<?xml version="1.0" encoding="utf-8"?>
<search>
	<entry>
		<title>nlpå…³é”®è¯å’Œæ‘˜è¦æå–æŠ€æœ¯æ•´ç†</title>
		<url>/article/42898.html</url>
		<content>åˆ‡è¯ç­‰å¾…â€¦å…³é”®è¯æå–è‡ªåŠ¨å…³é”®è¯æŠ½å–ç ”ç©¶ç»¼è¿°2017ç‰¹å¾é©±åŠ¨çš„å…³é”®è¯æå–ç®—æ³•ç»¼è¿°2018å…³é”®è¯æå–ç ”ç©¶ç»¼è¿°2021æ¦‚è¿°æ¦‚å¿µå…³é”®è¯æå–æŠ€æœ¯æ˜¯ä¸€ç§è‡ªç„¶è¯­è¨€å¤„ç†æŠ€æœ¯ï¼Œæ—¨åœ¨ä»ç»™å®šçš„æ–‡æœ¬ä¸­è‡ªåŠ¨è¯†åˆ«å‡ºæœ€å…·ä»£è¡¨æ€§å’Œé‡è¦æ€§çš„å…³é”®è¯æˆ–çŸ­è¯­å…³é”®è¯é€šå¸¸æ˜¯æ–‡æœ¬ä¸­å…·æœ‰ç‰¹æ®Šå«ä¹‰ã€èƒ½å¤Ÿæ¦‚æ‹¬æ–‡æœ¬ä¸»é¢˜æˆ–å†…å®¹çš„è¯è¯­æˆ–çŸ­è¯­ä½¿ç”¨åœºæ™¯å…³é”®è¯æå–æŠ€æœ¯çš„ç›®æ ‡æ˜¯å¯¹æ–‡æœ¬è¿›è¡Œè¯­ä¹‰åˆ†æå’Œå†…å®¹æŠ½å–ï¼Œä»è€Œæå–å‡ºæœ€èƒ½ä»£è¡¨æ–‡æœ¬ä¸»é¢˜å’Œå†…å®¹çš„å…³é”®è¯è¿™äº›å…³é”®è¯å¯ä»¥ç”¨äºæ–‡æœ¬åˆ†ç±»ã€ä¿¡æ¯æ£€ç´¢ã€æ–‡æœ¬æ‘˜è¦ã€ä¸»é¢˜å»ºæ¨¡ã€ä¿¡æ¯è¿‡æ»¤ç­‰è‡ªç„¶è¯­è¨€å¤„ç†ä»»åŠ¡ç»å…¸æ–¹æ³•å…³é”®è¯æå–æŠ€æœ¯é€šå¸¸ç»“åˆäº†æ–‡æœ¬çš„è¯­è¨€ç»Ÿè®¡ç‰¹å¾ã€è¯é¢‘åˆ†å¸ƒã€è¯æ€§ã€ä¸Šä¸‹æ–‡å…³ç³»ã€è¯­ä¹‰ç›¸ä¼¼åº¦ç­‰å¤šç§ä¿¡æ¯æºï¼Œä»¥è¯†åˆ«å¹¶æå–å‡ºæœ€ç›¸å…³å’Œå…·æœ‰åŒºåˆ†åº¦çš„å…³é”®è¯å¸¸è§çš„å…³é”®è¯æå–æ–¹æ³•åŒ…æ‹¬åŸºäºè¯é¢‘ã€TF-IDFã€æ–‡æœ¬å›¾ç»“æ„ã€è¯­è¨€æ¨¡å‹ã€å›¾æ¨¡å‹ã€æ·±åº¦å­¦ä¹ ç­‰å¤šç§æŠ€æœ¯æ‰‹æ®µå…³é”®è¯æå–æŠ€æœ¯åœ¨ä¿¡æ¯å¤„ç†ã€æ–‡æœ¬æŒ–æ˜ã€è‡ªåŠ¨åŒ–æ–‡æ¡£å¤„ç†ç­‰é¢†åŸŸå…·æœ‰é‡è¦åº”ç”¨ä»·å€¼ï¼Œèƒ½å¤Ÿå¸®åŠ©äººä»¬æ›´å¿«é€Ÿã€å‡†ç¡®åœ°ç†è§£å’Œå¤„ç†å¤§é‡æ–‡æœ¬ä¿¡æ¯åˆ†ç±»NLPä¸­å…³é”®å­—æå–æ–¹æ³•æ€»ç»“å’Œæ¦‚è¿°åŸºäºç»Ÿè®¡ç»Ÿè®¡æ–¹æ³•æ˜¯æœ€ç®€å•çš„ã€‚ä»–ä»¬è®¡ç®—å…³é”®å­—çš„ç»Ÿè®¡æ•°æ®å¹¶ä½¿ç”¨è¿™äº›ç»Ÿè®¡æ•°æ®å¯¹å®ƒä»¬è¿›è¡Œè¯„åˆ†ã€‚ä¸€äº›æœ€ç®€å•çš„ç»Ÿè®¡æ–¹æ³•æ˜¯è¯é¢‘ã€è¯æ­é…å’Œå…±ç°ä¹Ÿæœ‰ä¸€äº›æ›´å¤æ‚çš„ï¼Œä¾‹å¦‚TF-IDFå’ŒYAKE!tf-idfæ¦‚è¿°TF-IDFæˆ–term frequencyâ€“inverse document frequencyï¼Œä¼šè®¡ç®—æ–‡æ¡£ä¸­å•è¯ç›¸å¯¹äºæ•´ä¸ªè¯­æ–™åº“(æ›´å¤šæ–‡æ¡£é›†)çš„é‡è¦æ€§å®ƒè®¡ç®—æ–‡æ¡£ä¸­æ¯ä¸ªè¯çš„é¢‘ç‡ï¼Œå¹¶é€šè¿‡è¯åœ¨æ•´ä¸ªè¯­æ–™åº“ä¸­çš„é¢‘ç‡çš„å€’æ•°å¯¹å…¶è¿›è¡ŒåŠ æƒã€‚æœ€åï¼Œé€‰æ‹©å¾—åˆ†æœ€é«˜çš„è¯ä½œä¸ºå…³é”®è¯ï¼ŒTF-IDFæœ‰ä¸¤å±‚æ„æ€è¯é¢‘: Term Frequencyï¼Œç¼©å†™ä¸ºTFï¼Œé€šå¸¸æ¥è¯´ï¼Œä¸€ä¸ªåˆ†è¯å‡ºç°çš„æ¬¡æ•°è¶Šå¤šï¼Œä»£è¡¨è¶Šé‡è¦é€†æ–‡æ¡£é¢‘ç‡: Inverse Document Frequencyï¼Œç¼©å†™ä¸ºIDFï¼Œåœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œå‡ºç°æ¬¡æ•°æœ€å¤šçš„è¯æ˜¯ä¸€äº›æ— æ„ä¹‰çš„è¯ï¼Œæ¯”å¦‚åœç”¨è¯ï¼Œå¯¹æœç´¢ç»“æœæ¯«æ— å¸®åŠ©ï¼Œå¿…é¡»é€šè¿‡åˆ†è¯å™¨æå‰è¿‡æ»¤æ‰çš„è¯å…¬å¼ - TF-IDF from scratch in python on a real-world dataset.æœ¯è¯­tdNcorpusé‡Šä¹‰term(word)document(set of words)ä¸€ç¯‡æ–‡æ¡£ä¸­çš„è¯é›†åˆcount of corpusè¯­æ–™æ•°é‡the total document setæ€»ä½“æ–‡æ¡£é›†åˆä¸€ä¸ªåˆ†è¯Termçš„ç›¸å…³æ€§ç”±tf*idfå…¬å¼ç®€åŒ–è¡¨è¾¾ã€‚tf-idfæ¨¡å‹åŒ…å«äº†äºŒä¸ªç®€å•äº‹å®ï¼šæŸä¸ªtermåˆ†è¯åœ¨ä¸€ä¸ªæ–‡æ¡£ä¸­å‡ºç°æ¬¡æ•°(tf)è¶Šå¤šï¼Œè¿™ä¸ªè¯ä¸æ–‡æ¡£è¶Šç›¸å…³æŸä¸ªç´¢å¼•ä¸­åŒ…å«æŸä¸ªtermåˆ†è¯çš„æ–‡æ¡£æ•°é‡è¶Šå°‘(idf)ï¼Œè¿™ä¸ªtermåˆ†è¯è¶Šé‡è¦ä¾‹å­è€ƒè™‘ä¸€ä¸ªåŒ…å«100ä¸ªå•è¯çš„æ–‡æ¡£ï¼Œå…¶ä¸­Leonè¿™ä¸ªåˆ†è¯å‡ºç°äº†10æ¬¡ã€‚è¿™ä¸ªæ—¶å€™TF=(10/100)=0.1å¹¶ä¸”å‡è®¾Luceneç´¢å¼•ä¸­æœ‰1000Wä»½æ–‡æ¡£æ•°é‡ï¼Œå…¶ä¸­æœ‰1000ä»½æ–‡æ¡£ä¸­å‡ºç°äº†Leonè¿™ä¸ªåˆ†è¯ï¼Œæ­¤æ—¶é€†æ–‡æ¡£é¢‘ç‡(IDF)è®¡ç®—ä¸ºIDF=log(10,000,000/1,000)=4å› æ­¤ï¼ŒTD-IDFè®¡ç®—ä¸ºTF*IDF=0.1 * 4=0.412345678910111213import jiebaimport jieba.analysesentence = 'ä¸­åèœœèœ‚åŸäº§äºä¸­å›½ï¼Œæ˜¯ä¸­å›½çš„åœŸè‘—èœ‚ï¼Œé€‚åº”ä¸­å›½å„åœ°çš„æ°”å€™å’Œèœœæºæ¡ä»¶ï¼Œé€‚äºå®šåœ°é¥²å…»ä¸”ç¨³äº§ï¼Œå°¤å…¶æ˜¯åœ¨å—æ–¹å±±åŒºï¼Œæœ‰ç€å…¶ä»–èœ‚ç§ä¸å¯æ›¿ä»£çš„åœ°ä½'seg_list = jieba.cut(sentence, cut_all=True)print(&quot;, &quot;.join(seg_list))keywords = jieba.analyse.extract_tags(sentence, topK=20, withWeight=True, allowPOS=('n', 'nr', 'ns'))print(keywords)&gt;&gt;&gt;ä¸­å, èœœèœ‚, åŸäº§, äº§äº, ä¸­å›½, ï¼Œ, æ˜¯, ä¸­å›½, çš„, åœŸè‘—, èœ‚, ï¼Œ, é€‚åº”, ä¸­å›½, å„åœ°, çš„, æ°”å€™, å’Œ, èœœæº, æ¡ä»¶, ï¼Œ, é€‚äº, å®š, åœ°, é¥²å…», ä¸”, ç¨³äº§, ï¼Œ, å°¤å…¶, æ˜¯, åœ¨, å—æ–¹, æ–¹å±±, å±±åŒº, ï¼Œ, æœ‰ç€, å…¶ä»–, èœ‚, ç§, ä¸å¯, æ›¿ä»£, çš„, åœ°ä½[('å®šåœ°', 0.7969), ('èœ‚ç§', 0.7969), ('ç¨³äº§', 0.7340), ('èœœæº', 0.66725), ('ä¸­å›½', 0.60546), ('èœœèœ‚', 0.5859), ('åœŸè‘—', 0.55968), ('åŸäº§', 0.544705), ('æ›¿ä»£', 0.484315), ('å±±åŒº', 0.44390), ('æ°”å€™', 0.38804), ('åœ°ä½', 0.34710), ('æ¡ä»¶', 0.32636)]ä¼˜ç¼ºç‚¹é€Ÿåº¦å¿«: TF-IDFçš„ä¼˜ç‚¹æ˜¯é€Ÿåº¦å¿«è¯­è¨€æ— å…³: TF-IDFä¸è¯­è¨€æ— å…³éœ€è¦è¯­æ–™: éœ€è¦è‡³å°‘å‡ åä¸ªæ–‡æ¡£çš„è¯­æ–™åº“ä¸å¤Ÿå…¨é¢: ç¼ºç‚¹æ˜¯å•çº¯äºè¯é¢‘æ¥åˆ¤æ–­ä¸€ä¸ªåˆ†è¯çš„é‡è¦æ€§ï¼Œä¸å¤Ÿå…¨é¢æ— æ³•æ•è·è¯­ä¹‰: ç¼ºç‚¹æ˜¯ä¸èƒ½æ•æ‰åˆ†è¯Termåœ¨æ–‡æ¡£ä¸­çš„ä½ç½®å˜ç§TF-IDF çš„4å¤§å¸¸è§å˜ç§å˜ç§1: å¯¹æ•°å‡½æ•°å˜æ¢ TFï¼Œè§£å†³TFç°è¡Œå¢é•¿é—®é¢˜å˜ç§2: å¯¹ TF è¿›è¡Œæ ‡å‡†åŒ–ï¼Œè§£å†³é•¿çŸ­æ–‡æ¡£é—®é¢˜å˜ç§3: å¯¹æ•°å‡½æ•°å˜æ¢ IDFï¼Œè§£å†³IDF ç°è¡Œå¢é•¿é—®é¢˜å˜ç§4: æŸ¥è¯¢è¯åŠæ–‡æ¡£å‘é‡æ ‡å‡†åŒ–ï¼Œè§£å†³é•¿çŸ­æ–‡æ¡£é—®é¢˜YAKE2018ECIRçš„æœ€ä½³çŸ­è®ºæ–‡å¥– A Text Feature Based Automatic Keyword Extraction Method for Single Documentsgithub Yet Another Keyword Extractor (Yake)æ¦‚è¿°YAKE(Yet Another Keyword Extractor)æ˜¯ä¸€ç§å…³é”®å­—æå–æ–¹æ³•ï¼Œå®ƒåˆ©ç”¨å•ä¸ªæ–‡æ¡£çš„ç»Ÿè®¡ç‰¹å¾æ¥æå–å…³é”®å­—å®ƒé€šè¿‡äº”ä¸ªæ­¥éª¤æå–å…³é”®å­—ï¼Œæ—¨åœ¨ä»æ–‡æœ¬ä¸­è‡ªåŠ¨æå–æœ€ç›¸å…³çš„å…³é”®è¯å’Œå…³é”®çŸ­è¯­YAKEç®—æ³•çš„å·¥ä½œåŸç†å¦‚ä¸‹ï¼šæ–‡æœ¬é¢„å¤„ç†ï¼šå°†è¾“å…¥æ–‡æœ¬è¿›è¡Œé¢„å¤„ç†ï¼ŒåŒ…æ‹¬åˆ†è¯ã€å»é™¤åœç”¨è¯ç­‰ç‰¹å¾æå–ï¼šä½¿ç”¨è¯é¢‘ã€ä½ç½®æƒé‡ã€é•¿åº¦ç­‰ç‰¹å¾æ¥è¡¡é‡å•è¯å’ŒçŸ­è¯­çš„é‡è¦æ€§å…³é”®è¯å€™é€‰ç”Ÿæˆï¼šæ ¹æ®ç‰¹å¾æƒé‡ï¼Œç”Ÿæˆå€™é€‰å…³é”®è¯å’Œå…³é”®çŸ­è¯­å…³é”®è¯æƒé‡è®¡ç®—ï¼šæ ¹æ®å€™é€‰å…³é”®è¯çš„ç‰¹å¾æƒé‡ï¼Œè®¡ç®—å®ƒä»¬çš„æœ€ç»ˆæƒé‡å…³é”®è¯ç­›é€‰ï¼šæ ¹æ®è®¾å®šçš„é˜ˆå€¼æˆ–æ’åºæ–¹æ³•ï¼Œç­›é€‰å‡ºå…·æœ‰é«˜æƒé‡çš„å…³é”®è¯å’Œå…³é”®çŸ­è¯­ä½œä¸ºæœ€ç»ˆç»“æœYAKEç®—æ³•ä¸ä¼ ç»Ÿçš„åŸºäºç»Ÿè®¡å’Œè¯­è¨€æ¨¡å‹çš„å…³é”®è¯æå–æ–¹æ³•ä¸åŒï¼Œå®ƒé‡‡ç”¨äº†åŸºäºç‰¹å¾æƒé‡çš„æ–¹æ³•ï¼Œä½¿å¾—ç®—æ³•æ›´åŠ çµæ´»å’Œå¯å®šåˆ¶æ­¤å¤–ï¼ŒYAKEè¿˜æ”¯æŒå¤šè¯­è¨€å…³é”®è¯æå–ï¼Œå¹¶èƒ½å¤Ÿå¤„ç†é¢†åŸŸç‰¹å®šçš„æ–‡æœ¬æ€»ä½“è€Œè¨€ï¼ŒYAKEç®—æ³•é€šè¿‡ç»¼åˆè€ƒè™‘å•è¯å’ŒçŸ­è¯­çš„ç‰¹å¾æƒé‡ï¼Œä»¥åŠå®ƒä»¬åœ¨æ–‡æœ¬ä¸­çš„é¢‘ç‡å’Œä½ç½®ç­‰ä¿¡æ¯ï¼Œæ¥æå–ä¸æ–‡æœ¬å†…å®¹ç›¸å…³çš„å…³é”®è¯å’Œå…³é”®çŸ­è¯­å®˜æ–¹å®ç°ä»…æ”¯æŒè‹±æ–‡åŸºäºå›¾æŠ€æœ¯TextRankTextRankç®—æ³•ä»‹ç»åŠå®ç°TextRankæ˜¯ä¸€ç§åŸºäºå›¾çš„ç®—æ³•ï¼Œç”¨äºå…³é”®è¯æå–å’Œæ–‡æœ¬æ‘˜è¦ã€‚å®ƒåŸºäºPageRankç®—æ³•çš„æ€æƒ³ï¼Œå°†æ–‡æœ¬è¡¨ç¤ºä¸ºä¸€ä¸ªå›¾ï¼Œå…¶ä¸­èŠ‚ç‚¹è¡¨ç¤ºæ–‡æœ¬ä¸­çš„å•è¯æˆ–çŸ­è¯­ï¼Œè¾¹è¡¨ç¤ºå®ƒä»¬ä¹‹é—´çš„å…³ç³»é€šè¿‡è®¡ç®—èŠ‚ç‚¹ä¹‹é—´çš„æƒé‡å’Œè¿æ¥å…³ç³»ï¼ŒTextRankå¯ä»¥ç¡®å®šæ–‡æœ¬ä¸­æœ€é‡è¦çš„å•è¯æˆ–çŸ­è¯­ã€‚TextRankçš„æ­¥éª¤å¦‚ä¸‹ï¼šåˆ†å‰²æ–‡æœ¬ï¼šå°†æ–‡æœ¬åˆ†å‰²æˆå¥å­æˆ–å•è¯æ„å»ºå›¾ï¼šæ ¹æ®æ–‡æœ¬ä¸­çš„å¥å­æˆ–å•è¯æ„å»ºä¸€ä¸ªå›¾ï¼Œå…¶ä¸­æ¯ä¸ªå¥å­æˆ–å•è¯ä½œä¸ºä¸€ä¸ªèŠ‚ç‚¹ï¼Œè¾¹è¡¨ç¤ºå®ƒä»¬ä¹‹é—´çš„å…³ç³»ã€‚å¸¸è§çš„å…³ç³»å¯ä»¥æ˜¯å…±ç°å…³ç³»æˆ–è¯­ä¹‰å…³ç³»è®¡ç®—æƒé‡ï¼šä¸ºå›¾ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹è®¡ç®—æƒé‡ã€‚é€šå¸¸ä½¿ç”¨è¯é¢‘æˆ–TF-IDFä½œä¸ºåˆå§‹æƒé‡è¿­ä»£è®¡ç®—ï¼šé€šè¿‡è¿­ä»£è®¡ç®—èŠ‚ç‚¹ä¹‹é—´çš„æƒé‡ï¼Œæ›´æ–°æ¯ä¸ªèŠ‚ç‚¹çš„æƒé‡å€¼ã€‚è¿­ä»£è¿‡ç¨‹ä¸­ï¼ŒèŠ‚ç‚¹çš„æƒé‡å°†è€ƒè™‘å…¶ç›¸é‚»èŠ‚ç‚¹çš„æƒé‡å€¼æ’åºèŠ‚ç‚¹ï¼šæ ¹æ®èŠ‚ç‚¹çš„æƒé‡å€¼å¯¹èŠ‚ç‚¹è¿›è¡Œæ’åºï¼Œå¾—åˆ°å…³é”®è¯æˆ–æ‘˜è¦TextRankç®—æ³•åœ¨å…³é”®è¯æå–å’Œæ–‡æœ¬æ‘˜è¦ç­‰ä»»åŠ¡ä¸­è¡¨ç°è‰¯å¥½ï¼Œå®ƒä¸éœ€è¦ä¾èµ–é¢„è®­ç»ƒæ¨¡å‹ï¼Œå¯ä»¥ç›´æ¥åº”ç”¨äºå„ç§é¢†åŸŸçš„æ–‡æœ¬å¤„ç†ä»»åŠ¡PageRankThe PageRank Citation Ranking: Bringing Order to the Web 1999å…³é”®è¯æå–å’Œæ‘˜è¦ç®—æ³•TextRankè¯¦è§£ä¸å®æˆ˜PageRankç®—æ³•é€šè¿‡è®¡ç®—ç½‘é¡µé“¾æ¥çš„æ•°é‡å’Œè´¨é‡æ¥ç²—ç•¥ä¼°è®¡ç½‘é¡µçš„é‡è¦æ€§ï¼Œç®—æ³•åˆ›ç«‹ä¹‹åˆå³åº”ç”¨åœ¨è°·æ­Œçš„æœç´¢å¼•æ“ä¸­ï¼Œå¯¹ç½‘é¡µè¿›è¡Œæ’åã€‚PageRankç®—æ³•çš„æ ¸å¿ƒæ€æƒ³å¦‚ä¸‹ï¼šé“¾æ¥æ•°é‡ï¼šå¦‚æœä¸€ä¸ªç½‘é¡µè¢«è¶Šå¤šçš„å…¶ä»–ç½‘é¡µé“¾æ¥ï¼Œè¯´æ˜è¿™ä¸ªç½‘é¡µè¶Šé‡è¦ï¼Œå³è¯¥ç½‘é¡µçš„PRå€¼(PageRankå€¼)ä¼šç›¸å¯¹è¾ƒé«˜é“¾æ¥è´¨é‡ï¼šå¦‚æœä¸€ä¸ªç½‘é¡µè¢«ä¸€ä¸ªè¶Šé«˜æƒå€¼çš„ç½‘é¡µé“¾æ¥ï¼Œä¹Ÿèƒ½è¡¨æ˜è¿™ä¸ªç½‘é¡µè¶Šé‡è¦ï¼Œå³ä¸€ä¸ªPRå€¼å¾ˆé«˜çš„ç½‘é¡µé“¾æ¥åˆ°ä¸€ä¸ªå…¶ä»–ç½‘é¡µï¼Œé‚£ä¹ˆè¢«é“¾æ¥åˆ°çš„ç½‘é¡µçš„PRå€¼ä¼šç›¸åº”åœ°å› æ­¤è€Œæé«˜PageRankç®—æ³•è®¡ç®—å…¬å¼å…¶ä¸­ï¼Œæ˜¯ç½‘é¡µçš„é‡è¦æ€§(PRå€¼)ï¼Œæ˜¯é˜»å°¼ç³»æ•°ï¼Œä¸€èˆ¬ä¸º0.85ï¼Œæ˜¯æ•´ä¸ªäº’è”ç½‘ä¸­æ‰€å­˜åœ¨çš„æœ‰æŒ‡åŒç½‘é¡µçš„é“¾æ¥çš„ç½‘é¡µé›†åˆï¼Œæ˜¯ç½‘é¡µä¸­å­˜åœ¨çš„æŒ‡å‘æ‰€æœ‰å¤–éƒ¨ç½‘é¡µçš„é“¾è¾–çš„é›†åˆï¼Œæ˜¯è¯¥é›†åˆä¸­å…ƒç´ çš„ä¸ªæ•°ä¾‹å­ç­‰å¾…â€¦PageRankç®—æ³•ä¸TextRankç®—æ³•çš„åŒºåˆ«PageRankç®—æ³•æ ¹æ®ç½‘é¡µä¹‹é—´çš„é“¾æ¥å…³ç³»æ„é€ ç½‘ç»œï¼ŒTextRankç®—æ³•æ ¹æ®è¯ä¹‹é—´çš„å…±ç°å…³ç³»æ„é€ ç½‘ç»œPageRankç®—æ³•æ„é€ çš„ç½‘ç»œä¸­çš„è¾¹æ˜¯æœ‰å‘æ— æƒè¾¹ï¼ŒTextRankç®—æ³•æ„é€ çš„ç½‘ç»œä¸­çš„è¾¹æ˜¯æ— å‘æœ‰æƒè¾¹å®ç°åŸºäºTextrank4zhçš„TextRankç®—æ³•å®ç°12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182from textrank4zh import TextRank4Keyword, TextRank4Sentenceimport jieba.analysefrom snownlp import SnowNLPimport pandas as pdimport numpy as np #å…³é”®è¯æŠ½å–def keywords_extraction(text):    tr4w = TextRank4Keyword(allow_speech_tags=['n', 'nr', 'nrfg', 'ns', 'nt', 'nz'])    # allow_speech_tags   --è¯æ€§åˆ—è¡¨ï¼Œç”¨äºè¿‡æ»¤æŸäº›è¯æ€§çš„è¯    tr4w.analyze(text=text, window=2, lower=True, vertex_source='all_filters', edge_source='no_stop_words',                 pagerank_config={'alpha': 0.85, })    # text    --  æ–‡æœ¬å†…å®¹ï¼Œå­—ç¬¦ä¸²    # window  --  çª—å£å¤§å°ï¼Œintï¼Œç”¨æ¥æ„é€ å•è¯ä¹‹é—´çš„è¾¹ã€‚é»˜è®¤å€¼ä¸º2    # lower   --  æ˜¯å¦å°†è‹±æ–‡æ–‡æœ¬è½¬æ¢ä¸ºå°å†™ï¼Œé»˜è®¤å€¼ä¸ºFalse    # vertex_source  -- é€‰æ‹©ä½¿ç”¨words_no_filter, words_no_stop_words, words_all_filtersä¸­çš„å“ªä¸€ä¸ªæ¥æ„é€ pagerankå¯¹åº”çš„å›¾ä¸­çš„èŠ‚ç‚¹    #                -- é»˜è®¤å€¼ä¸º`'all_filters'`ï¼Œå¯é€‰å€¼ä¸º`'no_filter', 'no_stop_words', 'all_filters'    # edge_source  -- é€‰æ‹©ä½¿ç”¨words_no_filter, words_no_stop_words, words_all_filtersä¸­çš„å“ªä¸€ä¸ªæ¥æ„é€ pagerankå¯¹åº”çš„å›¾ä¸­çš„èŠ‚ç‚¹ä¹‹é—´çš„è¾¹    #              -- é»˜è®¤å€¼ä¸º`'no_stop_words'`ï¼Œå¯é€‰å€¼ä¸º`'no_filter', 'no_stop_words', 'all_filters'`ã€‚è¾¹çš„æ„é€ è¦ç»“åˆ`window`å‚æ•°     # pagerank_config  -- pagerankç®—æ³•å‚æ•°é…ç½®ï¼Œé˜»å°¼ç³»æ•°ä¸º0.85    keywords = tr4w.get_keywords(num=6, word_min_len=2)    # num           --  è¿”å›å…³é”®è¯æ•°é‡    # word_min_len  --  è¯çš„æœ€å°é•¿åº¦ï¼Œé»˜è®¤å€¼ä¸º1    return keywords #å…³é”®çŸ­è¯­æŠ½å–def keyphrases_extraction(text):    tr4w = TextRank4Keyword()    tr4w.analyze(text=text, window=2, lower=True, vertex_source='all_filters', edge_source='no_stop_words',                 pagerank_config={'alpha': 0.85, })    keyphrases = tr4w.get_keyphrases(keywords_num=6, min_occur_num=1)    # keywords_num    --  æŠ½å–çš„å…³é”®è¯æ•°é‡    # min_occur_num   --  å…³é”®çŸ­è¯­åœ¨æ–‡ä¸­çš„æœ€å°‘å‡ºç°æ¬¡æ•°    return keyphrases #å…³é”®å¥æŠ½å–def keysentences_extraction(text):    tr4s = TextRank4Sentence()    tr4s.analyze(text, lower=True, source='all_filters')    # text    -- æ–‡æœ¬å†…å®¹ï¼Œå­—ç¬¦ä¸²    # lower   -- æ˜¯å¦å°†è‹±æ–‡æ–‡æœ¬è½¬æ¢ä¸ºå°å†™ï¼Œé»˜è®¤å€¼ä¸ºFalse    # source  -- é€‰æ‹©ä½¿ç”¨words_no_filter, words_no_stop_words, words_all_filtersä¸­çš„å“ªä¸€ä¸ªæ¥ç”Ÿæˆå¥å­ä¹‹é—´çš„ç›¸ä¼¼åº¦ã€‚    #   -- é»˜è®¤å€¼ä¸º`'all_filters'`ï¼Œå¯é€‰å€¼ä¸º`'no_filter', 'no_stop_words', 'all_filters'    # sim_func -- æŒ‡å®šè®¡ç®—å¥å­ç›¸ä¼¼åº¦çš„å‡½æ•°     # è·å–æœ€é‡è¦çš„numä¸ªé•¿åº¦å¤§äºç­‰äºsentence_min_lençš„å¥å­ç”¨æ¥ç”Ÿæˆæ‘˜è¦    keysentences = tr4s.get_key_sentences(num=3, sentence_min_len=6)    return keysentences  def keywords_textrank(text):    keywords = jieba.analyse.textrank(text, topK=6)    return keywords  if __name__ == &quot;__main__&quot;:    text = &quot;æ¥æºï¼šä¸­å›½ç§‘å­¦æŠ¥æœ¬æŠ¥è®¯ï¼ˆè®°è€…è‚–æ´ï¼‰åˆæœ‰ä¸€ä½ä¸­å›½ç§‘å­¦å®¶å–œè·å°è¡Œæ˜Ÿå‘½åæ®Šè£ï¼4æœˆ19æ—¥ä¸‹åˆï¼Œä¸­å›½ç§‘å­¦é™¢å›½å®¶å¤©æ–‡å°åœ¨äº¬ä¸¾è¡Œâ€œå‘¨åˆå…ƒæ˜Ÿâ€é¢æˆä»ªå¼ï¼Œ&quot; \           &quot;æˆ‘å›½å¤©æ–‡å­¦å®¶ã€ä¸­å›½ç§‘å­¦é™¢é™¢å£«å‘¨åˆå…ƒçš„å¼Ÿå­ä¸åè¾ˆåœ¨æ¬¢å£°ç¬‘è¯­ä¸­æµæµä¸€å ‚ã€‚å›½å®¶å¤©æ–‡å°å…šå§”ä¹¦è®°ã€&quot; \           &quot;å‰¯å°é•¿èµµåˆšåœ¨è‡´è¾ä¸€å¼€å§‹æ›´æ˜¯é€ä¸Šç™½å±…æ˜“çš„è¯—å¥ï¼šâ€œä»¤å…¬æ¡ƒææ»¡å¤©ä¸‹ï¼Œä½•é¡»å ‚å‰æ›´ç§èŠ±ã€‚â€&quot; \           &quot;æ®ä»‹ç»ï¼Œè¿™é¢—å°è¡Œæ˜Ÿç”±å›½å®¶å¤©æ–‡å°æ–½å¯†ç‰¹CCDå°è¡Œæ˜Ÿé¡¹ç›®ç»„äº1997å¹´9æœˆ26æ—¥å‘ç°äºå…´éš†è§‚æµ‹ç«™ï¼Œ&quot; \           &quot;è·å¾—å›½é™…æ°¸ä¹…ç¼–å·ç¬¬120730å·ã€‚2018å¹´9æœˆ25æ—¥ï¼Œç»å›½å®¶å¤©æ–‡å°ç”³æŠ¥ï¼Œ&quot; \           &quot;å›½é™…å¤©æ–‡å­¦è”åˆä¼šå°å¤©ä½“è”åˆä¼šå°å¤©ä½“å‘½åå§”å‘˜ä¼šæ‰¹å‡†ï¼Œå›½é™…å¤©æ–‡å­¦è”åˆä¼šã€Šå°è¡Œæ˜Ÿé€šæŠ¥ã€‹é€šçŸ¥å›½é™…ç¤¾ä¼šï¼Œ&quot; \           &quot;æ­£å¼å°†è¯¥å°è¡Œæ˜Ÿå‘½åä¸ºâ€œå‘¨åˆå…ƒæ˜Ÿâ€ã€‚&quot;    #å…³é”®è¯æŠ½å–    keywords=keywords_extraction(text)    print(keywords)     #å…³é”®çŸ­è¯­æŠ½å–    keyphrases=keyphrases_extraction(text)    print(keyphrases)     #å…³é”®å¥æŠ½å–    keysentences=keysentences_extraction(text)    print(keysentences)        &gt;&gt;&gt;[{'word': 'å°è¡Œæ˜Ÿ', 'weight': 0.05808}, {'word': 'å¤©æ–‡å°', 'weight': 0.05721}, {'word': 'å‘½å', 'weight': 0.048517}, {'word': 'ä¸­å›½', 'weight': 0.045716}, {'word': 'ä¸­å›½ç§‘å­¦é™¢', 'weight': 0.037818}, {'word': 'å›½å®¶', 'weight': 0.03438}]['å°è¡Œæ˜Ÿå‘½å'][{'index': 4, 'sentence': '2018å¹´9æœˆ25æ—¥ï¼Œç»å›½å®¶å¤©æ–‡å°ç”³æŠ¥ï¼Œå›½é™…å¤©æ–‡å­¦è”åˆä¼šå°å¤©ä½“è”åˆä¼šå°å¤©ä½“å‘½åå§”å‘˜ä¼šæ‰¹å‡†ï¼Œå›½é™…å¤©æ–‡å­¦è”åˆä¼šã€Šå°è¡Œæ˜Ÿé€šæŠ¥ã€‹é€šçŸ¥å›½é™…ç¤¾ä¼šï¼Œæ­£å¼å°†è¯¥å°è¡Œæ˜Ÿå‘½åä¸ºâ€œå‘¨åˆå…ƒæ˜Ÿâ€', 'weight': 0.2281}, {'index': 3, 'sentence': 'â€æ®ä»‹ç»ï¼Œè¿™é¢—å°è¡Œæ˜Ÿç”±å›½å®¶å¤©æ–‡å°æ–½å¯†ç‰¹CCDå°è¡Œæ˜Ÿé¡¹ç›®ç»„äº1997å¹´9æœˆ26æ—¥å‘ç°äºå…´éš†è§‚æµ‹ç«™ï¼Œè·å¾—å›½é™…æ°¸ä¹…ç¼–å·ç¬¬120730å·', 'weight': 0.2106}, {'index': 1, 'sentence': '4æœˆ19æ—¥ä¸‹åˆï¼Œä¸­å›½ç§‘å­¦é™¢å›½å®¶å¤©æ–‡å°åœ¨äº¬ä¸¾è¡Œâ€œå‘¨åˆå…ƒæ˜Ÿâ€é¢æˆä»ªå¼ï¼Œæˆ‘å›½å¤©æ–‡å­¦å®¶ã€ä¸­å›½ç§‘å­¦é™¢é™¢å£«å‘¨åˆå…ƒçš„å¼Ÿå­ä¸åè¾ˆåœ¨æ¬¢å£°ç¬‘è¯­ä¸­æµæµä¸€å ‚', 'weight': 0.20209}]åŸºäºjiebaçš„TextRankç®—æ³•å®ç°12345678910111213141516if __name__ == &quot;__main__&quot;:    text = &quot;æ¥æºï¼šä¸­å›½ç§‘å­¦æŠ¥æœ¬æŠ¥è®¯ï¼ˆè®°è€…è‚–æ´ï¼‰åˆæœ‰ä¸€ä½ä¸­å›½ç§‘å­¦å®¶å–œè·å°è¡Œæ˜Ÿå‘½åæ®Šè£ï¼4æœˆ19æ—¥ä¸‹åˆï¼Œä¸­å›½ç§‘å­¦é™¢å›½å®¶å¤©æ–‡å°åœ¨äº¬ä¸¾è¡Œâ€œå‘¨åˆå…ƒæ˜Ÿâ€é¢æˆä»ªå¼ï¼Œ&quot; \           &quot;æˆ‘å›½å¤©æ–‡å­¦å®¶ã€ä¸­å›½ç§‘å­¦é™¢é™¢å£«å‘¨åˆå…ƒçš„å¼Ÿå­ä¸åè¾ˆåœ¨æ¬¢å£°ç¬‘è¯­ä¸­æµæµä¸€å ‚ã€‚å›½å®¶å¤©æ–‡å°å…šå§”ä¹¦è®°ã€&quot; \           &quot;å‰¯å°é•¿èµµåˆšåœ¨è‡´è¾ä¸€å¼€å§‹æ›´æ˜¯é€ä¸Šç™½å±…æ˜“çš„è¯—å¥ï¼šâ€œä»¤å…¬æ¡ƒææ»¡å¤©ä¸‹ï¼Œä½•é¡»å ‚å‰æ›´ç§èŠ±ã€‚â€&quot; \           &quot;æ®ä»‹ç»ï¼Œè¿™é¢—å°è¡Œæ˜Ÿç”±å›½å®¶å¤©æ–‡å°æ–½å¯†ç‰¹CCDå°è¡Œæ˜Ÿé¡¹ç›®ç»„äº1997å¹´9æœˆ26æ—¥å‘ç°äºå…´éš†è§‚æµ‹ç«™ï¼Œ&quot; \           &quot;è·å¾—å›½é™…æ°¸ä¹…ç¼–å·ç¬¬120730å·ã€‚2018å¹´9æœˆ25æ—¥ï¼Œç»å›½å®¶å¤©æ–‡å°ç”³æŠ¥ï¼Œ&quot; \           &quot;å›½é™…å¤©æ–‡å­¦è”åˆä¼šå°å¤©ä½“è”åˆä¼šå°å¤©ä½“å‘½åå§”å‘˜ä¼šæ‰¹å‡†ï¼Œå›½é™…å¤©æ–‡å­¦è”åˆä¼šã€Šå°è¡Œæ˜Ÿé€šæŠ¥ã€‹é€šçŸ¥å›½é™…ç¤¾ä¼šï¼Œ&quot; \           &quot;æ­£å¼å°†è¯¥å°è¡Œæ˜Ÿå‘½åä¸ºâ€œå‘¨åˆå…ƒæ˜Ÿâ€ã€‚&quot;     # åŸºäºjiebaçš„textrankç®—æ³•å®ç°    keywords=keywords_textrank(text)    print(keywords)&gt;&gt;&gt;['å°è¡Œæ˜Ÿ', 'å‘½å', 'å›½é™…', 'ä¸­å›½', 'å›½å®¶', 'å¤©æ–‡å­¦å®¶']RAKERAKEå’ŒTextRankçš„ä¸»è¦åŒºåˆ«åœ¨äºRAKEè€ƒè™‘å€™é€‰å…³é”®å­—å†…çš„å…±ç°è€Œä¸æ˜¯å›ºå®šçª—å£ã€‚å®ƒä½¿ç”¨æ›´ç®€å•ã€æ›´å…·ç»Ÿè®¡æ€§çš„è¯„åˆ†ç¨‹åºã€‚è¯¥ç®—æ³•å¯¹æ¯ä¸ªæ–‡æ¡£åˆ†åˆ«è¿›è¡Œï¼Œå› æ­¤ä¸éœ€è¦æ–‡æ¡£è¯­æ–™åº“æ¥è¿›è¡Œå…³é”®è¯æå–åŸºäºæ·±åº¦å­¦ä¹ æ·±åº¦å­¦ä¹ çš„å‡ºç°ä½¿åŸºäºåµŒå…¥çš„æ–¹æ³•æˆä¸ºå¯èƒ½ã€‚ç ”ç©¶äººå‘˜å¼€å‘äº†å‡ ç§ä½¿ç”¨æ–‡æ¡£åµŒå…¥çš„å…³é”®å­—æå–æ–¹æ³•(ä¾‹å¦‚Bennaniç­‰äºº)è¿™äº›æ–¹æ³•ä¸»è¦æŸ¥æ‰¾å€™é€‰å…³é”®å­—åˆ—è¡¨(ä¾‹å¦‚ï¼ŒBennaniç­‰äººåªè€ƒè™‘ç”±åè¯å’Œå½¢å®¹è¯ç»„æˆçš„å…³é”®å­—)ä»–ä»¬å°†æ–‡æ¡£å’Œå€™é€‰å…³é”®å­—åµŒå…¥åˆ°ç›¸åŒçš„åµŒå…¥ç©ºé—´ä¸­ï¼Œå¹¶æµ‹é‡æ–‡æ¡£å’Œå…³é”®å­—åµŒå…¥ä¹‹é—´çš„ç›¸ä¼¼åº¦(ä¾‹å¦‚ä½™å¼¦ç›¸ä¼¼åº¦)ã€‚ä»–ä»¬æ ¹æ®ç›¸ä¼¼åº¦åº¦é‡é€‰æ‹©ä¸æ–‡æ¡£æ–‡æœ¬æœ€ç›¸ä¼¼çš„å…³é”®å­—SIFRankSIFRank: A New Baseline for Unsupervised Keyphrase Extraction Based on Pre-Trained Language Model 2019è®ºæ–‡é˜…è¯»ç¬”è®°ï¼š SIFRank and BERT-KPEgithub sunyilgdx/SIFRank_zhSIFRankæ¯”è¾ƒé€‚åˆçŸ­æ–‡æœ¬çš„å…³é”®è¯æŠ½å–ï¼Œè€ŒSIFRank+å¤§å¹…å¢åŠ äº†é•¿æ–‡æœ¬çš„å…³é”®è¯æŠ½å–æ•ˆæœæ­¥éª¤äººå·¥æ ‡æ³¨ï¼šåˆ†è¯+æ ‡è¯æ€§è·å–å€™é€‰å…³é”®è¯åˆ—è¡¨ï¼šåˆ©ç”¨æ­£åˆ™è¡¨è¾¾å¼ç¡®å®šåè¯çŸ­è¯­(ä¾‹å¦‚ï¼šå½¢å®¹è¯+åè¯)ï¼Œå°†åè¯çŸ­è¯­ä½œä¸ºå€™é€‰å…³é”®çŸ­è¯­é€šè¿‡é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ï¼Œå¾—åˆ°å…³é”®è¯çš„embeddingåŒæ ·åœ°ï¼Œå¾—åˆ°å¥å­æˆ–æ–‡æ¡£çš„embeddingè®¡ç®—3ä¸4ç»“æœçš„ä½™å¼¦ç›¸ä¼¼åº¦ï¼Œé€‰å–topNä½œä¸ºå…¶æœ€ç»ˆæå–çš„å…³é”®è¯NP chunkeråœ¨SIFRankæ–¹æ³•ä¸­ï¼ŒNP chunkeræ˜¯ä¸€ç§ç”¨äºè¯†åˆ«å’Œæå–åè¯çŸ­è¯­(Noun Phrase)çš„å·¥å…·æˆ–ç»„ä»¶ã€‚NP chunkerçš„ç›®æ ‡æ˜¯ä»ç»™å®šçš„æ–‡æœ¬ä¸­å®šä½å’Œæå–å‡ºåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªåè¯çš„çŸ­è¯­ã€‚åè¯çŸ­è¯­é€šå¸¸ç”±ä¸€ä¸ªåè¯ä½œä¸ºæ ¸å¿ƒè¯ï¼Œå¹¶å¯èƒ½åŒ…å«å…¶ä»–ä¿®é¥°è¯æˆ–é™å®šè¯NP chunkerä½¿ç”¨ä¸€ç³»åˆ—è¯­æ³•è§„åˆ™æˆ–æœºå™¨å­¦ä¹ æ¨¡å‹æ¥è¯†åˆ«åè¯çŸ­è¯­çš„è¾¹ç•Œï¼Œå¹¶å°†å®ƒä»¬æ ‡è®°ä¸ºä¸€ä¸ªå•ç‹¬çš„çŸ­è¯­å•å…ƒè¿™ä¸ªè¿‡ç¨‹æœ‰åŠ©äºæ›´å¥½åœ°ç†è§£æ–‡æœ¬çš„ç»“æ„å’Œè¯­ä¹‰ï¼Œç‰¹åˆ«æ˜¯åœ¨æ–‡æœ¬ä¸­æ¶‰åŠåˆ°åè¯çŸ­è¯­çš„å…³é”®çŸ­è¯­æå–ä»»åŠ¡ä¸­ã€‚åœ¨SIFRankæ–¹æ³•ä¸­ï¼ŒNP chunkerç”¨äºæå–å€™é€‰å…³é”®çŸ­è¯­ï¼Œå¹¶ä¸ºåç»­çš„å…³é”®çŸ­è¯­æ’åºå’Œè¯„åˆ†æä¾›åŸºç¡€SIFæ¨¡å‹å¥å­åµŒå…¥æ¨¡å‹SIF(Smooth Inverse Frequency)æ˜¯ä¸€ç§ç”¨äºå°†å¥å­è½¬æ¢ä¸ºè¿ç»­å‘é‡è¡¨ç¤ºçš„æ–¹æ³•å®ƒæ—¨åœ¨æ•æ‰å¥å­çš„è¯­ä¹‰ä¿¡æ¯ï¼Œå¹¶å°†å¥å­è¡¨ç¤ºä¸ºç¨ å¯†çš„ä½ç»´å‘é‡ã€‚SIFæ¨¡å‹çš„å…³é”®æ€æƒ³æ˜¯ç»“åˆè¯é¢‘ä¿¡æ¯æ¥è°ƒæ•´è¯å‘é‡çš„æƒé‡ï¼Œä»¥é™ä½é«˜é¢‘è¯çš„é‡è¦æ€§ï¼ŒåŒæ—¶æé«˜ä½é¢‘è¯çš„é‡è¦æ€§ã€‚è¿™æ ·å¯ä»¥å‡è½»ä¸€äº›å¸¸è§è¯å¯¹å¥å­è¡¨ç¤ºçš„å½±å“ï¼Œä½¿å¾—å¥å­è¡¨ç¤ºæ›´åŠ æ³¨é‡é‚£äº›åœ¨è¯­ä¹‰ä¸Šæ›´å…·åŒºåˆ†åº¦çš„è¯è¯­ã€‚SIFæ¨¡å‹é€šè¿‡ç®€å•çš„æ•°å­¦è¿ç®—ï¼Œå¦‚å‡æ³•å’ŒåŠ æƒå¹³å‡ï¼Œæ¥è®¡ç®—å¥å­çš„åµŒå…¥è¡¨ç¤ºå®ƒåœ¨è‡ªç„¶è¯­è¨€å¤„ç†ä»»åŠ¡ä¸­è¢«å¹¿æ³›åº”ç”¨ï¼Œå¦‚æ–‡æœ¬åˆ†ç±»ã€æƒ…æ„Ÿåˆ†æå’Œå¥å­ç›¸ä¼¼åº¦è®¡ç®—ç­‰sentence embeddingçš„å‡è®¾æ˜¯ï¼šæ–‡ç« æ˜¯ç”±ä¸€ä¸ªtopicç”Ÿæˆçš„ï¼Œæ–‡ç« ä¸­çš„æ¯ä¸ªå¥å­äº¦æ˜¯å¦‚æ­¤ï¼Œå› æ­¤ï¼Œå¥å­çš„embeddingåº”è¯¥ä¸æ–‡ç« embeddingçš„æœŸæœ›å€¼(topic embedding)ç›¸è¿‘Bert-KPECapturing Global Informativeness in Open Domain Keyphrase Extraction 2021BERT-KPEæ˜¯æœ€è¿‘ç”±thunlpæå‡ºçš„æ–¹æ³•ï¼Œåœ¨OpenKPå’ŒKP20Kä¸Šéƒ½è¾¾åˆ°äº†state-of-the-artå’Œè‰¯å¥½çš„é²æ£’æ€§æœ‰ç›‘ç£çš„æ–¹å¼KeyBertKeyBERTKeyword Extraction with BERTã€Œå…³é”®è¯ã€æå–éƒ½æœ‰å“ªäº›æ–¹æ¡ˆï¼Ÿå½“æˆ‘ä»¬æƒ³è¦ä»ç‰¹å®šæ–‡æ¡£ä¸­äº†è§£å…³é”®ä¿¡æ¯æ—¶ï¼Œé€šå¸¸ä¼šä½¿ç”¨å…³é”®è¯æå–ã€‚å…³é”®è¯æå–æ˜¯ä¸€ç§è‡ªåŠ¨åŒ–çš„è¿‡ç¨‹ï¼Œç”¨äºæå–ä¸è¾“å…¥æ–‡æœ¬æœ€ç›¸å…³çš„å•è¯å’ŒçŸ­è¯­é€šè¿‡ä½¿ç”¨Rakeå’ŒYAKE!ç­‰æ–¹æ³•ï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥ä½¿ç”¨æ˜“äºä½¿ç”¨çš„è½¯ä»¶åŒ…æ¥æå–å…³é”®è¯å’Œå…³é”®çŸ­è¯­ã€‚ç„¶è€Œï¼Œè¿™äº›æ¨¡å‹é€šå¸¸åŸºäºæ–‡æœ¬çš„ç»Ÿè®¡ç‰¹æ€§è€Œä¸æ˜¯è¯­ä¹‰ç›¸ä¼¼æ€§è¿›è¡Œå·¥ä½œäºæ˜¯BERTç™»åœºã€‚BERTæ˜¯ä¸€ä¸ªåŒå‘å˜æ¢å™¨æ¨¡å‹ï¼Œå¯ä»¥å°†çŸ­è¯­å’Œæ–‡æ¡£è½¬åŒ–ä¸ºèƒ½å¤Ÿæ•æ‰å…¶æ„ä¹‰çš„å‘é‡ä½¿ç”¨BERTæå–æ–‡æ¡£å‘é‡(åµŒå…¥)ä»¥è·å–æ–‡æ¡£çº§è¡¨ç¤ºã€‚ç„¶åï¼Œé’ˆå¯¹Nå…ƒè¯­æ³•è¯/çŸ­è¯­æå–è¯å‘é‡ã€‚æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨ä½™å¼¦ç›¸ä¼¼åº¦æ¥æŸ¥æ‰¾ä¸æ–‡æ¡£æœ€ç›¸ä¼¼çš„è¯/çŸ­è¯­ã€‚ç„¶åï¼Œå¯ä»¥å°†æœ€ç›¸ä¼¼çš„è¯è¯†å®šä¹‰ä¸ºæœ€èƒ½æè¿°æ•´ä¸ªæ–‡æ¡£çš„è¯æ¦‚è¿°ä»€ä¹ˆæ˜¯KeybertKeybertæ˜¯ä¸€ç§åŸºäºæ— ç›‘ç£å­¦ä¹ çš„å…³é”®è¯æŠ½å–æŠ€æœ¯ï¼Œä¸ä»…æ•ˆæœå¥½ï¼Œè€Œä¸”æ˜“äºä½¿ç”¨Keybertä¸»è¦é€šè¿‡Bertè·å–æ–‡æ¡£å’Œå€™é€‰è¯çš„embeddingï¼Œç„¶åä½¿ç”¨ä½™å¼¦ç›¸ä¼¼åº¦è®¡ç®—å¾—åˆ°æ–‡æ¡£ä¸­æœ€ç›¸ä¼¼çš„å€™é€‰è¯ä½œä¸ºå…³é”®è¯å¤šæ ·æ€§åœ¨å…³é”®è¯æå–ä¸­ï¼Œå¤šæ ·æ€§é—®é¢˜æŒ‡çš„æ˜¯å…³é”®è¯åˆ—è¡¨ä¸­å­˜åœ¨å¤§é‡ç›¸ä¼¼æˆ–é‡å¤çš„å…³é”®è¯ï¼Œç¼ºä¹å¤šæ ·æ€§å’Œä»£è¡¨æ€§ã€‚è¿™å¯èƒ½å¯¼è‡´å…³é”®ä¿¡æ¯çš„ä¸¢å¤±æˆ–é‡å¤ï¼Œå¹¶é™ä½å…³é”®è¯æå–çš„æ•ˆæœMSSæœ€å¤§æ€»è·ç¦»(Max Sum Distance)ï¼šé€šè¿‡å°†æ–‡æ¡£ä¸­æœ€ç›¸ä¼¼çš„å…³é”®è¯/çŸ­è¯­ä¸å€™é€‰å…³é”®è¯/çŸ­è¯­è¿›è¡Œç»„åˆï¼Œæ‰¾åˆ°å½¼æ­¤ä¹‹é—´ç›¸ä¼¼æ€§æœ€ä½çš„ç»„åˆï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿å…³é”®è¯ä¹‹é—´çš„å·®å¼‚æ€§MMRæœ€å¤§è¾¹é™…ç›¸å…³æ€§ï¼ˆMaximal Marginal Relevanceï¼ŒMMR)ï¼šé€šè¿‡ä½¿ç”¨ä½™å¼¦ç›¸ä¼¼åº¦æ¥åˆ›å»ºå…³é”®è¯/çŸ­è¯­ï¼ŒåŸºäºç›¸ä¼¼æ€§çš„æ’åºç„¶åï¼Œä»æ’åºåçš„ç»“æœä¸­é€‰æ‹©ä¸æ–‡æ¡£æœ€ç›¸å…³çš„å…³é”®è¯/çŸ­è¯­ï¼Œå¹¶é€‰æ‹©ä¸å·²é€‰æ‹©å…³é”®è¯/çŸ­è¯­æœ€ä¸ç›¸ä¼¼çš„å€™é€‰å…³é”®è¯/çŸ­è¯­ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿ç»“æœå…·æœ‰é«˜åº¦çš„å¤šæ ·æ€§ç¤ºä¾‹KeyBert Quickstartå®‰è£…12345678# é»˜è®¤hugging facepip install keybert# å…¶ä»–åç«¯pip install keybert[flair]pip install keybert[gensim]pip install keybert[spacy]pip install keybert[use]åŸºç¡€KeyBERTåŸºç¡€ç”¨æ³•1234567891011121314151617181920212223242526272829303132333435from keybert import KeyBERTdoc = &quot;&quot;&quot;         Supervised learning is the machine learning task of learning a function that         maps an input to an output based on example input-output pairs.[1] It infers a         function from labeled training data consisting of a set of training examples.[2]         In supervised learning, each example is a pair consisting of an input object         (typically a vector) and a desired output value (also called the supervisory signal).         A supervised learning algorithm analyzes the training data and produces an inferred function,         which can be used for mapping new examples. An optimal scenario will allow for the         algorithm to correctly determine the class labels for unseen instances. This requires         the learning algorithm to generalize from the training data to unseen situations in a         'reasonable' way (see inductive bias).      &quot;&quot;&quot;kw_model = KeyBERT()keywords = kw_model.extract_keywords(doc)# è®¾ç½®keyphrase_ngram_rangeæ¥ç¡®å®šç”Ÿæˆçš„å…³é”®è¯/å…³é”®çŸ­è¯­çš„é•¿åº¦èŒƒå›´&gt;&gt;&gt; kw_model.extract_keywords(doc, keyphrase_ngram_range=(1, 1), stop_words=None)[('learning', 0.4604), ('algorithm', 0.4556), ('training', 0.4487), ('class', 0.4086), ('mapping', 0.3700)]# è¦æå–å…³é”®çŸ­è¯­ï¼Œåªéœ€å°†keyphrase_ngram_rangeè®¾ç½®ä¸º(1, 2)æˆ–æ›´é«˜ï¼Œå…·ä½“å–å†³äºæ‚¨å¸Œæœ›åœ¨ç”Ÿæˆçš„å…³é”®çŸ­è¯­ä¸­åŒ…å«çš„å•è¯æ•°é‡&gt;&gt;&gt; kw_model.extract_keywords(doc, keyphrase_ngram_range=(1, 2), stop_words=None)[('learning algorithm', 0.6978), ('machine learning', 0.6305), ('supervised learning', 0.5985), ('algorithm analyzes', 0.5860), ('learning function', 0.5850)]# è®¾ç½®highlightæ¥åœ¨æ–‡æ¡£ä¸­çªå‡ºæ˜¾ç¤ºå…³é”®è¯keywords = kw_model.extract_keywords(doc, highlight=True)å…³é”®è¯å¤šæ ·åŒ–é»˜è®¤æƒ…å†µä¸‹ï¼ŒKeyBERTä»…åŸºäºä½™å¼¦ç›¸ä¼¼åº¦æ¯”è¾ƒæ–‡æ¡£å’Œå€™é€‰å…³é”®è¯/å…³é”®çŸ­è¯­ã€‚ç„¶è€Œï¼Œè¿™å¯èƒ½å¯¼è‡´éå¸¸ç›¸ä¼¼çš„å•è¯å‡ºç°åœ¨æœ€å‡†ç¡®çš„å…³é”®è¯/å…³é”®çŸ­è¯­åˆ—è¡¨ä¸­ä¸ºäº†ç¡®ä¿å®ƒä»¬æ›´åŠ å¤šæ ·åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡å–ä¸¤ç§æ–¹æ³•æ¥å¾®è°ƒè¾“å‡ºç»“æœï¼Œå³æœ€å¤§æ€»è·ç¦»(Max Sum Distance)å’Œæœ€å¤§è¾¹é™…ç›¸å…³æ€§(Maximal Marginal Relevance)æœ€å¤§æ€»è·ç¦»: ä¸ºäº†ä½¿ç»“æœå¤šæ ·åŒ–ï¼Œæˆ‘ä»¬é€‰å–æ–‡æ¡£ä¸­ä¸å‰top_nä¸ªæœ€ç›¸ä¼¼çš„å•è¯/çŸ­è¯­ã€‚ç„¶åï¼Œæˆ‘ä»¬ä»è¿™2 x top_nä¸ªå•è¯ä¸­é€‰å–æ‰€æœ‰top_nä¸ªç»„åˆï¼Œå¹¶æå–å½¼æ­¤ä¹‹é—´æœ€ä¸ç›¸ä¼¼çš„ç»„åˆï¼Œé€šè¿‡ä½™å¼¦ç›¸ä¼¼åº¦è¿›è¡Œæ¯”è¾ƒ1234567&gt;&gt;&gt; kw_model.extract_keywords(doc, keyphrase_ngram_range=(3, 3), stop_words='english',                              use_maxsum=True, nr_candidates=20, top_n=5)[('set training examples', 0.7504), ('generalize training data', 0.7727), ('requires learning algorithm', 0.5050), ('supervised learning algorithm', 0.3779), ('learning machine learning', 0.2891)]æœ€å¤§è¾¹é™…ç›¸å…³æ€§: ä¸ºäº†ä½¿ç»“æœå¤šæ ·åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æœ€å¤§è¾¹é™…ç›¸å…³æ€§ï¼ˆMaximal Marginal Relevanceï¼ŒMMRï¼‰æ¥åˆ›å»ºå…³é”®è¯/å…³é”®çŸ­è¯­ï¼Œå®ƒä¹ŸåŸºäºä½™å¼¦ç›¸ä¼¼åº¦1234567891011121314151617# å…·æœ‰é«˜å¤šæ ·æ€§çš„ç»“æœkw_model.extract_keywords(doc, keyphrase_ngram_range=(3, 3), stop_words='english',                          use_mmr=True, diversity=0.7)[('algorithm generalize training', 0.7727), ('labels unseen instances', 0.1649), ('new examples optimal', 0.4185), ('determine class labels', 0.4774), ('supervised learning algorithm', 0.7502)]# å…·æœ‰ä½å¤šæ ·æ€§çš„ç»“æœ&gt;&gt;&gt; kw_model.extract_keywords(doc, keyphrase_ngram_range=(3, 3), stop_words='english',                              use_mmr=True, diversity=0.2)[('algorithm generalize training', 0.7727), ('supervised learning algorithm', 0.7502), ('learning machine learning', 0.7577), ('learning algorithm analyzes', 0.7587), ('learning algorithm generalize', 0.7514)]å…¶ä»–å…³é”®è¯ç®—æ³•ç”Ÿæˆçš„å€™é€‰å…³é”®è¯åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ‚¨å¯èƒ½å¸Œæœ›ä½¿ç”¨å…¶ä»–å…³é”®è¯ç®—æ³•ç”Ÿæˆçš„å€™é€‰å…³é”®è¯æˆ–ä»å¯èƒ½çš„å…³é”®è¯/å…³é”®çŸ­è¯­åˆ—è¡¨ä¸­æ£€ç´¢çš„å€™é€‰å…³é”®è¯åœ¨KeyBERTä¸­ï¼Œæ‚¨å¯ä»¥è½»æ¾ä½¿ç”¨è¿™äº›å€™é€‰å…³é”®è¯è¿›è¡Œå…³é”®è¯æå–1234567891011import yakefrom keybert import KeyBERT# Create candidateskw_extractor = yake.KeywordExtractor(top=50)candidates = kw_extractor.extract_keywords(doc)candidates = [candidate[0] for candidate in candidates]# Pass candidates to KeyBERTkw_model = KeyBERT()keywords = kw_model.extract_keywords(doc, candidates=candidates)Guided KeyBERTGuided KeyBERT(å¼•å¯¼å¼KeyBERT)ä¸å¼•å¯¼å¼ä¸»é¢˜å»ºæ¨¡ç±»ä¼¼ï¼Œå®ƒè¯•å›¾å°†è®­ç»ƒå¼•å¯¼åˆ°ä¸€ç»„ç§å­æœ¯è¯­ä¸Šã€‚å½“åº”ç”¨KeyBERTæ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨æå–ä¸ç‰¹å®šæ–‡æ¡£æœ€ç›¸å…³çš„å…³é”®è¯ã€‚ç„¶è€Œï¼Œæœ‰æ—¶åˆ©ç›Šç›¸å…³è€…å’Œç”¨æˆ·æ­£åœ¨å¯»æ‰¾ç‰¹å®šç±»å‹çš„å…³é”®è¯ã€‚ä¾‹å¦‚ï¼Œå½“é€šè¿‡contentfulåœ¨æ‚¨çš„ç½‘ç«™ä¸Šå‘å¸ƒä¸€ç¯‡æ–‡ç« æ—¶ï¼Œæ‚¨é€šå¸¸å·²ç»äº†è§£ä¸è¯¥æ–‡ç« ç›¸å…³çš„å…¨å±€å…³é”®è¯ã€‚ä½†æ˜¯ï¼Œæ–‡ç« ä¸­å¯èƒ½å­˜åœ¨æ‚¨å¸Œæœ›é€šè¿‡å…³é”®è¯æå–å‡ºæ¥çš„ç‰¹å®šä¸»é¢˜ã€‚ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬åªéœ€ç»™KeyBERTæä¾›ä¸€ç»„ç›¸å…³çš„ç§å­å…³é”®è¯(å¯ä»¥æ˜¯å•ä¸ªå…³é”®è¯)ï¼Œå¹¶æœç´¢ä¸æ–‡æ¡£å’Œç§å­å…³é”®è¯éƒ½ç›¸ä¼¼çš„å…³é”®è¯ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½éå¸¸ç®€å•ï¼Œåªéœ€å®šä¹‰ä¸€ä¸ªç§å­å…³é”®è¯åˆ—è¡¨å¹¶å°†å…¶ä¼ é€’ç»™KeyBERTå³å¯123456from keybert import KeyBERTkw_model = KeyBERT()# Define our seeded termseed_keywords = [&quot;information&quot;]keywords = kw_model.extract_keywords(doc, seed_keywords=seed_keywords)å½“ä½ æœ‰ä¸€ä¸ªå¤§å‹æ•°æ®é›†ï¼Œå¹¶ä¸”æƒ³è¦å¾®è°ƒè¯¸å¦‚å¤šæ ·æ€§ä¹‹ç±»çš„å‚æ•°æ—¶ï¼Œæ¯æ¬¡æ›´æ”¹å‚æ•°æ—¶é‡æ–°è®¡ç®—æ–‡æ¡£å’Œå•è¯åµŒå…¥å¯èƒ½éœ€è¦å¾ˆé•¿æ—¶é—´ã€‚ç›¸åï¼Œæˆ‘ä»¬å¯ä»¥é¢„å…ˆè®¡ç®—è¿™äº›åµŒå…¥ï¼Œå¹¶å°†å®ƒä»¬ä¼ é€’ç»™.extract_keywordsï¼Œè¿™æ ·æˆ‘ä»¬åªéœ€è®¡ç®—ä¸€æ¬¡å³å¯1234from keybert import KeyBERTkw_model = KeyBERT()doc_embeddings, word_embeddings = kw_model.extract_embeddings(docs)ç„¶åï¼Œä½ å¯ä»¥ä½¿ç”¨è¿™äº›åµŒå…¥å¹¶å°†å®ƒä»¬ä¼ é€’ç»™.extract_keywordsæ¥åŠ å¿«æ¨¡å‹çš„è°ƒæ•´1keywords = kw_model.extract_keywords(docs, doc_embeddings=doc_embeddings, word_embeddings=word_embeddings).extract_embeddingsä¸­æœ‰å‡ ä¸ªå‚æ•°å®šä¹‰äº†å¦‚ä½•ç”Ÿæˆå€™é€‰å…³é”®è¯/å…³é”®çŸ­è¯­çš„åˆ—è¡¨ï¼šcandidateskeyphrase_ngram_rangestop_wordsmin_dfvectorizerè¿™äº›å‚æ•°çš„å€¼åœ¨.extract_embeddingså’Œ.extract_keywordsä¸­éœ€è¦å®Œå…¨ç›¸åŒï¼Œæ¢å¥è¯è¯´ï¼Œä»¥ä¸‹å†…å®¹å°†èµ·ä½œç”¨ï¼Œå› ä¸ºå®ƒä»¬ä½¿ç”¨ç›¸åŒçš„å‚æ•°å­é›†1234567from keybert import KeyBERTkw_model = KeyBERT()doc_embeddings, word_embeddings = kw_model.extract_embeddings(docs, min_df=1, stop_words=&quot;english&quot;)keywords = kw_model.extract_keywords(docs, min_df=1, stop_words=&quot;english&quot;,                                      doc_embeddings=doc_embeddings,                                      word_embeddings=word_embeddings)ç„¶è€Œï¼Œä»¥ä¸‹å†…å®¹å°†æŠ›å‡ºé”™è¯¯ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰ä¸ºmin_dfå’Œstop_wordsä½¿ç”¨ç›¸åŒçš„å€¼1234567from keybert import KeyBERTkw_model = KeyBERT()doc_embeddings, word_embeddings = kw_model.extract_embeddings(docs, min_df=3, stop_words=&quot;dutch&quot;)keywords = kw_model.extract_keywords(docs, min_df=1, stop_words=&quot;english&quot;,                                      doc_embeddings=doc_embeddings,                                      word_embeddings=word_embeddings)æ‘˜è¦æå–ç­‰å¾…â€¦ç”Ÿæˆå¼ + æŠ½å–å¼</content>
	</entry>
	<entry>
		<title>LLMæ¨¡å‹å¾®è°ƒç³»åˆ—</title>
		<url>/article/59381.html</url>
		<content>LLMæ¨¡å‹ä»€ä¹ˆæ˜¯LLMï¼ˆå¤§è¯­éŸ³æ¨¡å‹ï¼‰æ¦‚è¿°Large Language Model(LLM)ï¼Œä¹Ÿç§°ä¸ºå¤§å‹è¯­è¨€æ¨¡å‹ï¼Œæ˜¯ä¸€ç§åŸºäºæœºå™¨å­¦ä¹ å’Œè‡ªç„¶è¯­è¨€å¤„ç†æŠ€æœ¯çš„æ¨¡å‹ï¼Œå®ƒé€šè¿‡å¯¹å¤§é‡çš„æ–‡æœ¬æ•°æ®è¿›è¡Œè®­ç»ƒï¼Œæ¥å­¦ä¹ æœåŠ¡äººç±»è¯­è¨€ç†è§£å’Œç”Ÿæˆçš„èƒ½åŠ›LLMçš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡å¤§è§„æ¨¡çš„æ— ç›‘ç£è®­ç»ƒæ¥å­¦ä¹ è‡ªç„¶è¯­è¨€çš„æ¨¡å¼å’Œè¯­è¨€ç»“æ„ï¼Œè¿™åœ¨ä¸€å®šç¨‹åº¦ä¸Šèƒ½å¤Ÿæ¨¡æ‹Ÿäººç±»çš„è¯­è¨€è®¤çŸ¥å’Œç”Ÿæˆè¿‡ç¨‹ä¸ä¼ ç»Ÿçš„NLPæ¨¡å‹ç›¸æ¯”ï¼ŒLLMèƒ½å¤Ÿæ›´å¥½åœ°ç†è§£å’Œç”Ÿæˆè‡ªç„¶æ–‡æœ¬ï¼ŒåŒæ—¶è¿˜èƒ½å¤Ÿè¡¨ç°å‡ºä¸€å®šçš„é€»è¾‘æ€ç»´å’Œæ¨ç†èƒ½åŠ›è¿‘å¹´æ¥ï¼ŒLLMå¾—åˆ°äº†å¹¿æ³›çš„åº”ç”¨ï¼Œå…¶ä¸­æœ€å…·ä»£è¡¨æ€§çš„æ˜¯è°·æ­Œçš„BERTå’ŒOpenAIçš„GPTç³»åˆ—ã€‚è¿™äº›æ¨¡å‹åœ¨å¤šä¸ªè‡ªç„¶è¯­è¨€å¤„ç†é¢†åŸŸå·²ç»å–å¾—äº†æ˜¾è‘—çš„æˆæœï¼ŒåŒ…æ‹¬æ–‡æœ¬åˆ†ç±»ã€å‘½åå®ä½“è¯†åˆ«ã€æƒ…æ„Ÿåˆ†æã€æœºå™¨ç¿»è¯‘ã€è‡ªåŠ¨é—®ç­”ç­‰ç„¶è€Œï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼ŒLLMé¢ä¸´ç€æ›´å¤šçš„æŒ‘æˆ˜é¦–å…ˆï¼ŒLLMéœ€è¦å¤§é‡çš„è®¡ç®—èµ„æºå’Œå¤§è§„æ¨¡çš„æ•°æ®é›†æ¥è®­ç»ƒï¼Œè¿™å¯¹äºä¸€èˆ¬çš„ä¼ä¸šå’Œä¸ªäººæ¥è¯´ååˆ†å›°éš¾å…¶æ¬¡ï¼Œç”±äºLLMæ¨¡å‹çš„å¤æ‚æ€§å’Œè®¡ç®—é‡è¾ƒå¤§ï¼Œå¯¹äºå®æ—¶çš„è¯­è¨€å¤„ç†åº”ç”¨æ¥è¯´ï¼ŒLLMåœ¨åº”ç”¨æ•ˆç‡å’Œå“åº”é€Ÿåº¦ä¸Šè¿˜å­˜åœ¨ä¸€å®šçš„å±€é™æ€§å› æ­¤ï¼Œå¦‚ä½•è§£å†³æ¨¡å‹è®­ç»ƒå’Œåº”ç”¨è¿‡ç¨‹ä¸­çš„è®¡ç®—æ€§èƒ½å’Œæ•ˆç‡é—®é¢˜ï¼Œæ˜¯LLMé¢ä¸´çš„ä¸»è¦æŒ‘æˆ˜ä¹‹ä¸€å¾®è°ƒLLMå¤§æ¨¡å‹ä½èµ„æºå¾®è°ƒp tuning v2å’ŒloraåŒºåˆ«prefix, p-tuningv2, lora finetuneè¯¥æ€ä¹ˆé€‰æ‹©?è®©å¤©ä¸‹æ²¡æœ‰éš¾Tuningçš„å¤§æ¨¡å‹ï¼šPEFTæŠ€æœ¯ç®€ä»‹ 2023-04å¾®è°ƒ(Fine-tuning)æ˜¯ä¸€ç§å¸¸ç”¨çš„æŠ€æœ¯ï¼Œç”¨äºå°†é¢„è®­ç»ƒçš„è¯­è¨€æ¨¡å‹é€‚åº”äºç‰¹å®šçš„ä»»åŠ¡æˆ–é¢†åŸŸã€‚å¾®è°ƒçš„ç›®çš„æ˜¯é€šè¿‡åœ¨ç‰¹å®šä»»åŠ¡ä¸Šè¿›è¡Œæœ‰ç›‘ç£çš„è®­ç»ƒï¼Œè°ƒæ•´æ¨¡å‹å‚æ•°ä»¥æé«˜å…¶æ€§èƒ½å’Œé€‚åº”æ€§ä»¥ä¸‹æ˜¯å¾®è°ƒåœ¨é€‚åº”è¯­è¨€æ¨¡å‹ä¸­çš„æœ‰æ•ˆæ€§çš„å‡ ä¸ªåŸå› ï¼šè¿ç§»å­¦ä¹ ï¼šé¢„è®­ç»ƒçš„è¯­è¨€æ¨¡å‹åœ¨å¤§è§„æ¨¡æ–‡æœ¬æ•°æ®ä¸Šè¿›è¡Œäº†æ— ç›‘ç£çš„å­¦ä¹ ï¼Œä»ä¸­å­¦ä¹ åˆ°äº†é€šç”¨çš„è¯­è¨€è¡¨ç¤ºã€‚é€šè¿‡å¾®è°ƒï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™äº›é€šç”¨çš„è¯­è¨€è¡¨ç¤ºè¿ç§»åˆ°ç‰¹å®šä»»åŠ¡æˆ–é¢†åŸŸä¸Šï¼Œå› æ­¤å¯ä»¥åˆ©ç”¨æ¨¡å‹åœ¨é¢„è®­ç»ƒé˜¶æ®µå­¦åˆ°çš„çŸ¥è¯†å°‘æ ·æœ¬å­¦ä¹ ï¼šå¾®è°ƒé€šå¸¸åªéœ€è¦åœ¨ç‰¹å®šä»»åŠ¡çš„ç›¸å¯¹è¾ƒå°çš„æ ‡æ³¨æ•°æ®é›†ä¸Šè¿›è¡Œè®­ç»ƒï¼Œè€Œä¸æ˜¯ä»å¤´å¼€å§‹è®­ç»ƒä¸€ä¸ªå…¨æ–°çš„æ¨¡å‹ã€‚è¿™å¯¹äºè®¸å¤šä»»åŠ¡æ¥è¯´æ˜¯éå¸¸æœ‰ç›Šçš„ï¼Œå› ä¸ºè·å¾—å¤§è§„æ¨¡æ ‡æ³¨æ•°æ®å¯èƒ½æ˜¯æ˜‚è´µæˆ–å›°éš¾çš„ã€‚é€šè¿‡åˆ©ç”¨é¢„è®­ç»ƒæ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ï¼Œå¾®è°ƒå¯ä»¥åœ¨å°‘é‡æ ‡æ³¨æ ·æœ¬ä¸Šå®ç°è¾ƒå¥½çš„æ€§èƒ½é¢†åŸŸè‡ªé€‚åº”ï¼šé€šè¿‡å¾®è°ƒï¼Œå¯ä»¥å°†è¯­è¨€æ¨¡å‹ä»é€šç”¨é¢†åŸŸé€‚åº”åˆ°ç‰¹å®šé¢†åŸŸã€‚é€šè¿‡åœ¨ç‰¹å®šé¢†åŸŸçš„æ•°æ®ä¸Šå¾®è°ƒï¼Œæ¨¡å‹å¯ä»¥å­¦ä¹ åˆ°è¯¥é¢†åŸŸçš„ç‰¹å®šè¯­è¨€æ¨¡å¼ã€è¯æ±‡å’Œä¸Šä¸‹æ–‡ï¼Œä»è€Œæé«˜åœ¨è¯¥é¢†åŸŸä»»åŠ¡ä¸Šçš„æ€§èƒ½æ¨¡å‹ä¸ªæ€§åŒ–ï¼šå¾®è°ƒè¿˜å¯ä»¥ç”¨äºä¸ªæ€§åŒ–æ¨¡å‹ï¼Œä»¥é€‚åº”ç‰¹å®šç”¨æˆ·æˆ–ç‰¹å®šåº”ç”¨åœºæ™¯çš„éœ€æ±‚ã€‚é€šè¿‡å¾®è°ƒæ¨¡å‹ï¼Œå¯ä»¥æ ¹æ®ä¸ªä½“ç”¨æˆ·çš„åå¥½ã€è¡Œä¸ºæˆ–æ•°æ®ç‰¹ç‚¹è¿›è¡Œå®šåˆ¶ï¼Œæä¾›æ›´å‡†ç¡®å’Œä¸ªæ€§åŒ–çš„é¢„æµ‹å’Œæ¨èå¾®è°ƒè¯­è¨€æ¨¡å‹æ˜¯ä¸€ç§æœ‰æ•ˆçš„æ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡è¿ç§»å­¦ä¹ ã€å°‘æ ·æœ¬å­¦ä¹ ã€é¢†åŸŸè‡ªé€‚åº”å’Œæ¨¡å‹ä¸ªæ€§åŒ–ç­‰æ–¹å¼ï¼Œåˆ©ç”¨é¢„è®­ç»ƒæ¨¡å‹çš„ä¼˜åŠ¿å’Œæ³›åŒ–èƒ½åŠ›ï¼Œæé«˜æ¨¡å‹åœ¨ç‰¹å®šä»»åŠ¡æˆ–é¢†åŸŸä¸Šçš„æ€§èƒ½å’Œé€‚åº”æ€§ä¸ºä»€ä¹ˆéœ€è¦å¾®è°ƒé«˜æ•ˆè®­ç»ƒï¼Œå‡å°‘è®­ç»ƒæˆæœ¬å…±äº«åŸºç¡€å¤§æ¨¡å‹ï¼Œåœ¨ä¸Šé¢å åŠ è‡ªå·±çš„æ–°æ¨¡å‹å‘å±•è„‰ç»œAdapterç³»åˆ—AdapterFusion: Non-Destructive Task Composition for Transfer Learning 2021Lexicon Enhanced Chinese Sequence Labeling Using BERT Adapter 2021LLaMA-Adapter: Efficient Fine-tuning of Language Models with Zero-init Attention 2023LLaMA-Adapter V2: Parameter-Efficient Visual Instruction Model 2023github LLaMA-Adapter: Efficient Fine-tuning of LLaMAp-tunningç³»åˆ—Prefix-Tuning: Optimizing Continuous Prompts for Generation 2021The Power of Scale for Parameter-Efficient Prompt Tuning 2021P-Tuning - GPT Understands, Too 2021P-Tuning v2: Prompt Tuning Can Be Comparable to Fine-tuning Universally Across Scales and Tasks 2022loraç³»åˆ—LORA: LOW-RANK ADAPTATION OF LARGE LANGUAGE MODELS 2021AdaLoRA Adaptive Budget Allocation for Parameter-Efficient Fine-Tuning 2023QLORA: Efficient Finetuning of Quantized LLM 2023å¦å¤–huggingfaceå¾ˆè´´å¿ƒçš„æŠŠå¸¸è§çš„fine-Tuningæ–¹æ³•éƒ½åšäº†é›†æˆï¼Œåªç”¨å‡ è¡Œä»£ç å°±å¯æ·»åŠ å’Œä¿®æ”¹ï¼Œååˆ†æ–¹ä¾¿ï¼Œè¿˜æœ‰å¾®è½¯æä¾›çš„åŠ é€Ÿåº“huggingfaceå®˜ç½‘å®ç°çš„fine-Tuningæ–¹æ³•microsoft/DeepSpeed åŠ é€Ÿè§£å¯†Promptç³»åˆ—3. å†»ç»“LMå¾®è°ƒPrompt: Prefix-Tuning &amp; Prompt-Tuning &amp; P-Tuningå¾®è°ƒLMå’Œå…¨éƒ¨å†»ç»“çš„promptæ¨¡æ¿ç›¸æ¯”ï¼Œå¾®è°ƒPromptèŒƒå¼æœ€å¤§çš„åŒºåˆ«å°±æ˜¯promptæ¨¡æ¿éƒ½æ˜¯è¿ç»­å‹(Embedding)ï¼Œè€Œéå’ŒTokenå¯¹åº”çš„ç¦»æ•£å‹æ¨¡æ¿æ ¸å¿ƒåœ¨äºæˆ‘ä»¬å¹¶ä¸å…³å¿ƒpromptæœ¬èº«æ˜¯å¦æ˜¯è‡ªç„¶è¯­è¨€ï¼Œåªå…³å¿ƒpromptä½œä¸ºæ¢é’ˆèƒ½å¦å¼•å¯¼å‡ºé¢„è®­ç»ƒæ¨¡å‹åœ¨ä¸‹æ¸¸ä»»åŠ¡ä¸Šçš„ç‰¹å®šèƒ½åŠ›å›ºå®šLMå¾®è°ƒPromptçš„èŒƒå¼æœ‰ä»¥ä¸‹å‡ ä¸ªä¼˜ç‚¹æ€§ä»·æ¯”é«˜: å¾®è°ƒå‚æ•°å°‘ï¼Œå†»ç»“LMåªå¾®è°ƒpromptéƒ¨åˆ†çš„å‚æ•°æ— äººå·¥å‚ä¸: æ— éœ€äººå·¥è®¾è®¡promptæ¨¡æ¿ï¼Œä¾èµ–æ¨¡å‹å¾®è°ƒå³å¯å¤šä»»åŠ¡å…±äº«æ¨¡å‹: å› ä¸ºLMè¢«å†»ç»“ï¼Œåªéœ€è®­ç»ƒé’ˆå¯¹ä¸åŒä»»åŠ¡çš„promptå³å¯ã€‚å› æ­¤å¯ä»¥å›ºå®šé¢„è®­ç»ƒæ¨¡å‹ï¼Œæ‹”æ’å¼åŠ å…¥Promptç”¨äºä¸åŒä¸‹æ¸¸ä»»åŠ¡Prefix/Prompt-TuningPrefix-Tuningç­‰å¾…â€¦Prefix-Tuningå¯ä»¥ç†è§£æ˜¯CTRL[1]æ¨¡å‹çš„è¿ç»­åŒ–å‡çº§ç‰ˆï¼Œä¸ºäº†ç”Ÿæˆä¸åŒé¢†åŸŸå’Œè¯é¢˜çš„æ–‡æœ¬ï¼ŒCTRLæ˜¯åœ¨é¢„è®­ç»ƒé˜¶æ®µåœ¨è¾“å…¥æ–‡æœ¬å‰åŠ å…¥äº†control codeï¼Œä¾‹å¦‚å¥½è¯„å‰é¢åŠ â€™Reviews Rating:5.0â€™,å·®è¯„å‰é¢åŠ â€™Reviews Rating:1.0â€™, æ”¿æ²»è¯„è®ºå‰é¢åŠ â€˜Politics Title:â€™ï¼ŒæŠŠè¯­è¨€æ¨¡å‹çš„ç”Ÿæˆæ¦‚ç‡ï¼Œä¼˜åŒ–æˆäº†åŸºäºæ–‡æœ¬ä¸»é¢˜çš„æ¡ä»¶æ¦‚ç‡Prefix-Tuningè¿›ä¸€æ­¥æŠŠcontrol codeä¼˜åŒ–æˆäº†è™šæ‹ŸTokenï¼Œæ¯ä¸ªNLPä»»åŠ¡å¯¹åº”å¤šä¸ªè™šæ‹ŸTokençš„Embeddingï¼ˆprefixï¼‰ï¼Œå¯¹äºDecoder-Onlyçš„GPTï¼ŒprefixåªåŠ åœ¨å¥é¦–ï¼Œå¯¹äºEncoder-Decoderçš„BARTï¼Œä¸åŒçš„prefixåŒæ—¶åŠ åœ¨ç¼–ç å™¨å’Œè§£ç å™¨çš„å¼€å¤´ã€‚åœ¨ä¸‹æ¸¸å¾®è°ƒæ—¶ï¼ŒLMçš„å‚æ•°è¢«å†»ç»“ï¼Œåªæœ‰prefixéƒ¨åˆ†çš„å‚æ•°è¿›è¡Œæ›´æ–°ã€‚ä¸è¿‡è¿™é‡Œçš„prefixå‚æ•°ä¸åªåŒ…æ‹¬embeddingå±‚è€Œæ˜¯è™šæ‹Ÿtokenä½ç½®å¯¹åº”çš„æ¯ä¸€å±‚çš„activationéƒ½è¿›è¡Œæ›´æ–°Prompt-Tuninghttps://github.com/google-research/prompt-tuningç­‰å¾…â€¦Prompt-Tunningæ˜¯ä»¥ä¸Šprefix-Tunningçš„ç®€åŒ–ç‰ˆæœ¬ï¼Œé¢å‘NLUä»»åŠ¡ï¼Œè¿›è¡Œäº†æ›´å…¨é¢çš„æ•ˆæœå¯¹æ¯”ï¼Œå¹¶ä¸”åœ¨å¤§æ¨¡å‹ä¸ŠæˆåŠŸæ‰“å¹³äº†LMå¾®è°ƒçš„æ•ˆæœå¯¹æ¯”Prefix-Tunningï¼Œprompt-tuningçš„ä¸»è¦å·®å¼‚å¦‚ä¸‹:è®ºæ–‡ä½¿ç”¨100ä¸ªprefix tokenä½œä¸ºé»˜è®¤å‚æ•°ï¼Œå¤§äºä»¥ä¸Šprefix-tuningé»˜è®¤çš„10ä¸ªtokenï¼Œä¸è¿‡å·®å¼‚åœ¨äºprompt-Tunningåªå¯¹è¾“å…¥å±‚(Embedding)è¿›è¡Œå¾®è°ƒï¼Œè€ŒPrefixæ˜¯å¯¹è™šæ‹ŸTokenå¯¹åº”çš„ä¸Šæ¸¸layerå…¨éƒ¨è¿›è¡Œå¾®è°ƒã€‚å› æ­¤Prompt-Tunningçš„å¾®è°ƒå‚æ•°é‡çº§è¦æ›´å°ï¼Œä¸”ä¸éœ€è¦ä¿®æ”¹åŸå§‹æ¨¡å‹ç»“æ„ï¼Œè¿™æ˜¯â€œç®€åŒ–â€çš„æ¥æºã€‚ç›¸åŒçš„prefixé•¿åº¦ï¼ŒPrompt-Tunning(&lt;0.01%)å¾®è°ƒçš„å‚æ•°é‡çº§è¦æ¯”Prefix-Tunning(0.1%~1%)å°10å€ä»¥ä¸ŠP-TuningP-Tuning V1github THUDM/P-tuningæ‰‹åŠ¨å°è¯•æœ€ä¼˜çš„æç¤ºæ— å¼‚äºå¤§æµ·æé’ˆï¼Œäºæ˜¯ä¾¿æœ‰äº†è‡ªåŠ¨ç¦»æ•£æç¤ºæœç´¢çš„æ–¹æ³•(å·¦å›¾)ï¼Œä½†æç¤ºæ˜¯ç¦»æ•£çš„ï¼Œç¥ç»ç½‘ç»œæ˜¯è¿ç»­çš„ï¼Œæ‰€ä»¥å¯»æ‰¾çš„æœ€ä¼˜æç¤ºå¯èƒ½æ˜¯æ¬¡ä¼˜çš„ã€‚p-tuningä¾ç„¶æ˜¯å›ºå®šLLMå‚æ•°ï¼Œåˆ©ç”¨å¤šå±‚æ„ŸçŸ¥æœºå’ŒLSTMå¯¹promptè¿›è¡Œç¼–ç ï¼Œç¼–ç ä¹‹åä¸å…¶ä»–å‘é‡è¿›è¡Œæ‹¼æ¥ä¹‹åæ­£å¸¸è¾“å…¥LLMã€‚æ³¨æ„ï¼Œè®­ç»ƒä¹‹ååªä¿ç•™promptç¼–ç ä¹‹åçš„å‘é‡å³å¯ï¼Œæ— éœ€ä¿ç•™ç¼–ç å™¨åŠ¨æœºä¸€ä¸ªåˆ»æ¿å°è±¡æ˜¯GPTä¸é€‚åˆç†è§£ç±»ä»»åŠ¡ï¼Œè¿™ç¯‡å°±æ˜¯å»æ€è€ƒè¿™ç§åˆ»æ¿å°è±¡æ˜¯å¦æ­£ç¡®GPT-3é‡‡ç”¨äººå·¥æ„é€ çš„æ¨¡ç‰ˆæ¥åšin context learningï¼Œäººå·¥è®¾è®¡çš„æ¨¡ç‰ˆçš„å˜åŒ–ç‰¹åˆ«æ•æ„Ÿï¼ŒåŠ ä¸€ä¸ªè¯æˆ–è€…å°‘ä¸€ä¸ªè¯ï¼Œæˆ–è€…å˜åŠ¨ä½ç½®å•¥çš„éƒ½ä¼šé€ æˆæ¯”è¾ƒå¤§çš„å˜åŒ–ï¼ˆè¿™é‡Œä½œè€…åšäº†ä¸€ä¸ªç®€å•çš„éªŒè¯å®éªŒï¼Œå…·ä½“çœ‹è®ºæ–‡ï¼‰ã€‚è¿‘æ¥çš„è‡ªåŠ¨åŒ–æœç´¢æ¨¡ç‰ˆå·¥ä½œæˆæœ¬ä¹Ÿæ¯”è¾ƒé«˜ï¼ŒåŒæ—¶ä»¥å‰è¿™ç§ç¦»æ•£åŒ–çš„tokençš„æœç´¢å‡ºæ¥çš„ç»“æœå¯èƒ½å¹¶ä¸æ˜¯æœ€ä¼˜çš„å’Œprefix-tuningå·®ä¸å¤šï¼Œåæ­£æ˜¯åŸºäºè¿™ä¸¤ç‚¹å»è®¾è®¡äº†ä¸€ç§è¿ç»­å¯å¾®çš„æ¨¡ç‰ˆç›¸æ¯”prefix-tuningï¼Œè¿™é‡ŒåŠ äº†å¯å¾®çš„virtual tokenï¼Œä½†æ˜¯ä»…é™äºè¾“å…¥ï¼Œæ²¡æœ‰åœ¨æ¯å±‚åŠ ï¼›å¦å¤–virtual tokençš„ä½ç½®ä¹Ÿä¸ä¸€å®šæ˜¯å‰ç¼€ï¼Œæ’å…¥çš„ä½ç½®æ˜¯å¯é€‰çš„ã€‚è¿™é‡Œçš„å‡ºå‘ç‚¹å®é™…æ˜¯æŠŠä¼ ç»Ÿäººå·¥è®¾è®¡æ¨¡ç‰ˆä¸­çš„çœŸå®tokenæ›¿æ¢æˆå¯å¾®çš„virtual tokenP-Tuning V2github THUDM/P-tuning-v2P-tuning V2è®ºæ–‡å’Œä»£ç å®ç°è¯¦è§£æ¦‚è¿°ä»£ç ç¤ºä¾‹PrefixEncoderç±»ï¼Œä¸ºäº†è·å¾—è¿ç»­promptï¼Œè®¾è®¡çš„æ¨¡å—1234567891011121314151617181920212223242526272829303132import torchclass PrefixEncoder(torch.nn.Module):    r'''    The torch.nn model to encode the prefix    Input shape: (batch-size, prefix-length)    Output shape: (batch-size, prefix-length, 2*layers*hidden)    '''    def __init__(self, config):        super().__init__()        self.prefix_projection = config.prefix_projection        if self.prefix_projection:            # Use a two-layer MLP to encode the prefix            self.embedding = torch.nn.Embedding(config.pre_seq_len, config.hidden_size)            self.trans = torch.nn.Sequential(                torch.nn.Linear(config.hidden_size, config.prefix_hidden_size),                torch.nn.Tanh(),                torch.nn.Linear(config.prefix_hidden_size, config.num_hidden_layers * 2 * config.hidden_size)            )        else:            self.embedding = torch.nn.Embedding(config.pre_seq_len, config.num_hidden_layers * 2 * config.hidden_size)    def forward(self, prefix: torch.Tensor):        if self.prefix_projection:            prefix_tokens = self.embedding(prefix)            past_key_values = self.trans(prefix_tokens)        else:            past_key_values = self.embedding(prefix)        return past_key_values&gt;1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192class BertPrefixForTokenClassification(BertPreTrainedModel):    def __init__(self, config):        super().__init__(config)        self.num_labels = config.num_labels        self.bert = BertModel(config, add_pooling_layer=False)        self.dropout = torch.nn.Dropout(config.hidden_dropout_prob)        self.classifier = torch.nn.Linear(config.hidden_size, config.num_labels)        from_pretrained = False        if from_pretrained:            self.classifier.load_state_dict(torch.load('model/checkpoint.pkl'))        for param in self.bert.parameters():            param.requires_grad = False        self.pre_seq_len = config.pre_seq_len        self.n_layer = config.num_hidden_layers        self.n_head = config.num_attention_heads        self.n_embd = config.hidden_size // config.num_attention_heads        self.prefix_tokens = torch.arange(self.pre_seq_len).long()        self.prefix_encoder = PrefixEncoder(config)        bert_param = 0        for name, param in self.bert.named_parameters():            bert_param += param.numel()        all_param = 0        for name, param in self.named_parameters():            all_param += param.numel()        total_param = all_param - bert_param        print('total param is {}'.format(total_param))  # 9860105    def get_prompt(self, batch_size):        prefix_tokens = self.prefix_tokens.unsqueeze(0).expand(batch_size, -1).to(self.bert.device)        # å¾—åˆ°è¿ç»­Prompt        past_key_values = self.prefix_encoder(prefix_tokens)        # bsz, seqlen, _ = past_key_values.shape        # æ”¹å˜å½¢çŠ¶        past_key_values = past_key_values.view(            batch_size,            self.pre_seq_len,            self.n_layer * 2,            self.n_head,            self.n_embd        )        past_key_values = self.dropout(past_key_values)        # æ”¹å˜å½¢çŠ¶ï¼Œåˆ’åˆ†æˆæ•°ç»„ã€‚æ¯ä¸€ä¸ªæ•°ç»„å…ƒç´ å½¢çŠ¶ä¸ºï¼š(2,batch_size,n_head,seq_len,head_dim)        past_key_values = past_key_values.permute([2, 0, 3, 1, 4]).split(2)        return past_key_values    def forward(            self,            input_ids=None,            attention_mask=None,            token_type_ids=None,            position_ids=None,            head_mask=None,            inputs_embeds=None,            labels=None,            output_attentions=None,            output_hidden_states=None,            return_dict=None,    ):        return_dict = return_dict if return_dict is not None else self.config.use_return_dict        batch_size = input_ids.shape[0]        past_key_values = self.get_prompt(batch_size=batch_size)        prefix_attention_mask = torch.ones(batch_size, self.pre_seq_len).to(self.bert.device)        attention_mask = torch.cat((prefix_attention_mask, attention_mask), dim=1)        # å¼€å§‹ä¼ é€’past_key_values        outputs = self.bert(            input_ids,            attention_mask=attention_mask,            token_type_ids=token_type_ids,            position_ids=position_ids,            head_mask=head_mask,            inputs_embeds=inputs_embeds,            output_attentions=output_attentions,            output_hidden_states=output_hidden_states,            return_dict=return_dict,            past_key_values=past_key_values,        )        ...        return TokenClassifierOutput(            loss=loss,            logits=logits,            hidden_states=outputs.hidden_states,            attentions=outputs.attentions,        )ä¸€æ¬¡å‰å‘è®¡ç®—ä¸­ï¼ŒP-tuning v2ä¼šé€šè¿‡self.get_prompt(batch_size=batch_size)å¾—åˆ°è¦è¿ç»­PromptBertEncoderä¼šæ‰§è¡Œforå¾ªç¯ï¼ŒæŠŠpast_key_valuesæ‹†åˆ†åˆ°ä¸€ä¸ªä¸ªBertLayer12345678910111213self.layer = nn.ModuleList([BertLayer(config) for _ in range(config.num_hidden_layers)])...for i, layer_module in enumerate(self.layer):if output_hidden_states:    all_hidden_states = all_hidden_states + (hidden_states,)    layer_head_mask = head_mask[i] if head_mask is not None else Nonepast_key_value = past_key_values[i] if past_key_values is not None else None...# BertLayerlayer_module(..., past_key_value, ...)å·§å¦™çš„åˆ©ç”¨past_key_valueså‚æ•°ï¼Œå°†past_key_valuesæ•°ç»„ä¸­æ¯ä¸€ä¸ªå…ƒç´ ï¼Œæ‹¼æ¥åˆ°BertSelfAttentionä¸­Keyå’ŒValueä»£ç è·Ÿè¸ªé“¾è·¯BertModel -&gt; BertEncoder -&gt; BertLayer -&gt; BertAttention -&gt; BertSelfAttention1234567891011121314151617181920212223242526272829303132333435363738394041424344454647class BertSelfAttention(nn.Module):...    def transpose_for_scores(self, x: torch.Tensor) -&gt; torch.Tensor:        # å°†å¼ é‡è½¬æ¢å½¢çŠ¶ï¼Œè°ƒæ¢ç»´åº¦ã€‚è¿™ä¸ªä»£ç ä¼šåœ¨seq_lengthç»´åº¦è¿›è¡Œæ‹¼æ¥ï¼Œå…¶ä»–ç»´åº¦ä¸å¯åŠ¨        new_x_shape = x.size()[:-1] + (self.num_attention_heads, self.attention_head_size)        x = x.view(new_x_shape)        return x.permute(0, 2, 1, 3)        def forward(        self,        hidden_states: torch.Tensor,        attention_mask: Optional[torch.FloatTensor] = None,        head_mask: Optional[torch.FloatTensor] = None,        encoder_hidden_states: Optional[torch.FloatTensor] = None,        encoder_attention_mask: Optional[torch.FloatTensor] = None,        past_key_value: Optional[Tuple[Tuple[torch.FloatTensor]]] = None,        output_attentions: Optional[bool] = False,    ) -&gt; Tuple[torch.Tensor]:        mixed_query_layer = self.query(hidden_states)        # If this is instantiated as a cross-attention module, the keys        # and values come from an encoder; the attention mask needs to be        # such that the encoder's padding tokens are not attended to.        is_cross_attention = encoder_hidden_states is not None        if is_cross_attention and past_key_value is not None:            # reuse k,v, cross_attentions            key_layer = past_key_value[0]            value_layer = past_key_value[1]            attention_mask = encoder_attention_mask        elif is_cross_attention:            key_layer = self.transpose_for_scores(self.key(encoder_hidden_states))            value_layer = self.transpose_for_scores(self.value(encoder_hidden_states))            attention_mask = encoder_attention_mask        elif past_key_value is not None:            key_layer = self.transpose_for_scores(self.key(hidden_states))            value_layer = self.transpose_for_scores(self.value(hidden_states))            key_layer = torch.cat([past_key_value[0], key_layer], dim=2)            value_layer = torch.cat([past_key_value[1], value_layer], dim=2)        else:            key_layer = self.transpose_for_scores(self.key(hidden_states))            value_layer = self.transpose_for_scores(self.value(hidden_states))        query_layer = self.transpose_for_scores(mixed_query_layer)                ...è¿™é‡Œå°±ä¼šæŠŠpast_key_valueæ‹¼æ¥åˆ°äº†åŸå§‹çš„kã€vä¸Šé¢ï¼Œè¿™æ ·å­å°±ç›¸å½“äºç»™kã€væ·»åŠ äº†é¢å¤–éœ€è¦å­¦ä¹ çš„å‚æ•°äº†ï¼Œå†å¾®è°ƒæ—¶åªæ›´æ–°è¿™éƒ¨åˆ†æ–°çš„å‚æ•°å³å¯P-tuning V2è¿ç»­Promptä»£ç å®ç°ä»¿çœŸä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778#!/usr/bin/env Python# -- coding: utf-8 --&quot;&quot;&quot;@version: v1.0@author: huangyc@file: p_tuning_test.py@Description: @time: 2023/6/6 15:31&quot;&quot;&quot;import torchfrom torch import nndef run():    def transpose_for_scores(x: torch.Tensor) -&gt; torch.Tensor:        new_x_shape = x.size()[:-1] + (12, 64)        x = x.view(new_x_shape)        return x.permute(0, 2, 1, 3)    prompt = torch.rand(32, 128, 48, 12, 64)  # batch_size, seq_len, num_layer*2, num_head, head_size    prompt = prompt.permute([2, 0, 3, 1, 4])    print(f&quot;P-tuningV2æ„é€ çš„trainable continuous embeddingså½¢çŠ¶ï¼š{prompt.shape}&quot;)    past_key_values = prompt.split(2)    num_layers = 24    hidden_dim = 768    n_head = 12    head_dim = hidden_dim // n_head    all_head_size = n_head * head_dim    hidden_states = torch.randn(32, 128, 768)  # batch_size, seq_len, hidden_size    print(f&quot;è¾“å…¥çš„å‘é‡å½¢çŠ¶ï¼š{hidden_states.shape}&quot;)    for i in range(num_layers):        past_key_value = past_key_values[i]        print(f&quot;æ¯ä¸€å±‚BertLayeréœ€è¦åŠ å…¥çš„promptå½¢çŠ¶: {past_key_value.shape}&quot;)        self_attn_past_key_value = past_key_value[:2] if past_key_value is not None else None        # BertSelfAttention        query = nn.Linear(hidden_dim, all_head_size)        key = nn.Linear(hidden_dim, all_head_size)        value = nn.Linear(hidden_dim, all_head_size)        # åŸå§‹kvçš„å¤§å°        key_layer = transpose_for_scores(key(hidden_states))        old_key_layer_shape = key_layer.shape        print(f&quot;ç»è¿‡transpose_for_scoresåçš„keyå½¢çŠ¶ï¼š{old_key_layer_shape}&quot;)        value_layer = transpose_for_scores(value(hidden_states))        old_value_layer_shape = value_layer.shape        print(f&quot;ç»è¿‡transpose_for_scoresåçš„valueå½¢çŠ¶ï¼š{old_value_layer_shape}\n&quot;)        # æ‹¼æ¥åkvçš„å¤§å°        key_layer = torch.cat([past_key_value[0], key_layer], dim=2)        print(            f&quot;past_key_value[0]çš„å½¢çŠ¶ï¼š{past_key_value[0].shape} åŸå§‹key_layerçš„å½¢çŠ¶ï¼š{old_key_layer_shape} ç»è¿‡catåçš„key_layerå½¢çŠ¶ï¼š{key_layer.shape}&quot;)        value_layer = torch.cat([past_key_value[1], value_layer], dim=2)        print(            f&quot;past_key_value[1]çš„å½¢çŠ¶ï¼š{past_key_value[1].shape} åŸå§‹value_layerçš„å½¢çŠ¶ï¼š{old_value_layer_shape} ç»è¿‡catåçš„value_layerå½¢çŠ¶ï¼š{value_layer.shape}\n&quot;)        mixed_query_layer = query(hidden_states)        print(f&quot;hidden_statesç»è¿‡queryå±‚åè¾“å‡ºçš„å½¢çŠ¶ï¼š{mixed_query_layer.size()}&quot;)  # batch seq len embed        query_layer = transpose_for_scores(mixed_query_layer)        print(f&quot;ç»è¿‡transpose_for_scoresåçš„queryå½¢çŠ¶{query_layer.size()}&quot;)  # batch        print(&quot;æ³¨æ„åŠ›åˆ†æ•°å¼€å§‹è®¡ç®—&quot;)        attention_scores = torch.matmul(query_layer, key_layer.transpose(-1, -2))        print(f&quot;attention_scoresçš„å½¢çŠ¶ï¼š{attention_scores.size()}&quot;)  # batch head seq_len seq_len        print(&quot;å¼€å§‹æ³¨æ„åŠ›æ±‡èšè®¡ç®—&quot;)        context_layer = torch.matmul(attention_scores, value_layer)        print(f&quot;æ³¨æ„åŠ›æ±‡èšåè¾“å‡ºçŸ©é˜µcontext_layerçš„å½¢çŠ¶ï¼š{context_layer.size()}&quot;)  # batch head seq_len embed/12        print(&quot;æœ€åï¼Œå°†context_layerçš„å½¢çŠ¶æ¢å¤æˆè¾“å…¥hidden_statesçš„å½¢çŠ¶&quot;)        context_layer = context_layer.permute(0, 2, 1, 3).contiguous()        new_context_layer_shape = context_layer.size()[:-2] + (768,)        context_layer = context_layer.view(new_context_layer_shape)        print(f&quot;context_layerçš„å½¢çŠ¶æ¢å¤å®Œæˆï¼Œå…¶å½¢çŠ¶ä¸ºï¼š{context_layer.size()}&quot;)        print(&quot;ä¸€æ¬¡P-tuningV2çš„BertLayerè®¡ç®—ä»¿çœŸç»“æŸ&quot;)        breakif __name__ == '__main__':    run()æµ‹è¯•è¾“å‡º123456789101112131415161718192021S:\Anaconda3\envs\torch38\python.exe Q:\pyCharmWS\chatgpts\P-tuning-v2\tests\p_tuning_test.py P-tuningV2æ„é€ çš„trainable continuous embeddingså½¢çŠ¶ï¼štorch.Size([48, 32, 12, 128, 64])è¾“å…¥çš„å‘é‡å½¢çŠ¶ï¼štorch.Size([32, 128, 768])æ¯ä¸€å±‚BertLayeréœ€è¦åŠ å…¥çš„promptå½¢çŠ¶: torch.Size([2, 32, 12, 128, 64])ç»è¿‡transpose_for_scoresåçš„keyå½¢çŠ¶ï¼štorch.Size([32, 12, 128, 64])ç»è¿‡transpose_for_scoresåçš„valueå½¢çŠ¶ï¼štorch.Size([32, 12, 128, 64])====================&gt; æ ¸å¿ƒpast_key_value[0]çš„å½¢çŠ¶ï¼štorch.Size([32, 12, 128, 64]) åŸå§‹key_layerçš„å½¢çŠ¶ï¼štorch.Size([32, 12, 128, 64]) ç»è¿‡catåçš„key_layerå½¢çŠ¶ï¼štorch.Size([32, 12, 256, 64])past_key_value[1]çš„å½¢çŠ¶ï¼štorch.Size([32, 12, 128, 64]) åŸå§‹value_layerçš„å½¢çŠ¶ï¼štorch.Size([32, 12, 128, 64]) ç»è¿‡catåçš„value_layerå½¢çŠ¶ï¼štorch.Size([32, 12, 256, 64])====================&gt; æ ¸å¿ƒhidden_statesç»è¿‡queryå±‚åè¾“å‡ºçš„å½¢çŠ¶ï¼štorch.Size([32, 128, 768])ç»è¿‡transpose_for_scoresåçš„queryå½¢çŠ¶torch.Size([32, 12, 128, 64])æ³¨æ„åŠ›åˆ†æ•°å¼€å§‹è®¡ç®—attention_scoresçš„å½¢çŠ¶ï¼štorch.Size([32, 12, 128, 256])å¼€å§‹æ³¨æ„åŠ›æ±‡èšè®¡ç®—æ³¨æ„åŠ›æ±‡èšåè¾“å‡ºçŸ©é˜µcontext_layerçš„å½¢çŠ¶ï¼štorch.Size([32, 12, 128, 64])æœ€åï¼Œå°†context_layerçš„å½¢çŠ¶æ¢å¤æˆè¾“å…¥hidden_statesçš„å½¢çŠ¶context_layerçš„å½¢çŠ¶æ¢å¤å®Œæˆï¼Œå…¶å½¢çŠ¶ä¸ºï¼štorch.Size([32, 128, 768])ä¸€æ¬¡P-tuningV2çš„BertLayerè®¡ç®—ä»¿çœŸç»“æŸLORAç³»åˆ—ç‚¹èµğŸ‘Bç«™åšä¸» å°æ¨ä¸åŠªåŠ›0v0 + åšä¸»ç›¸å…³çš„æ–‡ç« é“¾æ¥LORA(è½¬)LoRAï¼šè®­ç»ƒä½ çš„GPTã€è®ºæ–‡ç²—è¯»Â·1ã€‘ä¸€ç§é€šè¿‡ä½ç§©è¿‘ä¼¼å¢é‡çŸ©é˜µçš„ï¼Œç»è¿‡å¹¿æ³›éªŒè¯è¶³å¤ŸRobustçš„å¾®è°ƒæ–¹æ³•æ‘˜è¦éšç€è‡ªç„¶è¯­è¨€å¤„ç†(NLP)æ¨¡å‹è§„æ¨¡çš„ä¸æ–­å¢é•¿ï¼Œç”±äºæˆæœ¬å’Œèµ„æºé™åˆ¶ï¼Œå¯¹å…¶è¿›è¡Œå®Œå…¨å¾®è°ƒä»¥ç”¨äºä¸‹æ¸¸ä»»åŠ¡çš„æŒ‘æˆ˜æ—¥ç›Šå¢åŠ ä»‹ç»ä½ç§©é€‚åº”(Low-Rank Adaptation)ã€‚LoRAé€šè¿‡å¼•å…¥å‚æ•°çŸ©é˜µæ¥å‡å°‘å‚æ•°ï¼Œå¹¶å°†GPUå†…å­˜éœ€æ±‚é™ä½äº†3å€ã€‚ç›¸æ¯”äºä½¿ç”¨GPT-3è¿›è¡Œå¾®è°ƒï¼Œå®ƒå°†å‚æ•°å‡å°‘äº†10,000å€å°½ç®¡å¯è®­ç»ƒå‚æ•°æ›´å°‘ï¼Œä½†LoRAåœ¨å¤§å¤šæ•°è¯­è¨€æ¨¡å‹ä¸Šè¡¨ç°ä¼˜äºå¾®è°ƒï¼Œå…·æœ‰æ›´é«˜çš„è®­ç»ƒååé‡å’Œæ— æ¨ç†å»¶è¿Ÿå¯¹è¯­è¨€æ¨¡å‹é€‚åº”ä¸­çš„ç§©ç¼ºå¤±è¿›è¡Œçš„å®è¯ç ”ç©¶ä¸ºLoRAçš„æœ‰æ•ˆæ€§æä¾›äº†è¯æ®ï¼ŒLoRAæ˜¯å¼€æºçš„ä»‹ç»å¯¹äºä¸‹æ¸¸ä»»åŠ¡è€Œè¨€ï¼Œå®Œå…¨å¾®è°ƒå¤§å‹è¯­è¨€æ¨¡å‹æ˜¯å…·æœ‰æŒ‘æˆ˜æ€§çš„ã€‚ å—åˆ°[å†…åœ¨ç»´åº¦]çš„ç ”ç©¶å¯å‘ï¼Œæˆ‘ä»¬æå‡ºäº†LoRAï¼Œå…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼šä½ä»»åŠ¡åˆ‡æ¢å¼€é”€: ä¸€ä¸ªé¢„è®­ç»ƒæ¨¡å‹å¯ä»¥è¢«å…±äº«å¹¶ç”¨äºæ„å»ºå¤šä¸ªé’ˆå¯¹ä¸åŒä»»åŠ¡çš„å°å‹LoRAæ¨¡å—å‚æ•°é«˜æ•ˆ: LoRAé€šè¿‡ä½¿ç”¨è‡ªé€‚åº”ä¼˜åŒ–å™¨ï¼Œåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä½¿å¾—è®­ç»ƒæ›´é«˜æ•ˆï¼Œå¹¶å°†ç¡¬ä»¶é—¨æ§›é™ä½äº†æœ€å¤š3å€æ— æ¨ç†å»¶è¿Ÿ: LoRAçš„ç®€å•çº¿æ€§è®¾è®¡ä½¿å¾—å¯è®­ç»ƒçŸ©é˜µåœ¨éƒ¨ç½²æ—¶å¯ä»¥ä¸å†»ç»“æƒé‡åˆå¹¶æ­£äº¤æ€§: LoRAä¸è®¸å¤šå…ˆå‰çš„æ–¹æ³•æ˜¯æ­£äº¤çš„ï¼Œå¹¶ä¸”å¯ä»¥ä¸å®ƒä»¬ç»“åˆä½¿ç”¨ï¼Œæ¯”å¦‚å‰ç¼€å¾®è°ƒ(prefix-tuning)é—®é¢˜æè¿°æ¨¡å‹è®­ç»ƒæ—¶å‚æ•°é‡è¯„ä¼°ï¼Œå¯¹äºLLMï¼Œå¦‚æœæ¨¡å‹çš„å‚æ•°æ—¶$\Phi$çš„è¯å…¨é‡å¾®è°ƒä½¿ç”¨Adamä¼˜åŒ–å™¨ä¸‹çš„ï¼Œ$\mathrm{n}=8$ï¼Œå¹¶ä¸”ä½¿ç”¨æ··åˆç²¾åº¦ï¼Œä¸€ä¸ªå‚æ•°éœ€è¦16ä¸ªbytesæ¥å­˜å‚¨ï¼Œè¿™16ä¸ªbytesåˆ†åˆ«ä¸ºæƒé‡$W$éœ€è¦$fp16$æ¥å­˜å‚¨ï¼Œæ¿€æ´»å€¼$A$éœ€è¦$fp16$ï¼Œä¸ºäº†æ›´æ–°æƒé‡è¿˜éœ€å­˜ä¸€ä¸ªå¤åˆ¶$W_c$éœ€è¦$fp32$ï¼Œä¼˜åŒ–å™¨éœ€è¦å­˜ä¸¤ä¸ªå€¼ï¼Œåˆ†åˆ«æ˜¯$M$å’Œ$V$(æ–¹å·®)ï¼Œåˆ†åˆ«éœ€è¦$fp32$å…¶ä¸­$fp16$å 2bytesï¼Œ$fp32$å bytesï¼Œæ€»å…±ä¸º$2+2+4+4+4 = 16$byteså› æ­¤ï¼Œ$\Phi$ä¸ªå‚æ•°å°±éœ€è¦$ \Phi * 2n$bytesLoraLoraåœ¨è®­ç»ƒæ—¶ï¼Œå°†åŸæ¥çš„å‚æ•°å›ºå®šä¸‹æ¥ï¼Œåªæ›´æ–°æ–°å¢åŠ çš„å‚æ•°ï¼Œå› æ­¤Mem Required: $(4 \Phi+\theta * 2 n)$ bytesåœ¨GPT-3çš„175Bå‚æ•°ä¸‹ï¼Œè¿™é‡Œçš„$\Theta$å¯ä»¥è¾¾åˆ°åŸæ¥çš„$0.01 \%$ä¸ºä»€ä¹ˆä¼šæå‡ºLoraå‘¢åŸæ¥çš„Adapteræ–¹æ³•ä¹Ÿæ˜¯å›ºå®šæ¨¡å‹çš„å‚æ•°ï¼Œåªè®­ç»ƒMLPå‚æ•°ï¼Œä½†æ˜¯è¿™æ ·å­æœ‰å‡ ä¸ªå¼Šç«¯å¢åŠ äº†ç½‘ç»œæ·±åº¦ï¼Œå¢åŠ äº†æ¨ç†çš„æ—¶é—´æ·»åŠ MLPä¹‹åï¼Œè®­ç»ƒå‡ºæ¥çš„æœ€ä¼˜æ–¹æ¡ˆä¹Ÿåªèƒ½æ”¶æ•›åˆ°MLPå±‚ï¼Œä¸ä¸€å®šæ˜¯å…¨å±€æœ€å¥½çš„ç›´æ¥å»ä¼˜åŒ–è¿™ä¸ªPromoteå¹¶ä¸èƒ½ä¿è¯ä¼˜åŒ–æ˜¯å•è°ƒçš„ï¼Œä¹Ÿå°±æ˜¯ä¸æ˜¯å…¨å±€æœ€ä¼˜ï¼Œå¾ˆéš¾ä¼˜åŒ–å¥½å‡å°‘äº†å¯ç”¨äºå¤„ç†ä¸‹æ¸¸ä»»åŠ¡çš„åºåˆ—é•¿åº¦ï¼Œå› ä¸ºæ–°åŠ å…¥çš„Promoteä¼šå ç”¨è¾“å…¥çš„tokené•¿åº¦å…·ä½“æ–¹æ³•æœ€æ ¸å¿ƒçš„æ€è·¯å¦‚ä¸‹å…¬å¼æ‰€ç¤ºï¼Œç ”ç©¶è¡¨æ˜$\Delta W$é€šå¸¸æ˜¯ä¸€ä¸ªæ¬ ç§©çš„çŸ©é˜µå› æ­¤ï¼Œ$\Delta W$å¯ä»¥è¿›è¡Œä½ç§©åˆ†è§£è®­ç»ƒæ—¶ï¼Œ$B$åˆå§‹åŒ–ä¸ºå…¨é›¶çŸ©é˜µï¼Œè¿™æ ·å­å‚æ•°é‡å°±ä»å˜æˆäº†ï¼Œè¿™é‡Œçš„ä¸€èˆ¬æ˜¯è¿œå°äºçš„ä¼˜ç‚¹LoRAæ˜¯å¯¹å®Œå…¨å¾®è°ƒçš„ä¸€ç§æ¨å¹¿æ–¹æ³•åœ¨é€‚åº”è¿‡ç¨‹ä¸­ï¼ŒLoRAä¸éœ€è¦å¯¹æƒé‡çŸ©é˜µè¿›è¡Œå®Œå…¨ç§©çš„ç´¯ç§¯æ¢¯åº¦æ›´æ–°ï¼Œè€Œæ˜¯å¯ä»¥åŸºäºé¢„è®­ç»ƒçš„æƒé‡çŸ©é˜µè®¾ç½®ç§©å½“LoRAåº”ç”¨äºæ‰€æœ‰æƒé‡çŸ©é˜µå¹¶ä¸”åç½®è¿›è¡Œè®­ç»ƒæ—¶ï¼Œè¿™ç§æ–¹æ³•æä¾›äº†ç±»ä¼¼äºå®Œå…¨å¾®è°ƒçš„è¡¨ç°èƒ½åŠ›æ²¡æœ‰é¢å¤–çš„æ¨ç†å»¶è¿Ÿåœ¨ç”Ÿäº§éƒ¨ç½²ä¸­ï¼ŒLoRAå¯ä»¥è®¡ç®—å’Œå­˜å‚¨$W=W_0+BA$ï¼Œå…¶ä¸­$W_0$å’Œ$ğµğ´$å±äº$â„^{ğ‘‘Ã—ğ‘˜}$ï¼Œå½“åˆ‡æ¢åˆ°å¦ä¸€ä¸ªä¸‹æ¸¸ä»»åŠ¡æ—¶ï¼Œå¯ä»¥é€šè¿‡å‡å»$ğµğ´$å¹¶åŠ ä¸Šä¸åŒçš„$ğµâ€™ğ´â€™$æ¥æ¢å¤$ğ‘Š_0$ï¼Œè¿™æ˜¯ä¸€ä¸ªå¿«é€Ÿæ“ä½œï¼Œå‡ ä¹æ²¡æœ‰é¢å¤–çš„å†…å­˜å¼€é”€(æ½®æ±GPU)ä¸ºä»€ä¹ˆä½ç§©çŸ©é˜µæœ‰æ•ˆå½“ç»™å®šå‚æ•°æ•°é‡æ—¶ï¼Œåº”è¯¥è°ƒæ•´é¢„è®­ç»ƒTransformerä¸­çš„å“ªäº›å…·ä½“æƒé‡çŸ©é˜µå­é›†ä»¥å®ç°æœ€ä½³çš„ä¸‹æ¸¸æ€§èƒ½ï¼Ÿåœ¨ç»™å®šå‚æ•°é¢„ç®—çš„æƒ…å†µä¸‹ï¼Œç¡®å®šè¦è°ƒæ•´çš„æƒé‡çŸ©é˜µå­é›†ä»¥å®ç°æœ€ä½³ä¸‹æ¸¸æ€§èƒ½æ˜¯ä¸€ä¸ªå¤æ‚çš„é—®é¢˜ï¼Œå¹¶ä¸”æ²¡æœ‰å›ºå®šçš„ç­”æ¡ˆé€šå¸¸ï¼Œå¯ä»¥è€ƒè™‘æ ¹æ®ä¸‹æ¸¸ä»»åŠ¡çš„ç‰¹ç‚¹å’Œéœ€æ±‚è¿›è¡Œæƒè¡¡å’Œé€‰æ‹©ä¸€ç§å¸¸è§çš„æ–¹æ³•æ˜¯é€šè¿‡å¯¹ä¸åŒæƒé‡çŸ©é˜µè¿›è¡Œå®éªŒæ€§å¾®è°ƒï¼Œå¹¶æ ¹æ®æ€§èƒ½è¯„ä¼°æ¥ç¡®å®šé€‚åˆç‰¹å®šä»»åŠ¡çš„æƒé‡çŸ©é˜µå­é›†æœ€ä¼˜çš„é€‚åº”çŸ©é˜µ$\Delta W$æ˜¯å¦çœŸçš„æ˜¯æ¬ ç§©çš„å—ï¼Ÿå¦‚æœæ˜¯ï¼Œé‚£ä¹ˆåœ¨å®é™…æƒ…å†µä¸‹æ¨èçš„ç§©æ˜¯å¤šå°‘ï¼Ÿæœ€ä¼˜çš„é€‚åº”çŸ©é˜µ$\Delta W$æ˜¯å¦çœŸçš„æ˜¯æ¬ ç§©çš„ï¼Œè¿™å–å†³äºå…·ä½“æƒ…å†µã€‚ç§©ç¼ºå¤±æ„å‘³ç€çŸ©é˜µçš„ç§©(çŸ©é˜µçš„çº¿æ€§ç‹¬ç«‹åˆ—æ•°æˆ–è¡Œæ•°çš„æœ€å¤§æ•°é‡)è¾ƒä½å¯¹äºå®é™…ç›®çš„ï¼Œå»ºè®®é€‰æ‹©é€‚å½“çš„ç§©ä»¥å¹³è¡¡æ¨¡å‹æ€§èƒ½å’Œè®¡ç®—æˆæœ¬ã€‚å…·ä½“æ¨èçš„ç§©å–å†³äºä»»åŠ¡çš„å¤æ‚æ€§ã€æ•°æ®é›†çš„è§„æ¨¡ä»¥åŠå¯ç”¨çš„è®¡ç®—èµ„æºç­‰å› ç´ $\Delta W$å’Œ$W$ä¹‹é—´çš„å…³ç³»æ˜¯ä»€ä¹ˆï¼Ÿ$\Delta W$å’Œ$W$ä¹‹é—´æ˜¯å¦å­˜åœ¨é«˜ç›¸å…³æ€§ï¼Ÿ$\Delta W$çš„å¤§å°ä¸$W$ç›¸æ¯”å¦‚ä½•ï¼Ÿ$\Delta W$è¡¨ç¤ºé€‚åº”çŸ©é˜µï¼Œç”¨äºè°ƒæ•´é¢„è®­ç»ƒæƒé‡çŸ©é˜µ$W$ï¼Œ$\Delta W$å’Œ$W$ä¹‹é—´çš„å…³ç³»å–å†³äºå…·ä½“çš„é€‚åº”æ–¹æ³•å’Œä¼˜åŒ–ç®—æ³•ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œ$\Delta W$å¯ä»¥é€šè¿‡å¯¹$W$çš„å¾®å°è°ƒæ•´æ¥è·å¾—ï¼Œè€Œåœ¨å…¶ä»–æƒ…å†µä¸‹ï¼Œ$\Delta W$å¯èƒ½åŒ…å«æ›´å¤§çš„å˜åŒ–$\Delta W$å’Œ$W$ä¹‹é—´çš„ç›¸å…³æ€§å–å†³äºé€‚åº”æ–¹æ³•çš„è®¾è®¡å’Œä¼˜åŒ–è¿‡ç¨‹çš„ç»†èŠ‚ã€‚å®ƒä»¬å¯ä»¥å­˜åœ¨ä¸€å®šçš„ç›¸å…³æ€§ï¼Œä½†å…·ä½“æƒ…å†µå¯èƒ½å› æ¨¡å‹æ¶æ„ã€ä»»åŠ¡è¦æ±‚å’Œæ•°æ®é›†ç‰¹å¾è€Œå¼‚$\Delta W$çš„å¤§å°ä¸$W$çš„å¤§å°ä¹‹é—´æ²¡æœ‰å›ºå®šçš„æ¯”è¾ƒå…³ç³»ï¼Œå› ä¸ºå®ƒä»¬çš„å°ºåº¦å–å†³äºå…·ä½“çš„æ•°å€¼èŒƒå›´å’Œè°ƒæ•´æ–¹æ³•å¯¹äºattentionå‚æ•°é™„åŠ åˆ°å“ªä¸ªä¸Šæ›´æœ‰æ•ˆå®éªŒåœ¨GPT-3 175Bæ¨¡å‹ä¸Šè®¾ç½®äº†ä¸€ä¸ªå‚æ•°é¢„ç®—ä¸º18M(å¦‚æœä»¥FP16å­˜å‚¨ï¼Œå¤§çº¦ä¸º35MB)ã€‚è¿™å¯¹åº”äºå½“æˆ‘ä»¬é€‚åº”ä¸€ç§æ³¨æ„åŠ›æƒé‡æ—¶r=8ï¼Œæˆ–è€…å½“æˆ‘ä»¬é€‚åº”ä¸¤ç§ç±»å‹æ—¶r=4ï¼Œé€‚ç”¨äºæ‰€æœ‰96å±‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå°†æ‰€æœ‰å‚æ•°æ”¾åœ¨æˆ–ä¸­ä¼šå¯¼è‡´æ˜¾è‘—é™ä½æ€§èƒ½ï¼Œè€Œæ³¨å…¥åˆ°å’Œåˆ™äº§ç”Ÿæœ€ä½³ç»“æœã€‚è¿™è¡¨æ˜ï¼Œå³ä½¿ç§©ä¸º4ï¼Œä¸­åŒ…å«äº†è¶³å¤Ÿçš„ä¿¡æ¯ï¼Œä½¿å¾—ä¸ä½¿ç”¨å…·æœ‰è¾ƒå¤§ç§©çš„å•ä¸€ç±»å‹çš„æƒé‡ç›¸æ¯”ï¼Œä½¿ç”¨æ›´å¤šçš„æƒé‡çŸ©é˜µæ›´å¯å–å›ç­”ï¼šå°†å‚æ•°è®¾ç½®åˆ°qã€vä¸Šæ—¶ï¼Œrå–å¤šå°‘åˆé€‚LoRAåœ¨éå¸¸å°çš„ç§©(ç‰¹åˆ«æ˜¯å¯¹äºï¼Œè€Œè¨€)ä¸‹å·²ç»å–å¾—äº†ç›¸å½“çš„ç«äº‰åŠ›ï¼Œè¿™è¡¨æ˜æ›´æ–°çŸ©é˜µå¯èƒ½å…·æœ‰éå¸¸å°çš„å†…åœ¨ç§©ï¼Œä½¿ç”¨ä½ç§©çŸ©é˜µå¯¹LLMè¿›è¡Œfine tuneçš„æ—¶å€™ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªéå¸¸å°çš„ä½ç§©çŸ©é˜µï¼Œå°±å¯ä»¥æ•æ‰åˆ°å¯¹ä¸‹æ¸¸ä»»åŠ¡çš„ä¸€äº›ç‰¹å¾ä¿¡æ¯ï¼Œè¿™ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªéå¸¸é«˜æ•ˆçš„LLMçš„fine tuneçš„æ–¹å¼ï¼ŒåŒæ—¶æé«˜äº†ä¸‹æ¸¸ä»»åŠ¡çš„æ€§èƒ½å›ç­”ï¼š$\Delta W$å’Œ$W$ä¹‹é—´çš„å…³ç³»æ˜¯ä»€ä¹ˆé¦–å…ˆå¯¹$\Delta W$è¿›è¡Œå¥‡å¼‚å€¼åˆ†è§£ï¼Œå¹¶ä¸”æŠŠå®ƒå·¦å¥‡å¼‚å€¼å‘é‡å’Œå³å¥‡å¼‚å€¼å‘é‡ä¹˜åˆ°$W_q$ä¸Šï¼ŒæŠŠ$W_q$æ˜ å°„åˆ°$\Delta W_q$çš„å­ç©ºé—´ï¼Œå¹¶è®¡ç®—$F$èŒƒæ•°ï¼ŒåŒæ—¶è¿˜æŠŠ$W_q$æ˜ å°„åˆ°æ˜ å°„åˆ°éšæœºçŸ©é˜µä¸Šä»¥æ­¤æ¥è¯æ˜$\Delta W_q$ä¸$W_q$æœ‰æ›´å¼ºçš„ç›¸å…³æ€§é¦–å…ˆï¼Œä¸éšæœºçŸ©é˜µç›¸æ¯”ï¼Œ$\Delta W_q$ä¸$W_q$å…·æœ‰æ›´å¼ºçš„ç›¸å…³æ€§ï¼Œè¡¨æ˜$\Delta W$æ”¾å¤§äº†é¢„è®­ç»ƒæ¨¡å‹ä¸­çš„$W$ä¸­å·²ç»å­˜åœ¨çš„æŸäº›ç‰¹å¾å…¶æ¬¡ï¼Œ$\Delta W$ä¸æ˜¯é‡å¤$W$çš„å¥‡å¼‚å€¼æ–¹å‘ï¼Œè€Œæ˜¯åªæ”¾å¤§åœ¨$W$ä¸­æ²¡æœ‰å¼ºè°ƒçš„æ–¹å‘ç¬¬ä¸‰ï¼Œæ”¾å¤§å› å­ç›¸å½“å·¨å¤§ï¼šå½“r=4æ—¶ï¼Œ21.5â‰ˆ6.91/0.32ï¼Œè¡¨æ˜$\Delta W$åªæ˜¯æ”¾å¤§äº†$W$ä¸­çš„ä¸€äº›ç‰¹å¾ï¼Œä¸”æ”¾å¤§å€æ•°æ˜¯å¾ˆå¤§çš„ï¼Œç›¸å½“äºæ˜¯æŠŠä¸‹æ¸¸ä»»åŠ¡éœ€è¦çš„ç‰¹å¾æå–å‡ºæ¥å¹¶è¿›è¡Œæ”¾å¤§AdaLoRA(è½¬)AdaLoRAï¼šæ›´å¼ºå¤§çš„LoRAgithub cauyxy/YourGPTLoraä¸­çš„ræ˜¯ä¸€ä¸ªç¡®å®šå€¼ï¼Œä½†ä¸æ˜¯å¯¹äºæ‰€æœ‰çš„å±‚ï¼Œåƒqã€kè¿™æ ·çš„å±‚ï¼Œqå†…åœ¨ç§©æ¯”è¾ƒå¤§ï¼Œvå†…åœ¨ç§©æ¯”è¾ƒå°ï¼Œå¯¹äºä¸åŒçš„çŸ©é˜µåº”è¯¥ä½¿ç”¨ä¸åŒçš„å†…åœ¨ç§©AdaLoRAæ˜¯åœ¨å¯¹åŒæ ·çš„å‚æ•°é‡ä¸‹ï¼Œå¯¹ä¸åŒçš„çŸ©é˜µä½¿ç”¨ä¸åŒçš„rï¼Œé€šè¿‡å¥‡å¼‚å€¼åˆ†è§£ï¼Œåˆ¤æ–­rçš„å¤§å°ï¼Œæ¥å–å¾—æ›´å¥½çš„æ•ˆæœæå‡ºé—®é¢˜åœ¨NLPé¢†åŸŸï¼Œå¯¹äºä¸‹æ¸¸ä»»åŠ¡è¿›è¡Œå¤§å‹é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹çš„å¾®è°ƒå·²ç»æˆä¸ºä¸€ç§é‡è¦çš„åšæ³•ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œæˆ‘ä»¬ä¼šé‡‡ç”¨å¯¹åŸæœ‰çš„é¢„è®­ç»ƒæ¨¡å‹è¿›è¡Œå…¨é‡å¾®è°ƒçš„æ–¹æ³•æ¥é€‚é…ä¸‹æ¸¸ä»»åŠ¡ï¼Œä½†è¿™ç§æ–¹æ³•å­˜åœ¨ä¸¤ä¸ªé—®é¢˜è®­ç»ƒé˜¶æ®µ: å¯¹äºé¢„è®­ç»ƒæ¨¡å‹è¿›è¡Œå¾®è°ƒçš„æ—¶å€™ï¼Œä¸ºäº†æ›´æ–°æƒé‡å‚æ•°ï¼Œéœ€è¦å¤§é‡çš„æ˜¾å­˜æ¥å­˜å‚¨å‚æ•°çš„æ¢¯åº¦å’Œä¼˜åŒ–å™¨ä¿¡æ¯ï¼Œåœ¨å½“ä»Šé¢„è®­ç»ƒæ¨¡å‹çš„å‚æ•°å˜å¾—è¶Šæ¥è¶Šå¤§çš„æƒ…å†µä¸‹ï¼Œé’ˆå¯¹ä¸‹æ¸¸ä»»åŠ¡å¾®è°ƒé—¨æ§›å˜å¾—è¶Šæ¥è¶Šé«˜æ¨ç†é˜¶æ®µ: ç”±äºæˆ‘ä»¬è®­ç»ƒçš„æ—¶å€™æ˜¯å¯¹äºæ¨¡å‹å‚æ•°è¿›è¡Œå…¨é‡çš„æ›´æ–°ï¼Œæ‰€ä»¥å¤šä¸ªä¸‹æ¸¸ä»»åŠ¡éœ€è¦ä¸ºæ¯ä¸ªä»»åŠ¡ç»´æŠ¤ä¸€ä¸ªå¤§å‹æ¨¡å‹çš„ç‹¬ç«‹å‰¯æœ¬ï¼Œè¿™æ ·å°±å¯¼è‡´æˆ‘ä»¬åœ¨å®é™…åº”ç”¨çš„æ—¶å€™æµªè´¹äº†ä¸å¿…è¦çš„å­˜å‚¨ç°æœ‰æ–¹æ³•: ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œç ”ç©¶è€…æå‡ºäº†ä¸¤ä¸ªä¸»è¦ç ”ç©¶æ–¹å‘ï¼Œä»¥å‡å°‘å¾®è°ƒå‚æ•°çš„æ•°é‡ï¼ŒåŒæ—¶ä¿æŒç”šè‡³æé«˜é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹çš„æ€§èƒ½æ·»åŠ å°å‹ç½‘ç»œæ¨¡å—å°†å°å‹ç½‘ç»œæ¨¡å—æ·»åŠ åˆ°PLMsä¸­ï¼Œä¿æŒåŸºç¡€æ¨¡å‹ä¿æŒä¸å˜çš„æƒ…å†µä¸‹ä»…é’ˆå¯¹æ¯ä¸ªä»»åŠ¡å¾®è°ƒè¿™äº›æ¨¡å—ï¼Œå¯ä»¥ç”¨äºæ‰€æœ‰ä»»åŠ¡ã€‚è¿™æ ·ï¼Œåªéœ€å¼•å…¥å’Œæ›´æ–°å°‘é‡ä»»åŠ¡ç‰¹å®šçš„å‚æ•°ï¼Œå°±å¯ä»¥é€‚é…ä¸‹æ¸¸çš„ä»»åŠ¡ï¼Œå¤§å¤§æé«˜äº†é¢„è®­ç»ƒæ¨¡å‹çš„å®ç”¨æ€§ï¼Œæ–¹æ³•ç¤ºä¾‹Adapter tuningï¼šæ˜¯åœ¨åŸºç¡€æ¨¡å‹çš„å„å±‚ä¹‹é—´æ’å…¥å°å‹ç¥ç»æ¨¡å—Prefix tuningï¼šå°†å¯è®­ç»ƒçš„å‰ç¼€æ ‡è®°é™„åŠ åˆ°åŸºç¡€æ¨¡å‹çš„è¾“å…¥æˆ–éšè—å±‚ä¸ŠPrompt Tuning: ä¿®æ”¹æ¨¡å‹çš„è¾“å…¥ï¼Œåœ¨æ¨¡å‹è¾“å…¥çš„å‰é¢åŠ ä¸€äº›ç‰¹å®šçš„å‰ç¼€å¯è¡Œä¹‹å¤„ï¼šå¯ä»¥è¾¾åˆ°ä¸å®Œå…¨å¾®è°ƒå‡ ä¹ç›¸å½“çš„æ€§èƒ½ï¼ŒåŒæ—¶ä»…æ›´æ–°ä¸åˆ°åŸå§‹æ¨¡å‹å‚æ•°çš„1ï¼…ï¼Œå¤§å¤§å‡å°‘äº†å†…å­˜æ¶ˆè€—ã€‚å­˜åœ¨é—®é¢˜ï¼šAdapter tuningï¼šå¼•å…¥äº†æ¨ç†å»¶è¿Ÿï¼Œæœ€ç»ˆæ”¶æ•›åˆ°é€‚é…å™¨å±‚Prefix or Prompt tuningï¼šç›´æ¥ä¼˜åŒ–Prefixå’ŒPromptæ˜¯éå•è°ƒçš„ï¼Œæ¯”è¾ƒéš¾æ”¶æ•›ï¼Œå¹¶ä¸”æ¶ˆè€—äº†è¾“å…¥çš„tokenä¸‹æ¸¸ä»»åŠ¡å¢é‡æ›´æ–°å¯¹é¢„è®­ç»ƒæƒé‡çš„å¢é‡æ›´æ–°è¿›è¡Œå»ºæ¨¡ï¼Œè€Œæ— éœ€ä¿®æ”¹æ¨¡å‹æ¶æ„æ–¹æ³•ç¤ºä¾‹ï¼šDiff pruningï¼šå°†$\Delta$åˆå§‹åŒ–ä¸ºä¸$W$ç›¸åŒçš„ç»´åº¦ï¼Œç„¶åæ ¹æ®å‚æ•°çš„å¤§å°æŒ‰å…ƒç´ å¯¹$\Delta$è¿›è¡Œå‰ªæLoRAï¼šé€šè¿‡ä¸¤ä¸ªå°å¾—å¤šçš„çŸ©é˜µçš„ä¹˜ç§¯å°†$\Delta$å‚æ•°åŒ–ä¸ºä½é˜¶çŸ©é˜µå¯è¡Œä¹‹å¤„ï¼šå¯ä»¥è¾¾åˆ°ä¸å®Œå…¨å¾®è°ƒå‡ ä¹ç›¸å½“çš„æ€§èƒ½å­˜åœ¨é—®é¢˜:Diff pruningï¼šéœ€è¦åº•å±‚å®ç°æ¥åŠ é€Ÿéç»“æ„åŒ–ç¨€ç–çŸ©é˜µçš„è®¡ç®—ï¼Œä¸èƒ½ç›´æ¥ä½¿ç”¨ç°æœ‰çš„æ¡†æ¶è®­ç»ƒè¿‡ç¨‹ä¸­éœ€è¦å­˜å‚¨å®Œæ•´çš„$\Delta$çŸ©é˜µï¼Œç›¸æ¯”äºFull finetuneå¹¶æ²¡æœ‰é™ä½è®¡ç®—æˆæœ¬LoRAï¼šé¢„å…ˆæŒ‡å®šæ¯ä¸ªå¢é‡çŸ©é˜µçš„å†…åœ¨ç§©rç›¸åŒï¼Œå¿½ç•¥äº†åœ¨å¾®è°ƒé¢„è®­ç»ƒæ¨¡å‹æ—¶ï¼Œæƒé‡çŸ©é˜µçš„é‡è¦æ€§åœ¨ä¸åŒæ¨¡å—å’Œå±‚ä¹‹é—´å­˜åœ¨æ˜¾è‘—å·®å¼‚åªè®­ç»ƒäº†self-attentionï¼Œæ²¡æœ‰è®­ç»ƒfeed-forward networksï¼Œäº‹å®ä¸ŠFFNæ›´é‡è¦é—®é¢˜æ€»ç»“ä¸èƒ½é¢„å…ˆæŒ‡å®šçŸ©é˜µçš„ç§©ï¼Œéœ€è¦åŠ¨æ€æ›´æ–°å¢é‡çŸ©é˜µçš„Ræƒé‡çŸ©é˜µçš„é‡è¦æ€§åœ¨ä¸åŒæ¨¡å—å’Œå±‚ä¹‹é—´å­˜åœ¨æ˜¾è‘—å·®å¼‚éœ€è¦æ‰¾åˆ°æ›´åŠ é‡è¦çš„çŸ©é˜µï¼Œåˆ†é…æ›´å¤šçš„å‚æ•°ï¼Œè£å‰ªä¸é‡è¦çš„çŸ©é˜µæ‰¾åˆ°é‡è¦çš„çŸ©é˜µï¼Œæå‡æ¨¡å‹æ•ˆæœè£å‰ªä¸é‡è¦çš„çŸ©é˜µï¼Œé™ä½å‚æ•°è®¡ç®—é‡ï¼Œé™ä½æ¨¡å‹æ•ˆæœå·®çš„é£é™©è§£å†³æ–¹æ¡ˆç›®æ ‡ï¼šåœ¨ç±»ä¼¼LoRAçš„å¾®è°ƒè¿‡ç¨‹ä¸­åŠ¨æ€åˆ†é…å‚æ•°é¢„ç®—ç»™æƒé‡çŸ©é˜µè°ƒæ•´å¢é‡çŸ©é˜µçš„ç§©æ¥æ§åˆ¶é¢„ç®—åˆ†é…ã€‚AdaLoRAå°†å…³é”®çš„å¢é‡çŸ©é˜µåˆ†é…é«˜ç§©ä»¥æ•æ‰æ›´ç²¾ç»†å’Œä»»åŠ¡ç‰¹å®šçš„ä¿¡æ¯ï¼Œè€Œå°†è¾ƒä¸é‡è¦çš„çŸ©é˜µçš„ç§©é™ä½ä»¥é˜²æ­¢è¿‡æ‹Ÿåˆå¹¶èŠ‚çœè®¡ç®—é¢„ç®—é‡‡ç”¨å‚æ•°åŒ–çŸ©é˜µæ¥æ¨¡æ‹ŸSVDï¼Œå¹¶èˆå¼ƒä¸é‡è¦çš„å¥‡å¼‚å€¼ï¼ŒåŒæ—¶ä¿ç•™å¥‡å¼‚å‘é‡ã€‚ç”±äºå¯¹ä¸€ä¸ªå¤§çŸ©é˜µè¿›è¡Œç²¾ç¡®SVDåˆ†è§£çš„è®¡ç®—æ¶ˆè€—éå¸¸å¤§ï¼Œè¿™ç§æ–¹æ³•å¯ä»¥åŠ é€Ÿè®¡ç®—ï¼ŒåŒæ—¶ä¿ç•™æœªæ¥æ¢å¤çš„å¯èƒ½æ€§å¹¶ç¨³å®šè®­ç»ƒåœ¨è®­ç»ƒæŸå¤±ä¸­æ·»åŠ äº†é¢å¤–çš„æƒ©ç½šé¡¹ï¼Œä»¥è§„èŒƒå¥‡å¼‚çŸ©é˜µPå’ŒQçš„æ­£äº¤æ€§ï¼Œä»è€Œé¿å…SVDçš„å¤§é‡è®¡ç®—å¹¶ç¨³å®šè®­ç»ƒSVD-BASED ADAPTATIONå¦‚ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬æŠŠå¢é‡çŸ©é˜µ$\Delta$åšä¸€ä¸ªå¥‡å¼‚å€¼åˆ†è§£çš„è¿‘ä¼¼ï¼Œå³$\Delta=P \Lambda Q$ï¼Œå¯¹çŸ©é˜µæ›´æ–°çš„æè¿°åˆ™æœ‰å¦‚ä¸‹è¡¨ç¤ºä¸ºäº†ä¿è¯$\mathrm{P}$å’Œ$\mathrm{Q}$çš„æ­£äº¤æ€§ï¼Œå³$P^{\top} P=Q Q^{\top}=I$ï¼Œæˆ‘ä»¬æå‡ºå¦‚ä¸‹æ‰€ç¤ºçš„æ­£åˆ™æŸå¤±ä¸ºä»€ä¹ˆä¸ç›´æ¥åœ¨åŸæ¥çš„BAä¸Šè¿›è¡Œä¿®å‰ªï¼Ÿå½“ä¸€å¯¹å¥‡å¼‚å‘é‡è¢«è®¤ä¸ºä¸ºä¸é‡è¦æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»ä¿®å‰ªå®ƒçš„æ‰€æœ‰å…ƒç´ ã€‚è¿™å°±å¯¼è‡´å‡ ä¹ä¸å¯èƒ½é‡æ–°æ¿€æ´»ä¿®å‰ªè¿‡çš„å¥‡å¼‚å‘é‡ï¼Œå› ä¸ºå®ƒä»¬çš„å…ƒç´ éƒ½è¢«æ¸…é›¶å¹¶ä¸”ä¸å†è®­ç»ƒä¸ä¹‹å¯¹æ¯”ï¼ŒAdaLoRAåªæ˜¯Maskäº†å¥‡å¼‚å€¼LoRAçš„Aå’ŒBä¸æ˜¯æ­£äº¤çš„ï¼Œè¿™æ„å‘³ç€å¥‡å¼‚å‘é‡å¯ä»¥ç›¸äº’ä¾èµ–ã€‚ ä¸æˆªæ–­æœ€å°çš„å¥‡å¼‚å€¼ç›¸æ¯”ï¼Œä¸¢å¼ƒå¥‡å¼‚å‘é‡å¯èƒ½ä¼šå¯¼è‡´åŸå§‹çŸ©é˜µå‘ç”Ÿæ›´å¤§çš„å˜åŒ–ã€‚å› æ­¤ï¼Œåœ¨åˆ†é…å®Œç§©çš„æ¯ä¸€æ­¥ä¹‹åï¼Œå¢é‡çŸ©é˜µé€šå¸¸ä¼šå‘ç”Ÿæ›´å¤šä¸å¯é¢„æµ‹çš„æ˜¾è‘—å˜åŒ–ï¼Œè¿™å¯¼è‡´è®­ç»ƒä¸ç¨³å®šï¼Œç”šè‡³æŸå®³æ¨¡å‹çš„æ•ˆæœIMPORTANCE-AWARE RANK ALLOCATIONæˆ‘ä»¬å°†åŸºäºSVDçš„ç§©è°ƒæ•´åº”ç”¨äºæ¯ä¸ªæƒé‡çŸ©é˜µï¼ŒåŒ…æ‹¬æ¯ä¸ªtransformerå±‚çš„$W{q}, W{k}, W{v}, W{f 1}$å’Œ$W_{f 2}$ã€‚ä¸ºäº†æ§åˆ¶å‚æ•°é¢„ç®—ï¼Œæˆ‘ä»¬åœ¨è®­ç»ƒæœŸé—´æ ¹æ®é‡è¦æ€§å¾—åˆ†è¿­ä»£ä¿®å‰ªå¥‡å¼‚å€¼ä¸ºäº†æ›´å¥½åœ°è¡¨ç¤ºï¼Œæˆ‘ä»¬ç”¨$k$æ¥ç´¢å¼•å¢é‡çŸ©é˜µ$\Delta{k}=P{k} \Lambda{k} Q{k}$ for $k=1, \ldots, n$ï¼Œç”¨$\mathcal{G}{k, i}=\left{P{k,  i}, \lambda{k, i}, Q{k, i }\right}$æ¥è¡¨ç¤ºç¬¬$k$ä¸ªçŸ©é˜µçš„å¥‡å¼‚å€¼ï¼Œå¥‡å¼‚å‘é‡ä¸‰å…ƒç»„ï¼Œ$\mathcal{S}_{k, i}$ æ¥è¡¨ç¤ºè¿™ä¸ªä¸‰å…ƒç»„çš„é‡è¦æ€§$\mathcal{C}(\mathcal{P}, \mathcal{E}, \mathcal{Q})$ä½œä¸ºå‚æ•°è®­ç»ƒçš„ä»£ä»·ï¼ŒåŒæ—¶åŠ ä¸Šæ­£åˆ™åŒ–é¡¹ï¼Œå°±å¾—å‡ºäº†å¦‚ä¸‹çš„ç›®æ ‡å‡½æ•°: ($\gamma$æ˜¯æ­£åˆ™åŒ–ç³»æ•°)æˆ‘ä»¬åœ¨è®­ç»ƒçš„æ—¶å€™å°±å¯ä»¥é€šè¿‡æ¢¯åº¦ä¸‹é™çš„æ–¹å¼å¯¹$P, \Lambda, Q$è¿›è¡Œæ›´æ–°ï¼Œä¸‹é¢æ˜¯$\Lambda$çš„ä¾‹å­ç„¶åæˆ‘ä»¬å†åŸºäº$\mathcal{S}_{k, i}$å¯¹$\Lambda$è¿›è¡Œè£å‰ªå…¶ä¸­$S^{(t)}=\left{S{k, i}^{(t)}\right}{1 \leq k \leq n, 1 \leq i \leq r}$åŒ…å«æ‰€æœ‰ä¸‰å…ƒç»„çš„é‡è¦æ€§åˆ†æ•°ã€‚$b^{(t)}$æ˜¯ç¬¬$\mathrm{t}$æ­¥å‰©ä½™å¥‡å¼‚å€¼çš„é¢„ç®—é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬é€šè¿‡ä¿®å‰ªä¸å¤ªé‡è¦çš„å¥‡å¼‚å€¼ï¼Œå°†æ›´å¤šé¢„ç®—ç•™ç»™ä¼˜å…ˆçº§è¾ƒé«˜çš„å¢é‡çŸ©é˜µMagnitude of singular valuesè¿™æ ·çš„è¯åªæœ‰æœ€å°çš„å¥‡å¼‚å€¼ä»¥åŠæœ€ä¸é‡è¦çš„å¥‡å¼‚å‘é‡è¢«å»å¼ƒã€‚å®ƒæœ€å¤§é™åº¦åœ°å‡å°äº†ä¸åŸå§‹çŸ©é˜µçš„åå·®ï¼Œè¿›ä¸€æ­¥ç¨³å®šäº†è®­ç»ƒã€‚ä½†æ˜¯è¿™ä¸ªåº¦é‡ä¸èƒ½æ­£ç¡®é‡åŒ–å‚æ•°(ä¸‰å…ƒç»„)å¯¹æ¨¡å‹æ€§èƒ½çš„è´¡çŒ®Sensitivity-based importanceä¹‹å‰çš„å·¥ä½œåˆ©ç”¨çµæ•åº¦æ¥é‡åŒ–å•ä¸ªå‚æ•°çš„é‡è¦æ€§ï¼Œå¹¶æ®æ­¤å¯¹å‚æ•°è¿›è¡Œéç»“æ„åŒ–ä¿®å‰ªã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸Šï¼Œæˆ‘ä»¬å¿…é¡»è®¾è®¡ä¸€ä¸ªæ–°çš„åº¦é‡æ ‡å‡†ï¼Œå› ä¸ºä¸‰å…ƒç»„è¦è¢«æŒ‰ç»„ä¸¢å¼ƒäº†ï¼Œæ‰€ä»¥æ¯ä¸€é¡¹çš„æ•æ„Ÿæ€§éƒ½åº”è¯¥è¢«è€ƒè™‘ï¼Œå¹¶é€‚å½“åœ°ç»„åˆèµ·æ¥ï¼Œä»¥é‡åŒ–ä¸‰å…ƒç»„å¯¹æ¨¡å‹æ€§èƒ½çš„æ•´ä½“è´¡çŒ®æˆ‘ä»¬è®¾è®¡äº†å¦‚ä¸‹æ‰€ç¤ºçš„å‡½æ•°æ¥è®¡ç®—importance scoreæˆ‘ä»¬å¯ä»¥é‡‡ç”¨$s(\cdot)$çš„çµæ•åº¦ï¼Œ$s(\cdot)$å®šä¹‰ä¸ºæ¢¯åº¦æƒé‡ä¹˜ç§¯çš„å¤§å°:æœ¬è´¨ä¸Šè¿‘ä¼¼äºå‚æ•°å½’é›¶æ—¶çš„æŸå¤±å˜åŒ–ã€‚å¦‚æœå»é™¤ä¸€ä¸ªå‚æ•°å½±å“è¾ƒå¤§ï¼Œåˆ™æ¨¡å‹å¯¹è¯¥å‚æ•°æ•æ„Ÿï¼Œæˆ‘ä»¬åº”è¯¥ä¿ç•™å®ƒä½†ä¹‹å‰çš„å·¥ä½œæŒ‡å‡ºï¼Œç›´æ¥è®¡ç®—çš„æ•æ„Ÿæ€§è¿˜ä¸æ˜¯ä¸€ä¸ªå¯é çš„é‡è¦æŒ‡æ ‡ã€‚è¿™æ ·çš„åˆ†æ•°æ˜¯åœ¨æŠ½æ ·çš„minibatchä¸Šä¼°è®¡çš„ã€‚éšæœºé‡‡æ ·å’Œå¤æ‚çš„è®­ç»ƒåŠ¨æ€å¯¼è‡´çµæ•åº¦ä¼°è®¡çš„å˜å¼‚æ€§å¤§ï¼Œä¸ç¡®å®šæ€§å¤§ï¼Œè¿™æ ·å¯èƒ½ä¼šå¯¼è‡´å¯¹äºå‚æ•°çš„é‡è¦æ€§çš„é”™è¯¯ä¼°è®¡ã€‚æå‡ºé€šè¿‡çµæ•åº¦å¹³æ»‘å’Œä¸ç¡®å®šæ€§é‡åŒ–ï¼ŒåŠ å…¥ç´¯è®¡çµæ•åº¦çš„å½±å“æ¥è§£å†³è¿™ä¸€é—®é¢˜:æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æŠŠ$s(\cdot)$å®šä¹‰ä¸º$\bar{I}^{(t)}$å’Œ$\bar{U}^{(t)}$çš„ä¹˜ç§¯è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†ä¸€ä¸ªæ—¢è€ƒè™‘äº†ä¸‰å…ƒç»„æ‰€æœ‰å…ƒç´ ï¼Œåˆè€ƒè™‘äº†ç´¯è®¡çµæ•åº¦è¶³å¤Ÿå¹³æ»‘çš„ä¸€ä¸ªé‡è¦æ€§å‡½æ•°GLOBAL BUDGET SCHEDULERåœ¨ä½ç§©è‡ªé€‚åº”çš„æƒ…å†µä¸‹ï¼Œè°ƒæ•´ç§©è‡ªç„¶æ˜¯ä¸ºäº†æ§åˆ¶å‚æ•°é¢„ç®—ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†é¢„ç®—$b^{(t)}$å®šä¹‰ä¸ºæ‰€æœ‰å¢é‡çŸ©é˜µçš„æ€»ç§©ï¼Œå³æ€»å¥‡å¼‚å€¼çš„æ•°é‡å›æƒ³ä¸€ä¸‹ï¼Œé¢„ç®—åˆ†é…æ˜¯åœ¨å¾®è°ƒæœŸé—´è¿­ä»£æ‰§è¡Œçš„ã€‚ä¸ºäº†ä¾¿äºè®­ç»ƒï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªå…¨å±€é¢„ç®—è°ƒåº¦å™¨ã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬ä»ç•¥é«˜äºç›®æ ‡é¢„ç®—$b^{(T)}$çš„åˆå§‹é¢„ç®—ç®—$b^{(0)}$å¼€å§‹(ä¾‹å¦‚ï¼Œ$b^{(T)}$çš„1.5å€)æˆ‘ä»¬å°†æ¯ä¸ªå¢é‡çŸ©é˜µçš„åˆå§‹ç§©è®¾ä¸º$r=\frac{b^{(0)}}{n}$ã€‚æˆ‘ä»¬å¯¹$t_{\text {init }}$æ­¥è¿›è¡Œwarmupï¼Œç„¶åæŒ‰ç…§ä¸‰æ¬¡è®¡åˆ’å‡å°‘é¢„ç®—$b^{(t)}$ï¼Œç›´åˆ°è¾¾åˆ°$b^{(t)}$æœ€åï¼Œæˆ‘ä»¬å¾—åˆ°çš„ä¿®æ­£å®Œé¢„ç®—åˆ†å¸ƒï¼Œå¹¶å¯¹$t_{\text {final }}$æ­¥éª¤çš„æ¨¡å‹è¿›è¡Œäº†å¾®è°ƒè¿™ä½¿å¾—AdaLoRAå¯ä»¥å…ˆæ¢ç´¢å‚æ•°ç©ºé—´ï¼Œç„¶åå†å…³æ³¨æœ€é‡è¦çš„æƒé‡å®éªŒéªŒè¯QLORAFineTune -&gt; P_tuning -&gt; P_tuning V2 -&gt; LoRA -&gt; QLoRABERT AdapterRLHFå…¥é—¨ã€‘å¤§è¯­è¨€æ¨¡å‹å¸¸ç”¨å¾®è°ƒæ¡†æ¶ä»‹ç»ï½œLoRA&amp;Prefix-Tuning&amp;Prompt-Tuning&amp;P-Tuning v2&amp;RLHFå¾®è°ƒåŸç†ç®€ä»‹RLHF: Reinforcement Learning from Humanã€‚Feedbackï¼Œå³åŸºäºäººå·¥åé¦ˆæœºåˆ¶çš„å¼ºåŒ–å­¦ä¹ ã€‚æœ€æ—©ä¸2022å¹´4æœˆï¼Œç”±OpenAIç ”ç©¶å›¢é˜Ÿç³»ç»Ÿæ€»ç»“å¹¶æå‡º.å¹¶åœ¨GPTæ¨¡å‹çš„å¯¹è¯ç±»ä»»åŠ¡å¾®è°ƒä¸­å¤§æ”¾å¼‚å½©ï¼Œè¢«ç§°ä¸ºChatGPTèƒŒåçš„åŠŸè‡£RLHFä¹Ÿæ˜¯ç›®å‰ä¸ºæ­¢å¸¸ç”¨çš„ã€æœ€ä¸ºå¤æ‚çš„åŸºäºå¼ºåŒ–å­¦ä¹ çš„å¤§è¯­è¨€æ¨¡å‹å¾®è°ƒæ–¹æ³•ï¼Œç›®å‰æœ€å¥½çš„ç«¯åˆ°ç«¯RLHFå®ç°æ˜¯DeepSpeedChatåº“ï¼Œç”±å¾®è½¯å¼€æºå¹¶ç»´æŠ¤åŸºäºå¼ºåŒ–å­¦ä¹ çš„è¿›é˜¶å¾®è°ƒæ–¹æ³•RLHFæ–¹æ³•è®ºæ–‡åœ°å€: https://arxiv.org/abs/2203.02155æ­¥éª¤1: ç›‘ç£å¾®è°ƒ (SFT)-ä¸€ ä½¿ç”¨ç²¾é€‰çš„äººç±»å›ç­”æ¥å¾®è°ƒé¢„è®­ç»ƒçš„è¯­è¨€æ¨¡å‹ä»¥åº”å¯¹å„ç§æŸ¥è¯¢æ­¥éª¤2:å¥–åŠ±æ¨¡å‹å¾®è°ƒ â€” ä½¿ç”¨ä¸€ä¸ªåŒ…å«äººç±»å¯¹åŒä¸€æŸ¥è¯¢çš„å¤šä¸ªç­”æ¡ˆæ‰“åˆ†çš„æ•°æ®é›†æ¥è®­ç»ƒä¸€ä¸ªç‹¬ç«‹çš„ (é€šå¸¸æ¯” SFT å°çš„) å¥–åŠ±æ¨¡å‹ (RW) æ­¥éª¤3: RLHF è®­ç»ƒ â€”åˆ©ç”¨ Proximal Policy Optimization (PPO) ç®—æ³•æ ¹æ® RW æ¨¡å‹çš„å¥–åŠ±Dä¹å¤©Hectoråé¦ˆè¿›ä¸€æ­¥å¾®è°ƒ SFT æ¨¡å‹ã€‚Flash_Atten(è½¬)å‰ç½®çŸ¥è¯† GPU Arch:è‡ªé¡¶å‘ä¸‹åˆ†æ + Bç«™ GPU Archï¼šè‡ªé¡¶å‘ä¸‹åˆ†æã€æµ…è°ˆåº•å±‚Â·1ã€‘éšç€äººå·¥æ™ºèƒ½ç‰¹åˆ«æ˜¯ä»¥GPTä¸ºä»£è¡¨çš„ç”Ÿæˆå¼AIçš„è¿…çŒ›å‘å±•ï¼ŒGPUå·²ç»æˆä¸ºäº†ä¸€ç§ä¸å¯æˆ–ç¼ºçš„å·¥å…·ï¼Œç”šè‡³ä¼ä¸šéƒ½ä»¥æ‹¥æœ‰å¤šå°‘é«˜ç«¯GPUä½œä¸ºæŠ“ä½é£å£èƒ½åŠ›çš„è¡¡é‡æ ‡å‡†ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒCPUè™½ç„¶åœ¨ä¼ ç»Ÿè®¡ç®—é¢†åŸŸå æ®ä¸»å¯¼åœ°ä½ï¼Œä½†åœ¨å¤„ç†AIä»»åŠ¡æ—¶å´ä¸åŠGPUå‡ºè‰²ä¸ºä»€ä¹ˆAIè®¡ç®—é€šå¸¸é€‰æ‹©GPUè€Œä¸æ˜¯CPUï¼Œåˆ†æGPUåœ¨AIè®¡ç®—ä¸­çš„ä¼˜åŠ¿ï¼ŒåŒæ—¶ï¼Œä»åº•å±‚åŸç†æ¢è®¨ä»Voltaåˆ°æœ€æ–°çš„Hopperå››ä»£NVIDIA GPUæ¶æ„çš„æ¼”è¿›ï¼Œå±•ç¤ºå…¶ä¸æ–­æå‡çš„æ€§èƒ½å’ŒåŠŸèƒ½GPUä¸»è¦ç”±è®¡ç®—å•å…ƒALUç»„æˆã€‚CPUä¸ä»…è¢«Cacheå æ®äº†å¤§é‡ç©ºé—´ï¼Œè€Œä¸”è¿˜æœ‰æœ‰å¤æ‚çš„æ§åˆ¶é€»è¾‘å’Œè¯¸å¤šä¼˜åŒ–ç”µè·¯ï¼Œç›¸æ¯”ä¹‹ä¸‹ï¼Œè®¡ç®—èƒ½åŠ›åªæ˜¯CPUå¾ˆå°çš„ä¸€éƒ¨åˆ†é€šè¿‡ä¸Šé¢è‡ªé¡¶å‘ä¸‹çš„åˆ†æï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œå¯¹äºGPUä¸­çš„å­˜å‚¨éƒ¨åˆ†è®¿é—®é€Ÿåº¦ç”±å¿«åˆ°æ…¢ï¼Œè®¡ç®—éƒ¨åˆ†ä»å¤§åˆ°å°æ’åˆ—ä¸ºNVLinkæ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆéœ€è¦ä»–ï¼Ÿå¤§æ¨¡å‹é€šå¸¸å…·æœ‰å·¨å¤§çš„å‚æ•°æ•°é‡å’Œå¤æ‚çš„ç»“æ„ï¼Œéœ€è¦å¤„ç†å¤§é‡çš„æ•°æ®ã€‚åˆ†å¸ƒå¼è®­ç»ƒå°†è¿™äº›å¤§å‹æ¨¡å‹åˆ†å‰²æˆå¤šä¸ªéƒ¨åˆ†ï¼Œç”±å¤šä¸ªGPUæˆ–è®¡ç®—èŠ‚ç‚¹å¹¶è¡Œå¤„ç†ï¼Œæ¯ä¸ªéƒ¨åˆ†å¤„ç†è‡ªå·±çš„æ•°æ®å­é›†ã€‚ç„¶åé€šè¿‡å…¨å±€é€šä¿¡ï¼Œå‚æ•°åŒæ­¥ç­‰æ–¹å¼è¿›è¡Œæ¢¯åº¦ä¼ æ’­ï¼Œæ­¤æ—¶GPUä¹‹é—´çš„é€šä¿¡å¸¦å®½å°±å˜çš„è¶Šæ¥è¶Šé‡è¦åœ¨NVLinkå‡ºç°ä¹‹å‰ï¼ŒGPUä¸GPUä¹‹é—´çš„æ•°æ®äº¤äº’é€šè¿‡PCIeï¼ˆPeripheral Component Interconnect Expressï¼‰æ€»çº¿è¿›è¡Œã€‚ä½†PCIeå­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼Œä¸€æ˜¯PCIeæ€»çº¿çš„å¸¦å®½ç›¸å¯¹æœ‰é™ï¼Œå…¶ä¸­PCIe 4.0x16çš„æœ€å¤§å¸¦å®½ä¹Ÿå°±64GB/sï¼ŒäºŒæ˜¯PCIeæ€»çº¿çš„å»¶è¿Ÿç›¸å¯¹è¾ƒé«˜ï¼Œåœ¨GPUä¹‹é—´ä¼ è¾“æ•°æ®æ—¶ï¼Œæ¯æ¬¡æ•°æ®ä¼ è¾“éƒ½éœ€è¦é€šè¿‡CPUå’Œä¸»æœºå†…å­˜æ¥å®Œæˆã€‚è¿™ç§ä¼ è¾“è·¯å¾„ä¼šå¯¼è‡´é¢å¤–çš„å»¶è¿Ÿï¼Œå¹¶é™ä½æ•°æ®ä¼ è¾“çš„æ•ˆç‡ã€‚ç„¶è€Œï¼Œæ·±åº¦å­¦ä¹ åº”ç”¨ä¸­éœ€è¦æ›´é«˜çš„å¸¦å®½å’Œæ›´ä½çš„å»¶è¿Ÿï¼ŒPCIeæ˜¾ç„¶æ˜¯æ— æ³•æ»¡è¶³å½“ä¸‹çš„ç¥ç»ç½‘ç»œè®­ç»ƒéœ€æ±‚NVLinkåˆ©ç”¨é«˜å¸¦å®½ã€ä½å»¶è¿Ÿçš„é€šä¿¡é€šé“ï¼Œç›´æ¥å°†å¤šä¸ªGPUè¿æ¥åœ¨ä¸€èµ·ï¼Œå®ç°å¿«é€Ÿã€é«˜æ•ˆçš„æ•°æ®ä¼ è¾“å’Œå…±äº«ã€‚é€šè¿‡NVLinkï¼ŒGPUä¹‹é—´çš„æ•°æ®äº¤äº’å¯ä»¥ç›´æ¥åœ¨GPUä¹‹é—´è¿›è¡Œï¼Œè€Œæ— éœ€é€šè¿‡CPUå’Œä¸»æœºå†…å­˜ã€‚è¿™ç§ç›´æ¥å†…å­˜è®¿é—®ï¼ˆDMAï¼‰çš„æ–¹å¼å¤§å¤§å‡å°‘äº†æ•°æ®ä¼ è¾“çš„å¤åˆ¶å’Œå»¶è¿Ÿï¼Œæé«˜äº†æ•°æ®å…±äº«çš„æ•ˆç‡ã€‚æ­¤å¤–ï¼ŒNVLinkè¿˜æä¾›äº†ä¸€è‡´çš„å†…å­˜ç©ºé—´ï¼Œä½¿å¾—å¤šä¸ªGPUèƒ½å¤Ÿå…±äº«åŒä¸€ä»½å†…å­˜ï¼Œç®€åŒ–äº†ç¨‹åºè®¾è®¡å’Œæ•°æ®ç®¡ç†çš„å¤æ‚æ€§æ¦‚è¿°FlashAttention: Fast and Memory-Efficient Exact Attention with IO-Awareness Paper 2022FlashAttention: æ›´å¿«è®­ç»ƒæ›´é•¿ä¸Šä¸‹æ–‡çš„GPTTransformerä½œä¸ºGPTç±»æ¨¡å‹çš„åŸºç¡€æ¶æ„æä¾›äº†å¼ºå¤§çš„ç‰¹å¾å¤„ç†èƒ½åŠ›ï¼Œä½†æ˜¯å¤„ç†æ›´é•¿ä¸Šä¸‹æ–‡ä»ç„¶æ˜¯ä¸€ä¸ªæŒ‘æˆ˜ï¼Œå› ä¸ºæ ¸å¿ƒçš„è‡ªæ³¨æ„åŠ›æ¨¡å—åœ¨åºåˆ—é•¿åº¦ä¸Šå…·æœ‰O(N^2)çš„æ—¶é—´å’Œå†…å­˜å¤æ‚åº¦ğŸ˜“è¿™ç¯‡Flash Attentionçš„å·¥ä½œæ·±å…¥ç¡¬ä»¶ï¼Œæ–°æå‡ºäº†ä¸€ç§å…·æœ‰IOæ„ŸçŸ¥çš„ï¼Œå¿«é€Ÿçš„âš¡ï¸ï¼ŒèŠ‚çœå†…å­˜çš„ğŸ§ ï¼Œç²¾ç¡®çš„ğŸ¯æ³¨æ„åŠ›ç®—æ³•ã€‚ç›®å‰ï¼ŒFlash Attentionå·²ç»é›†æˆè‡³torch2.0ï¼Œå¹¶ä¸”ç¤¾åŒºä¹Ÿæä¾›äº†å¤šç§å®ç°78sçœ‹æ‡‚FlashAttentionã€æœ‰ç‚¹æ„æ€Â·1ã€‘ æ ¸å¿ƒè¦ç‚¹âš¡ï¸ä¸ºä»€ä¹ˆåŠ å¿«äº†è®¡ç®—ï¼ŸFasté™ä½äº†è€—æ—¶çš„HBMè®¿é—®æ¬¡æ•°ã€‚é‡‡ç”¨TilingæŠ€æœ¯åˆ†å—ä»HBMåŠ è½½æ•°æ®åˆ°SRAMè¿›è¡Œèåˆè®¡ç®—ğŸ§ ä¸ºä»€ä¹ˆèŠ‚çœäº†å†…å­˜ï¼ŸMemory-Efficientä¸å†å¯¹ä¸­é—´çŸ©é˜µSï¼ŒPè¿›è¡Œå­˜å‚¨ã€‚åœ¨åå‘çš„æ—¶å€™é€šè¿‡Recomputationé‡æ–°è®¡ç®—æ¥è®¡ç®—æ¢¯åº¦ğŸ¯ä¸ºä»€ä¹ˆæ˜¯ç²¾å‡†æ³¨æ„åŠ›ï¼ŸExact Attentionç®—æ³•æµç¨‹åªæ˜¯åˆ†å—è®¡ç®—ï¼Œæ— è¿‘ä¼¼æ“ä½œæå‡ºé—®é¢˜Transformerç»“æ„å·²æˆä¸ºè‡ªç„¶è¯­è¨€å¤„ç†å’Œå›¾åƒåˆ†ç±»ç­‰åº”ç”¨ä¸­æœ€å¸¸ç”¨çš„æ¶æ„ã€‚å°½ç®¡Transformeråœ¨è§„æ¨¡ä¸Šä¸æ–­å¢å¤§å’ŒåŠ æ·±ï¼Œä½†å¤„ç†æ›´é•¿ä¸Šä¸‹æ–‡ä»ç„¶æ˜¯ä¸€ä¸ªæŒ‘æˆ˜ï¼Œå› ä¸ºæ ¸å¿ƒçš„è‡ªæ³¨æ„åŠ›æ¨¡å—åœ¨åºåˆ—é•¿åº¦ä¸Šå…·æœ‰äºŒæ¬¡æ–¹çš„æ—¶é—´å’Œå†…å­˜å¤æ‚åº¦ã€‚è¿™å¯¼è‡´åœ¨å¤„ç†é•¿åºåˆ—æ—¶é€Ÿåº¦å˜æ…¢ä¸”å†…å­˜éœ€æ±‚å·¨å¤§ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¸€äº›ä¼˜åŒ–ç®—æ³•æ¥æé«˜æ³¨æ„åŠ›æ¨¡å—çš„è®¡ç®—é€Ÿåº¦å’Œå†…å­˜åˆ©ç”¨ç‡è§£å†³æ–¹æ¡ˆForwardStandard Attentionåœ¨æ³¨æ„åŠ›çš„ä¸€èˆ¬å®ç°ä¸­ï¼Œå¯¹$\mathbf{Q}, \mathbf{K}, \mathbf{V} \in \mathbb{R}^{N \times d}$ ä¸‰ä¸ªè¾“å…¥æ‰§è¡Œä»¥ä¸‹ç®—æ³•å¾—åˆ°è¾“å‡º$\mathbf{O}$ï¼Œå…¶ä¸­softmaxè¡Œçº§åˆ«æ‰§è¡Œåœ¨è¿™ä¸ªç®—æ³•ä¸­ï¼Œ$\mathbf{S}$ï¼Œ$\mathbf{P}$çŸ©é˜µéƒ½æ˜¯å¾ˆå¤§ï¼Œéœ€è¦åœ¨HBMä¸­å®ä¾‹åŒ–æ¥è¿›è¡Œå­˜å‚¨ï¼Œè¿™æ ·å°±ä¼šå¸¦æ¥å¾ˆå¤šHBMçš„è®¿é—®æ¬¡æ•°ï¼Œ æœ€ç»ˆä½“ç°åˆ°ç®—æ³•æ—¶é—´ç«¯åˆ°ç«¯è¾ƒé•¿çš„å»¶è¿ŸFlashAttention(Tiling)ç†è®ºåŸºç¡€åœ¨ä¼ ç»Ÿç®—æ³•ä¸­ï¼Œä¸€ç§æ–¹å¼æ˜¯å°†Maskå’ŒSoftMaxéƒ¨åˆ†èåˆï¼Œä»¥å‡å°‘è®¿å­˜æ¬¡æ•°ã€‚ç„¶è€Œï¼ŒFlashAttentionåˆ™æ›´åŠ æ¿€è¿›ï¼Œå®ƒå°†ä»è¾“å…¥$\mathbf{Q}, \mathbf{K}, \mathbf{V}$åˆ°è¾“å‡º$\mathbf{O}$çš„æ•´ä¸ªè¿‡ç¨‹è¿›è¡Œèåˆï¼Œä»¥é¿å…$\mathbf{S}$ï¼Œ$ \mathbf{P}$çŸ©é˜µçš„å­˜å‚¨å¼€é”€ï¼Œå®ç°ç«¯åˆ°ç«¯çš„å»¶è¿Ÿç¼©å‡ã€‚ç„¶è€Œï¼Œç”±äºè¾“å…¥çš„é•¿åº¦$N$é€šå¸¸å¾ˆé•¿ï¼Œæ— æ³•å®Œå…¨å°†å®Œæ•´çš„$\mathbf{Q}, \mathbf{K}, \mathbf{V}, \mathbf{O}$åŠä¸­é—´è®¡ç®—ç»“æœå­˜å‚¨åœ¨SRAMä¸­ã€‚å› æ­¤ï¼Œéœ€è¦ä¾ èµ–HBMè¿›è¡Œè®¿å­˜æ“ä½œï¼Œä¸åŸå§‹è®¡ç®—å»¶è¿Ÿç›¸æ¯”æ²¡æœ‰å¤ªå¤§å·®å¼‚ï¼Œç”šè‡³ä¼šå˜æ…¢(æ²¡å…·ä½“æµ‹)ä¸ºäº†è®©è®¡ç®—è¿‡ç¨‹çš„ç»“æœå®Œå…¨åœ¨SRAMä¸­ï¼Œæ‘†è„±å¯¹HBMçš„ä¾èµ–ï¼Œå¯ä»¥é‡‡ç”¨åˆ†ç‰‡æ“ä½œï¼Œæ¯æ¬¡è¿›è¡Œéƒ¨åˆ†è®¡ç®—ï¼Œç¡®ä¿è¿™äº›è®¡ç®—ç»“æœèƒ½åœ¨SRAMå†…è¿›è¡Œäº¤äº’ï¼Œå¾…å¾—åˆ°å¯¹åº”çš„ç»“æœåå†è¿›è¡Œè¾“å‡ºè¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¹‹å‰å¯¹äºsoftmaxçš„è®¡ç®—æ˜¯ä»¥è¡Œä¸ºå•ä½çš„ï¼Œå¦‚ä¸‹æ‰€ç¤º:å½“æˆ‘ä»¬å°†è¾“å…¥è¿›è¡Œåˆ†ç‰‡åï¼Œæ— æ³•å¯¹å®Œæ•´çš„è¡Œæ•°æ®æ‰§è¡ŒSoftmaxæ“ä½œã€‚è¿™æ˜¯å› ä¸ºSoftmaxå‡½æ•°åœ¨è®¡ç®—æ—¶éœ€è¦è€ƒè™‘æ•´ä¸ªè¡Œçš„æ•°æ®ç„¶è€Œï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹æ‰€ç¤ºæ–¹æ³•æ¥è·å¾—ä¸å®Œæ•´è¡ŒSoftmaxç›¸åŒçš„ç»“æœï¼Œè€Œæ— éœ€ä½¿ç”¨è¿‘ä¼¼æ“ä½œå…·ä½“çš„åˆ†å—softmaxä»£ç æ¼”ç¤º12345678910111213141516171819202122232425262728293031323334353637383940import torchq = torch.tensor([1,2]).float()v = torch.tensor([1,2]).float()q_sm = torch.softmax(q, 0)print(q_sm)   # tensor([0.2689, 0.7311])torch.dot(q_sm, v)  # tensor(1.7311)m_pre = float(&quot;-inf&quot;)l_pre = 0cur_sum = 0block1 = torch.tensor([1]).float()# get cur max valuem_cur = max(torch.max(block1), m_pre)# scale pre log value by max expl_pre *= torch.exp(m_pre - m_cur)# calculate current log sump = torch.exp(block1 - m_cur)l_cur = torch.sum(p) + l_pre# scale pre result by log sumcur_sum = cur_sum * l_pre / l_curp = p / l_curcur_sum = 1 * p[0]l_pre = l_curm_pre = m_curprint(cur_sum)   # tensor(1.)block2 = torch.tensor([2]).float()m_cur = max(torch.max(block2), m_pre)l_pre *= torch.exp(m_pre - m_cur)p = torch.exp(block2 - m_cur)l_cur = torch.sum(p) + l_precur_sum = cur_sum * l_pre / l_curp = p / l_curcur_sum += 2 * p[0]print(cur_sum)   # tensor(1.7311)ä»£ç å®ç°1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374@triton.jitdef _fwd_kernel(    Q, K, V, sm_scale,    L, M,    Out,    stride_qz, stride_qh, stride_qm, stride_qk,    stride_kz, stride_kh, stride_kn, stride_kk,    stride_vz, stride_vh, stride_vk, stride_vn,    stride_oz, stride_oh, stride_om, stride_on,    Z, H, N_CTX,    BLOCK_M: tl.constexpr, BLOCK_DMODEL: tl.constexpr,    BLOCK_N: tl.constexpr,):    start_m = tl.program_id(0)    off_hz = tl.program_id(1)    # initialize offsets    offs_m = start_m * BLOCK_M + tl.arange(0, BLOCK_M)    offs_n = tl.arange(0, BLOCK_N)    offs_d = tl.arange(0, BLOCK_DMODEL)    off_q = off_hz * stride_qh + offs_m[:, None] * stride_qm + offs_d[None, :] * stride_qk    off_k = off_hz * stride_qh + offs_n[None, :] * stride_kn + offs_d[:, None] * stride_kk    off_v = off_hz * stride_qh + offs_n[:, None] * stride_qm + offs_d[None, :] * stride_qk    # Initialize pointers to Q, K, V    q_ptrs = Q + off_q    k_ptrs = K + off_k    v_ptrs = V + off_v    # initialize pointer to m and l    m_prev = tl.zeros([BLOCK_M], dtype=tl.float32) - float(&quot;inf&quot;)    l_prev = tl.zeros([BLOCK_M], dtype=tl.float32)    acc = tl.zeros([BLOCK_M, BLOCK_DMODEL], dtype=tl.float32)    # load q: it will stay in SRAM throughout    q = tl.load(q_ptrs)    # loop over k, v and update accumulator    for start_n in range(0, (start_m + 1) * BLOCK_M, BLOCK_N):        # -- compute qk ----        k = tl.load(k_ptrs)        qk = tl.zeros([BLOCK_M, BLOCK_N], dtype=tl.float32)        qk += tl.dot(q, k)        qk *= sm_scale        qk = tl.where(offs_m[:, None] &gt;= (start_n + offs_n[None, :]), qk, float(&quot;-inf&quot;))        # compute new m        m_curr = tl.maximum(tl.max(qk, 1), m_prev)        # correct old l        l_prev *= tl.exp(m_prev - m_curr)        # attention weights        p = tl.exp(qk - m_curr[:, None])        l_curr = tl.sum(p, 1) + l_prev        # rescale operands of matmuls        l_rcp = 1. / l_curr        p *= l_rcp[:, None]        acc *= (l_prev * l_rcp)[:, None]        # update acc        p = p.to(Q.dtype.element_ty)        v = tl.load(v_ptrs)        acc += tl.dot(p, v)        # update m_i and l_i        l_prev = l_curr        m_prev = m_curr        # update pointers        k_ptrs += BLOCK_N * stride_kn        v_ptrs += BLOCK_N * stride_vk    # rematerialize offsets to save registers    start_m = tl.program_id(0)    offs_m = start_m * BLOCK_M + tl.arange(0, BLOCK_M)    # write back l and m    l_ptrs = L + off_hz * N_CTX + offs_m    m_ptrs = M + off_hz * N_CTX + offs_m    tl.store(l_ptrs, l_prev)    tl.store(m_ptrs, m_prev)    # initialize pointers to output    offs_n = tl.arange(0, BLOCK_DMODEL)    off_o = off_hz * stride_oh + offs_m[:, None] * stride_om + offs_n[None, :] * stride_on    out_ptrs = Out + off_o    tl.store(out_ptrs, acc)IOå¤æ‚åº¦åˆ†æStandard Attentionå¯¹äºæ ‡å‡†æ³¨æ„åŠ›å®ç°ï¼ŒåˆæœŸæˆ‘ä»¬éœ€è¦æŠŠè¾“å…¥ $\mathbf{Q}, \mathbf{K}, \mathbf{V}$ä»HBMä¸­è¯»å–ï¼Œå¹¶è®¡ç®—å®Œæ¯•åæŠŠè¾“å‡º$\mathbf{O}$å†™å…¥åˆ°HBMä¸­ç¬¬ä¸€æ­¥æŠŠ$\mathbf{Q}, \mathbf{K}$è¯»å–å‡ºæ¥è®¡ç®—å‡º$\mathbf{S}=\mathbf{Q} \mathbf{K}^{\top}$ï¼Œç„¶åæŠŠ$\mathbf{S}$å­˜å›å»ï¼Œå†…å­˜è®¿é—®å¤æ‚åº¦$\Theta\left(N d+N^{2}\right)$ç¬¬äºŒæ­¥æŠŠ$\mathbf{S}$è¯»å–å‡ºæ¥è®¡ç®—å‡º$\mathbf{P}=\operatorname{softmax}(\mathbf{S})$ï¼Œç„¶åæŠŠ$\mathbf{P}$å­˜å›å»ï¼Œå†…å­˜è®¿é—®å¤æ‚åº¦$\Theta\left(N^{2}\right)$ç¬¬ä¸‰æ­¥æŠŠ$\mathbf{V}, \mathbf{P}$è¯»å–å‡ºæ¥è®¡ç®—å‡º$\mathbf{O}=\mathbf{P V}$ï¼Œç„¶åè®¡ç®—å‡ºç»“æœ$\mathbf{O}$ï¼Œå†…å­˜è®¿é—®å¤æ‚åº¦$\Theta\left(N d+N^{2}\right)$ç»¼ä¸Šæ‰€è¿°ï¼Œæ•´ä½“çš„å†…å­˜è®¿é—®å¤æ‚åº¦ä¸º$\Theta\left(N d+N^{2}\right)$FlashAttentionå¯¹äºFlashAttentionï¼Œæˆ‘ä»¬è®¾ç½®ä¸€ä¸ªåˆ†å—å¤§å°æ¥æŠŠåˆ†æˆå—ï¼Œå¯¹äºçš„æ¯ä¸€å—éƒ½è¦æŠŠéƒ¨åˆ†çš„å…¨éƒ¨å…ƒç´ Loadä¸€éï¼Œè¿™æ ·åˆ™æœ‰FlashAttentionçš„å†…å­˜è®¿é—®å¤æ‚åº¦ä¸ºåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬éœ€è¦ä¸¤ä¸ªåˆ†å—å¤§å°ï¼Œçš„åˆ†å—å¤§å°ï¼Œçš„åˆ†å—å¤§å°ï¼Œæˆ‘ä»¬è®¾å®šSRAMçš„å¤§å°ä¸ºï¼Œä¸ºäº†èƒ½æŠŠåˆ†å—åçš„æ”¾è¿›SRAMï¼Œé‚£ä¹ˆåˆ™æœ‰ä¸€ä¸‹é™åˆ¶:ç›¸åº”çš„ï¼Œ$\mathbf{Q}, \mathbf{O} \in \mathbb{R}^{B_{r} \times d}$æœ‰å¦‚ä¸‹é™åˆ¶:æœ€ç»ˆï¼Œè¿˜æœ‰ä¸€ä¸ªä¸­é—´æ€éœ€è¦å­˜å‚¨ï¼Œåˆ™æœ‰å¦‚ä¸‹é™åˆ¶:ç»¼ä¸Šï¼Œé™åˆ¶å¦‚ä¸‹è¿›è€Œæ¨å‡ºé‚£ä¹ˆåœ¨$M=\Theta(N d)$ çš„å‰æä¸‹ï¼Œåˆ™æœ‰FlashAttentionçš„HBMå†…å­˜è®¿é—®å¤æ‚åº¦ä¸ºï¼šåœ¨è¯­è¨€å»ºæ¨¡ä¸­ï¼Œé€šå¸¸æœ‰ï¼Œåˆ™æœ‰ã€‚è¿™æ ·ï¼Œåœ¨å‰å‘çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬é‡‡ç”¨åˆ†å—è®¡ç®—çš„æ–¹å¼ï¼Œé¿å…äº†çŸ©é˜µçš„å­˜å‚¨å¼€é”€ï¼Œæ•´ä½“çš„è¿ç®—éƒ½åœ¨SRAMå†…è¿›è¡Œï¼Œé™ä½äº†HBMè®¿é—®æ¬¡æ•°ï¼Œå¤§å¤§æå‡äº†è®¡ç®—çš„é€Ÿåº¦ï¼Œå‡å°‘äº†å¯¹å­˜å‚¨çš„æ¶ˆè€—Backwardç†è®ºåŸºç¡€åœ¨ä¸Šé¢å‰å‘çš„æ—¶å€™æˆ‘ä»¬ä¸ºäº†å‡å°‘HBMè®¿å­˜æ¬¡æ•°ï¼Œé™ä½å†…å­˜æ¶ˆè€—é‡ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰å¯¹$\mathbf{S}, \mathbf{P}$çŸ©é˜µè¿›è¡Œå­˜å‚¨ï¼Œè€Œè¿™ä¸ªåœ¨åå‘ä¼ æ’­è®¡ç®—æ¢¯åº¦çš„æ—¶å€™ç¡®å®éœ€è¦çš„ä¸€ä¸ªä¿¡æ¯ä¹‹å‰æœ‰é€šè¿‡Gradient checkpointingçš„æ–¹å¼æ¥å®ç°æ¢¯åº¦å®ç°åœ¨å‰å‘çš„æ—¶å€™æ›´åŠ èŠ‚çœå†…å­˜æˆ‘ä»¬è¿™é‡Œåˆ™é‡‡ç”¨é‡æ–°è®¡ç®—çš„æ–¹å¼æ¥è®¡ç®—å¯¹åº”çš„æ¢¯åº¦ã€‚åœ¨ä¸Šé¢å‰å‘è®¡ç®—çš„æ—¶å€™æˆ‘ä»¬ä¸ä¼šå­˜å‚¨$\mathbf{S}, \mathbf{P}$çŸ©é˜µï¼Œä½†æ˜¯æˆ‘ä»¬ä¼šå­˜å‚¨å¯¹åº”çš„æŒ‡æ•°é¡¹ä¹‹å’Œ$L$æ¥è¿›è¡Œæ¢¯åº¦çš„è®¡ç®—æˆ‘ä»¬åœ¨åå‘çš„è¿‡ç¨‹ä¸­æœ€é‡è¦çš„äº‹æƒ…å°±æ˜¯å°±æ˜¯Losså‡½æ•°$\phi$å¯¹$\mathbf{Q}, \mathbf{K}, \mathbf{V}, \mathbf{O}$å¯¹åº”çš„æ¢¯åº¦$\mathbf{O}$å¯¹åº”çš„æ¢¯åº¦æœ€å¥½è®¡ç®—$\mathbf{d} \mathbf{O}=\frac{\partial \phi}{\partial \mathbf{O}}$ï¼Œå…¶ä¸­$\mathbf{O}$æ˜¯ç°æˆçš„$\mathbf{V}$å¯¹åº”çš„æ¢¯åº¦ä¹Ÿå¾ˆå¥½è®¡ç®—ï¼Œç”±äº$\mathbf{O}=\mathbf{P V}$ï¼Œæ ¹æ®é“¾å¼æ±‚å¯¼æ³•åˆ™å’ŒçŸ©é˜µæ±‚å¯¼æ³•åˆ™åˆ™æœ‰$\mathbf{d V}=\mathbf{P}^{T} \mathbf{d} \mathbf{O}$ï¼Œæ›´è¯¦ç»†å¦‚ä¸‹æ‰€ç¤º:$\mathbf{Q}, \mathbf{K}$å¯¹åº”çš„æ¢¯åº¦ç®—èµ·æ¥å°±æ¯”è¾ƒå¤æ‚ä¸€ç‚¹ã€‚è¿™ä¸¤ä¸ªç»è¿‡çš„è®¡ç®—é€»è¾‘æ­¥éª¤æ›´å¤šï¼Œæˆ‘ä»¬å¯ä»¥ä¸€æ­¥ä¸€æ­¥çš„æ¥è¿›è¡Œè®¡ç®—ã€‚æˆ‘ä»¬å¯ä»¥å…ˆè®¡ç®—$\mathbf{d P}$ï¼Œ$\mathbf{d S}$ã€‚ç”±äº$\mathbf{O}=\mathbf{P V}$ ï¼Œåˆ™æœ‰$\mathbf{d P}$å¦‚ä¸‹è¡¨ç¤ºFact: $y=\operatorname{softmax}(x)$çš„é›…å„æ¯”çŸ©é˜µä¸º$\operatorname{diag}(y)-y y^{T}$ï¼Œå…·ä½“æ¨å¯¼è§Derivative of the Softmax Function and the Categorical Cross-Entropy Lossç”±äºï¼Œ æ ¹æ®ä¸Šè¿°å®šç†åˆ™æœ‰:æ¥ä¸‹æ¥æˆ‘ä»¬å®šä¹‰å¦‚ä¸‹è¡¨ç¤º:æ ¹æ®ä¸Šè¿°å®šä¹‰ç®€åŒ–ä¸Šä¸Šå¼åˆ™æœ‰å¦‚ä¸‹è¡¨ç¤º:ç›¸åº”çš„$d \mathbf{S}$å¯è¡¨ç¤ºä¸ºå¦‚ä¸‹å½¢å¼:åˆå› ä¸ºï¼Œç»“åˆä¸Šè¿°æ¨å¯¼åˆ©ç”¨é“¾å¼æ±‚å¯¼æ³•åˆ™å¯¹åº”çš„æ¢¯åº¦æœ‰å¦‚ä¸‹è¡¨ç¤ºï¼šè‡³æ­¤ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªå®Œæ•´çš„åŒ…å«å‰å‘å’Œåå‘çš„ï¼Œé™ä½äº†HBMè®¿é—®æ¬¡æ•°çš„ï¼Œæ–°çš„Attentionç®—å­ä»£ç å®ç°12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182@triton.jitdef _bwd_kernel(    Q, K, V, sm_scale, Out, DO,    DQ, DK, DV,    L, M,    D,    stride_qz, stride_qh, stride_qm, stride_qk,    stride_kz, stride_kh, stride_kn, stride_kk,    stride_vz, stride_vh, stride_vk, stride_vn,    Z, H, N_CTX,    num_block,    BLOCK_M: tl.constexpr, BLOCK_DMODEL: tl.constexpr,    BLOCK_N: tl.constexpr,):    off_hz = tl.program_id(0)    off_z = off_hz // H    off_h = off_hz % H    # offset pointers for batch/head    Q += off_z * stride_qz + off_h * stride_qh    K += off_z * stride_qz + off_h * stride_qh    V += off_z * stride_qz + off_h * stride_qh    DO += off_z * stride_qz + off_h * stride_qh    DQ += off_z * stride_qz + off_h * stride_qh    DK += off_z * stride_qz + off_h * stride_qh    DV += off_z * stride_qz + off_h * stride_qh    for start_n in range(0, num_block):        lo = start_n * BLOCK_M        # initialize row/col offsets        offs_qm = lo + tl.arange(0, BLOCK_M)        offs_n = start_n * BLOCK_M + tl.arange(0, BLOCK_M)        offs_m = tl.arange(0, BLOCK_N)        offs_k = tl.arange(0, BLOCK_DMODEL)        # initialize pointers to value-like data        q_ptrs = Q + (offs_qm[:, None] * stride_qm + offs_k[None, :] * stride_qk)        k_ptrs = K + (offs_n[:, None] * stride_kn + offs_k[None, :] * stride_kk)        v_ptrs = V + (offs_n[:, None] * stride_qm + offs_k[None, :] * stride_qk)        do_ptrs = DO + (offs_qm[:, None] * stride_qm + offs_k[None, :] * stride_qk)        dq_ptrs = DQ + (offs_qm[:, None] * stride_qm + offs_k[None, :] * stride_qk)        # pointer to row-wise quantities in value-like data        D_ptrs = D + off_hz * N_CTX        m_ptrs = M + off_hz * N_CTX        # initialize dv amd dk        dv = tl.zeros([BLOCK_M, BLOCK_DMODEL], dtype=tl.float32)        dk = tl.zeros([BLOCK_M, BLOCK_DMODEL], dtype=tl.float32)        # k and v stay in SRAM throughout        k = tl.load(k_ptrs)        v = tl.load(v_ptrs)        # loop over rows        for start_m in range(lo, num_block * BLOCK_M, BLOCK_M):            offs_m_curr = start_m + offs_m            # load q, k, v, do on-chip            q = tl.load(q_ptrs)            # recompute p = softmax(qk, dim=-1).T            # NOTE: `do` is pre-divided by `l`; no normalization here            qk = tl.dot(q, tl.trans(k))            qk = tl.where(offs_m_curr[:, None] &gt;= (offs_n[None, :]), qk, float(&quot;-inf&quot;))            m = tl.load(m_ptrs + offs_m_curr)            p = tl.exp(qk * sm_scale - m[:, None])            # compute dv            do = tl.load(do_ptrs)            dv += tl.dot(tl.trans(p.to(Q.dtype.element_ty)), do)            # compute dp = dot(v, do)            Di = tl.load(D_ptrs + offs_m_curr)            dp = tl.zeros([BLOCK_M, BLOCK_N], dtype=tl.float32) - Di[:, None]            dp += tl.dot(do, tl.trans(v))            # compute ds = p * (dp - delta[:, None])            ds = p * dp * sm_scale            # compute dk = dot(ds.T, q)            dk += tl.dot(tl.trans(ds.to(Q.dtype.element_ty)), q)            # compute dq            dq = tl.load(dq_ptrs)            dq += tl.dot(ds.to(Q.dtype.element_ty), k)            tl.store(dq_ptrs, dq)            # increment pointers            dq_ptrs += BLOCK_M * stride_qm            q_ptrs += BLOCK_M * stride_qm            do_ptrs += BLOCK_M * stride_qm        # write-back        dv_ptrs = DV + (offs_n[:, None] * stride_qm + offs_k[None, :] * stride_qk)        dk_ptrs = DK + (offs_n[:, None] * stride_kn + offs_k[None, :] * stride_kk)        tl.store(dv_ptrs, dv)        tl.store(dk_ptrs, dk)Block-Sparseç›¸æ¯”äºä¸Šé¢çš„å…¨é‡è®¡ç®—ï¼Œå—ç¨€ç–çš„FlashAttentionéœ€è¦é¢å¤–æä¾›ä¸€ä¸ªMaskçŸ©é˜µ$\tilde{\mathbf{M}} \in{0,1}^{N \times N}$ç”¨äºå°†ä¸€äº›å…ƒ ç´ ç½®é›¶æ¥ä¿è¯å—ç¨€ç–åŠ é€Ÿè®¡ç®—æœ¬ç« å¯¹äºå—ç¨€ç–çš„ä¸€ä¸ªè®¡ç®—åªæ˜¯ä¸€ä¸ªç®€å•çš„å°è¯•ï¼Œæ²¡æœ‰è¿›è¡Œå¤ªæ·±å…¥çš„æ¢ç´¢ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å…ˆä¸€ç¬”å¸¦è¿‡ï¼Œåé¢æˆ‘ä»¬å¯ä»¥è®²ä¸€ç¯‡å¯¹FlashAttentionè¿›è¡Œå—ç¨€ç–ä¼˜åŒ–çš„å·¥ä½œSCFAå®éªŒéªŒè¯é€šè¿‡å®éªŒéªŒè¯å‘ç°ï¼ŒFlashAttentionåœ¨é€Ÿåº¦å’Œå†…å­˜å ç”¨æ–¹é¢éƒ½è¡¨ç°å‡ºæ˜æ˜¾çš„ä¼˜åŠ¿ï¼Œå¹¶å–å¾—äº†è‰¯å¥½çš„æ•ˆæœç›®å‰ï¼ŒFlashAttentionå·²ç»ç»è¿‡å¹¿æ³›éªŒè¯, torch2.0ä¸­å·²æä¾›flashattentionçš„å®ç°æ­£å¦‚æ ‡é¢˜ã€ŠFast and Memory-Efficient Exact Attention with IO-Awarenessã€‹æ‰€ç¤ºï¼ŒFlashAttentionçš„ä¼˜ç‚¹åœ¨äºå……åˆ†è€ƒè™‘äº†åœ¨è®¡ç®—ä»»åŠ¡ä¸­IOçš„é‡è¦æ€§ï¼Œå¹¶é€šè¿‡åˆ†å—è®¡ç®—çš„æ–¹å¼å¼€å‘äº†ä¸€ç§å¿«é€Ÿã€èŠ‚çœæ˜¾å­˜ã€ç²¾ç¡®æ— è¿‘ä¼¼çš„æ³¨æ„åŠ›å®ç°æ–¹æ³•ã€‚è¿™ä½¿å¾—æˆ‘ä»¬æ›´ä¾¿äºè®­ç»ƒå…·æœ‰æ›´é•¿ä¸Šä¸‹æ–‡çš„Transformeræ¨¡å‹ï¼Œå¹¶ä¸”ä¸ºåç»­æ³¨æ„åŠ›ç®—æ³•çš„ä¼˜åŒ–æä¾›äº†ä¸€ä¸ªåŸºå‡†</content>
	</entry>
	<entry>
		<title>LLMæ¨¡å‹éƒ¨ç½²è°ƒè¯•æ¨ç†</title>
		<url>/article/24897.html</url>
		<content>LLMæ¨¡å‹ä»€ä¹ˆæ˜¯LLMï¼ˆå¤§è¯­éŸ³æ¨¡å‹ï¼‰æ¦‚è¿°Large Language Model(LLM)ï¼Œä¹Ÿç§°ä¸ºå¤§å‹è¯­è¨€æ¨¡å‹ï¼Œæ˜¯ä¸€ç§åŸºäºæœºå™¨å­¦ä¹ å’Œè‡ªç„¶è¯­è¨€å¤„ç†æŠ€æœ¯çš„æ¨¡å‹ï¼Œå®ƒé€šè¿‡å¯¹å¤§é‡çš„æ–‡æœ¬æ•°æ®è¿›è¡Œè®­ç»ƒï¼Œæ¥å­¦ä¹ æœåŠ¡äººç±»è¯­è¨€ç†è§£å’Œç”Ÿæˆçš„èƒ½åŠ›LLMçš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡å¤§è§„æ¨¡çš„æ— ç›‘ç£è®­ç»ƒæ¥å­¦ä¹ è‡ªç„¶è¯­è¨€çš„æ¨¡å¼å’Œè¯­è¨€ç»“æ„ï¼Œè¿™åœ¨ä¸€å®šç¨‹åº¦ä¸Šèƒ½å¤Ÿæ¨¡æ‹Ÿäººç±»çš„è¯­è¨€è®¤çŸ¥å’Œç”Ÿæˆè¿‡ç¨‹ä¸ä¼ ç»Ÿçš„NLPæ¨¡å‹ç›¸æ¯”ï¼ŒLLMèƒ½å¤Ÿæ›´å¥½åœ°ç†è§£å’Œç”Ÿæˆè‡ªç„¶æ–‡æœ¬ï¼ŒåŒæ—¶è¿˜èƒ½å¤Ÿè¡¨ç°å‡ºä¸€å®šçš„é€»è¾‘æ€ç»´å’Œæ¨ç†èƒ½åŠ›è¿‘å¹´æ¥ï¼ŒLLMå¾—åˆ°äº†å¹¿æ³›çš„åº”ç”¨ï¼Œå…¶ä¸­æœ€å…·ä»£è¡¨æ€§çš„æ˜¯è°·æ­Œçš„BERTå’ŒOpenAIçš„GPTç³»åˆ—ã€‚è¿™äº›æ¨¡å‹åœ¨å¤šä¸ªè‡ªç„¶è¯­è¨€å¤„ç†é¢†åŸŸå·²ç»å–å¾—äº†æ˜¾è‘—çš„æˆæœï¼ŒåŒ…æ‹¬æ–‡æœ¬åˆ†ç±»ã€å‘½åå®ä½“è¯†åˆ«ã€æƒ…æ„Ÿåˆ†æã€æœºå™¨ç¿»è¯‘ã€è‡ªåŠ¨é—®ç­”ç­‰ç„¶è€Œï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼ŒLLMé¢ä¸´ç€æ›´å¤šçš„æŒ‘æˆ˜é¦–å…ˆï¼ŒLLMéœ€è¦å¤§é‡çš„è®¡ç®—èµ„æºå’Œå¤§è§„æ¨¡çš„æ•°æ®é›†æ¥è®­ç»ƒï¼Œè¿™å¯¹äºä¸€èˆ¬çš„ä¼ä¸šå’Œä¸ªäººæ¥è¯´ååˆ†å›°éš¾å…¶æ¬¡ï¼Œç”±äºLLMæ¨¡å‹çš„å¤æ‚æ€§å’Œè®¡ç®—é‡è¾ƒå¤§ï¼Œå¯¹äºå®æ—¶çš„è¯­è¨€å¤„ç†åº”ç”¨æ¥è¯´ï¼ŒLLMåœ¨åº”ç”¨æ•ˆç‡å’Œå“åº”é€Ÿåº¦ä¸Šè¿˜å­˜åœ¨ä¸€å®šçš„å±€é™æ€§å› æ­¤ï¼Œå¦‚ä½•è§£å†³æ¨¡å‹è®­ç»ƒå’Œåº”ç”¨è¿‡ç¨‹ä¸­çš„è®¡ç®—æ€§èƒ½å’Œæ•ˆç‡é—®é¢˜ï¼Œæ˜¯LLMé¢ä¸´çš„ä¸»è¦æŒ‘æˆ˜ä¹‹ä¸€ä¸»è¦åº”ç”¨LLMåœ¨å®é™…åº”ç”¨ä¸­æœ‰å¤šç§å½¢å¼ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›å…·ä½“çš„ç¤ºä¾‹ï¼šè‡ªç„¶è¯­è¨€ç†è§£ï¼šé€šè¿‡è¯­æ³•è¯æ±‡ã€å¥æ³•è¯­ä¹‰ã€è¯­å¢ƒç­‰ç›¸äº’ä½œç”¨ï¼Œä½¿è®¡ç®—æœºèƒ½å¤Ÿç†è§£äººç±»è¯­è¨€ã€‚å¦‚é€šè¿‡è¯­éŸ³åˆæˆåŠŸèƒ½ï¼Œå®ç°æ–‡å­—è½¬è¯­éŸ³çš„æŠ€æœ¯ã€‚å¦å¤–ï¼ŒåŸºäºLLMæŠ€æœ¯çš„è‹±è¯­å­¦ä¹ Appå¯ä»¥é’ˆå¯¹ä¸åŒçš„ç”¨æˆ·è®©æœºå™¨è¿›è¡Œè‡ªé€‚åº”æ•™å­¦ï¼Œå¸®åŠ©ç”¨æˆ·æ›´åŠ é«˜æ•ˆåœ°å­¦ä¹ è‹±è¯­æœºå™¨ç¿»è¯‘ï¼šLLMå¯ä»¥åˆ©ç”¨å¤§é‡çš„æ–‡æœ¬æ•°æ®è¿›è¡Œç¿»è¯‘å­¦ä¹ ï¼Œæé«˜ç¿»è¯‘å‡†ç¡®åº¦å’Œè¯­éŸ³ç¿»è¯‘åº¦ï¼ŒåŒæ—¶åŠ é€Ÿç¿»è¯‘é€Ÿåº¦ï¼Œä¾‹å¦‚è°·æ­Œç¿»è¯‘ç­‰ä½“éªŒéƒ½æœ‰æ˜æ˜¾æå‡æƒ…æ„Ÿåˆ†æï¼šLLMæŠ€æœ¯å¯ä»¥é€šè¿‡å¯¹å¤§é‡æ•°æ®è¿›è¡Œåˆ†æï¼Œå®ç°å¯¹äººä»¬åœ¨ç¤¾äº¤åª’ä½“ä¸Šå¯¹å•†å“ã€æœåŠ¡å’Œå“ç‰Œç­‰çš„è¯„ä»·ï¼Œä»è€Œå¸®åŠ©ä¼ä¸šäº†è§£æ¶ˆè´¹è€…çš„å¿ƒæ€ï¼Œå¹¶æ ¹æ®æƒ…æ„Ÿä¿¡æ¯æ¥ä¼˜åŒ–å…¶è¥é”€ç­–ç•¥æœºå™¨å­¦ä¹ è¯­éŸ³è¯†åˆ«ï¼šåœ¨è¯­éŸ³è¯†åˆ«é¢†åŸŸï¼ŒLLMæŠ€æœ¯å¯ä»¥é€šè¿‡æ·±åº¦å­¦ä¹ ç®—æ³•ç­‰æŠ€æœ¯æ”¹è¿›ï¼Œä»è€Œåœ¨åˆ†è¾¨ç‡ã€å£°éŸ³é‡å ã€å™ªéŸ³å’Œå¤æ‚è¯­éŸ³è¯­è¨€ä¸­å®ç°æ›´å¥½çš„è¯­éŸ³è¯†åˆ«æ•ˆæœã€‚åŒæ—¶ï¼Œåœ¨è¯­éŸ³äº¤äº’ä¸Šï¼Œä¹Ÿå¯ä»¥è¿›è¡Œä¸€äº›åŸºäºLLMçš„å®šåˆ¶ï¼Œä¾‹å¦‚æ™ºèƒ½éŸ³ç®±ã€è¯­éŸ³æ¥å¾…å‘˜å’Œå®¢æˆ·æœåŠ¡æœºå™¨äººç­‰æ–‡æœ¬ç”Ÿæˆï¼šLLMæŠ€æœ¯åœ¨æ–‡æœ¬ç”Ÿæˆæ–¹é¢çš„åº”ç”¨å¯ä»¥åœ¨æ–‡æœ¬æ‘˜è¦ã€ç¿»è¯‘å’Œè‡ªåŠ¨åŒ–å†™ä½œç­‰æ–¹é¢è¿›è¡Œé€‚ç”¨ã€‚ä¾‹å¦‚ï¼ŒLLMæ¨¡å‹å¯ä»¥ä»çŸ­ç¯‡å°è¯´çš„èƒŒæ™¯ä¿¡æ¯ä¸­è‡ªåŠ¨ç”Ÿæˆæè¿°ã€å¯¹è¯ç­‰å†…å®¹ï¼ŒåŒæ—¶è¿˜å¯ä»¥é€šè¿‡å¯¹ä¸åŒé£æ ¼çš„æ–‡æœ¬è¿›è¡Œå­¦ä¹ ï¼Œå¹¶ä»ä¸­å­¦ä¹ åˆ›é€ æ€§çš„æ–‡æœ¬ç”ŸæˆGPUç¯å¢ƒé˜¿é‡Œäº‘è´­ä¹°ä¸€å°è‡ªå·±çš„GPUæœæœåŠ¡å™¨è´­ä¹°é˜¿é‡Œäº‘æœåŠ¡å™¨å¯ä»¥é€šè¿‡ä»¥ä¸‹æ­¥éª¤è¿›è¡Œï¼šè®¿é—®é˜¿é‡Œäº‘å®˜ç½‘å¹¶æ³¨å†Œä¸€ä¸ªè´¦æˆ·ç™»å½•æ‚¨çš„é˜¿é‡Œäº‘è´¦æˆ·ï¼Œé€‰æ‹©â€äº§å“ä¸æœåŠ¡â€ï¼Œç„¶åé€‰æ‹©â€äº‘æœåŠ¡å™¨ ECSâ€åœ¨äº‘æœåŠ¡å™¨ECSé¡µé¢ä¸Šï¼Œæ‚¨å¯ä»¥é€‰æ‹©ä¸åŒçš„å®ä¾‹ç±»å‹å’Œé…ç½®ï¼Œæ ¹æ®æ‚¨çš„éœ€æ±‚é€‰æ‹©é€‚åˆçš„æœåŠ¡å™¨è§„æ ¼ã€‚è¿™äº›è§„æ ¼åŒ…æ‹¬CPUã€å†…å­˜ã€å­˜å‚¨ç©ºé—´ç­‰é…ç½®ç½‘ç»œå’Œå®‰å…¨ç»„ï¼Œæ‚¨å¯ä»¥è®¾ç½®ç½‘ç»œç±»å‹ã€å…¬ç½‘å¸¦å®½ã€IPåœ°å€ç­‰æ ¹æ®æ‚¨çš„éœ€æ±‚é€‰æ‹©è´­ä¹°æ—¶é•¿ï¼Œå¯ä»¥é€‰æ‹©åŒ…å¹´åŒ…æœˆæˆ–æŒ‰å°æ—¶è®¡è´¹ï¼Œè¿™é‡Œå¦‚æœåªæ˜¯ä¸ºäº†æµ‹è¯•æˆ–ç©ä¸€ç©ï¼Œå¯ä»¥é€‰æ‹©æœ€ä¾¿å®œçš„æ–¹å¼é…ç½®ç³»ç»Ÿå’Œè½¯ä»¶ï¼Œæ‚¨å¯ä»¥é€‰æ‹©æ“ä½œç³»ç»Ÿå’Œå…¶ä»–è½¯ä»¶é¢„è£…é€‰é¡¹æŸ¥çœ‹è®¢å•å’Œä»·æ ¼ï¼Œç¡®è®¤æ— è¯¯åï¼Œç‚¹å‡»â€ç«‹å³è´­ä¹°â€åœ¨æ”¯ä»˜é¡µé¢é€‰æ‹©åˆé€‚çš„æ”¯ä»˜æ–¹å¼å®Œæˆè´­ä¹°å®Œæˆæ”¯ä»˜åï¼Œæ‚¨å°†æ”¶åˆ°è´­ä¹°æœåŠ¡å™¨çš„ç¡®è®¤ä¿¡æ¯å’ŒæœåŠ¡å™¨ç™»å½•å‡­è¯ç«¯å£å¼€æ”¾å®‰è£…åŸºç¡€çš„pythonç¯å¢ƒé¦–å…ˆå¤åˆ¶å…¬ç½‘ipï¼Œä½¿ç”¨sshå·¥å…·è¿æ¥è‡ªå·±çš„æœåŠ¡å™¨ï¼Œç”¨æˆ·åé»˜è®¤æ˜¯rootï¼Œå¯†ç ä¸ºè‡ªå®šä¹‰å¯†ç ï¼Œç™»é™†è¿›æ¥é¦–å…ˆä¼šç³»ç»Ÿåˆå§‹åŒ–GPUç¯å¢ƒï¼Œç­‰å¾…å®Œæˆåä¼šè‡ªåŠ¨é‡å¯è‡ªåŠ¨é‡å¯åï¼Œå¯ä»¥ç”¨nvidia-smiæŸ¥çœ‹nvidiaé©±åŠ¨é…ç½®å®‰è£…gitï¼Œåé¢å¾ˆå¤šé¡¹ç›®æˆ–è€…æ¨¡å‹ä¸‹è½½ä¼šç”¨åˆ°ï¼ŒåŒ…æ‹¬git lfs1234567# å®‰è£…gityum install git -y# å®‰è£…git lfsï¼ˆå¤§æ–‡ä»¶ä¸‹è½½ï¼‰curl -s https://packagecloud.io/install/repositories/github/git-lfs/script.rpm.sh | sudo bashyum install git-lfsgit lfs installå®‰è£…anacondaï¼Œå¹¶åˆ›å»ºè‡ªå·±çš„pythonç¯å¢ƒ1234567# å®‰è£…anacondaç¯å¢ƒwget https://repo.anaconda.com/archive/Anaconda3-2023.03-1-Linux-x86_64.shchmod +x Anaconda3-2023.03-1-Linux-x86_64.sh./Anaconda3-2023.03-1-Linux-x86_64.sh# åˆ›å»ºè‡ªå·±çš„pythonç¯å¢ƒconda create -n gpt310 python=3.10 anacondaå®‰è£…pytorchï¼Œè¿™é‡Œçš„cudaé€‰cu117ï¼Œå› ä¸ºä¸Šé¢çš„æœåŠ¡å™¨çš„cudaæ˜¯11.4çš„ï¼Œè¿™é‡Œçš„cu117æ˜¯å¯ä»¥å‘ä¸‹å…¼å®¹çš„12345# åˆ‡æ¢åˆ°gpt310source activate gpt310# å®‰è£…gpuç‰ˆçš„pytorch, éœ€è¦åœ¨GPUç¯å¢ƒä¸‹å®‰è£…ï¼Œå¦åˆ™å®‰è£…æ˜¯cpuç‰ˆæœ¬pip install torch==2.0.0+cu117 torchvision==0.15.1+cu117 torchaudio==2.0.1 --index-url https://download.pytorch.org/whl/cu117åœ¨Pythonä¸­å¯¼å…¥PyTorchå¹¶æ£€æŸ¥CUDAæ˜¯å¦å¯ç”¨1234567import torch# æ£€æŸ¥PyTorchæ˜¯å¦ä½¿ç”¨äº†CUDAif torch.cuda.is_available():    print(&quot;CUDAå¯ç”¨&quot;)else:    print(&quot;CUDAä¸å¯ç”¨&quot;)è¿˜å¯ä»¥ä½¿ç”¨torch.cuda.get_device_capability()å‡½æ•°æ¥è·å–è®¡ç®—æœºä¸Šæ”¯æŒçš„CUDAè®¾å¤‡çš„è®¡ç®—èƒ½åŠ›ã€‚è¿™å¯ä»¥å¸®åŠ©æ‚¨ç¡®å®šæ‰€å®‰è£…çš„CUDAç‰ˆæœ¬æ˜¯å¦ä¸æ‚¨çš„æ˜¾å¡å…¼å®¹ç”¨å®Œæœºå™¨è®°å¾—å…³æœºï¼Œä¸ç„¶ä¼šä¸€ç›´æ‰£è´¹AutoDLAutoDLå¹³å°ç®€ä»‹AutoDLç®—åŠ›å¹³å°æ˜¯æŒ‡ä¸ºè‡ªåŠ¨åŒ–æ·±åº¦å­¦ä¹ (AutoDL)ä»»åŠ¡æä¾›è®¡ç®—èµ„æºå’ŒåŸºç¡€è®¾æ–½çš„å¹³å°ã€‚ç”±äºæ·±åº¦å­¦ä¹ ä»»åŠ¡é€šå¸¸éœ€è¦å¤§é‡çš„è®¡ç®—èµ„æºå’Œå­˜å‚¨ç©ºé—´ï¼Œä¸ºäº†æœ‰æ•ˆåœ°æ‰§è¡ŒAutoDLä»»åŠ¡ï¼Œéœ€è¦å…·å¤‡ç›¸åº”çš„ç®—åŠ›å¹³å°ä¸€ä¸ªä¼˜ç§€çš„AutoDLç®—åŠ›å¹³å°é€šå¸¸å…·å¤‡ä»¥ä¸‹ç‰¹ç‚¹ï¼šé«˜æ€§èƒ½è®¡ç®—ï¼šæä¾›å¼ºå¤§çš„è®¡ç®—èƒ½åŠ›ï¼ŒåŒ…æ‹¬é«˜æ€§èƒ½çš„CPUã€GPUæˆ–ä¸“ç”¨çš„AIèŠ¯ç‰‡ç­‰ã€‚è¿™äº›è®¡ç®—èµ„æºå¯ä»¥æ”¯æŒAutoDLä»»åŠ¡çš„æ¨¡å‹è®­ç»ƒã€è¶…å‚æ•°æœç´¢å’Œæ¶æ„æœç´¢ç­‰è®¡ç®—å¯†é›†å‹ä»»åŠ¡åˆ†å¸ƒå¼è®¡ç®—ï¼šæ”¯æŒåˆ†å¸ƒå¼è®¡ç®—å’Œè®­ç»ƒï¼Œä½¿å¾—AutoDLä»»åŠ¡å¯ä»¥åœ¨å¤šä¸ªè®¡ç®—èŠ‚ç‚¹ä¸Šå¹¶è¡Œæ‰§è¡Œï¼Œä»è€ŒåŠ å¿«ä»»åŠ¡çš„å®Œæˆæ—¶é—´ã€‚è¿™å¯¹äºå¤§è§„æ¨¡æ•°æ®å’Œå¤æ‚æ¨¡å‹çš„AutoDLä»»åŠ¡å°¤ä¸ºé‡è¦æ•°æ®å­˜å‚¨å’Œç®¡ç†ï¼šæä¾›é«˜æ•ˆçš„æ•°æ®å­˜å‚¨å’Œç®¡ç†ç³»ç»Ÿï¼Œä»¥æ”¯æŒå¤§è§„æ¨¡æ•°æ®é›†çš„å­˜å‚¨å’Œè®¿é—®ã€‚è¿™å¯ä»¥ç¡®ä¿AutoDLä»»åŠ¡èƒ½å¤Ÿå¿«é€Ÿã€å¯é åœ°è®¿é—®æ‰€éœ€çš„è®­ç»ƒæ•°æ®å’ŒéªŒè¯æ•°æ®ä»»åŠ¡è°ƒåº¦å’Œèµ„æºç®¡ç†ï¼šå…·å¤‡ä»»åŠ¡è°ƒåº¦å’Œèµ„æºç®¡ç†åŠŸèƒ½ï¼Œå¯ä»¥æœ‰æ•ˆåœ°ç®¡ç†å¤šä¸ªAutoDLä»»åŠ¡çš„æ‰§è¡Œï¼ŒåŒ…æ‹¬èµ„æºåˆ†é…ã€ä¼˜å…ˆçº§ç®¡ç†å’Œä»»åŠ¡è°ƒåº¦ç­‰ï¼Œä»¥ä¿è¯ä»»åŠ¡çš„é¡ºåˆ©è¿›è¡Œæ˜“ç”¨æ€§å’Œçµæ´»æ€§ï¼šæä¾›å‹å¥½çš„ç”¨æˆ·ç•Œé¢å’Œå·¥å…·ï¼Œä½¿å¾—ç”¨æˆ·å¯ä»¥æ–¹ä¾¿åœ°é…ç½®å’Œç®¡ç†AutoDLä»»åŠ¡ã€‚åŒæ—¶ï¼Œæä¾›çµæ´»çš„é…ç½®é€‰é¡¹ï¼Œä»¥æ»¡è¶³ä¸åŒä»»åŠ¡å’Œéœ€æ±‚çš„å®šåˆ¶åŒ–è¦æ±‚AutoDLç®—åŠ›å¹³å°çš„è®¾è®¡å’ŒåŠŸèƒ½æ—¨åœ¨æä¾›é«˜æ•ˆã€å¯æ‰©å±•å’Œæ˜“ç”¨çš„è®¡ç®—èµ„æºï¼Œä»¥æ”¯æŒAutoDLä»»åŠ¡çš„å¿«é€Ÿè¿­ä»£å’Œå¤§è§„æ¨¡åº”ç”¨ã€‚å®ƒä»¬å¯ä»¥å¸®åŠ©ç ”ç©¶äººå‘˜å’Œå¼€å‘è€…æ›´åŠ ä¾¿æ·åœ°è¿›è¡ŒAutoDLå®éªŒå’Œæ¨¡å‹ä¼˜åŒ–ï¼Œä»è€Œæ¨åŠ¨è‡ªåŠ¨åŒ–æ·±åº¦å­¦ä¹ é¢†åŸŸçš„å‘å±•è´­ä¹°ç®—åŠ›é€‰æ‹©è®¡è´¹æ–¹å¼å’Œæ˜¾å¡é€‰æ‹©æ˜¯å¦éœ€è¦æ‰©å±•æ•°æ®ç›˜ï¼Œä»¥åŠåŸºç¡€é•œåƒï¼Œè¿™é‡Œé€‰Minicondaç¯å¢ƒå¯åŠ¨æœºå™¨ï¼Œè¿›å…¥ç»ˆç«¯å¯ä»¥çœ‹åˆ°12345678910111213141516171819+--------------------------------------------------AutoDL--------------------------------------------------------+ç›®å½•è¯´æ˜:â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—â•‘ç›®å½•             â•‘åç§°    â•‘é€Ÿåº¦â•‘è¯´æ˜                                                                     â•‘â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£â•‘/                â•‘ç³» ç»Ÿ ç›˜â•‘ä¸€èˆ¬â•‘å®ä¾‹å…³æœºæ•°æ®ä¸ä¼šä¸¢å¤±ï¼Œå¯å­˜æ”¾ä»£ç ç­‰ã€‚ä¼šéšä¿å­˜é•œåƒä¸€èµ·ä¿å­˜ã€‚               â•‘â•‘/root/autodl-tmp â•‘æ•° æ® ç›˜â•‘ å¿« â•‘å®ä¾‹å…³æœºæ•°æ®ä¸ä¼šä¸¢å¤±ï¼Œå¯å­˜æ”¾è¯»å†™IOè¦æ±‚é«˜çš„æ•°æ®ã€‚ä½†ä¸ä¼šéšä¿å­˜é•œåƒä¸€èµ·ä¿å­˜ â•‘â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•©â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•CPU ï¼š0.5 æ ¸å¿ƒå†…å­˜ï¼š2 GBGPU ï¼šNo devices were foundå­˜å‚¨ï¼š  ç³» ç»Ÿ ç›˜/               ï¼š46% 12G/25G  æ•° æ® ç›˜/root/autodl-tmpï¼š65% 33G/50G+----------------------------------------------------------------------------------------------------------------+*æ³¨æ„: 1.ç³»ç»Ÿç›˜è¾ƒå°è¯·å°†å¤§çš„æ•°æ®å­˜æ”¾äºæ•°æ®ç›˜æˆ–ç½‘ç›˜ä¸­ï¼Œé‡ç½®ç³»ç»Ÿæ—¶æ•°æ®ç›˜å’Œç½‘ç›˜ä¸­çš„æ•°æ®ä¸å—å½±å“2.æ¸…ç†ç³»ç»Ÿç›˜è¯·å‚è€ƒï¼šhttps://www.autodl.com/docs/qa/å®‰è£…git-lfsä»¥åŠsslç­‰ä¾èµ–123456curl -s https://packagecloud.io/install/repositories/github/git-lfs/script.deb.sh | sudo bashsudo apt-get install git-lfsgit lfs installsudo apt-get install opensslsudo apt-get install libssl-devå®‰è£…pytorchç¯å¢ƒ12345678# åˆ›å»ºè‡ªå·±çš„pythonç¯å¢ƒconda create -n gpt310 python=3.10 anaconda# åˆ‡æ¢åˆ°gpt310source activate gpt310# å®‰è£…gpuç‰ˆçš„pytorch, éœ€è¦åœ¨GPUç¯å¢ƒä¸‹å®‰è£…ï¼Œå¦åˆ™å®‰è£…æ˜¯cpuç‰ˆæœ¬pip install torch==2.0.0+cu117 torchvision==0.15.1+cu117 torchaudio==2.0.1 --index-url https://download.pytorch.org/whl/cu117åœ¨Pythonä¸­å¯¼å…¥PyTorchå¹¶æ£€æŸ¥CUDAæ˜¯å¦å¯ç”¨1234567import torch# æ£€æŸ¥PyTorchæ˜¯å¦ä½¿ç”¨äº†CUDAif torch.cuda.is_available():    print(&quot;CUDAå¯ç”¨&quot;)else:    print(&quot;CUDAä¸å¯ç”¨&quot;)å…¶å®ƒäº‹é¡¹æ§åˆ¶å°ä¸‹å®¹å™¨å®ä¾‹å°±æ˜¯ç§Ÿç”¨çš„æœºå™¨ï¼Œè‡ªå®šä¹‰æœåŠ¡æ˜¯å°†å®¹å™¨å†…çš„6006ç«¯å£æ˜ å°„åˆ°å…¬ç½‘/root/autodl-tmpå¯ä»¥æ”¾ä¸€äº›æ•°æ®æˆ–æ¨¡å‹ï¼Œå¼€å…³æœºä¸ä¼šä¸¢å¤±ï¼Œä½†ä¸éšé•œåƒä¸€èµ·ä¿å­˜æ— å¡å¼€æœºæ¨¡å‹ä¸å¸¦GPUï¼Œå¾ˆä¾¿å®œï¼Œä¸€å°æ—¶0.01å…ƒæœ¬åœ°ğŸ‘»æ²¡æœ‰æ˜¾å¡ï¼ŒğŸ¤•ä¼¤ä¸èµ·ğŸ¤•Langchain-ChatGLMgithub imClumsyPanda/langchain-ChatGLMğŸ¤–ï¸ ä¸€ç§åˆ©ç”¨ langchain æ€æƒ³å®ç°çš„åŸºäºæœ¬åœ°çŸ¥è¯†åº“çš„é—®ç­”åº”ç”¨ï¼Œç›®æ ‡æœŸæœ›å»ºç«‹ä¸€å¥—å¯¹ä¸­æ–‡åœºæ™¯ä¸å¼€æºæ¨¡å‹æ”¯æŒå‹å¥½ã€å¯ç¦»çº¿è¿è¡Œçš„çŸ¥è¯†åº“é—®ç­”è§£å†³æ–¹æ¡ˆğŸ’¡ å— GanymedeNil çš„é¡¹ç›® document.ai å’Œ AlexZhangji åˆ›å»ºçš„ ChatGLM-6B Pull Request å¯å‘ï¼Œå»ºç«‹äº†å…¨æµç¨‹å¯ä½¿ç”¨å¼€æºæ¨¡å‹å®ç°çš„æœ¬åœ°çŸ¥è¯†åº“é—®ç­”åº”ç”¨ã€‚ç°å·²æ”¯æŒä½¿ç”¨ ChatGLM-6B ç­‰å¤§è¯­è¨€æ¨¡å‹ç›´æ¥æ¥å…¥ï¼Œæˆ–é€šè¿‡ fastchat api å½¢å¼æ¥å…¥ Vicuna, Alpaca, LLaMA, Koala, RWKV ç­‰æ¨¡å‹âœ… æœ¬é¡¹ç›®ä¸­ Embedding é»˜è®¤é€‰ç”¨çš„æ˜¯ GanymedeNil/text2vec-large-chineseï¼ŒLLM é»˜è®¤é€‰ç”¨çš„æ˜¯ ChatGLM-6Bã€‚ä¾æ‰˜ä¸Šè¿°æ¨¡å‹ï¼Œæœ¬é¡¹ç›®å¯å®ç°å…¨éƒ¨ä½¿ç”¨å¼€æºæ¨¡å‹ç¦»çº¿ç§æœ‰éƒ¨ç½²â›“ï¸ æœ¬é¡¹ç›®å®ç°åŸç†å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¿‡ç¨‹åŒ…æ‹¬åŠ è½½æ–‡ä»¶ -&gt; è¯»å–æ–‡æœ¬ -&gt; æ–‡æœ¬åˆ†å‰² -&gt; æ–‡æœ¬å‘é‡åŒ– -&gt; é—®å¥å‘é‡åŒ– -&gt; åœ¨æ–‡æœ¬å‘é‡ä¸­åŒ¹é…å‡ºä¸é—®å¥å‘é‡æœ€ç›¸ä¼¼çš„top kä¸ª -&gt; åŒ¹é…å‡ºçš„æ–‡æœ¬ä½œä¸ºä¸Šä¸‹æ–‡å’Œé—®é¢˜ä¸€èµ·æ·»åŠ åˆ°promptä¸­ -&gt; æäº¤ç»™LLMç”Ÿæˆå›ç­”ä»æ–‡æ¡£å¤„ç†è§’åº¦æ¥çœ‹ï¼Œå®ç°æµç¨‹å¦‚ä¸‹ï¼šChatGLM-6Bæ¨¡å‹ç¡¬ä»¶éœ€æ±‚æ³¨ï¼šå¦‚æœªå°†æ¨¡å‹ä¸‹è½½è‡³æœ¬åœ°ï¼Œè¯·æ‰§è¡Œå‰æ£€æŸ¥$HOME/.cache/huggingface/æ–‡ä»¶å¤¹å‰©ä½™ç©ºé—´ï¼Œæ¨¡å‹æ–‡ä»¶ä¸‹è½½è‡³æœ¬åœ°éœ€è¦15GBå­˜å‚¨ç©ºé—´ã€‚æ³¨ï¼šä¸€äº›å…¶å®ƒçš„å¯é€‰å¯åŠ¨é¡¹è§é¡¹ç›®å¯åŠ¨é€‰é¡¹æ¨¡å‹ä¸‹è½½æ–¹æ³•å¯å‚è€ƒå¸¸è§é—®é¢˜ä¸­Q8é‡åŒ–ç­‰çº§æœ€ä½ GPU æ˜¾å­˜ï¼ˆæ¨ç†ï¼‰æœ€ä½ GPU æ˜¾å­˜ï¼ˆé«˜æ•ˆå‚æ•°å¾®è°ƒï¼‰FP16ï¼ˆæ— é‡åŒ–ï¼‰13 GB14 GBINT88 GB9 GBINT46 GB7 GBå‡†å¤‡å·¥ä½œé¡¹ç›®ç¯å¢ƒå‡†å¤‡å…ˆåœ¨/homeç›®å½•ä¸‹åˆ›å»ºhuangycæ–‡ä»¶å¤¹ï¼Œè¿›å…¥huangycç›®å½•ä¸‹åï¼Œæ‹‰å–é¡¹ç›®ä»£ç 1git clone https://github.com/imClumsyPanda/langchain-ChatGLM.gitå®‰è£…å¿…è¦åº“123456# centosç³»ç»Ÿä¸‹yum install libX11 -yyum install libXext -ypip uninstall detectron2# ubuntuç³»ç»Ÿä¸éœ€è¦è¿›å…¥langchain-ChatGLMæ–‡ä»¶å¤¹ï¼Œå®‰è£…ä¾èµ–åº“ï¼ŒAutoDlå¹³å°ä¸‹å¥½åƒéœ€è¦åŠ -iå‚æ•°1pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simpleæ¨¡å‹å‡†å¤‡ä»huggingfaceå¼€æ”¾æ¨¡å‹ä¸‹æ‰¾åˆ°è‡ªå·±çš„éœ€è¦çš„æ¨¡å‹ï¼Œç”¨git lfsä¸‹è½½ï¼Œå¦‚æœåœ¨AutoDlå¹³å°ï¼Œå¯ä»¥æŠŠæ¨¡å‹ä¸‹è½½åˆ°/root/autodl-tmp1git clone https://huggingface.co/THUDM/chatglm-6b-int4.gitå¯ä»¥ç”¨ls -lh .å‘½ä»¤æŸ¥çœ‹ä¸‹è½½çš„æ–‡ä»¶å¤§å°æ˜¯å¦æ­£å¸¸ä¸‹è½½å®Œçš„chatglm-6b-int4æ¨¡å‹æ–‡ä»¶å¤¹ï¼Œæ”¾åˆ°langchain-ChatGLMé¡¹ç›®çš„modelæ–‡ä»¶å¤¹ä¸‹ï¼Œæ²¡æœ‰modelæ–‡ä»¶å¤¹çš„è¯ï¼Œè‡ªå·±åˆ›å»ºä¸‹å¦‚æœä¸‹è½½å¤±è´¥çš„è¯ï¼Œå¯ä»¥è¯•ä¸‹ç”¨wgetä¸‹è½½ï¼Œä¾‹å¦‚1wget --no-check-certificate https://huggingface.co/THUDM/chatglm-6b-int4/resolve/main/pytorch_model.binæ¨ç†ä¿®æ”¹é…ç½®æ‰“å¼€langchain-ChatGLM/config/model_config.pyï¼Œä¿®æ”¹å¦‚ä¸‹é…ç½®123456789101112131415161718# supported LLM models# llm_model_dict å¤„ç†äº†loaderçš„ä¸€äº›é¢„è®¾è¡Œä¸ºï¼Œå¦‚åŠ è½½ä½ç½®ï¼Œæ¨¡å‹åç§°ï¼Œæ¨¡å‹å¤„ç†å™¨å®ä¾‹llm_model_dict = {......    &quot;chatglm-6b-int4&quot;: {        &quot;name&quot;: &quot;chatglm-6b-int4&quot;,-        &quot;pretrained_model_name&quot;: &quot;THUDM/chatglm-6b-int4&quot;,+        &quot;pretrained_model_name&quot;: &quot;model/chatglm-6b-int4&quot;,               &quot;local_model_path&quot;: None,        &quot;provides&quot;: &quot;ChatGLM&quot;    }    ......}# LLM åç§°LLM_MODEL = &quot;chatglm-6b-int4&quot;# å¦‚æœä½ éœ€è¦åŠ è½½æœ¬åœ°çš„modelï¼ŒæŒ‡å®šè¿™ä¸ªå‚æ•°  ` --no-remote-model`ï¼Œæˆ–è€…ä¸‹æ–¹å‚æ•°ä¿®æ”¹ä¸º `True`NO_REMOTE_MODEL = Falseè¿™æ ·æ¨¡å‹ä¼šä»æœ¬åœ°åŠ è½½ä¿®æ”¹webui.pyï¼Œç”¨äºå¯åŠ¨Web äº¤äº’123456789(demo .queue(concurrency_count=3)- .launch(server_name='0.0.0.0',+ .launch(server_name='localhost',                   server_port=7860,  # AutoDlå¹³å°ç”¨çš„æ˜¯6006         show_api=False,-        share=False,+        share=True,                   inbrowser=False))é˜¿é‡Œäº‘æœåŠ¡å™¨é‚£è¾¹éœ€è¦å¼€æ”¾7860ç«¯å£å¯åŠ¨webæœåŠ¡è¿›å…¥åˆ°langchain-ChatGLMé¡¹ç›®ä¸‹ï¼Œæ‰§è¡Œwebui.py1python webui.pyå¦‚æœå‘ç°ç«¯å£è¢«å ç”¨äº†ï¼Œå¯ä»¥ç”¨netstat -atunlp | grep 7860å‘½ä»¤æŸ¥çœ‹å¹¶æ€æ­»å ç”¨è¯¥ç«¯å£çš„è¿›ç¨‹(è‡ªå·±åˆ¤æ–­)æ‰“å¼€ç½‘é¡µï¼Œä½ çš„ip:7860ï¼Œå°±å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ç•Œé¢ï¼Œé»˜è®¤æ˜¯å¯¹è¯ç•Œé¢å¯ä»¥åˆ‡æ¢åˆ°çŸ¥è¯†åº“æµ‹è¯•ï¼Œåœ¨è¿™é‡Œå¯ä»¥ä¸Šä¼ è‡ªå·±çš„æ–‡æ¡£åˆ°çŸ¥è¯†åº“åå°çœ‹ä¸‹å½“å‰æ˜¾å­˜å ç”¨ï¼Œæ¨¡å‹ç”¨çš„æ˜¯chatglm-6b-int4æ¨¡å‹ä¹‹åæµ‹è¯•ä¸Šä¼ äº†ã€Šæµç•…çš„Pythonã€‹é«˜æ¸…å®˜æ–¹ä¸­æ–‡ç‰ˆ.pdfï¼Œåå°ä¸€ç›´åœ¨æ›´æ–°çŸ¥è¯†åº“ï¼Œç­‰äº†åå‡ åˆ†é’Ÿï¼Œè¿˜æ²¡ç»“æŸï¼Œæˆ‘å°±åˆ‡æ¢åˆ°æ™®é€šå¯¹è¯äº†ï¼Œåˆæµ‹äº†åå‡ è½®å¯¹è¯ï¼Œçªç„¶çˆ†äº†æ˜¾å­˜ä¸å¤Ÿï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯ä¸Šä¼ çŸ¥è¯†åº“å¼•èµ·çš„ï¼Œè¿˜æ˜¯éšç€å¯¹è¯å¢åŠ ï¼Œæ˜¾å­˜ä¸€ç›´æ²¡é‡Šæ”¾pycharmè¿œç¨‹é…ç½®PyCharmè¿œç¨‹é…ç½®è§£é‡Šå™¨å’Œé¡¹ç›®æä¾›äº†ä»¥ä¸‹å‡ ä¸ªé‡è¦çš„ç”¨é€”å’Œä¼˜åŠ¿ï¼šè¿œç¨‹å¼€å‘ï¼šæ‚¨å¯ä»¥åœ¨æœ¬åœ°ä½¿ç”¨PyCharmç¼–å†™ä»£ç ï¼Œå¹¶å°†ä»£ç éƒ¨ç½²å’Œè¿è¡Œåœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šã€‚è¿™æ„å‘³ç€æ‚¨ä¸éœ€è¦åœ¨æœ¬åœ°é…ç½®å’Œå®‰è£…ä¸è¿œç¨‹æœåŠ¡å™¨ç¯å¢ƒç›¸åŒçš„è½¯ä»¶å’Œä¾èµ–é¡¹ã€‚æ‚¨å¯ä»¥åˆ©ç”¨æœåŠ¡å™¨ä¸Šçš„è®¡ç®—èµ„æºå’Œç¯å¢ƒæ¥è¿›è¡Œå¼€å‘å’Œæµ‹è¯•ï¼Œå‡è½»äº†æœ¬åœ°æœºå™¨çš„è´Ÿæ‹…ç»Ÿä¸€å¼€å‘ç¯å¢ƒï¼šé€šè¿‡è¿œç¨‹é…ç½®è§£é‡Šå™¨å’Œé¡¹ç›®ï¼Œæ‚¨å¯ä»¥åœ¨æœ¬åœ°ä½¿ç”¨PyCharmçš„åŠŸèƒ½å’Œå·¥å…·æ¥å¼€å‘å’Œè°ƒè¯•ä»£ç ã€‚æ‚¨å¯ä»¥äº«å—PyCharmæä¾›çš„æ™ºèƒ½ä»£ç è¡¥å…¨ã€è°ƒè¯•å™¨ã€ç‰ˆæœ¬æ§åˆ¶é›†æˆç­‰åŠŸèƒ½ï¼Œæ— éœ€åˆ‡æ¢åˆ°å…¶ä»–ç¼–è¾‘å™¨æˆ–è¿œç¨‹ç»ˆç«¯åä½œä¸å›¢é˜Ÿå¼€å‘ï¼šè¿œç¨‹é…ç½®è§£é‡Šå™¨å’Œé¡¹ç›®ä½¿å›¢é˜Ÿæˆå‘˜å¯ä»¥å…±äº«ç›¸åŒçš„å¼€å‘ç¯å¢ƒã€‚æ— è®ºæ˜¯åœ¨æœ¬åœ°è¿˜æ˜¯è¿œç¨‹æœåŠ¡å™¨ä¸Šï¼Œå›¢é˜Ÿæˆå‘˜å¯ä»¥ä½¿ç”¨ç›¸åŒçš„é…ç½®å’Œä¾èµ–é¡¹æ¥å¼€å‘å’Œæµ‹è¯•ä»£ç ã€‚è¿™æœ‰åŠ©äºç¡®ä¿ä»£ç åœ¨ä¸åŒç¯å¢ƒä¸‹çš„ä¸€è‡´æ€§ï¼Œå¹¶ä¿ƒè¿›å›¢é˜Ÿåä½œå’Œå¼€å‘æ•ˆç‡è¿œç¨‹è°ƒè¯•å’Œé”™è¯¯æ’æŸ¥ï¼šé€šè¿‡é…ç½®è¿œç¨‹è§£é‡Šå™¨ï¼Œæ‚¨å¯ä»¥åœ¨æœ¬åœ°ä½¿ç”¨PyCharmçš„è°ƒè¯•å™¨æ¥è°ƒè¯•è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„ä»£ç ã€‚è¿™æ ·ï¼Œæ‚¨å¯ä»¥é€æ­¥æ‰§è¡Œä»£ç ã€è§‚å¯Ÿå˜é‡å’Œç›‘æ§ç¨‹åºçŠ¶æ€ï¼Œä»¥ä¾¿æ›´è½»æ¾åœ°è¿›è¡Œé”™è¯¯æ’æŸ¥å’Œä¿®å¤è¿œç¨‹éƒ¨ç½²å’Œç®¡ç†ï¼šé€šè¿‡è¿œç¨‹é…ç½®é¡¹ç›®ï¼Œæ‚¨å¯ä»¥å°†æœ¬åœ°çš„ä»£ç åŒæ­¥åˆ°è¿œç¨‹æœåŠ¡å™¨ä¸Šï¼Œå¹¶åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œå’Œç®¡ç†é¡¹ç›®ã€‚è¿™ç®€åŒ–äº†éƒ¨ç½²è¿‡ç¨‹ï¼Œå¹¶ä½¿æ‚¨èƒ½å¤Ÿç›´æ¥åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šæ“ä½œé¡¹ç›®æ–‡ä»¶å’Œèµ„æºPyCharmè¿œç¨‹é…ç½®è§£é‡Šå™¨å’Œé¡¹ç›®æä¾›äº†ä¸€ç§æ–¹ä¾¿è€Œé«˜æ•ˆçš„æ–¹å¼ï¼Œè®©æ‚¨å¯ä»¥åœ¨æœ¬åœ°ä½¿ç”¨PyCharmè¿›è¡Œå¼€å‘å’Œè°ƒè¯•ï¼ŒåŒæ—¶åˆ©ç”¨è¿œç¨‹æœåŠ¡å™¨çš„ä¼˜åŠ¿æ¥è¿è¡Œå’Œéƒ¨ç½²ä»£ç ã€‚è¿™å¯¹äºéœ€è¦åœ¨è¿œç¨‹ç¯å¢ƒä¸‹è¿›è¡Œå¼€å‘å’Œåä½œçš„åœºæ™¯éå¸¸æœ‰ç”¨ï¼Œå¦‚è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„Webå¼€å‘ã€æ•°æ®å¤„ç†å’Œäº‘è®¡ç®—ç­‰ä»»åŠ¡pycharmè¿œç¨‹é…ç½®å‚è€ƒæœ¬ç«™çš„Sparké›†ç¾¤æ­å»ºç« èŠ‚ä¸‹çš„é…ç½®è¿œç¨‹è§£é‡Šå™¨ç›¸å…³æŠ€æœ¯langchain: langchainã€LangChainï¼šä¸ºä½ å®šåˆ¶ä¸€ä¸ªä¸“å±çš„GPTLangChainæ˜¯ä¸€ä¸ªç”¨äºå¼€å‘åŸºäºè¯­è¨€æ¨¡å‹çš„åº”ç”¨ç¨‹åºå¼€å‘æ¡†æ¶ï¼Œç”¨æˆ·å¯ä»¥åˆ©ç”¨LangChainçš„æ¨¡å—æ¥æ”¹å–„å¤§è¯­è¨€æ¨¡å‹çš„ä½¿ç”¨ï¼Œé€šè¿‡è¾“å…¥è‡ªå·±çš„çŸ¥è¯†åº“æ¥å®šåˆ¶åŒ–è‡ªå·±çš„å¤§è¯­è¨€æ¨¡å‹faiss: Faiss Documentationã€[python] å‘é‡æ£€ç´¢åº“Faissä½¿ç”¨æŒ‡åŒ—æ‰€è°“ç›¸ä¼¼æ€§æœç´¢æ˜¯æŒ‡é€šè¿‡æ¯”è¾ƒå¤šç»´ç©ºé—´ä¸­æ•°æ®ä¹‹é—´çš„ç›¸ä¼¼æ€§æ¥æœç´¢ä¸è¾“å…¥æ•°æ®æœ€ç›¸ä¼¼çš„ç›®æ ‡æ•°æ®ã€‚ä¾‹å¦‚äººè„¸è¯†åˆ«ä¸­ï¼Œé€šè¿‡æ¯”è¾ƒäººè„¸å‘é‡ä¹‹å‰çš„è·ç¦»æ¥è¯†åˆ«å½“å‰äººè„¸ä¸å“ªå¼ äººè„¸ç›¸ä¼¼ã€‚å› æ­¤ï¼Œè¯¥æŠ€æœ¯è¢«å¹¿æ³›åº”ç”¨äºä¿¡æ¯æ£€ç´¢ã€è®¡ç®—æœºè§†è§‰ã€æ•°æ®åˆ†æç­‰é¢†åŸŸã€‚å¦‚æœè¦æ£€ç´¢çš„æ•°æ®å¾ˆå¤šæ—¶ï¼Œé‚£ä¹ˆå°±éœ€è¦ä¸€ä¸ªå‘é‡æ£€ç´¢åº“æ¥åŠ é€Ÿæ£€ç´¢FaissåŒ…å«å¤šç§ç›¸ä¼¼æ€§æœç´¢æ–¹æ³•ï¼Œå¹¶æä¾›cpuå’Œgpuç‰ˆæœ¬æ”¯æŒã€‚Faissçš„ä¼˜åŠ¿åœ¨äºé€šè¿‡è¾ƒå°çš„ç²¾åº¦æŸå¤±æé«˜å‘é‡ç›¸ä¼¼åº¦çš„æ£€ç´¢é€Ÿåº¦å’Œå‡å°‘å†…å­˜ä½¿ç”¨é‡ChatGLM-6B: chatglmã€github THUDM/ChatGLM-6BChatGLM-6Bæ˜¯ä¸€ä¸ªå¼€æºçš„ã€æ”¯æŒä¸­è‹±åŒè¯­çš„å¯¹è¯è¯­è¨€æ¨¡å‹ï¼ŒåŸºäºGeneral Language Model (GLM)æ¶æ„ï¼Œå…·æœ‰62äº¿å‚æ•°ã€‚ç»“åˆæ¨¡å‹é‡åŒ–æŠ€æœ¯ï¼Œç”¨æˆ·å¯ä»¥åœ¨æ¶ˆè´¹çº§çš„æ˜¾å¡ä¸Šè¿›è¡Œæœ¬åœ°éƒ¨ç½²(INT4é‡åŒ–çº§åˆ«ä¸‹æœ€ä½åªéœ€6GBæ˜¾å­˜)ã€‚ ChatGLM-6Bä½¿ç”¨äº†å’ŒChatGPTç›¸ä¼¼çš„æŠ€æœ¯ï¼Œé’ˆå¯¹ä¸­æ–‡é—®ç­”å’Œå¯¹è¯è¿›è¡Œäº†ä¼˜åŒ–ã€‚ç»è¿‡çº¦1Tæ ‡è¯†ç¬¦çš„ä¸­è‹±åŒè¯­è®­ç»ƒï¼Œè¾…ä»¥ç›‘ç£å¾®è°ƒã€åé¦ˆè‡ªåŠ©ã€äººç±»åé¦ˆå¼ºåŒ–å­¦ä¹ ç­‰æŠ€æœ¯çš„åŠ æŒï¼Œ62äº¿å‚æ•°çš„ChatGLM-6Bå·²ç»èƒ½ç”Ÿæˆç›¸å½“ç¬¦åˆäººç±»åå¥½çš„å›ç­”Hugging Face: Hugging FaceHugging Faceæ˜¯ä¸€ä¸ªçŸ¥åçš„å¼€æºç¤¾åŒºå’Œå…¬å¸ï¼Œä¸“æ³¨äºè‡ªç„¶è¯­è¨€å¤„ç†(NLP)å’Œæœºå™¨å­¦ä¹ (ML)é¢†åŸŸã€‚ä»–ä»¬å¼€å‘äº†è®¸å¤šæµè¡Œçš„å¼€æºå·¥å…·å’Œåº“ï¼Œä½¿å¾—æ„å»ºå’Œåº”ç”¨NLPæ¨¡å‹æ›´åŠ ä¾¿æ·localGPTgithub PromtEngineer/localGPTç­‰å¾…</content>
	</entry>
	<entry>
		<title>huggingfaceåŸºæœ¬ä½¿ç”¨æ•™ç¨‹</title>
		<url>/article/57912.html</url>
		<content>huggingfaceæ¦‚è¿°Hugging Faceå®˜ç½‘ä»»åŠ¡åˆ†ç±»å’Œç¤ºä¾‹Hugging Faceæ˜¯ä¸€ä¸ªçŸ¥åçš„å¼€æºç¤¾åŒºå’Œå…¬å¸ï¼Œä¸“æ³¨äºè‡ªç„¶è¯­è¨€å¤„ç†(NLP)å’Œæœºå™¨å­¦ä¹ (ML)é¢†åŸŸã€‚ä»–ä»¬å¼€å‘äº†è®¸å¤šæµè¡Œçš„å¼€æºå·¥å…·å’Œåº“ï¼Œä½¿å¾—æ„å»ºå’Œåº”ç”¨NLPæ¨¡å‹æ›´åŠ ä¾¿æ·Hugging faceèµ·åˆæ˜¯ä¸€å®¶æ€»éƒ¨ä½äºçº½çº¦çš„èŠå¤©æœºå™¨äººåˆåˆ›æœåŠ¡å•†ï¼Œä»–ä»¬æœ¬æ¥æ‰“ç®—åˆ›ä¸šåšèŠå¤©æœºå™¨äººï¼Œç„¶ååœ¨githubä¸Šå¼€æºäº†ä¸€ä¸ªTransformersåº“ï¼Œè™½ç„¶èŠå¤©æœºå™¨äººä¸šåŠ¡æ²¡æèµ·æ¥ï¼Œä½†æ˜¯ä»–ä»¬çš„è¿™ä¸ªåº“åœ¨æœºå™¨å­¦ä¹ ç¤¾åŒºè¿…é€Ÿå¤§ç«èµ·æ¥ã€‚ç›®å‰å·²ç»å…±äº«äº†è¶…100,000ä¸ªé¢„è®­ç»ƒæ¨¡å‹ï¼Œ10,000ä¸ªæ•°æ®é›†ï¼Œå˜æˆäº†æœºå™¨å­¦ä¹ ç•Œçš„githubåœ¨è¿™é‡Œä¸»è¦æœ‰ä»¥ä¸‹å¤§å®¶éœ€è¦çš„èµ„æºDatasetsï¼šæ•°æ®é›†ï¼Œä»¥åŠæ•°æ®é›†çš„ä¸‹è½½åœ°å€Modelsï¼šåŒ…æ‹¬å„ç§å¤„ç†CVå’ŒNLPç­‰ä»»åŠ¡çš„æ¨¡å‹ï¼Œä¸Šé¢æ¨¡å‹éƒ½æ˜¯å¯ä»¥å…è´¹è·å¾—ä¸»è¦åŒ…æ‹¬è®¡ç®—æœºè§†è§‰ã€è‡ªç„¶è¯­è¨€å¤„ç†ã€è¯­éŸ³å¤„ç†ã€å¤šæ¨¡æ€ã€è¡¨æ ¼å¤„ç†ã€å¼ºåŒ–å­¦ä¹ courseï¼šå…è´¹çš„nlpè¯¾ç¨‹docsï¼šæ–‡æ¡£å±•å¼€ç»†èŠ‚Computer Vision(è®¡ç®—æœºè§†è§‰ä»»åŠ¡)ï¼šåŒ…æ‹¬lmage Classification(å›¾åƒåˆ†ç±»)ï¼Œlmage Segmentation(å›¾åƒåˆ†å‰²)ã€zero-Shot lmage Classification(é›¶æ ·æœ¬å›¾åƒåˆ†ç±»)ã€lmage-to-Image(å›¾åƒåˆ°å›¾åƒçš„ä»»åŠ¡)ã€Unconditional lmage Generation(æ— æ¡ä»¶å›¾åƒç”Ÿæˆ)ã€Object Detection(ç›®æ ‡æ£€æµ‹)ã€Video Classification(è§†é¢‘åˆ†ç±»)ã€Depth Estimation(æ·±åº¦ä¼°è®¡ï¼Œä¼°è®¡æ‹æ‘„è€…è·ç¦»å›¾åƒå„å¤„çš„è·ç¦»)Natural Language Processing(è‡ªç„¶è¯­è¨€å¤„ç†)ï¼šåŒ…æ‹¬Translation(æœºå™¨ç¿»è¯‘)ã€Fill-Mask(å¡«å……æ©ç ï¼Œé¢„æµ‹å¥å­ä¸­è¢«é®æ©çš„è¯)ã€Token Classification(è¯åˆ†ç±»)ã€Sentence Similarity(å¥å­ç›¸ä¼¼åº¦)ã€Question Answering(é—®ç­”ç³»ç»Ÿ)ï¼ŒSummarization(æ€»ç»“ï¼Œç¼©å¥)ã€Zero-Shot Classification (é›¶æ ·æœ¬åˆ†ç±»)ã€Text Classification(æ–‡æœ¬åˆ†ç±»)ã€Text2Text(æ–‡æœ¬åˆ°æ–‡æœ¬çš„ç”Ÿæˆ)ã€Text Generation(æ–‡æœ¬ç”Ÿæˆ)ã€Conversational(èŠå¤©)ã€Table Question Answer(è¡¨é—®ç­”ï¼Œ1.é¢„æµ‹è¡¨æ ¼ä¸­è¢«é®æ©å•è¯2.æ•°å­—æ¨ç†ï¼Œåˆ¤æ–­å¥å­æ˜¯å¦è¢«è¡¨æ ¼æ•°æ®æ”¯æŒ)Audio(è¯­éŸ³)ï¼šAutomatic Speech Recognition(è¯­éŸ³è¯†åˆ«)ã€Audio Classification(è¯­éŸ³åˆ†ç±»)ã€Text-to-Speech(æ–‡æœ¬åˆ°è¯­éŸ³çš„ç”Ÿæˆ)ã€Audio-to-Audio(è¯­éŸ³åˆ°è¯­éŸ³çš„ç”Ÿæˆ)ã€Voice Activity Detection(å£°éŸ³æ£€æµ‹ã€æ£€æµ‹è¯†åˆ«å‡ºéœ€è¦çš„å£°éŸ³éƒ¨åˆ†)Multimodal(å¤šæ¨¡æ€)ï¼šFeature Extraction(ç‰¹å¾æå–)ã€Text-to-Image(æ–‡æœ¬åˆ°å›¾åƒ)ã€Visual Question Answering(è§†è§‰é—®ç­”)ã€Image2Text(å›¾åƒåˆ°æ–‡æœ¬)ã€Document Question Answering(æ–‡æ¡£é—®ç­”)Tabular(è¡¨æ ¼)ï¼šTabular Classification(è¡¨åˆ†ç±»)ã€Tabular Regression(è¡¨å›å½’)Reinforcement Learning(å¼ºåŒ–å­¦ä¹ )ï¼šReinforcement Learning(å¼ºåŒ–å­¦ä¹ )ã€Robotics(æœºå™¨äºº)å®‰è£…å®‰è£…transformersåº“1pip install transformersdatasetsHuggingFace datasetsåº“æ€»ç»“å®‰è£…ä¸‹é¢ä¸‰ä¸ªå‘½ä»¤éƒ½ç”¨äºå®‰è£…Hugging Faceçš„datasetsåº“çš„ä¸åŒé…ç½®pip install datasetsï¼šè¿™ä¸ªå‘½ä»¤å®‰è£…çš„æ˜¯datasetsåº“çš„åŸºæœ¬é…ç½®ï¼Œå®ƒæä¾›äº†å¯¹å¸¸è§çš„è‡ªç„¶è¯­è¨€å¤„ç†(NLP)ä»»åŠ¡å’Œæ•°æ®é›†çš„æ”¯æŒï¼Œä¾‹å¦‚æ–‡æœ¬åˆ†ç±»ã€å‘½åå®ä½“è¯†åˆ«ã€é—®ç­”ç³»ç»Ÿç­‰ã€‚å¦‚æœæ‚¨åªéœ€è¦å¤„ç†æ–‡æœ¬æ•°æ®æˆ–è¿›è¡Œå¸¸è§çš„NLPä»»åŠ¡ï¼Œè¿™ä¸ªåŸºæœ¬é…ç½®å°±è¶³å¤Ÿäº†pip install datasets[audio]ï¼šè¿™ä¸ªå‘½ä»¤å®‰è£…çš„æ˜¯datasetsåº“çš„â€audioâ€é…ç½®ã€‚å®ƒåŒ…å«äº†å¯¹å£°éŸ³å’ŒéŸ³é¢‘æ•°æ®é›†çš„æ”¯æŒï¼Œä¾‹å¦‚è‡ªåŠ¨è¯­éŸ³è¯†åˆ«(ASR)å’ŒéŸ³é¢‘åˆ†ç±»ä»»åŠ¡ã€‚å¦‚æœæ‚¨éœ€è¦å¤„ç†å£°éŸ³å’ŒéŸ³é¢‘æ•°æ®ï¼Œæ¯”å¦‚è¿›è¡Œè¯­éŸ³è¯†åˆ«æˆ–éŸ³é¢‘åˆ†ç±»ï¼Œå®‰è£…è¿™ä¸ªé…ç½®ä¼šæä¾›ç›¸åº”çš„åŠŸèƒ½å’Œæ•°æ®é›†æ”¯æŒpip install datasets[vision]ï¼šè¿™ä¸ªå‘½ä»¤å®‰è£…çš„æ˜¯datasetsåº“çš„â€visionâ€é…ç½®ã€‚å®ƒåŒ…å«äº†å¯¹å›¾åƒå’Œè®¡ç®—æœºè§†è§‰ä»»åŠ¡çš„æ”¯æŒï¼Œä¾‹å¦‚å›¾åƒåˆ†ç±»ã€ç›®æ ‡æ£€æµ‹å’Œåˆ†å‰²ç­‰ã€‚å¦‚æœæ‚¨éœ€è¦å¤„ç†å›¾åƒæ•°æ®æˆ–è¿›è¡Œè®¡ç®—æœºè§†è§‰ä»»åŠ¡ï¼Œå®‰è£…è¿™ä¸ªé…ç½®ä¼šæä¾›ç›¸åº”çš„åŠŸèƒ½å’Œæ•°æ®é›†æ”¯æŒé€šè¿‡å®‰è£…ä¸åŒçš„é…ç½®ï¼Œæ‚¨å¯ä»¥é€‰æ‹©ä»…å®‰è£…æ‚¨éœ€è¦çš„åŠŸèƒ½å’Œæ”¯æŒçš„ä»»åŠ¡ç±»å‹ï¼Œä»¥å‡å°‘åº“çš„å®‰è£…å’Œå­˜å‚¨ç©ºé—´ã€‚æ ¹æ®æ‚¨çš„å…·ä½“éœ€æ±‚ï¼Œé€‰æ‹©é€‚åˆçš„é…ç½®è¿›è¡Œå®‰è£…å³å¯123456# å®‰è£…åŸºç¡€ç‰ˆpip install datasets# å®‰è£…forå£°éŸ³pip install datasets[audio]# å®‰è£…forå›¾åƒpip install datasets[vision]å¿«é€Ÿå¼€å§‹è§†è§‰123456789101112131415161718192021222324252627282930from datasets import load_dataset, Imagefrom torch.utils.data import DataLoaderfrom torchvision.transforms import Compose, ColorJitter, ToTensor# åŠ è½½æ•°æ®é›†dataset = load_dataset(&quot;beans&quot;, split=&quot;train&quot;)jitter = Compose(    [ColorJitter(brightness=0.5, hue=0.5), ToTensor()])def transforms(examples):    examples[&quot;pixel_values&quot;] = [jitter(image.convert(&quot;RGB&quot;)) for image in examples[&quot;image&quot;]]    return examplesdataset = dataset.with_transform(transforms)def collate_fn(examples):    images = []    labels = []    for example in examples:        images.append((example[&quot;pixel_values&quot;]))        labels.append(example[&quot;labels&quot;])            pixel_values = torch.stack(images)    labels = torch.tensor(labels)    return {&quot;pixel_values&quot;: pixel_values, &quot;labels&quot;: labels}# å®šä¹‰DataLoaderdataloader = DataLoader(dataset, collate_fn=collate_fn, batch_size=4)nlpä½¿ç”¨ Hugging Face æä¾›çš„datasetsåº“åŠ è½½äº†GLUE(General Language Understanding Evaluation)æ•°æ®é›†ä¸­çš„MRPC(Microsoft Research Paraphrase Corpus)éƒ¨åˆ†çš„è®­ç»ƒé›†ã€‚è¿™ä¸ªæ•°æ®é›†ç”¨äºå¥å­å¯¹çš„ç›¸ä¼¼æ€§åˆ¤æ–­ä»»åŠ¡1234567891011121314151617181920212223242526272829from datasets import load_datasetfrom transformers import AutoModelForSequenceClassification, AutoTokenizerimport torchdataset = load_dataset(&quot;glue&quot;, &quot;mrpc&quot;, split=&quot;test&quot;)# load a pretrained BERT model and its corresponding tokenizer from the ğŸ¤— Transformers library.model = AutoModelForSequenceClassification.from_pretrained(&quot;bert-base-uncased&quot;)tokenizer = AutoTokenizer.from_pretrained(&quot;bert-base-uncased&quot;)def encode(examples):    return tokenizer(examples[&quot;sentence1&quot;], examples[&quot;sentence2&quot;], truncation=True, padding=&quot;max_length&quot;)dataset = dataset.map(encode, batched=True)dataset[0]{'sentence1': 'Amrozi accused his brother , whom he called &quot; the witness &quot; , of deliberately distorting his evidence .','sentence2': 'Referring to him as only &quot; the witness &quot; , Amrozi accused his brother of deliberately distorting his evidence .','label': 1,'idx': 0,'input_ids': array([  101,  7277,  2180,  5303,  4806,  1117,  1711,   117,  2292, 1119,  1270,   107,  1103,  7737,   107,   117,  1104,  9938, 4267, 12223, 21811,  1117,  2554,   119,   102, 11336,  6732, 3384,  1106,  1140,  1112,  1178,   107,  1103,  7737,   107, 117,  7277,  2180,  5303,  4806,  1117,  1711,  1104,  9938, 4267, 12223, 21811,  1117,  2554,   119,   102]),'token_type_ids': array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]),'attention_mask': array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])}#  Rename the label column to labels, which is the expected input name in BertForSequenceClassificationdataset = dataset.map(lambda examples: {&quot;labels&quot;: examples[&quot;label&quot;]}, batched=True)dataset.set_format(type=&quot;torch&quot;, columns=[&quot;input_ids&quot;, &quot;token_type_ids&quot;, &quot;attention_mask&quot;, &quot;labels&quot;])dataloader = torch.utils.data.DataLoader(dataset, batch_size=32)åŠ è½½æ•°æ®é›†æŸ¥çœ‹æ•°æ®é›†æè¿°12345678910from datasets import load_dataset_builderds_builder = load_dataset_builder(&quot;rotten_tomatoes&quot;)ds_builder.info.descriptionMovie Review Dataset. This is a dataset of containing 5,331 positive and 5,331 negative processed sentences from Rotten Tomatoes movie reviews. This data was first used in Bo Pang and Lillian Lee, ``Seeing stars: Exploiting class relationships for sentiment categorization with respect to rating scales.'', Proceedings of the ACL, 2005.ds_builder.info.features{'label': ClassLabel(num_classes=2, names=['neg', 'pos'], id=None), 'text': Value(dtype='string', id=None)}åŠ è½½æ•°æ®é›†123from datasets import load_datasetdataset = load_dataset(&quot;rotten_tomatoes&quot;, split=&quot;train&quot;)å½“ä¸€ä¸ªæ•°æ®é›†ç”±å¤šä¸ªæ–‡ä»¶(æˆ‘ä»¬ç§°ä¹‹ä¸ºåˆ†ç‰‡)ç»„æˆæ—¶ï¼Œå¯ä»¥æ˜¾è‘—åŠ å¿«æ•°æ®é›†çš„ä¸‹è½½å’Œå‡†å¤‡æ­¥éª¤æ‚¨å¯ä»¥ä½¿ç”¨num_procå‚æ•°é€‰æ‹©å¹¶è¡Œå‡†å¤‡æ•°æ®é›†æ—¶è¦ä½¿ç”¨çš„è¿›ç¨‹æ•°ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¯ä¸ªè¿›ç¨‹è¢«åˆ†é…äº†ä¸€éƒ¨åˆ†åˆ†ç‰‡æ¥è¿›è¡Œå‡†å¤‡12345from datasets import load_datasetoscar_afrikaans = load_dataset(&quot;oscar-corpus/OSCAR-2201&quot;, &quot;af&quot;, num_proc=8)imagenet = load_dataset(&quot;imagenet-1k&quot;, num_proc=8)ml_librispeech_spanish = load_dataset(&quot;facebook/multilingual_librispeech&quot;, &quot;spanish&quot;, num_proc=8)æŸ¥çœ‹æ•°æ®é›†çš„åˆ†ç‰‡åç§°ï¼Œå¹¶åŠ è½½æŒ‡å®šçš„åˆ†ç‰‡åç§°123456789101112131415161718192021222324252627282930313233343536373839404142434445464748from datasets import get_dataset_split_namesfrom datasets import load_datasetget_dataset_split_names(&quot;rotten_tomatoes&quot;)['train', 'validation', 'test']# åŠ è½½æŒ‡å®šåˆ†ç‰‡dataset = load_dataset(&quot;rotten_tomatoes&quot;, split=&quot;train&quot;)Dataset({    features: ['text', 'label'],    num_rows: 8530})# è¿˜å¯ä»¥è¿™ä¹ˆå†™ï¼štrain_test_ds = datasets.load_dataset(&quot;bookcorpus&quot;, split=&quot;train+test&quot;)train_10_20_ds = datasets.load_dataset(&quot;bookcorpus&quot;, split=&quot;train[10:20]&quot;)train_10pct_ds = datasets.load_dataset(&quot;bookcorpus&quot;, split=&quot;train[:10%]&quot;)train_10_80pct_ds = datasets.load_dataset(&quot;bookcorpus&quot;, split=&quot;train[:10%]+train[-80%:]&quot;)val_ds = datasets.load_dataset(&quot;bookcorpus&quot;, split=[f&quot;train[{k}%:{k+10}%]&quot; for k in range(0, 100, 10)])train_ds = datasets.load_dataset(&quot;bookcorpus&quot;, split=[f&quot;train[:{k}%]+train[{k+10}%:]&quot; for k in range(0, 100, 10)])train_50_52_ds = datasets.load_dataset(&quot;bookcorpus&quot;, split=&quot;train[50%:52%]&quot;)train_52_54_ds = datasets.load_dataset(&quot;bookcorpus&quot;, split=&quot;train[52%:54%]&quot;)# 18 records, from 450 (included) to 468 (excluded).train_50_52pct1_ds = datasets.load_dataset(&quot;bookcorpus&quot;, split=datasets.ReadInstruction(&quot;train&quot;, from_=50, to=52, unit=&quot;%&quot;, rounding=&quot;pct1_dropremainder&quot;))# 18 records, from 468 (included) to 486 (excluded).train_52_54pct1_ds = datasets.load_dataset(&quot;bookcorpus&quot;, split=datasets.ReadInstruction(&quot;train&quot;,from_=52, to=54, unit=&quot;%&quot;, rounding=&quot;pct1_dropremainder&quot;))# Or equivalently:train_50_52pct1_ds = datasets.load_dataset(&quot;bookcorpus&quot;, split=&quot;train[50%:52%](pct1_dropremainder)&quot;)train_52_54pct1_ds = datasets.load_dataset(&quot;bookcorpus&quot;, split=&quot;train[52%:54%](pct1_dropremainder)&quot;)# åŠ è½½å…¨éƒ¨æ•°æ®dataset = load_dataset(&quot;rotten_tomatoes&quot;)DatasetDict({    train: Dataset({        features: ['text', 'label'],        num_rows: 8530    })    validation: Dataset({        features: ['text', 'label'],        num_rows: 1066    })    test: Dataset({        features: ['text', 'label'],        num_rows: 1066    })})æŸ¥çœ‹æ•°æ®é›†å­é›†ï¼Œä¸€ä¸ªæ•°æ®ä¸‹å¯èƒ½è¿˜æœ‰å¾ˆå¤šå­æ•°æ®é›†123456from datasets import get_dataset_config_namesconfigs = get_dataset_config_names(&quot;PolyAI/minds14&quot;)print(configs)['cs-CZ', 'de-DE', 'en-AU', 'en-GB', 'en-US', 'es-ES', 'fr-FR', 'it-IT', 'ko-KR', 'nl-NL', 'pl-PL', 'pt-PT', 'ru-RU', 'zh-CN', 'all']åŠ è½½æŒ‡å®šå­æ•°æ®é›†123from datasets import load_datasetmindsFR = load_dataset(&quot;PolyAI/minds14&quot;, &quot;fr-FR&quot;, split=&quot;train&quot;) # æŒ‡å®šå­æ•°æ®é›†æ˜¯fr-FRæŒ‡å®šæ•°æ®é›†çš„æ–‡ä»¶, é¿å…loadè¿‡å¤šçš„æ•°æ®12data_files = {&quot;validation&quot;: &quot;en/c4-validation.*.json.gz&quot;}c4_validation = load_dataset(&quot;allenai/c4&quot;, data_files=data_files, split=&quot;validation&quot;)loadæœ¬åœ°çš„jsonã€csvæ–‡ä»¶ç­‰ï¼Œå¯ä»¥loadè¿œç¨‹æ–‡ä»¶ã€sqlç­‰1234567#{&quot;version&quot;: &quot;0.1.0&quot;,# &quot;data&quot;: [{&quot;a&quot;: 1, &quot;b&quot;: 2.0, &quot;c&quot;: &quot;foo&quot;, &quot;d&quot;: false},#          {&quot;a&quot;: 4, &quot;b&quot;: -5.5, &quot;c&quot;: null, &quot;d&quot;: true}]#}from datasets import load_datasetdataset = load_dataset(&quot;json&quot;, data_files=&quot;my_file.json&quot;, field=&quot;data&quot;)é€šè¿‡pythonå¯¹è±¡æ¥åˆ›å»ºdataset1234567891011121314from datasets import Datasetimport pandas as pd# å­—å…¸æ–¹å¼my_dict = {&quot;a&quot;: [1, 2, 3]}dataset = Dataset.from_dict(my_dict)# listæ–¹å¼my_list = [{&quot;a&quot;: 1}, {&quot;a&quot;: 2}, {&quot;a&quot;: 3}]dataset = Dataset.from_list(my_list)# pandasæ–¹å¼df = pd.DataFrame({&quot;a&quot;: [1, 2, 3]})dataset = Dataset.from_pandas(df)loadå¤šä¸ªæ–‡æœ¬æ–‡ä»¶: æ–‡æœ¬å¿…é¡»ä¸€è¡Œå°±æ˜¯ä¸€æ¡æ ·æœ¬12345from datasets import load_datasetdataset = load_dataset(&quot;text&quot;, data_files={&quot;train&quot;: [&quot;my_text_1.txt&quot;, &quot;my_text_2.txt&quot;], &quot;test&quot;: &quot;my_test_file.txt&quot;})# Load from a directorydataset = load_dataset(&quot;text&quot;, data_dir=&quot;path/to/text/dataset&quot;)ç¦»çº¿load: å°†ç¯å¢ƒå˜é‡HF_DATASETS_OFFLINEè®¾ç½®ä¸º1ä»¥å¯ç”¨å®Œå…¨ç¦»çº¿æ¨¡å¼è¿›é˜¶åŠ è½½æ•°æ®é›†ä»è„šæœ¬åŠ è½½æ•°æ®é›†æ‚¨å¯èƒ½åœ¨æœ¬åœ°è®¡ç®—æœºä¸Šæœ‰ä¸€ä¸ªğŸ¤—Datasetsçš„åŠ è½½è„šæœ¬ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé€šè¿‡å°†ä»¥ä¸‹è·¯å¾„ä¹‹ä¸€ä¼ é€’ç»™load_dataset()æ¥åŠ è½½æ•°æ®é›†ï¼šåŠ è½½è„šæœ¬æ–‡ä»¶çš„æœ¬åœ°è·¯å¾„ã€‚ åŒ…å«åŠ è½½è„šæœ¬æ–‡ä»¶çš„ç›®å½•çš„æœ¬åœ°è·¯å¾„(ä»…å½“è„šæœ¬æ–‡ä»¶ä¸ç›®å½•å…·æœ‰ç›¸åŒçš„åç§°æ—¶)1234dataset = load_dataset(&quot;path/to/local/loading_script/loading_script.py&quot;, split=&quot;train&quot;)# equivalent because the file has the same name as the directorydataset = load_dataset(&quot;path/to/local/loading_script&quot;, split=&quot;train&quot;)å¯ä»¥ä»Hubä¸Šä¸‹è½½åŠ è½½è„šæœ¬ï¼Œå¹¶å¯¹å…¶è¿›è¡Œç¼–è¾‘ä»¥æ·»åŠ è‡ªå·±çš„ä¿®æ”¹ã€‚å°†æ•°æ®é›†ä»“åº“ä¸‹è½½åˆ°æœ¬åœ°ï¼Œä»¥ä¾¿åŠ è½½è„šæœ¬ä¸­ç›¸å¯¹è·¯å¾„å¼•ç”¨çš„ä»»ä½•æ•°æ®æ–‡ä»¶éƒ½å¯ä»¥è¢«åŠ è½½1git clone https://huggingface.co/datasets/eli5åœ¨åŠ è½½è„šæœ¬ä¸Šè¿›è¡Œç¼–è¾‘åï¼Œé€šè¿‡å°†å…¶æœ¬åœ°è·¯å¾„ä¼ é€’ç»™load_dataset()æ¥åŠ è½½å®ƒ123from datasets import load_dataseteli5 = load_dataset(&quot;path/to/local/eli5&quot;)csv+jsonæ–¹å¼æ•°æ®é›†å¯ä»¥ä»å­˜å‚¨åœ¨è®¡ç®—æœºä¸Šçš„æœ¬åœ°æ–‡ä»¶å’Œè¿œç¨‹æ–‡ä»¶ä¸­åŠ è½½ã€‚è¿™äº›æ•°æ®é›†å¾ˆå¯èƒ½ä»¥csvã€jsonã€txtæˆ–parquetæ–‡ä»¶çš„å½¢å¼å­˜å‚¨ã€‚load_dataset()å‡½æ•°å¯ä»¥åŠ è½½è¿™äº›æ–‡ä»¶ç±»å‹çš„æ•°æ®é›†1234567891011121314151617181920212223242526from datasets import load_dataset# csvæ–¹å¼dataset = load_dataset(&quot;csv&quot;, data_files=&quot;my_file.csv&quot;)# jsonæ–¹å¼# {&quot;a&quot;: 1, &quot;b&quot;: 2.0, &quot;c&quot;: &quot;foo&quot;, &quot;d&quot;: false}# {&quot;a&quot;: 4, &quot;b&quot;: -5.5, &quot;c&quot;: null, &quot;d&quot;: true}dataset = load_dataset(&quot;json&quot;, data_files=&quot;my_file.json&quot;)# {&quot;version&quot;: &quot;0.1.0&quot;,#  &quot;data&quot;: [{&quot;a&quot;: 1, &quot;b&quot;: 2.0, &quot;c&quot;: &quot;foo&quot;, &quot;d&quot;: false},#           {&quot;a&quot;: 4, &quot;b&quot;: -5.5, &quot;c&quot;: null, &quot;d&quot;: true}]# }dataset = load_dataset(&quot;json&quot;, data_files=&quot;my_file.json&quot;, field=&quot;data&quot;)# ä»httpæ–¹å¼åŠ è½½csvbase_url = &quot;https://rajpurkar.github.io/SQuAD-explorer/dataset/&quot;dataset = load_dataset(&quot;json&quot;, data_files={&quot;train&quot;: base_url + &quot;train-v1.1.json&quot;, &quot;validation&quot;: base_url + &quot;dev-v1.1.json&quot;}, field=&quot;data&quot;)# Parquetæ–¹å¼dataset = load_dataset(&quot;parquet&quot;, data_files={'train': 'train.parquet', 'test': 'test.parquet'})base_url = &quot;https://storage.googleapis.com/huggingface-nlp/cache/datasets/wikipedia/20200501.en/1.0.0/&quot;data_files = {&quot;train&quot;: base_url + &quot;wikipedia-train.parquet&quot;}wiki = load_dataset(&quot;parquet&quot;, data_files=data_files, split=&quot;train&quot;)sqlæ–¹å¼ä½¿ç”¨from_sql()æ–¹æ³•å¯ä»¥é€šè¿‡æŒ‡å®šè¿æ¥åˆ°æ•°æ®åº“çš„URIæ¥è¯»å–æ•°æ®åº“å†…å®¹ã€‚æ‚¨å¯ä»¥è¯»å–è¡¨åæˆ–æ‰§è¡ŒæŸ¥è¯¢æ“ä½œ1234from datasets import Datasetdataset = Dataset.from_sql(&quot;data_table_name&quot;, con=&quot;sqlite:///sqlite_file.db&quot;)dataset = Dataset.from_sql(&quot;SELECT text FROM table WHERE length(text) &gt; 100 LIMIT 10&quot;, con=&quot;sqlite:///sqlite_file.db&quot;)For more details, check out the how to load tabular datasets from SQL databases guide.æ¢ç´¢æ•°æ®é›†ä¸‹æ ‡12345678910111213# ç¬¬ä¸€ä¸ªæ ·æœ¬dataset[0]#{'label': 1,# 'text': 'the rock is destined to be the 21st century\'s new &quot; conan &quot; and that he\'s going to make a splash even greater than arnold schwarzenegger , jean-claud van damme or steven segal .'}# æœ€åä¸€ä¸ªæ ·æœ¬dataset[-1]# åªå–textåˆ—dataset[&quot;text&quot;] # è¿”å›a list of æ ·æœ¬åˆ—# ç¬¬ä¸€ä¸ªæ ·æœ¬textåˆ—dataset[0][&quot;text&quot;] # æ€§èƒ½ï¼šdataset[0]['text']æ¯”dataset['text'][0]å¿«2å€ã€‚æ•°æ®åˆ‡ç‰‡12345# Get the first three rowsdataset[:3]# Get rows between three and sixdataset[3:6]è¿­ä»£æ–¹å¼ï¼Œstreaming=True1234567891011121314151617from datasets import load_datasetiterable_dataset = load_dataset(&quot;food101&quot;, split=&quot;train&quot;, streaming=True)for example in iterable_dataset:    print(example)    break    {'image': &lt;PIL.JpegImagePlugin.JpegImageFile image mode=RGB size=384x512 at 0x7F0681F5C520&gt;, 'label': 6}# Get first three exampleslist(iterable_dataset.take(3))[{'image': &lt;PIL.JpegImagePlugin.JpegImageFile image mode=RGB size=384x512 at 0x7F7479DEE9D0&gt;,  'label': 6}, {'image': &lt;PIL.JpegImagePlugin.JpegImageFile image mode=RGB size=512x512 at 0x7F7479DE8190&gt;,  'label': 6}, {'image': &lt;PIL.JpegImagePlugin.JpegImageFile image mode=RGB size=512x383 at 0x7F7479DE8310&gt;,  'label': 6}]æ’åº+shuffle+é€‰æ‹©+filter+åˆ‡åˆ†æ•°æ®é›†+åˆ†ç‰‡12345678910111213141516171819202122232425# sort: æŒ‰æŸä¸€åˆ—æ’åºdataset.sort(&quot;label&quot;)# æ‰“ä¹±shuffled_dataset = sorted_dataset.shuffle(seed=42)# é€‰æ‹©small_dataset = dataset.select([0, 10, 20, 30, 40, 50])# åŒ¹é…æŸ¥æ‰¾start_with_ar = dataset.filter(lambda example: example[&quot;sentence1&quot;].startswith(&quot;Ar&quot;))len(start_with_ar)start_with_ar[&quot;sentence1&quot;]# åŒ¹é…æŸ¥æ‰¾ï¼šæ ¹æ®ä¸‹æ ‡even_dataset = dataset.filter(lambda example, idx: idx % 2 == 0, with_indices=True)# åˆ‡åˆ†dataset.train_test_split(test_size=0.1)# åˆ†ç‰‡# æ•°æ®é›†æ”¯æŒåˆ†ç‰‡ï¼Œå°†éå¸¸å¤§çš„æ•°æ®é›†åˆ’åˆ†ä¸ºé¢„å®šä¹‰æ•°é‡çš„å—ã€‚ åœ¨ shard() ä¸­æŒ‡å®š num_shards å‚æ•°ä»¥ç¡®å®šè¦å°†æ•°æ®é›†æ‹†åˆ†æˆçš„åˆ†ç‰‡æ•°ã€‚ æ‚¨è¿˜éœ€è¦ä½¿ç”¨ index å‚æ•°æä¾›è¦è¿”å›çš„åˆ†ç‰‡ã€‚from datasets import load_datasetdatasets = load_dataset(&quot;imdb&quot;, split=&quot;train&quot;)print(dataset)dataset.shard(num_shards=4, index=0) # å››åˆ†ä¹‹ä¸€åˆ—é‡å‘½å+ç§»é™¤åˆ—+è½¬æ¢æ ¼å¼+flatten1234567891011121314151617181920from datasets import ClassLabel, Valuefrom datasets import load_dataset# åˆ—é‡å‘½ådataset = dataset.rename_column(&quot;sentence1&quot;, &quot;sentenceA&quot;)# å»æ‰æŸä¸€åˆ—dataset = dataset.remove_columns([&quot;sentence1&quot;, &quot;sentence2&quot;])# è½¬æ¢æ ¼å¼ï¼šä¸€åˆ—æˆ–è€…å¤šåˆ—new_features = dataset.features.copy()new_features[&quot;label&quot;] = ClassLabel(names=[&quot;negative&quot;, &quot;positive&quot;])new_features[&quot;idx&quot;] = Value(&quot;int64&quot;)dataset = dataset.cast(new_features)# è½¬æ¢æ ¼å¼ï¼šä¸€åˆ—dataset = dataset.cast_column(&quot;audio&quot;, Audio(sampling_rate=16000))# å°†æŸä¸€åˆ—çš„key\valueæ‹‰å¹³dataset = load_dataset(&quot;squad&quot;, split=&quot;train&quot;) # ???mapè½¬æ¢1234567891011121314151617181920212223242526272829303132333435363738394041424344454647from multiprocess import set_start_methodfrom datasets import load_datasetimport torchimport osset_start_method(&quot;spawn&quot;)# remove_columns è½¬æ¢çš„åŒæ—¶å»æ‰æŸä¸€åˆ—updated_dataset = dataset.map(lambda example: {&quot;new_sentence&quot;: example[&quot;sentence1&quot;]}, remove_columns=[&quot;sentence1&quot;])updated_dataset.column_names# with_indices: å¯¹ä¸‹æ ‡å¤„ç†updated_dataset = dataset.map(lambda example, idx: {&quot;sentence2&quot;: f&quot;{idx}: &quot; + example[&quot;sentence2&quot;]}, with_indices=True)updated_dataset[&quot;sentence2&quot;][:5]#å¦‚æœæ‚¨è®¾ç½®with_rank=Trueï¼Œmap()ä¹Ÿé€‚ç”¨äºè¿›ç¨‹çš„ç­‰çº§ã€‚ è¿™ç±»ä¼¼äºwith_indiceså‚æ•°ã€‚ æ˜ å°„å‡½æ•°ä¸­çš„with_rankå‚æ•°ä½äºç´¢å¼•1ä¹‹å(å¦‚æœå®ƒå·²ç»å­˜åœ¨)def gpu_computation(example, rank):    os.environ[&quot;CUDA_VISIBLE_DEVICES&quot;] = str(rank % torch.cuda.device_count())    # Your big GPU call goes here    return examplesupdated_dataset = dataset.map(gpu_computation, with_rank=True)# å¤šçº¿ç¨‹updated_dataset = dataset.map(lambda example, idx: {&quot;sentence2&quot;: f&quot;{idx}: &quot; + example[&quot;sentence2&quot;]}, num_proc=4)# batchedchunked_dataset = dataset.map(chunk_examples, batched=True, remove_columns=dataset.column_names)# æ•°æ®å¢å¼ºdef augment_data(examples):    outputs = []    for sentence in examples[&quot;sentence1&quot;]:        words = sentence.split(' ')        K = randint(1, len(words)-1)        masked_sentence = &quot; &quot;.join(words[:K]  + [mask_token] + words[K+1:])        predictions = fillmask(masked_sentence)        augmented_sequences = [predictions[i][&quot;sequence&quot;] for i in range(3)]        outputs += [sentence] + augmented_sequences    return {&quot;data&quot;: outputs}augmented_dataset = smaller_dataset.map(augment_data, batched=True, remove_columns=dataset.column_names, batch_size=8)augmented_dataset[:9][&quot;data&quot;]# å¤„ç†å¤šsplitdataset = load_dataset('glue', 'mrpc')encoded_dataset = dataset.map(lambda examples: tokenizer(examples[&quot;sentence1&quot;]), batched=True)encoded_dataset[&quot;train&quot;][0]åˆå¹¶+æ‹¼æ¥æ•°æ®é›†1234567891011121314from datasets import concatenate_datasets, load_datasetfrom datasets import Dataset# åŠ è½½æ•°æ®é›†bookcorpus = load_dataset(&quot;bookcorpus&quot;, split=&quot;train&quot;)wiki = load_dataset(&quot;wikipedia&quot;, &quot;20220301.en&quot;, split=&quot;train&quot;)wiki = wiki.remove_columns([col for col in wiki.column_names if col != &quot;text&quot;])  # only keep the 'text' columnassert bookcorpus.features.type == wiki.features.typebert_dataset = concatenate_datasets([bookcorpus, wiki])# å¯ä»¥æ¢concateçš„æ–¹å‘bookcorpus_ids = Dataset.from_dict({&quot;ids&quot;: list(range(len(bookcorpus)))})bookcorpus_with_ids = concatenate_datasets([bookcorpus, bookcorpus_ids], axis=1)ç›¸äº’ç©¿æ’1234567891011121314151617import torch# æŒ‰æ¦‚ç‡ç©¿æ’seed = 42probabilities = [0.3, 0.5, 0.2]d1 = Dataset.from_dict({&quot;a&quot;: [0, 1, 2]})d2 = Dataset.from_dict({&quot;a&quot;: [10, 11, 12, 13]})d3 = Dataset.from_dict({&quot;a&quot;: [20, 21, 22]})dataset = interleave_datasets([d1, d2, d3], probabilities=probabilities, seed=seed)dataset[&quot;a&quot;]# æŒ‰æ‰€æœ‰çš„æ ·æœ¬éƒ½å‡ºç°è¿‡ä¸€æ¬¡åï¼Œé©¬ä¸Šåœæ­¢d1 = Dataset.from_dict({&quot;a&quot;: [0, 1, 2]})d2 = Dataset.from_dict({&quot;a&quot;: [10, 11, 12, 13]})d3 = Dataset.from_dict({&quot;a&quot;: [20, 21, 22]})dataset = interleave_datasets([d1, d2, d3], stopping_strategy=&quot;all_exhausted&quot;)dataset[&quot;a&quot;]format1234567dataset.set_format(type=&quot;torch&quot;, columns=[&quot;input_ids&quot;, &quot;token_type_ids&quot;, &quot;attention_mask&quot;, &quot;label&quot;])# è¿”å›ä¸€ä¸ªæ–°datasetdataset = dataset.with_format(type=&quot;torch&quot;, columns=[&quot;input_ids&quot;, &quot;token_type_ids&quot;, &quot;attention_mask&quot;, &quot;label&quot;])# æŸ¥çœ‹dataset.formatä¿å­˜12345678from datasets import load_from_diskencoded_dataset.save_to_disk(&quot;path/of/my/dataset/directory&quot;)# ä»æœ¬åœ°loadä¸Šæ¥reloaded_dataset = load_from_disk(&quot;path/of/my/dataset/directory&quot;)encoded_dataset.to_csv(&quot;path/of/my/dataset.csv&quot;)Dataset.to_json()Preprocesså¤„ç†æ–‡æœ¬å¤„ç†ï¼šç”¨transformersçš„tokenizer1234567891011from transformers import AutoTokenizerfrom datasets import load_datasettokenizer = AutoTokenizer.from_pretrained(&quot;bert-base-uncased&quot;)dataset = load_dataset(&quot;rotten_tomatoes&quot;, split=&quot;train&quot;)tokenizer(dataset[0][&quot;text&quot;]){'input_ids': [101, 1103, 2067, 1110, 17348, 1106, 1129, 1103, 6880, 1432, 112, 188, 1207, 107, 14255, 1389, 107, 1105, 1115, 1119, 112, 188, 1280, 1106, 1294, 170, 24194, 1256, 3407, 1190, 170, 11791, 5253, 188, 1732, 7200, 10947, 12606, 2895, 117, 179, 7766, 118, 172, 15554, 1181, 3498, 6961, 3263, 1137, 188, 1566, 7912, 14516, 6997, 119, 102],  'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],  'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]}åˆ†è¯å™¨è¿”å›ä¸€ä¸ªåŒ…å«ä¸‰ä¸ªé¡¹ç›®çš„å­—å…¸ï¼šinput_idsï¼šè¡¨ç¤ºæ–‡æœ¬ä¸­å„ä¸ªæ ‡è®°çš„æ•°å­—token_type_idsï¼šå¦‚æœæœ‰å¤šä¸ªåºåˆ—ï¼ŒæŒ‡ç¤ºä¸€ä¸ªæ ‡è®°å±äºå“ªä¸ªåºåˆ—attention_maskï¼šæŒ‡ç¤ºä¸€ä¸ªæ ‡è®°æ˜¯å¦åº”è¯¥è¢«æ©ç›–(masked)1dataset.set_format(type=&quot;torch&quot;, columns=[&quot;input_ids&quot;, &quot;token_type_ids&quot;, &quot;attention_mask&quot;, &quot;labels&quot;])éŸ³é¢‘ä¿¡å·ï¼šé‡æ–°é‡‡æ ·éŸ³é¢‘ä¿¡å·123456789101112from transformers import AutoFeatureExtractorfrom datasets import load_dataset, Audiofeature_extractor = AutoFeatureExtractor.from_pretrained(&quot;facebook/wav2vec2-base-960h&quot;)dataset = load_dataset(&quot;PolyAI/minds14&quot;, &quot;en-US&quot;, split=&quot;train&quot;)dataset[0][&quot;audio&quot;]{'array': array([ 0.        ,  0.00024414, -0.00024414, ..., -0.00024414,         0.        ,  0.        ], dtype=float32), 'path': '/root/.cache/huggingface/datasets/downloads/extracted/f14948e0e84be638dd7943ac36518a4cf3324e8b7aa331c5ab11541518e9368c/en-US~JOINT_ACCOUNT/602ba55abb1e6d0fbce92065.wav', 'sampling_rate': 8000}MInDS-14æ•°æ®é›†å¡ä¼šå‘Šè¯‰æ‚¨é‡‡æ ·ç‡ä¸º8kHzWav2Vec2æ¨¡å‹å¡è¯´å®ƒæ˜¯åœ¨16kHzè¯­éŸ³éŸ³é¢‘ä¸Šé‡‡æ ·çš„ã€‚ è¿™æ„å‘³ç€æ‚¨éœ€è¦å¯¹MInDS-14æ•°æ®é›†è¿›è¡Œä¸Šé‡‡æ ·ä»¥åŒ¹é…æ¨¡å‹çš„é‡‡æ ·ç‡ä½¿ç”¨cast_column()å‡½æ•°å¹¶åœ¨AudioåŠŸèƒ½ä¸­è®¾ç½®sampling_rateå‚æ•°ä»¥å¯¹éŸ³é¢‘ä¿¡å·è¿›è¡Œä¸Šé‡‡æ ·ã€‚ å½“æ‚¨ç°åœ¨è°ƒç”¨éŸ³é¢‘åˆ—æ—¶ï¼Œå®ƒä¼šè¢«è§£ç å¹¶é‡æ–°é‡‡æ ·åˆ°16kHzï¼š123456789101112dataset = dataset.cast_column(&quot;audio&quot;, Audio(sampling_rate=16_000))dataset[0][&quot;audio&quot;]# åŠ é€Ÿï¼šä½¿ç”¨ map() å‡½æ•°å°†æ•´ä¸ªæ•°æ®é›†é‡æ–°é‡‡æ ·åˆ°16kHzdef preprocess_function(examples):    audio_arrays = [x[&quot;array&quot;] for x in examples[&quot;audio&quot;]]    inputs = feature_extractor(        audio_arrays, sampling_rate=feature_extractor.sampling_rate, max_length=16000, truncation=True    )    return inputsdataset = dataset.map(preprocess_function, batched=True)å›¾åƒå¢å¼ºåœ¨å›¾åƒæ•°æ®é›†ä¸­ï¼Œæœ€å¸¸è§çš„é¢„å¤„ç†æ“ä½œä¹‹ä¸€æ˜¯æ•°æ®å¢å¼º(data augmentation)ï¼Œè¿™æ˜¯ä¸€ç§åœ¨ä¸æ”¹å˜æ•°æ®å«ä¹‰çš„æƒ…å†µä¸‹å¯¹å›¾åƒå¼•å…¥éšæœºå˜åŒ–çš„è¿‡ç¨‹è¿™å¯ä»¥åŒ…æ‹¬æ”¹å˜å›¾åƒçš„é¢œè‰²å±æ€§æˆ–éšæœºè£å‰ªå›¾åƒã€‚æ‚¨å¯ä»¥è‡ªç”±é€‰æ‹©ä»»ä½•æ•°æ®å¢å¼ºåº“ï¼Œå¹¶ä¸”ğŸ¤—Datasetså°†å¸®åŠ©æ‚¨å°†æ•°æ®å¢å¼ºåº”ç”¨åˆ°æ‚¨çš„æ•°æ®é›†ä¸­12345678910111213141516from transformers import AutoFeatureExtractorfrom datasets import load_dataset, Imagefrom torchvision.transforms import RandomRotationfeature_extractor = AutoFeatureExtractor.from_pretrained(&quot;google/vit-base-patch16-224-in21k&quot;)dataset = load_dataset(&quot;beans&quot;, split=&quot;train&quot;)rotate = RandomRotation(degrees=(0, 90))def transforms(examples):    examples[&quot;pixel_values&quot;] = [rotate(image.convert(&quot;RGB&quot;)) for image in examples[&quot;image&quot;]]    return examples# åº”ç”¨å›¾åƒè½¬æ¢dataset.set_transform(transforms)dataset[0][&quot;pixel_values&quot;]label idå¯¹é½åœ¨Transformersåº“ä¸­ï¼Œlabel idå¯¹é½(label ID alignment)é€šå¸¸æŒ‡çš„æ˜¯å°†æ ‡ç­¾ä¸æ¨¡å‹è¾“å‡ºçš„é¢„æµ‹ç»“æœå¯¹é½ã€‚å½“ä½¿ç”¨é¢„è®­ç»ƒæ¨¡å‹è¿›è¡Œåˆ†ç±»æˆ–å›å½’ç­‰ä»»åŠ¡æ—¶ï¼Œé€šå¸¸éœ€è¦å°†æ ‡ç­¾æ˜ å°„ä¸ºæ¨¡å‹æœŸæœ›çš„æ ‡ç­¾IDå…·ä½“æ¥è¯´ï¼Œå¯¹äºåˆ†ç±»ä»»åŠ¡ï¼Œå¸¸è§çš„åšæ³•æ˜¯å°†æ ‡ç­¾æ˜ å°„ä¸ºæ•´æ•°æ ‡ç­¾IDã€‚ä¾‹å¦‚ï¼Œå¦‚æœæœ‰ä¸‰ä¸ªç±»åˆ«[â€œcatâ€, â€œdogâ€, â€œbirdâ€]ï¼Œå¯ä»¥å°†å®ƒä»¬æ˜ å°„ä¸º[0, 1, 2]ï¼Œå¹¶å°†æ¨¡å‹çš„è¾“å‡ºæ ‡ç­¾é¢„æµ‹ç»“æœä¸è¿™äº›æ ‡ç­¾IDè¿›è¡Œå¯¹é½å¯¹äºå›å½’ä»»åŠ¡ï¼Œå¯èƒ½éœ€è¦å°†è¿ç»­å€¼çš„æ ‡ç­¾è¿›è¡Œç¦»æ•£åŒ–æˆ–å½’ä¸€åŒ–ï¼Œå¹¶å°†å…¶æ˜ å°„ä¸ºæ ‡ç­¾IDã€‚ä¾‹å¦‚ï¼Œå°†ä¸€ä¸ªè¿ç»­çš„ç›®æ ‡å€¼èŒƒå›´æ˜ å°„ä¸ºä¸€ç»„ç¦»æ•£çš„æ ‡ç­¾IDåœ¨ä½¿ç”¨Transformersåº“è¿›è¡Œè®­ç»ƒæˆ–è¯„ä¼°æ—¶ï¼Œæ‚¨éœ€è¦ç¡®ä¿æ ‡ç­¾ä¸æ¨¡å‹çš„è¾“å‡ºç»“æœå…·æœ‰ç›¸åŒçš„æ ‡ç­¾IDå¯¹é½ï¼Œä»¥ä¾¿æ­£ç¡®è®¡ç®—æŸå¤±ã€è¯„ä¼°æŒ‡æ ‡å’Œè§£ç é¢„æµ‹ç»“æœéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ ‡ç­¾IDå¯¹é½çš„å…·ä½“å®ç°æ–¹å¼å¯èƒ½å› ä»»åŠ¡å’Œåº“çš„ä½¿ç”¨è€Œæœ‰æ‰€ä¸åŒã€‚åœ¨å…·ä½“çš„ä»£ç å®ç°ä¸­ï¼Œæ‚¨å¯èƒ½éœ€è¦æ ¹æ®æ‚¨çš„æ•°æ®é›†å’Œæ¨¡å‹è®¾ç½®è¿›è¡Œç›¸åº”çš„æ ‡ç­¾IDå¯¹é½æ“ä½œ123456from datasets import load_datasetlabel2id = {&quot;contradiction&quot;: 0, &quot;neutral&quot;: 1, &quot;entailment&quot;: 2}mnli = load_dataset(&quot;glue&quot;, &quot;mnli&quot;, split=&quot;train&quot;)mnli_aligned = mnli.align_labels_with_mapping(label2id, &quot;label&quot;)æ„å»ºæ•°æ®é›†å¦‚æœæ‚¨ä½¿ç”¨è‡ªå·±çš„æ•°æ®ï¼Œå¯èƒ½éœ€è¦åˆ›å»ºä¸€ä¸ªæ•°æ®é›†ã€‚ä½¿ç”¨ğŸ¤—Datasetsåˆ›å»ºæ•°æ®é›†å¯ä»¥äº«å—åˆ°è¯¥åº“çš„æ‰€æœ‰ä¼˜åŠ¿ï¼šå¿«é€ŸåŠ è½½å’Œå¤„ç†æ•°æ®ã€æµå¼å¤„ç†å¤§å‹æ•°æ®é›†ã€å†…å­˜æ˜ å°„ç­‰ç­‰ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ğŸ¤—Datasetsçš„ä½ä»£ç æ–¹æ³•è½»æ¾å¿«é€Ÿåœ°åˆ›å»ºæ•°æ®é›†ï¼Œå‡å°‘å¯åŠ¨è®­ç»ƒæ¨¡å‹æ‰€éœ€çš„æ—¶é—´ã€‚åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œåªéœ€å°†æ•°æ®æ–‡ä»¶æ‹–æ”¾åˆ°Hubä¸Šçš„æ•°æ®é›†ä»“åº“ä¸­ï¼Œå°±å¯ä»¥è½»æ¾å®Œæˆåœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæ‚¨å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨ğŸ¤—Datasetsçš„ä½ä»£ç æ–¹æ³•åˆ›å»ºå„ç§ç±»å‹çš„æ•°æ®é›†ï¼šåŸºäºæ–‡ä»¶å¤¹çš„æ„å»ºå™¨(Folder-based builders)ï¼Œç”¨äºå¿«é€Ÿåˆ›å»ºå›¾åƒæˆ–éŸ³é¢‘æ•°æ®é›†ä½¿ç”¨from_æ–¹æ³•ä»æœ¬åœ°æ–‡ä»¶åˆ›å»ºæ•°æ®é›†åŸºäºæ–‡ä»¶å¤¹çš„æ„å»ºå™¨æœ‰ä¸¤ä¸ªåŸºäºæ–‡ä»¶å¤¹çš„æ„å»ºå™¨ï¼šImageFolder(å›¾åƒæ–‡ä»¶å¤¹æ„å»ºå™¨)å’ŒAudioFolder(éŸ³é¢‘æ–‡ä»¶å¤¹æ„å»ºå™¨)å®ƒä»¬æ˜¯ä½ä»£ç æ–¹æ³•ï¼Œå¯ä»¥å¿«é€Ÿåˆ›å»ºåŒ…å«æ•°åƒä¸ªç¤ºä¾‹çš„å›¾åƒã€è¯­éŸ³å’ŒéŸ³é¢‘æ•°æ®é›†ã€‚å®ƒä»¬éå¸¸é€‚ç”¨äºåœ¨æ‰©å±•åˆ°æ›´å¤§çš„æ•°æ®é›†ä¹‹å‰ï¼Œå¿«é€ŸåŸå‹åŒ–è®¡ç®—æœºè§†è§‰å’Œè¯­éŸ³æ¨¡å‹åŸºäºæ–‡ä»¶å¤¹çš„æ„å»ºå™¨ä¼šä½¿ç”¨æ‚¨çš„æ•°æ®ï¼Œå¹¶è‡ªåŠ¨ç”Ÿæˆæ•°æ®é›†çš„ç‰¹å¾ã€åˆ’åˆ†å’Œæ ‡ç­¾ã€‚å…·ä½“æ¥è¯´ï¼šImageFolderä½¿ç”¨Imageç‰¹å¾æ¥è§£ç å›¾åƒæ–‡ä»¶ã€‚å®ƒæ”¯æŒè®¸å¤šå›¾åƒæ‰©å±•æ ¼å¼ï¼Œä¾‹å¦‚jpgå’Œpngï¼Œè¿˜æ”¯æŒå…¶ä»–æ ¼å¼ã€‚æ‚¨å¯ä»¥æŸ¥çœ‹æ”¯æŒçš„å›¾åƒæ‰©å±•æ ¼å¼çš„å®Œæ•´åˆ—è¡¨AudioFolderä½¿ç”¨Audioç‰¹å¾æ¥è§£ç éŸ³é¢‘æ–‡ä»¶ã€‚å®ƒæ”¯æŒéŸ³é¢‘æ‰©å±•æ ¼å¼ï¼Œå¦‚wavå’Œmp3ï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹æ”¯æŒçš„éŸ³é¢‘æ‰©å±•æ ¼å¼çš„å®Œæ•´åˆ—è¡¨ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨çš„å›¾åƒæ•°æ®é›†(å¯¹äºéŸ³é¢‘æ•°æ®é›†ä¹Ÿæ˜¯ä¸€æ ·)å­˜å‚¨å¦‚ä¸‹æ‰€ç¤ºï¼š1234567pokemon/train/grass/bulbasaur.pngpokemon/train/fire/charmander.pngpokemon/train/water/squirtle.pngpokemon/test/grass/ivysaur.pngpokemon/test/fire/charmeleon.pngpokemon/test/water/wartortle.png12345from datasets import ImageFolderfrom datasets import AudioFolderdataset = load_dataset(&quot;imagefolder&quot;, data_dir=&quot;/path/to/pokemon&quot;)dataset = load_dataset(&quot;audiofolder&quot;, data_dir=&quot;/path/to/folder&quot;)æ•°æ®é›†ä¸­å¯ä»¥åŒ…å«æœ‰å…³æ•°æ®é›†çš„å…¶ä»–ä¿¡æ¯ï¼Œä¾‹å¦‚æ–‡æœ¬æ ‡é¢˜æˆ–è½¬å½•ï¼Œå¯ä»¥ä½¿ç”¨åŒ…å«åœ¨æ•°æ®é›†æ–‡ä»¶å¤¹ä¸­çš„metadata.csvæ–‡ä»¶æ¥è¿›è¡Œå­˜å‚¨metadataæ–‡ä»¶éœ€è¦æœ‰ä¸€ä¸ªfile_nameåˆ—ï¼Œå°†å›¾åƒæˆ–éŸ³é¢‘æ–‡ä»¶ä¸å…¶ç›¸åº”çš„å…ƒæ•°æ®è¿›è¡Œå…³è”1234file_name, textbulbasaur.png, There is a plant seed on its back right from the day this PokÃ©mon is born.charmander.png, It has a preference for hot things.squirtle.png, When it retracts its long neck into its shell, it squirts out water with vigorous force.To learn more about each of these folder-based builders, check out the and ImageFolder or AudioFolder guides.åŸºäºæ–‡ä»¶çš„æ„å»ºå™¨ä½¿ç”¨ from_generator() æ–¹æ³•æ˜¯ä»ç”Ÿæˆå™¨åˆ›å»ºæ•°æ®é›†çš„æœ€èŠ‚çœå†…å­˜çš„æ–¹å¼ï¼Œè¿™æ˜¯ç”±äºç”Ÿæˆå™¨çš„è¿­ä»£è¡Œä¸ºã€‚è¿™åœ¨å¤„ç†éå¸¸å¤§çš„æ•°æ®é›†æ—¶ç‰¹åˆ«æœ‰ç”¨ï¼Œå› ä¸ºæ•°æ®é›†æ˜¯é€æ­¥åœ¨ç£ç›˜ä¸Šç”Ÿæˆçš„ï¼Œç„¶åè¿›è¡Œå†…å­˜æ˜ å°„ï¼Œè¿™æ ·å¯ä»¥é¿å…å°†æ•´ä¸ªæ•°æ®é›†åŠ è½½åˆ°å†…å­˜ä¸­1234567from datasets import Datasetdef gen():    yield {&quot;pokemon&quot;: &quot;bulbasaur&quot;, &quot;type&quot;: &quot;grass&quot;}    yield {&quot;pokemon&quot;: &quot;squirtle&quot;, &quot;type&quot;: &quot;water&quot;}ds = Dataset.from_generator(gen)ds[0]{&quot;pokemon&quot;: &quot;bulbasaur&quot;, &quot;type&quot;: &quot;grass&quot;}åŸºäºç”Ÿæˆå™¨çš„IterableDatasetéœ€è¦ä½¿ç”¨forå¾ªç¯è¿›è¡Œè¿­ä»£ï¼Œä¾‹å¦‚ï¼š1234567from datasets import IterableDatasetds = IterableDataset.from_generator(gen)for example in ds:    print(example)    {&quot;pokemon&quot;: &quot;bulbasaur&quot;, &quot;type&quot;: &quot;grass&quot;}{&quot;pokemon&quot;: &quot;squirtle&quot;, &quot;type&quot;: &quot;water&quot;}ä½¿ç”¨from_dict()æ–¹æ³•æ˜¯ä»å­—å…¸åˆ›å»ºæ•°æ®é›†çš„ç®€å•ç›´æ¥çš„æ–¹å¼ï¼š12345from datasets import Datasetds = Dataset.from_dict({&quot;pokemon&quot;: [&quot;bulbasaur&quot;, &quot;squirtle&quot;], &quot;type&quot;: [&quot;grass&quot;, &quot;water&quot;]})ds[0]{&quot;pokemon&quot;: &quot;bulbasaur&quot;, &quot;type&quot;: &quot;grass&quot;}åˆ†äº«æ•°æ®é›†ç‚¹å‡»æ‚¨çš„ä¸ªäººèµ„æ–™å¹¶é€‰æ‹©æ–°çš„æ•°æ®é›†ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ®é›†ä»“åº“ã€‚ ä¸ºæ‚¨çš„æ•°æ®é›†é€‰æ‹©ä¸€ä¸ªåç§°ï¼Œå¹¶é€‰æ‹©å®ƒæ˜¯ä¸€ä¸ªå…¬å…±æ•°æ®é›†è¿˜æ˜¯ç§æœ‰æ•°æ®é›†ã€‚å…¬å…±æ•°æ®é›†å¯¹ä»»ä½•äººå¯è§ï¼Œè€Œç§æœ‰æ•°æ®é›†åªèƒ½ç”±æ‚¨æˆ–æ‚¨ç»„ç»‡çš„æˆå‘˜æŸ¥çœ‹ä¸€æ—¦æ‚¨çš„æ•°æ®é›†å­˜å‚¨åœ¨Hubä¸Šï¼Œä»»ä½•äººéƒ½å¯ä»¥ä½¿ç”¨load_dataset()å‡½æ•°åŠ è½½å®ƒï¼š123from datasets import load_datasetdataset = load_dataset(&quot;stevhliu/demo&quot;)ä½¿ç”¨Pythonè¿›è¡Œä¸Šä¼ å–œæ¬¢ä»¥ç¼–ç¨‹æ–¹å¼ä¸Šä¼ æ•°æ®é›†çš„ç”¨æˆ·å¯ä»¥ä½¿ç”¨huggingface_hubåº“ã€‚è¯¥åº“å…è®¸ç”¨æˆ·ä»Pythonä¸­ä¸Hubè¿›è¡Œäº¤äº’é¦–å…ˆå®‰è£…è¯¥åº“ï¼š1pip install huggingface_hubè¦åœ¨Hubä¸Šä½¿ç”¨Pythonä¸Šä¼ æ•°æ®é›†ï¼Œæ‚¨éœ€è¦ç™»å½•åˆ°æ‚¨çš„Hugging Faceè´¦æˆ·ï¼š1huggingface-cli loginä½¿ç”¨push_to_hub()å‡½æ•°å¸®åŠ©æ‚¨å°†æ–‡ä»¶æ·»åŠ ã€æäº¤å’Œæ¨é€åˆ°æ‚¨çš„ä»“åº“ï¼š12345from datasets import load_datasetdataset = load_dataset(&quot;stevhliu/demo&quot;)# dataset = dataset.map(...)  # åœ¨è¿™é‡Œè¿›è¡Œæ‰€æœ‰çš„æ•°æ®å¤„ç†dataset.push_to_hub(&quot;stevhliu/processed_demo&quot;)å¦‚æœè¦å°†æ•°æ®é›†è®¾ç½®ä¸ºç§æœ‰ï¼Œè¯·å°†privateå‚æ•°è®¾ç½®ä¸ºTrueã€‚è¯¥å‚æ•°ä»…åœ¨é¦–æ¬¡åˆ›å»ºä»“åº“æ—¶æœ‰æ•ˆ1dataset.push_to_hub(&quot;stevhliu/private_processed_demo&quot;, private=True)è¯„ä¼°æŒ‡æ ‡å®‰è£…ä¸€ç§ç”¨äºè½»æ¾è¯„ä¼°æœºå™¨å­¦ä¹ æ¨¡å‹å’Œæ•°æ®é›†çš„åº“åªéœ€ä¸€è¡Œä»£ç ï¼Œæ‚¨å°±å¯ä»¥è®¿é—®æ•°åç§ä¸åŒé¢†åŸŸ(è‡ªç„¶è¯­è¨€å¤„ç†ã€è®¡ç®—æœºè§†è§‰ã€å¼ºåŒ–å­¦ä¹ ç­‰)çš„è¯„ä¼°æ–¹æ³•æ— è®ºæ˜¯åœ¨æœ¬åœ°æœºå™¨ä¸Šè¿˜æ˜¯åœ¨åˆ†å¸ƒå¼è®­ç»ƒç¯å¢ƒä¸­ï¼Œæ‚¨éƒ½å¯ä»¥ä»¥ä¸€ç§ä¸€è‡´ä¸”å¯é‡å¤çš„æ–¹å¼è¯„ä¼°æ‚¨çš„æ¨¡å‹å®‰è£…1pip install evaluateæµ‹è¯•123python -c &quot;import evaluate; print(evaluate.load('exact_match').compute(references=['hello'], predictions=['hello']))&quot;{'exact_match': 1.0}å¿«é€Ÿå¼€å§‹æŒ‡æ ‡ç§ç±»Evaluate Metricå¡ç‰‡å®ä¾‹ğŸ¤—Evaluateæä¾›äº†å¹¿æ³›çš„è¯„ä¼°å·¥å…·ã€‚å®ƒæ¶µç›–äº†æ–‡æœ¬ã€è®¡ç®—æœºè§†è§‰ã€éŸ³é¢‘ç­‰å¤šç§å½¢å¼ï¼Œå¹¶æä¾›äº†ç”¨äºè¯„ä¼°æ¨¡å‹æˆ–æ•°æ®é›†çš„å·¥å…·ã€‚è¿™äº›å·¥å…·åˆ†ä¸ºä¸‰ä¸ªç±»åˆ«è¯„ä¼°ç±»å‹ å…¸å‹çš„æœºå™¨å­¦ä¹ æµç¨‹æ¶‰åŠåˆ°ä¸åŒæ–¹é¢çš„è¯„ä¼°ï¼Œå¯¹äºæ¯ä¸ªæ–¹é¢ï¼ŒğŸ¤— Evaluateéƒ½æä¾›äº†ç›¸åº”çš„å·¥å…·ï¼šæŒ‡æ ‡(Metric)ï¼šç”¨äºè¯„ä¼°æ¨¡å‹çš„æ€§èƒ½ï¼Œé€šå¸¸æ¶‰åŠæ¨¡å‹çš„é¢„æµ‹ç»“æœå’Œä¸€äº›çœŸå®æ ‡ç­¾ã€‚æ‚¨å¯ä»¥åœ¨evaluate-metricä¸­æ‰¾åˆ°æ‰€æœ‰é›†æˆçš„æŒ‡æ ‡æ¯”è¾ƒ(Comparison)ï¼šç”¨äºæ¯”è¾ƒä¸¤ä¸ªæ¨¡å‹ã€‚å¯ä»¥é€šè¿‡å°†å®ƒä»¬çš„é¢„æµ‹ç»“æœä¸çœŸå®æ ‡ç­¾è¿›è¡Œæ¯”è¾ƒå¹¶è®¡ç®—å®ƒä»¬çš„ä¸€è‡´æ€§æ¥è¿›è¡Œæ¯”è¾ƒã€‚æ‚¨å¯ä»¥åœ¨evaluate-comparisonä¸­æ‰¾åˆ°æ‰€æœ‰é›†æˆçš„æ¯”è¾ƒæ–¹æ³•æµ‹é‡(Measurement)ï¼šæ•°æ®é›†å’Œè®­ç»ƒåœ¨å…¶ä¸Šçš„æ¨¡å‹åŒæ ·é‡è¦ã€‚é€šè¿‡æµ‹é‡å¯ä»¥ç ”ç©¶æ•°æ®é›†çš„ç‰¹æ€§ã€‚æ‚¨å¯ä»¥åœ¨evaluate-measurementä¸­æ‰¾åˆ°æ‰€æœ‰é›†æˆçš„æµ‹é‡æ–¹æ³•æ¯ä¸ªè¯„ä¼°æ¨¡å—éƒ½ä½œä¸ºä¸€ä¸ªSpaceå­˜å‚¨åœ¨Hugging Face Hubä¸Šã€‚å®ƒä»¬æä¾›äº†ä¸€ä¸ªäº¤äº’å¼å°éƒ¨ä»¶å’Œä¸€ä¸ªæ–‡æ¡£å¡ç‰‡ï¼Œç”¨äºè®°å½•å…¶ä½¿ç”¨æ–¹æ³•å’Œé™åˆ¶è¯„ä¼°å·¥å…·ä¹‹é—´çš„å…³ç³»å’ŒåŒºåˆ«Evaluateåº“ä¸­çš„Metric(æŒ‡æ ‡)ã€Comparison(æ¯”è¾ƒ)å’ŒMeasurement(æµ‹é‡)æ˜¯ä¸‰ç§ä¸åŒçš„è¯„ä¼°å·¥å…·ï¼Œç”¨äºè¯„ä¼°æœºå™¨å­¦ä¹ æ¨¡å‹å’Œæ•°æ®é›†ã€‚å®ƒä»¬ä¹‹é—´çš„å…³ç³»å’ŒåŒºåˆ«å¦‚ä¸‹ï¼šMetric(æŒ‡æ ‡)ï¼šç”¨é€”ï¼šç”¨äºè¯„ä¼°æ¨¡å‹çš„æ€§èƒ½å…·ä½“å«ä¹‰ï¼šæŒ‡æ ‡é€šè¿‡å°†æ¨¡å‹çš„é¢„æµ‹ç»“æœä¸çœŸå®æ ‡ç­¾è¿›è¡Œæ¯”è¾ƒæ¥è¡¡é‡æ¨¡å‹çš„è¡¨ç°ç¤ºä¾‹ï¼šå‡†ç¡®ç‡ã€ç²¾ç¡®ç‡ã€å¬å›ç‡ã€F1åˆ†æ•°ç­‰ç›®çš„ï¼šæä¾›äº†å¯¹æ¨¡å‹æ€§èƒ½çš„å®šé‡è¯„ä¼°ï¼Œå¸®åŠ©è¡¡é‡æ¨¡å‹åœ¨ç‰¹å®šä»»åŠ¡ä¸Šçš„è¡¨ç°Comparison(æ¯”è¾ƒ)ï¼šç”¨é€”ï¼šç”¨äºæ¯”è¾ƒä¸¤ä¸ªæ¨¡å‹ä¹‹é—´çš„å·®å¼‚å…·ä½“å«ä¹‰ï¼šæ¯”è¾ƒå·¥å…·å°†ä¸¤ä¸ªæ¨¡å‹çš„é¢„æµ‹ç»“æœä¸çœŸå®æ ‡ç­¾è¿›è¡Œå¯¹æ¯”ï¼Œè®¡ç®—å®ƒä»¬ä¹‹é—´çš„ä¸€è‡´æ€§æˆ–å·®å¼‚ç¨‹åº¦ç¤ºä¾‹ï¼šä¸€è‡´æ€§æŒ‡æ ‡ã€ç›¸å¯¹è¯¯å·®ç­‰ç›®çš„ï¼šå¸®åŠ©è¯„ä¼°ä¸åŒæ¨¡å‹ä¹‹é—´çš„æ€§èƒ½å·®å¼‚ï¼Œæ‰¾åˆ°æ›´å¥½çš„æ¨¡å‹æˆ–è¿›è¡Œæ¨¡å‹é€‰æ‹©Measurement(æµ‹é‡)ï¼šç”¨é€”ï¼šç”¨äºç ”ç©¶æ•°æ®é›†çš„å±æ€§å’Œç‰¹æ€§å…·ä½“å«ä¹‰ï¼šæµ‹é‡å·¥å…·ç”¨äºå¯¹æ•°æ®é›†è¿›è¡Œåˆ†æï¼Œæ¢ç´¢æ•°æ®é›†çš„ç»“æ„ã€åˆ†å¸ƒã€åå·®ç­‰æ–¹é¢çš„ä¿¡æ¯ç¤ºä¾‹ï¼šæ•°æ®é›†å¤§å°ã€æ ·æœ¬åˆ†å¸ƒã€ç±»åˆ«ä¸å¹³è¡¡åº¦ç­‰ç›®çš„ï¼šæä¾›å¯¹æ•°æ®é›†çš„è¯¦ç»†äº†è§£ï¼Œå¸®åŠ©äº†è§£æ•°æ®é›†çš„ç‰¹ç‚¹å’Œæ½œåœ¨é—®é¢˜è¿™ä¸‰ç§è¯„ä¼°å·¥å…·åœ¨Evaluateåº“ä¸­å„è‡ªç‹¬ç«‹ï¼Œç”¨äºä¸åŒçš„è¯„ä¼°ç›®çš„ã€‚Metricç”¨äºè¡¡é‡æ¨¡å‹æ€§èƒ½ï¼ŒComparisonç”¨äºæ¯”è¾ƒä¸åŒæ¨¡å‹ä¹‹é—´çš„æ€§èƒ½å·®å¼‚ï¼ŒMeasurementç”¨äºç ”ç©¶å’Œäº†è§£æ•°æ®é›†çš„ç‰¹æ€§ã€‚é€šè¿‡ä½¿ç”¨è¿™äº›å·¥å…·ï¼Œå¯ä»¥å…¨é¢è¯„ä¼°å’Œç†è§£æœºå™¨å­¦ä¹ æ¨¡å‹å’Œæ•°æ®é›†çš„è¡¨ç°å’Œç‰¹ç‚¹æŒ‡æ ‡åŠ è½½å®˜æ–¹+ç¤¾åŒº æŒ‡æ ‡åœ¨ä½¿ç”¨Hugging Faceçš„Evaluateåº“åŠ è½½è¯„ä¼°å·¥å…·æ—¶ï¼Œå¯ä»¥é€šè¿‡æ˜¾å¼æŒ‡å®šè¯„ä¼°çš„ç±»å‹æ¥ç¡®ä¿åŠ è½½æ­£ç¡®çš„å·¥å…·ã€‚è¿™å¯ä»¥é˜²æ­¢åç§°å†²çªæˆ–æ··æ·†ï¼Œç¡®ä¿æ‚¨ä½¿ç”¨çš„æ˜¯æœŸæœ›çš„è¯„ä¼°å·¥å…·123456789import evaluateaccuracy = evaluate.load(&quot;accuracy&quot;)# æ˜¾å¼æŒ‡å®šè¯„ä¼°çš„ç±»å‹word_length = evaluate.load(&quot;word_length&quot;, module_type=&quot;measurement&quot;)# ç¤¾åŒºæŒ‡æ ‡element_count = evaluate.load(&quot;lvwerra/element_count&quot;, module_type=&quot;measurement&quot;)æŸ¥çœ‹å¯ç”¨çš„æ¨¡å—æ–¹æ³•1234567evaluate.list_evaluation_modules(  module_type=&quot;comparison&quot;,  include_community=False,  with_details=True)[{'name': 'mcnemar', 'type': 'comparison', 'community': False, 'likes': 1}, {'name': 'exact_match', 'type': 'comparison', 'community': False, 'likes': 0}]æŒ‡æ ‡è®¡ç®—è®¡ç®—æŒ‡æ ‡å½“æ¶‰åŠåˆ°è®¡ç®—å®é™…å¾—åˆ†æ—¶ï¼Œæœ‰ä¸¤ç§ä¸»è¦çš„æ–¹æ³•ï¼šä¸€ä½“å¼è®¡ç®—(All-in-one)ï¼šé€šè¿‡ä¸€æ¬¡æ€§å°†æ‰€æœ‰å¿…è¦çš„è¾“å…¥ä¼ é€’ç»™compute()æ–¹æ³•æ¥è®¡ç®—å¾—åˆ†123accuracy.compute(references=[0,1,0,1], predictions=[1,0,0,1]){'accuracy': 0.5}é€æ­¥è®¡ç®—(Incremental)ï¼šé€šè¿‡ä½¿ç”¨EvaluationModule.add()æˆ–EvaluationModule.add_batch()å°†å¿…è¦çš„è¾“å…¥é€æ­¥æ·»åŠ åˆ°æ¨¡å—ä¸­ï¼Œç„¶ååœ¨æœ€åä½¿ç”¨ EvaluationModule.compute()è®¡ç®—å¾—åˆ†1234567891011# addçš„æ–¹å¼for ref, pred in zip([0,1,0,1], [1,0,0,1]):    accuracy.add(references=ref, predictions=pred)accuracy.compute(){'accuracy': 0.5}# add_batchçš„æ–¹å¼for refs, preds in zip([[0,1],[0,1]], [[1,0],[0,1]]):    accuracy.add_batch(references=refs, predictions=preds)accuracy.compute(){'accuracy': 0.5}åœ¨ä½ éœ€è¦ä»¥æ‰¹é‡æ–¹å¼ä»æ¨¡å‹ä¸­è·å–é¢„æµ‹ç»“æœæ—¶ç‰¹åˆ«æœ‰ç”¨ï¼š1234for model_inputs, gold_standards in evaluation_dataset:    predictions = model(model_inputs)    metric.add_batch(references=gold_standards, predictions=predictions)metric.compute()åˆ†å¸ƒå¼æŒ‡æ ‡åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­è®¡ç®—æŒ‡æ ‡å¯èƒ½ä¼šæœ‰äº›æ£˜æ‰‹ã€‚æŒ‡æ ‡è¯„ä¼°æ˜¯åœ¨ä¸åŒçš„æ•°æ®å­é›†ä¸Šçš„å•ç‹¬Pythonè¿›ç¨‹æˆ–èŠ‚ç‚¹ä¸­æ‰§è¡Œçš„é€šå¸¸æƒ…å†µä¸‹ï¼Œå½“ä¸€ä¸ªæŒ‡æ ‡å¾—åˆ†æ˜¯å¯åŠ çš„($ f(A \cup B) = f(A) + f(B)$)æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨åˆ†å¸ƒå¼çš„reduceæ“ä½œæ¥æ”¶é›†æ¯ä¸ªæ•°æ®å­é›†çš„å¾—åˆ†ã€‚ä½†æ˜¯å½“æŒ‡æ ‡æ˜¯éå¯åŠ çš„($ f(A \cup B) \neq f(A) + f(B)$)æ—¶ï¼Œæƒ…å†µå°±ä¸é‚£ä¹ˆç®€å•äº†ã€‚ä¾‹å¦‚ï¼Œä½ ä¸èƒ½å°†æ¯ä¸ªæ•°æ®å­é›†çš„F1åˆ†æ•°ç›¸åŠ ä½œä¸ºæœ€ç»ˆçš„æŒ‡æ ‡å…‹æœè¿™ä¸ªé—®é¢˜çš„å¸¸è§æ–¹æ³•æ˜¯å›é€€åˆ°å•è¿›ç¨‹è¯„ä¼°ï¼Œä½†æŒ‡æ ‡åœ¨å•ä¸ªGPUä¸Šè¿›è¡Œè¯„ä¼°ï¼Œè¿™ä¼šå¯¼è‡´æ•ˆç‡é™ä½ğŸ¤—Evaluateé€šè¿‡ä»…åœ¨ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ä¸Šè®¡ç®—æœ€ç»ˆçš„æŒ‡æ ‡æ¥è§£å†³äº†è¿™ä¸ªé—®é¢˜é¢„æµ‹ç»“æœå’Œå‚è€ƒç»“æœè¢«åˆ†åˆ«è®¡ç®—å¹¶æä¾›ç»™æ¯ä¸ªèŠ‚ç‚¹çš„æŒ‡æ ‡ï¼Œè¿™äº›ç»“æœæš‚æ—¶å­˜å‚¨åœ¨Apache Arrowè¡¨ä¸­ï¼Œé¿å…äº†GPUæˆ–CPUå†…å­˜çš„æ··ä¹±å½“ä½ å‡†å¤‡ä½¿ç”¨compute()è®¡ç®—æœ€ç»ˆæŒ‡æ ‡æ—¶ï¼Œç¬¬ä¸€ä¸ªèŠ‚ç‚¹èƒ½å¤Ÿè®¿é—®æ‰€æœ‰å…¶ä»–èŠ‚ç‚¹ä¸Šå­˜å‚¨çš„é¢„æµ‹ç»“æœå’Œå‚è€ƒç»“æœã€‚ä¸€æ—¦å®ƒæ”¶é›†åˆ°æ‰€æœ‰çš„é¢„æµ‹ç»“æœå’Œå‚è€ƒç»“æœï¼Œcompute()å°†è¿›è¡Œæœ€ç»ˆçš„æŒ‡æ ‡è¯„ä¼°è¿™ä¸ªè§£å†³æ–¹æ¡ˆä½¿å¾—ğŸ¤—Evaluateèƒ½å¤Ÿåœ¨åˆ†å¸ƒå¼è®¾ç½®ä¸­æ‰§è¡Œåˆ†å¸ƒå¼é¢„æµ‹ï¼Œè¿™å¯¹äºæé«˜è¯„ä¼°é€Ÿåº¦éå¸¸é‡è¦ã€‚åŒæ—¶ï¼Œä½ è¿˜å¯ä»¥ä½¿ç”¨å¤æ‚çš„éå¯åŠ æŒ‡æ ‡ï¼Œè€Œä¸æµªè´¹å®è´µçš„GPUæˆ–CPUå†…å­˜ç»„åˆè¯„ä¼°é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸ä»…æƒ³è¯„ä¼°å•ä¸ªæŒ‡æ ‡ï¼Œè€Œæ˜¯æƒ³è¯„ä¼°ä¸€ç³»åˆ—ä¸åŒçš„æŒ‡æ ‡ï¼Œä»¥æ•æ‰æ¨¡å‹æ€§èƒ½çš„ä¸åŒæ–¹é¢ä¾‹å¦‚ï¼Œå¯¹äºåˆ†ç±»é—®é¢˜ï¼Œé™¤äº†å‡†ç¡®åº¦å¤–ï¼Œé€šå¸¸è¿˜ä¼šè®¡ç®—F1åˆ†æ•°ã€å¬å›ç‡å’Œç²¾ç¡®åº¦ï¼Œä»¥ä¾¿æ›´å¥½åœ°äº†è§£æ¨¡å‹çš„æ€§èƒ½ã€‚å½“ç„¶ï¼Œä½ å¯ä»¥åŠ è½½ä¸€ç³»åˆ—æŒ‡æ ‡å¹¶ä¾æ¬¡è°ƒç”¨å®ƒä»¬ã€‚ç„¶è€Œï¼Œä¸€ç§æ›´æ–¹ä¾¿çš„æ–¹æ³•æ˜¯ä½¿ç”¨combine()å‡½æ•°å°†å®ƒä»¬æ†ç»‘åœ¨ä¸€èµ·ï¼š123456789clf_metrics = evaluate.combine([&quot;accuracy&quot;, &quot;f1&quot;, &quot;precision&quot;, &quot;recall&quot;])clf_metrics.compute(predictions=[0, 1, 0], references=[0, 1, 1]){  'accuracy': 0.667,  'f1': 0.667,  'precision': 1.0,  'recall': 0.5}è‡ªåŠ¨åŒ–è¯„ä¼°ä½¿ç”¨evaluate.evaluator()æä¾›äº†è‡ªåŠ¨åŒ–çš„è¯„ä¼°åŠŸèƒ½ï¼Œåªéœ€è¦ä¸€ä¸ªæ¨¡å‹ã€æ•°æ®é›†å’Œåº¦é‡æŒ‡æ ‡ï¼Œä¸EvaluationModulesä¸­çš„åº¦é‡æŒ‡æ ‡ç›¸æ¯”ï¼Œå®ƒä¸éœ€è¦æ¨¡å‹çš„é¢„æµ‹ç»“æœã€‚å› æ­¤ï¼Œä½¿ç”¨ç»™å®šçš„åº¦é‡æŒ‡æ ‡åœ¨æ•°æ®é›†ä¸Šè¯„ä¼°æ¨¡å‹æ›´å®¹æ˜“ï¼Œå› ä¸ºæ¨ç†è¿‡ç¨‹æ˜¯åœ¨å†…éƒ¨å¤„ç†çš„ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œå®ƒä½¿ç”¨äº†transformersåº“ä¸­çš„pipelineæŠ½è±¡ã€‚ç„¶è€Œï¼Œåªè¦ç¬¦åˆpipelineæ¥å£ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨è‡ªå·±çš„æ¡†æ¶1234from transformers import pipelinefrom datasets import load_datasetfrom evaluate import evaluatorimport evaluateä¸ºäº†ä½¿ç”¨evaluatorè¿›è¡Œè¯„ä¼°ï¼Œè®©æˆ‘ä»¬åŠ è½½ä¸€ä¸ªåŸºäºIMDbè®­ç»ƒçš„transformers pipelineï¼ˆä½†ä½ ä¹Ÿå¯ä»¥ä¼ é€’è‡ªå·±çš„è‡ªå®šä¹‰æ¨ç†ç±»æ¥é€‚åº”ä»»ä½•éµå¾ªpipelineè°ƒç”¨APIçš„æ¡†æ¶ï¼‰ï¼Œå¹¶ä½¿ç”¨IMDbçš„æµ‹è¯•é›†å’Œå‡†ç¡®åº¦åº¦é‡æŒ‡æ ‡è¿›è¡Œè¯„ä¼°123456789pipe = pipeline(&quot;text-classification&quot;, model=&quot;lvwerra/distilbert-imdb&quot;, device=0)data = load_dataset(&quot;imdb&quot;, split=&quot;test&quot;).shuffle().select(range(1000))metric = evaluate.load(&quot;accuracy&quot;)task_evaluator = evaluator(&quot;text-classification&quot;)results = task_evaluator.compute(model_or_pipeline=pipe, data=data, metric=metric,                       label_mapping={&quot;NEGATIVE&quot;: 0, &quot;POSITIVE&quot;: 1},){'accuracy': 0.934}ä»…ä»…è®¡ç®—åº¦é‡æŒ‡æ ‡çš„å€¼é€šå¸¸è¿˜ä¸è¶³ä»¥çŸ¥é“ä¸€ä¸ªæ¨¡å‹æ˜¯å¦æ˜¾è‘—ä¼˜äºå¦ä¸€ä¸ªæ¨¡å‹ã€‚é€šè¿‡ä½¿ç”¨è‡ªåŠ©æ³•(bootstrapping)ï¼Œevaluateè®¡ç®—ç½®ä¿¡åŒºé—´å’Œæ ‡å‡†è¯¯å·®ï¼Œè¿™æœ‰åŠ©äºä¼°è®¡åˆ†æ•°çš„ç¨³å®šæ€§1234567891011results = eval.compute(model_or_pipeline=pipe, data=data, metric=metric,                       label_mapping={&quot;NEGATIVE&quot;: 0, &quot;POSITIVE&quot;: 1},                       strategy=&quot;bootstrap&quot;, n_resamples=200){'accuracy':    {      'confidence_interval': (0.906, 0.9406749892841922),      'standard_error': 0.00865213251082787,      'score': 0.923    }}è¯„ä¼°å™¨æœŸæœ›æ•°æ®è¾“å…¥å…·æœ‰â€textâ€å’Œâ€labelâ€åˆ—ã€‚å¦‚æœæ‚¨çš„æ•°æ®é›†ä¸åŒï¼Œå¯ä»¥ä½¿ç”¨å…³é”®å­—å‚æ•°input_column=â€textâ€å’Œlabel_column=â€labelâ€æ¥æä¾›åˆ—åç›®å‰åªæ”¯æŒâ€text-classificationâ€ä»»åŠ¡ï¼Œå°†æ¥å¯èƒ½ä¼šæ·»åŠ æ›´å¤šçš„ä»»åŠ¡ç±»å‹ç»“æœå­˜å‚¨è¯„ä¼°ç»“æœsaveå’Œpushä¿å­˜å’Œåˆ†äº«è¯„ä¼°ç»“æœæ˜¯ä¸€ä¸ªé‡è¦çš„æ­¥éª¤ã€‚æˆ‘ä»¬æä¾›evaluate.save()å‡½æ•°æ¥æ–¹ä¾¿åœ°ä¿å­˜æŒ‡æ ‡ç»“æœã€‚ä½ å¯ä»¥ä¼ é€’ä¸€ä¸ªç‰¹å®šçš„æ–‡ä»¶åæˆ–ç›®å½•ã€‚åœ¨åä¸€ç§æƒ…å†µä¸‹ï¼Œç»“æœå°†ä¿å­˜åœ¨ä¸€ä¸ªå¸¦æœ‰è‡ªåŠ¨åˆ›å»ºçš„æ–‡ä»¶åçš„æ–‡ä»¶ä¸­é™¤äº†ç›®å½•æˆ–æ–‡ä»¶åï¼Œè¯¥å‡½æ•°è¿˜æ¥å—ä»»æ„çš„é”®å€¼å¯¹ä½œä¸ºè¾“å…¥ï¼Œå¹¶å°†å®ƒä»¬å­˜å‚¨åœ¨ä¸€ä¸ªJSONæ–‡ä»¶ä¸­123456789101112131415161718result = accuracy.compute(references=[0,1,0,1], predictions=[1,0,0,1])hyperparams = {&quot;model&quot;: &quot;bert-base-uncased&quot;}evaluate.save(&quot;./results/&quot;, experiment=&quot;run 42&quot;, **result, **hyperparams)PosixPath('results/result-2022_05_30-22_09_11.json')# result-2022_05_30-22_09_11.json{    &quot;experiment&quot;: &quot;run 42&quot;,    &quot;accuracy&quot;: 0.5,    &quot;model&quot;: &quot;bert-base-uncased&quot;,    &quot;_timestamp&quot;: &quot;2022-05-30T22:09:11.959469&quot;,    &quot;_git_commit_hash&quot;: &quot;123456789abcdefghijkl&quot;,    &quot;_evaluate_version&quot;: &quot;0.1.0&quot;,    &quot;_python_version&quot;: &quot;3.9.12 (main, Mar 26 2022, 15:51:15) \n[Clang 13.1.6 (clang-1316.0.21.2)]&quot;,    &quot;_interpreter_path&quot;: &quot;/Users/leandro/git/evaluate/env/bin/python&quot;}é™¤äº†æŒ‡å®šçš„å­—æ®µï¼Œå®ƒè¿˜åŒ…å«æœ‰ç”¨çš„ç³»ç»Ÿä¿¡æ¯ï¼Œç”¨äºé‡ç°ç»“æœï¼Œä½ è¿˜åº”è¯¥å°†å®ƒä»¬æŠ¥å‘Šåˆ°æ¨¡å‹åœ¨Hubä¸Šçš„å­˜å‚¨åº“ä¸­1234567891011evaluate.push_to_hub(  model_id=&quot;huggingface/gpt2-wikitext2&quot;,  # model repository on hub  metric_value=0.5,                       # metric value  metric_type=&quot;bleu&quot;,                     # metric name, e.g. accuracy.name  metric_name=&quot;BLEU&quot;,                     # pretty name which is displayed  dataset_type=&quot;wikitext&quot;,                # dataset name on the hub  dataset_name=&quot;WikiText&quot;,                # pretty name  dataset_split=&quot;test&quot;,                   # dataset split used  task_type=&quot;text-generation&quot;,            # task id, see https://github.com/huggingface/datasets/blob/master/src/datasets/utils/resources/tasks.json  task_name=&quot;Text Generation&quot;             # pretty name for task)ä¸Šä¼ è‡ªå·±çš„æŒ‡æ ‡Creating and sharing a new evaluationå¯è§†åŒ–å½“æ¯”è¾ƒå¤šä¸ªæ¨¡å‹æ—¶ï¼Œä»…é€šè¿‡æŸ¥çœ‹å®ƒä»¬çš„å¾—åˆ†å¾€å¾€å¾ˆéš¾å‘ç°å®ƒä»¬ä¹‹é—´çš„å·®å¼‚ã€‚è€Œä¸”é€šå¸¸æƒ…å†µä¸‹ï¼Œå¹¶æ²¡æœ‰ä¸€ä¸ªå•ä¸€çš„æœ€ä½³æ¨¡å‹ï¼Œè€Œæ˜¯åœ¨å‡†ç¡®æ€§å’Œå»¶è¿Ÿç­‰æ–¹é¢å­˜åœ¨ç€æƒè¡¡ï¼Œå› ä¸ºè¾ƒå¤§çš„æ¨¡å‹å¯èƒ½å…·æœ‰æ›´å¥½çš„æ€§èƒ½ä½†ä¹Ÿæ›´æ…¢ã€‚æˆ‘ä»¬æ­£åœ¨é€æ­¥æ·»åŠ ä¸åŒçš„å¯è§†åŒ–æ–¹æ³•ï¼Œä¾‹å¦‚ç»˜å›¾ï¼Œä»¥ä¾¿æ›´è½»æ¾åœ°é€‰æ‹©é€‚åˆç‰¹å®šç”¨ä¾‹çš„æœ€ä½³æ¨¡å‹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æœ‰å¤šä¸ªæ¨¡å‹çš„ç»“æœåˆ—è¡¨ï¼ˆä»¥å­—å…¸å½¢å¼ï¼‰ï¼Œæ‚¨å¯ä»¥å°†å®ƒä»¬ä¼ é€’ç»™radar_plot()å‡½æ•°è¿›è¡Œå¯è§†åŒ–ï¼š123456789101112import evaluatefrom evaluate.visualization import radar_plotdata = [   {&quot;accuracy&quot;: 0.99, &quot;precision&quot;: 0.8, &quot;f1&quot;: 0.95, &quot;latency_in_seconds&quot;: 33.6},   {&quot;accuracy&quot;: 0.98, &quot;precision&quot;: 0.87, &quot;f1&quot;: 0.91, &quot;latency_in_seconds&quot;: 11.2},   {&quot;accuracy&quot;: 0.98, &quot;precision&quot;: 0.78, &quot;f1&quot;: 0.88, &quot;latency_in_seconds&quot;: 87.6},    {&quot;accuracy&quot;: 0.88, &quot;precision&quot;: 0.78, &quot;f1&quot;: 0.81, &quot;latency_in_seconds&quot;: 101.6}   ]model_names = [&quot;Model 1&quot;, &quot;Model 2&quot;, &quot;Model 3&quot;, &quot;Model 4&quot;]plot = radar_plot(data=data, model_names=model_names)plot.show()é€‰æ‹©åˆé€‚æŒ‡æ ‡è¯„ä¼°æŒ‡æ ‡å¯ä»¥åˆ†ä¸ºä¸‰ä¸ªé«˜çº§ç±»åˆ«ï¼šé€šç”¨æŒ‡æ ‡ï¼šé€‚ç”¨äºå„ç§æƒ…å†µå’Œæ•°æ®é›†çš„æŒ‡æ ‡ï¼Œä¾‹å¦‚ç²¾ç¡®åº¦å’Œå‡†ç¡®åº¦12345precision_metric = evaluate.load(&quot;precision&quot;)results = precision_metric.compute(references=[0, 1], predictions=[0, 1])print(results){'precision': 1.0}ä»»åŠ¡ç‰¹å®šæŒ‡æ ‡ï¼šä»…é€‚ç”¨äºç‰¹å®šä»»åŠ¡çš„æŒ‡æ ‡ï¼Œä¾‹å¦‚æœºå™¨ç¿»è¯‘(é€šå¸¸ä½¿ç”¨BLEUæˆ–ROUGEæŒ‡æ ‡è¿›è¡Œè¯„ä¼°)æˆ–å‘½åå®ä½“è¯†åˆ«(é€šå¸¸ä½¿ç”¨seqevalè¿›è¡Œè¯„ä¼°)æ•°æ®é›†ç‰¹å®šæŒ‡æ ‡ï¼šæ—¨åœ¨è¡¡é‡æ¨¡å‹åœ¨ç‰¹å®šåŸºå‡†æ•°æ®é›†ä¸Šçš„æ€§èƒ½ï¼Œä¾‹å¦‚GLUEåŸºå‡†æµ‹è¯•å…·æœ‰ä¸“é—¨çš„è¯„ä¼°æŒ‡æ ‡transformersæ¦‚è¿°What ğŸ¤— Transformers can doğŸ¤— Transformersæä¾›äº†APIå’Œå·¥å…·ï¼Œå¯è½»æ¾ä¸‹è½½å’Œè®­ç»ƒæœ€å…ˆè¿›çš„é¢„è®­ç»ƒæ¨¡å‹ã€‚ä½¿ç”¨é¢„è®­ç»ƒæ¨¡å‹å¯ä»¥å‡å°‘è®¡ç®—æˆæœ¬ã€ç¢³è¶³è¿¹ï¼Œå¹¶èŠ‚çœä»å¤´å¼€å§‹è®­ç»ƒæ¨¡å‹æ‰€éœ€çš„æ—¶é—´å’Œèµ„æºã€‚è¿™äº›æ¨¡å‹æ”¯æŒä¸åŒé¢†åŸŸçš„å¸¸è§ä»»åŠ¡ï¼ŒåŒ…æ‹¬ï¼šğŸ“ è‡ªç„¶è¯­è¨€å¤„ç†ï¼šæ–‡æœ¬åˆ†ç±»ã€å‘½åå®ä½“è¯†åˆ«ã€é—®ç­”ç³»ç»Ÿã€è¯­è¨€å»ºæ¨¡ã€æ‘˜è¦ç”Ÿæˆã€ç¿»è¯‘ã€å¤šé¡¹é€‰æ‹©å’Œæ–‡æœ¬ç”ŸæˆğŸ–¼ï¸ è®¡ç®—æœºè§†è§‰ï¼šå›¾åƒåˆ†ç±»ã€ç›®æ ‡æ£€æµ‹å’Œåˆ†å‰²ğŸ—£ï¸ éŸ³é¢‘ï¼šè‡ªåŠ¨è¯­éŸ³è¯†åˆ«å’ŒéŸ³é¢‘åˆ†ç±»ğŸ™ å¤šæ¨¡æ€ï¼šè¡¨æ ¼é—®ç­”ã€å…‰å­¦å­—ç¬¦è¯†åˆ«ã€ä»æ‰«ææ–‡æ¡£ä¸­æå–ä¿¡æ¯ã€è§†é¢‘åˆ†ç±»å’Œè§†è§‰é—®ç­”ğŸ¤— Transformersæ”¯æŒåœ¨PyTorchã€TensorFlowå’ŒJAXä¹‹é—´è¿›è¡Œæ¡†æ¶äº’æ“ä½œã€‚è¿™æä¾›äº†åœ¨æ¨¡å‹çš„ä¸åŒé˜¶æ®µä½¿ç”¨ä¸åŒæ¡†æ¶çš„çµæ´»æ€§ï¼›å¯ä»¥åœ¨ä¸€ä¸ªæ¡†æ¶ä¸­ç”¨ä¸‰è¡Œä»£ç è®­ç»ƒæ¨¡å‹ï¼Œç„¶ååœ¨å¦ä¸€ä¸ªæ¡†æ¶ä¸­åŠ è½½æ¨¡å‹è¿›è¡Œæ¨ç†ã€‚æ¨¡å‹è¿˜å¯ä»¥å¯¼å‡ºä¸ºONNXå’ŒTorchScriptç­‰æ ¼å¼ï¼Œä»¥ä¾¿åœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿›è¡Œéƒ¨ç½²å®‰è£…1pip install transformers datasetså¿«é€Ÿå¼€å§‹Pipelinepipeline()æ˜¯ä½¿ç”¨é¢„è®­ç»ƒæ¨¡å‹è¿›è¡Œæ¨ç†çš„æœ€ç®€å•å’Œæœ€å¿«æ·çš„æ–¹æ³•ã€‚æ‚¨å¯ä»¥ç›´æ¥ä½¿ç”¨pipeline()è¿›è¡Œè®¸å¤šä»»åŠ¡çš„æ¨ç†ï¼Œæ¶µç›–äº†ä¸åŒçš„æ¨¡æ€ï¼Œä¸‹è¡¨åˆ—å‡ºäº†å…¶ä¸­ä¸€äº›ä»»åŠ¡TaskDescriptionModalityPipeline identifierText classificationassign a label to a given sequence of textNLPpipeline(task=â€œsentiment-analysisâ€)Text generationgenerate text given a promptNLPpipeline(task=â€œtext-generationâ€)Summarizationgenerate a summary of a sequence of text or documentNLPpipeline(task=â€œsummarizationâ€)Image classificationassign a label to an imageCVpipeline(task=â€œimage-classificationâ€)Image segmentationassign a label to each individual pixel of an image (supports semantic, panoptic, and instance segmentation)CVpipeline(task=â€œimage-segmentationâ€)Object detectionpredict the bounding boxes and classes of objects in an imageCVpipeline(task=â€œobject-detectionâ€)Audio classificationassign a label to some audio dataAudiopipeline(task=â€œaudio-classificationâ€)Automatic speech recognitiontranscribe speech into textAudiopipeline(task=â€œautomatic-speech-recognitionâ€)Visual question answeringanswer a question about the image, given an image and a questionMultimodalpipeline(task=â€œvqaâ€)Document question answeringanswer a question about a document, given an image and a questionMultimodalpipeline(task=â€œdocument-question-answeringâ€)Image captioninggenerate a caption for a given imageMultimodalpipeline(task=â€œimage-to-textâ€)åŸºæœ¬ä½¿ç”¨é¦–å…ˆï¼Œé€šè¿‡åˆ›å»ºpipeline()çš„å®ä¾‹å¹¶æŒ‡å®šè¦ä½¿ç”¨çš„ä»»åŠ¡ï¼Œå¼€å§‹ä½¿ç”¨å®ƒã€‚åœ¨æœ¬æŒ‡å—ä¸­ï¼Œæˆ‘ä»¬ä»¥æƒ…æ„Ÿåˆ†æçš„pipeline()ä¸ºä¾‹ï¼š123from transformers import pipelineclassifier = pipeline(&quot;sentiment-analysis&quot;)pipeline()ä¼šä¸‹è½½å¹¶ç¼“å­˜ç”¨äºæƒ…æ„Ÿåˆ†æçš„é»˜è®¤é¢„è®­ç»ƒæ¨¡å‹å’Œåˆ†è¯å™¨ã€‚ç°åœ¨ï¼Œæ‚¨å¯ä»¥åœ¨ç›®æ ‡æ–‡æœ¬ä¸Šä½¿ç”¨åˆ†ç±»å™¨äº†ï¼š123classifier(&quot;We are very happy to show you the ğŸ¤— Transformers library.&quot;)[{'label': 'POSITIVE', 'score': 0.9998}]å¦‚æœæ‚¨æœ‰å¤šä¸ªè¾“å…¥ï¼Œè¯·å°†è¾“å…¥ä½œä¸ºåˆ—è¡¨ä¼ é€’ç»™pipeline()ï¼Œä»¥è¿”å›ä¸€ä¸ªå­—å…¸åˆ—è¡¨123456results = classifier([&quot;We are very happy to show you the ğŸ¤— Transformers library.&quot;, &quot;We hope you don't hate it.&quot;])for result in results:    print(f&quot;label: {result['label']}, with score: {round(result['score'], 4)}&quot;)label: POSITIVE, with score: 0.9998label: NEGATIVE, with score: 0.5309pipeline()è¿˜å¯ä»¥å¯¹ä»»ä½•æ‚¨å–œæ¬¢çš„ä»»åŠ¡è¿­ä»£æ•´ä¸ªæ•°æ®é›†ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œè®©æˆ‘ä»¬é€‰æ‹©è‡ªåŠ¨è¯­éŸ³è¯†åˆ«ä½œä¸ºæˆ‘ä»¬çš„ä»»åŠ¡1234import torchfrom transformers import pipelinespeech_recognizer = pipeline(&quot;automatic-speech-recognition&quot;, model=&quot;facebook/wav2vec2-base-960h&quot;)åŠ è½½æ‚¨æƒ³è¦è¿­ä»£çš„éŸ³é¢‘æ•°æ®é›†(æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ğŸ¤— Datasetså¿«é€Ÿå…¥é—¨)ã€‚ä¾‹å¦‚ï¼ŒåŠ è½½MInDS-14æ•°æ®é›†ï¼š123from datasets import load_dataset, Audiodataset = load_dataset(&quot;PolyAI/minds14&quot;, name=&quot;en-US&quot;, split=&quot;train&quot;)æ‚¨éœ€è¦ç¡®ä¿æ•°æ®é›†çš„é‡‡æ ·ç‡ä¸facebook/wav2vec2-base-960h è®­ç»ƒæ—¶ä½¿ç”¨çš„é‡‡æ ·ç‡ç›¸åŒ¹é…1dataset = dataset.cast_column(&quot;audio&quot;, Audio(sampling_rate=speech_recognizer.feature_extractor.sampling_rate))è°ƒç”¨â€audioâ€åˆ—æ—¶ï¼ŒéŸ³é¢‘æ–‡ä»¶ä¼šè‡ªåŠ¨åŠ è½½å’Œé‡æ–°é‡‡æ ·ã€‚ä»å‰å››ä¸ªæ ·æœ¬ä¸­æå–åŸå§‹æ³¢å½¢æ•°ç»„ï¼Œå¹¶å°†å…¶ä½œä¸ºåˆ—è¡¨ä¼ é€’ç»™pipelineï¼š1234result = speech_recognizer(dataset[:4][&quot;audio&quot;])print([d[&quot;text&quot;] for d in result])['I WOULD LIKE TO SET UP A JOINT ACCOUNT WITH MY PARTNER HOW DO I PROCEED WITH DOING THAT', &quot;FONDERING HOW I'D SET UP A JOIN TO HELL T WITH MY WIFE AND WHERE THE AP MIGHT BE&quot;, &quot;I I'D LIKE TOY SET UP A JOINT ACCOUNT WITH MY PARTNER I'M NOT SEEING THE OPTION TO DO IT ON THE APSO I CALLED IN TO GET SOME HELP CAN I JUST DO IT OVER THE PHONE WITH YOU AND GIVE YOU THE INFORMATION OR SHOULD I DO IT IN THE AP AN I'M MISSING SOMETHING UQUETTE HAD PREFERRED TO JUST DO IT OVER THE PHONE OF POSSIBLE THINGS&quot;, 'HOW DO I FURN A JOINA COUT']å¯¹äºè¾“å…¥è¾ƒå¤§çš„æ›´å¤§æ•°æ®é›†(å¦‚è¯­éŸ³æˆ–è§†è§‰æ•°æ®)ï¼Œæ‚¨å¯ä»¥å°†ç”Ÿæˆå™¨ä¼ é€’ç»™pipelineï¼Œè€Œä¸æ˜¯å°†å…¶ä½œä¸ºåˆ—è¡¨åŠ è½½åˆ°å†…å­˜ä¸­åœ¨pipelineä¸­ä½¿ç”¨å…¶ä»–æ¨¡å‹å’Œåˆ†è¯å™¨pipeline()å¯ä»¥é€‚åº”Hubä¸­çš„ä»»ä½•æ¨¡å‹ï¼Œè¿™ä½¿å¾—å¯¹pipeline()è¿›è¡Œå…¶ä»–ç”¨é€”çš„è°ƒæ•´å˜å¾—å®¹æ˜“ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æƒ³è¦ä¸€ä¸ªèƒ½å¤Ÿå¤„ç†æ³•è¯­æ–‡æœ¬çš„æ¨¡å‹ï¼Œè¯·ä½¿ç”¨Hubä¸Šçš„æ ‡ç­¾æ¥è¿‡æ»¤åˆé€‚çš„æ¨¡å‹ã€‚é€šè¿‡å¯¹è¿‡æ»¤ç»“æœè¿›è¡Œæ’åºï¼Œæ‚¨å¯ä»¥è·å¾—ä¸€ä¸ªé’ˆå¯¹æ³•è¯­æ–‡æœ¬è¿›è¡Œæƒ…æ„Ÿåˆ†æçš„å¤šè¯­è¨€BERTæ¨¡å‹åœ¨pipelineä¸­ä½¿ç”¨å¦ä¸€ä¸ªæ¨¡å‹å’Œåˆ†è¯å™¨pipeline()å¯ä»¥é€‚åº”Hubä¸­çš„ä»»ä½•æ¨¡å‹ï¼Œè¿™ä½¿å¾—å°†pipeline()é€‚åº”å…¶ä»–ç”¨ä¾‹å˜å¾—å®¹æ˜“12345678from transformers import AutoTokenizer, AutoModelForSequenceClassificationmodel_name = &quot;nlptown/bert-base-multilingual-uncased-sentiment&quot;model = AutoModelForSequenceClassification.from_pretrained(model_name)tokenizer = AutoTokenizer.from_pretrained(model_name)classifier = pipeline(&quot;sentiment-analysis&quot;, model=model, tokenizer=tokenizer)classifier(&quot;Nous sommes trÃ¨s heureux de vous prÃ©senter la bibliothÃ¨que ğŸ¤— Transformers.&quot;)AutoClassAutoClassæ˜¯ä¸€ç§å¿«æ·æ–¹å¼ï¼Œå®ƒå¯ä»¥æ ¹æ®æ¨¡å‹çš„åç§°æˆ–è·¯å¾„è‡ªåŠ¨è·å–é¢„è®­ç»ƒæ¨¡å‹çš„æ¶æ„ã€‚æ‚¨åªéœ€è¦é€‰æ‹©ä¸æ‚¨çš„ä»»åŠ¡ç›¸åŒ¹é…çš„AutoClasså’Œç›¸åº”çš„é¢„å¤„ç†ç±»AutoTokenizerAutoTokenizeråˆ†è¯å™¨è´Ÿè´£å°†æ–‡æœ¬é¢„å¤„ç†ä¸ºæ¨¡å‹è¾“å…¥çš„æ•°å­—æ•°ç»„ã€‚æœ‰å¤šä¸ªè§„åˆ™æ¥è§„å®šåˆ†è¯çš„è¿‡ç¨‹ï¼ŒåŒ…æ‹¬å¦‚ä½•æ‹†åˆ†ä¸€ä¸ªå•è¯ä»¥åŠä»¥ä½•ç§çº§åˆ«æ‹†åˆ†å•è¯æœ€é‡è¦çš„æ˜¯ï¼Œæ‚¨éœ€è¦ä½¿ç”¨ç›¸åŒçš„æ¨¡å‹åç§°æ¥å®ä¾‹åŒ–ä¸€ä¸ªåˆ†è¯å™¨ï¼Œä»¥ç¡®ä¿æ‚¨ä½¿ç”¨äº†ä¸é¢„è®­ç»ƒæ¨¡å‹ç›¸åŒçš„åˆ†è¯è§„åˆ™ä½¿ç”¨AutoTokenizeråŠ è½½ä¸€ä¸ªåˆ†è¯å™¨å°†return_tensorså‚æ•°è®¾ç½®ä¸ºptä»¥è¿”å›é€‚ç”¨äºPyTorchçš„å¼ é‡ï¼Œæˆ–è€…è®¾ç½®ä¸ºtfä»¥è¿”å›é€‚ç”¨äºTensorFlowçš„å¼ é‡123456789101112from transformers import AutoTokenizermodel_name = &quot;nlptown/bert-base-multilingual-uncased-sentiment&quot;tokenizer = AutoTokenizer.from_pretrained(model_name)encoding = tokenizer(&quot;We are very happy to show you the ğŸ¤— Transformers library.&quot;, return_tensors=&quot;pt&quot;){'input_ids': [101, 11312, 10320, 12495, 19308, 10114, 11391, 10855, 10103, 100, 58263, 13299, 119, 102], 'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]}tokenizer.decode(encoding[&quot;input_ids&quot;])&quot;We are very happy to show you the ğŸ¤— Transformers library.&quot;åˆ†è¯å™¨è¿”å›ä¸€ä¸ªåŒ…å«ä¸‰ä¸ªé¡¹ç›®çš„å­—å…¸ï¼šinput_idsï¼šè¡¨ç¤ºæ–‡æœ¬ä¸­å„ä¸ªæ ‡è®°çš„æ•°å­—token_type_idsï¼šå¦‚æœæœ‰å¤šä¸ªåºåˆ—ï¼ŒæŒ‡ç¤ºä¸€ä¸ªæ ‡è®°å±äºå“ªä¸ªåºåˆ—attention_maskï¼šæŒ‡ç¤ºä¸€ä¸ªæ ‡è®°æ˜¯å¦åº”è¯¥è¢«æ©ç›–(masked)åˆ†è¯å™¨è¿˜å¯ä»¥æ¥å—ä¸€ä¸ªè¾“å…¥åˆ—è¡¨ï¼Œå¹¶å¯¹æ–‡æœ¬è¿›è¡Œå¡«å……å’Œæˆªæ–­ï¼Œä»¥è¿”å›å…·æœ‰ç»Ÿä¸€é•¿åº¦çš„æ‰¹å¤„ç†æ•°æ®123456pt_batch = tokenizer(    [&quot;We are very happy to show you the ğŸ¤— Transformers library.&quot;, &quot;We hope you don't hate it.&quot;],    padding=True,    truncation=True,    max_length=512,    return_tensors=&quot;pt&quot;)pad + truncation1234567891011121314151617181920212223242526272829303132333435# paddingbatch_sentences = [    &quot;But what about second breakfast?&quot;,    &quot;Don't think he knows about second breakfast, Pip.&quot;,    &quot;What about elevensies?&quot;,]encoded_input = tokenizer(batch_sentences, padding=True){'input_ids': [[101, 1252, 1184, 1164, 1248, 6462, 136, 102, 0, 0, 0, 0, 0, 0, 0],                [101, 1790, 112, 189, 1341, 1119, 3520, 1164, 1248, 6462, 117, 21902, 1643, 119, 102],                [101, 1327, 1164, 5450, 23434, 136, 102, 0, 0, 0, 0, 0, 0, 0, 0]],  'token_type_ids': [[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],                     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],                     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],  'attention_mask': [[1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0],                     [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],                     [1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0]]}# truncation  å°†truncationå‚æ•°è®¾ç½®ä¸ºTrueï¼Œå¯ä»¥å°†åºåˆ—æˆªæ–­ä¸ºæ¨¡å‹æ‰€èƒ½æ¥å—çš„æœ€å¤§é•¿åº¦batch_sentences = [    &quot;But what about second breakfast?&quot;,    &quot;Don't think he knows about second breakfast, Pip.&quot;,    &quot;What about elevensies?&quot;,]encoded_input = tokenizer(batch_sentences, padding=True, truncation=True){'input_ids': [[101, 1252, 1184, 1164, 1248, 6462, 136, 102, 0, 0, 0, 0, 0, 0, 0],                [101, 1790, 112, 189, 1341, 1119, 3520, 1164, 1248, 6462, 117, 21902, 1643, 119, 102],                [101, 1327, 1164, 5450, 23434, 136, 102, 0, 0, 0, 0, 0, 0, 0, 0]],  'token_type_ids': [[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],                     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],                     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]],  'attention_mask': [[1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0],                     [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],                     [1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0]]}AutoModelğŸ¤—Transformersæä¾›äº†ä¸€ç§ç®€å•è€Œç»Ÿä¸€çš„æ–¹æ³•æ¥åŠ è½½é¢„è®­ç»ƒæ¨¡å‹å®ä¾‹ã€‚è¿™æ„å‘³ç€æ‚¨å¯ä»¥åƒåŠ è½½AutoTokenizerä¸€æ ·åŠ è½½AutoModelå”¯ä¸€çš„åŒºåˆ«æ˜¯é€‰æ‹©æ­£ç¡®çš„AutoModelæ¥é€‚åº”ä»»åŠ¡ã€‚å¯¹äºæ–‡æœ¬(æˆ–åºåˆ—)åˆ†ç±»ï¼Œæ‚¨åº”è¯¥åŠ è½½AutoModelForSequenceClassification123456from transformers import AutoModelForSequenceClassificationmodel_name = &quot;nlptown/bert-base-multilingual-uncased-sentiment&quot;pt_model = AutoModelForSequenceClassification.from_pretrained(model_name)pt_outputs = pt_model(**pt_batch)æ¨¡å‹å°†æœ€ç»ˆçš„æ¿€æ´»å€¼å­˜å‚¨åœ¨logitså±æ€§ä¸­ã€‚åº”ç”¨softmaxå‡½æ•°åˆ°logitsä¸Šä»¥è·å–æ¦‚ç‡å€¼1234567from torch import nnpt_predictions = nn.functional.softmax(pt_outputs.logits, dim=-1)tensor([[0.0021, 0.0018, 0.0115, 0.2121, 0.7725],        [0.2084, 0.1826, 0.1969, 0.1755, 0.2365]], grad_fn=&lt;SoftmaxBackward0&gt;)åœ¨huggingfaceåº“ä¸­ï¼ŒAutoModelç±»å¯ä»¥æ ¹æ®ç»™å®šçš„checkpointè‡ªåŠ¨é€‰æ‹©å¹¶åŠ è½½é€‚åˆçš„æ¨¡å‹ã€‚å®ƒæ”¯æŒå„ç§ä¸åŒçš„æ¨¡å‹æ¶æ„ï¼ŒåŒ…æ‹¬ï¼šAutoModel: ç”¨äºé€šç”¨çš„æ¨¡å‹åŠ è½½ï¼Œæ ¹æ®checkpointè‡ªåŠ¨é€‰æ‹©é€‚åˆçš„æ¨¡å‹æ¶æ„AutoModelForSequenceClassification: ç”¨äºåºåˆ—åˆ†ç±»ä»»åŠ¡çš„æ¨¡å‹ï¼Œå¦‚æ–‡æœ¬åˆ†ç±»AutoModelForQuestionAnswering: ç”¨äºé—®ç­”ä»»åŠ¡çš„æ¨¡å‹ï¼Œå¦‚é˜…è¯»ç†è§£AutoModelForTokenClassification: ç”¨äºæ ‡è®°åˆ†ç±»ä»»åŠ¡çš„æ¨¡å‹ï¼Œå¦‚å‘½åå®ä½“è¯†åˆ«AutoModelForMaskedLM: ç”¨äºé®è”½è¯­è¨€å»ºæ¨¡ä»»åŠ¡çš„æ¨¡å‹ï¼Œå¦‚BERTAutoModelForCausalLM: ç”¨äºæœ‰å› æœå…³ç³»çš„è¯­è¨€å»ºæ¨¡ä»»åŠ¡çš„æ¨¡å‹ï¼Œå¦‚GPTAutoModelForImageClassification: ç”¨äºå›¾åƒåˆ†ç±»ä»»åŠ¡çš„æ¨¡å‹ï¼Œå¦‚ResNetAutoModelForImageSegmentation: ç”¨äºå›¾åƒåˆ†å‰²ä»»åŠ¡çš„æ¨¡å‹ï¼Œå¦‚Mask R-CNNè¿™äº›ä»…æ˜¯AutoModelç±»çš„ä¸€äº›ç¤ºä¾‹ï¼Œå®é™…ä¸Šè¿˜æœ‰æ›´å¤šå¯ç”¨çš„æ¨¡å‹æ¶æ„ã€‚æ‚¨å¯ä»¥æ ¹æ®å…·ä½“çš„ä»»åŠ¡éœ€æ±‚é€‰æ‹©é€‚åˆçš„AutoModelç±»è¿›è¡ŒåŠ è½½å’Œä½¿ç”¨å…¶ä»–çš„Autoç±»AutoImageProcessorå¯¹äºè§†è§‰ä»»åŠ¡ï¼Œå›¾åƒå¤„ç†å™¨å°†å›¾åƒå¤„ç†ä¸ºæ­£ç¡®çš„è¾“å…¥æ ¼å¼123from transformers import AutoImageProcessorimage_processor = AutoImageProcessor.from_pretrained(&quot;google/vit-base-patch16-224&quot;)AutoFeatureExtractorå¯¹äºéŸ³é¢‘ä»»åŠ¡ï¼Œç‰¹å¾æå–å™¨å°†éŸ³é¢‘ä¿¡å·å¤„ç†ä¸ºæ­£ç¡®çš„è¾“å…¥æ ¼å¼12345from transformers import AutoFeatureExtractorfeature_extractor = AutoFeatureExtractor.from_pretrained(    &quot;ehcalabres/wav2vec2-lg-xlsr-en-speech-emotion-recognition&quot;)AutoProcessorå¤šæ¨¡æ€ä»»åŠ¡éœ€è¦ä¸€ä¸ªå¤„ç†å™¨æ¥ç»“åˆä¸¤ç§ç±»å‹çš„é¢„å¤„ç†å·¥å…·ã€‚ä¾‹å¦‚ï¼ŒLayoutLMV2æ¨¡å‹éœ€è¦ä¸€ä¸ªå›¾åƒå¤„ç†å™¨æ¥å¤„ç†å›¾åƒï¼Œè¿˜éœ€è¦ä¸€ä¸ªåˆ†è¯å™¨æ¥å¤„ç†æ–‡æœ¬ï¼›å¤„ç†å™¨å°†ä¸¤è€…ç»“åˆèµ·æ¥123from transformers import AutoProcessorprocessor = AutoProcessor.from_pretrained(&quot;microsoft/layoutlmv2-base-uncased&quot;)æ¨¡å‹ä¿å­˜ä¸€æ—¦æ‚¨çš„æ¨¡å‹ç»è¿‡å¾®è°ƒï¼Œæ‚¨å¯ä»¥ä½¿ç”¨PreTrainedModel.save_pretrained()å°†å…¶ä¸å…¶æ ‡è®°å™¨ä¸€èµ·ä¿å­˜èµ·æ¥ï¼š1234567# æ¨¡å‹+åˆ†è¯å™¨ ä¿å­˜pt_save_directory = &quot;./pt_save_pretrained&quot;tokenizer.save_pretrained(pt_save_directory)pt_model.save_pretrained(pt_save_directory)# åŠ è½½pt_model = AutoModelForSequenceClassification.from_pretrained(pt_save_directory)AutoConfigæ‚¨å¯ä»¥ä¿®æ”¹æ¨¡å‹çš„é…ç½®ç±»æ¥æ›´æ”¹æ¨¡å‹çš„æ„å»ºæ–¹å¼ã€‚é…ç½®ç±»æŒ‡å®šäº†æ¨¡å‹çš„å±æ€§ï¼Œä¾‹å¦‚éšè—å±‚çš„æ•°é‡æˆ–æ³¨æ„åŠ›å¤´æ•°å½“æ‚¨ä»è‡ªå®šä¹‰é…ç½®ç±»åˆå§‹åŒ–æ¨¡å‹æ—¶ï¼Œæ‚¨å°†ä»å¤´å¼€å§‹ã€‚æ¨¡å‹çš„å±æ€§å°†è¢«éšæœºåˆå§‹åŒ–ï¼Œæ‚¨éœ€è¦åœ¨ä½¿ç”¨æ¨¡å‹ä¹‹å‰å¯¹å…¶è¿›è¡Œè®­ç»ƒä»¥è·å¾—æœ‰æ„ä¹‰çš„ç»“æœé¦–å…ˆå¯¼å…¥AutoConfigï¼Œç„¶ååŠ è½½è¦ä¿®æ”¹çš„é¢„è®­ç»ƒæ¨¡å‹ã€‚åœ¨AutoConfig.from_pretrained()ä¸­ï¼Œæ‚¨å¯ä»¥æŒ‡å®šè¦æ›´æ”¹çš„å±æ€§ï¼Œä¾‹å¦‚æ³¨æ„åŠ›å¤´çš„æ•°é‡ï¼š12345from transformers import AutoConfigfrom transformers import AutoModelmy_config = AutoConfig.from_pretrained(&quot;distilbert-base-uncased&quot;, n_heads=12)my_model = AutoModel.from_config(my_config)Trainerå¯¹äºPyTorchï¼Œæ‰€æœ‰æ¨¡å‹éƒ½æ˜¯æ ‡å‡†çš„torch.nn.Moduleï¼Œå› æ­¤æ‚¨å¯ä»¥åœ¨ä»»ä½•å…¸å‹çš„è®­ç»ƒå¾ªç¯ä¸­ä½¿ç”¨å®ƒä»¬ã€‚è™½ç„¶æ‚¨å¯ä»¥ç¼–å†™è‡ªå·±çš„è®­ç»ƒå¾ªç¯ï¼Œä½†ğŸ¤—Transformersæä¾›äº†Trainerç±»ï¼Œå…¶ä¸­åŒ…å«åŸºæœ¬çš„è®­ç»ƒå¾ªç¯ï¼Œå¹¶æ·»åŠ äº†å…¶ä»–åŠŸèƒ½ï¼Œå¦‚åˆ†å¸ƒå¼è®­ç»ƒã€æ··åˆç²¾åº¦ç­‰æ ¹æ®æ‚¨çš„ä»»åŠ¡ï¼Œé€šå¸¸ä¼šå‘Trainerä¼ é€’ä»¥ä¸‹å‚æ•°ï¼šPreTrainedModelæˆ–torch.nn.Moduleå¯¹è±¡123from transformers import AutoModelForSequenceClassificationmodel = AutoModelForSequenceClassification.from_pretrained(&quot;distilbert-base-uncased&quot;)TrainingArgumentsåŒ…å«äº†å¯ä»¥ä¿®æ”¹çš„æ¨¡å‹è¶…å‚æ•°ï¼Œæ¯”å¦‚å­¦ä¹ ç‡ã€æ‰¹å¤§å°å’Œè®­ç»ƒçš„è½®æ•°ã€‚å¦‚æœä½ ä¸æŒ‡å®šä»»ä½•è®­ç»ƒå‚æ•°ï¼Œå°†ä½¿ç”¨é»˜è®¤å€¼123456789from transformers import TrainingArgumentstraining_args = TrainingArguments(    output_dir=&quot;path/to/save/folder/&quot;,    learning_rate=2e-5,    per_device_train_batch_size=8,    per_device_eval_batch_size=8,    num_train_epochs=2,)Preprocessingç±»ï¼Œä¾‹å¦‚tokenizer(æ ‡è®°å™¨)ã€image processor(å›¾åƒå¤„ç†å™¨)ã€feature extractor(ç‰¹å¾æå–å™¨)æˆ–processor(å¤„ç†å™¨)123from transformers import AutoTokenizertokenizer = AutoTokenizer.from_pretrained(&quot;distilbert-base-uncased&quot;)åŠ è½½æ•°æ®é›†123from datasets import load_datasetdataset = load_dataset(&quot;rotten_tomatoes&quot;)  # doctest: +IGNORE_RESULTåˆ›å»ºä¸€ä¸ªå‡½æ•°æ¥å¯¹æ•°æ®é›†è¿›è¡Œæ ‡è®°åŒ–å¤„ç†ï¼Œç„¶åä½¿ç”¨mapå‡½æ•°å°†å…¶åº”ç”¨äºæ•´ä¸ªæ•°æ®é›†1234def tokenize_dataset(dataset):    return tokenizer(dataset[&quot;text&quot;])dataset = dataset.map(tokenize_dataset, batched=True)ä½¿ç”¨DataCollatorWithPaddingæ¥ä»æ•°æ®é›†ä¸­åˆ›å»ºä¸€ä¸ªæ‰¹æ¬¡çš„ç¤ºä¾‹123from transformers import DataCollatorWithPaddingdata_collator = DataCollatorWithPadding(tokenizer=tokenizer)DataCollatorWithPaddingæ˜¯Hugging Faceçš„transformersåº“ä¸­çš„ä¸€ä¸ªç±»ï¼Œç”¨äºåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­åˆ›å»ºæ‰¹æ¬¡æ•°æ®ã€‚å®ƒçš„ä½œç”¨æ˜¯å°†ä¸åŒé•¿åº¦çš„æ ·æœ¬å¡«å……åˆ°ç›¸åŒé•¿åº¦ï¼Œä»¥ä¾¿èƒ½å¤ŸåŒæ—¶è¿›è¡Œæ‰¹å¤„ç†å…·ä½“æ¥è¯´ï¼ŒDataCollatorWithPaddingä¼šæ ¹æ®ç»™å®šçš„æ•°æ®é›†ï¼Œæ‰¾åˆ°å…¶ä¸­æœ€é•¿çš„æ ·æœ¬ï¼Œå¹¶å°†å…¶ä»–æ ·æœ¬å¡«å……åˆ°ç›¸åŒçš„é•¿åº¦ã€‚å¡«å……é€šå¸¸ä½¿ç”¨ç‰¹å®šçš„å¡«å……ä»¤ç‰Œ(token)æ¥å®Œæˆï¼Œè¿™æ ·æ¨¡å‹åœ¨å¤„ç†æ—¶å¯ä»¥è¯†åˆ«å‡ºå¡«å……éƒ¨åˆ†ï¼Œå¹¶è¿›è¡Œç›¸åº”çš„å¤„ç†ä½¿ç”¨DataCollatorWithPaddingå¯ä»¥ç¡®ä¿æ‰¹æ¬¡æ•°æ®çš„é•¿åº¦ä¸€è‡´ï¼Œä»è€Œæé«˜è®­ç»ƒæ•ˆç‡ï¼Œå¹¶é¿å…ç”±äºä¸åŒé•¿åº¦æ ·æœ¬å¯¼è‡´çš„é”™è¯¯ç°åœ¨å°†æ‰€æœ‰è¿™äº›ç±»ç»„åˆåœ¨Trainerä¸­123456789101112from transformers import Trainertrainer = Trainer(    model=model,    args=training_args,    train_dataset=dataset[&quot;train&quot;],    eval_dataset=dataset[&quot;test&quot;],    tokenizer=tokenizer,    data_collator=data_collator,)  # doctest: +SKIPtrainer.train()Trainerç±»æä¾›äº†è‡ªå®šä¹‰è®­ç»ƒå¾ªç¯è¡Œä¸ºçš„æ–¹æ³•ï¼Œä½ å¯ä»¥é€šè¿‡ç»§æ‰¿Trainerç±»å¹¶é‡å†™å…¶ä¸­çš„æ–¹æ³•æ¥å®ç°è‡ªå®šä¹‰è¡Œä¸ºã€‚è¿™æ ·ä½ å°±å¯ä»¥å®šåˆ¶è¯¸å¦‚æŸå¤±å‡½æ•°ã€ä¼˜åŒ–å™¨å’Œå­¦ä¹ ç‡è°ƒåº¦å™¨ç­‰åŠŸèƒ½ã€‚ä½ å¯ä»¥å‚è€ƒTrainerç±»çš„æ–‡æ¡£äº†è§£å¯ä»¥é‡å†™çš„æ–¹æ³•å¦ä¸€ç§å®šåˆ¶è®­ç»ƒå¾ªç¯çš„æ–¹å¼æ˜¯ä½¿ç”¨å›è°ƒå‡½æ•°(Callbacks)ã€‚ä½ å¯ä»¥ä½¿ç”¨å›è°ƒå‡½æ•°ä¸å…¶ä»–åº“è¿›è¡Œé›†æˆï¼Œç›‘è§†è®­ç»ƒè¿‡ç¨‹å¹¶æŠ¥å‘Šè¿›å±•ï¼Œæˆ–åœ¨å¿…è¦æ—¶æå‰åœæ­¢è®­ç»ƒã€‚å›è°ƒå‡½æ•°ä¸ä¼šä¿®æ”¹è®­ç»ƒå¾ªç¯æœ¬èº«çš„è¡Œä¸ºã€‚å¦‚æœä½ éœ€è¦å®šåˆ¶æŸå¤±å‡½æ•°ç­‰å†…å®¹ï¼Œä½ éœ€è¦ç»§æ‰¿Trainerç±»æ¥å®ç°æ•™ç¨‹æ¨¡å‹è®­ç»ƒä½¿ç”¨é¢„è®­ç»ƒæ¨¡å‹æœ‰å¾ˆå¤šå¥½å¤„ã€‚å®ƒå¯ä»¥å‡å°‘è®¡ç®—æˆæœ¬å’Œç¢³è¶³è¿¹ï¼Œå¹¶ä¸”å¯ä»¥è®©æ‚¨ä½¿ç”¨æœ€å…ˆè¿›çš„æ¨¡å‹ï¼Œè€Œæ— éœ€ä»å¤´å¼€å§‹è®­ç»ƒğŸ¤—Transformersæä¾›äº†å¯¹å„ç§ä»»åŠ¡çš„æ•°åƒä¸ªé¢„è®­ç»ƒæ¨¡å‹çš„è®¿é—®ã€‚å½“æ‚¨ä½¿ç”¨é¢„è®­ç»ƒæ¨¡å‹æ—¶ï¼Œæ‚¨å¯ä»¥åœ¨ç‰¹å®šäºæ‚¨ä»»åŠ¡çš„æ•°æ®é›†ä¸Šè¿›è¡Œå¾®è°ƒè®­ç»ƒã€‚è¿™è¢«ç§°ä¸ºå¾®è°ƒï¼Œæ˜¯ä¸€ç§éå¸¸å¼ºå¤§çš„è®­ç»ƒæŠ€æœ¯æ•°æ®å‡†å¤‡123456789101112131415161718from datasets import load_datasetfrom transformers import AutoTokenizer# 1. åŠ è½½æ•°æ®é›†dataset = load_dataset(&quot;yelp_review_full&quot;)dataset[&quot;train&quot;][100]{'label': 0, 'text': 'My expectations for McDonalds are t rarely high. But for one to still fail so spectacularly...that takes something special!\\nThe cashier took my friends\'s order, then promptly ignored me. I had to force myself in front of a cashier who opened his register to wait on the person BEHIND me. I waited over five minutes for a gigantic order that included precisely one kid\'s meal. After watching two people who ordered after me be handed their food, I asked where mine was. The manager started yelling at the cashiers for \\&quot;serving off their orders\\&quot; when they didn\'t have their food. But neither cashier was anywhere near those controls, and the manager was the one serving food to customers and clearing the boards.\\nThe manager was rude when giving me my order. She didn\'t make sure that I had everything ON MY RECEIPT, and never even had the decency to apologize that I felt I was getting poor service.\\nI\'ve eaten at various McDonalds restaurants for over 30 years. I\'ve worked at more than one location. I expect bad days, bad moods, and the occasional mistake. But I have yet to have a decent experience at this store. It will remain a place I avoid unless someone in my party needs to avoid illness from low blood sugar. Perhaps I should go back to the racially biased service of Steak n Shake instead!'}# å¯ä»¥åˆ›å»ºä¸€ä¸ªè¾ƒå°çš„æ•°æ®é›†å­é›†ï¼Œç”¨äºå¾®è°ƒï¼Œä»¥å‡å°‘æ‰€éœ€çš„æ—¶é—´small_train_dataset = tokenized_datasets[&quot;train&quot;].shuffle(seed=42).select(range(1000))small_eval_dataset = tokenized_datasets[&quot;test&quot;].shuffle(seed=42).select(range(1000))# 2. åˆ†è¯å™¨tokenizer = AutoTokenizer.from_pretrained(&quot;bert-base-cased&quot;)def tokenize_function(examples):    return tokenizer(examples[&quot;text&quot;], padding=&quot;max_length&quot;, truncation=True)tokenized_datasets = dataset.map(tokenize_function, batched=True)Train with PyTorch Trainer123456789101112131415161718192021222324252627282930from transformers import AutoModelForSequenceClassificationfrom transformers import TrainingArgumentsimport numpy as npimport evaluate# 1. åŠ è½½æ¨¡å‹model = AutoModelForSequenceClassification.from_pretrained(&quot;bert-base-cased&quot;, num_labels=5)# 2. å®šä¹‰è®­ç»ƒå‚æ•°  åœ¨è®­ç»ƒå‚æ•°ä¸­æŒ‡å®ševaluation_strategyå‚æ•°ï¼Œä»¥åœ¨æ¯ä¸ªepochç»“æŸæ—¶æŠ¥å‘Šè¯„ä¼°æŒ‡æ ‡training_args = TrainingArguments(output_dir=&quot;test_trainer&quot;, evaluation_strategy=&quot;epoch&quot;)# 3. åŠ è½½è¯„ä¼°å™¨metric = evaluate.load(&quot;accuracy&quot;)# åœ¨è®¡ç®—åº¦é‡æ ‡å‡†çš„æ—¶å€™è°ƒç”¨computeï¼Œä»¥è®¡ç®—æ‚¨çš„é¢„æµ‹çš„å‡†ç¡®ç‡ã€‚åœ¨å°†é¢„æµ‹ç»“æœä¼ é€’ç»™computeä¹‹å‰ï¼Œæ‚¨éœ€è¦å°†é¢„æµ‹ç»“æœè½¬æ¢ä¸ºlogitsdef compute_metrics(eval_pred):    logits, labels = eval_pred    predictions = np.argmax(logits, axis=-1)    return metric.compute(predictions=predictions, references=labels)# 4. å®šä¹‰Trainertrainer = Trainer(    model=model,    args=training_args,    train_dataset=small_train_dataset,    eval_dataset=small_eval_dataset,    compute_metrics=compute_metrics,)# 5. å¼€å§‹è®­ç»ƒtrainer.train()Train in native PyTorchTrainerè´Ÿè´£è®­ç»ƒå¾ªç¯ï¼Œå¹¶å…è®¸æ‚¨é€šè¿‡ä¸€è¡Œä»£ç å¯¹æ¨¡å‹è¿›è¡Œå¾®è°ƒã€‚å¯¹äºå–œæ¬¢ç¼–å†™è‡ªå·±çš„è®­ç»ƒå¾ªç¯çš„ç”¨æˆ·ï¼Œæ‚¨ä¹Ÿå¯ä»¥åœ¨åŸç”ŸPyTorchä¸­å¯¹ğŸ¤—Transformersæ¨¡å‹è¿›è¡Œå¾®è°ƒ123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263from torch.utils.data import DataLoaderfrom transformers import AutoModelForSequenceClassificationfrom torch.optim import AdamWfrom transformers import get_schedulerimport torchfrom tqdm.auto import tqdmimport evaluate# 1. æ•°æ®é›†é¢„å¤„ç†tokenized_datasets = tokenized_datasets.remove_columns([&quot;text&quot;])tokenized_datasets = tokenized_datasets.rename_column(&quot;label&quot;, &quot;labels&quot;)tokenized_datasets.set_format(&quot;torch&quot;)# 2. å®šä¹‰DataLoadertrain_dataloader = DataLoader(small_train_dataset, shuffle=True, batch_size=8)eval_dataloader = DataLoader(small_eval_dataset, batch_size=8)# 3. åŠ è½½æ¨¡å‹model = AutoModelForSequenceClassification.from_pretrained(&quot;bert-base-cased&quot;, num_labels=5)# 4. å®šä¹‰ä¼˜åŒ–å™¨optimizer = AdamW(model.parameters(), lr=5e-5)# 5. å®šä¹‰schedulernum_epochs = 3num_training_steps = num_epochs * len(train_dataloader)lr_scheduler = get_scheduler(    name=&quot;linear&quot;, optimizer=optimizer, num_warmup_steps=0, num_training_steps=num_training_steps)# 6. ç§»åŠ¨æ¨¡å‹åˆ°æŒ‡å®šè®¾å¤‡ device = torch.device(&quot;cuda&quot;) if torch.cuda.is_available() else torch.device(&quot;cpu&quot;)model.to(device)# 7. å¼€å§‹è®­ç»ƒprogress_bar = tqdm(range(num_training_steps))model.train()for epoch in range(num_epochs):    for batch in train_dataloader:        batch = {k: v.to(device) for k, v in batch.items()}        outputs = model(**batch)        loss = outputs.loss        loss.backward()        optimizer.step()        lr_scheduler.step()        optimizer.zero_grad()        progress_bar.update(1)# 8. éªŒè¯é›†è¯„ä¼°metric = evaluate.load(&quot;accuracy&quot;)model.eval()for batch in eval_dataloader:    batch = {k: v.to(device) for k, v in batch.items()}    with torch.no_grad():        outputs = model(**batch)    logits = outputs.logits    predictions = torch.argmax(logits, dim=-1)    metric.add_batch(predictions=predictions, references=batch[&quot;labels&quot;])metric.compute()åˆ†å¸ƒå¼åŠ é€Ÿhuggingfaceçš„accelerateæ¨¡å—ğŸ¤—Accelerateæ˜¯Hugging Faceæä¾›çš„ç”¨äºç®€åŒ–åˆ†å¸ƒå¼è®­ç»ƒçš„åº“ã€‚å®ƒæ—¨åœ¨ä½¿åˆ†å¸ƒå¼è®­ç»ƒæ›´åŠ å®¹æ˜“å’Œé«˜æ•ˆï¼Œæ”¯æŒå¤šç§æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼ŒåŒ…æ‹¬PyTorchå’ŒTensorFlowAccelerateæä¾›äº†ä»¥ä¸‹åŠŸèƒ½ï¼šæ•°æ®å¹¶è¡Œï¼šAccelerateä½¿ç”¨accelerator.DataParallelç±»æ¥å®ç°æ•°æ®å¹¶è¡Œï¼Œå¯ä»¥åœ¨å¤šä¸ªGPUä¸ŠåŒæ—¶è®­ç»ƒæ¨¡å‹æ··åˆç²¾åº¦è®­ç»ƒï¼šAccelerateæ”¯æŒè‡ªåŠ¨æ··åˆç²¾åº¦è®­ç»ƒï¼Œé€šè¿‡å°†æ¨¡å‹å‚æ•°å’Œæ¢¯åº¦è½¬æ¢ä¸ºåŠç²¾åº¦æµ®ç‚¹æ•°æ¥å‡å°‘å†…å­˜å ç”¨å’Œè®¡ç®—é‡åˆ†å¸ƒå¼è®­ç»ƒï¼šAccelerateä½¿ç”¨accelerator.DistributedDataParallelç±»æ¥å®ç°åˆ†å¸ƒå¼è®­ç»ƒï¼Œå¯ä»¥åœ¨å¤šä¸ªæœºå™¨ä¸Šå¹¶è¡Œè®­ç»ƒæ¨¡å‹è®­ç»ƒå¾ªç¯çš„è‡ªåŠ¨ç®¡ç†ï¼šAccelerateæä¾›äº†ä¸€ä¸ªaccelerator.Trainerç±»ï¼Œå®ƒå°è£…äº†è®­ç»ƒå¾ªç¯ï¼Œè‡ªåŠ¨å¤„ç†æ•°æ®åŠ è½½ã€å‰å‘ä¼ æ’­ã€åå‘ä¼ æ’­ã€ä¼˜åŒ–å™¨æ›´æ–°ç­‰è¿‡ç¨‹ä½¿ç”¨Accelerateå¯ä»¥ç®€åŒ–åˆ†å¸ƒå¼è®­ç»ƒçš„é…ç½®å’Œç®¡ç†ï¼Œä½¿ç”¨æˆ·èƒ½å¤Ÿæ›´è½»æ¾åœ°åˆ©ç”¨å¤šä¸ªGPUæˆ–å¤šå°æœºå™¨è¿›è¡Œè®­ç»ƒï¼Œå¹¶è·å¾—æ›´é«˜çš„è®­ç»ƒæ•ˆç‡å®‰è£…1pip install accelerateç¤ºä¾‹ä»£ç ï¼Œä»¥ä¸‹ä»£ç åªåˆ—å‡ºæ”¹å˜çš„éƒ¨åˆ†ä»£ç åªéœ€è¦åœ¨è®­ç»ƒå¾ªç¯ä¸­æ·»åŠ å››è¡Œé¢å¤–çš„ä»£ç å³å¯å¯ç”¨åˆ†å¸ƒå¼è®­ç»ƒ123456789101112131415161718192021from accelerate import Accelerator# 1. å®šä¹‰åŠ é€Ÿå™¨accelerator = Accelerator()# 2. dataloaderåŒ…è£…train_dataloader, eval_dataloader, model, optimizer = accelerator.prepare(    train_dataloader, eval_dataloader, model, optimizer)# 3. åå‘ä¼ æ’­for epoch in range(num_epochs):    for batch in train_dataloader:        outputs = model(**batch)        loss = outputs.loss        accelerator.backward(loss)        optimizer.step()        lr_scheduler.step()        optimizer.zero_grad()        progress_bar.update(1)å®Œæ•´ä»£ç å¦‚ä¸‹123456789101112131415161718192021222324252627282930313233343536373839+ from accelerate import Accelerator  from transformers import AdamW, AutoModelForSequenceClassification, get_scheduler+ accelerator = Accelerator()  model = AutoModelForSequenceClassification.from_pretrained(checkpoint, num_labels=2)  optimizer = AdamW(model.parameters(), lr=3e-5)- device = torch.device(&quot;cuda&quot;) if torch.cuda.is_available() else torch.device(&quot;cpu&quot;)- model.to(device)+ train_dataloader, eval_dataloader, model, optimizer = accelerator.prepare(+     train_dataloader, eval_dataloader, model, optimizer+ )  num_epochs = 3  num_training_steps = num_epochs * len(train_dataloader)  lr_scheduler = get_scheduler(      &quot;linear&quot;,      optimizer=optimizer,      num_warmup_steps=0,      num_training_steps=num_training_steps  )  progress_bar = tqdm(range(num_training_steps))  model.train()  for epoch in range(num_epochs):      for batch in train_dataloader:-         batch = {k: v.to(device) for k, v in batch.items()}          outputs = model(**batch)          loss = outputs.loss-         loss.backward()+         accelerator.backward(loss)          optimizer.step()          lr_scheduler.step()          optimizer.zero_grad()          progress_bar.update(1)ç¤ºä¾‹ä»£ç åŒ…æ‹¬è‡ªç„¶è¯­è¨€å¤„ç†ã€è¯­éŸ³ã€è®¡ç®—æœºè§†è§‰å’Œå¤šæ¨¡æ€PEFTæ¨¡å—huggingface PEFTæ¨¡å—ğŸ¤—PEFTï¼Œå³Parameter-Efficient Fine-Tuning(å‚æ•°é«˜æ•ˆå¾®è°ƒ)ï¼Œæ˜¯ä¸€ä¸ªç”¨äºé«˜æ•ˆåœ°å°†é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹(PLM)é€‚åº”äºå„ç§ä¸‹æ¸¸åº”ç”¨çš„åº“ï¼Œè€Œæ— éœ€å¯¹æ‰€æœ‰æ¨¡å‹å‚æ•°è¿›è¡Œå¾®è°ƒPEFTæ–¹æ³•åªå¾®è°ƒå°‘é‡çš„(é¢å¤–çš„)æ¨¡å‹å‚æ•°ï¼Œæ˜¾è‘—é™ä½äº†è®¡ç®—å’Œå­˜å‚¨æˆæœ¬ï¼Œå› ä¸ºå¯¹å¤§è§„æ¨¡PLMè¿›è¡Œå®Œæ•´å¾®è°ƒä»£ä»·è¿‡é«˜ã€‚æœ€è¿‘çš„æœ€å…ˆè¿›çš„PEFTæŠ€æœ¯è¾¾åˆ°äº†ä¸å®Œæ•´å¾®è°ƒç›¸å½“çš„æ€§èƒ½PEFTä¸ğŸ¤—Accelerateåº“æ— ç¼é›†æˆï¼Œç”¨äºåˆ©ç”¨DeepSpeedå’ŒBig Model Inferenceè¿›è¡Œå¤§è§„æ¨¡æ¨¡å‹å¾®è°ƒSupported methods (æˆªè‡³23-06-15)LoRA: LORA: LOW-RANK ADAPTATION OF LARGE LANGUAGE MODELSPrefix Tuning: Prefix-Tuning: Optimizing Continuous Prompts for Generation, P-Tuning v2: Prompt Tuning Can Be Comparable to Fine-tuning Universally Across Scales and TasksP-Tuning: GPT Understands, TooPrompt Tuning: The Power of Scale for Parameter-Efficient Prompt TuningAdaLoRA: Adaptive Budget Allocation for Parameter-Efficient Fine-TuningLLaMA-Adapter: Efficient Fine-tuning of Language Models with Zero-init Attentionå…¶ä»–æ¨¡å—AutoTrainAutoTrainæ˜¯ä¸€ä¸ªç”¨äºè‡ªåŠ¨åŒ–è®­ç»ƒçš„åº“ï¼Œæ—¨åœ¨ç®€åŒ–æ¨¡å‹è®­ç»ƒçš„è¿‡ç¨‹ã€‚å®ƒæä¾›äº†ä¸€ç§ç®€å•çš„æ–¹æ³•æ¥å®šä¹‰å’Œè®­ç»ƒæ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œè‡ªåŠ¨å¤„ç†æ•°æ®åŠ è½½ã€æ‰¹å¤„ç†ã€ä¼˜åŒ–å™¨ã€æŸå¤±å‡½æ•°ç­‰è®­ç»ƒè¿‡ç¨‹ä¸­çš„ç»†èŠ‚ã€‚é€šè¿‡ä½¿ç”¨AutoTrainï¼Œä½ å¯ä»¥æ›´å¿«é€Ÿåœ°æ­å»ºå’Œè®­ç»ƒæ¨¡å‹ï¼Œå‡å°‘æ ·æ¿ä»£ç çš„ç¼–å†™ï¼Œå¹¶ä¸”èƒ½å¤Ÿè½»æ¾åœ°è¿›è¡Œè¶…å‚æ•°æœç´¢å’Œæ¨¡å‹é€‰æ‹©GradioGradioæ˜¯ä¸€ä¸ªç”¨äºæ„å»ºäº¤äº’å¼ç•Œé¢çš„åº“ï¼Œä½¿ä½ èƒ½å¤Ÿè½»æ¾åœ°ä¸ºä½ çš„æ·±åº¦å­¦ä¹ æ¨¡å‹åˆ›å»ºWebåº”ç”¨ç¨‹åºã€‚Gradioæä¾›äº†ä¸€ä¸ªç®€å•è€Œå¼ºå¤§çš„APIï¼Œå¯ä»¥å°†æ¨¡å‹ä¸ç”¨æˆ·ç•Œé¢ç»„ä»¶(å¦‚æ–‡æœ¬æ¡†ã€æ»‘å—ã€å›¾åƒä¸Šä¼ å™¨ç­‰)ç›¸è¿æ¥ï¼Œä»è€Œå®ç°æ¨¡å‹çš„å®æ—¶æ¨ç†å’Œå¯è§†åŒ–ã€‚é€šè¿‡Gradioï¼Œä½ å¯ä»¥å¿«é€Ÿæ„å»ºä¸€ä¸ªäº¤äº’å¼çš„æ¼”ç¤ºæˆ–éƒ¨ç½²ä½ çš„æ¨¡å‹åˆ°Webä¸Šï¼Œæ— éœ€ç¼–å†™å¤æ‚çš„å‰ç«¯ä»£ç DiffusersDiffusersæ˜¯ä¸€ä¸ªç”¨äºç”Ÿæˆå›¾åƒã€éŸ³é¢‘ç”šè‡³åˆ†å­çš„ä¸‰ç»´ç»“æ„çš„æœ€æ–°é¢„è®­ç»ƒæ‰©æ•£æ¨¡å‹çš„åº“ã€‚æ— è®ºæ‚¨æ˜¯å¯»æ‰¾ä¸€ä¸ªç®€å•çš„æ¨ç†è§£å†³æ–¹æ¡ˆï¼Œè¿˜æ˜¯æƒ³è¦è®­ç»ƒè‡ªå·±çš„æ‰©æ•£æ¨¡å‹ï¼ŒğŸ¤—Diffuserséƒ½æ˜¯ä¸€ä¸ªæ”¯æŒä¸¤è€…çš„æ¨¡å—åŒ–å·¥å…·ç®±ã€‚æˆ‘ä»¬çš„åº“ç€é‡äºæ˜“ç”¨æ€§è€Œéæ€§èƒ½ï¼Œç®€æ´è€Œéå¤æ‚ï¼Œå¯å®šåˆ¶æ€§è€ŒéæŠ½è±¡æ€§ï¼Œè¯¥åº“ä¸»è¦åŒ…å«ä»¥ä¸‹ä¸‰ä¸ªç»„ä»¶ï¼šæœ€æ–°çš„æ‰©æ•£æ¨ç†æµç¨‹ï¼Œåªéœ€å‡ è¡Œä»£ç å³å¯å®ç°å¯äº’æ¢çš„å™ªå£°è°ƒåº¦å™¨ï¼Œç”¨äºåœ¨ç”Ÿæˆé€Ÿåº¦å’Œè´¨é‡ä¹‹é—´å¹³è¡¡æƒè¡¡å¯ç”¨ä½œæ„å»ºå—çš„é¢„è®­ç»ƒæ¨¡å‹ï¼Œå¯ä»¥ä¸è°ƒåº¦å™¨ç»“åˆä½¿ç”¨ï¼Œåˆ›å»ºæ‚¨è‡ªå·±çš„ç«¯åˆ°ç«¯æ‰©æ•£ç³»ç»ŸAccelerateHugging Faceçš„Accelerateæ˜¯ä¸€ä¸ªæ—¨åœ¨ç®€åŒ–å’ŒåŠ é€Ÿæ·±åº¦å­¦ä¹ æ¨¡å‹è®­ç»ƒå’Œæ¨ç†è¿‡ç¨‹çš„åº“å®ƒæä¾›äº†ä¸€ä¸ªé«˜çº§APIï¼ŒæŠ½è±¡äº†åˆ†å¸ƒå¼è®­ç»ƒã€æ··åˆç²¾åº¦å’Œæ¢¯åº¦ç´¯ç§¯ç­‰å¤æ‚æ€§ï¼Œä½¿ç”¨æˆ·èƒ½å¤Ÿè½»æ¾åœ°å……åˆ†åˆ©ç”¨ç¡¬ä»¶èµ„æºçš„æ½œåŠ›Accelerateå…¼å®¹PyTorchå’ŒTensorFlowï¼Œå¹¶æä¾›äº†ä¸€å¥—å·¥å…·å’Œå®ç”¨ç¨‹åºï¼Œä»¥å®ç°è·¨å¤šä¸ªGPUæˆ–å¤šå°æœºå™¨çš„é«˜æ•ˆåˆ†å¸ƒå¼è®­ç»ƒã€‚å®ƒåŒ…æ‹¬ä»¥ä¸‹åŠŸèƒ½ï¼šåˆ†å¸ƒå¼è®­ç»ƒï¼šAccelerateæä¾›äº†ç®€å•æ˜“ç”¨çš„æ¥å£ï¼Œä½¿ç”¨æˆ·èƒ½å¤Ÿå°†è®­ç»ƒè¿‡ç¨‹åˆ†å¸ƒåˆ°å¤šä¸ªGPUæˆ–å¤šå°æœºå™¨ä¸Šã€‚å®ƒæ”¯æŒå¸¸è§çš„åˆ†å¸ƒå¼è®­ç»ƒç­–ç•¥ï¼Œå¦‚æ•°æ®å¹¶è¡Œå’Œæ¨¡å‹å¹¶è¡Œï¼Œå¹¶è‡ªåŠ¨å¤„ç†æ•°æ®çš„åˆ†å‘å’Œæ¢¯åº¦çš„èšåˆï¼Œä½¿ç”¨æˆ·æ— éœ€æ‰‹åŠ¨ç¼–å†™å¤æ‚çš„åˆ†å¸ƒå¼è®­ç»ƒä»£ç æ··åˆç²¾åº¦è®­ç»ƒï¼šAccelerateæ”¯æŒæ··åˆç²¾åº¦è®­ç»ƒï¼Œé€šè¿‡åŒæ—¶ä½¿ç”¨æµ®ç‚¹16ä½å’Œæµ®ç‚¹32ä½ç²¾åº¦æ¥åŠ å¿«æ¨¡å‹çš„è®­ç»ƒé€Ÿåº¦ã€‚å®ƒè‡ªåŠ¨å¤„ç†æ•°æ®ç±»å‹è½¬æ¢å’Œæ¢¯åº¦ç¼©æ”¾ï¼Œç”¨æˆ·åªéœ€ç®€å•åœ°æŒ‡å®šä½¿ç”¨æ··åˆç²¾åº¦è®­ç»ƒå³å¯æ¢¯åº¦ç´¯ç§¯ï¼šAccelerateæ”¯æŒæ¢¯åº¦ç´¯ç§¯ï¼Œè¿™åœ¨GPUæ˜¾å­˜æœ‰é™çš„æƒ…å†µä¸‹ç‰¹åˆ«æœ‰ç”¨ã€‚æ¢¯åº¦ç´¯ç§¯å…è®¸åœ¨å¤šä¸ªå°æ‰¹æ¬¡ä¸Šç´¯ç§¯æ¢¯åº¦ï¼Œç„¶åè¿›è¡Œä¸€æ¬¡å¤§æ‰¹æ¬¡çš„å‚æ•°æ›´æ–°ï¼Œä»è€Œå‡å°‘æ˜¾å­˜å ç”¨å¹¶æé«˜è®­ç»ƒæ•ˆç‡è‡ªåŠ¨è°ƒèŠ‚æ‰¹æ¬¡å¤§å°ï¼šAccelerateå¯ä»¥è‡ªåŠ¨è°ƒæ•´æ‰¹æ¬¡å¤§å°ä»¥é€‚åº”å¯ç”¨çš„GPUå†…å­˜ã€‚å®ƒä¼šåŠ¨æ€è°ƒæ•´æ‰¹æ¬¡å¤§å°ï¼Œä»¥è¾¾åˆ°æœ€ä½³çš„GPUåˆ©ç”¨ç‡å’Œè®­ç»ƒæ€§èƒ½æ€»ä¹‹ï¼ŒHugging Faceçš„Accelerateæ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„åº“ï¼Œæ—¨åœ¨ç®€åŒ–å’ŒåŠ é€Ÿæ·±åº¦å­¦ä¹ æ¨¡å‹çš„è®­ç»ƒå’Œæ¨ç†è¿‡ç¨‹ã€‚å®ƒæä¾›äº†é«˜çº§APIå’Œä¸€ç³»åˆ—å·¥å…·ï¼Œä½¿ç”¨æˆ·èƒ½å¤Ÿè½»æ¾åœ°å®ç°åˆ†å¸ƒå¼è®­ç»ƒã€æ··åˆç²¾åº¦è®­ç»ƒå’Œæ¢¯åº¦ç´¯ç§¯ç­‰é«˜æ•ˆè®­ç»ƒç­–ç•¥</content>
	</entry>
	<entry>
		<title>æ·±åº¦å­¦ä¹ æ¨¡å‹å‹ç¼©æŠ€æœ¯</title>
		<url>/article/53377.html</url>
		<content>æ¨¡å‹å‹ç¼©æ¦‚è¿°æ·±åº¦å­¦ä¹ æ¨¡å‹å‹ç¼©ä¸åŠ é€Ÿä¸ƒå¤§æ–¹æ³•æ€»ç»“ï¼éšç€æ·±åº¦å­¦ä¹ çš„å‘å±•ä¸é«˜æ€§èƒ½GPUå¤„ç†èƒ½åŠ›çš„å¢å¼ºï¼Œç¥ç»ç½‘ç»œç»“æ„å˜å¾—è¶Šæ¥è¶Šå¤æ‚ï¼Œæ¨¡å‹å‚æ•°é‡ä¹Ÿè¶Šæ¥è¶Šåºå¤§ï¼Œè¿™ä½¿å¾—æ·±åº¦å­¦ä¹ åœ¨ç§»åŠ¨åµŒå…¥å¼è®¾å¤‡ä¸Šçš„éƒ¨ç½²é‡åˆ°å·¨å¤§çš„å›°éš¾å’ŒæŒ‘æˆ˜å› æ­¤ï¼Œå¦‚ä½•åœ¨ä¸å½±å“æ·±åº¦å­¦ä¹ æ¨¡å‹æ€§èƒ½çš„æƒ…å†µä¸‹è¿›è¡Œæ¨¡å‹å‹ç¼©ä¸åŠ é€Ÿæˆä¸ºäº†ç ”ç©¶çƒ­ç‚¹åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œæ¨¡å‹å‹ç¼©æ˜¯ä¸€ç§é€šè¿‡å‡å°æ¨¡å‹çš„å¤§å°ã€å‚æ•°æ•°é‡æˆ–è®¡ç®—é‡æ¥é™ä½æ¨¡å‹å¤æ‚åº¦çš„æŠ€æœ¯ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„æ¨¡å‹å‹ç¼©æŠ€æœ¯ï¼šå‚æ•°å‰ªæ(Pruning)ï¼šé€šè¿‡å‰ªé™¤æ¨¡å‹ä¸­ä¸é‡è¦çš„è¿æ¥æˆ–å‚æ•°ï¼Œå‡å°‘æ¨¡å‹çš„å‚æ•°æ•°é‡å’Œè®¡ç®—é‡ã€‚å‰ªæå¯ä»¥åŸºäºæƒé‡çš„é‡è¦æ€§è¿›è¡Œï¼Œå‰ªé™¤è¾ƒå°çš„æƒé‡æˆ–é€šè¿‡ç¨€ç–åŒ–æŠ€æœ¯å°†æƒé‡è®¾ç½®ä¸ºé›¶æƒé‡å…±äº«(Weight Sharing)ï¼šå°†æ¨¡å‹ä¸­çš„ä¸€äº›æƒé‡å…±äº«ï¼Œå‡å°‘æ¨¡å‹ä¸­éœ€è¦å­˜å‚¨çš„å‚æ•°æ•°é‡ã€‚è¿™å¯ä»¥é€šè¿‡å¯¹æƒé‡è¿›è¡Œèšç±»æˆ–ä½¿ç”¨å“ˆå¸Œå‡½æ•°å°†ç›¸ä¼¼çš„æƒé‡æ˜ å°„åˆ°åŒä¸€ä¸ªå€¼æ¥å®ç°ä½ç§©è¿‘ä¼¼(Low-Rank Approximation)ï¼šé€šè¿‡å°†æ¨¡å‹çš„æƒé‡çŸ©é˜µåˆ†è§£ä¸ºè¾ƒä½ç§©çš„çŸ©é˜µä¹˜ç§¯å½¢å¼ï¼Œå‡å°‘æ¨¡å‹çš„å‚æ•°æ•°é‡ã€‚å¸¸è§çš„æ–¹æ³•åŒ…æ‹¬å¥‡å¼‚å€¼åˆ†è§£(SVD)å’ŒçŸ©é˜µåˆ†è§£æŠ€æœ¯çŸ¥è¯†è’¸é¦(Knowledge Distillation)ï¼šå°†ä¸€ä¸ªå¤æ‚çš„æ¨¡å‹çš„çŸ¥è¯†ä¼ é€’ç»™ä¸€ä¸ªè¾ƒç®€å•çš„æ¨¡å‹ï¼Œé€šè¿‡è®©å­¦ç”Ÿæ¨¡å‹å­¦ä¹ æ•™å¸ˆæ¨¡å‹çš„è¾“å‡ºæ¦‚ç‡åˆ†å¸ƒæˆ–ä¸­é—´è¡¨ç¤ºæ¥æé«˜å­¦ç”Ÿæ¨¡å‹çš„æ€§èƒ½ç½‘ç»œé‡åŒ–(Network Quantization)ï¼šå‡å°‘æ¨¡å‹ä¸­å‚æ•°çš„ä½æ•°è¡¨ç¤ºï¼Œä¾‹å¦‚å°†æµ®ç‚¹æ•°å‚æ•°è½¬æ¢ä¸ºè¾ƒä½ä½æ•°çš„æ•´æ•°è¡¨ç¤ºï¼Œä»è€Œå‡å°æ¨¡å‹çš„å­˜å‚¨éœ€æ±‚å’Œè®¡ç®—å¤æ‚åº¦ç½‘ç»œå‰ªæ(Network Pruning)ï¼šé™¤äº†å‰ªææƒé‡å’Œè¿æ¥ä¹‹å¤–ï¼Œè¿˜å‰ªææ¨¡å‹çš„ç½‘ç»œç»“æ„ã€‚è¿™åŒ…æ‹¬å‰ªæå±‚ã€å‰ªæé€šé“æˆ–å‰ªææ¨¡å—ç­‰ç½‘ç»œè’¸é¦(Network Distillation)ï¼šç±»ä¼¼äºçŸ¥è¯†è’¸é¦ï¼Œä½†æ˜¯ä¸ä»…ä¼ é€’æ•™å¸ˆæ¨¡å‹çš„è¾“å‡ºæ¦‚ç‡åˆ†å¸ƒæˆ–ä¸­é—´è¡¨ç¤ºï¼Œè¿˜ä¼ é€’æ•™å¸ˆæ¨¡å‹çš„æ¿€æ´»å€¼æˆ–å…¶ä»–è¾…åŠ©ä¿¡æ¯è¿™äº›æŠ€æœ¯å¯ä»¥å•ç‹¬åº”ç”¨æˆ–ç»“åˆä½¿ç”¨ï¼Œä»¥å‡å°æ·±åº¦å­¦ä¹ æ¨¡å‹çš„å¤§å°ã€å¤æ‚åº¦å’Œè®¡ç®—éœ€æ±‚ï¼Œä»è€Œå®ç°æ¨¡å‹å‹ç¼©å’ŒåŠ é€Ÿçš„æ•ˆæœå‚æ•°å‰ªæå¯¹æ¨¡å‹çš„ç½‘ç»œè¿›è¡Œä¿®å‰ªï¼Œæ¯”å¦‚å‡æ‰å¤šä½™çš„å¤´(å› ä¸ºTransformerä½¿ç”¨å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶)ï¼Œæˆ–è€…ç›´æ¥ç²—æš´çš„ä½¿ç”¨æ›´å°‘çš„Transformerå±‚æ•°æƒé‡å…±äº«ç­‰å¾…â€¦ä½ç§©è¿‘ä¼¼ç­‰å¾…â€¦çŸ¥è¯†è’¸é¦æ‰‹å†™æ•°å­—è¯†åˆ«ä¸­å¤šå…ƒåˆ†ç±»åŸç†_å¹¿å‘Šè¡Œä¸šä¸­é‚£äº›è¶£äº‹ç³»åˆ—21ï¼šä»ç†è®ºåˆ°å®æˆ˜BERTçŸ¥è¯†è’¸é¦â€¦æ·±åº¦å­¦ä¹ ä¸­çš„çŸ¥è¯†è’¸é¦æŠ€æœ¯`ä¸€åˆ†é’Ÿå¸¦ä½ è®¤è¯†æ·±åº¦å­¦ä¹ ä¸­çš„çŸ¥è¯†è’¸é¦æ¦‚è¿°çŸ¥è¯†è’¸é¦çš„æ¦‚å¿µæœ€æ—©æ˜¯2015å¹´Geoffrey Hintonåœ¨ã€ŠDistilling the Knowledge in a Neural Networkã€‹è¿™ç¯‡è®ºæ–‡ä¸­æå‡ºæ¥çš„åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼ŒçŸ¥è¯†è’¸é¦(Knowledge Distillation)æŒ‡çš„æ˜¯å°†ä¸€ä¸ªå¤æ‚çš„æ¨¡å‹(ç§°ä¸ºæ•™å¸ˆæ¨¡å‹)çš„çŸ¥è¯†ä¼ é€’ç»™ä¸€ä¸ªè¾ƒç®€å•çš„æ¨¡å‹(ç§°ä¸ºå­¦ç”Ÿæ¨¡å‹)çš„è¿‡ç¨‹è¿™ç§æ–¹æ³•æ—¨åœ¨é€šè¿‡è®­ç»ƒå­¦ç”Ÿæ¨¡å‹ä½¿å…¶èƒ½å¤Ÿå­¦ä¹ æ•™å¸ˆæ¨¡å‹çš„æ¨ç†èƒ½åŠ›å’Œæ³›åŒ–èƒ½åŠ›é€šå¸¸æƒ…å†µä¸‹ï¼Œæ•™å¸ˆæ¨¡å‹æ˜¯ä¸€ä¸ªè¾ƒå¤§ã€å¤æ‚ã€å‡†ç¡®åº¦è¾ƒé«˜çš„æ¨¡å‹ï¼Œè€Œå­¦ç”Ÿæ¨¡å‹åˆ™æ˜¯ä¸€ä¸ªè¾ƒå°ã€ç®€åŒ–çš„æ¨¡å‹çŸ¥è¯†è’¸é¦é€šè¿‡è®©å­¦ç”Ÿæ¨¡å‹å­¦ä¹ æ•™å¸ˆæ¨¡å‹çš„è¾“å‡ºæ¦‚ç‡åˆ†å¸ƒæˆ–ä¸­é—´è¡¨ç¤ºï¼Œä»è€Œæé«˜å­¦ç”Ÿæ¨¡å‹çš„æ€§èƒ½ã€‚è¿™ç§çŸ¥è¯†ä¼ é€’å¯ä»¥å¸®åŠ©å­¦ç”Ÿæ¨¡å‹æ›´å¥½åœ°æ•æ‰æ•°æ®é›†çš„ç‰¹å¾ï¼Œæé«˜æ³›åŒ–èƒ½åŠ›ï¼Œå¹¶ä¸”åœ¨å…·æœ‰è¾ƒå°‘è®­ç»ƒæ•°æ®çš„æƒ…å†µä¸‹å–å¾—è¾ƒå¥½çš„æ€§èƒ½ä¾‹å­: TextCNNçŸ¥è¯†è’¸é¦BERTè¿™ç±»å¤§æ¨¡å‹ç²¾åº¦é«˜ä½†æ˜¯çº¿ä¸Šæ¨ç†é€Ÿåº¦æ…¢ï¼Œä¼ ç»Ÿçš„æ–‡æœ¬åˆ†ç±»æ¨¡å‹æ¯”å¦‚TextCNNç­‰çº¿ä¸Šæ¨ç†é€Ÿåº¦å¿«(å› ä¸ºæ¨¡å‹æ¯”è¾ƒå°)ä½†æ˜¯ç²¾åº¦æœ‰å¾…æå‡ã€‚é’ˆå¯¹ä¸Šé¢çš„é—®é¢˜ï¼Œæˆ‘ä»¬çš„éœ€æ±‚æ˜¯è·å¾—åª²ç¾BERTç­‰å¤§æ¨¡å‹çš„ç²¾åº¦ï¼Œè¿˜èƒ½æ»¡è¶³çº¿ä¸Šæ¨ç†é€Ÿåº¦çš„æ—¶å»¶è¦æ±‚ä¸šåŠ¡ä¸­å¯ä»¥æŠŠBERTä½œä¸ºè€å¸ˆæ¨¡å‹å»æ•™ä½œä¸ºå­¦ç”Ÿæ¨¡å‹çš„TextCNNæ¥å­¦ä¹ çŸ¥è¯†ï¼Œä»è€Œä½¿TextCNNä¸ä»…è¾¾åˆ°äº†åª²ç¾BERTçš„åˆ†ç±»æ•ˆæœï¼Œè€Œä¸”è¿˜èƒ½å¾ˆå¥½çš„æ»¡è¶³çº¿ä¸Šæ¨ç†é€Ÿåº¦çš„è¦æ±‚æš—çŸ¥è¯†å¯¹äºè€å¸ˆæˆ–è€…æ²¡æœ‰ä½¿ç”¨çŸ¥è¯†è’¸é¦çš„å°æ¨¡å‹æ¥è¯´ï¼Œä¸»è¦æ˜¯é€šè¿‡è®­ç»ƒæ•°æ®æ¥å­¦ä¹ çŸ¥è¯†ã€‚æˆ‘ä»¬çš„è®­ç»ƒæ•°æ®é›†æ˜¯ä¸€å¼ ä¸€å¼ æ‰‹å†™æ•°å­—çš„å›¾ç‰‡ï¼Œè¿˜æœ‰å¯¹åº”0åˆ°9åä¸ªæ•°å­—çš„æ ‡ç­¾ã€‚åœ¨è¿™ç§å­¦ä¹ ä¸­æˆ‘ä»¬å¯ä»¥ç”¨çš„åªæœ‰åä¸ªç±»åˆ«å€¼ï¼Œæ¯”å¦‚ä¸€å¼ æ‰‹å†™æ•°å­—1çš„å›¾ç‰‡æ ·æœ¬çš„æ ‡ç­¾æ˜¯1ï¼Œå‘Šè¯‰æ¨¡å‹çš„çŸ¥è¯†å°±æ˜¯è¿™ä¸ªæ ·æœ¬æ ‡ç­¾æ˜¯1ï¼Œä¸æ˜¯å…¶ä»–ç±»åˆ«è€Œä½¿ç”¨çŸ¥è¯†è’¸é¦çš„æ—¶å€™æ¨¡å‹å¯ä»¥å­¦åˆ°æ›´å¤šçš„çŸ¥è¯†ï¼Œæ¯”å¦‚æ‰‹å†™æ•°å­—1çš„å›¾ç‰‡æ ·æœ¬æœ‰0.7çš„å¯èƒ½æ˜¯æ•°å­—1ï¼Œ0.2çš„å¯èƒ½æ˜¯æ•°å­—7ï¼Œè¿˜æœ‰0.1çš„å¯èƒ½æ˜¯æ•°å­—9è¿™éå¸¸æœ‰æ„æ€ï¼Œæ¨¡å‹ä¸ä»…å­¦åˆ°äº†æ ‡ç­¾æœ¬èº«çš„çŸ¥è¯†ï¼Œè¿˜å­¦ä¹ åˆ°äº†æ ‡ç­¾ä¹‹é—´çš„å…³è”çŸ¥è¯†ï¼Œå°±æ˜¯1å’Œ7ã€9å¯èƒ½å­˜åœ¨æŸäº›å…³è”ï¼Œè¿™äº›çŸ¥è¯†ç§°ä¸ºæš—çŸ¥è¯†å…¶ä»–çš„è’¸é¦å¯¹æŠ—è’¸é¦ã€å¤šæ•™å¸ˆè’¸é¦ã€è·¨æ¨¡æ€è’¸é¦ã€æ— æ•°æ®è’¸é¦è’¸é¦çš„ç›®çš„æ¨¡å‹å‹ç¼©(Model Compression)ï¼šé€šè¿‡çŸ¥è¯†è’¸é¦ï¼Œå¯ä»¥å°†ä¸€ä¸ªè¾ƒå¤§ã€å¤æ‚çš„æ¨¡å‹å‹ç¼©æˆä¸€ä¸ªæ›´å°ã€è½»é‡çº§çš„æ¨¡å‹ï¼Œå‡å°‘æ¨¡å‹çš„å­˜å‚¨ç©ºé—´å’Œè®¡ç®—èµ„æºçš„æ¶ˆè€—ã€‚è¿™ä½¿å¾—æ¨¡å‹å¯ä»¥åœ¨èµ„æºå—é™çš„è®¾å¤‡ä¸Šè¿è¡Œï¼ŒåŒæ—¶ä»ä¿æŒè¾ƒé«˜çš„æ€§èƒ½æ¨¡å‹åŠ é€Ÿ(Model Acceleration)ï¼šçŸ¥è¯†è’¸é¦å¯ä»¥åŠ é€Ÿæ¨¡å‹çš„æ¨ç†è¿‡ç¨‹ï¼Œä½¿å¾—æ¨¡å‹åœ¨å®æ—¶æ€§è¦æ±‚è¾ƒé«˜çš„åœºæ™¯ä¸­èƒ½å¤Ÿæ›´å¿«åœ°è¿›è¡Œé¢„æµ‹ã€‚é€šè¿‡å°†è¾ƒå¤æ‚çš„æ¨¡å‹çš„çŸ¥è¯†è½¬ç§»ç»™ç®€åŒ–çš„æ¨¡å‹ï¼Œå¯ä»¥åŠ å¿«æ¨ç†é€Ÿåº¦æå‡æ³›åŒ–èƒ½åŠ›(Improving Generalization)ï¼šçŸ¥è¯†è’¸é¦å¯ä»¥é€šè¿‡å°†ä¸€ä¸ªå¤æ‚æ¨¡å‹çš„çŸ¥è¯†ä¼ é€’ç»™ä¸€ä¸ªç®€åŒ–æ¨¡å‹ï¼Œå¸®åŠ©ç®€åŒ–æ¨¡å‹å­¦ä¹ åˆ°æ›´å¥½çš„ç‰¹å¾è¡¨ç¤ºå’Œæ³›åŒ–èƒ½åŠ›ã€‚è¾ƒå¤æ‚çš„æ¨¡å‹é€šå¸¸å…·æœ‰æ›´å¼ºå¤§çš„è¡¨ç¤ºèƒ½åŠ›å’Œè¡¨è¾¾èƒ½åŠ›ï¼Œé€šè¿‡çŸ¥è¯†è’¸é¦ï¼Œè¿™äº›èƒ½åŠ›å¯ä»¥ä¼ é€’ç»™ç®€åŒ–æ¨¡å‹ï¼Œæå‡å…¶æ³›åŒ–æ€§èƒ½è¿ç§»å­¦ä¹ (Transfer Learning)ï¼šçŸ¥è¯†è’¸é¦å¯ä»¥é€šè¿‡å°†ä¸€ä¸ªåœ¨å¤§è§„æ¨¡æ•°æ®é›†ä¸Šè®­ç»ƒè¿‡çš„å¤æ‚æ¨¡å‹çš„çŸ¥è¯†è¿ç§»åˆ°ä¸€ä¸ªç›¸ä¼¼ä»»åŠ¡çš„ç®€åŒ–æ¨¡å‹ä¸Šï¼Œä»è€ŒåŠ å¿«ç®€åŒ–æ¨¡å‹åœ¨æ–°ä»»åŠ¡ä¸Šçš„å­¦ä¹ é€Ÿåº¦å’Œæ€§èƒ½æ€»ä¹‹ï¼ŒçŸ¥è¯†è’¸é¦çš„ä¸»è¦ç›®çš„æ˜¯é€šè¿‡å°†ä¸€ä¸ªå¤æ‚æ¨¡å‹çš„çŸ¥è¯†è½¬ç§»åˆ°ä¸€ä¸ªç®€åŒ–æ¨¡å‹ä¸Šï¼Œä»è€Œå®ç°æ¨¡å‹å‹ç¼©ã€åŠ é€Ÿã€æå‡æ³›åŒ–èƒ½åŠ›å’Œè¿ç§»å­¦ä¹ ç­‰ç›®æ ‡è’¸é¦æœºåˆ¶ã€æ·±åº¦å­¦ä¹ ã€‘ï¼ˆä¸€ï¼‰çŸ¥è¯†è’¸é¦æ ¹æ®æ•™å¸ˆç½‘ç»œæ˜¯å¦å’Œå­¦ç”Ÿç½‘ç»œä¸€èµ·æ›´æ–°ï¼Œå¯ä»¥åˆ†ä¸ºç¦»çº¿è’¸é¦ï¼Œåœ¨çº¿è’¸é¦å’Œè‡ªè’¸é¦æ„Ÿæ€§ä¸Šç†è§£ä¸‰ç§è’¸é¦æ–¹å¼ï¼šç¦»çº¿è’¸é¦(Offline Distillation): å¯ä»¥ç†è§£ä¸ºçŸ¥è¯†æ¸Šåšçš„è€å¸ˆç»™å­¦ç”Ÿä¼ æˆçŸ¥è¯†åœ¨çº¿è’¸é¦(Online Distillation): å¯ä»¥ç†è§£ä¸ºæ•™å¸ˆå’Œå­¦ç”Ÿä¸€èµ·å­¦ä¹ è‡ªè’¸é¦(Self-Distillation): æ„å‘³ç€å­¦ç”Ÿè‡ªå·±å­¦ä¹ çŸ¥è¯†ç¦»çº¿è’¸é¦æ—©æœŸçš„çŸ¥è¯†è’¸é¦æ–¹æ³•éƒ½å±äºç¦»çº¿è’¸é¦ï¼Œå°†ä¸€ä¸ªé¢„è®­ç»ƒå¥½çš„æ•™å¸ˆæ¨¡å‹çš„çŸ¥è¯†è¿ç§»åˆ°å­¦ç”Ÿç½‘ç»œï¼Œæ‰€ä»¥é€šå¸¸åŒ…æ‹¬ä¸¤ä¸ªé˜¶æ®µï¼šåœ¨è’¸é¦å‰ï¼Œæ•™å¸ˆç½‘ç»œåœ¨è®­ç»ƒé›†ä¸Šè¿›è¡Œè®­ç»ƒæ•™å¸ˆç½‘ç»œé€šè¿‡logitså±‚ä¿¡æ¯æˆ–è€…ä¸­é—´å±‚ä¿¡æ¯æå–çŸ¥è¯†ï¼Œå¼•å¯¼å­¦ç”Ÿç½‘ç»œçš„è®­ç»ƒç¬¬ä¸€ä¸ªé˜¶æ®µé€šå¸¸ä¸è¢«è®¤ä¸ºå±äºçŸ¥è¯†è’¸é¦çš„ä¸€éƒ¨åˆ†ï¼Œå› ä¸ºé»˜è®¤æ•™å¸ˆç½‘ç»œæœ¬èº«å°±æ˜¯å·²ç»é¢„è®­ç»ƒå¥½çš„ä¸€èˆ¬ç¦»çº¿è’¸é¦ç®—æ³•å…³æ³¨ä¸æå‡çŸ¥è¯†è¿ç§»çš„ä¸åŒéƒ¨åˆ†ï¼ŒåŒ…æ‹¬ï¼šçŸ¥è¯†çš„å½¢å¼ï¼ŒæŸå¤±å‡½æ•°çš„è®¾è®¡ï¼Œåˆ†å¸ƒçš„åŒ¹é…ä¼˜ç‚¹å®ç°èµ·æ¥æ¯”è¾ƒç®€å•ï¼Œå½¢å¼ä¸Šé€šå¸¸æ˜¯å•å‘çš„çŸ¥è¯†è¿ç§»(å³ä»æ•™å¸ˆç½‘ç»œåˆ°å­¦ç”Ÿç½‘ç»œ)ï¼ŒåŒæ—¶éœ€è¦ä¸¤ä¸ªé˜¶æ®µçš„è®­ç»ƒ(è®­ç»ƒæ•™å¸ˆç½‘ç»œå’ŒçŸ¥è¯†è’¸é¦)ç¼ºç‚¹æ•™å¸ˆç½‘ç»œé€šå¸¸å®¹é‡å¤§ï¼Œæ¨¡å‹å¤æ‚ï¼Œéœ€è¦å¤§é‡è®­ç»ƒæ—¶é—´ï¼Œè¿˜éœ€è¦æ³¨æ„æ•™å¸ˆç½‘ç»œå’Œå­¦ç”Ÿç½‘ç»œä¹‹é—´çš„å®¹é‡å·®å¼‚ï¼Œå½“å®¹é‡å·®å¼‚è¿‡å¤§çš„æ—¶å€™ï¼Œå­¦ç”Ÿç½‘ç»œå¯èƒ½å¾ˆéš¾å­¦ä¹ å¥½è¿™äº›çŸ¥è¯†åœ¨çº¿è’¸é¦æ•™å¸ˆæ¨¡å‹å’Œå­¦ç”Ÿæ¨¡å‹éƒ½æ˜¯to be trainedçš„çŠ¶æ€ï¼Œå³æ•™å¸ˆæ¨¡å‹å¹¶æ²¡æœ‰é¢„è®­ç»ƒåœ¨å¤§å®¹é‡æ•™å¸ˆç½‘ç»œæ²¡æœ‰ç°æˆæ¨¡å‹çš„æ—¶å€™ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨online distillationã€‚ä½¿ç”¨åœ¨çº¿è’¸é¦çš„æ—¶å€™ï¼Œæ•™å¸ˆç½‘ç»œå’Œå­¦ç”Ÿç½‘ç»œçš„å‚æ•°ä¼šåŒæ—¶æ›´æ–°ï¼Œæ•´ä¸ªçŸ¥è¯†è’¸é¦æ¡†æ¶æ˜¯ç«¯åˆ°ç«¯è®­ç»ƒçš„å¯ä»¥å‚è€ƒæœ¬ç«™å›¾åƒåˆ†ç±»ç®—æ³•ç« èŠ‚ä¸‹çš„DeiTModelï¼ŒDeiTModelæ¨¡å‹æ˜¯å¯¹Vitæ¨¡å‹çš„æ”¹è¿›å’Œä¼˜åŒ–ï¼Œä½¿ç”¨äº†åœ¨çº¿è’¸é¦ç­–ç•¥(è¿˜æ˜¯ç¦»çº¿?)è‡ªè’¸é¦è‡ªè’¸é¦ä¸­ï¼Œæ•™å¸ˆå’Œå­¦ç”Ÿæ¨¡å‹ä½¿ç”¨ç›¸åŒçš„ç½‘ç»œã€‚è‡ªè’¸é¦å¯ä»¥çœ‹ä½œæ˜¯åœ¨çº¿è’¸é¦çš„ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œå› ä¸ºæ•™å¸ˆç½‘ç»œå’Œå­¦ç”Ÿç½‘ç»œä½¿ç”¨çš„æ˜¯ç›¸åŒçš„æ¨¡å‹æ¸©åº¦å‚æ•°ç­‰å¾…â€¦ç½‘ç»œé‡åŒ–ç­‰å¾…â€¦ç½‘ç»œå‰ªæç­‰å¾…â€¦ç½‘ç»œè’¸é¦ç­‰å¾…â€¦</content>
	</entry>
	<entry>
		<title>ä½œæ–‡èµæ_è¯­æ–‡ä»æˆ‘èº«è¾¹èµ°è¿‡</title>
		<url>/article/58490.html</url>
		<content> è¯­æ–‡ä»æˆ‘èº«è¾¹èµ°è¿‡   Your browser does not support the audio element.Â Â Â Â Â Â Â Â è¯­æ–‡ä»æˆ‘èº«è¾¹å€˜å¾‰è€Œè¿‡ï¼Œç•™ä¸‹å”é£å®‹éŸµçš„æ·‹æ¼“é…£ç•…ï¼Â Â Â Â Â Â Â Â è¯­æ–‡ä»æˆ‘èº«è¾¹æµæ·Œè€Œè¿‡ï¼Œç•™ä¸‹è¯—æ—è¯è‹‘çš„æ…·æ…¨æ¿€æ˜‚ï¼Â Â Â Â Â Â Â Â è¯­æ–‡ä»æˆ‘èº«è¾¹é£˜ç„¶è€Œè¿‡ï¼Œç•™ä¸‹ç¾æ–‡å°è¯´çš„å©‰è½¬æ‚ æ‰¬ï¼Â Â Â Â Â Â Â Â æœ¦èƒ§ä¸­èŠ³é¦™æ‰‘é¼»ï¼Œæ˜¯æ»¡å›­æ˜¥è‰²ä¸­ï¼Œé‚£æå‡ºå¢™çº¢æçš„é¦™ç”œä¹‹å‘³ï¼Ÿè¿˜æ˜¯å¤æ—¥è·å¡˜é‚£é–èœ“ä¼«ç«‹å°è·æ‰€æº¢çš„æ¸…å¹½ï¼Ÿæ˜¯é‡é˜³èŠèŠ±æ€’æ”¾å¸¦å‡ºæ€¡äººçš„æ·¡é›…ä¹‹é¦™ï¼Ÿè¿˜æ˜¯å†¬æ—¥å±±å›­å°æ¢…å‡Œå¯’å‚²é›ªæµ®åŠ¨çš„æš—é¦™ï¼ŸÂ Â Â Â Â Â Â Â å¦‚æœä½ æ˜¯â€œå¤§æ¼ å­¤çƒŸç›´ï¼Œé•¿æ²³è½æ—¥åœ†â€çš„è¾¹å¡å¤§æ¼ ï¼Œæˆ‘æ„¿é£å¥”åœ¨æ¼«å¤©é»„æ²™é‡Œï¼›å¦‚é‡‡ä½ æ˜¯â€œæƒŠæ¶›æ‹å²¸ï¼Œå·èµ·åƒå †é›ªâ€çš„æµ©ç€šé•¿æ±Ÿï¼Œæˆ‘æ„¿é¨æ¸¸äºçŒ›æµªæ¹æ¼©ä¸­ï¼›å¦‚æœä½ æ˜¯â€œå±±é‡æ°´å¤ç–‘æ— è·¯ï¼ŒæŸ³æš—èŠ±æ˜åˆä¸€æ‘â€çš„æ·±å±±ä¸›æ—ï¼Œæˆ‘æ„¿è·‹æ¶‰åœ¨è†æ£˜å°é“ä¸Šã€‚Â Â Â Â Â Â Â Â å­å¤œï¼Œé›¨æ°´å¤¹æ‚ç€é£çš„å•¸é¸£ï¼Œé™ä¸´äººé—´ï¼Œæ’å‡»ç€çª—æ£‚ã€‚æ­¤æ—¶çš„é›¨ï¼Œå£°å£°æ•²å‡»ç€å¿ƒæ‰‰ï¼Œä¼¼â€œå·´å±±å¤œé›¨æ¶¨ç§‹æ± â€ï¼Œä¼¼â€œé›¨æ‰“èŠ­è•‰æ¹¿çº¢æâ€â€¦â€¦å€¾å¬å¥‹æ–—ç›®æ ‡é›¨å£°ï¼Œä»¿ä½›å¬åˆ°äº†é»›ç‰è‘¬èŠ±é¢˜å¸•çš„å•¼å“­ï¼›ä»¿ä½›å¬åˆ°äº†é™†æ¸¸â€œé“é©¬å†°æ²³â€çš„å–Ÿå¹ï¼›ä»¿ä½›å¬åˆ°äº†æå•†éšæ€€å¿µå‹äººçš„å£°å£°å¹æƒ‹ã€‚Â Â Â Â Â Â Â Â é›¨ä¸­ï¼Œå…¨æˆˆé“é©¬æ­£ä¼´éšç€éœ‡å¤©çš„æˆ˜é¼“ä»é‚£é•¿å·é—´å¥”é©¬è€Œæ¥â€¦â€¦é›¨æ˜¯ç§¦æ§æ±‰æŸï¼Œä»äººå¿—å£«è½ä¸‹çš„æ‚²æ€†ä¹‹æ³ªï¼›é›¨æ˜¯æ¡ƒèŠ±æ½­æ°´è¾¹çŸ¥å·²ä¾ä¾ä¸èˆçš„æƒ†æ€…ä¹‹æ³ªï¼›é›¨æ˜¯èŒ«èŒ«æˆˆå£é—´ï¼Œå®ˆè¾¹å°†å£«æ‚‰è‹¦å¯‚å¯¥çš„ä¹¡æ€ä¹‹æ³ªã€‚Â Â Â Â Â Â Â Â è¯­æ–‡ï¼Œå¥½æ¯”ä¸€ç¼•è½»é£ï¼Œè¡æ¶¤ç€æˆ‘çš„å¿ƒæµ·ï¼Œä½¿æˆ‘çš„å¤©ç©ºå››å­£å¸¦æ˜¥ã€‚Â Â Â Â Â Â Â Â è¯­æ–‡ï¼Œå¥½æ¯”ä¸€è½®éª„é˜³ï¼Œç…§è€€ç€æˆ‘çš„å¿ƒçµï¼Œä½¿æˆ‘çš„ä¸–ç•Œå…‰æ˜æ°¸å­˜ã€‚Â Â Â Â Â Â Â Â è¯­æ–‡ï¼Œå¥½æ¯”ä¸€é˜µç»†é›¨ï¼Œæ»‹æ¶¦ç€æˆ‘çš„å¿ƒç”°ï¼Œä½¿æˆ‘çš„äººç”Ÿæ°¸ä¸æ¯ç«­ã€‚æƒ³é‡‡æ’·ä¸€æ³¢æµªæ¶›ç¼–ç»‡ä½ é£åŠ¨çš„è£™è§’æƒ³æ”¶é›†ä¸€æ§æ˜Ÿå…‰ç‚¹ç¼€ä½ é£˜è¿œçš„å‘æ¢¢æƒ³æŒ½ç•™ä¸€æŠ¹æ–œé˜³å®šæ ¼ä½ é†‰äººçš„å¾®ç¬‘æ— é¡»å¤ªå¤šè¨€è¾åªéœ€æ·±æ·±å‡çœ¸æ‹‚å»äº†å¹´å°‘è½»ç‹‚åªç•™ä¸‹ä¸ä¸æ„ŸåŠ¨Â Â Â Â Â Â Â Â ä¸é¡»â€œä¼—é‡Œå¯»ä»–åƒç™¾åº¦â€ä½ å·²â€œåœ¨ç¯ç«é˜‘çŠå¤„â€ï¼Œè½è½å¤§æ–¹çš„å±•éœ²èŠ³å®¹ã€‚å°±åƒæ­¤åˆ»ï¼Œæˆ‘è‡ªä¿¡åœ°ååœ¨ç­ä¸Šï¼Œé—»ç€çª—å¤–é˜³å…‰çš„æ°”æ¯ï¼Œæ„Ÿå—ç€è¯­æ–‡çš„ç¿°å¢¨æµé¦™ï¼Œè½»é£å°†æˆ‘çš„å‘ä¸æ‹‚èµ·ï¼Œæ‹‚èµ·æˆ‘å˜´è§’çš„ä¸€ä¸å¾®ç¬‘ï¼Œå› ä¸ºæˆ‘çŸ¥é“ï¼Œä½ æ­£ä»æˆ‘èº«è¾¹æ‚„æ‚„èµ°è¿‡ã€‚Â Â Â Â Â Â Â Â æŠ›ä¸å®Œç›¸æ€è¡€æ³ªæŠ›çº¢è±†ï¼Œå¼€ä¸å®Œæ˜¥æŸ³æ˜¥èŠ±æ»¡ç”»æ¥¼ï¼Œç¡ä¸ç¨³çº±çª—é£é›¨é»„æ˜åï¼Œå¿˜ä¸äº†æ–°æ„ä¸æ—§æ„ï¼Œå±•ä¸å¼€çš„çœ‰å¤´ï¼Œçœ‹ä¸æ¸…çš„é—å˜±ï¼Œæ°ä¾¿ä¼¼é®ä¸ä½çš„é’å±±éšéšï¼Œæµä¸å°½çš„ç»¿æ°´å¹½å¹½â€¦â€¦</content>
	</entry>
	<entry>
		<title>å›¾åƒåˆ†å‰²ç®—æ³•</title>
		<url>/article/54081.html</url>
		<content>å›¾åƒåˆ†å‰²UNetU-Net: Convolutional Networks for Biomedical Image Segmentation 2015å›¾åƒåˆ†å‰²å¿…å¤‡çŸ¥è¯†ç‚¹ | Unetè¯¦è§£ ç†è®º+ ä»£ç U-Netæ˜¯ä¸€ç§å¸¸ç”¨çš„å·ç§¯ç¥ç»ç½‘ç»œç»“æ„ï¼Œç‰¹åˆ«é€‚ç”¨äºå›¾åƒåˆ†å‰²ä»»åŠ¡ã€‚å®ƒç”±Olaf Ronnebergerç­‰äººåœ¨2015å¹´æå‡ºï¼Œå¹¶å› å…¶åœ¨ç”Ÿç‰©åŒ»å­¦å›¾åƒåˆ†å‰²ä¸­çš„å‡ºè‰²è¡¨ç°è€Œå—åˆ°å¹¿æ³›å…³æ³¨U-Netçš„æ•´ä½“ç»“æ„å‘ˆUå­—å½¢ï¼Œå› æ­¤å¾—åã€‚å®ƒåŒ…å«ä¸¤ä¸ªä¸»è¦éƒ¨åˆ†ï¼šç¼–ç å™¨(Encoder)å’Œè§£ç å™¨(Decoder)ç¼–ç å™¨ç”±ä¸€ç³»åˆ—å·ç§¯å±‚å’Œæ± åŒ–å±‚ç»„æˆï¼Œç”¨äºæå–å›¾åƒä¸­çš„ç‰¹å¾å¹¶é€æ¸ç¼©å°æ„Ÿå—é‡è§£ç å™¨ç”±ä¸€ç³»åˆ—åå·ç§¯å±‚å’Œè·³è·ƒè¿æ¥(Skip Connection)ç»„æˆï¼Œç”¨äºå°†ç¼–ç å™¨æå–çš„ç‰¹å¾æ˜ å°„é‡æ–°æ”¾å¤§ï¼Œå¹¶ä¸è§£ç å™¨ä¸­çš„ç‰¹å¾è¿›è¡Œèåˆè·³è·ƒè¿æ¥çš„ä½œç”¨æ˜¯å°†åº•å±‚çš„ç»†èŠ‚ä¿¡æ¯ä¼ é€’ç»™è§£ç å™¨ï¼Œæœ‰åŠ©äºæ›´å¥½åœ°æ¢å¤åˆ†å‰²ç»“æœçš„ç»†èŠ‚U-Netçš„è®¾è®¡æ€æƒ³æ˜¯åœ¨ç‰¹å¾æå–çš„åŒæ—¶ä¿ç•™æ›´å¤šçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œä»¥åŠä¿ç•™é«˜åˆ†è¾¨ç‡çš„ç»†èŠ‚ã€‚é€šè¿‡ç¼–ç å™¨å’Œè§£ç å™¨ä¹‹é—´çš„ç‰¹å¾ä¼ é€’å’Œèåˆï¼ŒU-Netèƒ½å¤ŸåŒæ—¶è·å¾—å±€éƒ¨å’Œå…¨å±€çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œå¹¶ç”Ÿæˆç»†è‡´å‡†ç¡®çš„åˆ†å‰²ç»“æœç”±äºå…¶ç®€å•è€Œæœ‰æ•ˆçš„ç»“æ„ï¼ŒU-Netåœ¨åŒ»å­¦å›¾åƒåˆ†å‰²ã€è¯­ä¹‰åˆ†å‰²ã€é¥æ„Ÿå›¾åƒåˆ†æç­‰é¢†åŸŸå¾—åˆ°äº†å¹¿æ³›åº”ç”¨ï¼Œå¹¶æˆä¸ºå›¾åƒåˆ†å‰²ä»»åŠ¡ä¸­çš„ç»å…¸æ¨¡å‹ä¹‹ä¸€è¯­ä¹‰åˆ†å‰²å®ä¾‹åˆ†å‰²</content>
	</entry>
	<entry>
		<title>æ·±åº¦å­¦ä¹ æ ¸å¿ƒä¹‹ä¼˜åŒ–å™¨</title>
		<url>/article/36065.html</url>
		<content>ä¼˜åŒ–ç®—æ³•æœ€ä¼˜åŒ–æ˜¯æŒ‡éçº¿æ€§æœ€ä¼˜åŒ–ï¼Œè§£éçº¿æ€§æœ€ä¼˜åŒ–çš„æ–¹æ³•æœ‰å¾ˆå¤šæ¯”å¦‚æ¢¯åº¦ä¸‹é™æ³•ã€å…±è½­æ¢¯åº¦æ³•ã€å˜å°ºåº¦æ³•å’Œæ­¥é•¿åŠ é€Ÿæ³•ç­‰å‚è€ƒæœ¬ç«™é“¾æ¥æœºå™¨å­¦ä¹ _æœ€ä¼˜åŒ–æ–¹æ³•æ¦‚è¿°pytorchä¼˜åŒ–å™¨é£æµ†å®˜æ–¹æ–‡æ¡£ï¼Œæ€»ç»“åˆ°ä½æ·±åº¦å­¦ä¹ ä¼˜åŒ–å™¨æ–¹æ³•åŠå­¦ä¹ ç‡è¡°å‡æ–¹å¼ç»¼è¿°An overview of gradient descent optimization algorithms18471951198320112012GD(BGD)SGDSGDM(Momentum)ã€NAGAdaGradAdadeltaã€RMSprop201520162018Adamã€AdaMaxNadamAMSGradç›¸å¯¹åº”çš„è®ºæ–‡A Stochastic Approximation Method SGD 1951Learning representations by back-propagating errors Momentum 1983A method for unconstrained convex minimization problem with the rate of convergence  o(1/k2) NAG 1983Adaptive subgradient methods for online learning and stochastic optimization AdaGrad 2011ADADELTA: an adaptive learning rate method. Adadelta 2012Neural Networks for Machine Learning Lecture 6a Overview of mini-batch gradient descent RMSprop 2012Adam: A method for stochastic optimization Adam &amp; AdaMax 2014Incorporating Nesterov Momentum into Adam NAdam 2016ä»¥ä¸‹æ˜¯ä¼˜åŒ–å™¨çš„å‘å±•è„‰ç»œï¼ŒæŒ‰ç…§æ—¶é—´é¡ºåºåˆ—å‡ºäº†ä¸€äº›é‡è¦çš„ä¼˜åŒ–å™¨åŠå…¶å¹´ä»½ï¼šGradient Descent (GD)ï¼šæœ€æ—©çš„ä¼˜åŒ–å™¨ä¹‹ä¸€ï¼Œç”¨äºæ±‚è§£æ— çº¦æŸä¼˜åŒ–é—®é¢˜ã€‚æ²¡æœ‰ç‰¹å®šçš„å¹´ä»½ï¼Œä½†æ—©åœ¨20ä¸–çºª50å¹´ä»£å°±å¼€å§‹è¢«å¹¿æ³›åº”ç”¨Stochastic Gradient Descent (SGD)ï¼šå¼•å…¥éšæœºæ€§æ¥ä¼°è®¡æ¢¯åº¦çš„ä¼˜åŒ–å™¨ï¼Œç”¨äºå¤§è§„æ¨¡æ•°æ®é›†å’Œæ·±åº¦å­¦ä¹ æ¨¡å‹ã€‚æ²¡æœ‰ç‰¹å®šçš„å¹´ä»½ï¼Œä½†åœ¨æ·±åº¦å­¦ä¹ çš„æ—©æœŸå°±è¢«å¹¿æ³›ä½¿ç”¨Momentumï¼ˆ1983ï¼‰ï¼šæå‡ºäº†åŠ¨é‡æ¦‚å¿µï¼Œé€šè¿‡ç´¯ç§¯æ¢¯åº¦çš„æŒ‡æ•°åŠ æƒå¹³å‡æ¥åŠ é€Ÿæ”¶æ•›AdaGradï¼ˆ2011ï¼‰ï¼šè‡ªé€‚åº”æ¢¯åº¦ç®—æ³•ï¼Œé€šè¿‡å¯¹æ¢¯åº¦è¿›è¡Œå½’ä¸€åŒ–å’Œè°ƒæ•´å­¦ä¹ ç‡ï¼Œé€‚åº”ä¸åŒå‚æ•°çš„æ›´æ–°éœ€æ±‚Adadeltaï¼ˆ2012ï¼‰ï¼šæ”¹è¿›äº†AdaGradçš„ç¼ºç‚¹ï¼Œé€šè¿‡è€ƒè™‘å†å²æ¢¯åº¦çš„å¹³å‡å€¼æ¥è°ƒæ•´å­¦ä¹ ç‡RMSpropï¼ˆ2012ï¼‰ï¼šå¼•å…¥äº†æŒ‡æ•°åŠ æƒç§»åŠ¨å¹³å‡çš„æ¦‚å¿µï¼Œç”¨äºè°ƒæ•´å­¦ä¹ ç‡ä»¥å¹³è¡¡å†å²æ¢¯åº¦ä¿¡æ¯Adamï¼ˆ2014ï¼‰ï¼šç»“åˆäº†åŠ¨é‡å’Œè‡ªé€‚åº”å­¦ä¹ ç‡çš„ä¼˜ç‚¹ï¼Œé€šè¿‡è‡ªé€‚åº”è°ƒæ•´å­¦ä¹ ç‡å’Œæ¢¯åº¦çš„ä¸€é˜¶çŸ©ä¼°è®¡å’ŒäºŒé˜¶çŸ©ä¼°è®¡æ¥è¿›è¡Œå‚æ•°æ›´æ–°AdaMaxï¼ˆ2014ï¼‰ï¼šåŸºäºAdamç®—æ³•ï¼Œé€šè¿‡æ›¿æ¢äºŒé˜¶çŸ©ä¼°è®¡çš„èŒƒæ•°ä¸ºæ— ç©·èŒƒæ•°ï¼Œæä¾›äº†æ›´ç¨³å®šçš„æ›´æ–°è§„åˆ™Nadamï¼ˆ2016ï¼‰ï¼šç»“åˆäº†NesterovåŠ¨é‡å’ŒAdamç®—æ³•ï¼Œåˆ©ç”¨åŠ¨é‡æ¥åŠ é€Ÿæ”¶æ•›AMSGradï¼ˆ2018ï¼‰ï¼šå¯¹Adamç®—æ³•è¿›è¡Œäº†æ”¹è¿›ï¼Œè§£å†³äº†Adamç®—æ³•å­¦ä¹ ç‡ä¸‹é™ä¸ç¨³å®šçš„é—®é¢˜è¿™äº›æ˜¯ä¸€äº›æ¯”è¾ƒé‡è¦çš„ä¼˜åŒ–å™¨ï¼Œå¹¶ä¸”æŒ‰ç…§æ—¶é—´é¡ºåºåˆ—å‡ºã€‚ç„¶è€Œï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¹¶éæ‰€æœ‰çš„ä¼˜åŒ–å™¨éƒ½æ˜¯çº¿æ€§å‘å±•çš„ï¼Œè€Œæ˜¯ç›¸äº’å€Ÿé‰´ã€æ”¹è¿›å’Œç»“åˆçš„ç»“æœã€‚ä¼˜åŒ–å™¨çš„å‘å±•æ˜¯ä¸€ä¸ªæ´»è·ƒçš„ç ”ç©¶é¢†åŸŸï¼Œä»ç„¶æœ‰è®¸å¤šæ–°çš„ä¼˜åŒ–ç®—æ³•è¢«æå‡ºå’Œæ”¹è¿›ä»€ä¹ˆæ˜¯ä¼˜åŒ–å™¨æ·±åº¦å­¦ä¹ çš„ç›®æ ‡æ˜¯é€šè¿‡ä¸æ–­æ”¹å˜ç½‘ç»œå‚æ•°ï¼Œä½¿å¾—å‚æ•°èƒ½å¤Ÿå¯¹è¾“å…¥åšå„ç§éçº¿æ€§å˜æ¢æ‹Ÿåˆè¾“å‡ºï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªå‡½æ•°å»å¯»æ‰¾æœ€ä¼˜è§£ï¼Œæ‰€ä»¥å¦‚ä½•å»æ›´æ–°å‚æ•°æ˜¯æ·±åº¦å­¦ä¹ ç ”ç©¶çš„é‡ç‚¹é€šå¸¸å°†æ›´æ–°å‚æ•°çš„ç®—æ³•ç§°ä¸ºä¼˜åŒ–å™¨ï¼Œå­—é¢ç†è§£å°±æ˜¯é€šè¿‡ä»€ä¹ˆç®—æ³•å»ä¼˜åŒ–ç½‘ç»œæ¨¡å‹çš„å‚æ•°æ¢¯åº¦ä¸‹é™æ ¸å¿ƒç‚¹æ–¹å‘: ç¡®å®šä¼˜åŒ–çš„æ–¹å‘ï¼Œä¸€èˆ¬é€šè¿‡æ±‚å¯¼ä¾¿å¯ä»¥æ±‚å¾—æ­¥é•¿: æ­¥å­å°±æ˜¯å†³å®šå½“å‰èµ°å¤šå¤§ï¼Œå¦‚æœå­¦ä¹ ç‡è®¾çš„è¿‡å¤§ï¼Œæ¢¯åº¦ä¼šåœ¨æœ€ä¼˜ç‚¹æ¥å›è·³åŠ¨ï¼Œè®¾çš„è¿‡å°éœ€è¦å¾ˆä¹…çš„è®­ç»ƒæ‰èƒ½è¾¾åˆ°æœ€ä¼˜ç‚¹ä¼˜åŒ–å™¨çš„ä¸»è¦ä½œç”¨å‚æ•°æ›´æ–°ï¼šä¼˜åŒ–å™¨æ ¹æ®æŸå¤±å‡½æ•°çš„æ¢¯åº¦ä¿¡æ¯ï¼Œè®¡ç®—å‡ºæ¯ä¸ªå‚æ•°çš„æ›´æ–°é‡ï¼Œå¹¶å°†æ›´æ–°é‡åº”ç”¨äºå‚æ•°ï¼Œä»è€Œæ›´æ–°æ¨¡å‹çš„å‚æ•°ã€‚è¿™æ ·ï¼Œæ¨¡å‹çš„å‚æ•°å°±å¯ä»¥æœç€èƒ½å¤Ÿæ›´å¥½åœ°æ‹Ÿåˆè®­ç»ƒæ•°æ®çš„æ–¹å‘è¿›è¡Œè°ƒæ•´å­¦ä¹ ç‡è°ƒæ•´ï¼šä¼˜åŒ–å™¨é€šå¸¸ä¼šè‡ªåŠ¨è°ƒæ•´å­¦ä¹ ç‡ï¼Œä»¥æ§åˆ¶å‚æ•°æ›´æ–°çš„æ­¥å¹…ã€‚å­¦ä¹ ç‡å†³å®šäº†æ¯æ¬¡å‚æ•°æ›´æ–°çš„å¹…åº¦ï¼Œè¿‡å¤§çš„å­¦ä¹ ç‡å¯èƒ½å¯¼è‡´å‚æ•°æ›´æ–°è¿‡å¿«è€Œé”™è¿‡æœ€ä¼˜è§£ï¼Œè€Œè¿‡å°çš„å­¦ä¹ ç‡å¯èƒ½å¯¼è‡´æ”¶æ•›é€Ÿåº¦ç¼“æ…¢ã€‚ä¼˜åŒ–å™¨æ ¹æ®å½“å‰è®­ç»ƒçš„è¿›åº¦å’Œå‚æ•°çš„å˜åŒ–æƒ…å†µï¼ŒåŠ¨æ€åœ°è°ƒæ•´å­¦ä¹ ç‡ï¼Œä»¥è·å¾—æ›´å¥½çš„è®­ç»ƒæ•ˆæœä¼˜åŒ–ç®—æ³•é€‰æ‹©ï¼šä¼˜åŒ–å™¨æä¾›äº†å¤šç§ä¸åŒçš„ä¼˜åŒ–ç®—æ³•ï¼Œå¦‚æ¢¯åº¦ä¸‹é™ã€åŠ¨é‡ä¼˜åŒ–ã€è‡ªé€‚åº”å­¦ä¹ ç‡ç­‰ã€‚è¿™äº›ç®—æ³•åœ¨å‚æ•°æ›´æ–°çš„æ–¹å¼ã€å­¦ä¹ ç‡è°ƒæ•´ç­–ç•¥ç­‰æ–¹é¢æœ‰æ‰€ä¸åŒï¼Œå¯ä»¥æ ¹æ®å…·ä½“ä»»åŠ¡çš„éœ€æ±‚é€‰æ‹©åˆé€‚çš„ä¼˜åŒ–ç®—æ³•é€šè¿‡åˆé€‚çš„ä¼˜åŒ–å™¨é€‰æ‹©å’Œå‚æ•°è°ƒæ•´ï¼Œå¯ä»¥æé«˜ç¥ç»ç½‘ç»œçš„è®­ç»ƒæ•ˆç‡å’Œæ€§èƒ½ï¼ŒåŠ é€Ÿæ”¶æ•›è¿‡ç¨‹ï¼Œä½¿å¾—æ¨¡å‹èƒ½å¤Ÿæ›´å¥½åœ°æ‹Ÿåˆè®­ç»ƒæ•°æ®ï¼Œå¹¶åœ¨æµ‹è¯•æ•°æ®ä¸Šå–å¾—è¾ƒå¥½çš„æ³›åŒ–èƒ½åŠ›ä¼˜åŒ–å™¨åˆ†ç±»æ¢¯åº¦ä¸‹é™ä¼˜åŒ–å™¨(Gradient Descent Optimizers)ï¼šåŸºäºæ¢¯åº¦ä¿¡æ¯æ¥æ›´æ–°å‚æ•°çš„ä¼˜åŒ–å™¨ï¼ŒåŒ…æ‹¬æ‰¹é‡æ¢¯åº¦ä¸‹é™(BGD)ã€éšæœºæ¢¯åº¦ä¸‹é™(SGD)å’Œå°æ‰¹é‡æ¢¯åº¦ä¸‹é™(Mini-Batch Gradient Descentï¼ŒMBGD)ç­‰åŸºäºåŠ¨é‡çš„ä¼˜åŒ–å™¨(Momentum-based Optimizers)ï¼šåœ¨æ¢¯åº¦ä¸‹é™çš„åŸºç¡€ä¸Šå¼•å…¥åŠ¨é‡çš„æ¦‚å¿µï¼Œæ—¨åœ¨åŠ é€Ÿæ”¶æ•›è¿‡ç¨‹å¹¶å‡å°‘éœ‡è¡ï¼Œå¸¸è§çš„åŒ…æ‹¬åŠ¨é‡ä¼˜åŒ–å™¨(Momentum Optimizer)ã€ç‰›é¡¿åŠ é€Ÿåº¦åŠ¨é‡ä¼˜åŒ–æ³•Nesterov Accelerated Gradient(NAG)ç­‰è‡ªé€‚åº”å­¦ä¹ ç‡ä¼˜åŒ–å™¨(Adaptive Learning Rate Optimizers)ï¼šæ ¹æ®å‚æ•°æ›´æ–°çš„æƒ…å†µåŠ¨æ€åœ°è°ƒæ•´å­¦ä¹ ç‡ï¼Œä»¥æé«˜æ”¶æ•›é€Ÿåº¦å’Œæ•ˆæœï¼Œå¸¸è§çš„åŒ…æ‹¬AdaGradã€RMSpropã€Adamã€AdaDeltaã€Adamaxç­‰å­¦ä¹ ç‡è¡°å‡ä¼˜åŒ–å™¨(Learning Rate Decay Optimizers)ï¼šåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­é€æ¸å‡å°å­¦ä¹ ç‡çš„ä¼˜åŒ–å™¨ï¼Œå¸¸è§çš„åŒ…æ‹¬Step Decayã€Exponential Decayã€Piecewise Decayç­‰æ­£åˆ™åŒ–ä¼˜åŒ–å™¨(Regularization Optimizers)ï¼šç»“åˆæ­£åˆ™åŒ–æŠ€æœ¯ï¼Œé€šè¿‡å¯¹æŸå¤±å‡½æ•°æ·»åŠ æ­£åˆ™åŒ–é¡¹æ¥æ§åˆ¶æ¨¡å‹çš„å¤æ‚åº¦ï¼Œå¸¸è§çš„åŒ…æ‹¬L1æ­£åˆ™åŒ–ã€L2æ­£åˆ™åŒ–ç­‰äºŒé˜¶ä¼˜åŒ–å™¨(Second-Order Optimizers)ï¼šè€ƒè™‘å‚æ•°äºŒé˜¶ä¿¡æ¯çš„ä¼˜åŒ–å™¨ï¼Œå¦‚ç‰›é¡¿æ³•(Newtonâ€™s Method)ã€å…±è½­æ¢¯åº¦æ³•(Conjugate Gradient)ç­‰ä¸åŒç±»å‹çš„ä¼˜åŒ–å™¨åœ¨æ›´æ–°å‚æ•°çš„æ–¹å¼ã€å­¦ä¹ ç‡è°ƒæ•´ç­–ç•¥ã€æ”¶æ•›é€Ÿåº¦ã€å¯¹å™ªå£°å’Œå±€éƒ¨æœ€ä¼˜çš„é²æ£’æ€§ç­‰æ–¹é¢æœ‰æ‰€åŒºåˆ«ï¼Œé€‰æ‹©åˆé€‚çš„ä¼˜åŒ–å™¨å–å†³äºå…·ä½“çš„é—®é¢˜å’Œæ•°æ®é›†ç‰¹å¾åŸºæœ¬çš„æ¢¯åº¦ä¸‹é™æ³•ä¼˜åŒ–å™¨ç»¼è¿°æ·±åº¦å­¦ä¹ â€”â€”ä¼˜åŒ–å™¨ç®—æ³•Optimizerè¯¦è§£ï¼ˆBGDã€SGDã€MBGDã€Momentumã€NAGã€Adagradã€Adadeltaã€RMSpropã€Adamï¼‰ä¼˜åŒ–å™¨çš„å­˜åœ¨å°±æ˜¯ç¡®å®šä¼˜åŒ–çš„æ–¹å‘å’Œé¢å¯¹å½“å‰çš„æƒ…å†µåŠ¨æ€çš„è°ƒæ•´æ­¥å­BGDã€SGDå’ŒMBGDçš„åŒºåˆ«ä¼˜åŒ–å™¨BGDSGDMBGDæ ·æœ¬æ•°N(æ‰€æœ‰)1batch_sizeBGDBGD(Batch Gradient Descent)é‡‡ç”¨æ•´ä¸ªè®­ç»ƒé›†çš„æ•°æ®æ¥è®¡ç®—cost functionå¯¹å‚æ•°çš„æ¢¯åº¦å…¶ä¸­$\alpha $ä¸ºå­¦ä¹ ç‡ï¼Œè€Œ$\Delta L\left(w_{t}\right)$ä¸ºæŸå¤±å‡½æ•°çš„ä¸€é˜¶å¯¼æ•°BGDåœ¨è®¡ç®—æ¢¯åº¦æ—¶ä¼šå‡ºç°å†—ä½™å› ä¸ºBGDåœ¨æ¯ä¸€æ¬¡è¿­ä»£ä¸­éƒ½ä½¿ç”¨äº†æ•´ä¸ªè®­ç»ƒé›†ï¼Œè€Œä¸”åœ¨æ¢¯åº¦è®¡ç®—è¿‡ç¨‹ä¸­å¹¶æ²¡æœ‰è€ƒè™‘æ ·æœ¬ä¹‹é—´çš„ç›¸å…³æ€§å› æ­¤ï¼Œå¯¹äºæ ·æœ¬ä¸­çš„æŸäº›éƒ¨åˆ†ï¼Œå…¶æ¢¯åº¦è®¡ç®—å¯èƒ½ä¼šä¸å…¶ä»–æ ·æœ¬çš„æ¢¯åº¦è®¡ç®—é‡å¤ï¼Œè¿™ç§å†—ä½™è®¡ç®—å¯èƒ½ä¼šå¯¼è‡´è®¡ç®—æ•ˆç‡çš„é™ä½ï¼Œç‰¹åˆ«æ˜¯åœ¨è®­ç»ƒé›†å¾ˆå¤§çš„æƒ…å†µä¸‹ä¼˜ç‚¹æ”¶æ•›ç¨³å®šï¼šç”±äºæ¯æ¬¡è¿­ä»£ä½¿ç”¨æ•´ä¸ªè®­ç»ƒé›†çš„æ‰€æœ‰æ ·æœ¬è¿›è¡Œå‚æ•°æ›´æ–°ï¼Œæ”¶æ•›è¿‡ç¨‹ç›¸å¯¹ç¨³å®šå‚æ•°æ›´æ–°å‡†ç¡®ï¼šä½¿ç”¨å…¨å±€æ¢¯åº¦æ¥æ›´æ–°å‚æ•°ï¼Œå¯¹äºå‡¸ä¼˜åŒ–é—®é¢˜ï¼Œå¯ä»¥è¾¾åˆ°å…¨å±€æœ€ä¼˜è§£ç¼ºç‚¹è®­ç»ƒé€Ÿåº¦æ…¢ï¼šBGD æ˜¯ä¸€ç§æ‰¹é‡æ¢¯åº¦ä¸‹é™ç®—æ³•ï¼Œæ¯æ¬¡æ›´æ–°æ¨¡å‹å‚æ•°æ—¶ä½¿ç”¨æ•´ä¸ªè®­ç»ƒæ•°æ®é›†è®¡ç®—å¼€é”€å¤§ï¼šéœ€è¦è®¡ç®—æ•´ä¸ªè®­ç»ƒé›†çš„æ¢¯åº¦ï¼Œå¯¹äºå¤§è§„æ¨¡æ•°æ®é›†æˆ–å¤æ‚æ¨¡å‹ï¼Œè®¡ç®—å¼€é”€è¾ƒé«˜å†…å­˜å ç”¨é«˜ï¼šéœ€è¦å­˜å‚¨æ•´ä¸ªè®­ç»ƒé›†çš„æ•°æ®å’Œæ¢¯åº¦ä¿¡æ¯SGDSGD(Stochastic Gradient Descent)æ˜¯ä¸€ç§éšæœºæ¢¯åº¦ä¸‹é™ç®—æ³•ï¼Œæ¯æ¬¡æ›´æ–°æ¨¡å‹å‚æ•°æ—¶ä½¿ç”¨å•ä¸ªæ ·æœ¬æˆ–ä¸€å°æ‰¹æ ·æœ¬(é€šå¸¸ç§°ä¸ºmini-batchï¼Œä¹Ÿç§°MBGD)å…¶ä¸­$\alpha $ä¸ºå­¦ä¹ ç‡ï¼Œè€Œ$\Delta L\left(w_{t}\right)$ä¸ºæŸå¤±å‡½æ•°çš„ä¸€é˜¶å¯¼æ•°ï¼Œ$m$ä¸ºbatch_sizeï¼Œå½“$m=1$å°±æ˜¯SGDï¼Œå¦åˆ™å°±æ˜¯MBGDä¼˜ç‚¹è®¡ç®—å¼€é”€å°ï¼šæ¯æ¬¡è¿­ä»£åªä½¿ç”¨ä¸€ä¸ªæ ·æœ¬è¿›è¡Œå‚æ•°æ›´æ–°ï¼Œè®¡ç®—å¼€é”€è¾ƒå°é€‚ç”¨äºå¤§è§„æ¨¡æ•°æ®é›†ï¼šç”±äºæ ·æœ¬çš„éšæœºé€‰æ‹©ï¼Œå¯ä»¥å¤„ç†å¤§è§„æ¨¡æ•°æ®é›†ï¼Œä¸”æ˜“äºå¹¶è¡Œå¤„ç†ç¼ºç‚¹å‚æ•°æ›´æ–°ä¸ç¨³å®šï¼šç”±äºå•ä¸ªæ ·æœ¬çš„æ¢¯åº¦è®¡ç®—å¯èƒ½å­˜åœ¨å™ªå£°ï¼Œå‚æ•°æ›´æ–°ä¸ç¨³å®šï¼Œå¯èƒ½å¼•èµ·å‚æ•°åœ¨æœ€ä¼˜ç‚¹é™„è¿‘éœ‡è¡æ”¶æ•›é€Ÿåº¦è¾ƒæ…¢ï¼šç”±äºå‚æ•°æ›´æ–°çš„ä¸ç¨³å®šæ€§ï¼Œæ”¶æ•›é€Ÿåº¦ç›¸å¯¹è¾ƒæ…¢MBGDMBGD(Mini-Batch Gradient Descent)æ¯ä¸€æ¬¡åˆ©ç”¨ä¸€å°æ‰¹æ ·æœ¬ï¼Œå³batch_sizeä¸ªæ ·æœ¬è¿›è¡Œè®¡ç®—ï¼Œè¿™æ ·å®ƒå¯ä»¥é™ä½å‚æ•°æ›´æ–°æ—¶çš„æ–¹å·®ï¼Œæ”¶æ•›æ›´ç¨³å®šï¼Œå¦ä¸€æ–¹é¢å¯ä»¥å……åˆ†åœ°åˆ©ç”¨æ·±åº¦å­¦ä¹ åº“ä¸­é«˜åº¦ä¼˜åŒ–çš„çŸ©é˜µæ“ä½œæ¥è¿›è¡Œæ›´æœ‰æ•ˆçš„æ¢¯åº¦è®¡ç®—å…¶ä¸­$\alpha $ä¸ºå­¦ä¹ ç‡ï¼Œè€Œ$\Delta L\left(w_{t}\right)$ä¸ºæŸå¤±å‡½æ•°çš„ä¸€é˜¶å¯¼æ•°ï¼Œ$m$ä¸ºbatch_sizeï¼Œå½“$m=1$å°±æ˜¯SGDï¼Œå¦åˆ™å°±æ˜¯MBGDä¼˜ç‚¹å¹³è¡¡äº†å¼€é”€å’Œå‚æ•°ç¨³å®šæ€§ï¼šä½¿ç”¨ä¸€å°æ‰¹æ ·æœ¬è¿›è¡Œå‚æ•°æ›´æ–°ï¼Œç»¼åˆäº†å…¨å±€æ¢¯åº¦å’Œéšæœºæ¢¯åº¦çš„ä¿¡æ¯ï¼Œè®¡ç®—å¼€é”€å’Œå‚æ•°æ›´æ–°çš„ç¨³å®šæ€§å¾—åˆ°ä¸€å®šçš„å¹³è¡¡æ”¶æ•›é€Ÿåº¦è¾ƒå¿«ï¼šç›¸å¯¹äºBGDï¼Œä½¿ç”¨è¾ƒå°çš„æ‰¹é‡æ ·æœ¬æ›´æ–°å‚æ•°ï¼Œæ”¶æ•›é€Ÿåº¦æ›´å¿«ç¼ºç‚¹æ‰¹é‡å¤§å°éœ€è°ƒä¼˜ï¼šæ‰¹é‡å¤§å°çš„é€‰æ‹©å¯èƒ½ä¼šå½±å“æ¨¡å‹çš„æ€§èƒ½ï¼Œéœ€è¦è¿›è¡Œè°ƒä¼˜å¯èƒ½å¯¼è‡´å±€éƒ¨æœ€ä¼˜ï¼šè¾ƒå°çš„æ‰¹é‡æ ·æœ¬å¯èƒ½ä¼šå¼•å…¥ä¸€å®šçš„éšæœºæ€§ï¼Œå¯èƒ½å¯¼è‡´é™·å…¥å±€éƒ¨æœ€ä¼˜è€Œæ— æ³•è¾¾åˆ°å…¨å±€æœ€ä¼˜åŠ¨é‡ä¼˜åŒ–æ³•SGDMéšæœºæ¢¯åº¦ä¸‹é™æ³•è™½ç„¶æœ‰æ•ˆï¼Œä½†å®¹æ˜“é™·å…¥å±€éƒ¨æœ€å°å€¼ç‚¹ï¼Œç”šè‡³åœ¨é©»ç‚¹é™„è¿‘ä»¥åŠæ¢¯åº¦å€¼éå¸¸å°çš„ç‚¹é™„è¿‘æ—¶å‚æ•°æ›´æ–°æä¸ºç¼“æ…¢ä¸ºäº†æŠ‘åˆ¶SGDçš„éœ‡è¡ï¼ŒSGDM(Stochastic Gradient Descent Momentum)è®¤ä¸ºæ¢¯åº¦ä¸‹é™è¿‡ç¨‹å¯ä»¥åŠ å…¥æƒ¯æ€§ä¸»è¦æ€æƒ³æ˜¯ä¸‹é™è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå‘ç°æ˜¯é™¡å¡ï¼Œé‚£å°±åˆ©ç”¨æƒ¯æ€§è·‘çš„å¿«ä¸€äº›ã€‚å› æ­¤ï¼Œå…¶åœ¨SGDåŸºç¡€ä¸Šå¼•å…¥äº†ä¸€é˜¶åŠ¨é‡åœ¨å¡åº¦æ¯”è¾ƒé™¡çš„åœ°æ–¹ï¼Œä¼šæœ‰è¾ƒå¤§çš„æƒ¯æ€§ï¼Œè¿™æ˜¯ä¸‹é™çš„å¤šã€‚å¡åº¦å¹³ç¼“çš„åœ°æ–¹ï¼Œæƒ¯æ€§è¾ƒå°ï¼Œä¸‹é™çš„ä¼šæ¯”è¾ƒæ…¢å…¶ä¸­$\alpha $ä¸ºå­¦ä¹ ç‡ï¼Œ$\Delta L(w_t)$è¡¨ç¤ºå½“å‰tæ—¶åˆ»æ¢¯åº¦ï¼Œ$m_t$è¡¨ç¤ºå½“å‰æ—¶åˆ»çš„åŠ æƒåçš„æ¢¯åº¦ï¼Œ$\lambda$æ˜¯åŠ¨é‡ç³»æ•°$\lambda$çš„ç»éªŒå€¼ä¸º0.9(è¡¨ç¤ºæœ€å¤§é€Ÿåº¦10å€äºSGD)ï¼Œè¿™å°±æ„å‘³ç€ä¸‹é™æ–¹å‘ä¸»è¦æ˜¯æ­¤å‰ç´¯ç§¯çš„ä¸‹é™æ–¹å‘ï¼Œå¹¶ç•¥å¾®åå‘å½“å‰æ—¶åˆ»çš„ä¸‹é™æ–¹å‘ä¸€é˜¶åŠ¨é‡æ˜¯å„ä¸ªæ—¶åˆ»æ¢¯åº¦æ–¹å‘çš„æŒ‡æ•°ç§»åŠ¨å¹³å‡å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ—¶åˆ»çš„ä¸‹é™æ–¹å‘ï¼Œä¸ä»…ç”±å½“å‰ç‚¹çš„æ¢¯åº¦æ–¹å‘å†³å®šï¼Œè€Œä¸”ç”±æ­¤å‰ç´¯ç§¯çš„ä¸‹é™æ–¹å‘å†³å®šæ¢¯åº¦æ˜¯å¦‚ä½•ç´¯ç§¯çš„è¿™é‡Œå°†$m_t$å±•å¼€ï¼Œå¯ä»¥çœ‹åˆ°å½“å‰æ—¶åˆ»çš„æ¢¯åº¦æ˜¯å¯¹å†å²æ¢¯åº¦è¿›è¡ŒåŠ æƒå¾—åˆ°çš„ï¼Œå…¶ä¸­ï¼Œ$\lambda$æ˜¯ä¸€ä¸ªä»‹äº0å’Œ1ä¹‹é—´çš„å‚æ•°ï¼Œæ§åˆ¶äº†å†å²æ¢¯åº¦å¯¹å½“å‰åŠ¨é‡çš„è´¡çŒ®ç¨‹åº¦è¾ƒå¤§çš„$\lambda$å€¼ä¼šä½¿å†å²æ¢¯åº¦çš„è´¡çŒ®æ›´å¤§ï¼Œä»è€Œä½¿åŠ¨é‡æ›´åŠ å¹³æ»‘è¾ƒå°çš„$\lambda$å€¼ä¼šä½¿å½“å‰æ¢¯åº¦çš„è´¡çŒ®æ›´å¤§ï¼Œä»è€Œå¯¹å˜åŒ–æ›´ä¸ºæ•æ„Ÿè¿™ç§æƒé‡è¡°å‡çš„æ–¹å¼ä½¿å¾—å†å²æ¢¯åº¦çš„è´¡çŒ®é€æ¸å‡å°ï¼Œæ›´åŠ å…³æ³¨è¿‘æœŸçš„æ¢¯åº¦å˜åŒ–ï¼Œæœ‰åŠ©äºé€‚åº”å˜åŒ–çš„æ•°æ®å’Œæ¨¡å‹å‚æ•°ä¼˜ç‚¹åŠ é€Ÿæ”¶æ•›ï¼šSGDMå¼•å…¥äº†åŠ¨é‡çš„æ¦‚å¿µï¼Œé€šè¿‡ç´¯ç§¯ä¹‹å‰çš„åŠ¨é‡ä¿¡æ¯ï¼Œæœ‰åŠ©äºåŠ é€Ÿæ¨¡å‹çš„æ”¶æ•›é€Ÿåº¦ï¼Œç‰¹åˆ«æ˜¯åœ¨å­˜åœ¨å¹³å¦åŒºåŸŸçš„æƒ…å†µä¸‹æ›´ä¸ºæ˜æ˜¾å‡å°‘éœ‡è¡ï¼šåŠ¨é‡çš„ç´¯ç§¯ä½œç”¨å¯ä»¥å‡å°‘å‚æ•°æ›´æ–°æ—¶çš„éœ‡è¡ç°è±¡ï¼Œæœ‰åŠ©äºæ›´ç¨³å®šåœ°æ›´æ–°æ¨¡å‹å‚æ•°å°½å¯èƒ½è·³å‡ºå±€éƒ¨æœ€ä¼˜ï¼šåŠ¨é‡çš„å¼•å…¥å¯ä»¥å¸®åŠ©æ¨¡å‹è·³å‡ºå±€éƒ¨æœ€ä¼˜ç‚¹ï¼Œä»¥ä¾¿æ›´å¥½åœ°æœç´¢å…¨å±€æœ€ä¼˜ç‚¹å½“å±€éƒ¨æ²Ÿå£‘æ¯”è¾ƒæ·±ï¼ŒåŠ¨é‡åŠ æŒç”¨å®Œäº†ï¼Œä¾ç„¶ä¼šå›°åœ¨å±€éƒ¨æœ€ä¼˜é‡Œæ¥å›æŒ¯è¡ç¼ºç‚¹éœ€è¦è°ƒæ•´è¶…å‚æ•°ï¼šSGDMä¸­çš„åŠ¨é‡ç³»æ•°éœ€è¦æ‰‹åŠ¨è®¾ç½®ï¼Œé€‰æ‹©åˆé€‚çš„åŠ¨é‡ç³»æ•°å¯¹äºæ¨¡å‹çš„æ€§èƒ½å½±å“è¾ƒå¤§ï¼Œéœ€è¦è¿›è¡Œè°ƒè¯•å’Œè°ƒä¼˜å¯èƒ½å¯¼è‡´è¿‡æ‹Ÿåˆï¼šå½“åŠ¨é‡ç³»æ•°è¾ƒå¤§æ—¶ï¼ŒSGDMå¯èƒ½åœ¨ä¼˜åŒ–è¿‡ç¨‹ä¸­è¿‡åº¦ä¾èµ–ä¹‹å‰çš„åŠ¨é‡ä¿¡æ¯ï¼Œå¯¼è‡´æ¨¡å‹è¿‡æ‹Ÿåˆéš¾ä»¥å¤„ç†éå¹³ç¨³æ•°æ®ï¼šå¯¹äºéå¹³ç¨³æ•°æ®ï¼ŒSGDMçš„åŠ¨é‡ç´¯ç§¯å¯èƒ½ä¼šå¯¼è‡´æ¨¡å‹åœ¨å˜åŒ–å¿«é€Ÿçš„æ–¹å‘ä¸Šè¿‡åº¦è¿½è¸ªï¼Œè€Œæ— æ³•åŠæ—¶é€‚åº”å˜åŒ–æ”¹è¿›æ–¹æ³•è‡ªé€‚åº”è°ƒæ•´åŠ¨é‡ç³»æ•°ï¼šå¯ä»¥é‡‡ç”¨è‡ªé€‚åº”çš„æ–¹å¼æ¥è°ƒæ•´åŠ¨é‡ç³»æ•°ï¼Œä¾‹å¦‚ä½¿ç”¨è‡ªé€‚åº”çš„åŠ¨é‡æ–¹æ³•(å¦‚Adam)æ¥æ ¹æ®æ¢¯åº¦çš„å˜åŒ–è‡ªåŠ¨è°ƒæ•´åŠ¨é‡ç³»æ•°å­¦ä¹ ç‡è°ƒåº¦ç­–ç•¥ï¼šç»“åˆå­¦ä¹ ç‡è°ƒåº¦ç­–ç•¥ï¼Œå¦‚å­¦ä¹ ç‡è¡°å‡æˆ–è‡ªé€‚åº”å­¦ä¹ ç‡æ–¹æ³•ï¼Œå¯ä»¥æ›´å¥½åœ°æ§åˆ¶æ¨¡å‹çš„å­¦ä¹ é€Ÿåº¦å’Œæ–¹å‘æ­£åˆ™åŒ–æŠ€æœ¯ï¼šä½¿ç”¨æ­£åˆ™åŒ–æŠ€æœ¯ï¼Œå¦‚L1æ­£åˆ™åŒ–æˆ–L2æ­£åˆ™åŒ–ï¼Œå¯ä»¥ç¼“è§£è¿‡æ‹Ÿåˆé—®é¢˜ï¼Œä½¿æ¨¡å‹æ›´å…·æ³›åŒ–èƒ½åŠ›å› ä¸ºåŠ å…¥äº†åŠ¨é‡å› ç´ ï¼ŒSGDMç¼“è§£äº†SGDåœ¨å±€éƒ¨æœ€ä¼˜ç‚¹æ¢¯åº¦ä¸º0ï¼Œæ— æ³•æŒç»­æ›´æ–°çš„é—®é¢˜å’ŒæŒ¯è¡å¹…åº¦è¿‡å¤§çš„é—®é¢˜ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å®Œå…¨è§£å†³ï¼Œå½“å±€éƒ¨æ²Ÿå£‘æ¯”è¾ƒæ·±ï¼ŒåŠ¨é‡åŠ æŒç”¨å®Œäº†ï¼Œä¾ç„¶ä¼šå›°åœ¨å±€éƒ¨æœ€ä¼˜é‡Œæ¥å›æŒ¯è¡NAGæ·±åº¦å­¦ä¹ ä¼˜åŒ–å‡½æ•°è¯¦è§£â€” Nesterov accelerated gradient (NAG)æ¯”Momentumæ›´å¿«ï¼šæ­å¼€Nesterov Accelerated Gradientçš„çœŸé¢ç›®åŠ¨é‡æ³•æ¯ä¸‹é™ä¸€æ­¥éƒ½æ˜¯ç”±å‰é¢ä¸‹é™æ–¹å‘çš„ä¸€ä¸ªç´¯ç§¯å’Œå½“å‰ç‚¹çš„æ¢¯åº¦æ–¹å‘ç»„åˆè€Œæˆã€‚äºæ˜¯ä¸€ä½å¤§ç¥(Nesterov)å°±å¼€å§‹æ€è€ƒï¼Œæ—¢ç„¶æ¯ä¸€æ­¥éƒ½è¦å°†ä¸¤ä¸ªæ¢¯åº¦æ–¹å‘(å†å²æ¢¯åº¦ã€å½“å‰æ¢¯åº¦)åšä¸€ä¸ªåˆå¹¶å†ä¸‹é™ï¼Œé‚£ä¸ºä»€ä¹ˆä¸å…ˆæŒ‰ç…§å†å²æ¢¯åº¦å¾€å‰èµ°é‚£ä¹ˆä¸€å°æ­¥ï¼ŒæŒ‰ç…§å‰é¢ä¸€å°æ­¥ä½ç½®çš„è¶…å‰æ¢¯åº¦æ¥åšæ¢¯åº¦åˆå¹¶å‘¢å¦‚æ­¤ä¸€æ¥ï¼Œå°çƒå°±å¯ä»¥å…ˆä¸ç®¡ä¸‰ä¸ƒäºŒåä¸€å…ˆå¾€å‰èµ°ä¸€æ­¥ï¼Œåœ¨é å‰ä¸€ç‚¹çš„ä½ç½®çœ‹åˆ°æ¢¯åº¦ï¼Œç„¶åæŒ‰ç…§é‚£ä¸ªä½ç½®å†æ¥ä¿®æ­£è¿™ä¸€æ­¥çš„æ¢¯åº¦æ–¹å‘ï¼ŒåŒSGDMæ¯”è¾ƒçš„å·®ä¸€ç‚¹å¦‚ä¸‹å…¬å¼æ‰€ç¤ºæ—¢ç„¶çŸ¥é“ä¼šèµ°ï¼Œå°±ä¸éœ€è¦è¿˜ç”¨å½“å‰ä½ç½®çš„æ¢¯åº¦ï¼Œå¯ä»¥ç›´æ¥èµ°åˆ°çš„ä½ç½®è®¡ç®—æ¢¯åº¦ï¼Œè¿™æ ·å­å°±æœ‰äº†è¶…å‰çœ¼å…‰æœ‰äº†è¶…å‰çš„çœ¼å…‰ï¼Œå°çƒå°±ä¼šæ›´åŠ èªæ˜, è¿™ç§æ–¹æ³•è¢«å‘½åä¸ºç‰›é¡¿åŠ é€Ÿæ¢¯åº¦(Nesterov accelerated gradient)ç®€ç§°NAGï¼Œä¸‹å›¾æ˜¯SGDMä¸‹é™æ³•ä¸NAGä¸‹é™æ³•çš„å¯è§†åŒ–æ¯”è¾ƒNAGç®—æ³•å…¬å¼è¡¨è¾¾å¦‚ä¸‹ï¼šä¸ºä»€ä¹ˆNAGæ¯”SGDMå¿«å¯¹NAGåŸæ¥çš„æ›´æ–°å…¬å¼è¿›è¡Œå˜æ¢ï¼Œå¾—åˆ°è¿™æ ·çš„ç­‰æ•ˆå½¢å¼(å…·ä½“æ¨å¯¼è¿‡ç¨‹)ä¸Momentumçš„åŒºåˆ«åœ¨äºï¼Œæœ¬æ¬¡æ›´æ–°æ–¹å‘å¤šåŠ äº†ä¸€ä¸ªç›´è§‚å«ä¹‰å°±å¾ˆæ˜æ˜¾äº†ï¼šå¦‚æœè¿™æ¬¡çš„æ¢¯åº¦æ¯”ä¸Šæ¬¡çš„æ¢¯åº¦å˜å¤§äº†ï¼Œé‚£ä¹ˆæœ‰å¯èƒ½ä¼šç»§ç»­å˜å¤§ï¼Œå¯ä»¥æŠŠé¢„è®¡å¢å¤§çš„éƒ¨åˆ†æå‰åŠ è¿›æ¥ï¼›å˜å°çš„æƒ…å†µç±»ä¼¼è¿™ä¸ªå¤šåŠ ä¸Šå»çš„é¡¹å°±æ˜¯åœ¨è¿‘ä¼¼ç›®æ ‡å‡½æ•°çš„äºŒé˜¶å¯¼å˜›ï¼Œå› æ­¤ï¼ŒNAGæœ¬è´¨ä¸Šæ˜¯å¤šè€ƒè™‘äº†ç›®æ ‡å‡½æ•°çš„äºŒé˜¶å¯¼ä¿¡æ¯ï¼Œå…¶å®æ‰€è°“å¾€å‰çœ‹çš„è¯´æ³•ï¼Œåœ¨ç‰›é¡¿æ³•è¿™æ ·çš„äºŒé˜¶æ–¹æ³•ä¸­ä¹Ÿæ˜¯ç»å¸¸æåˆ°çš„ï¼Œä»æ•°å­¦è§’åº¦ä¸Šçœ‹ï¼Œåˆ™æ˜¯åˆ©ç”¨äº†ç›®æ ‡å‡½æ•°çš„äºŒé˜¶å¯¼ä¿¡æ¯è‡ªé€‚åº”å­¦ä¹ ç‡ä¼˜åŒ–å™¨AdaGradæå®æ¯…æ·±åº¦å­¦ä¹ ç¬”è®°-Adagradç®—æ³•AdaGrad ç®—æ³•ä¼˜åŒ–çš„å˜é‡å¯¹äºç›®æ ‡å‡½æ•°çš„ä¾èµ–æ˜¯å„ä¸ç›¸åŒåœ¨åŸºæœ¬çš„æ¢¯åº¦ä¸‹é™æ³•ä¼˜åŒ–ä¸­ï¼Œæœ‰ä¸€ä¸ªå¸¸è§çš„é—®é¢˜æ˜¯ï¼Œè¦ä¼˜åŒ–çš„å˜é‡å¯¹äºç›®æ ‡å‡½æ•°çš„ä¾èµ–æ˜¯å„ä¸ç›¸åŒçš„å¯¹äºæŸäº›å˜é‡ï¼Œå·²ç»ä¼˜åŒ–åˆ°äº†æå°å€¼é™„è¿‘ï¼Œä½†æ˜¯æœ‰çš„å˜é‡ä»ç„¶åœ¨æ¢¯åº¦å¾ˆå¤§çš„åœ°æ–¹ï¼Œè¿™æ—¶å€™ä¸€ä¸ªç»Ÿä¸€çš„å…¨å±€å­¦ä¹ ç‡æ˜¯å¯èƒ½å‡ºç°é—®é¢˜çš„å¦‚æœå­¦ä¹ ç‡å¤ªå°ï¼Œåˆ™æ¢¯åº¦å¾ˆå¤§çš„å˜é‡ä¼šæ”¶æ•›å¾ˆæ…¢ï¼Œå¦‚æœæ¢¯åº¦å¤ªå¤§ï¼Œå·²ç»ä¼˜åŒ–å·®ä¸å¤šçš„å˜é‡å°±å¯èƒ½ä¼šä¸ç¨³å®šç°å®ä¸–ç•Œçš„æ•°æ®é›†ä¸­ï¼Œä¸€äº›ç‰¹å¾æ˜¯ç¨€ç–çš„(å¤§éƒ¨åˆ†ç‰¹å¾ä¸ºé›¶ï¼Œæ‰€ä»¥å®ƒæ˜¯ç¨€ç–çš„)ï¼Œè€Œå¦ä¸€äº›åˆ™æ˜¯å¯†é›†çš„(denseï¼Œå¤§éƒ¨åˆ†ç‰¹å¾æ˜¯éé›¶çš„)ï¼Œå› æ­¤ä¸ºæ‰€æœ‰æƒå€¼ä¿æŒç›¸åŒçš„å­¦ä¹ ç‡ä¸åˆ©äºä¼˜åŒ–é’ˆå¯¹è¿™ä¸ªé—®é¢˜ï¼Œå½“æ—¶åœ¨ä¼¯å…‹åˆ©åŠ å·å¤§å­¦è¯»åšå£«çš„Jhon Duchiï¼Œ2011å¹´æå‡ºäº†AdaGrad(Adaptive Gradient)ï¼Œä¹Ÿå°±æ˜¯è‡ªé€‚åº”å­¦ä¹ ç‡åŸºæœ¬æ€æƒ³AdaGradçš„åŸºæœ¬æ€æƒ³æ˜¯å¯¹æ¯ä¸ªå˜é‡ç”¨ä¸åŒçš„å­¦ä¹ ç‡ï¼Œè®¾ç½®äº†å…¨å±€å­¦ä¹ ç‡ä¹‹åï¼Œæ¯æ¬¡é€šè¿‡ï¼Œå…¨å±€å­¦ä¹ ç‡é€å‚æ•°çš„é™¤ä»¥å†å²æ¢¯åº¦å¹³æ–¹å’Œçš„å¹³æ–¹æ ¹ï¼Œä½¿å¾—æ¯ä¸ªå‚æ•°çš„å­¦ä¹ ç‡ä¸åŒè¿™ä¸ªå­¦ä¹ ç‡åœ¨ä¸€å¼€å§‹ä¼šæ¯”è¾ƒå¤§ï¼Œç”¨äºå¿«é€Ÿæ¢¯åº¦ä¸‹é™ã€‚éšç€ä¼˜åŒ–è¿‡ç¨‹çš„è¿›è¡Œï¼Œå¯¹äºå·²ç»ä¸‹é™å¾ˆå¤šçš„å˜é‡ï¼Œåˆ™å‡ç¼“å­¦ä¹ ç‡ï¼Œå¯¹äºè¿˜æ²¡æ€ä¹ˆä¸‹é™çš„å˜é‡ï¼Œåˆ™ä¿æŒä¸€ä¸ªè¾ƒå¤§çš„å­¦ä¹ ç‡å…¬å¼å…¶ä¸­$\eta$ä¸ºå­¦ä¹ ç‡ï¼Œè€Œ$\Delta L\left(w_{t}\right)$ä¸ºæŸå¤±å‡½æ•°çš„ä¸€é˜¶å¯¼æ•°ï¼Œ$\epsilon$æ˜¯ä¸€ä¸ªå¹³æ»‘é¡¹ï¼Œé¿å…äº†é™¤ä»¥é›¶(é€šå¸¸å–å€¼åœ¨$1e-8$å·¦å³)ï¼Œ$\odot$è¡¨ç¤ºå…ƒç´ é€å…ƒç´ ç›¸ä¹˜æ“ä½œ$G_{t+1}$å¯ä»¥å†™æˆä¸‹å¼ï¼Œæ¯ä¸ªå‚æ•°çš„æ‰€æœ‰åå¾®åˆ†çš„å¹³æ–¹å’Œï¼Œ$g_i$æ˜¯å¯¹æ¢¯åº¦çš„ç¼©å†™ä¼˜ç¼ºç‚¹ä¼˜ç‚¹ï¼šè‡ªé€‚åº”çš„å­¦ä¹ ç‡ï¼Œæ— éœ€äººå·¥è°ƒèŠ‚ï¼ŒAdaGradåœ¨è¿­ä»£è¿‡ç¨‹ä¸­ä¸æ–­è°ƒæ•´å­¦ä¹ ç‡ï¼Œå¹¶è®©ç›®æ ‡å‡½æ•°ä¸­çš„æ¯ä¸ªå‚æ•°éƒ½åˆ†åˆ«æ‹¥æœ‰è‡ªå·±çš„å­¦ä¹ ç‡ï¼Œå­¦ä¹ ç‡é»˜è®¤å€¼ä¸º0.01æœ‰æ•ˆåœ°å¤„ç†ç¨€ç–ç‰¹å¾ï¼Œå› ä¸ºå®ƒèƒ½å¤Ÿè‡ªåŠ¨è°ƒæ•´æ¯ä¸ªç‰¹å¾çš„å­¦ä¹ ç‡ï¼Œä½¿å¾—ç¨€ç–ç‰¹å¾çš„æ›´æ–°æ›´å°‘ç¼ºç‚¹ï¼šå…¨å±€å­¦ä¹ ç‡: ä»éœ€è¦æ‰‹å·¥è®¾ç½®ä¸€ä¸ªå…¨å±€å­¦ä¹ ç‡$\eta$, å¦‚æœ$\eta$è®¾ç½®è¿‡å¤§çš„è¯ï¼Œä¼šä½¿regularizerè¿‡äºæ•æ„Ÿï¼Œå¯¹æ¢¯åº¦çš„è°ƒèŠ‚å¤ªå¤§è®­ç»ƒåœæ­¢: ç”±äºæ¢¯åº¦å¹³æ–¹å’Œçš„ç´¯ç§¯ï¼Œå­¦ä¹ ç‡ä¼šä¸æ–­è¡°å‡ï¼Œå¯èƒ½å¯¼è‡´åœ¨è®­ç»ƒåæœŸå­¦ä¹ ç‡è¿‡å°ï¼Œé€ æˆæ”¶æ•›é€Ÿåº¦è¿‡æ…¢æˆ–è€…æå‰åœæ­¢è®­ç»ƒçš„é—®é¢˜(Adadeltaç®—æ³•è§£å†³)é™„ä¸Šåˆ«äººå†™çš„ä»£ç 123456def sgd_adagrad(parameters, sqrs, lr):    eps = 1e-10    for param, sqr in zip(parameters, sqrs):        sqr[:] = sqr + param.grad.data ** 2        div = lr / torch.sqrt(sqr + eps) * param.grad.data        param.data = param.data - divRMSPropAn overview of gradient descent optimization algorithms 2017RMSProp(Root Mean Square Propagation)æ˜¯Hintonå¤§ç¥äº2012å¹´åœ¨ä¸€é—¨å«Neural Networks for Machine Learningçš„åœ¨çº¿è¯¾ç¨‹ä¸­æå‡º(å¹¶æœªæ­£å¼å‘è¡¨)ï¼Œæ˜¯æ¢¯åº¦ä¸‹é™ä¼˜åŒ–ç®—æ³•çš„æ‰©å±•RMSPropå®é™…ä¸Šæ˜¯Adagradå¼•å…¥äº†Momentumï¼Œå…¬å¼è¡¨è¾¾å¦‚ä¸‹æ‰€ç¤º$\alpha$æ˜¯å­¦ä¹ ç‡ï¼Œ$\beta$åˆ™ç±»ä¼¼äºåŠ¨é‡æ¢¯åº¦ä¸‹é™æ³•ä¸­çš„è¡°å‡å› å­ï¼Œä»£è¡¨è¿‡å»æ¢¯åº¦å¯¹å½“å‰æ¢¯åº¦çš„å½±å“ï¼Œä¸€èˆ¬å–å€¼0.9ï¼Œ$\epsilon$æ˜¯ä¸€ä¸ªå¹³æ»‘é¡¹ï¼Œé¿å…äº†é™¤ä»¥é›¶(é€šå¸¸å–å€¼åœ¨$1e-8$å·¦å³)ï¼Œ$\odot$è¡¨ç¤ºå…ƒç´ é€å…ƒç´ ç›¸ä¹˜æ“ä½œ(ä¹Ÿå¯ä»¥çœç•¥ä¸å†™)å…¬å¼é‡Œçš„ç´¯ç§¯æ¢¯åº¦å¹³æ–¹å’Œ$G_{t+1}$å¯ä»¥å±•å¼€å†™æˆä¸‹é¢çš„å½¢å¼ï¼Œ$g_i$æ˜¯å¯¹æ¢¯åº¦çš„ç¼©å†™(åŒAdaGrad)ä¼˜ç‚¹ç¼ºç‚¹ä»£ç (å‚è€ƒæ–‡æ¡£)12345drad_squared = 0for _ in num_iterations:    dw = compute_gradients(x, y)    grad_squared = 0.9 * grads_squared + 0.1 * dx * dx    w = w - (lr / np.sqrt(grad_squared)) * dwAdadeltaä¼˜åŒ–å™¨(AdaGrad,AdaDelta,RmsProp,Adam,Nadam,Nesterovs,Sgd,momentum)AdaDeltaç®—æ³•ä¸¤ç§è§£å†³æ–¹æ¡ˆAdadelta ä¼˜åŒ–å™¨ç”±äºAdaGradè°ƒæ•´å­¦ä¹ ç‡å˜åŒ–è¿‡äºæ¿€è¿›ï¼Œæˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªæ”¹å˜äºŒé˜¶åŠ¨é‡è®¡ç®—æ–¹æ³•çš„ç­–ç•¥ï¼šä¸ç´¯ç§¯å…¨éƒ¨å†å²æ¢¯åº¦ï¼Œè€Œåªå…³æ³¨è¿‡å»ä¸€æ®µæ—¶é—´çª—å£çš„ä¸‹é™æ¢¯åº¦å³Adadeltaåªç´¯åŠ å›ºå®šå¤§å°çš„é¡¹ï¼Œå¹¶ä¸”ä¹Ÿä¸ç›´æ¥å­˜å‚¨è¿™äº›é¡¹ï¼Œä»…ä»…æ˜¯è¿‘ä¼¼è®¡ç®—å¯¹åº”çš„å¹³å‡å€¼(æŒ‡æ•°ç§»åŠ¨å¹³å‡å€¼)ï¼Œè¿™å°±é¿å…äº†äºŒé˜¶åŠ¨é‡æŒç»­ç´¯ç§¯ã€å¯¼è‡´è®­ç»ƒè¿‡ç¨‹æå‰ç»“æŸçš„é—®é¢˜äº†è®ºæ–‡ä¸­æåˆ°äº†ä¸¤ç§å®ç°ç­–ç•¥æ–¹æ³•ä¸€: Accumulate Over Windowä»å…¨éƒ¨å†å²æ¢¯åº¦å˜ä¸ºå½“å‰æ—¶é—´å‘å‰çš„ä¸€ä¸ªçª—å£æœŸå†…çš„ç´¯ç§¯ï¼Œè®¡ç®—å®šä¹‰ä¸ºç›¸å½“äºå†å²æ¢¯åº¦ä¿¡æ¯çš„ç´¯è®¡ä¹˜ä¸Šä¸€ä¸ªè¡°å‡ç³»æ•°$\rho$ï¼Œç„¶åç”¨$\rho$ä½œä¸ºå½“å‰æ¢¯åº¦çš„å¹³æ–¹åŠ æƒç³»æ•°ç›¸åŠ æ¢¯åº¦æ›´æ–°å…¬å¼ä¸ºè§£å†³äº†å¯¹å†å²æ¢¯åº¦ä¸€ç›´ç´¯åŠ è€Œå¯¼è‡´å­¦ä¹ ç‡ä¸€ç›´ä¸‹é™çš„é—®é¢˜æ–¹æ³•äºŒ: Correct Units with Hessian Approximationåœ¨1988å¹´LeCunç­‰äººæ›¾ç»æå‡ºä¸€ç§ç”¨çŸ©é˜µå¯¹è§’çº¿å…ƒç´ æ¥è¿‘ä¼¼é€†çŸ©é˜µdiagå‡½æ•°æŒ‡çš„æ˜¯æ„é€ HessiançŸ©é˜µçš„å¯¹è§’çŸ©é˜µï¼Œ$\mu$æ˜¯å¸¸æ•°é¡¹ï¼Œé˜²æ­¢åˆ†æ¯ä¸º0å¦‚æœå­¦è¿‡æ•°å€¼åˆ†æçš„åŒå­¦åº”è¯¥çŸ¥é“ï¼Œç‰›é¡¿æ³•ç”¨HessiançŸ©é˜µæ›¿ä»£äººå·¥è®¾ç½®çš„å­¦ä¹ ç‡ï¼Œåœ¨æ¢¯åº¦ä¸‹é™çš„æ—¶å€™ï¼Œå¯ä»¥å®Œç¾çš„æ‰¾å‡ºä¸‹é™æ–¹å‘ï¼Œä¸ä¼šé™·å…¥å±€éƒ¨æœ€å°å€¼å½“ä¸­ï¼Œæ˜¯ç†æƒ³çš„æ–¹æ³•ï¼Œä½†æ˜¯HessiançŸ©é˜µçš„é€†åœ¨æ•°æ®å¾ˆå¤§çš„æƒ…å†µä¸‹æ ¹æœ¬æ²¡åŠæ³•æ±‚2012å¹´ï¼Œ[Schaul&amp;S. Zhang&amp;LeCun]å€Ÿé‰´äº†AdaGradçš„åšæ³•ï¼Œæå‡ºäº†æ›´ç²¾ç¡®çš„è¿‘ä¼¼$E\left[g_{t-w: t}\right]$æŒ‡çš„æ˜¯ä»å½“å‰tå¼€å§‹çš„å‰wä¸ªæ¢¯åº¦çŠ¶æ€çš„æœŸæœ›å€¼$E\left[g_{t-w: t}^{2}\right]$æŒ‡çš„æ˜¯ä»å½“å‰tå¼€å§‹çš„å‰wä¸ªæ¢¯åº¦çŠ¶æ€çš„å¹³æ–¹çš„æœŸæœ›å€¼åŒæ ·æ˜¯åŸºäºGradientçš„Regularizerï¼Œä¸è¿‡åªå–æœ€è¿‘çš„wä¸ªçŠ¶æ€ï¼Œè¿™æ ·ä¸ä¼šè®©æ¢¯åº¦è¢«æƒ©ç½šè‡³0è¿™é‡Œå¦‚æœæ±‚æœŸæœ›çš„è¯ï¼Œéå¸¸çš„éº»çƒ¦ï¼Œæ‰€ä»¥é‡‡å–äº†ç§»åŠ¨å¹³å‡æ³•æ¥è®¡ç®—ã€‚è¿™é‡Œä½œè€…åœ¨è®ºæ–‡ä¸­ä¹Ÿç»™å‡ºäº†è¿‘ä¼¼çš„è¯æ˜è¿™é‡Œæ˜¯å½“ä¸ºæŒ‡æ•°å‹å‡½æ•°, æœ€åä¸€ä¸ªè¿‘ä¼¼æˆç«‹ã€‚ å¯¹äºç‰›é¡¿æ³•ï¼šç”±ä¸Šå¼å¯å¾—ï¼šåŸºä¸­:è¿™é‡Œå¯ä»¥ç”¨å±€éƒ¨çš„åŠ æƒæŒ‡æ•°å¹³æ»‘æ¥æ›¿ä»£ï¼Œå³ï¼šè¿™é‡Œçš„RMSè¡¨ç¤ºå‡æ–¹:å¯ä»¥å¾—åˆ°:æœ€åçš„æ›´æ–°å…¬å¼ä¸ºä¼˜ç‚¹æ— éœ€æ‰‹åŠ¨è®¾ç½®å­¦ä¹ ç‡ï¼šAdadeltaèƒ½å¤Ÿè‡ªé€‚åº”åœ°è°ƒæ•´å­¦ä¹ ç‡ï¼Œæ— éœ€æ‰‹åŠ¨è®¾ç½®è§£å†³äº†å­¦ä¹ ç‡è¡°å‡é—®é¢˜ï¼šç”±äºé‡‡ç”¨äº†è¡°å‡å¹³å‡çš„æ–¹å¼ï¼ŒAdadeltaèƒ½å¤Ÿè§£å†³å­¦ä¹ ç‡éšæ—¶é—´è¡°å‡è¿‡å¿«çš„é—®é¢˜ï¼Œä½¿å¾—æ¨¡å‹èƒ½å¤Ÿæ›´å¥½åœ°æ”¶æ•›ä¸ä¾èµ–å…¨å±€å­¦ä¹ ç‡ï¼šAdadeltaä¸éœ€è¦è®¾ç½®å…¨å±€å­¦ä¹ ç‡ï¼Œå› æ­¤å¯ä»¥é€‚åº”ä¸åŒå‚æ•°çš„å­¦ä¹ é€Ÿåº¦éœ€æ±‚å¯¹åˆå§‹å­¦ä¹ ç‡ä¸æ•æ„Ÿï¼šAdadeltaç›¸å¯¹äºå…¶ä»–ä¼˜åŒ–å™¨å¯¹åˆå§‹å­¦ä¹ ç‡çš„é€‰æ‹©å¹¶ä¸æ•æ„Ÿï¼Œä½¿å¾—æ¨¡å‹æ›´å…·é²æ£’æ€§ç¼ºç‚¹å­˜å‚¨é¢å¤–çš„çŠ¶æ€ä¿¡æ¯ï¼šAdadeltaéœ€è¦ä¿å­˜é¢å¤–çš„çŠ¶æ€ä¿¡æ¯(å¦‚æ¢¯åº¦å¹³æ–¹çš„ç´¯ç§¯)ï¼Œå¢åŠ äº†å­˜å‚¨çš„å¼€é”€ç®—æ³•å‚æ•°è¦è°ƒæ•´ï¼šAdadeltaä¸­çš„è¡°å‡ç³»æ•°$\rho$éœ€è¦è¿›è¡Œé€‚å½“çš„è°ƒæ•´ï¼Œä¸åŒä»»åŠ¡å¯èƒ½éœ€è¦ä¸åŒçš„è®¾ç½®AdamAdam(Adaptive Moment Estimation)è‡ªé€‚åº”çŸ©ä¼°è®¡ï¼Œæ˜¯å¦ä¸€ç§è‡ªé€‚åº”å­¦ä¹ ç‡çš„ç®—æ³•ï¼Œæœ¬è´¨ä¸Šæ˜¯å¸¦æœ‰åŠ¨é‡é¡¹çš„Adadeltaæˆ–RMSpropæ˜¯Diederik P. Kingmaç­‰äººåœ¨2014å¹´æå‡ºçš„ä¼˜åŒ–ç®—æ³•ï¼Œå¼•å…¥äº†ä¸¤ä¸ªå‚æ•°$\beta 1$å’Œ$\beta 2$æ€è·¯Adamä¸ä»…å¦‚RMSPropç®—æ³•é‚£æ ·åŸºäºä¸€é˜¶çŸ©å‡å€¼è®¡ç®—é€‚åº”æ€§å‚æ•°å­¦ä¹ ç‡ï¼Œå®ƒåŒæ—¶è¿˜å……åˆ†åˆ©ç”¨äº†æ¢¯åº¦çš„äºŒé˜¶çŸ©å‡å€¼(å³æœ‰åæ–¹å·®)ï¼Œé€‚åˆè§£å†³å«å¤§è§„æ¨¡çš„æ•°æ®å’Œå‚æ•°çš„ä¼˜åŒ–ç›®æ ‡ï¼Œä¹Ÿé€‚åˆè§£å†³åŒ…å«é«˜å™ªå£°æˆ–ç¨€ç–æ¢¯åº¦çš„é—®é¢˜ï¼Œè®©å‚æ•°æ›´æ–°æ—¶ä¿æŒç¨³å®šå…¶ä¸­$\beta _1$æ§åˆ¶ä¸€é˜¶åŠ¨é‡ï¼Œ$\beta _2$æ§åˆ¶äºŒé˜¶åŠ¨é‡æœ€ç»ˆçš„å‚æ•°æ›´æ–°å…¬å¼ä¸ºé»˜è®¤å€¼è®¾ç½®$\alpha=0.001 $ï¼Œ$ \beta 1=0.9 $ï¼Œ$ \beta 2=0.999 $ï¼Œ$ \varepsilon=10-8$ ä¼˜ç‚¹è‡ªé€‚åº”å­¦ä¹ ç‡ï¼šAdamé€šè¿‡è‡ªé€‚åº”åœ°è°ƒæ•´æ¯ä¸ªå‚æ•°çš„å­¦ä¹ ç‡ï¼Œå¯ä»¥æœ‰æ•ˆåœ°åº”å¯¹ä¸åŒå‚æ•°çš„æ¢¯åº¦å˜åŒ–æƒ…å†µã€‚è¿™ä½¿å¾—å®ƒåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­æ›´å®¹æ˜“æ”¶æ•›ï¼Œå¹¶ä¸”å¯¹äºå¤§å¤šæ•°ä»»åŠ¡å…·æœ‰è¾ƒå¥½çš„æ€§èƒ½ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯å®ƒçš„æ•ˆæœæœ‰æ—¶å€™ä¸å¦‚SGDMé€Ÿåº¦å¿«ï¼šAdamç»“åˆäº†åŠ¨é‡æ–¹æ³•ï¼Œèƒ½å¤Ÿåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ç§¯ç´¯æ¢¯åº¦çš„åŠ¨é‡ï¼Œä»è€ŒåŠ é€Ÿå‚æ•°æ›´æ–°çš„é€Ÿåº¦ï¼Œå°¤å…¶åœ¨å…·æœ‰å¹³å¦æˆ–ç¨€ç–æ¢¯åº¦çš„æƒ…å†µä¸‹æ›´åŠ æ˜æ˜¾ç»“åˆäº†Adagradå–„äºå¤„ç†ç¨€ç–æ¢¯åº¦å’ŒRMSpropå–„äºå¤„ç†éå¹³ç¨³ç›®æ ‡çš„ä¼˜ç‚¹é€‚ç”¨æ€§å¹¿æ³›ï¼šä¹Ÿé€‚ç”¨äºå¤§å¤šéå‡¸ä¼˜åŒ–ï¼Œé€‚ç”¨äºå¤§æ•°æ®é›†å’Œé«˜ç»´ç©ºé—´ç¼ºç‚¹å†…å­˜æ¶ˆè€—è¾ƒå¤§ï¼šAdaméœ€è¦å­˜å‚¨æ¯ä¸ªå‚æ•°çš„åŠ¨é‡å’Œå¹³æ–¹æ¢¯åº¦ä¼°è®¡ï¼Œè¿™ä¼šå ç”¨è¾ƒå¤§çš„å†…å­˜ç©ºé—´ï¼Œç‰¹åˆ«æ˜¯åœ¨å…·æœ‰å¤§é‡å‚æ•°çš„æ·±åº¦ç¥ç»ç½‘ç»œä¸­AdaMaxAdaMaxæ˜¯ä¸€ç§è‡ªé€‚åº”å­¦ä¹ ç‡ä¼˜åŒ–ç®—æ³•ï¼Œæ˜¯Adamä¼˜åŒ–å™¨çš„ä¸€ç§å˜ä½“AdaMaxä½¿ç”¨äº†æ¢¯åº¦çš„æ— ç©·èŒƒæ•°æ¥ä¼°è®¡æ¢¯åº¦çš„å¤§å°ï¼Œè€ŒAdamä½¿ç”¨äº†æ¢¯åº¦çš„äºŒèŒƒæ•°(æ ¸å¿ƒåŒºåˆ«)ï¼Œå˜åŒ–å¦‚ä¸‹æ‰€ç¤ºè®ºæ–‡ä¸­AdaMaxçš„$p= \infty$ä¸ºä»€ä¹ˆæ˜¯é€‰æ‹©äº†æ— ç©·èŒƒæ•°AdaMaxé€‰æ‹©äº†æ— ç©·èŒƒæ•°($\infty$èŒƒæ•°)æ˜¯å› ä¸ºåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œ$\infty$èŒƒæ•°å…·æœ‰ç¨³å®šçš„è¡Œä¸ºå¯¹äºä¸€äº›é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œ$\infty$èŒƒæ•°å¯ä»¥æä¾›æ›´å¥½çš„æ•°å€¼ç¨³å®šæ€§å’Œæ”¶æ•›æ€§ç›¸æ¯”äºå…¶ä»–èŒƒæ•°ï¼Œ$\infty$èŒƒæ•°èƒ½å¤Ÿæ›´å¥½åœ°æ§åˆ¶æ¢¯åº¦çš„æœ€å¤§å€¼ï¼Œä»è€Œå‡å°‘å‚æ•°æ›´æ–°çš„ä¸ç¨³å®šæ€§å› æ­¤ï¼ŒAdaMaxé€‰æ‹©äº†$\infty$èŒƒæ•°ä½œä¸ºå…¶æ›´æ–°è§„åˆ™çš„ä¸€éƒ¨åˆ†ï¼Œä»¥æé«˜ä¼˜åŒ–ç®—æ³•çš„ç¨³å®šæ€§å’Œæ•ˆæœNadamæ·±åº¦å­¦ä¹ ä¼˜åŒ–ç­–ç•¥NadamNadam(Nesterov-accelerated Adaptive Moment Estimation)æ˜¯å°†Adamä¸NesterovåŠ é€Ÿæ¢¯åº¦ç»“åˆåœ¨ä¸€èµ·ï¼Œå®ƒå¯¹å­¦ä¹ ç‡çš„çº¦æŸå°†æ›´å¼ºï¼Œå…·å¤‡äºŒè€…çš„ä¼˜åŠ¿ï¼Œä½¿å¾—æ­¤ç®—æ³•åœ¨æŸäº›é—®é¢˜ä¸Šçš„æ•ˆæœæ›´å¥½Nadamçš„æ›´æ–°è§„åˆ™ä¸Adamç±»ä¼¼ï¼Œä½†åœ¨è®¡ç®—æ¢¯åº¦æ›´æ–°æ—¶å¼•å…¥äº†NesterovåŠ¨é‡é¡¹ã€‚å…·ä½“è€Œè¨€ï¼ŒNadamåœ¨è®¡ç®—æ¢¯åº¦çš„ç§»åŠ¨å¹³å‡å’Œæ¢¯åº¦æ›´æ–°æ—¶ï¼Œä½¿ç”¨äº†NesterovåŠ¨é‡çš„ä¿®æ­£æ¢¯åº¦æ¥æ›´æ–°æ¨¡å‹å‚æ•°ã€‚è¿™ä½¿å¾—Nadamåœ¨å¤„ç†å‡¸ä¼˜åŒ–é—®é¢˜æ—¶èƒ½å¤Ÿæ›´å¥½åœ°é€¼è¿‘æœ€ä¼˜è§£ï¼Œå¹¶ä¸”åœ¨å¤„ç†éå‡¸é—®é¢˜æ—¶èƒ½å¤Ÿæ›´å¿«åœ°æ”¶æ•›å…¶ä»–ä¼˜åŒ–å™¨AdamWï¼ˆAdam with Weight Decayï¼‰ï¼š AdamWæ˜¯å¯¹Adamä¼˜åŒ–å™¨çš„æ”¹è¿›ï¼Œé€šè¿‡æ·»åŠ æƒé‡è¡°å‡ï¼ˆWeight Decayï¼‰çš„æ­£åˆ™åŒ–é¡¹æ¥è§£å†³æƒé‡è¡°å‡å¯¹Adamä¼˜åŒ–å™¨çš„å½±å“ã€‚ä¼ ç»Ÿçš„Adamä¼˜åŒ–å™¨åœ¨è®¡ç®—æ¢¯åº¦æ›´æ–°æ—¶ï¼Œä¼šå°†æƒé‡è¡°å‡é¡¹ä¹Ÿçº³å…¥æ¢¯åº¦è®¡ç®—ä¸­ï¼Œå¯¼è‡´æƒé‡è¡°å‡æ•ˆæœä¸å‡†ç¡®ã€‚è€ŒAdamWåœ¨è®¡ç®—æ¢¯åº¦æ›´æ–°æ—¶å°†æƒé‡è¡°å‡é¡¹å•ç‹¬å¤„ç†ï¼Œä½¿å¾—æƒé‡è¡°å‡çš„æ•ˆæœæ›´åŠ å‡†ç¡®å’Œç¨³å®šASGDï¼ˆAverage Stochastic Gradient Descentï¼‰ï¼š ASGDæ˜¯ä¸€ç§éšæœºæ¢¯åº¦ä¸‹é™æ³•çš„å˜ä½“ï¼Œå®ƒé€šè¿‡è®¡ç®—ä¸€å®šæ•°é‡çš„éšæœºæ¢¯åº¦çš„å¹³å‡å€¼æ¥æ›´æ–°æ¨¡å‹å‚æ•°ã€‚ASGDä½¿ç”¨ä¸€ä¸ªå¹³å‡æ¨¡å‹å‚æ•°çš„å†å²è®°å½•ï¼Œä»¥å‡å°è®­ç»ƒè¿‡ç¨‹ä¸­å‚æ•°æ›´æ–°çš„æ–¹å·®ã€‚è¿™æ ·å¯ä»¥ä½¿æ¨¡å‹çš„æ”¶æ•›é€Ÿåº¦æ›´ç¨³å®šï¼Œå¹¶ä¸”èƒ½å¤Ÿåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­é€æ¸å‡å°å­¦ä¹ ç‡ï¼Œä½¿å¾—æ¨¡å‹åœ¨è®­ç»ƒåæœŸæ›´åŠ è¶‹äºæ”¶æ•›LBFGSï¼ˆLimited-memory Broyden-Fletcher-Goldfarb-Shannoï¼‰ï¼š LBFGSæ˜¯ä¸€ç§åŸºäºæ‹Ÿç‰›é¡¿æ³•çš„ä¼˜åŒ–ç®—æ³•ï¼Œç”¨äºè§£å†³æ— çº¦æŸéçº¿æ€§ä¼˜åŒ–é—®é¢˜ã€‚å®ƒåˆ©ç”¨å‡½æ•°çš„ä¸€é˜¶å¯¼æ•°å’ŒäºŒé˜¶å¯¼æ•°ä¿¡æ¯æ¥é€¼è¿‘ç›®æ ‡å‡½æ•°çš„å±€éƒ¨äºŒæ¬¡æ¨¡å‹ï¼Œå¹¶é€šè¿‡è¿­ä»£æ›´æ–°å‚æ•°æ¥å¯»æ‰¾æœ€ä¼˜è§£ã€‚LBFGSä½¿ç”¨æœ‰é™çš„å†…å­˜æ¥å­˜å‚¨å†å²ä¿¡æ¯ï¼Œä»¥å‡å°‘å†…å­˜æ¶ˆè€—ã€‚ç”±äºå®ƒä¸éœ€è¦æ˜¾å¼è®¡ç®—äºŒé˜¶å¯¼æ•°çŸ©é˜µï¼ŒLBFGSé€‚ç”¨äºå‚æ•°è¾ƒå¤šçš„é—®é¢˜ï¼Œå¹¶ä¸”é€šå¸¸å…·æœ‰è¾ƒå¥½çš„æ”¶æ•›æ€§èƒ½æ€»ç»“ï¼šAdamWæ˜¯å¯¹Adamä¼˜åŒ–å™¨çš„æ”¹è¿›ï¼Œè§£å†³äº†æƒé‡è¡°å‡å¯¹Adamä¼˜åŒ–å™¨çš„å½±å“ASGDæ˜¯ä¸€ç§éšæœºæ¢¯åº¦ä¸‹é™æ³•çš„å˜ä½“ï¼Œé€šè¿‡å¹³å‡éšæœºæ¢¯åº¦æ¥å‡å°å‚æ•°æ›´æ–°çš„æ–¹å·®ï¼Œæé«˜æ”¶æ•›é€Ÿåº¦å’Œç¨³å®šæ€§LBFGSæ˜¯ä¸€ç§åŸºäºæ‹Ÿç‰›é¡¿æ³•çš„ä¼˜åŒ–ç®—æ³•ï¼Œé€šè¿‡é€¼è¿‘ç›®æ ‡å‡½æ•°çš„å±€éƒ¨äºŒæ¬¡æ¨¡å‹æ¥å¯»æ‰¾æœ€ä¼˜è§£ï¼Œå…·æœ‰è¾ƒå¥½çš„æ”¶æ•›æ€§èƒ½å’Œé€‚ç”¨æ€§å­¦ä¹ ç‡è¡°å‡åœ¨æ¨¡å‹ä¼˜åŒ–ä¸­ï¼Œå¸¸ç”¨åˆ°çš„å‡ ç§å­¦ä¹ ç‡è¡°å‡æ–¹æ³•æœ‰ï¼šåˆ†æ®µå¸¸æ•°è¡°å‡ã€å¤šé¡¹å¼è¡°å‡ã€æŒ‡æ•°è¡°å‡ã€è‡ªç„¶æŒ‡æ•°è¡°å‡ã€ä½™å¼¦è¡°å‡ã€çº¿æ€§ä½™å¼¦è¡°å‡ã€å™ªå£°çº¿æ€§ä½™å¼¦è¡°å‡æ·±åº¦å­¦ä¹ ä¼˜åŒ–å™¨æ–¹æ³•åŠå­¦ä¹ ç‡è¡°å‡æ–¹å¼ç»¼è¿°</content>
	</entry>
	<entry>
		<title>æ·±åº¦å­¦ä¹ æ ¸å¿ƒä¹‹æŸå¤±å‡½æ•°</title>
		<url>/article/46832.html</url>
		<content>æ¦‚è¿°ä¸€æ–‡çœ‹å°½æ·±åº¦å­¦ä¹ ä¸­çš„å„ç§æŸå¤±å‡½æ•°å¸¸ç”¨çš„æŸå¤±å‡½æ•°åˆé›†æ·±åº¦å­¦ä¹ å¸¸ç”¨æŸå¤±å‡½æ•°çš„åŸºæœ¬å½¢å¼ã€åŸç†åŠç‰¹ç‚¹Loss FunctionsæŸå¤±å‡½æ•°(Loss Function)æ˜¯ç”¨æ¥è¡¡é‡æ¨¡å‹é¢„æµ‹å€¼ä¸çœŸå®å€¼ä¹‹é—´å·®å¼‚çš„å‡½æ•°ï¼Œå®ƒæ˜¯æ·±åº¦å­¦ä¹ ä¸­çš„ä¸€ä¸ªé‡è¦ç»„æˆéƒ¨åˆ†ï¼Œç”¨äºè¯„ä¼°æ¨¡å‹çš„æ€§èƒ½å¹¶æŒ‡å¯¼æ¨¡å‹çš„ä¼˜åŒ–è¿‡ç¨‹æŸå¤±å‡½æ•°ã€ä»£ä»·å‡½æ•°ã€ç›®æ ‡å‡½æ•°çš„å…³ç³»æŸå¤±å‡½æ•°(Loss Function)ï¼šæŸå¤±å‡½æ•°æ˜¯ç”¨æ¥è¡¡é‡æ¨¡å‹åœ¨å•ä¸ªæ ·æœ¬ä¸Šçš„é¢„æµ‹ç»“æœä¸çœŸå®æ ‡ç­¾ä¹‹é—´çš„å·®å¼‚ã€‚å®ƒæ˜¯ä¸€ä¸ªæ ‡é‡å€¼ï¼Œè¡¨ç¤ºæ¨¡å‹é¢„æµ‹çš„è¯¯å·®æˆ–æŸå¤±ç¨‹åº¦ã€‚æŸå¤±å‡½æ•°é€šå¸¸æ˜¯é’ˆå¯¹å•ä¸ªæ ·æœ¬è®¡ç®—çš„ï¼Œä¾‹å¦‚å‡æ–¹è¯¯å·®(MSE)ã€äº¤å‰ç†µæŸå¤±ç­‰ã€‚åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œé€šè¿‡æœ€å°åŒ–æŸå¤±å‡½æ•°æ¥ä¼˜åŒ–æ¨¡å‹å‚æ•°ï¼Œä½¿æ¨¡å‹çš„é¢„æµ‹ç»“æœä¸çœŸå®æ ‡ç­¾æ›´æ¥è¿‘ä»£ä»·å‡½æ•°(Cost Function)ï¼šä»£ä»·å‡½æ•°æ˜¯æŒ‡æ•´ä¸ªè®­ç»ƒé›†ä¸Šçš„å¹³å‡æŸå¤±æˆ–è¯¯å·®å‡½æ•°ã€‚ä»£ä»·å‡½æ•°æ˜¯æŸå¤±å‡½æ•°çš„æ±‚å’Œæˆ–å¹³å‡ï¼Œç”¨äºè¡¡é‡æ¨¡å‹åœ¨æ•´ä¸ªè®­ç»ƒé›†ä¸Šçš„é¢„æµ‹ç»“æœä¸çœŸå®æ ‡ç­¾ä¹‹é—´çš„æ€»ä½“å·®å¼‚ã€‚ä»£ä»·å‡½æ•°é€šå¸¸æ˜¯åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä½¿ç”¨çš„ï¼Œç”¨äºè®¡ç®—æ¢¯åº¦å¹¶æ›´æ–°æ¨¡å‹å‚æ•°ç›®æ ‡å‡½æ•°(Objective Function)ï¼šç›®æ ‡å‡½æ•°æ˜¯åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­è¦æœ€å°åŒ–æˆ–æœ€å¤§åŒ–çš„å‡½æ•°ï¼Œå¯ä»¥æ˜¯æŸå¤±å‡½æ•°æˆ–ä»£ä»·å‡½æ•°ã€‚ç›®æ ‡å‡½æ•°æ˜¯æ¨¡å‹è®­ç»ƒçš„ç›®æ ‡ï¼Œé€šè¿‡ä¼˜åŒ–ç›®æ ‡å‡½æ•°æ¥è°ƒæ•´æ¨¡å‹å‚æ•°ï¼Œä½¿å¾—æ¨¡å‹åœ¨è®­ç»ƒé›†ä¸Šçš„æ€§èƒ½è¾¾åˆ°æœ€ä¼˜å®šä¹‰æŸå¤±å‡½æ•°(Loss Function)ä»£ä»·å‡½æ•°(Cost Function)ç›®æ ‡å‡½æ•°(Objective Function)æ•°æ®é›†å•ä¸ªæ ·æœ¬æ•´ä¸ªè®­ç»ƒé›†è®­ç»ƒè¦ä¼˜åŒ–å‡½æ•°åœ¨å®é™…åº”ç”¨ä¸­ï¼ŒæŸå¤±å‡½æ•°ã€ä»£ä»·å‡½æ•°å’Œç›®æ ‡å‡½æ•°è¿™äº›æœ¯è¯­æœ‰æ—¶ä¼šè¢«æ··ç”¨ï¼Œä½†å®ƒä»¬éƒ½æ¶‰åŠåˆ°è¡¡é‡æ¨¡å‹çš„é¢„æµ‹ç»“æœä¸çœŸå®æ ‡ç­¾ä¹‹é—´çš„å·®å¼‚ï¼Œå¹¶åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ç”¨äºä¼˜åŒ–æ¨¡å‹æŸå¤±å‡½æ•°å¤§è‡´å¯åˆ†ä¸ºä¸¤ç§ï¼šå›å½’æŸå¤±(é’ˆå¯¹è¿ç»­å‹å˜é‡)å’Œåˆ†ç±»æŸå¤±(é’ˆå¯¹ç¦»æ•£å‹å˜é‡)å…·ä½“ä½¿ç”¨å“ªä¸ªæœ¯è¯­å–å†³äºä¸Šä¸‹æ–‡å’Œä¸ªäººåå¥½ï¼Œä½†å®ƒä»¬éƒ½æŒ‡å‘ç±»ä¼¼çš„æ¦‚å¿µå›å½’æŸå¤±å‡½æ•°æ·±åº¦å­¦ä¹ å¸¸ç”¨æŸå¤±å‡½æ•°æ€»è§ˆï¼šåŸºæœ¬å½¢å¼ã€åŸç†ã€ç‰¹ç‚¹L1 LossL1 Lossä¹Ÿç§°ä¸ºMean Absolute Errorï¼Œå³å¹³å‡ç»å¯¹è¯¯å·®(MAE)ï¼Œå…¬å¼å®šä¹‰ä¸ºä¼˜ç‚¹: å¯¹ç¦»ç¾¤ç‚¹(Outliers)æˆ–è€…å¼‚å¸¸å€¼æ›´å…·æœ‰é²æ£’æ€§ç¼ºç‚¹: ç”±å›¾å¯çŸ¥å…¶åœ¨0ç‚¹å¤„çš„å¯¼æ•°ä¸è¿ç»­ï¼Œä½¿å¾—æ±‚è§£æ•ˆç‡ä½ä¸‹ï¼Œå¯¼è‡´æ”¶æ•›é€Ÿåº¦æ…¢ï¼›å¯¹äºè¾ƒå°çš„æŸå¤±å€¼ï¼Œå…¶æ¢¯åº¦ä¹ŸåŒå…¶ä»–åŒºé—´æŸå¤±å€¼çš„æ¢¯åº¦ä¸€æ ·å¤§ï¼Œæ‰€ä»¥ä¸åˆ©äºç½‘ç»œçš„å­¦ä¹ æ¨¡å‹é¢„æµ‹ä¸çœŸå®å€¼ä¹‹é—´çš„è¯¯å·®æœä»æ‹‰æ™®æ‹‰æ–¯åˆ†å¸ƒLaplace distributionå¯ä»¥åœ¨ä¸€å®šçš„å‡è®¾ä¸‹é€šè¿‡æœ€å¤§åŒ–ä¼¼ç„¶å¯ä»¥å¾—åˆ°MAEæŸå¤±çš„å½¢å¼ï¼Œå‡è®¾æ¨¡å‹é¢„æµ‹ä¸çœŸå®å€¼ä¹‹é—´çš„è¯¯å·®æœä»æ‹‰æ™®æ‹‰æ–¯åˆ†å¸ƒLaplace distribution $(\mu=0, b=1)$ï¼Œåˆ™ç»™å®šä¸€ä¸ªè¾“å…¥ï¼Œæ¨¡å‹è¾“å‡ºçœŸå®å€¼çš„æ¦‚ç‡ä¸ºå¯¹å…¶æ±‚å¯¹æ•°å¯ä»¥å¾—åˆ°çš„è´Ÿå¯¹æ•°ä¼¼ç„¶å®é™…ä¸Šå°±æ˜¯MAEæŸå¤±çš„å½¢å¼L2 LossL2 Lossä¹Ÿç§°ä¸ºMean Squred Errorï¼Œå³å‡æ–¹å·®(MSE)ï¼Œå®ƒè¡¡é‡çš„æ˜¯é¢„æµ‹å€¼ä¸çœŸå®å€¼ä¹‹é—´è·ç¦»çš„å¹³æ–¹å’Œä¼˜ç‚¹: æ”¶æ•›é€Ÿåº¦å¿«ï¼Œèƒ½å¤Ÿå¯¹æ¢¯åº¦ç»™äºˆåˆé€‚çš„æƒ©ç½šæƒé‡ï¼Œè€Œä¸æ˜¯ä¸€è§†åŒä»ï¼Œä½¿æ¢¯åº¦æ›´æ–°çš„æ–¹å‘å¯ä»¥æ›´åŠ ç²¾ç¡®ç¼ºç‚¹: å¯¹å¼‚å¸¸å€¼ååˆ†æ•æ„Ÿï¼Œæ¢¯åº¦æ›´æ–°çš„æ–¹å‘å¾ˆå®¹æ˜“å—ç¦»ç¾¤ç‚¹æ‰€ä¸»å¯¼ï¼Œä¸å…·å¤‡é²æ£’æ€§ï¼Œå‡å¦‚æˆ‘ä»¬è®­ç»ƒæ•°æ®ä¸­å­˜åœ¨è¾ƒå¤§çš„å¼‚å¸¸å€¼ï¼Œæ­¤æ—¶æˆ‘ä»¬å°†ä¼šæœ‰ä¸€ä¸ªå·¨å¤§çš„æƒé‡æ›´æ–°ï¼Œè¿™æœ‰å¯èƒ½ä¼šä½¿æ¨¡å‹å¤±å»å¹³è¡¡åœ¨æ¨¡å‹è¾“å‡ºä¸çœŸå®å€¼çš„è¯¯å·®æœä»é«˜æ–¯åˆ†å¸ƒçš„å‡è®¾ä¸‹ï¼Œæœ€å°åŒ–å‡æ–¹å·®æŸå¤±å‡½æ•°ä¸æå¤§ä¼¼ç„¶ä¼°è®¡æœ¬è´¨ä¸Šæ˜¯ä¸€è‡´çš„MSEå‡è®¾äº†è¯¯å·®æœä»é«˜æ–¯åˆ†å¸ƒï¼Œåœ¨é«˜æ–¯åˆ†å¸ƒå‡è®¾ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨æœ€å¤§åŒ–ä¼¼ç„¶å¾—åˆ°å‡æ–¹å·®æŸå¤±çš„å½¢å¼ï¼Œå‡è®¾æ¨¡å‹é¢„æµ‹ä¸çœŸå®å€¼ä¹‹é—´çš„è¯¯å·®æœä»æ ‡å‡†é«˜æ–¯åˆ†å¸ƒ$(\mu=0, \sigma=1)$ï¼Œåˆ™ç»™å®šä¸€ä¸ªè¾“å…¥ï¼Œæ¨¡å‹è¾“å‡ºçœŸå®å€¼çš„æ¦‚ç‡ä¸ºè¿›ä¸€æ­¥æˆ‘ä»¬å‡è®¾æ•°æ®é›†ä¸­$\mathrm{N}$ä¸ªæ ·æœ¬ç‚¹ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œåˆ™ç»™å®šæ‰€æœ‰$x$è¾“å‡ºæ‰€æœ‰çœŸå®å€¼$y$çš„æ¦‚ç‡ï¼Œå³ä¼¼ç„¶Likelihoodä¸ºæ‰€æœ‰çš„ç´¯ä¹˜é€šå¸¸ä¸ºäº†è®¡ç®—æ–¹ä¾¿ï¼Œæˆ‘ä»¬é€šå¸¸æœ€å¤§åŒ–å¯¹æ•°ä¼¼ç„¶Log-Likelihoodå»æ‰ä¸$\hat{y}_{i}$æ— å…³çš„ç¬¬ä¸€é¡¹ï¼Œç„¶åè½¬åŒ–ä¸ºæœ€å°åŒ–è´Ÿå¯¹æ•°ä¼¼ç„¶Negative Log-Likelihoodå¯ä»¥çœ‹åˆ°è¿™ä¸ªå®é™…ä¸Šå°±æ˜¯å‡æ–¹å·®æŸå¤±çš„å½¢å¼ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨æ¨¡å‹è¾“å‡ºä¸çœŸå®å€¼çš„è¯¯å·®æœä»é«˜æ–¯åˆ†å¸ƒçš„å‡è®¾ä¸‹ï¼Œæœ€å°åŒ–å‡æ–¹å·®æŸå¤±å‡½æ•°ä¸æå¤§ä¼¼ç„¶ä¼°è®¡æœ¬è´¨ä¸Šæ˜¯ä¸€è‡´çš„å› æ­¤åœ¨è¿™ä¸ªå‡è®¾èƒ½è¢«æ»¡è¶³çš„åœºæ™¯ä¸­(æ¯”å¦‚å›å½’)ï¼Œå‡æ–¹å·®æŸå¤±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æŸå¤±å‡½æ•°é€‰æ‹©å½“è¿™ä¸ªå‡è®¾æ²¡èƒ½è¢«æ»¡è¶³çš„åœºæ™¯ä¸­(æ¯”å¦‚åˆ†ç±»)ï¼Œå‡æ–¹å·®æŸå¤±ä¸æ˜¯ä¸€ä¸ªå¥½çš„é€‰æ‹©MAEå’ŒMSEä½œä¸ºæŸå¤±å‡½æ•°çš„ä¸»è¦åŒºåˆ«æ˜¯MSEæŸå¤±ç›¸æ¯”MAEé€šå¸¸å¯ä»¥æ›´å¿«åœ°æ”¶æ•›å½“ä½¿ç”¨æ¢¯åº¦ä¸‹é™ç®—æ³•æ—¶ï¼ŒMSEçš„æ¢¯åº¦ä¸ºï¼Œè€ŒMAEæŸå¤±çš„æ¢¯åº¦ä¸ºï¼Œå³MSEçš„æ¢¯åº¦çš„scaleä¼šéšè¯¯å·®å¤§å°å˜åŒ–ï¼Œè€ŒMAEçš„æ¢¯åº¦çš„scaleåˆ™ä¸€ç›´ä¿æŒä¸º1ï¼Œå³ä¾¿åœ¨ç»å¯¹è¯¯å·®å¾ˆå°çš„æ—¶å€™ï¼ŒMAEçš„æ¢¯åº¦scaleä¹ŸåŒæ ·ä¸º1ï¼Œè¿™å®é™…ä¸Šæ˜¯éå¸¸ä¸åˆ©äºæ¨¡å‹çš„è®­ç»ƒçš„å½“ç„¶ä½ å¯ä»¥é€šè¿‡åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­åŠ¨æ€è°ƒæ•´å­¦ä¹ ç‡ç¼“è§£è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯æ€»çš„æ¥è¯´ï¼ŒæŸå¤±å‡½æ•°æ¢¯åº¦ä¹‹é—´çš„å·®å¼‚å¯¼è‡´äº†MSEåœ¨å¤§éƒ¨åˆ†æ—¶å€™æ¯”MAEæ”¶æ•›åœ°æ›´å¿«ï¼Œè¿™ä¹Ÿæ˜¯MSEæ›´ä¸ºæµè¡Œçš„åŸå› MAEæŸå¤±å¯¹äºoutlieræ›´åŠ å¥å£®ï¼Œå³æ›´åŠ ä¸æ˜“å—åˆ°outlierå½±å“ï¼Œå½“è¯¯å·®éå¸¸å¤§çš„æ—¶å€™ï¼ŒMSEæŸå¤±ä¼šè¿œè¿œå¤§äºMAEæŸå¤±MSEå‡è®¾äº†è¯¯å·®æœä»é«˜æ–¯åˆ†å¸ƒï¼ŒMAEå‡è®¾äº†è¯¯å·®æœä»æ‹‰æ™®æ‹‰æ–¯åˆ†å¸ƒï¼Œæ‹‰æ™®æ‹‰æ–¯åˆ†å¸ƒæœ¬èº«å¯¹äºoutlieræ›´åŠ robusté€‚ç”¨åœºæ™¯Smooth L1 Losspytorch SMOOTHL LOSSSmooth L1 Losså³å¹³æ»‘çš„L1æŸå¤±(SLL)ï¼Œå‡ºè‡ªFast RCNNï¼Œä¹Ÿç§°ä¸ºSLLï¼ŒSmooth L1 lossä¹Ÿå…·å¤‡äº†L1 losså’ŒL2 losså„è‡ªçš„ä¼˜ç‚¹ï¼Œæœ¬è´¨å°±æ˜¯L1å’ŒL2çš„ç»„åˆHuber Losspytorch Huber LOSSHuber Lossæ˜¯ä¸€ç§ç±»ä¼¼äºSmooth L1 Lossçš„æŸå¤±å‡½æ•°ï¼Œå®ƒä¹Ÿèƒ½å¤Ÿå¹³è¡¡L2èŒƒæ•°å’ŒL1èŒƒæ•°ä¹‹é—´çš„æƒè¡¡Huber losså’ŒSmooth L1 losså…·æœ‰ç›¸åŒçš„æ›²çº¿èµ°åŠ¿ï¼Œå½“Huber lossä¸­çš„Î´ç­‰äº1æ—¶ï¼ŒHuber lossç­‰ä»·äºSmooth L1 losså¯¹äºHuberæŸå¤±æ¥è¯´ï¼Œ$\delta$çš„é€‰æ‹©ååˆ†é‡è¦ï¼Œå®ƒå†³å®šäº†æ¨¡å‹å¤„ç†å±€å¤–ç‚¹çš„è¡Œä¸ºã€‚å½“æ®‹å·®å¤§äº$\delta$æ—¶ä½¿ç”¨L1æŸå¤±ï¼Œå¾ˆå°æ—¶åˆ™ä½¿ç”¨æ›´ä¸ºåˆé€‚çš„L2æŸå¤±æ¥è¿›è¡Œä¼˜åŒ–ä¼˜ç‚¹é›¶ç‚¹å¯¼æ•°è¿ç»­: HuberæŸå¤±å‡½æ•°å…‹æœäº†MAEå’ŒMSEçš„ç¼ºç‚¹ï¼Œä¸ä»…å¯ä»¥ä¿æŒæŸå¤±å‡½æ•°å…·æœ‰è¿ç»­çš„å¯¼æ•°è§£å†³ç¦»ç¾¤ç‚¹æ¢¯åº¦çˆ†ç‚¸çš„é—®é¢˜: åˆ©ç”¨MSEæ¢¯åº¦éšè¯¯å·®å‡å°çš„ç‰¹æ€§æ¥å¾—åˆ°æ›´ç²¾ç¡®çš„æœ€å°å€¼ï¼Œä¹Ÿå¯¹å±€å¤–ç‚¹å…·æœ‰æ›´å¥½çš„é²æ£’æ€§ä½†HuberæŸå¤±å‡½æ•°çš„è‰¯å¥½è¡¨ç°å¾—ç›Šäºç²¾å¿ƒè®­ç»ƒçš„è¶…å‚æ•°$\delta$ï¼Œå½“$\delta$è¶‹å‘äº0æ—¶å®ƒå°±é€€åŒ–æˆäº†MAEï¼Œè€Œå½“$\delta$è¶‹å‘äºæ— ç©·æ—¶åˆ™é€€åŒ–ä¸ºäº†MSEQuantile Lossåˆ†ä½æ•°å›å½’Quantile Regressionæ˜¯ä¸€ç±»åœ¨å®é™…åº”ç”¨ä¸­éå¸¸æœ‰ç”¨çš„å›å½’ç®—æ³•ï¼Œé€šå¸¸çš„å›å½’ç®—æ³•æ˜¯æ‹Ÿåˆç›®æ ‡å€¼çš„æœŸæœ›æˆ–è€…ä¸­ä½æ•°ï¼Œè€Œåˆ†ä½æ•°å›å½’å¯ä»¥é€šè¿‡ç»™å®šä¸åŒçš„åˆ†ä½ç‚¹ï¼Œæ‹Ÿåˆç›®æ ‡å€¼çš„ä¸åŒåˆ†ä½æ•°IoU LossUnitBox: An Advanced Object Detection Network 2016åˆ†ç±»æŸå¤±å‡½æ•°Binary Cross Entropyç®€å•çš„äº¤å‰ç†µæŸå¤±å‡½æ•°ï¼Œä½ çœŸçš„æ‡‚äº†å—å¯¹äºåˆ†ç±»é—®é¢˜ï¼Œæœ€å¸¸ç”¨çš„æŸå¤±å‡½æ•°æ˜¯äº¤å‰ç†µæŸå¤±å‡½æ•°Cross Entropy Lossè€ƒè™‘äºŒåˆ†ç±»ï¼Œåœ¨äºŒåˆ†ç±»ä¸­æˆ‘ä»¬é€šå¸¸ä½¿ç”¨Sigmoidå‡½æ•°å°†æ¨¡å‹çš„è¾“å‡ºå‹ç¼©åˆ°$(0,1)$åŒºé—´å†…ï¼Œç”¨æ¥ä»£è¡¨ç»™å®šè¾“å…¥ï¼Œæ¨¡å‹åˆ¤æ–­ä¸ºæ­£ç±»çš„æ¦‚ç‡ç”±äºåªæœ‰æ­£è´Ÿä¸¤ç±»ï¼Œ å› æ­¤åŒæ—¶ä¹Ÿå¾—åˆ°äº†è´Ÿç±»çš„æ¦‚ç‡å°†ä¸¤æ¡å¼å­åˆå¹¶æˆä¸€æ¡å‡è®¾æ•°æ®ç‚¹ä¹‹é—´ç‹¬ç«‹åŒåˆ†å¸ƒï¼Œåˆ™ä¼¼ç„¶å¯ä»¥è¡¨ç¤ºä¸ºå¯¹ä¼¼ç„¶å–å¯¹æ•°ï¼Œç„¶ååŠ è´Ÿå·å˜æˆæœ€å°åŒ–è´Ÿå¯¹æ•°ä¼¼ç„¶ï¼Œå³ä¸ºäº¤å‰ç†µæŸå¤±å‡½æ•°çš„å½¢å¼å¯è§†åŒ–ä¸‹å›¾æ˜¯å¯¹äºŒåˆ†ç±»çš„äº¤å‰ç†µæŸå¤±å‡½æ•°çš„å¯è§†åŒ–ï¼Œè“çº¿æ˜¯ç›®æ ‡å€¼ä¸º0æ—¶è¾“å‡ºä¸åŒè¾“å‡ºçš„æŸå¤±ï¼Œé»„çº¿æ˜¯ç›®æ ‡å€¼ä¸º1æ—¶çš„æŸå¤±å¯ä»¥çœ‹åˆ°çº¦æ¥è¿‘ç›®æ ‡å€¼æŸå¤±è¶Šå°ï¼Œéšç€è¯¯å·®å˜å·®ï¼ŒæŸå¤±å‘ˆæŒ‡æ•°å¢é•¿å›¾ä¸­è“çº¿æ˜¯$y_i=0$çš„å›¾çº¿ï¼Œæ­¤æ—¶æŸå¤±å‡½æ•°å˜ä¸ºå›¾ä¸­é»„çº¿æ˜¯$y_i=1$çš„å›¾çº¿ï¼Œæ­¤æ—¶æŸå¤±å‡½æ•°å˜ä¸ºä»å›¾å½¢ä¸­æˆ‘ä»¬å¯ä»¥å‘ç°ï¼šé¢„æµ‹è¾“å‡ºä¸$y$å·®å¾—è¶Šå¤šï¼Œ$J_{CE}$çš„å€¼è¶Šå¤§ï¼Œä¹Ÿå°±æ˜¯è¯´å¯¹å½“å‰æ¨¡å‹çš„æƒ©ç½šè¶Šå¤§ï¼Œè€Œä¸”æ˜¯éçº¿æ€§å¢å¤§ï¼Œæ˜¯ä¸€ç§ç±»ä¼¼æŒ‡æ•°å¢é•¿çš„çº§åˆ«è¿™æ˜¯ç”±logå‡½æ•°æœ¬èº«çš„ç‰¹æ€§æ‰€å†³å®šçš„ï¼Œè¿™æ ·çš„å¥½å¤„æ˜¯æ¨¡å‹ä¼šå€¾å‘äºè®©é¢„æµ‹è¾“å‡ºæ›´æ¥è¿‘çœŸå®æ ·æœ¬æ ‡ç­¾$y$Cross Entropy Lossäº¤å‰ç†µæŸå¤±å‡½æ•°ï¼ˆCrossEntropy Lossï¼‰åœ¨å¤šåˆ†ç±»çš„ä»»åŠ¡ä¸­ï¼Œäº¤å‰æ¨€æŸå¤±å‡½æ•°çš„æ¨å¯¼æ€è·¯å’ŒäºŒåˆ†ç±»æ˜¯ä¸€æ ·çš„ï¼Œå˜åŒ–çš„åœ°æ–¹ä¸»è¦æœ‰ä¸¤ä¸ªç»´åº¦å˜åŒ–: çœŸå®å€¼$y_{i}$ç°åœ¨æ˜¯ä¸€ä¸ªone-hotå‘é‡æ¿€æ´»å‡½æ•°: æ¨¡å‹è¾“å‡ºçš„æœ€åçš„æ¿€æ´»å‡½æ•°ç”±åŸæ¥çš„Sigmoidå‡½æ•°æ¢æˆSoftmaxå‡½æ•°ä¸ºä»€ä¹ˆåˆ†ç±»ç”¨äº¤å‰ç†µæŸå¤±ï¼Œè€Œä¸æ˜¯å‡æ–¹å·®æŸå¤±å‡æ–¹å·®æŸå¤±å®é™…ä¸Šå‡æ–¹å·®æŸå¤±å‡è®¾äº†è¯¯å·®æœä»é«˜æ–¯åˆ†å¸ƒï¼Œåœ¨åˆ†ç±»ä»»åŠ¡ä¸‹è¿™ä¸ªå‡è®¾æ²¡åŠæ³•è¢«æ»¡è¶³ï¼Œå› æ­¤æ•ˆæœä¼šå¾ˆå·®ä¸ºä»€ä¹ˆæ˜¯äº¤å‰ç†µæŸå¤±å‘¢? æœ‰ä¸¤ä¸ªè§’åº¦å¯ä»¥è§£é‡Šè¿™ä¸ªäº‹æƒ…ï¼Œä¸€ä¸ªè§’åº¦ä»æœ€å¤§ä¼¼ç„¶çš„è§’åº¦ï¼Œå¦ä¸€ä¸ªè§’åº¦æ˜¯å¯ä»¥ç”¨ä¿¡æ¯è®ºæ¥è§£é‡Šäº¤å‰ç†µæŸå¤±æœ€å¤§ä¼¼ç„¶è§’åº¦Softmaxå‡½æ•°å°†æ¯ä¸ªç»´åº¦çš„è¾“å‡ºèŒƒå›´éƒ½é™å®šåœ¨$(0,1)$ä¹‹é—´ï¼ŒåŒæ—¶æ‰€æœ‰ç»´åº¦çš„è¾“å‡ºå’Œä¸º1ï¼Œç”¨äºè¡¨ç¤ºä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒå…¶ä¸­$k \in K$è¡¨ç¤º$\mathrm{K}$ä¸ªç±»åˆ«ä¸­çš„ä¸€ç±»ï¼ŒåŒæ ·çš„å‡è®¾æ•°æ®ç‚¹ä¹‹é—´ç‹¬ç«‹åŒåˆ†å¸ƒï¼Œå¯å¾—åˆ°è´Ÿå¯¹æ•°ä¼¼ç„¶ä¸ºç”±äº$y_{i}$æ˜¯ä¸€ä¸ªone-hotå‘é‡ï¼Œé™¤äº†ç›®æ ‡ç±»ä¸º1ä¹‹å¤–å…¶ä»–ç±»åˆ«ä¸Šçš„è¾“å‡ºéƒ½ä¸º0ï¼Œå› æ­¤ä¸Šå¼ä¹Ÿå¯ä»¥å†™ä¸ºå…¶ä¸­æ˜¯æ ·æœ¬çš„ç›®æ ‡ç±»ã€‚é€šå¸¸è¿™ä¸ªåº”ç”¨äºå¤šåˆ†ç±»çš„äº¤å‰æ¨€æŸå¤±å‡½æ•°ä¹Ÿè¢«ç§°ä¸ºSoftmax Lossæˆ–è€…Categorical Cross Entropy Lossä¿¡æ¯è®ºè§’åº¦å‡è®¾å¯¹äºæ ·æœ¬å­˜åœ¨ä¸€ä¸ªæœ€ä¼˜åˆ†å¸ƒçœŸå®åœ°è¡¨æ˜äº†è¿™ä¸ªæ ·æœ¬å±äºå„ä¸ªç±»åˆ«çš„æ¦‚ç‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¸Œæœ›æ¨¡å‹çš„è¾“å‡ºå°½å¯èƒ½åœ°é€¼è¿‘è¿™ä¸ªæœ€ä¼˜åˆ†å¸ƒåœ¨ä¿¡æ¯è®ºä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨KLæ•£åº¦(Kullback-Leibler Divergence)æ¥è¡¡é‡ä¸¤ä¸ªåˆ†å¸ƒçš„ç›¸ä¼¼æ€§ç»™å®šåˆ†å¸ƒ$p$å’Œåˆ†å¸ƒ$q$ï¼Œä¸¤è€…çš„KLæ•£åº¦å…¬å¼å¦‚ä¸‹å…¶ä¸­ç¬¬ä¸€é¡¹ä¸ºåˆ†å¸ƒçš„ä¿¡æ¯ç†µï¼Œç¬¬äºŒé¡¹ä¸ºåˆ†å¸ƒå’Œçš„äº¤å‰ç†µã€‚å°†æœ€ä¼˜åˆ†å¸ƒå’Œè¾“å‡ºåˆ†å¸ƒå¸¦å…¥å’Œå¾—åˆ°ç”±äºæˆ‘ä»¬å¸Œæœ›ä¸¤ä¸ªåˆ†å¸ƒå°½é‡ç›¸è¿‘ï¼Œå› æ­¤æˆ‘ä»¬æœ€å°åŒ–KLæ•£åº¦ã€‚åŒæ—¶ç”±äºä¸Šå¼ç¬¬ä¸€é¡¹ä¿¡æ¯ç†µä»…ä¸æœ€ä¼˜åˆ†å¸ƒæœ¬èº«ç›¸å…³ï¼Œå› æ­¤æˆ‘ä»¬åœ¨æœ€å°åŒ–çš„è¿‡ç¨‹ä¸­å¯ä»¥å¿½ç•¥æ‰ï¼Œå˜æˆæœ€å°åŒ–æˆ‘ä»¬å¹¶ä¸çŸ¥é“æœ€ä¼˜åˆ†å¸ƒï¼Œä½†è®­ç»ƒæ•°æ®é‡Œé¢çš„ç›®æ ‡å€¼å¯ä»¥çœ‹åšæ˜¯çš„ä¸€ä¸ªè¿‘ä¼¼åˆ†å¸ƒè¿™ä¸ªæ˜¯é’ˆå¯¹å•ä¸ªè®­ç»ƒæ ·æœ¬çš„æŸå¤±å‡½æ•°ï¼Œå¦‚æœè€ƒè™‘æ•´ä¸ªæ•°æ®é›†ï¼Œåˆ™å¯ä»¥çœ‹åˆ°é€šè¿‡æœ€å°åŒ–äº¤å‰å«¡çš„è§’åº¦æ¨å¯¼å‡ºæ¥çš„ç»“æœå’Œä½¿ç”¨æœ€å¤§åŒ–ä¼¼ç„¶å¾—åˆ°çš„ç»“æœæ˜¯ä¸€è‡´çš„Hinge Lossåˆé¡µæŸå¤±Hinge Lossæ˜¯å¦å¤–ä¸€ç§äºŒåˆ†ç±»æŸå¤±å‡½æ•°ï¼Œé€‚ç”¨äºmaximum-marginçš„åˆ†ç±»ï¼Œæ”¯æŒå‘é‡æœºSupport Vector Machine (SVM)æ¨¡å‹çš„æŸå¤±å‡½æ•°æœ¬è´¨ä¸Šå°±æ˜¯Hinge Loss + L2æ­£åˆ™åŒ–ä¸‹å›¾æ˜¯$y$ä¸ºæ­£ç±»ï¼Œå³$sgn(y)=1$æ—¶ï¼Œä¸åŒè¾“å‡ºçš„åˆé¡µæŸå¤±ç¤ºæ„å›¾å¯ä»¥çœ‹åˆ°å½“$y$ä¸ºæ­£ç±»æ—¶ï¼Œæ¨¡å‹è¾“å‡ºè´Ÿå€¼ä¼šæœ‰è¾ƒå¤§çš„æƒ©ç½šï¼Œå½“æ¨¡å‹è¾“å‡ºä¸ºæ­£å€¼ä¸”åœ¨åŒºé—´æ—¶è¿˜ä¼šæœ‰ä¸€ä¸ªè¾ƒå°çš„æƒ©ç½šå³åˆé¡µæŸå¤±ä¸ä»…æƒ©ç½šé¢„æµ‹é”™çš„ï¼Œå¹¶ä¸”å¯¹äºé¢„æµ‹å¯¹äº†ä½†æ˜¯ç½®ä¿¡åº¦ä¸é«˜çš„ä¹Ÿä¼šç»™ä¸€ä¸ªæƒ©ç½šï¼Œåªæœ‰ç½®ä¿¡åº¦é«˜çš„æ‰ä¼šæœ‰é›¶æŸå¤±ä½¿ç”¨åˆé¡µæŸå¤±ç›´è§‰ä¸Šç†è§£æ˜¯è¦æ‰¾åˆ°ä¸€ä¸ªå†³ç­–è¾¹ç•Œï¼Œä½¿å¾—æ‰€æœ‰æ•°æ®ç‚¹è¢«è¿™ä¸ªè¾¹ç•Œæ­£ç¡®åœ°ã€é«˜ç½®ä¿¡åœ°è¢«åˆ†ç±»Focal LossFocal Loss for Dense Object Detection 2018ppt: Focal Loss for Dense Object DetectionFocal LossæŸå¤±å‡½æ•°(è¶…çº§è¯¦ç»†çš„è§£è¯»)Focal lossæŸå¤±å‡½æ•°æ˜¯ä¸ºäº†è§£å†³one-stageç›®æ ‡æ£€æµ‹ä¸­æ­£è´Ÿæ ·æœ¬æåº¦ä¸å¹³è¡¡çš„é—®é¢˜ï¼Œç”±ä½•æºæ˜(Kaiming He)å›¢é˜Ÿæå‡ºFocal lossæ˜¯åŸºäºBCE(äºŒåˆ†ç±»äº¤å‰ç†µ)çš„ã€‚å®ƒæ˜¯ä¸€ä¸ªåŠ¨æ€ç¼©æ”¾çš„äº¤å‰ç†µæŸå¤±ï¼Œé€šè¿‡ä¸€ä¸ªåŠ¨æ€ç¼©æ”¾å› å­ï¼Œå¯ä»¥åŠ¨æ€é™ä½è®­ç»ƒè¿‡ç¨‹ä¸­æ˜“åŒºåˆ†æ ·æœ¬çš„æƒé‡ï¼Œä»è€Œå°†é‡å¿ƒå¿«é€Ÿèšç„¦åœ¨é‚£äº›éš¾åŒºåˆ†çš„æ ·æœ¬(æœ‰å¯èƒ½æ˜¯æ­£æ ·æœ¬ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯è´Ÿæ ·æœ¬ï¼Œä½†éƒ½æ˜¯å¯¹è®­ç»ƒç½‘ç»œæœ‰å¸®åŠ©çš„æ ·æœ¬)æ­£è´Ÿæ ·æœ¬ä¸å¹³è¡¡(Class Imbalance)åœ¨ä¸€å¼ å›¾åƒä¸­èƒ½å¤ŸåŒ¹é…åˆ°ç›®æ ‡çš„å€™é€‰æ¡†(æ­£æ ·æœ¬)ä¸ªæ•°ä¸€èˆ¬åªæœ‰åå‡ ä¸ªæˆ–å‡ åä¸ªï¼Œè€Œæ²¡æœ‰åŒ¹é…åˆ°çš„å€™é€‰æ¡†(è´Ÿæ ·æœ¬)åˆ™æœ‰10000~100000ä¸ªè¿™ä¹ˆå¤šçš„è´Ÿæ ·æœ¬ä¸ä»…å¯¹è®­ç»ƒç½‘ç»œèµ·ä¸åˆ°ä»€ä¹ˆä½œç”¨ï¼Œåè€Œä¼šæ·¹æ²¡æ‰å°‘é‡ä½†æœ‰åŠ©äºè®­ç»ƒçš„æ ·æœ¬Focal lossæ˜¯ä¸ºäº†è§£å†³ä¸€é˜¶æ®µç›®æ ‡æ£€æµ‹æ¨¡å‹ï¼Œé‚£ä¸ºä»€ä¹ˆäºŒé˜¶æ®µä¸ç”¨è§£å†³åœ¨two-stageä¸­åˆ†äº†ä¸¤æ­¥ï¼Œç¬¬ä¸€æ­¥æ—¶åŒæ ·ä¹Ÿä¼šç”Ÿæˆè®¸å¤šçš„è´Ÿæ ·æœ¬ä»¥åŠå¾ˆå°‘çš„æ­£æ ·æœ¬ï¼Œä½†åˆ°ç¬¬äºŒæ­¥æ—¶ï¼Œå®ƒä¼šåœ¨ç¬¬ä¸€æ­¥çš„åŸºç¡€ä¸Šé€‰å–ç‰¹å®šæ•°é‡çš„æ­£è´Ÿæ ·æœ¬å»æ£€æµ‹ï¼Œæ‰€ä»¥æ­£è´Ÿæ ·æœ¬å¹¶ä¸ä¼šç‰¹åˆ«ä¸å¹³è¡¡ï¼ŒäºŒé˜¶æ®µæ¨¡å‹è¿˜å¯ä»¥é‡‡ç”¨æ›´å¤æ‚çš„é‡‡æ ·ç­–ç•¥å’Œhard negative mining (éš¾ä¾‹æŒ–æ˜)ç­‰æ–¹æ³•æ¥å¤„ç†æ ·æœ¬ä¸å¹³è¡¡å’Œéš¾æ˜“æ ·æœ¬çš„é—®é¢˜ï¼Œå› æ­¤å¯¹äºäºŒé˜¶æ®µç›®æ ‡æ£€æµ‹æ¨¡å‹æ¥è¯´ï¼ŒFocal Lossçš„ä¼˜åŠ¿å¯èƒ½ç›¸å¯¹è¾ƒå°å¼•å‡ºFocal lossä¸ºäº†æ–¹ä¾¿æ¥ä¸‹æ¥çš„æè¿°ï¼Œè¿™é‡Œå…ˆå®šä¹‰$p_t$ä¸ºæ­¤æ—¶cross entropyå¯ä»¥å®šä¹‰ä¸ºè§£å†³ç±»åˆ«ä¸å¹³è¡¡çš„å¸¸è§æ–¹æ³•æ˜¯ä¸ºç±»åˆ«1å¼•å…¥ä¸€ä¸ªæƒé‡å› å­$ \alpha \in [0, 1]$ï¼Œè€Œå¯¹äºç±»åˆ«é1å¼•å…¥æƒé‡å› å­$1-\alpha$ï¼Œè¿™é‡Œå¼•å‡ºBalanced Cross Entropy(å¹³è¡¡äº¤å‰ç†µ)åœ¨è®ºæ–‡å®éªŒä¸­æ˜¾ç¤ºï¼Œå¯†é›†æ£€æµ‹å™¨è®­ç»ƒè¿‡ç¨‹ä¸­é‡åˆ°çš„ç±»åˆ«ä¸å¹³è¡¡é—®é¢˜ä½¿å¾—äº¤å‰ç†µæŸå¤±å¤±å»äº†æ•ˆæœï¼Œæ˜“äºåˆ†ç±»çš„è´Ÿæ ·æœ¬å æ®äº†å¤§éƒ¨åˆ†æŸå¤±å¹¶ä¸»å¯¼äº†æ¢¯åº¦è™½ç„¶$\alpha$å¹³è¡¡äº†æ­£æ ·æœ¬å’Œè´Ÿæ ·æœ¬çš„é‡è¦æ€§ï¼Œä½†å®ƒæ— æ³•åŒºåˆ†æ˜“äºå’Œå›°éš¾çš„æ ·æœ¬å› æ­¤ï¼Œè®ºæ–‡æå‡ºäº†æ–°çš„æŸå¤±å‡½æ•°ä»¥å‡å°æ˜“äºæ ·æœ¬çš„æƒé‡ï¼Œä»è€Œå°†è®­ç»ƒçš„é‡ç‚¹æ”¾åœ¨å›°éš¾çš„è´Ÿæ ·æœ¬ä¸Šï¼Œæ›´å…·ä½“åœ°è¯´ï¼Œè®ºæ–‡æå‡ºåœ¨äº¤å‰ç†µæŸå¤±ä¸­æ·»åŠ ä¸€ä¸ªè°ƒåˆ¶å› å­$\left(1-p_{\mathrm{t}}\right)^{\gamma}$ï¼Œå…¶ä¸­$\gamma$æ˜¯å¯è°ƒçš„Focalå‚æ•°ã€‚æˆ‘ä»¬å°†è¿™ä¸ªæŸå¤±å‡½æ•°ç§°ä¸ºFocal lossï¼Œå®šä¹‰Focal Losså…¬å¼å¦‚ä¸‹å…¶ä¸­$\gamma$ä½œç”¨æ˜¯è°ƒèŠ‚éš¾æ˜“ï¼Œè¾ƒå°çš„$\gamma$å€¼ä¼šä½¿å¾—æ˜“æ ·æœ¬çš„æŸå¤±æƒé‡ä¸‹é™æ›´æ…¢ï¼Œè€Œè¾ƒå¤§çš„$\gamma$å€¼åˆ™ä¼šåŠ é€Ÿæ˜“æ ·æœ¬çš„æŸå¤±æƒé‡ä¸‹é™$\alpha$ä½œç”¨æ˜¯å¹³è¡¡æ­£è´Ÿæ ·(æ­£è´Ÿæ ·æœ¬æ•°é‡ä¸å‡è¡¡)ï¼Œå½“$\alpha$æ¥è¿‘0æ—¶ï¼Œè´Ÿæ ·æœ¬çš„æŸå¤±è´¡çŒ®è¢«æ”¾å¤§ï¼Œä»è€Œå¹³è¡¡äº†æ­£è´Ÿæ ·æœ¬ä¹‹é—´çš„é‡è¦æ€§é€šè¿‡è°ƒæ•´$\alpha$å’Œ$\gamma$çš„å€¼ï¼Œå¯ä»¥æ ¹æ®å…·ä½“æƒ…å†µè°ƒèŠ‚æ¨¡å‹å¯¹ä¸åŒæ ·æœ¬çš„å…³æ³¨ç¨‹åº¦ï¼Œæé«˜æ¨¡å‹å¯¹éš¾æ ·æœ¬çš„å­¦ä¹ å’Œè®­ç»ƒæ•ˆæœå¯è§†åŒ–ä¸‹å›¾å¯è§†åŒ–äº†$\gamma \in[0,5]$çš„å€¼ï¼Œå¯ä»¥è§‚å¯Ÿåˆ°å¢åŠ äº†åˆ†ç±»ä¸å‡†ç¡®æ ·æœ¬åœ¨æŸå¤±å‡½æ•°ä¸­çš„æƒé‡å¢åŠ äº†éš¾åˆ†æ ·æœ¬åœ¨æŸå¤±å‡½æ•°çš„æƒé‡ï¼Œä½¿å¾—æŸå¤±å‡½æ•°å€¾å‘äºéš¾åˆ†çš„æ ·æœ¬ï¼Œæœ‰åŠ©äºæé«˜éš¾åˆ†æ ·æœ¬çš„å‡†ç¡®åº¦$\gamma$ä½œç”¨æ˜¯è°ƒèŠ‚éš¾æ˜“æ ·æœ¬å¯¹äºæ€»lossçš„æƒé‡(æ­£è´Ÿæ ·æœ¬ä¸­éƒ½æœ‰éš¾æ˜“ï¼Œéƒ½è¿›è¡Œäº†è°ƒèŠ‚)$\gamma$è°ƒèŠ‚ç®€å•æ ·æœ¬æƒé‡é™ä½çš„é€Ÿç‡ï¼Œå½“$\gamma=0$æ—¶å³ä¸ºäº¤å‰ç†µæŸå¤±å‡½æ•°ï¼Œå½“$\gamma$å¢åŠ æ—¶ï¼Œè°ƒæ•´å› å­çš„å½±å“ä¹Ÿåœ¨å¢åŠ ã€‚å®éªŒå‘ç°$\gamma=2$æ˜¯æœ€ä¼˜åŸºäºæ¦‚ç‡çš„æŸå¤±KLæ•£åº¦KL-æ•£åº¦æŸå¤±å‡½æ•°çš„å®šä¹‰å¦‚ä¸‹ä¼˜ç‚¹ï¼šé€‚ç”¨äºè¿‘ä¼¼å¤æ‚çš„ç›®æ ‡åˆ†å¸ƒï¼Œå¦‚å›¾åƒå¦‚ä¸Šæ‰€ç¤ºï¼ŒKLæ•£åº¦æŸå¤±æ˜¯ä»æˆ‘ä»¬ç½‘ç»œé¢„æµ‹çš„äº¤å‰ç†µåˆ†å¸ƒä¸ç›®æ ‡åˆ†å¸ƒçš„ç†µä¹‹é—´çš„å·®å¼‚ã€‚å®ƒå‘Šè¯‰æˆ‘ä»¬æ¨¡å‹ç¦»æœŸæœ›çš„åˆ†å¸ƒæœ‰å¤šè¿œé‚£ä¹ˆæˆ‘ä»¬ä»€ä¹ˆæƒ…å†µä¸‹ä½¿ç”¨å®ƒå¦‚æœæˆ‘ä»¬çš„ä»»åŠ¡æ˜¯ç”Ÿæˆå›¾åƒï¼Œé‚£ä¹ˆç›®æ ‡åˆ†å¸ƒè¦å¤æ‚å¾—å¤šï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½¿ç”¨KLæ•£åº¦æŸå¤±çš„æ•ˆæœæœ€å¥½æ­£åˆ™åŒ–æŠ€æœ¯L1æ­£åˆ™åŒ–åœ¨æŸå¤±å‡½æ•°ä¸­æ·»åŠ æ¨¡å‹å‚æ•°çš„ L1 èŒƒæ•°ä½œä¸ºæ­£åˆ™é¡¹ã€‚å®ƒä¿ƒä½¿æ¨¡å‹å‚æ•°ç¨€ç–åŒ–ï¼Œå³å°†ä¸€äº›å‚æ•°å‹ç¼©ä¸ºé›¶ï¼Œä»è€Œå®ç°ç‰¹å¾é€‰æ‹©å’Œæ¨¡å‹ç®€åŒ–L2æ­£åˆ™åŒ–åœ¨æŸå¤±å‡½æ•°ä¸­æ·»åŠ æ¨¡å‹å‚æ•°çš„ L2 èŒƒæ•°ä½œä¸ºæ­£åˆ™é¡¹ã€‚å®ƒå¯¹æ¨¡å‹å‚æ•°è¿›è¡Œå¹³æ»‘çº¦æŸï¼Œä½¿æ¨¡å‹å‚æ•°å€¼è¶‹å‘äºè¾ƒå°çš„å€¼ï¼Œæœ‰åŠ©äºé˜²æ­¢è¿‡æ‹Ÿåˆå¼¹æ€§ç½‘æ­£åˆ™åŒ–å¼¹æ€§ç½‘æ­£åˆ™åŒ–æ˜¯ L1 æ­£åˆ™åŒ–å’Œ L2 æ­£åˆ™åŒ–çš„ä¸€ç§ç»“åˆã€‚å®ƒåŒæ—¶å¯¹æ¨¡å‹å‚æ•°ä½¿ç”¨ L1 å’Œ L2 æ­£åˆ™åŒ–ï¼Œä»è€Œç»¼åˆè€ƒè™‘äº†ç¨€ç–æ€§å’Œå¹³æ»‘æ€§çš„å½±å“å…¶ä»–æ­£åˆ™Dropoutï¼šDropout æ˜¯ä¸€ç§åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­éšæœºä¸¢å¼ƒéƒ¨åˆ†ç¥ç»å…ƒçš„æŠ€æœ¯ã€‚å®ƒå¯ä»¥é˜²æ­¢ç¥ç»ç½‘ç»œè¿‡æ‹Ÿåˆï¼Œå¹¶æé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚é€šè¿‡åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä»¥ä¸€å®šæ¦‚ç‡å°†éƒ¨åˆ†ç¥ç»å…ƒç½®é›¶ï¼ŒDropout å¯ä»¥å¼ºåˆ¶æ¨¡å‹åœ¨æ²¡æœ‰å®Œæ•´ç¥ç»ç½‘ç»œçš„æƒ…å†µä¸‹è¿›è¡Œå­¦ä¹ æ•°æ®å¢å¼º(Data Augmentation)ï¼šæ•°æ®å¢å¼ºæ˜¯ä¸€ç§é€šè¿‡å¯¹è®­ç»ƒæ•°æ®è¿›è¡Œéšæœºå˜æ¢æ¥æ‰©å……æ•°æ®é›†çš„æŠ€æœ¯ã€‚å¸¸è§çš„æ•°æ®å¢å¼ºæ“ä½œåŒ…æ‹¬éšæœºè£å‰ªã€æ—‹è½¬ã€ç¿»è½¬ã€å¹³ç§»ã€ç¼©æ”¾ç­‰ã€‚æ•°æ®å¢å¼ºå¯ä»¥å¢åŠ è®­ç»ƒæ•°æ®çš„å¤šæ ·æ€§ï¼Œæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›å’Œé²æ£’æ€§å›¾åƒå¢å¼ºæŠ€æœ¯ï¼šäº†è§£å¸¸è§çš„å›¾åƒå¢å¼ºæ–¹æ³•ï¼Œå¦‚å¯¹æ¯”åº¦è°ƒæ•´ã€äº®åº¦è°ƒæ•´ã€è‰²å½©å¹³è¡¡ã€ç›´æ–¹å›¾å‡è¡¡åŒ–ç­‰ï¼Œä»¥åŠå®ƒä»¬åœ¨å›¾åƒå¤„ç†å’Œè®¡ç®—æœºè§†è§‰ä¸­çš„åº”ç”¨</content>
	</entry>
	<entry>
		<title>æ·±åº¦å­¦ä¹ æ ¸å¿ƒä¹‹æ¿€æ´»å‡½æ•°</title>
		<url>/article/22410.html</url>
		<content>æ¦‚è¿°æ¿€æ´»å‡½æ•°ï¼ˆActivation Functionï¼‰æ¿€æ´»å‡½æ•°å¯è§†åŒ–æ¿€æ´»å‡½æ•°(Activation Function)æ˜¯ä¸€ç§æ·»åŠ åˆ°äººå·¥ç¥ç»ç½‘ç»œä¸­çš„å‡½æ•°ï¼Œæ—¨åœ¨å¸®åŠ©ç½‘ç»œå­¦ä¹ æ•°æ®ä¸­çš„å¤æ‚æ¨¡å¼å¼•å…¥æ¿€æ´»å‡½æ•°çš„ç›®çš„ä¸ä½¿ç”¨æ¿€æ´»å‡½æ•°çš„è¯ï¼Œç¥ç»ç½‘ç»œçš„æ¯å±‚éƒ½åªæ˜¯åšçº¿æ€§å˜æ¢ï¼Œå¤šå±‚è¾“å…¥å åŠ åä¹Ÿè¿˜æ˜¯çº¿æ€§å˜æ¢ã€‚å› ä¸ºçº¿æ€§æ¨¡å‹çš„è¡¨è¾¾èƒ½åŠ›é€šå¸¸ä¸å¤Ÿæ‰€ä»¥è¿™æ—¶å€™å°±ä½“ç°äº†æ¿€æ´»å‡½æ•°çš„ä½œç”¨äº†ï¼Œæ¿€æ´»å‡½æ•°å¯ä»¥å¼•å…¥éçº¿æ€§å› ç´ ï¼Œè®¾æœ‰ä¸‰ä¸ªçº¿æ€§å˜æ¢å°†è¿™ä¸‰ä¸ªçº¿æ€§å˜æ¢åŠ åˆ°ä¸€èµ·ï¼Œå¯ä»¥å¾—åˆ°æ‰€ä»¥ï¼Œå¦‚æœç¥ç»ç½‘ç»œåªæœ‰çº¿æ€§ï¼Œé‚£ä¹ˆä¸è®ºæœ‰å¤šå°‘éšå±‚ï¼Œæœ‰å¤šå°‘ç¥ç»å…ƒï¼Œæœ€ç»ˆè¿˜æ˜¯çº¿æ€§çš„æ­¤æ—¶å°±éœ€è¦é€šè¿‡æ·»åŠ æ¿€æ´»å‡½æ•°æ¥å¯¹æ¯ä¸€å±‚çš„è¾“å‡ºåšå¤„ç†ï¼Œå¼•å…¥éçº¿æ€§å› ç´ ï¼Œä½¿å¾—ç¥ç»ç½‘ç»œå¯ä»¥é€¼è¿‘ä»»æ„çš„éçº¿æ€§å‡½æ•°æ¿€æ´»å‡½æ•°åœ¨ç¥ç»ç½‘ç»œä¸­çš„åº”ç”¨ï¼Œé™¤äº†å¼•å…¥éçº¿æ€§è¡¨è¾¾èƒ½åŠ›ï¼Œå…¶åœ¨æé«˜æ¨¡å‹é²æ£’æ€§ã€ç¼“è§£æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ã€å°†ç‰¹å¾è¾“å…¥æ˜ å°„åˆ°æ–°çš„ç‰¹å¾ç©ºé—´ä»¥åŠåŠ é€Ÿæ¨¡å‹æ”¶æ•›ç­‰æ–¹é¢éƒ½æœ‰ä¸åŒç¨‹åº¦çš„æ”¹å–„ä½œç”¨å°ç»“:å¼•å…¥éçº¿æ€§è¡¨è¾¾èƒ½åŠ›æé«˜æ¨¡å‹é²æ£’æ€§ï¼šéçº¿æ€§çš„æ¿€æ´»å‡½æ•°èƒ½å¤Ÿå¼•å…¥éçº¿æ€§å˜æ¢ï¼Œä»è€Œä½¿ç¥ç»ç½‘ç»œå…·æœ‰æ›´å¼ºçš„è¡¨è¾¾èƒ½åŠ›ï¼Œèƒ½å¤Ÿæ›´å¥½åœ°æ‹Ÿåˆå¤æ‚çš„æ•°æ®åˆ†å¸ƒå’Œæ¨¡å¼ç¼“è§£æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ï¼šåœ¨æ·±å±‚ç¥ç»ç½‘ç»œä¸­ï¼Œç”±äºé“¾å¼æ±‚å¯¼çš„å…³ç³»ï¼Œæ¢¯åº¦åœ¨åå‘ä¼ æ’­è¿‡ç¨‹ä¸­ä¼šé€æ¸å‡å°ï¼Œå¯¼è‡´æ¢¯åº¦æ¶ˆå¤±çš„é—®é¢˜ä½¿ç”¨éçº¿æ€§æ¿€æ´»å‡½æ•°å¯ä»¥å¸®åŠ©ç¼“è§£æ¢¯åº¦æ¶ˆå¤±ï¼Œå› ä¸ºè¿™äº›å‡½æ•°åœ¨è¾“å…¥çš„ä¸åŒèŒƒå›´å†…å…·æœ‰ä¸åŒçš„æ–œç‡ï¼Œä»è€Œå…è®¸æ¢¯åº¦èƒ½å¤Ÿåœ¨åå‘ä¼ æ’­ä¸­æ›´å¥½åœ°ä¼ é€’å¸¸è§æ¿€æ´»å‡½æ•°Activation Functions with Derivative and Python code: Sigmoid vs Tanh Vs Reluã€æ¿€æ´»å‡½æ•°åˆé›†ã€‘ç›˜ç‚¹å½“å‰æœ€æµè¡Œçš„æ¿€æ´»å‡½æ•°åŠé€‰æ‹©ç»éªŒæ¿€æ´»å‡½æ•°å‘å±•å†ç¨‹æ—©æœŸ1970198020102013é˜¶è·ƒå‡½æ•°(Step Function)SigmoidåŒæ›²æ­£åˆ‡(Tanh)ReLU(Rectified Linear Unit)Leaky ReLUMaxout2015201620172020PReLU(Parametric ReLU)ELU(Exponential Linear Unit)GELUS(Gaussian Error Linear Units)SwishMishç›¸å¯¹åº”çš„è®ºæ–‡é“¾æ¥å¦‚ä¸‹Maxout Networks 2013Delving Deep into Rectifiers: Surpassing Human-Level Performance on ImageNet Classification 2015 PReLUFast and Accurate Deep Network Learning by Exponential Linear Units (ELUs) 2016Gaussian Error Linear Units (GELUS) 2016å¹´æå‡ºSearching for Activation Functions (Swish) 2017Swish: a Self-Gated Activation Function 2017Mish: A Self Regularized Non-Monotonic Neural Activation Function 2019SigmoidSigmoidå‡½æ•°(Logisticå‡½æ•°)å‡½æ•°çš„å›¾åƒçœ‹èµ·æ¥åƒä¸€ä¸ªSå½¢æ›²çº¿ï¼Œå‡½æ•°è¡¨è¾¾å¼å¦‚ä¸‹å¯¹åº”çš„å¯¼æ•°ä¸ºå‡½æ•°å›¾åƒå’Œå¯¹åº”çš„å¯¼æ•°å›¾åƒå¦‚ä¸‹å›¾æ‰€ç¤ºä½œç”¨å°†è¾“å…¥æ˜ å°„åˆ°0åˆ°1ä¹‹é—´çš„è¿ç»­å€¼ï¼Œå¸¸ç”¨äºäºŒåˆ†ç±»é—®é¢˜æˆ–è¾“å‡ºå±‚çš„æ¦‚ç‡é¢„æµ‹Sigmoidæ¿€æ´»å‡½æ•°çš„ä¼˜ç¼ºç‚¹ä¼˜ç‚¹å¹³æ»‘æ˜“äºæ±‚å¯¼å¯ä»¥ä½œä¸ºæ¦‚ç‡ï¼Œè¾…åŠ©æ¨¡å‹è§£ç¼ºç‚¹æ¢¯åº¦æ¶ˆå¤±: Sigmoidå‡½æ•°çš„å¯¼æ•°å½¢å¼ä¸º$ fâ€™(x) = f(x)(1-f(x))$ï¼Œå…¶ä¸­$f(x)$æ˜¯Sigmoidå‡½æ•°å½“è¾“å…¥å€¼éå¸¸å¤§æ—¶ï¼ŒSigmoidå‡½æ•°æ¥è¿‘äº1ï¼Œå¯¼æ•°æ¥è¿‘äº0ï¼Œè€Œå½“è¾“å…¥å€¼éå¸¸å°æ—¶ï¼ŒSigmoidå‡½æ•°æ¥è¿‘äº0ï¼Œå¯¼æ•°åŒæ ·æ¥è¿‘äº0è¿™æ„å‘³ç€åœ¨åå‘ä¼ æ’­æ—¶ï¼Œæ¢¯åº¦é€æ¸å˜å°å¹¶è¶‹è¿‘äºé›¶ï¼Œä¼ é€’åˆ°è¾ƒæ—©å±‚æ—¶ï¼Œæ¢¯åº¦å‡ ä¹æ¶ˆå¤±äº†æ¢¯åº¦æ›´æ–°æ…¢: å¦‚æœç¥ç»å…ƒçš„è¾“å‡ºå¤§éƒ¨åˆ†ä½äºé¥±å’ŒåŒºåŸŸ(æ¥è¿‘0æˆ–1)ï¼Œé‚£ä¹ˆæ¢¯åº¦å°†éå¸¸å°ï¼Œå› ä¸ºsigmoidå‡½æ•°åœ¨é¥±å’ŒåŒºåŸŸçš„å¯¼æ•°æ¥è¿‘äº0(å¦‚å›¾æ‰€ç¤º)è¿™æ ·ï¼Œæƒé‡çš„æ›´æ–°å°†å˜å¾—éå¸¸ç¼“æ…¢ï¼Œå¯èƒ½å¯¼è‡´è®­ç»ƒè¿‡ç¨‹å˜å¾—å›°éš¾ï¼Œå¹¶ä¸”ç½‘ç»œçš„æ”¶æ•›é€Ÿåº¦å‡æ…¢è®¡ç®—æ•ˆç‡ä½: Sigmoidå‡½æ•°æ‰§è¡ŒæŒ‡æ•°è¿ç®—ï¼Œè®¡ç®—æœºè¿è¡Œå¾—è¾ƒæ…¢TanhTanhå‡½æ•°(åŒæ›²æ­£åˆ‡å‡½æ•°)å‡½æ•°çš„å›¾åƒçœ‹èµ·æ¥ä¹Ÿåƒä¸€ä¸ªSå½¢æ›²çº¿ï¼Œå‡½æ•°è¡¨è¾¾å¼å¦‚ä¸‹å¯¹åº”çš„å¯¼æ•°ä¸ºTanhå›¾åƒå’Œsigmoidå‡½æ•°æ¯”è¾ƒå¦‚ä¸‹å›¾æ‰€ç¤ºä¸Sigmoidå‡½æ•°å¯¹æ¯”Tanhæ˜¯ä¸€ä¸ªåŒæ›²æ­£åˆ‡å‡½æ•°ï¼ŒTanhå‡½æ•°å’Œsigmoidå‡½æ•°çš„æ›²çº¿ç›¸å¯¹ç›¸ä¼¼ï¼Œä½†æ˜¯å®ƒæ¯”sigmoidå‡½æ•°æ›´æœ‰ä¸€äº›ä¼˜åŠ¿ï¼Œè¿™ä¸¤ç§æ¿€æ´»å‡½æ•°å‡ä¸ºé¥±å’Œæ¿€æ´»å‡½æ•°ä¼˜ç‚¹ï¼šèŒƒå›´æ›´å¹¿ï¼štanhå‡½æ•°çš„è¾“å‡ºèŒƒå›´æ˜¯(-1, 1)ï¼Œè€Œsigmoidå‡½æ•°çš„è¾“å‡ºèŒƒå›´æ˜¯(0, 1)ï¼Œtanhå‡½æ•°åœ¨å‡å€¼ä¸º0é™„è¿‘æ›´é›†ä¸­ï¼Œå¯¹äºæŸäº›ä»»åŠ¡å¯èƒ½æ›´é€‚ç”¨æ”¶æ•›é€Ÿåº¦å¿«ï¼štanhå‡½æ•°åœ¨è¾“å…¥çš„ç»å¯¹å€¼è¾ƒå¤§æ—¶ï¼Œè¾“å‡ºçš„æ¢¯åº¦ä¹Ÿè¾ƒå¤§ï¼Œè¿™å¯ä»¥å¸®åŠ©ç½‘ç»œæ›´å¿«åœ°æ”¶æ•›å…·æœ‰é›¶ä¸­å¿ƒæ€§ï¼štanhå‡½æ•°çš„å‡å€¼ä¸º0ï¼Œç›¸å¯¹äºsigmoidå‡½æ•°æ¥è¯´æ›´å®¹æ˜“å¤„ç†æ­£è´Ÿå€¼çš„è¾“å…¥ï¼Œè®­ç»ƒç›¸å¯¹å®¹æ˜“ç¼ºç‚¹ï¼šæ¢¯åº¦æ¶ˆå¤±é—®é¢˜: ä¸Sigmoidå‡½æ•°ç±»ä¼¼ï¼Œæ¢¯åº¦æ¶ˆå¤±é—®é¢˜ä»ç„¶å­˜åœ¨è®¡ç®—ä»£ä»·è¾ƒé«˜ï¼šç›¸å¯¹äºsigmoidå‡½æ•°æ¥è¯´ï¼Œtanhå‡½æ•°çš„è®¡ç®—ä»£ä»·è¾ƒé«˜ï¼Œå› ä¸ºå®ƒéœ€è¦è¿›è¡ŒæŒ‡æ•°è¿ç®—ReluReLUå‡½æ•°çš„ä¸»è¦ä¼˜ç‚¹æ˜¯è®¡ç®—ç®€å•ã€éçº¿æ€§è¡¨è¾¾èƒ½åŠ›å¼ºã€ä½¿ç½‘ç»œæ›´å¿«é€Ÿåœ°æ”¶æ•›ï¼Œå¹¶ä¸”åœ¨æ·±åº¦ç¥ç»ç½‘ç»œä¸­è¡¨ç°å‡ºè‰¯å¥½çš„æ€§èƒ½ï¼Œå‡½æ•°è¡¨è¾¾å¼å¦‚ä¸‹å¯¹åº”çš„å¯¼æ•°ä¸ºå‡½æ•°å›¾åƒå’Œå¯¹åº”çš„å¯¼æ•°å›¾åƒå¦‚ä¸‹å›¾æ‰€ç¤ºä¸»è¦ä¼˜ç¼ºç‚¹ä¼˜ç‚¹ï¼šè®¡ç®—é€Ÿåº¦å¿«ï¼šReLUå‡½æ•°çš„è®¡ç®—éå¸¸ç®€å•ï¼Œåªæœ‰çº¿æ€§å…³ç³»ï¼Œä¸éœ€è¦æŒ‡æ•°è®¡ç®—ï¼Œä¸ç®¡åœ¨å‰å‘ä¼ æ’­è¿˜æ˜¯åå‘ä¼ æ’­ï¼Œè®¡ç®—é€Ÿåº¦éƒ½æ¯”sigmoidå’Œtanhå¿«ç¼“è§£æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ï¼šç›¸æ¯”äºsigmoidå’Œtanhç­‰å‡½æ•°ï¼Œåœ¨æ­£åŒºé—´ä¸ŠReLUå‡½æ•°çš„å¯¼æ•°ä¸ºå¸¸æ•°1ï¼Œè¿™æœ‰åŠ©äºç¼“è§£æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ï¼Œä½¿å¾—æ·±å±‚ç½‘ç»œçš„æ¢¯åº¦èƒ½å¤Ÿæ›´å¥½åœ°ä¼ æ’­ï¼Œæ›´å®¹æ˜“è¿›è¡Œåå‘ä¼ æ’­ç®—æ³•çš„ä¼˜åŒ–ï¼Œè‡³å°‘xåœ¨æ­£åŒºé—´å†…ï¼Œç¥ç»å…ƒä¸ä¼šé¥±å’Œæ¿€æ´»ç¨€ç–æ€§ï¼šReLUå‡½æ•°å¯¹äºè´Ÿè¾“å…¥å€¼ç›´æ¥è¾“å‡ºä¸º0ï¼Œè¿™å¯¼è‡´ç¥ç»å…ƒçš„æ¿€æ´»å˜å¾—ç¨€ç–ï¼Œå³åªæœ‰éƒ¨åˆ†ç¥ç»å…ƒä¼šè¢«æ¿€æ´»ã€‚è¿™ç§ç¨€ç–æ€§æœ‰åŠ©äºå‡å°‘å‚æ•°ä¹‹é—´çš„å†—ä½™ï¼Œå¹¶ä¸”åœ¨ä¸€å®šç¨‹åº¦ä¸Šå…·æœ‰æ­£åˆ™åŒ–çš„æ•ˆæœç¼ºç‚¹ï¼šç¥ç»å…ƒæ­»äº¡é—®é¢˜ï¼šReLUå‡½æ•°åœ¨è´ŸåŒºé—´ä¸Šè¾“å‡ºæ’ä¸º0ï¼Œå½“ç¥ç»å…ƒåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å‡ºç°è´Ÿè¾“å…¥æ—¶ï¼Œä¼šå¯¼è‡´è¯¥ç¥ç»å…ƒæ°¸è¿œä¸ä¼šè¢«æ¿€æ´»ï¼Œç§°ä¸ºç¥ç»å…ƒæ­»äº¡é—®é¢˜ã€‚è¿™ä¼šå¯¼è‡´ä¸€éƒ¨åˆ†ç¥ç»å…ƒå¤±å»äº†å­¦ä¹ èƒ½åŠ›è¾“å‡ºä¸æ˜¯é›¶ä¸­å¿ƒï¼šReLUå‡½æ•°çš„è¾“å‡ºèŒƒå›´æ˜¯$[0, + \infty)$ï¼Œå¹¶ä¸ä»¥0ä¸ºä¸­å¿ƒï¼Œè¿™å¯èƒ½ä¼šå¯¹æŸäº›ä¼˜åŒ–ç®—æ³•çš„æ”¶æ•›é€Ÿåº¦äº§ç”Ÿå½±å“è®­ç»ƒç¥ç»ç½‘ç»œçš„æ—¶å€™ï¼Œä¸€æ—¦å­¦ä¹ ç‡æ²¡æœ‰è®¾ç½®å¥½ï¼Œç¬¬ä¸€æ¬¡æ›´æ–°æƒé‡çš„æ—¶å€™ï¼Œè¾“å…¥çš„æ˜¯è´Ÿå€¼ï¼Œé‚£ä¹ˆè¿™ä¸ªå«æœ‰ReLUçš„ç¥ç»èŠ‚ç‚¹å°±ä¼šæ­»äº¡ï¼Œå†ä¹Ÿä¸ä¼šè¢«æ¿€æ´»åœ¨å®é™…è®­ç»ƒä¸­ï¼Œå¦‚æœå­¦ä¹ ç‡è®¾ç½®çš„å¤ªé«˜ï¼Œå¯èƒ½ä¼šå‘ç°ç½‘ç»œä¸­40%çš„ç¥ç»å…ƒéƒ½ä¼šæ­»æ‰ï¼Œä¸”åœ¨æ•´ä¸ªè®­ç»ƒé›†ä¸­è¿™äº›ç¥ç»å…ƒéƒ½ä¸ä¼šè¢«æ¿€æ´»æ‰€ä»¥ï¼Œè®¾ç½®ä¸€ä¸ªåˆé€‚çš„è¾ƒå°çš„å­¦ä¹ ç‡ä¼šé™ä½è¿™ç§æƒ…å†µçš„å‘ç”Ÿä¸ºäº†è§£å†³ç¥ç»å…ƒèŠ‚ç‚¹æ­»äº¡çš„æƒ…å†µï¼Œæœ‰äººæå‡ºäº†Leaky ReLUã€P-ReLUã€R-ReLUã€ELUç­‰æ¿€æ´»å‡½æ•°Leaky ReLULeaky ReLUå‡½æ•°åœ¨è´Ÿæ•°èŒƒå›´å†…å¼•å…¥äº†ä¸€ä¸ªå°çš„æ–œç‡ï¼Œè§£å†³äº†ReLUå‡½æ•°ä¸­è´Ÿæ•°éƒ¨åˆ†çš„æ­»äº¡é—®é¢˜ï¼Œå‡½æ•°è¡¨è¾¾å¼å¦‚ä¸‹å¯¹åº”çš„å¯¼æ•°ä¸ºå‡½æ•°å›¾åƒå’Œå¯¹åº”çš„å¯¼æ•°å›¾åƒå¦‚ä¸‹å›¾æ‰€ç¤ºä¼˜ç¼ºç‚¹ä¼˜ç‚¹:Leaky ReLUä¸­å¼•å…¥äº†è¶…å‚æ•°ï¼Œä¸€èˆ¬è®¾ç½®ä¸º0.01ã€‚åœ¨åå‘ä¼ æ’­è¿‡ç¨‹ä¸­ï¼Œå¯¹äºLeaky ReLUçš„è¾“å…¥å°äºé›¶çš„æƒ…å†µï¼Œä¹Ÿå¯ä»¥è®¡ç®—å¾—åˆ°ä¸€ä¸ªæ¢¯åº¦(è€Œä¸æ˜¯åƒReLUä¸€æ ·å€¼ä¸º0)ï¼Œè¿™æ ·å°±é¿å…äº†ç¥ç»å…ƒæ­»äº¡çš„é—®é¢˜ç¼ºç‚¹:ç¨€ç–æ€§å·®: ç›¸è¾ƒäºReLUï¼Œç¥ç»ç½‘ç»œçš„ç¨€ç–æ€§è¦å·®ä¸€äº›é¢å¤–çš„è¶…å‚æ•°: å¼•å…¥äº†é¢å¤–çš„è¶…å‚æ•°$\alpha$ç¥ç»ç½‘ç»œä¸å­¦ä¹ $\alpha$å€¼ä¸ºä»€ä¹ˆLeaky ReLUæ¯”ReLUæ›´å¥½è°ƒæ•´è´Ÿå€¼çš„é›¶æ¢¯åº¦: Leaky ReLUé€šè¿‡æŠŠxçš„éå¸¸å°çš„çº¿æ€§åˆ†é‡ç»™äºˆè´Ÿè¾“å…¥(0.01x)æ¥è°ƒæ•´è´Ÿå€¼çš„é›¶æ¢¯åº¦(zero gradients)é—®é¢˜æ‰©å¤§å‡½æ•°çš„èŒƒå›´: Leaky ReLUæœ‰åŠ©äºæ‰©å¤§ReLUå‡½æ•°çš„èŒƒå›´ï¼Œé€šå¸¸$\alpha$çš„å€¼ä¸º0.01å·¦å³å–å€¼èŒƒå›´: Leaky ReLUçš„å‡½æ•°èŒƒå›´æ˜¯(è´Ÿæ— ç©·åˆ°æ­£æ— ç©·)ä»ç†è®ºä¸Šè®²ï¼ŒLeaky ReLUå…·æœ‰ReLUçš„æ‰€æœ‰ä¼˜ç‚¹ï¼Œè€Œä¸”Dead ReLUä¸ä¼šæœ‰ä»»ä½•é—®é¢˜ï¼Œä½†åœ¨å®é™…æ“ä½œä¸­ï¼Œå°šæœªå®Œå…¨è¯æ˜Leaky ReLUæ€»æ˜¯æ¯”ReLUæ›´å¥½PReLUP-Reluæ¿€æ´»å‡½æ•°çš„è§£æå¼P-Reluå‡½æ•°åŠå…¶å¯¼æ•°çš„å›¾åƒå¦‚ä¸‹å›¾æ‰€ç¤ºå…¶ä¸­$\alpha$æ˜¯è¶…å‚æ•°ã€‚è¿™é‡Œå¼•å…¥äº†ä¸€ä¸ªéšæœºçš„è¶…å‚æ•°$\alpha$ï¼Œå®ƒå¯ä»¥è¢«å­¦ä¹ ï¼Œå› ä¸ºä½ å¯ä»¥å¯¹å®ƒè¿›è¡Œåå‘ä¼ æ’­è¿™ä½¿ç¥ç»å…ƒèƒ½å¤Ÿé€‰æ‹©è´ŸåŒºåŸŸæœ€å¥½çš„æ¢¯åº¦ï¼Œæœ‰äº†è¿™ç§èƒ½åŠ›ï¼Œå®ƒä»¬å¯ä»¥å˜æˆReLUæˆ–Leaky ReLUä¸ReLUå’ŒLeaky ReLUçš„å…³ç³»çœ‹ä¸€ä¸‹PReLUçš„å…¬å¼ï¼šå‚æ•°Î±é€šå¸¸ä¸º0åˆ°1ä¹‹é—´çš„æ•°å­—ï¼Œå¹¶ä¸”é€šå¸¸ç›¸å¯¹è¾ƒå°å¦‚æœ$\alpha_{i}=0$ï¼Œåˆ™$f$å˜ä¸ºReLUå¦‚æœ$\alpha_{i} \gt 0$ï¼Œåˆ™$f$å˜ä¸ºLeaky ReLUå¦‚æœ$\alpha_{i}$æ˜¯å¯å­¦ä¹ çš„å‚æ•°ï¼Œåˆ™$f$å˜ä¸ºPReLUELUELU as an Activation Function in Neural NetworksCUDAç¼–ç¨‹å…¥é—¨ä¹‹æ¿€æ´»å‡½æ•°ELUELUæ¿€æ´»å‡½æ•°è§£å†³äº†ReLUçš„ä¸€äº›é—®é¢˜ï¼ŒåŒæ—¶ä¹Ÿä¿ç•™äº†ä¸€äº›å¥½çš„æ–¹é¢ã€‚è¿™ç§æ¿€æ´»å‡½æ•°è¦é€‰å–ä¸€ä¸ª$\alpha$å€¼ï¼›å¸¸è§çš„å–å€¼æ˜¯åœ¨0.1åˆ°0.3ä¹‹é—´å¯¹åº”çš„å¯¼æ•°ä¸ºå‡½æ•°åŠå…¶å¯¼æ•°çš„å›¾åƒå¦‚ä¸‹å›¾æ‰€ç¤ºå¦‚æœæˆ‘ä»¬è¾“å…¥çš„$x$å€¼å¤§äº0ï¼Œåˆ™ç»“æœä¸ReLUä¸€æ ·ï¼Œå³$y$å€¼ç­‰äº$x$å€¼ï¼›ä½†å¦‚æœè¾“å…¥çš„$x$å€¼å°äº0ï¼Œåˆ™æˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ªç¨å¾®å°äº0çš„å€¼ï¼Œæ‰€å¾—åˆ°çš„$y$å€¼å–å†³äºè¾“å…¥çš„$x$å€¼ï¼Œä½†è¿˜è¦å…¼é¡¾å‚æ•°$\alpha$ä½ å¯ä»¥æ ¹æ®éœ€è¦æ¥è°ƒæ•´è¿™ä¸ªå‚æ•°ã€‚æ›´è¿›ä¸€æ­¥ï¼Œæˆ‘ä»¬å¼•å…¥äº†æŒ‡æ•°è¿ç®—$e^x$ï¼Œå› æ­¤ELUçš„è®¡ç®—æˆæœ¬æ¯”ReLUé«˜ä¼˜ç¼ºç‚¹ä¼˜ç‚¹ä¸ReLUä¸åŒï¼Œå®ƒæ²¡æœ‰ç¥ç»å…ƒæ­»äº¡çš„é—®é¢˜ã€‚ è¿™æ˜¯å› ä¸º ELU çš„æ¢¯åº¦å¯¹äºæ‰€æœ‰è´Ÿå€¼éƒ½æ˜¯éé›¶çš„ä¸å…¶ä»–çº¿æ€§éé¥±å’Œæ¿€æ´»å‡½æ•°ï¼ˆå¦‚ ReLU åŠå…¶å˜ä½“ï¼‰ç›¸æ¯”ï¼Œå®ƒæœ‰ç€æ›´å¿«çš„è®­ç»ƒæ—¶é—´ä½œä¸ºéé¥±å’Œæ¿€æ´»å‡½æ•°ï¼Œå®ƒä¸ä¼šé‡åˆ°æ¢¯åº¦çˆ†ç‚¸æˆ–æ¶ˆå¤±çš„é—®é¢˜æ‰€æœ‰ç‚¹ä¸Šéƒ½æ˜¯è¿ç»­çš„å’Œå¯å¾®ç¼ºç‚¹åŒ…å«æŒ‡æ•°è¿ç®—ï¼Œè®¡ç®—æ—¶é—´é•¿æ— æ³•é¿å…æ¢¯åº¦çˆ†ç‚¸é—®é¢˜ç¥ç»ç½‘ç»œæ— æ³•å­¦ä¹ $\alpha $å€¼ä¸Leaky-ReLUå’ŒPReLUç±»ä¼¼ï¼Œä¸ReLUä¸åŒçš„æ˜¯ï¼ŒELUæ²¡æœ‰ç¥ç»å…ƒæ­»äº¡çš„é—®é¢˜(ReLU Dying é—®é¢˜æ˜¯æŒ‡å½“å‡ºç°å¼‚å¸¸è¾“å…¥æ—¶ï¼Œåœ¨åå‘ä¼ æ’­ä¸­ä¼šäº§ç”Ÿå¤§çš„æ¢¯åº¦ï¼Œè¿™ç§å¤§çš„æ¢¯åº¦ä¼šå¯¼è‡´ç¥ç»å…ƒæ­»äº¡å’Œæ¢¯åº¦æ¶ˆå¤±)ã€‚å®ƒå·²è¢«è¯æ˜ä¼˜äºReLUåŠå…¶å˜ä½“ï¼Œå¦‚Leaky-ReLU(LReLU)å’ŒParameterized-ReLU(PReLU)ã€‚ä¸ReLUåŠå…¶å˜ä½“ç›¸æ¯”ï¼Œä½¿ç”¨ELUå¯åœ¨ç¥ç»ç½‘ç»œä¸­ç¼©çŸ­è®­ç»ƒæ—¶é—´å¹¶æé«˜å‡†ç¡®åº¦GELUGaussian Error Linear Units (GELUS) 2016å¹´æå‡º è®ºæ–‡åœ°å€GELUå¯ä»¥çœ‹åšæ˜¯RELUçš„ä¸€ä¸ªå¹³æ»‘ç‰ˆæœ¬ï¼›GELUæ¿€æ´»å‡½æ•°çš„æœ€å¤§ç‰¹ç‚¹æ˜¯ï¼šå°†éçº¿æ€§ä¸ä¾èµ–è¾“å…¥æ•°æ®åˆ†å¸ƒçš„éšæœºæ­£åˆ™åŒ–å™¨ç›¸ç»“åˆåœ¨ä¸€ä¸ªæ¿€æ´»å‡½æ•°çš„è¡¨è¾¾ä¸­åœ¨é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ä¸­ï¼ŒGELUå¯ä»¥è¯´æ˜¯ä¸»æµçš„æ¿€æ´»å‡½æ•°ï¼›Bertï¼ŒRoBERTaï¼ŒALBERTï¼ŒGPT-2ç­‰é¡¶å°–çš„NLPé¢„è®­ç»ƒæ¨¡å‹éƒ½æ˜¯ä½¿ç”¨çš„GELUbertä¸­ä½¿ç”¨çš„æ¿€æ´»å‡½æ•°ï¼Œä½œè€…ç»è¿‡å®éªŒè¯æ˜æ¯”reluç­‰è¦å¥½ã€‚åŸç‚¹å¯å¯¼ï¼Œä¸ä¼šæœ‰Dead ReLUé—®é¢˜ä¸Reluå’ŒELUæ¯”è¾ƒå¦‚ä¸‹SoftplusSoftpluså‡½æ•°ç±»ä¼¼äºReLUå‡½æ•°ï¼Œä½†æ˜¯ç›¸å¯¹è¾ƒå¹³æ»‘ï¼ŒåƒReLUä¸€æ ·æ˜¯å•ä¾§æŠ‘åˆ¶ï¼Œå®ƒçš„æ¥å—èŒƒå›´å¾ˆå¹¿å…¶å¯¹åº”çš„å¯¼æ•°å¦‚ä¸‹ä¼˜ç‚¹ï¼šä½œä¸ºreluçš„ä¸€ä¸ªä¸é”™çš„æ›¿ä»£é€‰æ‹©ï¼Œsoftplusèƒ½å¤Ÿè¿”å›ä»»ä½•å¤§äº0çš„å€¼ä¸reluä¸åŒï¼Œsoftplusçš„å¯¼æ•°æ˜¯è¿ç»­çš„ã€éé›¶çš„ï¼Œæ— å¤„ä¸åœ¨ï¼Œä»è€Œé˜²æ­¢å‡ºç°æ­»ç¥ç»å…ƒç¼ºç‚¹ï¼šå¯¼æ•°å¸¸å¸¸å°äº1ï¼Œä¹Ÿå¯èƒ½å‡ºç°æ¢¯åº¦æ¶ˆå¤±çš„é—®é¢˜softpluså¦ä¸€ä¸ªä¸åŒäº reluçš„åœ°æ–¹åœ¨äºå…¶ä¸å¯¹ç§°æ€§ï¼Œä¸ä»¥é›¶ä¸ºä¸­å¿ƒï¼Œå¯èƒ½ä¼šå¦¨ç¢å­¦ä¹ Maxoutç­‰å¾…â€¦Swishå°†Sigmoidå‡½æ•°ä¸çº¿æ€§å‡½æ•°çš„ä¹˜ç§¯ä½œä¸ºæ¿€æ´»å‡½æ•°ï¼Œå¹³è¡¡äº†éçº¿æ€§å’Œçº¿æ€§è¡¨è¾¾èƒ½åŠ›MishMish: A Self Regularized Non-Monotonic Neural Activation Function 2020SoftSignä¼˜ç‚¹ï¼šsoftsignæ˜¯ tanhæ¿€æ´»å‡½æ•°çš„å¦ä¸€ä¸ªæ›¿ä»£é€‰æ‹©softsignæ˜¯åå¯¹ç§°ã€å»ä¸­å¿ƒã€å¯å¾®åˆ†ï¼Œå¹¶è¿”å›âˆ’1å’Œ1ä¹‹é—´çš„å€¼softsignæ›´å¹³å¦çš„æ›²çº¿ä¸æ›´æ…¢çš„ä¸‹é™å¯¼æ•°è¡¨æ˜å®ƒå¯ä»¥æ›´é«˜æ•ˆåœ°å­¦ä¹ ç¼ºç‚¹ï¼šå¯¼æ•°çš„è®¡ç®—æ¯”tanhæ›´éº»çƒ¦æ¿€æ´»å‡½æ•°çš„é€‰æ‹©é€‰æ‹©ä¸€ä¸ªé€‚åˆçš„æ¿€æ´»å‡½æ•°å¹¶ä¸å®¹æ˜“ï¼Œéœ€è¦è€ƒè™‘å¾ˆå¤šå› ç´ ï¼Œé€šå¸¸çš„åšæ³•æ˜¯ï¼Œå¦‚æœä¸ç¡®å®šå“ªä¸€ä¸ªæ¿€æ´»å‡½æ•°æ•ˆæœæ›´å¥½ï¼Œå¯ä»¥æŠŠå®ƒä»¬éƒ½è¯•è¯•ï¼Œç„¶åçœ‹çœ‹åœ¨éªŒè¯é›†æˆ–è€…æµ‹è¯•é›†ä¸Šçš„æ•ˆæœç„¶åçœ‹å“ªä¸€ç§è¡¨ç°çš„æ›´å¥½ï¼Œå°±å»ä½¿ç”¨å®ƒä»¥ä¸‹æ˜¯å¸¸è§çš„é€‰æ‹©æƒ…å†µï¼šå¦‚æœè¾“å‡ºæ˜¯0ã€1å€¼(äºŒåˆ†ç±»é—®é¢˜)ï¼Œåˆ™è¾“å‡ºå±‚é€‰æ‹©Sigmoidå‡½æ•°ï¼Œç„¶åå…¶å®ƒçš„æ‰€æœ‰å•å…ƒéƒ½é€‰æ‹©ReLUå‡½æ•°å¦‚æœåœ¨éšè—å±‚ä¸Šä¸ç¡®å®šä½¿ç”¨å“ªä¸ªæ¿€æ´»å‡½æ•°ï¼Œé‚£ä¹ˆé€šå¸¸ä¼šä½¿ç”¨ReLUæ¿€æ´»å‡½æ•°ã€‚æœ‰æ—¶ï¼Œä¹Ÿä¼šä½¿ç”¨Tanhæ¿€æ´»å‡½æ•°Sigmoidæ¿€æ´»å‡½æ•°ï¼šé™¤äº†è¾“å‡ºå±‚æ˜¯ä¸€ä¸ªäºŒåˆ†ç±»é—®é¢˜åŸºæœ¬ä¸ä¼šç”¨å®ƒTanhæ¿€æ´»å‡½æ•°ï¼šTanhæ˜¯éå¸¸ä¼˜ç§€çš„ï¼Œå‡ ä¹é€‚åˆæ‰€æœ‰åœºåˆReLUæ¿€æ´»å‡½æ•°ï¼šæœ€å¸¸ç”¨çš„é»˜è®¤å‡½æ•°ï¼Œå¦‚æœä¸ç¡®å®šç”¨å“ªä¸ªæ¿€æ´»å‡½æ•°ï¼Œå°±ä½¿ç”¨ReLUæˆ–è€…Leaky ReLUï¼Œå†å»å°è¯•å…¶ä»–çš„æ¿€æ´»å‡½æ•°å¦‚æœé‡åˆ°äº†ä¸€äº›æ­»çš„ç¥ç»å…ƒï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ Leaky ReLUå‡½æ•°</content>
	</entry>
	<entry>
		<title>æ·±åº¦å­¦ä¹ æ ¸å¿ƒåŸºç¡€çŸ¥è¯†ç‚¹</title>
		<url>/article/6384.html</url>
		<content>åŸºç¡€çŸ¥è¯†ç®€å•è¯´æ˜ä¸‹æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ çš„ä¸»è¦åŒºåˆ«ï¼šæ¨¡å‹ç»“æ„ï¼šä¸€èˆ¬æ·±åº¦å­¦ä¹ åŸºäºæ·±åº¦ç¥ç»ç½‘ç»œæ¶æ„è¾ƒä¸ºå¤æ‚åŒ–è‡ªåŠ¨æå–ç‰¹å¾ï¼šä¼ ç»Ÿæœºå™¨å­¦ä¹ éœ€è¦äººå·¥æ„é€ ç‰¹å¾ä½†æ·±åº¦å­¦ä¹ åŸºäºç¥ç»ç½‘ç»œè‡ªåŠ¨æå–ç‰¹å¾æ•°æ®é‡ï¼šæ·±åº¦å­¦ä¹ éœ€è¦å¤§é‡çš„æ•°æ®é›†æ¥è®­ç»ƒå¤šå±‚ç¥ç»ç½‘ç»œåå‘ä¼ æ’­ç®—æ³•åå‘ä¼ æ’­(Backpropagation)ç®—æ³•æ˜¯ä¸€ç§ç”¨äºè®¡ç®—ç¥ç»ç½‘ç»œä¸­å„ä¸ªå‚æ•°æ¢¯åº¦çš„æ–¹æ³•ï¼Œå®ƒåŸºäºé“¾å¼æ³•åˆ™å’Œæ¢¯åº¦ä¸‹é™ç®—æ³•ï¼Œä¸‹é¢æ˜¯åå‘ä¼ æ’­ç®—æ³•çš„åŸºæœ¬æ­¥éª¤ï¼šå‰å‘ä¼ æ’­(Forward Propagation)ï¼šè¾“å…¥ä¸€ä¸ªæ ·æœ¬ï¼Œé€šè¿‡ç¥ç»ç½‘ç»œçš„å‰å‘ä¼ æ’­è®¡ç®—å¾—åˆ°é¢„æµ‹è¾“å‡ºé€å±‚è®¡ç®—æ¯ä¸ªç¥ç»å…ƒçš„è¾“å‡ºå€¼ï¼Œç›´è‡³è¾“å‡ºå±‚åœ¨å‰å‘ä¼ æ’­è¿‡ç¨‹ä¸­ï¼Œå°†æ¯ä¸€å±‚çš„è¾“å…¥ã€æƒé‡å’Œæ¿€æ´»å‡½æ•°çš„ç»“æœä¿å­˜ä¸‹æ¥ï¼Œç”¨äºåç»­çš„åå‘ä¼ æ’­è®¡ç®—è®¡ç®—æŸå¤±å‡½æ•°(Loss Calculation)ï¼šæ ¹æ®é¢„æµ‹è¾“å‡ºå’ŒçœŸå®æ ‡ç­¾è®¡ç®—æŸå¤±å‡½æ•°çš„å€¼å¸¸è§çš„æŸå¤±å‡½æ•°åŒ…æ‹¬å‡æ–¹è¯¯å·®(Mean Squared Error)ã€äº¤å‰ç†µæŸå¤±(Cross-Entropy Loss)ç­‰åå‘ä¼ æ’­è®¡ç®—æ¢¯åº¦(Backward Propagation)ï¼šä»è¾“å‡ºå±‚å¼€å§‹ï¼Œæ ¹æ®é“¾å¼æ³•åˆ™è®¡ç®—æ¯ä¸ªå‚æ•°çš„æ¢¯åº¦é€å±‚å‘åä¼ æ’­ï¼Œé€šè¿‡é“¾å¼æ³•åˆ™å°†ä¸Šä¸€å±‚çš„æ¢¯åº¦ä¹˜ä»¥å½“å‰å±‚çš„å±€éƒ¨æ¢¯åº¦ï¼Œå¾—åˆ°å½“å‰å±‚çš„æ¢¯åº¦æ ¹æ®æ¢¯åº¦ä¸‹é™ç®—æ³•æ›´æ–°ç½‘ç»œå‚æ•°å‚æ•°æ›´æ–°(Parameter Update)ï¼šæ ¹æ®è®¡ç®—å¾—åˆ°çš„æ¢¯åº¦å€¼ï¼Œä½¿ç”¨æ¢¯åº¦ä¸‹é™ç®—æ³•æˆ–å…¶å˜ç§æ–¹æ³•æ¥æ›´æ–°ç½‘ç»œçš„å‚æ•°å¸¸è§çš„æ¢¯åº¦ä¸‹é™ç®—æ³•åŒ…æ‹¬éšæœºæ¢¯åº¦ä¸‹é™(Stochastic Gradient Descentï¼ŒSGD)ã€åŠ¨é‡æ³•(Momentum)ã€Adamç­‰é‡å¤ä»¥ä¸Šæ­¥éª¤ï¼šå¯¹äºæ¯ä¸ªè®­ç»ƒæ ·æœ¬ï¼Œé‡å¤æ‰§è¡Œå‰å‘ä¼ æ’­ã€æŸå¤±è®¡ç®—ã€åå‘ä¼ æ’­å’Œå‚æ•°æ›´æ–°çš„æ­¥éª¤è¿­ä»£è®­ç»ƒè¿‡ç¨‹ç›´åˆ°è¾¾åˆ°é¢„è®¾çš„åœæ­¢æ¡ä»¶ï¼Œå¦‚è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•°æˆ–æŸå¤±å‡½æ•°æ”¶æ•›æ³¨æ„ï¼Œåå‘ä¼ æ’­ç®—æ³•ä¼šé‡å¤åˆ©ç”¨å‰å‘ä¼ æ’­ä¸­å­˜å‚¨çš„ä¸­é—´å€¼ï¼Œä»¥é¿å…é‡å¤è®¡ç®—ï¼Œå› æ­¤ï¼Œéœ€è¦ä¿ç•™å‰å‘ä¼ æ’­çš„ä¸­é—´ç»“æœï¼Œè¿™ä¹Ÿä¼šå¯¼è‡´æ¨¡å‹è®­ç»ƒæ¯”å•çº¯çš„é¢„æµ‹éœ€è¦æ›´å¤šçš„å†…å­˜(æ˜¾å­˜)åŒæ—¶è¿™äº›ä¸­é—´ç»“æœå ç”¨å†…å­˜(æ˜¾å­˜)å¤§å°ä¸ç½‘ç»œå±‚çš„æ•°é‡å’Œæ‰¹é‡(batch_size)å¤§å°æˆæ­£æ¯”å› æ­¤ä½¿ç”¨å¤§batch_sizeè®­ç»ƒæ›´æ·±å±‚æ¬¡çš„ç½‘ç»œæ›´å®¹æ˜“å¯¼è‡´å†…å­˜ä¸è¶³(out of memory)çš„é”™è¯¯åå‘ä¼ æ’­ç®—æ³•é€šè¿‡æœ‰æ•ˆåœ°è®¡ç®—æ¯ä¸ªå‚æ•°çš„æ¢¯åº¦ï¼Œä½¿å¾—ç¥ç»ç½‘ç»œå¯ä»¥é€šè¿‡æ¢¯åº¦ä¸‹é™ç­‰ä¼˜åŒ–æ–¹æ³•æ¥ä¸æ–­æ›´æ–°å‚æ•°ä»¥æœ€å°åŒ–æŸå¤±å‡½æ•°è¿™æ ·ï¼Œç¥ç»ç½‘ç»œå¯ä»¥é€æ­¥ä¼˜åŒ–è‡ªèº«çš„æƒé‡å’Œåç½®ï¼Œä»è€Œæé«˜æ¨¡å‹çš„æ€§èƒ½å’Œå‡†ç¡®åº¦æ·±åº¦å­¦ä¹ ä¼˜åŒ–å­˜åœ¨è®¸å¤šæŒ‘æˆ˜ï¼Œå…¶ä¸­ä¸€äº›æœ€ä»¤äººçƒ¦æ¼çš„æ˜¯å±€éƒ¨æœ€å°å€¼ã€éç‚¹å’Œæ¢¯åº¦æ¶ˆå¤±å±€éƒ¨æœ€å°å€¼(local minimum): å¯¹äºä»»ä½•ç›®æ ‡å‡½æ•°$f(x)$ï¼Œå¦‚æœåœ¨$x$å¤„å¯¹åº”çš„$f(x)$å€¼å°äºåœ¨$x$é™„è¿‘ä»»ä½•å…¶ä»–ç‚¹çš„$f(x)$å€¼ï¼Œé‚£ä¹ˆ$f(x)$å¯èƒ½æ˜¯å±€éƒ¨æœ€å°å€¼å¦‚æœ$f(x)$åœ¨$x$å¤„çš„å€¼æ˜¯æ•´ä¸ªåŸŸä¸Šç›®æ ‡å‡½æ•°çš„æœ€å°å€¼ï¼Œé‚£ä¹ˆ$f(x)$æ˜¯å…¨å±€æœ€å°å€¼éç‚¹(saddle point): æŒ‡å‡½æ•°çš„æ‰€æœ‰æ¢¯åº¦éƒ½æ¶ˆå¤±ä½†æ—¢ä¸æ˜¯å…¨å±€æœ€å°å€¼ä¹Ÿä¸æ˜¯å±€éƒ¨æœ€å°å€¼çš„ä»»ä½•ä½ç½®æ¢¯åº¦æ¶ˆå¤±(vanishing gradient): å› ä¸ºæŸäº›åŸå› å¯¼è‡´ç›®æ ‡å‡½æ•°$f$çš„æ¢¯åº¦æ¥è¿‘é›¶(å³æ¢¯åº¦æ¶ˆå¤±é—®é¢˜)ï¼Œæ˜¯åœ¨å¼•å…¥ReLUæ¿€æ´»å‡½æ•°å’ŒResNetä¹‹å‰è®­ç»ƒæ·±åº¦å­¦ä¹ æ¨¡å‹ç›¸å½“æ£˜æ‰‹çš„åŸå› ä¹‹ä¸€åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œå¤§å¤šæ•°ç›®æ ‡å‡½æ•°éƒ½å¾ˆå¤æ‚ï¼Œæ²¡æœ‰è§£æè§£ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬éœ€ä½¿ç”¨æ•°å€¼ä¼˜åŒ–ç®—æ³•æ¢¯åº¦æ¶ˆå¤±å’Œçˆ†ç‚¸æ¢¯åº¦ä¸ç¨³å®šçš„åŸå› ï¼šæ ¸å¿ƒåœ¨äºé“¾å¼æ³•åˆ™ï¼Œå‰é¢å±‚ä¸Šçš„æ¢¯åº¦æ˜¯æ¥è‡ªåé¢å±‚ä¸Šæ¢¯åº¦çš„ä¹˜ç§¯ã€‚å½“å­˜åœ¨è¿‡å¤šçš„å±‚æ—¶ï¼Œå°±ä¼šå‡ºç°æ¢¯åº¦ä¸ç¨³å®šåœºæ™¯ï¼Œæ¯”å¦‚æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸æ¢¯åº¦çˆ†ç‚¸åœ¨åå‘ä¼ æ’­è¿‡ç¨‹ä¸­éœ€è¦å¯¹æ¿€æ´»å‡½æ•°è¿›è¡Œæ±‚å¯¼ï¼Œå¦‚æœå¯¼æ•°å¤§äº1ï¼Œé‚£ä¹ˆéšç€ç½‘ç»œå±‚æ•°çš„å¢åŠ æ¢¯åº¦æ›´æ–°å°†ä¼šæœç€æŒ‡æ•°çˆ†ç‚¸çš„æ–¹å¼å¢åŠ è¿™å°±æ˜¯æ¢¯åº¦çˆ†ç‚¸æ¢¯åº¦æ¶ˆå¤±åŒæ ·å¦‚æœå¯¼æ•°å°äº1ï¼Œé‚£ä¹ˆéšç€ç½‘ç»œå±‚æ•°çš„å¢åŠ æ¢¯åº¦æ›´æ–°ä¿¡æ¯ä¼šæœç€æŒ‡æ•°è¡°å‡çš„æ–¹å¼å‡å°‘è¿™å°±æ˜¯æ¢¯åº¦æ¶ˆå¤±æ ¹æœ¬åŸå› æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸ï¼Œå…¶æ ¹æœ¬åŸå› åœ¨äºåå‘ä¼ æ’­è®­ç»ƒæ³•åˆ™ï¼Œå±äºå…ˆå¤©ä¸è¶³è®¡ç®—æƒå€¼æ›´æ–°ä¿¡æ¯çš„æ—¶å€™éœ€è¦è®¡ç®—å‰å±‚åå¯¼ä¿¡æ¯ï¼Œå› æ­¤å¦‚æœæ¿€æ´»å‡½æ•°é€‰æ‹©ä¸åˆé€‚æ¯”å¦‚ä½¿ç”¨sigmoidï¼Œæ¢¯åº¦æ¶ˆå¤±å°±ä¼šå¾ˆæ˜æ˜¾äº†ï¼Œå¦‚æœä½¿ç”¨sigmoidä½œä¸ºæŸå¤±å‡½æ•°ï¼Œå…¶æ¢¯åº¦æ˜¯ä¸å¯èƒ½è¶…è¿‡0.25ï¼Œè¿™æ ·ç»è¿‡é“¾å¼æ±‚å¯¼ä¹‹åï¼Œå¾ˆå®¹æ˜“å‘ç”Ÿæ¢¯åº¦æ¶ˆå¤±è§£å†³æ–¹æ¡ˆæ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸æ˜¯åœ¨ç¥ç»ç½‘ç»œè®­ç»ƒè¿‡ç¨‹ä¸­å¸¸è§çš„é—®é¢˜ï¼Œå¯èƒ½å¯¼è‡´æ¨¡å‹æ”¶æ•›å›°éš¾æˆ–æ— æ³•æœ‰æ•ˆæ›´æ–°æƒé‡ã€‚ä¸‹é¢æ˜¯æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸çš„äº§ç”ŸåŸå› å’Œè§£å†³æ–¹æ³•ï¼šæ¢¯åº¦æ¶ˆå¤±(Gradient Vanishing)åŸå› ï¼šåœ¨æ·±å±‚ç¥ç»ç½‘ç»œä¸­ï¼Œæ¢¯åº¦é€šè¿‡å¤šä¸ªå±‚ä¼ é€’æ—¶å¯èƒ½ä¼šé€æ¸è¡°å‡ã€‚ç‰¹åˆ«æ˜¯ä½¿ç”¨å…·æœ‰å°æ¢¯åº¦çš„æ¿€æ´»å‡½æ•°(å¦‚Sigmoidã€Tanh)æ—¶ï¼Œæ¢¯åº¦æ¶ˆå¤±é—®é¢˜æ›´ä¸ºä¸¥é‡è§£å†³æ–¹æ³•ï¼šå¤§æ¢¯åº¦çš„æ¿€æ´»å‡½æ•°ï¼šé€‰æ‹©å…·æœ‰è¾ƒå¤§æ¢¯åº¦çš„æ¿€æ´»å‡½æ•°ï¼Œå¦‚ReLUã€Leaky ReLUç­‰å‚æ•°åˆå§‹åŒ–ï¼šåˆç†åˆå§‹åŒ–æƒé‡ï¼Œé¿å…åˆå§‹æ¢¯åº¦è¿‡å°æˆ–è¿‡å¤§æ‰¹å½’ä¸€åŒ–(Batch Normalization)ï¼šé€šè¿‡å¯¹æ¯ä¸€å±‚çš„è¾“å…¥è¿›è¡Œå½’ä¸€åŒ–ï¼Œå¯ä»¥ä½¿å¾—æ¿€æ´»å‡½æ•°è¾“å…¥å€¼çš„åˆ†å¸ƒæ›´ç¨³å®šï¼Œæœ‰åŠ©äºç¼“è§£æ¢¯åº¦æ¶ˆå¤±é—®é¢˜æ®‹å·®è¿æ¥(Residual Connections)ï¼šå¼•å…¥è·¨å±‚çš„ç›´æ¥è¿æ¥ï¼Œä½¿å¾—æ¢¯åº¦å¯ä»¥æ›´å®¹æ˜“åœ°é€šè¿‡ç½‘ç»œä¼ æ’­ï¼Œä¾‹å¦‚ResNetä¸­çš„æ®‹å·®è¿æ¥ç»“æ„æ¢¯åº¦çˆ†ç‚¸(Gradient Explosion)åŸå› ï¼šåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ¢¯åº¦å¯èƒ½ä¼šæŒ‡æ•°çº§å¢é•¿ï¼Œå¯¼è‡´æ•°å€¼æº¢å‡ºè§£å†³æ–¹æ³•ï¼šæ¢¯åº¦è£å‰ª(Gradient Clipping)ï¼šé™åˆ¶æ¢¯åº¦çš„èŒƒå›´ï¼Œé€šè¿‡è®¾ç½®é˜ˆå€¼æˆ–ç¼©æ”¾æ¢¯åº¦æ¥é˜²æ­¢æ¢¯åº¦çˆ†ç‚¸å‚æ•°åˆå§‹åŒ–ï¼šåˆç†åˆå§‹åŒ–æƒé‡ï¼Œé¿å…åˆå§‹æ¢¯åº¦è¿‡å¤§ä½¿ç”¨ç¨€ç–è¿æ¥ï¼šå‡å°‘ç½‘ç»œä¸­çš„è¿æ¥æ•°é‡ï¼Œå¯ä»¥é™ä½æ¢¯åº¦çˆ†ç‚¸çš„é£é™©æ›´å°çš„å­¦ä¹ ç‡ï¼šé™ä½å­¦ä¹ ç‡ï¼Œä½¿å¾—æ¢¯åº¦æ›´æ–°æ›´åŠ ç¨³å®šæ­£åˆ™åŒ–æ–¹æ³•å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šç¼“è§£æ¢¯åº¦çˆ†ç‚¸å’Œæ¢¯åº¦æ¶ˆå¤±çš„é—®é¢˜æ€»çš„æ¥è¯´ï¼Œè§£å†³æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸é—®é¢˜çš„æ–¹æ³•åŒ…æ‹¬é€‰æ‹©åˆé€‚çš„æ¿€æ´»å‡½æ•°ã€å‚æ•°åˆå§‹åŒ–ç­–ç•¥ã€æ‰¹å½’ä¸€åŒ–ã€æ®‹å·®è¿æ¥ã€æ¢¯åº¦è£å‰ªç­‰éœ€è¦æ ¹æ®å…·ä½“æƒ…å†µç»¼åˆè€ƒè™‘å¹¶é€‚å½“è°ƒæ•´è¿™äº›æ–¹æ³•ä»¥æé«˜è®­ç»ƒçš„ç¨³å®šæ€§å’Œæ•ˆæœæ³›åŒ–é—®é¢˜è¿‡æ‹Ÿåˆ(Over fitting)å’Œæ¬ æ‹Ÿåˆ(Under fitting)æ˜¯æŒ‡æœºå™¨å­¦ä¹ æ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å¯¹è®­ç»ƒæ•°æ®çš„æ‹Ÿåˆç¨‹åº¦ä¸åˆé€‚çš„é—®é¢˜è¿‡æ‹Ÿåˆç°è±¡è¿‡æ‹ŸåˆæŒ‡çš„æ˜¯æ¨¡å‹è¿‡äºå¤æ‚ï¼Œè¿‡åº¦é€‚åº”äº†è®­ç»ƒæ•°æ®çš„ç‰¹å¾ï¼Œå¯¼è‡´åœ¨æ–°çš„æœªè§è¿‡çš„æ•°æ®ä¸Šè¡¨ç°ä¸ä½³è¿‡æ‹Ÿåˆçš„è¡¨ç°æ˜¯åœ¨è®­ç»ƒæ•°æ®ä¸Šè¡¨ç°å‡ºè¾ƒå¥½çš„æ‹Ÿåˆæ•ˆæœï¼Œä½†åœ¨æµ‹è¯•æ•°æ®ä¸Šçš„è¡¨ç°è¾ƒå·®è¿‡æ‹Ÿåˆçš„åŸå› å¯èƒ½æ˜¯æ¨¡å‹è¿‡äºå¤æ‚ï¼Œå‚æ•°è¿‡å¤šï¼Œå¯¼è‡´æ¨¡å‹å…·æœ‰å¾ˆå¼ºçš„è®°å¿†èƒ½åŠ›è€Œå¿½ç•¥äº†æ•°æ®çš„çœŸå®è§„å¾‹äº§ç”ŸåŸå› æ¨¡å‹å¤ªå¤æ‚: è®­ç»ƒé›†çš„æ•°é‡çº§å’Œæ¨¡å‹çš„å¤æ‚åº¦ä¸åŒ¹é…ï¼Œè®­ç»ƒé›†çš„æ•°é‡çº§è¦å°äºæ¨¡å‹çš„å¤æ‚åº¦ç‰¹å¾åˆ†å¸ƒä¸ä¸€è‡´: è®­ç»ƒé›†å’Œæµ‹è¯•é›†ç‰¹å¾åˆ†å¸ƒä¸ä¸€è‡´å­¦ä¹ åˆ°å™ªéŸ³: æ ·æœ¬é‡Œçš„å™ªéŸ³æ•°æ®å¹²æ‰°è¿‡å¤§ï¼Œå¤§åˆ°æ¨¡å‹è¿‡åˆ†çš„è®°ä½äº†å™ªéŸ³ç‰¹å¾ï¼Œè€Œå¿½ç•¥äº†çœŸå®çš„è¾“å…¥è¾“å‡ºé—´çš„å…³ç³»è¿­ä»£è¿‡å¤š: æƒå€¼å­¦ä¹ è¿­ä»£æ¬¡æ•°è¶³å¤Ÿå¤š(Over training)ï¼Œæ‹Ÿåˆäº†è®­ç»ƒæ•°æ®ä¸­çš„å™ªå£°å’Œè®­ç»ƒæ ·ä¾‹ä¸­æ²¡æœ‰ä»£è¡¨æ€§çš„ç‰¹å¾è§£å†³æ–¹æ¡ˆç®€åŒ–æ¨¡å‹: ä½¿å…¶é€‚åˆè‡ªå·±è®­ç»ƒé›†çš„æ•°é‡çº§(ç¼©å°å®½åº¦å’Œå‡å°æ·±åº¦)ï¼Œä½¿æ¨¡å‹æ›´å¥½åœ°å­¦ä¹ æ•°æ®çš„çœŸå®åˆ†å¸ƒæ•°æ®å¢å¼º: è®­ç»ƒé›†è¶Šå¤šï¼Œè¿‡æ‹Ÿåˆçš„æ¦‚ç‡è¶Šå°ã€‚åœ¨è®¡ç®—æœºè§†è§‰é¢†åŸŸä¸­ï¼Œå¢å¹¿çš„æ–¹å¼æ˜¯å¯¹å›¾åƒæ—‹è½¬ï¼Œç¼©æ”¾ï¼Œå‰ªåˆ‡ï¼Œæ·»åŠ å™ªå£°ç­‰æ­£åˆ™åŒ–: æŒ‡é€šè¿‡å¼•å…¥é¢å¤–æ–°ä¿¡æ¯æ¥è§£å†³è¿‡æ‹Ÿåˆé—®é¢˜çš„ä¸€ç§ï¼Œè¿™ç§é¢å¤–ä¿¡æ¯é€šå¸¸çš„å½¢å¼æ˜¯æ¨¡å‹å¤æ‚æ€§å¸¦æ¥çš„æƒ©ç½šåº¦ã€‚æ­£åˆ™åŒ–å¯ä»¥ä¿æŒæ¨¡å‹ç®€å•dropout: åœ¨è®­ç»ƒçš„æ—¶å€™è®©ç¥ç»å…ƒä»¥ä¸€å®šæ¦‚ç‡ä¸å·¥ä½œEarly stopping: è¿­ä»£æ¬¡æ•°æˆªæ–­çš„æ–¹æ³•æ¥é˜²æ­¢è¿‡æ‹Ÿåˆçš„ï¼Œå³åœ¨æ¨¡å‹å¯¹è®­ç»ƒæ•°æ®é›†è¿­ä»£æ”¶æ•›ä¹‹å‰åœæ­¢è¿­ä»£æ¥é˜²æ­¢è¿‡æ‹Ÿåˆæ¬ æ‹Ÿåˆç°è±¡æ¬ æ‹ŸåˆæŒ‡çš„æ˜¯æ¨¡å‹è¿‡äºç®€å•ï¼Œä¸èƒ½å¾ˆå¥½åœ°æ‹Ÿåˆè®­ç»ƒæ•°æ®çš„ç‰¹å¾ï¼Œå¯¼è‡´åœ¨è®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®ä¸Šçš„è¡¨ç°éƒ½ä¸ä½³æ¬ æ‹Ÿåˆçš„è¡¨ç°æ˜¯æ¨¡å‹æ— æ³•æ•æ‰åˆ°æ•°æ®ä¸­çš„å¤æ‚å…³ç³»æˆ–è§„å¾‹ï¼Œæ— æ³•å¾ˆå¥½åœ°æ‹Ÿåˆè®­ç»ƒæ•°æ®æ¬ æ‹Ÿåˆçš„åŸå› å¯èƒ½æ˜¯æ¨¡å‹è¿‡äºç®€å•ï¼Œå‚æ•°è¿‡å°‘ï¼Œæ— æ³•å……åˆ†å­¦ä¹ æ•°æ®çš„ç‰¹å¾äº§ç”ŸåŸå› æ¨¡å‹å¤æ‚åº¦ä¸è¶³ï¼šæ¨¡å‹çš„å¤æ‚åº¦ä¸è¶³ä»¥æ•æ‰æ•°æ®ä¸­çš„å¤æ‚å…³ç³»ã€‚ä¾‹å¦‚ï¼Œçº¿æ€§æ¨¡å‹æ— æ³•å¾ˆå¥½åœ°æ‹Ÿåˆéçº¿æ€§æ•°æ®ï¼Œå¯¼è‡´æ¬ æ‹Ÿåˆç‰¹å¾æå–ä¸è¶³ï¼šç‰¹å¾æå–ä¸è¶³æ„å‘³ç€æ¨¡å‹æ— æ³•ä»åŸå§‹æ•°æ®ä¸­æå–å‡ºæœ‰ç”¨çš„ç‰¹å¾ã€‚å¦‚æœç‰¹å¾ä¸å…·å¤‡è¾ƒå¼ºçš„åŒºåˆ†æ€§ï¼Œæ¨¡å‹å°±æ— æ³•å¾ˆå¥½åœ°è¿›è¡Œæ‹Ÿåˆæ•°æ®é‡ä¸è¶³ï¼šå½“è®­ç»ƒæ•°æ®è¾ƒå°‘æ—¶ï¼Œæ¨¡å‹éš¾ä»¥å­¦ä¹ æ•°æ®çš„çœŸå®åˆ†å¸ƒå’Œè§„å¾‹ã€‚æœ‰é™çš„æ•°æ®æ ·æœ¬å¯èƒ½æ— æ³•æä¾›è¶³å¤Ÿçš„ä¿¡æ¯æ¥è®­ç»ƒä¸€ä¸ªå¤æ‚çš„æ¨¡å‹è¿‡åº¦æ­£åˆ™åŒ–ï¼šè¿‡åº¦æ­£åˆ™åŒ–å¯ä»¥å¯¼è‡´æ¨¡å‹è¿‡äºç®€å•ï¼Œæ— æ³•å¾ˆå¥½åœ°æ‹Ÿåˆè®­ç»ƒæ•°æ®ã€‚ä¾‹å¦‚ï¼Œå¼ºåˆ¶æ–½åŠ è¾ƒå¼ºçš„æ­£åˆ™åŒ–é¡¹æˆ–ä½¿ç”¨è¾ƒé«˜çš„æ­£åˆ™åŒ–ç³»æ•°ä¼šé™åˆ¶æ¨¡å‹çš„çµæ´»æ€§æ•°æ®å™ªå£°ï¼šå½“è®­ç»ƒæ•°æ®ä¸­å­˜åœ¨å™ªå£°æˆ–é”™è¯¯æ ‡ç­¾æ—¶ï¼Œæ¨¡å‹å¯èƒ½ä¼šè¿‡äºå…³æ³¨è¿™äº›å¼‚å¸¸æ ·æœ¬ï¼Œä»è€Œå¯¼è‡´æ¬ æ‹Ÿåˆè§£å†³æ–¹æ¡ˆç‰¹å¾å·¥ç¨‹: æ¬ æ‹Ÿåˆæ˜¯ç”±äºå­¦ä¹ ä¸è¶³ï¼Œå¯ä»¥è€ƒè™‘æ·»åŠ ç‰¹å¾ï¼Œä»æ•°æ®ä¸­æŒ–æ˜æ›´å¤šçš„ç‰¹å¾ï¼Œæœ‰æ—¶å€™è¿˜éœ€è¦å¯¹ç‰¹å¾è¿›è¡Œå˜æ¢ï¼Œä½¿ç”¨ç»„åˆç‰¹å¾å’Œé«˜æ¬¡ç‰¹å¾æ›´å¼ºçš„æ¨¡å‹: æ¨¡å‹ç®€å•ä¹Ÿä¼šå¯¼è‡´æ¬ æ‹Ÿåˆï¼Œå¦‚çº¿æ€§æ¨¡å‹åªèƒ½æ‹Ÿåˆä¸€æ¬¡å‡½æ•°çš„æ•°æ®ï¼Œå°è¯•ä½¿ç”¨æ›´é«˜çº§çš„æ¨¡å‹æœ‰åŠ©äºè§£å†³æ¬ æ‹Ÿåˆè°ƒæ•´è¶…å‚æ•°: è°ƒæ•´æ¨¡å‹çš„è¶…å‚æ•°ï¼Œå¦‚å­¦ä¹ ç‡ã€æ­£åˆ™åŒ–ç³»æ•°ç­‰ï¼Œä»¥è·å¾—æ›´å¥½çš„æ¨¡å‹æ‹Ÿåˆæ•ˆæœæ ¸å¿ƒç½‘ç»œå±‚å…¨è¿æ¥å±‚ç­‰å¾…â€¦Convå·ç§¯æ“ä½œä¸€æ–‡è¯¦è§£å„ç§å·ç§¯æ“ä½œpytorchä¸­å·ç§¯ç½‘ç»œçš„å‡ ç§å·ç§¯å’Œæ± åŒ–pytorchå®˜ç½‘å…³äºcnnçš„è¯´æ˜å·ç§¯æ“ä½œæ˜¯ç¥ç»ç½‘ç»œä¸­å¸¸ç”¨çš„æ“ä½œä¹‹ä¸€ï¼Œç‰¹åˆ«æ˜¯åœ¨å›¾åƒå¤„ç†å’Œè®¡ç®—æœºè§†è§‰ä»»åŠ¡ä¸­å·ç§¯æ“ä½œé€šè¿‡å°†è¾“å…¥æ•°æ®ä¸å·ç§¯æ ¸(ä¹Ÿç§°ä¸ºæ»¤æ³¢å™¨)è¿›è¡Œé€å…ƒç´ ç›¸ä¹˜ï¼Œå¹¶å°†ç»“æœè¿›è¡Œæ±‚å’Œï¼Œä»è€Œäº§ç”Ÿè¾“å‡ºç‰¹å¾å›¾åœ¨å·ç§¯ç¥ç»ç½‘ç»œ(Convolutional Neural Networkï¼ŒCNN)ä¸­ï¼Œå·ç§¯æ“ä½œç”¨äºæå–è¾“å…¥æ•°æ®ä¸­çš„å±€éƒ¨ç‰¹å¾ï¼Œå®ƒåˆ©ç”¨äº†ç‰¹å¾çš„å±€éƒ¨ç›¸å…³æ€§å’Œå¹³ç§»ä¸å˜æ€§å±€éƒ¨ç›¸å…³æ€§: å±€éƒ¨ç›¸å…³æ€§æŒ‡çš„æ˜¯æ¯ä¸ªç¥ç»å…ƒåªä¸è¾“å…¥æ•°æ®çš„ä¸€å°å—åŒºåŸŸè¿æ¥ï¼Œå¯ä»¥æ•æ‰åˆ°è¾“å…¥æ•°æ®çš„å±€éƒ¨ç‰¹å¾ï¼Œå‡å°‘äº†å‚æ•°æ•°é‡ï¼Œé™ä½äº†è®¡ç®—å¤æ‚åº¦å¹³ç§»ä¸å˜æ€§: å¹³ç§»ä¸å˜æ€§æŒ‡çš„æ˜¯å®ƒå¯¹è¾“å…¥æ•°æ®çš„å¹³ç§»å…·æœ‰ä¸å˜æ€§ï¼Œå·ç§¯å±‚å¯ä»¥é€šè¿‡å…±äº«æƒé‡å’Œå±€éƒ¨è¿æ¥çš„æ–¹å¼æ¥æå–ç‰¹å¾ï¼Œä»è€Œä½¿å¾—å¯¹äºä¸åŒä½ç½®çš„ç‰©ä½“èƒ½å¤Ÿäº§ç”Ÿç›¸ä¼¼çš„ç‰¹å¾è¡¨ç¤ºå·ç§¯è¾“å‡ºå¤§å°è®¡ç®—å…¬å¼å…¶ä¸­$L_{in}$è¡¨ç¤ºè¾“å…¥çš„ç‰¹å¾å¤§å°ï¼Œ$padding$æ˜¯å¡«å……ï¼Œæ˜¯å·ç§¯æ ¸å¤§å°ï¼Œ$stride$æ˜¯æ­¥é•¿ä¸€ç»´å·ç§¯åœ¨çº¿å¯è§†åŒ–äºŒç»´å·ç§¯åœ¨çº¿å¯è§†åŒ–æ™®é€šå·ç§¯æ·±åº¦å­¦ä¹ ä¸­å·ç§¯çš„æ¦‚å¿µä¸ä¿¡å·å¤„ç†é¢†åŸŸçš„å·ç§¯ç›¸ä¼¼(åªæ˜¯æ·±åº¦å­¦ä¹ çš„å·ç§¯åœ¨è¿ç®—è¿‡ç¨‹ä¸­çš„æ»¤æ³¢å™¨ä¸ç»è¿‡ç¿»è½¬)ï¼Œå·ç§¯æ ¸ä»¥ä¸€å®šçš„æ­¥é•¿åœ¨è¾“å…¥å›¾ç‰‡ä¸Šæ»‘åŠ¨ï¼Œæ¯ä¸€æ­¥éƒ½å°†å¯¹åº”å…ƒç´ ç›¸ä¹˜åæ±‚å’Œçš„è¿‡ç¨‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºå·ç§¯æ ¸å¤§å°(kernel_size)å·ç§¯æ ¸å¤§å°å®šä¹‰äº†å·ç§¯çš„è§†å›¾ï¼Œæ ¹æ®å·ç§¯æ ¸çš„å¤§å°ï¼Œå¸¸è§çš„å·ç§¯å°ºå¯¸æœ‰1Ã—1å·ç§¯ã€3Ã—3 å·ç§¯ã€5Ã—5å·ç§¯ã€7Ã—7å·ç§¯ç­‰å·ç§¯ï¼šé€šå¸¸ç”¨äºè¾“å‡ºç»´åº¦çš„å‡ç»´æˆ–é™ç»´ã€‚è‹¥ç‰¹å¾å›¾æ˜¯å°ºå¯¸æ˜¯ï¼Œå·ç§¯æ ¸å°ºå¯¸æ˜¯ï¼Œè¾“å‡ºé€šé“å°ºå¯¸æ˜¯ã€‚å½“æˆ‘ä»¬å°†æ¬¡å·ç§¯ç»“æœè¿æ¥åœ¨ä¸€èµ·æ—¶ï¼Œå¯ä»¥å¾—åˆ°çš„è¾“å‡ºï¼Œä»è€Œå®ç°å‡ç»´æˆ–é™ç»´çš„åŠŸèƒ½å·ç§¯ï¼šç”±äºå¤§å°ºå¯¸çš„å·ç§¯æ ¸çš„å‚æ•°é‡è¾ƒå¤§ï¼Œç ”ç©¶äººå‘˜å‘ç°ä¸¤ä¸ªå·ç§¯çš„å †å ï¼Œæ„Ÿå—é‡ç­‰åŒäºä¸€ä¸ªå·ç§¯ï¼Œä½†æ˜¯å‚æ•°é‡å´å‡å°‘äº†ï¼Œæ‰€ä»¥ä»VGGçš„æ—¶ä»£å¼€å§‹ï¼ŒåŸºæœ¬åé¢çš„ç½‘ç»œéƒ½ç¦»ä¸å¼€å®ƒçš„èº«å½±å·ç§¯ï¼šå·ç§¯æ ¸è¶Šå¤§ï¼Œæ„Ÿå—é‡è¶Šå¤§ï¼Œçœ‹åˆ°çš„å›¾ç‰‡ä¿¡æ¯è¶Šå¤šï¼Œæ‰€è·å¾—çš„å…¨å±€ç‰¹å¾è¶Šå¥½ã€‚ä½†æ˜¯è¿™æ ·å‚æ•°å¾ˆå¤šï¼Œä¼šå¯¼è‡´è®¡ç®—é‡æš´å¢ï¼Œå±‚æ¬¡å°‘ä¸åˆ©äºæ¨¡å‹æ·±åº¦çš„å¢åŠ ï¼Œè¡¨è¾¾èƒ½åŠ›å¼±ã€‚æ‰€ä»¥æˆ‘ä»¬ä¼šçœ‹åˆ°åœ¨æ—©æœŸçš„ç½‘ç»œä¼šå‡ºç°å¤§å·ç§¯æ ¸çš„å †å ï¼Œæˆ–è€…å½“ä¸‹ç ”ç©¶äººå‘˜ä¸€èˆ¬å°†å¤§å°ºå¯¸å·ç§¯æ”¾åœ¨å¯¹è¾“å…¥å›¾ç‰‡çš„åˆå§‹æ“ä½œå¤„(åŒç†)æ­¥é•¿(stride)æ ¸çš„æ­¥é•¿å®šä¹‰äº†å·ç§¯æ ¸åœ¨å›¾åƒä¸­ç§»åŠ¨çš„æ¯ä¸€æ­¥çš„å¤§å°ï¼Œä»£è¡¨æå–çš„ç²¾åº¦ï¼Œé€šå¸¸ä¸º1ï¼Œä¹Ÿå¯ä»¥ç”¨å¤§äºç­‰äº2çš„æ­¥é•¿ï¼Œå¯¹å›¾åƒè¿›è¡Œä¸‹é‡‡æ ·ï¼Œæ›¿ä»£æ± åŒ–æ“ä½œå¡«å……(padding)å·ç§¯æ ¸ä¸è¾“å…¥å›¾åƒçš„å°ºå¯¸ä¸åŒ¹é…ï¼Œè¿™æ—¶å°±éœ€è¦å¡«å……å›¾åƒï¼Œä¾‹å¦‚è¾“å…¥å›¾ç‰‡å°ºå¯¸ä¸ºï¼Œå·ç§¯æ ¸çš„å¤§å°ä¸ºå¦‚æœä¸è¿›è¡Œå¡«å……ï¼Œæ­¥é•¿ä¸º1çš„è¯ï¼Œå½“å·ç§¯æ ¸æ²¿ç€å›¾ç‰‡æ»‘åŠ¨ååªèƒ½æ»‘åŠ¨å‡ºä¸€ä¸ªçš„å›¾ç‰‡å‡ºæ¥ï¼Œå·ç§¯åçš„å›¾ç‰‡è¶Šå˜è¶Šå°ï¼Œä¸”è¾“å…¥å›¾ç‰‡è¾¹ç¼˜åƒç´ åªè¢«è®¡ç®—è¿‡ä¸€æ¬¡è€Œä¸­é—´åƒç´ ä¼šè¢«å·ç§¯è®¡ç®—å¤šæ¬¡ï¼Œæ„å‘³ç€ä¸¢å¤±å›¾åƒè§’è½ä¿¡æ¯ï¼Œæ‰€ä»¥ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œéœ€è¦å…ˆå¯¹åŸå§‹å›¾ç‰‡åšè¾¹ç•Œå¡«å……å¤„ç†3Då·ç§¯3Då·ç§¯çš„å·ç§¯æ ¸å¯ä»¥åœ¨è¾“å…¥å›¾åƒçš„3ä¸ªæ–¹å‘ï¼Œå³å›¾åƒçš„é«˜åº¦ï¼Œå®½åº¦ï¼Œæ·±åº¦ä¸Šç§»åŠ¨ã€‚å¹¶ä¸äºŒç»´å·ç§¯ç±»ä¼¼ï¼Œåœ¨æ¯ä¸ªä½ç½®å„å…ƒç´ å…ˆç›¸ä¹˜å†ç›¸åŠ ï¼Œæœ€åè¾“å‡ºä¸€ä¸ª3Dæ•°æ®å·ç§¯ç‰¹æ€§ï¼šç›¸æ¯”äºæ™®é€šçš„äºŒç»´å·ç§¯ï¼Œå¤šäº†ä¸€ä¸ªç»´åº¦(æ·±åº¦)ï¼Œå¯ä»¥æŠŠè¿™ä¸ªæ·±åº¦å½“ä½œè§†é¢‘ä¸­çš„è¿ç»­å¸§ï¼Œæˆ–è€…æ˜¯ç«‹ä½“å›¾åƒä¸­çš„ä¸åŒçš„åˆ‡ç‰‡ã€‚ä½†æ˜¯å…¶å‚æ•°é‡è¾ƒå¤§ï¼Œä¼šå»¶ç¼“ç½‘ç»œçš„æ¨ç†é€Ÿåº¦åº”ç”¨åœºæ™¯ï¼š3Då·ç§¯å¸¸åº”ç”¨åœ¨è§†é¢‘åˆ†ç±»ã€åŒ»å­¦å½±åƒã€ç‚¹äº‘å¤„ç†ç­‰é¢†åŸŸã€‚æ¯”å¦‚ç»å…¸çš„VoxelNetç½‘ç»œå°±é‡‡ç”¨3D CNNæå–ç‚¹äº‘çš„ä½“ç´ ç‰¹å¾åšç›®æ ‡æ£€æµ‹ä»»åŠ¡æ‰©å¼ å·ç§¯(è†¨èƒ€ã€ç©ºæ´)æ‰©å¼ å·ç§¯(Dilated Convolution)ï¼Œä¹Ÿç§°ä¸ºç©ºæ´å·ç§¯(Atrous Convolution)ï¼Œæœ€æ—©æ˜¯ç”±DeepLabå›¢é˜Ÿæå‡ºçš„DeepLabæ˜¯ç”±Google Brainå¼€å‘çš„ä¸€ç§ç”¨äºå›¾åƒè¯­ä¹‰åˆ†å‰²çš„æ·±åº¦å­¦ä¹ æ¶æ„ï¼Œéšåï¼Œæ‰©å¼ å·ç§¯è¢«å¹¿æ³›åº”ç”¨äºå…¶ä»–è®¡ç®—æœºè§†è§‰ä»»åŠ¡ï¼Œå¦‚å›¾åƒè¶…åˆ†è¾¨ç‡ã€ç›®æ ‡æ£€æµ‹ã€å›¾åƒç”Ÿæˆå’Œå›¾åƒä¿®å¤ç­‰æ‰©å¼ å·ç§¯çš„ä¸»è¦ç›®çš„æ˜¯å¢åŠ å·ç§¯æ“ä½œçš„æ„Ÿå—é‡ï¼Œä»è€Œæ•æ‰æ›´å¤§èŒƒå›´çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ä¼ ç»Ÿçš„å·ç§¯æ“ä½œå…·æœ‰å›ºå®šçš„å·ç§¯æ ¸å°ºå¯¸å’Œæ­¥å¹…ï¼Œé™åˆ¶äº†æ„Ÿå—é‡çš„å¤§å°ã€‚è€Œæ‰©å¼ å·ç§¯é€šè¿‡åœ¨å·ç§¯æ ¸çš„å…ƒç´ ä¹‹é—´å¼•å…¥å›ºå®šçš„é—´éš”(æ‰©å¼ ç‡æˆ–ç©ºæ´ç‡)ï¼Œä½¿å¾—å·ç§¯æ ¸åœ¨è¾“å…¥ç‰¹å¾å›¾ä¸Šçš„é‡‡æ ·é—´éš”æ‰©å¤§ï¼Œä»è€Œå®ç°æ„Ÿå—é‡çš„æ‰©å¤§æ‰©å¼ å·ç§¯æœ€åˆç”¨äºå›¾åƒè¯­ä¹‰åˆ†å‰²ä»»åŠ¡ï¼Œæ—¨åœ¨æé«˜åˆ†å‰²ç»“æœçš„ç²¾åº¦ã€‚è¯­ä¹‰åˆ†å‰²éœ€è¦å°†å›¾åƒä¸­çš„æ¯ä¸ªåƒç´ åˆ†ç±»åˆ°ä¸åŒçš„è¯­ä¹‰ç±»åˆ«ä¸­ï¼Œå› æ­¤éœ€è¦å……åˆ†è€ƒè™‘åƒç´ å‘¨å›´çš„ä¸Šä¸‹æ–‡ä¿¡æ¯é€šè¿‡ä½¿ç”¨æ‰©å¼ å·ç§¯ï¼ŒDeepLabå›¢é˜Ÿå¯ä»¥æ›´å¥½åœ°æ•æ‰åƒç´ ä¹‹é—´çš„é•¿è·ç¦»ä¾èµ–å…³ç³»ï¼Œæé«˜åˆ†å‰²æ¨¡å‹å¯¹ç»†ç²’åº¦è¾¹ç•Œå’Œå°å°ºå¯¸ç‰©ä½“çš„æ„ŸçŸ¥èƒ½åŠ›å®ƒåœ¨è¿™äº›ä»»åŠ¡ä¸­çš„åº”ç”¨ä¸»è¦æ˜¯ä¸ºäº†å¢åŠ æ„Ÿå—é‡ã€æé«˜åˆ†è¾¨ç‡å’Œå®ç°å¤šå°ºåº¦ç‰¹å¾èåˆï¼Œä»¥å¢å¼ºæ¨¡å‹çš„æ„ŸçŸ¥èƒ½åŠ›å’Œè¡¨è¾¾èƒ½åŠ›æ‰©å¼ çš„å¥½å¤„ï¼šä½¿å¾—åœ¨ç›¸åŒçš„è®¡ç®—æˆæœ¬ä¸‹ï¼Œé¿å…å› æ± åŒ–æŸå¤±ä¿¡æ¯è€Œå¢å¤§äº†æ„Ÿå—é‡è†¨èƒ€å·ç§¯ä½¿ç”¨çš„æ–¹æ³•è¿ç»­ä½¿ç”¨å¤šä¸ªè†¨èƒ€å·ç§¯æ—¶åº”è¯¥å¦‚ä½•è®¾è®¡å®ƒçš„è†¨èƒ€ç³»æ•°å°†è†¨èƒ€ç³»æ•°è®¾ç½®ä¸ºé”¯é½¿å½¢çŠ¶ï¼Œä¾‹å¦‚[1,2,3,1,2,3]å…¬çº¦æ•°ä¸èƒ½å¤§äº1ï¼Œæ¯”å¦‚å¯ä»¥æ˜¯[1,2,3]ï¼Œè€Œä¸æ˜¯[2,4,8]åˆ†ç»„å·ç§¯åˆ†ç»„å·ç§¯ï¼ˆGroup Convolutionï¼‰Depthwiseå·ç§¯ä¸Pointwiseå·ç§¯åˆ†ç»„å·ç§¯æœ€å¼€å§‹è¢«ä½¿ç”¨åœ¨ç»å…¸å…¥é—¨å·ç§¯ç¥ç»ç½‘ç»œAlexNetä¸Šï¼Œç”¨äºè§£å†³æ˜¾å­˜ä¸è¶³çš„é—®é¢˜ã€‚åœ¨ç°åœ¨è¢«å¹¿æ³›ç”¨äºå„ç§è½»é‡åŒ–æ¨¡å‹ä¸­ï¼Œç”¨äºå‡å°‘è¿ç®—é‡å’Œå‚æ•°é‡ï¼Œå…¶ä¸­åº”ç”¨æœ€å¹¿çš„å°±æ˜¯æ·±åº¦å¯åˆ†ç¦»å·ç§¯(Depthwise Separable Convolution)Depthwiseå·ç§¯(æ·±åº¦å·ç§¯)å’ŒPointwiseå·ç§¯(é€ç‚¹å·ç§¯)Depthwiseå·ç§¯(æ·±åº¦å·ç§¯)å’ŒPointwiseå·ç§¯(é€ç‚¹å·ç§¯)æ˜¯MobileNetç­‰è½»é‡çº§ç¥ç»ç½‘ç»œä¸­å¸¸ç”¨çš„å·ç§¯æ“ä½œå·ç§¯ï¼Œåˆèµ·æ¥è¢«ç§°ä½œDepthwise Separable Convolution(å‚è§Googleçš„Xception)ï¼Œè¯¥ç»“æ„å’Œå¸¸è§„å·ç§¯æ“ä½œç±»ä¼¼ï¼Œå¯ç”¨æ¥æå–ç‰¹å¾ï¼Œä½†ç›¸æ¯”äºå¸¸è§„å·ç§¯æ“ä½œï¼Œå…¶å‚æ•°é‡å’Œè¿ç®—æˆæœ¬è¾ƒä½ã€‚æ‰€ä»¥åœ¨ä¸€äº›è½»é‡çº§ç½‘ç»œä¸­ä¼šç¢°åˆ°è¿™ç§ç»“æ„å¦‚MobileNetå¯ä»¥å°†æ·±åº¦å·ç§¯å’Œé€ç‚¹å·ç§¯ç»“åˆä½¿ç”¨ï¼Œä½œä¸ºåˆ†ç»„å·ç§¯çš„ä¸€ç§å®ç°æ–¹å¼ï¼Œä»¥æé«˜æ¨¡å‹çš„è®¡ç®—æ•ˆç‡å’Œå‚æ•°æ•ˆç‡æ·±åº¦å·ç§¯ç”¨äºæ•æ‰ç©ºé—´ä¸Šçš„ç›¸å…³ä¿¡æ¯ï¼Œé€ç‚¹å·ç§¯ç”¨äºæ•´åˆå’Œè½¬æ¢é€šé“é—´çš„ç‰¹å¾å…³ç³»ã€‚è¿™æ ·çš„ç»„åˆå¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šå‡å°‘è®¡ç®—é‡ï¼Œå¹¶ä¿æŒæ¨¡å‹çš„è¡¨è¾¾èƒ½åŠ›ä¼ ç»Ÿå’Œåˆ†ç»„å·ç§¯çš„æ¯”è¾ƒåœ¨ä¼ ç»Ÿçš„å·ç§¯æ“ä½œä¸­ï¼Œè¾“å…¥ç‰¹å¾å›¾çš„æ¯ä¸ªé€šé“éƒ½ä¸å·ç§¯æ ¸çš„æ¯ä¸ªé€šé“è¿›è¡Œå·ç§¯è¿ç®—ï¼Œè¾“å‡ºçš„ç‰¹å¾å›¾æ˜¯æ‰€æœ‰é€šé“çš„å åŠ åœ¨åˆ†ç»„å·ç§¯ä¸­ï¼Œå°†è¾“å…¥ç‰¹å¾å›¾å’Œå·ç§¯æ ¸åˆ†æˆå¤šä¸ªç»„ï¼Œæ¯ä¸ªç»„ä¸­çš„é€šé“è¿›è¡Œç‹¬ç«‹çš„å·ç§¯è¿ç®—ï¼Œæœ€åå°†å„ç»„çš„è¾“å‡ºç‰¹å¾å›¾è¿›è¡Œè¿æ¥ï¼Œå¾—åˆ°æœ€ç»ˆçš„è¾“å‡ºç»“æœå·¦å›¾æ˜¯æ™®é€šçš„å·ç§¯ï¼Œå³å›¾æ˜¯åˆ†ç»„å·ç§¯å¯¹äºå°ºå¯¸ä¸ºçš„è¾“å…¥çŸ©é˜µï¼Œå½“æ ‡å‡†å·ç§¯æ ¸çš„å°ºå¯¸ä¸ºï¼Œå…±æœ‰ä¸ªæ ‡å‡†å·ç§¯æ ¸æ—¶ï¼Œæ ‡å‡†å·ç§¯ä¼šå¯¹å®Œæ•´çš„è¾“å…¥æ•°æ®è¿›è¡Œè¿ç®—ï¼Œæœ€ç»ˆå¾—åˆ°çš„è¾“å‡ºçŸ©é˜µå°ºå¯¸ä¸º ã€‚è¿™é‡Œæˆ‘ä»¬å‡è®¾å·ç§¯è¿ç®—å‰åçš„ç‰¹å¾å›¾å°ºå¯¸ä¿æŒä¸å˜ï¼Œåˆ™ä¸Šè¿°è¿‡ç¨‹å¯ä»¥å±•ç¤ºä¸ºå·¦å›¾åˆ†ç»„å·ç§¯ä¸­ï¼Œé€šè¿‡æŒ‡å®šç»„æ•°æ¥ç¡®å®šåˆ†ç»„æ•°é‡ï¼Œå°†è¾“å…¥æ•°æ®åˆ†æˆç»„ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œçš„åˆ†ç»„æŒ‡çš„æ˜¯åœ¨æ·±åº¦ä¸Šè¿›è¡Œåˆ†ç»„ï¼Œè¾“å…¥çš„å®½å’Œé«˜ä¿æŒä¸å˜ï¼Œå³å°†æ¯ä¸ªé€šé“çš„æ•°æ®åˆ†ä¸ºä¸€ç»„ã€‚å› ä¸ºè¾“å…¥æ•°æ®å‘ç”Ÿäº†æ”¹å˜ï¼Œç›¸åº”çš„å·ç§¯æ ¸ä¹Ÿéœ€è¦è¿›è¡Œå¯¹åº”çš„å˜åŒ–ï¼Œå³æ¯ä¸ªå·ç§¯æ ¸çš„è¾“å…¥é€šé“æ•°ä¹Ÿå°±å˜ä¸ºäº†ï¼Œè€Œå·ç§¯æ ¸çš„å¤§å°æ˜¯ä¸éœ€è¦æ”¹å˜çš„åŒæ—¶ï¼Œæ¯ç»„çš„å·ç§¯æ ¸ä¸ªæ•°ä¹Ÿç”±åŸæ¥çš„å˜ä¸ºã€‚å¯¹äºæ¯ä¸ªç»„å†…çš„å·ç§¯è¿ç®—ï¼ŒåŒæ ·é‡‡ç”¨æ ‡å‡†å·ç§¯è¿ç®—çš„è®¡ç®—æ–¹å¼ï¼Œè¿™æ ·å°±å¯ä»¥å¾—åˆ°ç»„å°ºå¯¸ä¸ºçš„è¾“å‡ºçŸ©é˜µï¼Œæœ€ç»ˆå°†è¿™ç»„è¾“å‡ºçŸ©é˜µè¿›è¡Œæ‹¼æ¥å°±å¯ä»¥å¾—åˆ°æœ€ç»ˆçš„ç»“æœã€‚è¿™æ ·æ‹¼æ¥å®Œæˆåï¼Œæœ€ç»ˆçš„è¾“å‡ºå°ºå¯¸å°±å¯ä»¥ä¿æŒä¸å˜ï¼Œä»ç„¶æ˜¯ã€‚åˆ†ç»„å·ç§¯çš„è¿ç®—è¿‡ç¨‹å¦‚å³å›¾æ‰€ç¤ºåˆ†ç»„å·ç§¯çš„ä¸»è¦ä¼˜ç‚¹æ˜¯å‡å°‘äº†è®¡ç®—é‡å’Œå‚æ•°æ•°é‡ï¼Œå› ä¸ºæ¯ä¸ªç»„å†…çš„å·ç§¯æ“ä½œæ˜¯ç‹¬ç«‹è¿›è¡Œçš„ï¼Œç›¸å½“äºå°†æ•´ä¸ªå·ç§¯æ“ä½œæ‹†åˆ†æˆäº†å¤šä¸ªè¾ƒå°çš„å·ç§¯æ“ä½œè¿™åœ¨ä¸€äº›è®¡ç®—èµ„æºæœ‰é™çš„æƒ…å†µä¸‹ï¼Œå¦‚ç§»åŠ¨è®¾å¤‡æˆ–åµŒå…¥å¼ç³»ç»Ÿä¸­ï¼Œå¯ä»¥æ˜¾è‘—å‡å°‘è®¡ç®—æˆæœ¬ï¼Œæé«˜æ¨¡å‹çš„é€Ÿåº¦å’Œæ•ˆç‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåˆ†ç»„å·ç§¯çš„ä½¿ç”¨éœ€è¦åœ¨è€ƒè™‘è®¡ç®—æ•ˆç‡çš„åŒæ—¶æƒè¡¡æ¨¡å‹æ€§èƒ½ã€‚åˆ†ç»„å·ç§¯å¯èƒ½ä¼šæŸå¤±ä¸€å®šçš„è¡¨ç¤ºèƒ½åŠ›ï¼Œç‰¹åˆ«æ˜¯å¯¹äºé‚£äº›å…·æœ‰è·¨é€šé“ç›¸å…³æ€§çš„ç‰¹å¾å› æ­¤ï¼Œåœ¨è®¾è®¡ç½‘ç»œç»“æ„æ—¶ï¼Œéœ€è¦æ ¹æ®ä»»åŠ¡çš„éœ€æ±‚å’Œèµ„æºçš„é™åˆ¶æ¥é€‰æ‹©åˆé€‚çš„åˆ†ç»„æ•°å’Œç»„å†…é€šé“æ•°ï¼Œä»¥åœ¨æ•ˆç‡å’Œå‡†ç¡®æ€§ä¹‹é—´æ‰¾åˆ°å¹³è¡¡ç‚¹åå·ç§¯(è½¬ç½®)UNet Architecture BreakdownPytorch è½¬ç½®å·ç§¯è½¬ç½®å·ç§¯(Transposed Convolution)ï¼Œä¹Ÿç§°ä¸ºåå·ç§¯(Deconvolution)ï¼Œæ˜¯å·ç§¯ç¥ç»ç½‘ç»œä¸­å¸¸ç”¨çš„ä¸€ç§æ“ä½œå®ƒä¸æ ‡å‡†å·ç§¯æ“ä½œç›¸åï¼Œç”¨äºå°†ä½ç»´ç‰¹å¾æ˜ å°„æ‰©å±•ä¸ºé«˜ç»´ç‰¹å¾æ˜ å°„åœ¨ä¼ ç»Ÿçš„å·ç§¯æ“ä½œä¸­ï¼Œè¾“å…¥ç‰¹å¾å›¾é€šè¿‡å·ç§¯æ ¸è¿›è¡Œå·ç§¯è¿ç®—ï¼Œå¾—åˆ°è¾“å‡ºç‰¹å¾å›¾ã€‚è€Œè½¬ç½®å·ç§¯åˆ™æ˜¯é€šè¿‡å¯¹è¾“å‡ºç‰¹å¾å›¾åº”ç”¨åå‘å·ç§¯æ“ä½œï¼Œä»¥é‡å»ºé«˜ç»´ç‰¹å¾æ˜ å°„è½¬ç½®å·ç§¯å¸¸ç”¨äºä»¥ä¸‹å‡ ä¸ªä»»åŠ¡å’Œåº”ç”¨ä¸­ï¼šå›¾åƒç”Ÿæˆï¼šè½¬ç½®å·ç§¯è¢«å¹¿æ³›åº”ç”¨äºå›¾åƒç”Ÿæˆä»»åŠ¡ï¼Œå¦‚å›¾åƒç”Ÿæˆã€å›¾åƒä¿®å¤ç­‰ã€‚é€šè¿‡å°†ä½ç»´ç‰¹å¾æ˜ å°„è½¬æ¢ä¸ºé«˜ç»´ç‰¹å¾æ˜ å°„ï¼Œå¯ä»¥ç”Ÿæˆå…·æœ‰æ›´é«˜åˆ†è¾¨ç‡å’Œæ›´å¤šç»†èŠ‚çš„å›¾åƒå›¾åƒåˆ†å‰²ï¼šåœ¨å›¾åƒåˆ†å‰²ä»»åŠ¡ä¸­ï¼Œè½¬ç½®å·ç§¯å¸¸ç”¨äºå°†ä½åˆ†è¾¨ç‡çš„è¯­ä¹‰ç‰¹å¾æ˜ å°„æ¢å¤åˆ°ä¸è¾“å…¥å›¾åƒç›¸åŒçš„å°ºå¯¸ï¼Œä»¥è·å¾—åƒç´ çº§åˆ«çš„åˆ†å‰²ç»“æœç›®æ ‡æ£€æµ‹ï¼šè½¬ç½®å·ç§¯åœ¨ç›®æ ‡æ£€æµ‹ä»»åŠ¡ä¸­è¢«ç”¨äºç”Ÿæˆé«˜åˆ†è¾¨ç‡çš„ç‰¹å¾æ˜ å°„ï¼Œä»¥ä¾¿æ›´å‡†ç¡®åœ°å®šä½å’Œè¯†åˆ«ç›®æ ‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè½¬ç½®å·ç§¯çš„åç§°å¯èƒ½ä¼šå¼•èµ·ä¸€äº›è¯¯è§£ï¼Œå› ä¸ºå®ƒå®é™…ä¸Šå¹¶ä¸æ˜¯çœŸæ­£çš„å·ç§¯æ“ä½œçš„é€†è¿ç®—ã€‚è½¬ç½®å·ç§¯çš„åç§°èµ·æºäºå…¶ä¸å·ç§¯æ“ä½œçš„ç›¸ä¼¼æ€§ï¼Œä½†å…¶è®¡ç®—è¿‡ç¨‹ä¸å·ç§¯å¹¶ä¸å®Œå…¨ç›¸åŒåœ¨ç¥ç»ç½‘ç»œä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦ä¸Šé‡‡æ ·æ¥æé«˜ä½åˆ†è¾¨ç‡å›¾ç‰‡çš„åˆ†è¾¨ç‡ã€‚è€Œè½¬ç½®å·ç§¯å°±å¯ä»¥ä½œä¸ºä¸€ç§é€šè¿‡å·ç§¯å­¦ä¹ å‚æ•°ï¼Œä»è€Œè·å¾—æœ€ä¼˜ä¸Šé‡‡æ ·çš„æ–¹æ³•å¯è§†åŒ–è§£é‡Šä¸‹å›¾æ˜¯ä¸€ä¸ª$4 \times 4$çš„è¾“å…¥çŸ©é˜µï¼Œç”¨$3 \times 3$çš„å·ç§¯æ ¸è¿›è¡Œæ²¡æœ‰å¡«å……ï¼Œæ­¥é•¿ä¸º1çš„å·ç§¯æ“ä½œï¼Œç»“æœæ˜¯ä¸€ä¸ª$2 \times 2$çš„çŸ©é˜µæˆ‘ä»¬å°†$3 \times 3$çš„å·ç§¯æ ¸é‡æ’ä¸º$4 \times 16$çš„å½¢å¼(ä¸‹å›¾ç¬¬ä¸€é¡¹)ï¼ŒåŒæ—¶å°†$4 \times 4$çš„è¾“å…¥çŸ©é˜µå±•å¼€ä¸º$16 \times 1$çš„åˆ—å‘é‡çš„å½¢å¼(ä¸‹å›¾ç¬¬äºŒé¡¹)ã€‚é€šè¿‡çŸ©é˜µä¹˜æ³•å¾—åˆ°ä¸€ä¸ª$4 \times 1$çš„åˆ—å‘é‡ï¼Œå¯ä»¥çœ‹å‡ºè¿™ä¸ªåˆ—å‘é‡æ­£æ˜¯ç”±ä¸Šå›¾çš„$2 \times 2$å·ç§¯è¾“å‡ºçŸ©é˜µå±•å¼€å¾—åˆ°çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥å°†å·ç§¯æ“ä½œå†™æˆçŸ©é˜µä¹˜æ³•è¿ç®—é€šè¿‡è¿™æ ·çš„æ“ä½œï¼Œå¯ä»¥æŠŠ16($4 \times 4$çš„çŸ©é˜µ)ä¸ªå€¼æ˜ å°„ä¸º4($2 \times 2$çš„çŸ©é˜µ)ä¸ªå€¼ï¼Œé‚£ä¹ˆå°†è¿™ä¸ªæ“ä½œåè¿‡æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠ4($2 \times 2$çš„çŸ©é˜µ)ä¸ªå€¼æ˜ å°„ä¸º16($4 \times 4$çš„çŸ©é˜µ)æœ€åå°†è¾“å‡ºçŸ©é˜µå¯ä»¥reshapeä¸º$4 \times 4$çš„å½¢å¼å·ç§¯ç‰¹å¾ï¼šè™½ç„¶è½¬ç½®å·ç§¯èƒ½å¤Ÿé€šè¿‡å­¦ä¹ å‚æ•°è¿›è¡Œæœ€ä¼˜çš„ä¸Šé‡‡æ ·ï¼Œä½†æ˜¯å®é™…åº”ç”¨ä¸­ï¼Œç ”ç©¶äººå‘˜å¾€å¾€æ›´åŠ å€¾å‘äºä½¿ç”¨çº¿æ€§æ’å€¼çš„æ–¹å¼åšä¸Šé‡‡æ ·ï¼Œæ•ˆç‡æ›´é«˜å¯åˆ†ç¦»å·ç§¯ç©ºé—´å¯åˆ†ç¦»å·ç§¯ç©ºé—´å¯åˆ†ç¦»å·ç§¯ä¸»è¦å¤„ç†å›¾åƒå’Œå·ç§¯æ ¸çš„ç©ºé—´ç»´åº¦ï¼šå®½åº¦å’Œé«˜åº¦å°†ä¸€ä¸ªå·ç§¯æ ¸åˆ’åˆ†ä¸ºä¸¤ä¸ªè¾ƒå°çš„å·ç§¯æ ¸ï¼Œå¦‚å°†$3 \times 3$çš„å·ç§¯æ ¸åˆ†ä¸º$3 \times 1$å’Œ$1 \times 3$çš„å·ç§¯æ ¸ï¼Œå†ä¾æ¬¡è¿›è¡Œå·ç§¯å¦‚æ­¤ï¼Œåˆ™å¯ä»¥å°†ä¸€æ¬¡å·ç§¯çš„9æ¬¡ä¹˜æ³•å‡å°‘ä¸ºä¸¤æ¬¡å·ç§¯å…±6æ¬¡ä¹˜æ³•ï¼Œå‡å°‘è®¡ç®—é‡ï¼Œä»è€ŒåŠ å¿«ç½‘ç»œè¿è¡Œé€Ÿåº¦æ·±åº¦å¯åˆ†ç¦»å·ç§¯æ·±åº¦å¯åˆ†ç¦»å·ç§¯ä¸ä»…æ¶‰åŠç©ºé—´ç»´åº¦ï¼Œè¿˜å¯¹æ·±åº¦ç»´åº¦è¿›è¡Œå¤„ç†ã€‚å®ƒä¸»è¦åˆ†ä¸ºä¸¤ä¸ªè¿‡ç¨‹ï¼Œåˆ†åˆ«ä¸ºé€é€šé“å·ç§¯å’Œé€ç‚¹å·ç§¯é€é€šé“å·ç§¯: é€é€šé“å·ç§¯çš„å·ç§¯æ ¸ä¸é€šé“æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œæ‰€ä»¥è¾“å‡ºçš„ç‰¹å¾å›¾ç‰‡çš„æ·±åº¦å’Œè¾“å…¥çš„æ·±åº¦å®Œå…¨ä¸€æ ·é€ç‚¹å·ç§¯: é€ç‚¹å·ç§¯çš„è¿ç®—ä¸å¸¸è§„å·ç§¯è¿ç®—ç›¸ä¼¼ï¼Œå®ƒçš„å·ç§¯æ ¸çš„å°ºå¯¸ä¸º$1 \times 1 \times M$ï¼Œ$M$ä¸ºä¸Šä¸€å±‚çš„æ·±åº¦ã€‚å®ƒæ˜¯å°†ä¸Šä¸€æ­¥çš„ç‰¹å¾å›¾åœ¨æ·±åº¦æ–¹å‘ä¸Šè¿›è¡ŒåŠ æƒç›¸åŠ ï¼Œç”Ÿæˆæ–°çš„ç‰¹å¾å›¾,æœ‰å‡ ä¸ªå·ç§¯æ ¸å°±æœ‰å‡ å±‚æ–°çš„ç‰¹å¾å›¾è¾“å‡ºå·ç§¯ç‰¹æ€§ï¼šæ·±åº¦å¯åˆ†ç¦»å·ç§¯çš„ä¼˜åŠ¿åœ¨äºéœ€è¦æå–çš„å±æ€§è¶Šå¤šï¼Œå°±èƒ½å¤ŸèŠ‚çœè¶Šå¤šçš„å‚æ•°ï¼Œå‡å°‘è®¡ç®—é‡ã€‚æœ€æ—©å‡ºç°åœ¨mobilenetä¸­ï¼Œä¹Ÿæ˜¯ç”¨äºè½»é‡åŒ–ç½‘ç»œçš„ç‰¹å¾æå–éƒ¨åˆ†ï¼Œä½¿åµŒå…¥å¼éƒ¨ç½²çš„ç¥ç»ç½‘ç»œæ¨ç†æ›´å¿«é€Ÿç›¸è¾ƒäºä¼ ç»Ÿçš„æ ‡å‡†å·ç§¯ï¼Œå®ƒåªéœ€è¦å¯¹æ¯ä¸ªé€šé“è¿›è¡Œå·ç§¯æ“ä½œï¼Œè€Œä¸æ˜¯å¯¹æ¯ä¸ªé€šé“å’Œæ¯ä¸ªä½ç½®éƒ½è¿›è¡Œå·ç§¯æ“ä½œã€‚å› æ­¤ï¼Œå®ƒèƒ½å¤Ÿåœ¨ä¿æŒæ¨¡å‹æ€§èƒ½çš„åŒæ—¶ï¼Œæ˜¾è‘—å‡å°‘è®¡ç®—å¼€é”€ï¼Œç‰¹åˆ«é€‚ç”¨äºè½»é‡çº§æ¨¡å‹å’Œè®¡ç®—èµ„æºå—é™çš„åœºæ™¯å¯åˆ†ç¦»å·ç§¯å¸¸ç”¨äºç§»åŠ¨è®¾å¤‡ã€åµŒå…¥å¼è®¾å¤‡å’Œè®¡ç®—èµ„æºæœ‰é™çš„ç¯å¢ƒä¸­ï¼Œå¦‚ç§»åŠ¨ç«¯çš„å›¾åƒåˆ†ç±»ã€ç›®æ ‡æ£€æµ‹ã€è¯­ä¹‰åˆ†å‰²ç­‰ä»»åŠ¡é€šè¿‡é‡‡ç”¨å¯åˆ†ç¦»å·ç§¯ï¼Œå¯ä»¥å®ç°è½»é‡çº§çš„æ¨¡å‹ç»“æ„ï¼Œæé«˜æ¨¡å‹çš„è®¡ç®—æ•ˆç‡å’Œé€Ÿåº¦ï¼ŒåŒæ—¶é™ä½æ¨¡å‹çš„å­˜å‚¨ç©ºé—´å’Œå†…å­˜æ¶ˆè€—å¯å˜å½¢å·ç§¯Deformable Convolutional Networks 2017å¯å˜å½¢å·ç§¯(Deformable Convolution)æ˜¯ä¸€ç§å…·æœ‰è‡ªé€‚åº”æ„Ÿå—é‡çš„å·ç§¯æ“ä½œï¼Œèƒ½å¤Ÿæ›´å¥½åœ°æ•æ‰å›¾åƒä¸­éåˆšæ€§å½¢å˜çš„ç‰¹å¾ã€‚ä¸ä¼ ç»Ÿçš„å·ç§¯æ“ä½œç›¸æ¯”ï¼Œå¯å˜å½¢å·ç§¯å¼•å…¥äº†å¯å­¦ä¹ çš„åç§»å‚æ•°ï¼Œç”¨äºè°ƒæ•´å·ç§¯æ ¸åœ¨è¾“å…¥ç‰¹å¾å›¾ä¸Šçš„é‡‡æ ·ä½ç½®åœ¨ä¼ ç»Ÿçš„å·ç§¯æ“ä½œä¸­ï¼Œå·ç§¯æ ¸çš„é‡‡æ ·ä½ç½®æ˜¯å›ºå®šçš„ï¼Œå¯¹è¾“å…¥ç‰¹å¾å›¾çš„ä¸åŒåŒºåŸŸåº”ç”¨ç›¸åŒçš„é‡‡æ ·æ¨¡å¼ã€‚è€Œå¯å˜å½¢å·ç§¯é€šè¿‡åœ¨æ¯ä¸ªä½ç½®å¼•å…¥åç§»å‚æ•°ï¼Œä½¿å¾—å·ç§¯æ ¸å¯ä»¥è‡ªé€‚åº”åœ°è°ƒæ•´é‡‡æ ·ä½ç½®ï¼Œä»è€Œé€‚åº”ä¸åŒåŒºåŸŸçš„éåˆšæ€§å½¢å˜æ€è·¯å¯å˜å½¢å·ç§¯æ˜¯ä¸€ç§å·ç§¯æ ¸å†…éƒ¨ç‚¹æŒ‰ä¸è§„åˆ™çš„æ–¹å¼ç»„åˆï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º(a)æ™®é€šå·ç§¯é‡‡æ ·çš„9ä¸ªç‚¹(ç»¿ç‚¹)ï¼›(b)(c)(d)éƒ½ä¸ºå¯å˜å½¢å·ç§¯ï¼Œåœ¨æ™®é€šå·ç§¯é‡‡æ ·åæ ‡ä¸ŠåŠ ä¸Šä¸€ä¸ªä½ç§»é‡(è“è‰²ç®­å¤´)ï¼Œå¾—åˆ°å˜å½¢çš„é‡‡æ ·ä½ç½®(æ·±è“ç‚¹)å¯¹äºè¾“å…¥çš„ä¸€å¼ ç‰¹å¾å›¾ï¼ŒæŠŠæ™®é€šå·ç§¯çš„è¿‡ç¨‹åˆ†æˆä¸¤è·¯ï¼Œå…ˆé€šè¿‡ä¸Šé¢ä¸€è·¯å­¦ä¹ å¾—åˆ°offsetï¼›ä¸‹é¢çš„å¯å˜å½¢å·ç§¯æ˜¯åŸºäºä¸Šé¢ç”Ÿæˆçš„offsetï¼Œæˆ‘ä»¬çš„å·ç§¯çª—å£å°†ç”±è§„æ•´çš„ç»¿è‰²çª—å£å˜æˆè“è‰²éƒ¨åˆ†ï¼Œç„¶åå†æ‰§è¡Œæ™®é€šçš„å·ç§¯ï¼Œè¿™ç§å®ç°æ–¹å¼ç›¸å½“äºäºæ¯”æ­£å¸¸çš„å·ç§¯æ“ä½œå¤šå­¦ä¹ äº†å·ç§¯æ ¸çš„åç§»offsetå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå·¦è¾¹æ™®é€šå·ç§¯æ–¹æ³•æ²¡æœ‰æå–åˆ°å®Œæ•´ç»µç¾Šçš„ç‰¹å¾ï¼Œè€Œå³è¾¹çš„å¯å˜å½¢å·ç§¯æ–¹æ³•æå–åˆ°äº†å®Œæ•´çš„ç»µç¾Šçš„ç‰¹å¾å®ç°DCNä¸­çš„ä¸¤ä¸ªé—®é¢˜QAQA1: å¦‚ä½•å°†å¯å˜å½¢å·ç§¯å˜æˆå•ç‹¬çš„ä¸€ä¸ªå±‚ï¼Œè€Œä¸å½±å“åˆ«çš„å±‚åœ¨å®é™…æ“ä½œæ—¶ï¼Œå¹¶ä¸æ˜¯çœŸæ­£åœ°æŠŠå·ç§¯æ ¸è¿›è¡Œæ‰©å±•ï¼Œè€Œæ˜¯å¯¹å·ç§¯å‰å›¾ç‰‡çš„åƒç´ é‡æ–°æ•´åˆï¼Œå˜ç›¸åœ°å®ç°å·ç§¯æ ¸çš„æ‰©å¼ ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®é™…ä¸Šå˜çš„æ˜¯æ¯æ¬¡è¿›è¡Œå·ç§¯åå¾—åˆ°çš„å¸¦åç§»å€¼çš„åæ ‡å€¼ï¼Œæ ¹æ®è¿™äº›åæ ‡å–åƒç´ ç‚¹ï¼Œç„¶ååŒçº¿æ€§å·®å€¼ï¼Œå¾—åˆ°æ–°feature mapï¼Œç„¶åä½œä¸ºè¾“å‡ºå¹¶æˆä¸ºä¸‹ä¸€å±‚çš„æ–°è¾“å…¥QA2: åœ¨å‰å‘ä¼ æ’­å®ç°å¯å˜æ€§å·ç§¯ä¸­ï¼Œå¦‚ä½•èƒ½æœ‰æ•ˆåœ°è¿›è¡Œåå‘ä¼ æ’­åœ¨å›¾ç‰‡åƒç´ æ•´åˆæ—¶ï¼Œéœ€è¦å¯¹åƒç´ è¿›è¡Œåç§»æ“ä½œï¼Œåç§»é‡çš„ç”Ÿæˆä¼šäº§ç”Ÿæµ®ç‚¹æ•°ç±»å‹ï¼Œè€Œåç§»é‡åˆå¿…é¡»è½¬æ¢ä¸ºæ•´å½¢ï¼Œç›´æ¥å¯¹åç§»é‡å–æ•´çš„è¯æ— æ³•è¿›è¡Œåå‘ä¼ æ’­ï¼Œè¿™æ—¶é‡‡ç”¨åŒçº¿æ€§å·®å€¼çš„æ–¹å¼æ¥å¾—åˆ°å¯¹åº”çš„åƒç´ å¯å˜å½¢å·ç§¯çš„ä½¿ç”¨ç¨‹åº¦å–å†³äºå…·ä½“çš„åº”ç”¨åœºæ™¯å’Œä»»åŠ¡è¦æ±‚ç›®æ ‡æ£€æµ‹ï¼šå¯å˜å½¢å·ç§¯åœ¨ç›®æ ‡æ£€æµ‹ä»»åŠ¡ä¸­è¢«å¹¿æ³›ä½¿ç”¨ã€‚ç”±äºç›®æ ‡åœ¨å›¾åƒä¸­å¯èƒ½å­˜åœ¨å°ºåº¦å˜åŒ–ã€å½¢å˜ç­‰éåˆšæ€§å˜åŒ–ï¼Œä¼ ç»Ÿçš„å›ºå®šæ„Ÿå—é‡çš„å·ç§¯æ ¸éš¾ä»¥å‡†ç¡®æ•æ‰ç›®æ ‡çš„ç»†èŠ‚å’Œå½¢çŠ¶ä¿¡æ¯ã€‚å¯å˜å½¢å·ç§¯é€šè¿‡å¼•å…¥å¯å­¦ä¹ çš„åç§»å‚æ•°ï¼Œèƒ½å¤Ÿè‡ªé€‚åº”åœ°è°ƒæ•´æ„Ÿå—é‡ï¼Œä»è€Œæé«˜ç›®æ ‡æ£€æµ‹çš„ç²¾åº¦å’Œé²æ£’æ€§è¯­ä¹‰åˆ†å‰²ï¼šå¯¹äºè¯­ä¹‰åˆ†å‰²ä»»åŠ¡ï¼Œå¯å˜å½¢å·ç§¯ä¹Ÿè¢«å¹¿æ³›ä½¿ç”¨ã€‚è¯­ä¹‰åˆ†å‰²éœ€è¦å¯¹å›¾åƒä¸­çš„æ¯ä¸ªåƒç´ è¿›è¡Œåˆ†ç±»ï¼Œå› æ­¤å‡†ç¡®åœ°æ•æ‰åƒç´ å‘¨å›´çš„ä¸Šä¸‹æ–‡ä¿¡æ¯è‡³å…³é‡è¦ã€‚å¯å˜å½¢å·ç§¯èƒ½å¤Ÿé€šè¿‡è‡ªé€‚åº”è°ƒæ•´é‡‡æ ·ä½ç½®æ¥æ›´å¥½åœ°æ•æ‰éåˆšæ€§å½¢å˜çš„ç›®æ ‡è¾¹ç•Œå’Œç»†èŠ‚ï¼Œæé«˜è¯­ä¹‰åˆ†å‰²çš„ç²¾åº¦å’Œç»†èŠ‚ä¿ç•™èƒ½åŠ›äººä½“å§¿æ€ä¼°è®¡ï¼šåœ¨äººä½“å§¿æ€ä¼°è®¡ä»»åŠ¡ä¸­ï¼Œå¯å˜å½¢å·ç§¯ä¹Ÿè¢«å¹¿æ³›åº”ç”¨ã€‚äººä½“å§¿æ€å…·æœ‰å¤æ‚çš„éåˆšæ€§å½¢å˜ï¼Œä¼ ç»Ÿçš„å·ç§¯æ“ä½œå¾€å¾€æ— æ³•å‡†ç¡®åœ°æ•æ‰åˆ°äººä½“å…³èŠ‚çš„ä½ç½®å’Œå§¿æ€ä¿¡æ¯ã€‚é€šè¿‡å¼•å…¥å¯å˜å½¢å·ç§¯ï¼Œå¯ä»¥æ›´å¥½åœ°å»ºæ¨¡äººä½“çš„éåˆšæ€§å½¢å˜ï¼Œæé«˜å§¿æ€ä¼°è®¡çš„å‡†ç¡®æ€§å’Œé²æ£’æ€§éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¯å˜å½¢å·ç§¯çš„è®¡ç®—é‡è¾ƒå¤§ï¼Œå¯èƒ½ä¼šå¢åŠ æ¨¡å‹çš„å¤æ‚æ€§å’Œè®­ç»ƒçš„éš¾åº¦å› æ­¤ï¼Œå®ƒé€šå¸¸åœ¨éœ€è¦å¯¹éåˆšæ€§å½¢å˜å»ºæ¨¡çš„ä»»åŠ¡ä¸­ä½¿ç”¨ï¼Œå¹¶ä¸”åœ¨è®¾è®¡æ¨¡å‹æ—¶éœ€è¦æ ¹æ®å…·ä½“æƒ…å†µè¿›è¡Œæƒè¡¡å’Œé€‰æ‹©æ± åŒ–æ“ä½œå·ç§¯ç¥ç»ç½‘ç»œæ± åŒ–æ–¹æ³•ç»¼è¿°é‚£äº›é¬¼æ–§ç¥å·¥çš„æ± åŒ–æ“ä½œï¼Œçœ‹å®Œæˆ‘ç‚¸è£‚ï¼æ± åŒ–çš„ä½œç”¨æŠ‘åˆ¶å™ªå£°ï¼Œé™ä½ä¿¡æ¯å†—ä½™æå‡æ¨¡å‹çš„å°ºåº¦ä¸å˜æ€§ã€æ—‹è½¬ä¸å˜æ€§é™ä½æ¨¡å‹è®¡ç®—é‡é˜²æ­¢è¿‡æ‹Ÿåˆæ± åŒ–å›ä¼ æ¢¯åº¦çš„åŸåˆ™æ˜¯ä¿è¯ä¼ é€’çš„loss(æˆ–è€…è¯´æ¢¯åº¦)æ€»å’Œä¸å˜æœ€å¤§æ± åŒ–: å–æ¯ä¸ªå—çš„æœ€å¤§å€¼ä½œä¸ºä¸‹ä¸€å±‚çš„ä¸€ä¸ªå…ƒç´ å€¼ï¼Œå› æ­¤ä¸‹ä¸€ä¸ªå…ƒç´ çš„Lossåªæ¥æºäºè¿™ä¸ªæœ€å¤§å€¼ï¼Œå› æ­¤æ¢¯åº¦æ›´æ–°ä¹Ÿåªæ›´æ–°è¿™ä¸ªæœ€å¤§å€¼ï¼Œå…¶ä»–å€¼æ¢¯åº¦ä¸º0å¹³å‡æ± åŒ–: å°†è¾“å…¥åŒºåŸŸå†…çš„æ¢¯åº¦å‡åŒ€åœ°åˆ†é…ç»™è¯¥åŒºåŸŸä¸­çš„æ¯ä¸ªä½ç½®ã€‚åå‘ä¼ æ’­è¿‡ç¨‹ä¸­ï¼Œå°†æ¢¯åº¦å‡åŒ€åˆ†é…ç»™è¾“å…¥åŒºåŸŸå†…çš„æ‰€æœ‰ä½ç½®æ± åŒ–è¾“å‡ºå¤§å°è®¡ç®—å…¬å¼æœ€å¤§æœ€å°æ± åŒ–å®šä¹‰æœ€å¤§æ± åŒ–(Max Pooling): é€‰æ‹©è¾“å…¥åŒºåŸŸä¸­çš„æœ€å¤§å€¼ä½œä¸ºè¾“å‡ºï¼Œå¿½ç•¥å…¶ä»–å€¼æœ€å°æ± åŒ–(Min Pooling): é€‰æ‹©è¾“å…¥åŒºåŸŸä¸­çš„æœ€å°å€¼ä½œä¸ºè¾“å‡ºï¼Œå¿½ç•¥å…¶ä»–å€¼ä¸‹å›¾æ˜¯æœ€å¤§æ± åŒ–çš„ç¤ºä¾‹å›¾é‡å æ± åŒ–å’Œéé‡å æ± åŒ–æ± åŒ–åˆåˆ†ä¸ºé‡å æ± åŒ–å’Œéé‡å æ± åŒ–éé‡å æ± åŒ–: stride=kernel sizeçš„æƒ…å†µé‡å æ± åŒ–: stride&lt;kernel sizeçš„æƒ…å†µé‡å æ± åŒ–ç›¸æ¯”äºéé‡å æ± åŒ–ä¸ä»…å¯ä»¥æå‡é¢„æµ‹ç²¾åº¦ï¼ŒåŒæ—¶åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¯ä»¥ç¼“è§£è¿‡æ‹Ÿåˆå¹³å‡æ± åŒ–å¹³å‡æ± åŒ–(Average Pooling): è®¡ç®—è¾“å…¥åŒºåŸŸå†…çš„å¹³å‡å€¼ä½œä¸ºè¾“å‡ºï¼Œå°†è¾“å…¥åŒºåŸŸçš„å€¼å¹³å‡åˆ†é…æœ€å¤§æ± åŒ–å’Œå‡å€¼æ± åŒ–çš„å¼Šç«¯å¦‚ä¸‹æ‰€ç¤ºéšæœºæ± åŒ–Stochastic Pooling for Regularization of Deep Convolutional Neural Networks 2013Stochastic poolingæ˜¯è®ºæ–‡ã€ŠStochastic Pooling for Regularization of Deep Convolutional Neural Networksã€‹ä¸­æåˆ°çš„ä¸€ç§æ± åŒ–ç­–ç•¥ï¼Œå¤§æ„æ˜¯åªéœ€å¯¹ç‰¹å¾åŒºåŸŸå…ƒç´ æŒ‰ç…§å…¶æ¦‚ç‡å€¼å¤§å°éšæœºé€‰æ‹©ï¼Œå…ƒç´ å€¼å¤§çš„è¢«é€‰ä¸­çš„æ¦‚ç‡ä¹Ÿå¤§ä¸‹è¡¨æ˜¯éšæœºæ± åŒ–åœ¨CIFAR-10ä¸Šçš„è¡¨ç°ï¼Œå¯ä»¥çœ‹å‡ºï¼Œä½¿ç”¨éšæœºæ± åŒ–æ•ˆæœå’Œé‡‡ç”¨dropoutçš„ç»“æœæ¥è¿‘ï¼Œè¯æ˜äº†å…¶æœ‰ä¸€å®šé˜²æ­¢è¿‡æ‹Ÿåˆçš„ä½œç”¨Lpæ± åŒ–Lpæ± åŒ–(Lp Pooling)æ˜¯é€šè¿‡è°ƒæ•´å‚æ•°pçš„å€¼æ¥å®ç°ä¸åŒçš„æ± åŒ–æ–¹å¼ï¼Œå½“p=1æ—¶ï¼Œä¸ºå¹³å‡æ± åŒ–ï¼Œå½“pè¶‹è¿‘äºæ— ç©·å¤§æ—¶ï¼Œä¸ºæœ€å¤§æ± åŒ–Lpæ± åŒ–çš„å¥½å¤„æ˜¯å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šä¿ç•™æ›´å¤šçš„ä¿¡æ¯ã€‚å¹³å‡æ± åŒ–ä¼šå¹³å‡åŒ–å±€éƒ¨åŒºåŸŸçš„ç‰¹å¾ï¼Œå¯èƒ½ä¸¢å¤±ä¸€äº›ç»†èŠ‚ä¿¡æ¯ï¼›è€Œæœ€å¤§æ± åŒ–åªä¿ç•™å±€éƒ¨åŒºåŸŸçš„æœ€å¤§å€¼ï¼Œå¯èƒ½ä¸¢å¤±å…¶ä»–é‡è¦çš„ä¿¡æ¯Lpæ± åŒ–é€šè¿‡è°ƒæ•´å‚æ•°pçš„å€¼ï¼Œå¯ä»¥åœ¨ç‰¹å¾æ±‡èšæ—¶å¹³è¡¡ä¿¡æ¯çš„ä¸°å¯Œæ€§å’ŒæŠ—å™ªæ€§èƒ½æ± åŒ–å…·ä½“æ“ä½œå¦‚ä¸‹å…¬å¼æ‰€æè¿°å½“p=1æ—¶ï¼Œä½¿ç”¨å±€éƒ¨æ±‚å’Œï¼Œè€Œpä¸ºæ— ç©·å¤§æ—¶ï¼Œå¯¹åº”max-poolingåœ¨Lpæ± åŒ–ä¸­ï¼Œpçš„é€‰æ‹©éœ€è¦æ ¹æ®å…·ä½“ä»»åŠ¡å’Œæ•°æ®é›†è¿›è¡Œè°ƒæ•´è¾ƒå°çš„på€¼å¯ä»¥æ›´åŠ æ³¨é‡ç»†èŠ‚ä¿¡æ¯ï¼Œé€‚ç”¨äºéœ€è¦ä¿ç•™ç»†ç²’åº¦ç‰¹å¾çš„ä»»åŠ¡è¾ƒå¤§çš„på€¼å¯ä»¥æ›´åŠ æ³¨é‡å…¨å±€ä¿¡æ¯ï¼Œé€‚ç”¨äºæ›´åŠ æ•´ä½“åŒ–çš„ä»»åŠ¡é€šå¸¸æƒ…å†µä¸‹ï¼Œpå–2æ—¶èƒ½å¤Ÿè·å¾—è¾ƒå¥½çš„æ€§èƒ½ç»„åˆæ± åŒ–ç»„åˆæ± åŒ–åˆ™æ˜¯åŒæ—¶åˆ©ç”¨æœ€å¤§å€¼æ± åŒ–ä¸å‡å€¼æ± åŒ–ä¸¤ç§çš„ä¼˜åŠ¿è€Œå¼•ç”³çš„ä¸€ç§æ± åŒ–ç­–ç•¥ï¼Œå¸¸è§ç»„åˆç­–ç•¥æœ‰Catå’ŒAddè¿™ä¸¤ç§å¸¸å¸¸è¢«å½“åšåˆ†ç±»ä»»åŠ¡çš„ä¸€ä¸ªtrickï¼Œå…¶ä½œç”¨å°±æ˜¯ä¸°å¯Œç‰¹å¾å±‚ï¼Œmaxpoolæ›´å…³æ³¨é‡è¦çš„å±€éƒ¨ç‰¹å¾ï¼Œè€Œaverage poolingæ›´å…³æ³¨å…¨å±€ç‰¹å¾123456789def add_avgmax_pool2d(x, output_size=1):    x_avg = F.adaptive_avg_pool2d(x, output_size)    x_max = F.adaptive_max_pool2d(x, output_size)    return 0.5 * (x_avg + x_max)def cat_avgmax_pool2d(x, output_size=1):    x_avg = F.adaptive_avg_pool2d(x, output_size)    x_max = F.adaptive_max_pool2d(x, output_size)    return torch.cat([x_avg, x_max], 1)SPPæ± åŒ–Spatial Pyramid Pooling in Deep Convolutional Networks for Visual Recognition 2015SPP(ç©ºé—´é‡‘å­—å¡”æ± åŒ–)æ˜¯åœ¨SPPNetä¸­æå‡ºçš„ï¼ŒSPPNetæå‡ºæ¯”è¾ƒæ—©ï¼Œåœ¨RCNNä¹‹åæå‡ºçš„ï¼Œç”¨äºè§£å†³é‡å¤å·ç§¯è®¡ç®—å’Œå›ºå®šè¾“å‡ºçš„ä¸¤ä¸ªé—®é¢˜ï¼Œå…·ä½“æ–¹æ³•å¦‚ä¸‹å›¾æ‰€ç¤ºç©ºé—´é‡‘å­—å¡”æ± åŒ–çš„åŸºæœ¬æ€æƒ³æ˜¯å°†è¾“å…¥ç‰¹å¾å›¾åˆ†å‰²æˆå¤šä¸ªä¸åŒå¤§å°çš„å­åŒºåŸŸï¼Œå¹¶å¯¹æ¯ä¸ªå­åŒºåŸŸè¿›è¡Œæ± åŒ–æ“ä½œã€‚è¿™äº›å­åŒºåŸŸçš„å¤§å°å’Œæ•°é‡æ„æˆäº†ä¸€ä¸ªé‡‘å­—å¡”å½¢çŠ¶çš„å±‚æ¬¡ç»“æ„ç„¶åï¼Œå¯¹æ¯ä¸ªå­åŒºåŸŸè¿›è¡Œæ± åŒ–æ“ä½œï¼ˆé€šå¸¸æ˜¯æœ€å¤§æ± åŒ–ï¼‰ï¼Œç”Ÿæˆå›ºå®šå¤§å°çš„ç‰¹å¾å‘é‡ã€‚æœ€åï¼Œå°†æ‰€æœ‰å°ºåº¦ä¸Šå¾—åˆ°çš„ç‰¹å¾å‘é‡æ‹¼æ¥åœ¨ä¸€èµ·ï¼Œå½¢æˆæœ€ç»ˆçš„ç‰¹å¾è¡¨ç¤ºé€šè¿‡ç©ºé—´é‡‘å­—å¡”æ± åŒ–ï¼Œæ¨¡å‹èƒ½å¤Ÿåœ¨ä¸åŒå°ºåº¦ä¸Šæ•æ‰åˆ°æ›´åŠ ä¸°å¯Œçš„å±€éƒ¨ç‰¹å¾ï¼Œä»è€Œå¢å¼ºäº†æ¨¡å‹å¯¹å°ºåº¦å˜åŒ–å’Œç‰©ä½“å¤§å°å˜åŒ–çš„é²æ£’æ€§è¿™å¯¹äºå¤„ç†ä¸åŒå°ºåº¦çš„ç‰©ä½“æ£€æµ‹ã€å›¾åƒåˆ†ç±»å’Œè¯­ä¹‰åˆ†å‰²ç­‰ä»»åŠ¡éå¸¸æœ‰ç”¨ROIæ± åŒ–ROIæ± åŒ–(Region of Interest Pooling)æ˜¯åœ¨ç›®æ ‡æ£€æµ‹ä»»åŠ¡ä¸­å¹¿æ³›ä½¿ç”¨çš„æ“ä½œã€‚å®ƒå¯¹äºæ¥è‡ªè¾“å…¥åˆ—è¡¨çš„æ¯ä¸ªæ„Ÿå…´è¶£åŒºåŸŸï¼Œå®ƒé‡‡ç”¨ä¸å…¶å¯¹åº”çš„è¾“å…¥ç‰¹å¾å›¾çš„ä¸€éƒ¨åˆ†å¹¶å°†å…¶ç¼©æ”¾åˆ°æŸä¸ªé¢„å®šä¹‰çš„å¤§å°ã€‚è¿™å¯ä»¥æ˜¾ç€åŠ å¿«è®­ç»ƒå’Œæµ‹è¯•æ—¶é—´ï¼Œå®ƒå…è®¸é‡æ–°ä½¿ç”¨å·ç§¯ç½‘ç»œä¸­çš„ç‰¹å¾æ˜ å°„ï¼ŒåŒæ—¶ä¹Ÿå…è®¸ä»¥ç«¯åˆ°ç«¯çš„æ–¹å¼è®­ç»ƒç‰©ä½“æ£€æµ‹ç³»ç»ŸROI Poolingä¸SPPæ± åŒ–çš„åŒºåˆ«é€šè¿‡ä¸Šé¢çš„ä»‹ç»ï¼Œå¯ä»¥çœ‹åˆ°ä¸¤è€…èµ·åˆ°çš„ä½œç”¨æ˜¯ç›¸åŒçš„ï¼ŒæŠŠä¸åŒå°ºå¯¸çš„ç‰¹å¾è¾“å…¥è½¬åŒ–ä¸ºç›¸åŒå°ºå¯¸çš„ç‰¹å¾è¾“å‡ºSPPé’ˆå¯¹åŒä¸€ä¸ªè¾“å…¥ä½¿ç”¨äº†å¤šä¸ªä¸åŒå°ºå¯¸çš„æ± åŒ–æ“ä½œï¼ŒæŠŠä¸åŒå°ºåº¦çš„ç»“æœæ‹¼æ¥ä½œä¸ºè¾“å‡ºï¼›è€ŒROI Poolingå¯çœ‹ä½œå•å°ºåº¦çš„SPPï¼Œå¯¹äºä¸€ä¸ªè¾“å…¥åªè¿›è¡Œä¸€æ¬¡æ± åŒ–æ“ä½œåæ± åŒ–[CNN] å·ç§¯ã€åå·ç§¯ã€æ± åŒ–ã€åæ± åŒ–åæ± åŒ–(Unpooling)ä¸æ± åŒ–æ“ä½œç›¸åï¼Œç”¨äºæ¢å¤ç‰¹å¾å›¾çš„å°ºå¯¸ï¼Œå¸¸è§çš„æ–¹æ³•åŒ…æ‹¬æœ€å¤§åæ± åŒ–å’Œå¹³å‡åæ± åŒ–åœ¨ä¼ ç»Ÿçš„æ± åŒ–æ“ä½œä¸­ï¼Œé€šè¿‡å°†ç‰¹å¾å›¾çš„å¤§å°å‡å°ï¼Œä»¥å®ç°ç‰¹å¾çš„é™ç»´å’Œå‡å°‘è®¡ç®—é‡ã€‚ç„¶è€Œï¼Œè¿™ä¹Ÿå¯¼è‡´äº†ä¿¡æ¯çš„æŸå¤±å’Œç©ºé—´åˆ†è¾¨ç‡çš„é™ä½ä¸ºäº†è¡¥å¿è¿™ç§ä¿¡æ¯æŸå¤±ï¼Œåæ± åŒ–å’ŒUnpoolingæ“ä½œç”¨äºè¿˜åŸç‰¹å¾å›¾çš„ç©ºé—´åˆ†è¾¨ç‡ï¼Œä½¿å…¶ä¸è¾“å…¥ç‰¹å¾å›¾å…·æœ‰ç›¸åŒçš„å°ºå¯¸åæ± åŒ–é€šå¸¸æ˜¯é€šè¿‡è½¬ç½®å·ç§¯(Transpose Convolution)æ¥å®ç°çš„ã€‚è½¬ç½®å·ç§¯é€šè¿‡åœ¨ç‰¹å¾å›¾ä¹‹é—´æ’å…¥ç©ºç™½åƒç´ æˆ–é›¶å¡«å……ï¼Œå¹¶ä½¿ç”¨é€‚å½“çš„å·ç§¯æ ¸å¯¹è¿™äº›ç©ºç™½åƒç´ è¿›è¡Œå·ç§¯è¿ç®—ï¼Œä»¥æ¢å¤ç‰¹å¾å›¾çš„å°ºå¯¸Unpoolingåˆ™æ˜¯åœ¨åæ± åŒ–æ“ä½œä¸­ä¸è½¬ç½®å·ç§¯ç»“åˆä½¿ç”¨çš„ä¸€ç§æ–¹å¼ã€‚åœ¨æ± åŒ–æ“ä½œä¸­ï¼Œé€šå¸¸ä¼šè®°å½•æ± åŒ–æ“ä½œæ—¶çš„æœ€å¤§å€¼æˆ–å¹³å‡å€¼çš„ä½ç½®ã€‚åœ¨Unpoolingä¸­ï¼Œæ ¹æ®è¿™äº›ä½ç½®ä¿¡æ¯ï¼Œå°†åæ± åŒ–æ“ä½œçš„è¾“å‡ºå€¼æ”¾ç½®å›åŸå§‹ç‰¹å¾å›¾çš„å¯¹åº”ä½ç½®ã€‚è¿™æ ·å¯ä»¥åœ¨æ¢å¤ç©ºé—´åˆ†è¾¨ç‡çš„åŒæ—¶ä¿ç•™ä¸€å®šçš„ä½ç½®ä¿¡æ¯åæ± åŒ–å’ŒUnpoolingåœ¨å·ç§¯ç¥ç»ç½‘ç»œä¸­èµ·ç€é‡è¦çš„ä½œç”¨ï¼Œç‰¹åˆ«æ˜¯åœ¨è¯­ä¹‰åˆ†å‰²å’Œå›¾åƒé‡å»ºç­‰ä»»åŠ¡ä¸­ã€‚å®ƒä»¬å¸®åŠ©ç½‘ç»œæ¢å¤è¾“å…¥å›¾åƒçš„è¯¦ç»†ç»“æ„å’Œç©ºé—´ä¿¡æ¯ï¼Œä»è€Œæé«˜æ¨¡å‹çš„ç²¾åº¦å’Œè´¨é‡å…¶ä»–æ± åŒ–LIPæ± åŒ–: LIP: Local Importance-based Poolingè‡ªé€‚åº”æ± åŒ–(Adaptive Pooling): æ ¹æ®è¾“å…¥çš„å°ºå¯¸è‡ªåŠ¨è°ƒæ•´æ± åŒ–çª—å£çš„å¤§å°ï¼Œé€‚åº”ä¸åŒå¤§å°çš„è¾“å…¥å½’ä¸€åŒ–BatchNormalizationã€LayerNormalizationã€InstanceNormã€GroupNormç®€ä»‹ç¥ç»ç½‘ç»œä¸­æœ‰å„ç§å½’ä¸€åŒ–ç®—æ³•ï¼Œä»å…¬å¼çœ‹å®ƒä»¬éƒ½å·®ä¸å¤šï¼šæ— éæ˜¯å‡å»å‡å€¼ï¼Œé™¤ä»¥æ ‡å‡†å·®ï¼Œå†æ–½ä»¥çº¿æ€§æ˜ å°„å½’ä¸€åŒ–ç®—æ³•çš„ä¸»è¦åŒºåˆ«åœ¨äºæ“ä½œçš„feature mapç»´åº¦ä¸åŒä¸‹å›¾æ¥è‡ªä½•å‡¯æ˜çš„Group Normalization 2018å¯ä»¥çœ‹å‡ºBN: é’ˆå¯¹æ•´ä¸ªbatchä¸åŒé€šé“ï¼Œå…·ä½“æ¥è¯´ï¼Œå°±æ˜¯æŠŠç¬¬1ä¸ªæ ·æœ¬çš„ç¬¬1ä¸ªé€šé“ï¼ŒåŠ ä¸Šç¬¬2ä¸ªæ ·æœ¬ç¬¬1ä¸ªé€šé“â€¦åŠ ä¸Šç¬¬Nä¸ªæ ·æœ¬ç¬¬1ä¸ªé€šé“ï¼Œæ±‚å¹³å‡ï¼Œå¾—åˆ°é€šé“1çš„å‡å€¼LNï¼šé’ˆå¯¹æ¯ä¸ªæ ·æœ¬ï¼Œå¯¹æ¯ä¸ªæ ·æœ¬çš„Cã€Hã€Wç»´åº¦ä¸Šçš„æ•°æ®æ±‚å‡å€¼å’Œæ ‡å‡†å·®ï¼Œä¿ç•™Nç»´åº¦INï¼šé’ˆå¯¹æ¯ä¸ªæ ·æœ¬ä¸‹çš„æ¯ä¸ªé€šé“ï¼Œå¯¹æ¯ä¸ªæ ·æœ¬çš„Hã€Wç»´åº¦çš„æ•°æ®æ±‚å‡å€¼å’Œæ ‡å‡†å·®ï¼Œä¿ç•™N ã€Cç»´åº¦ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒåªåœ¨channelå†…éƒ¨æ±‚å‡å€¼å’Œæ ‡å‡†å·®GNï¼šé’ˆå¯¹æ¯ä¸ªæ ·æœ¬ä¸‹çš„å¤šä¸ªé€šé“ï¼Œè®¡ç®—å‡å€¼å’Œæ ‡å‡†å·®æ—¶ï¼ŒæŠŠæ¯ä¸€ä¸ªæ ·æœ¬feature mapçš„channelåˆ†æˆGç»„ï¼Œæ¯ç»„å°†æœ‰C/Gä¸ªchannelï¼Œç„¶åå°†è¿™äº›channelä¸­çš„å…ƒç´ æ±‚å‡å€¼å’Œæ ‡å‡†å·®ã€‚å„ç»„channelç”¨å…¶å¯¹åº”çš„å½’ä¸€åŒ–å‚æ•°ç‹¬ç«‹åœ°å½’ä¸€åŒ–æ‰¹å½’ä¸€åŒ–èƒŒæ™¯æœºå™¨å­¦ä¹ é¢†åŸŸæœ‰ä¸ªå¾ˆé‡è¦çš„å‡è®¾ï¼šIID ç‹¬ç«‹åŒåˆ†å¸ƒå‡è®¾ï¼Œå°±æ˜¯å‡è®¾è®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®æ˜¯æ»¡è¶³ç›¸åŒåˆ†å¸ƒçš„ï¼Œè¿™æ˜¯é€šè¿‡è®­ç»ƒæ•°æ®è·å¾—çš„æ¨¡å‹èƒ½å¤Ÿåœ¨æµ‹è¯•é›†è·å¾—å¥½çš„æ•ˆæœçš„ä¸€ä¸ªåŸºæœ¬ä¿éšœåœ¨æŠŠæ•°æ®å–‚ç»™æœºå™¨å­¦ä¹ æ¨¡å‹ä¹‹å‰ï¼Œç™½åŒ–(whitening)æ˜¯ä¸€ä¸ªé‡è¦çš„æ•°æ®é¢„å¤„ç†æ­¥éª¤ç‹¬ç«‹: å»é™¤ç‰¹å¾ä¹‹é—´çš„ç›¸å…³æ€§åŒåˆ†å¸ƒ: ä½¿å¾—æ‰€æœ‰ç‰¹å¾å…·æœ‰ç›¸åŒçš„å‡å€¼å’Œæ–¹å·®æ¯æ‰¹è®­ç»ƒæ•°æ®çš„åˆ†å¸ƒå„ä¸ç›¸åŒï¼Œé‚£ä¹ˆç½‘ç»œéœ€è¦åœ¨æ¯æ¬¡è¿­ä»£ä¸­å»å­¦ä¹ é€‚åº”ä¸åŒçš„åˆ†å¸ƒï¼Œè¿™æ ·å°†ä¼šå¤§å¤§é™ä½ç½‘ç»œçš„è®­ç»ƒé€Ÿåº¦ã€‚å¯¹äºæ·±åº¦ç½‘ç»œçš„è®­ç»ƒæ˜¯ä¸€ä¸ªéå¸¸å¤æ‚çš„è¿‡ç¨‹ï¼Œåªè¦ç½‘ç»œçš„å‰é¢å‡ å±‚å‘ç”Ÿå¾®å°çš„æ”¹å˜ï¼Œé‚£ä¹ˆè¿™äº›å¾®å°çš„æ”¹å˜åœ¨åé¢çš„å±‚å°±ä¼šè¢«ç´¯ç§¯æ”¾å¤§ä¸‹å»ä¸€æ—¦ç½‘ç»œæŸä¸€å±‚çš„è¾“å…¥æ•°æ®çš„åˆ†å¸ƒå‘ç”Ÿæ”¹å˜ï¼Œé‚£ä¹ˆè¿™ä¸€å±‚ç½‘ç»œå°±éœ€è¦å»é€‚åº”å­¦ä¹ è¿™ä¸ªæ–°çš„æ•°æ®åˆ†å¸ƒï¼Œæ‰€ä»¥å¦‚æœè®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œè®­ç»ƒæ•°æ®çš„åˆ†å¸ƒä¸€ç›´åœ¨å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆå°†ä¼šå½±å“ç½‘ç»œçš„è®­ç»ƒé€Ÿåº¦ä¸€æ–‡ææ‡‚BNçš„åŸç†åŠå…¶å®ç°è¿‡ç¨‹ï¼ˆBatch Normalizationï¼‰æ·±å…¥ç†è§£NLPä¸­LayerNormçš„åŸç†ä»¥åŠLNçš„ä»£ç è¯¦è§£å¼•å…¥æ‰¹å½’ä¸€åŒ–Batch Normalizationçš„åŸå› ï¼šåœ¨å›¾åƒé¢„å¤„ç†è¿‡ç¨‹ä¸­é€šå¸¸ä¼šå¯¹å›¾åƒè¿›è¡Œæ ‡å‡†åŒ–å¤„ç†ï¼Œä¹Ÿå°±æ˜¯image normalizationï¼Œä½¿å¾—æ¯å¼ è¾“å…¥å›¾ç‰‡çš„æ•°æ®åˆ†å¸ƒèƒ½å¤Ÿç»Ÿå‡å€¼ä¸º$\mu$ï¼Œæ–¹å·®ä¸º$ \sigma ^2$çš„åˆ†å¸ƒã€‚è¿™æ ·èƒ½å¤ŸåŠ é€Ÿç½‘ç»œçš„æ”¶æ•›ã€‚ä½†æ˜¯å½“ä¸€å¼ å›¾ç‰‡è¾“å…¥åˆ°ç¥ç»ç½‘ç»œç»è¿‡å·ç§¯è®¡ç®—ä¹‹åï¼Œè¿™ä¸ªåˆ†å¸ƒå°±ä¸ä¼šæ»¡è¶³åˆšæ‰ç»è¿‡image normalizationæ“ä½œä¹‹åçš„åˆ†å¸ƒäº†ï¼Œå¯èƒ½é€‚åº”äº†æ–°çš„æ•°æ®åˆ†å¸ƒè§„å¾‹ï¼Œè¿™ä¸ªæ—¶å€™å°†æ•°æ®æ¥å…¥æ¿€æ´»å‡½æ•°ä¸­ï¼Œå¾ˆå¯èƒ½ä¸€äº›æ–°çš„æ•°æ®ä¼šè½å…¥æ¿€æ´»å‡½æ•°çš„é¥±å’ŒåŒºï¼Œå¯¼è‡´ç¥ç»ç½‘ç»œè®­ç»ƒçš„æ¢¯åº¦æ¶ˆå¤±è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¼•å…¥Batch Normalizationçš„ç›®çš„å°±æ˜¯ä½¿æˆ‘ä»¬å·ç§¯ä»¥åçš„feature mapæ»¡è¶³å‡å€¼ä¸º0ï¼Œæ–¹å·®ä¸º1çš„åˆ†å¸ƒè§„å¾‹ï¼Œå†æ¥å…¥æ¿€æ´»å‡½æ•°å°±ä¸ä¼šå‘ç”Ÿè¿™æ ·çš„æƒ…å†µæ•°æ®å½’ä¸€åŒ–éƒ½æ˜¯åœ¨æ•°æ®è¾“å…¥æ—¶åšçš„ï¼Œä½†æ˜¯å®é™…ä¸Šåœ¨ä»»ä½•ä½ç½®éƒ½æ˜¯å¯ä»¥è¿›è¡Œæ•°æ®å½’ä¸€åŒ–ï¼Œåœ¨ç¥ç»ç½‘ç»œé‡Œä¸Šä¸€å±‚ç½‘ç»œçš„è¾“å‡ºæ­£å¥½å°±æ˜¯ä¸‹ä¸€å±‚ç½‘ç»œçš„è¾“å…¥ä¼˜ç‚¹åŠ é€Ÿæ”¶æ•›ï¼šå½’ä¸€åŒ–æ“ä½œå¯ä»¥å‡å°‘ç½‘ç»œä¸­ä¸ç¨³å®šçš„å› ç´ ï¼Œæœ‰åŠ©äºæ¢¯åº¦çš„ä¼ æ’­å’Œæ”¶æ•›ã€‚å®ƒä½¿å¾—ç½‘ç»œåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­æ›´å®¹æ˜“ä¼˜åŒ–ï¼ŒåŠ é€Ÿäº†è®­ç»ƒçš„é€Ÿåº¦å‡å°‘æ¢¯åº¦å¼¥æ•£é—®é¢˜ï¼šç¥ç»ç½‘ç»œåœ¨æ·±å±‚æ—¶å®¹æ˜“å‡ºç°æ¢¯åº¦æ¶ˆå¤±æˆ–æ¢¯åº¦çˆ†ç‚¸çš„é—®é¢˜ã€‚Batch Normalizationé€šè¿‡å°†æ•°æ®å½’ä¸€åŒ–åˆ°ä¸€ä¸ªåˆé€‚çš„èŒƒå›´ï¼Œä½¿å¾—æ¿€æ´»å‡½æ•°çš„è¾“å…¥æ›´åŠ ç¨³å®šï¼Œå‡å°‘äº†æ¢¯åº¦æ¶ˆå¤±çš„é£é™©æé«˜æ³›åŒ–èƒ½åŠ›ï¼šBatch Normalizationä½œä¸ºä¸€ç§æ­£åˆ™åŒ–æ–¹æ³•ï¼Œæœ‰åŠ©äºå‡å°‘è¿‡æ‹Ÿåˆçš„é£é™©ã€‚é€šè¿‡åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å¼•å…¥ä¸€äº›å™ªå£°ï¼Œå®ƒå¯ä»¥æé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ï¼Œå¹¶ä½¿å¾—ç½‘ç»œå¯¹è¾“å…¥æ•°æ®çš„å˜åŒ–æ›´åŠ é²æ£’Batch Normalizationåœ¨æ¯ä¸ªå°æ‰¹é‡è®­ç»ƒæ ·æœ¬ä¸­å¯¹è¾“å…¥è¿›è¡Œæ ‡å‡†åŒ–ï¼Œä½¿å…¶å…·æœ‰é›¶å‡å€¼å’Œå•ä½æ–¹å·®å›¾åƒä¸‹çš„BNç¤ºä¾‹ä¸‹å›¾å±•ç¤ºäº†ä¸€ä¸ªbatch sizeä¸º2(ä¸¤å¼ å›¾ç‰‡ï¼Œæ¯å¼ å›¾ç‰‡æœ‰3ä¸ªé€šé“ï¼Œå…¶ä¸­é¢œè‰²çº¢ï¼Œç»¿ï¼Œè“åˆ†åˆ«ä»£è¡¨r,g,bé€šé“)çš„Batch Normalizationçš„åŸç†ï¼Œé¦–å…ˆä¼šç»Ÿè®¡æ¯ä¸ªé€šé“æ•°ç›®æ‰€æœ‰ç‚¹çš„åƒç´ å€¼ï¼Œæ±‚å¾—å‡å€¼å’Œæ–¹å·®ï¼Œç„¶ååœ¨æ¯ä¸ªé€šé“ä¸Šåˆ†åˆ«ç”¨è¯¥ç‚¹çš„åƒç´ å€¼å‡å‡å€¼é™¤æ–¹å·®å¾—åˆ°è¯¥ç‚¹çš„åƒç´ å€¼ï¼Œæ­¤è¿‡ç¨‹å°±æ˜¯BNã€‚æœ€åå°†å…¶æ¥å…¥åˆ°æ¿€æ´»å‡½æ•°ä¸­å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå…¶ä¸­çº¢ï¼Œç»¿ï¼Œè“åˆ†åˆ«ä»£è¡¨å›¾åƒä¸åŒçš„é€šé“ï¼Œå‡è®¾å‡è®¾feature map1ã€feature map2åˆ†åˆ«æ˜¯ç”±image1ã€image2ç»è¿‡ä¸€ç³»åˆ—å·ç§¯æ± åŒ–åå¾—åˆ°çš„ç‰¹å¾çŸ©é˜µå…¶ä¸­æ¯ä¸ªç½‘æ ¼çš„å€¼ä»£è¡¨è¯¥ç‚¹çš„åƒç´ å€¼ï¼Œåˆ†åˆ«ç»Ÿè®¡feature map1å’Œfeature map2æ¯ä¸ªé€šé“çš„åƒç´ å€¼ï¼Œå¾—åˆ°ä¸€ä¸ªçŸ©é˜µï¼Œåœ¨ä½¿ç”¨BNçš„è®¡ç®—å…¬å¼è®¡ç®—ç»è¿‡BNä»¥åæ¯ä¸ªé€šé“æ¯ä¸ªåƒç´ ç‚¹çš„åƒç´ å€¼å®šä¹‰$x$ä¸ºä»¥ä¸‹çŸ©é˜µå¯ä»¥è®¡ç®—å¾—åˆ°$\mu$å’Œ$\sigma ^2$å³å¾—åˆ°å‡å€¼å’Œæ–¹å·®ä¸ºå’Œè¿™æœ‰åŠ©äºè§£å†³è®­ç»ƒè¿‡ç¨‹ä¸­çš„å†…éƒ¨åå˜é‡åç§»(Internal Covariate Shift)é—®é¢˜ï¼Œå³ç½‘ç»œåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­çš„æ¯ä¸€å±‚çš„è¾“å…¥åˆ†å¸ƒå‘ç”Ÿå˜åŒ–ï¼Œå¯¼è‡´ç½‘ç»œçš„è®­ç»ƒå˜å¾—å›°éš¾ä»£ç ç¤ºä¾‹123456789101112131415161718192021222324252627import torch.nn as nnimport torchdata = [[[1, 2, 5], [2, 5, 8.5], [3, 3, 3]],        [[2, 8, 4], [1, 3, 9], [2, 6, 4]],        [[1, 1, 1], [1, 3, 5], [0.5, 6, 0.2]]]data = torch.tensor(data)data_bn = nn.BatchNorm1d(3)(data)data_ln = nn.LayerNorm(3)(data)mean = torch.sum(data_bn)mu = torch.sum(th.pow(data_bn - mean, 2) / 27)print(data_bn)print(mean)print(mu)&gt;&gt;&gt;tensor([[[-0.7734, -0.3384,  0.9667],         [-0.7714,  0.2967,  1.5428],         [-0.0400, -0.0400, -0.0400]],        [[-0.3384,  2.2718,  0.5317],         [-1.1274, -0.4154,  1.7208],         [-0.5542,  1.5027,  0.4742]],        [[-0.7734, -0.7734, -0.7734],         [-1.1274, -0.4154,  0.2967],         [-1.3256,  1.5027, -1.4798]]], grad_fn=&lt;NativeBatchNormBackward0&gt;)tensor(-5.9605e-07, grad_fn=&lt;SumBackward0&gt;)  # çº¦ç­‰äº0tensor(1.0000, grad_fn=&lt;SumBackward0&gt;)å±‚å½’ä¸€åŒ–æ·±åº¦å­¦ä¹ åŸºç¡€ä¹‹BatchNormå’ŒLayerNormä¸ºä»€ä¹ˆTransformerä½¿ç”¨LayerNorm ï¼Œè€Œä¸ä½¿ç”¨BatchNormBNçš„ç‰¹ç‚¹æ˜¯å¼ºè¡Œæ‹‰å¹³æ•°æ®ä¹‹é—´çš„åˆ†å¸ƒï¼Œä½¿å¾—æ¨¡å‹æ”¶æ•›é€Ÿåº¦æ›´å¿«ï¼Œå¹¶ä¸”èµ·åˆ°äº†æ­£åˆ™åŒ–çš„ä½œç”¨ï¼Œä½¿æ¨¡å‹æ•ˆæœæ›´ä½³ã€‚ä½†æ˜¯ï¼ŒBatchNormå¯¹Batch Sizeå¤§å°å¾ˆæ•æ„Ÿï¼Œå¹¶ä¸”åœ¨LSTMç½‘ç»œä¸Šæ•ˆæœæå·®ã€‚LayerNormæ˜¯æ¨ªå‘å½’ä¸€åŒ–ï¼Œä¸å—Batch Sizeå¤§å°çš„å½±å“ï¼Œå¹¶ä¸”å¯ä»¥å¾ˆå¥½åœ°åº”ç”¨åœ¨æ—¶åºæ•°æ®ä¸­ï¼Œè€Œä¸”ä¸éœ€è¦é¢å¤–çš„å‚¨å­˜ç©ºé—´ã€‚ã€ŠRethinking Batch Normalization in Transformersã€‹ä¸€æ–‡å¯¹æ¯”äº†LayerNormå’ŒBatchNormå¯¹äºTransformerçš„ä½œç”¨ï¼Œå¹¶ä¸”æå‡ºäº†ä¸€ç§æ–°çš„å½’ä¸€åŒ–æ–¹å¼æ‰¹å½’ä¸€åŒ–å’Œå±‚å½’ä¸€åŒ–æ¯”è¾ƒé€‚ç”¨åœºæ™¯batch norm: é€‚ç”¨äºCVï¼Œå› ä¸ºè®¡ç®—æœºè§†è§‰å–‚å…¥çš„æ•°æ®éƒ½æ˜¯åƒç´ ç‚¹ï¼Œå¯ä»¥è¯´æ•°æ®ç‚¹ä¸ç‚¹ä¹‹é—´æ˜¯å¯ä»¥æ¯”è¾ƒçš„ï¼Œæ‰€ä»¥ä½¿ç”¨batch normå¯ä»¥æœ‰æ¯”è¾ƒå¥½çš„æ•ˆæœï¼Œlayer norm: NLPé‡Œï¼Œæ¯ä¸ªè¯çš„è¯å‘é‡æ˜¯ä¸€ç»„å‘é‡è¡¨ç¤ºä¸€ä¸ªè¯ï¼Œä¸€ä¸ªè¯å‘é‡å‰²è£‚å¼€æ¥çœ‹æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œå› æ­¤ä¸åŒè¯å‘é‡é‡Œçš„æ•°æ®ç‚¹æ˜¯ä¸èƒ½æ··ä¸ºä¸€è°ˆçš„æ‰€ä»¥batch normä¹‹åå¯èƒ½ä¼šä½¿å¾—è¯æŸå¤±è¯­ä¹‰ï¼Œæ•ˆæœå°±å¯èƒ½ä¸å¥½äº†ï¼Œä½†æ˜¯ä½¿ç”¨layer normåªæ˜¯è®©å„ä¸ªè¯å‘é‡è¿›è¡Œæ ‡å‡†åŒ–ï¼Œå°±èƒ½å¤Ÿæœ‰æ¯”è¾ƒç†æƒ³çš„æ•ˆæœäº†å½’ä¸€åŒ–ç»´åº¦batch norm: ä»¥CVä¸ºä¾‹ï¼Œå½’ä¸€åŒ–çš„æ˜¯ç›¸åŒé€šé“ï¼Œå‡å€¼å’Œæ–¹å·®è®¡ç®—æ˜¯æ¯ä¸ªé€šé“çš„å€¼layer norm: ä»¥NLPä¸ºä¾‹ï¼Œå½’ä¸€åŒ–çš„æ¯ä¸ªè¯å‘é‡ï¼Œä¸€ä¸ªè¯å‘é‡è‡ªå·±åšå½’ä¸€åŒ–å®ä¾‹å½’ä¸€åŒ–ç­‰å¾…â€¦ç»„å½’ä¸€åŒ–12345678910def GroupNorm(x, gamma, beta, G, eps=1e-5):    # x: input features with shape [N,C,H,W]    # gamma, beta: scale and offset, with shape [1,C,1,1]    # G: number of groups for GN    N, C, H, W = x.shape    x = tf.reshape(x, [N, G, C // G, H, W])    mean, var = tf.nn.moments(x, [2, 3, 4], keepdims=True)    x = (x - mean) / tf.sqrt(var + eps)    x = tf.reshape(x, [N, C, H, W])    return x * gamma + betaEmbeddingå±‚ç­‰å¾…â€¦Dropoutå±‚ç­‰å¾…â€¦æŒ‡æ ‡ç­‰å¾…â€¦</content>
	</entry>
	<entry>
		<title>å›¾åƒåˆ†ç±»ç®—æ³•</title>
		<url>/article/451.html</url>
		<content>å›¾åƒåˆ†ç±»è®¡ç®—æœºè§†è§‰ä¸­å›¾åƒåˆ†ç±»ä»»åŠ¡è„‰ç»œæ¢³ç†An Analysis of Deep Neural Network Models for Practical Applicationsç»å…¸æ¨¡å‹ç»¼è¿°æ¨¡å‹ç»¼è¿°LeNet-5: æ—©æœŸå·ç§¯ç¥ç»ç½‘ç»œä¸­æœ€æœ‰ä»£è¡¨æ€§çš„æ¶æ„ï¼Œæ˜¯Yann LeCunåœ¨1998å¹´è®¾è®¡çš„ï¼Œç”¨äºæ‰‹å†™æ•°å­—è¯†åˆ«çš„å·ç§¯ç¥ç»ç½‘ç»œAlexNet: 2012å¹´ILSVRCå† å†›ï¼Œ6åƒä¸‡å‚æ•°ã€‚ç”±äºå‡†ç¡®ç‡è¿œè¶…ä¼ ç»Ÿæ–¹æ³•çš„ç¬¬äºŒåï¼ˆtop5é”™è¯¯ç‡ä¸º15.3%ï¼Œç¬¬äºŒåä¸º26.2%ï¼‰ï¼Œå¼•èµ·äº†å¾ˆå¤§çš„è½°åŠ¨ã€‚è‡ªæ­¤ä¹‹åï¼ŒCNNæˆä¸ºåœ¨å›¾åƒè¯†åˆ«åˆ†ç±»çš„æ ¸å¿ƒç®—æ³•æ¨¡å‹ï¼Œå¸¦æ¥äº†æ·±åº¦å­¦ä¹ çš„å¤§çˆ†å‘ZF-Net: 2013å¹´ILSVRCå† å†›ï¼Œç»“æ„å’ŒAlexNetåŒºåˆ«ä¸å¤§ï¼Œåˆ†ç±»æ•ˆæœä¹Ÿå·®ä¸å¤šã€‚è¿™ç¯‡æ–‡ç« çš„è´¡çŒ®åœ¨äºï¼Œæå‡ºäº†ä¸€ç§CNNç‰¹å¾å¯è§†åŒ–æ–¹æ³•ï¼šåæ± åŒ–ã€åæ¿€æ´»ã€åå·ç§¯ï¼Œä»è€Œæˆä¸ºCNNç‰¹å¾å¯è§†åŒ–çš„å¼€å±±ä¹‹ä½œGoogLeNet: 2014å¹´ILSVRCå† å†›ç½‘ç»œã€‚åŒæ ·ä¹Ÿæ˜¯5+3çš„æ¨¡å¼ï¼ˆä»¥æ± åŒ–å±‚ä¸ºç•Œï¼‰ï¼Œå‚æ•°é‡çº¦ä¸º5ç™¾ä¸‡ï¼Œæ ¸å¿ƒæ¨¡å—æ˜¯Inception Moduleã€‚Inceptionå†ç»äº†V1ã€V2ã€V3ã€V4ç­‰å¤šä¸ªç‰ˆæœ¬çš„å‘å±•ï¼Œä¸æ–­è¶‹äºå®Œå–„Inception V1ï¼šä¸»è¦æå‡ºäº†å¤šåˆ†æ”¯(å¤šåˆ†è¾¨ç‡çš„filterç»„åˆ)çš„ç½‘ç»œInception V2ï¼š ä¸»è¦æå‡ºäº†BNå±‚ï¼Œæé«˜ç½‘ç»œæ€§èƒ½(å‡å°‘æ¢¯åº¦æ¶ˆå¤±å’Œçˆ†ç‚¸ã€é˜²æ­¢è¿‡æ‹Ÿåˆã€ä»£æ›¿dropoutå±‚ã€ä½¿åˆå§‹åŒ–å­¦ä¹ å‚æ•°æ›´å¤§)Inception V3ï¼šä¸»è¦æå‡ºäº†åˆ†è§£å·ç§¯ï¼ŒæŠŠå¤§å·ç§¯å› å¼åˆ†è§£æˆå°å·ç§¯å’Œéå¯¹ç§°å·ç§¯VGG: 2014å¹´ILSVRCäºšå†›ç½‘ç»œï¼Œ1.38äº¿å‚æ•°ã€‚ç”±äºç½‘ç»œç»“æ„ååˆ†ç®€å•ï¼Œå¾ˆé€‚åˆè¿ç§»å­¦ä¹ ResNet: 2015å¹´ILSVRCå† å†›ç½‘ç»œã€‚æ ¸å¿ƒæ˜¯å¸¦çŸ­è¿æ¥çš„æ®‹å·®æ¨¡å—ï¼Œå…¶ä¸­ä¸»è·¯å¾„æœ‰ä¸¤å±‚å·ç§¯æ ¸ï¼ˆRes34ï¼‰ï¼ŒçŸ­è¿æ¥æŠŠæ¨¡å—çš„è¾“å…¥ä¿¡æ¯ç›´æ¥å’Œç»è¿‡ä¸¤æ¬¡å·ç§¯ä¹‹åçš„ä¿¡æ¯èåˆï¼Œç›¸å½“äºåŠ äº†ä¸€ä¸ªæ’ç­‰å˜æ¢ã€‚çŸ­è¿æ¥æ˜¯æ·±åº¦å­¦ä¹ åˆä¸€é‡è¦æ€æƒ³ï¼Œé™¤è®¡ç®—æœºè§†è§‰å¤–ï¼ŒçŸ­è¿æ¥æ€æƒ³ä¹Ÿè¢«ç”¨åˆ°äº†æœºå™¨ç¿»è¯‘ã€è¯­éŸ³è¯†åˆ«/åˆæˆé¢†åŸŸResNeXt: ResNetçš„å¦ä¸€æ”¹è¿›ã€‚ä¸»è¦æ˜¯é‡‡ç”¨äº†VGGå †å æ€æƒ³å’ŒInceptionçš„split-transform-mergeæ€æƒ³ï¼Œåœ¨ä¸å¢åŠ å‚æ•°å¤æ‚åº¦çš„å‰æä¸‹æé«˜å‡†ç¡®ç‡ã€‚ResNeXtå‘ç°ï¼Œå¢åŠ åˆ†æ”¯æ•°æ˜¯æ¯”åŠ æ·±æˆ–åŠ å®½æ›´æœ‰æ•ˆåœ°æå‡ç½‘ç»œæ€§èƒ½çš„æ–¹å¼DenseNet: CVPR2017çš„oralã€‚ä¸»è¦æ€æƒ³æ˜¯å°†æ¯ä¸€å±‚éƒ½ä¸åé¢çš„å±‚è¿æ¥èµ·æ¥ï¼Œå¦‚æœä¸€ä¸ªç½‘ç»œä¸­æœ‰Lå±‚ï¼Œé‚£ä¹ˆä¼šæœ‰L(L+1)/2ä¸ªè¿æ¥ã€‚é€šè¿‡è¿™æ ·çš„å¯†é›†è¿æ¥ï¼Œæ¯ä¸€å±‚åœ¨æ­£å‘æ—¶å€™éƒ½èƒ½ç›´æ¥æ¥å—åŸå§‹è¾“å…¥ä¿¡å·ï¼Œåœ¨åå‘æ—¶å€™ä¹Ÿéƒ½èƒ½ç›´æ¥æ¥å—æŸå¤±å‡½æ•°çš„æ¢¯åº¦ï¼Œå³è¿™ç§è¿æ¥æ–¹å¼ä½¿å¾—ç‰¹å¾å’Œæ¢¯åº¦çš„ä¼ é€’æ›´åŠ æœ‰æ•ˆï¼Œç½‘ç»œä¹Ÿå°±æ›´åŠ å®¹æ˜“è®­ç»ƒå½“ç„¶ï¼Œå¦‚æœå…¨éƒ¨é‡‡ç”¨è¿™ç§å¯†é›†è¿æ¥çš„æ–¹å¼ï¼Œç‰¹å¾å›¾çš„åšåº¦å°±ä¼šå¾ˆå¤§ã€‚äºæ˜¯é‡‡ç”¨ä¸¤ç§æ–¹å¼é™ä½å‚æ•°é‡ï¼šä¸€æ˜¯å°†å¯†é›†è¿æ¥çš„å±‚åšæˆä¸€ä¸ªæ¨¡å—ï¼Œæ•´ä¸ªç½‘ç»œé‡‡ç”¨æ¨¡å—å †å çš„æ–¹å¼ï¼Œè€Œä¸æ˜¯æ‰€æœ‰å±‚å…¨éƒ¨å¯†é›†è¿æ¥ï¼›äºŒæ˜¯åœ¨dense blockä¸­å¼•å…¥bottleneck layerï¼Œå³å·ç§¯3x3å‰å¢åŠ 1x1å·ç§¯ï¼Œä»¥æ­¤æ¥å‡å°‘feature mapæ•°é‡ç¼ºç‚¹æ˜¯å¤ªåƒæ˜¾å­˜ã€‚é€šå¸¸å ç”¨æ˜¾å­˜çš„ä¸»è¦æ˜¯æ¨æ–­è¿‡ç¨‹ä¸­äº§ç”Ÿçš„feature mapå’Œå‚æ•°é‡ã€‚æœ‰äº›æ¡†æ¶ä¼šæœ‰ä¼˜åŒ–ï¼Œè‡ªåŠ¨æŠŠæ¯”è¾ƒé å‰çš„å±‚çš„feature mapé‡Šæ”¾æ‰ï¼Œæ‰€ä»¥æ˜¾å­˜å°±ä¼šå‡å°‘ï¼Œæˆ–è€…inplaceæ“ä½œé€šè¿‡é‡æ–°è®¡ç®—çš„æ–¹æ³•å‡å°‘ä¸€éƒ¨åˆ†æ˜¾å­˜ï¼Œä½†æ˜¯densenetå› ä¸ºéœ€è¦é‡å¤åˆ©ç”¨æ¯”è¾ƒé å‰çš„feature mapï¼Œæ‰€ä»¥æ— æ³•é‡Šæ”¾ï¼Œå¯¼è‡´æ˜¾å­˜å ç”¨è¿‡å¤§SENet: 2017å¹´ILSVRCå† å†›ç½‘ç»œã€‚æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œå¯ä»¥å’Œå…¶ä»–çš„ç½‘ç»œæ¶æ„ç»“åˆï¼Œæ¯”å¦‚GoogLeNetã€ResNetç­‰å†å²è„‰ç»œ19982012201320142014LeNet-5AlexNetZF-NetGoogLeNetV1ã€V2ã€V3ã€V4VGG2015201620172017ResNetResNeXtDenseNetSENet20202021202220232024VitDeiTã€ClipTOnICSåˆ†ç±»æ•°æ®é›†ImageNetImageNetæ˜¯è®¡ç®—æœºè§†è§‰é¢†åŸŸå¸¸ç”¨çš„æ•°æ®é›†ä¹‹ä¸€ã€‚åœ¨ å›¾åƒåˆ†ç±»ã€ç›®æ ‡åˆ†å‰²å’Œ ç›®æ ‡æ£€æµ‹ä¸­æœ‰ç€æ— æ³•æ’¼åŠ¨çš„åœ°ä½ImageNetæœ€åˆæ˜¯ç”±æé£é£ç­‰äººåœ¨CVPR 2009å¹´å‘è¡¨çš„è®ºæ–‡â€”â€”ã€ŒImageNet: A Large-Scale Hierarchical Image Databaseã€ä¸­å‘å¸ƒçš„å¤šå¹´æ¥ï¼ŒImageNet çš„ç›¸å…³è®ºæ–‡å¯¹ä¸šå†…æœ‰æå¤§çš„å½±å“ImageNetæœ¬èº«åˆ™æ˜¯ä¸€ä¸ªæµ·é‡çš„å¸¦æ ‡æ³¨å›¾åƒæ•°æ®é›†ã€‚é€šè¿‡ä¼—åŒ…ç­‰æ–¹å¼è¿›è¡Œæ ‡æ³¨ï¼Œä»2007å¹´å¼€å§‹ç›´åˆ°2009å¹´å®Œæˆã€‚ImageNetæœ‰è¶…è¿‡1500ä¸‡å¼ å›¾ç‰‡ï¼Œä»…æ±½è½¦å›¾åƒçš„æ•°é‡è¾¾åˆ°äº†70ä¸‡å¼ ï¼Œç±»åˆ«æ•°é‡ä¸º2567ä¸ªã€‚å¦‚æ­¤å·¨é‡ã€ æ ‡æ³¨é”™è¯¯æä½ä¸”å…è´¹çš„æ•°æ®é›†ï¼Œå·²ç»æˆä¸ºå›¾åƒå¤„ç†é¢†åŸŸç ”ç©¶è€…é¦–å…ˆæ¥è§¦çš„æ•°æ®é›†ä¹‹ä¸€æ¯«ä¸å¤¸å¼ çš„è¯´ï¼ŒImageNetæ˜¯å›¾åƒå¤„ç†ç®—æ³•çš„è¯•é‡‘çŸ³ã€‚ä»2010å¹´èµ·ï¼Œæ¯å¹´ImageNetå®˜æ–¹ä¼šä¸¾åŠæŒ‘æˆ˜èµ›ã€‚2017å¹´åçš„æ¯”èµ›ç”±Kaggleç¤¾åŒºä¸»æŒã€‚è‡ª2012å¹´Hintonç­‰çš„å›¢é˜Ÿæå‡ºAlexNetå¼€å§‹ï¼Œæ¯å¹´éƒ½æœ‰å±‚å‡ºä¸ç©·çš„æ¨¡å‹å¸Œæœ›åœ¨ImageNetæ’è¡Œæ¦œä¸Šå–å¾—ä¸€å¸­ä¹‹åœ°torchvisionModels and pre-trained weights â€” Torchvision main documentation (pytorch.org)Datasetstorchvisionæ˜¯PyTorchåº“ä¸­çš„ä¸€ä¸ªå­æ¨¡å—ï¼Œä¸“é—¨ç”¨äºå¤„ç†è®¡ç®—æœºè§†è§‰ä»»åŠ¡ã€‚å®ƒæä¾›äº†è®¸å¤šæœ‰ç”¨çš„å‡½æ•°ã€å·¥å…·å’Œé¢„è®­ç»ƒæ¨¡å‹ï¼Œä½¿å¾—å¤„ç†å›¾åƒå’Œè§†é¢‘æ•°æ®å˜å¾—æ›´åŠ ç®€å•å’Œé«˜æ•ˆtorchvisionçš„åŠŸèƒ½ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼šæ•°æ®é›†å’Œæ•°æ®åŠ è½½ï¼štorchvisionæä¾›äº†å¸¸è§çš„è®¡ç®—æœºè§†è§‰æ•°æ®é›†ï¼Œå¦‚MNISTã€CIFAR10ã€ImageNetç­‰ã€‚å®ƒè¿˜æä¾›äº†æ–¹ä¾¿çš„æ•°æ®åŠ è½½å‡½æ•°å’Œæ•°æ®è½¬æ¢å·¥å…·ï¼Œä½¿å¾—åŠ è½½å’Œé¢„å¤„ç†æ•°æ®å˜å¾—ç®€å•ã€‚å¯ä»¥ä½¿ç”¨è¿™äº›åŠŸèƒ½æ¥å‡†å¤‡è®­ç»ƒæ•°æ®é›†ã€éªŒè¯æ•°æ®é›†å’Œæµ‹è¯•æ•°æ®é›†æ•°æ®è½¬æ¢ï¼štorchvisionåŒ…å«äº†å„ç§å¸¸ç”¨çš„æ•°æ®è½¬æ¢æ“ä½œï¼Œä¾‹å¦‚å›¾åƒç¼©æ”¾ã€è£å‰ªã€æ—‹è½¬ã€ç¿»è½¬ã€æ ‡å‡†åŒ–ç­‰ã€‚è¿™äº›è½¬æ¢æ“ä½œå¯ä»¥æ–¹ä¾¿åœ°åº”ç”¨äºæ•°æ®é›†ï¼Œä»¥å¢å¼ºæ•°æ®çš„å¤šæ ·æ€§å’Œé€‚åº”æ¨¡å‹çš„éœ€æ±‚æ¨¡å‹å’Œé¢„è®­ç»ƒæ¨¡å‹ï¼štorchvisionæä¾›äº†ä¸€äº›ç»å…¸çš„è®¡ç®—æœºè§†è§‰æ¨¡å‹ï¼Œå¦‚AlexNetã€VGGã€ResNetã€Inceptionç­‰ã€‚è¿™äº›æ¨¡å‹éƒ½åœ¨å¤§è§„æ¨¡å›¾åƒæ•°æ®é›†ä¸Šè¿›è¡Œäº†é¢„è®­ç»ƒï¼Œå¯ä»¥ç”¨äºå›¾åƒåˆ†ç±»ã€ç›®æ ‡æ£€æµ‹ã€è¯­ä¹‰åˆ†å‰²ç­‰ä»»åŠ¡ã€‚æ­¤å¤–ï¼Œtorchvisionè¿˜æä¾›äº†åŠ è½½å’Œä½¿ç”¨è¿™äº›é¢„è®­ç»ƒæ¨¡å‹çš„ä¾¿æ·æ¥å£å›¾åƒå·¥å…·ï¼štorchvisionè¿˜åŒ…å«äº†ä¸€äº›å›¾åƒå¤„ç†å·¥å…·ï¼Œå¦‚ç»˜åˆ¶è¾¹ç•Œæ¡†ã€ç»˜åˆ¶å›¾åƒç½‘æ ¼ã€ç»˜åˆ¶ç±»åˆ«æ ‡ç­¾ç­‰ã€‚è¿™äº›å·¥å…·å¯ä»¥ç”¨äºå¯è§†åŒ–å’Œè°ƒè¯•æ¨¡å‹çš„è¾“å‡ºç»“æœæ€»ä¹‹ï¼Œtorchvisionæ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„PyTorchæ¨¡å—ï¼Œæä¾›äº†è®¸å¤šå¤„ç†è®¡ç®—æœºè§†è§‰ä»»åŠ¡æ‰€éœ€çš„å·¥å…·å’ŒåŠŸèƒ½ã€‚å®ƒç®€åŒ–äº†æ•°æ®åŠ è½½ã€æ•°æ®è½¬æ¢ã€æ¨¡å‹åŠ è½½å’Œé¢„æµ‹ç­‰æ“ä½œï¼Œä¸ºè®¡ç®—æœºè§†è§‰ç ”ç©¶äººå‘˜å’Œå¼€å‘è€…æä¾›äº†ä¾¿åˆ©LenetGradient-Based Learning Applied to Document Recognition 1998LeNet-5, convolutional neural networksæ‰‹å†™å­—ä½“è¯†åˆ«æ¨¡å‹LeNet5è¯ç”Ÿäº1994å¹´ï¼Œæ˜¯æœ€æ—©çš„å·ç§¯ç¥ç»ç½‘ç»œä¹‹ä¸€ã€‚LeNet5é€šè¿‡å·§å¦™çš„è®¾è®¡ï¼Œåˆ©ç”¨å·ç§¯ã€å‚æ•°å…±äº«ã€æ± åŒ–ç­‰æ“ä½œæå–ç‰¹å¾ï¼Œé¿å…äº†å¤§é‡çš„è®¡ç®—æˆæœ¬ï¼Œæœ€åå†ä½¿ç”¨å…¨è¿æ¥ç¥ç»ç½‘ç»œè¿›è¡Œåˆ†ç±»è¯†åˆ«ï¼Œè¿™ä¸ªç½‘ç»œä¹Ÿæ˜¯æœ€è¿‘å¤§é‡ç¥ç»ç½‘ç»œæ¶æ„çš„èµ·ç‚¹LeNetæ˜¯ç”±Yann Lecun(2018å¹´å›¾çµå¥–å¾—ä¸»ï¼ŒCNNçš„ç¼”é€ è€…)åˆ›é€ çš„CNNç»å…¸ç½‘ç»œï¼Œæ˜¯å·ç§¯ç¥ç»ç½‘ç»œå²ä¸Šçš„å¼€ç¯‡ä¹‹ä½œä»£ç 1234567891011121314151617181920212223242526272829303132333435363738394041424344import torchimport torch.nn as nnimport torch.nn.functional as Fclass LeNet5(nn.Module):    def __init__(self, num_classes, grayscale=False):         &quot;&quot;&quot;        num_classes: åˆ†ç±»çš„æ•°é‡        grayscaleï¼šæ˜¯å¦ä¸ºç°åº¦å›¾        &quot;&quot;&quot;        super(LeNet5, self).__init__()        self.grayscale = grayscale        self.num_classes = num_classes        if self.grayscale: # å¯ä»¥é€‚ç”¨å•é€šé“å’Œä¸‰é€šé“çš„å›¾åƒ            in_channels = 1        else:            in_channels = 3        # å·ç§¯ç¥ç»ç½‘ç»œ        self.features = nn.Sequential(            nn.Conv2d(in_channels, 6, kernel_size=5),            nn.ReLU(),            nn.MaxPool2d(kernel_size=2),            nn.Conv2d(6, 16, kernel_size=5),            nn.ReLU(),            nn.MaxPool2d(kernel_size=2)   # åŸå§‹çš„æ¨¡å‹ä½¿ç”¨çš„æ˜¯ å¹³å‡æ± åŒ–        )        # åˆ†ç±»å™¨        self.classifier = nn.Sequential(            nn.Linear(16*5*5, 120),  # è¿™é‡ŒæŠŠç¬¬ä¸‰ä¸ªå·ç§¯å½“ä½œæ˜¯å…¨è¿æ¥å±‚äº†            nn.ReLU(),            nn.Linear(120, 84),             nn.ReLU(),            nn.Linear(84, num_classes)        )    def forward(self, x):        x = self.features(x) # è¾“å‡º 16*5*5 ç‰¹å¾å›¾        x = torch.flatten(x, 1) # å±•å¹³ ï¼ˆ1ï¼Œ 16*5*5ï¼‰        logits = self.classifier(x) # è¾“å‡º 10        probas = F.softmax(logits, dim=1)        return logits, probasAlexNetAlexNetä¸LeNetåŒºåˆ«ï¼šå±‚æ•°æ›´å¤š: ç›¸å¯¹è¾ƒå°çš„LeNetç›¸æ¯”ï¼ŒAlexNetåŒ…å«8å±‚å˜æ¢ï¼Œå…¶ä¸­æœ‰5å±‚å·ç§¯å’Œ2å±‚å…¨è¿æ¥éšè—å±‚ï¼Œä»¥åŠ1ä¸ªå…¨è¿æ¥è¾“å‡ºå±‚æ¿€æ´»å‡½æ•°: AlexNetå°†sigmoidæ¿€æ´»å‡½æ•°æ”¹æˆäº†æ›´åŠ ç®€å•çš„ReLUæ¿€æ´»å‡½æ•°dropout: AlexNeté€šè¿‡dropoutæ¥æ§åˆ¶å…¨è¿æ¥å±‚çš„æ¨¡å‹å¤æ‚åº¦ã€‚è€ŒLeNetå¹¶æ²¡æœ‰ä½¿ç”¨ä¸¢å¼ƒæ³•æ•°æ®å¢å¼º: AlexNetå¼•å…¥äº†å¤§é‡çš„å›¾åƒå¢å¹¿ï¼Œå¦‚ç¿»è½¬ã€è£å‰ªå’Œé¢œè‰²å˜åŒ–ï¼Œä»è€Œè¿›ä¸€æ­¥æ‰©å¤§æ•°æ®é›†æ¥ç¼“è§£è¿‡æ‹Ÿåˆæœ€å¤§æ± åŒ–: ç”¨MaxPoolingè€Œä¸æ˜¯AvgPoolingæ¨¡å‹ç»“æ„æ¯”è¾ƒVggVery Deep Convolutional Networks For Large-Scale Image RecognitionVGG â€” Torchvision main documentation (pytorch.org)æ¦‚è¿°å¿«é€Ÿç†è§£VGGç½‘ç»œVGG(Visual Geometry Group)æ˜¯ä¸€ç§ç»å…¸çš„å·ç§¯ç¥ç»ç½‘ç»œæ¶æ„ï¼Œæ˜¯ç‰›æ´¥å¤§å­¦è®¡ç®—æœºè§†è§‰ç»„(Visual Geometry Group)å’Œè°·æ­ŒDeepMindä¸€èµ·ç ”ç©¶å‡ºæ¥çš„æ·±åº¦å·ç§¯ç¥ç»ç½‘ç»œã€‚å…¶åœ¨åœ¨2014å¹´çš„ImageNetå¤§è§„æ¨¡è§†è§‰è¯†åˆ«æŒ‘æˆ˜(ILSVRC-2014)ä¸­è·å¾—äº†äºšå†›ï¼Œå…¶ä¸»è¦è´¡çŒ®æ˜¯é€šè¿‡å¢åŠ ç½‘ç»œçš„æ·±åº¦æ¥æé«˜å‡†ç¡®ç‡ï¼Œå½“å¹´è·å¾—å† å†›çš„æ˜¯GoogLeNetè™½ç„¶å…¶å±ˆå±…äºšå†›ï¼Œä½†æ˜¯ç”±äºå…¶è§„å¾‹çš„è®¾è®¡ã€ç®€æ´å¯å †å çš„å·ç§¯å—ï¼Œä¸”åœ¨å…¶ä»–æ•°æ®é›†ä¸Šéƒ½æœ‰ç€å¾ˆå¥½çš„è¡¨ç°ï¼Œä»è€Œè¢«äººä»¬å¹¿æ³›ä½¿ç”¨ï¼Œä»è¿™ç‚¹ä¸Šè¿˜æ˜¯è¶…è¿‡äº†GoogLenetVGG16ç›¸æ¯”AlexNetçš„ä¸€ä¸ªæ”¹è¿›æ˜¯é‡‡ç”¨è¿ç»­çš„å‡ ä¸ªçš„å·ç§¯æ ¸ä»£æ›¿AlexNetä¸­çš„è¾ƒå¤§å·ç§¯æ ¸(ï¼Œï¼Œ)VGGç½‘ç»œçš„æ ¸å¿ƒæ€æƒ³ä½¿ç”¨å¤šä¸ªè¿ç»­çš„$ 3 \times 3$å·ç§¯å±‚æ¥æ›¿ä»£è¾ƒå¤§æ„Ÿå—é‡çš„å·ç§¯å±‚ï¼Œè¿™ç§è®¾è®¡çš„ä¼˜åŠ¿å¯ä»¥å¢åŠ ç½‘ç»œçš„æ·±åº¦ï¼Œä½¿ç½‘ç»œèƒ½å¤Ÿæ›´å¥½åœ°æ•æ‰å›¾åƒçš„ç»†èŠ‚å’Œå¤æ‚ç‰¹å¾å¯¹äºç»™å®šçš„æ„Ÿå—é‡(ä¸è¾“å‡ºæœ‰å…³çš„è¾“å…¥å›¾ç‰‡çš„å±€éƒ¨å¤§å°)ï¼Œé‡‡ç”¨å †ç§¯çš„å°å·ç§¯æ ¸æ˜¯ä¼˜äºé‡‡ç”¨å¤§çš„å·ç§¯æ ¸å‚æ•°æ›´å°‘: æ¯”å¦‚ï¼Œ3ä¸ªæ­¥é•¿ä¸º1çš„$ 3 \times 3$å·ç§¯æ ¸çš„ä¸€å±‚å±‚å åŠ ä½œç”¨å¯çœ‹æˆä¸€ä¸ªå¤§å°ä¸º7çš„æ„Ÿå—é‡(å…¶å®å°±è¡¨ç¤º3ä¸ª$ 3 \times 3$è¿ç»­å·ç§¯ç›¸å½“äºä¸€ä¸ª$ 7 \times 7$å·ç§¯)å…¶å‚æ•°æ€»é‡ä¸º$ 3 \times (9 \times C^2) $ï¼Œå¦‚æœç›´æ¥ä½¿ç”¨$ 7 \times 7$å·ç§¯æ ¸ï¼Œå…¶å‚æ•°æ€»é‡ä¸º$ 49 \times C^2 $ï¼Œè¿™é‡Œ$C$æŒ‡çš„æ˜¯è¾“å…¥å’Œè¾“å‡ºçš„é€šé“æ•°å¾ˆæ˜æ˜¾å‡å°‘äº†å‚æ•°ï¼Œè€Œä¸”3x3å·ç§¯æ ¸æœ‰åˆ©äºæ›´å¥½åœ°ä¿æŒå›¾åƒæ€§è´¨ä¸Šå›¾å°±æ˜¯ç”¨ä¸¤ä¸ª$ 3 \times 3$å·ç§¯çº§è”(å åŠ )èµ·æ¥ä»£æ›¿ä¸€ä¸ª$ 5 \times 5$å·ç§¯ï¼ŒåŒç†å¯ä»¥ç”¨ä¸‰ä¸ª$ 3 \times 3$å·ç§¯çº§è”(å åŠ )èµ·æ¥ä»£æ›¿ä¸€ä¸ª$ 7 \times 7 $å·ç§¯ç®€æ´ä¸€è‡´VGGç½‘ç»œçš„ä¸€ä¸ªé‡è¦ç‰¹ç‚¹æ˜¯å…¶ç®€æ´è€Œä¸€è‡´çš„ç»“æ„ã€‚å®ƒä½¿ç”¨äº†å°å°ºå¯¸çš„å·ç§¯æ ¸($ 3 \times 3$)ï¼Œå¹¶ä¸”åœ¨æ¯ä¸ªå·ç§¯å±‚å—ä¸­éƒ½ä½¿ç”¨äº†ç›¸åŒæ•°é‡çš„å·ç§¯å±‚å’Œæ± åŒ–å±‚ï¼Œè¿™ç§è®¾è®¡ä½¿å¾—ç½‘ç»œçš„ç»“æ„éå¸¸è§„æ•´ï¼Œæ–¹ä¾¿ç†è§£å’Œå®ç°VGGç½‘ç»œçš„æ¶æ„å¯ä»¥æ ¹æ®æ·±åº¦çš„ä¸åŒè¿›è¡Œåˆ†ç±»ï¼Œæœ€å¸¸è§çš„æ˜¯VGG16å’ŒVGG19ã€‚VGG16åŒ…å«16ä¸ªå·ç§¯å±‚å’Œ3ä¸ªå…¨è¿æ¥å±‚ï¼Œè€ŒVGG19åˆ™åŒ…å«19ä¸ªå·ç§¯å±‚å’Œ3ä¸ªå…¨è¿æ¥å±‚ã€‚è¿™äº›ç½‘ç»œåœ¨ImageNetå›¾åƒåˆ†ç±»ä»»åŠ¡ä¸Šå–å¾—äº†å¾ˆå¥½çš„æ€§èƒ½ï¼Œæˆä¸ºäº†åç»­å·ç§¯ç¥ç»ç½‘ç»œè®¾è®¡çš„é‡è¦å‚è€ƒå°½ç®¡VGGç½‘ç»œå·²ç»è¢«æ›´å…ˆè¿›çš„ç½‘ç»œæ¶æ„æ‰€å–ä»£ï¼Œä½†å…¶ç®€æ´è€Œä¸€è‡´çš„ç»“æ„ä»¥åŠè‰¯å¥½çš„æ€§èƒ½ä½¿å…¶ä»ç„¶è¢«å¹¿æ³›åº”ç”¨äºå›¾åƒåˆ†ç±»ã€ç‰¹å¾æå–å’Œè¿ç§»å­¦ä¹ ç­‰ä»»åŠ¡ã€‚åŒæ—¶ï¼ŒVGGç½‘ç»œä¹Ÿä¸ºåç»­æ·±åº¦å­¦ä¹ ç ”ç©¶æä¾›äº†é‡è¦çš„å¯ç¤ºï¼Œå°¤å…¶æ˜¯å…³äºç½‘ç»œæ·±åº¦å’Œå·ç§¯æ ¸å°ºå¯¸å¯¹æ€§èƒ½çš„å½±å“æ¨¡å‹æ•´ä½“ç»“æ„VGGNetä»¥ä¸‹6ç§ä¸åŒç»“æ„ï¼Œæˆ‘ä»¬ä»¥é€šå¸¸æ‰€è¯´çš„VGG-16(å³ä¸‹å›¾Dåˆ—)ä¸ºä¾‹ï¼Œå±•ç¤ºå…¶ç»“æ„ç¤ºæ„å›¾å®˜æ–¹ç»™å‡ºçš„VGGç³»åˆ—ç¥ç»ç½‘ç»œçš„å‚æ•°é‡å¦‚ä¸‹ï¼šNetworkA, A-LRNBCDEå‚æ•°é‡(in millions)133133134138144å¯¹äºVGG16æ¥è®²ï¼Œå®ƒçš„ç½‘ç»œç»“ç»“æ„å›¾å°±å¦‚ä¸‹æ‰€ç¤ºvgg-blockå—ç”±nä¸ªç›¸åŒç»“æ„çš„å·ç§¯å±‚+1ä¸ªçš„æ± åŒ–å±‚æ„æˆï¼Œæ„å‘³ç€è¾“å…¥å’Œè¾“å‡ºçš„å°ºå¯¸ä¸€æ ·ï¼Œä¸”å·ç§¯å±‚å¯ä»¥å †å å¤ç”¨å¯¹äºVgg-16ï¼Œæ•´ä¸ªç½‘ç»œæœ‰5ä¸ªvgg-blockå—å’Œ5ä¸ªmaxpoolå±‚é€ä¸ªç›¸è¿ï¼Œç„¶åè¿›å…¥FCå±‚ï¼Œç›´åˆ°æœ€å1000è·¯softmaxè¾“å‡ºæ¥è®¡ç®—ä¸€ä¸‹VGG16çš„å‚æ•°é‡layershapefilterå‚æ•°æ•°é‡(å¸¦bias)2-block4-block6-block8-block10-block12-Dense13-Dense14-Denseæ€»æ•°VGGçš„ç‰¹ç‚¹vgg-blockå†…çš„å·ç§¯å±‚éƒ½æ˜¯åŒç»“æ„çš„æ± åŒ–å±‚éƒ½å¾—ä¸Šä¸€å±‚çš„å·ç§¯å±‚ç‰¹å¾ç¼©å‡ä¸€åŠæ·±åº¦è¾ƒæ·±ï¼Œå‚æ•°é‡å¤Ÿå¤§è¾ƒå°çš„filter size/kernel sizeæ•°æ®å¢å¼ºæ–¹é¢VGGç½‘ç»œä¸­ï¼Œæ•°æ®å¢å¼ºä½¿ç”¨çš„æ˜¯Multi-Scaleè¿™é‡Œçš„Multi-Scaleä¸»è¦æ˜¯å°†å›¾åƒæ”¾å¤§åˆ°éšæœºçš„å¤§å°ï¼Œç„¶åå†è£å‰ªåˆ°224*224çš„å›¾åƒæ ¸å¿ƒä»£ç -ç»å…¸å·ç§¯ç¥ç»ç½‘ç»œâ€”â€”VGG1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283import torchfrom torch import nnfrom torchvision import transformsimport torchvisionfrom torch.utils import datafrom d2l import torch as d2limport numpy as npimport matplotlib.pyplot as plt# è®¾è®¡VGGå—ï¼Œå¤šä¸ªå·ç§¯è¿‡åä¸€ä¸ªæœ€å¤§æ± åŒ–å±‚# å·ç§¯è¿‡åçš„è¾“å…¥è¾“å‡ºå›¾ç‰‡å¤§å°ä¸å˜ï¼Œé€šé“æœ‰å˜åŒ–# ç»è¿‡æœ€å¤§æ± åŒ–åï¼Œå®½é«˜ç¼©å‡ä¸€åŠdef vgg_block(num_convs, in_channels, out_channels):    layers = []    for _ in range(num_convs):        layers.append(nn.Conv2d(in_channels,out_channels,kernel_size=3,padding=1))        layers.append(nn.ReLU())        in_channels = out_channels    layers.append(nn.MaxPool2d(kernel_size=2,stride=2))    return nn.Sequential(*layers)# VGGæ¶æ„ï¼ŒVGGå—(å·ç§¯å±‚ï¼Œouttput),ç»è¿‡äº”å±‚VGGå—è¿‡åï¼Œå®½é«˜ä¸ºï¼ˆ7ï¼Œ7ï¼‰# è¿™ä¸ªæ¶æ„å¯ä»¥ç§°ä¸ºVGG-11,1+1+2*3+1+1+1 = 11conv_arch = ((1, 64), (1, 128), (2, 256), (2, 512), (2, 512))def vgg(conv_arch):    conv_blocks = []    in_channels = 1    for (num_convs, out_channels) in conv_arch:        conv_blocks.append(vgg_block(num_convs,in_channels,out_channels))        in_channels = out_channels    return nn.Sequential(        *conv_blocks,        nn.Flatten(),        # å…¨è¿æ¥å±‚éƒ¨åˆ†        nn.Linear(out_channels * 7 * 7, 4096), nn.ReLU(), nn.Dropout(0.5),        nn.Linear(4096, 4096), nn.ReLU(), nn.Dropout(0.5),        nn.Linear(4096, 10)        )net = vgg(conv_arch)# è§‚å¯Ÿæ¯ä¸ªå±‚çš„è¾“å‡ºæƒ…å†µx = torch.randn(1,1,224,224)for layer in net:    x = layer(x)    print(layer.__class__.__name__,&quot;output shape:&quot;,x.shape)small_conv_arch = ((1, 16), (1, 32), (2, 32), (2, 64), (2, 64))net = vgg(small_conv_arch)# ç°åœ¨ä½¿ç”¨mnistæ•°æ®é›†æµ‹è¯•ä¸€ä¸‹ç»“æœdef load_data_fashion_mnist(batch_size, resize=None):    &quot;&quot;&quot;ä¸‹è½½æˆ–è€…åŠ è½½Fashion-MNISTæ•°æ®é›†&quot;&quot;&quot;    trans = [transforms.ToTensor()]    if resize:        # éœ€è¦æŠŠå›¾ç‰‡æ‹‰é•¿,æ­£å¸¸æ—¶ä¸ä¼šè¿™ä¹ˆåšçš„        trans.insert(0, transforms.Resize(resize))    trans = transforms.Compose(trans) # è¿™æ˜¯ä¸€æ­¥å¯ä»¥å»æ‰çš„æ“ä½œï¼Œè¿™ä¸ªå°±æ˜¯æŠŠå¤šä¸ªå›¾åƒå¤„ç†çš„æ­¥éª¤æ•´åˆåˆ°ä¸€èµ·    mnist_train = torchvision.datasets.FashionMNIST(        root=&quot;../data/&quot;,        train=True,        transform=trans,        download=False # è¦æ˜¯æ²¡ä¸‹è½½è¿‡å°±é€‰æ‹©true    )    mnist_test = torchvision.datasets.FashionMNIST(        root=&quot;../data/&quot;,        train=False,        transform=trans,        download=False # è¦æ˜¯æ²¡ä¸‹è½½è¿‡å°±é€‰æ‹©true    )    return (data.DataLoader(mnist_train,batch_size=batch_size,shuffle=True,num_workers=0),            data.DataLoader(mnist_test,batch_size=batch_size,shuffle=True,num_workers=0))    batch_size = 64learning_rate = 0.01epochs = 10train_iter,test_iter = load_data_fashion_mnist(batch_size,resize=(224))d2l.train_ch6(net,train_iter,test_iter,epochs,lr=learning_rate,device=d2l.try_gpu())    ç¼ºç‚¹å°½ç®¡VGGåœ¨æ·±åº¦å­¦ä¹ ä¸­å…·æœ‰é‡è¦çš„åœ°ä½å’Œå½±å“åŠ›ï¼Œä½†å®ƒä¹Ÿå­˜åœ¨ä¸€äº›ç¼ºç‚¹ï¼ŒåŒ…æ‹¬ï¼šå¤§é‡å‚æ•°ï¼šVGGç½‘ç»œå…·æœ‰å¾ˆæ·±çš„ç»“æ„ï¼Œå…¶ä¸­åŒ…å«å¤šä¸ªå·ç§¯å±‚å’Œå…¨è¿æ¥å±‚ã€‚è¿™å¯¼è‡´äº†ç½‘ç»œä¸­çš„å‚æ•°æ•°é‡å¾ˆå¤§ï¼Œéœ€è¦æ›´å¤šçš„è®¡ç®—èµ„æºå’Œå­˜å‚¨ç©ºé—´ã€‚åœ¨è®­ç»ƒå’Œæ¨ç†è¿‡ç¨‹ä¸­ï¼Œè¿™ä¼šå¢åŠ è®¡ç®—çš„å¤æ‚æ€§å’Œæ—¶é—´æˆæœ¬è®¡ç®—èµ„æºè¦æ±‚é«˜ï¼šç”±äºVGGç½‘ç»œçš„æ·±åº¦å’Œå‚æ•°é‡è¾ƒå¤§ï¼Œéœ€è¦è¾ƒé«˜çš„è®¡ç®—èµ„æºæ¥è¿›è¡Œè®­ç»ƒå’Œæ¨ç†ã€‚è¿™å¯¹äºä¸€äº›èµ„æºå—é™çš„ç¯å¢ƒæ¥è¯´å¯èƒ½æ˜¯ä¸€ä¸ªæŒ‘æˆ˜ï¼Œç‰¹åˆ«æ˜¯åœ¨ç§»åŠ¨è®¾å¤‡æˆ–åµŒå…¥å¼ç³»ç»Ÿä¸Šåº”ç”¨VGGç½‘ç»œæ—¶è¿‡åº¦æ‹Ÿåˆï¼šç”±äºVGGç½‘ç»œçš„æ·±åº¦å’Œå‚æ•°é‡è¾ƒå¤§ï¼Œå®ƒå¯¹äºè¾ƒå°çš„æ•°æ®é›†å®¹æ˜“å‘ç”Ÿè¿‡æ‹Ÿåˆçš„æƒ…å†µã€‚åœ¨åº”ç”¨VGGç½‘ç»œæ—¶ï¼Œå¦‚æœè®­ç»ƒæ•°æ®ä¸å¤Ÿä¸°å¯Œï¼Œæ¨¡å‹å¯èƒ½ä¼šè¿‡åº¦ä¾èµ–äºè®­ç»ƒé›†çš„ç‰¹ç‚¹ï¼Œå¯¼è‡´åœ¨æ–°æ•°æ®ä¸Šçš„æ³›åŒ–èƒ½åŠ›ä¸‹é™ç¼ºä¹ç©ºé—´ä¿¡æ¯åˆ©ç”¨ï¼šVGGç½‘ç»œä»…ä½¿ç”¨äº†æ± åŒ–å±‚æ¥å‡å°ç‰¹å¾å›¾çš„å°ºå¯¸ï¼Œä½†åœ¨å‡å°å°ºå¯¸çš„åŒæ—¶ä¸¢å¤±äº†ä¸€éƒ¨åˆ†ç©ºé—´ä¿¡æ¯ã€‚ç›¸æ¯”äºä¸€äº›å…·æœ‰è·³è·ƒè¿æ¥æˆ–æ³¨æ„åŠ›æœºåˆ¶çš„ç½‘ç»œï¼ŒVGGåœ¨åˆ©ç”¨å›¾åƒä¸­çš„ç©ºé—´å…³ç³»æ–¹é¢ç›¸å¯¹è¾ƒå¼±è¾ƒé«˜çš„å†…å­˜éœ€æ±‚ï¼šç”±äºVGGç½‘ç»œä¸­çš„å·ç§¯å±‚å’Œå…¨è¿æ¥å±‚è¾ƒå¤šï¼Œå…¶ç”Ÿæˆçš„ç‰¹å¾å›¾è¾ƒå¤§ï¼Œéœ€è¦è¾ƒå¤§çš„å†…å­˜æ¥å­˜å‚¨ä¸­é—´ç»“æœã€‚è¿™å¯èƒ½ä¼šé™åˆ¶VGGç½‘ç»œåœ¨ä¸€äº›å†…å­˜å—é™çš„è®¾å¤‡æˆ–å¹³å°ä¸Šçš„åº”ç”¨GoogleNetRethinking the Inception Architecture for Computer Vision 2015Inception-V3è®ºæ–‡ç¿»è¯‘â€”â€”ä¸­è‹±æ–‡å¯¹ç…§GoogLeNetç½‘ç»œç³»åˆ—è§£è¯»GoogLeNetæ˜¯ç”±Googleå›¢é˜Ÿåœ¨2014å¹´æå‡ºçš„ä¸€ç§æ·±åº¦å·ç§¯ç¥ç»ç½‘ç»œæ¶æ„ï¼Œä¹Ÿè¢«ç§°ä¸ºInceptionç½‘ç»œã€‚ç›¸æ¯”äºä¼ ç»Ÿçš„å·ç§¯ç¥ç»ç½‘ç»œï¼ŒGoogLeNeté‡‡ç”¨äº†ä¸€ç§ç‰¹æ®Šçš„æ¨¡å—åŒ–è®¾è®¡ï¼Œæ—¨åœ¨æé«˜ç½‘ç»œçš„è®¡ç®—æ•ˆç‡å’Œè¡¨è¾¾èƒ½åŠ›GooLeNetæ·±åº¦åªæœ‰22å±‚ï¼Œä½†å¤§å°å´æ¯”AlexNetå’ŒVGGå°å¾ˆå¤šï¼ŒGooLeNetçš„å‚æ•°ä¸º500ä¸‡ä¸ªï¼ŒAlexNetå‚æ•°ä¸ªæ•°æ˜¯GooLeNetçš„12å€ï¼ŒVGGNetå‚æ•°åˆæ˜¯AlexNetçš„3å€InceptionV1 å¦‚ä½•æå‡ç½‘ç»œæ€§èƒ½ä¸€èˆ¬æå‡ç½‘ç»œæ€§èƒ½æœ€ç›´æ¥çš„æ–¹æ³•æ˜¯å¢åŠ ç½‘ç»œæ·±åº¦å’Œå®½åº¦ï¼Œæ·±åº¦æŒ‡ç½‘ç»œå±‚æ•°ï¼Œå®½åº¦æŒ‡ç¥ç»å…ƒæ•°é‡ï¼Œä½†æ˜¯ä¼šå­˜åœ¨ä¸€äº›é—®é¢˜ï¼šå‚æ•°å¤ªå¤šï¼Œå¦‚æœè®­ç»ƒæ•°æ®é›†æœ‰é™ï¼Œå¾ˆå®¹æ˜“äº§ç”Ÿè¿‡æ‹Ÿåˆç½‘ç»œè¶Šå¤§ï¼Œå‚æ•°è¶Šå¤šï¼Œåˆ™è®¡ç®—å¤æ‚åº¦è¶Šå¤§ï¼Œéš¾ä»¥åº”ç”¨ç½‘ç»œè¶Šæ·±ï¼Œå®¹æ˜“å‡ºç°æ¢¯åº¦å¼¥æ•£é—®é¢˜(æ¢¯åº¦è¶Šå¾€åè¶Šå®¹æ˜“æ¶ˆå¤±)ï¼Œéš¾ä»¥ä¼˜åŒ–æ¨¡å‹æœ‰ä¸€ç§è§£å†³æ–¹å¼æ˜¯å¢åŠ ç½‘ç»œçš„æ·±åº¦å’Œå®½åº¦çš„åŒæ—¶å‡å°‘å‚æ•°ï¼Œä¸ºäº†å‡å°‘å‚æ•°ä¸€ç§æ–¹å¼æ˜¯å°†å…¨è¿æ¥å˜æˆç¨€ç–è¿æ¥(Dropout)ä½†å®é™…ä¸Šç¨€ç–è¿æ¥çš„è®¡ç®—æ€§èƒ½å¹¶ä¸ä¼šæœ‰è´¨çš„æå‡ã€‚è¿™æ˜¯å› ä¸ºå¤§éƒ¨åˆ†ç¡¬ä»¶æ˜¯é’ˆå¯¹å¯†é›†çŸ©é˜µè®¡ç®—ä¼˜åŒ–çš„GooLeNetæå‡ºäº†ä¸€ç§Inceptionç½‘ç»œç»“æ„ï¼Œæ„é€ ä¸€ç§â€œåŸºç¡€ç¥ç»å…ƒâ€ç»“æ„ï¼Œæ¥æ­å»ºä¸€ä¸ªç¨€ç–æ€§ï¼Œé«˜è®¡ç®—æ€§èƒ½çš„ç½‘ç»œç»“æ„ã€‚æ—¢èƒ½ä¿æŒç½‘ç»œç»“æ„çš„ç¨€ç–æ€§ï¼Œåˆèƒ½åˆ©ç”¨å¯†é›†çŸ©é˜µçš„é«˜è®¡ç®—æ€§èƒ½Inceptionæ¨¡å—GoogLeNetçš„æ ¸å¿ƒæ˜¯Inceptionæ¨¡å—ï¼Œè¿™æ˜¯ä¸€ç§å¤šå°ºåº¦ç‰¹å¾æå–æ¨¡å—ã€‚å®ƒé€šè¿‡å¹¶è¡Œåœ°ä½¿ç”¨ä¸åŒå¤§å°çš„å·ç§¯æ ¸å’Œæ± åŒ–æ“ä½œæ¥æ•æ‰å›¾åƒä¸­ä¸åŒå°ºåº¦çš„ç‰¹å¾ã€‚è¿™æ ·çš„è®¾è®¡å¯ä»¥åœ¨ä¿æŒè®¡ç®—æ•ˆç‡çš„åŒæ—¶ï¼Œå¢åŠ ç½‘ç»œå¯¹ä¸åŒå°ºåº¦ä¿¡æ¯çš„æ„ŸçŸ¥èƒ½åŠ›å¦ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„ç‰¹ç‚¹æ˜¯GoogLeNetä¸­é‡‡ç”¨äº†$ 1 \times 1$å·ç§¯æ ¸çš„å·ç§¯å±‚ï¼Œç§°ä¸ºç“¶é¢ˆå±‚ã€‚è¿™äº›$ 1 \times 1$å·ç§¯å±‚ä¸»è¦ç”¨äºé™ä½è¾“å…¥é€šé“çš„ç»´åº¦ï¼Œå‡å°‘ç½‘ç»œçš„å‚æ•°é‡å’Œè®¡ç®—å¤æ‚åº¦ã€‚åŒæ—¶ï¼Œå®ƒä»¬è¿˜èƒ½å¤Ÿå¼•å…¥éçº¿æ€§å˜æ¢ï¼Œæé«˜ç½‘ç»œçš„è¡¨è¾¾èƒ½åŠ›GoogLeNetè¿˜é‡‡ç”¨äº†å…¨å±€å¹³å‡æ± åŒ–å±‚ï¼Œå°†æœ€åä¸€ä¸ªå·ç§¯å±‚çš„ç‰¹å¾å›¾è¿›è¡Œå¹³å‡æ± åŒ–ï¼Œå¾—åˆ°å…¨å±€çš„ç‰¹å¾è¡¨ç¤ºã€‚è¿™æ ·å¯ä»¥æ˜¾è‘—å‡å°‘å…¨è¿æ¥å±‚çš„å‚æ•°é‡ï¼Œæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ï¼Œå¹¶ä¸”é™ä½è¿‡æ‹Ÿåˆçš„é£é™©Inceptionç½‘ç»œå’ŒVGGç½‘ç»œVGGç½‘ç»œæ³¨é‡å¢åŠ ç½‘ç»œçš„æ·±åº¦æ¥æå–æ›´å¤æ‚çš„ç‰¹å¾ï¼Œè€ŒInceptionç½‘ç»œåˆ™é€šè¿‡å¹¶è¡Œçš„å·ç§¯åˆ†æ”¯æ¥æ•æ‰å¤šå°ºåº¦çš„ç‰¹å¾ä¿¡æ¯ã€‚å› æ­¤ï¼ŒInceptionç½‘ç»œç›¸å¯¹äºVGGç½‘ç»œæ¥è¯´å…·æœ‰æ›´é«˜çš„è®¡ç®—æ•ˆç‡å’Œå‚æ•°æ•ˆç‡Inception-v1Going Deeper with Convolutions 2014 Inception-v1Inception Moduleæ˜¯GoogLeNetçš„æ ¸å¿ƒç»„æˆå•å…ƒï¼Œç»“æ„å¦‚ä¸‹å›¾Inception ModuleåŸºæœ¬ç»„æˆç»“æ„æœ‰å››ä¸ªæˆåˆ†ã€‚$ 1 \times 1$å·ç§¯ï¼Œ$ 3 \times 3$å·ç§¯ï¼Œ$ 5 \times 5$å·ç§¯ï¼Œ$ 3 \times 3$æœ€å¤§æ± åŒ–ï¼Œæœ€åå¯¹å››ä¸ªæˆåˆ†è¿ç®—ç»“æœè¿›è¡Œé€šé“ä¸Šç»„åˆè¿™å°±æ˜¯Inception Moduleçš„æ ¸å¿ƒæ€æƒ³ï¼Œé€šè¿‡å¤šä¸ªå·ç§¯æ ¸æå–å›¾åƒä¸åŒå°ºåº¦çš„ä¿¡æ¯ï¼Œæœ€åè¿›è¡Œèåˆï¼Œå¯ä»¥å¾—åˆ°å›¾åƒæ›´å¥½çš„è¡¨å¾è¾…åŠ©åˆ†ç±»å™¨(æœŸæœ›ç¼“è§£æ¢¯åº¦æ¶ˆå¤±é—®é¢˜)å®Œæ•´çš„ç»“æ„å¯ä»¥çœ‹åŸè®ºæ–‡ï¼Œæˆ–è€…æ˜¯è¿™ä¸ªé“¾æ¥ä¸ºäº†é¿å…æ¢¯åº¦æ¶ˆå¤±ï¼Œç½‘ç»œé¢å¤–å¢åŠ 2ä¸ªè¾…åŠ©çš„softmaxç”¨äºå‘å‰ä¼ å¯¼æ¢¯åº¦(è¾…åŠ©åˆ†ç±»å™¨)ï¼Œè¾…åŠ©åˆ†ç±»å™¨æ˜¯å°†ä¸­é—´æŸä¸€å±‚çš„è¾“å‡ºç”¨ä½œåˆ†ç±»ï¼Œå¹¶æŒ‰ä¸€ä¸ªè¾ƒå°çš„æƒé‡(0.3)åŠ åˆ°æœ€ç»ˆåˆ†ç±»ç»“æœä¸­ï¼Œè¿™æ ·å°±ç›¸å½“äºåšäº†æ¨¡å‹èåˆï¼ŒåŒæ—¶ç»™ç½‘ç»œå¢åŠ äº†åå‘ä¼ æ’­çš„æ¢¯åº¦ä¿¡å·ï¼Œä¹Ÿæä¾›äº†é¢å¤–çš„æ­£åˆ™åŒ–ï¼Œå¯¹äºæ•´ä¸ªç½‘ç»œçš„è®­ç»ƒå¾ˆæœ‰è£¨ç›Šï¼Œå®é™…æµ‹è¯•æ—¶ä¼šå»æ‰è¿™ä¸¤ä¸ªé¢å¤–çš„softmaxInception-v2Batch Normalization: Accelerating Deep Network Training by Reducing Internal Covariate Shift 2015 Inception-v2Inception v2åœ¨åŸå§‹çš„Inception v1çš„åŸºç¡€ä¸Šå¼•å…¥äº†Batch Normalization(æ‰¹é‡å½’ä¸€åŒ–)æŠ€æœ¯ï¼Œè¿™æ˜¯å®ƒçš„ä¸»è¦è´¡çŒ®ã€‚Batch Normalizationæ˜¯ä¸€ç§ç”¨äºåŠ é€Ÿç¥ç»ç½‘ç»œè®­ç»ƒå’Œæé«˜ç½‘ç»œæ€§èƒ½çš„æŠ€æœ¯é€šè¿‡ä½¿ç”¨Batch Normalizationï¼ŒInception v2å®ç°äº†ä»¥ä¸‹å‡ ä¸ªé‡è¦çš„ä¼˜åŠ¿ï¼šåŠ é€Ÿè®­ç»ƒï¼šBatch Normalizationå¯ä»¥ä½¿ç½‘ç»œæ›´å¿«åœ°æ”¶æ•›ï¼Œå› ä¸ºå®ƒå‡å°‘äº†è®­ç»ƒè¿‡ç¨‹ä¸­çš„æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸é—®é¢˜ï¼Œä»è€ŒåŠ é€Ÿäº†æ¢¯åº¦ä¼ æ’­å’Œå‚æ•°æ›´æ–°æé«˜ç½‘ç»œçš„ç¨³å®šæ€§ï¼šBatch Normalization ä½¿å¾—ç½‘ç»œå¯¹è¾“å…¥æ•°æ®çš„å˜åŒ–æ›´åŠ é²æ£’ï¼Œå‡å°‘äº†å¯¹è¾“å…¥æ•°æ®åˆ†å¸ƒå’Œå¤§å°çš„æ•æ„Ÿæ€§ï¼Œæé«˜äº†ç½‘ç»œçš„ç¨³å®šæ€§å‡å°‘å¯¹è¶…å‚æ•°çš„æ•æ„Ÿæ€§ï¼šBatch Normalization å‡å°‘äº†ç½‘ç»œå¯¹å­¦ä¹ ç‡å’Œæƒé‡åˆå§‹åŒ–ç­‰è¶…å‚æ•°çš„æ•æ„Ÿæ€§ï¼Œä½¿å¾—ç½‘ç»œæ›´å®¹æ˜“è°ƒä¼˜å’Œè®­ç»ƒæ­£åˆ™åŒ–æ•ˆæœï¼šBatch Normalization å…·æœ‰ä¸€å®šçš„æ­£åˆ™åŒ–æ•ˆæœï¼Œå¯ä»¥å‡å°‘è¿‡æ‹Ÿåˆé—®é¢˜ï¼Œæé«˜ç½‘ç»œçš„æ³›åŒ–èƒ½åŠ›å› æ­¤ï¼ŒInception v2çš„ä¸»è¦è´¡çŒ®åœ¨äºå¼•å…¥äº†Batch NormalizationæŠ€æœ¯ï¼Œä½¿å¾—ç½‘ç»œçš„è®­ç»ƒæ›´åŠ ç¨³å®šå’Œé«˜æ•ˆï¼Œè¿›ä¸€æ­¥æ¨åŠ¨äº†æ·±åº¦å­¦ä¹ æ¨¡å‹çš„å‘å±•å’Œåº”ç”¨ç›¸æ¯”è¾ƒäºv1$5 \times 5$å·ç§¯å±‚è¢«æ›¿æ¢ä¸ºä¸¤ä¸ªè¿ç»­çš„$3 \times 3$å·ç§¯å±‚. ç½‘ç»œçš„æœ€å¤§æ·±åº¦å¢åŠ 9ä¸ªæƒé‡å±‚. å‚æ•°é‡å¢åŠ äº†å¤§çº¦25%ï¼Œè®¡ç®—é‡å¢åŠ äº†å¤§çº¦30%ä½¿ç”¨BNå±‚ï¼Œå°†æ¯ä¸€å±‚çš„è¾“å‡ºéƒ½è§„èŒƒåŒ–åˆ°ä¸€ä¸ª$N(0,1)$çš„æ­£æ€åˆ†å¸ƒï¼Œæé«˜ç½‘ç»œæ”¶æ•›é€Ÿåº¦Inception-v3Rethinking the Inception Architecture for Computer Vision 2015 Inception-v3Inception V3ä¸€ä¸ªæœ€é‡è¦çš„æ”¹è¿›æ˜¯åˆ†è§£(Factorization)ï¼Œå°†$7 \times 7$åˆ†è§£æˆä¸¤ä¸ªä¸€ç»´çš„å·ç§¯($1 \times 7$ï¼Œ$7 \times 1$)ï¼Œ$3 \times 3$ä¹Ÿæ˜¯ä¸€æ ·($1 \times 3$ï¼Œ$3 \times 1$)ï¼Œè¿™æ ·çš„å¥½å¤„ï¼Œæ—¢å¯ä»¥åŠ é€Ÿè®¡ç®—ï¼Œåˆå¯ä»¥å°†1ä¸ªå·ç§¯æ‹†æˆ2ä¸ªå·ç§¯ï¼Œä½¿å¾—ç½‘ç»œæ·±åº¦è¿›ä¸€æ­¥å¢åŠ ï¼Œå¢åŠ äº†ç½‘ç»œçš„éçº¿æ€§(æ¯å¢åŠ ä¸€å±‚éƒ½è¦è¿›è¡ŒReLU)ï¼Œå¦å¤–ï¼Œç½‘ç»œè¾“å…¥ä»$ 224 \times 224$å˜ä¸ºäº†$ 229 \times 229$åœ¨Inception v2çš„åŸºç¡€ä¸Šå¼•å…¥äº†ä¸€äº›é‡è¦çš„æ”¹è¿›ï¼Œå…¶ä¸»è¦è´¡çŒ®å¦‚ä¸‹ï¼šè¾…åŠ©åˆ†ç±»å™¨ï¼šInception v3åœ¨ç½‘ç»œçš„ä¸­é—´å±‚æ·»åŠ äº†è¾…åŠ©åˆ†ç±»å™¨ï¼Œè¿™äº›åˆ†ç±»å™¨æœ‰åŠ©äºåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å¼•å¯¼æ¢¯åº¦æµåŠ¨å’Œæä¾›æ­£åˆ™åŒ–ã€‚è¾…åŠ©åˆ†ç±»å™¨ä½äºç½‘ç»œçš„ä¸åŒå±‚çº§ï¼Œå¹¶ä¸ä¸»åˆ†ç±»å™¨å…±åŒè¿›è¡Œè®­ç»ƒã€‚è¿™äº›è¾…åŠ©åˆ†ç±»å™¨æœ‰åŠ©äºå‡è½»æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ï¼Œæé«˜ç½‘ç»œçš„ç¨³å®šæ€§å’Œæ”¶æ•›é€Ÿåº¦æ›´æ·±çš„ç½‘ç»œç»“æ„ï¼šInception v3ç›¸å¯¹äºä¹‹å‰çš„ç‰ˆæœ¬å¢åŠ äº†æ›´å¤šçš„ç½‘ç»œå±‚ï¼Œä½¿å¾—ç½‘ç»œæ›´æ·±ã€‚æ›´æ·±çš„ç½‘ç»œç»“æ„æœ‰åŠ©äºæé«˜ç‰¹å¾è¡¨ç¤ºçš„èƒ½åŠ›ï¼Œä½¿å¾—æ¨¡å‹èƒ½å¤Ÿæ›´å¥½åœ°å­¦ä¹ å¤æ‚çš„å›¾åƒç‰¹å¾æ›´å¤šçš„1x1å·ç§¯æ ¸ï¼šInception v3è¿›ä¸€æ­¥å¢åŠ äº†ç½‘ç»œä¸­çš„1x1å·ç§¯æ ¸çš„æ•°é‡ã€‚1x1å·ç§¯æ ¸å…·æœ‰é™ä½é€šé“æ•°å’Œç»´åº¦çš„ä½œç”¨ï¼Œå®ƒèƒ½å¤Ÿå‡å°‘ç½‘ç»œçš„è®¡ç®—é‡ï¼Œå¹¶å¼•å…¥äº†æ›´å¤šçš„éçº¿æ€§å˜æ¢ï¼Œæé«˜äº†ç½‘ç»œçš„è¡¨è¾¾èƒ½åŠ›å’Œç‰¹å¾æå–èƒ½åŠ›åˆ†æ”¯ç»“æ„ï¼šInception v3ä¸­çš„Inceptionæ¨¡å—å¼•å…¥äº†åˆ†æ”¯ç»“æ„ï¼Œå³åœ¨ä¸åŒå°ºåº¦ä¸Šä½¿ç”¨ä¸åŒå¤§å°çš„å·ç§¯æ ¸è¿›è¡Œç‰¹å¾æå–ã€‚è¿™ç§åˆ†æ”¯ç»“æ„æœ‰åŠ©äºæ•æ‰ä¸åŒå°ºåº¦çš„å›¾åƒç‰¹å¾ï¼Œå¹¶æé«˜äº†ç½‘ç»œå¯¹å›¾åƒçš„æ„ŸçŸ¥èƒ½åŠ›å…¶ä»–ä¼˜åŒ–æªæ–½ï¼šInception v3è¿˜å¼•å…¥äº†å…¶ä»–ä¸€äº›ä¼˜åŒ–æªæ–½ï¼Œå¦‚ä½¿ç”¨æ›´å°çš„å·ç§¯æ ¸ã€å¼•å…¥æ‰¹é‡å½’ä¸€åŒ–ç­‰ï¼Œä»¥è¿›ä¸€æ­¥æå‡ç½‘ç»œçš„æ€§èƒ½å’Œè®­ç»ƒæ•ˆæœInception-v4ä¸ResNetInception-v4, Inception-ResNet and the Impact of Residual Connections on Learning 2016 Inception-v4Inception-v4ä¸Inception-ResNetç»“æ„è¯¦è§£(åŸåˆ›)å¾®è½¯äºšæ´²ç ”ç©¶é™¢çš„ä½•æºæ˜åœ¨2015å¹´æå‡ºäº†éœ‡æƒŠä¸šç•Œçš„ResNetç»“æ„ï¼Œè¿™ç§ç»“æ„å’Œä»¥å¾€çš„Inceptionç»“æ„èµ°äº†ä¸¤æ¡ä¸åŒçš„é“è·¯ï¼šå‰è€…ä¸»è¦å…³æ³¨åŠ å¤§ç½‘ç»œæ·±åº¦åçš„æ”¶æ•›é—®é¢˜è€ŒInceptionæ›´å…³æ³¨ç‰¹å¾ç»´åº¦ä¸Šçš„åˆ©ç”¨å¦‚æœæŠŠè¿™ä¸¤ç§æ–¹æ³•ç»“åˆèµ·æ¥ä¼šæœ‰ä»€ä¹ˆæ•ˆæœå‘¢ï¼ŸSzegedyåœ¨2016å¹´å°±è¯•éªŒäº†ä¸€æŠŠï¼ŒæŠŠè¿™ä¸¤ç§ æœ€é¡¶å°–çš„ç»“æ„æ··åˆåˆ°ä¸€èµ·æå‡ºäº†Inception-ResNetï¼Œå®ƒçš„æ”¶æ•›é€Ÿåº¦æ›´å¿«ä½†åœ¨é”™è¯¯ç‡ä¸Šå’ŒåŒå±‚æ¬¡çš„Inceptionç›¸åŒï¼›Szegedyè¿˜å¯¹è‡ªå·±ä»¥å‰æå‡ºçš„Inception-v3è¿›è¡Œäº†ä¸€ç•ªæ”¹è‰¯ï¼Œæå‡ºäº†Inception-v4Inception-v4ç½‘ç»œç»“æ„Inception-v4ä¸Inception-ResNeté›†æˆçš„ç»“æ„åœ¨ImageNetç«èµ›ä¸Šè¾¾åˆ°äº†3.08%çš„top5é”™è¯¯ç‡ï¼Œä¹Ÿç®—å½“æ—¶çš„state-of-art performanceäº†Inception-v4ç½‘ç»œï¼Œå¯¹äºInceptionå—çš„æ¯ä¸ªç½‘æ ¼å¤§å°è¿›è¡Œäº†ç»Ÿä¸€Inception V4ä¸»è¦åˆ©ç”¨æ®‹å·®è¿æ¥ï¼ˆResidual Connectionï¼‰æ¥æ”¹è¿›V3ç»“æ„ï¼Œå¾—åˆ°Inception-ResNet-v1ï¼ŒInception-ResNet-v2ï¼ŒInception-v4ç½‘ç»œInception-ResNet-v1ç»“æ„Inception-ResNet-v2ç»“æ„ResNetDeep residual learning for image recognition 2015æ·±åº¦å­¦ä¹ â€”â€”ResNetè¶…è¯¦ç»†è®²è§£ï¼Œè¯¦è§£å±‚æ•°è®¡ç®—ã€å„å±‚ç»´åº¦è®¡ç®—ResNet(Residual Network)æ˜¯ä¸€ç§æ·±åº¦æ®‹å·®ç½‘ç»œï¼Œå®ƒæ˜¯ç”±Kaiming Heç­‰äººäº2015å¹´æå‡ºçš„ã€‚ResNetçš„æ ¸å¿ƒæ€æƒ³æ˜¯å¼•å…¥äº†æ®‹å·®è¿æ¥ï¼ˆResidual Connectionï¼‰ï¼Œé€šè¿‡è·¨å±‚ç›´æ¥è¿æ¥æ¥è§£å†³æ·±å±‚ç½‘ç»œè®­ç»ƒä¸­çš„æ¢¯åº¦æ¶ˆå¤±å’Œæ¨¡å‹é€€åŒ–é—®é¢˜ä¼ ç»Ÿçš„æ·±åº¦ç¥ç»ç½‘ç»œåœ¨å±‚æ•°å¢åŠ æ—¶ä¼šé¢ä¸´æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸çš„é—®é¢˜ï¼Œå¯¼è‡´æ¨¡å‹éš¾ä»¥è®­ç»ƒã€‚ResNeté€šè¿‡åœ¨ç½‘ç»œä¸­æ·»åŠ æ®‹å·®å—ï¼ˆResidual Blockï¼‰ï¼Œå…è®¸ä¿¡æ¯åœ¨è·³è¿‡å±‚çš„è·¯å¾„ä¸Šç›´æ¥ä¼ é€’ï¼Œä½¿å¾—ç½‘ç»œå¯ä»¥æ›´å®¹æ˜“åœ°å­¦ä¹ æ’ç­‰æ˜ å°„ã€‚å…·ä½“æ¥è¯´ï¼Œæ®‹å·®å—å°†è¾“å…¥å’Œè¾“å‡ºè¿›è¡Œç›¸åŠ ï¼Œç„¶åé€šè¿‡æ¿€æ´»å‡½æ•°è¿›è¡Œéçº¿æ€§å˜æ¢ã€‚è¿™æ ·çš„è®¾è®¡å…è®¸ç½‘ç»œåœ¨éœ€è¦æ—¶å°†æ®‹å·®ä¿¡å·ä¼ é€’åˆ°åç»­å±‚ï¼Œè§£å†³äº†æ¢¯åº¦æ¶ˆå¤±å’Œæ¨¡å‹é€€åŒ–çš„é—®é¢˜ResNetçš„ä¸€ä¸ªé‡è¦å˜ç§æ˜¯ResNet-50ï¼Œå®ƒç”±50ä¸ªå·ç§¯å±‚ç»„æˆï¼Œå…¶ä¸­åŒ…æ‹¬æ®‹å·®å—ã€æ± åŒ–å±‚å’Œå…¨è¿æ¥å±‚ã€‚ResNet-50åœ¨ImageNetå›¾åƒåˆ†ç±»ä»»åŠ¡ä¸Šå–å¾—äº†å¾ˆå¥½çš„æ€§èƒ½ï¼Œæˆä¸ºå½“æ—¶æœ€å…ˆè¿›çš„æ¨¡å‹ä¹‹ä¸€äº‹å®ä¸Šï¼ŒResNetå¹¶ä¸æ˜¯ç¬¬ä¸€ä¸ªåˆ©ç”¨è¿‘è·¯è¿æ¥ã€Highway Networkså¼•å…¥é—¨æ§è¿‘è·¯è¿æ¥çš„ã€‚è¿™äº›å‚æ•°åŒ–é—¨æ§åˆ¶å…è®¸å¤šå°‘ä¿¡æ¯æµè¿‡è¿‘è·¯(shortcut)ã€‚ç±»ä¼¼çš„æƒ³æ³•å¯ä»¥åœ¨é•¿çŸ­æœŸè®°å¿†ç½‘ç»œ(LSTM)å•å…ƒä¸­æ‰¾åˆ°ï¼Œå…¶ä¸­å­˜åœ¨å‚æ•°åŒ–çš„å¿˜è®°é—¨ï¼Œå…¶æ§åˆ¶å¤šå°‘ä¿¡æ¯å°†æµå‘ä¸‹ä¸€ä¸ªæ—¶é—´æ­¥ã€‚å› æ­¤ï¼ŒResNetå¯ä»¥è¢«è®¤ä¸ºæ˜¯Highway Networksçš„ä¸€ç§ç‰¹æ®Šæƒ…å†µå±‚æ•°è¶Šå¤šè¶Šå¥½å—åœ¨ResNetä¹‹å‰çš„ç½‘ç»œå±‚æ•°éƒ½ä¸æ˜¯å¾ˆé«˜ï¼Œ14å¹´çš„VGGç½‘ç»œæ‰åªæœ‰19å±‚ï¼Œä½†æ˜¯ResNetçš„ç½‘ç»œå±‚æ•°è¾¾åˆ°äº†æƒŠäººçš„152å±‚ã€‚è®¸å¤šäººä¼šæœ‰ä¸€ä¸ªç›´è§‚çš„å°è±¡ï¼Œä¹Ÿå°±æ˜¯ç½‘ç»œå±‚æ•°è¶Šå¤šï¼Œè®­ç»ƒæ•ˆæœè¶Šå¥½ï¼Œä½†æ˜¯è¿™æ ·çš„è¯VGGç½‘ç»œä¸ºä»€ä¹ˆä¸é‡‡å–152å±‚è€Œæ˜¯é‡‡ç”¨19å±‚å‘¢ï¼Ÿå…¶å®æ˜¯å› ä¸ºè®­ç»ƒæ¨¡å‹çš„å‡†ç¡®åº¦ä¸ä¸€å®šå’Œæ¨¡å‹å±‚æ•°å‘ˆçœŸç›¸å…³çš„å…³ç³»ã€‚å› ä¸ºéšç€ç½‘ç»œå±‚æ•°çš„åŠ æ·±ï¼Œç½‘ç»œå‡†ç¡®éœ€å‡ºç°é¥±å’Œï¼Œä¼šå‡ºç°ä¸‹é™çš„ç°è±¡56å±‚çš„ç½‘ç»œæ¯”20å±‚ç½‘ç»œçš„è®­ç»ƒæ•ˆæœè¦å·®ï¼Œè®¸å¤šäººç¬¬ä¸€ååº”å°±æ˜¯è¿‡æ‹Ÿåˆï¼Œä½†äº‹å®å¹¶ä¸å¦‚æ­¤ï¼Œå› ä¸ºè¿‡æ‹Ÿåˆç°è±¡çš„è®­ç»ƒé›†å‡†ç¡®åº¦ä¼šå¾ˆé«˜ï¼Œä½†æ˜¯ä»å›¾ä¸­å¯ä»¥çœ‹å‡º56å±‚ç½‘ç»œçš„è®­ç»ƒé›†å‡†ç¡®åº¦åŒæ ·å¾ˆä½ã€‚å¾ˆæ˜¾ç„¶å¯çŸ¥çš„æ˜¯ï¼Œéšç€å±‚åº¦åŠ æ·±ï¼Œä¼šå‡ºç°æ¢¯åº¦æ¶ˆå¤±æˆ–æ¢¯åº¦çˆ†ç‚¸çš„é—®é¢˜ï¼Œä½¿å¾—æ·±åº¦æ¨¡å‹å¾ˆéš¾è®­ç»ƒï¼Œä½†æ˜¯å·²ç»å­˜åœ¨BatchNormç­‰æ‰‹æ®µç¼“è§£è¿™ä¸€é—®é¢˜ï¼Œå› æ­¤å¦‚ä½•è§£å†³æ·±åº¦ç½‘ç»œçš„é€€åŒ–é—®é¢˜æ˜¯ç¥ç»ç½‘ç»œå‘å±•çš„ä¸‹ä¸€ä¸ªæ–¹å‘æ¨¡å‹å®˜æ–¹ç»™äº†ä¸¤ä¸ªResNetå—çš„ç»“æ„å›¾ï¼Œå›¾ä¸€ä¸ºBasicBlockä¹Ÿå°±æ˜¯æœ€å¸¸è§„çš„å—ï¼Œå›¾äºŒè¢«æˆä¸ºBottleBlockBasicBlock(å¸¸è§„)(ä¸¤å±‚ç»“æ„)åœ¨ResNet34çš„æ—¶å€™æ˜¯ç”¨çš„è¿™ä¸ªBottleBlock(ä¸‰å±‚ç»“æ„)åœ¨ResNet50/101/152çš„æ—¶å€™ç”¨çš„æ˜¯è¿™ä¸ªæ˜¯å‚è€ƒGoogleNetçš„æ–¹å¼å¯¹ç½‘ç»œå†…å®¹è¿›è¡Œçš„ä¸€å®šä¼˜åŒ–åœ¨è®¡ç®—å‰å…ˆæ¥ç”¨$ 1 \times 1$çš„å·é˜¶å±‚é™ç»´ï¼Œæ—¢ä¿æŒç²¾åº¦åˆå‡å°‘è®¡ç®—é‡ï¼Œå†å¯¹64ç»´è¿›è¡Œè®¡ç®—åç»è¿‡$ 1 \times 1$çš„å·ç§¯æ¢å¤æ®‹å·®å¯¹æ®‹å·®ç½‘ç»œçš„ç†è§£ä¸ºä»€ä¹ˆæ®‹å·®å­¦ä¹ ç›¸å¯¹æ›´å®¹æ˜“ï¼Œä»ç›´è§‚ä¸Šçœ‹æ®‹å·®å­¦ä¹ éœ€è¦å­¦ä¹ çš„å†…å®¹å°‘ï¼Œå› ä¸ºæ®‹å·®ä¸€èˆ¬ä¼šæ¯”è¾ƒå°ï¼Œå­¦ä¹ éš¾åº¦å°ç‚¹ã€‚ä¸è¿‡æˆ‘ä»¬å¯ä»¥ä»æ•°å­¦çš„è§’åº¦æ¥åˆ†æè¿™ä¸ªé—®é¢˜ï¼Œé¦–å…ˆæ®‹å·®å•å…ƒå¯ä»¥è¡¨ç¤ºä¸ºï¼šå…¶ä¸­å’Œåˆ†åˆ«è¡¨ç¤ºçš„æ˜¯ç¬¬ä¸ªæ®‹å·®å•å…ƒçš„è¾“å…¥å’Œè¾“å‡ºï¼Œæ³¨æ„æ¯ä¸ªæ®‹å·®å•å…ƒä¸€èˆ¬åŒ…å«å¤šå±‚ç»“æ„ã€‚æ˜¯æ®‹å·®å‡½æ•°ï¼Œè¡¨ç¤ºå­¦ä¹ åˆ°çš„æ®‹å·®ï¼Œè€Œè¡¨ç¤ºæ’ç­‰æ˜ å°„ï¼Œæ˜¯ReLUæ¿€æ´»å‡½æ•°ã€‚åŸºäºä¸Šå¼ï¼Œæˆ‘ä»¬æ±‚å¾—ä»æµ…å±‚åˆ°æ·±å±‚çš„å­¦ä¹ ç‰¹å¾ä¸º:åˆ©ç”¨é“¾å¼è§„åˆ™ï¼Œå¯ä»¥æ±‚å¾—åå‘è¿‡ç¨‹çš„æ¢¯åº¦ï¼šå¼å­çš„ç¬¬ä¸€ä¸ªå› å­$\frac{\partial l o s s}{\partial x_{L}}$è¡¨ç¤ºçš„æŸå¤±å‡½æ•°åˆ°è¾¾$L$çš„æ¢¯åº¦ï¼Œå°æ‹¬å·ä¸­çš„1è¡¨æ˜çŸ­è·¯æœºåˆ¶å¯ä»¥æ— æŸåœ°ä¼ æ’­æ¢¯åº¦ï¼Œè€Œå¦å¤–ä¸€é¡¹æ®‹å·®æ¢¯åº¦åˆ™éœ€è¦ç»è¿‡å¸¦æœ‰weightçš„å±‚ï¼Œæ¢¯åº¦ä¸æ˜¯ç›´æ¥ä¼ é€’è¿‡æ¥çš„ã€‚æ®‹å·®æ¢¯åº¦ä¸ä¼šé‚£ä¹ˆå·§å…¨ä¸º-1ï¼Œè€Œä¸”å°±ç®—å…¶æ¯”è¾ƒå°ï¼Œæœ‰1çš„å­˜åœ¨ä¹Ÿä¸ä¼šå¯¼è‡´æ¢¯åº¦æ¶ˆå¤±ã€‚æ‰€ä»¥æ®‹å·®å­¦ä¹ ä¼šæ›´å®¹æ˜“ã€‚è¦æ³¨æ„ä¸Šé¢çš„æ¨å¯¼å¹¶ä¸æ˜¯ä¸¥æ ¼çš„è¯æ˜å¦‚æœä»ResNetçš„è®ºæ–‡æ¥çœ‹ï¼Œç¡®å®ResNetå‡ºå‘ç‚¹ä¸æ˜¯æ¢¯åº¦æ¶ˆå¤±è€Œæ˜¯ç½‘ç»œé€€åŒ–ï¼›ä½†æ˜¯Kaimingéš”å¹´çš„è®ºæ–‡ç¡®å®æœ‰æåˆ°ï¼Œæ®‹å·®ç»“æ„å¯ä»¥ä½¿å¾—åå‘çš„æ¢¯åº¦æ€»ä¸æ¶ˆå¤±ï¼Œå³ä¾¿ä¸­é—´æƒé‡çŸ©é˜µå¾ˆå°æ®‹å·®æ˜ å°„æ›´å®¹æ˜“å­¦ä¹ æœ‰ä¸ªåŸå› æ˜¯åå‘ä¼ æ’­çš„æ—¶å€™$H(x)=x+F(x)$ï¼Œ$x$åˆ†èµ°äº†ä¸€éƒ¨åˆ†æ¢¯åº¦ï¼Œæ‰€ä»¥åŒæ ·çš„è¯¯å·®$F(x)$å¾—åˆ°çš„æ¢¯åº¦æ›´å°åˆ°ä¸€å®šæ·±åº¦çš„æ—¶å€™ï¼Œæ¢¯åº¦ä¼šå˜æˆ0ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æœ‰ä¸Šä¸€å±‚çš„æ¢¯åº¦ï¼Œæ‰€ä»¥è¯´ä¸ä¼šæ¯”ä¹‹å‰çš„å·®DenseNetDensely Connected Convolutional Networks 2018æ¦‚è¿°ä½œä¸ºCVPR2017å¹´çš„Best Paperï¼ŒDenseNetè„±ç¦»äº†åŠ æ·±ç½‘ç»œå±‚æ•°(ResNet)å’ŒåŠ å®½ç½‘ç»œç»“æ„(Inception)æ¥æå‡ç½‘ç»œæ€§èƒ½çš„å®šå¼æ€ç»´ï¼Œä»ç‰¹å¾çš„è§’åº¦è€ƒè™‘ï¼Œé€šè¿‡ç‰¹å¾é‡ç”¨å’Œæ—è·¯(Bypass)è®¾ç½®ï¼Œæ—¢å¤§å¹…åº¦å‡å°‘äº†ç½‘ç»œçš„å‚æ•°é‡ï¼Œåˆåœ¨ä¸€å®šç¨‹åº¦ä¸Šç¼“è§£äº†gradient vanishingé—®é¢˜çš„äº§ç”Ÿã€‚ç»“åˆä¿¡æ¯æµå’Œç‰¹å¾å¤ç”¨çš„å‡è®¾ï¼ŒDenseNetå½“ä¹‹æ— æ„§æˆä¸º2017å¹´è®¡ç®—æœºè§†è§‰é¡¶ä¼šçš„å¹´åº¦æœ€ä½³è®ºæ–‡DenseNetä½œä¸ºå¦ä¸€ç§æ‹¥æœ‰è¾ƒæ·±å±‚æ•°çš„å·ç§¯ç¥ç»ç½‘ç»œï¼Œå…·æœ‰å¦‚ä¸‹ä¼˜ç‚¹:ç›¸æ¯”ResNetæ‹¥æœ‰æ›´å°‘çš„å‚æ•°æ•°é‡æ—è·¯åŠ å¼ºäº†ç‰¹å¾çš„é‡ç”¨ç½‘ç»œæ›´æ˜“äºè®­ç»ƒï¼Œå¹¶å…·æœ‰ä¸€å®šçš„æ­£åˆ™æ•ˆæœç¼“è§£äº†gradient vanishingå’Œmodel degradationçš„é—®é¢˜ä½•æºæ˜åœ¨æå‡ºResNetæ—¶åšå‡ºäº†è¿™æ ·çš„å‡è®¾ï¼šè‹¥æŸä¸€è¾ƒæ·±çš„ç½‘ç»œå¤šå‡ºå¦ä¸€è¾ƒæµ…ç½‘ç»œçš„è‹¥å¹²å±‚æœ‰èƒ½åŠ›å­¦ä¹ åˆ°æ’ç­‰æ˜ å°„ï¼Œé‚£ä¹ˆè¿™ä¸€è¾ƒæ·±ç½‘ç»œè®­ç»ƒå¾—åˆ°çš„æ¨¡å‹æ€§èƒ½ä¸€å®šä¸ä¼šå¼±äºè¯¥æµ…å±‚ç½‘ç»œé€šä¿—çš„è¯´å°±æ˜¯å¦‚æœå¯¹æŸä¸€ç½‘ç»œä¸­å¢æ·»ä¸€äº›å¯ä»¥å­¦åˆ°æ’ç­‰æ˜ å°„çš„å±‚ç»„æˆæ–°çš„ç½‘è·¯ï¼Œé‚£ä¹ˆæœ€å·®çš„ç»“æœä¹Ÿæ˜¯æ–°ç½‘ç»œä¸­çš„è¿™äº›å±‚åœ¨è®­ç»ƒåæˆä¸ºæ’ç­‰æ˜ å°„è€Œä¸ä¼šå½±å“åŸç½‘ç»œçš„æ€§èƒ½åŒæ ·DenseNetåœ¨æå‡ºæ—¶ä¹Ÿåšè¿‡å‡è®¾ï¼šä¸å…¶å¤šæ¬¡å­¦ä¹ å†—ä½™çš„ç‰¹å¾ï¼Œç‰¹å¾å¤ç”¨æ˜¯ä¸€ç§æ›´å¥½çš„ç‰¹å¾æå–æ–¹å¼æ¨¡å‹DenseNetæ˜¯ä¸€ç§æ·±åº¦ç¥ç»ç½‘ç»œæ¶æ„ï¼Œå…¶æ ¸å¿ƒæ€æƒ³æ˜¯å¯†é›†è¿æ¥(Dense Connectivity)ã€‚ç›¸æ¯”äºä¼ ç»Ÿçš„ç¥ç»ç½‘ç»œç»“æ„ï¼Œå¦‚VGGå’ŒResNetï¼ŒDenseNeté€šè¿‡å¼•å…¥å¯†é›†è¿æ¥çš„æ–¹å¼ï¼Œåœ¨ç½‘ç»œä¸­æ¯ä¸€å±‚éƒ½ä¸å‰é¢æ‰€æœ‰å±‚ç›´æ¥ç›¸è¿ï¼Œä»è€Œå¢å¼ºäº†ä¿¡æ¯æµåŠ¨å’Œç‰¹å¾é‡ç”¨çš„èƒ½åŠ›DenseNetçš„ä¸»è¦ç‰¹ç‚¹å¦‚ä¸‹ï¼šå¯†é›†è¿æ¥ï¼šåœ¨DenseNetä¸­ï¼Œæ¯ä¸ªå±‚éƒ½ä¸å‰é¢æ‰€æœ‰å±‚ç›´æ¥ç›¸è¿ã€‚å…·ä½“è€Œè¨€ï¼ŒæŸä¸€å±‚çš„è¾“å…¥åŒ…æ‹¬å®ƒä¹‹å‰æ‰€æœ‰å±‚çš„è¾“å‡ºã€‚è¿™ç§å¯†é›†è¿æ¥çš„æ–¹å¼ä½¿å¾—ä¿¡æ¯å¯ä»¥åœ¨ç½‘ç»œä¸­è‡ªç”±åœ°æµåŠ¨ï¼Œä¿ƒè¿›äº†ç‰¹å¾çš„ä¼ é€’å’Œå…±äº«æ··åˆç‰¹å¾é‡ç”¨ï¼šç”±äºå¯†é›†è¿æ¥çš„å­˜åœ¨ï¼Œæ¯ä¸ªå±‚å¯ä»¥ç›´æ¥è®¿é—®ä¹‹å‰æ‰€æœ‰å±‚çš„ç‰¹å¾å›¾ã€‚è¿™æ ·ï¼Œä½å±‚ç‰¹å¾å¯ä»¥ç›´æ¥ä¼ é€’ç»™åç»­å±‚ï¼Œå®ç°äº†æ··åˆç‰¹å¾é‡ç”¨ã€‚è¿™ç§ç‰¹å¾é‡ç”¨æœºåˆ¶æœ‰æ•ˆåœ°åˆ©ç”¨äº†ç½‘ç»œä¸­çš„ä¿¡æ¯ï¼Œå¢å¼ºäº†ç‰¹å¾çš„å¤šæ ·æ€§å’Œä¸°å¯Œæ€§åŸºæœ¬ç»„ä»¶ï¼šDenseNetçš„åŸºæœ¬ç»„ä»¶æ˜¯â€Dense Blockâ€ï¼Œå®ƒç”±å¤šä¸ªå…·æœ‰ç›¸åŒè¾“å‡ºé€šé“æ•°çš„å·ç§¯å±‚ç»„æˆã€‚åœ¨æ¯ä¸ªDense Blockå†…éƒ¨ï¼Œå±‚ä¸å±‚ä¹‹é—´é€šè¿‡å¯†é›†è¿æ¥ç›¸è¿ã€‚ä¸ºäº†æ§åˆ¶å‚æ•°æ•°é‡å’Œè®¡ç®—é‡ï¼Œæ¯ä¸ªå·ç§¯å±‚é€šå¸¸é‡‡ç”¨è¾ƒå°çš„3x3å·ç§¯è¿‡æ¸¡å±‚ï¼šä¸ºäº†æ§åˆ¶ç½‘ç»œçš„å®½åº¦ï¼ŒDenseNetåœ¨ç›¸é‚»çš„Dense Blockä¹‹é—´å¼•å…¥äº†è¿‡æ¸¡å±‚(Transition Layer)ã€‚è¿‡æ¸¡å±‚ç”±ä¸€ä¸ª1x1å·ç§¯å±‚å’Œä¸€ä¸ª2x2çš„å¹³å‡æ± åŒ–å±‚ç»„æˆï¼Œå®ƒå¯ä»¥å‡å°ç‰¹å¾å›¾çš„å°ºå¯¸å¹¶é™ä½é€šé“æ•°ï¼Œä»è€Œå‡å°‘è®¡ç®—é‡DenseNetçš„ä¼˜ç‚¹åŒ…æ‹¬æ¨¡å‹å‚æ•°ç›¸å¯¹è¾ƒå°‘ã€ç‰¹å¾é‡ç”¨æ€§å¼ºã€æ¢¯åº¦ä¼ æ’­æ›´åŠ é¡ºç•…ç­‰Dense BlockDenseNetä¸­çš„æ ¸å¿ƒç»„ä»¶æ˜¯â€Dense Blockâ€ï¼Œå®ƒç”±å¤šä¸ªå¯†é›†è¿æ¥çš„å·ç§¯å±‚ç»„æˆã€‚Dense Blockçš„è®¾è®¡æ—¨åœ¨ä¿ƒè¿›ç‰¹å¾çš„ä¼ é€’å’Œé‡ç”¨ï¼Œå¢å¼ºç½‘ç»œçš„è¡¨ç¤ºèƒ½åŠ›å…·ä½“æ¥è¯´ï¼ŒDense Blockç”±ä¸€ç³»åˆ—å †å åœ¨ä¸€èµ·çš„å·ç§¯å±‚ç»„æˆï¼Œæ¯ä¸ªå·ç§¯å±‚éƒ½ç›´æ¥è¿æ¥åˆ°å‰é¢æ‰€æœ‰å±‚çš„è¾“å‡ºã€‚è¿™æ„å‘³ç€æŸä¸€å±‚çš„è¾“å…¥æ˜¯å…¶ä¹‹å‰æ‰€æœ‰å±‚çš„è¾“å‡ºçš„ä¸²è”ã€‚è¿™ç§å¯†é›†è¿æ¥çš„æ–¹å¼ä½¿å¾—ä¿¡æ¯å¯ä»¥åœ¨ç½‘ç»œä¸­è‡ªç”±åœ°æµåŠ¨ï¼Œä»è€Œæœ‰æ•ˆåœ°æé«˜äº†ç‰¹å¾ä¼ é€’å’Œå…±äº«çš„èƒ½åŠ›ä¸ºäº†æ§åˆ¶å‚æ•°æ•°é‡å’Œè®¡ç®—é‡ï¼Œæ¯ä¸ªå·ç§¯å±‚é€šå¸¸é‡‡ç”¨å…·æœ‰ç›¸åŒè¾“å‡ºé€šé“æ•°çš„$3 \times 3$å·ç§¯ã€‚è¿™æ ·ï¼Œæ¯ä¸ªå·ç§¯å±‚éƒ½å¯ä»¥åˆ©ç”¨ä¹‹å‰å±‚çš„ä¸°å¯Œç‰¹å¾æ¥ç”Ÿæˆæ›´åŠ å¤æ‚å’ŒæŠ½è±¡çš„ç‰¹å¾è¡¨ç¤ºã€‚è¿™ç§å¯†é›†è¿æ¥çš„æ–¹å¼ä¸ä»…å¢åŠ äº†ç‰¹å¾çš„å¤šæ ·æ€§ï¼Œè¿˜å‡è½»äº†æ¢¯åº¦æ¶ˆå¤±çš„é—®é¢˜ï¼Œä½¿å¾—ç½‘ç»œæ›´å®¹æ˜“è®­ç»ƒåœ¨æ¯ä¸ªDense Blockä¹‹é—´ï¼Œä¸ºäº†æ§åˆ¶ç½‘ç»œçš„å®½åº¦å’Œæ·±åº¦ï¼Œé€šå¸¸ä¼šå¼•å…¥è¿‡æ¸¡å±‚(Transition Layer)ã€‚è¿‡æ¸¡å±‚ç”±ä¸€ä¸ª$1 \times 1$å·ç§¯å±‚å’Œä¸€ä¸ª$2 \times 2$çš„å¹³å‡æ± åŒ–å±‚ç»„æˆã€‚$1 \times 1$å·ç§¯å±‚ç”¨äºé™ä½é€šé“æ•°ï¼Œå‡å°‘è®¡ç®—é‡ã€‚å¹³å‡æ± åŒ–å±‚åˆ™ç”¨äºå‡å°ç‰¹å¾å›¾çš„å°ºå¯¸ï¼Œè¿›ä¸€æ­¥å‡å°‘å‚æ•°å’Œè®¡ç®—å¤æ‚åº¦æ¨¡å‹DenseNetæ˜¯ä¸€ç§åŸºäºå¯†é›†è¿æ¥çš„å·ç§¯ç¥ç»ç½‘ç»œ(CNN)ï¼Œå…¶ä¸»è¦ç‰¹ç‚¹æ˜¯åœ¨ç½‘ç»œä¸­å¼•å…¥äº†å¯†é›†è¿æ¥å±‚ï¼Œä»è€Œæ”¹å–„äº†ä¿¡æ¯çš„æµåŠ¨å’Œæ¢¯åº¦çš„ä¼ é€’ã€‚ä¸‹é¢æ˜¯DenseNetçš„ç½‘ç»œç»“æ„ï¼š1.è¾“å…¥å±‚ï¼šè¾“å…¥å±‚æ¥æ”¶è¾“å…¥æ•°æ®ï¼Œå¹¶å°†å…¶é€å…¥ç¬¬ä¸€ä¸ªå·ç§¯å±‚ä¸­2.å·ç§¯å±‚ï¼šDenseNetä¸­çš„å·ç§¯å±‚é€šå¸¸é‡‡ç”¨$3\times 3$çš„å·ç§¯æ ¸ï¼Œå¹¶é‡‡ç”¨paddingæ¥ä¿æŒç‰¹å¾å›¾çš„å¤§å°ä¸å˜ã€‚åœ¨æ¯ä¸ªå·ç§¯å±‚åé¢ï¼Œéƒ½ä¼šæ¥ä¸ŠBNå±‚å’ŒReLUæ¿€æ´»å‡½æ•°3.å¯†é›†å—(Dense Block)ï¼šå¯†é›†å—æ˜¯DenseNetçš„æ ¸å¿ƒï¼Œå®ƒç”±å¤šä¸ªå¯†é›†è¿æ¥å±‚ç»„æˆã€‚æ¯ä¸ªå¯†é›†å—ä¸­ï¼Œæ‰€æœ‰å‰é¢å±‚çš„è¾“å‡ºéƒ½ä¼šä¸å½“å‰å±‚çš„è¾“å…¥è¿›è¡Œè¿æ¥ï¼Œå¹¶é€šè¿‡ä¸€ä¸ªéçº¿æ€§å˜æ¢è¿›è¡Œå¤„ç†4.è¿‡æ¸¡å±‚(Transition Block)ï¼šä¸ºäº†é¿å…ç½‘ç»œè¿‡æ·±å¯¼è‡´æ¢¯åº¦æ¶ˆå¤±å’Œè®¡ç®—èµ„æºè¿‡åº¦æ¶ˆè€—ï¼ŒDenseNetä¸­é‡‡ç”¨äº†è¿‡æ¸¡å±‚æ¥æ§åˆ¶ç½‘ç»œçš„å¤§å°ã€‚åœ¨æ¯ä¸ªå¯†é›†å—ä¹‹é—´ï¼Œéƒ½ä¼šæ¥ä¸Šä¸€ä¸ªè¿‡æ¸¡å±‚ï¼Œå®ƒåŒ…å«ä¸€ä¸ª$1\times 1$çš„å·ç§¯å±‚ã€BNå±‚å’Œå¹³å‡æ± åŒ–å±‚ï¼Œå…¶ä¸­å¹³å‡æ± åŒ–çš„æ­¥å¹…ä¸º2ï¼Œç”¨äºå‡å°‘ç‰¹å¾å›¾çš„å¤§å°5.å…¨å±€æ± åŒ–å±‚å’Œå…¨è¿æ¥å±‚ï¼šæœ€åï¼ŒDenseNetä½¿ç”¨å…¨å±€å¹³å‡æ± åŒ–å±‚å°†ç‰¹å¾å›¾é™ç»´ä¸ºä¸€ä¸ªå‘é‡ï¼Œç„¶åé€šè¿‡ä¸€ä¸ªå…¨è¿æ¥å±‚è¿›è¡Œåˆ†ç±»æœ€åä¸€ä¸ªæ± åŒ–ç”¨çš„æ˜¯å…¨å±€æ± åŒ–å±‚å…·ä½“æ¥è¯´ï¼ŒDenseNetçš„å¯†é›†è¿æ¥æœºåˆ¶ä½¿å¾—å‰é¢çš„å±‚å¯ä»¥ç›´æ¥è¿æ¥åˆ°åé¢çš„å±‚ï¼Œä»è€Œä¿ç•™äº†æ›´å¤šçš„ç‰¹å¾ä¿¡æ¯ã€‚ç„¶è€Œï¼Œè¿™ç§å¯†é›†è¿æ¥ä¹Ÿå¯¼è‡´äº†ç‰¹å¾å›¾çš„å°ºå¯¸é€æ¸å¢å¤§ã€‚ä¸ºäº†æ§åˆ¶æ¨¡å‹çš„å¤æ‚æ€§å’Œè®¡ç®—é‡ï¼Œå¹¶ä¸”èƒ½å¤Ÿæ›´å¥½åœ°é€‚åº”ä¸åŒå°ºåº¦çš„è¾“å…¥ï¼ŒDenseNetå¼•å…¥äº†å…¨å±€æ± åŒ–å±‚å…¨å±€æ± åŒ–å±‚å¯ä»¥å°†æ•´ä¸ªç‰¹å¾å›¾è½¬åŒ–ä¸ºå›ºå®šé•¿åº¦çš„ç‰¹å¾å‘é‡ï¼Œè¿™æ ·å¯ä»¥æœ‰æ•ˆåœ°é™ä½ç‰¹å¾çš„ç»´åº¦ï¼Œå¹¶ä¸”ä¿ç•™äº†å…¨å±€æ„Ÿå—é‡çš„ç‰¹å¾ä¿¡æ¯ã€‚é€šè¿‡å°†ç‰¹å¾å›¾çš„æ¯ä¸ªé€šé“è¿›è¡Œå¹³å‡æ± åŒ–æˆ–æœ€å¤§æ± åŒ–æ“ä½œï¼Œå…¨å±€æ± åŒ–å±‚å¯ä»¥æ•æ‰åˆ°æ•´ä¸ªç‰¹å¾å›¾çš„ç»Ÿè®¡ç‰¹å¾ï¼Œä»è€Œå¯¹å…¨å±€ä¿¡æ¯è¿›è¡Œæ±‡èšä½¿ç”¨å…¨å±€æ± åŒ–å±‚çš„å¥½å¤„æ˜¯å‡å°‘äº†æ¨¡å‹çš„å‚æ•°æ•°é‡å’Œè®¡ç®—é‡ï¼ŒåŒæ—¶ä»ç„¶èƒ½å¤Ÿä¿ç•™é‡è¦çš„å…¨å±€ç‰¹å¾ã€‚è¿™æœ‰åŠ©äºæé«˜æ¨¡å‹çš„æ•ˆç‡å’Œæ³›åŒ–èƒ½åŠ›ï¼Œå¹¶ä¸”åœ¨è®­ç»ƒå’Œæ¨æ–­é˜¶æ®µéƒ½èƒ½å¤Ÿæ›´å¥½åœ°é€‚åº”ä¸åŒå°ºåº¦çš„è¾“å…¥å›¾åƒResnextResnetæ€§èƒ½æœ€å¥½çš„å˜ä½“æ˜¯ResnextVitVit An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale 2020Vision Transformerè¯¦è§£Vision Transformer (base-sized model)æ¦‚è¿°ViT(Vision Transformer)æ˜¯ä¸€ç§åŸºäºTransformerçš„è§†è§‰æ¨¡å‹ï¼Œå®ƒå°†è‡ªç„¶è¯­è¨€å¤„ç†ä¸­çš„Transformeræ¨¡å‹æˆåŠŸåº”ç”¨äºè®¡ç®—æœºè§†è§‰ä»»åŠ¡ä¼ ç»Ÿçš„è®¡ç®—æœºè§†è§‰æ¨¡å‹ä¸»è¦åŸºäºå·ç§¯ç¥ç»ç½‘ç»œ(CNN)ï¼Œè€ŒViTå°è¯•ä½¿ç”¨Transformerçš„è‡ªæ³¨æ„åŠ›æœºåˆ¶æ¥å¤„ç†å›¾åƒæ•°æ®ViTçš„å…³é”®æ€æƒ³å°†è¾“å…¥å›¾åƒåˆ‡åˆ†ä¸ºå›ºå®šå¤§å°çš„å›¾åƒå—(patches)ï¼Œå¹¶å°†è¿™äº›å›¾åƒå—å±•å¹³ä¸ºåºåˆ—å½¢å¼çš„è¾“å…¥ã€‚æ¯ä¸ªå›¾åƒå—é€šè¿‡ä¸€ä¸ªçº¿æ€§æ˜ å°„å±‚è¿›è¡Œç‰¹å¾åµŒå…¥ï¼Œç„¶åé€šè¿‡æ·»åŠ ä½ç½®åµŒå…¥æ¥å¼•å…¥ä½ç½®ä¿¡æ¯ä¹‹å‰å­¦ä¹ çš„Transformerç»“æ„ä¸­ï¼Œè¾“å…¥éœ€è¦æ˜¯ä¸€ä¸ªäºŒç»´çš„çŸ©é˜µï¼ŒçŸ©é˜µçš„å½¢çŠ¶å¯ä»¥è¡¨ç¤ºä¸º$(N, D)$ï¼Œå…¶ä¸­$N$æ˜¯sequenceçš„é•¿åº¦ï¼Œè€Œ$D$æ˜¯sequenceä¸­æ¯ä¸ªå‘é‡çš„ç»´åº¦å› æ­¤ï¼Œåœ¨ViTç®—æ³•ä¸­ï¼Œé¦–å…ˆéœ€è¦è®¾æ³•å°†$H \times W \times C$çš„ä¸‰ç»´å›¾åƒè½¬åŒ–ä¸º$(N, D)$çš„äºŒç»´è¾“å…¥ViTä¸­çš„å…·ä½“å®ç°æ–¹å¼ä¸º: å°†çš„å›¾åƒï¼Œå˜ä¸ºä¸€ä¸ªçš„åºåˆ—ã€‚è¿™ä¸ªåºåˆ—å¯ä»¥çœ‹ä½œæ˜¯ä¸€ç³»åˆ—å±•å¹³çš„å›¾åƒå—ï¼Œä¹Ÿå°±æ˜¯å°†å›¾åƒåˆ‡åˆ†æˆå°å—åï¼Œå†å°†å…¶å±•å¹³ã€‚è¯¥åºåˆ—ä¸­ä¸€å…±åŒ…å«äº†ä¸ªå›¾åƒå—ï¼Œæ¯ä¸ªå›¾åƒå—çš„ç»´åº¦åˆ™æ˜¯ã€‚å…¶ä¸­æ˜¯å›¾åƒå—çš„å¤§å°ï¼Œæ˜¯é€šé“æ•°é‡ã€‚ç»è¿‡å¦‚ä¸Šå˜æ¢ï¼Œå°±å¯ä»¥å°†è§†ä¸ºsequenceçš„é•¿åº¦äº†ä½†æ˜¯ï¼Œæ­¤æ—¶æ¯ä¸ªå›¾åƒå—çš„ç»´åº¦æ˜¯ï¼Œè€Œæˆ‘ä»¬å®é™…éœ€è¦çš„å‘é‡ç»´åº¦æ˜¯ï¼Œå› æ­¤æˆ‘ä»¬è¿˜éœ€è¦å¯¹å›¾åƒå—è¿›è¡ŒEmbeddingã€‚è¿™é‡ŒEmbeddingçš„æ–¹å¼éå¸¸ç®€å•ï¼Œåªéœ€è¦å¯¹æ¯ä¸ªçš„å›¾åƒå—åšä¸€ä¸ªçº¿æ€§å˜æ¢ï¼Œå°†ç»´åº¦å‹ç¼©ä¸ºå³å¯æ¨¡å‹ç»“æ„ViTæ¨¡å‹é€šå¸¸åŒ…å«å¤šä¸ªTransformerç¼–ç å™¨å±‚ï¼Œæ¯ä¸ªå±‚ç”±å¤šå¤´è‡ªæ³¨æ„åŠ›æœºåˆ¶å’Œå‰é¦ˆç¥ç»ç½‘ç»œç»„æˆåœ¨ViTä¸­ï¼Œåºåˆ—ä¸­çš„æ¯ä¸ªä½ç½®éƒ½å¯ä»¥è¿›è¡Œè‡ªæ³¨æ„åŠ›è®¡ç®—ï¼Œä½¿æ¨¡å‹èƒ½å¤Ÿåœ¨å…¨å±€ä¸Šå¯¹å›¾åƒè¿›è¡Œç¼–ç å’Œç†è§£æœ€åï¼ŒViTæ¨¡å‹å°†åºåˆ—çš„è¡¨ç¤ºé€šè¿‡ä¸€ä¸ªæ± åŒ–æ“ä½œå¾—åˆ°æ•´ä¸ªå›¾åƒçš„è¡¨ç¤ºï¼Œç„¶åå¯ä»¥é€šè¿‡ä¸€ä¸ªçº¿æ€§åˆ†ç±»å™¨è¿›è¡Œåˆ†ç±»æˆ–è¿›è¡Œå…¶ä»–ä»»åŠ¡ä¼˜ç¼ºç‚¹ViTçš„ä¼˜ç‚¹ä¹‹ä¸€æ˜¯å®ƒèƒ½å¤Ÿæ•æ‰å…¨å±€ä¿¡æ¯ï¼Œå¹¶ä¸”åœ¨ä¸€äº›è®¡ç®—æœºè§†è§‰ä»»åŠ¡ä¸Šå–å¾—äº†å¾ˆå¥½çš„è¡¨ç°ï¼Œä¾‹å¦‚å›¾åƒåˆ†ç±»ã€ç›®æ ‡æ£€æµ‹å’Œå›¾åƒåˆ†å‰²ç„¶è€Œï¼ŒViTå¯¹äºå¤§å°ºå¯¸é«˜åˆ†è¾¨ç‡å›¾åƒçš„å¤„ç†ç›¸å¯¹è¾ƒæ…¢ï¼Œä¸”å¯¹äºç©ºé—´ä¿¡æ¯çš„å»ºæ¨¡ç›¸å¯¹è¾ƒå¼±ï¼Œå› æ­¤åœ¨å¤„ç†å…·æœ‰ç»†ç²’åº¦ç»“æ„çš„å›¾åƒæ—¶å¯èƒ½å­˜åœ¨ä¸€å®šçš„é™åˆ¶ViTé€šè¿‡å°†å›¾åƒåˆ’åˆ†ä¸ºåºåˆ—ï¼Œå¹¶åˆ©ç”¨Transformerçš„è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼Œå°†è‡ªç„¶è¯­è¨€å¤„ç†ä¸­çš„Transformeræ¨¡å‹å¼•å…¥äº†è®¡ç®—æœºè§†è§‰é¢†åŸŸï¼Œä¸ºå›¾åƒç†è§£ä»»åŠ¡æä¾›äº†ä¸€ç§æ–°çš„æ€è·¯å’Œæ–¹æ³•Transformeræ¨¡å‹æ˜¯å¦‚ä½•åœ¨CVé¢†åŸŸé‡Œç”¨èµ·æ¥çš„åœ¨è®¡ç®—æœºè§†è§‰é¢†åŸŸï¼ŒTransformeræ¨¡å‹é€šå¸¸ç”¨äºå¤„ç†åºåˆ—æ•°æ®å’Œå®ç°ä¸€äº›ç‰¹å®šä»»åŠ¡ï¼Œè€Œä¸æ˜¯ç›´æ¥åº”ç”¨äºå›¾åƒè¾“å…¥ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ä½¿ç”¨Transformeræ¨¡å‹çš„å¸¸è§æ–¹å¼ï¼šå›¾åƒåˆ†ç±»ï¼šå¯ä»¥å°†å›¾åƒåˆ’åˆ†ä¸ºç½‘æ ¼å•å…ƒï¼Œå¹¶å°†æ¯ä¸ªå•å…ƒçš„ç‰¹å¾è¡¨ç¤ºä¸ºåºåˆ—ã€‚ç„¶åï¼Œå°†åºåˆ—è¾“å…¥Transformeræ¨¡å‹è¿›è¡Œåˆ†ç±»ä»»åŠ¡ã€‚è¿™æ ·åšçš„ä¸€ä¸ªä¾‹å­æ˜¯Vision Transformer(ViT)æ¨¡å‹ï¼Œå®ƒå°†å›¾åƒåˆ’åˆ†ä¸ºå›¾åƒå—ï¼Œç„¶åé€šè¿‡Transformerç¼–ç å™¨å¯¹è¿™äº›å—è¿›è¡Œå¤„ç†ç›®æ ‡æ£€æµ‹ï¼šä¸€ç§ä½¿ç”¨Transformerçš„ç›®æ ‡æ£€æµ‹æ–¹æ³•æ˜¯å°†å›¾åƒåˆ’åˆ†ä¸ºä¸€ç»„å›ºå®šå¤§å°çš„åŒºåŸŸï¼Œç„¶åå¯¹æ¯ä¸ªåŒºåŸŸæå–ç‰¹å¾ï¼Œå¹¶å°†è¿™äº›ç‰¹å¾åºåˆ—è¾“å…¥Transformeræ¨¡å‹ä¸­è¿›è¡Œå¯¹è±¡åˆ†ç±»å’Œè¾¹ç•Œæ¡†å›å½’ã€‚è¿™ç§æ–¹æ³•çš„ä¸€ä¸ªä¾‹å­æ˜¯DETR(Detection Transformer)æ¨¡å‹å›¾åƒç”Ÿæˆï¼šTransformeræ¨¡å‹ä¹Ÿå¯ä»¥ç”¨äºç”Ÿæˆè§†è§‰å†…å®¹ï¼Œå¦‚å›¾åƒç”Ÿæˆã€å›¾åƒæè¿°ç”Ÿæˆç­‰ä»»åŠ¡ã€‚é€šè¿‡å°†Transformeræ¨¡å‹ä½œä¸ºç”Ÿæˆå™¨ï¼Œå¯ä»¥å­¦ä¹ ç”Ÿæˆé«˜è´¨é‡çš„å›¾åƒæˆ–å›¾åƒæè¿°éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºå›¾åƒæ•°æ®çš„é«˜ç»´æ€§å’Œç©ºé—´ç»“æ„ï¼Œç›´æ¥å°†Transformeræ¨¡å‹åº”ç”¨äºæ•´ä¸ªå›¾åƒé€šå¸¸ä¸æ˜¯å¸¸è§çš„åšæ³•ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œå·ç§¯ç¥ç»ç½‘ç»œ(CNN)åœ¨è®¡ç®—æœºè§†è§‰é¢†åŸŸä¸­æ›´ä¸ºå¸¸è§ï¼Œå› ä¸ºå®ƒä»¬æ›´é€‚åˆå¤„ç†å›¾åƒæ•°æ®çš„å±€éƒ¨ç‰¹å¾å’Œç©ºé—´ç»“æ„ã€‚ä½†æ˜¯ï¼Œé€šè¿‡å°†Transformeræ¨¡å‹ä¸CNNç»“åˆä½¿ç”¨ï¼Œå¯ä»¥åˆ©ç”¨Transformeræ¨¡å‹çš„åºåˆ—å»ºæ¨¡èƒ½åŠ›å’Œæ³¨æ„åŠ›æœºåˆ¶æ¥å¤„ç†å›¾åƒä¸­çš„åºåˆ—æˆ–å±€éƒ¨ç‰¹å¾ï¼Œä»è€Œæé«˜è®¡ç®—æœºè§†è§‰ä»»åŠ¡çš„æ€§èƒ½Tranformerå’ŒCNNæ¯”è¾ƒTranformerç›¸è¾ƒäºCNNç»“æ„ï¼Œç¼ºå°‘ä¸€å®šçš„å¹³ç§»ä¸å˜æ€§å’Œå±€éƒ¨æ„ŸçŸ¥æ€§ï¼Œå› æ­¤åœ¨æ•°æ®é‡ä¸å……åˆ†æ—¶ï¼Œå¾ˆéš¾è¾¾åˆ°åŒç­‰çš„æ•ˆæœï¼Œè¡¨ç°ä¸ºä½¿ç”¨ä¸­ç­‰è§„æ¨¡çš„ImageNetè®­ç»ƒçš„Tranformerä¼šæ¯”ResNetåœ¨ç²¾åº¦ä¸Šä½å‡ ä¸ªç™¾åˆ†ç‚¹å½“æœ‰å¤§é‡çš„è®­ç»ƒæ ·æœ¬æ—¶ï¼Œç»“æœåˆ™ä¼šå‘ç”Ÿæ”¹å˜ã€‚ä½¿ç”¨å¤§è§„æ¨¡æ•°æ®é›†è¿›è¡Œé¢„è®­ç»ƒåï¼Œå†ä½¿ç”¨è¿ç§»å­¦ä¹ çš„æ–¹å¼åº”ç”¨åˆ°å…¶ä»–æ•°æ®é›†ä¸Šï¼Œå¯ä»¥è¾¾åˆ°æˆ–è¶…è¶Šå½“å‰çš„SOTAæ°´å¹³DeiTModelTraining data-efficient image transformers &amp; distillation through attention 2021è§†è§‰Transformerç»å…¸è®ºæ–‡â€”â€”ViTã€DeiTçš„ä¸åŸç†è§£è¯»ä¸å®ç°huggingface DeiTModelDeiTï¼šæ³¨æ„åŠ›Attentionä¹Ÿèƒ½è’¸é¦DeiTModel(Data-efficient Image Transformers Model)å’ŒViT(Vision Transformer)ä¹‹é—´å­˜åœ¨å…³ç³»ï¼ŒDeiTModelå¯ä»¥çœ‹ä½œæ˜¯å¯¹ViTæ¨¡å‹çš„æ”¹è¿›å’Œä¼˜åŒ–ViTåœ¨å¤§æ•°æ®é›† mageNet-21k(14million)æˆ–è€…JFT-300M(300million)ä¸Šè¿›è¡Œè®­ç»ƒï¼ŒBatch Size 128ä¸‹NVIDIA A100 32G GPUçš„è®¡ç®—èµ„æºåŠ æŒä¸‹é¢„è®­ç»ƒViT-Base/32éœ€è¦3å¤©æ—¶é—´ViTæ˜¯ä¸€ç§åŸºäºTransformerçš„å›¾åƒåˆ†ç±»æ¨¡å‹ï¼Œé€šè¿‡å°†å›¾åƒæ‹†åˆ†æˆå›ºå®šå¤§å°çš„å›¾åƒå—ï¼Œå¹¶ä½¿ç”¨çº¿æ€§åµŒå…¥å°†æ¯ä¸ªå›¾åƒå—è½¬æ¢ä¸ºå‘é‡åºåˆ—ï¼Œç„¶åå°†åºåˆ—è¾“å…¥åˆ°Transformerç¼–ç å™¨ä¸­è¿›è¡Œå¤„ç†ã€‚ViTæ¨¡å‹åœ¨å›¾åƒåˆ†ç±»ä»»åŠ¡ä¸­å–å¾—äº†å‡ºè‰²çš„æ€§èƒ½ï¼Œä½†éœ€è¦å¤§é‡çš„è®­ç»ƒæ•°æ®å’Œè®¡ç®—èµ„æºFacebookä¸ç´¢é‚¦å¤§å­¦Matthieu Cordæ•™æˆåˆä½œDeiTModelï¼ŒDeiTæ¨¡å‹(8600ä¸‡å‚æ•°)ä»…ç”¨ä¸€å°GPUæœåŠ¡å™¨åœ¨53 hours trainï¼Œ20 hours finetuneï¼Œä»…ä½¿ç”¨ImageNetå°±è¾¾åˆ°äº† 84.2 top-1å‡†ç¡®æ€§ï¼Œè€Œæ— éœ€ä½¿ç”¨ä»»ä½•å¤–éƒ¨æ•°æ®è¿›è¡Œè®­ç»ƒã€‚æ€§èƒ½ä¸æœ€å…ˆè¿›çš„å·ç§¯ç¥ç»ç½‘ç»œ(CNN)å¯ä»¥æŠ—è¡¡è¾ƒäºVitçš„æ”¹è¿›ç‚¹DeiTModelåˆ™æ˜¯åœ¨ViTçš„åŸºç¡€ä¸Šè¿›è¡Œäº†æ”¹è¿›ï¼Œæ—¨åœ¨æé«˜æ•°æ®æ•ˆç‡è®­ç»ƒç­–ç•¥: é«˜ä½ç²¾åº¦+æ•°æ®å¢å¼ºæ›´å°‘çš„æ•°æ®å’Œè®¡ç®—èµ„æº: DeiTæ¨¡å‹ä½¿ç”¨æ›´å°‘çš„æ•°æ®å’Œè®¡ç®—èµ„æºï¼Œä»…ä½¿ç”¨ImageNetæ•°æ®é›†è¿›è¡Œè®­ç»ƒï¼Œå¹¶åœ¨è¾ƒçŸ­çš„æ—¶é—´å†…å®Œæˆè®­ç»ƒè’¸é¦æœºåˆ¶: DeiTæ¨¡å‹è¿˜å¼•å…¥äº†ä¸€ç§æ•™å¸ˆ-å­¦ç”Ÿç­–ç•¥ï¼Œé€šè¿‡è’¸é¦æœºåˆ¶ä½¿å­¦ç”Ÿæ¨¡å‹ä»æ•™å¸ˆæ¨¡å‹ä¸­å­¦ä¹ ï¼Œè¿™ç§ç­–ç•¥æœ‰åŠ©äºæé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›å’Œæ€§èƒ½çŸ¥è¯†è’¸é¦DeiTï¼šæ³¨æ„åŠ›Attentionä¹Ÿèƒ½è’¸é¦çŸ¥è¯†è’¸é¦ä½¿ç”¨çš„æ˜¯Teacherâ€”Studentæ¨¡å‹ï¼Œå…¶ä¸­Teacheræ˜¯çŸ¥è¯†çš„è¾“å‡ºè€…ï¼ŒStudentæ˜¯çŸ¥è¯†çš„æ¥å—è€…ã€‚çŸ¥è¯†è’¸é¦çš„è¿‡ç¨‹åˆ†ä¸º2ä¸ªé˜¶æ®µ:åŸå§‹æ¨¡å‹è®­ç»ƒ: è®­ç»ƒTeacheræ¨¡å‹, ç®€ç§°ä¸ºNet-Tï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯æ¨¡å‹ç›¸å¯¹å¤æ‚ï¼Œä¹Ÿå¯ä»¥ç”±å¤šä¸ªåˆ†åˆ«è®­ç»ƒçš„æ¨¡å‹é›†æˆè€Œæˆã€‚æˆ‘ä»¬å¯¹Teacheræ¨¡å‹ä¸ä½œä»»ä½•å…³äºæ¨¡å‹æ¶æ„ã€å‚æ•°é‡ã€æ˜¯å¦é›†æˆæ–¹é¢çš„é™åˆ¶ï¼Œå”¯ä¸€çš„è¦æ±‚å°±æ˜¯ï¼Œå¯¹äºè¾“å…¥X, å…¶éƒ½èƒ½è¾“å‡ºYï¼Œå…¶ä¸­Yç»è¿‡softmaxçš„æ˜ å°„ï¼Œè¾“å‡ºå€¼å¯¹åº”ç›¸åº”ç±»åˆ«çš„æ¦‚ç‡å€¼ç²¾ç®€æ¨¡å‹è®­ç»ƒ: è®­ç»ƒStudentæ¨¡å‹, ç®€ç§°ä¸ºNet-Sï¼Œå®ƒæ˜¯å‚æ•°é‡è¾ƒå°ã€æ¨¡å‹ç»“æ„ç›¸å¯¹ç®€å•çš„å•æ¨¡å‹ã€‚åŒæ ·çš„ï¼Œå¯¹äºè¾“å…¥Xï¼Œå…¶éƒ½èƒ½è¾“å‡ºYï¼ŒYç»è¿‡softmaxæ˜ å°„ååŒæ ·èƒ½è¾“å‡ºå¯¹åº”ç›¸åº”ç±»åˆ«çš„æ¦‚ç‡å€¼å°†é—®é¢˜é™å®šåœ¨åˆ†ç±»é—®é¢˜ä¸‹ï¼Œæˆ–è€…å…¶ä»–æœ¬è´¨ä¸Šå±äºåˆ†ç±»é—®é¢˜çš„é—®é¢˜ï¼Œè¯¥ç±»é—®é¢˜çš„å…±åŒç‚¹æ˜¯æ¨¡å‹æœ€åä¼šæœ‰ä¸€ä¸ªsoftmaxå±‚ï¼Œå…¶è¾“å‡ºå€¼å¯¹åº”äº†ç›¸åº”ç±»åˆ«çš„æ¦‚ç‡å€¼ã€‚çŸ¥è¯†è’¸é¦æ—¶ï¼Œç”±äºå·²ç»æœ‰äº†ä¸€ä¸ªæ³›åŒ–èƒ½åŠ›è¾ƒå¼ºçš„Net-Tï¼Œæˆ‘ä»¬åœ¨åˆ©ç”¨Net-Tæ¥è’¸é¦è®­ç»ƒNet-Sæ—¶ï¼Œå¯ä»¥ç›´æ¥è®©Net-Så»å­¦ä¹ Net-Tçš„æ³›åŒ–èƒ½åŠ›ä¸Šå›¾æ˜¯æ•™å¸ˆå­¦ç”Ÿæ¨¡å‹çš„ä¸€èˆ¬å½¢å¼ï¼Œå°±æ˜¯æœ‰ä¸¤éƒ¨åˆ†çš„lossï¼Œä¸€ä¸ªå…³æ³¨çœŸå®æ ‡ç­¾ï¼Œå¦ä¸€ä¸ªå…³æ³¨Net-Tçš„è¾“å‡ºï¼Œè®­ç»ƒçš„æ¨¡å‹å¯ä»¥å…¼é¡¾è‡ªèº«å’Œæ•™å¸ˆæ¨¡å‹çš„çº¦æŸï¼Œå³ä¸‹é¢å·¦å›¾æ¯”è¾ƒäº†æ”¹å˜è®­ç»ƒç­–ç•¥å’Œæ·»åŠ è’¸é¦å­¦ä¹ çš„ç»“æœæ¯”è¾ƒï¼Œå³å›¾æ˜¯DeiTæ¨¡å‹ç»“æ„å·¦å›¾å›¾ä¸­çš„æŒ‡æ ‡å‡ä¸ºåœ¨ImageNetæ•°æ®é›†ä¸Šè¿›è¡Œè®­ç»ƒï¼Œä¸”åœ¨ImageNetæ•°æ®é›†ä¸Šè¯„ä¼°çš„ç»“æœå…¶ä¸­Ours(Deit)ä¸ºä½¿ç”¨ä¸ViTå®Œå…¨ä¸€è‡´çš„ç½‘ç»œç»“æ„ï¼Œä½†æ˜¯æ”¹è¿›äº†è®­ç»ƒç­–ç•¥è€ŒOursâš—(DeiTâš—)åˆ™æ˜¯åœ¨DeiTçš„åŸºç¡€ä¸Šç»§ç»­ä½¿ç”¨äº†è’¸é¦å­¦ä¹ çš„æ–¹å¼è¿›è¡Œæ”¹è¿›å¯ä»¥çœ‹åˆ°ï¼ŒViTç®—æ³•åœ¨è¿™ç§ä¸­ç­‰è§„æ¨¡çš„æ•°æ®é›†ä¸Šï¼ŒæŒ‡æ ‡è¿œä¸å¦‚CNNç½‘ç»œEfficientNetè€Œé€šè¿‡æ”¹å˜è®­ç»ƒç­–ç•¥ï¼Œä½¿ç”¨è’¸é¦å­¦ä¹ ï¼Œç½‘ç»œç»“æ„ä¸ViTåŸºæœ¬ä¸€è‡´çš„DeiTæ€§èƒ½æœ‰äº†å¾ˆå¤§çš„æå‡ï¼Œè¶…è¿‡äº†EfficientNetå³å›¾DeiTä¸ViTçš„ä¸»è¦å·®å¼‚åœ¨äºå¼•å…¥äº†ä¸€ä¸ªdistillation tokenï¼Œå…¶ä¸»è¦ç”¨äºç½‘ç»œè®­ç»ƒä¸­çš„è’¸é¦å­¦ä¹ è¿™ä¸ªdistillation tokenä¸class tokenå¾ˆåƒï¼Œå…¶åœ¨self-attention layersä¸­ä¼šè·Ÿclass tokenä»¥åŠå›¾åƒpatchä¸æ–­äº¤äº’è€Œdistillation tokenä¸class tokenå”¯ä¸€åŒºåˆ«åœ¨äºï¼Œclass tokençš„ç›®æ ‡æ˜¯è·ŸçœŸå®çš„labelä¸€è‡´ï¼Œè€Œdistillation tokenæ˜¯è¦è·Ÿè’¸é¦å­¦ä¹ ä¸­æ•™å¸ˆç½‘ç»œé¢„æµ‹çš„labelä¸€è‡´åœ¨æœ€ç»ˆé¢„æµ‹æ—¶ï¼Œç½‘ç»œæ—¢ä¼šè¾“å‡ºclass tokençš„ç»“æœï¼Œä¹Ÿä¼šè¾“å‡ºdistillation tokençš„ç»“æœï¼Œè®ºæ–‡ç­”æ¡ˆæ˜¯å°†ä¸¤è€…çš„softmaxç»“æœè¿›è¡Œç›¸åŠ ï¼Œå³å¯ç®€å•åœ°å¾—åˆ°ç®—æ³•çš„æœ€ç»ˆé¢„æµ‹ç»“æœè¿™é‡Œåœ¨è®¡ç®—å’ŒNet-Tçš„lossæ—¶ï¼Œè¿˜å¯ä»¥ç»†åˆ†ä¸ºä¸¤ç§ï¼Œåˆ†åˆ«æ˜¯è½¯è’¸é¦(soft distillation)å’Œç¡¬è’¸é¦(hard distillation)è½¯è’¸é¦: å°†å­¦ç”Ÿç½‘ç»œçš„è¾“å‡ºç»“æœä¸æ•™å¸ˆç½‘ç»œçš„softmaxè¾“å‡ºç»“æœå–KL Lossç¡¬è’¸é¦: å°†å­¦ç”Ÿç½‘ç»œçš„è¾“å‡ºç»“æœä¸æ•™å¸ˆç½‘ç»œçš„æ ‡ç­¾å–äº¤å‰ç†µæŸå¤±Hard Labelä¹Ÿå¯ä»¥é€šè¿‡æ ‡ç­¾å¹³æ»‘æŠ€æœ¯(Label smoothing)è½¬æ¢æˆSoft Labeï¼Œå…¶ä¸­çœŸå€¼å¯¹åº”çš„æ ‡ç­¾è¢«è®¤ä¸ºå…·æœ‰1-esilonçš„æ¦‚ç‡ï¼Œå‰©ä½™çš„esilonç”±å‰©ä½™çš„ç±»åˆ«å…±äº«ViTã€Deitè¿™ç±»è§†è§‰transformeræ˜¯å¦‚ä½•å¤„ç†å˜é•¿åºåˆ—è¾“å…¥çš„å½“å¢åŠ è¾“å…¥å›¾åƒçš„åˆ†è¾¨ç‡æ—¶ï¼Œä¾‹å¦‚DeiTä»224åˆ°384ï¼Œä¸€èˆ¬æ¥è¯´ä¼šä¿æŒpatch size(ä¾‹å¦‚9)ï¼Œå› æ­¤patchçš„æ•°é‡Nä¼šå‘ç”Ÿäº†å˜åŒ–ç”±äºTransformerç»“æ„çš„åŸå› ï¼Œå†…ç½®äº†position embeddingä½ç½®ç¼–ç çš„å·®å€¼ï¼Œä¸€èˆ¬å°†ä½ç½®ç¼–ç åŒçº¿æ€§æ’å€¼åˆ°å›¾ç‰‡åˆ†è¾¨ç‡ï¼Œå½“Nå‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ¨¡å‹çš„æƒé‡ä¸éœ€è¦åšå‡ºä»»ä½•å˜åŒ–ä¹Ÿå¯ä»¥ä»¥åŒæ ·çš„æ–¹å¼è®¡ç®—å‡ºQã€Kã€Vçš„å€¼ï¼Œæ‰€ä»¥Visual transformerçš„æ¨¡å‹ç»“æ„é€‚ç”¨äºä»»ä½•é•¿åº¦çš„sequenceã€‚æœ€ç»ˆè¾“å‡ºé¢„æµ‹çš„æ—¶å€™ï¼Œçœ‹æ ·å­åºåˆ—é•¿äº†å¥½å¤šï¼Œä½†å…¶å®è¿˜æ˜¯åªå–cls tokenè¾“å‡ºä½œä¸ºè¾“å‡ºé¢„æµ‹ClipLearning Transferable Visual Models From Natural Language Supervision Clip 2021CLIP openaiå®˜æ–¹æºç Openaiè¿æ¥æ–‡æœ¬å’Œå›¾åƒCLIPæ¨¡å‹(Huggingfaceç‰ˆ)zero-shotåˆ†ç±»ä»£ç æ¡ˆä¾‹2021å¹´è§è¯äº†vision transformerçš„å¤§çˆ†å‘ï¼Œéšç€è°·æ­Œæå‡ºViTä¹‹åï¼Œä¸€å¤§æ‰¹çš„vision transformerçš„å·¥ä½œå¸­å·è®¡ç®—æœºè§†è§‰ä»»åŠ¡ã€‚é™¤äº†vision transformerï¼Œå¦å¤–ä¸€ä¸ªå¯¹è®¡ç®—æœºè§†è§‰å½±å“æ¯”è¾ƒå¤§çš„å·¥ä½œå°±æ˜¯Open AIåœ¨2021å¹´1æœˆä»½å‘å¸ƒçš„DALL-Eå’ŒCLIPï¼Œè¿™ä¸¤ä¸ªéƒ½å±äºç»“åˆå›¾åƒå’Œæ–‡æœ¬çš„å¤šæ¨¡æ€æ¨¡å‹DALL-Eæ˜¯åŸºäºæ–‡æœ¬æ¥ç”Ÿæˆæ¨¡å‹çš„æ¨¡å‹CLIPæ˜¯ç”¨æ–‡æœ¬ä½œä¸ºç›‘ç£ä¿¡å·æ¥è®­ç»ƒå¯è¿ç§»çš„è§†è§‰æ¨¡å‹è¿™ä¸¤ä¸ªå·¥ä½œä¹ŸåƒViTä¸€æ ·å¸¦åŠ¨äº†ä¸€æ³¢æ–°çš„ç ”ç©¶é«˜æ½®æ¦‚è¿°Openaiè¿æ¥æ–‡æœ¬å’Œå›¾åƒCLIPæ¨¡å‹(Huggingfaceç‰ˆ)zero-shotåˆ†ç±»ä»£ç æ¡ˆä¾‹CLIPçš„è‹±æ–‡å…¨ç§°æ˜¯Contrastive Language-Image Pre-trainingï¼Œå³ä¸€ç§åŸºäºå¯¹æ¯”æ–‡æœ¬-å›¾åƒå¯¹çš„é¢„è®­ç»ƒæ–¹æ³•æˆ–è€…æ¨¡å‹CLIPæ˜¯ä¸€ç§åŸºäºå¯¹æ¯”å­¦ä¹ çš„å¤šæ¨¡æ€æ¨¡å‹ï¼Œä¸CVä¸­çš„ä¸€äº›å¯¹æ¯”å­¦ä¹ æ–¹æ³•å¦‚mocoå’Œsimclrä¸åŒçš„æ˜¯ï¼ŒCLIPçš„è®­ç»ƒæ•°æ®æ˜¯æ–‡æœ¬-å›¾åƒå¯¹ï¼šä¸€å¼ å›¾åƒå’Œå®ƒå¯¹åº”çš„æ–‡æœ¬æè¿°ï¼Œè¿™é‡Œå¸Œæœ›é€šè¿‡å¯¹æ¯”å­¦ä¹ ï¼Œæ¨¡å‹èƒ½å¤Ÿå­¦ä¹ åˆ°æ–‡æœ¬-å›¾åƒå¯¹çš„åŒ¹é…å…³ç³»å¦‚ä¸Šå›¾(1)æ‰€ç¤ºï¼ŒCLIPåŒ…æ‹¬ä¸¤ä¸ªæ¨¡å‹ï¼šText Encoderå’ŒImage Encoderï¼Œå…¶ä¸­Text Encoderç”¨æ¥æå–æ–‡æœ¬çš„ç‰¹å¾ï¼Œå¯ä»¥é‡‡ç”¨NLPä¸­å¸¸ç”¨çš„text transformeræ¨¡å‹ï¼›è€ŒImage Encoderç”¨æ¥æå–å›¾åƒçš„ç‰¹å¾ï¼Œå¯ä»¥é‡‡ç”¨å¸¸ç”¨CNNæ¨¡å‹æˆ–è€…vision transformerå¯¹æå–çš„æ–‡æœ¬ç‰¹å¾å’Œå›¾åƒç‰¹å¾è¿›è¡Œå¯¹æ¯”å­¦ä¹ å¯¹äºä¸€ä¸ªåŒ…å«Nä¸ªæ–‡æœ¬-å›¾åƒå¯¹çš„è®­ç»ƒbatchï¼Œå°†Nä¸ªæ–‡æœ¬ç‰¹å¾å’ŒNä¸ªå›¾åƒç‰¹å¾ä¸¤ä¸¤ç»„åˆï¼ŒCLIPæ¨¡å‹ä¼šé¢„æµ‹å‡ºNæ–¹ä¸ªå¯èƒ½çš„æ–‡æœ¬-å›¾åƒå¯¹çš„ç›¸ä¼¼åº¦ï¼Œè¿™é‡Œçš„ç›¸ä¼¼åº¦ç›´æ¥è®¡ç®—æ–‡æœ¬ç‰¹å¾å’Œå›¾åƒç‰¹å¾çš„ä½™å¼¦ç›¸ä¼¼æ€§(cosine similarity)ï¼Œå³ä¸Šå›¾æ‰€ç¤ºçš„çŸ©é˜µè¿™é‡Œå…±æœ‰$N$ä¸ªæ­£æ ·æœ¬ï¼Œå³çœŸæ­£å±äºä¸€å¯¹çš„æ–‡æœ¬å’Œå›¾åƒ(çŸ©é˜µä¸­çš„å¯¹è§’çº¿å…ƒç´ )ï¼Œè€Œå‰©ä½™çš„$N*(N-1)$ä¸ªæ–‡æœ¬-å›¾åƒå¯¹ä¸ºè´Ÿæ ·æœ¬é‚£ä¹ˆCLIPçš„è®­ç»ƒç›®æ ‡å°±æ˜¯æœ€å¤§Nä¸ªæ­£æ ·æœ¬çš„ç›¸ä¼¼åº¦ï¼ŒåŒæ—¶æœ€å°åŒ–Næ–¹-Nä¸ªè´Ÿæ ·æœ¬çš„ç›¸ä¼¼åº¦ä¸ºäº†è®­ç»ƒCLIPï¼ŒOpenAIä»äº’è”ç½‘æ”¶é›†äº†å…±4ä¸ªäº¿çš„æ–‡æœ¬-å›¾åƒå¯¹zero-shotåˆ†ç±»ä¸CVä¸­å¸¸ç”¨çš„å…ˆé¢„è®­ç»ƒç„¶åå¾®è°ƒä¸åŒï¼ŒCLIPå¯ä»¥ç›´æ¥å®ç°zero-shotçš„å›¾åƒåˆ†ç±»ï¼Œå³ä¸éœ€è¦ä»»ä½•è®­ç»ƒæ•°æ®ï¼Œå°±èƒ½åœ¨æŸä¸ªå…·ä½“ä¸‹æ¸¸ä»»åŠ¡ä¸Šå®ç°åˆ†ç±»ï¼Œè¿™ä¹Ÿæ˜¯CLIPäº®ç‚¹å’Œå¼ºå¤§ä¹‹å¤„æ ¹æ®ä»»åŠ¡çš„åˆ†ç±»æ ‡ç­¾æ„å»ºæ¯ä¸ªç±»åˆ«çš„æè¿°æ–‡æœ¬ï¼šA photo of {label}ï¼Œç„¶åå°†è¿™äº›æ–‡æœ¬é€å…¥Text Encoderå¾—åˆ°å¯¹åº”çš„æ–‡æœ¬ç‰¹å¾å°†è¦é¢„æµ‹çš„å›¾åƒé€å…¥Image Encoderå¾—åˆ°å›¾åƒç‰¹å¾ï¼Œç„¶åä¸Nä¸ªæ–‡æœ¬ç‰¹å¾è®¡ç®—ç¼©æ”¾çš„ä½™å¼¦ç›¸ä¼¼åº¦(å’Œè®­ç»ƒè¿‡ç¨‹ä¸€è‡´)ç„¶åé€‰æ‹©ç›¸ä¼¼åº¦æœ€å¤§çš„æ–‡æœ¬å¯¹åº”çš„ç±»åˆ«ä½œä¸ºå›¾åƒåˆ†ç±»é¢„æµ‹ç»“æœï¼Œè¿›ä¸€æ­¥åœ°ï¼Œå¯ä»¥å°†è¿™äº›ç›¸ä¼¼åº¦çœ‹æˆlogitsï¼Œé€å…¥softmaxåå¯ä»¥åˆ°æ¯ä¸ªç±»åˆ«çš„é¢„æµ‹æ¦‚ç‡12345678910111213141516from PIL import Imagefrom transformers import CLIPProcessor,CLIPModelmodel = CLIPModel.from_pretrained(&quot;openai/clip-vit-base-patch32&quot;)processor = CLIPProcessor.from_pretrained(&quot;openai/clip-vit-base-patch32&quot;)#è¿™é‡ŒåŠ å…¥è‡ªå·±å›¾ç‰‡çš„åœ°å€å°±è¡Œimage = Image.open('xxx.jpg')#è¿™é‡ŒåŠ å…¥ç±»åˆ«çš„æ ‡ç­¾ç±»åˆ«text = ['plane','car','dog','bird']inputs = processor(text=text,images = image,return_tensors=&quot;pt&quot;,padding=True)outputs = model(**inputs)logits_per_image = outputs.logits_per_imageprobs = logits_per_image.softmax(dim=1)for i in range(len(text)):    print(text[i],&quot;:&quot;,probs[0][i])ä½¿ç”¨CLIPè¿›è¡Œzero-shotåˆ†ç±»ï¼Œå¦å¤–ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„åœ°æ–¹æ˜¯æ–‡æœ¬æè¿°çš„ç”Ÿæˆï¼Œä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬é‡‡ç”¨åˆ†ç±»æ ‡ç­¾ï¼Œä½†å…¶å®ä¹Ÿæœ‰å…¶å®ƒé€‰æ‹©æ¯”å¦‚æˆ‘ä»¬ç›´æ¥ç”¨ç±»åˆ«æ ‡ç­¾ï¼Œè¿™å…¶å®å±äºæœ€è¿‘NLPé¢†åŸŸæ¯”è¾ƒç«çš„ä¸€ä¸ªç ”ç©¶ï¼šprompt learningæˆ–è€…prompt engineeringæ‰©å±•CLIPæ˜¯åŸºäºæ–‡æœ¬-å›¾åƒå¯¹æ¥åšçš„ï¼Œä½†æ˜¯å®ƒå¯ä»¥æ‰©å±•åˆ°æ–‡æœ¬-è§†é¢‘ï¼Œæ¯”å¦‚VideoCLIPå°±æ˜¯å°†CLIPåº”ç”¨åœ¨è§†é¢‘é¢†åŸŸæ¥å®ç°ä¸€äº›zero-shotè§†é¢‘ç†è§£ä»»åŠ¡VQGAN+CLIPå®ç°å„ç§å›¾åƒç”Ÿæˆæ¨¡å‹TOnICSCurriculum Learning for Data-Efficient Vision-Language Alignment TOnICS 2022è¶…è¶ŠCLIPçš„å¤šæ¨¡æ€æ¨¡å‹ï¼Œåªéœ€ä¸åˆ°1%çš„è®­ç»ƒæ•°æ®ï¼å—åŠ å¤§æœ€æ–°ç ”ç©¶æ¥äº† CLIP(Contrastive Languageâ€“Image Pre-training)ï¼Œæ˜¯ä¸€ç§åŸºäºå¯¹æ¯”çš„å›¾ç‰‡-æ–‡æœ¬å­¦ä¹ çš„è·¨æ¨¡æ€é¢„è®­ç»ƒæ¨¡å‹ï¼Œç”±OpenAIäº2021å¹´1æœˆå‘å¸ƒå®ƒå­˜åœ¨ä¸€ä¸ªç¼ºç‚¹å°±æ˜¯æ•°æ®éœ€æ±‚å¤ªå¤§ï¼š4äº¿ä¸ªå›¾åƒæ–‡æœ¬å¯¹ã€256ä¸ªGPUï¼Œè¿™å¯¹è®¸å¤šå…¬å¸å’Œä¸ªäººéƒ½å¾ˆä¸å‹å¥½å¯¹æ­¤ï¼Œå—åŠ å·å¤§å­¦çš„æœ€æ–°ç ”ç©¶å‘ç°äº†ä¸€ç§åŸºäºæœ¬ä½“çš„è¯¾ç¨‹å­¦ä¹ (Curriculum Learning)ç®—æ³•ï¼Œåªéœ€ä¸åˆ°1%çš„è®­ç»ƒæ•°æ®å°±èƒ½è¾¾åˆ°CLIPåŒæ¬¾æ•ˆæœï¼Œç”šè‡³åœ¨å›¾åƒæ£€ç´¢æ–¹é¢è¡¨ç°æ›´å¥½</content>
	</entry>
	<entry>
		<title>ç›®æ ‡æ£€æµ‹ä¸è·Ÿè¸ªç®—æ³•</title>
		<url>/article/34192.html</url>
		<content>ç›®æ ‡æ£€æµ‹ç»å…¸ç›®æ ‡æ£€æµ‹Object Detectionæ¨¡å‹æ•´ç†æ·±å…¥æµ…å‡ºYoloç³»åˆ—ä¹‹Yolov5æ ¸å¿ƒåŸºç¡€çŸ¥è¯†å®Œæ•´è®²è§£ç›®æ ‡æ£€æµ‹ YOLOç³»åˆ—ç®—æ³•Object Detection in 20 Years: A Surveyè®ºæ–‡è¯¦è§£R-CNNå²ä¸Šæœ€å…¨è®²è§£YOLOv1è®ºæ–‡ç¿»è¯‘è§£è¯»YOLO v4ï¼šç‰©ä½“æ£€æµ‹çš„æœ€ä½³é€Ÿåº¦å’Œç²¾åº¦Yoloç³»åˆ—ä»£ç æ¦‚è¿°ç›®æ ‡æ£€æµ‹â€”â€”RCNNä¸YOLOç³»åˆ—æ ¸å¿ƒé—®é¢˜åˆ†ç±»é—®é¢˜ï¼šå³å›¾ç‰‡(æˆ–æŸä¸ªåŒºåŸŸ)ä¸­çš„å›¾åƒå±äºå“ªä¸ªç±»åˆ«å®šä½é—®é¢˜ï¼šç›®æ ‡å¯èƒ½å‡ºç°åœ¨å›¾åƒçš„ä»»ä½•ä½ç½®å¤§å°é—®é¢˜ï¼šç›®æ ‡æœ‰å„ç§ä¸åŒçš„å¤§å°å½¢çŠ¶é—®é¢˜ï¼šç›®æ ‡å¯èƒ½æœ‰å„ç§ä¸åŒçš„å½¢çŠ¶ç®—æ³•åˆ†ç±»Anchor Basedæ¨¡å‹Anchor Freeæ¨¡å‹One-stageæ¨¡å‹YoloV2-5ç³»åˆ—ã€SSDã€RetinaNetYoloV1ã€FCOSã€CornerNetTwo-stageæ¨¡å‹Faster RCNNã€Cascade RCNNã€MaskRCNNtwo stageï¼šå…ˆè¿›è¡ŒåŒºåŸŸç”Ÿæˆï¼Œè¯¥åŒºåŸŸç§°ä¸ºregion proposalï¼ˆRPï¼Œä¸€ä¸ªæœ‰å¯èƒ½åŒ…å«ç‰©ä½“çš„é¢„é€‰æ¡†ï¼‰ï¼›å†é€šè¿‡å·ç§¯ç¥ç»ç½‘ç»œè¿›è¡Œæ ·æœ¬åˆ†ç±»ä»»åŠ¡æµç¨‹ï¼šç‰¹å¾æå–â€”ç”ŸæˆRPâ€”åˆ†ç±»/å®šä½å›å½’å¸¸è§two stageï¼šR-CNNã€SPP-Netã€Fast R-CNNã€Faster R-CNNã€R-FCNone stageï¼šä¸ç”¨RPï¼Œç›´æ¥åœ¨ç½‘ç»œä¸­æå–ç‰¹å¾æ¥é¢„æµ‹ç‰©ä½“çš„åˆ†ç±»å’Œä½ç½®ä»»åŠ¡æµç¨‹ï¼šç‰¹å¾æå–â€”åˆ†ç±»/å®šä½å›å½’å¸¸è§one stageï¼šOverFeatã€YOLOv1ã€YOLOv2ã€YOLOv3ã€SSDã€RetinaNetç›®æ ‡æ£€æµ‹åˆ†ä¸ºä¸¤å¤§ç³»åˆ—â€”â€”RCNNç³»åˆ—å’ŒYOLOç³»åˆ—ï¼šRCNNç³»åˆ—æ˜¯åŸºäºåŒºåŸŸæ£€æµ‹çš„ä»£è¡¨æ€§ç®—æ³•YOLOæ˜¯åŸºäºåŒºåŸŸæå–çš„ä»£è¡¨æ€§ç®—æ³•è¿˜æœ‰è‘—åçš„SSDæ˜¯åŸºäºå‰ä¸¤ä¸ªç³»åˆ—çš„æ”¹è¿›å‘å±•è„‰ç»œ20142015201620172018R-CNNFast R-CNNFaster R-CNNYOLOYOLOSSDYOLOv2RetinaNetMask R-CNNFPNYOLOv3Cascade R-CNN202020222023YOLOv4YOLOv5EfficientDetYOLOv6(ç¾å›¢)YOLOv7YOLOv8æŒ‡æ ‡å’Œæ•°æ®mapæŒ‡æ ‡mAPâ€”ç›®æ ‡æ£€æµ‹æ¨¡å‹çš„è¯„ä¼°æŒ‡æ ‡YOLO æ¨¡å‹çš„è¯„ä¼°æŒ‡æ ‡â€”â€”IOUã€Precisionã€Recallã€F1-scoreã€mAPmAP@0.5åœ¨YOLOæ¨¡å‹ä¸­ï¼Œä½ ä¼šè§åˆ°mAP@0.5è¿™æ ·çš„è¡¨ç°å½¢å¼ï¼Œè¿™ç§å½¢å¼è¡¨ç¤ºåœ¨IOUé˜ˆå€¼ä¸º0.5çš„æƒ…å†µä¸‹ï¼ŒmAPçš„å€¼ä¸ºå¤šå°‘ã€‚å½“é¢„æµ‹æ¡†ä¸æ ‡æ³¨æ¡†çš„IOUå¤§äº0.5æ—¶ï¼Œå°±è®¤ä¸ºè¿™ä¸ªå¯¹è±¡é¢„æµ‹æ­£ç¡®ï¼Œåœ¨è¿™ä¸ªå‰æä¸‹å†å»è®¡ç®—mAPã€‚ä¸€èˆ¬æ¥è¯´ï¼ŒmAP@0.5å³ä¸ºè¯„ä»·YOLOæ¨¡å‹çš„æŒ‡æ ‡ä¹‹ä¸€mAP@[0.5:0.95]YOLOæ¨¡å‹ä¸­è¿˜å­˜åœ¨mAP@[0.5:0.95]è¿™æ ·ä¸€ç§è¡¨ç°å½¢å¼ï¼Œè¿™å½¢å¼æ˜¯å¤šä¸ªIOUé˜ˆå€¼ä¸‹çš„mAPï¼Œä¼šåœ¨qåŒºé—´[0.5,0.95]å†…ï¼Œä»¥0.05ä¸ºæ­¥é•¿ï¼Œå–10ä¸ªIOUé˜ˆå€¼ï¼Œåˆ†åˆ«è®¡ç®—è¿™10ä¸ªIOUé˜ˆå€¼ä¸‹çš„mAPï¼Œå†å–å¹³å‡å€¼ã€‚mAP@[0.5:0.95]è¶Šå¤§ï¼Œè¡¨ç¤ºé¢„æµ‹æ¡†è¶Šç²¾å‡†ï¼Œå› ä¸ºå®ƒå»å–åˆ°äº†æ›´å¤šIOUé˜ˆå€¼å¤§çš„æƒ…å†µæ•°æ®é›†å‡†å¤‡How to Train YOLOv8 Object Detection on a Custom Datasetæ·±åº¦å­¦ä¹ ç³»åˆ—ä¹‹Anchor based å’Œ Anchor free ç›®æ ‡æ£€æµ‹æ–¹æ³•RCNNç³»åˆ—å€™é€‰åŒºåŸŸçš„äº§ç”Ÿé€‰æ‹©æ€§æœç´¢ç®—æ³• ï¼ˆSelective Search)é€‰æ‹©æ€§æœç´¢ç®—æ³•(Selective Search)è¶…è¯¦è§£ï¼ˆé€šä¿—æ˜“æ‡‚ç‰ˆï¼‰å¾ˆå¤šç›®æ ‡æ£€æµ‹æŠ€æœ¯éƒ½ä¼šæ¶‰åŠå€™é€‰æ¡†(bounding boxes)çš„ç”Ÿæˆï¼Œç‰©ä½“å€™é€‰æ¡†è·å–å½“å‰ä¸»è¦ä½¿ç”¨å›¾åƒåˆ†å‰²ä¸åŒºåŸŸç”Ÿé•¿æŠ€æœ¯ã€‚åŒºåŸŸç”Ÿé•¿(åˆå¹¶)ä¸»è¦ç”±äºæ£€æµ‹å›¾åƒä¸­å­˜åœ¨çš„ç‰©ä½“å…·æœ‰å±€éƒ¨åŒºåŸŸç›¸ä¼¼æ€§(é¢œè‰²ã€çº¹ç†ç­‰)æ»‘åŠ¨çª—å£æ³•æ»‘åŠ¨ï¼šé¦–å…ˆå¯¹è¾“å…¥å›¾åƒè¿›è¡Œä¸åŒçª—å£å¤§å°çš„æ»‘çª—è¿›è¡Œä»å·¦å¾€å³ã€ä»ä¸Šåˆ°ä¸‹çš„æ»‘åŠ¨æ£€æµ‹ï¼šæ¯æ¬¡æ»‘åŠ¨æ—¶å€™å¯¹å½“å‰çª—å£æ‰§è¡Œåˆ†ç±»å™¨(åˆ†ç±»å™¨æ˜¯äº‹å…ˆè®­ç»ƒå¥½çš„)ã€‚å¦‚æœå½“å‰çª—å£å¾—åˆ°è¾ƒé«˜çš„åˆ†ç±»æ¦‚ç‡ï¼Œåˆ™è®¤ä¸ºæ£€æµ‹åˆ°äº†ç‰©ä½“ä¸åŒå°ºåº¦ï¼šå¯¹æ¯ä¸ªä¸åŒçª—å£å¤§å°çš„æ»‘çª—éƒ½è¿›è¡Œæ£€æµ‹åï¼Œä¼šå¾—åˆ°ä¸åŒçª—å£æ£€æµ‹åˆ°çš„ç‰©ä½“æ ‡è®°ï¼Œè¿™äº›çª—å£å¤§å°ä¼šå­˜åœ¨é‡å¤è¾ƒé«˜çš„éƒ¨åˆ†ï¼ŒNMSï¼šé‡‡ç”¨éæå¤§å€¼æŠ‘åˆ¶(Non-Maximum Suppression, NMS)çš„æ–¹æ³•è¿›è¡Œç­›é€‰ï¼Œæœ€ç»ˆï¼Œç»è¿‡NMSç­›é€‰åè·å¾—æ£€æµ‹åˆ°çš„ç‰©ä½“é€‰æ‹©æ€§æœç´¢ï¼šselective search(ç®€ç§°SS)æ–¹æ³•æ˜¯å½“ä¸‹æœ€ä¸ºç†ŸçŸ¥çš„å›¾åƒbounding boxesæå–ç®—æ³•ï¼Œç”±Koen E.Aäº2011å¹´æå‡ºåªå¯¹å›¾åƒä¸­æœ€æœ‰å¯èƒ½åŒ…å«ç‰©ä½“çš„åŒºåŸŸè¿›è¡Œæœç´¢ä»¥æ­¤æ¥æé«˜è®¡ç®—æ•ˆç‡ï¼Œå›¾åƒä¸­ç‰©ä½“å¯èƒ½å­˜åœ¨çš„åŒºåŸŸåº”è¯¥æ˜¯æœ‰æŸäº›ç›¸ä¼¼æ€§æˆ–è€…è¿ç»­æ€§åŒºåŸŸçš„åˆ†å‰²ï¼šå¯¹è¾“å…¥å›¾åƒè¿›è¡Œåˆ†å‰²ç®—æ³•äº§ç”Ÿè®¸å¤šå°çš„å­åŒºåŸŸåˆå¹¶ï¼šæ ¹æ®è¿™äº›å­åŒºåŸŸä¹‹é—´ç›¸ä¼¼æ€§(ç›¸ä¼¼æ€§æ ‡å‡†ä¸»è¦æœ‰é¢œè‰²ã€çº¹ç†ã€å¤§å°ç­‰ç­‰)è¿›è¡ŒåŒºåŸŸåˆå¹¶ï¼Œä¸æ–­çš„è¿›è¡ŒåŒºåŸŸè¿­ä»£åˆå¹¶å€™é€‰æ¡†ï¼šæ¯æ¬¡è¿­ä»£è¿‡ç¨‹ä¸­å¯¹è¿™äº›åˆå¹¶çš„å­åŒºåŸŸåšbounding boxes(å¤–åˆ‡çŸ©å½¢)ï¼Œè¿™äº›å­åŒºåŸŸå¤–åˆ‡çŸ©å½¢å°±æ˜¯é€šå¸¸æ‰€è¯´çš„å€™é€‰æ¡†æ»‘çª—æ³•ç®€å•æ˜“äºç†è§£ï¼Œä½†æ˜¯ä¸åŒçª—å£å¤§å°è¿›è¡Œå›¾åƒå…¨å±€æœç´¢å¯¼è‡´æ•ˆç‡ä½ä¸‹ï¼Œè€Œä¸”è®¾è®¡çª—å£å¤§å°æ—¶å€™è¿˜éœ€è¦è€ƒè™‘ç‰©ä½“çš„é•¿å®½æ¯”ã€‚æ‰€ä»¥ï¼Œå¯¹äºå®æ—¶æ€§è¦æ±‚è¾ƒé«˜çš„åˆ†ç±»å™¨ï¼Œä¸æ¨èä½¿ç”¨æ»‘çª—æ³•é€‰æ‹©æœç´¢è®¡ç®—æ•ˆç‡ä¼˜äºæ»‘çª—æ³•ï¼Œç”±äºé‡‡ç”¨å­åŒºåŸŸåˆå¹¶ç­–ç•¥ï¼Œæ‰€ä»¥å¯ä»¥åŒ…å«å„ç§å¤§å°çš„ç–‘ä¼¼ç‰©ä½“æ¡†ï¼Œåˆå¹¶åŒºåŸŸç›¸ä¼¼çš„æŒ‡æ ‡å¤šæ ·æ€§ï¼Œæé«˜äº†æ£€æµ‹ç‰©ä½“çš„æ¦‚ç‡æ•°æ®è¡¨ç¤ºé¢„æµ‹è¾“å‡ºå¯ä»¥è¡¨ç¤ºä¸ºï¼šå…¶ä¸­ï¼Œ ä¸ºé¢„æµ‹ç»“æœçš„ç½®ä¿¡æ¦‚ç‡ï¼Œ ä¸ºè¾¹æ¡†åæ ‡ï¼Œ ä¸ºå±äºæŸä¸ªç±»åˆ«çš„æ¦‚ç‡ï¼Œé€šè¿‡é¢„æµ‹ç»“æœï¼Œå®é™…ç»“æœï¼Œæ„å»ºæŸå¤±å‡½æ•°ï¼ŒæŸå¤±å‡½æ•°åŒ…å«äº†åˆ†ç±»ã€å›å½’ä¸¤éƒ¨åˆ†ç»„æˆæ•ˆæœè¯„ä¼°ä½¿ç”¨IoU(Intersection over Unionï¼Œäº¤å¹¶æ¯”)æ¥åˆ¤æ–­æ¨¡å‹çš„å¥½åã€‚æ‰€è°“äº¤å¹¶æ¯”ï¼Œæ˜¯æŒ‡é¢„æµ‹è¾¹æ¡†ã€å®é™…è¾¹æ¡†äº¤é›†å’Œå¹¶é›†çš„æ¯”ç‡ï¼Œä¸€èˆ¬çº¦å®š0.5ä¸ºä¸€ä¸ªå¯ä»¥æ¥å—çš„å€¼éæå¤§å€¼æŠ‘åˆ¶é¢„æµ‹ç»“æœä¸­ï¼Œå¯èƒ½å¤šä¸ªé¢„æµ‹ç»“æœé—´å­˜åœ¨é‡å éƒ¨åˆ†ï¼Œéœ€è¦ä¿ç•™äº¤å¹¶æ¯”æœ€å¤§çš„ã€å»æ‰éæœ€å¤§çš„é¢„æµ‹ç»“æœï¼Œè¿™å°±æ˜¯éæå¤§å€¼æŠ‘åˆ¶(Non-Maximum Suppressionï¼Œç®€å†™ä½œNMS)ï¼Œéæå¤§å€¼æŠ‘åˆ¶çš„æµç¨‹å¦‚ä¸‹ï¼šæ ¹æ®ç½®ä¿¡åº¦å¾—åˆ†è¿›è¡Œæ’åºé€‰æ‹©ç½®ä¿¡åº¦æœ€é«˜çš„æ¯”è¾¹ç•Œæ¡†æ·»åŠ åˆ°æœ€ç»ˆè¾“å‡ºåˆ—è¡¨ä¸­ï¼Œå°†å…¶ä»è¾¹ç•Œæ¡†åˆ—è¡¨ä¸­åˆ é™¤è®¡ç®—æ‰€æœ‰è¾¹ç•Œæ¡†çš„é¢ç§¯è®¡ç®—ç½®ä¿¡åº¦æœ€é«˜çš„è¾¹ç•Œæ¡†ä¸å…¶å®ƒå€™é€‰æ¡†çš„IoUã€‚åˆ é™¤IoUå¤§äºé˜ˆå€¼çš„è¾¹ç•Œæ¡†é‡å¤ä¸Šè¿°è¿‡ç¨‹ï¼Œç›´è‡³è¾¹ç•Œæ¡†åˆ—è¡¨ä¸ºç©ºbboxå›å½’è®­ç»ƒï¼šå…¶å®å°±æ˜¯è®­ç»ƒ  çŸ©é˜µå‘  çŸ©é˜µé é½çš„è¿‡ç¨‹ã€ç›®æ ‡æ£€æµ‹ã€‘åŸºç¡€çŸ¥è¯†ï¼šIoUã€NMSã€Bounding box regressionå³: ç»™å®š ï¼Œå¯»æ‰¾ä¸€ç§æ˜ å°„ï¼Œä½¿å¾—ä¸»è¦æ“ä½œå°±æ˜¯å¹³ç§»+ç¼©æ”¾rcnnRCNNåˆ†ä¸ºä¸‰ä¸ªmoduleï¼šç‹¬ç«‹ç±»åˆ«çš„å€™é€‰åŒºåŸŸï¼ˆcategory-independent region proposalsï¼‰ï¼Œç”Ÿæˆä¸€ç»„å¯¹æ£€æµ‹å™¨å¯ç”¨çš„æ£€æµ‹åæ ‡å¸¸è§çš„å€™é€‰åŒºç”Ÿæˆçš„æ–¹æ³•æœ‰å¾ˆå¤šï¼ˆobjectnessã€selective searchã€category-independent object proposalsã€constrained parametric min-cuts (CPMC) ã€multi-scale combinatorial groupingï¼‰ï¼Œæœ¬æ–‡ç”¨çš„æ˜¯é€‰æ‹©æœç´¢ã€‚äº§ç”Ÿäº†2000ä¸ªå€™é€‰åŒºåŸŸï¼ˆregion proposalï¼‰ä½¿ç”¨å·ç§¯ç¥ç»ç½‘ç»œä»æ¯ä¸ªåŒºåŸŸä»æå–å›ºå®šçš„ç‰¹å¾å‘é‡æœ¬æ–‡æ¯ä¸ªåŒºåŸŸæå–åˆ°çš„å›ºå®šé•¿åº¦çš„ç‰¹å¾å‘é‡æ˜¯4096ï¼Œä½¿ç”¨çš„ç½‘ç»œæ˜¯AlexNetéœ€è¦æ³¨æ„çš„æ˜¯ Alextnet çš„è¾“å…¥å›¾åƒå¤§å°æ˜¯$ 227\times227$ï¼Œè€Œé€šè¿‡ Selective Search äº§ç”Ÿçš„å€™é€‰åŒºåŸŸå¤§å°ä¸ä¸€ï¼Œä¸ºäº†ä¸ Alexnet å…¼å®¹ï¼ŒR-CNN é‡‡ç”¨äº†éå¸¸æš´åŠ›çš„æ‰‹æ®µï¼Œé‚£å°±æ˜¯æ— è§†å€™é€‰åŒºåŸŸçš„å¤§å°å’Œå½¢çŠ¶ï¼Œç»Ÿä¸€å˜æ¢åˆ°$ 227\times227$çš„å°ºå¯¸(å°±æ˜¯åªæœ‰å€™é€‰æ¡†é‡Œä¿ç•™ï¼Œå‰©ä½™éƒ¨åˆ†å¡«å……å…¶å®ƒåƒç´ ï¼Œæˆ–è€…å…ˆåœ¨å€™é€‰æ¡†å‘¨å›´åŠ ä¸Š16çš„paddingï¼Œå†è¿›è¡Œå„å‘å¼‚æ€§ç¼©æ”¾ï¼Œè¿™ç§å½¢å˜ä½¿å¾—mApæé«˜äº†3åˆ°5ä¸ªç™¾åˆ†ç‚¹)ã€‚æœ‰ä¸€ä¸ªç»†èŠ‚ï¼Œåœ¨å¯¹ Region è¿›è¡Œå˜æ¢çš„æ—¶å€™ï¼Œé¦–å…ˆå¯¹è¿™äº›åŒºåŸŸè¿›è¡Œè†¨èƒ€å¤„ç†ï¼Œåœ¨å…¶ box å‘¨å›´é™„åŠ äº† p ä¸ªåƒç´ ï¼Œä¹Ÿå°±æ˜¯äººä¸ºæ·»åŠ äº†è¾¹æ¡†ï¼Œåœ¨è¿™é‡Œ p=16åœ¨ ImageNet ä¸Šå…ˆè¿›è¡Œé¢„è®­ç»ƒï¼Œç„¶ååˆ©ç”¨æˆç†Ÿçš„æƒé‡å‚æ•°åœ¨ PASCAL VOC æ•°æ®é›†ä¸Šè¿›è¡Œ fine-tuneï¼Œå¦‚æœä¸é’ˆå¯¹ç‰¹å®šä»»åŠ¡è¿›è¡Œfine-tuningï¼Œè€Œæ˜¯æŠŠCNNå½“åšç‰¹å¾æå–å™¨ï¼Œå·ç§¯å±‚æ‰€å­¦åˆ°çš„ç‰¹å¾å…¶å®å°±æ˜¯åŸºç¡€çš„å…±äº«ç‰¹å¾æå–å±‚ï¼Œå°±ç±»ä¼¼äºSIFTç®—æ³•ä¸€æ ·ï¼Œå¯ä»¥ç”¨äºæå–å„ç§å›¾ç‰‡çš„ç‰¹å¾ï¼Œè€Œf6ã€f7æ‰€å­¦ä¹ åˆ°çš„ç‰¹å¾æ˜¯ç”¨äºé’ˆå¯¹ç‰¹å®šä»»åŠ¡çš„ç‰¹å¾ã€‚è®­ç»ƒè¿‡ç¨‹ï¼šé¦–å…ˆå¯¹ PASCAL VOCæ•°æ®é›† è¿›è¡ŒSelective Searchï¼Œæœç´¢åˆ°2000ä¸ªRegion Proposalå¯¹Pre-trainedæ¨¡å‹è¿›è¡Œfine-tuningã€‚å°†åŸæ¥é¢„è®­ç»ƒæ¨¡å‹æœ€åçš„1000-wayçš„å…¨è¿æ¥å±‚ï¼ˆåˆ†ç±»å±‚ï¼‰æ¢æˆ21-wayçš„åˆ†ç±»å±‚ï¼ˆ20ç±»ç‰©ä½“+èƒŒæ™¯ï¼‰ï¼Œç„¶åè®¡ç®—æ¯ä¸ªregion proposalå’Œground truth çš„IoUï¼Œå¯¹äºIoU&gt;0.5çš„region proposalè¢«è§†ä¸ºæ­£æ ·æœ¬ï¼Œå¦åˆ™ä¸ºè´Ÿæ ·æœ¬ï¼ˆå³èƒŒæ™¯ï¼‰ã€‚å¦å¤–ï¼Œç”±äºå¯¹äºä¸€å¼ å›¾ç‰‡çš„å¤šæœ‰å€™é€‰åŒºåŸŸæ¥è¯´ï¼Œè´Ÿæ ·æœ¬æ˜¯è¿œè¿œå¤§äºæ­£æ ·æœ¬æ•°ï¼Œæ‰€ä»¥éœ€è¦å°†æ­£æ ·æœ¬è¿›è¡Œä¸Šé‡‡æ ·æ¥ä¿è¯æ ·æœ¬åˆ†å¸ƒå‡è¡¡ã€‚åœ¨æ¯æ¬¡è¿­ä»£çš„è¿‡ç¨‹ä¸­ï¼Œé€‰æ‹©å±‚æ¬¡é‡‡æ ·ï¼Œæ¯ä¸ªmini-batchä¸­é‡‡æ ·ä¸¤å¼ å›¾åƒï¼Œä»ä¸­éšæœºé€‰å–32ä¸ªæ­£æ ·æœ¬å’Œ96ä¸ªè´Ÿæ ·æœ¬ç»„æˆä¸€ä¸ªmini-batchï¼ˆ128ï¼Œæ­£è´Ÿæ¯”ï¼š1ï¼š3ï¼‰ã€‚æˆ‘ä»¬ä½¿ç”¨0.001çš„å­¦ä¹ ç‡å’ŒSGDæ¥è¿›è¡Œè®­ç»ƒï¼Œæå–ç‰¹å¾çš„CNNç½‘ç»œç»è¿‡äº†é¢„è®­ç»ƒå’Œå¾®è°ƒåä¸å†è®­ç»ƒï¼Œå°±å›ºå®šä¸å˜äº†ï¼Œåªå•çº¯çš„ä½œä¸ºä¸€ä¸ªæç‰¹å¾çš„å·¥å…·äº†SVMçº¿æ€§åˆ†ç±»å™¨ï¼Œå¯¹ç‰¹å¾è¿›è¡Œåˆ†ç±»ï¼šåœ¨è®­ç»ƒCNNæå–ç‰¹å¾æ—¶ï¼Œè®¾ç½®çš„IOUæ˜¯0.5ä»¥ä¸Šä¸ºæ­£æ ·æœ¬ï¼Œå°äº0.5çš„æ˜¯è´Ÿæ ·æœ¬ã€‚ä½†åœ¨SVMåˆ†ç±»ä¸­ï¼Œåªæœ‰bboxå®Œå…¨åŒ…å›´äº†ç‰©ä½“ï¼ˆä¹Ÿå¯ä»¥ç†è§£ä¸ºIOUï¼0.7æ—¶ï¼‰æ‰æ˜¯æ­£æ ·æœ¬ï¼ŒIOUå°äº0.3çš„æ˜¯è´Ÿæ ·æœ¬ã€‚å‰è€…æ˜¯å¤§æ ·æœ¬è®­ç»ƒï¼Œåè€…æ˜¯å°æ ·æœ¬è®­ç»ƒï¼Œsvmé€‚ç”¨äºå°‘æ ·æœ¬è®­ç»ƒï¼Œå¦‚æœç”¨CNNåè€Œä¸åˆé€‚ç”¨SVMå¯¹æ¯ä¸ªç‰¹å¾å‘é‡è¿›è¡Œè¯„åˆ†ï¼Œç„¶åç”¨éæå¤§å€¼æŠ‘åˆ¶ç®€å•è¯´å°±æ˜¯ï¼šç»™å®šä¸€å¼ è¾“å…¥å›¾ç‰‡ï¼Œä»å›¾ç‰‡ä¸­æå– 2000 ä¸ªç±»åˆ«ç‹¬ç«‹çš„å€™é€‰åŒºåŸŸå¯¹äºæ¯ä¸ªåŒºåŸŸåˆ©ç”¨ CNN æŠ½å–ä¸€ä¸ªå›ºå®šé•¿åº¦çš„ç‰¹å¾å‘é‡å†å¯¹æ¯ä¸ªç‰¹å¾å‘é‡åˆ©ç”¨ SVM è¿›è¡Œç›®æ ‡åˆ†ç±»æµ‹è¯•æ­¥éª¤ï¼šRegion proposalçš„ç¡®å®šï¼šVOCæµ‹è¯•å›¾åƒè¾“å…¥åï¼Œåˆ©ç”¨SSæœç´¢æ–¹æ³•ï¼Œæ ¹æ®ç›¸ä¼¼åº¦ä»å¤§åˆ°å°æ’åºï¼Œç­›é€‰å‡º2000ä¸ªregion proposalsRPçš„Featuresæå–ï¼šå°†RPé€šè¿‡resizeæˆ$ 227 \times 227$ï¼Œç„¶ååˆ†åˆ«è¾“å…¥è¿›CNNç‰¹å¾æå–ç½‘ç»œï¼Œå¾—åˆ°äº†2000ä¸ª4096ç»´featuresSVMåˆ†ç±»ï¼šå°†(2000,4096)ç»´çŸ©é˜µè¾“å…¥è¿›SVMåˆ†ç±»å™¨ä¸­ï¼Œæœ€ç»ˆå¾—åˆ°(2000ï¼Œ21)çŸ©é˜µã€‚æ¯ä¸€è¡Œçš„21ä¸ªåˆ—å€¼ï¼Œåˆ†åˆ«ä»£è¡¨äº†è¿™ä¸ªRPå±äºæ¯ä¸€ä¸ªç±»çš„å¯èƒ½æ€§ã€‚é€šè¿‡æå‰è®¾ç½®å¥½çš„backgroundé˜ˆå€¼$\alpha$å’Œæ‰€å±äºç±»çš„é˜ˆå€¼$\beta$ï¼Œç­›é€‰å‡ºæ»¡è¶³æ¡ä»¶çš„mä¸ªRPåŒºåŸŸBoundingBox-Regressionï¼šå°†(m,4096)ç»´çŸ©é˜µè¾“å…¥è¿› (4096,4)çš„å›å½’çŸ©é˜µ d dd ä¸­ï¼Œæœ€åè¾“å‡º(m,4)åç§»çŸ©é˜µã€‚ä»£è¡¨RPä¸­å¿ƒç‚¹çš„ä½ç½®åç§» å’Œ bboxçš„å°ºå¯¸å˜æ¢å°†SVMç­›é€‰å‡ºçš„mä¸ªRPåŒºåŸŸå¯¹åº”çš„ç‰¹å¾å‘é‡ï¼Œç»„æˆ(m,4096)çŸ©é˜µ ä»£å…¥ (4096,4)çš„å›å½’çŸ©é˜µdä¸­ï¼Œæœ€åè¾“å‡º(m,4)åç§»çŸ©é˜µNon-maximum suppressionå¤„ç†ï¼šåªç”»å‡ºSVMç­›é€‰å‡ºçš„mä¸ªRPåŒºåŸŸçš„ä¿®æ­£åçš„æ£€æµ‹æ¡†ï¼Œè¿›è¡Œéæå¤§å€¼æŠ‘åˆ¶(NMS)ï¼Œå¾—åˆ°æœ€ç»ˆæ£€æµ‹ç»“æœç¼ºç‚¹ï¼šé‡å¤è®¡ç®—ï¼Œæ¯ä¸ªregion proposalï¼Œéƒ½éœ€è¦ç»è¿‡ä¸€ä¸ªAlexNetç‰¹å¾æå–ï¼Œä¸ºæ‰€æœ‰çš„RoIï¼ˆregion of interestï¼‰æå–ç‰¹å¾å¤§çº¦èŠ±è´¹47ç§’ï¼Œå ç”¨ç©ºé—´selective searchæ–¹æ³•ç”Ÿæˆregion proposalï¼Œå¯¹ä¸€å¸§å›¾åƒï¼Œéœ€è¦èŠ±è´¹2ç§’ä¸‰ä¸ªæ¨¡å—ï¼ˆæå–ã€åˆ†ç±»ã€å›å½’ï¼‰æ˜¯åˆ†åˆ«è®­ç»ƒçš„ï¼Œå¹¶ä¸”åœ¨è®­ç»ƒæ—¶å€™ï¼Œå¯¹äºå­˜å‚¨ç©ºé—´æ¶ˆè€—è¾ƒå¤§spp-netSPP-Net: å‡ºè‡ª2015å¹´å‘è¡¨åœ¨IEEEä¸Šçš„è®ºæ–‡-ã€ŠSpatial Pyramid Pooling in Deep Convolutional Networks for Visual Recognitionã€‹æ‰€æœ‰çš„ç¥ç»ç½‘ç»œéƒ½æ˜¯éœ€è¦è¾“å…¥å›ºå®šå°ºå¯¸çš„å›¾ç‰‡ï¼Œæ¯”å¦‚$ 224 \times 224$(ImageNet)ã€$ 32 \times 32$(LenNet)ã€$ 96\times 96$ç­‰ã€‚è¿™æ ·å¯¹äºæˆ‘ä»¬å¸Œæœ›æ£€æµ‹å„ç§å¤§å°çš„å›¾ç‰‡çš„æ—¶å€™ï¼Œéœ€è¦ç»è¿‡cropï¼Œæˆ–è€…warpç­‰ä¸€ç³»åˆ—æ“ä½œï¼Œè¿™éƒ½åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¯¼è‡´å›¾ç‰‡ä¿¡æ¯çš„ä¸¢å¤±å’Œå˜å½¢ï¼Œé™åˆ¶äº†è¯†åˆ«ç²¾ç¡®åº¦ä¸ºä»€ä¹ˆè¦å›ºå®šè¾“å…¥å›¾ç‰‡çš„å¤§å°ï¼Ÿï¼šå·ç§¯å±‚çš„å‚æ•°å’Œè¾“å…¥å¤§å°æ— å…³ï¼Œå®ƒä»…ä»…æ˜¯ä¸€ä¸ªå·ç§¯æ ¸åœ¨å›¾åƒä¸Šæ»‘åŠ¨ï¼Œä¸ç®¡è¾“å…¥å›¾åƒå¤šå¤§éƒ½æ²¡å…³ç³»ï¼Œåªæ˜¯å¯¹ä¸åŒå¤§å°çš„å›¾ç‰‡å·ç§¯å‡ºä¸åŒå¤§å°çš„ç‰¹å¾å›¾ï¼Œä½†æ˜¯å…¨è¿æ¥å±‚çš„å‚æ•°å°±å’Œè¾“å…¥å›¾åƒå¤§å°æœ‰å…³ï¼Œå› ä¸ºå®ƒè¦æŠŠè¾“å…¥çš„æ‰€æœ‰åƒç´ ç‚¹è¿æ¥èµ·æ¥,éœ€è¦æŒ‡å®šè¾“å…¥å±‚ç¥ç»å…ƒä¸ªæ•°å’Œè¾“å‡ºå±‚ç¥ç»å…ƒä¸ªæ•°ï¼Œæ‰€ä»¥éœ€è¦è§„å®šè¾“å…¥çš„featureçš„å¤§å°ï¼Œå› æ­¤ï¼Œå›ºå®šé•¿åº¦çš„çº¦æŸä»…é™äºå…¨è¿æ¥å±‚SPP-Netåœ¨æœ€åä¸€ä¸ªå·ç§¯å±‚åï¼Œæ¥å…¥äº†é‡‘å­—å¡”æ± åŒ–å±‚ï¼Œä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œå¯ä»¥è®©ç½‘ç»œè¾“å…¥ä»»æ„çš„å›¾ç‰‡ï¼Œè€Œä¸”è¿˜ä¼šç”Ÿæˆå›ºå®šå¤§å°çš„è¾“å‡ºé‡‘å­—å¡”æ± åŒ–ï¼Œä½¿å¾—ä»»æ„å¤§å°çš„ç‰¹å¾å›¾éƒ½èƒ½å¤Ÿè½¬æ¢æˆå›ºå®šå¤§å°çš„ç‰¹å¾å‘é‡ï¼Œè¿™å°±æ˜¯ç©ºé—´é‡‘å­—å¡”æ± åŒ–çš„æ„ä¹‰(å¤šå°ºåº¦ç‰¹å¾æå–å‡ºå›ºå®šå¤§å°çš„ç‰¹å¾å‘é‡)SPP-Netï¼Œæ•´ä¸ªè¿‡ç¨‹æ˜¯ï¼šé¦–å…ˆé€šè¿‡é€‰æ‹©æ€§æœç´¢ï¼Œå¯¹å¾…æ£€æµ‹çš„å›¾ç‰‡è¿›è¡Œæœç´¢å‡º2000ä¸ªå€™é€‰çª—å£ã€‚è¿™ä¸€æ­¥å’ŒR-CNNä¸€æ ·ã€‚ç‰¹å¾æå–é˜¶æ®µã€‚è¿™ä¸€æ­¥å°±æ˜¯å’ŒR-CNNæœ€å¤§çš„åŒºåˆ«äº†ï¼Œè¿™ä¸€æ­¥éª¤çš„å…·ä½“æ“ä½œå¦‚ä¸‹ï¼šæŠŠæ•´å¼ å¾…æ£€æµ‹çš„å›¾ç‰‡ï¼Œè¾“å…¥CNNä¸­ï¼Œè¿›è¡Œä¸€æ¬¡æ€§ç‰¹å¾æå–ï¼Œå¾—åˆ°feature mapsï¼Œç„¶ååœ¨feature mapsä¸­æ‰¾åˆ°å„ä¸ªå€™é€‰æ¡†çš„åŒºåŸŸï¼Œå†å¯¹å„ä¸ªå€™é€‰æ¡†é‡‡ç”¨é‡‘å­—å¡”ç©ºé—´æ± åŒ–ï¼Œæå–å‡ºå›ºå®šé•¿åº¦çš„ç‰¹å¾å‘é‡ã€‚è€ŒR-CNNè¾“å…¥çš„æ˜¯æ¯ä¸ªå€™é€‰æ¡†ï¼Œç„¶ååœ¨è¿›å…¥CNNï¼Œå› ä¸ºSPP-Netåªéœ€è¦ä¸€æ¬¡å¯¹æ•´å¼ å›¾ç‰‡è¿›è¡Œç‰¹å¾æå–ï¼Œé€Ÿåº¦ä¼šå¤§å¤§æå‡æœ€åä¸€æ­¥ä¹Ÿæ˜¯å’ŒR-CNNä¸€æ ·ï¼Œé‡‡ç”¨SVMç®—æ³•è¿›è¡Œç‰¹å¾å‘é‡åˆ†ç±»è¯†åˆ«éš¾ç‚¹å€™é€‰åŒºåŸŸï¼ˆåŸå›¾ä¸ç‰¹å¾å›¾ï¼‰çš„æ˜ å°„å‡è®¾$(xâ€™,yâ€™)$è¡¨ç¤ºç‰¹å¾å›¾ä¸Šçš„åæ ‡ç‚¹ï¼Œåæ ‡ç‚¹$(x,y)$è¡¨ç¤ºåŸè¾“å…¥å›¾ç‰‡ä¸Šçš„ç‚¹ï¼Œé‚£ä¹ˆå®ƒä»¬ä¹‹é—´æœ‰å¦‚ä¸‹è½¬æ¢å…³ç³»ï¼Œè¿™ç§æ˜ å°„å…³å¿ƒä¸ç½‘ç»œç»“æ„æœ‰å…³ï¼šå…¶ä¸­$S$å°±æ˜¯CNNä¸­æ‰€æœ‰çš„stridesçš„ä¹˜ç§¯ï¼ŒåŒ…å«äº†æ± åŒ–ã€å·ç§¯çš„stridefast-rcnnFast-Rcnnï¼šæå‡ºäº†ROI poolingR-CNNå­˜åœ¨ä¸€äº›é—®é¢˜ï¼šè®­ç»ƒåˆ†å¤šæ­¥ï¼šR-CNNçš„è®­ç»ƒå…ˆè¦fine tuningä¸€ä¸ªé¢„è®­ç»ƒçš„ç½‘ç»œï¼Œç„¶åé’ˆå¯¹æ¯ä¸ªç±»åˆ«éƒ½è®­ç»ƒä¸€ä¸ªSVMåˆ†ç±»å™¨ï¼Œæœ€åè¿˜è¦ç”¨regressorså¯¹bounding-boxè¿›è¡Œå›å½’ï¼Œå¦å¤–region proposalä¹Ÿè¦å•ç‹¬ç”¨selective searchçš„æ–¹å¼è·å¾—ï¼Œæ­¥éª¤æ¯”è¾ƒç¹çæ—¶é—´å’Œå†…å­˜æ¶ˆè€—å¤§ï¼šåœ¨è®­ç»ƒSVMå’Œå›å½’çš„æ—¶å€™éœ€è¦ç”¨ç½‘ç»œè®­ç»ƒçš„ç‰¹å¾ä½œä¸ºè¾“å…¥ï¼Œç‰¹å¾ä¿å­˜åœ¨ç£ç›˜ä¸Šå†è¯»å…¥çš„æ—¶é—´æ¶ˆè€—è¿˜æ˜¯æ¯”è¾ƒå¤§çš„æµ‹è¯•æ…¢ï¼šæ¯å¼ å›¾ç‰‡çš„æ¯ä¸ªregion proposaléƒ½è¦åšå·ç§¯ï¼Œé‡å¤æ“ä½œå¤ªå¤šè™½ç„¶åœ¨Fast RCNNä¹‹å‰æœ‰æå‡ºè¿‡SPPnetç®—æ³•æ¥è§£å†³RCNNä¸­é‡å¤å·ç§¯çš„é—®é¢˜ï¼Œä½†æ˜¯SPPnetä¾ç„¶å­˜åœ¨å’ŒRCNNä¸€æ ·çš„ä¸€äº›ç¼ºç‚¹æ¯”å¦‚ï¼šè®­ç»ƒæ­¥éª¤è¿‡å¤šï¼Œéœ€è¦è®­ç»ƒSVMåˆ†ç±»å™¨ï¼Œéœ€è¦é¢å¤–çš„å›å½’å™¨ï¼Œç‰¹å¾ä¹Ÿæ˜¯ä¿å­˜åœ¨ç£ç›˜ä¸Šå› æ­¤Fast RCNNç›¸å½“äºå…¨é¢æ”¹è¿›äº†åŸæœ‰çš„è¿™ä¸¤ä¸ªç®—æ³•ï¼Œä¸ä»…è®­ç»ƒæ­¥éª¤å‡å°‘äº†ï¼Œä¹Ÿä¸éœ€è¦é¢å¤–å°†ç‰¹å¾ä¿å­˜åœ¨ç£ç›˜ä¸ŠåŸºäºVGG16çš„Fast RCNNç®—æ³•çš„é€Ÿåº¦ï¼šåœ¨è®­ç»ƒé€Ÿåº¦ä¸Šæ¯”RCNNå¿«äº†å°†è¿‘9å€ï¼Œæ¯”SPPnetå¿«å¤§æ¦‚3å€æµ‹è¯•é€Ÿåº¦æ¯”RCNNå¿«äº†213å€ï¼Œæ¯”SPPnetå¿«äº†10å€åœ¨VOC2012ä¸Šçš„mAPåœ¨66%å·¦å³ç½‘ç»œæœ‰ä¸¤ä¸ªè¾“å…¥ï¼šå›¾åƒå’Œå¯¹åº”çš„region proposalã€‚å…¶ä¸­region proposalç”±selective searchæ–¹æ³•å¾—åˆ°ï¼Œæ²¡æœ‰è¡¨ç¤ºåœ¨æµç¨‹å›¾ä¸­å¯¹æ¯ä¸ªç±»åˆ«éƒ½è®­ç»ƒä¸€ä¸ªå›å½’å™¨ï¼Œä¸”åªæœ‰éèƒŒæ™¯çš„region proposalæ‰éœ€è¦è¿›è¡Œå›å½’ROI poolingï¼šROI Poolingçš„ä½œç”¨æ˜¯å¯¹ä¸åŒå¤§å°çš„region proposalï¼Œä»æœ€åå·ç§¯å±‚è¾“å‡ºçš„feature mapæå–å¤§å°å›ºå®šçš„feature map(ROI Poolingä½¿ç”¨è‡ªé€‚åº”(æ ¹æ®è¾“å…¥featureçš„å¤§å°è‡ªè°ƒæ•´)æ± åŒ–åŒºåŸŸï¼Œä¸å†å›ºå®šæ± åŒ–åŒºåŸŸå¤§å°ï¼Œè€Œå›ºå®šæ± åŒ–åŒºåŸŸä¸ªæ•°ï¼Œè¿™æ ·å°±ç¡®ä¿äº†è¾“å…¥ä»€ä¹ˆå¤§å°çš„featureï¼Œè¾“å‡ºçš„featureå¤§å°å®Œå…¨ç›¸ç­‰ï¼Œç­‰äºæ± åŒ–åŒºåŸŸä¸ªæ•°)ã€‚ç®€å•è®²å¯ä»¥çœ‹åšæ˜¯SPPNetçš„ç®€åŒ–ç‰ˆæœ¬ï¼Œå› ä¸ºå…¨è¿æ¥å±‚çš„è¾“å…¥éœ€è¦å°ºå¯¸å¤§å°ä¸€æ ·ï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥å°†ä¸åŒå¤§å°çš„region proposalæ˜ å°„åˆ°feature mapä½œä¸ºè¾“å‡ºï¼Œéœ€è¦åšå°ºå¯¸å˜æ¢ã€‚åœ¨æ–‡ç« ä¸­ï¼ŒVGG16ç½‘ç»œä½¿ç”¨$H = W = 7$çš„å‚æ•°ï¼Œå³å°†ä¸€ä¸ª$h \times w$çš„region proposalåˆ†å‰²æˆ$ H \times W$å¤§å°çš„ç½‘æ ¼ï¼Œç„¶åå°†è¿™ä¸ªregion proposalæ˜ å°„åˆ°æœ€åä¸€ä¸ªå·ç§¯å±‚è¾“å‡ºçš„feature mapï¼Œæœ€åè®¡ç®—æ¯ä¸ªç½‘æ ¼é‡Œçš„æœ€å¤§å€¼ä½œä¸ºè¯¥ç½‘æ ¼çš„è¾“å‡ºï¼Œæ‰€ä»¥ä¸ç®¡ROI poolingä¹‹å‰çš„feature mapå¤§å°æ˜¯å¤šå°‘ï¼ŒROI poolingåå¾—åˆ°çš„feature mapå¤§å°éƒ½æ˜¯$ H \times W$ç®€å•è¯´ROI poolingå°±æ˜¯ï¼šæŠŠå›¾ç‰‡ä¸Šselective searché€‰å‡ºçš„å€™é€‰æ¡†æ˜ å°„åˆ°ç‰¹å¾å›¾ä¸Šå¯¹åº”çš„ä½ç½®ï¼Œè¿™ä¸ªæ˜ å°„æ˜¯æ ¹æ®è¾“å…¥å›¾ç‰‡ç¼©å°çš„å°ºå¯¸æ¥çš„ï¼›å°†æ˜ å°„åçš„åŒºåŸŸåˆ’åˆ†ä¸ºç›¸åŒå¤§å°çš„sectionsï¼ˆsectionsæ•°é‡ä¸è¾“å‡ºçš„ç»´åº¦ç›¸åŒï¼‰å¯¹æ¯ä¸ªsectionsè¿›è¡Œmax poolingæ“ä½œï¼› è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä»ä¸åŒå¤§å°çš„æ–¹æ¡†å¾—åˆ°å›ºå®šå¤§å°çš„ç›¸åº” çš„feature mapsä¸¤ä¸ªlossï¼šç¬¬ä¸€ä¸ªä¼˜åŒ–ç›®æ ‡æ˜¯åˆ†ç±»ï¼Œä½¿ç”¨softmaxï¼ˆå°±ä¸ç”¨åƒå‰é¢çš„R-CNNå’ŒSPPå†ç”¨SVMäº†ï¼‰ï¼Œç¬¬äºŒä¸ªä¼˜åŒ–ç›®æ ‡æ˜¯bbox regressionï¼Œä½¿ç”¨äº†ä¸€ä¸ªå¹³æ»‘çš„L1-lossROI Pooling ä¸ SPP çš„åŒºåˆ«ï¼šé€šè¿‡ä¸Šé¢çš„ä»‹ç»ï¼Œå¯ä»¥çœ‹åˆ°ä¸¤è€…èµ·åˆ°çš„ä½œç”¨æ˜¯ç›¸åŒçš„ï¼ŒæŠŠä¸åŒå°ºå¯¸çš„ç‰¹å¾è¾“å…¥è½¬åŒ–ä¸ºç›¸åŒå°ºå¯¸çš„ç‰¹å¾è¾“å‡ºã€‚SPPé’ˆå¯¹åŒä¸€ä¸ªè¾“å…¥ä½¿ç”¨äº†å¤šä¸ªä¸åŒå°ºå¯¸çš„æ± åŒ–æ“ä½œï¼ŒæŠŠä¸åŒå°ºåº¦çš„ç»“æœæ‹¼æ¥ä½œä¸ºè¾“å‡ºï¼›è€ŒROI Poolingå¯çœ‹ä½œå•å°ºåº¦çš„SPPï¼Œå¯¹äºä¸€ä¸ªè¾“å…¥åªè¿›è¡Œä¸€æ¬¡æ± åŒ–æ“ä½œå¯ä»¥çœ‹å‡ºFast RCNNä¸»è¦æœ‰3ä¸ªæ”¹è¿›ï¼šå·ç§¯ä¸å†æ˜¯å¯¹æ¯ä¸ªregion proposalè¿›è¡Œï¼Œè€Œæ˜¯ç›´æ¥å¯¹æ•´å¼ å›¾åƒï¼Œè¿™æ ·å‡å°‘äº†å¾ˆå¤šé‡å¤è®¡ç®—ã€‚åŸæ¥RCNNæ˜¯å¯¹æ¯ä¸ªregion proposalåˆ†åˆ«åšå·ç§¯ï¼Œå› ä¸ºä¸€å¼ å›¾åƒä¸­æœ‰2000å·¦å³çš„region proposalï¼Œè‚¯å®šç›¸äº’ä¹‹é—´çš„é‡å ç‡å¾ˆé«˜ï¼Œå› æ­¤äº§ç”Ÿé‡å¤è®¡ç®—ç”¨ROI poolingè¿›è¡Œç‰¹å¾çš„å°ºå¯¸å˜æ¢ï¼Œå› ä¸ºå…¨è¿æ¥å±‚çš„è¾“å…¥è¦æ±‚å°ºå¯¸å¤§å°ä¸€æ ·ï¼Œå› æ­¤ä¸èƒ½ç›´æ¥æŠŠregion proposalä½œä¸ºè¾“å…¥å°†regressoræ”¾è¿›ç½‘ç»œä¸€èµ·è®­ç»ƒï¼Œæ¯ä¸ªç±»åˆ«å¯¹åº”ä¸€ä¸ªregressorï¼ŒåŒæ—¶ç”¨softmaxä»£æ›¿åŸæ¥çš„SVMåˆ†ç±»å™¨åœ¨å®é™…è®­ç»ƒä¸­ï¼Œæ¯ä¸ªmini-batchåŒ…å«2å¼ å›¾åƒå’Œ128ä¸ªregion proposalï¼ˆæˆ–è€…å«ROIï¼‰ï¼Œä¹Ÿå°±æ˜¯æ¯å¼ å›¾åƒæœ‰64ä¸ªROIã€‚ç„¶åä»è¿™äº›ROIä¸­æŒ‘é€‰çº¦25%çš„ROIï¼Œè¿™äº›ROIå’Œground truthçš„IOUå€¼éƒ½å¤§äº0.5ã€‚å¦å¤–åªé‡‡ç”¨éšæœºæ°´å¹³ç¿»è½¬çš„æ–¹å¼å¢åŠ æ•°æ®é›†æµ‹è¯•çš„æ—¶å€™åˆ™æ¯å¼ å›¾åƒå¤§çº¦2000ä¸ªROIæ€»ç»“ï¼šFast RCNNå°†RCNNä¼—å¤šæ­¥éª¤æ•´åˆåœ¨ä¸€èµ·ï¼Œä¸ä»…å¤§å¤§æé«˜äº†æ£€æµ‹é€Ÿåº¦ï¼Œä¹Ÿæé«˜äº†æ£€æµ‹å‡†ç¡®ç‡ã€‚å…¶ä¸­ï¼Œå¯¹æ•´å¼ å›¾åƒå·ç§¯è€Œä¸æ˜¯å¯¹æ¯ä¸ªregion proposalå·ç§¯ï¼ŒROI Poolingï¼Œåˆ†ç±»å’Œå›å½’éƒ½æ”¾åœ¨ç½‘ç»œä¸€èµ·è®­ç»ƒçš„multi-task lossæ˜¯ç®—æ³•çš„ä¸‰ä¸ªæ ¸å¿ƒã€‚å¦å¤–è¿˜æœ‰SVDåˆ†è§£ç­‰æ˜¯åŠ é€Ÿçš„å°è´¡çŒ®ï¼Œæ•°æ®é›†çš„å¢åŠ æ—¶mAPæé«˜çš„å°è´¡çŒ®å½“ç„¶Fast RCNNçš„ä¸»è¦ç¼ºç‚¹åœ¨äºregion proposalçš„æå–ä½¿ç”¨selective searchï¼Œç›®æ ‡æ£€æµ‹æ—¶é—´å¤§å¤šæ¶ˆè€—åœ¨è¿™ä¸Šé¢ï¼ˆæregion proposal 2~3sï¼Œè€Œæç‰¹å¾åˆ†ç±»åªéœ€0.32sï¼‰ï¼Œè¿™ä¹Ÿæ˜¯åç»­Faster RCNNçš„æ”¹è¿›æ–¹å‘ä¹‹ä¸€ç¼ºç‚¹ï¼šä¾æ—§é‡‡ç”¨selective searchæå–region proposalï¼ˆè€—æ—¶2~3ç§’ï¼Œç‰¹å¾æå–è€—æ—¶0.32ç§’ï¼‰æ— æ³•æ»¡è¶³å®æ—¶åº”ç”¨ï¼Œæ²¡æœ‰çœŸæ­£å®ç°ç«¯åˆ°ç«¯è®­ç»ƒæµ‹è¯•åˆ©ç”¨äº†GPUï¼Œä½†æ˜¯region proposalæ–¹æ³•æ˜¯åœ¨CPUä¸Šå®ç°çš„æ€»ç»“RCNN:ç»™å®šä¸€å¼ è¾“å…¥å›¾ç‰‡ï¼Œé€šè¿‡ Selective Searchä»å›¾ç‰‡ä¸­æå– 2000 ä¸ªç±»åˆ«ç‹¬ç«‹çš„å€™é€‰åŒºåŸŸå¯¹äºæ¯ä¸ªåŒºåŸŸåˆ©ç”¨ CNN æŠ½å–ä¸€ä¸ªå›ºå®šé•¿åº¦çš„ç‰¹å¾å‘é‡å¯¹æ¯ä¸ªç‰¹å¾å‘é‡åˆ©ç”¨ SVM è¿›è¡Œç›®æ ‡åˆ†ç±»å¯¹äºSVMåˆ†å¥½ç±»çš„Region Proposalåšè¾¹æ¡†å›å½’ï¼Œç”¨Bounding boxå›å½’å€¼æ ¡æ­£åŸæ¥çš„å»ºè®®çª—å£ï¼Œç”Ÿæˆé¢„æµ‹çª—å£åæ ‡ç¼ºç‚¹ï¼šé‡å¤è®¡ç®—ï¼Œæ¯ä¸ªregion proposalï¼Œéƒ½éœ€è¦ç»è¿‡ä¸€ä¸ªAlexNetç‰¹å¾æå–selective searchæ–¹æ³•ç”Ÿæˆregion proposalï¼Œå¯¹ä¸€å¸§å›¾åƒï¼Œéœ€è¦èŠ±è´¹2ç§’ä¸‰ä¸ªæ¨¡å—(æå–ã€åˆ†ç±»ã€å›å½’)æ˜¯åˆ†åˆ«è®­ç»ƒçš„ï¼Œå¹¶ä¸”åœ¨è®­ç»ƒæ—¶å€™ï¼Œå¯¹äºå­˜å‚¨ç©ºé—´æ¶ˆè€—è¾ƒå¤§è®­ç»ƒåˆ†ä¸ºå¤šä¸ªé˜¶æ®µï¼Œæ­¥éª¤ç¹çï¼šå¾®è°ƒç½‘ç»œ+è®­ç»ƒSVM+è®­ç»ƒè¾¹æ¡†å›å½’å™¨SVMå’Œå›å½’æ˜¯äº‹åæ“ä½œï¼Œåœ¨SVMå’Œå›å½’è¿‡ç¨‹ä¸­CNNç‰¹å¾æ²¡æœ‰è¢«å­¦ä¹ æ›´æ–°SPPNet: é‡‘å­—å¡”æ± åŒ–å±‚å½“ç½‘ç»œè¾“å…¥çš„æ˜¯ä¸€å¼ ä»»æ„å¤§å°çš„å›¾ç‰‡ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥ä¸€ç›´è¿›è¡Œå·ç§¯ã€æ± åŒ–ï¼Œç›´åˆ°ç½‘ç»œçš„å€’æ•°å‡ å±‚çš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å³å°†ä¸å…¨è¿æ¥å±‚è¿æ¥çš„æ—¶å€™ï¼Œå°±è¦ä½¿ç”¨é‡‘å­—å¡”æ± åŒ–ï¼Œä½¿å¾—ä»»æ„å¤§å°çš„ç‰¹å¾å›¾éƒ½èƒ½å¤Ÿè½¬æ¢æˆå›ºå®šå¤§å°çš„ç‰¹å¾å‘é‡ï¼Œè¿™å°±æ˜¯ç©ºé—´é‡‘å­—å¡”æ± åŒ–çš„æ„ä¹‰ï¼ˆå¤šå°ºåº¦ç‰¹å¾æå–å‡ºå›ºå®šå¤§å°çš„ç‰¹å¾å‘é‡ï¼‰é¦–å…ˆé€šè¿‡é€‰æ‹©æ€§æœç´¢ï¼Œå¯¹å¾…æ£€æµ‹çš„å›¾ç‰‡è¿›è¡Œæœç´¢å‡º2000ä¸ªå€™é€‰çª—å£ã€‚è¿™ä¸€æ­¥å’ŒR-CNNä¸€æ ·ç‰¹å¾æå–é˜¶æ®µ,æŠŠæ•´å¼ å¾…æ£€æµ‹çš„å›¾ç‰‡ï¼Œè¾“å…¥CNNä¸­ï¼Œè¿›è¡Œä¸€æ¬¡æ€§ç‰¹å¾æå–ï¼Œå¾—åˆ°feature mapsï¼Œç„¶ååœ¨feature mapsä¸­æ‰¾åˆ°å„ä¸ªå€™é€‰æ¡†çš„åŒºåŸŸï¼Œå†å¯¹å„ä¸ªå€™é€‰æ¡†é‡‡ç”¨é‡‘å­—å¡”ç©ºé—´æ± åŒ–ï¼Œæå–å‡ºå›ºå®šé•¿åº¦çš„ç‰¹å¾å‘é‡ï¼Œåªéœ€è¦ä¸€æ¬¡å¯¹æ•´å¼ å›¾ç‰‡è¿›è¡Œç‰¹å¾æå–ï¼Œé€Ÿåº¦ä¼šå¤§å¤§æå‡æœ€åä¸€æ­¥ä¹Ÿæ˜¯å’ŒR-CNNä¸€æ ·ï¼Œé‡‡ç”¨SVMç®—æ³•è¿›è¡Œç‰¹å¾å‘é‡åˆ†ç±»è¯†åˆ«Fast-RCNN:ç»™å®šä¸€å¼ è¾“å…¥å›¾ç‰‡ï¼Œé€šè¿‡ Selective Searchä»å›¾ç‰‡ä¸­æå– 2000 ä¸ªç±»åˆ«ç‹¬ç«‹çš„å€™é€‰åŒºåŸŸå¯¹æ¯ä¸ªç±»åˆ«éƒ½è®­ç»ƒä¸€ä¸ªå›å½’å™¨ï¼Œä¸”åªæœ‰éèƒŒæ™¯çš„region proposalæ‰éœ€è¦è¿›è¡Œå›å½’ã€‚ROI poolingï¼šROI Poolingçš„ä½œç”¨æ˜¯å¯¹ä¸åŒå¤§å°çš„region proposalï¼Œä»æœ€åå·ç§¯å±‚è¾“å‡ºçš„feature mapæå–å¤§å°å›ºå®šçš„feature mapã€‚ç®€å•è®²å¯ä»¥çœ‹åšæ˜¯SPPNetçš„ç®€åŒ–ç‰ˆæœ¬(æŠŠå›¾ç‰‡ä¸Šselective searché€‰å‡ºçš„å€™é€‰æ¡†æ˜ å°„åˆ°ç‰¹å¾å›¾ä¸Šå¯¹åº”çš„ä½ç½®ï¼Œè¿™ä¸ªæ˜ å°„æ˜¯æ ¹æ®è¾“å…¥å›¾ç‰‡ç¼©å°çš„å°ºå¯¸æ¥çš„)ï¼Œå› ä¸ºå…¨è¿æ¥å±‚çš„è¾“å…¥éœ€è¦å°ºå¯¸å¤§å°ä¸€æ ·ï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥å°†ä¸åŒå¤§å°çš„region proposalæ˜ å°„åˆ°feature mapä½œä¸ºè¾“å‡ºï¼Œéœ€è¦åšå°ºå¯¸å˜æ¢ä¸¤ä¸ªlossï¼šç¬¬ä¸€ä¸ªä¼˜åŒ–ç›®æ ‡æ˜¯åˆ†ç±»ï¼Œä½¿ç”¨softmaxï¼ˆå°±ä¸ç”¨åƒå‰é¢çš„R-CNNå’ŒSPPå†ç”¨SVMäº†ï¼‰ï¼Œç¬¬äºŒä¸ªä¼˜åŒ–ç›®æ ‡æ˜¯bbox regressionï¼Œä½¿ç”¨äº†ä¸€ä¸ªå¹³æ»‘çš„L1-lossä¼˜ç‚¹å·ç§¯ä¸å†æ˜¯å¯¹æ¯ä¸ªregion proposalè¿›è¡Œï¼Œè€Œæ˜¯ç›´æ¥å¯¹æ•´å¼ å›¾åƒï¼Œè¿™æ ·å‡å°‘äº†å¾ˆå¤šé‡å¤è®¡ç®—ç”¨ROI poolingè¿›è¡Œç‰¹å¾çš„å°ºå¯¸å˜æ¢ï¼Œå› ä¸ºå…¨è¿æ¥å±‚çš„è¾“å…¥è¦æ±‚å°ºå¯¸å¤§å°ä¸€æ ·å°†regressoræ”¾è¿›ç½‘ç»œä¸€èµ·è®­ç»ƒï¼Œæ¯ä¸ªç±»åˆ«å¯¹åº”ä¸€ä¸ªregressorï¼ŒåŒæ—¶ç”¨softmaxä»£æ›¿åŸæ¥çš„SVMåˆ†ç±»å™¨ ä¸‰ä¸ªæ ¸å¿ƒï¼šå¯¹æ•´å¼ å›¾åƒå·ç§¯ã€ROI Poolingã€åˆ†ç±»å’Œå›å½’ä¸€èµ·è®­ç»ƒçš„multi-task loss ä¸»è¦ç¼ºç‚¹åœ¨äºregion proposalçš„æå–ä½¿ç”¨selective searchï¼Œç›®æ ‡æ£€æµ‹æ—¶é—´å¤§å¤šæ¶ˆè€—åœ¨è¿™ä¸Šé¢ç›¸æ¯”R-CNNï¼Œä¸»è¦ä¸¤å¤„ä¸åŒï¼šæœ€åä¸€å±‚å·ç§¯å±‚ååŠ äº†ä¸€ä¸ªROI pooling layerï¼›æŸå¤±å‡½æ•°ä½¿ç”¨äº†å¤šä»»åŠ¡æŸå¤±å‡½æ•°(multi-task loss)ï¼Œå°†è¾¹æ¡†å›å½’ç›´æ¥åŠ å…¥åˆ°CNNç½‘ç»œä¸­è®­ç»ƒfaster-rcnnæ¨èè¿™ç¯‡æ–‡ç« -Object Detection and Classification using R-CNNsFaster R-CNNï¼šæå‡ºäº†RPN(region proposal network)ä¸»è¦å°±æ˜¯å¤šäº†ä¸€ä¸ªRPN(region proposal network)ï¼Œå°±æ˜¯åœ¨å·ç§¯æå–ç‰¹å¾ä¹‹åï¼Œå¤šå‡ºä¸€æ¡è·¯æ¥è¿›è¡Œå€™é€‰æ¡†çš„æå–æ¨èæœ‰å…³RPNå±‚çš„æ–‡ç« ï¼šRPNå±‚è§£æRPNåªæ˜¯å°†æ¡†å†…è®¤ä¸ºæ˜¯ç›®æ ‡ï¼Œæ¡†å¤–è®¤ä¸ºæ˜¯èƒŒæ™¯ï¼Œåšäº†ä¸ªäºŒåˆ†ç±»ï¼Œè‡³äºæ¡†å†…ç›®æ ‡å…·ä½“æ˜¯å•¥ï¼Œæœ€ç»ˆæ˜¯äº¤ç»™åˆ†ç±»ç½‘ç»œå»åšä¸‹å›¾æ¥è‡ªFaster-RCNNï¼ˆäºŒï¼‰ä¹‹RPNå±‚Faster-RCNN: RPN(region proposal network)ï¼Œå°±æ˜¯åœ¨å·ç§¯æå–ç‰¹å¾ä¹‹åï¼Œå¤šå‡ºä¸€æ¡è·¯æ¥è¿›è¡Œå€™é€‰æ¡†çš„æå–å°†æ•´å¼ å›¾ç‰‡è¾“å…¥CNNï¼Œè¿›è¡Œç‰¹å¾æå–ç”¨RPNç”Ÿæˆå»ºè®®çª—å£(proposals)ï¼Œæ¯å¼ å›¾ç‰‡ç”Ÿæˆ300ä¸ªå»ºè®®çª—å£é€šè¿‡RoI poolingå±‚ä½¿æ¯ä¸ªRoIç”Ÿæˆå›ºå®šå°ºå¯¸çš„feature mapåˆ©ç”¨Softmax Loss(æ¢æµ‹åˆ†ç±»æ¦‚ç‡) å’ŒSmooth L1 Loss(æ¢æµ‹è¾¹æ¡†å›å½’)å¯¹åˆ†ç±»æ¦‚ç‡å’Œè¾¹æ¡†å›å½’(Bounding box regression)è”åˆè®­ç»ƒç›¸æ¯”Fast R-CNNï¼Œä¸»è¦ä¸¤å¤„ä¸åŒï¼šä½¿ç”¨RPN(Region Proposal Network)ä»£æ›¿åŸæ¥çš„Selective Searchæ–¹æ³•äº§ç”Ÿå»ºè®®çª—å£ï¼›äº§ç”Ÿå»ºè®®çª—å£çš„CNNå’Œç›®æ ‡æ£€æµ‹çš„CNNå…±äº«å¦‚ä½•é«˜æ•ˆå¿«é€Ÿäº§ç”Ÿå»ºè®®æ¡†ï¼ŸFaster R-CNNåˆ›é€ æ€§åœ°é‡‡ç”¨å·ç§¯ç½‘ç»œè‡ªè¡Œäº§ç”Ÿå»ºè®®æ¡†ï¼Œå¹¶ä¸”å’Œç›®æ ‡æ£€æµ‹ç½‘ç»œå…±äº«å·ç§¯ç½‘ç»œï¼Œä½¿å¾—å»ºè®®æ¡†æ•°ç›®ä»åŸæœ‰çš„çº¦2000ä¸ªå‡å°‘ä¸º300ä¸ªï¼Œä¸”å»ºè®®æ¡†çš„è´¨é‡ä¹Ÿæœ‰æœ¬è´¨çš„æé«˜Yoloç³»åˆ—Yolov1ç½‘ç»œç»“æ„YOLO_v1è®²è§£æµ…è°ˆä¸åŒç‰ˆæœ¬YOLOçš„åŒºåˆ«ï¼ˆV1-V3ï¼‰è¾“å‡ºå±‚$7 \times 7 \times 30$çš„å«ä¹‰$7 \times 7$æŠŠåŸå›¾å¹³å‡åˆ†æˆ49ä¸ªç½‘æ ¼ï¼Œæ¯ä¸ªç½‘æ ¼å…è®¸é¢„æµ‹å‡º2ä¸ªè¾¹æ¡†ï¼Œæ€»å…± 49*2=98 ä¸ªbounding boxã€‚å¯ä»¥ç†è§£ä¸º98ä¸ªå€™é€‰åŒºï¼Œå®ƒä»¬å¾ˆç²—ç•¥çš„è¦†ç›–äº†å›¾ç‰‡çš„æ•´ä¸ªåŒºåŸŸ30ä»£è¡¨20ä¸ªç±»åˆ«çš„æ¡ä»¶æ¦‚ç‡å’Œä¸¤ä¸ªboundingboxçš„äº”ä¸ªå‚æ•°ï¼ˆä¸­å¿ƒåæ ‡xï¼Œyï¼Œæ¡†çš„å®½å’Œé«˜ï¼Œç½®ä¿¡åº¦ï¼‰æ¯ä¸ªcellåªèƒ½é¢„æµ‹ä¸€ä¸ªç±»åˆ«ï¼Œå¹¶ä¸”æ— æ³•è§£å†³ç‰©ä½“é‡å çš„é—®é¢˜ï¼Œæ­¤å¤–ï¼ŒYOLOV1å¯¹å°ç‰©ä½“çš„æ£€æµ‹æ•ˆæœä¹Ÿä¸ç†æƒ³lossæœ€æ ¸å¿ƒçš„lossè¯¦è§£å¯ä»¥è®¤ä¸ºYoloç³»åˆ—é‡Œæœ€æ ¸å¿ƒçš„å°±æ˜¯lossçš„è®¾è®¡ï¼Œç†è§£YOLOv1çš„æŸå¤±å‡½æ•°å¯ä»¥å¯¹åç»­çš„YOLOç³»åˆ—æœ‰ä¸€å®šçš„å¸®åŠ©å› ä¸ºåç»­çš„YOLOç‰ˆæœ¬åœ¨æŸå¤±å‡½æ•°è®¾è®¡ä¸Šæœ‰æ‰€æ”¹è¿›ï¼Œä½†ä»ç„¶ä¿ç•™äº†ä¸€äº›åŸºæœ¬çš„æ€æƒ³å’ŒåŸåˆ™å…ˆçœ‹æ¥ä»¥ä¸‹lossçš„è®¡ç®—å…¬å¼è¿™é‡Œçš„lossåˆ†æˆäº†äº”ä¸ªéƒ¨åˆ†ï¼šå«ç›®æ ‡çš„xy: å«æœ‰ç‰©ä½“ä¸­å¿ƒç‚¹çš„cellé‡Œï¼Œè´Ÿè´£é¢„æµ‹çš„bboxé¢„æµ‹å‡ºçš„xyçš„MSEå«ç›®æ ‡çš„wh: å«æœ‰ç‰©ä½“ä¸­å¿ƒç‚¹çš„cellé‡Œï¼Œè´Ÿè´£é¢„æµ‹çš„bboxé¢„æµ‹å‡ºçš„whçš„MSEå«ç›®æ ‡çš„ç½®ä¿¡åº¦: å«æœ‰ç‰©ä½“ä¸­å¿ƒç‚¹çš„cellé‡Œï¼Œè´Ÿè´£é¢„æµ‹çš„bboxé¢„æµ‹å‡ºçš„å­˜åœ¨ç‰©ä½“çš„ç½®ä¿¡åº¦çš„è¯¯å·®ä¸å«ç›®æ ‡çš„ç½®ä¿¡åº¦: ä¸å«æœ‰ç‰©ä½“ä¸­å¿ƒç‚¹çš„cellé‡Œï¼Œæ¯ä¸€ä¸ªbboxéƒ½è¦å‚ä¸åˆ°lossçš„è®¡ç®—ï¼Œ$Ci=0$ï¼›$\hat{C}{i}$=bboxçš„é¢„æµ‹å€¼ï¼Œç„¶åç´¯åŠ MSEå«ç›®æ ‡çš„åˆ†ç±»æŸå¤±: å«æœ‰ç‰©ä½“ä¸­å¿ƒç‚¹çš„cellé‡Œï¼Œé¢„æµ‹å‡ºçš„ç‰©ä½“ç±»åˆ«å‘é‡å’ŒGTå¯¹åº”çš„å‘é‡çš„MSEä¸å«ç›®æ ‡çš„losså½“cellä¸­ä¸åŒ…å«ç‰©ä½“çš„ä¸­å¿ƒç‚¹ï¼Œé‚£è¿™ä¸ªcellçš„bboxé¢„æµ‹å‡ºç‰©ä½“çš„ç½®ä¿¡åº¦å°±è¦è¶‹è¿‘äº0Aæ­¥éª¤ï¼šYoloå¯¹è¾“å…¥å›¾åƒå‰å‘ä¼ æ’­çš„è¾“å‡ºå¼ é‡ï¼Œä¸‹é¢æ˜¯è¯¥å›¾çš„ç›®æ ‡å¼ é‡Bæ­¥éª¤ï¼šä¹˜ä»¥ä¸å«ç‰©ä½“ä¸­å¿ƒç‚¹çš„cellçš„æ©ç ï¼Œç›¸å½“äºåªç•™ä¸‹æ— ç›®æ ‡çš„cellCæ­¥éª¤ï¼šæŒ–å»äº†ä¸‰ä¸ªæ´(å»é™¤äº†3ä¸ªå«æœ‰ç‰©ä½“ä¸­å¿ƒç‚¹çš„cellçš„æ•°æ®)Dæ­¥éª¤ï¼šä¸€å…±49ä¸ªæ ¼å­ï¼ŒæŒ–å»3ä¸ªå‰©46ï¼ŒB=2ï¼Œå› æ­¤æ‹‰ç›´çš„å‘é‡é•¿åº¦ä¸º92Eæ­¥éª¤ï¼šè®¡ç®—MSEï¼Œè¿™é‡Œå¯¹åº”å…¬å¼ä¸­çš„ç¬¬4éƒ¨åˆ†å«ç›®æ ‡çš„losså¦‚æœæœ‰ç‰©ä½“ï¼Œé¢„æµ‹æ­£ç¡®ç±»åˆ«è¯¯å·®å°±ç­‰äº0Aæ­¥éª¤ï¼šYoloå¯¹è¾“å…¥å›¾åƒå‰å‘ä¼ æ’­çš„è¾“å‡ºå¼ é‡ï¼Œä¸‹é¢æ˜¯è¯¥å›¾çš„ç›®æ ‡å¼ é‡Bæ­¥éª¤ï¼šä¹˜ä»¥å«ç‰©ä½“ä¸­å¿ƒç‚¹çš„cellçš„æ©ç ï¼Œï¼Œç›¸å½“äºåªç•™ä¸‹å«ç›®æ ‡çš„cellCæ­¥éª¤ï¼šåªç•™ä¸‹ä¸‰ä¸ªå‘é‡(3ä¸ªå«æœ‰ç‰©ä½“ä¸­å¿ƒç‚¹çš„cellçš„æ•°æ®)Dæ­¥éª¤ï¼šå‘é‡åˆå¹¶Eæ­¥éª¤ï¼šæå–å‡ºç±»åˆ«çš„å‘é‡Fæ­¥éª¤ï¼šè®¡ç®—MSEï¼Œè¿™é‡Œå¯¹åº”å…¬å¼ä¸­çš„ç¬¬5éƒ¨åˆ†Gæ­¥éª¤ï¼šæå–å‡ºxywhå’Œç½®ä¿¡åº¦çš„å‘é‡ï¼Œå‘é‡åˆå¹¶Hæ­¥éª¤ï¼šæ¯ä¸€ä¸ªcellä¼šæœ‰2ä¸ªbboxï¼Œè®¡ç®—æ¯ä¸ªbboxä¸ground truthçš„IOUï¼Œç„¶åå¾—åˆ°ç´¢å¼•çŸ©é˜µ(å¯ä»¥ç”¨æ¥ç¡®å®šå“ªä¸ªbboxæ¥å¤„ç†è¿™ä¸ªcell)Iæ­¥éª¤ï¼šæå–å‡ºæœ‰è´£ä»»çš„bboxçš„å‘é‡Jæ­¥éª¤ï¼šbboxé¢„æµ‹å‡ºçš„xyä¸GTç®—MSEï¼Œå¯¹åº”å…¬å¼ä¸­çš„ç¬¬1éƒ¨åˆ†ï¼›bboxé¢„æµ‹å‡ºçš„whä¸GTç®—MSEï¼Œå¯¹åº”å…¬å¼ä¸­çš„ç¬¬2éƒ¨åˆ†Kæ­¥éª¤ï¼šbboxé¢„æµ‹å‡ºçš„ç½®ä¿¡åº¦ä¸GTç®—MSEï¼Œå¯¹åº”å…¬å¼ä¸­çš„ç¬¬3éƒ¨åˆ†æµ‹è¯•é˜¶æ®µè¾“å…¥å›¾åƒï¼Œç»è¿‡YOLOç½‘ç»œåï¼Œè¾“å‡º$ 7 \times 7 \times (2 \times 5 + 20 )$çš„å¼ é‡è®¡ç®—æ¯ä¸ªbboxçš„ç±»åˆ«å¾—åˆ†ä»æ¯ä¸€ä¸ªcellä¸­æ‰¾å‡º20ä¸ªç±»åˆ«scoreä¸­æœ€å¤§çš„ç±»åˆ«ï¼Œä½œä¸ºcellä¸­ä¸¤boxé¢„æµ‹å‡ºçš„ç±»åˆ«é’ˆå¯¹æ¯ä¸€ä¸ªcellä¸­çš„ä¸¤ä¸ªbboxï¼Œé€‰æ‹©ç½®ä¿¡åº¦å¤§çš„boxæ¥ä»£è¡¨è¿™ä¸ªcellï¼Œå¹¶è®¡ç®—å‡ºboxçš„ç±»åˆ«å¾—åˆ†å‰©ä¸‹49ä¸ªbboxï¼Œæœ€åè¿›è¡ŒNMSYolov2(Yolo9000)YOLOç®—æ³•ä¹‹YOLOv2ç²¾è®²ç›¸æ¯”è¾ƒäºYolov1ä¸»è¦æ”¹è¿›ç‚¹ï¼šç½‘ç»œæ”¹è¿›ï¼šä½¿ç”¨DarckNet19ä»£æ›¿äº†YOLOv1çš„GoogLeNetç½‘ç»œï¼Œè¿™é‡Œä¸»è¦æ”¹è¿›æ˜¯å»æ‰äº†å…¨è¿æ¥å±‚ï¼Œç”¨å·ç§¯å’Œsoftmaxè¿›è¡Œä»£æ›¿åŠ å…¥BNï¼šä½¿ç”¨Batch Normalizationå¯¹ç½‘ç»œè¿›è¡Œä¼˜åŒ–ï¼Œè®©ç½‘ç»œæé«˜äº†æ”¶æ•›æ€§ï¼ŒåŒæ—¶è¿˜æ¶ˆé™¤äº†å¯¹å…¶ä»–å½¢å¼çš„æ­£åˆ™åŒ–(regularization)çš„ä¾èµ–HighResolution Classifierï¼šæ–°çš„YOLOç½‘ç»œæŠŠåˆ†è¾¨ç‡ç›´æ¥æå‡åˆ°äº†$448 \times 448$ï¼Œè¿™ä¹Ÿæ„å‘³ç€åŸæœ‰çš„ç½‘ç»œæ¨¡å‹å¿…é¡»è¿›è¡ŒæŸç§è°ƒæ•´ä»¥é€‚åº”æ–°çš„åˆ†è¾¨ç‡è¾“å…¥ï¼ŒmAPè·å¾—äº†4%çš„æå‡Multi-ScaleTrainingï¼šè®©ç½‘ç»œåœ¨ä¸åŒçš„è¾“å…¥å°ºå¯¸ä¸Šéƒ½èƒ½è¾¾åˆ°ä¸€ä¸ªå¾ˆå¥½çš„é¢„æµ‹æ•ˆæœï¼ŒåŒä¸€ç½‘ç»œèƒ½åœ¨ä¸åŒåˆ†è¾¨ç‡ä¸Šè¿›è¡Œæ£€æµ‹ã€‚å½“è¾“å…¥å›¾ç‰‡å°ºå¯¸æ¯”è¾ƒå°çš„æ—¶å€™è·‘çš„æ¯”è¾ƒå¿«ï¼Œè¾“å…¥å›¾ç‰‡å°ºå¯¸æ¯”è¾ƒå¤§çš„æ—¶å€™ç²¾åº¦é«˜Anchoræœºåˆ¶ï¼šAnchoré¦–å…ˆè¦é¢„è®¾å¥½å‡ ä¸ªè™šæ‹Ÿæ¡†ï¼Œåœ¨ç”¨å›å½’çš„æ–¹æ³•ç¡®å®šæœ€ç»ˆçš„é¢„æµ‹æ¡†ï¼Œåœ¨YOLOv2ä¸­ï¼Œä½¿ç”¨K-meansç®—æ³•æ¥ç”ŸæˆAnchor bboxï¼Œå¦‚å›¾1æ‰€ç¤ºï¼Œå½“k=5æ—¶ï¼Œæ¨¡å‹çš„å¤æ‚åº¦ä¸å¬å›ç‡è¾¾åˆ°äº†ä¸€ä¸ªæ¯”è¾ƒå¥½çš„å¹³è¡¡ï¼Œæ‰€ä»¥YOLOv2ä½¿ç”¨äº†5ä¸ªAnchor bboxåˆ†ç±»ã€æ£€æµ‹è®­ç»ƒé›†è”åˆè®­ç»ƒï¼šè”åˆè®­ç»ƒæ–¹æ³•æ€è·¯ç®€å•æ¸…æ™°ï¼ŒYolo v2ä¸­ç‰©ä½“çŸ©å½¢æ¡†ç”Ÿæˆï¼Œä¸ä¾èµ–äºç‰©ç†ç±»åˆ«é¢„æµ‹ï¼ŒäºŒè€…åŒæ—¶ç‹¬ç«‹è¿›è¡Œå½“è¾“å…¥æ˜¯æ£€æµ‹æ•°æ®é›†æ—¶ï¼Œæ ‡æ³¨ä¿¡æ¯æœ‰ç±»åˆ«ã€æœ‰ä½ç½®ï¼Œé‚£ä¹ˆå¯¹æ•´ä¸ªlosså‡½æ•°è®¡ç®—lossï¼Œè¿›è¡Œåå‘ä¼ æ’­å½“è¾“å…¥å›¾ç‰‡åªåŒ…å«åˆ†ç±»ä¿¡æ¯æ—¶ï¼Œlosså‡½æ•°åªè®¡ç®—åˆ†ç±»lossï¼Œå…¶ä½™éƒ¨åˆ†lossä¸ºé›¶å½“ç„¶ï¼Œä¸€èˆ¬çš„è®­ç»ƒç­–ç•¥ä¸ºï¼Œå…ˆåœ¨æ£€æµ‹æ•°æ®é›†ä¸Šè®­ç»ƒä¸€å®šçš„epochï¼Œå¾…é¢„æµ‹æ¡†çš„lossåŸºæœ¬ç¨³å®šåï¼Œå†è”åˆåˆ†ç±»æ•°æ®é›†ã€æ£€æµ‹æ•°æ®é›†è¿›è¡Œäº¤æ›¿è®­ç»ƒï¼ŒåŒæ—¶ä¸ºäº†åˆ†ç±»ã€æ£€æµ‹æ•°æ®é‡å¹³è¡¡ï¼Œä½œè€…å¯¹cocoæ•°æ®é›†è¿›è¡Œäº†ä¸Šé‡‡æ ·ï¼Œä½¿å¾—cocoæ•°æ®æ€»æ•°å’ŒImageNetå¤§è‡´ç›¸åŒè¾“å‡ºå’ŒYolov1æ¯”è¾ƒå¦‚ä¸‹YOLOv1æ˜¯çš„è¾“å‡º$7 \times 7 \times 30$çš„å¤šç»´å‘é‡ï¼Œå…¶ä¸­$7 \times 7$æ˜¯åˆ†è¾¨ç‡ï¼Œå¯¹åŸå›¾è¿›è¡Œäº†$7 \times 7$çš„åˆ†å‰²ï¼Œæ¯ä¸ªç½‘æ ¼å¯¹åº”ä¸€ä¸ªåŒ…å«30ä¸ªå‚æ•°çš„å‘é‡ï¼Œæ¯ä¸ªå‘é‡ä¸­åŒ…å«ä¸¤ä¸ªbboxï¼Œæ¯ä¸ªbboxä¸­åŒ…å«5ä¸ªå‘é‡ï¼Œåˆ†åˆ«æ˜¯bboxçš„è´¨å¿ƒåæ ‡ï¼ˆx, yï¼‰å’Œbboxçš„é•¿å’Œå®½ï¼Œè¿˜æœ‰ä¸€ä¸ªbboxçš„ç½®ä¿¡åº¦ï¼Œå‰©ä¸‹20ä¸ªåˆ™æ˜¯ç±»åˆ«æ¦‚ç‡YOLOv2è¾“å‡ºçš„æ˜¯$13 \times 13 \times 5 \times 25$çš„ä¸€ä¸ªå¤šç»´å‘é‡ï¼Œå…¶ä¸­$13 \times 13$æ˜¯åˆ†è¾¨ç‡ï¼Œä¹Ÿå°±æ˜¯è¯´ç½‘ç»œå°†è¾“å…¥å›¾ç‰‡åˆ†æˆäº†$13 \times 13$çš„ç½‘æ ¼ï¼Œæ¯ä¸€ä¸ªç½‘æ ¼å¯¹åº”ä¸€ä¸ªåŒ…å«$5 \times 25 =125 $ä¸ªå‚æ•°çš„ä¸€ç»´å‘é‡ï¼Œå…¶ä¸­5ä»£è¡¨5ä¸ªAnchor bboxï¼Œæ¯ä¸ªAnchor bboxä¸­åŒ…å«25ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯bboxçš„è´¨å¿ƒåæ ‡$(x,y)$å’Œbboxçš„é•¿å’Œå®½ï¼Œè¿˜æœ‰ä¸€ä¸ªbboxçš„ç½®ä¿¡åº¦ï¼Œå‰©ä¸‹20ä¸ªåˆ™æ˜¯ç±»åˆ«æ¦‚ç‡ã€‚è¿™æ ·çš„å¥½å¤„æ˜¯YOLOv2å¯ä»¥å¯¹ä¸€ä¸ªåŒºåŸŸè¿›è¡Œå¤šä¸ªæ ‡ç­¾çš„é¢„æµ‹ï¼Œæœ€ä¸»è¦çš„æ”¹å˜æ˜¯ï¼šbboxçš„å››ä¸ªä½ç½®å‚æ•°çš„æŸå¤±å‡½æ•°è®¡ç®—æ–¹æ³•å‘ç”Ÿäº†æ”¹å˜è®­ç»ƒä¸»è¦åŒ…æ‹¬ä»¥ä¸‹ä¸‰ä¸ªé˜¶æ®µï¼šå…ˆåœ¨ImageNetåˆ†ç±»æ•°æ®é›†ä¸Šé¢„è®­ç»ƒDarknet-19ï¼Œæ­¤æ—¶æ¨¡å‹è¾“å…¥$224 \times 224$ï¼Œå…±è®­ç»ƒ160ä¸ªepochsã€‚å°†ç½‘ç»œçš„è¾“å…¥è°ƒæ•´ä¸º$448 \times 448$ï¼Œç»§ç»­åœ¨ImageNetæ•°æ®é›†ä¸Šfinetuneåˆ†ç±»æ¨¡å‹ï¼Œè®­ç»ƒ10ä¸ªepochsï¼Œæ­¤æ—¶åˆ†ç±»æ¨¡å‹çš„top-1å‡†ç¡®åº¦ä¸º76.5%ï¼Œè€Œtop-5å‡†ç¡®åº¦ä¸º93.3%ã€‚ä¿®æ”¹Darknet-19åˆ†ç±»æ¨¡å‹ä¸ºæ£€æµ‹æ¨¡å‹ï¼šå³ç§»é™¤æœ€åä¸€ä¸ªå·ç§¯å±‚ã€global avg poolingå±‚ä»¥åŠsoftmaxå±‚ï¼Œå¹¶ä¸”æ–°å¢äº†ä¸‰ä¸ª$3 \times 3 \times 2014$å·ç§¯å±‚ï¼ŒåŒæ—¶å¢åŠ äº†ä¸€ä¸ªpassthroughå±‚ï¼Œæœ€åä½¿ç”¨$1 \times 1$å·ç§¯å±‚è¾“å‡ºé¢„æµ‹ç»“æœï¼Œå¹¶åœ¨æ£€æµ‹æ•°æ®é›†ä¸Šç»§ç»­finetuneç½‘ç»œyolov3ç¿æ™ºçš„ç›®æ ‡æ£€æµ‹26â€”â€”Pytorchæ­å»ºyolo3ç›®æ ‡æ£€æµ‹å¹³å°ä»ç‰¹å¾è·å–é¢„æµ‹ç»“æœçš„è¿‡ç¨‹å¯ä»¥åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œåˆ†åˆ«æ˜¯ï¼šæ„å»ºFPNç‰¹å¾é‡‘å­—å¡”è¿›è¡ŒåŠ å¼ºç‰¹å¾æå–åˆ©ç”¨Yolo Headå¯¹ä¸‰ä¸ªæœ‰æ•ˆç‰¹å¾å±‚è¿›è¡Œé¢„æµ‹åœ¨ç‰¹å¾åˆ©ç”¨éƒ¨åˆ†ï¼ŒYoloV3æå–å¤šç‰¹å¾å±‚è¿›è¡Œç›®æ ‡æ£€æµ‹ï¼Œä¸€å…±æå–ä¸‰ä¸ªç‰¹å¾å±‚ï¼Œä¸‰ä¸ªç‰¹å¾å±‚ä½äºä¸»å¹²éƒ¨åˆ†Darknet53çš„ä¸åŒä½ç½®ï¼Œåˆ†åˆ«ä½äºä¸­é—´å±‚ï¼Œä¸­ä¸‹å±‚ï¼Œåº•å±‚ä¸‰ä¸ªç‰¹å¾å±‚çš„shapeåˆ†åˆ«ä¸º(52,52,256)ã€(26,26,512)ã€(13,13,1024)è¾“å‡ºç»´åº¦è§£æç½‘ç»œæœ‰ä¸‰ä¸ªè¾“å‡ºï¼Œç»´åº¦åˆ†åˆ«ä¸º$bs \times 13 \times 13 \times 75$ã€$bs \times 26 \times 26 \times 75$å’Œ$bs \times 52 \times 52 \times 75$ï¼Œå…¶ä¸­75å¯ä»¥åˆ†è§£æˆ$3 \times (4+1+20)$3è¡¨ç¤ºä¸‰ä¸ªå€™é€‰æ¡†ï¼Œ4è¡¨ç¤ºçš„æ˜¯xywhçš„ä½ç½®ä¿¡æ¯ï¼Œ1è¡¨ç¤ºæ˜¯å¦ä¸ºèƒŒæ™¯ï¼Œ20ä¸ºç‰©ä½“çš„ç±»åˆ«æ•°(è¿™é‡Œç”¨çš„æ˜¯vocæ•°æ®é›†)å› ä¸ºæœ‰ä¸‰ä¸ªè¾“å‡ºï¼Œå› æ­¤è¯¥ç½‘ç»œæœ‰ä¸ª$13 \times 13 \times 3 + 26\times 26\times 3 + 52 \times 52\times 3 = 10647$é¢„æµ‹æ¡†å¯¹äºè¿™äº›é¢„æµ‹æ¡†ï¼Œå¦‚æœå…¶ä¸ä»»ä½•çœŸå®æ¡†çš„IoUå¤§äºä¸€å®šçš„é˜ˆå€¼ï¼ˆå¦‚0.5ï¼‰ï¼Œåˆ™å°†å…¶åˆ†é…ç»™å¯¹åº”çš„è¾“å‡ºå±‚ä½œä¸ºæ­£æ ·æœ¬ã€‚å¦åˆ™ï¼Œå°†å…¶è§†ä¸ºè´Ÿæ ·æœ¬YOLOv3 ä½¿ç”¨çš„æŸå¤±å‡½æ•°æ˜¯ç»„åˆäº†å¤šä¸ªéƒ¨åˆ†çš„ç»¼åˆæŸå¤±å‡½æ•°ï¼Œå…¶ä¸­åŒ…æ‹¬å®šä½æŸå¤±ï¼ˆLocalization Lossï¼‰ã€åˆ†ç±»æŸå¤±ï¼ˆClassification Lossï¼‰å’Œç½®ä¿¡åº¦æŸå¤±ï¼ˆConfidence Lossï¼‰åªæœ‰æ­£æ ·æœ¬æ‰æœ‰è¿™ä¸‰ç±»æŸå¤±ï¼Œè€Œè´Ÿæ ·æœ¬åªæœ‰ç½®ä¿¡åº¦æŸå¤±ä»¥ä¸‹æ˜¯ YOLOv3 çš„æŸå¤±å‡½æ•°çš„ä¼ªä»£ç å®ç°ï¼ŒåŒ…å«è¯¦ç»†æ³¨é‡Šï¼š12345678910111213141516171819202122232425262728293031def yolo_loss(pred_boxes, pred_cls, target_boxes, target_cls):    # pred_boxes: é¢„æµ‹çš„è¾¹ç•Œæ¡†åæ ‡ï¼Œshape ä¸º [batch_size, num_anchors, grid_size, grid_size, 4]    # pred_cls: é¢„æµ‹çš„ç±»åˆ«æ¦‚ç‡ï¼Œshape ä¸º [batch_size, num_anchors, grid_size, grid_size, num_classes]    # target_boxes: çœŸå®çš„è¾¹ç•Œæ¡†åæ ‡ï¼Œshape ä¸º [batch_size, num_anchors, grid_size, grid_size, 4]    # target_cls: çœŸå®çš„ç±»åˆ«æ ‡ç­¾ï¼Œshape ä¸º [batch_size, num_anchors, grid_size, grid_size, num_classes]        # è®¡ç®—é¢„æµ‹æ¡†å’ŒçœŸå®æ¡†çš„IoU    iou_scores = calculate_iou(pred_boxes, target_boxes)  # shape: [batch_size, num_anchors, grid_size, grid_size]        # è®¡ç®—ç±»åˆ«æŸå¤±ï¼Œä½¿ç”¨äº¤å‰ç†µæŸå¤±å‡½æ•°    cls_loss = cross_entropy_loss(pred_cls, target_cls)  # shape: [batch_size, num_anchors, grid_size, grid_size]        # è®¡ç®—è¾¹ç•Œæ¡†æŸå¤±ï¼Œä½¿ç”¨å¹³æ»‘L1æŸå¤±å‡½æ•°    box_loss = smooth_l1_loss(pred_boxes, target_boxes)  # shape: [batch_size, num_anchors, grid_size, grid_size]        # è®¡ç®—æ­£æ ·æœ¬çš„æ©ç ï¼Œå³ä¸çœŸå®æ¡†IoUå¤§äºé˜ˆå€¼çš„ä½ç½®ä¸º1ï¼Œå…¶ä½™ä¸º0    pos_mask = (iou_scores &gt; positive_iou_threshold).float()  # shape: [batch_size, num_anchors, grid_size, grid_size]        # è®¡ç®—è´Ÿæ ·æœ¬çš„æ©ç ï¼Œå³ä¸çœŸå®æ¡†IoUå°äºé˜ˆå€¼çš„ä½ç½®ä¸º1ï¼Œå…¶ä½™ä¸º0    neg_mask = (iou_scores &lt; negative_iou_threshold).float()  # shape: [batch_size, num_anchors, grid_size, grid_size]        # å°†æ­£æ ·æœ¬å’Œè´Ÿæ ·æœ¬çš„æ©ç ç›¸ä¹˜å¾—åˆ°æœ€ç»ˆçš„æ ·æœ¬æ©ç     sample_mask = pos_mask + neg_mask  # shape: [batch_size, num_anchors, grid_size, grid_size]        # å¯¹ç±»åˆ«æŸå¤±å’Œè¾¹ç•Œæ¡†æŸå¤±æŒ‰ç…§æ ·æœ¬æ©ç è¿›è¡ŒåŠ æƒæ±‚å’Œ    loss = lambda_cls * cls_loss * sample_mask + lambda_box * box_loss * sample_mask        # å¯¹æŸå¤±è¿›è¡Œå½’çº¦æ“ä½œï¼Œå–å¹³å‡æˆ–æ±‚å’Œ    loss = reduction_func(loss)  # å¯æ ¹æ®å®é™…æƒ…å†µé€‰æ‹©å¹³å‡æˆ–æ±‚å’Œ        return lossæ­£è´Ÿæ ·æœ¬æ•°åœ¨ YOLOv3 ä¸­ï¼Œé€šå¸¸ä¼šä¸ºæ¯ä¸ªç›®æ ‡é€‰æ‹©ä¸€ä¸ªæ­£æ ·æœ¬ï¼Œå³ä¸çœŸå®ç›®æ ‡æ¡†å…·æœ‰æœ€é«˜ IoU çš„é¢„æµ‹æ¡†ã€‚è¿™ç¡®ä¿äº†æ¯ä¸ªç›®æ ‡éƒ½æœ‰è‡³å°‘ä¸€ä¸ªæ­£æ ·æœ¬æ¥å‚ä¸æŸå¤±å‡½æ•°çš„è®¡ç®—å’Œç½‘ç»œçš„è®­ç»ƒã€‚è‡³äºè´Ÿæ ·æœ¬çš„é€‰æ‹©ï¼Œä¸€èˆ¬ä¼šè®¾ç½®ä¸€ä¸ªé˜ˆå€¼æ¥ç¡®å®šé¢„æµ‹æ¡†ä¸çœŸå®æ¡†ä¹‹é—´çš„ IoU é˜ˆå€¼ã€‚å¦‚æœé¢„æµ‹æ¡†çš„ IoU ä½äºè¯¥é˜ˆå€¼ï¼Œåˆ™è¢«è§†ä¸ºè´Ÿæ ·æœ¬ã€‚å¯¹äºæ¯ä¸ªè´Ÿæ ·æœ¬ï¼Œå¯ä»¥é€‰æ‹©ä¿ç•™ä¸€å®šæ•°é‡çš„è´Ÿæ ·æœ¬ï¼Œä»¥ç¡®ä¿æ­£è´Ÿæ ·æœ¬çš„å¹³è¡¡æ€§ã€‚å…·ä½“æ¥è¯´ï¼Œå…³äºæ­£è´Ÿæ ·æœ¬çš„é€‰æ‹©æ•°é‡å¹¶æ²¡æœ‰ä¸€ä¸ªå›ºå®šçš„æ ‡å‡†ï¼Œå®ƒå¯ä»¥æ ¹æ®å…·ä½“çš„æ•°æ®é›†å’Œåº”ç”¨åœºæ™¯æ¥ç¡®å®šã€‚åœ¨å®è·µä¸­ï¼Œå¯ä»¥æ ¹æ®æ•°æ®é›†çš„ç»Ÿè®¡ä¿¡æ¯å’Œè®­ç»ƒæ•ˆæœè¿›è¡Œè°ƒæ•´ï¼Œä»¥æ‰¾åˆ°ä¸€ä¸ªé€‚åˆçš„æ­£è´Ÿæ ·æœ¬æ¯”ä¾‹ï¼Œä»è€Œå¹³è¡¡ç›®æ ‡æ£€æµ‹çš„å‡†ç¡®æ€§å’Œæ•ˆç‡ã€‚yolov5Yolov8Yolov8 githubåœ°å€å’Œæ–‡æ¡£ç›®æ ‡æ£€æµ‹Modelsize (pixels)mAPval 50-95Speed CPU ONNX (ms)Speed A100 TensorRT (ms)params (M)FLOPs (B)YOLOv8n64037.380.40.993.28.7YOLOv8s64044.9128.41.2011.228.6YOLOv8m64050.2234.71.8325.978.9YOLOv8l64052.9375.22.3943.7165.2YOLOv8x64053.9479.13.5368.2257.8tensorRtåŠ é€Ÿå¯ä»¥ç”¨tensorRtåŠ é€Ÿï¼Œç¯å¢ƒæ•™ç¨‹å¯ä»¥å‚è€ƒè¿™ä¸ªæ–‡æ¡£è¿›è¡ŒtensortåŠ é€Ÿï¼Œcmakeç¼–è¯‘å¤±è´¥ï¼Œç¼ºå°‘zlibwapi.dllæ–‡ä»¶ï¼Œè§£å†³åŠæ³•ï¼Œå»cudnnå®˜ç½‘ä¸‹è½½zlib123dllx64libæ–‡ä»¶æ”¾åˆ°C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v11.1\libdllæ–‡ä»¶æ”¾åˆ°C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v11.1\binYoloV8æä¾›äº†å¯¼å‡ºå·¥å…·ï¼Œè¯¦è§æ–‡æ¡£ï¼Œpythonä»£ç å¯¼å‡ºå¯ä»¥è¿™æ ·å­å†™123def run():    model = YOLO(&quot;../../weights/yolov8s.pt&quot;)  # load an official detection model    model.export(format='engine', device='0', workspace=8, batch=4, dynamic=True)æˆ–è€…ç›´æ¥å‘½ä»¤è¡Œæ‰§è¡Œ1yolo mode=export model=yolov8s.pt format=engine device=0 workspace=8 batch=4 dynamic=Trueå…³é”®å‚æ•°å¦‚ä¸‹ï¼šdevice: å…¶ä¸­deviceå¿…é¡»æ˜¯GPUï¼Œå¯ä»¥æ˜¯å¤šå¼ æ˜¾å¡workspace: TensorRT: workspace size (GB)batch: æœ€å¤§æ‰¹æ¬¡å¤§å°ï¼Œå½“è®¾ç½®å‚æ•°æ—¶å¿…é¡»æœ‰dynamic=Trueï¼Œå¯ä»¥è¿è¡Œæœ€å¤§ä¸è¶…è¿‡batchçš„æ•°é‡dynamic: åŠ¨æ€å‚æ•°ï¼ŒONNX/TF/TensorRT: dynamic axesimgsz: image size as scalar or (h, w) list, i.e. (640, 480)æ³¨æ„äº‹é¡¹ï¼šTensorRTå‘å¸ƒçš„æ¨¡å‹(engine)ä¸èƒ½è·¨å¹³å°ä½¿ç”¨ä¾‹å¦‚linuxå‘å¸ƒçš„æ¨¡å‹ä¸èƒ½åœ¨windowsä¸‹ç”¨TensorRTå‘å¸ƒçš„æ¨¡å‹éœ€è¦åœ¨ç›¸åŒGPUç®—åŠ›(compute capability)çš„æƒ…å†µä¸‹ä½¿ç”¨å¦åˆ™ä¼šå¯¼è‡´compute capabilityä¸åŒ¹é…é—®é¢˜ï¼Œä¾‹å¦‚ç®—åŠ›6.1å‘å¸ƒçš„æ¨¡å‹ä¸èƒ½åœ¨7.5ä¸Šç”¨åŠ¨æ€batchå’ŒåŠ¨æ€å®½é«˜çš„å¤„ç†æ–¹å¼åŠ¨æ€batchï¼šæºè‡ªtensorRTç¼–è¯‘æ—¶å¯¹batchçš„å¤„ç†ï¼Œè‹¥é™æ€batchåˆ™æ„å‘³ç€æ— è®ºä½ å¤šå°‘å›¾ï¼Œéƒ½æŒ‰ç…§å›ºå®šå¤§å°batchæ¨ç†ï¼Œè€—æ—¶æ˜¯å›ºå®šçš„å¯¼å‡ºæ¨¡å‹æ—¶ï¼Œæ³¨æ„viewæ“ä½œä¸èƒ½å›ºå®šbatchç»´åº¦æ•°å€¼ï¼Œé€šå¸¸å†™-1å¯¼å‡ºæ¨¡å‹æ—¶ï¼Œé€šå¸¸å¯ä»¥æŒ‡å®šdynamic_axesï¼Œå®é™…ä¸Šä¸æŒ‡å®šä¹Ÿæ²¡å…³ç³»åŠ¨æ€å®½é«˜ï¼šæºè‡ªonnxå¯¼å‡ºæ—¶æŒ‡å®šçš„å®½é«˜æ˜¯å›ºå®šçš„ï¼Œtrtç¼–è¯‘æ—¶ä¹Ÿå¾—åˆ°å›ºå®šå¤§å°å¼•æ“ï¼Œæ­¤æ—¶è‹¥ä½ æƒ³å¾—åˆ°ä¸€ä¸ªä¸åŒå¤§å°çš„trtå¼•æ“æ—¶ï¼Œå°±éœ€è¦åŠ¨æ€å®½é«˜çš„å­˜åœ¨ã€‚è€Œä½¿ç”¨trtçš„åŠ¨æ€å®½é«˜ä¼šå¸¦æ¥å¤ªå¤šä¸å¿…è¦çš„å¤æ‚åº¦ï¼Œè¿™é‡Œä½¿ç”¨ä¸­é—´æ–¹æ¡ˆï¼Œç¼–è¯‘æ—¶ä¿®æ”¹onnxè¾“å…¥å®ç°ç›¸å¯¹åŠ¨æ€ï¼Œé¿å…é‡å›pytorchå†åšå¯¼å‡ºä¸å»ºè®®ä½¿ç”¨dynamic_axesæŒ‡å®š0ä»¥å¤–çš„ç»´åº¦ä¸ºåŠ¨æ€ï¼Œå¤æ‚åº¦å¤ªé«˜ï¼Œå¹¶ä¸”å­˜åœ¨æœ‰çš„layerä¸æ”¯æŒï¼Œè¿™ç§éœ€æ±‚ä¹Ÿä¸å¸¸ç”¨ï¼Œæ€§èƒ½ä¹Ÿå¾ˆå·®çœŸæ­£éœ€è¦çš„ï¼Œæ˜¯onnxæ–‡ä»¶å·²ç»å¯¼å‡ºï¼Œä½†æ˜¯è¾“å…¥shapeå›ºå®šäº†ï¼Œæ­¤æ—¶å¸Œæœ›ä¿®æ”¹è¿™ä¸ªonnxçš„è¾“å…¥shapeæ­¥éª¤ä¸€: ä½¿ç”¨TRT::compileå‡½æ•°çš„inputsDimsSetupå‚æ•°é‡å®šä¹‰è¾“å…¥çš„shapeæ­¥éª¤äºŒ: ä½¿ç”¨TRT:set_layer_hook_reshapeé’©å­åŠ¨æ€ä¿®æ”¹reshapeçš„å‚æ•°å®ç°é€‚é…å…¶ä»–æ£€æµ‹ç³»åˆ—SSDFPNFeature Pyramid Networks for Object Detectionæ¦‚è¿°FPN(feature pyramid networks) æ˜¯ä½•å‡¯æ˜ç­‰ä½œè€…æå‡ºçš„é€‚ç”¨äºå¤šå°ºåº¦ç›®æ ‡æ£€æµ‹ç®—æ³•åŸæ¥å¤šæ•°çš„object detectionç®—æ³•(æ¯”å¦‚ faster rcnn)éƒ½æ˜¯åªé‡‡ç”¨é¡¶å±‚ç‰¹å¾åšé¢„æµ‹ï¼Œä½†æˆ‘ä»¬çŸ¥é“ä½å±‚çš„ç‰¹å¾è¯­ä¹‰ä¿¡æ¯æ¯”è¾ƒå°‘ï¼Œä½†æ˜¯ç›®æ ‡ä½ç½®å‡†ç¡®ï¼›é«˜å±‚çš„ç‰¹å¾è¯­ä¹‰ä¿¡æ¯æ¯”è¾ƒä¸°å¯Œï¼Œä½†æ˜¯ç›®æ ‡ä½ç½®æ¯”è¾ƒç²—ç•¥å¦å¤–è™½ç„¶ä¹Ÿæœ‰äº›ç®—æ³•é‡‡ç”¨å¤šå°ºåº¦ç‰¹å¾èåˆçš„æ–¹å¼ï¼Œä½†æ˜¯ä¸€èˆ¬æ˜¯é‡‡ç”¨èåˆåçš„ç‰¹å¾åšé¢„æµ‹ï¼Œè€Œæœ¬æ–‡ä¸ä¸€æ ·çš„åœ°æ–¹åœ¨äºé¢„æµ‹æ˜¯åœ¨ä¸åŒç‰¹å¾å±‚ç‹¬ç«‹è¿›è¡Œçš„ï¼Œè¿™é‡Œä¸»è¦å€Ÿé‰´äº†ResNetçš„æ®‹å·®: ç»“åˆäº†æµ…å±‚ç‰¹å¾å’Œæ·±å±‚ç‰¹å¾SSDçš„æ£€æµ‹ç­–ç•¥: åœ¨ä¸åŒåˆ†è¾¨ç‡çš„ç‰¹å¾å›¾ä¸Šåˆ†åˆ«åšé¢„æµ‹ç‰¹å¾é‡‘å­—å¡”å›¾ç¤ºï¼Œè¶Šç²—è¡¨ç¤ºç‰¹å¾è¯­ä¹‰æ›´å¼ºè–°é£è¯»è®ºæ–‡ï¼šFeature Pyramid Network è¯¦è§£ç‰¹å¾é‡‘å­—å¡”ç½‘ç»œFPNçš„æ¥é¾™å»è„‰å›¾ä¸­å°†ç‰¹å¾é‡‘å­—å¡”å’Œå…¶ä»–çš„é‡‘å­—å¡”åšäº†æ¯”è¾ƒ(a)æ˜¯ä¼ ç»Ÿä¸­çš„å›¾ç‰‡é‡‘å­—å¡”ï¼Œå›¾ç‰‡ç¼©æ”¾åˆ°ä¸åŒçš„å¤§å°ï¼Œåˆ†åˆ«é¢„æµ‹ï¼Œæ¯ä¸ªç‰¹å¾æå–/é¢„æµ‹éƒ½æ˜¯ç‹¬ç«‹è¿›è¡Œçš„ï¼ŒåŒä¸€å¼ å›¾ç‰‡çš„ä¸åŒåˆ†è¾¨ç‡ï¼Œä¹Ÿå¾ˆéš¾å…±äº«å®ƒä»¬ä¸­é—´æå–çš„ç‰¹å¾ï¼Œè®©æ¨¡å‹é¢„æµ‹çš„è¿‡ç¨‹è´¹æ—¶è´¹åŠ›(b)æ˜¯åŸç”Ÿçš„CNNæå–çš„ç‰¹å¾ï¼Œç”±äºåç»­å­˜åœ¨æ± åŒ–å’Œé™é‡‡æ ·ï¼Œæµ…å±‚ç½‘ç»œçš„ç‰¹å¾å›¾å¯ä»¥ä¿ç•™æ›´å¤šçš„åˆ†è¾¨ç‡ï¼Œä½†æ˜¯ç‰¹å¾è¯­ä¹‰è¾ƒä¸ºä½çº§(c)æ˜¯SSDä¸­çš„ç‰¹å¾ï¼ŒæŠŠä¸åŒåˆ†è¾¨ç‡ç‰¹å¾ï¼Œåœ¨ä¸åŒåˆ†è¾¨ç‡çš„ç‰¹å¾ä¸Šç›´æ¥é¢„æµ‹ï¼Œé‚£ä¹ˆå¤§ç‰©ä½“å°ç‰©ä½“éƒ½èƒ½é¢„æµ‹åˆ°ï¼Œä½†ä»å­˜åœ¨åº•å±‚ç‰¹å¾è¯­ä¹‰ä¸å¤Ÿå’Œæœ€é«˜åˆ†è¾¨ç‡ä¸é«˜çš„é—®é¢˜(d)æ˜¯FPNä¸­ç”¨çš„ç‰¹å¾é‡‘å­—å¡”ï¼Œç»“åˆæ·±æµ…ç‰¹å¾ï¼Œå…¼é¡¾åˆ†è¾¨ç‡ä¸ç‰¹å¾è¯­ä¹‰RetinaNetFocal Loss for Dense Object Detection 2018ppt: Focal Loss for Dense Object DetectionRetinaNetæ˜¯ä½¿ç”¨FPNå’ŒFocal Loss(è¯¦æƒ…çœ‹æœ¬ç«™æ·±åº¦å­¦ä¹ æ ¸å¿ƒä¹‹æŸå¤±å‡½æ•°éƒ¨åˆ†)çš„ç›®æ ‡æ£€æµ‹æ¨¡å‹ï¼Œèƒ½å¤Ÿæœ‰æ•ˆè§£å†³ç±»åˆ«ä¸å¹³è¡¡é—®é¢˜å®ƒé€šè¿‡ç‰¹å¾é‡‘å­—å¡”ç½‘ç»œç”Ÿæˆå¤šå°ºåº¦çš„ç‰¹å¾å›¾ï¼Œå¹¶ä½¿ç”¨Focal Lossé‡ç‚¹å…³æ³¨éš¾ä»¥åˆ†ç±»çš„æ ·æœ¬ï¼Œä»è€Œæé«˜äº†æ£€æµ‹æ€§èƒ½DETREnd-to-End Object Detection with Transformers DETR 2020æ·±åº¦å­¦ä¹ ä¹‹ç›®æ ‡æ£€æµ‹ï¼ˆåä¸€ï¼‰â€”DETRè¯¦è§£ç»§Transformeråº”ç”¨äºå›¾åƒåˆ†ç±»åï¼ŒTransformeråº”ç”¨äºå›¾åƒç›®æ ‡æ£€æµ‹çš„å¼€å±±ä¹‹ä½œâ€“DEtection TRansformerï¼Œå…¶å¤§å¤§ç®€åŒ–äº†ç›®æ ‡æ£€æµ‹çš„æ¡†æ¶ï¼Œæ›´ç›´è§‚DETRæ˜¯Facebookå›¢é˜Ÿäº2020å¹´æå‡ºçš„åŸºäºTransformerçš„ç«¯åˆ°ç«¯ç›®æ ‡æ£€æµ‹ï¼Œæ²¡æœ‰éæå¤§å€¼æŠ‘åˆ¶NMSåå¤„ç†æ­¥éª¤ã€æ²¡æœ‰anchorç­‰å…ˆéªŒçŸ¥è¯†å’Œçº¦æŸï¼Œæ•´ä¸ªç”±ç½‘ç»œå®ç°ç«¯åˆ°ç«¯çš„ç›®æ ‡æ£€æµ‹å®ç°ï¼Œå¤§å¤§ç®€åŒ–äº†ç›®æ ‡æ£€æµ‹çš„pipelineã€‚ç»“æœåœ¨COCOæ•°æ®é›†ä¸Šæ•ˆæœä¸Faster RCNNç›¸å½“ï¼Œåœ¨å¤§ç›®æ ‡ä¸Šæ•ˆæœæ¯”Faster RCNNå¥½ï¼Œä¸”å¯ä»¥å¾ˆå®¹æ˜“åœ°å°†DETRè¿ç§»åˆ°å…¶ä»–ä»»åŠ¡ä¾‹å¦‚å…¨æ™¯åˆ†å‰²ç›®æ ‡è·Ÿè¸ªä¸‡å­—é•¿æ–‡ | å¤šç›®æ ‡è·Ÿè¸ªæœ€æ–°ç»¼è¿°(åŸºäºTransformer/å›¾æ¨¡å‹/æ£€æµ‹å’Œå…³è”/å­ªç”Ÿç½‘ç»œ)ã€yolov4ç›®æ ‡æ£€æµ‹ã€‘(2) å¤šç›®æ ‡è·Ÿè¸ªï¼Œæ¡ˆä¾‹ï¼šè½¦è¾†è¡Œäººçš„è·Ÿè¸ªå’Œè®¡æ•°ï¼Œé™„pythonå®Œæ•´ä»£ç å’Œæ•°æ®é›†yolov4-deepsort tensorflowä»£ç è½¬è½½ï¼šä¸€çº¿ç®—æ³•å·¥ç¨‹å¸ˆæ•´ç†ï¼è¶…å®ç”¨çš„3å¤§å¤šç›®æ ‡è·Ÿè¸ªç®—æ³•Deep-Sort å¤šç›®æ ‡è·Ÿè¸ªç®—æ³•åŸç†å’Œä»£ç è§£æDarklabelå¤šç›®æ ‡è·Ÿè¸ªæ ‡æ³¨å·¥å…·ä¸‡å­—ç»¼è¿°ï¼šç›®æ ‡æ£€æµ‹æ¨¡å‹YOLOv1-v7æ·±åº¦è§£æç›®æ ‡è·Ÿè¸ª = ç›®æ ‡æ£€æµ‹+ç›®æ ‡è·Ÿè¸ªç®—æ³•ç›®æ ‡è¿½è¸ªç®—æ³•åˆ†ä¸ºå•ç›®æ ‡è¿½è¸ªSOT(Single-Object Track)å’Œå¤šç›®æ ‡è¿½è¸ªMOT(Multi-Object Track)[1][2]åœ¨å•ç›®æ ‡è·Ÿè¸ªä¸­ï¼Œä½¿ç”¨ç»™å®šçš„åˆå§‹ç›®æ ‡ä½ç½®ï¼Œåœ¨åç»­è§†é¢‘å¸§ä¸­å¯¹ç»™å®šçš„ç‰©ä½“è¿›è¡Œä½ç½®é¢„æµ‹å¤šç›®æ ‡è·Ÿè¸ªç®—æ³•ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯ä¸è€ƒè™‘åˆå§‹ç›®æ ‡ä½ç½®çš„ï¼Œç›®æ ‡å¯è‡ªè¡Œæ¶ˆå¤±ä¸äº§ç”Ÿç›®æ ‡è·Ÿè¸ªåˆ†ç±»ç›®æ ‡è·Ÿè¸ªé€šå¸¸å¯åˆ†ä¸ºå•ç›®æ ‡è·Ÿè¸ªå’Œå¤šç›®æ ‡è·Ÿè¸ªä¸¤ç±»å•ç›®æ ‡è·Ÿè¸ªå¤šç›®æ ‡è·Ÿè¸ªSDE(separate detecting and embeding)æ¯éƒ¨åˆ†ç‹¬ç«‹ä¼˜åŒ–èƒ½å¤Ÿå–å¾—æ¯”è¾ƒé«˜çš„ç²¾åº¦ï¼Œç¼ºç‚¹å°±æ˜¯è®¡ç®—é‡ä¼šå¢åŠ JDE(joint detecting and embeding)JDEå°†ç›®æ ‡æ£€æµ‹ä¸REIDç‰¹å¾æå–æ”¾åœ¨ä¸€ä¸ªç½‘ç»œï¼Œè¿™æ ·èƒ½æœ‰æ•ˆå‡å°‘è®¡ç®—é‡ï¼Œä½†æ˜¯å¤šä»»åŠ¡å­¦ä¹ çš„ç²¾åº¦ä¼šä½äº›è§£å†³çš„ä»»åŠ¡å’Œè§†é¢‘ç›®æ ‡æ£€æµ‹ç›¸åŒçš„ç‚¹åœ¨äºéƒ½éœ€è¦å¯¹æ¯å¸§å›¾åƒä¸­çš„ç›®æ ‡ç²¾å‡†å®šä½ï¼Œä¸åŒç‚¹åœ¨äºç›®æ ‡è·Ÿè¸ªä¸è€ƒè™‘ç›®æ ‡çš„è¯†åˆ«é—®é¢˜SDEå°†REIDç‰¹å¾æå–å’Œç›®æ ‡æ£€æµ‹åˆ†ä¸ºä¸¤ä¸ªç‹¬ç«‹ç½‘ç»œæ¥å®ç°ï¼Œè¿™æ ·åšçš„ä¼˜ç‚¹æ˜¯æ¯éƒ¨åˆ†ç‹¬ç«‹ä¼˜åŒ–èƒ½å¤Ÿå–å¾—æ¯”è¾ƒé«˜çš„ç²¾åº¦ï¼Œç¼ºç‚¹å°±æ˜¯è®¡ç®—é‡ä¼šå¢åŠ ï¼›JDEå°†ç›®æ ‡æ£€æµ‹ä¸REIDç‰¹å¾æå–æ”¾åœ¨ä¸€ä¸ªç½‘ç»œï¼Œè¿™æ ·èƒ½æœ‰æ•ˆå‡å°‘è®¡ç®—é‡ï¼Œä½†æ˜¯å¤šä»»åŠ¡å­¦ä¹ çš„ç²¾åº¦ç›®å‰æ¥è¯´è¿˜æ²¡æœ‰SDEé«˜ã€‚åœ¨å·¥ç¨‹åº”ç”¨ä¸Šæˆ‘æ›´åå‘äºJDEï¼Œæ¯•ç«Ÿè·Ÿè¸ªè¦ä¿è¯å®æ—¶æ€§ï¼Œåœ¨èƒ½å¤Ÿæå–ä¸€ä¸ªä¸å¤ªå·®çš„REIDç‰¹å¾åŸºç¡€ä¸Šï¼ŒåŠ å¼ºæ£€æµ‹å™¨æ€§èƒ½å’Œä¼˜åŒ–æ•°æ®å…³è”éƒ¨åˆ†ä¹Ÿèƒ½ä¸€å®šç¨‹åº¦ä¸Šå¼¥è¡¥REIDç‰¹å¾ä¸å¤Ÿå¥½å¸¦æ¥çš„æ€§èƒ½æŸå¤±SortDeepSortç›®æ ‡è·Ÿè¸ªåŸºç¡€â€”â€”DeepSORTã€MOTã€‘è¯¦è§£DeepSORTå¤šç›®æ ‡è¿½è¸ªæ¨¡å‹StrongSortStrongSortç›¸æ¯”äºDeepSortçš„åŒºåˆ«ï¼šä½¿ç”¨BoTæ›¿ä»£CNNåšå¤–è¡¨ç‰¹å¾çš„æå–ä½¿ç”¨EMA(exponential moving averageï¼šæŒ‡æ•°ç§»åŠ¨å¹³å‡)ç­–ç•¥æ›´æ–°æ–°å¸§ä¸­çš„ç›®æ ‡å¤–è§‚ç‰¹å¾EMAæ›´æ–°ç­–ç•¥ä¸ä»…æé«˜äº†åŒ¹é…è´¨é‡ï¼Œè€Œä¸”å‡å°‘äº†æ—¶é—´æ¶ˆè€—åœ¨åšKalman filterä¹‹å‰ï¼Œä½¿ç”¨ECCï¼ˆenhanced correlation coefficientï¼šå¢å¼ºç›¸å…³ç³»æ•°ï¼‰è¿›è¡Œç›¸æœºè¿åŠ¨è¡¥å¿ï¼›å¹¶ä½¿ç”¨NSA Kalmanä»£æ›¿Kalmanè¿›è¡Œè¿åŠ¨ç‰¹å¾è·å–å°†è¿åŠ¨ä¿¡æ¯å’Œå¤–è§‚ä¿¡æ¯ç»“åˆæ¥è¿›è¡ŒåŒ¹é…ä½¿ç”¨Vanillaå…¨å±€çº¿æ€§èµ‹å€¼ä»£æ›¿äº†åŒ¹é…çº§è”BotSortBoT-SORT: Robust Associations Multi-Pedestrian TrackingBoT-SORT ï½œè¶…è¶Š DeepSORTã€StrongSORT++ å’Œ ByteTrackByteTrackByteTrack: Multi-Object Tracking by Associating Every Detection Boxä¾èµ–çš„ç®—æ³•å¡å°”æ›¼æ»¤æ³¢å¡å°”æ›¼æ»¤æ³¢è¢«å¹¿æ³›åº”ç”¨äºæ— äººæœºã€è‡ªåŠ¨é©¾é©¶ã€å«æ˜Ÿå¯¼èˆªç­‰é¢†åŸŸç®€å•æ¥è¯´ï¼Œå…¶ä½œç”¨å°±æ˜¯åŸºäºä¼ æ„Ÿå™¨çš„æµ‹é‡å€¼æ¥æ›´æ–°é¢„æµ‹å€¼ï¼Œä»¥è¾¾åˆ°æ›´ç²¾ç¡®çš„ä¼°è®¡å‡è®¾æˆ‘ä»¬è¦è·Ÿè¸ªå°è½¦çš„ä½ç½®å˜åŒ–ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè“è‰²çš„åˆ†å¸ƒæ˜¯å¡å°”æ›¼æ»¤æ³¢é¢„æµ‹å€¼ï¼Œæ£•è‰²çš„åˆ†å¸ƒæ˜¯ä¼ æ„Ÿå™¨çš„æµ‹é‡å€¼ï¼Œç°è‰²çš„åˆ†å¸ƒå°±æ˜¯é¢„æµ‹å€¼åŸºäºæµ‹é‡å€¼æ›´æ–°åçš„æœ€ä¼˜ä¼°è®¡åœ¨ç›®æ ‡è·Ÿè¸ªä¸­ï¼Œéœ€è¦ä¼°è®¡trackçš„ä»¥ä¸‹ä¸¤ä¸ªçŠ¶æ€ï¼šå‡å€¼(Mean)ï¼šè¡¨ç¤ºç›®æ ‡çš„ä½ç½®ä¿¡æ¯ï¼Œç”±bboxçš„ä¸­å¿ƒåæ ‡ (cx, cy)ï¼Œå®½é«˜æ¯”rï¼Œé«˜hï¼Œä»¥åŠå„è‡ªçš„é€Ÿåº¦å˜åŒ–å€¼ç»„æˆç”±8ç»´å‘é‡è¡¨ç¤ºä¸º x = [cx, cy, r, h, vx, vy, vr, vh]ï¼Œå„ä¸ªé€Ÿåº¦å€¼åˆå§‹åŒ–ä¸º0åæ–¹å·®(Covariance )ï¼šè¡¨ç¤ºç›®æ ‡ä½ç½®ä¿¡æ¯çš„ä¸ç¡®å®šæ€§ï¼Œç”±8x8çš„å¯¹è§’çŸ©é˜µè¡¨ç¤ºï¼ŒçŸ©é˜µä¸­æ•°å­—è¶Šå¤§åˆ™è¡¨æ˜ä¸ç¡®å®šæ€§è¶Šå¤§ï¼Œå¯ä»¥ä»¥ä»»æ„å€¼åˆå§‹åŒ–å¡å°”æ›¼æ»¤æ³¢åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼š(1) é¢„æµ‹trackåœ¨ä¸‹ä¸€æ—¶åˆ»çš„ä½ç½®ï¼Œ(2) åŸºäºdetectionæ¥æ›´æ–°é¢„æµ‹çš„ä½ç½®ã€‚åŒˆç‰™åˆ©åŒ¹é…ç®—æ³•ç›®æ ‡è·Ÿè¸ªåˆæ¢(DeepSORT)å…ˆä»‹ç»ä¸€ä¸‹ä»€ä¹ˆæ˜¯åˆ†é…é—®é¢˜ï¼ˆAssignment Problemï¼‰ï¼šå‡è®¾æœ‰Nä¸ªäººå’ŒNä¸ªä»»åŠ¡ï¼Œæ¯ä¸ªä»»åŠ¡å¯ä»¥ä»»æ„åˆ†é…ç»™ä¸åŒçš„äººï¼Œå·²çŸ¥æ¯ä¸ªäººå®Œæˆæ¯ä¸ªä»»åŠ¡è¦èŠ±è´¹çš„ä»£ä»·ä¸å°½ç›¸åŒï¼Œé‚£ä¹ˆå¦‚ä½•åˆ†é…å¯ä»¥ä½¿å¾—æ€»çš„ä»£ä»·æœ€å°ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾ç°åœ¨æœ‰3ä¸ªä»»åŠ¡ï¼Œè¦åˆ†åˆ«åˆ†é…ç»™3ä¸ªäººï¼Œæ¯ä¸ªäººå®Œæˆå„ä¸ªä»»åŠ¡æ‰€éœ€ä»£ä»·çŸ©é˜µ(cost matrix)å¦‚ä¸‹æ‰€ç¤º(è¿™ä¸ªä»£ä»·å¯ä»¥æ˜¯é‡‘é’±ã€æ—¶é—´ç­‰ç­‰)ï¼šTask_1Task_2Task_3Person_1154045Person_2206035Person_3204025æ€æ ·æ‰èƒ½æ‰¾åˆ°ä¸€ä¸ªæœ€ä¼˜åˆ†é…ï¼Œä½¿å¾—å®Œæˆæ‰€æœ‰ä»»åŠ¡èŠ±è´¹çš„ä»£ä»·æœ€å°å‘¢ï¼ŸåŒˆç‰™åˆ©ç®—æ³•(åˆå«KMç®—æ³•)å°±æ˜¯ç”¨æ¥è§£å†³åˆ†é…é—®é¢˜çš„ä¸€ç§æ–¹æ³•ï¼Œå®ƒåŸºäºå®šç†ï¼šå¦‚æœä»£ä»·çŸ©é˜µçš„æŸä¸€è¡Œæˆ–æŸä¸€åˆ—åŒæ—¶åŠ ä¸Šæˆ–å‡å»æŸä¸ªæ•°ï¼Œåˆ™è¿™ä¸ªæ–°çš„ä»£ä»·çŸ©é˜µçš„æœ€ä¼˜åˆ†é…ä»ç„¶æ˜¯åŸä»£ä»·çŸ©é˜µçš„æœ€ä¼˜åˆ†é…ç®—æ³•æ­¥éª¤(å‡è®¾çŸ©é˜µä¸ºNé˜¶æ–¹é˜µ)ï¼šå¯¹äºçŸ©é˜µçš„æ¯ä¸€è¡Œï¼Œå‡å»å…¶ä¸­æœ€å°çš„å…ƒç´ å¯¹äºçŸ©é˜µçš„æ¯ä¸€åˆ—ï¼Œå‡å»å…¶ä¸­æœ€å°çš„å…ƒç´ ç”¨æœ€å°‘çš„æ°´å¹³çº¿æˆ–å‚ç›´çº¿è¦†ç›–çŸ©é˜µä¸­æ‰€æœ‰çš„0å¦‚æœçº¿çš„æ•°é‡ç­‰äºNï¼Œåˆ™æ‰¾åˆ°äº†æœ€ä¼˜åˆ†é…ï¼Œç®—æ³•ç»“æŸï¼Œå¦åˆ™è¿›å…¥æ­¥éª¤5æ‰¾åˆ°æ²¡æœ‰è¢«ä»»ä½•çº¿è¦†ç›–çš„æœ€å°å…ƒç´ ï¼Œæ¯ä¸ªæ²¡è¢«çº¿è¦†ç›–çš„è¡Œå‡å»è¿™ä¸ªå…ƒç´ ï¼Œæ¯ä¸ªè¢«çº¿è¦†ç›–çš„åˆ—åŠ ä¸Šè¿™ä¸ªå…ƒç´ ï¼Œè¿”å›æ­¥éª¤3ç»§ç»­æ‹¿ä¸Šé¢çš„ä¾‹å­åšæ¼”ç¤ºï¼šstep1 æ¯ä¸€è¡Œæœ€å°çš„å…ƒç´ åˆ†åˆ«ä¸º15ã€20ã€20ï¼Œå‡å»å¾—åˆ°ï¼šTask_1Task_2Task_3Person_102530Person_204015Person_30205step2 æ¯ä¸€åˆ—æœ€å°çš„å…ƒç´ åˆ†åˆ«ä¸º0ã€20ã€5ï¼Œå‡å»å¾—åˆ°ï¼šTask_1Task_2Task_3Person_10525Person_202010Person_3000step3 ç”¨æœ€å°‘çš„æ°´å¹³çº¿æˆ–å‚ç›´çº¿è¦†ç›–æ‰€æœ‰çš„0ï¼Œå¾—åˆ°ï¼šTask_1Task_2Task_3Person_10525Person_202010Person_3000step4 çº¿çš„æ•°é‡ä¸º2ï¼Œå°äº3ï¼Œè¿›å…¥ä¸‹ä¸€æ­¥ï¼›step5 ç°åœ¨æ²¡è¢«è¦†ç›–çš„æœ€å°å…ƒç´ æ˜¯5ï¼Œæ²¡è¢«è¦†ç›–çš„è¡Œ(ç¬¬ä¸€å’Œç¬¬äºŒè¡Œ)å‡å»5ï¼Œå¾—åˆ°ï¼šTask_1Task_2Task_3Person_1-5020Person_2-5155Person_3000è¢«è¦†ç›–çš„åˆ—(ç¬¬ä¸€åˆ—)åŠ ä¸Š5ï¼Œå¾—åˆ°ï¼šTask_1Task_2Task_3Person_10020Person_20155Person_3500è·³è½¬åˆ°step3ï¼Œç”¨æœ€å°‘çš„æ°´å¹³çº¿æˆ–å‚ç›´çº¿è¦†ç›–æ‰€æœ‰çš„0ï¼Œå¾—åˆ°ï¼šTask_1Task_2Task_3Person_10020Person_20155Person_3500step4ï¼šçº¿çš„æ•°é‡ä¸º3ï¼Œæ»¡è¶³æ¡ä»¶ï¼Œç®—æ³•ç»“æŸæ˜¾ç„¶ï¼Œå°†ä»»åŠ¡2åˆ†é…ç»™ç¬¬1ä¸ªäººã€ä»»åŠ¡1åˆ†é…ç»™ç¬¬2ä¸ªäººã€ä»»åŠ¡3åˆ†é…ç»™ç¬¬3ä¸ªäººæ—¶ï¼Œæ€»çš„ä»£ä»·æœ€å°(0+0+0=0)ï¼šæ‰€ä»¥åŸçŸ©é˜µçš„æœ€å°æ€»ä»£ä»·ä¸º40+20+25=85Task_1Task_2Task_3Person_1154045Person_2206035Person_3204025sklearné‡Œçš„linear_assignment()å‡½æ•°ä»¥åŠscipyé‡Œçš„linear_sum_assignment()å‡½æ•°éƒ½å®ç°äº†åŒˆç‰™åˆ©ç®—æ³•123456789101112131415import numpy as np from scipy.optimize import linear_sum_assignment cost_matrix = np.array([    [15,40,45],    [20,60,35],    [20,40,25]]) matches = linear_sum_assignment(cost_matrix)print('scipy API result:\n', matches) &gt;&gt;&gt;scipy API result: (array([0, 1, 2], dtype=int64), array([1, 0, 2], dtype=int64))è¿½è¸ªæŒ‡æ ‡å¤šç›®æ ‡è·Ÿè¸ªè¯„ä»·æŒ‡æ ‡æ€»ç»“â€”â€”MOTAã€IDF1ã€HOTAç­‰MOTA(Multiple Object Tracking Accuracy): æŒ‡æ ‡ä½“ç°å¤šç›®æ ‡è·Ÿè¸ªçš„å‡†ç¡®åº¦MOTAæŒ‡æ ‡æ˜¯è¡¡é‡å¤šç›®æ ‡è·Ÿè¸ªç®—æ³•ç²¾ç¡®æ€§æ–¹é¢æœ€é‡è¦çš„æŒ‡æ ‡ï¼Œä»¥1ä¸ºæœ€ä½³æƒ…å†µï¼Œæ•°å€¼è¶Šé«˜ä»£è¡¨è·Ÿè¸ªç²¾ç¡®åº¦è¶Šå¥½IDF1: æŒ‡æ ‡ä»£è¡¨è¢«æ£€æµ‹å’Œè·Ÿè¸ªçš„ç›®æ ‡ä¸­è·å–æ­£ç¡®çš„IDçš„æ£€æµ‹ç›®æ ‡çš„æ¯”ä¾‹ï¼Œç»¼åˆè€ƒè™‘IDå‡†ç¡®ç‡å’ŒIDå¬å›ç‡ï¼Œä»£è¡¨ä¸¤è€…çš„è°ƒå’Œå‡å€¼å…¶ä¸­ï¼ŒIDPä»£è¡¨IDè·Ÿè¸ªçš„å‡†ç¡®ç‡ï¼ŒIDRä»£è¡¨IDè·Ÿè¸ªçš„å¬å›ç‡ï¼ŒIDF1æŒ‡æ ‡æ›´èšç„¦äºè·Ÿè¸ªç®—æ³•è·Ÿè¸ªæŸä¸ªç›®æ ‡çš„æ—¶é—´é•¿çŸ­ï¼Œè€ƒå¯Ÿè·Ÿè¸ªçš„è¿ç»­æ€§å’Œé‡è¯†åˆ«çš„å‡†ç¡®æ€§ï¼ŒIDF1ä»¥1ä¸ºæœ€ä½³æƒ…å†µï¼Œæ•°å€¼è¶Šé«˜ä»£è¡¨è·Ÿè¸ªç‰¹å®šç›®æ ‡çš„ç²¾åº¦è¶Šå¥½HOTAé“è·¯ç›‘æ§ç®¡ç†Roboflowæ•°æ®é›†æ ‡æ³¨ç›®æ ‡æ£€æµ‹ç®—æ³•_æ¨¡å‹è®­ç»ƒç›®æ ‡è·Ÿè¸ªç®—æ³•_ByteTrack(å®æ—¶æ€§)ç‰©ä½“æ£€æµ‹åˆ†ç±»ä¸»åŠ¨å­¦ä¹ å’Œå¼ºåŒ–å­¦ä¹ ä¸»åŠ¨å­¦ä¹ ï¼šæ˜¯ä¸€ç§é€šè¿‡ä¸»åŠ¨é€‰æ‹©æœ€æœ‰ä»·å€¼çš„æ ·æœ¬è¿›è¡Œæ ‡æ³¨çš„æœºå™¨å­¦ä¹ æˆ–äººå·¥æ™ºèƒ½æ–¹æ³•ã€‚å…¶ç›®çš„æ˜¯ä½¿ç”¨å°½å¯èƒ½å°‘çš„ã€é«˜è´¨é‡çš„æ ·æœ¬æ ‡æ³¨ä½¿æ¨¡å‹è¾¾åˆ°å°½å¯èƒ½å¥½çš„æ€§èƒ½ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸»åŠ¨å­¦ä¹ æ–¹æ³•èƒ½å¤Ÿæé«˜æ ·æœ¬åŠæ ‡æ³¨çš„å¢ç›Šï¼Œåœ¨æœ‰é™æ ‡æ³¨é¢„ç®—çš„å‰æä¸‹ï¼Œæœ€å¤§åŒ–æ¨¡å‹çš„æ€§èƒ½ï¼Œæ˜¯ä¸€ç§ä»æ ·æœ¬çš„è§’åº¦ï¼Œæé«˜æ•°æ®æ•ˆç‡çš„æ–¹æ¡ˆï¼Œå› è€Œè¢«åº”ç”¨åœ¨æ ‡æ³¨æˆæœ¬é«˜ã€æ ‡æ³¨éš¾åº¦å¤§ç­‰ä»»åŠ¡ä¸­ï¼Œä¾‹å¦‚åŒ»ç–—å›¾åƒã€æ— äººé©¾é©¶ã€å¼‚å¸¸æ£€æµ‹ã€åŸºäºäº’è”ç½‘å¤§æ•°æ®çš„ç›¸å…³é—®é¢˜å¼ºåŒ–å­¦ä¹ ä»‹ç»åŠåº”ç”¨å¼ºåŒ–å­¦ä¹ ï¼šå¼ºåŒ–å­¦ä¹ æ˜¯ä¸€ä¸ªéå¸¸å¸å¼•äººçš„äººå·¥æ™ºèƒ½é¢†åŸŸï¼Œ2016å¹´ Alpha Goåœ¨å›´æ£‹é¢†åŸŸæŒ‘æˆ˜æä¸–çŸ³ï¼Œä»¥å‡ ä¹ç¢¾å‹çš„ç»“æœå¤ºå† ï¼Œå¼•èµ·äº†äººä»¬å¯¹äºäººå·¥æ™ºèƒ½çš„å¹¿æ³›è®¨è®ºã€‚2019å¹´Alpha Staræ¨ªç©ºå‡ºä¸–ï¼Œåœ¨å¤æ‚çš„æ˜Ÿé™…äº‰éœ¸2æ¸¸æˆä¸­è¾¾åˆ°èƒ½å’Œäººç±»é¡¶çº§ç©å®¶PKçš„æ°´å¹³ï¼Œç™»ä¸ŠNatureã€‚è¿™ä¸¤æ¬¡ä¸äººç±»é¡¶çº§ç©å®¶çš„æŠ—è¡¡ä¹‹æˆ˜ï¼ŒèƒŒåçš„æŠ€æœ¯éƒ½æ˜¯å¼ºåŒ–å­¦ä¹ ã€‚å¼ºåŒ–å­¦ä¹ æ˜¯æœºå™¨å­¦ä¹ é¢†åŸŸçš„ä¸€ä¸ªåˆ†æ”¯ï¼Œå¼ºè°ƒåŸºäºç¯å¢ƒè€Œè¡ŒåŠ¨ï¼Œä»¥å–å¾—æœ€å¤§åŒ–çš„é•¿æœŸåˆ©ç›Šã€‚ä¸ç›‘ç£å­¦ä¹ ã€éç›‘ç£å­¦ä¹ ä¸åŒï¼Œç›‘ç£å­¦ä¹ è§£å†³å¦‚åˆ†ç±»ã€å›å½’ç­‰æ„ŸçŸ¥å’Œè®¤çŸ¥ç±»çš„ä»»åŠ¡ï¼Œè€Œå¼ºåŒ–å­¦ä¹ å¤„ç†å†³ç­–é—®é¢˜ï¼Œç€é‡äºç¯å¢ƒçš„äº¤äº’ã€åºåˆ—å†³ç­–ã€å’Œé•¿æœŸæ”¶ç›Šã€‚å¼ºåŒ–å­¦ä¹ ä¸ç¯å¢ƒçš„äº¤äº’æ¨¡å¼å¯ä»¥æŠ½è±¡ä¸ºï¼šæ™ºèƒ½ä½“Agentåœ¨ç¯å¢ƒEnvironmentä¸­å­¦ä¹ ï¼Œæ ¹ç»ç¯å¢ƒçš„çŠ¶æ€Stateï¼Œæ‰§è¡ŒåŠ¨ä½œActionï¼Œå¹¶æ ¹æ®ç¯å¢ƒåé¦ˆçš„å¥–åŠ±Rewardæ¥æŒ‡å¯¼è¾“å‡ºæ›´å¥½çš„åŠ¨ä½œ</content>
	</entry>
	<entry>
		<title>æ•°æ®æ ‡æ³¨å·¥å…·</title>
		<url>/article/42221.html</url>
		<content>label-studiolabel-studioç¤¾åŒºç‰ˆå’Œä¼ä¸šç‰ˆæ¯”è¾ƒLabel Studioæ˜¯ä¸€ä¸ªå¼€æºçš„ï¼Œå¯é…ç½®çš„æ•°æ®æ³¨é‡Šå·¥å…·ï¼Œå…¶ç›®çš„æ˜¯ä½¿æ‚¨èƒ½å¤Ÿä½¿ç”¨æ ‡å‡†åŒ–è¾“å‡ºæ ¼å¼çš„æœ€æ–¹ä¾¿çš„ç•Œé¢æ ‡è®°ä¸åŒç±»å‹çš„æ•°æ®ç‰¹è‰²ï¼šæ”¯æŒå¤šäººåä½œï¼Œæ”¯æŒä¸»åŠ¨å­¦ä¹ ã€æ”¯æŒå¤šç§çš„æ ‡æ³¨çš„ä»»åŠ¡ç¼ºç‚¹ï¼šåœ¨ç›®æ ‡æ£€æµ‹æ ‡æ³¨æ—¶ï¼Œå¥½åƒæ²¡æœ‰åå­—è¾…åŠ©çº¿æ”¯æŒçš„æ ‡æ³¨ä»»åŠ¡ï¼ŒåŒ…æ‹¬äº†å¦‚ä¸‹æ‰€ç¤ºï¼Œå…·ä½“çš„è§å®˜æ–¹gitä»‹ç»label studio ç»“åˆ MMDetection å®ç°æ•°æ®é›†è‡ªåŠ¨æ ‡è®°ã€æ¨¡å‹è¿­ä»£è®­ç»ƒçš„é—­ç¯Label Studioä½¿ç”¨æŠ€å·§å…³é”®çš„ä¸¤ä¸ªgitä»“åº“ï¼Œå…¶ä¸­label-studioçš„å®˜æ–¹æ–‡æ¡£åœ¨è¿™é‡Œlabel-studioï¼Œ è¿›è¡Œæ™®é€šçš„å›¾ç‰‡æ ‡è®°å·¥ä½œï¼Œå¦‚æœè¦ä½¿ç”¨å…¶æä¾›çš„è¾…åŠ©é¢„æ ‡è®°åŠŸèƒ½ï¼Œåˆ™éœ€è¦è¿›è¡Œåç»­é…ç½®label-studio-ml-backendï¼Œä¸»è¦æä¾›æ·±åº¦å­¦ä¹ æœåŠ¡ï¼ŒåŒ…æ‹¬é¢„æ ‡è®°å’Œæ¨¡å‹è®­ç»ƒï¼Œç»“åˆå‰ç«¯å½¢æˆæ¨¡å‹è¿­ä»£è®­ç»ƒçš„ä¸»åŠ¨å­¦ä¹ æ•ˆæœå‰åç«¯ç»“åˆå¯ä»¥è¾¾åˆ°æ¨¡å‹è‡ªåŠ¨æ ‡è®°æ•°æ®é›†ã€æ•°æ®é›†æ›´æ–°è¿­ä»£è®­ç»ƒæ¨¡å‹çš„é—­ç¯å‰ç«¯å®‰è£…123pip install label-studio# å¦‚æœå®‰è£…psycopg2==2.9.5 å¤±è´¥, å¯ä»¥å…ˆè£…ä¸‹ä¸‹é¢çš„åº“sudo yum install python-devel postgresql-devel postgresql-libs gccç¯å¢ƒå®‰è£…å®Œæˆååœ¨ä»»æ„ä½ç½®æ‰“å¼€å‘½ä»¤è¡Œï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨ label studio12# ä¸æŒ‡å®šè·¯å¾„æ—¶, é»˜è®¤æ”¾åœ¨äº† /root/.local/share/label-studiolabel-studio --data-dir Label-Studio -p 80å…¶ä¸­ --data-dir ç”¨äºæŒ‡å®šå·¥ä½œç›®å½•ï¼Œ -p ç”¨æ¥æŒ‡å®šè¿è¡Œç«¯å£ï¼Œè¿è¡ŒæˆåŠŸåä¼šå½“å‰ç›®å½•ä¼šç”Ÿæˆ Label-Studio ç›®å½•æµè§ˆå™¨æ‰“å¼€label studioå·¥ä½œç•Œé¢ï¼Œåˆ›å»ºç”¨æˆ·åå³å¯ç™»å½•ä½¿ç”¨(è¿™é‡Œçš„åˆ›å»ºå¾ˆç®€å•ï¼Œç¬¦åˆè§„èŒƒå°±å¯ä»¥)æ–‡ä»¶å¤¹ä¸­ä¸»è¦åŒ…æ‹¬äº†exportå’Œmediaæ–‡ä»¶å¤¹ï¼Œä»¥åŠä¸€ä¸ªlabel_studio.sqlite3æ•°æ®åº“æ–‡ä»¶æ•°æ®åº“é…ç½®æ•°æ®åº“é»˜è®¤ä½¿ç”¨çš„æ˜¯sqlite3ï¼Œè¿˜å¯ä»¥é…ç½®å…¶ä»–çš„å…³ç³»åº“ï¼Œå¦‚PostgreSQLç­‰ï¼Œé€šå¸¸å¦‚æœä½ æƒ³æ ‡æ³¨æ•°ç™¾ä¸‡ä¸ªä»»åŠ¡ï¼Œæˆ–è€…é¢„è®¡ä¼šæœ‰å¾ˆå¤šå¹¶å‘ç”¨æˆ·ï¼Œæˆ–è€…ä½ è®¡åˆ’åœ¨ç°å®ç”Ÿæ´»ä¸­çš„é¡¹ç›®ä¸­å·¥ä½œï¼Œé‚£ä¹ˆä½¿ç”¨PostgreSQLæ•°æ®åº“å®˜æ–¹æä¾›çš„è®¾ç½®pgçš„ç¯å¢ƒå˜é‡å¥½åƒä¸èµ·æ•ˆæœï¼Œä¸çŸ¥é“æŠŠæ•°æ®åº“å»ºå“ªé‡Œå»äº†ï¼Œè¿™é‡Œç›´æ¥åœ¨å‘½ä»¤è¡Œå¸¦ä¸Špgåº“çš„å‚æ•°1DJANGO_DB=default POSTGRE_NAME=label_studio_db POSTGRE_USER=postgres POSTGRE_PASSWORD=xxx POSTGRE_PORT=5432 POSTGRE_HOST=192.168.123.xx LABEL_STUDIO_LOCAL_FILES_DOCUMENT_ROOT=/home/huangyc/label_ws label-studio start --data-dir /home/huangyc/label_ws -p 8080LABEL_STUDIO_LOCAL_FILES_DOCUMENT_ROOTç”¨äºæŒ‡å®šæœ¬åœ°æ–‡ä»¶çš„ä½ç½®ï¼Œé¡¹ç›®è®¾ç½®é‡Œé¢é…ç½®æœ¬åœ°è·¯å¾„ä¸º/home/huangyc/label_ws/media(è¿™åªæ˜¯ä¸ªä¾‹å­å¥½åƒé…æˆ/home/huangyc/label_ws/media/uploadä¹Ÿæ˜¯ä¸€æ ·çš„)ï¼Œæ­¤æ—¶å¯ä»¥è®¿é—®12# æ³¨æ„?dåé¢çš„è·¯å¾„æ˜¯LABEL_STUDIO_LOCAL_FILES_DOCUMENT_ROOTé…ç½®çš„è·¯å¾„åé¢ç»§ç»­å¼€å§‹http://192.168.123.xx:8080/data/local-files?d=media/upload/3/demo.jpgå½“å‰ç›®å½•ç»“æ„å¦‚ä¸‹12345678910111213(label38) [root@uslave02 label_ws]# tree -d.â”œâ”€â”€ exportâ””â”€â”€ media    â”œâ”€â”€ avatars    â”œâ”€â”€ export    â””â”€â”€ upload        â”œâ”€â”€ 1        â”œâ”€â”€ 3            â”œâ”€â”€ demo.jpg        â””â”€â”€ 48 directoriesæ³¨æ„è¿™é‡Œéœ€è¦æå‰åˆ›å»ºå¥½æ•°æ®åº“label_studio_dbï¼Œå¯åŠ¨å®Œæˆæ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹çš„æ—¥å¿—1234567891011121314151617label-studio start --data-dir /home/huangyc/label_ws -p 8080=&gt; Database and media directory: /root/.local/share/label-studio=&gt; Static URL is set to: /static/=&gt; Database and media directory: /home/huangyc/label_ws=&gt; Static URL is set to: /static/Starting new HTTPS connection (1): pypi.org:443https://pypi.org:443 &quot;GET /pypi/label-studio/json HTTP/1.1&quot; 200 56156Initializing database..Performing system checks...[2023-03-29 05:01:46,560] [django::register_actions_from_dir::97] [INFO] No module named 'data_manager.actions.__pycache_'[2023-03-29 05:01:46,560] [django::register_actions_from_dir::97] [INFO] No module named 'data_manager.actions.__pycache_'System check identified no issues (1 silenced).March 29, 2023 - 05:01:46Django version 3.2.16, using settings 'label_studio.core.settings.label_studio'Starting development server at http://0.0.0.0:8080/Quit the server with CONTROL-C.æ­¤æ—¶æ•°æ®åº“label_studio_dbé‡Œé¢ä¼šå»ºå¥½æ‰€æœ‰çš„è¡¨ï¼Œæ¯”å¦‚htx_userå­˜çš„å°±æ˜¯æ³¨å†Œçš„ç”¨æˆ·ä¿¡æ¯å¦‚æœè¦åå°æ‰§è¡Œï¼Œå¯ä»¥æ–°å»ºä¸€ä¸ªstart.shè„šæœ¬1DJANGO_DB=default POSTGRE_NAME=label_studio_db POSTGRE_USER=postgres POSTGRE_PASSWORD=xxx POSTGRE_PORT=5432 POSTGRE_HOST=192.168.123.xx label-studio start --data-dir /home/huangyc/label_ws -p 8080ç„¶åæ‰§è¡Œnohup sh start.sh &gt; log_start.log &amp;å¯¼å…¥ç°æœ‰æ ‡æ³¨å°†ç°æœ‰æ ‡æ³¨è½¬ä¸ºjsonæ ¼å¼å¯ä»¥ç”¨label-studio-converterå·¥å…·ï¼Œå®‰è£…å‘½ä»¤ä¸ºpip install label-studio-converterè½¬æ¢çš„ä¾‹å­ï¼Œç›®å½•ç»“æ„ä¸º:12345678910111213Q:.â”œâ”€images   â”œâ”€ 1.jpg   â”œâ”€ 2.jpgâ””â”€labels   â”œâ”€ 1.txt   â”œâ”€ 2.txtâ”œâ”€ classes.txt   # æ³¨æ„è¿™é‡Œçš„classes.txté‡Œé¢çš„ç±»åˆ«é¡ºåºä¸€å®šè¦æ­£ç¡®ï¼Œå¦‚æœæ˜¯ä»label-studioå‰ç«¯å¯¼å‡ºçš„ï¼Œå¥½åƒé¡ºåºä¼šæœ‰é—®é¢˜ï¼Œå¯ä»¥ç”¨notes.jsonå»è·å–æ­£ç¡®çš„é¡ºåº# ä»£ç ä¸ºannotation_labels = json_load_op('notes.json')['categories']annotation_labels = sorted(annotation_labels, key=lambda k: int(k['id']))annotation_labels = [anno['name'] for anno in annotation_labels]å‘½ä»¤è¡Œä¸º1label-studio-converter import yolo -i project-1 -o ls-tasks.json --image-root-url /data/local-files?d=tmp/imagesè¾“å‡ºls-tasks.jsonå’Œls-tasks.label_config.xmlä¸¤ä¸ªæ–‡ä»¶ï¼Œç¬¬ä¸€ä¸ªæ˜¯æ•°æ®çš„ç´¢å¼•å’Œæ ‡ç­¾ä¿¡æ¯ï¼Œç¬¬äºŒä¸ªæ˜¯é¡¹ç›®çš„æ ‡ç­¾é…ç½®æ–‡ä»¶æ­¤æ—¶è¦æŠŠæ–‡ä»¶ä¸Šä¼ åˆ°LABEL_STUDIO_LOCAL_FILES_DOCUMENT_ROOT/tmp/imagesä¸‹æ‰å¯ä»¥çœ‹åˆ°å¦‚æœè¿™é‡Œè½¬æ¢å‡ºæ¥çš„è·¯å¾„ä¸å¯¹ï¼Œå¯ä»¥ä¿®æ”¹label_studio_converter\imports\yolo.py.pyä¸‹çš„12345678910111213task = {            &quot;data&quot;: {                # eg. '../../foo+you.py' -&gt; '../../foo%2Byou.py'                &quot;image&quot;: f&quot;{image_root_url}{sp}{image_file_base}&quot; # æ”¹å®Œåçš„            },            # 'annotations' or 'predictions'            out_type: [                {                    &quot;result&quot;: [],                    &quot;ground_truth&quot;: False,                }            ]        }ä¸ç„¶ä¼šè®¿é—®ä¸åˆ°æ•°æ®å¦‚æœæ•°æ®æ²¡æœ‰æ ‡æ³¨ä¿¡æ¯ï¼Œå¯ä»¥å°†æ•°æ®ä¼ åˆ°LABEL_STUDIO_LOCAL_FILES_DOCUMENT_ROOT/tmp/imagesä¸‹ï¼Œå¹¶ç”Ÿæˆå¦‚ä¸‹jsonæ–‡ä»¶ï¼Œå¹¶åœ¨é¡¹ç›®ç•Œé¢å¯¼å…¥è¯¥æ–‡ä»¶å³å¯1234[{&quot;image&quot;:&quot;/data/local-files?d=tmp/images/175.jpg&quot;},{&quot;image&quot;:&quot;/data/local-files?d=tmp/images/696.jpg&quot;}]Cloudreveæ•°æ®å¯¼å…¥cloudreveç§æœ‰äº‘ç›˜é…ç½®åå°è¿è¡Œå®‰è£…é…ç½®CloudreveCloudreveå¯åŠ©ä½ å³åˆ»æ„å»ºå‡ºå…¼å¤‡è‡ªç”¨æˆ–å…¬ç”¨çš„ç½‘ç›˜æœåŠ¡ï¼Œé€šè¿‡å¤šç§å­˜å‚¨ç­–ç•¥çš„æ”¯æŒã€è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿç­‰ç‰¹æ€§å®ç°çµæ´»çš„æ–‡ä»¶ç®¡ç†ä½“éªŒLinux ä¸‹ï¼Œç›´æ¥è§£å‹å¹¶æ‰§è¡Œä¸»ç¨‹åºå³å¯ï¼š12345678#è§£å‹è·å–åˆ°çš„ä¸»ç¨‹åºtar -zxvf cloudreve_VERSION_OS_ARCH.tar.gz# èµ‹äºˆæ‰§è¡Œæƒé™chmod +x ./cloudreve# å¯åŠ¨ Cloudrevenohup ./cloudreve &gt; start.log &amp;Windowsä¸‹ï¼Œç›´æ¥è§£å‹è·å–åˆ°çš„ zip å‹ç¼©åŒ…ï¼Œå¯åŠ¨ cloudreve.exe å³å¯Cloudreveåœ¨é¦–æ¬¡å¯åŠ¨æ—¶ï¼Œä¼šåˆ›å»ºåˆå§‹ç®¡ç†å‘˜è´¦å·ï¼Œè¯·æ³¨æ„ä¿ç®¡ç®¡ç†å‘˜å¯†ç ï¼Œæ­¤å¯†ç åªä¼šåœ¨é¦–æ¬¡å¯åŠ¨æ—¶å‡ºç°ã€‚å¦‚æœæ‚¨å¿˜è®°åˆå§‹ç®¡ç†å‘˜å¯†ç ï¼Œéœ€è¦åˆ é™¤åŒçº§ç›®å½•ä¸‹çš„cloudreve.dbï¼Œé‡æ–°å¯åŠ¨ä¸»ç¨‹åºä»¥åˆå§‹åŒ–æ–°çš„ç®¡ç†å‘˜è´¦æˆ·ã€‚æˆ–è€…ä½¿ç”¨./cloudreve --database-script ResetAdminPasswordé‡ç½®å¯†ç Cloudreveé»˜è®¤ä¼šç›‘å¬5212ç«¯å£ã€‚ä½ å¯ä»¥åœ¨æµè§ˆå™¨ä¸­è®¿é—®http://æœåŠ¡å™¨IP:5212è¿›å…¥ Cloudreveã€‚ä»¥ä¸Šæ­¥éª¤æ“ä½œå®Œåï¼Œæœ€ç®€å•çš„éƒ¨ç½²å°±å®Œæˆäº†ã€‚ä½ å¯èƒ½éœ€è¦ä¸€äº›æ›´ä¸ºå…·ä½“çš„é…ç½®ï¼Œæ‰èƒ½è®© Cloudreve æ›´å¥½çš„å·¥ä½œç™»å½•ç®¡ç†å‘˜ï¼Œç¼–è¾‘å­˜å‚¨ç­–ç•¥ä¸‹çš„Default storage policyï¼Œå°†å­˜å‚¨æ–‡ä»¶åæ”¹ä¸º{originname}ï¼Œä¸ç„¶ä¼šé»˜è®¤ä¼šå¸¦ä¸Šä¸€äº›å‰ç¼€Cloudreveçš„æ–‡ä»¶å®é™…ä¸Šæ˜¯å­˜å‚¨åœ¨/home/huangyc/cloudreve/uploads/1ä¸‹ï¼Œåœ¨æ­¤ç›®å½•ä¸‹æ–°å»ºè½¯é“¾æ¥label_wsåˆ°label-studioçš„å·¥ä½œç›®å½•ä¸‹ï¼Œè‡³æ­¤123[root@uslave02 1]# ln -s /home/huangyc/label_ws/uploads label_ws[root@uslave02 1]# pwd/home/huangyc/cloudreve/uploads/1æ­¤æ—¶ï¼Œç•Œé¢ç½‘é¡µä¸Šå¯ä»¥çœ‹åˆ°label_wsæ–‡ä»¶å¤¹ï¼Œåç»­çš„é¡¹ç›®æ–‡ä»¶å¯ä»¥ä¼ åˆ°è¿™é‡Œï¼Œè‡³æ­¤Cloudreveé…ç½®å®Œæˆlabel-studioé¡¹ç›®è®¾ç½®è¿™é‡Œå¯ä»¥å°†label-studioé¡¹ç›®çš„äº‘å­˜å‚¨ä½ç½®è®¾ç½®ä¸ºæœ¬åœ°/home/huangyc/label_ws/uploadsï¼Œç„¶åå¯¼å…¥ä¸€ä¸‹jsonæ–‡ä»¶åˆ°é¡¹ç›®123[{&quot;image&quot;:&quot;/data/local-files?d=uploads/tricycle_samples/ç­é¬¼ä¹‹åˆƒ.png&quot;}]æœ€åé€šè¿‡Cloudreveï¼ŒæŠŠæ–‡ä»¶ç­é¬¼ä¹‹åˆƒ.pngä¸Šä¼ åˆ°label_ws/tricycle_samplesä¸‹å°±å¯ä»¥çœ‹åˆ°å›¾ç‰‡äº†ï¼Œæ³¨æ„ï¼šè¿™é‡Œçš„label_wsç›¸å½“äº/home/huangyc/label_ws/uploadsï¼Œè¿™å°±æ˜¯è½¯é“¾æ¥çš„é­…åŠ›æ–°å»ºæ ‡æ³¨é¡¹ç›®åœ¨ label studio å‰ç«¯ä¸»é¡µä¸­é€‰æ‹©åˆ›å»ºé¡¹ç›®ï¼Œä¸»è¦æµç¨‹å¡«å†™é¡¹ç›®åŸºæœ¬ä¿¡æ¯å¯¼å…¥æ•°æ®é€‰æ‹©æ ‡è®°æ¨¡æ¿: label studioå†…ç½®äº†å¾ˆå¤šå¸¸è§çš„æ·±åº¦å­¦ä¹ æ ‡è®°æ¨¡æ¿ä»¥ä¸‹æ˜¯ç›®æ ‡æ£€æµ‹çš„æ¨¡æ¿12345678910&lt;View&gt;  &lt;Image name=&quot;image&quot; value=&quot;$image&quot; zoom=&quot;true&quot; showMousePos=&quot;true&quot; zoomControl=&quot;true&quot; rotateControl=&quot;true&quot;/&gt;  &lt;View&gt;    &lt;Filter toName=&quot;label&quot; minlength=&quot;0&quot; name=&quot;filter&quot;/&gt;    &lt;RectangleLabels name=&quot;label&quot; toName=&quot;image&quot;&gt;      &lt;Label value=&quot;tricycle&quot; background=&quot;#ca9eff&quot; category=&quot;0&quot;/&gt;      &lt;Label value=&quot;person&quot; background=&quot;#50b01c&quot; category=&quot;1&quot;/&gt;    &lt;/RectangleLabels&gt;  &lt;/View&gt;&lt;/View&gt;categoryå¾ˆé‡è¦ï¼Œèƒ½ä¿è¯æ ‡ç­¾çš„é¡ºåºï¼Œè¿™é‡Œè¦ä»0å¼€å§‹æ­¤æ—¶æˆ‘ä»¬å·²ç»å¯ä»¥é€šè¿‡ label studio è¿›è¡Œæ™®é€šçš„å›¾ç‰‡æ ‡è®°å·¥ä½œï¼Œå¦‚æœè¦ä½¿ç”¨å…¶æä¾›çš„è¾…åŠ©é¢„æ ‡è®°åŠŸèƒ½ï¼Œåˆ™éœ€è¦è¿›è¡Œåç»­é…ç½®åç«¯label studio mlæ˜¯label studioçš„åç«¯é…ç½®ï¼Œå…¶ä¸»è¦æä¾›äº†ä¸€ç§èƒ½å¤Ÿå¿«é€Ÿå°†AIæ¨¡å‹å°è£…ä¸ºlabel studioå¯ä½¿ç”¨çš„é¢„æ ‡è®°æœåŠ¡(æä¾›æ¨¡å‹é¢„æµ‹æœåŠ¡)å®‰è£…: ä¾èµ–äº†rqåº“å’Œredisåº“ï¼Œæ³¨æ„æœ‰äº›åº“çš„ç‰ˆæœ¬ä¸èƒ½è¿‡é«˜1pip install label-studio-mlåˆ›å»ºåç«¯æ¨¡å‹å¯¼å…¥ç›¸å…³åº“12345678910111213import osfrom PIL import Imagefrom label_studio_ml import modelfrom label_studio_ml.model import LabelStudioMLBasefrom label_studio_ml.utils import get_envfrom label_studio_tools.core.utils.io import get_local_pathmodel.LABEL_STUDIO_ML_BACKEND_V2 = Trueos.environ['HOSTNAME'] = 'http://192.168.123.xx:8080'os.environ['API_KEY'] = 'TOKEN,åœ¨é¡¹ç›®çš„settingsé‡Œé¢å¤åˆ¶'os.environ['LABEL_STUDIO_ML_BACKEND_V2'] = 'True'æ¨¡å‹ç±»1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980class MyModel(LabelStudioMLBase):    def __init__(self, **kwargs):        super(MyModel, self).__init__(**kwargs)        # æŒ‰ mmdetection çš„æ–¹å¼åŠ è½½æ¨¡å‹åŠæƒé‡        print(kwargs)        print(&quot;åˆå§‹åŒ–å®Œæˆ&quot;)    def predict(self, tasks, **kwargs):        # è·å–å¾…æ ‡è®°å›¾ç‰‡        print(&quot;å¼€å§‹é¢„æµ‹&quot;)        images = [get_local_path(task['data']['image'], hostname=HOSTNAME, access_token=API_KEY) for task in tasks]        results = []        all_scores = []        # è¿™é‡Œåªæ˜¯ç¤ºä¾‹, è¿”å›ç»“æœéƒ½ä¸€æ ·        for img_path in images:            for _ in range(1):                w, h = Image.open(img_path).size                pixel_x, pixel_y, pixel_width, pixel_height = convert_to_ls(0, 0, 200, 250, w, h)                result = {                    'id': '0',  # å¿…é¡»ä¸º strï¼Œå¦åˆ™å‰ç«¯ä¸æ˜¾ç¤º                    'from_name': 'label',                    'to_name': 'image',                    'type': 'rectanglelabels',                    'value': {                        'rectanglelabels': ['tricycle'],                        'x': pixel_x,  # xy ä¸ºå·¦ä¸Šè§’åæ ‡ç‚¹                        'y': pixel_y,                        'width': pixel_width,  # width,height ä¸ºå®½é«˜                        'height': pixel_height                    },                    'score': 0.95                }                results.append(result)                all_scores.append(0.95)        print(tasks)        print(kwargs)        avg_score = sum(all_scores) / max(len(all_scores), 1)        results = [{            'result': results,            'score': avg_score        }]        return results    def fit(self, completions, num_epochs=5, **kwargs):        &quot;&quot;&quot; æ¨¡å‹è®­ç»ƒ &quot;&quot;&quot;        print(&quot;å¼€å§‹è®­ç»ƒ&quot;)        if self.gen_train_data(project_id):            # è®­ç»ƒæ¨¡å‹            return {'model_path': r'\runs\detect\TriCycle\weights\best.pt'}        else:            raise &quot;gen_train_data error&quot;    def gen_train_data(self, project_id):        &quot;&quot;&quot; è·å–æ•°æ®è®­ç»ƒæ•°æ® &quot;&quot;&quot;        print(&quot;è·å–æ•°æ® project_id&quot;, project_id)        import zipfile        import glob        download_url = f'{HOSTNAME.rstrip(&quot;/&quot;)}/api/projects/{project_id}/export?export_type=COCO&amp;download_all_tasks=false&amp;download_resources=true'        response = requests.get(download_url, headers={'Authorization': f'Token {API_KEY}'})        zip_path = os.path.join(conf['workdir'], &quot;train.zip&quot;)        train_path = os.path.join(conf['workdir'], &quot;train&quot;)        with open(zip_path, 'wb') as file:            file.write(response.content)  # é€šè¿‡äºŒè¿›åˆ¶å†™æ–‡ä»¶çš„æ–¹å¼ä¿å­˜è·å–çš„å†…å®¹            file.flush()        f = zipfile.ZipFile(zip_path)  # åˆ›å»ºå‹ç¼©åŒ…å¯¹è±¡        f.extractall(train_path)  # å‹ç¼©åŒ…è§£å‹ç¼©        f.close()        os.remove(zip_path)        if not os.path.exists(os.path.join(train_path, &quot;images&quot;, str(project_id))):            os.makedirs(os.path.join(train_path, &quot;images&quot;, str(project_id)))        for img in glob.glob(os.path.join(train_path, &quot;images&quot;, &quot;*.jpg&quot;)):            basename = os.path.basename(img)            shutil.move(img, os.path.join(train_path, &quot;images&quot;, str(project_id), basename))        return Trueå¯åŠ¨åç«¯æœåŠ¡: åˆ†ä¸ºä¸‰æ­¥ï¼Œç”ŸæˆæœåŠ¡ä»£ç +å¯åŠ¨æœåŠ¡+è¿æ¥æœåŠ¡+è®­ç»ƒæ¨¡å‹ç¬¬ä¸€æ­¥ï¼šç”ŸæˆæœåŠ¡ä»£ç 1label-studio-ml init backend/model --script label_studio_backend/yolo_detection.py --forcelabel-studio-ml init å‘½ä»¤æä¾›äº†ä¸€ç§æ ¹æ®åç«¯æ¨¡å‹è‡ªåŠ¨ç”Ÿæˆåç«¯æœåŠ¡ä»£ç çš„åŠŸèƒ½ï¼Œ model ä¸ºè¾“å‡ºç›®å½•ï¼Œ --script æŒ‡å®šåç«¯æ¨¡å‹è·¯å¾„ï¼Œ --force è¡¨ç¤ºè¦†ç›–ç”Ÿæˆã€‚è¯¥å‘½ä»¤æ‰§è¡ŒæˆåŠŸåä¼šåœ¨ backend ç›®å½•ä¸‹ç”Ÿæˆ model ç›®å½•ä¸»è¦åŒ…æ‹¬äº†_wsgi.pyã€docker-compose.ymlã€Dockerfileã€yolo_detection.pyç­‰æ–‡ä»¶ç¬¬äºŒæ­¥ï¼šå¯åŠ¨æœåŠ¡å¦‚æœæœ‰ä¾èµ–çš„æ–‡ä»¶ï¼Œéœ€è¦è‡ªå·±å¤åˆ¶åˆ° model ç›®å½•ä¸‹ï¼Œæ¥ç€å¯åŠ¨åç«¯æœåŠ¡123label-studio-ml start backend/model --host 0.0.0.0 -p 8888# orpython backend/model/_wsgi.py --host 0.0.0.0 -p 8888  # æ–¹ä¾¿debugå¯åŠ¨æˆåŠŸçš„è¯ï¼Œæ§åˆ¶å°ä¼šè¾“å‡ºå¦‚ä¸‹çš„æ—¥å¿—12345678910=&gt; ROOT =  Q:\pyCharmWS\object_detection\smart_city_management\label_studio_backend\backend\yolo-detector=&gt; LABEL STUDIO HOSTNAME =  http://192.168.123.xx:8080 * Serving Flask app &quot;label_studio_ml.api&quot; (lazy loading) * Environment: production   WARNING: This is a development server. Do not use it in a production deployment.   Use a production WSGI server instead. * Debug mode: off[2023-03-29 14:21:59,286] [WARNING] [werkzeug::_log::225]  * Running on all addresses.   WARNING: This is a development server. Do not use it in a production deployment.[2023-03-29 14:21:59,286] [INFO] [werkzeug::_log::225]  * Running on http://10.10.0.xx:8888/ (Press CTRL+C to quit)PS: æµ‹è¯•çš„æ—¶å€™å‘ç°ï¼Œç›´æ¥æ‰§è¡Œ_wsgi.pyæ–‡ä»¶ä¸€æ ·å¯ä»¥å¯åŠ¨åç«¯ï¼Œè·Ÿè¸ªlabel_studio_mlçš„server.pyæ–‡ä»¶å¯ä»¥çœ‹åˆ°æ‰§è¡Œæ ¸å¿ƒä»£ç 12345678910def main():    args, subargs = get_args()    if args.command == 'init':        create_dir(args)    elif args.command == 'start':        start_server(args, subargs)    elif args.command == 'deploy':        if args.provider == 'gcp':            deploy_to_gcp(args)ç¬¬ä¸‰æ­¥ï¼šè¿æ¥æœåŠ¡åœ¨æˆ‘ä»¬åˆ›å»ºçš„å‰ç«¯é¡¹ç›®ä¸­ä¾æ¬¡é€‰æ‹© Settings -&gt; Machine Learning -&gt; Add model ï¼Œç„¶åè¾“å…¥åç«¯åœ°å€ http://10.100.143.xxx:8888/(è¿™é‡Œæ˜¯åç«¯çš„åœ°å€å’Œç«¯å£)ï¼Œç‚¹å‡»ä¿å­˜æ­¤æ—¶æˆ‘ä»¬ä»å‰ç«¯é¡¹ç›®ä¸­æ‰“å¼€å¾…æ ‡è®°å›¾ç‰‡ï¼Œå‰ç«¯ä¼šè‡ªåŠ¨è¯·æ±‚åç«¯å¯¹å…¶è¿›è¡Œæ ‡è®°(è°ƒç”¨åç«¯çš„ predict æ–¹æ³•)ï¼Œç­‰å¾…ç‰‡åˆ»åå³å¯çœ‹è§é¢„æ ‡è®°ç»“æœï¼Œæˆ‘ä»¬åªéœ€è¦å¤§è‡´æ ¸å¯¹æ— è¯¯åç‚¹å‡» submit å³å¯å¦‚æœè§‰å¾—æ¯æ¬¡æ‰“å¼€å›¾ç‰‡éƒ½éœ€è¦ç­‰å¾…ç‰‡åˆ»æ‰ä¼šæ”¶åˆ°åç«¯é¢„æµ‹ç»“æœæ¯”è¾ƒè´¹æ—¶ï¼Œå¯ä»¥åœ¨ Settings -&gt; Machine Learning è®¾ç½®ä¸­é€‰æ‹©æ‰“å¼€ Retrieve predictions when loading a task automatically ï¼Œæ­¤åå‰ç«¯ä¼šåœ¨æˆ‘ä»¬æ¯æ¬¡æ‰“å¼€é¡¹ç›®æ—¶è‡ªåŠ¨å¯¹æ‰€æœ‰ä»»åŠ¡è¿›è¡Œè‡ªåŠ¨é¢„æµ‹ï¼ŒåŸºæœ¬èƒ½å¤Ÿåšåˆ°æ— ç­‰å¾…ç¬¬å››æ­¥ï¼šè®­ç»ƒæ¨¡å‹åœ¨ Settings -&gt; Machine Learning ä¸­ç‚¹å‡»åç«¯æœåŠ¡çš„ Start Training æŒ‰é’®ï¼Œå³å¯è°ƒç”¨åç«¯æ¨¡å‹ä½¿ç”¨å·²æ ‡è®°ä¿¡æ¯è¿›è¡Œè®­ç»ƒä¹Ÿå¯ä»¥ Settings -&gt; Machine Learning ä¸­å…è®¸æ¨¡å‹è‡ªåŠ¨è®­ç»ƒï¼Œä½†è®­ç»ƒé¢‘ç‡è¿‡é«˜ä¼šå½±å“ç¨‹åºæ•ˆç‡ç›®æ ‡æ£€æµ‹ä»»åŠ¡æ³¨æ„äº‹é¡¹predictè¿”å›çš„åæ ‡ä¸ºconvert_to_lsè½¬æ¢åçš„åæ ‡å€¼123456789101112131415161718192021222324252627282930# convert from LS percent units to pixels def convert_from_ls(result):    if 'original_width' not in result or 'original_height' not in result:        return None    value = result['value']    w, h = result['original_width'], result['original_height']    if all([key in value for key in ['x', 'y', 'width', 'height']]):        return w * value['x'] / 100.0, \               h * value['y'] / 100.0, \               w * value['width'] / 100.0, \               h * value['height'] / 100.0# convert from pixels to LS percent units def convert_to_ls(x, y, width, height, original_width, original_height):    return x / original_width * 100.0, y / original_height * 100.0, \           width / original_width * 100.0, height / original_height * 100# convert from LSoutput = convert_from_ls(task['annotations'][0]['result'][0])if output is None:    raise Exception('Wrong convert') pixel_x, pixel_y, pixel_width, pixel_height = outputprint(pixel_x, pixel_y, pixel_width, pixel_height)# convert back to LS x, y, width, height = convert_to_ls(pixel_x, pixel_y, pixel_width, pixel_height, 600, 403)print(x, y, width, height)Roboflowå¦‚ä½•ä½¿ç”¨ Roboflow æ ‡æ³¨å…³é”®ç‚¹</content>
	</entry>
	<entry>
		<title>pytorchå­¦ä¹ è®°å½•</title>
		<url>/article/53039.html</url>
		<content>pytorchä¸­æ–‡æ–‡æ¡£torchåŸºæœ¬æ“ä½œtorch.is_tensor: å¦‚æœobjæ˜¯ä¸€ä¸ªpytorchå¼ é‡ï¼Œåˆ™è¿”å›True1234x=torch.tensor([1,2,3])torch.is_tensor(x)Out[0]: Truetorch.is_storage: å¦‚ä½•objæ˜¯ä¸€ä¸ªpytorch storageå¯¹è±¡ï¼Œåˆ™è¿”å›True1234x=torch.tensor([1,2,3])torch.is_storage(x)Out[0]: Falsetorch.numel: è¿”å›input å¼ é‡ä¸­çš„å…ƒç´ ä¸ªæ•°1234567a = torch.randn(1,2,3,4,5)torch.numel(a)Out[0]: 120a = torch.zeros(4,4)torch.numel(a)Out[1]: 16torch.set_printoptions: è®¾ç½®æ‰“å°é€‰é¡¹å‚æ•°:precision â€“ æµ®ç‚¹æ•°è¾“å‡ºçš„ç²¾åº¦ä½æ•° (é»˜è®¤ä¸º8 )threshold â€“ é˜ˆå€¼ï¼Œè§¦å‘æ±‡æ€»æ˜¾ç¤ºè€Œä¸æ˜¯å®Œå…¨æ˜¾ç¤º(repr)çš„æ•°ç»„å…ƒç´ çš„æ€»æ•° ï¼ˆé»˜è®¤ä¸º1000ï¼‰edgeitems â€“ æ±‡æ€»æ˜¾ç¤ºä¸­ï¼Œæ¯ç»´ï¼ˆè½´ï¼‰ä¸¤ç«¯æ˜¾ç¤ºçš„é¡¹æ•°ï¼ˆé»˜è®¤å€¼ä¸º3ï¼‰linewidth â€“ ç”¨äºæ’å…¥è¡Œé—´éš”çš„æ¯è¡Œå­—ç¬¦æ•°ï¼ˆé»˜è®¤ä¸º80ï¼‰ã€‚Thresholded matricies will ignore this parameter.profile â€“ prettyæ‰“å°çš„å®Œå…¨é»˜è®¤å€¼ã€‚ å¯ä»¥è¦†ç›–ä¸Šè¿°æ‰€æœ‰é€‰é¡¹ (é»˜è®¤ä¸ºshort, full)åˆ›å»ºæ“ä½œ Creation Opstorch.eye: è¿”å›ä¸€ä¸ª2ç»´å¼ é‡ï¼Œå¯¹è§’çº¿ä½ç½®å…¨1ï¼Œå…¶å®ƒä½ç½®å…¨0å‚æ•°:n (int ) â€“ è¡Œæ•°m (int, optional) â€“ åˆ—æ•°.å¦‚æœä¸ºNone,åˆ™é»˜è®¤ä¸ºnout (Tensor, optinal) - Output tensor123456torch.eye(3)Out[0]:  1  0  0 0  1  0 0  0  1 [torch.FloatTensor of size 3x3]from_numpy: å°†numpy.ndarray è½¬æ¢ä¸ºpytorchçš„ Tensorã€‚ è¿”å›çš„å¼ é‡tensorå’Œnumpyçš„ndarrayå…±äº«åŒä¸€å†…å­˜ç©ºé—´ã€‚ä¿®æ”¹ä¸€ä¸ªä¼šå¯¼è‡´å¦å¤–ä¸€ä¸ªä¹Ÿè¢«ä¿®æ”¹ã€‚è¿”å›çš„å¼ é‡ä¸èƒ½æ”¹å˜å¤§å°1234567a = numpy.array([1, 2, 3])t = torch.from_numpy(a)Out[0]: torch.LongTensor([1, 2, 3])t[0] = -1aOut[1]: array([-1,  2,  3])torch.linspace: è¿”å›ä¸€ä¸ª1ç»´å¼ é‡ï¼ŒåŒ…å«åœ¨åŒºé—´start å’Œ end ä¸Šå‡åŒ€é—´éš”çš„stepsä¸ªç‚¹ã€‚ è¾“å‡º1ç»´å¼ é‡çš„é•¿åº¦ä¸ºstepså‚æ•°:start (float) â€“ åºåˆ—çš„èµ·å§‹ç‚¹end (float) â€“ åºåˆ—çš„æœ€ç»ˆå€¼steps (int) â€“ åœ¨start å’Œ endé—´ç”Ÿæˆçš„æ ·æœ¬æ•°out (Tensor, optional) â€“ ç»“æœå¼ é‡123456789torch.linspace(3, 10, steps=5)Out[0]:   3.0000  4.7500  6.5000  8.2500 10.0000[torch.FloatTensor of size 5]torch.logspace: å‚æ•°:start (float) â€“ åºåˆ—çš„èµ·å§‹ç‚¹end (float) â€“ åºåˆ—çš„æœ€ç»ˆå€¼steps (int) â€“ åœ¨å¼€å§‹å’Œç»“æŸä¹‹é—´è¦é‡‡æ ·çš„ç‚¹æ•°ã€‚é»˜è®¤å€¼ï¼š100out (Tensor, optional) â€“ ç»“æœå¼ é‡123456789torch.logspace(start=0.1, end=1.0, steps=5)Out[0]:   1.2589  2.1135  3.5481  5.9566 10.0000[torch.FloatTensor of size 5]torch.ones: è¿”å›ä¸€ä¸ªå…¨ä¸º1 çš„å¼ é‡ï¼Œå½¢çŠ¶ç”±å¯å˜å‚æ•°sizeså®šä¹‰123456torch.ones(2, 3)Out[0]:  1  1  1 1  1  1[torch.FloatTensor of size 2x3]torch.rand: è¿”å›ä¸€ä¸ªå¼ é‡ï¼ŒåŒ…å«äº†ä»åŒºé—´[0,1)çš„å‡åŒ€åˆ†å¸ƒä¸­æŠ½å–çš„ä¸€ç»„éšæœºæ•°ï¼Œå½¢çŠ¶ç”±å¯å˜å‚æ•°sizes å®šä¹‰123456torch.rand(2, 3)Out[0]:  0.5010  0.5140  0.0719 0.1435  0.5636  0.0538[torch.FloatTensor of size 2x3]torch.randn: è¿”å›ä¸€ä¸ªå¼ é‡ï¼ŒåŒ…å«äº†ä»æ ‡å‡†æ­£æ€åˆ†å¸ƒ(å‡å€¼ä¸º0ï¼Œæ–¹å·®ä¸º 1ï¼Œå³é«˜æ–¯ç™½å™ªå£°)ä¸­æŠ½å–ä¸€ç»„éšæœºæ•°123456torch.randn(2, 3)Out[0]:  1.4339  0.3351 -1.0999 1.5458 -0.9643 -0.3558[torch.FloatTensor of size 2x3]torch.randperm: ç»™å®šå‚æ•°nï¼Œè¿”å›ä¸€ä¸ªä»0 åˆ°n -1 çš„éšæœºæ•´æ•°æ’åˆ—12345torch.randperm(4)Out[0]: tensor([1, 0, 2, 3])    torch.randperm(6)Out[1]: tensor([1, 0, 3, 2, 5, 4])torch.arange: torch.arange(start, end, step=1, out=None) â†’ Tensorå‚æ•°:start (float) â€“ åºåˆ—çš„èµ·å§‹ç‚¹end (float) â€“ åºåˆ—çš„ç»ˆæ­¢ç‚¹step (float) â€“ ç›¸é‚»ç‚¹çš„é—´éš”å¤§å°out (Tensor, optional) â€“ ç»“æœå¼ é‡123torch.arange(1, 2.5, 0.5)Out[0]: tensor([1.0000, 1.5000, 2.0000])torch.zeros: è¿”å›ä¸€ä¸ªå…¨ä¸ºæ ‡é‡ 0 çš„å¼ é‡12345torch.zeros(2, 3)Out[0]: tensor([[0., 0., 0.],        [0., 0., 0.]])ç´¢å¼•|åˆ‡ç‰‡|è¿æ¥|æ¢ä½torch.cat: ç»™å®šç»´åº¦ä¸Šå¯¹è¾“å…¥çš„å¼ é‡åºåˆ—seq è¿›è¡Œè¿æ¥æ“ä½œtorch.cat()å¯ä»¥çœ‹åš torch.split() å’Œ torch.chunk()çš„åæ“ä½œå‚æ•°:inputs (sequence of Tensors) â€“ å¯ä»¥æ˜¯ä»»æ„ç›¸åŒTensor ç±»å‹çš„python åºåˆ—dimension (int, optional) â€“ æ²¿ç€æ­¤ç»´è¿æ¥å¼ é‡åºåˆ—12345678910x = torch.randn(1, 2)torch.cat((x, x, x), 0)Out[0]: tensor([[ 0.6030, -0.0292],        [ 0.6030, -0.0292],        [ 0.6030, -0.0292]])torch.cat((x, x, x), 1)Out[1]: tensor([[ 0.6030, -0.0292,  0.6030, -0.0292,  0.6030, -0.0292]])torch.chunk: torch.chunk(tensor, chunks, dim=0)åœ¨ç»™å®šç»´åº¦(è½´)ä¸Šå°†è¾“å…¥å¼ é‡è¿›è¡Œåˆ†å—å„¿å‚æ•°:tensor (Tensor) â€“ å¾…åˆ†å—çš„è¾“å…¥å¼ é‡chunks (int) â€“ åˆ†å—çš„ä¸ªæ•°dim (int) â€“ æ²¿ç€æ­¤ç»´åº¦è¿›è¡Œåˆ†å—12345678torch.arange(11).chunk(4)Out[0]: (tensor([0, 1, 2]), tensor([3, 4, 5]), tensor([6, 7, 8]), tensor([ 9, 10]))torch.rand((3,2)).chunk(3,dim=0)Out[1]: (tensor([[0.4479, 0.8420]]), tensor([[0.2951, 0.9858]]), tensor([[0.2795, 0.7413]]))torch.gather: torch.gather(input, dim, index, out=None) â†’ Tensoræ²¿ç»™å®šè½´dimï¼Œå°†è¾“å…¥ç´¢å¼•å¼ é‡indexæŒ‡å®šä½ç½®çš„å€¼è¿›è¡Œèšåˆå‚æ•°:input (Tensor) â€“ æºå¼ é‡dim (int) â€“ ç´¢å¼•çš„è½´index (LongTensor) â€“ èšåˆå…ƒç´ çš„ä¸‹æ ‡out (Tensor, optional) â€“ ç›®æ ‡å¼ é‡123456789101112t = torch.Tensor([[1,2],[3,4]])torch.gather(t, 1, torch.LongTensor([[0,0],[1,0]]))Out[0]: tensor([[1., 1.],        [4., 3.]])t = torch.Tensor([[1, 2], [3, 4], [5, 6]])torch.gather(t, 1, torch.LongTensor([[0,0],[1,0]]))Out[1]: tensor([[1., 1.],        [4., 3.]])torch.index_select: torch.index_select(input, dim, index, out=None) â†’ Tensoræ²¿ç€æŒ‡å®šç»´åº¦å¯¹è¾“å…¥è¿›è¡Œåˆ‡ç‰‡ï¼Œå–indexä¸­æŒ‡å®šçš„ç›¸åº”é¡¹(indexä¸ºä¸€ä¸ªLongTensor)ï¼Œç„¶åè¿”å›åˆ°ä¸€ä¸ªæ–°çš„å¼ é‡ï¼Œ è¿”å›çš„å¼ é‡ä¸åŸå§‹å¼ é‡Tensoræœ‰ç›¸åŒçš„ç»´åº¦(åœ¨æŒ‡å®šè½´ä¸Š)å‚æ•°:input (Tensor) â€“ è¾“å…¥å¼ é‡dim (int) â€“ ç´¢å¼•çš„è½´index (LongTensor) â€“ åŒ…å«ç´¢å¼•ä¸‹æ ‡çš„ä¸€ç»´å¼ é‡out (Tensor, optional) â€“ ç›®æ ‡å¼ é‡123456789101112131415161718x = torch.randn(3, 4)Out[0]: tensor([[-0.8335,  1.2611,  0.6569, -0.1598],        [-0.1019,  1.5010, -1.4486, -2.2269],        [-0.6087, -0.6940, -0.2556, -1.1843]])indices = torch.LongTensor([0, 2])torch.index_select(x, 0, indices)Out[1]: tensor([[-0.8335,  1.2611,  0.6569, -0.1598],        [-0.6087, -0.6940, -0.2556, -1.1843]])torch.index_select(x, 1, indices)Out[2]: tensor([[-0.8335,  0.6569],        [-0.1019, -1.4486],        [-0.6087, -0.2556]])torch.masked_select: torch.masked_select(input, mask, out=None) â†’ Tensoræ ¹æ®æ©ç å¼ é‡maskä¸­çš„äºŒå…ƒå€¼ï¼Œå–è¾“å…¥å¼ é‡ä¸­çš„æŒ‡å®šé¡¹( maskä¸ºä¸€ä¸ª ByteTensor)ï¼Œå°†å–å€¼è¿”å›åˆ°ä¸€ä¸ªæ–°çš„1Då¼ é‡å¼ é‡ maské¡»è·Ÿinputå¼ é‡æœ‰ç›¸åŒæ•°é‡çš„å…ƒç´ æ•°ç›®ï¼Œä½†å½¢çŠ¶æˆ–ç»´åº¦ä¸éœ€è¦ç›¸åŒ1234567891011121314x = torch.randn(3, 4)Out[0]: tensor([[-0.8335,  1.2611,  0.6569, -0.1598],        [-0.1019,  1.5010, -1.4486, -2.2269],        [-0.6087, -0.6940, -0.2556, -1.1843]])mask = x.ge(0.5)Out[1]: tensor([[ True,  True,  True,  True],        [False, False, False,  True],        [False, False, False, False]])   torch.masked_select(x, mask)Out[2]: tensor([1.2394, 0.5152, 0.5170, 1.8193, 0.7352])torch.nonzero: ç”¨äºè¾“å‡ºæ•°ç»„çš„éé›¶å€¼çš„ç´¢å¼•ï¼Œå³ç”¨æ¥å®šä½æ•°ç»„ä¸­éé›¶çš„å…ƒç´ as_tupleï¼šå¦‚æœè®¾ä¸ºFalseï¼Œåˆ™è¿”å›ä¸€ä¸ªäºŒç»´å¼ é‡ï¼Œå…¶ä¸­æ¯ä¸€è¡Œéƒ½æ˜¯éé›¶å€¼çš„ç´¢å¼•1234567891011121314151617torch.nonzero(torch.Tensor([1, 1, 1, 0, 1]))Out[0]: tensor([[0],        [1],        [2],        [4]])torch.nonzero(torch.Tensor([[0.6, 0.0, 0.0, 0.0],                             [0.0, 0.4, 0.0, 0.0],                             [0.0, 0.0, 1.2, 0.0],                             [0.0, 0.0, 1, -0.4]]))Out[1]: tensor([[0, 0],        [1, 1],        [2, 2],        [3, 2],        [3, 3]])torch.split: torch.split(tensor, split_size, dim=0)å°†è¾“å…¥å¼ é‡åˆ†å‰²æˆç›¸ç­‰å½¢çŠ¶çš„chunks(å¦‚æœå¯åˆ†)å¦‚æœæ²¿æŒ‡å®šç»´çš„å¼ é‡å½¢çŠ¶å¤§å°ä¸èƒ½è¢«split_size æ•´åˆ†ï¼Œ åˆ™æœ€åä¸€ä¸ªåˆ†å—ä¼šå°äºå…¶å®ƒåˆ†å—å‚æ•°:tensor (Tensor) â€“ å¾…åˆ†å‰²å¼ é‡split_size (int) â€“ å•ä¸ªåˆ†å—çš„å½¢çŠ¶å¤§å°dim (int) â€“ æ²¿ç€æ­¤ç»´è¿›è¡Œåˆ†å‰²1234567891011121314151617181920212223a = torch.arange(10).reshape(5,2)Out[0]: tensor([[0, 1],        [2, 3],        [4, 5],        [6, 7],        [8, 9]])torch.split(a, 2)Out[1]: (tensor([[0, 1],         [2, 3]]), tensor([[4, 5],         [6, 7]]), tensor([[8, 9]]))torch.split(a, [1,4])Out[2]: (tensor([[0, 1]]), tensor([[2, 3],         [4, 5],         [6, 7],         [8, 9]]))torch.squeeze: torch.squeeze(input, dim=None, out=None)å°†è¾“å…¥å¼ é‡å½¢çŠ¶ä¸­çš„1 å»é™¤å¹¶è¿”å›ã€‚ å¦‚æœè¾“å…¥æ˜¯å½¢å¦‚(AÃ—1Ã—BÃ—1Ã—CÃ—1Ã—D)(AÃ—1Ã—BÃ—1Ã—CÃ—1Ã—D)ï¼Œé‚£ä¹ˆè¾“å‡ºå½¢çŠ¶å°±ä¸ºï¼š (AÃ—BÃ—CÃ—D)å½“ç»™å®šdimæ—¶ï¼Œé‚£ä¹ˆæŒ¤å‹æ“ä½œåªåœ¨ç»™å®šç»´åº¦ä¸Šã€‚ä¾‹å¦‚ï¼Œè¾“å…¥å½¢çŠ¶ä¸º: (AÃ—1Ã—B)(AÃ—1Ã—B), squeeze(input, 0) å°†ä¼šä¿æŒå¼ é‡ä¸å˜ï¼Œåªæœ‰ç”¨ squeeze(input, 1)ï¼Œå½¢çŠ¶ä¼šå˜æˆ (AÃ—B)(AÃ—B)ã€‚æ³¨æ„ï¼š è¿”å›å¼ é‡ä¸è¾“å…¥å¼ é‡å…±äº«å†…å­˜ï¼Œæ‰€ä»¥æ”¹å˜å…¶ä¸­ä¸€ä¸ªçš„å†…å®¹ä¼šæ”¹å˜å¦ä¸€ä¸ªã€‚å‚æ•°:input (Tensor) â€“ è¾“å…¥å¼ é‡dim (int, optional) â€“ å¦‚æœç»™å®šï¼Œåˆ™inputåªä¼šåœ¨ç»™å®šç»´åº¦æŒ¤å‹out (Tensor, optional) â€“ è¾“å‡ºå¼ é‡123456789101112131415x = torch.zeros(2, 1, 2, 1, 2)x.size()Out[0]: torch.Size([2, 1, 2, 1, 2])    y = torch.squeeze(x)y.size()Out[1]: torch.Size([2, 2, 2])y = torch.squeeze(x, 0)y.size()Out[2]: torch.Size([2, 1, 2, 1, 2])y = torch.squeeze(x, 1)y.size()Out[3]: torch.Size([2, 2, 1, 2])torch.unsqueeze: torch.unsqueeze(input, dim, out=None)è¿”å›ä¸€ä¸ªæ–°çš„å¼ é‡ï¼Œå¯¹è¾“å…¥çš„åˆ¶å®šä½ç½®æ’å…¥ç»´åº¦ 1æ³¨æ„ï¼š è¿”å›å¼ é‡ä¸è¾“å…¥å¼ é‡å…±äº«å†…å­˜ï¼Œæ‰€ä»¥æ”¹å˜å…¶ä¸­ä¸€ä¸ªçš„å†…å®¹ä¼šæ”¹å˜å¦ä¸€ä¸ª123456789x = torch.Tensor([1, 2, 3, 4])x.shapeOut[0]: torch.Size([4])torch.unsqueeze(x, 0).shapeOut[1]: torch.Size([1, 4])torch.unsqueeze(x, 1).shapeOut[2]: torch.Size([4, 1])torch.stack: torch.stack(sequence, dim=0)æ²¿ç€ä¸€ä¸ªæ–°ç»´åº¦å¯¹è¾“å…¥å¼ é‡åºåˆ—è¿›è¡Œè¿æ¥ã€‚ åºåˆ—ä¸­æ‰€æœ‰çš„å¼ é‡éƒ½åº”è¯¥ä¸ºç›¸åŒå½¢çŠ¶1234567891011121314151617t1 = torch.tensor([[1, 2, 3],                   [4, 5, 6],                   [7, 8, 9]])t2 = torch.tensor([[10, 20, 30],                   [40, 50, 60],                   [70, 80, 90]])t1.shape, t2.shapeOut[0]: (torch.Size([3, 3]), torch.Size([3, 3]))torch.stack((t1, t2), dim=0).shapeOut[1]: torch.Size([2, 3, 3])torch.stack((t1, t2), dim=1).shapeOut[2]: torch.Size([3, 2, 3])torch.stack((t1, t2), dim=2).shapeOut[3]: torch.Size([3, 3, 2])torch.transpose: torch.transpose(input, dim0, dim1, out=None) â†’ Tensorè¿”å›è¾“å…¥çŸ©é˜µinputçš„è½¬ç½®ã€‚äº¤æ¢ç»´åº¦dim0å’Œdim1ã€‚ è¾“å‡ºå¼ é‡ä¸è¾“å…¥å¼ é‡å…±äº«å†…å­˜ï¼Œæ‰€ä»¥æ”¹å˜å…¶ä¸­ä¸€ä¸ªä¼šå¯¼è‡´å¦å¤–ä¸€ä¸ªä¹Ÿè¢«ä¿®æ”¹ã€‚å‚æ•°:input (Tensor) â€“ è¾“å…¥å¼ é‡dim0 (int) â€“ è½¬ç½®çš„ç¬¬ä¸€ç»´dim1 (int) â€“ è½¬ç½®çš„ç¬¬äºŒç»´torch.t: torch.t(input, out=None) â†’ Tensorè¾“å…¥ä¸€ä¸ªçŸ©é˜µï¼ˆ2ç»´å¼ é‡ï¼‰ï¼Œå¹¶è½¬ç½®0, 1ç»´ã€‚ å¯ä»¥è¢«è§†ä¸ºå‡½æ•°transpose(input, 0, 1)çš„ç®€å†™123456789x = torch.randn(2, 3)x.shapeOut[0]: torch.Size([2, 3])torch.transpose(x, 0, 1).shapeOut[1]: torch.Size([3, 2])    torch.t(x).shapeOut[2]: torch.Size([3, 2])torch.unbind: torch.unbind(tensor, dim=0)[source]ç§»é™¤æŒ‡å®šç»´åï¼Œè¿”å›ä¸€ä¸ªå…ƒç»„ï¼ŒåŒ…å«äº†æ²¿ç€æŒ‡å®šç»´åˆ‡ç‰‡åçš„å„ä¸ªåˆ‡ç‰‡å‚æ•°:tensor (Tensor) â€“ è¾“å…¥å¼ é‡dim (int) â€“ åˆ é™¤çš„ç»´åº¦1234567891011121314torch.unbind(torch.tensor([[1, 2, 3],                           [4, 5, 6],                           [7, 8, 9]]))Out[0]: (tensor([1, 2, 3]), tensor([4, 5, 6]), tensor([7, 8, 9]))torch.unbind(torch.tensor([[1, 2, 3],                           [4, 5, 6],                           [7, 8, 9]]), dim=0)Out[1]: (tensor([1, 2, 3]), tensor([4, 5, 6]), tensor([7, 8, 9]))torch.unbind(torch.tensor([[1, 2, 3],                           [4, 5, 6],                           [7, 8, 9]]), dim=1)Out[2]: (tensor([1, 4, 7]), tensor([2, 5, 8]), tensor([3, 6, 9]))éšæœºæŠ½æ ·torch.seed: è®¾ç½®torch cpuéšæœºæ•°ç§å­torch.manual_seed: è®¾ç½®torch cpuéšæœºæ•°ç§å­ï¼Œtorch.manual_seed(seed)è®¾å®šç”Ÿæˆéšæœºæ•°çš„ç§å­ï¼Œå¹¶è¿”å›ä¸€ä¸ªtorch._C.Generatorå¯¹è±¡torch.cuda.manual_seed: è®¾ç½®torch cudaéšæœºæ•°ç§å­123456789torch.seed()Out[0]: 348176808892500torch.seed()Out[1]: 348177652492500torch.manual_seed(0)Out[2]: &lt;torch._C.Generator at 0x138bdf41a90&gt;torch.cuda.manual_seed(0)torch.bernoulli: torch.bernoulli(input, out=None) â†’ Tensorä»ä¼¯åŠªåˆ©åˆ†å¸ƒä¸­æå–äºŒè¿›åˆ¶éšæœºæ•°ï¼ˆ0æˆ–1ï¼‰ï¼Œè¾“å…¥å¼ é‡åº”ä¸ºåŒ…å«ç”¨äºç»˜åˆ¶äºŒè¿›åˆ¶éšæœºæ•°çš„æ¦‚ç‡çš„å¼ é‡ã€‚å› æ­¤ï¼Œè¾“å…¥ä¸­çš„æ‰€æœ‰å€¼éƒ½å¿…é¡»åœ¨ä»¥ä¸‹èŒƒå›´å†…(0,1)torch.poisson: æ³Šæ¾åˆ†å¸ƒç”¨äºè®¡ç®—ä¸€ä¸ªäº‹ä»¶åœ¨å¹³å‡ä»·å€¼ç‡(æ—¶é—´)çš„ä¸€å®šæ—¶é—´å†…å‘ç”Ÿçš„å¯èƒ½æ€§ã€‚æ³Šæ¾åˆ†å¸ƒæ˜¯ä¸€ä¸ªç¦»æ•£çš„æ¦‚ç‡åˆ†å¸ƒ123456789101112131415161718192021222324252627282930313233343536a = torch.Tensor(3, 3).uniform_(0, 1)Out[0]: tensor([[0.0044, 0.7257, 0.2599],        [0.1663, 0.2119, 0.7875],        [0.7648, 0.8838, 0.6814]])torch.bernoulli(a)Out[1]: tensor([[0., 1., 0.],        [0., 0., 1.],        [1., 1., 1.]])a = torch.ones(3, 3)torch.bernoulli(a)Out[2]: tensor([[1., 1., 1.],        [1., 1., 1.],        [1., 1., 1.]])a = torch.zeros(3, 3)torch.bernoulli(a)Out[3]: tensor([[0., 0., 0.],        [0., 0., 0.],        [0., 0., 0.]])a = torch.rand(4, 4) * 5 Out[0]: tensor([[0.2542, 1.3148, 4.2023, 2.4838],        [1.2574, 0.5842, 0.1604, 0.3900],        [1.9929, 3.8710, 3.8516, 0.0889],        [4.0595, 0.5437, 1.9715, 1.4863]])torch.poisson(a)Out[1]: tensor([[0., 1., 4., 2.],        [2., 1., 0., 0.],        [2., 8., 4., 0.],        [5., 0., 1., 2.]])torch.multinomial: torch.multinomial(input, num_samples,replacement=False, out=None) â†’ LongTensorå¯¹inputçš„æ¯ä¸€è¡Œåšn_samplesæ¬¡å–å€¼ï¼Œè¾“å‡ºçš„å¼ é‡æ˜¯æ¯ä¸€æ¬¡å–å€¼æ—¶inputå¼ é‡å¯¹åº”è¡Œçš„ä¸‹æ ‡å‚æ•°:input (Tensor) â€“ åŒ…å«æ¦‚ç‡å€¼çš„å¼ é‡num_samples (int) â€“ æŠ½å–çš„æ ·æœ¬æ•°replacement (bool, optional) â€“ å¸ƒå°”å€¼ï¼Œå†³å®šæ˜¯å¦èƒ½é‡å¤æŠ½å–out (Tensor, optional) â€“ ç»“æœå¼ é‡12345678weights = torch.Tensor([0, 10, 3, 0])torch.multinomial(weights, 4)Out[0]: tensor([2, 1, 0, 3])# replacement=Trueæ—¶ æ¦‚ç‡ä¸º0çš„æ²¡æœºä¼šè¢«å–åˆ°torch.multinomial(weights, 4, replacement=True)Out[1]: tensor([2, 1, 1, 1])torch.normal: torch.normal(means, std, out=None)è¿”å›ä¸€ä¸ªå¼ é‡ï¼ŒåŒ…å«ä»ç»™å®šå‚æ•°means,stdçš„ç¦»æ•£æ­£æ€åˆ†å¸ƒä¸­æŠ½å–éšæœºæ•°12345678910torch.normal(mean=torch.arange(1., 11.), std=torch.arange(1, 0, -0.1))Out[0]: tensor([ 0.9732,  2.0833,  2.5282,  4.3588,  5.4837,  5.1150,  7.0366,  7.9774,         9.1679, 10.0248])torch.normal(mean=0.5, std=torch.arange(1., 6.))Out[1]: tensor([ 0.7067,  2.4856, -2.1957, -4.3114, 16.2506])torch.normal(mean=torch.arange(1., 6.))Out[2]: tensor([0.7835, 4.6096, 2.7244, 5.2810, 4.8413])åºåˆ—åŒ–Serializationtorch.save: ä¿å­˜ä¸€ä¸ªå¯¹è±¡åˆ°ä¸€ä¸ªç¡¬ç›˜æ–‡ä»¶ä¸Š å‚è€ƒ: Recommended approach for saving a model torch.save(obj, f, pickle_module=pickle, pickle_protocol=DEFAULT_PROTOCOL, _use_new_zipfile_serialization=True)å‚æ•°ï¼šobj â€“ ä¿å­˜å¯¹è±¡f ï¼ ç±»æ–‡ä»¶å¯¹è±¡ (è¿”å›æ–‡ä»¶æè¿°ç¬¦)æˆ–ä¸€ä¸ªä¿å­˜æ–‡ä»¶åçš„å­—ç¬¦ä¸²pickle_module â€“ ç”¨äºpicklingå…ƒæ•°æ®å’Œå¯¹è±¡çš„æ¨¡å—pickle_protocol â€“ æŒ‡å®špickle protocal å¯ä»¥è¦†ç›–é»˜è®¤å‚æ•°12345678x = torch.tensor([0, 1, 2, 3, 4])# Save to filetorch.save(x, 'tensor.pt')# Save to io.BytesIO bufferbuffer = io.BytesIO()torch.save(x, buffer)torch.load: ä»ç£ç›˜æ–‡ä»¶ä¸­è¯»å–ä¸€ä¸ªé€šè¿‡torch.save()ä¿å­˜çš„å¯¹è±¡torch.load(f, map_location=None, pickle_module=pickle, , weights_only=False, pickle_load_args*)12345678torch.load('tensors.pt', encoding='ascii')torch.load('tensors.pt', map_location=torch.device('cpu'))torch.load('tensors.pt', map_location={'cuda:1':'cuda:0'})# Load from io.BytesIO bufferwith open('tensor.pt', 'rb') as f:    buffer = io.BytesIO(f.read())torch.load(buffer)å¹¶è¡ŒåŒ– Parallelismtorch.get_num_threads: è·å¾—ç”¨äºå¹¶è¡ŒåŒ–CPUæ“ä½œçš„OpenMPçº¿ç¨‹æ•°torch.set_num_threads: è®¾å®šç”¨äºå¹¶è¡ŒåŒ–CPUæ“ä½œçš„OpenMPçº¿ç¨‹æ•°æ•°å­¦æ“ä½œMath operationstorch.abs: è®¡ç®—è¾“å…¥å¼ é‡çš„æ¯ä¸ªå…ƒç´ ç»å¯¹å€¼12torch.abs(torch.FloatTensor([-1, -2, 3]))Out[0]: tensor([1., 2., 3.])torch.acos: torch.acos(input, out=None) â†’ Tensorè¿”å›ä¸€ä¸ªæ–°å¼ é‡ï¼ŒåŒ…å«è¾“å…¥å¼ é‡æ¯ä¸ªå…ƒç´ çš„åä½™å¼¦12torch.acos(torch.FloatTensor([-1, 1, 0]))Out[1]: tensor([3.1416, 0.0000, 1.5708])torch.add: torch.add(input, value, out=None)å¯¹è¾“å…¥å¼ é‡inputé€å…ƒç´ åŠ ä¸Šæ ‡é‡å€¼valueï¼Œå¹¶è¿”å›ç»“æœåˆ°ä¸€ä¸ªæ–°çš„å¼ é‡12345a = torch.randn(4)Out[0]: tensor([ 0.3510, -0.2226, -0.7971, -0.2564])torch.add(a, 20)Out[1]: tensor([20.3510, 19.7774, 19.2029, 19.7436])torch.addcdiv: torch.addcdiv(tensor, value=1, tensor1, tensor2, out=None) â†’ Tensorç”¨tensor2å¯¹tensor1é€å…ƒç´ ç›¸é™¤ï¼Œç„¶åä¹˜ä»¥æ ‡é‡å€¼value å¹¶åŠ åˆ°tensorå¼ é‡çš„å½¢çŠ¶ä¸éœ€è¦åŒ¹é…ï¼Œä½†å…ƒç´ æ•°é‡å¿…é¡»ä¸€è‡´å‚æ•°ï¼štensor (Tensor) â€“ å¼ é‡ï¼Œå¯¹ tensor1 ./ tensor è¿›è¡Œç›¸åŠ value (Number, optional) â€“ æ ‡é‡ï¼Œå¯¹ tensor1 ./ tensor2 è¿›è¡Œç›¸ä¹˜tensor1 (Tensor) â€“ å¼ é‡ï¼Œä½œä¸ºè¢«é™¤æ•°(åˆ†å­)tensor2 (Tensor) â€“å¼ é‡ï¼Œä½œä¸ºé™¤æ•°(åˆ†æ¯)out (Tensor, optional) â€“ è¾“å‡ºå¼ é‡12345678910111213141516t = torch.randn(1, 3)t1 = torch.randn(3, 1)t2 = torch.randn(1, 3)t, t1, t2Out[0]: (tensor([[-1.2863,  1.1267, -1.7120]]), tensor([[-0.4294],         [-0.5328],         [-0.5373]]), tensor([[-0.0876,  0.4398,  1.3583]]))torch.addcdiv(t, t1, t2, value=0.1)Out[1]: tensor([[-0.7958,  1.0291, -1.7436],        [-0.6778,  1.0056, -1.7512],        [-0.6727,  1.0046, -1.7515]])torch.addcmul: torch.addcmul(tensor, value=1, tensor1, tensor2, out=None) â†’ Tensorç”¨tensor2å¯¹tensor1é€å…ƒç´ ç›¸ä¹˜ï¼Œå¹¶å¯¹ç»“æœä¹˜ä»¥æ ‡é‡å€¼valueç„¶ååŠ åˆ°tensorå‚æ•°ï¼štensor (Tensor) â€“ å¼ é‡ï¼Œå¯¹tensor1 ./ tensor è¿›è¡Œç›¸åŠ value (Number, optional) â€“ æ ‡é‡ï¼Œå¯¹ tensor1 . tensor2 è¿›è¡Œç›¸ä¹˜tensor1 (Tensor) â€“ å¼ é‡ï¼Œä½œä¸ºä¹˜å­1tensor2 (Tensor) â€“å¼ é‡ï¼Œä½œä¸ºä¹˜å­2out (Tensor, optional) â€“ è¾“å‡ºå¼ é‡12345678910111213141516t = torch.randn(1, 3)t1 = torch.randn(3, 1)t2 = torch.randn(1, 3)t, t1, t2Out[0]: (tensor([[-1.2863,  1.1267, -1.7120]]), tensor([[-0.4294],         [-0.5328],         [-0.5373]]), tensor([[-0.0876,  0.4398,  1.3583]]))torch.addcmul(t, t1, t2, value=0.1)Out[1]: tensor([[-1.2825,  1.1078, -1.7703],        [-1.2816,  1.1033, -1.7844],        [-1.2816,  1.1031, -1.7850]])torch.asin: è¿”å›ä¸€ä¸ªæ–°å¼ é‡ï¼ŒåŒ…å«è¾“å…¥inputå¼ é‡æ¯ä¸ªå…ƒç´ çš„åæ­£å¼¦å‡½æ•°12345a = torch.randn(4)Out[0]: tensor([ 0.2583, -0.5285,  0.8979,  1.0104])torch.asin(a)Out[1]: tensor([ 0.2613, -0.5569,  1.1149,     nan])torch.atan: è¿”å›ä¸€ä¸ªæ–°å¼ é‡ï¼ŒåŒ…å«è¾“å…¥inputå¼ é‡æ¯ä¸ªå…ƒç´ çš„åæ­£åˆ‡å‡½æ•°torch.atan2: è¿”å›ä¸€ä¸ªæ–°å¼ é‡ï¼ŒåŒ…å«ä¸¤ä¸ªè¾“å…¥å¼ é‡input1å’Œinput2çš„åæ­£åˆ‡å‡½æ•°torch.atan2(input1, input2, out=None) â†’ Tensor12345678910a = torch.randn(4)Out[0]: tensor([ 0.2583, -0.5285,  0.8979,  1.0104])b = torch.randn(4)Out[2]: tensor([0.1100, 1.4311, 1.9536, 0.7652])torch.atan(a)Out[1]: tensor([ 0.2528, -0.4862,  0.7316,  0.7906])torch.atan2(a, b)Out[3]: tensor([ 1.1681, -0.3538,  0.4308,  0.9226])torch.ceil: å¯¹è¾“å…¥inputå¼ é‡æ¯ä¸ªå…ƒç´ å‘ä¸Šå–æ•´, å³å–ä¸å°äºæ¯ä¸ªå…ƒç´ çš„æœ€å°æ•´æ•°12345a = torch.randn(4)Out[0]: tensor([-0.9105, -0.7277,  0.9516, -0.1081])torch.ceil(a)Out[1]: tensor([-0., -0., 1., -0.])torch.floor: è¿”å›ä¸€ä¸ªæ–°å¼ é‡ï¼ŒåŒ…å«è¾“å…¥inputå¼ é‡æ¯ä¸ªå…ƒç´ çš„floorï¼Œå³ä¸å°äºå…ƒç´ çš„æœ€å¤§æ•´æ•°12345a = torch.randn(4)Out[0]: tensor([-0.5661, -0.9135,  1.1018, -0.2633])torch.floor(a)Out[1]: tensor([-1., -1.,  1., -1.])torch.fmod: è®¡ç®—é€å…ƒç´ ä½™æ•°ï¼Œ ä¿ç•™æ­£è´Ÿå·torch.remainder: è®¡ç®—é€å…ƒç´ ä½™æ•°ï¼Œ ç›¸å½“äºpython ä¸­çš„ % æ“ä½œç¬¦12345678910t = torch.tensor([10, -22, 31, -47])torch.fmod(t, 5)Out[0]: tensor([ 0, -2,  1, -2])torch.remainder(t, 5)Out[1]: tensor([0, 3, 1, 3])np.mod(np.array([10, -22, 31, -47]), 5)Out[2]: array([0, 3, 1, 3], dtype=int32)torch.clamp: torch.clamp(input, min, max, out=None) â†’ Tensorå°†è¾“å…¥inputå¼ é‡æ¯ä¸ªå…ƒç´ çš„å¤¹ç´§åˆ°åŒºé—´ [min,max][min,max]ï¼Œå¹¶è¿”å›ç»“æœåˆ°ä¸€ä¸ªæ–°å¼ é‡123      | min, if x_i &lt; miny_i = | x_i, if min &lt;= x_i &lt;= max      | max, if x_i &gt; max12345a = torch.randn(4)Out[0]: tensor([-0.9105, -0.7277,  0.9516, -0.1081])torch.clamp(a, min=-0.5, max=0.5)Out[1]: tensor([-0.5000, -0.5000,  0.5000, -0.1081])torch.cos: è¿”å›ä¸€ä¸ªæ–°å¼ é‡ï¼ŒåŒ…å«è¾“å…¥inputå¼ é‡æ¯ä¸ªå…ƒç´ çš„ä½™å¼¦torch.cosh: è¿”å›ä¸€ä¸ªæ–°å¼ é‡ï¼ŒåŒ…å«è¾“å…¥inputå¼ é‡æ¯ä¸ªå…ƒç´ çš„åŒæ›²ä½™å¼¦12345678a = torch.randn(4)Out[0]: tensor([-0.9105, -0.7277,  0.9516, -0.1081])torch.cos(a)Out[1]: tensor([0.6133, 0.7467, 0.5804, 0.9942])torch.cosh(a)Out[2]: tensor([1.4439, 1.2766, 1.4880, 1.0058])    torch.div(): å°†inputé€å…ƒç´ é™¤ä»¥æ ‡é‡å€¼valueï¼Œå¹¶è¿”å›ç»“æœåˆ°è¾“å‡ºå¼ é‡outtorch.div(input, value, out=None)ä¸¤å¼ é‡inputå’Œotheré€å…ƒç´ ç›¸é™¤ï¼Œå¹¶å°†ç»“æœè¿”å›åˆ°è¾“å‡ºtorch.div(input, other, **, rounding_mode=None, out=None*) â†’ Tensor1234567891011121314151617181920a = torch.randn(4)Out[0]: tensor([-0.9105, -0.7277,  0.9516, -0.1081])torch.div(a, 0.5)Out[1]: tensor([-1.8210, -1.4554,  1.9032, -0.2162])    a = torch.tensor([[-0.3711, -1.9353, -0.4605, -0.2917],                  [ 0.1815, -1.0111,  0.9805, -1.5923]])b = torch.tensor([ 0.8032,  0.2930, -0.8113, -0.2308])torch.div(a, b, rounding_mode='trunc')Out[2]: tensor([[-0., -6.,  0.,  1.],        [ 0., -3., -1.,  6.]])torch.div(a, b, rounding_mode='floor')Out[3]: tensor([[-1., -7.,  0.,  1.],        [ 0., -4., -2.,  6.]])torch.exp: è¿”å›ä¸€ä¸ªæ–°å¼ é‡ï¼ŒåŒ…å«è¾“å…¥inputå¼ é‡æ¯ä¸ªå…ƒç´ çš„æŒ‡æ•°ã€‚1234import mathtorch.exp(torch.Tensor([0, math.log(2)]))Out[0]: tensor([1., 2.])torch.frac: è¿”å›æ¯ä¸ªå…ƒç´ çš„åˆ†æ•°éƒ¨åˆ†12torch.frac(torch.Tensor([1, 2.5, -3.2]))Out[0]: tensor([ 0.0000,  0.5000, -0.2000])torch.lerp: å¯¹ä¸¤ä¸ªå¼ é‡ä»¥startï¼Œendåšçº¿æ€§æ’å€¼ï¼Œ å°†ç»“æœè¿”å›åˆ°è¾“å‡ºå¼ é‡torch.lerp(input, end, weight, **, out=None*)å‚æ•°ï¼šstart (Tensor) â€“ èµ·å§‹ç‚¹å¼ é‡end (Tensor) â€“ ç»ˆæ­¢ç‚¹å¼ é‡weight (float) â€“ æ’å€¼å…¬å¼çš„weightout (Tensor, optional) â€“ ç»“æœå¼ é‡123456789start = torch.arange(1., 5.)end = torch.empty(4).fill_(10)start, endOut[0]: (tensor([1., 2., 3., 4.]), tensor([10., 10., 10., 10.]))torch.lerp(start, end, 0.5)Out[1]: tensor([5.5000, 6.0000, 6.5000, 7.0000])torch.lerp(start, end, torch.full_like(start, 0.5))Out[2]: tensor([5.5000, 6.0000, 6.5000, 7.0000])torch.log: è®¡ç®—input çš„è‡ªç„¶å¯¹æ•°torch.log1p: è®¡ç®—$input + 1$çš„è‡ªç„¶å¯¹æ•°$y_i = log(x_i+1)$ï¼Œå¯¹å€¼æ¯”è¾ƒå°çš„è¾“å…¥ï¼Œæ­¤å‡½æ•°æ¯”torch.log()æ›´å‡†ç¡®12345678a = torch.randn(5)Out[0]: tensor([-0.3466,  2.3803, -0.0423, -0.9744,  0.4976])torch.log(a)Out[1]: tensor([    nan,  0.8672,     nan,     nan, -0.6980])torch.log1p(a)Out[2]: tensor([-0.4256,  1.2180, -0.0432, -3.6633,  0.4039])torch.mul: ç”¨æ ‡é‡å€¼valueä¹˜ä»¥è¾“å…¥inputçš„æ¯ä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„ç»“æœå¼ é‡torch.mul(input, value, out=None)ä¸¤ä¸ªå¼ é‡input,otheræŒ‰å…ƒç´ è¿›è¡Œç›¸ä¹˜ï¼Œå¹¶è¿”å›åˆ°è¾“å‡ºå¼ é‡torch.mul(input, other, out=None)12345678910a = torch.randn(3)Out[0]: tensor([ 0.0603, -0.5258, -0.3810])b = torch.randn(3)Out[1]: tensor([ 1.2408, -1.3506,  0.9296])torch.mul(a, 100)Out[2]: tensor([  6.0299, -52.5785, -38.0989])torch.mul(a, b)Out[3]: tensor([ 0.0748,  0.7101, -0.3542])torch.neg: è¿”å›ä¸€ä¸ªæ–°å¼ é‡ï¼ŒåŒ…å«è¾“å…¥input å¼ é‡æŒ‰å…ƒç´ å–è´Ÿ12345a = torch.randn(3)Out[0]: tensor([ 0.0603, -0.5258, -0.3810])torch.neg(a)Out[1]: tensor([-0.0603,  0.5258,  0.3810])torch.pow: torch.pow(input, exponent, out=None)å¯¹è¾“å…¥inputçš„æŒ‰å…ƒç´ æ±‚exponentæ¬¡å¹‚å€¼ï¼Œå¹¶è¿”å›ç»“æœå¼ é‡ã€‚ å¹‚å€¼exponent å¯ä»¥ä¸ºå•ä¸€ float æ•°æˆ–è€…ä¸inputç›¸åŒå…ƒç´ æ•°çš„å¼ é‡1234567891011a = torch.arange(1, 5)Out[0]: tensor([1, 2, 3, 4])exp = torch.arange(1, 5)Out[1]: tensor([1, 2, 3, 4])torch.pow(a, 2)Out[2]: tensor([ 1,  4,  9, 16])torch.pow(a, exp)Out[3]: tensor([  1,   4,  27, 256])torch.pow(2, exp)Out[4]: tensor([ 2,  4,  8, 16])torch.reciprocal: è¿”å›ä¸€ä¸ªæ–°å¼ é‡ï¼ŒåŒ…å«è¾“å…¥inputå¼ é‡æ¯ä¸ªå…ƒç´ çš„å€’æ•°ï¼Œå³ 1.0/x12345a = torch.Tensor([1, 2, 3, 4])Out[0]: tensor([1., 2., 3., 4.])torch.reciprocal(a)Out[1]: tensor([1.0000, 0.5000, 0.3333, 0.2500])torch.round: è¿”å›ä¸€ä¸ªæ–°å¼ é‡ï¼Œå°†è¾“å…¥inputå¼ é‡æ¯ä¸ªå…ƒç´ èˆå…¥åˆ°æœ€è¿‘çš„æ•´æ•°12345a = torch.randn(4)Out[0]: tensor([ 0.7995, -2.0975,  0.7273,  0.7539])torch.round(a)Out[1]: tensor([ 1., -2.,  1.,  1.])torch.rsqrt: è¿”å›ä¸€ä¸ªæ–°å¼ é‡ï¼ŒåŒ…å«è¾“å…¥inputå¼ é‡æ¯ä¸ªå…ƒç´ çš„å¹³æ–¹æ ¹å€’æ•°12345a = torch.Tensor([1, 2, 3, 4])Out[0]: tensor([1., 2., 3., 4.])torch.rsqrt(a)Out[1]: tensor([1.0000, 0.7071, 0.5774, 0.5000])torch.sigmoid: è¿”å›ä¸€ä¸ªæ–°å¼ é‡ï¼ŒåŒ…å«è¾“å…¥inputå¼ é‡æ¯ä¸ªå…ƒç´ çš„sigmoidå€¼12345a = torch.Tensor([1, 2, 3, 4])Out[0]: tensor([1., 2., 3., 4.])torch.sigmoid(a)Out[1]: tensor([0.7311, 0.8808, 0.9526, 0.9820])torch.sign: ç¬¦å·å‡½æ•°ï¼šè¿”å›ä¸€ä¸ªæ–°å¼ é‡ï¼ŒåŒ…å«è¾“å…¥inputå¼ é‡æ¯ä¸ªå…ƒç´ çš„æ­£è´Ÿ12345a = torch.Tensor([1, 2, 3, 4])Out[0]: tensor([1., 2., 3., 4.])torch.sign(a)Out[1]: tensor([1., 1., 1., 1.])torch.sin: è¿”å›ä¸€ä¸ªæ–°å¼ é‡ï¼ŒåŒ…å«è¾“å…¥inputå¼ é‡æ¯ä¸ªå…ƒç´ çš„æ­£å¼¦torch.sinh: è¿”å›ä¸€ä¸ªæ–°å¼ é‡ï¼ŒåŒ…å«è¾“å…¥inputå¼ é‡æ¯ä¸ªå…ƒç´ çš„åŒæ›²æ­£å¼¦123456a = torch.randn(4)torch.sin(a)Out[0]: tensor([-0.9215,  0.2650,  0.8285,  0.5914])torch.sinh(a)Out[1]: tensor([-1.4591,  0.2714,  1.1392,  0.6759])torch.sqrt: è¿”å›ä¸€ä¸ªæ–°å¼ é‡ï¼ŒåŒ…å«è¾“å…¥inputå¼ é‡æ¯ä¸ªå…ƒç´ çš„å¹³æ–¹æ ¹12345a = torch.Tensor([1, 2, 3, 4])Out[0]: tensor([1., 2., 3., 4.])torch.sqrt(a)Out[1]: tensor([1.0000, 1.4142, 1.7321, 2.0000])torch.tan: è¿”å›ä¸€ä¸ªæ–°å¼ é‡ï¼ŒåŒ…å«è¾“å…¥inputå¼ é‡æ¯ä¸ªå…ƒç´ çš„æ­£åˆ‡torch.tanh: è¿”å›ä¸€ä¸ªæ–°å¼ é‡ï¼ŒåŒ…å«è¾“å…¥inputå¼ é‡æ¯ä¸ªå…ƒç´ çš„åŒæ›²æ­£åˆ‡1234567a = torch.Tensor([1, 2, 3, 4])Out[0]: tensor([1., 2., 3., 4.])torch.tan(a)Out[1]: tensor([ 1.5574, -2.1850, -0.1425,  1.1578])torch.tanh(a)Out[2]: tensor([0.7616, 0.9640, 0.9951, 0.9993])torch.trunc: è¿”å›ä¸€ä¸ªæ–°å¼ é‡ï¼ŒåŒ…å«è¾“å…¥inputå¼ é‡æ¯ä¸ªå…ƒç´ çš„æˆªæ–­å€¼(æ ‡é‡xçš„æˆªæ–­å€¼æ˜¯æœ€æ¥è¿‘å…¶çš„æ•´æ•°)ç®€è€Œè¨€ä¹‹ï¼Œæœ‰ç¬¦å·æ•°çš„å°æ•°éƒ¨åˆ†è¢«èˆå¼ƒ12345a = torch.randn(4)Out[0]: tensor([-2.1647, -0.2294,  0.4943,  1.5146])torch.trunc(a)Out[1]: tensor([-2., -0.,  0.,  1.])Reduction Opstorch.cumprod: torch.cumprod(input, dim, out=None) â†’ Tensorè¿”å›è¾“å…¥æ²¿æŒ‡å®šç»´åº¦çš„ç´¯ç§¯ï¼Œä¾‹å¦‚ï¼Œå¦‚æœè¾“å…¥æ˜¯ä¸€ä¸ªN å…ƒå‘é‡ï¼Œåˆ™ç»“æœä¹Ÿæ˜¯ä¸€ä¸ªN å…ƒå‘é‡ï¼Œ$yi= \prod {i}{x_i}$12345a = torch.Tensor([1, 2, 3, 4])Out[0]: tensor([1., 2., 3., 4.])torch.cumprod(a, dim=0)Out[1]: tensor([ 1.,  2.,  6., 24.])torch.cumsum: torch.cumsum(input, dim, out=None) â†’ Tensorè¿”å›è¾“å…¥æ²¿æŒ‡å®šç»´åº¦çš„ç´¯åŠ ï¼Œä¾‹å¦‚ï¼Œå¦‚æœè¾“å…¥æ˜¯ä¸€ä¸ªN å…ƒå‘é‡ï¼Œåˆ™ç»“æœä¹Ÿæ˜¯ä¸€ä¸ªN å…ƒå‘é‡ï¼Œ$yi= \sum {i}{x_i}$12345a = torch.Tensor([1, 2, 3, 4])Out[0]: tensor([1., 2., 3., 4.])torch.cumsum(a, dim=0)Out[1]: tensor([ 1.,  3.,  6., 10.])torch.dist: è¿”å› (input - other) çš„ pèŒƒæ•°torch.dist(input, other, p=2, out=None) â†’ Tensorå‚æ•°ï¼šinput (Tensor) â€“ è¾“å…¥å¼ é‡other (Tensor) â€“ å³ä¾§è¾“å…¥å¼ é‡p (float, optional) â€“ æ‰€è®¡ç®—çš„èŒƒæ•°out (Tensor, optional) â€“ ç»“æœå¼ é‡1234567x = torch.Tensor([1, 2, 3, 4])y = torch.Tensor([1, 2, 3, 0])torch.dist(x, y, 3.5)Out[0]: tensor(4.0000)torch.dist(x, y, 3)Out[1]: tensor(4.)torch.norm: è¿”å›è¾“å…¥å¼ é‡input çš„ p èŒƒæ•°torch.norm(input, p=2) â†’ floatè¿”å›è¾“å…¥å¼ é‡ç»™å®šç»´dim ä¸Šæ¯è¡Œçš„p èŒƒæ•°torch.norm(input, p, dim, out=None) â†’ Tensor123456789101112a = torch.randn(1, 3)Out[0]: tensor([[ 0.7848, -0.3629,  0.4028]])torch.norm(a, 3)Out[1]: tensor(0.8418)a = torch.randn(3, 2)Out[2]: tensor([[ 1.0718,  3.1510],        [-0.3178, -0.9579],        [ 0.4065,  0.4106]])torch.norm(a, 2, 1)Out[3]: tensor([3.3283, 1.0092, 0.5778])torch.mean: è¿”å›è¾“å…¥å¼ é‡ç»™å®šç»´åº¦dimä¸Šæ¯è¡Œçš„å‡å€¼torch.median: è¿”å›è¾“å…¥å¼ é‡ç»™å®šç»´åº¦æ¯è¡Œçš„ä¸­ä½æ•°ï¼ŒåŒæ—¶è¿”å›ä¸€ä¸ªåŒ…å«ä¸­ä½æ•°çš„ç´¢å¼•çš„LongTensorå‚æ•°ï¼šinput (Tensor) â€“ è¾“å…¥å¼ é‡dim (int) â€“ ç¼©å‡çš„ç»´åº¦values (Tensor, optional) â€“ ç»“æœå¼ é‡indices (Tensor, optional) â€“ è¿”å›çš„ç´¢å¼•ç»“æœå¼ é‡1234567x = torch.Tensor([1, 2, 3, 4])torch.mean(x)Out[0]: tensor(2.5000)torch.median(x)Out[1]: tensor(2.)torch.mode: è¿”å›ç»™å®šç»´dimä¸Šï¼Œæ¯è¡Œçš„ä¼—æ•°å€¼ï¼Œ åŒæ—¶è¿”å›ä¸€ä¸ªLongTensorï¼ŒåŒ…å«ä¼—æ•°èŒçš„ç´¢å¼•torch.mode(input, dim=-1, values=None, indices=None) -&gt; (Tensor, LongTensor)è¿”å›è¾“å…¥å¼ é‡ç»™å®šç»´åº¦ä¸Šæ¯è¡Œçš„ç§¯torch.prod(input, dim, out=None) â†’ Tensor12345678910a = torch.randn(2, 3)Out[0]: tensor([[-0.1038,  0.8983, -0.7463],        [-0.6661, -0.5061,  0.2043]])torch.mode(a, 1)Out[1]: torch.return_types.mode(values=tensor([-0.7463, -0.6661]),indices=tensor([2, 0]))torch.prod: è¿”å›è¾“å…¥å¼ é‡input æ‰€æœ‰å…ƒç´ çš„ç§¯1234567x = torch.Tensor([1, 2, 3, 4])torch.prod(x)Out[0]: tensor(24.)    y = torch.Tensor([[1, 2], [3, 4]])torch.prod(y, dim=1)Out[1]: tensor([ 2., 12.])    torch.std: è¿”å›è¾“å…¥å¼ é‡input æ‰€æœ‰å…ƒç´ çš„æ ‡å‡†å·®torch.std(input) â†’ floatè¿”å›è¾“å…¥å¼ é‡ç»™å®šç»´åº¦ä¸Šæ¯è¡Œçš„æ ‡å‡†å·®torch.std(input, dim, out=None) â†’ Tensor12345678x = torch.Tensor([1, 2, 3, 4])y = torch.Tensor([[1, 2], [3, 4]])torch.std(x)Out[0]: tensor(1.2910)torch.std(y, dim=1)Out[1]: tensor([0.7071, 0.7071])torch.sum: è¿”å›è¾“å…¥å¼ é‡æ‰€æœ‰å…ƒç´ çš„å’Œtorch.sum(input) â†’ floatè¿”å›è¾“å…¥å¼ é‡ç»™å®šç»´åº¦ä¸Šæ¯è¡Œçš„å’Œtorch.sum(input, dim, out=None) â†’ Tensor12345678x = torch.Tensor([1, 2, 3, 4])y = torch.Tensor([[1, 2], [3, 4]])torch.var(x)Out[0]: tensor(10.0)torch.var(y, dim=1)Out[1]: tensor([3., 7.])torch.var: è¿”å›è¾“å…¥å¼ é‡æ‰€æœ‰å…ƒç´ çš„æ–¹å·®torch.var(input) â†’ floatè¿”å›è¾“å…¥å¼ é‡ç»™å®šç»´åº¦ä¸Šæ¯è¡Œçš„æ–¹å·®torch.var(input, dim, out=None) â†’ Tensor12345678x = torch.Tensor([1, 2, 3, 4])y = torch.Tensor([[1, 2], [3, 4]])torch.var(x)Out[0]: tensor(1.6667)torch.var(y, dim=1)Out[1]: tensor([0.5000, 0.5000])æ¯”è¾ƒæ“ä½œ Comparison Opstorch.eq: torch.eq(input, other, out=None) â†’ Tensoræ¯”è¾ƒå…ƒç´ ç›¸ç­‰æ€§ã€‚ç¬¬äºŒä¸ªå‚æ•°å¯ä¸ºä¸€ä¸ªæ•°æˆ–ä¸ç¬¬ä¸€ä¸ªå‚æ•°åŒç±»å‹å½¢çŠ¶çš„å¼ é‡torch.ge: torch.ge(input, other, out=None) â†’ Tensoré€å…ƒç´ æ¯”è¾ƒinputå’Œotherï¼Œå³æ˜¯å¦ input&gt;=othertorch.gt: torch.gt(input, other, out=None) â†’ Tensoré€å…ƒç´ æ¯”è¾ƒinputå’Œother ï¼Œ å³æ˜¯å¦input&gt;otherinput&gt;other torch.le: torch.le(input, other, out=None) â†’ Tensoré€å…ƒç´ æ¯”è¾ƒinputå’Œother ï¼Œ å³æ˜¯å¦input&lt;=othertorch.lt: torch.lt(input, other, out=None) â†’ Tensoré€å…ƒç´ æ¯”è¾ƒinputå’Œother ï¼Œ å³æ˜¯å¦ input&lt;othertorch.ne: torch.ne(input, other, out=None) â†’ Tensoré€å…ƒç´ æ¯”è¾ƒinputå’Œotherï¼Œå³æ˜¯å¦ input!=other1234567891011121314151617181920212223242526272829torch.eq(torch.Tensor([[1, 2], [3, 4]]), torch.Tensor([[1, 1], [4, 4]]))Out[0]: tensor([[ True, False],        [False,  True]])torch.ge(torch.Tensor([[1, 2], [3, 4]]), torch.Tensor([[1, 1], [4, 4]]))Out[1]: tensor([[ True,  True],        [False,  True]])torch.gt(torch.Tensor([[1, 2], [3, 4]]), torch.Tensor([[1, 1], [4, 4]]))Out[2]: tensor([[False,  True],        [False, False]])torch.le(torch.Tensor([[1, 2], [3, 4]]), torch.Tensor([[1, 1], [4, 4]]))Out[3]: tensor([[ True, False],        [ True,  True]])torch.lt(torch.Tensor([[1, 2], [3, 4]]), torch.Tensor([[1, 1], [4, 4]]))Out[4]: tensor([[False, False],        [ True, False]])torch.ne(torch.Tensor([[1, 2], [3, 4]]), torch.Tensor([[1, 1], [4, 4]]))Out[5]: tensor([[False,  True],        [ True, False]])torch.equal: torch.equal(tensor1, tensor2) â†’ boolå¦‚æœä¸¤ä¸ªå¼ é‡æœ‰ç›¸åŒçš„å½¢çŠ¶å’Œå…ƒç´ å€¼ï¼Œåˆ™è¿”å›True ï¼Œå¦åˆ™ False12torch.equal(torch.Tensor([1, 2]), torch.Tensor([1, 2]))Out[0]: Truetorch.kthvalue: torch.kthvalue(input, k, dim=None, out=None) -&gt; (Tensor, LongTensor)å–è¾“å…¥å¼ é‡inputæŒ‡å®šç»´ä¸Šç¬¬k ä¸ªæœ€å°å€¼ã€‚å¦‚æœä¸æŒ‡å®šdimï¼Œåˆ™é»˜è®¤ä¸ºinputçš„æœ€åä¸€ç»´torch.topk: æ²¿ç»™å®šdimç»´åº¦è¿”å›è¾“å…¥å¼ é‡inputä¸­ k ä¸ªæœ€å¤§å€¼ã€‚ å¦‚æœä¸æŒ‡å®šdimï¼Œåˆ™é»˜è®¤ä¸ºinputçš„æœ€åä¸€ç»´ã€‚ å¦‚æœä¸ºlargestä¸º False ï¼Œåˆ™è¿”å›æœ€å°çš„ k ä¸ªå€¼è¿”å›ä¸€ä¸ªå…ƒç»„ (values,indices)ï¼Œå…¶ä¸­indicesæ˜¯åŸå§‹è¾“å…¥å¼ é‡inputä¸­æµ‹å…ƒç´ ä¸‹æ ‡ã€‚ å¦‚æœè®¾å®šå¸ƒå°”å€¼sorted ä¸ºTrueï¼Œå°†ä¼šç¡®ä¿è¿”å›çš„ k ä¸ªå€¼è¢«æ’åºtorch.topk(input, k, dim=None, largest=True, sorted=True, out=None) -&gt; (Tensor, LongTensor)å‚æ•°:input (Tensor) â€“ è¾“å…¥å¼ é‡k (int) â€“ â€œtop-kâ€ä¸­çš„kdim (int, optional) â€“ æ’åºçš„ç»´largest (bool, optional) â€“ å¸ƒå°”å€¼ï¼Œæ§åˆ¶è¿”å›æœ€å¤§æˆ–æœ€å°å€¼sorted (bool, optional) â€“ å¸ƒå°”å€¼ï¼Œæ§åˆ¶è¿”å›å€¼æ˜¯å¦æ’åºout (tuple, optional) â€“ å¯é€‰è¾“å‡ºå¼ é‡ (Tensor, LongTensor) output buffers123456789101112131415161718192021222324x = torch.arange(1, 6)# torch.kthvaluetorch.kthvalue(x, 4)Out[0]:torch.return_types.kthvalue(values=tensor(4),indices=tensor(3))# torch.topkx = torch.arange(1, 6)Out[1]: tensor([1, 2, 3, 4, 5])torch.topk(x, 3)Out[2]: torch.return_types.topk(values=tensor([5, 4, 3]),indices=tensor([4, 3, 2]))torch.topk(x, 3, 0, largest=False)Out[3]: torch.return_types.topk(values=tensor([1, 2, 3]),indices=tensor([0, 1, 2]))torch.max: è¿”å›è¾“å…¥å¼ é‡æ‰€æœ‰å…ƒç´ çš„æœ€å¤§å€¼torch.max()è¿”å›è¾“å…¥å¼ é‡ç»™å®šç»´åº¦ä¸Šæ¯è¡Œçš„æœ€å¤§å€¼ï¼Œå¹¶åŒæ—¶è¿”å›æ¯ä¸ªæœ€å¤§å€¼çš„ä½ç½®ç´¢å¼•torch.max(input, dim, max=None, max_indices=None) -&gt; (Tensor, LongTensor)inputä¸­é€å…ƒç´ ä¸otherç›¸åº”ä½ç½®çš„å…ƒç´ å¯¹æ¯”ï¼Œè¿”å›æœ€å¤§å€¼åˆ°è¾“å‡ºå¼ é‡torch.max(input, other, out=None) â†’ Tensortorch.min: è¿”å›è¾“å…¥å¼ é‡æ‰€æœ‰å…ƒç´ çš„æœ€å°å€¼torch.min(input) â†’ floatè¿”å›è¾“å…¥å¼ é‡ç»™å®šç»´åº¦ä¸Šæ¯è¡Œçš„æœ€å°å€¼ï¼Œå¹¶åŒæ—¶è¿”å›æ¯ä¸ªæœ€å°å€¼çš„ä½ç½®ç´¢å¼•torch.min(input, dim, min=None, min_indices=None) -&gt; (Tensor, LongTensor)inputä¸­é€å…ƒç´ ä¸otherç›¸åº”ä½ç½®çš„å…ƒç´ å¯¹æ¯”ï¼Œè¿”å›æœ€å°å€¼åˆ°è¾“å‡ºå¼ é‡torch.min(input, other, out=None) â†’ Tensor12345678910111213141516171819202122232425262728293031323334a = torch.randn(2, 2)Out[0]: tensor([[-0.1204, -0.5016],        [ 1.2717,  0.7351]])b = torch.randn(2, 2)Out[1]: tensor([[-1.4497,  0.7534],        [ 0.5994, -0.1490]])# æœ€å¤§å€¼torch.max(torch.arange(1, 5))Out[2]: tensor(4)torch.max(a, 1)Out[3]: torch.return_types.max(values=tensor([-0.1204,  1.2717]),indices=tensor([0, 0]))torch.max(a, b)Out[4]: tensor([[-0.1204,  0.7534],        [ 1.2717,  0.7351]])# æœ€å°å€¼torch.min(torch.arange(1, 5))Out[5]: tensor(1)torch.min(a, 1)Out[6]: torch.return_types.min(values=tensor([-0.5016,  0.7351]),indices=tensor([1, 1]))torch.min(a, b)Out[7]: tensor([[-1.4497, -0.5016],        [ 0.5994, -0.1490]])torch.sort: torch.sort(input, dim=None, descending=False, out=None) -&gt; (Tensor, LongTensor)å¯¹è¾“å…¥å¼ é‡inputæ²¿ç€æŒ‡å®šç»´æŒ‰å‡åºæ’åºã€‚å¦‚æœä¸ç»™å®šdimï¼Œåˆ™é»˜è®¤ä¸ºè¾“å…¥çš„æœ€åä¸€ç»´ã€‚å¦‚æœæŒ‡å®šå‚æ•°descendingä¸ºTrueï¼Œåˆ™æŒ‰é™åºæ’åºè¿”å›å…ƒç»„ (sorted_tensor, sorted_indices) ï¼Œ sorted_indices ä¸ºåŸå§‹è¾“å…¥ä¸­çš„ä¸‹æ ‡123456789101112131415x = torch.randn(3, 4)Out[0]: tensor([[-2.3460,  1.3734,  1.1444, -0.4736],        [-1.1785,  0.8436, -1.4403, -0.1073],        [-0.1198,  0.7067, -0.0734, -1.6181]])sorted, indices = torch.sort(x)sorted, indicesOut[1]: (tensor([[-2.3460, -0.4736,  1.1444,  1.3734],         [-1.4403, -1.1785, -0.1073,  0.8436],         [-1.6181, -0.1198, -0.0734,  0.7067]]), tensor([[0, 3, 2, 1],         [2, 0, 3, 1],         [3, 0, 2, 1]]))å…¶å®ƒæ“ä½œ Other Operationstorch.cross: è¿”å›æ²¿ç€ç»´åº¦dimä¸Šï¼Œä¸¤ä¸ªå¼ é‡inputå’Œotherçš„å‘é‡ç§¯ï¼ˆå‰ç§¯ï¼‰ã€‚ inputå’Œother å¿…é¡»æœ‰ç›¸åŒçš„å½¢çŠ¶ï¼Œä¸”æŒ‡å®šçš„dimç»´ä¸Šsizeå¿…é¡»ä¸º3å¦‚æœä¸æŒ‡å®šdimï¼Œåˆ™é»˜è®¤ä¸ºç¬¬ä¸€ä¸ªå°ºåº¦ä¸º3çš„ç»´torch.cross(input, other, dim=-1, out=None) â†’ Tensor123456789101112131415161718a = torch.randint(1, 6, (2, 3))Out[0]: tensor([[5, 4, 5],        [4, 2, 3]])b = torch.randint(1, 6, (2, 3))Out[1]: tensor([[1, 1, 2],        [3, 4, 2]])torch.cross(a, a)Out[2]: tensor([[0, 0, 0],        [0, 0, 0]])torch.cross(a, b)Out[3]: tensor([[ 3, -5,  1],        [-8,  1, 10]])torch.diag: torch.diag(input, diagonal=0, out=None) â†’ Tensorå¦‚æœè¾“å…¥æ˜¯ä¸€ä¸ªå‘é‡(1D å¼ é‡)ï¼Œåˆ™è¿”å›ä¸€ä¸ªä»¥inputä¸ºå¯¹è§’çº¿å…ƒç´ çš„2Dæ–¹é˜µå¦‚æœè¾“å…¥æ˜¯ä¸€ä¸ªçŸ©é˜µ(2D å¼ é‡)ï¼Œåˆ™è¿”å›ä¸€ä¸ªåŒ…å«inputå¯¹è§’çº¿å…ƒç´ çš„1Då¼ é‡å‚æ•°diagonalæŒ‡å®šå¯¹è§’çº¿:diagonal = 0, ä¸»å¯¹è§’çº¿diagonal &gt; 0, ä¸»å¯¹è§’çº¿ä¹‹ä¸Šdiagonal &lt; 0, ä¸»å¯¹è§’çº¿ä¹‹ä¸‹1234567891011121314151617181920212223242526# å¦‚æœè¾“å…¥æ˜¯ä¸€ä¸ªå‘é‡(1D å¼ é‡)ï¼Œåˆ™è¿”å›ä¸€ä¸ªä»¥`input`ä¸ºå¯¹è§’çº¿å…ƒç´ çš„2Dæ–¹é˜µa = torch.randn(3)Out[0]: tensor([-0.3509,  0.6176, -1.4976])torch.diag(a)Out[1]: tensor([[-0.3509,  0.0000,  0.0000],        [ 0.0000,  0.6176,  0.0000],        [ 0.0000,  0.0000, -1.4976]])torch.diag(a, 1)Out[2]: tensor([[ 0.0000, -0.3509,  0.0000,  0.0000],        [ 0.0000,  0.0000,  0.6176,  0.0000],        [ 0.0000,  0.0000,  0.0000, -1.4976],        [ 0.0000,  0.0000,  0.0000,  0.0000]])# å¦‚æœè¾“å…¥æ˜¯ä¸€ä¸ªçŸ©é˜µ(2D å¼ é‡)ï¼Œåˆ™è¿”å›ä¸€ä¸ªåŒ…å«`input`å¯¹è§’çº¿å…ƒç´ çš„1Då¼ é‡# å–å¾—ç»™å®šçŸ©é˜µç¬¬kä¸ªå¯¹è§’çº¿:a = torch.randn(3, 3)Out[3]: tensor([[ 0.8224,  0.7792,  0.2605],        [-0.8646,  0.2568, -0.8189],        [ 1.1693,  0.8108, -1.9662]])torch.diag(a, 0)Out[4]: tensor([ 0.8224,  0.2568, -1.9662])torch.diag(a, 1)Out[5]: tensor([ 0.7792, -0.8189])torch.histc: torch.histc(input, bins=100, min=0, max=0, out=None) â†’ Tensorè®¡ç®—è¾“å…¥å¼ é‡çš„ç›´æ–¹å›¾ã€‚ä»¥minå’Œmaxä¸ºrangeè¾¹ç•Œï¼Œå°†å…¶å‡åˆ†æˆbinsä¸ªç›´æ¡ï¼Œç„¶åå°†æ’åºå¥½çš„æ•°æ®åˆ’åˆ†åˆ°å„ä¸ªç›´æ¡(bins)ä¸­å‚æ•°ï¼šinput (Tensor) â€“ è¾“å…¥å¼ é‡bins (int) â€“ ç›´æ–¹å›¾ bins(ç›´æ¡)çš„ä¸ªæ•°(é»˜è®¤100ä¸ª)min (int) â€“ rangeçš„ä¸‹è¾¹ç•Œ(åŒ…å«)max (int) â€“ rangeçš„ä¸Šè¾¹ç•Œ(åŒ…å«)out (Tensor, optional) â€“ ç»“æœå¼ é‡12345torch.histc(torch.FloatTensor([1, 2, 1]), bins=4, min=0, max=3)Out[0]: tensor([0., 2., 1., 0.])torch.histc(torch.FloatTensor([1, 1, 2, 1]), bins=4, min=0, max=3)Out[1]: tensor([0., 3., 1., 0.])torch.renorm: torch.renorm(input, p, dim, maxnorm, out=None) â†’ Tensorè¿”å›ä¸€ä¸ªå¼ é‡ï¼ŒåŒ…å«è§„èŒƒåŒ–åçš„å„ä¸ªå­å¼ é‡ï¼Œä½¿å¾—æ²¿ç€dimç»´åˆ’åˆ†çš„å„å­å¼ é‡çš„pèŒƒæ•°å°äºmaxnormå¦‚æœpèŒƒæ•°çš„å€¼å°äºmaxnormï¼Œåˆ™å½“å‰å­å¼ é‡ä¸éœ€è¦ä¿®æ”¹å‚æ•°ï¼šinput (Tensor) â€“ è¾“å…¥å¼ é‡p (float) â€“ èŒƒæ•°çš„pdim (int) â€“ æ²¿ç€æ­¤ç»´åˆ‡ç‰‡ï¼Œå¾—åˆ°å¼ é‡å­é›†maxnorm (float) â€“ æ¯ä¸ªå­å¼ é‡çš„èŒƒæ•°çš„æœ€å¤§å€¼out (Tensor, optional) â€“ ç»“æœå¼ é‡12345678910111213x = torch.ones(3, 3)x[1].fill_(2)x[2].fill_(3)Out[0]: tensor([[1., 1., 1.],        [2., 2., 2.],        [3., 3., 3.]])torch.renorm(x, p=1, dim=0, maxnorm=5)Out[1]: tensor([[1.0000, 1.0000, 1.0000],        [1.6667, 1.6667, 1.6667],        [1.6667, 1.6667, 1.6667]])torch.trace: è¿”å›è¾“å…¥2ç»´çŸ©é˜µå¯¹è§’çº¿å…ƒç´ çš„å’Œ(è¿¹)12345678x = torch.arange(1, 10).view(3, 3)Out[0]: tensor([[1, 2, 3],        [4, 5, 6],        [7, 8, 9]])torch.trace(x)Out[1]: tensor(15)torch.tril: torch.tril(input, diagonal=0, out=None) â†’ Tensorè¿”å›ä¸€ä¸ªå¼ é‡outï¼ŒåŒ…å«è¾“å…¥çŸ©é˜µ(2Då¼ é‡)çš„ä¸‹ä¸‰è§’éƒ¨åˆ†ï¼Œoutå…¶ä½™éƒ¨åˆ†è¢«è®¾ä¸º01234567891011121314151617x = torch.arange(1, 10).view(3, 3)Out[0]: tensor([[1, 2, 3],        [4, 5, 6],        [7, 8, 9]])torch.tril(x)Out[1]: tensor([[1, 0, 0],        [4, 5, 0],        [7, 8, 9]])torch.tril(x, diagonal=1)Out[2]: tensor([[1, 2, 0],        [4, 5, 6],        [7, 8, 9]])torch.triu: torch.triu(input, k=0, out=None) â†’ Tensorè¿”å›ä¸€ä¸ªå¼ é‡ï¼ŒåŒ…å«è¾“å…¥çŸ©é˜µ(2Då¼ é‡)çš„ä¸Šä¸‰è§’éƒ¨åˆ†ï¼Œå…¶ä½™éƒ¨åˆ†è¢«è®¾ä¸º0ã€‚è¿™é‡Œæ‰€è¯´çš„ä¸Šä¸‰è§’éƒ¨åˆ†ä¸ºçŸ©é˜µæŒ‡å®šå¯¹è§’çº¿diagonalä¹‹ä¸Šçš„å…ƒç´ ã€‚å‚æ•°kæ§åˆ¶å¯¹è§’çº¿: - k = 0, ä¸»å¯¹è§’çº¿ - k &gt; 0, ä¸»å¯¹è§’çº¿ä¹‹ä¸Š - k &lt; 0, ä¸»å¯¹è§’çº¿ä¹‹ä¸‹1234567891011121314151617x = torch.arange(1, 10).view(3, 3)Out[0]: tensor([[1, 2, 3],        [4, 5, 6],        [7, 8, 9]])torch.triu(x)Out[1]: tensor([[1, 2, 3],        [0, 5, 6],        [0, 0, 9]])torch.triu(x, diagonal=1)Out[2]: tensor([[0, 2, 3],        [0, 0, 6],        [0, 0, 0]])BLAS and LAPACK Operationstorch.addbmmtorch.addmmtorch.addmvtorch.addrtorch.baddbmmtorch.bmmtorch.btrifacttorch.btrisolvetorch.dot: è®¡ç®—ä¸¤ä¸ªå¼ é‡çš„ç‚¹ä¹˜(å†…ä¹˜),ä¸¤ä¸ªå¼ é‡éƒ½ä¸º1-D å‘é‡torch.dot(tensor1, tensor2) â†’ float12torch.dot(torch.Tensor([2, 3]), torch.Tensor([2, 1]))Out[0]: tensor(7.)torch.linalg.eig: è®¡ç®—å®æ–¹é˜µa çš„ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡torch.linalg.eig(A, * , out=None)12345678910A = torch.randn(2, 2, dtype=torch.complex128)Out[0]: tensor([[-0.2029-0.0673j, -0.5188-0.6723j],        [-1.1984+0.0585j,  0.5786-0.1849j]], dtype=torch.complex128)L, V = torch.linalg.eig(A)Out[1]: (tensor([-0.7870-0.5003j,  1.1626+0.2481j], dtype=torch.complex128), tensor([[ 0.7596+0.0000j, -0.4008-0.3285j],         [ 0.6258-0.1770j,  0.8552+0.0000j]], dtype=torch.complex128))Tensortorch.Tensoræ˜¯ä¸€ç§åŒ…å«å•ä¸€æ•°æ®ç±»å‹å…ƒç´ çš„å¤šç»´çŸ©é˜µTorchå®šä¹‰äº†10ç§CPU tensorç±»å‹å’ŒGPU tensorç±»å‹ï¼šData typedtypeCPU tensorGPU tensor32-bit floating pointtorch.float32 or torch.floattorch.FloatTensortorch.cuda.FloatTensor64-bit floating pointtorch.float64 or torch.doubletorch.DoubleTensortorch.cuda.DoubleTensor16-bit floating point [1]torch.float16 or torch.halftorch.HalfTensortorch.cuda.HalfTensor16-bit floating point [2]torch.bfloat16torch.BFloat16Tensortorch.cuda.BFloat16Tensor32-bit complextorch.complex32 or torch.chalf64-bit complextorch.complex64 or torch.cfloat128-bit complextorch.complex128 or torch.cdouble8-bit integer (unsigned)torch.uint8torch.ByteTensortorch.cuda.ByteTensor8-bit integer (signed)torch.int8torch.CharTensortorch.cuda.CharTensor16-bit integer (signed)torch.int16 or torch.shorttorch.ShortTensortorch.cuda.ShortTensor32-bit integer (signed)torch.int32 or torch.inttorch.IntTensortorch.cuda.IntTensor64-bit integer (signed)torch.int64 or torch.longtorch.LongTensortorch.cuda.LongTensorBooleantorch.booltorch.BoolTensortorch.cuda.BoolTensorquantized 8-bit integer (unsigned)torch.quint8torch.ByteTensor/quantized 8-bit integer (signed)torch.qint8torch.CharTensor/quantized 32-bit integer (signed)torch.qint32torch.IntTensor/quantized 4-bit integer (unsigned) [3]torch.quint4x2torch.ByteTensor/åˆ›å»ºä¸€ä¸ªå¼ é‡tensorå¯ä»¥ä»Pythonçš„listæˆ–åºåˆ—æ„å»º12345torch.FloatTensor([[1, 2, 3], [4, 5, 6]])Out[0]: tensor([[1., 2., 3.],        [4., 5., 6.]])æ ¹æ®å¯é€‰æ‹©çš„å¤§å°å’Œæ•°æ®æ–°å»ºä¸€ä¸ªtensorã€‚ å¦‚æœæ²¡æœ‰æä¾›å‚æ•°ï¼Œå°†ä¼šè¿”å›ä¸€ä¸ªç©ºçš„é›¶ç»´å¼ é‡ã€‚å¦‚æœæä¾›äº†numpy.ndarray,torch.Tensoræˆ–torch.Storageï¼Œå°†ä¼šè¿”å›ä¸€ä¸ªæœ‰åŒæ ·å‚æ•°çš„tensor.å¦‚æœæä¾›äº†pythonåºåˆ—ï¼Œå°†ä¼šä»åºåˆ—çš„å‰¯æœ¬åˆ›å»ºä¸€ä¸ªtensor1234567891011# æ¥å£ ä¸€ä¸ªç©ºå¼ é‡tensorå¯ä»¥é€šè¿‡è§„å®šå…¶å¤§å°æ¥æ„å»ºclass torch.Tensorclass torch.Tensor(*sizes)class torch.Tensor(size)class torch.Tensor(sequence)class torch.Tensor(ndarray)class torch.Tensor(tensor)class torch.Tensor(storage)# å®ä¾‹åŒ–torch.IntTensor(2, 4).zero_()å¯ä»¥ç”¨pythonçš„ç´¢å¼•å’Œåˆ‡ç‰‡æ¥è·å–å’Œä¿®æ”¹ä¸€ä¸ªå¼ é‡tensorä¸­çš„å†…å®¹123456789x = torch.FloatTensor([[1, 2, 3], [4, 5, 6]])x[1][2]Out[0]: tensor(6.)    x[0][1] = 8xOut[1]: tensor([[1., 8., 3.],        [4., 5., 6.]])æ¯ä¸€ä¸ªå¼ é‡tensoréƒ½æœ‰ä¸€ä¸ªç›¸åº”çš„torch.Storageç”¨æ¥ä¿å­˜å…¶æ•°æ®ã€‚ç±»tensoræä¾›äº†ä¸€ä¸ªå­˜å‚¨çš„å¤šç»´çš„ã€æ¨ªå‘è§†å›¾ï¼Œå¹¶ä¸”å®šä¹‰äº†åœ¨æ•°å€¼è¿ç®—ä¼šæ”¹å˜tensorçš„å‡½æ•°æ“ä½œä¼šç”¨ä¸€ä¸ªä¸‹åˆ’çº¿åç¼€æ¥æ ‡ç¤ºã€‚æ¯”å¦‚ï¼Œtorch.FloatTensor.abs_()ä¼šåœ¨åŸåœ°è®¡ç®—ç»å¯¹å€¼ï¼Œå¹¶è¿”å›æ”¹å˜åçš„tensorï¼Œè€Œtensor.FloatTensor.abs()å°†ä¼šåœ¨ä¸€ä¸ªæ–°çš„tensorä¸­è®¡ç®—ç»“æœå…³é”®å±æ€§å’Œæ–¹æ³•Tensor.new_tensorReturns a new Tensor with data as the tensor data.Tensor.new_fullReturns a Tensor of size size filled with fill_value.Tensor.new_emptyReturns a Tensor of size size filled with uninitialized data.Tensor.new_onesReturns a Tensor of size size filled with 1.Tensor.new_zerosReturns a Tensor of size size filled with 0.Tensor.is_cudaIs True if the Tensor is stored on the GPU, False otherwise.Tensor.is_quantizedIs True if the Tensor is quantized, False otherwise.Tensor.is_metaIs True if the Tensor is a meta tensor, False otherwise.Tensor.deviceIs the torch.device where this Tensor is.Tensor.gradThis attribute is None by default and becomes a Tensor the first time a call to backward() computes gradients for self.Tensor.ndimAlias for dim()Tensor.realReturns a new tensor containing real values of the self tensor for a complex-valued input tensor.Tensor.imagReturns a new tensor containing imaginary values of the self tensor.Tensor.absSee torch.abs()Tensor.abs_In-place version of abs()Tensor.absoluteAlias for abs()Tensor.absolute_In-place version of absolute() Alias for abs_()Tensor.acosSee torch.acos()Tensor.acos_In-place version of acos()Tensor.arccosSee torch.arccos()Tensor.arccos_In-place version of arccos()Tensor.addAdd a scalar or tensor to self tensor.Tensor.add_In-place version of add()Tensor.addbmmSee torch.addbmm()Tensor.addbmm_In-place version of addbmm()Tensor.addcdivSee torch.addcdiv()Tensor.addcdiv_In-place version of addcdiv()Tensor.addcmulSee torch.addcmul()Tensor.addcmul_In-place version of addcmul()Tensor.addmmSee torch.addmm()Tensor.addmm_In-place version of addmm()Tensor.sspaddmmSee torch.sspaddmm()Tensor.addmvSee torch.addmv()Tensor.addmv_In-place version of addmv()Tensor.addrSee torch.addr()Tensor.addr_In-place version of addr()Tensor.adjointAlias for adjoint()Tensor.allcloseSee torch.allclose()Tensor.amaxSee torch.amax()Tensor.aminSee torch.amin()Tensor.aminmaxSee torch.aminmax()Tensor.angleSee torch.angle()Tensor.apply_Applies the function callable to each element in the tensor, replacing each element with the value returned by callable.Tensor.argmaxSee torch.argmax()Tensor.argminSee torch.argmin()Tensor.argsortSee torch.argsort()Tensor.argwhereSee torch.argwhere()Tensor.asinSee torch.asin()Tensor.asin_In-place version of asin()Tensor.arcsinSee torch.arcsin()Tensor.arcsin_In-place version of arcsin()Tensor.as_stridedSee torch.as_strided()Tensor.atanSee torch.atan()Tensor.atan_In-place version of atan()Tensor.arctanSee torch.arctan()Tensor.arctan_In-place version of arctan()Tensor.atan2See torch.atan2()Tensor.atan2_In-place version of atan2()Tensor.arctan2See torch.arctan2()Tensor.arctan2_atan2_(other) -&gt; TensorTensor.allSee torch.all()Tensor.anySee torch.any()Tensor.backwardComputes the gradient of current tensor w.r.t.Tensor.baddbmmSee torch.baddbmm()Tensor.baddbmm_In-place version of baddbmm()Tensor.bernoulliReturns a result tensor where each \texttt{result[i]}result[i] is independently sampled from \text{Bernoulli}(\texttt{self[i]})Bernoulli(self[i]).Tensor.bernoulli_Fills each location of self with an independent sample from \text{Bernoulli}(\texttt{p})Bernoulli(p).Tensor.bfloat16self.bfloat16() is equivalent to self.to(torch.bfloat16).Tensor.bincountSee torch.bincount()Tensor.bitwise_notSee torch.bitwise_not()Tensor.bitwise_not_In-place version of bitwise_not()Tensor.bitwise_andSee torch.bitwise_and()Tensor.bitwise_and_In-place version of bitwise_and()Tensor.bitwise_orSee torch.bitwise_or()Tensor.bitwise_or_In-place version of bitwise_or()Tensor.bitwise_xorSee torch.bitwise_xor()Tensor.bitwise_xor_In-place version of bitwise_xor()Tensor.bitwise_left_shiftSee torch.bitwise_left_shift()Tensor.bitwise_left_shift_In-place version of bitwise_left_shift()Tensor.bitwise_right_shiftSee torch.bitwise_right_shift()Tensor.bitwise_right_shift_In-place version of bitwise_right_shift()Tensor.bmmSee torch.bmm()Tensor.boolself.bool() is equivalent to self.to(torch.bool).Tensor.byteself.byte() is equivalent to self.to(torch.uint8).Tensor.broadcast_toSee torch.broadcast_to().Tensor.cauchy_Fills the tensor with numbers drawn from the Cauchy distribution:Tensor.ceilSee torch.ceil()Tensor.ceil_In-place version of ceil()Tensor.charself.char() is equivalent to self.to(torch.int8).Tensor.choleskySee torch.cholesky()Tensor.cholesky_inverseSee torch.cholesky_inverse()Tensor.cholesky_solveSee torch.cholesky_solve()Tensor.chunkSee torch.chunk()Tensor.clampSee torch.clamp()Tensor.clamp_In-place version of clamp()Tensor.clipAlias for clamp().Tensor.clip_Alias for clamp_().Tensor.cloneSee torch.clone()Tensor.contiguousReturns a contiguous in memory tensor containing the same data as self tensor.Tensor.copy_Copies the elements from src into self tensor and returns self.Tensor.conjSee torch.conj()Tensor.conj_physicalSee torch.conj_physical()Tensor.conj_physical_In-place version of conj_physical()Tensor.resolve_conjSee torch.resolve_conj()Tensor.resolve_negSee torch.resolve_neg()Tensor.copysignSee torch.copysign()Tensor.copysign_In-place version of copysign()Tensor.cosSee torch.cos()Tensor.cos_In-place version of cos()Tensor.coshSee torch.cosh()Tensor.cosh_In-place version of cosh()Tensor.corrcoefSee torch.corrcoef()Tensor.count_nonzeroSee torch.count_nonzero()Tensor.covSee torch.cov()Tensor.acoshSee torch.acosh()Tensor.acosh_In-place version of acosh()Tensor.arccoshacosh() -&gt; TensorTensor.arccosh_acosh_() -&gt; TensorTensor.cpuReturns a copy of this object in CPU memory.Tensor.crossSee torch.cross()Tensor.cudaReturns a copy of this object in CUDA memory.Tensor.logcumsumexpSee torch.logcumsumexp()Tensor.cummaxSee torch.cummax()Tensor.cumminSee torch.cummin()Tensor.cumprodSee torch.cumprod()Tensor.cumprod_In-place version of cumprod()Tensor.cumsumSee torch.cumsum()Tensor.cumsum_In-place version of cumsum()Tensor.chalfself.chalf() is equivalent to self.to(torch.complex32).Tensor.cfloatself.cfloat() is equivalent to self.to(torch.complex64).Tensor.cdoubleself.cdouble() is equivalent to self.to(torch.complex128).Tensor.data_ptrReturns the address of the first element of self tensor.Tensor.deg2radSee torch.deg2rad()Tensor.dequantizeGiven a quantized Tensor, dequantize it and return the dequantized float Tensor.Tensor.detSee torch.det()Tensor.dense_dimReturn the number of dense dimensions in a sparse tensor self.Tensor.detachReturns a new Tensor, detached from the current graph.Tensor.detach_Detaches the Tensor from the graph that created it, making it a leaf.Tensor.diagSee torch.diag()Tensor.diag_embedSee torch.diag_embed()Tensor.diagflatSee torch.diagflat()Tensor.diagonalSee torch.diagonal()Tensor.diagonal_scatterSee torch.diagonal_scatter()Tensor.fill_diagonal_Fill the main diagonal of a tensor that has at least 2-dimensions.Tensor.fmaxSee torch.fmax()Tensor.fminSee torch.fmin()Tensor.diffSee torch.diff()Tensor.digammaSee torch.digamma()Tensor.digamma_In-place version of digamma()Tensor.dimReturns the number of dimensions of self tensor.Tensor.distSee torch.dist()Tensor.divSee torch.div()Tensor.div_In-place version of div()Tensor.divideSee torch.divide()Tensor.divide_In-place version of divide()Tensor.dotSee torch.dot()Tensor.doubleself.double() is equivalent to self.to(torch.float64).Tensor.dsplitSee torch.dsplit()Tensor.element_sizeReturns the size in bytes of an individual element.Tensor.eqSee torch.eq()Tensor.eq_In-place version of eq()Tensor.equalSee torch.equal()Tensor.erfSee torch.erf()Tensor.erf_In-place version of erf()Tensor.erfcSee torch.erfc()Tensor.erfc_In-place version of erfc()Tensor.erfinvSee torch.erfinv()Tensor.erfinv_In-place version of erfinv()Tensor.expSee torch.exp()Tensor.exp_In-place version of exp()Tensor.expm1See torch.expm1()Tensor.expm1_In-place version of expm1()Tensor.expandReturns a new view of the self tensor with singleton dimensions expanded to a larger size.Tensor.expand_asExpand this tensor to the same size as other.Tensor.exponential_Fills self tensor with elements drawn from the exponential distribution:Tensor.fixSee torch.fix().Tensor.fix_In-place version of fix()Tensor.fill_Fills self tensor with the specified value.Tensor.flattenSee torch.flatten()Tensor.flipSee torch.flip()Tensor.fliplrSee torch.fliplr()Tensor.flipudSee torch.flipud()Tensor.floatself.float() is equivalent to self.to(torch.float32).Tensor.float_powerSee torch.float_power()Tensor.float_power_In-place version of float_power()Tensor.floorSee torch.floor()Tensor.floor_In-place version of floor()Tensor.floor_divideSee torch.floor_divide()Tensor.floor_divide_In-place version of floor_divide()Tensor.fmodSee torch.fmod()Tensor.fmod_In-place version of fmod()Tensor.fracSee torch.frac()Tensor.frac_In-place version of frac()Tensor.frexpSee torch.frexp()Tensor.gatherSee torch.gather()Tensor.gcdSee torch.gcd()Tensor.gcd_In-place version of gcd()Tensor.geSee torch.ge().Tensor.ge_In-place version of ge().Tensor.greater_equalSee torch.greater_equal().Tensor.greater_equal_In-place version of greater_equal().Tensor.geometric_Fills self tensor with elements drawn from the geometric distribution:Tensor.geqrfSee torch.geqrf()Tensor.gerSee torch.ger()Tensor.get_deviceFor CUDA tensors, this function returns the device ordinal of the GPU on which the tensor resides.Tensor.gtSee torch.gt().Tensor.gt_In-place version of gt().Tensor.greaterSee torch.greater().Tensor.greater_In-place version of greater().Tensor.halfself.half() is equivalent to self.to(torch.float16).Tensor.hardshrinkSee torch.nn.functional.hardshrink()Tensor.heavisideSee torch.heaviside()Tensor.histcSee torch.histc()Tensor.histogramSee torch.histogram()Tensor.hsplitSee torch.hsplit()Tensor.hypotSee torch.hypot()Tensor.hypot_In-place version of hypot()Tensor.i0See torch.i0()Tensor.i0_In-place version of i0()Tensor.igammaSee torch.igamma()Tensor.igamma_In-place version of igamma()Tensor.igammacSee torch.igammac()Tensor.igammac_In-place version of igammac()Tensor.index_add_Accumulate the elements of alpha times source into the self tensor by adding to the indices in the order given in index.Tensor.index_addOut-of-place version of torch.Tensor.index_add_().Tensor.index_copy_Copies the elements of tensor into the self tensor by selecting the indices in the order given in index.Tensor.index_copyOut-of-place version of torch.Tensor.index_copy_().Tensor.index_fill_Fills the elements of the self tensor with value value by selecting the indices in the order given in index.Tensor.index_fillOut-of-place version of torch.Tensor.index_fill_().Tensor.index_put_Puts values from the tensor values into the tensor self using the indices specified in indices (which is a tuple of Tensors).Tensor.index_putOut-place version of index_put_().Tensor.index_reduce_Accumulate the elements of source into the self tensor by accumulating to the indices in the order given in index using the reduction given by the reduce argument.Tensor.index_reduceTensor.index_selectSee torch.index_select()Tensor.indicesReturn the indices tensor of a sparse COO tensor.Tensor.innerSee torch.inner().Tensor.intself.int() is equivalent to self.to(torch.int32).Tensor.int_reprGiven a quantized Tensor, self.int_repr() returns a CPU Tensor with uint8_t as data type that stores the underlying uint8_t values of the given Tensor.Tensor.inverseSee torch.inverse()Tensor.iscloseSee torch.isclose()Tensor.isfiniteSee torch.isfinite()Tensor.isinfSee torch.isinf()Tensor.isposinfSee torch.isposinf()Tensor.isneginfSee torch.isneginf()Tensor.isnanSee torch.isnan()Tensor.is_contiguousReturns True if self tensor is contiguous in memory in the order specified by memory format.Tensor.is_complexReturns True if the data type of self is a complex data type.Tensor.is_conjReturns True if the conjugate bit of self is set to true.Tensor.is_floating_pointReturns True if the data type of self is a floating point data type.Tensor.is_inferenceSee torch.is_inference()Tensor.is_leafAll Tensors that have requires_grad which is False will be leaf Tensors by convention.Tensor.is_pinnedReturns true if this tensor resides in pinned memory.Tensor.is_set_toReturns True if both tensors are pointing to the exact same memory (same storage, offset, size and stride).Tensor.is_sharedChecks if tensor is in shared memory.Tensor.is_signedReturns True if the data type of self is a signed data type.Tensor.is_sparseIs True if the Tensor uses sparse storage layout, False otherwise.Tensor.istftSee torch.istft()Tensor.isrealSee torch.isreal()Tensor.itemReturns the value of this tensor as a standard Python number.Tensor.kthvalueSee torch.kthvalue()Tensor.lcmSee torch.lcm()Tensor.lcm_In-place version of lcm()Tensor.ldexpSee torch.ldexp()Tensor.ldexp_In-place version of ldexp()Tensor.leSee torch.le().Tensor.le_In-place version of le().Tensor.less_equalSee torch.less_equal().Tensor.less_equal_In-place version of less_equal().Tensor.lerpSee torch.lerp()Tensor.lerp_In-place version of lerp()Tensor.lgammaSee torch.lgamma()Tensor.lgamma_In-place version of lgamma()Tensor.logSee torch.log()Tensor.log_In-place version of log()Tensor.logdetSee torch.logdet()Tensor.log10See torch.log10()Tensor.log10_In-place version of log10()Tensor.log1pSee torch.log1p()Tensor.log1p_In-place version of log1p()Tensor.log2See torch.log2()Tensor.log2_In-place version of log2()Tensor.log_normal_Fills self tensor with numbers samples from the log-normal distribution parameterized by the given mean \muÎ¼ and standard deviation \sigmaÏƒ.Tensor.logaddexpSee torch.logaddexp()Tensor.logaddexp2See torch.logaddexp2()Tensor.logsumexpSee torch.logsumexp()Tensor.logical_andSee torch.logical_and()Tensor.logical_and_In-place version of logical_and()Tensor.logical_notSee torch.logical_not()Tensor.logical_not_In-place version of logical_not()Tensor.logical_orSee torch.logical_or()Tensor.logical_or_In-place version of logical_or()Tensor.logical_xorSee torch.logical_xor()Tensor.logical_xor_In-place version of logical_xor()Tensor.logitSee torch.logit()Tensor.logit_In-place version of logit()Tensor.longself.long() is equivalent to self.to(torch.int64).Tensor.ltSee torch.lt().Tensor.lt_In-place version of lt().Tensor.lesslt(other) -&gt; TensorTensor.less_In-place version of less().Tensor.luSee torch.lu()Tensor.lu_solveSee torch.lu_solve()Tensor.as_subclassMakes a cls instance with the same data pointer as self.Tensor.map_Applies callable for each element in self tensor and the given tensor and stores the results in self tensor.Tensor.masked_scatter_Copies elements from source into self tensor at positions where the mask is True.Tensor.masked_scatterOut-of-place version of torch.Tensor.masked_scatter_()Tensor.masked_fill_Fills elements of self tensor with value where mask is True.Tensor.masked_fillOut-of-place version of torch.Tensor.masked_fill_()Tensor.masked_selectSee torch.masked_select()Tensor.matmulSee torch.matmul()Tensor.matrix_powerNOTEmatrix_power() is deprecated, use torch.linalg.matrix_power() instead.Tensor.matrix_expSee torch.matrix_exp()Tensor.maxSee torch.max()Tensor.maximumSee torch.maximum()Tensor.meanSee torch.mean()Tensor.nanmeanSee torch.nanmean()Tensor.medianSee torch.median()Tensor.nanmedianSee torch.nanmedian()Tensor.minSee torch.min()Tensor.minimumSee torch.minimum()Tensor.mmSee torch.mm()Tensor.smmSee torch.smm()Tensor.modeSee torch.mode()Tensor.movedimSee torch.movedim()Tensor.moveaxisSee torch.moveaxis()Tensor.msortSee torch.msort()Tensor.mulSee torch.mul().Tensor.mul_In-place version of mul().Tensor.multiplySee torch.multiply().Tensor.multiply_In-place version of multiply().Tensor.multinomialSee torch.multinomial()Tensor.mvSee torch.mv()Tensor.mvlgammaSee torch.mvlgamma()Tensor.mvlgamma_In-place version of mvlgamma()Tensor.nansumSee torch.nansum()Tensor.narrowSee torch.narrow()Tensor.narrow_copySee torch.narrow_copy().Tensor.ndimensionAlias for dim()Tensor.nan_to_numSee torch.nan_to_num().Tensor.nan_to_num_In-place version of nan_to_num().Tensor.neSee torch.ne().Tensor.ne_In-place version of ne().Tensor.not_equalSee torch.not_equal().Tensor.not_equal_In-place version of not_equal().Tensor.negSee torch.neg()Tensor.neg_In-place version of neg()Tensor.negativeSee torch.negative()Tensor.negative_In-place version of negative()Tensor.nelementAlias for numel()Tensor.nextafterSee torch.nextafter()Tensor.nextafter_In-place version of nextafter()Tensor.nonzeroSee torch.nonzero()Tensor.normSee torch.norm()Tensor.normal_Fills self tensor with elements samples from the normal distribution parameterized by mean and std.Tensor.numelSee torch.numel()Tensor.numpyReturns the tensor as a NumPy ndarray.Tensor.orgqrSee torch.orgqr()Tensor.ormqrSee torch.ormqr()Tensor.outerSee torch.outer().Tensor.permuteSee torch.permute()Tensor.pin_memoryCopies the tensor to pinned memory, if itâ€™s not already pinned.Tensor.pinverseSee torch.pinverse()Tensor.polygammaSee torch.polygamma()Tensor.polygamma_In-place version of polygamma()Tensor.positiveSee torch.positive()Tensor.powSee torch.pow()Tensor.pow_In-place version of pow()Tensor.prodSee torch.prod()Tensor.put_Copies the elements from source into the positions specified by index.Tensor.qrSee torch.qr()Tensor.qschemeReturns the quantization scheme of a given QTensor.Tensor.quantileSee torch.quantile()Tensor.nanquantileSee torch.nanquantile()Tensor.q_scaleGiven a Tensor quantized by linear(affine) quantization, returns the scale of the underlying quantizer().Tensor.q_zero_pointGiven a Tensor quantized by linear(affine) quantization, returns the zero_point of the underlying quantizer().Tensor.q_per_channel_scalesGiven a Tensor quantized by linear (affine) per-channel quantization, returns a Tensor of scales of the underlying quantizer.Tensor.q_per_channel_zero_pointsGiven a Tensor quantized by linear (affine) per-channel quantization, returns a tensor of zero_points of the underlying quantizer.Tensor.q_per_channel_axisGiven a Tensor quantized by linear (affine) per-channel quantization, returns the index of dimension on which per-channel quantization is applied.Tensor.rad2degSee torch.rad2deg()Tensor.random_Fills self tensor with numbers sampled from the discrete uniform distribution over [from, to - 1].Tensor.ravelsee torch.ravel()Tensor.reciprocalSee torch.reciprocal()Tensor.reciprocal_In-place version of reciprocal()Tensor.record_streamEnsures that the tensor memory is not reused for another tensor until all current work queued on stream are complete.Tensor.register_hookRegisters a backward hook.Tensor.remainderSee torch.remainder()Tensor.remainder_In-place version of remainder()Tensor.renormSee torch.renorm()Tensor.renorm_In-place version of renorm()Tensor.repeatRepeats this tensor along the specified dimensions.Tensor.repeat_interleaveSee torch.repeat_interleave().Tensor.requires_gradIs True if gradients need to be computed for this Tensor, False otherwise.Tensor.requires_grad_Change if autograd should record operations on this tensor: sets this tensorâ€™s requires_grad attribute in-place.Tensor.reshapeReturns a tensor with the same data and number of elements as self but with the specified shape.Tensor.reshape_asReturns this tensor as the same shape as other.Tensor.resize_Resizes self tensor to the specified size.Tensor.resize_as_Resizes the self tensor to be the same size as the specified tensor.Tensor.retain_gradEnables this Tensor to have their grad populated during backward().Tensor.retains_gradIs True if this Tensor is non-leaf and its grad is enabled to be populated during backward(), False otherwise.Tensor.rollSee torch.roll()Tensor.rot90See torch.rot90()Tensor.roundSee torch.round()Tensor.round_In-place version of round()Tensor.rsqrtSee torch.rsqrt()Tensor.rsqrt_In-place version of rsqrt()Tensor.scatterOut-of-place version of torch.Tensor.scatter_()Tensor.scatter_Writes all values from the tensor src into self at the indices specified in the index tensor.Tensor.scatter_add_Adds all values from the tensor src into self at the indices specified in the index tensor in a similar fashion as scatter_().Tensor.scatter_addOut-of-place version of torch.Tensor.scatter_add_()Tensor.scatter_reduce_Reduces all values from the src tensor to the indices specified in the index tensor in the self tensor using the applied reduction defined via the reduce argument (&quot;sum&quot;, &quot;prod&quot;, &quot;mean&quot;, &quot;amax&quot;, &quot;amin&quot;).Tensor.scatter_reduceOut-of-place version of torch.Tensor.scatter_reduce_()Tensor.selectSee torch.select()Tensor.select_scatterSee torch.select_scatter()Tensor.set_Sets the underlying storage, size, and strides.Tensor.share_memory_Moves the underlying storage to shared memory.Tensor.shortself.short() is equivalent to self.to(torch.int16).Tensor.sigmoidSee torch.sigmoid()Tensor.sigmoid_In-place version of sigmoid()Tensor.signSee torch.sign()Tensor.sign_In-place version of sign()Tensor.signbitSee torch.signbit()Tensor.sgnSee torch.sgn()Tensor.sgn_In-place version of sgn()Tensor.sinSee torch.sin()Tensor.sin_In-place version of sin()Tensor.sincSee torch.sinc()Tensor.sinc_In-place version of sinc()Tensor.sinhSee torch.sinh()Tensor.sinh_In-place version of sinh()Tensor.asinhSee torch.asinh()Tensor.asinh_In-place version of asinh()Tensor.arcsinhSee torch.arcsinh()Tensor.arcsinh_In-place version of arcsinh()Tensor.sizeReturns the size of the self tensor.Tensor.slogdetSee torch.slogdet()Tensor.slice_scatterSee torch.slice_scatter()Tensor.sortSee torch.sort()Tensor.splitSee torch.split()Tensor.sparse_maskReturns a new sparse tensor with values from a strided tensor self filtered by the indices of the sparse tensor mask.Tensor.sparse_dimReturn the number of sparse dimensions in a sparse tensor self.Tensor.sqrtSee torch.sqrt()Tensor.sqrt_In-place version of sqrt()Tensor.squareSee torch.square()Tensor.square_In-place version of square()Tensor.squeezeSee torch.squeeze()Tensor.squeeze_In-place version of squeeze()Tensor.stdSee torch.std()Tensor.stftSee torch.stft()Tensor.storageReturns the underlying storage.Tensor.storage_offsetReturns self tensorâ€™s offset in the underlying storage in terms of number of storage elements (not bytes).Tensor.storage_typeReturns the type of the underlying storage.Tensor.strideReturns the stride of self tensor.Tensor.subSee torch.sub().Tensor.sub_In-place version of sub()Tensor.subtractSee torch.subtract().Tensor.subtract_In-place version of subtract().Tensor.sumSee torch.sum()Tensor.sum_to_sizeSum this tensor to size.Tensor.svdSee torch.svd()Tensor.swapaxesSee torch.swapaxes()Tensor.swapdimsSee torch.swapdims()Tensor.symeigSee torch.symeig()Tensor.tSee torch.t()Tensor.t_In-place version of t()Tensor.tensor_splitSee torch.tensor_split()Tensor.tileSee torch.tile()Tensor.toPerforms Tensor dtype and/or device conversion.Tensor.to_mkldnnReturns a copy of the tensor in torch.mkldnn layout.Tensor.takeSee torch.take()Tensor.take_along_dimSee torch.take_along_dim()Tensor.tanSee torch.tan()Tensor.tan_In-place version of tan()Tensor.tanhSee torch.tanh()Tensor.tanh_In-place version of tanh()Tensor.atanhSee torch.atanh()Tensor.atanh_In-place version of atanh()Tensor.arctanhSee torch.arctanh()Tensor.arctanh_In-place version of arctanh()Tensor.tolistReturns the tensor as a (nested) list.Tensor.topkSee torch.topk()Tensor.to_denseCreates a strided copy of self if self is not a strided tensor, otherwise returns self.Tensor.to_sparseReturns a sparse copy of the tensor.Tensor.to_sparse_csrConvert a tensor to compressed row storage format (CSR).Tensor.to_sparse_cscConvert a tensor to compressed column storage (CSC) format.Tensor.to_sparse_bsrConvert a CSR tensor to a block sparse row (BSR) storage format of given blocksize.Tensor.to_sparse_bscConvert a CSR tensor to a block sparse column (BSC) storage format of given blocksize.Tensor.traceSee torch.trace()Tensor.transposeSee torch.transpose()Tensor.transpose_In-place version of transpose()Tensor.triangular_solveSee torch.triangular_solve()Tensor.trilSee torch.tril()Tensor.tril_In-place version of tril()Tensor.triuSee torch.triu()Tensor.triu_In-place version of triu()Tensor.true_divideSee torch.true_divide()Tensor.true_divide_In-place version of true_divide_()Tensor.truncSee torch.trunc()Tensor.trunc_In-place version of trunc()Tensor.typeReturns the type if dtype is not provided, else casts this object to the specified type.Tensor.type_asReturns this tensor cast to the type of the given tensor.Tensor.unbindSee torch.unbind()Tensor.unflattenSee torch.unflatten().Tensor.unfoldReturns a view of the original tensor which contains all slices of size size from self tensor in the dimension dimension.Tensor.uniform_Fills self tensor with numbers sampled from the continuous uniform distribution:Tensor.uniqueReturns the unique elements of the input tensor.Tensor.unique_consecutiveEliminates all but the first element from every consecutive group of equivalent elements.Tensor.unsqueezeSee torch.unsqueeze()Tensor.unsqueeze_In-place version of unsqueeze()Tensor.valuesReturn the values tensor of a sparse COO tensor.Tensor.varSee torch.var()Tensor.vdotSee torch.vdot()Tensor.viewReturns a new tensor with the same data as the self tensor but of a different shape.Tensor.view_asView this tensor as the same size as other.Tensor.vsplitSee torch.vsplit()Tensor.whereself.where(condition, y) is equivalent to torch.where(condition, self, y).Tensor.xlogySee torch.xlogy()Tensor.xlogy_In-place version of xlogy()Tensor.zero_Fills self tensor with zeros.storagetensorçš„æ•°æ®ç»“æ„ã€storage()ã€stride()ã€storage_offset()pytorchä¸­ä¸€ä¸ªtensorå¯¹è±¡åˆ†ä¸ºå¤´ä¿¡æ¯åŒºï¼ˆTensorï¼‰å’Œå­˜å‚¨åŒºï¼ˆStorageï¼‰ä¸¤éƒ¨åˆ†å¤´ä¿¡æ¯åŒºä¸»è¦ä¿å­˜tensorçš„å½¢çŠ¶ï¼ˆsizeï¼‰ã€æ­¥é•¿ï¼ˆstrideï¼‰ã€æ•°æ®ç±»å‹ï¼ˆtypeï¼‰ç­‰ä¿¡æ¯ï¼›è€ŒçœŸæ­£çš„dataï¼ˆæ•°æ®ï¼‰åˆ™ä»¥è¿ç»­ä¸€ç»´æ•°ç»„çš„å½¢å¼æ”¾åœ¨å­˜å‚¨åŒºï¼Œç”±torch.Storageå®ä¾‹ç®¡ç†ç€æ³¨æ„ï¼šstorageæ°¸è¿œæ˜¯ä¸€ç»´æ•°ç»„ï¼Œä»»ä½•ç»´åº¦çš„tensorçš„å®é™…æ•°æ®éƒ½å­˜å‚¨åœ¨ä¸€ç»´çš„storageä¸­è·å–tensorçš„storage123456789101112131415a = torch.tensor([[1.0, 4.0],[2.0, 1.0],[3.0, 5.0]])a.storage()Out[0]:  1.0 4.0 2.0 1.0 3.0 5.0[torch.storage.TypedStorage(dtype=torch.float32, device=cpu) of size 6]a.storage()[2] = 9id(a.storage())Out[1]: 1343354913168å®ä¾‹å°åœŸå †+ææ²è¯¾ç¨‹ç¬”è®°PyTorchæ·±åº¦å­¦ä¹ å¿«é€Ÿå…¥é—¨æ•™ç¨‹ï¼ˆç»å¯¹é€šä¿—æ˜“æ‡‚ï¼ï¼‰ã€å°åœŸå †ã€‘PytorchåŠ è½½æ•°æ®Pytorchä¸­åŠ è½½æ•°æ®éœ€è¦Datasetã€Dataloaderã€‚Datasetæä¾›ä¸€ç§æ–¹å¼å»è·å–æ¯ä¸ªæ•°æ®åŠå…¶å¯¹åº”çš„labelï¼Œå‘Šè¯‰æˆ‘ä»¬æ€»å…±æœ‰å¤šå°‘ä¸ªæ•°æ®ã€‚Dataloaderä¸ºåé¢çš„ç½‘ç»œæä¾›ä¸åŒçš„æ•°æ®å½¢å¼ï¼Œå®ƒå°†ä¸€æ‰¹ä¸€æ‰¹æ•°æ®è¿›è¡Œä¸€ä¸ªæ‰“åŒ…ã€‚Tensorboard1234567891011121314151617import torchvisionfrom torch.utils.data import DataLoaderfrom torch.utils.tensorboard import SummaryWriter# å‡†å¤‡çš„æµ‹è¯•æ•°æ®é›†test_data = torchvision.datasets.CIFAR10(&quot;./dataset&quot;,train=False,transform=torchvision.transforms.ToTensor())               # batch_size=4 ä½¿å¾— img0, target0 = dataset[0]ã€img1, target1 = dataset[1]ã€img2, target2 = dataset[2]ã€img3, target3 = dataset[3]ï¼Œç„¶åè¿™å››ä¸ªæ•°æ®ä½œä¸ºDataloaderçš„ä¸€ä¸ªè¿”å›      test_loader = DataLoader(dataset=test_data,batch_size=64,shuffle=True,num_workers=0,drop_last=False)      # ç”¨forå¾ªç¯å–å‡ºDataLoaderæ‰“åŒ…å¥½çš„å››ä¸ªæ•°æ®writer = SummaryWriter(&quot;logs&quot;)step = 0for data in test_loader:    imgs, targets = data # æ¯ä¸ªdataéƒ½æ˜¯ç”±4å¼ å›¾ç‰‡ç»„æˆï¼Œimgs.size ä¸º [4,3,32,32]ï¼Œå››å¼ 32Ã—32å›¾ç‰‡ä¸‰é€šé“ï¼Œtargetsç”±å››ä¸ªæ ‡ç­¾ç»„æˆ                 writer.add_images(&quot;test_data&quot;,imgs,step)    step = step + 1    writer.close()Transformsâ‘  Transformså½“æˆå·¥å…·ç®±çš„è¯ï¼Œé‡Œé¢çš„classå°±æ˜¯ä¸åŒçš„å·¥å…·ã€‚ä¾‹å¦‚åƒtotensorã€resizeè¿™äº›å·¥å…·ã€‚â‘¡ Transformsæ‹¿ä¸€äº›ç‰¹å®šæ ¼å¼çš„å›¾ç‰‡ï¼Œç»è¿‡Transformsé‡Œé¢çš„å·¥å…·ï¼Œè·å¾—æˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚123456789from torchvision import transformsfrom PIL import Imageimg_path = &quot;Data/FirstTypeData/val/bees/10870992_eebeeb3a12.jpg&quot;img = Image.open(img_path)  tensor_trans = transforms.ToTensor()  # åˆ›å»º transforms.ToTensorç±» çš„å®ä¾‹åŒ–å¯¹è±¡tensor_img = tensor_trans(img)  # è°ƒç”¨ transforms.ToTensorç±» çš„__call__çš„é­”æœ¯æ–¹æ³•   print(tensor_img)torchvisionæ•°æ®é›†â‘  torchvisionä¸­æœ‰å¾ˆå¤šæ•°æ®é›†ï¼Œå½“æˆ‘ä»¬å†™ä»£ç æ—¶æŒ‡å®šç›¸åº”çš„æ•°æ®é›†æŒ‡å®šä¸€äº›å‚æ•°ï¼Œå®ƒå°±å¯ä»¥è‡ªè¡Œä¸‹è½½ã€‚â‘¡ CIFAR-10æ•°æ®é›†åŒ…å«60000å¼ 32Ã—32çš„å½©è‰²å›¾ç‰‡ï¼Œä¸€å…±10ä¸ªç±»åˆ«ï¼Œå…¶ä¸­50000å¼ è®­ç»ƒå›¾ç‰‡ï¼Œ10000å¼ æµ‹è¯•å›¾ç‰‡ã€‚12345678910111213import torchvisiontrain_set = torchvision.datasets.CIFAR10(root=&quot;./dataset&quot;,train=True,download=True) # rootä¸ºå­˜æ”¾æ•°æ®é›†çš„ç›¸å¯¹è·¯çº¿test_set = torchvision.datasets.CIFAR10(root=&quot;./dataset&quot;,train=False,download=True) # train=Trueæ˜¯è®­ç»ƒé›†ï¼Œtrain=Falseæ˜¯æµ‹è¯•é›†  print(test_set[0])       # è¾“å‡ºçš„3æ˜¯target print(test_set.classes)  # æµ‹è¯•æ•°æ®é›†ä¸­æœ‰å¤šå°‘ç§img, target = test_set[0] # åˆ†åˆ«è·å¾—å›¾ç‰‡ã€targetprint(img)print(target)print(test_set.classes[target]) # 3å·targetå¯¹åº”çš„ç§ç±»img.show()æŸå¤±å‡½æ•°â‘  LossæŸå¤±å‡½æ•°ä¸€æ–¹é¢è®¡ç®—å®é™…è¾“å‡ºå’Œç›®æ ‡ä¹‹é—´çš„å·®è·ã€‚â‘¡ LossæŸå¤±å‡½æ•°å¦ä¸€æ–¹é¢ä¸ºæˆ‘ä»¬æ›´æ–°è¾“å‡ºæä¾›ä¸€å®šçš„ä¾æ®L1lossæŸå¤±å‡½æ•°123456789import torchfrom torch.nn import L1Lossinputs = torch.tensor([1,2,3],dtype=torch.float32)targets = torch.tensor([1,2,5],dtype=torch.float32)inputs = torch.reshape(inputs,(1,1,1,3))targets = torch.reshape(targets,(1,1,1,3))loss = L1Loss()  # é»˜è®¤ä¸º maenresult = loss(inputs,targets)print(result)MSEæŸå¤±å‡½æ•°12345678910import torchfrom torch.nn import L1Lossfrom torch import nninputs = torch.tensor([1,2,3],dtype=torch.float32)targets = torch.tensor([1,2,5],dtype=torch.float32)inputs = torch.reshape(inputs,(1,1,1,3))targets = torch.reshape(targets,(1,1,1,3))loss_mse = nn.MSELoss()result_mse = loss_mse(inputs,targets)print(result_mse)äº¤å‰ç†µæŸå¤±å‡½æ•°12345678910import torchfrom torch.nn import L1Lossfrom torch import nnx = torch.tensor([0.1,0.2,0.3])y = torch.tensor([1])x = torch.reshape(x,(1,3)) # 1çš„ batch_sizeï¼Œæœ‰ä¸‰ç±»loss_cross = nn.CrossEntropyLoss()result_cross = loss_cross(x,y)print(result_cross)ä¼˜åŒ–å™¨â‘  æŸå¤±å‡½æ•°è°ƒç”¨backwardæ–¹æ³•ï¼Œå°±å¯ä»¥è°ƒç”¨æŸå¤±å‡½æ•°çš„åå‘ä¼ æ’­æ–¹æ³•ï¼Œå°±å¯ä»¥æ±‚å‡ºæˆ‘ä»¬éœ€è¦è°ƒèŠ‚çš„æ¢¯åº¦ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨æˆ‘ä»¬çš„ä¼˜åŒ–å™¨å°±å¯ä»¥æ ¹æ®æ¢¯åº¦å¯¹å‚æ•°è¿›è¡Œè°ƒæ•´ï¼Œè¾¾åˆ°æ•´ä½“è¯¯å·®é™ä½çš„ç›®çš„ã€‚â‘¡ æ¢¯åº¦è¦æ¸…é›¶ï¼Œå¦‚æœæ¢¯åº¦ä¸æ¸…é›¶ä¼šå¯¼è‡´æ¢¯åº¦ç´¯åŠ 1234567891011loss = nn.CrossEntropyLoss() # äº¤å‰ç†µ    tudui = Tudui()optim = torch.optim.SGD(tudui.parameters(),lr=0.01)   # éšæœºæ¢¯åº¦ä¸‹é™ä¼˜åŒ–å™¨for data in dataloader:    imgs, targets = data    outputs = tudui(imgs)    result_loss = loss(outputs, targets) # è®¡ç®—å®é™…è¾“å‡ºä¸ç›®æ ‡è¾“å‡ºçš„å·®è·    optim.zero_grad()  # æ¢¯åº¦æ¸…é›¶    result_loss.backward() # åå‘ä¼ æ’­ï¼Œè®¡ç®—æŸå¤±å‡½æ•°çš„æ¢¯åº¦    optim.step()   # æ ¹æ®æ¢¯åº¦ï¼Œå¯¹ç½‘ç»œçš„å‚æ•°è¿›è¡Œè°ƒä¼˜    print(result_loss) # å¯¹æ•°æ®åªçœ‹äº†ä¸€éï¼Œåªçœ‹äº†ä¸€è½®ï¼Œæ‰€ä»¥lossä¸‹é™ä¸å¤§ç¥ç»ç½‘ç»œå­¦ä¹ ç‡ä¼˜åŒ–123456789101112131415161718192021222324252627282930313233343536373839404142434445import torchimport torchvisionfrom torch import nn from torch.nn import Conv2d, MaxPool2d, Flatten, Linear, Sequentialfrom torch.utils.data import DataLoaderfrom torch.utils.tensorboard import SummaryWriterdataset = torchvision.datasets.CIFAR10(&quot;./dataset&quot;,train=False,transform=torchvision.transforms.ToTensor(),download=True)       dataloader = DataLoader(dataset, batch_size=64,drop_last=True)class Tudui(nn.Module):    def __init__(self):        super(Tudui, self).__init__()                self.model1 = Sequential(            Conv2d(3,32,5,padding=2),            MaxPool2d(2),            Conv2d(32,32,5,padding=2),            MaxPool2d(2),            Conv2d(32,64,5,padding=2),            MaxPool2d(2),            Flatten(),            Linear(1024,64),            Linear(64,10)        )            def forward(self, x):        x = self.model1(x)        return x    loss = nn.CrossEntropyLoss() # äº¤å‰ç†µ    tudui = Tudui()optim = torch.optim.SGD(tudui.parameters(),lr=0.01)   # éšæœºæ¢¯åº¦ä¸‹é™ä¼˜åŒ–å™¨scheduler = torch.optim.lr_scheduler.StepLR(optim, step_size=5, gamma=0.1) # æ¯è¿‡ step_size æ›´æ–°ä¸€æ¬¡ä¼˜åŒ–å™¨ï¼Œæ›´æ–°æ˜¯å­¦ä¹ ç‡ä¸ºåŸæ¥çš„å­¦ä¹ ç‡çš„ 0.1 å€    for epoch in range(20):    running_loss = 0.0    for data in dataloader:        imgs, targets = data        outputs = tudui(imgs)        result_loss = loss(outputs, targets) # è®¡ç®—å®é™…è¾“å‡ºä¸ç›®æ ‡è¾“å‡ºçš„å·®è·        optim.zero_grad()  # æ¢¯åº¦æ¸…é›¶        result_loss.backward() # åå‘ä¼ æ’­ï¼Œè®¡ç®—æŸå¤±å‡½æ•°çš„æ¢¯åº¦        optim.step()   # æ ¹æ®æ¢¯åº¦ï¼Œå¯¹ç½‘ç»œçš„å‚æ•°è¿›è¡Œè°ƒä¼˜        scheduler.step() # å­¦ä¹ ç‡å¤ªå°äº†ï¼Œæ‰€ä»¥20ä¸ªè½®æ¬¡åï¼Œç›¸å½“äºæ²¡èµ°å¤šå°‘        running_loss = running_loss + result_loss    print(running_loss) # å¯¹è¿™ä¸€è½®æ‰€æœ‰è¯¯å·®çš„æ€»å’Œç½‘ç»œæ¨¡å‹ä½¿ç”¨åŠä¿®æ”¹ç½‘ç»œæ¨¡å‹æ·»åŠ 12345678import torchvisionfrom torch import nndataset = torchvision.datasets.CIFAR10(&quot;./dataset&quot;,train=True,transform=torchvision.transforms.ToTensor(),download=True)       vgg16_true = torchvision.models.vgg16(pretrained=True) # ä¸‹è½½å·ç§¯å±‚å¯¹åº”çš„å‚æ•°æ˜¯å¤šå°‘ã€æ± åŒ–å±‚å¯¹åº”çš„å‚æ•°æ—¶å¤šå°‘ï¼Œè¿™äº›å‚æ•°æ—¶ImageNetè®­ç»ƒå¥½äº†çš„vgg16_true.add_module('add_linear',nn.Linear(1000,10)) # åœ¨VGG16åé¢æ·»åŠ ä¸€ä¸ªçº¿æ€§å±‚ï¼Œä½¿å¾—è¾“å‡ºä¸ºé€‚åº”CIFAR10çš„è¾“å‡ºï¼ŒCIFAR10éœ€è¦è¾“å‡º10ä¸ªç§ç±»print(vgg16_true)ç½‘ç»œæ¨¡å‹ä¿®æ”¹1234567import torchvisionfrom torch import nnvgg16_false = torchvision.models.vgg16(pretrained=False) # æ²¡æœ‰é¢„è®­ç»ƒçš„å‚æ•°     print(vgg16_false)vgg16_false.classifier[6] = nn.Linear(4096,10)print(vgg16_false)ç½‘ç»œæ¨¡å‹ä¿å­˜ä¸è¯»å–æ¨¡å‹ç»“æ„ + æ¨¡å‹å‚æ•°12345678import torchvisionimport torchvgg16 = torchvision.models.vgg16(pretrained=False)torch.save(vgg16,&quot;./model/vgg16_method1.pth&quot;) # ä¿å­˜æ–¹å¼ä¸€ï¼šæ¨¡å‹ç»“æ„ + æ¨¡å‹å‚æ•°      print(vgg16)model = torch.load(&quot;./model/vgg16_method1.pth&quot;) # ä¿å­˜æ–¹å¼ä¸€å¯¹åº”çš„åŠ è½½æ¨¡å‹    print(model)æ¨¡å‹å‚æ•°ï¼ˆå®˜æ–¹æ¨èï¼‰ï¼Œä¸ä¿å­˜ç½‘ç»œæ¨¡å‹ç»“æ„12345678import torchvisionimport torchvgg16 = torchvision.models.vgg16(pretrained=False)torch.save(vgg16.state_dict(),&quot;./model/vgg16_method2.pth&quot;) # ä¿å­˜æ–¹å¼äºŒï¼šæ¨¡å‹å‚æ•°ï¼ˆå®˜æ–¹æ¨èï¼‰,ä¸å†ä¿å­˜ç½‘ç»œæ¨¡å‹ç»“æ„  print(vgg16)model = torch.load(&quot;./model/vgg16_method2.pth&quot;) # å¯¼å…¥æ¨¡å‹å‚æ•°   print(model)å›ºå®šæ¨¡å‹å‚æ•°åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å¯èƒ½éœ€è¦å›ºå®šä¸€éƒ¨åˆ†æ¨¡å‹çš„å‚æ•°ï¼Œåªæ›´æ–°å¦ä¸€éƒ¨åˆ†å‚æ•°ï¼Œæœ‰ä¸¤ç§æ€è·¯å®ç°è¿™ä¸ªç›®æ ‡ä¸€ä¸ªæ˜¯è®¾ç½®ä¸è¦æ›´æ–°å‚æ•°çš„ç½‘ç»œå±‚ä¸ºfalseå¦ä¸€ä¸ªå°±æ˜¯åœ¨å®šä¹‰ä¼˜åŒ–å™¨æ—¶åªä¼ å…¥è¦æ›´æ–°çš„å‚æ•°å½“ç„¶æœ€ä¼˜çš„åšæ³•æ˜¯ï¼Œä¼˜åŒ–å™¨ä¸­åªä¼ å…¥requires_grad=Trueçš„å‚æ•°ï¼Œè¿™æ ·å ç”¨çš„å†…å­˜ä¼šæ›´å°ä¸€ç‚¹ï¼Œæ•ˆç‡ä¹Ÿä¼šæ›´é«˜12345678910111213141516171819202122232425262728293031323334353637383940414243import torchimport torch.nn as nnimport torch.optim as optim# å®šä¹‰ä¸€ä¸ªç®€å•çš„ç½‘ç»œclass net(nn.Module):    def __init__(self, num_class=3):        super(net, self).__init__()        self.fc1 = nn.Linear(8, 4)        self.fc2 = nn.Linear(4, num_class)    def forward(self, x):        return self.fc2(self.fc1(x))model = net()# å†»ç»“fc1å±‚çš„å‚æ•°for name, param in model.named_parameters():    if &quot;fc1&quot; in name:        param.requires_grad = Falseloss_fn = nn.CrossEntropyLoss()# åªä¼ å…¥requires_grad = Trueçš„å‚æ•°optimizer = optim.SGD(filter(lambda p: p.requires_grad, net.parameters(), lr=1e-2)print(&quot;model.fc1.weight&quot;, model.fc1.weight)print(&quot;model.fc2.weight&quot;, model.fc2.weight)model.train()for epoch in range(10):    x = torch.randn((3, 8))    label = torch.randint(0, 3, [3]).long()    output = model(x)    loss = loss_fn(output, label)    optimizer.zero_grad()    loss.backward()    optimizer.step()print(&quot;model.fc1.weight&quot;, model.fc1.weight)print(&quot;model.fc2.weight&quot;, model.fc2.weight)è®­ç»ƒæµç¨‹DataLoaderåŠ è½½æ•°æ®é›†123456789101112131415161718import torchvisionfrom torch import nnfrom torch.utils.data import DataLoader# å‡†å¤‡æ•°æ®é›†train_data = torchvision.datasets.CIFAR10(&quot;./dataset&quot;,train=True,transform=torchvision.transforms.ToTensor(),download=True)       test_data = torchvision.datasets.CIFAR10(&quot;./dataset&quot;,train=False,transform=torchvision.transforms.ToTensor(),download=True)       # length é•¿åº¦train_data_size = len(train_data)test_data_size = len(test_data)# å¦‚æœtrain_data_size=10ï¼Œåˆ™æ‰“å°ï¼šè®­ç»ƒæ•°æ®é›†çš„é•¿åº¦ä¸ºï¼š10print(&quot;è®­ç»ƒæ•°æ®é›†çš„é•¿åº¦ï¼š{}&quot;.format(train_data_size))print(&quot;æµ‹è¯•æ•°æ®é›†çš„é•¿åº¦ï¼š{}&quot;.format(test_data_size))# åˆ©ç”¨ Dataloader æ¥åŠ è½½æ•°æ®é›†train_dataloader = DataLoader(train_data_size, batch_size=64)        test_dataloader = DataLoader(test_data_size, batch_size=64)æµ‹è¯•ç½‘ç»œæ­£ç¡®12345678910111213141516171819202122232425262728import torchfrom torch import nn# æ­å»ºç¥ç»ç½‘ç»œclass Tudui(nn.Module):    def __init__(self):        super(Tudui, self).__init__()                self.model1 = nn.Sequential(            nn.Conv2d(3,32,5,1,2),  # è¾“å…¥é€šé“3ï¼Œè¾“å‡ºé€šé“32ï¼Œå·ç§¯æ ¸å°ºå¯¸5Ã—5ï¼Œæ­¥é•¿1ï¼Œå¡«å……2                nn.MaxPool2d(2),            nn.Conv2d(32,32,5,1,2),            nn.MaxPool2d(2),            nn.Conv2d(32,64,5,1,2),            nn.MaxPool2d(2),            nn.Flatten(),  # å±•å¹³åå˜æˆ 64*4*4 äº†            nn.Linear(64*4*4,64),            nn.Linear(64,10)        )            def forward(self, x):        x = self.model1(x)        return x    if __name__ == '__main__':    tudui = Tudui()    input = torch.ones((64,3,32,32))    output = tudui(input)    print(output.shape)  # æµ‹è¯•è¾“å‡ºçš„å°ºå¯¸æ˜¯ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç½‘ç»œè®­ç»ƒæ•°æ®â‘  model.train()å’Œmodel.eval()çš„åŒºåˆ«ä¸»è¦åœ¨äºBatch Normalizationå’ŒDropoutä¸¤å±‚ã€‚â‘¡ å¦‚æœæ¨¡å‹ä¸­æœ‰BNå±‚(Batch Normalizationï¼‰å’Œ Dropoutï¼Œéœ€è¦åœ¨è®­ç»ƒæ—¶æ·»åŠ model.train()ã€‚model.train()æ˜¯ä¿è¯BNå±‚èƒ½å¤Ÿç”¨åˆ°æ¯ä¸€æ‰¹æ•°æ®çš„å‡å€¼å’Œæ–¹å·®ã€‚å¯¹äºDropoutï¼Œmodel.train()æ˜¯éšæœºå–ä¸€éƒ¨åˆ†ç½‘ç»œè¿æ¥æ¥è®­ç»ƒæ›´æ–°å‚æ•°ã€‚â‘¢ ä¸å¯ç”¨ Batch Normalization å’Œ Dropoutã€‚ å¦‚æœæ¨¡å‹ä¸­æœ‰BNå±‚(Batch Normalizationï¼‰å’ŒDropoutï¼Œåœ¨æµ‹è¯•æ—¶æ·»åŠ model.eval()ã€‚model.eval()æ˜¯ä¿è¯BNå±‚èƒ½å¤Ÿç”¨å…¨éƒ¨è®­ç»ƒæ•°æ®çš„å‡å€¼å’Œæ–¹å·®ï¼Œå³æµ‹è¯•è¿‡ç¨‹ä¸­è¦ä¿è¯BNå±‚çš„å‡å€¼å’Œæ–¹å·®ä¸å˜ã€‚å¯¹äºDropoutï¼Œmodel.eval()æ˜¯åˆ©ç”¨åˆ°äº†æ‰€æœ‰ç½‘ç»œè¿æ¥ï¼Œå³ä¸è¿›è¡Œéšæœºèˆå¼ƒç¥ç»å…ƒã€‚â‘£ è®­ç»ƒå®Œtrainæ ·æœ¬åï¼Œç”Ÿæˆçš„æ¨¡å‹modelè¦ç”¨æ¥æµ‹è¯•æ ·æœ¬ã€‚åœ¨model(test)ä¹‹å‰ï¼Œéœ€è¦åŠ ä¸Šmodel.eval()ï¼Œå¦åˆ™çš„è¯ï¼Œæœ‰è¾“å…¥æ•°æ®ï¼Œå³ä½¿ä¸è®­ç»ƒï¼Œå®ƒä¹Ÿä¼šæ”¹å˜æƒå€¼ã€‚è¿™æ˜¯modelä¸­å«æœ‰BNå±‚å’ŒDropoutæ‰€å¸¦æ¥çš„æ€§è´¨ã€‚â‘¤ åœ¨åšone classificationçš„æ—¶å€™ï¼Œè®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„æ ·æœ¬åˆ†å¸ƒæ˜¯ä¸ä¸€æ ·çš„ï¼Œå°¤å…¶éœ€è¦æ³¨æ„è¿™ä¸€ç‚¹123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107import torchvisionimport torchfrom torch import nnfrom torch.utils.data import DataLoaderfrom torch.utils.tensorboard import SummaryWriter# from model import * ç›¸å½“äºæŠŠ modelä¸­çš„æ‰€æœ‰å†…å®¹å†™åˆ°è¿™é‡Œï¼Œè¿™é‡Œç›´æ¥æŠŠ model å†™åœ¨è¿™é‡Œclass Tudui(nn.Module):    def __init__(self):        super(Tudui, self).__init__()                self.model1 = nn.Sequential(            nn.Conv2d(3,32,5,1,2),  # è¾“å…¥é€šé“3ï¼Œè¾“å‡ºé€šé“32ï¼Œå·ç§¯æ ¸å°ºå¯¸5Ã—5ï¼Œæ­¥é•¿1ï¼Œå¡«å……2                nn.MaxPool2d(2),            nn.Conv2d(32,32,5,1,2),            nn.MaxPool2d(2),            nn.Conv2d(32,64,5,1,2),            nn.MaxPool2d(2),            nn.Flatten(),  # å±•å¹³åå˜æˆ 64*4*4 äº†            nn.Linear(64*4*4,64),            nn.Linear(64,10)        )            def forward(self, x):        x = self.model1(x)        return x# å‡†å¤‡æ•°æ®é›†train_data = torchvision.datasets.CIFAR10(&quot;./dataset&quot;,train=True,transform=torchvision.transforms.ToTensor(),download=True)       test_data = torchvision.datasets.CIFAR10(&quot;./dataset&quot;,train=False,transform=torchvision.transforms.ToTensor(),download=True)       # length é•¿åº¦train_data_size = len(train_data)test_data_size = len(test_data)# å¦‚æœtrain_data_size=10ï¼Œåˆ™æ‰“å°ï¼šè®­ç»ƒæ•°æ®é›†çš„é•¿åº¦ä¸ºï¼š10print(&quot;è®­ç»ƒæ•°æ®é›†çš„é•¿åº¦ï¼š{}&quot;.format(train_data_size))print(&quot;æµ‹è¯•æ•°æ®é›†çš„é•¿åº¦ï¼š{}&quot;.format(test_data_size))# åˆ©ç”¨ Dataloader æ¥åŠ è½½æ•°æ®é›†train_dataloader = DataLoader(train_data, batch_size=64)        test_dataloader = DataLoader(test_data, batch_size=64)# åˆ›å»ºç½‘ç»œæ¨¡å‹tudui = Tudui() # æŸå¤±å‡½æ•°loss_fn = nn.CrossEntropyLoss() # äº¤å‰ç†µï¼Œfn æ˜¯ fuction çš„ç¼©å†™# ä¼˜åŒ–å™¨learning = 0.01  # 1e-2 å°±æ˜¯ 0.01 çš„æ„æ€optimizer = torch.optim.SGD(tudui.parameters(),learning)   # éšæœºæ¢¯åº¦ä¸‹é™ä¼˜åŒ–å™¨  # è®¾ç½®ç½‘ç»œçš„ä¸€äº›å‚æ•°# è®°å½•è®­ç»ƒçš„æ¬¡æ•°total_train_step = 0# è®°å½•æµ‹è¯•çš„æ¬¡æ•°total_test_step = 0# è®­ç»ƒçš„è½®æ¬¡epoch = 10# æ·»åŠ  tensorboardwriter = SummaryWriter(&quot;logs&quot;)for i in range(epoch):    print(&quot;-----ç¬¬ {} è½®è®­ç»ƒå¼€å§‹-----&quot;.format(i+1))        # è®­ç»ƒæ­¥éª¤å¼€å§‹    tudui.train() # å½“ç½‘ç»œä¸­æœ‰dropoutå±‚ã€batchnormå±‚æ—¶ï¼Œè¿™äº›å±‚èƒ½èµ·ä½œç”¨    for data in train_dataloader:        imgs, targets = data        outputs = tudui(imgs)        loss = loss_fn(outputs, targets) # è®¡ç®—å®é™…è¾“å‡ºä¸ç›®æ ‡è¾“å‡ºçš„å·®è·                # ä¼˜åŒ–å™¨å¯¹æ¨¡å‹è°ƒä¼˜        optimizer.zero_grad()  # æ¢¯åº¦æ¸…é›¶        loss.backward() # åå‘ä¼ æ’­ï¼Œè®¡ç®—æŸå¤±å‡½æ•°çš„æ¢¯åº¦        optimizer.step()   # æ ¹æ®æ¢¯åº¦ï¼Œå¯¹ç½‘ç»œçš„å‚æ•°è¿›è¡Œè°ƒä¼˜                total_train_step = total_train_step + 1        if total_train_step % 100 == 0:            print(&quot;è®­ç»ƒæ¬¡æ•°ï¼š{}ï¼ŒLossï¼š{}&quot;.format(total_train_step,loss.item()))  # æ–¹å¼äºŒï¼šè·å¾—losså€¼            writer.add_scalar(&quot;train_loss&quot;,loss.item(),total_train_step)        # æµ‹è¯•æ­¥éª¤å¼€å§‹ï¼ˆæ¯ä¸€è½®è®­ç»ƒåéƒ½æŸ¥çœ‹åœ¨æµ‹è¯•æ•°æ®é›†ä¸Šçš„lossæƒ…å†µï¼‰    tudui.eval()  # å½“ç½‘ç»œä¸­æœ‰dropoutå±‚ã€batchnormå±‚æ—¶ï¼Œè¿™äº›å±‚ä¸èƒ½èµ·ä½œç”¨    total_test_loss = 0    total_accuracy = 0    with torch.no_grad():  # æ²¡æœ‰æ¢¯åº¦äº†        for data in test_dataloader: # æµ‹è¯•æ•°æ®é›†æå–æ•°æ®            imgs, targets = data            outputs = tudui(imgs)            loss = loss_fn(outputs, targets) # ä»…dataæ•°æ®åœ¨ç½‘ç»œæ¨¡å‹ä¸Šçš„æŸå¤±            total_test_loss = total_test_loss + loss.item() # æ‰€æœ‰loss            accuracy = (outputs.argmax(1) == targets).sum()            total_accuracy = total_accuracy + accuracy                print(&quot;æ•´ä½“æµ‹è¯•é›†ä¸Šçš„Lossï¼š{}&quot;.format(total_test_loss))    print(&quot;æ•´ä½“æµ‹è¯•é›†ä¸Šçš„æ­£ç¡®ç‡ï¼š{}&quot;.format(total_accuracy/test_data_size))    writer.add_scalar(&quot;test_loss&quot;,total_test_loss,total_test_step)    writer.add_scalar(&quot;test_accuracy&quot;,total_accuracy/test_data_size,total_test_step)      total_test_step = total_test_step + 1        torch.save(tudui, &quot;./model/tudui_{}.pth&quot;.format(i)) # ä¿å­˜æ¯ä¸€è½®è®­ç»ƒåçš„ç»“æœ    #torch.save(tudui.state_dict(),&quot;tudui_{}.path&quot;.format(i)) # ä¿å­˜æ–¹å¼äºŒ             print(&quot;æ¨¡å‹å·²ä¿å­˜&quot;)    writer.close()</content>
	</entry>
	<entry>
		<title>pythonå¸¸ç”¨åº“å­¦ä¹ </title>
		<url>/article/31546.html</url>
		<content>å›¾åƒç›¸å…³10ä¸ªPythonå›¾åƒå¤„ç†å·¥å…·ï¼Œéå¸¸å…¨äº†ï¼å›¾åƒçš„RGB è‰²å½©æ¨¡å¼RGB ä¸‰ä¸ªé¢œè‰²é€šé“çš„å˜åŒ–å’Œå åŠ å¾—åˆ°å„ç§é¢œè‰²ï¼Œå…¶ä¸­R çº¢è‰²ï¼Œå–å€¼èŒƒå›´ï¼Œ0-255G ç»¿è‰²ï¼Œå–å€¼èŒƒå›´ï¼Œ0-255B è“è‰²ï¼Œå–å€¼èŒƒå›´ï¼Œ0-255ä¸€å¹…å›¾åƒä¸Šçš„æ‰€æœ‰åƒç´ ç‚¹çš„ä¿¡æ¯å°±å®Œå…¨å¯ä»¥é‡‡ç”¨çŸ©é˜µæ¥è¡¨ç¤ºï¼Œé€šè¿‡çŸ©é˜µçš„è¿ç®—å®ç°æ›´åŠ å¤æ‚çš„æ“ä½œç½‘ç»œå›¾ç‰‡è¯»å–12345678def get_url_img_io(url: str) -&gt; BytesIO:    &quot;&quot;&quot; è·å–ç½‘ç»œå›¾ç‰‡çš„ioæµ &quot;&quot;&quot;    return BytesIO(requests.get(url).content)def get_url_img(url: str):    &quot;&quot;&quot; è·å–ç½‘ç»œå›¾ç‰‡,å¹¶è½¬ä¸ºnp.array &quot;&quot;&quot;    return np.asarray(bytearray(get_url_img_io(url).read()), dtype=&quot;uint8&quot;)plt.imshow()å‡½æ•°è´Ÿè´£å¯¹å›¾åƒè¿›è¡Œå¤„ç†ï¼Œå¹¶æ˜¾ç¤ºå…¶æ ¼å¼plt.show()åˆ™æ˜¯å°†plt.imshow()å¤„ç†åçš„å‡½æ•°æ˜¾ç¤ºå‡ºæ¥PILPythonå›¾åƒåº“ï¼ˆPIL(Python Image Library)ï¼‰æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹PythonåŒ…ï¼Œä¸ºPythonè§£é‡Šå™¨æ·»åŠ äº†å›¾åƒå¤„ç†åŠŸèƒ½ï¼Œå…è®¸å¤„ç†ç…§ç‰‡å¹¶æ‰§è¡Œè®¸å¤šå¸¸è§çš„å›¾åƒæ–‡ä»¶æ“ä½œï¼Œå®˜æ–¹æ•™ç¨‹æ‰“å¼€å›¾åƒï¼šè¿”å›ä¸€ä¸ªPIL.JpegImagePlugin.JpegImageFileå¯¹è±¡12345678910111213# å¯¼å…¥ Image æ¨¡å—import requestsfrom PIL import Image# å›¾åƒè·¯å¾„img_path = r'frame.jpg'img_url = r'https://pic.hycbook.com/i/hexo/post_cover/è•¾å§†10.webp'# æ‰“å¼€æœ¬åœ°å›¾ç‰‡  RGBim = Image.open(img_path) # JpegImageFile image mode=RGB size=1408x1152# æ‰“å¼€ç½‘ç»œå›¾ç‰‡img = Image.open(get_url_img_io(img_url))   # [H,W,C]JpegImageFileå¯¹è±¡å¸¸ç”¨æ–¹æ³•123456789101112131415161718import matplotlib.pyplot as plt# Returns a histogram for the imagehistogram = image.histogram()# å¯è§†åŒ–é¢œè‰²åˆ†å¸ƒç›´æ–¹å›¾plt.hist(histogram, bins=len(histogram))plt.xlabel('Histogram')plt.show()# è£å‰ªå›¾åƒ  ç”¨äºè£å‰ªçš„å¼€å§‹å’Œç»“æŸx/yåæ ‡# ç”¨äºè£å‰ªçš„åæ ‡å°†éšç…§ç‰‡è€Œå˜åŒ–ã€‚äº‹å®ä¸Šï¼Œå¯èƒ½åº”è¯¥æ›´æ”¹æ­¤ä»£ç ï¼Œä½¿å…¶æ¥å—è£å‰ªåæ ‡ä½œä¸ºå‚æ•°ã€‚å¯ä»¥è‡ªå·±åå¤å°è¯•ï¼Œæ‰¾å‡ºè¦ä½¿ç”¨çš„è£å‰ªè¾¹ç•Œæ¡†ã€‚å¯ä»¥ä½¿ç”¨åƒGimpè¿™æ ·çš„å·¥å…·æ¥å¸®åŠ©ä½ ï¼Œç”¨Gimpç»˜åˆ¶ä¸€ä¸ªè¾¹ç•Œæ¡†ï¼Œå¹¶è®°ä¸‹å®ƒç»™ä½ çš„åæ ‡ï¼Œæ–¹ä¾¿å°è¯•ä½¿ç”¨Pillowcropped = image.crop((40, 590, 979, 1500))# é‡æ–°è°ƒæ•´å›¾åƒå¤§å°img = im.resize((240,240))# å›¾åƒæ—‹è½¬img.rotate(90).show()ä½¿ç”¨è¿‡æ»¤å™¨ï¼šPillowåŒ…å«æœ‰å‡ ä¸ªè¿‡æ»¤å™¨ï¼Œå¯ä»¥å°†å…¶åº”ç”¨äºå›¾åƒã€‚ä»¥ä¸‹æ˜¯å½“å‰æ”¯æŒçš„ç­›é€‰å™¨BLURCONTOURDETAILEDGE_ENHANCEEDGE_ENHANCE_MOREEMBOSSFIND_EDGESSHARPENSMOOTHSMOOTH_MORE123from PIL import ImageFilterblurred_image = image.filter(ImageFilter.BLUR)æ˜¾ç¤ºå›¾ç‰‡1234# æ‰“å¼€å›¾ç‰‡im = Image.open(img_path)# æ˜¾ç¤ºå›¾ç‰‡im.show()ä¿å­˜å›¾åƒ1234infile = &quot;in.jpg&quot;outfile = &quot;output.jpg&quot;with Image.open(infile) as im:im.save(outfile)ç±»å‹è½¬æ¢12345# JpegImageFile -&gt; np.array  [H,W,C]np.asanyarray(im)# np.array -&gt; JpegImageFileimg = Image.fromarray(arr)cv2åœ¨è®¡ç®—æœºè§†è§‰é¡¹ç›®çš„å¼€å‘ä¸­ï¼ŒOpenCVä½œä¸ºè¾ƒå¤§ä¼—çš„å¼€æºåº“ï¼Œæ‹¥æœ‰äº†ä¸°å¯Œçš„å¸¸ç”¨å›¾åƒå¤„ç†å‡½æ•°åº“ï¼Œé‡‡ç”¨C/C++è¯­è¨€ç¼–å†™ï¼Œå¯ä»¥è¿è¡Œåœ¨Linux/Windows/Macç­‰æ“ä½œç³»ç»Ÿä¸Šï¼Œèƒ½å¤Ÿå¿«é€Ÿçš„å®ç°ä¸€äº›å›¾åƒå¤„ç†å’Œè¯†åˆ«çš„ä»»åŠ¡ã€‚æ­¤å¤–ï¼ŒOpenCVè¿˜æä¾›äº†Javaã€pythonã€cudaç­‰çš„ä½¿ç”¨æ¥å£ã€æœºå™¨å­¦ä¹ çš„åŸºç¡€ç®—æ³•è°ƒç”¨ï¼Œä»è€Œä½¿å¾—å›¾åƒå¤„ç†å’Œå›¾åƒåˆ†æå˜å¾—æ›´åŠ æ˜“äºä¸Šæ‰‹ï¼Œè®©å¼€å‘äººå‘˜æ›´å¤šçš„ç²¾åŠ›èŠ±åœ¨ç®—æ³•çš„è®¾è®¡ä¸Šæ‰“å¼€å›¾åƒï¼šcv2.imread(filepath, flags)ï¼Œè¿”å›ä¸€ä¸ªnp.arrayå¯¹è±¡flagsï¼šè¯»å…¥å›¾ç‰‡çš„æ ‡å¿—cv2.IMREAD_COLORï¼šé»˜è®¤å‚æ•°ï¼Œè¯»å…¥ä¸€å‰¯å½©è‰²å›¾ç‰‡ï¼Œå¿½ç•¥alphaé€šé“cv2.IMREAD_GRAYSCALEï¼šè¯»å…¥ç°åº¦å›¾ç‰‡cv2.IMREAD_UNCHANGEDï¼šé¡¾åæ€ä¹‰ï¼Œè¯»å…¥å®Œæ•´å›¾ç‰‡ï¼ŒåŒ…æ‹¬alphaé€šé“123456789# å›¾åƒè·¯å¾„img_path = r'frame.jpg'img_url = r'https://pic.hycbook.com/i/hexo/post_cover/è•¾å§†10.webp'# æ‰“å¼€ç½‘ç»œå›¾ç‰‡img = get_url_img(img_url)# æ‰“å¼€æœ¬åœ°å›¾ç‰‡image = cv2.imread(img_path)  # [H,W,C]  np.arrayæ‰“å¼€è§†é¢‘å¸¸è§æ“ä½œresize:cv2.resize(InputArray src, OutputArray dst, Size, fx, fy, interpolation)fx, fyæ²¿xè½´ï¼Œyè½´çš„ç¼©æ”¾ç³»æ•°interpolationæ’å…¥æ–¹å¼INTER_NEARESTæœ€è¿‘é‚»æ’å€¼INTER_LINEARåŒçº¿æ€§æ’å€¼ï¼ˆé»˜è®¤è®¾ç½®ï¼‰INTER_AREAä½¿ç”¨åƒç´ åŒºåŸŸå…³ç³»è¿›è¡Œé‡é‡‡æ ·ã€‚INTER_CUBIC4x4åƒç´ é‚»åŸŸçš„åŒä¸‰æ¬¡æ’å€¼INTER_LANCZOS48x8åƒç´ é‚»åŸŸçš„Lanczosæ’å€¼12img_test = cv2.resize(img, (0, 0), fx=0.25, fy=0.25, interpolation=cv2.INTER_NEAREST)img_test = cv2.resize(img_test, (0, 0), fx=4, fy=4, interpolation=cv2.INTER_NEAREST)RGBè½¬ç°åº¦ï¼š1img2 = cv2.cvtColor(img, cv2.COLOR_RGB2GRAY)ç°åº¦è½¬RBGï¼š1img3 = cv2.cv2Color(img, cv2.COLOR_GRAY2RGB)æ˜¾ç¤ºå›¾ç‰‡12cv2.imshow(&quot;local pic&quot;, image)cv2.waitKey(0)ä¿å­˜å›¾åƒ1cv2.imwrite(outfile, image)æ—¶é—´ç›¸å…³åº“åè°ƒä¸–ç•Œæ—¶(Coordinated Universal Time, UTC)æ˜¯ä¸€ç§æ ‡å‡†çš„æ—¶é—´è¡¨è¿°æ–¹å¼ï¼Œå®ƒä¸æ—¶åŒºæ— å…³æœ‰äº›è®¡ç®—æœºï¼Œç”¨æŸæ—¶åˆ»ä¸UNIXæ—¶é—´åŸç‚¹ä¹‹é—´ç›¸å·®çš„ç§’æ•°ï¼Œæ¥è¡¨ç¤ºé‚£ä¸ªæ—¶åˆ»æ‰€å¯¹åº”çš„æ—¶é—´å¯¹äºè¿™äº›è®¡ç®—æœºæ¥è¯´ï¼ŒUTCæ˜¯ä¸€ç§éå¸¸å¥½çš„è®¡æ—¶æ–¹å¼Pythonæä¾›äº†ä¸¤ç§æ—¶é—´è½¬æ¢æ–¹å¼æ—§çš„æ–¹å¼ï¼Œæ˜¯ä½¿ç”¨å†…ç½®çš„timeæ¨¡å—ï¼Œè¿™æ˜¯ä¸€ç§ææ˜“å‡ºé”™çš„æ–¹å¼æ–°çš„æ–¹å¼ï¼Œåˆ™æ˜¯é‡‡ç”¨å†…ç½®çš„datetimeæ¨¡å—ï¼Œè¯¥æ¨¡å—çš„æ•ˆæœéå¸¸å¥½å°ç»“ï¼štimeæ¨¡å—éœ€è¦ä¾èµ–æ“ä½œç³»ç»Ÿè€Œè¿ä½œã€‚è¯¥æ¨¡å—çš„å®é™…è¡Œä¸ºï¼Œå–å†³äºåº•å±‚çš„Cå‡½æ•°å¦‚ä½•ä¸å®¿ä¸»æ“ä½œç³»ç»Ÿç›¸äº¤äº’è¿™ç§å·¥ä½œæ–¹å¼ï¼Œä½¿å¾—timeæ¨¡å—çš„åŠŸèƒ½ä¸å¤Ÿç¨³å®šã€‚å®ƒæ— æ³•åè°ƒåœ°å¤„ç†å„ç§æœ¬åœ°æ—¶åŒºï¼Œå› æ­¤ï¼Œæˆ‘ä»¬åº”è¯¥å°½é‡å°‘ç”¨è¿™ä¸ªæ¨¡å—å¦‚æœä¸€å®šè¦ä½¿ç”¨timeæ¨¡å—ï¼Œé‚£å°±åªåº”è¯¥ç”¨å®ƒåœ¨UTCä¸å®¿ä¸»è®¡ç®—æœºçš„å½“åœ°æ—¶åŒºä¹‹é—´è¿›è¡Œè½¬æ¢å¯¹äºå…¶ä»–ç±»å‹çš„è½¬æ¢æ¥è¯´ï¼Œè¿˜æ˜¯ä½¿ç”¨datetimeæ¨¡å—æ¯”è¾ƒå¥½å¸¸è§çš„æ—¶é—´æ¨¡å—time: Pythonå†…ç½®æ—¶é—´åº“ï¼Œé€šè¿‡æ—¶é—´æˆ³æˆ–å…ƒç»„è¡¨ç¤ºæ—¶é—´ï¼ŒåŠŸèƒ½ç®€çº¦ä½†å®ç”¨datetime: å†…ç½®æ—¥æœŸåº“ï¼Œå¤„ç†æ—¥æœŸæ—¶é—´å¯¹è±¡å’Œå±æ€§dateutil: åŸºäºdatetimeåº“çš„å®ç”¨æ‹“å±•ï¼Œå¢å¼ºäº†å¯¹æ—¶é—´é—´éš”å’Œæ—¶é—´åºåˆ—çš„å¤„ç†timeåº“çš„ä½¿ç”¨ timeâ€” Time access and conversionstimeåº“æ˜¯Pythonä¸­å¤„ç†æ—¶é—´çš„æ ‡å‡†åº“è®¡ç®—æœºæ—¶é—´çš„è¡¨è¾¾æä¾›è·å–ç³»ç»Ÿæ—¶é—´å¹¶æ ¼å¼åŒ–è¾“å‡ºåŠŸèƒ½æä¾›ç³»ç»Ÿçº§ç²¾ç¡®è®¡æ—¶åŠŸèƒ½ï¼Œç”¨äºç¨‹åºæ€§èƒ½åˆ†ææ—¶é—´è·å–12345678910111213141516# è·å–å½“å‰æ—¶é—´æˆ³ï¼Œå³è®¡ç®—æœºå†…éƒ¨æ—¶é—´å€¼ï¼Œæµ®ç‚¹æ•°&gt;&gt;&gt;time.time()1568506809.169575# è·å–å½“å‰æ—¶é—´å¹¶ä»¥æ˜“è¯»æ–¹å¼è¡¨ç¤ºï¼Œè¿”å›å­—ç¬¦ä¸², å°† gmtime()æˆ–localtime() è¿”å›çš„ è¡¨ç¤ºæ—¶é—´çš„ å…ƒç»„æˆ–struct_time è½¬æ¢æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ ¼å¼ï¼š'Sun Jun 20 23:21:051993'ã€‚&gt;&gt;&gt;time.ctime()  # ç­‰ä»·äº time.asctime(time.localtime(time.time()))'Sun Sep 15 08:20:16 2019'# è·å–å½“å‰æ—¶é—´ï¼Œè¡¨ç¤ºä¸ºè®¡ç®—æœºå¯å¤„ç†çš„æ—¶é—´æ ¼å¼ï¼Œè¿”å›çš„æ—¶é—´æ˜¯ä¸¤ä¸ªæ—¶åŒºå¯¹ç›¸åŒæ—¶åˆ»çš„æ—¶é—´è¡¨ç¤º# è¿”å›çš„æ˜¯struct_timeæ ¼å¼ï¼Œæ˜¯tupleçš„å­ç±»&gt;&gt;&gt;time.gmtime()  # 0æ—¶åŒº:time.gmtime() æœ¬åœ°æ—¶åŒº:time.localtime(seconds=None)time.struct_time(tm_year=2019, tm_mon=9, tm_mday=15, tm_hour=0, tm_min=21, tm_sec=40, tm_wday=6, tm_yday=258, tm_isdst=0)# time.mktime(t)æ˜¯localtime()çš„åå‡½æ•°&gt;&gt;&gt;time.mktime(time.localtime())1568508316.0struct_timeå…ƒç»„çš„å±æ€§å¦‚ä¸‹åºå·å±æ€§å€¼0tm_year20081tm_mon1 åˆ° 122tm_mday1 åˆ° 313tm_hour0 åˆ° 234tm_min0 åˆ° 595tm_sec0 åˆ° 61 (60æˆ–61 æ˜¯é—°ç§’)6tm_wday0åˆ°6 (0æ˜¯å‘¨ä¸€)7tm_yday1 åˆ° 366(å„’ç•¥å†)8tm_isdst-1, 0, 1, -1æ˜¯å†³å®šæ˜¯å¦ä¸ºå¤ä»¤æ—¶çš„æ——å¸œæ—¶é—´æ ¼å¼åŒ–å¯¹è±¡è½¬å­—ç¬¦ä¸²: time.strftime(format, obj)å­—ç¬¦ä¸²è½¬ç»“æ„åŒ–: time.strptime(time_str, format)1234567891011121314151617181920# strftime(tpl, ts)# tplæ˜¯æ ¼å¼åŒ–æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œç”¨æ¥å®šä¹‰è¾“å‡ºæ•ˆæœ# tsæ˜¯è®¡ç®—æœºå†…éƒ¨æ—¶é—´ç±»å‹å˜é‡&gt;&gt;&gt;t = time.gmtime()&gt;&gt;&gt;time.strftime(&quot;%Y-%m-%d %H:%M:%S&quot;, t)'2019-09-15 00:24:23'# strptime(str, tpl)# stræ˜¯å­—ç¬¦ä¸²å½¢å¼çš„æ—¶é—´å€¼# tplæ˜¯æ ¼å¼åŒ–æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œç”¨æ¥å®šä¹‰è¾“å…¥æ•ˆæœ&gt;&gt;&gt;timeStr = '2018-01-26 12:55:20'&gt;&gt;&gt;time.strptime(timeStr, &quot;%Y-%m-%d %H:%M:%S&quot;)time.struct_time(tm_year=2019, tm_mon=9, tm_mday=15, tm_hour=0, tm_min=25, tm_sec=50, tm_wday=6, tm_yday=258, tm_isdst=-1)# ç»“æ„åŒ–å¯¹è±¡è½¬æ—¶é—´æˆ³&gt;&gt;&gt;time.mktime(time.localtime())1668562455.0# æ—¶é—´æˆ³è½¬ç»“æ„åŒ–å¯¹è±¡&gt;&gt;&gt;time.localtime(time.time())time.struct_time(tm_year=2022, tm_mon=11, tm_mday=16, tm_hour=9, tm_min=37, tm_sec=9, tm_wday=2, tm_yday=320, tm_isdst=0)å¸¸ç”¨æ ¼å¼(å¹´æœˆæ—¥ã€æ—¶åˆ†ç§’)| æ ¼å¼åŒ–å­—ç¬¦ä¸² | æ—¥æœŸ/æ—¶é—´è¯´æ˜  | å€¼èŒƒå›´å’Œå®ä¾‹                   || â€”â€”â€”â€”â€”â€” | â€”â€”â€”â€”â€”â€”â€” | â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” || %Y           | å¹´ä»½           | 0000~9999ï¼Œä¾‹å¦‚ï¼š1900          || %y           | å»æ‰ä¸–çºªçš„å¹´ä»½ | 00~99                          || %m           | æœˆä»½           | 01~12ï¼Œä¾‹å¦‚ï¼š10                || %B           | æœˆä»½åç§°       | January~Decemberï¼Œä¾‹å¦‚ï¼šApril  || %b           | æœˆä»½åç§°ç¼©å†™   | Jan~Decï¼Œä¾‹å¦‚ï¼šApr             || %H           | å°æ—¶ï¼ˆ24håˆ¶ï¼‰  | 00~23ï¼Œä¾‹å¦‚ï¼š12                || %h           | å°æ—¶ï¼ˆ12håˆ¶ï¼‰  | 01~12ï¼Œä¾‹å¦‚ï¼š7                 || %M           | åˆ†é’Ÿ           | 00~59ï¼Œä¾‹å¦‚ï¼š26                || %S           | ç§’             | 00~59ï¼Œä¾‹å¦‚ï¼š26                |å…¶ä»–æ ¼å¼| æ ¼å¼åŒ–å­—ç¬¦ä¸² | æ—¥æœŸ/æ—¶é—´è¯´æ˜        | å€¼èŒƒå›´å’Œå®ä¾‹                   || â€”â€”â€”â€”â€”â€” | â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” | â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” || %w           | æ˜ŸæœŸä¸­çš„ç¬¬å‡ å¤©       | 0~6ï¼Œ0å¯¹åº”æ˜ŸæœŸå¤©               || %d           | æ—¥æœŸï¼Œä¸€æœˆä¸­çš„ç¬¬å‡ å¤© | 01~31ï¼Œä¾‹å¦‚ï¼š25                || %j           | ä¸€å¹´ä¸­çš„ç¬¬å‡ å¤©       | 001~366                        || %A           | æ˜ŸæœŸ                 | Monday~Sundayï¼Œä¾‹å¦‚ï¼šWednesday || %a           | æ˜ŸæœŸç¼©å†™             | Mon~Sunï¼Œä¾‹å¦‚ï¼šWed             || %p           | ä¸Š/ä¸‹åˆ              | AM, PMï¼Œä¾‹å¦‚ï¼šPM               || %Z           | æ—¶åŒºçš„åå­—           |                                |å°†æ—¶é—´ä»¥åˆç†çš„æ–¹å¼å±•ç¤ºå‡ºæ¥æ ¼å¼åŒ–ï¼šç±»ä¼¼å­—ç¬¦ä¸²æ ¼å¼åŒ–ï¼Œéœ€è¦æœ‰å±•ç¤ºæ¨¡æ¿å±•ç¤ºæ¨¡æ¿ç”±ç‰¹å®šçš„æ ¼å¼åŒ–æ§åˆ¶ç¬¦ç»„æˆstrftime()æ–¹æ³•ç¨‹åºè®¡æ—¶: æµ‹é‡èµ·æ­¢åŠ¨ä½œæ‰€ç»å†æ—¶é—´çš„è¿‡ç¨‹æµ‹é‡æ—¶é—´ï¼šperf_counter()äº§ç”Ÿæ—¶é—´ï¼šsleep()1234567891011# è¿”å›ä¸€ä¸ªCPUçº§åˆ«çš„ç²¾ç¡®æ—¶é—´è®¡æ•°å€¼ï¼Œå•ä½ä¸ºç§’# ç”±äºè¿™ä¸ªè®¡æ•°å€¼èµ·ç‚¹ä¸ç¡®å®šï¼Œè¿ç»­è°ƒç”¨å·®å€¼æ‰æœ‰æ„ä¹‰&gt;&gt;&gt;start = time.perf_counter()318.66599499718114&gt;&gt;&gt;end = time.perf_counter()341.3905185375658&gt;&gt;&gt;end - start22.724523540384666# sæ‹Ÿä¼‘çœ çš„æ—¶é—´ï¼Œå•ä½æ˜¯ç§’ï¼Œå¯ä»¥æ˜¯æµ®ç‚¹æ•°time.sleep(5)datetime æ¨¡å—python å¤„ç†æ—¥æœŸå’Œæ—¶é—´çš„æ ‡å‡†åº“ï¼Œå¸¸ç”¨ datetime ç±»ï¼ŒåŠ date ç±» å’Œ time ç±»ï¼Œå¯åšè®¡ç®—ä¹‹ç±»çš„æ“ä½œtimeæ¨¡å—æ¯”è¾ƒåº•å±‚ï¼Œèƒ½å®Œæˆçš„åŠŸèƒ½ç›¸å¯¹æœ‰é™ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦æ›´é«˜çº§çš„datetimeæ¨¡å—æ¥å‚ä¸äº†å¯ä»¥ç®€å•ç†è§£ä¸ºï¼Œdatetimeæ¨¡å—æ˜¯å¯¹timeæ¨¡å—è¿›è¡Œäº†æ›´é«˜ä¸€å±‚çš„å°è£…åŸºæœ¬å®šä¹‰å’Œå±æ€§æ–¹æ³•12345678910111213141516171819202122232425262728293031323334import datetimeimport sysfrom typing import Tuplefrom dateutil import relativedeltafrom dateutil.parser import parsedef fn_basic() -&gt; Tuple:    &quot;&quot;&quot; åŸºæœ¬å®šä¹‰å’Œå±æ€§æ–¹æ³• &quot;&quot;&quot;    # è·å–å½“å‰æ—¥æœŸæ—¶é—´    d_now = datetime.datetime.now()  # ç­‰ä»·äºdatetime.datetime.today()    d_utc_now = datetime.datetime.utcnow()  # è·å–utcå¯¹è±¡, åŒ—äº¬æ—¶é—´+8h=d_utc_now    # è‡³å°‘è¦ç»™å®šå¹´æœˆæ—¥    d_free = datetime.datetime(year=2022, month=11, day=11)    print(&quot;d_now &quot;, d_now)    print(f&quot;d_nowçš„è¯¦ç»†ä¿¡æ¯: year:{d_now.year} month:{d_now.month} day:{d_now.day}&quot;)    print(f&quot;d_nowçš„è¯¦ç»†ä¿¡æ¯: hour:{d_now.hour} minute:{d_now.minute} second:{d_now.second} microsecond:{d_now.microsecond}&quot;)    print(&quot;d_free&quot;, d_free)    # å¸¸ç”¨å±æ€§    d = d_free.date()  # è·å–æ—¥æœŸå¯¹è±¡    t = d_free.time()  # è·å–æ—¶é—´å¯¹è±¡    dt = datetime.datetime.combine(date=d, time=t)  # æ ¹æ®dateå’Œtime, åˆ›å»ºä¸€ä¸ªdatetimeå¯¹è±¡    ts = d_free.timestamp()  # è·å–å¯¹è±¡çš„æ—¶é—´æˆ³    print(&quot;ts    &quot;, ts)    print(sys._getframe().f_code.co_name, &quot;=&quot; * 60, '\n')    return d_now, d_free# è¾“å‡ºd_now  2022-11-15 16:59:45.447093d_nowçš„è¯¦ç»†ä¿¡æ¯: year:2022 month:11 day:15d_nowçš„è¯¦ç»†ä¿¡æ¯: hour:16 minute:59 second:45 microsecond:447093d_free 2022-11-11 00:00:00ts     1668096000.0fn_basic ============================================================ æ—¥æœŸæ—¶é—´å·®å¼‚12345678910111213141516171819def fn_dif(d_now, d_free):    &quot;&quot;&quot; æ—¥æœŸæ—¶é—´å·®å¼‚ &quot;&quot;&quot;    # type(dif) == timedelta    dif = d_now - d_free    print(&quot;d_free+dif==d_now is&quot;, d_free + dif == d_now)    # ä¸‹ä¸ªæœˆ å‰ä¸€å¤© å¾€å9å°æ—¶ å†å¾€å‰10åˆ†é’Ÿ    d_dif = d_free + relativedelta.relativedelta(months=1, days=-1, hours=9, minutes=-10)    print(&quot;d_dif &quot;, d_dif)    # æŒ‡å®šæ—¶é—´ï¼Œåªèƒ½æ˜¯æ•´æ•°    d_dif_abs = d_free + relativedelta.relativedelta(month=1, day=5, hour=9, minute=10)    print(&quot;d_dif_abs &quot;, d_dif_abs)    print(sys._getframe().f_code.co_name, &quot;=&quot; * 60, '\n')   # è¾“å‡ºd_free+dif==d_now is Trued_dif  2022-12-10 08:50:00d_dif_abs  2022-01-05 09:10:00fn_dif ============================================================ æ—¥æœŸæ—¶é—´çš„æ ¼å¼åŒ–1234567891011121314151617181920212223242526272829303132def fn_format_transform():    &quot;&quot;&quot; æ—¥æœŸæ—¶é—´çš„æ ¼å¼åŒ– &quot;&quot;&quot;    date_format_str = &quot;%Y-%m-%d %H:%M:%S&quot;    date_format_str_2 = &quot;{:%Y-%m-%d %H:%M:%S}&quot;    # è·å–å½“å‰æ—¥æœŸæ—¶é—´    d_now = datetime.datetime.now()    # å¯¹è±¡è½¬å­—ç¬¦ä¸²    date_string = d_now.strftime(date_format_str)    print(&quot;date_string:&quot;, date_string)    date_string_2 = date_format_str_2.format(d_now)    print(&quot;date_string_2:&quot;, date_string_2)    # å­—ç¬¦ä¸²è½¬å¯¹è±¡    d_from_str = datetime.datetime.strptime(date_string, date_format_str)    print(&quot;d_from_str:&quot;, d_from_str)    # dateutil.parse å¯ä»¥è§£æå‡ ä¹æ‰€æœ‰äººç±»èƒ½å¤Ÿç†è§£çš„æ—¥æœŸè¡¨ç¤ºå½¢å¼    d_parse = parse(date_string)    print(&quot;parse:&quot;, d_parse)    print(&quot;parse('Jan 31, 2021 10:45 PM'): &quot;, parse('Jan 31, 2022 10:45 PM'))    print(&quot;parse(str(d_now)): &quot;, parse(str(d_now)))    print(sys._getframe().f_code.co_name, &quot;=&quot; * 60, '\n')   # è¾“å‡ºdate_string: 2022-11-15 16:59:45date_string_2: 2022-11-15 16:59:45d_from_str: 2022-11-15 16:59:45parse: 2022-11-15 16:59:45parse('Jan 31, 2021 10:45 PM'):  2022-01-31 22:45:00parse(str(d_now)):  2022-11-15 16:59:45.447093fn_format ============================================================ äº§ç”ŸæŒ‡å®šèŒƒå›´å†…çš„æ—¥æœŸæ—¶é—´123456789101112131415161718192021222324252627def gen_date_times():    &quot;&quot;&quot; äº§ç”ŸæŒ‡å®šèŒƒå›´å†…çš„æ—¥æœŸæ—¶é—´ &quot;&quot;&quot;    def date_time(p_start_time, p_end_time, p_format: str = '%Y-%m-%d'):        while p_start_time &lt; p_end_time:            select_time = p_start_time.strftime(p_format)            print(select_time)            p_start_time += datetime.timedelta(days=1)    # è·å–å½“å¤©æ—¶é—´    format_ = '%Y-%m-%d'    end_time = datetime.datetime.now()    start_time = end_time + relativedelta.relativedelta(days=-10)    date_time(p_start_time=start_time, p_end_time=end_time, p_format=format_)# è¾“å‡º2022-11-052022-11-062022-11-072022-11-082022-11-092022-11-102022-11-112022-11-122022-11-132022-11-142022-11-15calendaråº“çš„ä½¿ç”¨æä¾›ä¸æ—¥å†ç›¸å…³åŠŸèƒ½ï¼Œå¦‚ï¼šä¸ºç»™å®šçš„æœˆä»½æˆ–å¹´ä»½ï¼Œæ‰“å°æ–‡æœ¬æ—¥å†12345678910111213import calendarc = calendar.month(2019, 9)print(c)   September 2019Mo Tu We Th Fr Sa Su                   1 2  3  4  5  6  7  8 9 10 11 12 13 14 1516 17 18 19 20 21 2223 24 25 26 27 28 2930randomåº“çš„ä½¿ç”¨randomåº“æ˜¯ä½¿ç”¨éšæœºæ•°çš„Pythonæ ‡å‡†åº“ä¼ªéšæœºæ•°: é‡‡ç”¨æ¢…æ£®æ—‹è½¬ç®—æ³•ç”Ÿæˆçš„(ä¼ª)éšæœºåºåˆ—ä¸­å…ƒç´ randomåº“ä¸»è¦ç”¨äºç”Ÿæˆéšæœºæ•°ä½¿ç”¨randomåº“: import randomä¸»è¦æ–¹æ³•åŸºæœ¬éšæœºæ•°å‡½æ•°ï¼š seed(), random()æ‰©å±•éšæœºæ•°å‡½æ•°ï¼š randint(), getrandbits(), uniform(), randrange(), choice(), shuffle()åŸºæœ¬éšæœºæ•°å‡½æ•°123456789101112131415161718192021222324# åˆå§‹åŒ–ç»™å®šçš„éšæœºæ•°ç§å­ï¼Œé»˜è®¤ä¸ºå½“å‰ç³»ç»Ÿæ—¶é—´&gt;&gt;&gt;random.seed(10) #äº§ç”Ÿç§å­10å¯¹åº”çš„åºåˆ—# ç”Ÿæˆä¸€ä¸ª[0.0, 1.0)ä¹‹é—´çš„éšæœºå°æ•°&gt;&gt;&gt;random.random()0.5714025946899135# è¿”å›æ•è·å½“å‰ç”Ÿæˆå™¨å†…éƒ¨çŠ¶æ€çš„å¯¹è±¡.è¯¥å¯¹è±¡å¯ä»¥ç”¨äºå‡½æ•°setstate()å–ä¿å­˜å½“å‰çš„çŠ¶æ€.&gt;&gt;&gt; state = random.getstate()&gt;&gt;&gt; random.setstate(state)# ä»¥ç›¸åŒé¡ºåºæ‰“ä¹±å¤šä¸ªæ•°ç»„# ç­‰ä»·äº  np.random.get_state()    np.random.shuffle(a)   np.random.set_state(state)a = np.arange(10)b=['A','B','C','D','E','F','G','H','I','J']state=random.getstate()random.shuffle(a)print(a)random.setstate(state)random.shuffle(b)print(b)[9 4 5 0 1 2 6 8 7 3]['J', 'E', 'F', 'A', 'B', 'C', 'G', 'I', 'H', 'D']æ‰©å±•éšæœºæ•°å‡½æ•°12345678910111213141516171819202122232425# ç”Ÿæˆä¸€ä¸ª[a, b]ä¹‹é—´çš„æ•´æ•°&gt;&gt;&gt;random.randint(10, 100)64# ç”Ÿæˆä¸€ä¸ª[m, n)ä¹‹é—´ä»¥kä¸ºæ­¥é•¿çš„éšæœºæ•´æ•°&gt;&gt;&gt;random.randrange(10, 100, 10)80     # ç”Ÿæˆä¸€ä¸ªkæ¯”ç‰¹é•¿çš„éšæœºæ•´æ•°&gt;&gt;&gt;random.getrandbits(16)37885# ç”Ÿæˆä¸€ä¸ª[a, b]ä¹‹é—´çš„éšæœºå°æ•°&gt;&gt;&gt;random.uniform(10, 100)13.096321648808136# ä»åºåˆ—seqä¸­éšæœºé€‰æ‹©ä¸€ä¸ªå…ƒç´ &gt;&gt;&gt;random.choice([1,2,3,4,5,6,7,8,9])8# å°†åºåˆ—seqä¸­å…ƒç´ éšæœºæ’åˆ—ï¼Œè¿”å›æ‰“ä¹±åçš„åºåˆ—&gt;&gt;&gt; s=[1,2,3,4,5,6,7,8,9];&gt;&gt;&gt; random.shuffle(s);&gt;&gt;&gt; print(s)[3, 5, 8, 9, 6, 1, 2, 7, 4]å‡½æ•°æè¿°randint(a, b)ç”Ÿæˆä¸€ä¸ª[a, b]ä¹‹é—´çš„æ•´æ•°randrange(m, n[, k])ç”Ÿæˆä¸€ä¸ª[m, n)ä¹‹é—´ä»¥kä¸ºæ­¥é•¿çš„éšæœºæ•´æ•°getrandbits(k)ç”Ÿæˆä¸€ä¸ªkæ¯”ç‰¹é•¿çš„éšæœºæ•´æ•°uniform(a, b)ç”Ÿæˆä¸€ä¸ª[a, b]ä¹‹é—´çš„éšæœºå°æ•°choice(seq)ä»åºåˆ—seqä¸­éšæœºé€‰æ‹©ä¸€ä¸ªå…ƒç´ shuffle(seq)å°†åºåˆ—seqä¸­å…ƒç´ éšæœºæ’åˆ—ï¼Œè¿”å›æ‰“ä¹±åçš„åºåˆ—å‘½ä»¤è¡Œè„šæœ¬ä¼ å‚å‘½ä»¤è¡Œè¿è¡ŒPythonè„šæœ¬æ—¶ä¼ å…¥å‚æ•°çš„ä¸‰ç§æ–¹å¼å¦‚æœåœ¨è¿è¡Œpythonè„šæœ¬æ—¶éœ€è¦ä¼ å…¥ä¸€äº›å‚æ•°ï¼Œä¾‹å¦‚gpusä¸batch_sizeï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä¸‰ç§æ–¹å¼ã€‚123python script.py 0,1,2 10python script.py --gpus=0,1,2 --batch-size=10python script.py --gpus=0,1,2 --batch_size=10è¿™ä¸‰ç§æ ¼å¼å¯¹åº”ä¸åŒçš„å‚æ•°è§£ææ–¹å¼ï¼Œåˆ†åˆ«ä¸ºsys.argv, argparse, tf.app.runå‰ä¸¤è€…æ˜¯pythonè‡ªå¸¦çš„åŠŸèƒ½ï¼Œåè€…æ˜¯tensorflowæä¾›çš„ä¾¿æ·æ–¹å¼ã€‚sys.argvsysæ¨¡å—æ˜¯å¾ˆå¸¸ç”¨çš„æ¨¡å—ï¼Œ å®ƒå°è£…äº†ä¸pythonè§£é‡Šå™¨ç›¸å…³çš„æ•°æ®ï¼Œä¾‹å¦‚sys.modulesé‡Œé¢æœ‰å·²ç»åŠ è½½äº†çš„æ‰€æœ‰æ¨¡å—ä¿¡æ¯ï¼Œsys.pathé‡Œé¢æ˜¯PYTHONPATHçš„å†…å®¹ï¼Œè€Œsys.argvåˆ™å°è£…äº†ä¼ å…¥çš„å‚æ•°æ•°æ®ä½¿ç”¨sys.argvæ¥æ”¶ä¸Šé¢ç¬¬ä¸€ä¸ªå‘½ä»¤ä¸­åŒ…å«çš„å‚æ•°æ–¹å¼å¦‚ä¸‹ï¼š123456import sysgpus = sys.argv[1]# gpus = [int(gpus.split(','))]batch_size = sys.argv[2]print gpusprint batch_sizeargparseå®˜æ–¹æ–‡æ¡£ä½¿ç”¨argparseä»å‘½ä»¤è¡Œæ¥æ”¶boolç±»å‹çš„å‚æ•°Python argparseåº“ç”¨æ³•æ€»ç»“é€Ÿè§ˆ1234567891011121314import argparse# åˆ›å»ºä¸€ä¸ªè§£æå¯¹è±¡parser = argparse.ArgumentParser(prog='æˆ‘çš„è§£æå¯¹è±¡')# æ·»åŠ ä½ è¦å…³æ³¨çš„å‘½ä»¤è¡Œå‚æ•°å’Œé€‰é¡¹parser.add_argument('--doc_path', '-dp')parser.add_argument('-tip', '--tp')# è§£æå‚æ•°opt = parser.parse_args()# å¸¦--çš„å‚æ•°å¯ä»¥ç›´æ¥ç”¨åå­—è®¿é—®print(opt.tp, opt.doc_path)å¯ä»¥ç”¨python arg.py -hè·å–å¸®åŠ©ArgumentParser1class argparse.ArgumentParser(prog=None, usage=None, description=None, epilog=None, parents=[], formatter_class=argparse.HelpFormatter, prefix_chars='-', fromfile_prefix_chars=None, argument_default=None, conflict_handler='error', add_help=True, allow_abbrev=True, exit_on_error=True)åˆ›å»ºä¸€ä¸ªæ–°çš„ArgumentParserå¯¹è±¡ï¼Œæ‰€æœ‰çš„å‚æ•°éƒ½åº”å½“ä½œä¸ºå…³é”®å­—å‚æ•°ä¼ å…¥ï¼Œæ¯ä¸ªå‚æ•°åœ¨ä¸‹é¢éƒ½æœ‰å®ƒæ›´è¯¦ç»†çš„æè¿°prog - ç¨‹åºçš„åç§° (é»˜è®¤å€¼: os.path.basename(sys.argv[0]))usage - æè¿°ç¨‹åºç”¨é€”çš„å­—ç¬¦ä¸²ï¼ˆé»˜è®¤å€¼ï¼šä»æ·»åŠ åˆ°è§£æå™¨çš„å‚æ•°ç”Ÿæˆï¼‰description - åœ¨å‚æ•°å¸®åŠ©æ–‡æ¡£ä¹‹åæ˜¾ç¤ºçš„æ–‡æœ¬ (é»˜è®¤å€¼:æ— )epilog - Text to display after the argument help (by default, no text)parents - ä¸€ä¸ª ArgumentParser å¯¹è±¡çš„åˆ—è¡¨ï¼Œå®ƒä»¬çš„å‚æ•°ä¹Ÿåº”åŒ…å«åœ¨å†…formatter_class - ç”¨äºè‡ªå®šä¹‰å¸®åŠ©æ–‡æ¡£è¾“å‡ºæ ¼å¼çš„ç±»argparse.RawDescriptionHelpFormatterï¼šè¡¨ç¤º description å’Œ epilog å·²ç»è¢«æ­£ç¡®çš„æ ¼å¼åŒ–argparse.RawTextHelpFormatterï¼šä¿ç•™æ‰€æœ‰ç§ç±»æ–‡å­—çš„ç©ºæ ¼ï¼ŒåŒ…æ‹¬å‚æ•°çš„æè¿°argparse.ArgumentDefaultsHelpFormatterï¼šè‡ªåŠ¨æ·»åŠ é»˜è®¤çš„å€¼çš„ä¿¡æ¯åˆ°æ¯ä¸€ä¸ªå¸®åŠ©ä¿¡æ¯çš„å‚æ•°ä¸­:argparse.MetavarTypeHelpFormatterï¼šæ¯ä¸€ä¸ªå‚æ•°ä¸­ä½¿ç”¨ type çš„å‚æ•°åå½“ä½œå®ƒçš„æ˜¾ç¤ºåprefix_chars - å¯é€‰å‚æ•°çš„å‰ç¼€å­—ç¬¦é›†åˆï¼ˆé»˜è®¤å€¼ï¼š â€˜-â€˜ï¼‰ï¼Œè®¸å¤šå‘½ä»¤è¡Œä¼šä½¿ç”¨ - å½“ä½œå‰ç¼€ï¼Œæ¯”å¦‚ -f/--fooã€‚å¦‚æœè§£æå™¨éœ€è¦æ”¯æŒä¸åŒçš„æˆ–è€…é¢å¤–çš„å­—ç¬¦ï¼Œæ¯”å¦‚åƒ +f æˆ–è€… /foo çš„é€‰é¡¹ï¼Œå¯ä»¥åœ¨å‚æ•°è§£ææ„å»ºå™¨ä¸­ä½¿ç”¨ prefix_chars= å‚æ•°fromfile_prefix_chars - å½“éœ€è¦ä»æ–‡ä»¶ä¸­è¯»å–å…¶ä»–å‚æ•°æ—¶ï¼Œç”¨äºæ ‡è¯†æ–‡ä»¶åçš„å‰ç¼€å­—ç¬¦é›†åˆï¼ˆé»˜è®¤å€¼ï¼š Noneï¼‰argument_default - å‚æ•°çš„å…¨å±€é»˜è®¤å€¼ï¼ˆé»˜è®¤å€¼ï¼š Noneï¼‰conflict_handler - è§£å†³å†²çªé€‰é¡¹çš„ç­–ç•¥ï¼ˆé€šå¸¸æ˜¯ä¸å¿…è¦çš„ï¼‰add_help - ä¸ºè§£æå™¨æ·»åŠ ä¸€ä¸ª -h/--help é€‰é¡¹ï¼ˆé»˜è®¤å€¼ï¼š Trueï¼‰ï¼Œæœ‰æ—¶å€™å¯èƒ½ä¼šéœ€è¦å…³é—­é¢å¤–çš„å¸®åŠ©ä¿¡æ¯allow_abbrev - å¦‚æœç¼©å†™æ˜¯æ— æ­§ä¹‰çš„ï¼Œåˆ™å…è®¸ç¼©å†™é•¿é€‰é¡¹ ï¼ˆé»˜è®¤å€¼ï¼šTrueï¼‰exit_on_error - æ­£å¸¸æƒ…å†µä¸‹ï¼Œå½“ä½ å‘ ArgumentParser çš„ parse_args() æ–¹æ³•ä¼ å…¥ä¸€ä¸ªæ— æ•ˆçš„å‚æ•°åˆ—è¡¨æ—¶ï¼Œå®ƒå°†ä¼šé€€å‡ºå¹¶å‘å‡ºé”™è¯¯ä¿¡æ¯ã€‚å¦‚æœç”¨æˆ·æƒ³è¦æ‰‹åŠ¨æ•è·é”™è¯¯ï¼Œå¯é€šè¿‡å°† exit_on_error è®¾ä¸º False æ¥å¯ç”¨è¯¥ç‰¹æ€§12345678910111213141516171819202122232425262728293031323334353637383940414243import argparse# å®ä¾‹åŒ–parser = argparse.ArgumentParser(prog=&quot;hyc_prog&quot;, usage='%(prog)s [options]',                                 description='[%(prog)s] å‚æ•°è§£ææè¿°ï¼Œç”¨äºæ¼”ç¤º',                                 epilog=&quot;description å‚æ•°åæ˜¾ç¤ºé¢å¤–çš„å¯¹ç¨‹åºçš„æè¿°&quot;,                                 # è¡¨ç¤º description å’Œ epilog å·²ç»è¢«æ­£ç¡®çš„æ ¼å¼åŒ–äº†                                 formatter_class=argparse.RawDescriptionHelpFormatter,                                 prefix_chars='-+',  # è§£æå™¨éœ€è¦æ”¯æŒä¸åŒçš„æˆ–è€…é¢å¤–çš„å­—ç¬¦                                 argument_default=argparse.SUPPRESS, # å…¨å±€ç¦æ­¢åœ¨ parse_args() ä¸­åˆ›å»ºå±æ€§                                 )# fromfile_prefix_charså‚æ•°with open('args.txt', 'w', encoding=sys.getfilesystemencoding()) as fp:    fp.write('-f\nbar')parser = argparse.ArgumentParser(fromfile_prefix_chars='@')parser.add_argument('-f')parser.parse_args(['-f', 'foo', '@args.txt'])# conflict_handlerå‚æ•°parser = argparse.ArgumentParser(prog='PROG', conflict_handler='resolve')parser.add_argument('-f', '--foo', help='old foo help')parser.add_argument('--foo', help='new foo help')parser.print_help()&gt;&gt;&gt; usage: PROG [-h] [-f FOO] [--foo FOO]options: -h, --help  show this help message and exit -f FOO      old foo help --foo FOO   new foo help# exit_on_errorå‚æ•°parser = argparse.ArgumentParser(exit_on_error=False)parser.add_argument('--integers', type=int)try:    parser.parse_args('--integers a'.split())except argparse.ArgumentError:    print('Catching an argumentError')add_argument1ArgumentParser.add_argument(name or flags...[, action][, nargs][, const][, default][, type][, choices][, required][, help][, metavar][, dest])å®šä¹‰å•ä¸ªçš„å‘½ä»¤è¡Œå‚æ•°åº”å½“å¦‚ä½•è§£æï¼Œæ¯ä¸ªå½¢å‚éƒ½åœ¨ä¸‹é¢æœ‰å®ƒè‡ªå·±æ›´å¤šçš„æè¿°ï¼Œé•¿è¯çŸ­è¯´æœ‰ï¼šname or flags - ä¸€ä¸ªå‘½åæˆ–è€…ä¸€ä¸ªé€‰é¡¹å­—ç¬¦ä¸²çš„åˆ—è¡¨ï¼Œä¾‹å¦‚ foo æˆ– -f, â€”fooaction - å½“å‚æ•°åœ¨å‘½ä»¤è¡Œä¸­å‡ºç°æ—¶ä½¿ç”¨çš„åŠ¨ä½œåŸºæœ¬ç±»å‹nargs - å‘½ä»¤è¡Œå‚æ•°åº”å½“æ¶ˆè€—çš„æ•°ç›®const - è¢«ä¸€äº› action å’Œ nargs é€‰æ‹©æ‰€éœ€æ±‚çš„å¸¸æ•°default - å½“å‚æ•°æœªåœ¨å‘½ä»¤è¡Œä¸­å‡ºç°å¹¶ä¸”ä¹Ÿä¸å­˜åœ¨äºå‘½åç©ºé—´å¯¹è±¡æ—¶æ‰€äº§ç”Ÿçš„å€¼type - å‘½ä»¤è¡Œå‚æ•°åº”å½“è¢«è½¬æ¢æˆçš„ç±»å‹choices - A sequence of the allowable values for the argument.required - æ­¤å‘½ä»¤è¡Œé€‰é¡¹æ˜¯å¦å¯çœç•¥(ä»…é€‰é¡¹å¯ç”¨)ï¼Œåªèƒ½ç”¨äºå¯é€‰å‚æ•°(optional arguments)help - ä¸€ä¸ªæ­¤é€‰é¡¹ä½œç”¨çš„ç®€å•æè¿°metavar - åœ¨ä½¿ç”¨æ–¹æ³•æ¶ˆæ¯ä¸­ä½¿ç”¨çš„å‚æ•°å€¼ç¤ºä¾‹dest - è¢«æ·»åŠ åˆ°parse_args()æ‰€è¿”å›å¯¹è±¡ä¸Šçš„å±æ€§åname or flagsnameå°±æ˜¯æŒ‡å‘½ä»¤è¡Œå‚æ•°ä¸­æ²¡æœ‰â€™-â€˜çš„å‚æ•°åå­—ä¾‹å¦‚â€™mynameâ€™ï¼Œè€Œflagså°±æ˜¯æŒ‡å‰é¢æœ‰â€™-â€˜çš„å‚æ•°åï¼Œä¾‹å¦‚â€™-aâ€™ã€â€™â€”ageâ€™å…¶ä¸­nameå¯¹åº”ä½ç½®å‚æ•°ï¼Œè€Œflagså¯¹åº”å¯é€‰å‚æ•°ï¼Œnameåœ¨å‘½ä»¤è¡Œå¿…é¡»è¾“å…¥ï¼Œå¹¶æŒ‰ç…§é¡ºåºå–‚ç»™ç¨‹åºå‘½ä»¤è¡Œä¼ å…¥å‚æ•°æ—¶ï¼Œå¯¹äºä½ç½®å‚æ•°æˆ‘ä»¬ç›´æ¥ç»™å‡ºå…¶å€¼ï¼Œå¯¹äºå¯é€‰å‚æ•°éœ€è¦ç»™å‡ºå…¶flagsã€‚argparseä¼šå…ˆå°†å¯é€‰å‚æ•°è¿›è¡Œè§£æï¼Œå¯¹äºå‰©ä½™æœªè§£æçš„å‚æ•°ï¼Œä¼ ç»™ä½ç½®å‚æ•°1234567891011import argparseparser = argparse.ArgumentParser(description='a test')parser.add_argument('--age','-a')parser.add_argument('myname')parser.add_argument('sex')# æ³¨æ„å‰ä¸¤ä¸ªå‚æ•°å¿…é¡»æ˜¯ mynameå’Œsexargs = parser.parse_args('tom boy --age 22'.split())print(args) # Namespace(age='22', sex='boy', myname='tom')å‘½ä»¤è¡Œä¼ å…¥å‚æ•°æ—¶ï¼Œå…ˆå†™ä½ç½®å‚æ•°ï¼Œå†å†™å¯é€‰å‚æ•°action: æŒ‡å®šäº†å‚æ•°æ˜¯å¦‚ä½•è¢«å¤„ç†çš„ï¼Œæ”¯æŒé¢æ“ä½œå¦‚ä¸‹storeï¼šè¿™ä¸ªåªæ˜¯ç®€å•çš„å­˜å‚¨è¿™ä¸ªå‚æ•°å€¼ï¼Œè¿™ä¹Ÿæ˜¯é»˜è®¤æ“ä½œstore_const: å­˜å‚¨constæŒ‡å®šçš„å€¼ï¼Œé…åˆconstå‚æ•°store_falseå’Œstore_true: åˆ†åˆ«å¯¹åº”å­˜å‚¨Falseå’ŒTrueå€¼ï¼Œå®ƒä»¬æ˜¯store_constçš„ç‰¹ä¾‹appendï¼šä¿å­˜ä¸ºåˆ—è¡¨æ ¼å¼ï¼Œå°†æ¯ä¸ªå‚æ•°çš„å€¼æ·»åŠ åˆ°è¿™ä¸ªåˆ—è¡¨123456789101112131415161718192021222324import argparse# action='store_const'  ä¼ å‚æ—¶åªè¦ä¼ å…¥å‚æ•°å,ä¼šé»˜è®¤é™„ä¸Šconst, å¦‚æœä¸ä¼ è¯¥å‚æ•°å, é»˜è®¤ä¸ºNoneparser=argparse.ArgumentParser()parser.add_argument('--foo',action='store_const',const=42)parser.parse_args('--foo'.split())Out[0]: Namespace(foo=42)parser.parse_args(''.split())Out[1]: Namespace(foo=None)# store_falseå’Œstore_true# ä»¥store_falseä¸ºä¾‹, å½“ä¼ å…¥å‚æ•°åæ—¶, å€¼ä¸ºFalse, ä¸ä¼ å‚æ•°åæ—¶å€¼ä¸ºTrueparser.add_argument('--bar', action='store_false')parser.parse_args(''.split())Out[2]: Namespace(bar=True, foo=None)parser.parse_args('--bar'.split())Out[3]: Namespace(bar=False, foo=None)# action='append'parser = argparse.ArgumentParser()parser.add_argument('--foo', action='append')parser.parse_args('--foo 1 --foo 2'.split())Out[5]: Namespace(foo=['1', '2'])nargs: nargsçš„æ„æ€å°±æ˜¯è¾“å…¥å‚æ•°çš„ä¸ªæ•°Nâ€”æŸæ­£æ•´æ•°: æŒ‡å®šå¥½åï¼Œä¸èƒ½è¾“å…¥å¤šäº†ï¼Œä¹Ÿä¸èƒ½è¾“å…¥å°‘äº†â€˜?â€™: è¿™æ—¶ä»£è¡¨parserä¼šè¯»å–0ä¸ªæˆ–1ä¸ªå‚æ•°ï¼Œå…·ä½“éµå¾ªä¸‹é¢çš„åŸåˆ™ï¼šå¦‚æœç»™å‡ºäº†1ä¸ªå‚æ•°ï¼Œç…§å¸¸è¯»å–è¿™ä¸ªå‚æ•°ä¿å­˜èµ·æ¥å¦‚æœåªç»™å‡ºäº†flagsï¼Œæ¯”å¦‚â€˜â€”ageâ€™åé¢æœªç»™å‡ºå…·ä½“å€¼ï¼Œåˆ™ä¿å­˜constå‚æ•°çš„å€¼ï¼ˆå¦‚æœconstæœªç»™å‡ºåˆ™ä¸ºNoneï¼‰å¦‚æœä»€ä¹ˆéƒ½æ²¡ç»™ï¼Œåˆ™ä¿å­˜defaultå‚æ•°çš„å€¼ï¼ˆå¦‚æœdefaultæœªç»™å‡ºåˆ™ä¸ºNoneï¼‰â€˜*â€˜:  ä¸ç¡®å®šå…·ä½“ä¸ªæ•°ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨nargs=*â€˜+â€™: è¦æ±‚å‚æ•°çš„ä¸ªæ•°å¿…é¡»å¤§äºå¦‚æœä¸ç»™flagsï¼Œparserä¼šç”¨defaultçš„å€¼ï¼›å¦‚æœåªç»™flagsï¼Œä¸ç»™å€¼ï¼Œæ­¤æ—¶ä¼šæŠ¥é”™è€Œå½“nargs=â€™*â€™æ—¶ï¼Œå°±ç®—åªç»™flagsä¸ç»™å€¼ï¼Œä¹Ÿä¸ä¼šæŠ¥é”™ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªç©ºåˆ—è¡¨å‚æ•°123456789101112131415import argparse# nargs=?parser = argparse.ArgumentParser(description='a test')parser.add_argument('name')parser.add_argument('--age','-a', nargs='?',const=16,default=18)args = parser.parse_args('tom -a 15'.split())print(args) # Namespace(age='15', name='tom')args = parser.parse_args('tom -a'.split())print(args) # Namespace(age=16, name='tom')args = parser.parse_args('tom'.split())print(args) # Namespace(age=18, name='tom')const: å¤šæ˜¯é…åˆå…¶å®ƒå‚æ•°å‡ºæ¼”çš„é…è§’actionå‚æ•°ä¸º â€˜store_constâ€™ æ—¶æˆ–æ˜¯ â€˜append_constâ€™ æ—¶nargså‚æ•°ä¸º â€˜?â€™ æ—¶defaultå½“å‘½ä»¤è¡Œå®Œå…¨æ²¡æœ‰æåˆ°æŸä¸ªå‚æ•°æ—¶ï¼Œdefaultå‚æ•°å°±ä¼šå‘æŒ¥ä½œç”¨ï¼Œdefaultçš„é»˜è®¤å€¼ä¸ºNonetypeè¿™ä¸ªç±»å‹å‚æ•°å¯ä»¥çº¦æŸè¾“å…¥å‚æ•°çš„ç±»å‹ï¼Œå½“ç±»å‹è½¬æ¢åˆæ³•æ—¶ï¼Œä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬è¿›è¡Œç±»å‹è½¬æ¢12345678910111213141516171819import argparsedef str2bool(v):    if v.lower() in ('yes', 'true', 't', 'y', '1'):        return True    elif v.lower() in ('no', 'false', 'f', 'n', '0'):        return False    else:        raise argparse.ArgumentTypeError('Unsupported value encountered.')# type=intparser = argparse.ArgumentParser(description='a test')parser.add_argument('name')parser.add_argument('--age','-a',type=int, default='17')args = parser.parse_args('tom'.split())print(args) # Namespace(age=17, name='tom')# è‡ªå®šä¹‰ç±»å‹parser.add_argument('--is_del_aft', type=str2bool, default=False)choicesè¿™ä¸ªé€‰é¡¹å‚æ•°å¯ä»¥ä½¿ç”¨åˆ—è¡¨çº¦æŸè¾“å…¥å‚æ•°çš„å–å€¼èŒƒå›´ã€‚å¦‚æœè¾“å…¥å‚æ•°ä¸åœ¨å€™é€‰å‚æ•°åˆ—è¡¨ä¸­ï¼Œç¨‹åºä¼šæŠ¥é”™1234567891011import argparseparser = argparse.ArgumentParser(description='a test')parser.add_argument('name',choices=['tom','Jim','Bob'])parser.add_argument('--age','-a',type=int, default='17')args = parser.parse_args('Jim'.split())print(args) # Namespace(age=17, name='Jim')args = parser.parse_args('Toy'.split())print(args) # test.py: error: argument name: invalid choice: 'Toy' (choose from 'tom', 'Jim', 'Bob')åœ¨å‚æ•°è·å–é˜¶æ®µï¼Œçº¦æŸå¥½ç”¨æˆ·è¾“å…¥çš„å‚æ•°èŒƒå›´ï¼Œå¯ä»¥é˜²æ­¢æ„æƒ³ä¸åˆ°çš„å‚æ•°å¸¦æ¥çš„æœªçŸ¥åæœmetavar: è¿™ä¸ªå‚æ•°çš„åŠŸèƒ½ä¹Ÿæ˜¯ä¸ªæ€§åŒ–æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯1234567891011121314151617181920212223242526import argparseparser = argparse.ArgumentParser(description='a test')parser.add_argument('name',metavar='haha')# åŠ metavarparser.add_argument('--age','-a',type=int, default='17',metavar='hahahaha')parser.parse_args('-h'.split())&gt;&gt;&gt; usage: pydevconsole.py [-h] [--age hahahaha] hahaa testpositional arguments:  hahaoptional arguments:  -h, --help            show this help message and exit  --age hahahaha, -a hahahaha# ä¸åŠ metavarparser.add_argument('--age','-a',type=int, default='17')&gt;&gt;&gt; usage: pydevconsole.py [-h] [--age AGE] hahaa testpositional arguments:  hahaoptional arguments:  -h, --help         show this help message and exit  --age AGE, -a AGEdestæ¯ä¸ªå‚æ•°å¾…parserå¤„ç†å®Œæ¯•åï¼Œéƒ½ä¼šä»¥â€˜å±æ€§å-å±æ€§â€™çš„å½¢å¼ä¿å­˜èµ·æ¥å¯¹äºä½ç½®å‚æ•°ï¼Œå±æ€§åå°±æ˜¯ä½ç½®å‚æ•°çš„nameå¯¹äºå¯é€‰å‚æ•°ï¼Œå±æ€§åæ˜¯å¯é€‰å‚æ•°å»æ‰â€˜â€”â€™åçš„é‚£éƒ¨åˆ†ï¼Œå¦‚æœæ²¡æœ‰â€˜â€”â€™ï¼Œåˆ™ä¸ºå»æ‰â€˜-â€™çš„é‚£éƒ¨åˆ†ä¸ºäº†ä½¿å¾—å±æ€§ååˆæ³•ï¼Œparserè¿˜ä¼šå°†å•è¯ä¸­é—´çš„çŸ­æ¨ªæ å˜ä¸ºä¸‹åˆ’çº¿ä½†å¦‚æœï¼Œä½ ä¸æƒ³ç”¨ä¸Šè¿°æ–¹æ³•è‡ªåŠ¨ç”Ÿæˆçš„å±æ€§åï¼Œä½ æƒ³è‡ªå·±æŒ‡å®šå±æ€§åï¼Œå°±å¯ä»¥è®¾å®šdestå‚æ•°æ¥æŒ‡å®šã€‚ï¼ˆåªèƒ½æŒ‡å®šå¯é€‰å‚æ•°çš„å±æ€§åï¼‰123456789101112131415161718import argparse# åˆ›å»º ArgumentParser å¯¹è±¡parser = argparse.ArgumentParser(description='An example of using argparse')# æ·»åŠ ä½ç½®å‚æ•°å’Œå¯é€‰å‚æ•°parser.add_argument('--input', dest='input_file', help='Input file path')parser.add_argument('--output', dest='output_file', help='Output file path')# è§£æå‘½ä»¤è¡Œå‚æ•°args = parser.parse_args('--input è¾“å…¥ --output è¾“å‡º'.split())# è®¿é—®è§£æåçš„å‚æ•°å€¼input_path = args.input_fileoutput_path = args.output_file# æ‰§è¡Œç›¸åº”æ“ä½œprint(f'Input file path: {input_path}')print(f'Output file path: {output_path}')&gt;&gt;&gt;Input file path: è¾“å…¥Output file path: è¾“å‡ºå¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœä¸æŒ‡å®šdestï¼Œå¹´é¾„çš„å±æ€§åæ˜¯ageã€‚è‹¥æ­¤æ—¶æŒ‡å®šäº†dest=â€™myageâ€™ï¼Œé‚£ä¹ˆå¹´é¾„çš„å±æ€§åå°±äººä¸ºè®¾å®šæˆäº†myageå®é™…ä¾‹å­è„šæœ¬è¿è¡Œå‘½ä»¤python script.py -gpus=0,1,2 --batch-size=10ä¸­çš„--batch-sizeä¼šè¢«è‡ªåŠ¨è§£ææˆbatch_sizeparser.add_argument æ–¹æ³•çš„typeå‚æ•°ç†è®ºä¸Šå¯ä»¥æ˜¯ä»»ä½•åˆæ³•çš„ç±»å‹ï¼Œä½†æœ‰äº›å‚æ•°ä¼ å…¥æ ¼å¼æ¯”è¾ƒéº»çƒ¦ä¾‹å¦‚listï¼Œæ‰€ä»¥ä¸€èˆ¬ä½¿ç”¨bool, int, str, floatè¿™äº›åŸºæœ¬ç±»å‹å°±è¡Œäº†ï¼Œæ›´å¤æ‚çš„éœ€æ±‚å¯ä»¥é€šè¿‡strä¼ å…¥ï¼Œç„¶åæ‰‹åŠ¨è§£æboolç±»å‹çš„è§£ææ¯”è¾ƒç‰¹æ®Šï¼Œä¼ å…¥ä»»ä½•å€¼éƒ½ä¼šè¢«è§£ææˆTrueï¼Œä¼ å…¥ç©ºå€¼æ—¶æ‰ä¸º`False123456789101112131415161718192021import argparsedef str2bool(v):    if v.lower() in ('yes', 'true', 't', 'y', '1'):        return True    elif v.lower() in ('no', 'false', 'f', 'n', '0'):        return False    else:        raise argparse.ArgumentTypeError('Unsupported value encountered.')    if __name__ == '__main__':    parser = argparse.ArgumentParser(description='manual to this script')    parser.add_argument('--zook_host', type=str, default='127.0.0.1:2181')    parser.add_argument('--num_of_task', type=int, default=10)    parser.add_argument('--is_del_aft', type=str2bool, default=False)    args = parser.parse_args()    many_tasks_schedule_performance(zook_host=args.zook_host,                                    num_of_task=args.num_of_task,                                    is_del_aft=args.is_del_aft)tf.app.runtensorflowä¹Ÿæä¾›äº†ä¸€ç§æ–¹ä¾¿çš„è§£ææ–¹å¼1234567891011121314151617181920import tensorflow as tftf.app.flags.DEFINE_string('gpus', None, 'gpus to use')tf.app.flags.DEFINE_integer('batch_size', 5, 'batch size')FLAGS = tf.app.flags.FLAGSdef main(_):    print    FLAGS.gpus    print    FLAGS.batch_sizeif __name__ == &quot;__main__&quot;:    tf.app.run()&gt;&gt;&gt; python script.py --gpus=0,1,2 --batch_size=10æœ‰å‡ ç‚¹éœ€è¦æ³¨æ„tensorflowåªæä¾›ä»¥ä¸‹å››ç§æ–¹æ³•ï¼štf.app.flags.DEFINE_string, tf.app.flags.DEFINE_integer, tf.app.flags.DEFINE_boolean,  tf.app.flags.DEFINE_floatåˆ†åˆ«å¯¹åº”str, int,bool,floatç±»å‹çš„å‚æ•°è¿™é‡Œå¯¹boolçš„è§£ææ¯”è¾ƒä¸¥æ ¼ï¼Œä¼ å…¥1ä¼šè¢«è§£ææˆTrueï¼Œå…¶ä½™ä»»ä½•å€¼éƒ½ä¼šè¢«è§£ææˆFalseè„šæœ¬ä¸­éœ€è¦å®šä¹‰ä¸€ä¸ªæ¥æ”¶ä¸€ä¸ªå‚æ•°çš„mainæ–¹æ³•ï¼šdef main(_):ï¼Œè¿™ä¸ªä¼ å…¥çš„å‚æ•°æ˜¯è„šæœ¬åï¼Œä¸€èˆ¬ç”¨ä¸åˆ°ï¼Œ æ‰€ä»¥ç”¨ä¸‹åˆ’çº¿æ¥æ”¶ã€‚ä»¥batch_sizeå‚æ•°ä¸ºä¾‹ï¼Œä¼ å…¥è¿™ä¸ªå‚æ•°æ—¶ä½¿ç”¨çš„åç§°ä¸º--batch_sizeï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸­åˆ’çº¿ä¸ä¼šåƒåœ¨argparse ä¸­ä¸€æ ·è¢«è§£ææˆä¸‹åˆ’çº¿ã€‚tf.app.run()ä¼šå¯»æ‰¾å¹¶æ‰§è¡Œå…¥å£è„šæœ¬çš„mainæ–¹æ³•ã€‚ä¹Ÿåªæœ‰åœ¨æ‰§è¡Œäº†tf.app.run()ä¹‹åæ‰èƒ½ä»FLAGSä¸­å–å‡ºå‚æ•°ã€‚ä»å®ƒçš„ç­¾åæ¥çœ‹ï¼Œå®ƒä¹Ÿæ˜¯å¯ä»¥è‡ªå·±æŒ‡å®šéœ€è¦æ‰§è¡Œçš„æ–¹æ³•çš„ï¼Œä¸ä¸€å®šéå¾—å«mainï¼š1run(main=None, argv=None)tf.app.flagsåªæ˜¯å¯¹argparsçš„ç®€å•å°è£…ã€‚ä»£ç è§https://github.com/tensorflow/tensorflow/blob/r1.2/tensorflow/python/platform/flags.pyä½è¿ç®—èƒŒæ™¯çŸ¥è¯†ğŸ…äºŒè¿›åˆ¶åœ¨Pythonä¸­å¯ä»¥é€šè¿‡ä»¥â€0bâ€æˆ–è€…â€-0bâ€å¼€å¤´çš„å­—ç¬¦ä¸²æ¥è¡¨ç¤ºäºŒè¿›åˆ¶123# è½¬äºŒè¿›åˆ¶print(bin(5))&gt;&gt;&gt; 0b101ğŸ¥¬åŸç ã€åç ã€è¡¥ç åŸç : å°†ä¸€ä¸ªæ•´æ•°è½¬æ¢æˆäºŒè¿›åˆ¶å½¢å¼ï¼Œå°±æ˜¯å…¶åŸç ã€‚ä¾‹å¦‚6çš„åŸç å°±æ˜¯0110ï¼›-18 çš„åŸç å°±æ˜¯1000 0000 0001 0010é€šä¿—çš„ç†è§£ï¼ŒåŸç å°±æ˜¯ä¸€ä¸ªæ•´æ•°æœ¬æ¥çš„äºŒè¿›åˆ¶å½¢å¼åç : å¯¹äºæ­£æ•°ï¼Œå®ƒçš„åç å°±æ˜¯å…¶åŸç (åŸç å’Œåç ç›¸åŒ)ï¼›è´Ÿæ•°çš„åç æ˜¯å°†åŸç ä¸­é™¤ç¬¦å·ä½ä»¥å¤–çš„æ‰€æœ‰ä½(æ•°å€¼ä½)å–åè¡¥ç : å¯¹äºæ­£æ•°ï¼Œå®ƒçš„è¡¥ç å°±æ˜¯å…¶åŸç (åŸç ã€åç ã€è¡¥ç éƒ½ç›¸åŒ)ï¼›è´Ÿæ•°çš„è¡¥ç æ˜¯å…¶åç åŠ 1ä½è¿ç®—ä¸: &amp; æŒ‰ä½ä¸æˆ–: | æŒ‰ä½æˆ–åï¼š~ æŒ‰ä½å–åå¼‚æˆ–: ^ æŒ‰ä½å¼‚æˆ–æŒ‰ä½å·¦ç§»: &lt;&lt; æŒ‰ä½å·¦ç§»ï¼Œå„äºŒè¿›ä½å…¨éƒ¨å·¦ç§»nä½ï¼Œé«˜ä½ä¸¢å¼ƒï¼Œä½ä½è¡¥0å·¦ç§»1ä½ç›¸å½“äº ä¹˜ä»¥2æŒ‰ä½å³ç§»: &gt;&gt; æŒ‰ä½å³ç§»ï¼Œæ‰€æœ‰äºŒè¿›åˆ¶ä½å‘å³ç§»åŠ¨nä½ï¼Œç§»å‡ºçš„ä½åˆ æ‰ï¼Œè¿›çš„ä½è¡¥ç¬¦å·ä½ï¼Œå³ç§»ä¸ä¼šæ”¹å˜ä¸€ä¸ªæ•°çš„ç¬¦å·å³ç§»1ä½ç›¸å½“äº é™¤ä»¥2åº”ç”¨åœºæ™¯åˆ¤æ–­å¥‡æ•°è¿˜æ˜¯å¶æ•°ä½¿ç”¨&amp;è¿ç®—ï¼Œä¸1è¿›è¡Œ&amp;ï¼Œå¦‚æœä¸º1ï¼Œé‚£ä¹ˆè¯¥æ•°ä¸ºå¥‡æ•°ï¼›å¦‚æœä¸º0ï¼Œé‚£ä¹ˆè¯¥æ•°æ˜¯å¶æ•°äº¤æ¢ä¸¤ä¸ªæ•°å€¼ç¬¬ä¸€è¡Œï¼Œa = a ^ bï¼Œå¾ˆå®¹æ˜“ç†è§£ç¬¬äºŒè¡Œï¼Œ b = b ^ a = b ^ a ^ bï¼Œç”±äº b ^ b = 0ï¼Œæ‰€ä»¥ b = a ^ 0ï¼Œå³ b = aç¬¬ä¸‰è¡Œï¼Œ a = a ^ b ,ç”±äºaåœ¨ç¬¬ä¸€æ­¥é‡æ–°èµ‹å€¼ï¼Œæ‰€ä»¥ï¼Œa =  a ^ b ^ a = bï¼Œå®Œæˆäº†æ•°å€¼äº¤æ¢123a ^= bb ^= aa ^= bå¯»æ‰¾æ•°æ®åˆ—è¡¨ä¸­çš„ç‹¬ä¸€æ— äºŒæœ‰ä¸€ä¸ªæ•°æ®åˆ—è¡¨ï¼ˆ2N+1ä¸ªæ•´æ•°ï¼‰ï¼Œåªæœ‰ä¸€ä¸ªæ•°å‡ºç°äº†1æ¬¡ï¼Œå…¶ä½™Nä¸ªæ•°éƒ½å‡ºç°äº†2æ¬¡ã€‚å¦‚ä½•æ‰¾åˆ°è¿™ä¸ªç‹¬ä¸€æ— äºŒçš„æ•°æ®12345from functools import reducelst = [1,5,6,4,2,6,4,2,1]reduce(lambda a,b : a^b, lst)&gt;&gt;&gt; è¾“å‡º5è®¡ç®—ä¸€ä¸ªæ•°å€¼çš„äºŒè¿›åˆ¶æ•°ä¸­æœ‰å¤šå°‘ä¸ª1123456def count_ones(x):    count = 0    while x:        count = count + 1        x = x &amp; (x-1) # ç­‰ä»·äº x = x &amp; (x-1)    return countåœ¨ä¸€å †æ•°å­—ä¸­æ‰¾å‡ºåªå‡ºç°ä¸€æ¬¡çš„ä¸¤ä¸ªæ•°å­—1234567891011121314151617# æŸ¥æ‰¾æ„æˆresçš„ä¸¤ä¸ªæ•°def split_res(res, lst):    tmp = 1    num_0, num_1 = 0, 0    while not tmp &amp; res:        tmp &lt;&lt;= 1    for i in lst:        if i &amp; tmp:            num_0 ^= i        else:            num_1 ^= i    return num_0, num_1from functools import reducelst = [1,5,6,4,2,6,4,2,1,7]res = reduce(lambda a,b : a^b, lst)num_0, num_1 = split_res(res, lst)è·¯å¾„Pythonè·¯å¾„æ“ä½œæ¨¡å—pathlibï¼Œçœ‹è¿™ç¯‡å°±å¤Ÿäº†ï¼pathlibå’Œoså¸¸ç”¨æ“ä½œå¯¹æ¯”é€šè¿‡å¸¸ç”¨è·¯å¾„æ“ä½œçš„å¯¹æ¯”ï¼Œå¯ä»¥æ›´æ·±åˆ»ç†è§£pathlibå’Œosçš„åŒºåˆ«ï¼Œä¾¿äºåœ¨å®é™…æ“ä½œä¸­åšå¯¹ç…§ï¼Œä¹Ÿä¾¿äºè¿›è¡Œä½¿ç”¨æ›¿ä»£ï¼Œè¯¦ç»†å¯¹æ¯”å¦‚ä¸‹ï¼špathlibæ“ä½œosåŠos.pathæ“ä½œåŠŸèƒ½æè¿°Path.resolve()os.path.abspath()è·å¾—ç»å¯¹è·¯å¾„Path.chmod()os.chmod()ä¿®æ”¹æ–‡ä»¶æƒé™å’Œæ—¶é—´æˆ³Path.mkdir()os.mkdir()åˆ›å»ºç›®å½•Path.rename()os.rename()æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹é‡å‘½åï¼Œå¦‚æœè·¯å¾„ä¸åŒï¼Œä¼šç§»åŠ¨å¹¶é‡æ–°å‘½åPath.replace()os.replace()æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹é‡å‘½åï¼Œå¦‚æœè·¯å¾„ä¸åŒï¼Œä¼šç§»åŠ¨å¹¶é‡æ–°å‘½åï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™ç ´åç°æœ‰ç›®æ ‡ã€‚Path.rmdir()os.rmdir()åˆ é™¤ç›®å½•Path.unlink()os.remove()åˆ é™¤ä¸€ä¸ªæ–‡ä»¶Path.unlink()os.unlink()åˆ é™¤ä¸€ä¸ªæ–‡ä»¶Path.cwd()os.getcwd()è·å¾—å½“å‰å·¥ä½œç›®å½•Path.exists()os.path.exists()åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ–‡ä»¶æˆ–ç›®å½•namePath.home()os.path.expanduser()è¿”å›ç”µè„‘çš„ç”¨æˆ·ç›®å½•Path.is_dir()os.path.isdir()æ£€éªŒç»™å‡ºçš„è·¯å¾„æ˜¯ä¸€ä¸ªæ–‡ä»¶Path.is_file()os.path.isfile()æ£€éªŒç»™å‡ºçš„è·¯å¾„æ˜¯ä¸€ä¸ªç›®å½•Path.is_symlink()os.path.islink()æ£€éªŒç»™å‡ºçš„è·¯å¾„æ˜¯ä¸€ä¸ªç¬¦å·é“¾æ¥Path.stat()os.stat()è·å¾—æ–‡ä»¶å±æ€§PurePath.is_absolute()os.path.isabs()åˆ¤æ–­æ˜¯å¦ä¸ºç»å¯¹è·¯å¾„PurePath.joinpath()os.path.join()è¿æ¥ç›®å½•ä¸æ–‡ä»¶åæˆ–ç›®å½•PurePath.nameos.path.basename()è¿”å›æ–‡ä»¶åPurePath.parentos.path.dirname()è¿”å›æ–‡ä»¶è·¯å¾„Path.samefile()os.path.samefile()åˆ¤æ–­ä¸¤ä¸ªè·¯å¾„æ˜¯å¦ç›¸åŒPurePath.suffixos.path.splitext()åˆ†ç¦»æ–‡ä»¶åå’Œæ‰©å±•åé…ç½®æ–‡ä»¶è§£è¯»pythoné…ç½®æ–‡ä»¶INI/TOML/YAML/ENVçš„åŒºåˆ«iniiniæ–‡ä»¶å¯èƒ½æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨çš„æœ€ç›´æ¥çš„é…ç½®æ–‡ä»¶ã€‚iniæ–‡ä»¶éå¸¸é€‚åˆè¾ƒå°çš„é¡¹ç›®ï¼Œä¸»è¦æ˜¯å› ä¸ºè¿™äº›æ–‡ä»¶ä»…æ”¯æŒ1çº§æ·±çš„å±‚æ¬¡ç»“æ„ï¼Œiniæ–‡ä»¶æœ¬è´¨ä¸Šæ˜¯å¹³é¢æ–‡ä»¶ï¼Œä½†å˜é‡å¯ä»¥å±äºç»„123456789101112131415161718[APP]ENVIRONMENT = developmentDEBUG = False[DATABASE]USERNAME: rootPASSWORD: p@ssw0rdHOST: 127.0.0.1PORT: 5432DB: my_database[LOGS]ERRORS: logs/errors.logINFO: data/info.log[FILES]STATIC_FOLDER: staticTEMPLATES_FOLDER: templatespythonè§£æiniæ–‡ä»¶ä»£ç å¦‚ä¸‹æ‰€ç¤º1234567891011121314151617import configparserconfig = configparser.ConfigParser()path = r'Q:\pyCharmWS\object_detection\test.ini'cfg = config.read(path)# å¤šç§æ–¹å¼è·å–å€¼config['DATABASE']['HOST']Out[6]: '127.0.0.1'config.get('DATABASE', 'HOST')Out[7]: '127.0.0.1' # è·å–æŒ‡å®šç±»å‹config.getboolean('APP', 'DEBUG')Out[8]: Falseconfig.get('APP', 'DEBUG')Out[9]: 'False'configparserè¿˜æœ‰è®¸å¤šå…¶ä»–ç±»å‹æ£€æŸ¥æ–¹æ³•ï¼Œä¾‹å¦‚getint()ï¼Œgetfloat()ç­‰ç­‰tomlTOMLæ–‡ä»¶ä¼¼ä¹ä¸iniæ–‡ä»¶å…±äº«æŸäº›è¯­æ³•ç›¸ä¼¼ä¹‹å¤„ï¼Œä½†æ”¯æŒæ›´å¹¿æ³›çš„æ•°æ®ç±»å‹ä»¥åŠå€¼æœ¬èº«ä¹‹é—´çš„å…³ç³»å¦‚è¡¨ä¸­æ‰€ç¤ºï¼ŒTOMLæ”¯æŒåµŒå¥—è¡¨çš„æ¦‚å¿µï¼Œè¯¥[environments]è¡¨åé¢å¸¦æœ‰å¤šä¸ªå­è¡¨ï¼Œé€šè¿‡ä½¿ç”¨ç‚¹ç¬¦å·ï¼Œæˆ‘ä»¬èƒ½å¤Ÿåˆ›å»ºè¡¨çš„å…³è”ï¼Œè¿™æ„å‘³ç€å®ƒä»¬æ˜¯åŒä¸€å…ƒç´ çš„ä¸åŒå®ä¾‹1234567891011121314151617181920212223242526272829303132333435363738# Keystitle = &quot;My TOML Config&quot;# Tables[project]    name = &quot;Faceback&quot;    description = &quot;Powerful AI which renders the back of somebody's head, based on their face.&quot;    version = &quot;1.0.0&quot;    updated = 1979-05-27T07:32:00Z    author = &quot;Todd Birchard&quot;[database]    host = &quot;127.0.0.1&quot;    password = &quot;p@ssw0rd&quot;    port = 5432    name = &quot;my_database&quot;    connection_max = 5000    enabled = true# Nested `tables`[environments]    [environments.dev]        ip = &quot;10.0.0.1&quot;        dc = &quot;eqdc10&quot;    [environments.staging]        ip = &quot;10.0.0.2&quot;        dc = &quot;eqdc10&quot;    [environments.production]        ip = &quot;10.0.0.3&quot;        dc = &quot;eqdc10&quot;# Array of Tables[[testers]]    id = 1    username = &quot;JohnCena&quot;    password = &quot;YouCantSeeMe69&quot;[[testers]]    id = 3    username = &quot;TheRock&quot;    password = &quot;CantCook123&quot;åŒæ ·æœ‰è¶£çš„æ˜¯æ¦‚å¿µè¡¨åˆ—ï¼Œå¦‚ä¸‹è¡¨ä¸­çš„[[testers]]ï¼ŒåŒæ‹¬å·ä¸­çš„è¡¨ä¼šè‡ªåŠ¨æ·»åŠ åˆ°æ•°ç»„ä¸­ï¼Œå…¶ä¸­æ•°ç»„ä¸­çš„æ¯ä¸ªé¡¹ç›®éƒ½æ˜¯å…·æœ‰ç›¸åŒåç§°çš„è¡¨ï¼Œç­‰ä»·äºä¸‹ä¸‹é¢JSONæ‰€è¡¨è¾¾çš„ä¿¡æ¯12345678910111213{&quot;testers&quot;: [{&quot;id&quot;: 1,&quot;username&quot;: &quot;JohnCena&quot;,&quot;password&quot;: &quot;YouCantSeeMe69&quot;},{&quot;id&quot;: 2,&quot;username&quot;: &quot;TheRock&quot;,&quot;password&quot;: &quot;CantCook123&quot;}]}pythonè§£ætomlçš„ä»£ç å¦‚ä¸‹12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455import tomlpath = r'Q:\pyCharmWS\object_detection\test.toml'cfg = toml.load([path])# Retrieving a dictionarycfg['project']cfg.get('project')# Retrieving a valuecfg['project']['author']cfg.get('project').get('author')print(cfg){'title': 'My TOML Config','project': {'name': 'Faceback','description': &quot;Powerful AI which renders the back of somebody's head, based on their face.&quot;,'version': '1.0.0','updated': datetime.datetime(1979, 5, 27, 7, 32, tzinfo = &lt; toml.tz.TomlTz object at 0x000001AE244933D0 &gt; ),'author': 'Todd Birchard'},'database': {'host': '127.0.0.1','password': 'p@ssw0rd','port': 5432,'name': 'my_database','connection_max': 5000,'enabled': True},'environments': {'dev': {'ip': '10.0.0.1','dc': 'eqdc10'},'staging': {'ip': '10.0.0.2','dc': 'eqdc10'},'production': {'ip': '10.0.0.3','dc': 'eqdc10'}},'testers': [{'id': 1,'username': 'JohnCena','password': 'YouCantSeeMe69'}, {'id': 3,'username': 'TheRock','password': 'CantCook123'}]}yamlç³»ç»Ÿå˜é‡1234from os import environenviron.get('ComSpec')Out[0]: 'C:\\WINDOWS\\system32\\cmd.exe'æµ</content>
	</entry>
	<entry>
		<title>æ·±åº¦å­¦ä¹ åœ¨å›¾åƒé¢†åŸŸçš„åº”ç”¨</title>
		<url>/article/35455.html</url>
		<content>å¿…è¯»ï¼è®¡ç®—æœºè§†è§‰å››å¤§åŸºæœ¬ä»»åŠ¡(åˆ†ç±»ã€å®šä½ã€æ£€æµ‹ã€åˆ†å‰²)æ¨¡å‹ä»‹ç»æ¨¡å‹å¯è§†åŒ–netronå·¥å…·åº“pytorchæ¨¡å‹è½¬onnxæ¨¡å‹çš„æ–¹æ³•è¯¦è§£å›¾åƒåˆ†ç±»Stable Diffusionæ€»å…±åŒ…å«ä¸‰ä¸ªä¸»è¦çš„ç»„ä»¶äººå·¥æ™ºèƒ½Aiç”»ç”»â€”â€”stable diffusion åŸç†å’Œä½¿ç”¨æ–¹æ³•è¯¦è§£ï¼1ï¼‰Clip Textç”¨äºæ–‡æœ¬ç¼–ç ã€‚è¾“å…¥ï¼šæ–‡æœ¬è¾“å‡ºï¼š77ä¸ªtokenåµŒå…¥å‘é‡ï¼Œå…¶ä¸­æ¯ä¸ªå‘é‡åŒ…å«768ä¸ªç»´åº¦2ï¼‰UNet + Scheduleråœ¨ä¿¡æ¯ï¼ˆæ½œï¼‰ç©ºé—´ä¸­é€æ­¥å¤„ç†/æ‰©æ•£ä¿¡æ¯ã€‚è¾“å…¥ï¼šæ–‡æœ¬åµŒå…¥å’Œä¸€ä¸ªç”±å™ªå£°ç»„æˆçš„åˆå§‹å¤šç»´æ•°ç»„ï¼ˆç»“æ„åŒ–çš„æ•°å­—åˆ—è¡¨ï¼Œä¹Ÿå«å¼ é‡tensorï¼‰ã€‚è¾“å‡ºï¼šä¸€ä¸ªç»è¿‡å¤„ç†çš„ä¿¡æ¯é˜µåˆ—3ï¼‰è‡ªç¼–ç è§£ç å™¨ï¼ˆAutoencoder Decoderï¼‰ï¼Œä½¿ç”¨å¤„ç†è¿‡çš„ä¿¡æ¯çŸ©é˜µç»˜åˆ¶æœ€ç»ˆå›¾åƒçš„è§£ç å™¨ã€‚Clip Text æ˜¯ä¸€ç§è‡ªç„¶è¯­è¨€å¤„ç†æ¨¡å‹ï¼Œç”± OpenAI å¼€å‘ã€‚å®ƒåŸºäº CLIPï¼ˆContrastive Language-Image Pretrainingï¼‰æ¨¡å‹ï¼Œæ—¨åœ¨å°†æ–‡æœ¬å’Œå›¾åƒè”ç³»èµ·æ¥ã€‚Clip Text æ¨¡å‹å¯ä»¥ç†è§£å’Œå¤„ç†æ–‡æœ¬æ•°æ®ï¼Œä»¥ä¾¿è¿›è¡Œå„ç§ä»»åŠ¡ï¼Œä¾‹å¦‚æ–‡æœ¬åˆ†ç±»ã€æƒ…æ„Ÿåˆ†æã€å‘½åå®ä½“è¯†åˆ«ç­‰ã€‚é€šè¿‡è®­ç»ƒ Clip Text æ¨¡å‹ï¼Œå¯ä»¥ä½¿å…¶å…·å¤‡å¯¹æ–‡æœ¬çš„ç†è§£èƒ½åŠ›ï¼Œä»è€Œæ”¯æŒåœ¨è‡ªç„¶è¯­è¨€å¤„ç†é¢†åŸŸè¿›è¡Œå„ç§åº”ç”¨å’Œç ”ç©¶ã€‚UNet æ˜¯ä¸€ç§ç”¨äºå›¾åƒåˆ†å‰²çš„å·ç§¯ç¥ç»ç½‘ç»œæ¨¡å‹ã€‚å®ƒæœ€åˆç”± Olaf Ronneberger ç­‰äººåœ¨ 2015 å¹´æå‡ºï¼Œæ—¨åœ¨è§£å†³åŒ»å­¦å›¾åƒåˆ†å‰²ä»»åŠ¡ä¸­çš„é—®é¢˜ã€‚UNet çš„è®¾è®¡çµæ„Ÿæ¥è‡ªäºç”Ÿç‰©å­¦ä¸­çš„ç¥ç»å…ƒç»“æ„ï¼Œå®ƒå…·æœ‰ä¸€ä¸ªç‰¹æ®Šçš„ U å½¢ç»“æ„ï¼Œå› æ­¤å¾—å UNetã€‚UNet çš„ç‰¹ç‚¹æ˜¯å…·æœ‰å¯¹ç§°çš„ç¼–ç å™¨-è§£ç å™¨ç»“æ„ï¼Œå…¶ä¸­ç¼–ç å™¨éƒ¨åˆ†ç”±å¤šä¸ªå·ç§¯å’Œæ± åŒ–å±‚ç»„æˆï¼Œç”¨äºé€æ­¥æå–å›¾åƒçš„ç‰¹å¾ã€‚è§£ç å™¨éƒ¨åˆ†åˆ™é€šè¿‡ä¸Šé‡‡æ ·å’Œå·ç§¯æ“ä½œé€æ­¥å°†ç‰¹å¾æ˜ å°„æ¢å¤åˆ°åŸå§‹å›¾åƒçš„å°ºå¯¸ï¼Œç”¨äºç”Ÿæˆåˆ†å‰²ç»“æœã€‚æ­¤å¤–ï¼ŒUNet è¿˜é€šè¿‡è·³è·ƒè¿æ¥ï¼ˆskip connectionsï¼‰åœ¨ç¼–ç å™¨å’Œè§£ç å™¨ä¹‹é—´å»ºç«‹äº†ç›´æ¥è¿æ¥ï¼Œä»¥ä¾¿ä¿ç•™å’Œåˆ©ç”¨ä¸åŒå±‚çº§çš„ç‰¹å¾ä¿¡æ¯ã€‚UNet åœ¨åŒ»å­¦å›¾åƒåˆ†å‰²ä»»åŠ¡ä¸­å–å¾—äº†å¾ˆå¥½çš„æ•ˆæœï¼Œå¹¶ä¸”åœ¨å…¶ä»–é¢†åŸŸçš„å›¾åƒåˆ†å‰²ä»»åŠ¡ä¸­ä¹Ÿå¾—åˆ°äº†å¹¿æ³›åº”ç”¨ã€‚å®ƒçš„ç½‘ç»œç»“æ„ç®€å•ã€æ˜“äºå®ç°å’Œè®­ç»ƒï¼Œå¹¶ä¸”èƒ½å¤Ÿå¤„ç†ä¸åŒå°ºåº¦å’Œå½¢çŠ¶çš„ç›®æ ‡ç‰©ä½“ï¼Œå› æ­¤æˆä¸ºå›¾åƒåˆ†å‰²é¢†åŸŸçš„é‡è¦æ¨¡å‹ä¹‹ä¸€ã€‚ç›®æ ‡æ£€æµ‹å’Œè·Ÿè¸ªå›¾åƒåˆ†å‰²è¯­ä¹‰åˆ†å‰²å®ä¾‹åˆ†å‰²å›¾åƒå¤„ç†è¶…åˆ†è¾¨ç‡é™¤é›¾å›¾åƒç”ŸæˆåŠ¨ä½œè¯†åˆ«é£æ ¼è½¬æ¢äººè„¸è¯†åˆ«å›¾åƒæè¿°OCRæ·±å…¥äº†è§£è§†è§‰è¯­è¨€æ¨¡å‹BEiT: BERT Pre-Training of Image Transformers 2022ã€æ·±åº¦å­¦ä¹ ã€‘è¯¦è§£ BEiTã€ŠBEITã€‹-åŸºäºå›¾åƒé‡å»ºè¿›è¡Œé¢„è®­ç»ƒï¼å¾®è½¯æå‡ºBEITï¼ŒTop-1å‡†ç¡®ç‡è¾¾86.3%ï¼ä»£ç å·²å¼€æºï¼ä¸å…¶ä»–æ¨¡å‹ä¸åŒï¼ŒVisionEncoderDecoderModel æ˜¯ä¸€ä¸ªæ ‡å‡†åŒ–çš„æ¨¡å‹ï¼Œå¯ç”¨äºåˆå§‹åŒ–ä»»æ„å›¾åƒè½¬æ–‡æœ¬æ¨¡å‹ï¼Œè¿™ç±»æ¨¡å‹å¯ä»¥ä½¿ç”¨ä»»ä½•é¢„è®­ç»ƒçš„åŸºäºTransformerçš„è§†è§‰æ¨¡å‹ä½œä¸ºç¼–ç å™¨(ä¾‹å¦‚ViT(å­ç›‘ç£è®­ç»ƒ)ã€BEiT é¢„è®­ç»ƒBEiT(è‡ªç›‘ç£è®­ç»ƒ): æ©ç å›¾åƒå»ºæ¨¡(MIM)ä»»åŠ¡ï¼Œéšæœºmaskä¸€å®šç™¾åˆ†æ¯”çš„å›¾åƒpatchesï¼Œç„¶åé¢„æµ‹masked patcheså¯¹åº”çš„è§†è§‰tokensã€DeiTã€Swin)ä»¥åŠä»»ä½•é¢„è®­ç»ƒçš„è¯­è¨€æ¨¡å‹ä½œä¸ºè§£ç å™¨(ä¾‹å¦‚RoBERTaã€GPT2ã€BERTã€DistilBERT)ã€‚äº‹å®ä¸Šï¼ŒTrOCRæ˜¯è¿™ä¸ªæ ‡å‡†ç±»çš„ä¸€ä¸ªå®ä¾‹TrOCR: Transformer-based Optical Character Recognition with Pre-trained Models 2022å¾®è½¯äºšæ´²ç ”ç©¶é™¢çš„ç ”ç©¶å‘˜ä»¬å±•å¼€äº†æ·±å…¥ç ”ç©¶ï¼Œæå‡ºäº†é¦–ä¸ªåˆ©ç”¨é¢„è®­ç»ƒæ¨¡å‹çš„ç«¯åˆ°ç«¯åŸºäºTransformerçš„æ–‡æœ¬è¯†åˆ«OCRæ¨¡å‹ï¼šTrOCRã€‚è¯¥æ¨¡å‹ç®€å•æœ‰æ•ˆï¼Œå¯ä»¥ä½¿ç”¨å¤§è§„æ¨¡åˆæˆæ•°æ®è¿›è¡Œé¢„è®­ç»ƒï¼Œå¹¶ä¸”èƒ½å¤Ÿåœ¨äººå·¥æ ‡æ³¨çš„æ•°æ®ä¸Šè¿›è¡Œå¾®è°ƒã€‚å®éªŒè¯æ˜ï¼ŒTrOCRåœ¨æ‰“å°æ•°æ®å’Œæ‰‹å†™æ•°æ®ä¸Šå‡è¶…è¿‡äº†å½“å‰æœ€å…ˆè¿›çš„æ¨¡å‹ä¸€èˆ¬çš„å…‰å­¦å­—ç¬¦è¯†åˆ«åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼šæ–‡æœ¬æ£€æµ‹å’Œæ–‡æœ¬è¯†åˆ«æ–‡æœ¬æ£€æµ‹: ç”¨äºåœ¨æ–‡æœ¬å›¾åƒä¸­å®šä½æ–‡æœ¬å—ï¼Œç²’åº¦å¯ä»¥æ˜¯å•è¯çº§åˆ«æˆ–æ˜¯æ–‡æœ¬è¡Œçº§åˆ«ç›®å‰çš„è§£å†³æ–¹æ¡ˆå¤§å¤šæ˜¯å°†è¯¥ä»»åŠ¡è§†ä¸ºç‰©ä½“æ£€æµ‹é—®é¢˜ï¼Œå¹¶é‡‡ç”¨äº†å¦‚YoLOv5å’ŒDBNetçš„ä¼ ç»Ÿç‰©ä½“æ£€æµ‹æ¨¡å‹æ–‡æœ¬è¯†åˆ«: è‡´åŠ›äºç†è§£æ–‡æœ¬å›¾åƒå¹¶å°†è§†è§‰ä¿¡å·è½¬æ¢ä¸ºè‡ªç„¶è¯­è¨€ç¬¦å·ï¼Œè¯¥ä»»åŠ¡é€šå¸¸ä½¿ç”¨ç¼–ç å™¨-è§£ç å™¨æ¶æ„ç°æœ‰æ–¹æ³•é‡‡ç”¨äº†åŸºäºCNNç½‘ç»œçš„ç¼–ç å™¨è¿›è¡Œå›¾åƒç†è§£ï¼Œä»¥åŠåŸºäºRNNç½‘ç»œçš„è§£ç å™¨è¿›è¡Œæ–‡æœ¬ç”Ÿæˆä¸ºäº†æ›´æœ‰æ•ˆçš„è®­ç»ƒTrOCRæ¨¡å‹ï¼Œç ”ç©¶å‘˜ä»¬ä½¿ç”¨äº†ViTæ¨¡å¼çš„é¢„è®­ç»ƒæ¨¡å‹å’ŒBERTæ¨¡å¼çš„é¢„è®­ç»ƒæ¨¡å‹ï¼Œæ¥åˆ†åˆ«åˆå§‹åŒ–ç¼–ç å™¨å’Œè§£ç å™¨TrOCRForCausalLMhuggingface TrOCRForCausalLMç¿»è¯‘ï¼šThe ViTFeatureExtractor class is responsible for preprocessing the input image and RobertaTokenizer decodes the generated target tokens to the target string. The TrOCRProcessor wraps ViTFeatureExtractor and RobertaTokenizer into a single instance to both extract the input features and decode the predicted token ids.ViTFeatureExtractorç±»è´Ÿè´£é¢„å¤„ç†è¾“å…¥å›¾åƒï¼Œè€ŒRobertaTokenizeråˆ™å°†ç”Ÿæˆçš„ç›®æ ‡æ ‡è®°è§£ç ä¸ºç›®æ ‡å­—ç¬¦ä¸²ã€‚TrOCRProcessorå°†ViTFeatureExtractorå’ŒRobertaTokenizerå°è£…ä¸ºå•ä¸ªå®ä¾‹ï¼Œæ—¢å¯ä»¥æå–è¾“å…¥ç‰¹å¾ï¼Œåˆå¯ä»¥è§£ç é¢„æµ‹çš„æ ‡è®°IDç¿»è¯‘ï¼šThe VisionEncoderDecoderModel can be used to initialize an image-to-text-sequence model with any pretrained vision autoencoding model as the encoder (e.g. ViT, BEiT, DeiT) and any pretrained language model as the decoder (e.g. RoBERTa, GPT2, BERT). The effectiveness of initializing image-to-text-sequence models with pretrained checkpoints has been shown in (for example) TrOCR: Transformer-based Optical Character Recognition with Pre-trained Models by Minghao Li, Tengchao Lv, Lei Cui, Yijuan Lu, Dinei Florencio, Cha Zhang, Zhoujun Li, Furu Wei. An example of how to use a VisionEncoderDecoderModel for inference can be seen in TrOCR.VisionEncoderDecoderModelå¯ä»¥ç”¨äºåˆå§‹åŒ–ä¸€ä¸ªå›¾åƒåˆ°æ–‡æœ¬åºåˆ—æ¨¡å‹ï¼Œå…¶ä¸­ç¼–ç å™¨å¯ä»¥æ˜¯ä»»ä½•é¢„è®­ç»ƒçš„å›¾åƒè‡ªç¼–ç æ¨¡å‹ï¼ˆä¾‹å¦‚ViTã€BEiTã€DeiTï¼‰ï¼Œè§£ç å™¨å¯ä»¥æ˜¯ä»»ä½•é¢„è®­ç»ƒçš„è¯­è¨€æ¨¡å‹ï¼ˆä¾‹å¦‚RoBERTaã€GPT2ã€BERTï¼‰åˆå§‹åŒ–å›¾åƒåˆ°æ–‡æœ¬åºåˆ—æ¨¡å‹æ—¶ä½¿ç”¨é¢„è®­ç»ƒçš„æ£€æŸ¥ç‚¹å·²ç»è¢«è¯æ˜æ˜¯æœ‰æ•ˆçš„ï¼Œä¾‹å¦‚åœ¨ã€ŠTrOCRï¼šåŸºäºé¢„è®­ç»ƒæ¨¡å‹çš„åŸºäºTransformerçš„å…‰å­¦å­—ç¬¦è¯†åˆ«ã€‹ä¸€æ–‡ä¸­ï¼Œä½œè€…Minghao Liã€Tengchao Lvã€Lei Cuiã€Yijuan Luã€Dinei Florencioã€Cha Zhangã€Zhoujun Liã€Furu Weiå±•ç¤ºäº†è¿™ä¸€ç‚¹å…³äºå¦‚ä½•ä½¿ç”¨VisionEncoderDecoderModelè¿›è¡Œæ¨æ–­çš„ç¤ºä¾‹å¯ä»¥åœ¨TrOCRä¸­æ‰¾åˆ°å›¾åƒç‰¹å®šçš„å½’çº³åå·®å›¾åƒç‰¹å®šçš„å½’çº³åå·®æ˜¯æŒ‡åœ¨å¤„ç†å›¾åƒæ•°æ®æ—¶ï¼Œæœºå™¨å­¦ä¹ ç®—æ³•æˆ–äººç±»å¤§è„‘å¯¹å›¾åƒçš„å¤„ç†å’Œç†è§£ä¸­å­˜åœ¨çš„åå¥½æˆ–å€¾å‘æ€§ã€‚è¿™ç§åå·®å¯èƒ½å¯¼è‡´ç®—æ³•æˆ–äººç±»åœ¨å¤„ç†å›¾åƒæ—¶å‡ºç°ç³»ç»Ÿæ€§çš„é”™è¯¯æˆ–è¯¯è§£ã€‚å›¾åƒç‰¹å®šçš„å½’çº³åå·®å¯èƒ½æºè‡ªä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼šå½¢çŠ¶åå·®ï¼šäººç±»å’Œæœºå™¨å­¦ä¹ ç®—æ³•åœ¨å¤„ç†å›¾åƒæ—¶ï¼Œå¯èƒ½æ›´å®¹æ˜“å…³æ³¨ç‰©ä½“çš„å½¢çŠ¶å’Œè½®å»“ã€‚è¿™å¯èƒ½å¯¼è‡´å¯¹äºå½¢çŠ¶ç‰¹å¾è¾ƒå¼ºçš„ç‰©ä½“æ›´æ•æ„Ÿï¼Œè€Œå¯¹äºçº¹ç†ã€é¢œè‰²ç­‰å…¶ä»–ç‰¹å¾çš„é‡è¦æ€§è¾ƒä½ã€‚é¢œè‰²åå·®ï¼šé¢œè‰²æ˜¯å›¾åƒä¸­çš„é‡è¦ç‰¹å¾ä¹‹ä¸€ï¼Œä½†äººç±»å’Œæœºå™¨å­¦ä¹ ç®—æ³•å¯èƒ½å¯¹ä¸åŒé¢œè‰²çš„æ„ŸçŸ¥å’Œè¾¨åˆ«èƒ½åŠ›å­˜åœ¨å·®å¼‚ã€‚æŸäº›é¢œè‰²çš„è¾¨åˆ«å¯èƒ½æ›´å®¹æ˜“ï¼Œè€Œå¯¹äºå…¶ä»–é¢œè‰²çš„è¾¨åˆ«å¯èƒ½ç›¸å¯¹è¾ƒå·®ã€‚å°ºåº¦åå·®ï¼šå›¾åƒä¸­çš„ç‰©ä½“å°ºåº¦å¯èƒ½å¯¹äºç®—æ³•æˆ–äººç±»çš„è§†è§‰å¤„ç†äº§ç”Ÿå½±å“ã€‚ä¾‹å¦‚ï¼Œè¾ƒå¤§å°ºåº¦çš„ç‰©ä½“å¯èƒ½æ›´å®¹æ˜“è¢«æ³¨æ„åˆ°å’Œç†è§£ï¼Œè€Œè¾ƒå°å°ºåº¦çš„ç‰©ä½“å¯èƒ½å®¹æ˜“è¢«å¿½ç•¥æˆ–è¯¯è§£ã€‚è§†è§’åå·®ï¼šè§†è§’å¯¹äºç†è§£å›¾åƒä¸­çš„ç‰©ä½“å’Œåœºæ™¯ä¹Ÿå…·æœ‰é‡è¦ä½œç”¨ã€‚ä¸åŒçš„è§†è§’å¯èƒ½å¯¼è‡´ç‰©ä½“çš„å¤–è§‚å‘ç”Ÿå˜åŒ–ï¼Œä»è€Œå½±å“ç®—æ³•æˆ–äººç±»å¯¹ç‰©ä½“çš„è®¤çŸ¥å’Œè§£é‡Šã€‚è¿™äº›å›¾åƒç‰¹å®šçš„å½’çº³åå·®å¯èƒ½ä¼šå¯¹è®¡ç®—æœºè§†è§‰ä»»åŠ¡ï¼ˆå¦‚ç‰©ä½“æ£€æµ‹ã€å›¾åƒåˆ†ç±»ç­‰ï¼‰çš„æ€§èƒ½äº§ç”Ÿå½±å“ï¼Œå¹¶å¯¼è‡´ä¸€äº›å¸¸è§çš„è¯¯åˆ†ç±»æˆ–è¯¯è§£ã€‚ä¸ºäº†å‡å°‘è¿™äº›åå·®çš„å½±å“ï¼Œç ”ç©¶äººå‘˜å’Œå¼€å‘è€…é€šå¸¸ä¼šé‡‡å–ä¸€ç³»åˆ—çš„æ–¹æ³•ï¼Œä¾‹å¦‚ä½¿ç”¨æ›´ä¸°å¯Œçš„ç‰¹å¾è¡¨ç¤ºã€è¿›è¡Œæ•°æ®å¢å¼ºã€å¤šè§’åº¦è®­ç»ƒç­‰ï¼Œä»¥æé«˜ç®—æ³•åœ¨å¤„ç†å›¾åƒæ•°æ®æ—¶çš„å‡†ç¡®æ€§å’Œé²æ£’æ€§ã€‚åŸºäºTrOCR æä¸€äº›é¢è¯•é¢˜å½“æ¶‰åŠåˆ°TrOCRï¼ˆTransformer-based Optical Character Recognitionï¼‰çš„é¢è¯•é—®é¢˜æ—¶ï¼Œå¯ä»¥è€ƒè™‘ä»¥ä¸‹å‡ ä¸ªæ–¹é¢çš„é—®é¢˜ï¼šä»€ä¹ˆæ˜¯TrOCRï¼Ÿå®ƒä¸ä¼ ç»Ÿçš„OCRæ–¹æ³•æœ‰ä½•ä¸åŒï¼ŸTrOCRä¸­ä½¿ç”¨çš„æ˜¯å“ªç§Transformeræ¨¡å‹ï¼Ÿè¯·æè¿°å…¶ç»“æ„å’Œä¸»è¦ç»„æˆéƒ¨åˆ†ã€‚åœ¨TrOCRä¸­ï¼Œå›¾åƒæ˜¯å¦‚ä½•è¢«å¤„ç†å’Œè¾“å…¥åˆ°Transformeræ¨¡å‹ä¸­çš„ï¼ŸTrOCRå¦‚ä½•å®ç°å¯¹æ–‡æœ¬çš„è‡ªå›å½’ç”Ÿæˆï¼Ÿå®ƒé‡‡ç”¨äº†å“ªäº›æŠ€æœ¯å’Œç­–ç•¥ï¼ŸTrOCRä¸­çš„é¢„è®­ç»ƒå’Œå¾®è°ƒæ˜¯å¦‚ä½•è¿›è¡Œçš„ï¼Ÿä½¿ç”¨äº†å“ªäº›æ•°æ®é›†å’Œè®­ç»ƒæ–¹æ³•ï¼ŸTrOCRåœ¨å“ªäº›ä»»åŠ¡å’Œæ•°æ®é›†ä¸Šå–å¾—äº†ä¼˜ç§€çš„æ€§èƒ½ï¼Ÿå¯ä»¥è°ˆè°ˆå…¶åœ¨å°åˆ·ä½“å’Œæ‰‹å†™ä½“è¯†åˆ«ä»»åŠ¡ä¸Šçš„è¡¨ç°ã€‚TrOCRçš„ä¼˜åŠ¿å’Œå±€é™æ€§æ˜¯ä»€ä¹ˆï¼Ÿç›¸å¯¹äºä¼ ç»Ÿçš„OCRæ–¹æ³•ï¼Œå®ƒæœ‰å“ªäº›æ½œåœ¨çš„åº”ç”¨å‰æ™¯å’ŒæŒ‘æˆ˜ï¼Ÿåœ¨TrOCRä¸­ï¼Œæ˜¯å¦å­˜åœ¨ä¸€äº›å¸¸è§çš„é—®é¢˜æˆ–æŒ‘æˆ˜ï¼Ÿå¯ä»¥è°ˆè°ˆå¯¹åº”çš„è§£å†³æ–¹æ³•æˆ–æ”¹è¿›æ€è·¯ã€‚TrOCRåœ¨å®é™…åº”ç”¨ä¸­å¯èƒ½é¢ä¸´çš„è®¡ç®—èµ„æºå’Œæ•ˆç‡æ–¹é¢çš„é—®é¢˜æœ‰å“ªäº›ï¼Ÿå¦‚ä½•è§£å†³æˆ–ä¼˜åŒ–è¿™äº›é—®é¢˜ï¼Ÿé™¤äº†TrOCRï¼Œè¿˜æœ‰å“ªäº›åŸºäºTransformerçš„å›¾åƒå¤„ç†ä»»åŠ¡å’Œåº”ç”¨ï¼Ÿå¯ä»¥ä¸¾ä¾‹è¯´æ˜ã€‚è¿™äº›é—®é¢˜å°†æ¶µç›–TrOCRçš„åŸºæœ¬æ¦‚å¿µã€æ¨¡å‹ç»“æ„ã€è®­ç»ƒå’Œåº”ç”¨ç­‰æ–¹é¢ï¼Œæœ‰åŠ©äºè¯„ä¼°é¢è¯•è€…å¯¹TrOCRçš„ç†è§£å’Œç†Ÿæ‚‰ç¨‹åº¦ã€‚æ ¹æ®å…·ä½“æƒ…å†µï¼Œä½ è¿˜å¯ä»¥è¿›ä¸€æ­¥å±•å¼€è®¨è®ºç›¸å…³çš„æ·±å…¥é—®é¢˜ã€‚å›ç­”ä¸‹ä½ æçš„åä¸ªé—®é¢˜å½“æ¶‰åŠåˆ°TrOCRï¼ˆTransformer-based Optical Character Recognitionï¼‰çš„é¢è¯•é—®é¢˜æ—¶ï¼Œä»¥ä¸‹æ˜¯å¯¹ä½ æå‡ºçš„åä¸ªé—®é¢˜çš„ç®€è¦å›ç­”ï¼šTrOCRæ˜¯ä¸€ç§åŸºäºTransformerçš„å…‰å­¦å­—ç¬¦è¯†åˆ«æ–¹æ³•ï¼Œä¸ä¼ ç»Ÿçš„OCRæ–¹æ³•ç›¸æ¯”ï¼Œå®ƒåˆ©ç”¨Transformeræ¨¡å‹å®ç°äº†ç«¯åˆ°ç«¯çš„æ–‡æœ¬ç”Ÿæˆå’Œç†è§£ï¼Œå…·æœ‰æ›´å¥½çš„å»ºæ¨¡èƒ½åŠ›å’Œä¸Šä¸‹æ–‡ç†è§£èƒ½åŠ›ã€‚TrOCRä½¿ç”¨çš„æ˜¯Transformeræ¨¡å‹ï¼Œå®ƒç”±ç¼–ç å™¨å’Œè§£ç å™¨ç»„æˆã€‚ç¼–ç å™¨é‡‡ç”¨è‡ªæ³¨æ„åŠ›æœºåˆ¶æ¥å¤„ç†è¾“å…¥å›¾åƒçš„ç‰¹å¾è¡¨ç¤ºï¼Œè§£ç å™¨é‡‡ç”¨è‡ªå›å½’ç”Ÿæˆçš„æ–¹å¼é€æ­¥ç”Ÿæˆè¾“å‡ºæ–‡æœ¬ã€‚åœ¨TrOCRä¸­ï¼Œå›¾åƒç»è¿‡é¢„å¤„ç†æ­¥éª¤ï¼Œå¦‚åˆ†å‰²ä¸ºå›ºå®šå¤§å°çš„å›¾åƒå—ï¼Œå¹¶è¿›è¡Œçº¿æ€§åµŒå…¥ï¼Œç„¶åæ·»åŠ ä½ç½®ç¼–ç ã€‚å¤„ç†åçš„å›¾åƒè¡¨ç¤ºè¢«è¾“å…¥åˆ°Transformerç¼–ç å™¨ä¸­è¿›è¡Œå¤„ç†ã€‚TrOCRé‡‡ç”¨è‡ªå›å½’ç”Ÿæˆçš„æ–¹å¼å¯¹æ–‡æœ¬è¿›è¡Œç”Ÿæˆï¼Œå³é€ä¸ªç”Ÿæˆæ¯ä¸ªå­—ç¬¦æˆ–è¯æ±‡ã€‚å®ƒä½¿ç”¨äº†ç±»ä¼¼äºè¯­è¨€å»ºæ¨¡çš„æŠ€æœ¯ï¼Œé€šè¿‡ä¸Šæ–‡çš„ä¿¡æ¯æ¥é¢„æµ‹ä¸‹ä¸€ä¸ªå­—ç¬¦æˆ–è¯æ±‡ã€‚TrOCRçš„é¢„è®­ç»ƒé˜¶æ®µé€šå¸¸ä½¿ç”¨å¤§è§„æ¨¡çš„åˆæˆæ•°æ®è¿›è¡Œè®­ç»ƒï¼Œä»¥å­¦ä¹ å›¾åƒå’Œæ–‡æœ¬ä¹‹é—´çš„å¯¹åº”å…³ç³»ã€‚ç„¶åï¼Œå¯ä»¥é€šè¿‡å¾®è°ƒé˜¶æ®µä½¿ç”¨çœŸå®æ ‡æ³¨çš„æ•°æ®æ¥ä¼˜åŒ–æ¨¡å‹çš„æ€§èƒ½ã€‚TrOCRåœ¨å°åˆ·ä½“å’Œæ‰‹å†™ä½“è¯†åˆ«ä»»åŠ¡ä¸Šå–å¾—äº†ä¼˜ç§€çš„æ€§èƒ½ã€‚å®ƒåœ¨å¤§è§„æ¨¡çš„OCRæ•°æ®é›†ä¸Šè¿›è¡Œäº†è¯„ä¼°ï¼Œå¹¶åœ¨å‡†ç¡®æ€§å’Œæ³›åŒ–èƒ½åŠ›æ–¹é¢è¶…è¿‡äº†ä¼ ç»Ÿçš„OCRæ–¹æ³•ã€‚TrOCRçš„ä¼˜åŠ¿åŒ…æ‹¬èƒ½å¤Ÿå¯¹é•¿æ–‡æœ¬è¿›è¡Œå»ºæ¨¡ã€ä¸Šä¸‹æ–‡ç†è§£èƒ½åŠ›å¼ºã€é€‚åº”ä¸åŒè¯­ç§å’Œå­—ä½“æ ·å¼ç­‰ã€‚ç„¶è€Œï¼ŒTrOCRå¯èƒ½å¯¹è®¡ç®—èµ„æºè¦æ±‚è¾ƒé«˜ï¼Œå¹¶ä¸”åœ¨å¤„ç†ä¸€äº›ç‰¹å®šçš„å¤æ‚åœºæ™¯ï¼ˆå¦‚ä½è´¨é‡å›¾åƒæˆ–ç‰¹æ®Šå­—ä½“ï¼‰æ—¶å¯èƒ½é¢ä¸´æŒ‘æˆ˜ã€‚åœ¨TrOCRä¸­ï¼Œä¸€äº›å¸¸è§çš„é—®é¢˜åŒ…æ‹¬æ–‡æœ¬é‡å¤ç”Ÿæˆã€æ¨¡ç³Šå›¾åƒçš„å¤„ç†ã€é•¿æ–‡æœ¬çš„ç”Ÿæˆå’Œè®­ç»ƒæ•°æ®çš„æ ‡æ³¨è´¨é‡ã€‚è§£å†³è¿™äº›é—®é¢˜çš„æ–¹æ³•å¯èƒ½æ¶‰åŠä½¿ç”¨æ›´å¤æ‚çš„è§£ç ç­–ç•¥ã€æ”¹è¿›çš„å›¾åƒé¢„å¤„ç†å’Œå¢å¼ºæŠ€æœ¯ä»¥åŠæ›´å¥½çš„æ•°æ®æ ‡æ³¨å’Œæ¸…æ´—æ–¹æ³•ã€‚TrOCRåœ¨å®é™…åº”ç”¨ä¸­å¯èƒ½é¢ä¸´çš„è®¡ç®—èµ„æºå’Œæ•ˆç‡æ–¹é¢çš„é—®é¢˜åŒ…æ‹¬æ¨¡å‹å¤§å°å’Œæ¨ç†é€Ÿåº¦ã€‚ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œå¯ä»¥é‡‡ç”¨æ¨¡å‹å‹ç¼©å’ŒåŠ é€ŸæŠ€æœ¯ï¼Œå¦‚å‰ªæã€é‡åŒ–å’Œæ¨¡å‹å¹¶è¡ŒåŒ–ç­‰ã€‚é™¤äº†TrOCRï¼Œè¿˜æœ‰è®¸å¤šåŸºäºTransformerçš„å›¾åƒå¤„ç†ä»»åŠ¡å’Œåº”ç”¨ã€‚ä¾‹å¦‚ï¼Œå›¾åƒåˆ†ç±»ã€ç›®æ ‡æ£€æµ‹OCRè¯†åˆ«æ‰‹å†™æ–‡å­—(ä¸­æ–‡+è‹±æ–‡)å‚è€ƒæ–‡çŒ®ï¼šTrOCR: Transformer-based Optical Character Recognition with Pre-trained Models 2022è¯¥è®ºæ–‡æå‡ºäº†ä¸€ç§åä¸ºTrOCRçš„åŸºäºTransformerçš„å…‰å­¦å­—ç¬¦è¯†åˆ«(OCR)æ¨¡å‹ï¼Œé€šè¿‡åˆ©ç”¨é¢„è®­ç»ƒæ¨¡å‹è¿›è¡Œç‰¹å¾æå–å’Œæ–‡æœ¬ç”Ÿæˆï¼Œå®ç°ç«¯åˆ°ç«¯çš„æ–‡æœ¬è¯†åˆ«ä»»åŠ¡TrOCRæ¨¡å‹çš„å…³é”®åˆ›æ–°ç‚¹åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼šåŸºäºTransformerçš„æ¶æ„ï¼šTrOCRé‡‡ç”¨äº†Transformeræ¶æ„ä½œä¸ºå…¶åŸºç¡€æ¨¡å‹ï¼Œå…¶ä¸­åŒ…æ‹¬ç¼–ç å™¨å’Œè§£ç å™¨ã€‚ç¼–ç å™¨ç”¨äºæå–å›¾åƒç‰¹å¾ï¼Œè§£ç å™¨ç”¨äºç”Ÿæˆè¯†åˆ«çš„æ–‡æœ¬åºåˆ—é¢„è®­ç»ƒæ¨¡å‹çš„åº”ç”¨ï¼šTrOCRåˆ©ç”¨é¢„è®­ç»ƒçš„å›¾åƒå’Œæ–‡æœ¬æ¨¡å‹ä½œä¸ºç¼–ç å™¨å’Œè§£ç å™¨ï¼Œå¦‚ViTã€RoBERTaç­‰ã€‚è¿™äº›é¢„è®­ç»ƒæ¨¡å‹èƒ½å¤Ÿæä¾›ä¸°å¯Œçš„è§†è§‰å’Œè¯­è¨€è¡¨ç¤ºèƒ½åŠ›ï¼Œæœ‰åŠ©äºæé«˜OCRçš„å‡†ç¡®æ€§å¤§è§„æ¨¡åˆæˆæ•°æ®é›†ï¼šä¸ºäº†è¿›è¡Œé¢„è®­ç»ƒå’Œå¾®è°ƒï¼ŒTrOCRä½¿ç”¨äº†å¤§è§„æ¨¡çš„åˆæˆæ•°æ®é›†ï¼ŒåŒ…æ‹¬æ•°ç™¾ä¸‡å¼ æ‰“å°æ–‡æœ¬å›¾åƒå’Œæ‰‹å†™æ–‡æœ¬å›¾åƒã€‚è¿™æ ·å¯ä»¥å¢åŠ æ¨¡å‹åœ¨ä¸åŒé¢†åŸŸå’Œæ ·å¼çš„æ–‡æœ¬ä¸Šçš„æ³›åŒ–èƒ½åŠ›å®éªŒè¯æ˜ï¼ŒTrOCRæ¨¡å‹åœ¨æ‰“å°æ–‡æœ¬ã€æ‰‹å†™æ–‡æœ¬å’Œåœºæ™¯æ–‡æœ¬è¯†åˆ«ä»»åŠ¡ä¸Šå–å¾—äº†ä¼˜å¼‚çš„æ€§èƒ½è¡¨ç°ï¼Œè¶…è¿‡äº†å½“å‰çš„state-of-the-artæ¨¡å‹ã€‚è¯¥è®ºæ–‡çš„è´¡çŒ®åœ¨äºå°†Transformeråº”ç”¨äºOCRä»»åŠ¡ï¼Œå¹¶ä¸”é€šè¿‡é¢„è®­ç»ƒæ¨¡å‹çš„åˆ©ç”¨æé«˜äº†OCRçš„å‡†ç¡®æ€§å’Œæ³›åŒ–èƒ½åŠ›æ¶æ„ï¼šmodel(VisionEncoderDecoderModel) = encoder(DeiT)+decoder(TrOCRForCausalLM)1234567891011121314151617181920212223242526272829303132333435363738394041DeiTModel(  (embeddings): DeiTEmbeddings(    (patch_embeddings): DeiTPatchEmbeddings(      (projection): Conv2d(3, 384, kernel_size=(16, 16), stride=(16, 16))    )    (dropout): Dropout(p=0.0, inplace=False)  )  (encoder): DeiTEncoder(    (layer): ModuleList(      (0): DeiTLayer(        (attention): DeiTAttention(          (attention): DeiTSelfAttention(            (query): Linear(in_features=384, out_features=384, bias=True)            (key): Linear(in_features=384, out_features=384, bias=True)            (value): Linear(in_features=384, out_features=384, bias=True)            (dropout): Dropout(p=0.0, inplace=False)          )          (output): DeiTSelfOutput(            (dense): Linear(in_features=384, out_features=384, bias=True)            (dropout): Dropout(p=0.0, inplace=False)          )        )        (intermediate): DeiTIntermediate(          (dense): Linear(in_features=384, out_features=1536, bias=True)          (intermediate_act_fn): GELUActivation()        )        (output): DeiTOutput(          (dense): Linear(in_features=1536, out_features=384, bias=True)          (dropout): Dropout(p=0.0, inplace=False)        )        (layernorm_before): LayerNorm((384,), eps=1e-12, elementwise_affine=True)        (layernorm_after): LayerNorm((384,), eps=1e-12, elementwise_affine=True)      ) * 12    )  )  (layernorm): LayerNorm((384,), eps=1e-12, elementwise_affine=True)  (pooler): DeiTPooler(    (dense): Linear(in_features=384, out_features=384, bias=True)    (activation): Tanh()  ))12# é€šè¿‡çº¿æ€§å±‚å°†ç¼–ç å™¨å’Œè§£ç å™¨è¿æ¥åˆ°äº†ä¸€èµ·enc_to_dec_proj = nn.Linear(self.encoder.config.hidden_size, self.decoder.config.hidden_size)1234567891011121314151617181920212223242526272829303132TrOCRForCausalLM(  (model): TrOCRDecoderWrapper(    (decoder): TrOCRDecoder(      (embed_tokens): Embedding(11318, 256, padding_idx=1)      (embed_positions): TrOCRLearnedPositionalEmbedding(514, 256)      (layernorm_embedding): LayerNorm((256,), eps=1e-05, elementwise_affine=True)      (layers): ModuleList(        (0): TrOCRDecoderLayer(          (self_attn): TrOCRAttention(            (k_proj): Linear(in_features=256, out_features=256, bias=True)            (v_proj): Linear(in_features=256, out_features=256, bias=True)            (q_proj): Linear(in_features=256, out_features=256, bias=True)            (out_proj): Linear(in_features=256, out_features=256, bias=True)          )          (activation_fn): ReLU()          (self_attn_layer_norm): LayerNorm((256,), eps=1e-05, elementwise_affine=True)          (encoder_attn): TrOCRAttention(            (k_proj): Linear(in_features=384, out_features=256, bias=True)            (v_proj): Linear(in_features=384, out_features=256, bias=True)            (q_proj): Linear(in_features=256, out_features=256, bias=True)            (out_proj): Linear(in_features=256, out_features=256, bias=True)          )          (encoder_attn_layer_norm): LayerNorm((256,), eps=1e-05, elementwise_affine=True)          (fc1): Linear(in_features=256, out_features=1024, bias=True)          (fc2): Linear(in_features=1024, out_features=256, bias=True)          (final_layer_norm): LayerNorm((256,), eps=1e-05, elementwise_affine=True)        ) * 6      )    )  )  (output_projection): Linear(in_features=256, out_features=11318, bias=False))å®ç°ç»†èŠ‚:æ•°æ®é›†:</content>
	</entry>
	<entry>
		<title>transformerå­¦ä¹ </title>
		<url>/article/44700.html</url>
		<content>TransformerAttention Is All You Needè®ºæ–‡è§£è¯»: Attention is All you needHugging Faceçš„GitHubä»£ç åº“é€šå¸¸è€Œè¨€ï¼Œç»å¤§éƒ¨åˆ†NLPé—®é¢˜å¯ä»¥å½’å…¥ä¸Šå›¾æ‰€ç¤ºçš„å››ç±»ä»»åŠ¡ä¸­åºåˆ—æ ‡æ³¨: è¿™æ˜¯æœ€å…¸å‹çš„NLPä»»åŠ¡ï¼Œæ¯”å¦‚ä¸­æ–‡åˆ†è¯ï¼Œè¯æ€§æ ‡æ³¨ï¼Œå‘½åå®ä½“è¯†åˆ«ï¼Œè¯­ä¹‰è§’è‰²æ ‡æ³¨ç­‰éƒ½å¯ä»¥å½’å…¥è¿™ä¸€ç±»é—®é¢˜å®ƒçš„ç‰¹ç‚¹æ˜¯å¥å­ä¸­æ¯ä¸ªå•è¯è¦æ±‚æ¨¡å‹æ ¹æ®ä¸Šä¸‹æ–‡éƒ½è¦ç»™å‡ºä¸€ä¸ªåˆ†ç±»ç±»åˆ«åˆ†ç±»ä»»åŠ¡: æ¯”å¦‚æˆ‘ä»¬å¸¸è§çš„æ–‡æœ¬åˆ†ç±»ï¼Œæƒ…æ„Ÿè®¡ç®—ç­‰éƒ½å¯ä»¥å½’å…¥è¿™ä¸€ç±»ã€‚å®ƒçš„ç‰¹ç‚¹æ˜¯ä¸ç®¡æ–‡ç« æœ‰å¤šé•¿ï¼Œæ€»ä½“ç»™å‡ºä¸€ä¸ªåˆ†ç±»ç±»åˆ«å³å¯å¥å­å…³ç³»åˆ¤æ–­: æ¯”å¦‚Entailmentï¼ŒQAï¼Œè¯­ä¹‰æ”¹å†™ï¼Œè‡ªç„¶è¯­è¨€æ¨ç†ç­‰ä»»åŠ¡éƒ½æ˜¯è¿™ä¸ªæ¨¡å¼ï¼Œç»™å®šä¸¤ä¸ªå¥å­ï¼Œæ¨¡å‹åˆ¤æ–­å‡ºä¸¤ä¸ªå¥å­æ˜¯å¦å…·å¤‡æŸç§è¯­ä¹‰å…³ç³»ç”Ÿæˆå¼ä»»åŠ¡: æ¯”å¦‚æœºå™¨ç¿»è¯‘ï¼Œæ–‡æœ¬æ‘˜è¦ï¼Œå†™è¯—é€ å¥ï¼Œçœ‹å›¾è¯´è¯ç­‰éƒ½å±äºè¿™ä¸€ç±»ï¼Œè¾“å…¥æ–‡æœ¬å†…å®¹åï¼Œéœ€è¦è‡ªä¸»ç”Ÿæˆå¦å¤–ä¸€æ®µæ–‡å­—é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ç›®å‰æœ‰ä¸¤ç§é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ç”¨äºä¸‹æ¸¸ä»»åŠ¡çš„æ–¹æ³•ï¼šfeature-based(ä»¥ELMoä¸ºä¾‹)å’Œfine-tuning(ä»¥BERTã€GPTä¸ºä¾‹)æœ‰ä¸“é—¨çš„è®ºæ–‡(To Tune or Not to Tune? Adapting Pretrained Representations to Diverse Tasks)è®¨è®ºäº†è¿™ä¸ªè¯é¢˜Feature-based Pre-Training:åœ¨Feature-based Pre-Trainingä¸­ï¼Œé¦–å…ˆä½¿ç”¨å¤§è§„æ¨¡çš„æœªæ ‡è®°æ•°æ®é›†å¯¹æ¨¡å‹è¿›è¡Œé¢„è®­ç»ƒé¢„è®­ç»ƒä»»åŠ¡é€šå¸¸æ˜¯é€šè¿‡è‡ªç›‘ç£å­¦ä¹ æˆ–å…¶ä»–æ— ç›‘ç£å­¦ä¹ æ–¹æ³•æ¥å®Œæˆï¼Œä¾‹å¦‚é¢„æµ‹ä¸‹ä¸€ä¸ªè¯è¯­ã€å›¾åƒçš„æ—‹è½¬è§’åº¦ç­‰é¢„è®­ç»ƒçš„ç›®æ ‡æ˜¯å­¦ä¹ åˆ°å…·æœ‰è‰¯å¥½è¡¨ç¤ºèƒ½åŠ›çš„ç‰¹å¾ï¼Œèƒ½å¤Ÿæ•æ‰æ•°æ®ä¸­çš„ä¸€èˆ¬æ€§ä¿¡æ¯é¢„è®­ç»ƒæ¨¡å‹é€šå¸¸æ˜¯ä¸€ä¸ªé€šç”¨çš„æ¨¡å‹ï¼Œä¸é’ˆå¯¹ç‰¹å®šçš„ä»»åŠ¡ã€‚å®ƒå­¦ä¹ åˆ°çš„ç‰¹å¾è¡¨ç¤ºå¯ä»¥åº”ç”¨äºå„ç§ä¸åŒçš„ä»»åŠ¡é¢„è®­ç»ƒæ¨¡å‹å¯ä»¥ä½œä¸ºè¿ç§»å­¦ä¹ çš„åŸºç¡€ï¼Œé€šè¿‡å°†å…¶ç‰¹å¾æå–éƒ¨åˆ†åº”ç”¨äºå…·ä½“çš„ä»»åŠ¡Fine-tuning:Fine-tuningæ˜¯åœ¨é¢„è®­ç»ƒæ¨¡å‹çš„åŸºç¡€ä¸Šï¼Œåœ¨ç‰¹å®šä»»åŠ¡çš„æœ‰æ ‡ç­¾æ•°æ®é›†ä¸Šè¿›è¡Œè¿›ä¸€æ­¥è®­ç»ƒå’Œä¼˜åŒ–Fine-tuningé˜¶æ®µä¼šè°ƒæ•´é¢„è®­ç»ƒæ¨¡å‹çš„æƒé‡å’Œå‚æ•°ï¼Œä»¥ä½¿å…¶é€‚åº”ç›®æ ‡ä»»åŠ¡çš„ç‰¹å®šè¦æ±‚Fine-tuningè¿‡ç¨‹ä¸­ï¼Œé€šå¸¸ä¼šä¿æŒé¢„è®­ç»ƒæ¨¡å‹çš„ä¸€éƒ¨åˆ†æƒé‡å›ºå®šï¼Œåªæ›´æ–°éƒ¨åˆ†æƒé‡ï¼Œä»¥ä¿ç•™é¢„è®­ç»ƒé˜¶æ®µå­¦ä¹ åˆ°çš„é€šç”¨ç‰¹å¾è¡¨ç¤ºFine-tuningæ—¨åœ¨åœ¨ç‰¹å®šä»»åŠ¡çš„æœ‰é™æ ‡è®°æ•°æ®é›†ä¸Šä¼˜åŒ–æ¨¡å‹ï¼Œä½¿å…¶æ›´å¥½åœ°é€‚åº”è¯¥ä»»åŠ¡çš„æ•°æ®å’Œç‰¹å¾æ€»ç»“æ¥è¯´ï¼ŒFeature-based Pre-Trainingæ˜¯é€šè¿‡åœ¨æœªæ ‡è®°æ•°æ®ä¸Šé¢„è®­ç»ƒæ¨¡å‹æ¥å­¦ä¹ é€šç”¨çš„ç‰¹å¾è¡¨ç¤ºï¼Œè€ŒFine-tuningæ˜¯åœ¨é¢„è®­ç»ƒæ¨¡å‹çš„åŸºç¡€ä¸Šï¼Œåœ¨ç‰¹å®šä»»åŠ¡çš„æœ‰æ ‡ç­¾æ•°æ®ä¸Šè¿›è¡Œè¿›ä¸€æ­¥ä¼˜åŒ–å’Œå¾®è°ƒFeature-based Pre-Trainingæä¾›äº†ä¸€ç§å­¦ä¹ é€šç”¨ç‰¹å¾è¡¨ç¤ºçš„æ–¹å¼ï¼Œè€ŒFine-tuningåˆ™å°†è¿™äº›é€šç”¨ç‰¹å¾åº”ç”¨äºç‰¹å®šä»»åŠ¡ï¼Œä»¥æå‡ä»»åŠ¡æ€§èƒ½ï¼Œä¸€å¥è¯æ¦‚æ‹¬ï¼šFeature-based Pre-TrainingæŠŠè¾“å…¥è½¬ç‰¹å¾ï¼Œç‰¹å¾ä¸¢ç»™åé¢çš„æ¨¡å‹(æ–°æ¨¡å‹)ï¼Œå…¶ä»–å°±å’Œå®ƒæ— å…³äº†Fine-tuningæ˜¯åŒä¸€ä¸ªç½‘ç»œç»“æ„ï¼Œæ¢äº†æ•°æ®ï¼Œå¯ä»¥å›ºå®šæˆ–ä¸å›ºå®šå‰å‡ å±‚ï¼Œç»§ç»­è®­ç»ƒè¯å‘é‡é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹çš„å‰ä¸–ä»Šç”Ÿ - ä»Word Embeddingåˆ°BERTå¹´ä»½2013 å¹´2014 å¹´2015 å¹´2016 å¹´2017 å¹´æŠ€æœ¯word2vecGloVeLSTM/AttentionSelf-AttentionTransformerå¹´ä»½2018 å¹´2019 å¹´2020 å¹´æŠ€æœ¯GPT/ELMo/BERT/GNNXLNet/BoBERTa/GPT-2/ERNIE/T5GPT-3/ELECTRA/ALBERTOne-hotç¼–ç ï¼šæ—©æœŸçš„è‡ªç„¶è¯­è¨€å¤„ç†ä¸­ï¼Œè¯è¯­é€šå¸¸è¢«è¡¨ç¤ºä¸ºç¦»æ•£çš„one-hotå‘é‡ã€‚æ¯ä¸ªè¯è¯­éƒ½è¢«è¡¨ç¤ºä¸ºä¸€ä¸ªç»´åº¦ç­‰äºè¯æ±‡è¡¨å¤§å°çš„å‘é‡ï¼Œå…¶ä¸­åªæœ‰ä¸€ä¸ªç»´åº¦ä¸º1ï¼Œå…¶ä½™ç»´åº¦éƒ½ä¸º0è¿™ç§è¡¨ç¤ºæ–¹æ³•æ— æ³•æ•æ‰è¯è¯­ä¹‹é—´çš„è¯­ä¹‰å…³ç³»å’Œç›¸ä¼¼åº¦Word Embeddingï¼šä¸ºäº†å…‹æœone-hotç¼–ç çš„å±€é™æ€§ï¼Œæå‡ºäº†åŸºäºåˆ†å¸ƒå‡è®¾çš„è¯å‘é‡è¡¨ç¤ºæ–¹æ³•ï¼Œå³Word Embeddingã€‚Word Embeddingä½¿ç”¨ä½ç»´å®æ•°å‘é‡è¡¨ç¤ºè¯è¯­ï¼Œé€šè¿‡è®­ç»ƒæ¨¡å‹å°†è¯è¯­æ˜ å°„åˆ°ä¸€ä¸ªè¿ç»­çš„å‘é‡ç©ºé—´ä¸­ã€‚å…¶ä¸­ï¼Œæ¯ä¸ªç»´åº¦ä»£è¡¨ä¸€ä¸ªè¯­ä¹‰ç‰¹å¾ã€‚Word Embeddingèƒ½å¤Ÿæ•æ‰åˆ°è¯è¯­ä¹‹é—´çš„è¯­ä¹‰å…³ç³»å’Œç›¸ä¼¼åº¦ï¼Œæä¾›æ›´ä¸°å¯Œçš„è¡¨ç¤ºWord2Vec(é™æ€)ï¼šWord2Vecæ˜¯ä¸€ç§ç»å…¸çš„è¯å‘é‡æ¨¡å‹ï¼Œç”±Tomas Mikolovç­‰äººäº2013å¹´æå‡ºã€‚å®ƒåŸºäºç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œé€šè¿‡è®­ç»ƒé¢„æµ‹è¯è¯­å‘¨å›´çš„ä¸Šä¸‹æ–‡æˆ–é¢„æµ‹ç›®æ ‡è¯è¯­ã€‚Word2Vecæ¨¡å‹åŒ…æ‹¬ä¸¤ç§ç®—æ³•ï¼šCBOW(Continuous Bag-of-Words)å’ŒSkip-gram`ã€‚è¿™ä¸¤ç§ç®—æ³•ä½¿ç”¨æµ…å±‚çš„ç¥ç»ç½‘ç»œæ¥å­¦ä¹ è¯å‘é‡ï¼Œå…·æœ‰é«˜æ•ˆã€å¿«é€Ÿè®­ç»ƒçš„ä¼˜åŠ¿ã€‚Word2Vecæ¨¡å‹èƒ½å¤Ÿç”Ÿæˆé™æ€çš„è¯å‘é‡ï¼Œä½†æ— æ³•æ•æ‰è¯è¯­çš„ä¸Šä¸‹æ–‡ç›¸å…³ç‰¹å¾ELMo(Embeddings from Language Models)(åŠ¨æ€)ï¼šELMoæ˜¯åœ¨Word2Vecä¹‹åæå‡ºçš„ä¸€ç§ä¸Šä¸‹æ–‡ç›¸å…³çš„è¯å‘é‡è¡¨ç¤ºæ–¹æ³•ï¼Œç”±Petersç­‰äººäº2018å¹´æå‡ºã€‚ELMoåˆ©ç”¨åŒå‘è¯­è¨€æ¨¡å‹ï¼Œé€šè¿‡è®­ç»ƒæ­£å‘å’Œé€†å‘çš„LSTMæ¨¡å‹æ¥å­¦ä¹ è¯è¯­çš„ä¸Šä¸‹æ–‡è¡¨ç¤ºã€‚ELMoèƒ½å¤Ÿæ ¹æ®ä¸Šä¸‹æ–‡åŠ¨æ€åœ°ç”Ÿæˆè¯å‘é‡ï¼Œæ•æ‰åˆ°è¯è¯­åœ¨ä¸åŒä¸Šä¸‹æ–‡ä¸­çš„è¯­ä¹‰ç‰¹å¾ã€‚ä¸é™æ€è¯å‘é‡ä¸åŒï¼ŒELMoæä¾›äº†æ›´ä¸°å¯Œã€æ›´å…·è¯­ä¹‰çš„è¯è¯­è¡¨ç¤ºï¼Œé€‚ç”¨äºå„ç§è‡ªç„¶è¯­è¨€å¤„ç†ä»»åŠ¡ELMo(Embeddings from Language Models)æ¨¡å‹åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä½¿ç”¨äº†åŒå‘é•¿çŸ­æœŸè®°å¿†ç½‘ç»œï¼ˆBi-LSTMï¼‰æ€»çš„æ¥è¯´ï¼Œå†å²å‘å±•ä¸­ï¼Œä»one-hotç¼–ç åˆ°Word Embeddingï¼Œå†åˆ°Word2Vecå’ŒELMoï¼Œè¯å‘é‡è¡¨ç¤ºæ–¹æ³•é€æ¸ä»ç¦»æ•£ã€é™æ€çš„è¡¨ç¤ºå‘å±•åˆ°äº†è¿ç»­ã€ä¸Šä¸‹æ–‡ç›¸å…³çš„è¡¨ç¤ºã€‚è¿™äº›æ–¹æ³•çš„æå‡ºå’Œå‘å±•ä½¿å¾—è‡ªç„¶è¯­è¨€å¤„ç†æ¨¡å‹èƒ½å¤Ÿæ›´å¥½åœ°ç†è§£å’Œå¤„ç†æ–‡æœ¬æ•°æ®ï¼Œæé«˜äº†å„ç§æ–‡æœ¬ç›¸å…³ä»»åŠ¡çš„æ€§èƒ½Word Embeddingã€Word2Vecå’ŒELMoå…³ç³»å¦‚ä¸‹ï¼šWord2Vecæ˜¯Word Embeddingçš„ä¸€ç§å…·ä½“å®ç°æ–¹å¼ã€‚Word EmbeddingæŒ‡çš„æ˜¯å°†è¯è¯­æ˜ å°„åˆ°ä½ç»´å®æ•°å‘é‡ç©ºé—´çš„è¡¨ç¤ºæ–¹æ³•ï¼Œè€ŒWord2Vecåˆ™æ˜¯ä¸€ç§ç”¨äºè®­ç»ƒWord Embeddingçš„ç®—æ³•ELMoå’ŒWord2Vecæ˜¯ä¸¤ç§ä¸åŒçš„è¯å‘é‡è¡¨ç¤ºæ–¹æ³•ã€‚ELMoæ˜¯ä¸€ç§ä¸Šä¸‹æ–‡ç›¸å…³çš„è¯å‘é‡è¡¨ç¤ºæ–¹æ³•ï¼Œé€šè¿‡è®­ç»ƒåŒå‘è¯­è¨€æ¨¡å‹æ¥å­¦ä¹ è¯è¯­åœ¨ä¸åŒä¸Šä¸‹æ–‡ä¸­çš„åŠ¨æ€è¡¨ç¤ºã€‚è€ŒWord2Vecæ˜¯ä¸€ç§ä¸Šä¸‹æ–‡æ— å…³çš„è¯å‘é‡è¡¨ç¤ºæ–¹æ³•ï¼Œé€šè¿‡è®­ç»ƒé¢„æµ‹è¯è¯­çš„ä¸Šä¸‹æ–‡æˆ–ç›®æ ‡è¯è¯­æ¥å­¦ä¹ é™æ€çš„è¯å‘é‡æ¨¡å‹ä»‹ç»ä»‹ç»Transformeræ¯”è¾ƒå¥½çš„æ–‡ç« ä¸€ä¸ªæ˜¯Jay Alammarå¯è§†åŒ–åœ°ä»‹ç»Transformerçš„åšå®¢æ–‡ç« The Illustrated Transformerï¼Œéå¸¸å®¹æ˜“ç†è§£æ•´ä¸ªæœºåˆ¶å“ˆä½›å¤§å­¦NLPç ”ç©¶ç»„å†™çš„The Annotated Transformerï¼Œä»£ç åŸç†åŒç®¡é½ä¸‹Attentionæœºåˆ¶Attentionæœºåˆ¶æœ€æ—©åœ¨è§†è§‰é¢†åŸŸæå‡ºï¼Œ2014å¹´Google Mindå‘è¡¨äº†ã€ŠRecurrent Models of Visual Attentionã€‹ï¼Œä½¿Attentionæœºåˆ¶æµè¡Œèµ·æ¥ï¼Œè¿™ç¯‡è®ºæ–‡é‡‡ç”¨äº†RNNæ¨¡å‹ï¼Œå¹¶åŠ å…¥äº†Attentionæœºåˆ¶æ¥è¿›è¡Œå›¾åƒçš„åˆ†ç±»2005å¹´ï¼ŒBahdanauç­‰äººåœ¨è®ºæ–‡ã€ŠNeural Machine Translation by Jointly Learning to Align and Translateã€‹ä¸­ï¼Œå°†attentionæœºåˆ¶é¦–æ¬¡åº”ç”¨åœ¨nlpé¢†åŸŸï¼Œå…¶é‡‡ç”¨Seq2Seq+Attentionæ¨¡å‹æ¥è¿›è¡Œæœºå™¨ç¿»è¯‘ï¼Œå¹¶ä¸”å¾—åˆ°äº†æ•ˆæœçš„æå‡ï¼ŒSeq2Seq With Attentionä¸­è¿›è¡Œäº†ä»‹ç»2017 å¹´ï¼ŒGoogle æœºå™¨ç¿»è¯‘å›¢é˜Ÿå‘è¡¨çš„ã€ŠAttention is All You Needã€‹ä¸­ï¼Œå®Œå…¨æŠ›å¼ƒäº†RNNå’ŒCNNç­‰ç½‘ç»œç»“æ„ï¼Œè€Œä»…ä»…é‡‡ç”¨è‡ªæ³¨æ„åŠ›(self-attention)æœºåˆ¶æ¥å­¦ä¹ æ–‡æœ¬è¡¨ç¤ºæ¥è¿›è¡Œæœºå™¨ç¿»è¯‘ä»»åŠ¡ï¼Œå¹¶ä¸”å–å¾—äº†å¾ˆå¥½çš„æ•ˆæœï¼Œæ³¨æ„åŠ›æœºåˆ¶ä¹Ÿæˆä¸ºäº†å¤§å®¶è¿‘æœŸçš„ç ”ç©¶çƒ­ç‚¹æœ¬æ–‡é¦–å…ˆä»‹ç»å¸¸è§çš„Attentionæœºåˆ¶ï¼Œç„¶åå¯¹è®ºæ–‡ã€ŠAttention is All You Needã€‹è¿›è¡Œä»‹ç»ï¼Œè¯¥è®ºæ–‡å‘è¡¨åœ¨NIPS 2017ä¸ŠArchitectureæ¨¡å‹ç»“æ„å¦‚ä¸‹è¾“å…¥å±‚è¯åµŒå…¥ç¼–ç å±‚ä½ç½®ç¼–ç å±‚Encoderå¤šå¤´è‡ªæ³¨æ„åŠ›æ®‹å·®è¿æ¥å…¨è¿æ¥ç½‘ç»œDncoderå¤šå¤´è‡ªæ³¨æ„åŠ›å¤šå¤´æ³¨æ„åŠ›(ä¸æ˜¯è‡ªæ³¨æ„, å› ä¸ºQKæ¥è‡ªEncoder)æ®‹å·®è¿æ¥å…¨è¿æ¥ç½‘ç»œæ¨¡å‹æ•´ä½“ç»“æ„å¦‚ä¸‹æ‰€ç¤ºTransformeræ˜¯ä¸€ç§åŸºäºè‡ªæ³¨æ„åŠ›æœºåˆ¶çš„åºåˆ—åˆ°åºåˆ—æ¨¡å‹ï¼Œå¹¿æ³›åº”ç”¨äºè‡ªç„¶è¯­è¨€å¤„ç†ä»»åŠ¡ï¼Œå¦‚æœºå™¨ç¿»è¯‘ã€æ–‡æœ¬æ‘˜è¦å’Œè¯­è¨€ç”Ÿæˆç­‰Transformeræ•´ä½“ç»“æ„ç”±ä»¥ä¸‹å‡ ä¸ªä¸»è¦ç»„ä»¶ç»„æˆï¼šç¼–ç å™¨ï¼ˆEncoderï¼‰ï¼šç¼–ç å™¨è´Ÿè´£å°†è¾“å…¥åºåˆ—ï¼ˆä¾‹å¦‚æºè¯­è¨€å¥å­ï¼‰è½¬æ¢ä¸ºä¸€ç³»åˆ—é«˜çº§ç‰¹å¾è¡¨ç¤ºã€‚å®ƒç”±å¤šä¸ªç›¸åŒçš„å±‚å †å è€Œæˆï¼Œæ¯ä¸ªå±‚éƒ½åŒ…å«ä¸¤ä¸ªå­å±‚ï¼šå¤šå¤´è‡ªæ³¨æ„åŠ›æœºåˆ¶å’Œå…¨è¿æ¥å‰é¦ˆç¥ç»ç½‘ç»œã€‚è‡ªæ³¨æ„åŠ›æœºåˆ¶å…è®¸æ¨¡å‹å¯¹è¾“å…¥åºåˆ—ä¸­çš„ä¸åŒä½ç½®è¿›è¡Œè‡ªé€‚åº”åœ°å…³æ³¨ï¼Œä»è€Œæ•æ‰åºåˆ—ä¸­çš„ä¸Šä¸‹æ–‡ä¿¡æ¯è§£ç å™¨ï¼ˆDecoderï¼‰ï¼šè§£ç å™¨è´Ÿè´£ä»ç¼–ç å™¨ç”Ÿæˆçš„ç‰¹å¾è¡¨ç¤ºä¸­ç”Ÿæˆç›®æ ‡åºåˆ—ï¼ˆä¾‹å¦‚ç›®æ ‡è¯­è¨€å¥å­ï¼‰ã€‚è§£ç å™¨ä¹Ÿç”±å¤šä¸ªç›¸åŒçš„å±‚å †å è€Œæˆï¼Œæ¯ä¸ªå±‚åŒ…å«ä¸‰ä¸ªå­å±‚ï¼šå¤šå¤´è‡ªæ³¨æ„åŠ›æœºåˆ¶ã€ç¼–ç å™¨-è§£ç å™¨æ³¨æ„åŠ›æœºåˆ¶å’Œå…¨è¿æ¥å‰é¦ˆç¥ç»ç½‘ç»œã€‚ç¼–ç å™¨-è§£ç å™¨æ³¨æ„åŠ›æœºåˆ¶ç”¨äºåœ¨ç”Ÿæˆç›®æ ‡åºåˆ—æ—¶ï¼Œå¼•å…¥å¯¹æºè¯­è¨€å¥å­çš„å…³æ³¨è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼ˆSelf-Attentionï¼‰ï¼šè‡ªæ³¨æ„åŠ›æœºåˆ¶æ˜¯Transformerçš„å…³é”®ç»„ä»¶ä¹‹ä¸€ã€‚å®ƒå…è®¸æ¨¡å‹åœ¨è¿›è¡Œç¼–ç æˆ–è§£ç æ—¶ï¼Œæ ¹æ®è¾“å…¥åºåˆ—ä¸­ä¸åŒä½ç½®ä¹‹é—´çš„å…³ç³»ï¼ŒåŠ¨æ€åœ°è®¡ç®—æ³¨æ„åŠ›æƒé‡ã€‚é€šè¿‡è‡ªé€‚åº”åœ°å…³æ³¨ä¸åŒä½ç½®çš„ä¿¡æ¯ï¼Œè‡ªæ³¨æ„åŠ›æœºåˆ¶èƒ½å¤Ÿæ•æ‰è¾“å…¥åºåˆ—ä¸­çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œæä¾›æ›´å…¨é¢çš„è¡¨ç¤ºæ³¨æ„åŠ›æœºåˆ¶ï¼ˆAttentionï¼‰ï¼šé™¤äº†è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼ŒTransformerè¿˜ä½¿ç”¨ç¼–ç å™¨-è§£ç å™¨æ³¨æ„åŠ›æœºåˆ¶ã€‚è¿™ç§æ³¨æ„åŠ›æœºåˆ¶å…è®¸è§£ç å™¨åœ¨ç”Ÿæˆç›®æ ‡åºåˆ—æ—¶ï¼Œå¯¹ç¼–ç å™¨è¾“å‡ºçš„ç‰¹å¾è¡¨ç¤ºè¿›è¡Œå…³æ³¨ã€‚å®ƒèƒ½å¤Ÿå¸®åŠ©è§£ç å™¨å¯¹æºè¯­è¨€å¥å­ä¸­ä¸å½“å‰ç”Ÿæˆä½ç½®ç›¸å…³çš„ä¿¡æ¯è¿›è¡Œå¤„ç†å‰é¦ˆç¥ç»ç½‘ç»œï¼ˆFeed-Forward Networkï¼‰ï¼šTransformerä¸­çš„æ¯ä¸ªå­å±‚éƒ½åŒ…å«ä¸€ä¸ªå‰é¦ˆç¥ç»ç½‘ç»œã€‚è¯¥ç½‘ç»œç”±ä¸¤ä¸ªå…¨è¿æ¥å±‚ç»„æˆï¼Œé€šè¿‡åº”ç”¨éçº¿æ€§æ¿€æ´»å‡½æ•°ï¼ˆå¦‚ReLUï¼‰æ¥å¯¹ç‰¹å¾è¡¨ç¤ºè¿›è¡Œæ˜ å°„å’Œå˜æ¢ã€‚å‰é¦ˆç¥ç»ç½‘ç»œæœ‰åŠ©äºæ•æ‰ç‰¹å¾ä¹‹é—´çš„éçº¿æ€§å…³ç³»é€šè¿‡ç¼–ç å™¨å’Œè§£ç å™¨çš„ç»„åˆï¼ŒTransformeræ¨¡å‹èƒ½å¤Ÿå°†è¾“å…¥åºåˆ—è½¬æ¢ä¸ºè¾“å‡ºåºåˆ—ï¼Œå®ç°ä¸åŒçš„åºåˆ—åˆ°åºåˆ—ä»»åŠ¡å®ƒçš„å¹¶è¡Œè®¡ç®—æ€§è´¨å’Œè‡ªæ³¨æ„åŠ›æœºåˆ¶çš„èƒ½åŠ›ä½¿å¾—å®ƒåœ¨å¤„ç†é•¿åºåˆ—å’Œæ•æ‰å…¨å±€ä¾èµ–å…³ç³»æ–¹é¢å…·æœ‰ä¼˜åŠ¿ï¼Œæˆä¸ºè‡ªç„¶è¯­è¨€å¤„ç†é¢†åŸŸçš„é‡è¦æ¨¡å‹ï¼Œæ›´è¯¦ç»†çš„æ¨¡å‹ç»“æ„å¦‚ä¸‹æ‰€ç¤ºEmbeddingEmbeddingå±‚æ˜¯Transformeræ¨¡å‹ä¸­çš„ä¸€ä¸ªé‡è¦ç»„æˆéƒ¨åˆ†ï¼Œç”¨äºå°†ç¦»æ•£çš„è¾“å…¥åºåˆ—ï¼ˆå¦‚å•è¯ã€å­—ç¬¦ç­‰ï¼‰æ˜ å°„åˆ°è¿ç»­çš„ä½ç»´å‘é‡è¡¨ç¤ºå®ƒè´Ÿè´£å°†è¾“å…¥çš„ç¬¦å·å‹æ•°æ®è½¬æ¢ä¸ºå¯†é›†çš„å®æ•°å‘é‡ï¼Œä»è€Œèƒ½å¤Ÿåœ¨æ¨¡å‹ä¸­è¿›è¡Œæœ‰æ•ˆçš„å­¦ä¹ å’Œå¤„ç†åœ¨Transformerä¸­ï¼ŒEmbeddingå±‚ä¸»è¦æœ‰ä¸¤ä¸ªä½œç”¨ï¼šè¯åµŒå…¥ï¼ˆWord Embeddingï¼‰ï¼šå¯¹äºè‡ªç„¶è¯­è¨€å¤„ç†ä»»åŠ¡ï¼ŒEmbeddingå±‚å°†æ¯ä¸ªè¯æ±‡æˆ–å­—ç¬¦æ˜ å°„åˆ°ä¸€ä¸ªä½ç»´çš„è¿ç»­å‘é‡è¡¨ç¤ºï¼Œç§°ä¸ºè¯åµŒå…¥æˆ–å­—ç¬¦åµŒå…¥ã€‚è¿™äº›åµŒå…¥å‘é‡æ•æ‰äº†è¯æ±‡æˆ–å­—ç¬¦ä¹‹é—´çš„è¯­ä¹‰å’Œè¯­æ³•å…³ç³»ï¼Œèƒ½å¤Ÿç¼–ç å•è¯çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œä½¿å¾—æ¨¡å‹èƒ½å¤Ÿæ›´å¥½åœ°ç†è§£å’Œè¡¨ç¤ºè¾“å…¥æ•°æ®ä½ç½®ç¼–ç ï¼ˆPositional Encodingï¼‰ï¼šTransformeræ¨¡å‹ä¸­æ²¡æœ‰ä½¿ç”¨å¾ªç¯ç¥ç»ç½‘ç»œæˆ–å·ç§¯ç¥ç»ç½‘ç»œï¼Œå› æ­¤æ— æ³•ç›´æ¥æ•æ‰è¾“å…¥åºåˆ—ä¸­é¡ºåºä¿¡æ¯ã€‚ä¸ºäº†å¼•å…¥ä½ç½®ä¿¡æ¯ï¼ŒEmbeddingå±‚ä¼šæ·»åŠ ä½ç½®ç¼–ç åˆ°è¯åµŒå…¥ä¸­ã€‚ä½ç½®ç¼–ç æ˜¯ä¸€ç§ç”¨äºè¡¨ç¤ºè¾“å…¥åºåˆ—ä½ç½®çš„å‘é‡ï¼Œå®ƒæä¾›äº†å…³äºè¯æ±‡åœ¨åºåˆ—ä¸­ç›¸å¯¹ä½ç½®çš„ä¿¡æ¯ï¼Œå¸®åŠ©æ¨¡å‹ç†è§£åºåˆ—ä¸­çš„é¡ºåºå…³ç³»åœ¨å®ç°ä¸Šï¼ŒEmbeddingå±‚å¯ä»¥ä½¿ç”¨ä¸€ä¸ªçŸ©é˜µä½œä¸ºå‚æ•°æ¥è¿›è¡Œè¯åµŒå…¥çš„æŸ¥æ‰¾ã€‚æ¯ä¸ªè¯æ±‡å¯¹åº”çŸ©é˜µä¸­çš„ä¸€è¡Œï¼Œé€šè¿‡æŸ¥æ‰¾è¾“å…¥åºåˆ—ä¸­çš„è¯æ±‡å¯¹åº”çš„è¡Œå‘é‡ï¼Œå¾—åˆ°è¯åµŒå…¥è¡¨ç¤ºä½ç½®ç¼–ç é€šå¸¸ä½¿ç”¨æ­£å¼¦å’Œä½™å¼¦å‡½æ•°çš„ç»„åˆæ¥è®¡ç®—ï¼Œä»¥è·å–ä¸åŒä½ç½®çš„ç¼–ç å‘é‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒEmbeddingå±‚çš„å‚æ•°é€šå¸¸æ˜¯åœ¨æ¨¡å‹è®­ç»ƒçš„è¿‡ç¨‹ä¸­å­¦ä¹ å¾—åˆ°çš„ï¼Œæ ¹æ®ä»»åŠ¡å’Œæ•°æ®æ¥è°ƒæ•´åµŒå…¥å‘é‡çš„è¡¨ç¤ºèƒ½åŠ›ã€‚é€šè¿‡Embeddingå±‚ï¼Œæ¨¡å‹èƒ½å¤Ÿåœ¨ä½ç»´è¿ç»­å‘é‡ç©ºé—´ä¸­å¯¹è¾“å…¥åºåˆ—è¿›è¡Œè¡¨å¾å’Œå»ºæ¨¡ï¼Œä»è€Œæ›´å¥½åœ°å¤„ç†è‡ªç„¶è¯­è¨€å¤„ç†ç­‰ä»»åŠ¡å¯¼å…¥åº“123456789101112131415161718#!/usr/bin/env Python# -- coding: utf-8 --&quot;&quot;&quot;@version: v1.0@author: huangyc@file: embedding.py@Description: @time: 2023/2/19 15:00&quot;&quot;&quot;import torchimport torch.nn as nnimport torch.nn.functional as Ffrom torch.autograd import Variableimport mathimport matplotlib.pyplot as pltimport numpy as npimport copyEmbeddingå±‚å®šä¹‰1234567891011121314class Embeddings(nn.Module):    def __init__(self, d_model: int, vocab: int):        &quot;&quot;&quot;        æ„å»ºEmbeddingç±»æ¥å®ç°æ–‡æœ¬åµŒå…¥å±‚        :param d_model: è¯åµŒå…¥çš„ç»´åº¦        :param vocab: è¯è¡¨çš„å¤§å°        &quot;&quot;&quot;        super(Embeddings, self).__init__()        # å®šä¹‰Embeddingå±‚        self.lut = nn.Embedding(vocab, d_model)        self.d_model = d_model    def forward(self, x):        return self.lut(x) * math.sqrt(self.d_model)PositionalEncodingå±‚12345678910111213141516171819202122232425262728293031323334353637383940414243444546# å®šä¹‰ä½ç½®ç¼–ç å™¨ç±», æˆ‘ä»¬åŒæ ·æŠŠå®ƒçœ‹åšä¸€ä¸ªå±‚,å› æ­¤ä¼šç»§æ‰¿nn.Moduleclass PositionalEncoding(nn.Module):    def __init__(self, d_model: int, dropout: float, max_len: int = 5000):        &quot;&quot;&quot;        ä½ç½®ç¼–ç å™¨ç±»çš„åˆå§‹åŒ–å‡½æ•°, å…±æœ‰ä¸‰ä¸ªå‚æ•°        :param d_model: è¯åµŒå…¥ç»´åº¦        :param dropout: ç½®0æ¯”ç‡        :param max_len: æ¯ä¸ªå¥å­çš„æœ€å¤§é•¿åº¦        :return:        &quot;&quot;&quot;        super(PositionalEncoding, self).__init__()        # å®ä¾‹åŒ–nnä¸­é¢„å®šä¹‰çš„Dropoutå±‚, å¹¶å°†dropoutä¼ å…¥å…¶ä¸­,è·å¾—å¯¹è±¡self.dropout        self.dropout = nn.Dropout(p=dropout)        # åˆå§‹åŒ–ä¸€ä¸ªä½ç½®ç¼–ç çŸ©é˜µ,å®ƒæ˜¯ä¸€ä¸ª0é˜µ, çŸ©é˜µçš„å¤§å°æ˜¯max_len * d_model        pe = torch.zeros(max_len, d_model)        # åˆå§‹åŒ–ä¸€ä¸ªç»å¯¹ä½ç½®çŸ©é˜µ, åœ¨æˆ‘ä»¬è¿™é‡Œ, è¯æ±‡çš„ç»å¯¹ä½ç½®å°±æ˜¯ç”¨å®ƒçš„ç´¢å¼•å»è¡¨ç¤º        # æ‰€ä»¥æˆ‘ä»¬é¦–å…ˆä½¿ç”¨arangeæ–¹æ³•è·å¾—ä¸€ä¸ªè¿ç»­è‡ªç„¶æ•°å‘é‡, ç„¶åå†ä½¿ç”¨unsqueezeæ–¹æ³•æ‹“å±•å‘é‡ç»´åº¦        # #åˆå› ä¸ºå‚æ•°ä¼ çš„æ˜¯1, ä»£è¡¨çŸ©é˜µæ‹“å±•çš„ä½ç½®, ä¼šä½¿å‘é‡å˜æˆä¸€ä¸ªmax_len * 1çš„çŸ©é˜µ        position = torch.arange(0, max_len).unsqueeze(1)        # ç»å¯¹ä½ç½®çŸ©é˜µåˆå§‹åŒ–ä¹‹å, æ¥ä¸‹æ¥å°±æ˜¯è€ƒè™‘å¦‚ä½•å°†è¿™äº›ä½ç½®ä¿¡æ¯åŠ å…¥åˆ°ä½ç½®ç¼–ç çŸ©é˜µä¸­        # æœ€ç®€å•æ€è·¯å°±æ˜¯å…ˆå°†max_len * 1çš„ç»å¯¹ä½ç½®çŸ©é˜µ, å˜æ¢æˆmax_len * d_modelå½¢çŠ¶, ç„¶åè¦†ç›–åŸæ¥çš„åˆå§‹ä½ç½®ç¼–ç çŸ©é˜µå³å¯        # è¦åšè¿™ç§çŸ©é˜µå˜æ¢, å°±éœ€è¦ä¸€ä¸ª1 * d_modelå½¢çŠ¶çš„å˜æ¢çŸ©é˜µdiv_term, æˆ‘ä»¬å¯¹è¿™ä¸ªå˜æ¢çŸ©é˜µçš„è¦æ±‚é™¤äº†å½¢çŠ¶å¤–        # è¿˜å¸Œæœ›å®ƒèƒ½å¤Ÿå°†è‡ªç„¶æ•°çš„ç»å¯¹ä½ç½®ç¼–ç ç¼©æ”¾æˆè¶³å¤Ÿå°çš„æ•°å­—, æœ‰åŠ©äºåœ¨ä¹‹åçš„æ¢¯åº¦ä¸‹é™è¿‡ç¨‹ä¸­æ›´å¿«çš„æ”¶æ•›        # é¦–å…ˆä½¿ç”¨arangeè·å¾—ä¸€ä¸ªè‡ªç„¶æ•°çŸ©é˜µ, ä½†æ˜¯ç»†å¿ƒçš„åŒå­¦ä»¬ä¼šå‘ç°, æˆ‘ä»¬è¿™é‡Œå¹¶æ²¡æœ‰æŒ‰ç…§é¢„è®¡çš„ä¸€æ ·åˆå§‹åŒ–ä¸€ä¸ª1 * d_modelçš„çŸ©é˜µ        # è€Œæ˜¯æœ‰äº†ä¸€ä¸ªè·³è·ƒï¼Œåªåˆå§‹åŒ–äº†ä¸€åŠå³1*d_mode1/2çš„çŸ©é˜µ. ä¸ºä»€ä¹ˆæ˜¯ä¸€åŠå‘¢, å…¶å®è¿™é‡Œå¹¶ä¸æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„åˆå§‹åŒ–        # æˆ‘ä»¬å¯ä»¥æŠŠå®ƒçœ‹ä½œæ˜¯åˆå§‹åŒ–äº†ä¸¤æ¬¡, è€Œæ¯æ¬¡åˆå§‹åŒ–çš„å˜æ¢çŸ©é˜µä¼šåšä¸åŒçš„å¤„ç†, ç¬¬ä¸€æ¬¡åˆå§‹åŒ–çš„å˜æ¢çŸ©é˜µåˆ†å¸ƒåœ¨æ­£å¼¦æ³¢ä¸Š, ç¬¬äºŒæ¬¡åˆå§‹åŒ–çš„å˜æ¢çŸ©é˜µåˆ†å¸ƒåœ¨ä½™å¼¦æ³¢ä¸Š        # å¹¶æŠŠè¿™ä¸¤ä¸ªçŸ©é˜µåˆ†åˆ«å¡«å……åœ¨ä½ç½®ç¼–ç çŸ©é˜µçš„å¶æ•°å’Œå¥‡æ•°ä½ç½®ä¸Š, ç»„æˆæœ€ç»ˆçš„ä½ç½®ç¼–ç çŸ©é˜µ        div_term = torch.exp(torch.arange(0, d_model, 2) * -(math.log(10000.) / d_model))        pe[:, 0::2] = torch.sin(position * div_term)        pe[:, 1::2] = torch.cos(position * div_term)        # è¿™æ ·æˆ‘ä»¬å°±å¾—åˆ°äº†ä½ç½®ç¼–ç çŸ©é˜µpe, peç°åœ¨è¿˜æ˜¯ä¸ªäºŒç»´çŸ©é˜µï¼Œè¦æƒ³å’Œembeddingçš„è¾“å‡º(ä¸€ä¸ªä¸‰ç»´å¼ é‡)ç›¸åŠ , éœ€è¦æ‰©å±•ç»´åº¦        pe = pe.unsqueeze(0)        # æˆ‘ä»¬æŠŠå®ƒè®¤ä¸ºæ˜¯å¯¹æ¨¡å‹æ•ˆæœæœ‰å¸®åŠ©çš„, ä½†æ˜¯å´ä¸æ˜¯æ¨¡å‹ç»“æ„ä¸­è¶…å‚æ•°æˆ–è€…å‚æ•°,ä¸éœ€è¦éšç€ä¼˜åŒ–æ­¥éª¤ä¼˜åŒ–        # æ³¨å†Œä¹‹åæˆ‘ä»¬å°±å¯ä»¥åœ¨æ¨¡å‹ä¿å­˜åé‡åŠ è½½æ—¶å’Œæ¨¡å‹ç»“æ„ä¸å‚æ•°ä¸€åŒè¢«åŠ è½½        self.register_buffer('pe', pe)    def forward(self, x):        &quot;&quot;&quot;        :param x: æ–‡æœ¬åºåˆ—çš„è¯åµŒå…¥è¡¨ç¤º        &quot;&quot;&quot;        # æ ¹æ®å¥å­æœ€å¤§é•¿åº¦åˆ‡å‰², peä¸éœ€è¦åšæ¢¯åº¦æ±‚è§£        x = x + Variable(self.pe[:, :x.size(1)], requires_grad=False)        return self.dropout(x)å®é™…æµ‹è¯• + ä½ç½®ç¼–ç å¯è§†åŒ–1234567891011121314151617181920212223242526272829303132if __name__ == '__main__':    p_d_model = 512    p_vocab = 1000    p_dropout: float = 0.1    p_max_len = 60    # è¯åµŒå…¥æµ‹è¯•    x = Variable(torch.LongTensor([[100, 2, 421, 508], [491, 998, 1, 221]]))    emb = Embeddings(d_model=p_d_model, vocab=p_vocab)    embr = emb(x)    print(&quot;embr&quot;, embr)    print(&quot;embr size&quot;, embr.shape)    # ä½ç½®ç¼–ç æµ‹è¯•    pe = PositionalEncoding(d_model=p_d_model, dropout=p_dropout, max_len=p_max_len)    pe_result = pe(embr)    print(&quot;pe_result&quot;, pe_result)    print(&quot;pe_result size&quot;, pe_result.shape)    # åˆ›å»ºä¸€å¼ 15x5å¤§å°çš„ç”»å¸ƒ    plt.figure(figsize=(15, 5))    # å®ä¾‹åŒ–PositionalEncodingç±»å¾—åˆ°peå¯¹è±¡, è¾“å…¥å‚æ•°æ˜¯20å’Œ0    pe = PositionalEncoding(20, 0)    # ç„¶åå‘peä¼ å…¥è¢«Variableå°è£…çš„tensor, è¿™æ ·peä¼šç›´æ¥æ‰§è¡Œforwardå‡½æ•°,    # ä¸”è¿™ä¸ªtensoré‡Œçš„æ•°å€¼éƒ½æ˜¯0, è¢«å¤„ç†åç›¸å½“äºä½ç½®ç¼–ç å¼ é‡    y = pe(Variable(torch.zeros(1, 100, 20)))    # ç„¶åå®šä¹‰ç”»å¸ƒçš„æ¨ªçºµåæ ‡, æ¨ªåæ ‡åˆ°100çš„é•¿åº¦, çºµåæ ‡æ˜¯æŸä¸€ä¸ªè¯æ±‡ä¸­çš„æŸç»´ç‰¹å¾åœ¨ä¸åŒé•¿åº¦ä¸‹å¯¹åº”çš„å€¼    # å› ä¸ºæ€»å…±æœ‰20ç»´ä¹‹å¤š, æˆ‘ä»¬è¿™é‡ŒåªæŸ¥çœ‹4,5,6,7ç»´çš„å€¼    plt.plot(np.arange(100), y[0, :, 4:8].data.numpy())    # åœ¨ç”»å¸ƒä¸Šå¡«å†™ç»´åº¦æç¤ºä¿¡æ¯    plt.legend([&quot;dim %d&quot; % p for p in [4, 5, 6, 7]])    plt.show()1234567891011121314151617181920212223embr tensor([[[-17.5113,  -6.0699,  11.6839,  ...,  -8.1281,  -7.7986,  35.1275],         [ -6.3789,  -7.7614,  13.2975,  ...,  16.8397, -31.3230, -68.4385],         [ -4.1841,   8.4322,  34.6418,  ...,  38.4747,  -4.9060,  25.4163],         [-23.4562, -28.9742,  18.1234,  ...,  38.6039,  15.0049,  -2.8916]],        [[-21.7485,   0.3263,  54.4449,  ..., -18.3120, -15.5987, -11.4275],         [ -0.6414,   2.9492, -32.3063,  ..., -21.9781, -16.3307, -15.4014],         [-16.1775,  20.8547, -21.0333,  ..., -11.7583,  -7.2429,   5.8607],         [ -4.7708, -51.9955,  14.8529,  ...,  21.0973,  13.4664, -10.8492]]],       grad_fn=&lt;MulBackward0&gt;)embr size torch.Size([2, 4, 512])pe_result tensor([[[-19.4569,  -5.6332,  12.9821,  ...,  -7.9201,  -0.0000,   0.0000],         [ -6.1526,  -8.0235,  15.6882,  ...,  19.8219, -34.8032, -74.9317],         [ -3.6387,   8.9068,  39.5314,  ...,  43.8608,  -5.4509,  29.3514],         [-25.9057, -33.2935,  20.4094,  ...,  44.0043,  16.6725,  -2.1017]],        [[-24.1650,   1.4736,   0.0000,  ..., -19.2356, -17.3319, -11.5861],         [  0.2223,   3.8772, -34.9827,  ..., -23.3090, -18.1452, -16.0015],         [-16.9647,  22.7095, -22.3299,  ..., -11.9537,  -8.0475,   7.6230],         [ -0.0000, -58.8727,   0.0000,  ...,  24.5526,  14.9630,  -0.0000]]],       grad_fn=&lt;MulBackward0&gt;)pe_result size torch.Size([2, 4, 512])Attentionè¶…è¯¦ç»†å›¾è§£Self-Attentionçš„é‚£äº›äº‹å„¿é™¤äº†Scaled Dot-Product Attentionï¼ŒTransformeræ¨¡å‹ä¸­è¿˜æœ‰å‡ ç§å¸¸è§çš„æ³¨æ„åŠ›æœºåˆ¶ç‚¹ç§¯æ³¨æ„åŠ›(Dot-Product Attention)ï¼šå®ƒæ˜¯Scaled Dot-Product Attentionçš„ç®€åŒ–ç‰ˆæœ¬ï¼Œç›´æ¥è®¡ç®—æŸ¥è¯¢ï¼ˆQï¼‰å’Œé”®ï¼ˆKï¼‰ä¹‹é—´çš„ç‚¹ç§¯ï¼Œç„¶åé€šè¿‡softmaxå‡½æ•°å°†ç»“æœè½¬åŒ–ä¸ºæ³¨æ„åŠ›æƒé‡ã€‚ç‚¹ç§¯æ³¨æ„åŠ›ç›¸æ¯”äºScaled Dot-Product Attentionæ²¡æœ‰è¿›è¡Œç¼©æ”¾æ“ä½œåŠ æ€§æ³¨æ„åŠ›(Additive Attention)ï¼šåŠ æ€§æ³¨æ„åŠ›ä½¿ç”¨äº†ä¸€ä¸ªé¢å¤–çš„å‰é¦ˆç¥ç»ç½‘ç»œæ¥è®¡ç®—æ³¨æ„åŠ›æƒé‡ã€‚å®ƒé€šè¿‡å°†æŸ¥è¯¢ï¼ˆQï¼‰å’Œé”®ï¼ˆKï¼‰æ˜ å°„åˆ°ç›¸åŒçš„ä½ç»´ç©ºé—´ï¼Œç„¶åè®¡ç®—å®ƒä»¬çš„ç›¸ä¼¼åº¦å¾—åˆ†ï¼Œæœ€åå°†ç›¸ä¼¼åº¦å¾—åˆ†é€šè¿‡softmaxå‡½æ•°è¿›è¡Œå½’ä¸€åŒ–ã€‚åŠ æ€§æ³¨æ„åŠ›åœ¨ä¸€äº›åœºæ™¯ä¸­èƒ½å¤Ÿæ›´å¥½åœ°æ•æ‰è¾“å…¥åºåˆ—ä¹‹é—´çš„éçº¿æ€§å…³ç³»ç¼©æ”¾ç‚¹ç§¯æ³¨æ„åŠ›(Scaled Dot-Product Attention)ï¼šå®ƒæ˜¯Transformerä¸­æœ€å¸¸ç”¨çš„æ³¨æ„åŠ›æœºåˆ¶ã€‚åœ¨è®¡ç®—æ³¨æ„åŠ›æƒé‡æ—¶ï¼Œå¯¹ç‚¹ç§¯æ³¨æ„åŠ›è¿›è¡Œäº†ç¼©æ”¾æ“ä½œï¼Œé€šè¿‡é™¤ä»¥ç‰¹å¾ç»´åº¦çš„å¹³æ–¹æ ¹ï¼Œä»¥å‡å°æ³¨æ„åŠ›æƒé‡çš„å¤§å°å˜åŒ–ã€‚è¿™æœ‰åŠ©äºé˜²æ­¢æ¢¯åº¦æ¶ˆå¤±æˆ–æ¢¯åº¦çˆ†ç‚¸ï¼Œå¹¶ä½¿å¾—æ¨¡å‹æ›´ç¨³å®šæŒ‰ä½ç½®åŠ æƒæ³¨æ„åŠ›(Relative Positional Attention)ï¼šè¿™ç§æ³¨æ„åŠ›æœºåˆ¶è€ƒè™‘äº†ä½ç½®ä¿¡æ¯å¯¹æ³¨æ„åŠ›è®¡ç®—çš„å½±å“ã€‚å®ƒå¼•å…¥äº†ä½ç½®ç¼–ç ï¼Œé€šè¿‡è®¡ç®—ç›¸å¯¹ä½ç½®çš„å·®å¼‚ï¼Œå¯¹æ³¨æ„åŠ›æƒé‡è¿›è¡Œè°ƒæ•´ã€‚è¿™ç§æ³¨æ„åŠ›æœºåˆ¶åœ¨å¤„ç†åºåˆ—ä»»åŠ¡æ—¶èƒ½å¤Ÿæ›´å¥½åœ°å»ºæ¨¡é•¿è·ç¦»ä¾èµ–å…³ç³»åœ¨Transformerä¸­ä½¿ç”¨çš„Attentionæ˜¯Scaled Dot-Product Attentionï¼Œæ˜¯å½’ä¸€åŒ–çš„ç‚¹ä¹˜Attentionï¼Œå‡è®¾è¾“å…¥çš„query  ã€keyç»´åº¦ã€valueç»´åº¦ä¸ºï¼Œé‚£ä¹ˆå°±è®¡ç®—queryå’Œæ¯ä¸ªkey çš„ç‚¹ä¹˜æ“ä½œï¼Œå¹¶é™¤ä»¥ï¼Œç„¶ååº”ç”¨Softmaxå‡½æ•°è®¡ç®—æƒé‡åœ¨å®è·µä¸­ï¼Œå°†queryå’Œkeysã€valuesåˆ†åˆ«å¤„ç†ä¸ºçŸ©é˜µ$Q, K, V$ï¼Œé‚£ä¹ˆè®¡ç®—è¾“å‡ºçŸ©é˜µä¸º:å…¶ä¸­, , ï¼Œè¾“å‡ºçŸ©é˜µç»´åº¦ä¸ºï¼Œå…¶ä¸­ä¸ºå¥å­é•¿åº¦ï¼Œä¸ºEmbeddingåçš„ç‰¹å¾é•¿åº¦å…¶ä¸­$QK$çš„ç»´åº¦ä¸º$m \times m$ï¼Œè¡¨ç¤ºå¥å­ä¸­æ¯ä¸ªå­—ä¹‹é—´çš„å…³æ³¨åº¦(self-attention)ï¼Œè€Œ$(QK)V$çš„ç»´åº¦ä¸º$m \times d_k$ï¼Œè¡¨ç¤ºattentionä¸‹çš„å¥å­ç‰¹å¾å‘é‡ï¼Œ$QKV$å¦‚ä¸‹æ‰€ç¤ºattentionä»£ç å¦‚ä¸‹: å…¶ä¸­qkvæ˜¯xç»è¿‡çº¿æ€§å˜æ¢ä¹‹åçš„ç»“æœ12345678910def attention(query, key, value, mask=None, dropout=None):    &quot;Compute 'Scaled Dot Product Attention'&quot;    d_k = query.size(-1)    scores = torch.matmul(query, key.transpose(-2, -1)) / math.sqrt(d_k)    if mask is not None:        scores = scores.masked_fill(mask == 0, -1e9)    p_attn = F.softmax(scores, dim = -1)    if dropout is not None:        p_attn = dropout(p_attn)    return torch.matmul(p_attn, value), p_attnçŸ©é˜µä¸å…¶è½¬ç½®çš„ä¹˜ç§¯å‘é‡æ•°é‡ç§¯çš„å‡ ä½•æ„ä¹‰ï¼šä¸€ä¸ªå‘é‡åœ¨å¦ä¸€ä¸ªå‘é‡ä¸Šçš„æŠ•å½±å‘é‡çš„ç›¸ä¼¼æ€§æ˜¯ç”¨ä¸¤è€…çš„è§’åº¦ä½™å¼¦æ¥åº¦é‡ï¼Œä½™å¼¦å€¼è¶Šå¤§åˆ™ä¸¤è€…è¶Šç›¸ä¼¼è€Œä½™å¼¦å€¼ç­‰äºä¸¤è€…å†…ç§¯ä¸ä¸¤è€…æ¨¡é•¿ç§¯çš„æ¯”ï¼Œå½“ä¸¤ä¸ªå‘é‡æ¨¡é•¿å›ºå®šçš„æƒ…å½¢ä¸‹ï¼Œå†…ç§¯å¤§å°åˆ™åæ˜ äº†ä¸¤è€…ç›¸ä¼¼æ€§çš„å¤§å°1234567import numpy as npmat_a = np.array([1, 2, 2], [4, 5, 8])np.matmul(mat_a,mat_a.T)Out[5]: array([[  9,  30],       [ 30, 105]])é‚£ä¹ˆScaled Dot-Product Attentionçš„ç¤ºæ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼ŒMaskæ˜¯å¯é€‰çš„ï¼Œå¦‚æœæ˜¯èƒ½å¤Ÿè·å–åˆ°æ‰€æœ‰æ—¶åˆ»çš„è¾“å…¥$(K, V)$ï¼Œé‚£ä¹ˆå°±ä¸ä½¿ç”¨Maskï¼›å¦‚æœæ˜¯ä¸èƒ½è·å–åˆ°ï¼Œé‚£ä¹ˆå°±éœ€è¦ä½¿ç”¨Maskä½¿ç”¨äº†Maskçš„Transformeræ¨¡å‹ä¹Ÿè¢«ç§°ä¸ºTransformer Decoderï¼Œä¸ä½¿ç”¨Maskçš„Transformeræ¨¡å‹ä¹Ÿè¢«ç§°ä¸ºTransformer Encoderå¦‚æœåªå¯¹Qã€Kã€Våšä¸€æ¬¡è¿™æ ·çš„æƒé‡æ“ä½œæ˜¯ä¸å¤Ÿçš„ï¼Œè¿™é‡Œæå‡ºäº†Multi-Head Attentionæ“ä½œï¼ŒåŒ…æ‹¬ï¼šé¦–å…ˆå¯¹åšä¸€æ¬¡çº¿æ€§æ˜ å°„ï¼Œå°†è¾“å…¥ç»´åº¦å‡ä¸ºçš„çŸ©é˜µæ˜ å°„åˆ°ç„¶åå†é‡‡ç”¨Scaled Dot-Product Attentionç®—å‡ºç»“æœå¤šæ¬¡è¿›è¡Œä¸Šè¿°ä¸¤æ­¥æ“ä½œï¼Œç„¶åå°†å¾—åˆ°çš„ç»“æœè¿›è¡Œåˆå¹¶å°†åˆå¹¶çš„ç»“æœè¿›è¡Œçº¿æ€§å˜æ¢å¤šå¤´æ³¨æ„åŠ›çš„å¼•å…¥æœ‰ä»¥ä¸‹å‡ ä¸ªç›®çš„ï¼šå¹³è¡Œè®¡ç®—ï¼šé€šè¿‡ä½¿ç”¨å¤šä¸ªæ³¨æ„åŠ›å¤´ï¼Œå¯ä»¥å¹¶è¡Œåœ°è®¡ç®—æ³¨æ„åŠ›æƒé‡å’ŒåŠ æƒæ±‚å’Œï¼Œä»è€ŒåŠ å¿«æ¨¡å‹çš„è®¡ç®—é€Ÿåº¦ã€‚æ¯ä¸ªæ³¨æ„åŠ›å¤´éƒ½ä¸“æ³¨äºä¸åŒçš„è¡¨ç¤ºå­ç©ºé—´ï¼Œå› æ­¤å¯ä»¥ç‹¬ç«‹åœ°è®¡ç®—å’Œå¤„ç†ä¿¡æ¯ï¼Œæé«˜æ¨¡å‹çš„æ•ˆç‡ã€‚å¤šæ ·æ€§è¡¨è¾¾ï¼šæ¯ä¸ªæ³¨æ„åŠ›å¤´å­¦ä¹ åˆ°çš„è¡¨ç¤ºå­ç©ºé—´ä¸åŒï¼Œé€šè¿‡å¤šä¸ªæ³¨æ„åŠ›å¤´çš„ç»„åˆï¼Œå¯ä»¥è·å¾—æ›´ä¸°å¯Œã€å¤šæ ·æ€§çš„è¡¨ç¤ºã€‚è¿™æœ‰åŠ©äºæ¨¡å‹æ›´å¥½åœ°æ•æ‰è¾“å…¥åºåˆ—ä¸­çš„ä¸åŒç‰¹å¾å’Œå…³ç³»ï¼Œæé«˜æ¨¡å‹çš„è¡¨è¾¾èƒ½åŠ›ã€‚ç»„åˆæ³¨æ„åŠ›ï¼šå¤šå¤´æ³¨æ„åŠ›å…è®¸æ¨¡å‹åœ¨ä¸åŒçš„è¡¨ç¤ºå­ç©ºé—´ä¸Šè¿›è¡Œå¤šæ¬¡æ³¨æ„åŠ›è®¡ç®—ï¼Œå¹¶å°†è¿™äº›è®¡ç®—çš„ç»“æœè¿›è¡Œç»„åˆã€‚è¿™ç§ç»„åˆèƒ½å¤Ÿä»ä¸åŒçš„å…³æ³¨è§’åº¦å’Œè§†è§’æ¥å¤„ç†è¾“å…¥åºåˆ—ï¼Œå¸®åŠ©æ¨¡å‹æ›´å…¨é¢åœ°ç†è§£åºåˆ—ä¸­çš„ä¿¡æ¯ã€‚é€šè¿‡è¿™äº›æ–¹å¼ï¼Œå¤šå¤´æ³¨æ„åŠ›å¯ä»¥æä¾›æ›´çµæ´»ã€æ›´å¼ºå¤§çš„å»ºæ¨¡èƒ½åŠ›ï¼Œå¢å¼ºæ¨¡å‹å¯¹åºåˆ—ä¸­çš„é•¿è·ç¦»ä¾èµ–å…³ç³»ã€å…¨å±€ä¸Šä¸‹æ–‡å’Œç‰¹å¾ä¹‹é—´å¤æ‚å…³ç³»çš„å»ºæ¨¡èƒ½åŠ›å®ƒæ˜¯Transformeræ¨¡å‹åœ¨å¤„ç†è‡ªç„¶è¯­è¨€å¤„ç†ä»»åŠ¡æ—¶å–å¾—æˆåŠŸçš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œæ€»ç»“æ¥è¯´å…¬å¼å¦‚ä¸‹æ‰€ç¤ºå…¶ä¸­ç¬¬1æ­¥çš„çº¿æ€§å˜æ¢å‚æ•°ä¸ºï¼Œç¬¬4 æ­¥çš„çº¿æ€§å˜åŒ–å‚æ•°ä¸ºï¼Œè€Œç¬¬ä¸‰æ­¥è®¡ç®—çš„æ¬¡æ•°æ˜¯åœ¨è®ºæ–‡ä¸­å– ï¼Œè¡¨ç¤ºæ¯ä¸ªæ—¶åˆ»çš„è¾“å…¥ç»´åº¦å’Œè¾“å‡ºç»´åº¦ï¼Œ è¡¨ç¤º8æ¬¡Attentionæ“ä½œï¼Œ è¡¨ç¤ºç»è¿‡çº¿æ€§å˜æ¢ä¹‹åã€è¿›è¡ŒAttentionæ“ä½œä¹‹å‰çš„ç»´åº¦è¿›è¡Œä¸€æ¬¡Attentionä¹‹åè¾“å‡ºçš„çŸ©é˜µç»´åº¦æ˜¯ï¼Œç„¶åè¿›è¡Œæ¬¡æ“ä½œåˆå¹¶ä¹‹åè¾“å‡ºçš„ç»“æœæ˜¯ï¼Œå› æ­¤è¾“å…¥å’Œè¾“å‡ºçš„çŸ©é˜µç»´åº¦ç›¸åŒè¿™æ ·è¾“å‡ºçš„çŸ©é˜µ$R^{m \times 512}$ï¼Œæ¯è¡Œçš„å‘é‡éƒ½æ˜¯å¯¹$V$å‘é‡ä¸­æ¯ä¸€è¡Œ$v_{i}$çš„åŠ æƒï¼Œç¤ºæ„å›¾å¦‚ä¸Šæ‰€ç¤ºå¤šå¤´æ³¨æ„åŠ›ä»£ç å®ç°1234567891011121314151617181920212223242526272829303132class MultiHeadedAttention(nn.Module):    def __init__(self, h, d_model, dropout=0.1):        &quot;Take in model size and number of heads.&quot;        super(MultiHeadedAttention, self).__init__()        assert d_model % h == 0        # We assume d_v always equals d_k        self.d_k = d_model // h        self.h = h        # å¤šå¤´åœ¨è¿™é‡Œä½“ç°        self.linears = clones(nn.Linear(d_model, d_model), 4)        self.attn = None        self.dropout = nn.Dropout(p=dropout)            def forward(self, query, key, value, mask=None):        if mask is not None:            # Same mask applied to all h heads.            mask = mask.unsqueeze(1)        nbatches = query.size(0)                # 1) Do all the linear projections in batch from d_model =&gt; h x d_k         query, key, value = \            [l(x).view(nbatches, -1, self.h, self.d_k).transpose(1, 2)             for l, x in zip(self.linears, (query, key, value))]                # 2) Apply attention on all the projected vectors in batch.         x, self.attn = attention(query, key, value, mask=mask, dropout=self.dropout)                # 3) &quot;Concat&quot; using a view and apply a final linear.         x = x.transpose(1, 2).contiguous().view(nbatches, -1, self.h * self.d_k)                # 4) çº¿æ€§å˜æ¢æŠ•å½±å›åŸå§‹è¡¨ç¤ºç»´åº¦        return self.linears[-1](x)å¦‚æœä¸å¥½ç†è§£å¯ä»¥çœ‹ä¸‹è¿™éƒ¨åˆ†ä»£ç 123456789101112131415161718192021222324def multihead_attention(Q, K, V, num_heads):    # çº¿æ€§å˜æ¢å¾—åˆ°æŸ¥è¯¢ã€é”®å’Œå€¼çš„è¡¨ç¤º    Q_transformed = linear_transform(Q)    K_transformed = linear_transform(K)    V_transformed = linear_transform(V)    # åˆ†å‰²å¤´    Q_heads = split_heads(Q_transformed, num_heads)    K_heads = split_heads(K_transformed, num_heads)    V_heads = split_heads(V_transformed, num_heads)    # æ¯ä¸ªå¤´çš„æ³¨æ„åŠ›è®¡ç®—    attention_heads = []    for i in range(num_heads):        attention_head = scaled_dot_product_attention(Q_heads[i], K_heads[i], V_heads[i])        attention_heads.append(attention_head)    # æ‹¼æ¥æ³¨æ„åŠ›å¤´    concatenated_attention = concatenate_heads(attention_heads)    # çº¿æ€§å˜æ¢æŠ•å½±å›åŸå§‹è¡¨ç¤ºç»´åº¦    output = linear_transform(concatenated_attention)    return outputEncoderç¼–ç å™¨å’Œè§£ç å™¨å¦‚ä¸‹æ‰€ç¤ºDecoderåœ¨encoderéƒ¨åˆ†ä¸­çš„self-attentionæ˜¯ä¸éœ€è¦maskçš„ï¼Œè€Œdecoderéƒ¨åˆ†çš„self-attentionæ˜¯éœ€è¦maskçš„ï¼Œå› ä¸ºæ­£æ˜¯æœ‰äº†maské®æŒ¡åé¢çš„ä¿¡æ¯ï¼Œæ‰èƒ½å°†transformerç”¨æ¥åšæ¨ç†ç¼–ç å™¨å’Œè§£ç å™¨å¦‚ä¸‹æ‰€ç¤ºç¼–ç å™¨æŠŠæœ€åä¸€å±‚çš„KVå–‚ç»™äº†ç¼–ç å™¨ï¼Œæ­¤æ—¶Qæ¥æºè§£ç å™¨ï¼ŒK=Væ¥æºäºç¼–ç å™¨ï¼Œæ˜¯ä¸ºäº†è®©è§£ç å™¨èƒ½å¤Ÿåœ¨ç”Ÿæˆè¾“å‡ºæ—¶ä½¿ç”¨ç¼–ç å™¨çš„ä¿¡æ¯é€šè¿‡ç»™è§£ç å™¨æä¾›ç¼–ç å™¨çš„é”®å’Œå€¼çŸ©é˜µï¼Œå¯ä»¥å®ç°ä»¥ä¸‹ä¸¤ä¸ªç›®çš„ï¼šä¸Šä¸‹æ–‡ä¿¡æ¯ä¼ é€’ï¼šç¼–ç å™¨ä¸­çš„è‡ªæ³¨æ„åŠ›æœºåˆ¶èƒ½å¤Ÿæ•æ‰åˆ°è¾“å…¥åºåˆ—ä¸­çš„å±€éƒ¨å’Œå…¨å±€å…³ç³»ï¼Œç”Ÿæˆå¯¹åº”çš„é”®å’Œå€¼ã€‚å°†è¿™äº›é”®å’Œå€¼ä¼ é€’ç»™è§£ç å™¨ï¼Œå¯ä»¥å°†ç¼–ç å™¨çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ä¼ é€’ç»™è§£ç å™¨ï¼Œä»¥å¸®åŠ©è§£ç å™¨åœ¨ç”Ÿæˆè¾“å‡ºæ—¶äº†è§£è¾“å…¥åºåˆ—çš„ç›¸å…³å†…å®¹ã€‚å¯¹é½å’Œä¿¡æ¯æå–ï¼šè§£ç å™¨å¯ä»¥é€šè¿‡æ³¨æ„åŠ›æœºåˆ¶å¯¹ç¼–ç å™¨çš„é”®å’Œå€¼è¿›è¡ŒåŠ æƒæ±‡æ€»ï¼Œä»¥è·å–ä¸å½“å‰è§£ç ä½ç½®ç›¸å…³çš„ä¿¡æ¯ã€‚é€šè¿‡è®¡ç®—è§£ç å™¨å½“å‰ä½ç½®ä¸ç¼–ç å™¨ä¸­æ¯ä¸ªä½ç½®ä¹‹é—´çš„æ³¨æ„åŠ›åˆ†æ•°ï¼Œå¯ä»¥å®ç°å¯¹é½å’Œä¿¡æ¯æå–ï¼Œä½¿è§£ç å™¨èƒ½å¤Ÿä¸“æ³¨äºä¸å½“å‰ä½ç½®ç›¸å…³çš„è¾“å…¥ä¿¡æ¯ã€‚æ€»ç»“æ¥è¯´ï¼Œé€šè¿‡å°†ç¼–ç å™¨çš„é”®å’Œå€¼çŸ©é˜µæä¾›ç»™è§£ç å™¨ï¼Œå¯ä»¥å®ç°ä¸Šä¸‹æ–‡ä¿¡æ¯ä¼ é€’å’Œå¯¹é½æœºåˆ¶ï¼Œå¸®åŠ©è§£ç å™¨åœ¨ç”Ÿæˆè¾“å‡ºæ—¶åˆ©ç”¨ç¼–ç å™¨çš„ä¿¡æ¯ï¼Œä»è€Œæ”¹å–„æ¨¡å‹çš„æ€§èƒ½å’Œè¾“å‡ºè´¨é‡maskAttention MaskPadding MaskBertThe Illustrated BERT, ELMo, and co. (How NLP Cracked Transfer Learning)ELMoã€GPT å’Œ BERT ä¸‰è€…çš„åŒºåˆ«GPTï¼šGPT ä½¿ç”¨Transformer Decoderä½œä¸ºç‰¹å¾æå–å™¨ï¼Œå®ç°äº†å•å‘ç¼–ç ã€å…·æœ‰è‰¯å¥½çš„æ–‡æœ¬ç”Ÿæˆèƒ½åŠ›ï¼Œç„¶è€Œå½“å‰è¯çš„è¯­ä¹‰åªèƒ½ç”±å…¶å‰åºè¯å†³å®šï¼Œå¹¶ä¸”åœ¨è¯­ä¹‰ç†è§£ä¸Šä¸è¶³BERTï¼šä½¿ç”¨äº†Transformer Encoderä½œä¸ºç‰¹å¾æå–å™¨ï¼Œä¸ºåŒå‘ç¼–ç å™¨ï¼Œå¹¶ä½¿ç”¨äº†ä¸å…¶é…å¥—çš„æ©ç è®­ç»ƒæ–¹æ³•ã€‚è™½ç„¶ä½¿ç”¨åŒå‘ç¼–ç è®©BERTä¸å†å…·æœ‰æ–‡æœ¬ç”Ÿæˆèƒ½åŠ›ï¼Œä½†æ˜¯BERTçš„è¯­ä¹‰ä¿¡æ¯æå–èƒ½åŠ›æ›´å¼ºELMo: ä½¿ç”¨è‡ªå·¦å‘å³ç¼–ç å’Œè‡ªå³å‘å·¦ç¼–ç çš„ä¸¤ä¸ªLSTMç½‘ç»œï¼Œåˆ†åˆ«ä»¥$P\left(w{i} \mid w{1}, \cdots, w{i-1}\right)$å’Œ$P\left(w{i} \mid w{i+1}, \cdots, w{n}\right)$ä¸ºç›®æ ‡å‡½æ•°ç‹¬ç«‹è®­ç»ƒï¼Œå°†è®­ç»ƒå¾—åˆ°çš„ç‰¹å¾å‘é‡ä»¥æ‹¼æ¥çš„å½¢å¼å®ç°åŒå‘ç¼–ç ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯å•å‘ç¼–ç ï¼Œåªä¸è¿‡æ˜¯ä¸¤ä¸ªæ–¹å‘ä¸Šçš„å•å‘ç¼–ç çš„æ‹¼æ¥è€Œæˆçš„åŒå‘ç¼–ç bertæ˜¯è‡ªç¼–ç æ¨¡å‹ï¼Œè€Œgptæ˜¯è‡ªå›å½’æ¨¡å‹bertæ¦‚å†µBERT(Bidirectional Encoder Representations from Transformers)æ¨¡å‹çš„ç¼–ç å™¨ç”±å¤šä¸ªTransformerç¼–ç å™¨å±‚ç»„æˆï¼Œé€šå¸¸ä½¿ç”¨äº†å¤šä¸ªé‡å¤çš„ç¼–ç å™¨æ¥å½¢æˆæ·±å±‚çš„è¡¨ç¤ºæ¯ä¸ªBERTç¼–ç å™¨å±‚åŒ…å«äº†ä»¥ä¸‹ç»„ä»¶ï¼šå¤šå¤´è‡ªæ³¨æ„åŠ›ï¼ˆMulti-Head Self-Attentionï¼‰ï¼šè¯¥å±‚ä½¿ç”¨å¤šå¤´è‡ªæ³¨æ„åŠ›æœºåˆ¶æ¥å¯¹è¾“å…¥åºåˆ—è¿›è¡Œå»ºæ¨¡ã€‚è‡ªæ³¨æ„åŠ›å…è®¸æ¨¡å‹åœ¨å¤„ç†åºåˆ—æ—¶å…³æ³¨ä¸åŒä½ç½®ä¹‹é—´çš„ç›¸å…³æ€§ï¼Œæœ‰åŠ©äºæ•æ‰ä¸Šä¸‹æ–‡ä¿¡æ¯å‰é¦ˆç¥ç»ç½‘ç»œï¼ˆFeed-Forward Neural Networkï¼‰ï¼šåœ¨è‡ªæ³¨æ„åŠ›å±‚åé¢æ˜¯ä¸€ä¸ªå‰é¦ˆç¥ç»ç½‘ç»œã€‚è¯¥ç½‘ç»œé€šå¸¸ç”±ä¸¤ä¸ªçº¿æ€§å±‚å’Œæ¿€æ´»å‡½æ•°ï¼ˆå¦‚ReLUï¼‰ç»„æˆï¼Œç”¨äºå¯¹è‡ªæ³¨æ„åŠ›è¾“å‡ºè¿›è¡Œéçº¿æ€§å˜æ¢å’Œç‰¹å¾æå–æ®‹å·®è¿æ¥ï¼ˆResidual Connectionsï¼‰å’Œå±‚å½’ä¸€åŒ–ï¼ˆLayer Normalizationï¼‰ï¼šåœ¨æ¯ä¸ªå­å±‚ï¼ˆè‡ªæ³¨æ„åŠ›å’Œå‰é¦ˆç¥ç»ç½‘ç»œï¼‰ä¹‹åéƒ½åº”ç”¨äº†æ®‹å·®è¿æ¥å’Œå±‚å½’ä¸€åŒ–æ“ä½œã€‚è¿™äº›æ“ä½œæœ‰åŠ©äºç¼“è§£æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ï¼Œå¹¶æä¾›æ›´ç¨³å®šå’Œé«˜æ•ˆçš„è®­ç»ƒBERTæ¨¡å‹ä¸­é€šå¸¸ä¼šå †å å¤šä¸ªç¼–ç å™¨å±‚æ¥å½¢æˆæ·±å±‚è¡¨ç¤ºã€‚æ¯ä¸ªç¼–ç å™¨å±‚çš„è¾“å‡ºä¼šä½œä¸ºä¸‹ä¸€å±‚çš„è¾“å…¥ï¼Œé€šè¿‡å¤šæ¬¡é‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œå¯ä»¥é€æ¸ä¸°å¯Œè¾“å…¥åºåˆ—çš„è¡¨ç¤ºèƒ½åŠ›å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒBERTæ¨¡å‹è¿˜åœ¨ç¼–ç å™¨è¾“å…¥çš„å¼€å¤´æ·»åŠ äº†ç‰¹æ®Šçš„æ ‡è®°ï¼Œå¦‚[CLS]ï¼ˆç”¨äºåˆ†ç±»ä»»åŠ¡ï¼‰å’Œ[SEP]ï¼ˆç”¨äºåˆ†éš”è¾“å…¥ï¼‰ã€‚è¿™äº›ç‰¹æ®Šæ ‡è®°æœ‰åŠ©äºæ¨¡å‹åœ¨å¤„ç†ä¸åŒä»»åŠ¡æ—¶è¿›è¡Œåºåˆ—çº§åˆ«çš„æ“ä½œå’Œåˆ†ç±»æ€»ç»“èµ·æ¥ï¼ŒBERTçš„ç¼–ç å™¨ç”±å¤šä¸ªTransformerç¼–ç å™¨å±‚ç»„æˆï¼Œæ¯ä¸ªç¼–ç å™¨å±‚ç”±å¤šå¤´è‡ªæ³¨æ„åŠ›ã€å‰é¦ˆç¥ç»ç½‘ç»œå’Œæ®‹å·®è¿æ¥/å±‚å½’ä¸€åŒ–ç»„æˆã€‚é€šè¿‡å †å å¤šä¸ªç¼–ç å™¨å±‚ï¼ŒBERTæ¨¡å‹å¯ä»¥è·å¾—æ·±å±‚ã€é«˜è´¨é‡çš„è¯­è¨€è¡¨ç¤ºArchitectureè¾“å…¥è®­ç»ƒæ–¹å¼ç”±äºæ— æ³•ä½¿ç”¨æ ‡å‡†è¯­è¨€æ¨¡å‹çš„è®­ç»ƒæ¨¡å¼ï¼ŒBERTå€Ÿé‰´å®Œå½¢å¡«ç©ºä»»åŠ¡å’ŒCBOWçš„æ€æƒ³ï¼Œä½¿ç”¨è¯­è¨€æ©ç æ¨¡å‹(MLM)æ–¹æ³•è®­ç»ƒæ¨¡å‹è®­ç»ƒä¸­çš„maskMLMæ–¹æ³•ä¹Ÿå°±æ˜¯éšæœºå»æ‰å¥å­ä¸­çš„éƒ¨åˆ†token(å•è¯)ï¼Œç„¶åæ¨¡å‹æ¥é¢„æµ‹è¢«å»æ‰çš„tokenæ˜¯ä»€ä¹ˆã€‚è¿™æ ·å®é™…ä¸Šå·²ç»ä¸æ˜¯ä¼ ç»Ÿçš„ç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹(ç±»ä¼¼äºç”Ÿæˆæ¨¡å‹)äº†ï¼Œè€Œæ˜¯å•çº¯ä½œä¸ºåˆ†ç±»é—®é¢˜ï¼Œæ ¹æ®è¿™ä¸ªæ—¶åˆ»çš„hidden stateæ¥é¢„æµ‹è¿™ä¸ªæ—¶åˆ»çš„tokenåº”è¯¥æ˜¯ä»€ä¹ˆï¼Œè€Œä¸æ˜¯é¢„æµ‹ä¸‹ä¸€ä¸ªæ—¶åˆ»çš„è¯çš„æ¦‚ç‡åˆ†å¸ƒäº†éšæœºå»æ‰çš„tokenè¢«ç§°ä½œæ©ç è¯ï¼Œåœ¨è®­ç»ƒä¸­ï¼Œæ©ç è¯å°†ä»¥15%çš„æ¦‚ç‡è¢«æ›¿æ¢æˆ[MASK]ï¼Œä¹Ÿå°±æ˜¯è¯´éšæœºmaskè¯­æ–™ä¸­15%çš„tokenï¼Œè¿™ä¸ªæ“ä½œåˆ™ç§°ä¸ºæ©ç æ“ä½œåœ¨é€‰æ‹©15%çš„è¯ä½œä¸ºæ©ç è¯åè¿™äº›æ©ç è¯æœ‰ä¸‰ç±»æ›¿æ¢é€‰é¡¹ï¼š80% ç»ƒæ ·æœ¬ä¸­ï¼šå°†é€‰ä¸­çš„è¯ç”¨ [MASK] æ¥ä»£æ›¿10% çš„è®­ç»ƒæ ·æœ¬ä¸­ï¼šé€‰ä¸­çš„è¯ä¸å‘ç”Ÿå˜åŒ–ï¼Œè¯¥åšæ³•æ˜¯ä¸ºäº†ç¼“è§£è®­ç»ƒæ–‡æœ¬å’Œé¢„æµ‹æ–‡æœ¬çš„åå·®å¸¦æ¥çš„æ€§èƒ½æŸå¤±10% çš„è®­ç»ƒæ ·æœ¬ä¸­ï¼šå°†é€‰ä¸­çš„è¯ç”¨ä»»æ„çš„è¯æ¥è¿›è¡Œä»£æ›¿ï¼Œè¯¥åšæ³•æ˜¯ä¸ºäº†è®© BERT å­¦ä¼šæ ¹æ®ä¸Šä¸‹æ–‡ä¿¡æ¯è‡ªåŠ¨çº é”™</content>
	</entry>
	<entry>
		<title>æ ‘ç®—æ³•</title>
		<url>/article/1774.html</url>
		<content>æ ‘ç»“æ„æ¦‚å¿µ</content>
	</entry>
	<entry>
		<title>å›¾è®ºç®—æ³•</title>
		<url>/article/56968.html</url>
		<content>å›¾ç»“æ„åŸºæœ¬æ¦‚å¿µå›¾è®ºåŸºç¡€å’Œè¡¨ç¤ºå›¾çš„åŸºæœ¬ä»‹ç»å’Œè¡¨ç¤ºæ–¹å¼ å®šä¹‰å›¾è®º(Graph Theory)æ˜¯ç¦»æ•£æ•°å­¦çš„ä¸€ä¸ªåˆ†æ”¯ï¼Œæ˜¯ä¸€é—¨ç ”ç©¶å›¾(Graph)çš„å­¦é—®å›¾çš„åˆ†ç±»æœ‰æ— æ–¹å‘æœ‰å‘å›¾æ— å‘å›¾æœ‰æ— æƒé‡æ— æƒå›¾æœ‰æƒå›¾è¿é€šæ€§å›¾è®ºä¸­ï¼Œè¿é€šå›¾åŸºäºè¿é€šçš„æ¦‚å¿µï¼Œåœ¨ä¸€ä¸ªæ— å‘å›¾Gä¸­ï¼Œè‹¥ä»é¡¶ç‚¹iåˆ°é¡¶ç‚¹jæœ‰è·¯å¾„ç›¸è¿(å½“ç„¶ä»jåˆ°iä¹Ÿä¸€å®šæœ‰è·¯å¾„)ï¼Œåˆ™ç§°iå’Œjæ˜¯è¿é€šçš„å¦‚æœå›¾ä¸­ä»»æ„ä¸¤ç‚¹éƒ½æ˜¯è¿é€šçš„ï¼Œé‚£ä¹ˆå›¾è¢«ç§°ä½œè¿é€šå›¾ï¼Œå¦‚æœæ­¤å›¾æ˜¯æœ‰å‘å›¾ï¼Œåˆ™ç§°ä¸ºå¼ºè¿é€šå›¾å®Œå…¨å›¾å®Œå…¨å›¾æ˜¯ä¸€ä¸ªç®€å•çš„æ— å‘å›¾ï¼Œå…¶ä¸­æ¯å¯¹ä¸åŒçš„é¡¶ç‚¹ä¹‹é—´éƒ½æ°è¿æœ‰ä¸€æ¡è¾¹ç›¸è¿å›¾çš„è¡¨ç¤ºå›¾çš„è¡¨ç¤ºæ–¹å¼æœ‰ä¸¤ç§ï¼šäºŒç»´æ•°ç»„è¡¨ç¤º(é‚»æ¥çŸ©é˜µ)ã€é“¾è¡¨è¡¨ç¤º(é‚»æ¥è¡¨)é‚»æ¥çŸ©é˜µé‚»æ¥è¡¨åå­—é“¾è¡¨[æœ‰å‘å›¾]å›¾çš„ç±»å‹æ¬§æ‹‰å›¾æ¬§æ‹‰é€šè·¯ã€æ¬§æ‹‰å›è·¯ã€æ¬§æ‹‰å›¾å’ŒåŠæ¬§æ‹‰å›¾ä»¥åŠ Hierholzer ç®—æ³•å›è·¯ä¸é€šè·¯çš„å®šä¹‰ï¼šæ¬§æ‹‰é€šè·¯(æ¬§æ‹‰è·¯å¾„): é€šè¿‡å›¾ä¸­æ‰€æœ‰è¾¹æ°å¥½ä¸€æ¬¡ä¸”è¡Œéæ‰€æœ‰é¡¶ç‚¹çš„é€šè·¯æ¬§æ‹‰å›è·¯: é€šè¿‡å›¾ä¸­æ‰€æœ‰è¾¹æ°å¥½ä¸€æ¬¡ä¸”è¡Œéæ‰€æœ‰é¡¶ç‚¹çš„å›è·¯æ¬§æ‹‰å›¾ä¸åŠæ¬§æ‹‰å›¾ï¼šæ¬§æ‹‰å›¾(Eulerian graph): å…·æœ‰æ¬§æ‹‰å›è·¯çš„å›¾ç§°åŠæ¬§æ‹‰å›¾(semi-Eulerian graph): å…·æœ‰æ¬§æ‹‰é€šè·¯ä½†ä¸å…·æœ‰æ¬§æ‹‰å›è·¯çš„å›¾æ¬§æ‹‰å›è·¯æ˜¯æ¬§æ‹‰è·¯å¾„ï¼Œæ¬§æ‹‰è·¯å¾„ä¸ä¸€å®šæ˜¯æ¬§æ‹‰å›è·¯ç‰¹å¾åœ¨æ— å‘å›¾ä¸­ï¼šæ— å‘å›¾Gä¸ºæ¬§æ‹‰å›¾ï¼Œå½“ä¸”ä»…å½“Gä¸ºè¿é€šå›¾ä¸”æ‰€æœ‰é¡¶ç‚¹çš„åº¦ä¸ºå¶æ•°æ— å‘å›¾Gä¸ºåŠæ¬§æ‹‰å›¾ï¼Œå½“ä¸”ä»…å½“Gä¸ºè¿é€šå›¾ä¸”é™¤äº†ä¸¤ä¸ªé¡¶ç‚¹çš„åº¦ä¸ºå¥‡æ•°ä¹‹å¤–ï¼Œå…¶å®ƒæ‰€æœ‰é¡¶ç‚¹çš„åº¦ä¸ºå¶æ•°åœ¨æœ‰å‘å›¾ä¸­æœ‰å‘å›¾Gä¸ºæ¬§æ‹‰å›¾ï¼Œå½“ä¸”ä»…å½“Gä¸ºè¿é€šå›¾ä¸”æ‰€æœ‰é¡¶ç‚¹çš„å…¥åº¦ç­‰äºå‡ºåº¦æœ‰å‘å›¾Gä¸ºåŠæ¬§æ‹‰å›¾ï¼Œå½“ä¸”ä»…å½“Gä¸ºè¿é€šå›¾ä¸”å­˜åœ¨æŸä¸€é¡¶ç‚¹çš„å…¥åº¦æ¯”å‡ºåº¦å¤§1ï¼Œè¿˜å­˜åœ¨å¦ä¸€ä¸ªé¡¶ç‚¹çš„å…¥åº¦æ¯”å‡ºåº¦å°1ï¼Œè€Œå…¶å®ƒæ‰€æœ‰é¡¶ç‚¹çš„å…¥åº¦ç­‰äºå‡ºåº¦å¯¹äºæœ‰å‘å›¾çš„åŠæ¬§æ‹‰å›¾ï¼Œå®ƒçš„æ¬§æ‹‰è·¯å¾„çš„èµ·ç‚¹çš„åº¦æ˜¯å‡ºåº¦=å…¥åº¦+1ï¼Œç»ˆç‚¹çš„åº¦æ˜¯å…¥åº¦=å‡ºåº¦+1Hierholzerç®—æ³•ç”¨äºå¯»æ‰¾æ¬§æ‹‰è·¯å¾„æˆ–æ¬§æ‹‰å›è·¯(è¯¥ç®—æ³•å‡å®šå›¾æœ‰æ¬§æ‹‰è·¯å¾„æˆ–æ¬§æ‹‰å›è·¯)ï¼Œå…¶æµç¨‹å¦‚ä¸‹ï¼šä»èµ·ç‚¹å‡ºå‘ï¼Œè¿›è¡Œæ·±åº¦ä¼˜å…ˆæœç´¢(DFS)æ¯æ¬¡æ²¿ç€æŸæ¡è¾¹ä»æŸä¸ªé¡¶ç‚¹ç§»åŠ¨åˆ°å¦å¤–ä¸€ä¸ªé¡¶ç‚¹çš„æ—¶å€™ï¼Œéƒ½å°†è¿™æ¡è¾¹æ ‡è®°ä¸ºå·²èµ°è¿‡å¦‚æœé‡åˆ°é˜»å¡(å³å½“å‰é¡¶ç‚¹æ²¡æœ‰åç»­é‚»è¾¹æˆ–è¯¥é¡¶ç‚¹çš„é‚»è¾¹éƒ½èµ°è¿‡)ï¼Œåˆ™å°†å½“å‰é¡¶ç‚¹åŠ å…¥åˆ°æ ˆä¸­ï¼Œå¹¶å›æº¯åˆ°ä¸Šä¸€é¡¶ç‚¹æŸ¥æ‰¾å…¶å¯ç§»åŠ¨åˆ°çš„é¡¶ç‚¹å“ˆå¯†é¡¿å›¾å›¾è®ºå¤ä¹ ï¼ˆäºŒï¼‰-â€”â€”å“ˆå¯†é¡¿å›¾åŠå…¶åº”ç”¨å›è·¯ä¸é€šè·¯çš„å®šä¹‰ï¼šå“ˆå¯†é¡¿è·¯: ç»™å®šæ— å‘å›¾Gä¸­ï¼Œé€šè¿‡å›¾ä¸­æ¯ä¸ªç»“ç‚¹ä¸€æ¬¡è€Œä¸”ä»…ä¸€æ¬¡çš„è·¯å¾„å“ˆå¯†é¡¿å›è·¯: ç»™å®šæ— å‘å›¾Gä¸­ï¼Œé€šè¿‡å›¾ä¸­æ¯ä¸ªç»“ç‚¹ä¸€æ¬¡è€Œä¸”ä»…ä¸€æ¬¡çš„å›è·¯å“ˆå¯†é¡¿(Hamilton)å›¾ä¸åŠå“ˆå¯†é¡¿å›¾ï¼šå“ˆå¯†é¡¿å›¾: å…·æœ‰å“ˆå¯†é¡¿å›è·¯çš„å›¾åŠå“ˆå¯†é¡¿å›¾: æœ‰å“ˆå¯†é¡¿è·¯å¾„è€Œæ²¡æœ‰å“ˆå¯†é¡¿å›è·¯çš„å›¾å“ˆå¯†å°”é¡¿å›¾å’ŒåŠå“ˆå¯†å°”é¡¿å›¾æ˜¯è¿é€šå›¾å“ˆå¯†é¡¿å›¾å’Œæ¬§æ‹‰å›¾è”ç³»ä¸¤è€…éƒ½æ˜¯éå†é—®é¢˜ï¼Œä½†æ˜¯æ¬§æ‹‰å›¾è€ƒè™‘çš„æ˜¯è¾¹ï¼Œè€Œå“ˆå¯†é¡¿è€ƒè™‘çš„æ˜¯ç»“ç‚¹åŒæ—¶åˆ¤å®šæ¬§æ‹‰å›¾å…·æœ‰å……è¦æ¡ä»¶ï¼Œä½†å“ˆå¯†é¡¿å›¾æ²¡æœ‰ç®€å•çš„å……è¦æ¡ä»¶ï¼Œåªæœ‰å¿…è¦æ¡ä»¶å’Œå……åˆ†æ¡ä»¶äºŒéƒ¨å›¾äºŒéƒ¨å›¾(äºŒåˆ†å›¾)æ€»ç»“å®šä¹‰äºŒåˆ†å›¾åˆç§°ä½œäºŒéƒ¨å›¾ï¼Œæ˜¯å›¾è®ºä¸­çš„ä¸€ç§ç‰¹æ®Šæ¨¡å‹è®¾G=(V, E)æ˜¯ä¸€ä¸ªæ— å‘å›¾ï¼Œå¦‚æœé¡¶ç‚¹Vå¯åˆ†å‰²ä¸ºä¸¤ä¸ªäº’ä¸ç›¸äº¤çš„å­é›†(A,B)ï¼Œå¹¶ä¸”å›¾ä¸­çš„æ¯æ¡è¾¹(i, j)æ‰€å…³è”çš„ä¸¤ä¸ªé¡¶ç‚¹iå’Œjåˆ†åˆ«å±äºè¿™ä¸¤ä¸ªä¸åŒçš„é¡¶ç‚¹é›†($i \in A$ï¼Œ$j \in B$)ï¼Œåˆ™ç§°å›¾Gä¸ºä¸€ä¸ªäºŒåˆ†å›¾ç«èµ›å›¾(æœ‰å‘å®Œå…¨å›¾)å®šä¹‰ç«èµ›å›¾ä¹Ÿå«æœ‰å‘å®Œå…¨å›¾ã€‚æ¯å¯¹é¡¶ç‚¹ä¹‹é—´éƒ½æœ‰ä¸€æ¡è¾¹ç›¸è¿çš„æœ‰å‘å›¾ç§°ä¸ºç«èµ›å›¾ç®€å•çš„æ€§è´¨ï¼šç«èµ›å›¾æ²¡æœ‰è‡ªç¯ï¼Œæ²¡æœ‰äºŒå…ƒç¯ï¼Œè‹¥ç«èµ›å›¾å­˜åœ¨ç¯ï¼Œåˆ™ä¸€å®šå­˜åœ¨ä¸‰å…ƒç¯å¦‚æœå­˜åœ¨ä¸€ä¸ªç¯å¤§äºä¸‰å…ƒï¼Œé‚£ä¹ˆä¸€å®šå­˜åœ¨å¦ä¸€ä¸ªä¸‰å…ƒçš„å°ç¯ä»»æ„ç«èµ›å›¾éƒ½æœ‰å“ˆå¯†é¡¿è·¯å¾„(ç»è¿‡æ¯ä¸ªç‚¹ä¸€æ¬¡çš„è·¯å¾„ï¼Œä¸è¦æ±‚å›åˆ°å‡ºå‘ç‚¹)å›¾å­˜åœ¨å“ˆå¯†é¡¿å›è·¯çš„å……è¦æ¡ä»¶æ˜¯å¼ºè”é€šå“ˆå¯†é¡¿é—®é¢˜ä¸­ï¼Œå¯¹äºné˜¶ç«èµ›å›¾ï¼Œå½“nå¤§äºç­‰äº2æ—¶ä¸€å®šå­˜åœ¨å“ˆå¯†é¡¿é€šè·¯acmé¢˜ç›®é¢˜ç›®å¤§æ„ï¼šç°åœ¨æœ‰æ¯”èµ›ï¼Œæ‰€æœ‰é˜Ÿä¼ä¸¤ä¸¤è¿›è¡Œæ¯”èµ›ï¼Œèµ¢çš„ç§¯2åˆ†ï¼Œè¾“çš„ç§¯0åˆ†ï¼Œå¦‚æœå¹³å±€çš„è¯å°±å„è‡ªéƒ½ç§¯1åˆ†ç°åœ¨ç»™å‡ºæ¯åªé˜Ÿä¼çš„å¾—åˆ†æƒ…å†µï¼Œåˆ¤æ–­æ˜¯å¦åˆæ³•æ€è·¯ï¼šç»™å‡ºçš„ m ä¸ªé˜Ÿä¼å¯ä»¥æ„æˆä¸€ä¸ªç«èµ›å›¾ï¼Œé—®å¾—åˆ†æƒ…å†µæ˜¯å¦åˆæ³•å®è´¨æ˜¯åœ¨é—®ç«èµ›å›¾æ˜¯å¦åˆæ³•æ ¹æ®ç«èµ›å›¾çš„å…°é“å®šç†ï¼Œå°†å¾—åˆ†è§†ä¸ºæ¯”åˆ†åºåˆ—ï¼Œå°†æ‰€æœ‰å¾—åˆ†è¿›è¡Œæ’åºï¼Œç„¶åä¾æ¬¡å¤„ç†ç”±äºæ¯æ¬¡æ¯”èµ›èƒœåˆ©éƒ½ä¼šä½¿å¾—æ€»åˆ† +2ï¼Œé‚£ä¹ˆå‰iåªé˜Ÿä¼çš„å¾—åˆ†æƒ…å†µå¿…é¡»å¤§äºç­‰äº i*(i-1)å½“åˆ¤æ–­åˆ°æœ€åä¸€åªé˜Ÿä¼æ—¶ï¼Œæœ‰å‰ n-1 åªé˜Ÿä¼çš„å¾—åˆ†å¿…é¡»å¤§äº n*(n-1)éå†ç®—æ³•æ·±åº¦æœç´¢å¹¿åº¦æœç´¢æœ€çŸ­è·¯å¾„ç®—æ³•FloydDijkstra[æœ€çŸ­è·¯å¾„é—®é¢˜]â€”Dijkstra ç®—æ³•æœ€è¯¦è§£æœ€å°ç”Ÿæˆæ ‘ç®—æ³•PrimKruskalå…³é”®è·¯å¾„æ‹“æ‰‘æ’åºäºŒåˆ†å›¾åŒ¹é…é…å¯¹åŒˆç‰™åˆ©ç®—æ³•ä¸­å¿ƒæ€§ç®—æ³•ç¤¾åŒºå‘ç°ç®—æ³•æ ‡ç­¾ä¼ æ’­ç®—æ³•LPAæ ‡ç­¾ä¼ æ’­ç®—æ³•(Label Propagation Algorithmï¼Œç®€ç§° LPA)æ˜¯ä¸€ä¸ªåœ¨å›¾ä¸­å¿«é€Ÿå‘ç°ç¤¾ç¾¤çš„ç®—æ³•Louvainç®—æ³•</content>
	</entry>
	<entry>
		<title>æ’åºç®—æ³•</title>
		<url>/article/62104.html</url>
		<content>æ’åºç®—æ³•åå¤§ç»å…¸æ’åºç®—æ³•_åŠ¨å›¾æ¼”ç¤ºå¸¸è§çš„10ç§æ’åºç®—æ³•åå¤§ç»å…¸æ’åºç®—æ³•åŠ¨ç”»ï¼Œçœ‹æˆ‘å°±å¤Ÿäº†åå¤§ç»å…¸æ’åºç®—æ³•åˆ†ç±»åç§å¸¸è§æ’åºç®—æ³•å¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»ï¼šæ¯”è¾ƒç±»æ’åºï¼šé€šè¿‡æ¯”è¾ƒæ¥å†³å®šå…ƒç´ é—´çš„ç›¸å¯¹æ¬¡åºï¼Œç”±äºå…¶æ—¶é—´å¤æ‚åº¦ä¸èƒ½çªç ´$O(n)$ï¼Œå› æ­¤ä¹Ÿç§°ä¸ºéçº¿æ€§æ—¶é—´æ¯”è¾ƒç±»æ’åºéæ¯”è¾ƒç±»æ’åºï¼šä¸é€šè¿‡æ¯”è¾ƒæ¥å†³å®šå…ƒç´ é—´çš„ç›¸å¯¹æ¬¡åºï¼Œå®ƒå¯ä»¥çªç ´åŸºäºæ¯”è¾ƒæ’åºçš„æ—¶é—´ä¸‹ç•Œï¼Œä»¥çº¿æ€§æ—¶é—´è¿è¡Œï¼Œå› æ­¤ä¹Ÿç§°ä¸ºçº¿æ€§æ—¶é—´éæ¯”è¾ƒç±»æ’åºæ’åºç®—æ³•æ¯”è¾ƒç±»äº¤æ¢æ’åºå†’æ³¡æ’åº(ç¨³å®š)å¿«é€Ÿæ’åº[åˆ†æ²»]æ’å…¥æ’åºç®€å•æ’å…¥æ’åº(ç¨³å®š)[æ‰“æ‰‘å…‹]å¸Œå°”æ’åº(æ’å…¥æ’åºçš„æ”¹è¿›)é€‰æ‹©æ’åºç®€å•é€‰æ‹©æ’åº[é€‰æœ€å€¼]å †æ’åºå½’å¹¶æ’åº(ç¨³å®š)[é€’å½’]äºŒè·¯å½’å¹¶æ’åºå¤šè·¯å½’å¹¶æ’åºéæ¯”è¾ƒç±»è®¡æ•°æ’åº(ç¨³å®š)æ¡¶æ’åº(ç¨³å®š)åŸºæ•°æ’åº(ç¨³å®š)ç®—æ³•å¤æ‚åº¦æ’åºæ–¹æ³•æ—¶é—´å¤æ‚åº¦(å‡)æ—¶é—´å¤æ‚åº¦(æœ€å)æ—¶é—´å¤æ‚åº¦(æœ€å¥½)ç©ºé—´å¤æ‚åº¦ç¨³å®šæ€§æœ¬åœ°æ’åºæ’å…¥æ’åº$O(n^2)$$O(n^2)$$O(n)$$O(1)$ç¨³å®šéƒ½å¯å¸Œå°”æ’åº$O(n^{1.3})$$O(n^2)$$O(n)$$O(1)$ä¸ç¨³å®šéƒ½å¯é€‰æ‹©æ’åº$O(n^2)$$O(n^2)$$O(n^2)$$O(1)$ä¸ç¨³å®šéƒ½å¯å †æ’åº$O(n log_2n)$$O(n log_2n)$$O(n log_2n)$$O(1)$ä¸ç¨³å®šéƒ½å¯å†’æ³¡æ’åº$O(n^2)$$O(n^2)$$O(n)$$O(1)$ç¨³å®šéƒ½å¯å¿«é€Ÿæ’åº$O(n log_2n)$$O(n^2)$$O(n log_2n)$$O(n log_2n)$ä¸ç¨³å®šä»…æœ¬åœ°å½’å¹¶æ’åº$O(n log_2n)$$O(n log_2n)$$O(n log_2n)$$O(n)$ç¨³å®šä¸æ”¯æŒè®¡æ•°æ’åº$O(n+k)$$O(n+k)$$O(n+k)$$O(n+k)$ç¨³å®šéƒ½å¯æ¡¶æ’åº$O(n+k)$$O(n^2)$$O(n)$$O(n+k)$ç¨³å®šéƒ½å¯åŸºæ•°æ’åº$O(n*k)$$O(n*k)$$O(n*k)$$O(n+k)$ç¨³å®šéƒ½å¯å°ç»“ç¨³å®šæ€§è®°å¿†æ–¹æ³•â€”â€”å¿«å¸Œé€‰å †ä¸ç¨³å®šéœ€è¦ä½¿ç”¨é¢å¤–ç©ºé—´çš„å››ç§æ’åºâ€”â€”åŸºæ•°ã€è®¡æ•°ã€æ¡¶æ’ã€å½’å¹¶å¸¸ç”¨æ—¶é—´å¤æ‚åº¦å¤§å°å…³ç³»åŸºæœ¬æ¦‚å¿µç¨³å®šæ€§å‡å®šåœ¨å¾…æ’åºçš„è®°å½•åºåˆ—ä¸­ï¼Œå­˜åœ¨å¤šä¸ªå…·æœ‰ç›¸åŒçš„å…³é”®å­—çš„è®°å½•ï¼Œè‹¥ç»è¿‡æ’åºï¼Œè¿™äº›è®°å½•çš„ç›¸å¯¹æ¬¡åºä¿æŒä¸å˜å³åœ¨åŸåºåˆ—ä¸­ï¼Œr[i]=r[j]ï¼Œä¸”r[i]åœ¨r[j]ä¹‹å‰ï¼Œè€Œåœ¨æ’åºåçš„åºåˆ—ä¸­ï¼Œr[i]ä»åœ¨r[j]ä¹‹å‰ï¼Œåˆ™ç§°è¿™ç§æ’åºç®—æ³•æ˜¯ç¨³å®šçš„æ¯”è¾ƒç±»å†’æ³¡æ’åº(Bubble Sort)ç®—æ³•æè¿°æ¯”è¾ƒç›¸é‚»çš„å…ƒç´ : å¦‚æœç¬¬ä¸€ä¸ªæ¯”ç¬¬äºŒä¸ªå¤§ï¼Œå°±äº¤æ¢å®ƒä»¬ä¸¤ä¸ªå¯¹æ¯ä¸€å¯¹ç›¸é‚»å…ƒç´ ä½œåŒæ ·çš„å·¥ä½œï¼Œä»å¼€å§‹ç¬¬ä¸€å¯¹åˆ°ç»“å°¾çš„æœ€åä¸€å¯¹ï¼Œè¿™æ ·åœ¨æœ€åçš„å…ƒç´ åº”è¯¥ä¼šæ˜¯æœ€å¤§çš„æ•°é’ˆå¯¹æ‰€æœ‰çš„å…ƒç´ é‡å¤ä»¥ä¸Šçš„æ­¥éª¤ï¼Œé™¤äº†æœ€åä¸€ä¸ªé‡å¤æ­¥éª¤1~3ï¼Œç›´åˆ°æ’åºå®ŒæˆåŠ¨å›¾æ¼”ç¤ºä»£ç å®ç°123456def bubbleSort(arr):    for i in range(1, len(arr)):        for j in range(0, len(arr)-i):            if arr[j] &gt; arr[j+1]:                arr[j], arr[j + 1] = arr[j + 1], arr[j]    return arræ”¹è¿›ä¸å˜ç§é¸¡å°¾é…’æ’åº(Cocktail Sort)å†’æ³¡æ’åºçš„å˜å½¢ç‰ˆï¼Œä¹Ÿç§°æ…æ‹Œæ’åºæ¯ä¸€è½®æ’åºæœ‰ä¸¤ä¸ªå†…å¾ªç¯ï¼Œæ¯è½®ç»“æŸæ—¶åŒæ—¶æ’å¥½äº†æœ€å¤§å’Œæœ€å°ä¸¤ä¸ªå…ƒç´ ç¬¬ä¸€ä¸ªå¾ªç¯è´Ÿè´£æŠŠå½“å‰æœ€å¤§å€¼å†’æ³¡åˆ°æœ€å³ç¬¬äºŒä¸ªå¾ªç¯æŠŠå½“å‰æœ€å°å€¼å†’æ³¡åˆ°æœ€å·¦1234567891011121314class Solution:    def MySort(self, arr):        n = len(arr)                for i in range(n-1, -1, -1):            for j in range(1, i+1):                if arr[j] &lt; arr[j-1]:                    arr[j], arr[j-1] = arr[j-1], arr[j]            for j in range(i-1, 0, -1):                if arr[j] &lt; arr[j-1]:                    arr[j], arr[j-1] = arr[j-1], arr[j]        return arré€‰æ‹©æ’åº(Selection Sort)å·¥ä½œåŸç†ï¼šé¦–å…ˆåœ¨æœªæ’åºåºåˆ—ä¸­æ‰¾åˆ°æœ€å°(å¤§)å…ƒç´ ï¼Œå­˜æ”¾åˆ°æ’åºåºåˆ—çš„èµ·å§‹ä½ç½®ï¼Œç„¶åï¼Œå†ä»å‰©ä½™æœªæ’åºå…ƒç´ ä¸­ç»§ç»­å¯»æ‰¾æœ€å°(å¤§)å…ƒç´ ï¼Œç„¶åæ”¾åˆ°å·²æ’åºåºåˆ—çš„æœ«å°¾ã€‚ä»¥æ­¤ç±»æ¨ï¼Œç›´åˆ°æ‰€æœ‰å…ƒç´ å‡æ’åºå®Œæ¯•ç®—æ³•æè¿°nä¸ªè®°å½•çš„ç›´æ¥é€‰æ‹©æ’åºå¯ç»è¿‡n-1è¶Ÿç›´æ¥é€‰æ‹©æ’åºå¾—åˆ°æœ‰åºç»“æœï¼Œå…·ä½“ç®—æ³•æè¿°å¦‚ä¸‹ï¼šåˆå§‹çŠ¶æ€ï¼šæ— åºåŒºä¸ºR[1..n]ï¼Œæœ‰åºåŒºä¸ºç©ºç¬¬iè¶Ÿæ’åº(i=1, 2, 3 â€¦ n-1)å¼€å§‹æ—¶ï¼Œå½“å‰æœ‰åºåŒºå’Œæ— åºåŒºåˆ†åˆ«ä¸ºR[1..i-1]å’ŒR(i..n)è¯¥è¶Ÿæ’åºä»å½“å‰æ— åºåŒºä¸­é€‰å‡ºå…³é”®å­—æœ€å°çš„è®°å½•R[k]ï¼Œå°†å®ƒä¸æ— åºåŒºçš„ç¬¬1ä¸ªè®°å½•Räº¤æ¢ä½¿R[1..i]å’ŒR[i+1..n)åˆ†åˆ«å˜ä¸ºè®°å½•ä¸ªæ•°å¢åŠ 1ä¸ªçš„æ–°æœ‰åºåŒºå’Œè®°å½•ä¸ªæ•°å‡å°‘1ä¸ªçš„æ–°æ— åºåŒºn-1è¶Ÿç»“æŸï¼Œæ•°ç»„æœ‰åºåŒ–äº†åŠ¨å›¾æ¼”ç¤ºä»£ç å®ç°1234567891011def selectionSort(arr):    for i in range(len(arr) - 1):        # è®°å½•æœ€å°æ•°çš„ç´¢å¼•        minIndex = i        for j in range(i + 1, len(arr)):            if arr[j] &lt; arr[minIndex]:                minIndex = j        # i ä¸æ˜¯æœ€å°æ•°æ—¶ï¼Œå°† i å’Œæœ€å°æ•°è¿›è¡Œäº¤æ¢        if i != minIndex:            arr[i], arr[minIndex] = arr[minIndex], arr[i]    return arræ’å…¥æ’åº(Insertion Sort)æ’å…¥æ’åº(Insertion-Sort)çš„ç®—æ³•æè¿°æ˜¯ä¸€ç§ç®€å•ç›´è§‚çš„æ’åºç®—æ³•å®ƒçš„å·¥ä½œåŸç†æ˜¯é€šè¿‡æ„å»ºæœ‰åºåºåˆ—ï¼Œå¯¹äºæœªæ’åºæ•°æ®ï¼Œåœ¨å·²æ’åºåºåˆ—ä¸­ä»åå‘å‰æ‰«æï¼Œæ‰¾åˆ°ç›¸åº”ä½ç½®å¹¶æ’å…¥ç®—æ³•æè¿°ä¸€èˆ¬æ¥è¯´ï¼Œæ’å…¥æ’åºéƒ½é‡‡ç”¨in-placeåœ¨æ•°ç»„ä¸Šå®ç°ã€‚å…·ä½“ç®—æ³•æè¿°å¦‚ä¸‹ï¼šä»ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹ï¼Œè¯¥å…ƒç´ å¯ä»¥è®¤ä¸ºå·²ç»è¢«æ’åºå–å‡ºä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œåœ¨å·²ç»æ’åºçš„å…ƒç´ åºåˆ—ä¸­ä»åå‘å‰æ‰«æå¦‚æœè¯¥å…ƒç´ (å·²æ’åº)å¤§äºæ–°å…ƒç´ ï¼Œå°†è¯¥å…ƒç´ ç§»åˆ°ä¸‹ä¸€ä½ç½®é‡å¤æ­¥éª¤3ï¼Œç›´åˆ°æ‰¾åˆ°å·²æ’åºçš„å…ƒç´ å°äºæˆ–è€…ç­‰äºæ–°å…ƒç´ çš„ä½ç½®å°†æ–°å…ƒç´ æ’å…¥åˆ°è¯¥ä½ç½®åé‡å¤æ­¥éª¤2~5åŠ¨å›¾æ¼”ç¤ºä»£ç å®ç°123456789def insertionSort(arr):    for i in range(len(arr)):        preIndex = i-1        current = arr[i]        while preIndex &gt;= 0 and arr[preIndex] &gt; current:            arr[preIndex+1] = arr[preIndex]            preIndex-=1        arr[preIndex+1] = current    return arrå¸Œå°”æ’åº(Shell Sort)1959å¹´Shellå‘æ˜ï¼Œç¬¬ä¸€ä¸ªçªç ´$O(n^2)$çš„æ’åºç®—æ³•ï¼Œæ˜¯ç®€å•æ’å…¥æ’åºçš„æ”¹è¿›ç‰ˆï¼Œå®ƒä¸æ’å…¥æ’åºçš„ä¸åŒä¹‹å¤„åœ¨äºï¼Œå®ƒä¼šä¼˜å…ˆæ¯”è¾ƒè·ç¦»è¾ƒè¿œçš„å…ƒç´ ï¼Œå¸Œå°”æ’åºåˆå«ç¼©å°å¢é‡æ’åºç®—æ³•æè¿°å…ˆå°†æ•´ä¸ªå¾…æ’åºçš„è®°å½•åºåˆ—åˆ†å‰²æˆä¸ºè‹¥å¹²å­åºåˆ—åˆ†åˆ«è¿›è¡Œç›´æ¥æ’å…¥æ’åºï¼Œå…·ä½“ç®—æ³•æè¿°ï¼šé€‰æ‹©ä¸€ä¸ªå¢é‡åºåˆ—t1ï¼Œt2ï¼Œâ€¦ï¼Œtkï¼Œå…¶ä¸­ti&gt;tjï¼Œtk=1æŒ‰å¢é‡åºåˆ—ä¸ªæ•°kï¼Œå¯¹åºåˆ—è¿›è¡Œkè¶Ÿæ’åºæ¯è¶Ÿæ’åºï¼Œæ ¹æ®å¯¹åº”çš„å¢é‡tiï¼Œå°†å¾…æ’åºåˆ—åˆ†å‰²æˆè‹¥å¹²é•¿åº¦ä¸ºmçš„å­åºåˆ—ï¼Œåˆ†åˆ«å¯¹å„å­è¡¨è¿›è¡Œç›´æ¥æ’å…¥æ’åºã€‚ä»…å¢é‡å› å­ä¸º1æ—¶ï¼Œæ•´ä¸ªåºåˆ—ä½œä¸ºä¸€ä¸ªè¡¨æ¥å¤„ç†ï¼Œè¡¨é•¿åº¦å³ä¸ºæ•´ä¸ªåºåˆ—çš„é•¿åº¦ã€‚åŠ¨å›¾æ¼”ç¤ºä»£ç å®ç°12345678910111213141516import mathdef shellSort(arr):    gap=1    while(gap &lt; len(arr)/3):        gap = gap*3+1    while gap &gt; 0:        for i in range(gap,len(arr)):            temp = arr[i]            j = i-gap            while j &gt;=0 and arr[j] &gt; temp:                arr[j+gap]=arr[j]                j-=gap            arr[j+gap] = temp        gap = math.floor(gap/3)    return arrå½’å¹¶æ’åº(Merge Sort)å½’å¹¶æ’åºæ˜¯å»ºç«‹åœ¨å½’å¹¶æ“ä½œä¸Šçš„ä¸€ç§æœ‰æ•ˆçš„æ’åºç®—æ³•ã€‚è¯¥ç®—æ³•æ˜¯é‡‡ç”¨åˆ†æ²»æ³•(Divide and Conquer)çš„ä¸€ä¸ªéå¸¸å…¸å‹çš„åº”ç”¨å°†å·²æœ‰åºçš„å­åºåˆ—åˆå¹¶ï¼Œå¾—åˆ°å®Œå…¨æœ‰åºçš„åºåˆ—ï¼›å³å…ˆä½¿æ¯ä¸ªå­åºåˆ—æœ‰åºï¼Œå†ä½¿å­åºåˆ—æ®µé—´æœ‰åºè‹¥å°†ä¸¤ä¸ªæœ‰åºè¡¨åˆå¹¶æˆä¸€ä¸ªæœ‰åºè¡¨ï¼Œç§°ä¸º2-è·¯å½’å¹¶ç®—æ³•æè¿°æŠŠé•¿åº¦ä¸ºnçš„è¾“å…¥åºåˆ—åˆ†æˆä¸¤ä¸ªé•¿åº¦ä¸ºn/2çš„å­åºåˆ—å¯¹è¿™ä¸¤ä¸ªå­åºåˆ—åˆ†åˆ«é‡‡ç”¨å½’å¹¶æ’åºå°†ä¸¤ä¸ªæ’åºå¥½çš„å­åºåˆ—åˆå¹¶æˆä¸€ä¸ªæœ€ç»ˆçš„æ’åºåºåˆ—åŠ¨å›¾æ¼”ç¤ºä»£ç å®ç°1234567891011121314151617181920def mergeSort(arr):    import math    if(len(arr)&lt;2):        return arr    middle = math.floor(len(arr)/2)    left, right = arr[0:middle], arr[middle:]    return merge(mergeSort(left), mergeSort(right))def merge(left,right):    result = []    while left and right:        if left[0] &lt;= right[0]:            result.append(left.pop(0))        else:            result.append(right.pop(0));    while left:        result.append(left.pop(0))    while right:        result.append(right.pop(0));    return resultå¿«é€Ÿæ’åº(Quick Sort)åŸºæœ¬æ€æƒ³ï¼šé€šè¿‡ä¸€è¶Ÿæ’åºå°†å¾…æ’è®°å½•åˆ†éš”æˆç‹¬ç«‹çš„ä¸¤éƒ¨åˆ†ï¼Œå…¶ä¸­ä¸€éƒ¨åˆ†è®°å½•çš„å…³é”®å­—å‡æ¯”å¦ä¸€éƒ¨åˆ†çš„å…³é”®å­—å°ï¼Œåˆ™å¯åˆ†åˆ«å¯¹è¿™ä¸¤éƒ¨åˆ†è®°å½•ç»§ç»­è¿›è¡Œæ’åºï¼Œä»¥è¾¾åˆ°æ•´ä¸ªåºåˆ—æœ‰åºç®—æ³•æè¿°å¿«é€Ÿæ’åºä½¿ç”¨åˆ†æ²»æ³•æ¥æŠŠä¸€ä¸ªä¸²(list)åˆ†ä¸ºä¸¤ä¸ªå­ä¸²(sub-lists)ï¼Œå…·ä½“ç®—æ³•æè¿°å¦‚ä¸‹ï¼šä»æ•°åˆ—ä¸­æŒ‘å‡ºä¸€ä¸ªå…ƒç´ ï¼Œç§°ä¸ºåŸºå‡†(pivot)é‡æ–°æ’åºæ•°åˆ—ï¼Œæ‰€æœ‰å…ƒç´ æ¯”åŸºå‡†å€¼å°çš„æ‘†æ”¾åœ¨åŸºå‡†å‰é¢ï¼Œæ‰€æœ‰å…ƒç´ æ¯”åŸºå‡†å€¼å¤§çš„æ‘†åœ¨åŸºå‡†çš„åé¢(ç›¸åŒçš„æ•°å¯ä»¥åˆ°ä»»ä¸€è¾¹)ï¼Œåœ¨è¿™ä¸ªåˆ†åŒºé€€å‡ºä¹‹åï¼Œè¯¥åŸºå‡†å°±å¤„äºæ•°åˆ—çš„ä¸­é—´ä½ç½®ï¼Œè¿™ä¸ªç§°ä¸ºåˆ†åŒº(partition)æ“ä½œé€’å½’åœ°(recursive)æŠŠå°äºåŸºå‡†å€¼å…ƒç´ çš„å­æ•°åˆ—å’Œå¤§äºåŸºå‡†å€¼å…ƒç´ çš„å­æ•°åˆ—æ’åºåŠ¨å›¾æ¼”ç¤ºå…·ä½“è¿‡ç¨‹ï¼Œå›¾ç‰‡æ¥æºä»£ç å®ç°1234567891011121314151617181920212223def quickSort(arr, left=None, right=None):    left = 0 if not isinstance(left,(int, float)) else left    right = len(arr)-1 if not isinstance(right,(int, float)) else right    if left &lt; right:        partitionIndex = partition(arr, left, right)        quickSort(arr, left, partitionIndex-1)        quickSort(arr, partitionIndex+1, right)    return arrdef partition(arr, left, right):    pivot = left    index = pivot+1    i = index    while  i &lt;= right:        if arr[i] &lt; arr[pivot]:            swap(arr, i, index)            index+=1        i+=1    swap(arr,pivot,index-1)    return index-1def swap(arr, i, j):    arr[i], arr[j] = arr[j], arr[i]å †æ’åº(Heap Sort)å †æ’åº(Heapsort)æ˜¯åˆ©ç”¨å †è¿™ç§æ•°æ®ç»“æ„æ‰€è®¾è®¡çš„ä¸€ç§æ’åºç®—æ³•å †æ˜¯ä¸€ä¸ªè¿‘ä¼¼å®Œå…¨äºŒå‰æ ‘çš„ç»“æ„ï¼Œå¹¶åŒæ—¶æ»¡è¶³å †ç§¯çš„æ€§è´¨ï¼šå³å­ç»“ç‚¹çš„é”®å€¼æˆ–ç´¢å¼•æ€»æ˜¯å°äº(æˆ–è€…å¤§äº)å®ƒçš„çˆ¶èŠ‚ç‚¹ç®—æ³•æè¿°å°†åˆå§‹å¾…æ’åºå…³é”®å­—åºåˆ—(R1, R2 â€¦. Rn)æ„å»ºæˆå¤§é¡¶å †ï¼Œæ­¤å †ä¸ºåˆå§‹çš„æ— åºåŒºå°†å †é¡¶å…ƒç´ R[1]ä¸æœ€åä¸€ä¸ªå…ƒç´ R[n]äº¤æ¢ï¼Œæ­¤æ—¶å¾—åˆ°æ–°çš„æ— åºåŒº(R1, R2, â€¦ Rn-1)å’Œæ–°çš„æœ‰åºåŒº(Rn)ï¼Œä¸”æ»¡è¶³R[1, 2 â€¦ n-1]&lt;=R[n]ç”±äºäº¤æ¢åæ–°çš„å †é¡¶R[1]å¯èƒ½è¿åå †çš„æ€§è´¨ï¼Œå› æ­¤éœ€è¦å¯¹å½“å‰æ— åºåŒº(R1,R2,â€¦â€¦Rn-1)è°ƒæ•´ä¸ºæ–°å †ï¼Œç„¶åå†æ¬¡å°†R[1]ä¸æ— åºåŒºæœ€åä¸€ä¸ªå…ƒç´ äº¤æ¢ï¼Œå¾—åˆ°æ–°çš„æ— åºåŒº(R1,R2â€¦.Rn-2)å’Œæ–°çš„æœ‰åºåŒº(Rn-1,Rn)ï¼Œä¸æ–­é‡å¤æ­¤è¿‡ç¨‹ç›´åˆ°æœ‰åºåŒºçš„å…ƒç´ ä¸ªæ•°ä¸ºn-1ï¼Œåˆ™æ•´ä¸ªæ’åºè¿‡ç¨‹å®ŒæˆåŠ¨å›¾æ¼”ç¤ºä»£ç å®ç°123456789101112131415161718192021222324252627282930def buildMaxHeap(arr):    import math    for i in range(math.floor(len(arr)/2),-1,-1):        heapify(arr,i)def heapify(arr, i):    left = 2*i+1    right = 2*i+2    largest = i    if left &lt; arrLen and arr[left] &gt; arr[largest]:        largest = left    if right &lt; arrLen and arr[right] &gt; arr[largest]:        largest = right    if largest != i:        swap(arr, i, largest)        heapify(arr, largest)def swap(arr, i, j):    arr[i], arr[j] = arr[j], arr[i]def heapSort(arr):    global arrLen    arrLen = len(arr)    buildMaxHeap(arr)    for i in range(len(arr)-1,0,-1):        swap(arr,0,i)        arrLen -=1        heapify(arr, 0)    return arréæ¯”è¾ƒç±»è¿™ä¸‰ç§æ’åºç®—æ³•éƒ½åˆ©ç”¨äº†æ¡¶çš„æ¦‚å¿µï¼Œä½†å¯¹æ¡¶çš„ä½¿ç”¨æ–¹æ³•ä¸Šæœ‰æ˜æ˜¾å·®å¼‚ï¼šåŸºæ•°æ’åºï¼šæ ¹æ®é”®å€¼çš„æ¯ä½æ•°å­—æ¥åˆ†é…æ¡¶è®¡æ•°æ’åºï¼šæ¯ä¸ªæ¡¶åªå­˜å‚¨å•ä¸€é”®å€¼æ¡¶æ’åºï¼šæ¯ä¸ªæ¡¶å­˜å‚¨ä¸€å®šèŒƒå›´çš„æ•°å€¼è®¡æ•°æ’åº(Counting Sort)è®¡æ•°æ’åºä¸æ˜¯åŸºäºæ¯”è¾ƒçš„æ’åºç®—æ³•ï¼Œå…¶æ ¸å¿ƒåœ¨äºå°†è¾“å…¥çš„æ•°æ®å€¼è½¬åŒ–ä¸ºé”®å­˜å‚¨åœ¨é¢å¤–å¼€è¾Ÿçš„æ•°ç»„ç©ºé—´ä¸­ä½œä¸ºä¸€ç§çº¿æ€§æ—¶é—´å¤æ‚åº¦çš„æ’åºï¼Œè®¡æ•°æ’åºè¦æ±‚è¾“å…¥çš„æ•°æ®å¿…é¡»æ˜¯æœ‰ç¡®å®šèŒƒå›´çš„æ•´æ•°ç®—æ³•æè¿°æ‰¾å‡ºå¾…æ’åºçš„æ•°ç»„ä¸­æœ€å¤§å’Œæœ€å°çš„å…ƒç´ ç»Ÿè®¡æ•°ç»„ä¸­æ¯ä¸ªå€¼ä¸ºiçš„å…ƒç´ å‡ºç°çš„æ¬¡æ•°ï¼Œå­˜å…¥æ•°ç»„Cçš„ç¬¬ié¡¹å¯¹æ‰€æœ‰çš„è®¡æ•°ç´¯åŠ (ä»Cä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹ï¼Œæ¯ä¸€é¡¹å’Œå‰ä¸€é¡¹ç›¸åŠ )åå‘å¡«å……ç›®æ ‡æ•°ç»„: å°†æ¯ä¸ªå…ƒç´ iæ”¾åœ¨æ–°æ•°ç»„çš„ç¬¬C(i)é¡¹ï¼Œæ¯æ”¾ä¸€ä¸ªå…ƒç´ å°±å°†C(i)å‡å»1åŠ¨å›¾æ¼”ç¤ºä»£ç å®ç°123456789101112131415def countingSort(arr, maxValue):    bucketLen = maxValue+1    bucket = [0]*bucketLen    sortedIndex =0    arrLen = len(arr)    for i in range(arrLen):        if not bucket[arr[i]]:            bucket[arr[i]]=0        bucket[arr[i]]+=1    for j in range(bucketLen):        while bucket[j]&gt;0:            arr[sortedIndex] = j            sortedIndex+=1            bucket[j]-=1    return arrä¼˜ç¼ºç‚¹å½“æ•°åˆ—æœ€å¤§æœ€å°å€¼å·®è·è¿‡å¤§æ—¶ï¼Œå¹¶ä¸é€‚ç”¨è®¡æ•°æ’åºå½“æ•°åˆ—å…ƒç´ ä¸æ˜¯æ•´æ•°ï¼Œå¹¶ä¸é€‚ç”¨è®¡æ•°æ’åºä¼˜åŒ–ç‰ˆæœ¬çš„è®¡æ•°æ’åºå±äºç¨³å®šæ’åºæ¡¶æ’åº(Bucket Sort)æ¡¶æ’åºæ˜¯è®¡æ•°æ’åºçš„å‡çº§ç‰ˆï¼Œå®ƒåˆ©ç”¨äº†å‡½æ•°çš„æ˜ å°„å…³ç³»ï¼Œé«˜æ•ˆä¸å¦çš„å…³é”®å°±åœ¨äºè¿™ä¸ªæ˜ å°„å‡½æ•°çš„ç¡®å®šæ¡¶æ’åº(Bucket sort)çš„å·¥ä½œçš„åŸç†ï¼šå‡è®¾è¾“å…¥æ•°æ®æœä»å‡åŒ€åˆ†å¸ƒï¼Œå°†æ•°æ®åˆ†åˆ°æœ‰é™æ•°é‡çš„æ¡¶é‡Œï¼Œæ¯ä¸ªæ¡¶å†åˆ†åˆ«æ’åº(æœ‰å¯èƒ½å†ä½¿ç”¨åˆ«çš„æ’åºç®—æ³•æˆ–æ˜¯ä»¥é€’å½’æ–¹å¼ç»§ç»­ä½¿ç”¨æ¡¶æ’åºè¿›è¡Œæ’)ç®—æ³•æè¿°è®¾ç½®ä¸€ä¸ªå®šé‡çš„æ•°ç»„å½“ä½œç©ºæ¡¶éå†è¾“å…¥æ•°æ®ï¼Œå¹¶ä¸”æŠŠæ•°æ®ä¸€ä¸ªä¸€ä¸ªæ”¾åˆ°å¯¹åº”çš„æ¡¶é‡Œå»å¯¹æ¯ä¸ªä¸æ˜¯ç©ºçš„æ¡¶è¿›è¡Œæ’åºä»ä¸æ˜¯ç©ºçš„æ¡¶é‡ŒæŠŠæ’å¥½åºçš„æ•°æ®æ‹¼æ¥èµ·æ¥å›¾ç‰‡æ¼”ç¤ºä»£ç å®ç°1234567891011def bucket_sort(array):    min_num, max_num = min(array), max(array)    bucket_num = (max_num-min_num)//3 + 1    buckets = [[] for _ in range(int(bucket_num))]    for num in array:        buckets[int((num-min_num)//3)].append(num)    new_array = list()    for i in buckets:        for j in sorted(i):            new_array.append(j)    return new_arrayåŸºæ•°æ’åºï¼ˆRadix Sortï¼‰åŸºæ•°æ’åºæ˜¯æŒ‰ç…§ä½ä½å…ˆæ’åºï¼Œç„¶åæ”¶é›†ï¼›å†æŒ‰ç…§é«˜ä½æ’åºï¼Œç„¶åå†æ”¶é›†ï¼›ä¾æ¬¡ç±»æ¨ï¼Œç›´åˆ°æœ€é«˜ä½æœ‰æ—¶å€™æœ‰äº›å±æ€§æ˜¯æœ‰ä¼˜å…ˆçº§é¡ºåºçš„ï¼Œå…ˆæŒ‰ä½ä¼˜å…ˆçº§æ’åºï¼Œå†æŒ‰é«˜ä¼˜å…ˆçº§æ’åºæœ€åçš„æ¬¡åºå°±æ˜¯é«˜ä¼˜å…ˆçº§é«˜çš„åœ¨å‰ï¼Œé«˜ä¼˜å…ˆçº§ç›¸åŒçš„ä½ä¼˜å…ˆçº§é«˜çš„åœ¨å‰ç®—æ³•æè¿°å–å¾—æ•°ç»„ä¸­çš„æœ€å¤§æ•°ï¼Œå¹¶å–å¾—ä½æ•°arrä¸ºåŸå§‹æ•°ç»„ï¼Œä»æœ€ä½ä½å¼€å§‹å–æ¯ä¸ªä½ç»„æˆradixæ•°ç»„å¯¹radixè¿›è¡Œè®¡æ•°æ’åº(åˆ©ç”¨è®¡æ•°æ’åºé€‚ç”¨äºå°èŒƒå›´æ•°çš„ç‰¹ç‚¹)åŠ¨å›¾æ¼”ç¤ºä»£ç å®ç°123456789101112131415def radix_sort(array):    max_num = max(array)    place = 1    while max_num &gt;= 10**place:        place += 1    for i in range(place):        buckets = [[] for _ in range(10)]        for num in array:            radix = int(num/(10**i) % 10)            buckets[radix].append(num)        j = 0        for k in range(10):            for num in buckets[k]:                array[j] = num                j += 1æ€»ç»“ä½¿ç”¨åœºæ™¯å¦‚æœå¾…æ’åºåˆ—ä¸­æ•°æ®å«æœ‰å¤§é‡é‡å¤å€¼â€”â€”ä¼˜å…ˆä½¿ç”¨è®¡æ•°æ’åºå¦‚æœå¾…æ’åºåˆ—ä¸­æ•°æ®è¿‘ä¹æœ‰åºâ€”â€”ä¼˜å…ˆä½¿ç”¨æ’å…¥æ’åºå¦‚æœå¾…æ’åºåˆ—ä¸­æ•°æ®å–å€¼èŒƒå›´æœ‰é™â€”â€”ä¼˜å…ˆä½¿ç”¨è®¡æ•°æ’åºå¦‚æœå¾…æ’åºåˆ—ä¸­æ•°æ®è¦æ±‚ç¨³å®šâ€”â€”ä¼˜å…ˆä½¿ç”¨å½’å¹¶æ’åºå¦‚æœå¾…æ’åºåˆ—éœ€è¦ä½¿ç”¨é“¾è¡¨â€”â€”ä¼˜å…ˆé“¾è¡¨å½’å¹¶ã€é“¾è¡¨å¿«æ’å¦‚æœå¾…æ’åºåˆ—ä¸­æ•°æ®æ— æ³•å…¨éƒ¨è£…åˆ°å†…å­˜â€”â€”ä¼˜å…ˆä½¿ç”¨å¤–éƒ¨æ’åºä¼˜ç¼ºç‚¹xxx</content>
	</entry>
	<entry>
		<title>æœºå™¨å­¦ä¹ _æœ€ä¼˜åŒ–æ–¹æ³•</title>
		<url>/article/58730.html</url>
		<content>å†™åœ¨å‰é¢ï¼Œæœ¬ç³»åˆ—ä¸»è¦æ˜¯å¯¹ä¸‹é¢è¿™æœ¬ä¹¦åšçš„å­¦ä¹ ç¬”è®°å¸¸ç”¨æ•°å­¦ç¬¦å·çš„ LaTeX è¡¨ç¤ºæ–¹æ³•Markdown å¸¸ç”¨æ•°å­¦ç¬¦å·å’Œå…¬å¼åŸºæœ¬æ¦‚å¿µå‰è¨€æœ€ä¼˜åŒ–æ–¹æ³•åœ¨æœºå™¨å­¦ä¹ é¢†åŸŸå¤„äºä¸­å¿ƒåœ°ä½ï¼Œç»å¤§å¤šæ•°ç®—æ³•æœ€åéƒ½å½’ç»“äºæ±‚è§£æœ€ä¼˜åŒ–é—®é¢˜ï¼Œä»è€Œç¡®å®šæ¨¡å‹å‚æ•°ï¼Œæˆ–ç›´æ¥è·å¾—é¢„æµ‹ç»“æœæœ‰ç›‘ç£å­¦ä¹ ï¼Œé€šè¿‡æœ€å°åŒ–æŸå¤±å‡½æ•°æˆ–ä¼˜åŒ–å…¶ä»–ç±»å‹çš„ç›®æ ‡å‡½æ•°ç¡®å®šæ¨¡å‹çš„å‚æ•°æ•°æ®é™ç»´ç®—æ³•ï¼Œé€šè¿‡ä¼˜åŒ–æŸç§ç›®æ ‡å‡½æ•°ï¼Œç¡®å®šé™ç»´åçš„ç»“æœï¼Œå¦‚ä¸»æˆåˆ†åˆ†ææŒ‰ç…§ä¼˜åŒ–å˜é‡çš„ç±»å‹ï¼Œå¯ä»¥å°†ä¼˜åŒ–é—®é¢˜åˆ†ä¸ºè¿ç»­å‹ä¼˜åŒ–é—®é¢˜ä¸ç¦»æ•£å‹ä¼˜åŒ–é—®é¢˜è¿ç»­å‹ä¼˜åŒ–é—®é¢˜çš„ä¼˜åŒ–å˜é‡æ˜¯è¿ç»­å˜é‡ï¼Œä¸€èˆ¬å¯å€ŸåŠ©å¯¼æ•°æ±‚è§£ç¦»æ•£å‹ä¼˜åŒ–é—®é¢˜çš„ä¼˜åŒ–å˜é‡åˆ™ä¸ºç¦»æ•£å€¼è¿ç»­å‹ä¼˜åŒ–é—®é¢˜åˆå¯åˆ†ä¸ºå‡¸ä¼˜åŒ–é—®é¢˜ä¸éå‡¸ä¼˜åŒ–é—®é¢˜ï¼Œå‡¸ä¼˜åŒ–é—®é¢˜å¯ä»¥ä¿è¯æ±‚å¾—å…¨å±€æœ€ä¼˜è§£æŒ‰ç…§ç›®æ ‡å‡½æ•°çš„æ•°é‡å•ç›®æ ‡ä¼˜åŒ–ï¼šåªæœ‰ä¸€ä¸ªç›®æ ‡å‡½æ•°,å¤šç›®æ ‡ä¼˜åŒ–ï¼šæœ‰å¤šä¸ªç›®æ ‡å‡½æ•°æŒ‰ç…§æ˜¯å¦å¸¦æœ‰çº¦æŸæ¡ä»¶ä¸å¸¦çº¦æŸçš„ä¼˜åŒ–å¸¦çº¦æŸçš„ä¼˜åŒ–æŒ‰ç…§æ±‚è§£æ–¹å¼å¯åˆ†ä¸ºæ•°å€¼ä¼˜åŒ–ï¼šæ±‚é—®é¢˜çš„è¿‘ä¼¼è§£è§£æè§£ï¼šæ±‚ç²¾ç¡®çš„å…¬å¼è§£åŸºäºæ¦‚ç‡çš„ä¼˜åŒ–ç®—æ³•æ˜¯ä¼˜åŒ–ç®—æ³•å®¶æ—ä¸­ä¸€ç§ç‰¹æ®Šçš„å­˜åœ¨ï¼Œå…¸å‹çš„æ˜¯é—ä¼ ç®—æ³•ä¸è´å¶æ–¯ä¼˜åŒ–é€šå¸¸æƒ…å†µä¸‹æœ€ä¼˜åŒ–é—®é¢˜æ˜¯æ±‚å‡½æ•°çš„æå€¼ï¼Œå…¶ä¼˜åŒ–å˜é‡æ˜¯æ•´æ•°æˆ–å®æ•°æœ‰ä¸€ç±»ç‰¹æ®Šçš„ä¼˜åŒ–é—®é¢˜ï¼Œå…¶ç›®æ ‡æ˜¯å¯»æ‰¾æŸä¸€å‡½æ•°ï¼Œä½¿å¾—æ³›å‡½çš„å€¼æœ€å¤§åŒ–æˆ–æœ€å°åŒ–ï¼Œå˜åˆ†æ³•æ˜¯æ±‚è§£æ­¤ç±»é—®é¢˜çš„ç»å…¸æ–¹æ³•åŸºæœ¬æ¦‚å¿µæœ€ä¼˜åŒ–é—®é¢˜çš„ç›®æ ‡æ˜¯æ±‚å‡½æ•°æˆ–æ³›å‡½çš„æå€¼(Extrema)ï¼Œåœ¨åŸºç¡€æ•°å­¦ã€è®¡ç®—æ•°å­¦ã€åº”ç”¨æ•°å­¦ä»¥åŠå·¥ç¨‹ã€ç®¡ç†ã€ç»æµå­¦é¢†åŸŸå‡æœ‰åº”ç”¨æœ€ä¼˜åŒ–ç®—æ³•æ˜¯æ±‚è§£æœ€ä¼˜åŒ–é—®é¢˜çš„æ–¹æ³•ç¡®å®šä¼˜åŒ–ç›®æ ‡å‡½æ•°ä¹‹åï¼Œéœ€è¦æ ¹æ®é—®é¢˜çš„ç‰¹ç‚¹ä»¥åŠç°å®æ¡ä»¶çš„é™åˆ¶é€‰æ‹åˆé€‚çš„ç®—æ³•åœ¨æœºå™¨å­¦ä¹ ä¸æ·±åº¦å­¦ä¹ åº“ä¸­ï¼Œæœ€ä¼˜åŒ–ç®—æ³•é€šå¸¸ä»¥ä¼˜åŒ–å™¨(Optimizer)æˆ–æ±‚è§£å™¨(Solver)çš„å½¢å¼å‡ºç°é—®é¢˜å®šä¹‰æ¥ä¸‹æ¥è€ƒè™‘çš„æœ€ä¼˜åŒ–é—®é¢˜æ˜¯æ±‚è§£å‡½æ•°æå€¼çš„é—®é¢˜ï¼ŒåŒ…æ‹¬æå¤§å€¼ä¸æå°å€¼è¦è®¡ç®—æå€¼çš„å‡½æ•°ç§°ä¸ºç›®æ ‡å‡½æ•°ï¼Œå…¶è‡ªå˜é‡ç§°ä¸ºä¼˜åŒ–å˜é‡ï¼Œå¯¹äºå‡½æ•°å…¶æå°å€¼åœ¨$x=2$ç‚¹å¤„å–å¾—ï¼Œæ­¤æ—¶å‡½æ•°å€¼ä¸º$5$ï¼Œ$x=2$ ä¸ºè¯¥é—®é¢˜çš„è§£ä¸€èˆ¬å°†æœ€ä¼˜åŒ–é—®é¢˜ç»Ÿä¸€è¡¨è¿°ä¸ºæå°å€¼é—®é¢˜ï¼Œå¯¹äºæå¤§å€¼é—®é¢˜ï¼Œåªéœ€è¦å°†ç›®æ ‡å‡½æ•°åå·ï¼Œå³å¯è½¬åŒ–ä¸ºæå°å€¼é—®é¢˜è¦æ±‚$f(x)$çš„æå¤§å€¼ï¼Œç­‰ä»·äºæ±‚$-f(x)$çš„æå°å€¼ï¼Œæœ€ä¼˜åŒ–é—®é¢˜å¯ä»¥å½¢å¼åŒ–åœ°å®šä¹‰ä¸ºå…¶ä¸­$x$ä¸ºä¼˜åŒ–å˜é‡ï¼Œ$f$ä¸ºç›®æ ‡å‡½æ•°ï¼Œ$X \subseteq \mathbb{R}^{n}$ä¸ºä¼˜åŒ–å˜é‡å…è®¸çš„å–å€¼é›†åˆï¼Œç§°ä¸ºå¯è¡ŒåŸŸ(Feasible Set)ï¼Œå®ƒç”±ç›®æ ‡å‡½æ•°çš„å®šä¹‰åŸŸã€ç­‰å¼åŠä¸ç­‰å¼çº¦æŸ(Constraint Function)å…±åŒç¡®å®šå¯è¡ŒåŸŸä¹‹å†…çš„è§£ç§°ä¸ºå¯è¡Œè§£(Feasible Solution)ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªå…¸å‹çš„æœ€ä¼˜åŒ–é—®é¢˜è¯¥é—®é¢˜çš„å¯è¡ŒåŸŸä¸ºåŒºé—´$[-10,10]$ï¼Œå¦‚ä¸è¿›è¡Œç‰¹æ®Šè¯´æ˜ï¼Œè¿™é‡Œç›®æ ‡å‡½æ•°å‡æŒ‡å¤šå…ƒå‡½æ•°ï¼Œä¸€å…ƒå‡½æ•°ä¸ºå…¶ç‰¹ä¾‹ï¼Œæ— é¡»å•ç‹¬è®¨è®ºçº¿æ€§è§„åˆ’ï¼šç›®æ ‡å‡½æ•°ä¸ºä¸€æ¬¡å‡½æ•°(çº¿æ€§å‡½æ•°)éçº¿æ€§è§„åˆ’ï¼šç›®æ ‡å‡½æ•°æ˜¯éçº¿æ€§å‡½æ•°éçº¿æ€§è§„åˆ’çš„ä¸€ç§ç‰¹ä¾‹æ˜¯ç›®æ ‡å‡½æ•°ä¸ºäºŒæ¬¡å‡½æ•°ï¼Œç§°ä¸ºäºŒæ¬¡è§„åˆ’å¾ˆå¤šå®é™…åº”ç”¨é—®é¢˜å¯èƒ½å¸¦æœ‰ç­‰å¼å’Œä¸ç­‰å¼çº¦æŸæ¡ä»¶ï¼Œå¯ä»¥å†™æˆè¿™é‡Œå°†ä¸ç­‰å¼çº¦æŸç»Ÿä¸€å†™æˆå°äºæˆ–ç­‰äºå·çš„å½¢å¼ï¼Œæ»¡è¶³ç­‰å¼å’Œä¸ç­‰å¼çº¦æŸæ¡ä»¶çš„è§£ç§°ä¸ºå¯è¡Œè§£ï¼Œå¦åˆ™ç§°ä¸ºä¸å¯è¡Œè§£ä¸‹é¢æ˜¯ä¸€ä¸ªå¸¦æœ‰ç­‰å¼å’Œä¸ç­‰å¼çº¦æŸçš„ä¼˜åŒ–é—®é¢˜ç­‰å¼å’Œä¸ç­‰å¼çº¦æŸå®šä¹‰çš„åŒºåŸŸä¸ç›®æ ‡å‡½æ•°å®šä¹‰åŸŸçš„äº¤é›†ä¸ºå¯è¡ŒåŸŸæ­¤é—®é¢˜çš„å¯è¡ŒåŸŸä¸ºçº¦æŸæ¡ä»¶$x+y=1$ä¸$x^{2}+y^{2} \leqslant 4$æ‰€å®šä¹‰çš„äº¤é›†ï¼Œæ˜¯ç›´çº¿ä½äºåœ†å†…çš„éƒ¨åˆ†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºxxxå›¾å¯è¡ŒåŸŸç¤ºæ„å›¾åœ¨å¾ˆå¤šå®é™…é—®é¢˜ä¸­å‡ºç°çš„äºŒæ¬¡è§„åˆ’å¯ä»¥å†™æˆä¸‹é¢çš„å½¢å¼å…¶ä¸­$x \in \mathbb{R}^{n}$ï¼Œ$Q$æ˜¯$n \times n$çš„äºŒæ¬¡é¡¹ç³»æ•°çŸ©é˜µï¼Œ$c \in \mathbb{R}^{n}$æ˜¯ä¸€æ¬¡é¡¹ç³»æ•°å‘é‡$\boldsymbol{A}$æ˜¯$m \times n$çš„ä¸ç­‰å¼çº¦æŸç³»æ•°çŸ©é˜µï¼Œ$\boldsymbol{b} \in \mathbb{R}^{m}$æ˜¯ä¸ç­‰å¼çº¦æŸçš„å¸¸æ•°å‘é‡å±€éƒ¨æœ€ä¼˜è§£ä¸å…¨å±€æœ€ä¼˜è§£å‡è®¾æ˜¯ä¸€ä¸ªå¯è¡Œè§£ï¼Œå¦‚æœå¯¹å¯è¡ŒåŸŸå†…æ‰€æœ‰ç‚¹éƒ½æœ‰ï¼Œåˆ™ç§°ä¸ºå…¨å±€æå°å€¼ç±»ä¼¼åœ°å¯ä»¥å®šä¹‰å…¨å±€æå¤§å€¼å…¨å±€æå°å€¼æ˜¯æœ€ä¼˜åŒ–é—®é¢˜çš„è§£å¯¹äºå¯è¡Œè§£ï¼Œå¦‚æœå­˜åœ¨å…¶é‚»åŸŸï¼Œä½¿å¾—è¯¥é‚»åŸŸå†…çš„æ‰€æœ‰ç‚¹å³æ‰€æœ‰æ»¡è¶³çš„ç‚¹ï¼Œéƒ½æœ‰ï¼Œåˆ™ç§°ä¸ºå±€éƒ¨æå°å€¼ç±»ä¼¼åœ°å¯ä»¥å®šä¹‰å±€éƒ¨æå¤§å€¼å±€éƒ¨æå°å€¼å¯èƒ½æ˜¯æœ€ä¼˜åŒ–é—®é¢˜çš„è§£ï¼Œä¹Ÿå¯èƒ½ä¸æ˜¯æœ€ä¼˜åŒ–ç®—æ³•çš„ç›®æ ‡æ˜¯å¯»æ‰¾ç›®æ ‡å‡½æ•°çš„å…¨å±€æå€¼ç‚¹è€Œéå±€éƒ¨æå€¼ç‚¹ã€‚ä¸‹å›¾ä¸ºå…¨å±€æœ€ä¼˜è§£ä¸å±€éƒ¨æœ€ä¼˜è§£çš„ç¤ºæ„å›¾ï¼Œç›®æ ‡å‡½æ•°ä¸ºxxxå›¾å…¨å±€æœ€ä¼˜è§£ä¸å±€éƒ¨æœ€ä¼˜è§£ä¸Šå›¾ä¸­çš„ç›®æ ‡å‡½æ•°æœ‰ä¸¤ä¸ªå±€éƒ¨æå¤§å€¼ç‚¹ã€1ä¸ªå±€éƒ¨æå°å€¼ç‚¹ï¼ŒåŒºé—´$[0,2]$å†…çš„å±€éƒ¨æå¤§å€¼ç‚¹ä¹Ÿæ˜¯å…¨å±€æå¤§å€¼ç‚¹è¿­ä»£æ³•çš„åŸºæœ¬æ€æƒ³å¦‚æœç›®æ ‡å‡½æ•°å¯å¯¼ï¼Œé‚£ä¹ˆå¯ä»¥åˆ©ç”¨å¯¼æ•°ä¿¡æ¯ç¡®å®šæå€¼ç‚¹å¾®ç§¯åˆ†ä¸ºæ±‚è§£å¯å¯¼å‡½æ•°æå€¼æä¾›äº†ç»Ÿä¸€çš„æ–¹æ³•ï¼Œå³å¯»æ‰¾å‡½æ•°çš„é©»ç‚¹æ ¹æ®è´¹é©¬å¼•ç†ï¼Œå¯¹äºä¸€å…ƒå‡½æ•°å±€éƒ¨æå€¼ç‚¹å¿…å®šæ˜¯å¯¼æ•°ä¸º0çš„ç‚¹ï¼›å¯¹äºå¤šå…ƒå‡½æ•°åˆ™æ˜¯æ¢¯åº¦ä¸º0çš„ç‚¹(åœ¨æ•°å€¼è®¡ç®—ä¸­ï¼Œä¹Ÿç§°ä¸ºé™æ­¢ç‚¹(Stationary Point)æœºå™¨å­¦ä¹ ä¸­ç»å¤§å¤šæ•°ç›®æ ‡å‡½æ•°å¯å¯¼ï¼Œå› æ­¤è¿™ç§æ–¹æ³•æ˜¯é€‚ç”¨çš„é€šè¿‡æ±‚è§£é©»ç‚¹æ¥å¯»æ‰¾æå€¼è™½ç„¶åœ¨ç†è®ºä¸Šå¯è¡Œï¼Œä½†å®ç°æ—¶å´å­˜åœ¨å›°éš¾å®é™…é—®é¢˜ä¸­ç›®æ ‡å‡½æ•°æ¢¯åº¦ä¸º0çš„æ–¹ç¨‹ç»„é€šå¸¸éš¾ä»¥æ±‚è§£ï¼Œå¯¹äºä¸‹é¢çš„äºŒå…ƒç›®æ ‡å‡½æ•°å¯¹$x$å’Œ$y$åˆ†åˆ«æ±‚åå¯¼æ•°å¹¶ä»¤å®ƒä»¬ä¸º0ï¼Œå¾—åˆ°å¦‚ä¸‹æ–¹ç¨‹ç»„æ˜¾ç„¶ï¼Œè¿™ä¸ªæ–¹ç¨‹ç»„å¾ˆéš¾æ±‚è§£ï¼Œå«æœ‰æŒ‡æ•°å‡½æ•°ã€å¯¹æ•°å‡½æ•°ã€ä¸‰è§’å‡½æ•°ä»¥åŠåä¸‰è§’å‡½æ•°çš„æ–¹ç¨‹ä¸€èˆ¬æƒ…å†µä¸‹æ²¡æœ‰å…¬å¼è§£ï¼Œç§°ä¸ºè¶…è¶Šæ–¹ç¨‹å³ä½¿æ˜¯ä»£æ•°æ–¹ç¨‹(å¤šé¡¹å¼æ–¹ç¨‹)ï¼Œ4æ¬¡ä»¥ä¸Šçš„æ–¹ç¨‹æ²¡æœ‰æ±‚æ ¹å…¬å¼æ–¹ç¨‹ç³»æ•°çš„æœ‰é™æ¬¡åŠ å‡ä¹˜é™¤ä»¥åŠå¼€æ–¹è¿ç®—å‡ä¸å¯èƒ½æ˜¯æ–¹ç¨‹çš„æ ¹å› æ­¤ï¼Œç›´æ¥è§£å¯¼æ•°ä¸º0çš„æ–¹ç¨‹ç»„ä¸æ˜¯ä¸€ç§å¯è¡Œçš„æ–¹æ³•å¯¹äºå¤§å¤šæ•°æœ€ä¼˜åŒ–é—®é¢˜é€šå¸¸åªèƒ½è¿‘ä¼¼æ±‚è§£ï¼Œç§°ä¸ºæ•°å€¼ä¼˜åŒ–ä¸€èˆ¬é‡‡ç”¨è¿­ä»£æ³•ï¼Œä»ä¸€ä¸ªåˆå§‹å¯è¡Œç‚¹$x_{0}$å¼€å§‹ï¼Œåå¤ä½¿ç”¨æŸç§è§„åˆ™è¿­ä»£ç›´è‡³æ”¶æ•›åˆ°æœ€ä¼˜è§£å…·ä½“åœ°ï¼Œåœ¨ç¬¬æ¬¡è¿­ä»£æ—¶ï¼Œä»å½“å‰ç‚¹ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªç‚¹å¦‚æœèƒ½æ„é€ ä¸€ä¸ªæ•°åˆ—${x_k}$ï¼Œä¿è¯å®ƒæ”¶æ•›åˆ°æ¢¯åº¦ä¸º0çš„ç‚¹ï¼Œå³ä¸‹é¢çš„æé™æˆç«‹åˆ™èƒ½æ‰¾åˆ°å‡½æ•°çš„æå€¼ç‚¹ç®—æ³•çš„æ ¸å¿ƒ1ï¸âƒ£å¦‚ä½•å®šä¹‰ä»ä¸Šä¸€ä¸ªç‚¹ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªç‚¹çš„è§„åˆ™ï¼Œè¿™äº›è§„åˆ™ä¸€èˆ¬åˆ©ç”¨ä¸€é˜¶å¯¼æ•°(æ¢¯åº¦)æˆ–äºŒé˜¶å¯¼æ•°(é»‘å¡çŸ©é˜µ)å› æ­¤ï¼Œè¿­ä»£æ³•çš„æ ¸å¿ƒæ˜¯å¾—åˆ°å¦‚ä¸‹å¼å½¢å¼çš„è¿­ä»£å…¬å¼æ¢¯åº¦ä¸‹é™æ³•ï¼Œç‰›é¡¿æ³•åŠæ‹Ÿç‰›é¡¿æ³•å‡é‡‡ç”¨äº†æ­¤æ€è·¯ï¼ŒåŒºåˆ«åœ¨äºæ„é€ è¿­ä»£å…¬å¼çš„æ–¹æ³•ä¸åŒï¼Œè¿­ä»£æ³•çš„åŸç†å¦‚å›¾æ‰€ç¤ºxxxå›¾è¿­ä»£æ³•çš„åŸç†2ï¸âƒ£åˆå§‹ç‚¹$\boldsymbol{x}_{0}$çš„é€‰æ‹©ï¼Œé€šå¸¸ç”¨å¸¸æ•°æˆ–éšæœºæ•°è¿›è¡Œåˆå§‹åŒ–ç®—æ³•è¦ä¿è¯å¯¹ä»»æ„å¯è¡Œçš„$x_{0}$å‡æ”¶æ•›åˆ°æå€¼ç‚¹å¤„ä¸€é˜¶ä¼˜åŒ–ç®—æ³•ä¸€é˜¶ä¼˜åŒ–ç®—æ³•åˆ©ç”¨ç›®æ ‡å‡½æ•°çš„ä¸€é˜¶å¯¼æ•°æ„é€ è¿­ä»£å…¬å¼ï¼Œå…¸å‹ä»£è¡¨æ˜¯æ¢¯åº¦ä¸‹é™æ³•åŠå…¶å˜ç§æœ¬èŠ‚ä»‹ç»åŸºæœ¬çš„æ¢¯åº¦ä¸‹é™æ³•ã€æœ€é€Ÿä¸‹é™æ³•ã€æ¢¯åº¦ä¸‹é™æ³•çš„å…¶ä»–æ”¹è¿›ç‰ˆæœ¬(åŒ…æ‹¬åŠ¨é‡é¡¹ã€ AdaGradã€RMSPropã€AdaDeltaã€Adam ç®—æ³•ç­‰)ä»¥åŠéšæœºæ¢¯åº¦ä¸‹é™æ³•æ¢¯åº¦ä¸‹é™æ³•æ¢¯åº¦ä¸‹é™æ³•(Gradient Descent Method)ç”±æ•°å­¦å®¶æŸ¯è¥¿æå‡ºï¼Œå®ƒæ²¿ç€å½“å‰ç‚¹å¤„æ¢¯åº¦ç›¸åçš„æ–¹å‘è¿›è¡Œè¿­ä»£ï¼Œå¾—åˆ°ï¼Œç›´è‡³æ”¶è‡´åˆ°æ¢¯åº¦ä¸º0çš„ç‚¹å…¶ç†è®ºä¾æ®ï¼šåœ¨æ¢¯åº¦ä¸ä¸º0çš„ä»»æ„ç‚¹å¤„ï¼Œæ¢¯åº¦æ­£æ–¹å‘æ˜¯å‡½æ•°å€¼ä¸Šå‡çš„æ–¹å‘ï¼Œæ¢¯åº¦åæ–¹å‘æ˜¯å‡½æ•°å€¼ä¸‹é™çš„æ–¹å‘ä¸‹é¢å…ˆé€šè¿‡ä¾‹å­è¯´æ˜ï¼Œç„¶åç»™å‡ºä¸¥æ ¼çš„è¯æ˜1ï¸âƒ£é¦–å…ˆè€ƒè™‘ä¸€å…ƒå‡½æ•°çš„æƒ…å†µï¼Œå¦‚å›¾æ‰€ç¤ºxxxå›¾ä¸€å…ƒå‡½æ•°çš„å¯¼æ•°å€¼ä¸å‡½æ•°å•è°ƒæ€§çš„å…³ç³»å¯¹äºä¸€å…ƒå‡½æ•°ï¼Œæ¢¯åº¦æ˜¯ä¸€ç»´çš„ï¼Œåªæœ‰ä¸¤ä¸ªæ–¹å‘ï¼šæ²¿ç€$x$è½´å‘å³å’Œå‘å·¦å¦‚æœå¯¼æ•°ä¸ºæ­£ï¼Œåˆ™æ¢¯åº¦å‘å³ï¼›å¦åˆ™å‘å·¦å½“å¯¼æ•°ä¸ºæ­£æ—¶ï¼Œæ˜¯å¢å‡½æ•°ï¼Œ$x$å˜é‡å‘å³ç§»åŠ¨æ—¶(å³æ²¿ç€æ¢¯åº¦æ–¹å‘)å‡½æ•°å€¼å¢å¤§ï¼Œå¦åˆ™å‡å°ï¼Œå¯¹äºä¸Šå›¾æ‰€ç¤ºçš„å‡½æ•°å½“$x&lt;x_{0}$æ—¶ï¼Œå¯¼æ•°ä¸ºæ­£ï¼Œæ­¤æ—¶å‘å·¦å‰è¿›å‡½æ•°å€¼å‡å°ï¼Œå‘å³åˆ™å¢å¤§å½“$x&gt;x_{0}$æ—¶ï¼Œå¯¼æ•°ä¸ºè´Ÿï¼Œæ­¤æ—¶å‘å·¦å‰è¿›å‡½æ•°å€¼å¢å¤§ï¼Œå‘å³åˆ™å‡å°2ï¸âƒ£æ¥ä¸‹æ¥è€ƒè™‘äºŒå…ƒå‡½æ•°ï¼ŒäºŒå…ƒå‡½æ•°çš„æ¢¯åº¦æœ‰æ— ç©·å¤šä¸ªæ–¹å‘å¯¹äºå‡½æ•°$x^{2}+y^{2}$ï¼Œå…¶åœ¨$(xï¼Œy)$ç‚¹å¤„çš„æ¢¯åº¦å€¼ä¸º$(2 xï¼Œ2 y)$ï¼Œå‡½æ•°åœ¨$(0,0)$ç‚¹å¤„æœ‰æå°å€¼ï¼Œåœ¨ä»»æ„ç‚¹$(xï¼Œy)$å¤„ï¼Œä»$(0,0)$ç‚¹æŒ‡å‘$(xï¼Œy)$æ–¹å‘(å³æ¢¯åº¦æ–¹å‘)çš„å‡½æ•°å€¼éƒ½æ˜¯å•è°ƒé€’å¢çš„è¯¥å‡½æ•°çš„å½¢çŠ¶å¦‚ä¸‹å›¾æ‰€ç¤ºxxxå›¾4.6$x^{2}+y^{2}$çš„å½¢çŠ¶ä¸‹å›¾ä¸ºè¯¥å‡½æ•°çš„ç­‰é«˜çº¿ï¼Œåœ¨åŒä¸€æ¡ç­‰é«˜çº¿ä¸Šçš„æ‰€æœ‰ç‚¹å¤„å‡½æ•°å€¼ç›¸ç­‰xxxå›¾4.6$x^{2}+y^{2}$çš„ç­‰é«˜çº¿åœ¨ä»»æ„ç‚¹å¤„ï¼Œæ¢¯åº¦å‡ä¸ºä»åŸç‚¹æŒ‡å‘è¯¥ç‚¹ï¼Œæ˜¯è¿œç¦»åŸç‚¹çš„æ–¹å‘ï¼Œå‡½æ•°å€¼å•è°ƒå¢ä¸‹é¢è€ƒè™‘å‡½æ•°$-x^{2}-y^{2}$ï¼Œå…¶åœ¨$(xï¼Œy)$ç‚¹å¤„çš„æ¢¯åº¦å€¼ä¸º$(-2 x,-2 y)$ï¼Œå‡½æ•°åœ¨$(0,0)$ç‚¹å¤„æœ‰æå¤§ å€¼ï¼Œåœ¨ä»»æ„ç‚¹$(xï¼Œy)$å¤„ï¼Œä»$(xï¼Œy)$ç‚¹æŒ‡å‘$(0,0)$æ–¹å‘çš„å‡½æ•°å€¼éƒ½æ˜¯å•è°ƒé€’å¢çš„ï¼Œ$(-x,-y)$å³æ¢¯åº¦ æ–¹å‘ï¼Œä¸‹å›¾ä¸ºè¯¥ç›®æ ‡å‡½æ•°çš„å½¢çŠ¶xxxå›¾$-x^{2}-y^{2}$çš„å½¢çŠ¶ä¸‹é¢ç»™å‡ºä¸¥æ ¼çš„è¯æ˜ï¼Œå°†å‡½æ•°åœ¨$\boldsymbol{x}$ç‚¹å¤„ä½œä¸€é˜¶æ³°å‹’å±•å¼€å¯¹ä¸Šå¼å˜å½¢ï¼Œå‡½æ•°çš„å¢é‡ä¸è‡ªå˜é‡å¢é‡ã€å‡½æ•°æ¢¯åº¦çš„å…³ç³»ä¸ºå¦‚æœä»¤$\Delta \boldsymbol{x}=\nabla f(\boldsymbol{x})$ï¼Œåˆ™æœ‰å¦‚æœ$\Delta x$è¶³å¤Ÿå°ï¼Œåˆ™å¯ä»¥å¿½ç•¥é«˜é˜¶æ— ç©·å°é¡¹ï¼Œæœ‰å¦‚æœåœ¨$\boldsymbol{x}$ç‚¹å¤„æ¢¯åº¦ä¸ä¸º$\boldsymbol{0}$ï¼Œåˆ™èƒ½ä¿è¯ç§»åŠ¨åˆ°$\boldsymbol{x}+\Delta \boldsymbol{x}$æ—¶å‡½æ•°å€¼å¢å¤§ï¼Œç›¸ååœ°ï¼Œå¦‚æœä»¤$\Delta \boldsymbol{x}=-\nabla f(\boldsymbol{x})$ï¼Œåˆ™æœ‰å³å‡½æ•°å€¼å‡å°ï¼Œäº‹å®ä¸Šï¼Œåªè¦ç¡®ä¿åˆ™æœ‰å› æ­¤ï¼Œé€‰æ‹©åˆé€‚çš„å¢é‡$\Delta x$å°±èƒ½ä¿è¯å‡½æ•°å€¼ä¸‹é™ï¼Œè´Ÿæ¢¯åº¦æ–¹å‘æ˜¯å…¶ä¸­çš„ä¸€ä¸ªç‰¹ä¾‹æ¥ä¸‹æ¥è¯æ˜ï¼šå¢é‡çš„æ¨¡ä¸€å®šæ—¶ï¼Œåœ¨è´Ÿæ¢¯åº¦æ–¹å‘ï¼Œå‡½æ•°å€¼æ˜¯ä¸‹é™æœ€å¿«çš„ç”±äºå…¶ä¸­$\theta$ä¸º$\nabla f(\boldsymbol{x})$ä¸$\Delta \boldsymbol{x}$ä¹‹é—´çš„å¤¹è§’ï¼Œå› æ­¤ï¼Œå¦‚æœ$\theta&lt;\frac{\pi}{2}$, åˆ™$\cos \theta&gt;0$ï¼Œä»è€Œæœ‰æ­¤æ—¶å‡½æ•°å€¼å¢å¤§$\Delta \boldsymbol{x}$æ²¿ç€æ­£æ¢¯åº¦æ–¹å‘æ˜¯å…¶ç‰¹ä¾‹ï¼Œå¦‚æœ$\theta&gt;\frac{\pi}{2}$ï¼Œåˆ™$\cos \theta&lt;0$ï¼Œä»è€Œæœ‰æ­¤æ—¶å‡½æ•°å€¼ä¸‹é™$\Delta x$æ²¿ç€è´Ÿæ¢¯åº¦æ–¹å‘å³$\theta=\pi$æ˜¯å…¶ç‰¹ä¾‹ï¼Œç”±äº$-1 \leqslant \cos \theta \leqslant 1$ï¼Œå› æ­¤ï¼Œå¦‚æœå‘é‡$\Delta x$çš„æ¨¡å¤§å°ä¸€ å®šï¼Œåˆ™$\Delta x=-\nabla f(\boldsymbol{x})$ï¼Œå³åœ¨æ¢¯åº¦ç›¸åçš„æ–¹å‘å‡½æ•°å€¼ä¸‹é™æœ€å¿«ï¼Œæ­¤æ—¶$\cos \theta=-1$ã€‚æ¢¯åº¦ä¸‹é™æ³•æ¯æ¬¡çš„è¿­ä»£å¢é‡ä¸ºå…¶ä¸­$\alpha$ä¸ºäººå·¥è®¾å®šçš„æ¥è¿‘äº0çš„æ­£æ•°ï¼Œç§°ä¸ºæ­¥é•¿æˆ–å­¦ä¹ ç‡ï¼Œå…¶ä½œç”¨æ˜¯ä¿è¯$\boldsymbol{x}+\Delta \boldsymbol{x}$åœ¨$\boldsymbol{x}$çš„é‚»åŸŸå†…ã€ä»è€Œå¯ä»¥å¿½ç•¥æ³°å‹’å…¬å¼ä¸­çš„$o(|\Delta x|)$é¡¹ï¼Œå¦åˆ™ä¸èƒ½ä¿è¯æ¯æ¬¡è¾¾ä»£æ—¶å‡½æ•°å€¼ä¸‹é™ï¼Œä½¿ç”¨è¯¥å¢é‡åˆ™æœ‰å‡½æ•°å€¼ä¸‹é™ï¼Œç”±æ­¤å¾—åˆ°æ¢¯åº¦ä¸‹é™æ³•çš„è¿­ä»£å…¬å¼ï¼Œä»åˆå§‹ç‚¹$x_{0}$å¼€å§‹ï¼Œåå¤ä½¿ç”¨å¦‚ä¸‹è¿­ä»£å…¬å¼åªè¦æ²¡æœ‰åˆ°è¾¾æ¢¯åº¦ä¸º0çš„ç‚¹ï¼Œå‡½æ•°å€¼ä¼šæ²¿åºåˆ—$\boldsymbol{x}_{k}$é€’å‡ï¼Œæœ€ç»ˆæ”¶æ•›åˆ°æ¢¯åº¦ä¸º0çš„ç‚¹ä»å‡ºå‘ï¼Œç”¨ä¸Šå¼è¿›è¡Œè¿­ä»£ï¼Œä¼šå½¢æˆä¸€ä¸ªå‡½æ•°å€¼é€’å‡çš„åºåˆ—è¿­ä»£ç»ˆæ­¢çš„æ¡ä»¶æ˜¯å‡½æ•°çš„æ¢¯åº¦å€¼ä¸º$\mathbf{0}$(å®é™…å®ç°æ—¶æ˜¯æ¥è¿‘äº 0 å³å¯)ï¼Œæ­¤æ—¶è®¤ä¸ºå·²ç»è¾¾åˆ°æå€¼ç‚¹ã€‚æ¢¯åº¦ä¸‹é™æ³•çš„æµç¨‹å¦‚ç®—æ³•$4.1$æ‰€ç¤ºğŸ§®ç®—æ³•æ¢¯åº¦ä¸‹é™æ³•åˆå§‹åŒ–$x_{0}$ï¼Œ$k=0$while $\left|\nabla f\left(\boldsymbol{x}_{k}\right)\right|&gt;$eps and $k&lt;N$ doâ€‹    è¿­ä»£â€‹    $k=k+1$end while$x_{0}$å¯åˆå§‹åŒ–ä¸ºå›ºå®šå€¼ï¼Œå¦‚$\mathbf{0}$ï¼Œæˆ–éšæœºæ•°(é€šå¸¸ä¸ºå‡åŒ€åˆ†å¸ƒæˆ–æ­£æ€åˆ†å¸ƒ)ï¼Œåè€…åœ¨è®­ç»ƒç¥ç»ç½‘ç»œæ—¶ç»å¸¸è¢«é‡‡ç”¨epsä¸ºäººå·¥æŒ‡å®šçš„æ¥è¿‘äº0çš„æ­£æ•°ï¼Œç”¨äºåˆ¤å®šæ¢¯åº¦æ˜¯å¦å·²ç»æ¥è¿‘äº$0$ï¼›$N$ä¸ºæœ€å¤§è¿­ä»£æ¬¡æ•°ï¼Œé˜²æ­¢æ­»å¾ªç¯çš„å‡ºç°æ¢¯åº¦ä¸‹é™æ³•åœ¨æ¯æ¬¡è¿­ä»£æ—¶åªéœ€è¦è®¡ç®—å‡½æ•°åœ¨å½“å‰ç‚¹å¤„çš„æ¢¯åº¦å€¼ï¼Œå…·æœ‰è®¡ç®—é‡å°ã€å®ç°ç®€å•çš„ä¼˜ç‚¹åªè¦æœªåˆ°è¾¾é©»ç‚¹å¤„ä¸”å­¦ä¹ ç‡è®¾ç½®æ°å½“ï¼Œæ¯æ¬¡è¾¾ä»£æ—¶å‡èƒ½ä¿è¯å‡½æ•°å€¼ä¸‹é™ä¸‹å›¾ä¸ºç”¨æ¢¯åº¦ä¸‹é™æ³•æ±‚è§£$x^{2}+y^{2}$æå€¼çš„è¿‡ç¨‹ï¼Œè¿­ä»£åˆå§‹å€¼(å›¾ä¸­çš„å¤§åœ†ç‚¹)è®¾ç½®ä¸º$(0,4)$ï¼Œå­¦ä¹ ç‡è®¾ç½®ä¸º$0.1$æ¯æ¬¡è¿­ä»£æ—¶çš„å€¼$\boldsymbol{x}_{i}$ä»¥å°åœ†ç‚¹æ˜¾ç¤ºå­¦ä¹ ç‡$\alpha$çš„è®¾å®šä¹Ÿæ˜¯éœ€è¦è€ƒè™‘çš„é—®é¢˜ï¼Œä¸€èˆ¬æƒ…å†µä¸‹è®¾ç½®ä¸ºå›ºå®šçš„å¸¸æ•°ï¼Œå¦‚$10^{-5}$åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œé‡‡ç”¨äº†æ›´å¤æ‚çš„ç­–ç•¥ï¼Œå¯ä»¥åœ¨è¿­ä»£æ—¶åŠ¨æ€è°ƒæ•´å…¶å€¼æœ€é€Ÿä¸‹é™æ³•æ¢¯åº¦ä¸‹é™æ³•ä¸­æ­¥é•¿$\alpha$æ˜¯å›ºå®šçš„ï¼Œæˆ–è€…æ ¹æ®æŸç§äººå·¥æŒ‡å®šçš„ç­–ç•¥åŠ¨æ€è°ƒæ•´æœ€é€Ÿä¸‹é™æ³•(Steepest Descent Method)æ˜¯å¯¹æ¢¯åº¦ä¸‹é™æ³•çš„æ”¹è¿›ï¼Œå®ƒç”¨ç®—æ³•è‡ªåŠ¨ç¡®å®šæ­¥é•¿å€¼æœ€é€Ÿä¸‹é™æ³•åŒæ ·æ²¿ç€æ¢¯åº¦ç›¸åçš„æ–¹å‘è¿›è¡Œè¿­ä»£ï¼Œä½†æ¯æ¬¡éœ€è¦è®¡ç®—æœ€ä½³æ­¥é•¿$\alpha$æœ€é€Ÿä¸‹é™æ³•çš„æœç´¢æ–¹å‘ä¸æ¢¯åº¦ä¸‹é™æ³•ç›¸åŒï¼Œä¹Ÿæ˜¯è´Ÿæ¢¯åº¦æ–¹å‘åœ¨è¯¥æ–¹å‘ä¸Šå¯»æ‰¾ä½¿å¾—å‡½æ•°å€¼æœ€å°çš„æ­¥é•¿ï¼Œé€šè¿‡æ±‚è§£å¦‚ä¸‹ä¸€å…ƒå‡½æ•°ä¼˜åŒ–é—®é¢˜å®ç°ä¼˜åŒ–å˜é‡æ˜¯$\alpha$ï¼Œå®ç°æ—¶æœ‰ä¸¤ç§æ–¹æ¡ˆå°†çš„å–å€¼ç¦»æ•£åŒ–ï¼Œå–å…¸å‹å€¼ï¼Œåˆ†åˆ«è®¡ç®—å–è¿™äº›å€¼çš„ç›®æ ‡å‡½æ•°å€¼ï¼Œç„¶åç¡®å®šæœ€ä¼˜å€¼ç›´æ¥æ±‚è§£ä¸Šå¼ç›®æ ‡å‡½æ•°çš„é©»ç‚¹ï¼Œå¯¹äºæœ‰äº›æƒ…å†µå¯å¾—åˆ°è§£æè§£è¿™ç±»æ–¹æ³•ä¹Ÿç§°ä¸ºç›´çº¿æœç´¢(Line Search)ï¼Œå®ƒæ²¿ç€æŸä¸€ç¡®å®šçš„æ–¹å‘åœ¨ç›´çº¿ä¸Šå¯»æ‰¾æœ€ä¼˜æ­¥é•¿æ¢¯åº¦ä¸‹é™æ³•çš„æ”¹è¿›æ¢¯åº¦ä¸‹é™æ³•åœ¨æŸäº›æƒ…å†µä¸‹å­˜åœ¨æ”¶æ•›é€Ÿåº¦æ…¢ã€æ”¶æ•›æ•ˆæœå·®çš„åŒé¢˜ï¼Œå› æ­¤å‡ºç°äº†å¤§é‡æ”¹è¿›æ–¹æ¡ˆæ ‡å‡†çš„æ¢¯åº¦ä¸‹é™æ³•å¯èƒ½å­˜åœ¨æŒ¯è¡é—®é¢˜ï¼Œå…·ä½“è¡¨ç°ä¸ºåœ¨ä¼˜åŒ–å˜æ˜°çš„æŸäº›åˆ†é‡æ–¹å‘ä¸Šæ¥å›æŒ¯è¡ï¼Œå¯¼è‡´æ”¶æ•›é€Ÿåº¦æ…¢ä¸‹å›¾æ˜¾ç¤ºäº†ç”¨æ¢¯åº¦ä¸‹é™æ³•æ±‚è§£çš„æå€¼æ—¶çš„é€„ä»£è¿‡ç¨‹ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œ è¿­ä»£åºåˆ—åœ¨æ–¹å‘æ¥å›æŒ¯è¡xxxå›¾æ¢¯åº¦ä¸‹é™æ³•æŒ¯è¡é—®é¢˜åŠ¨é‡é¡¹æ¢¯åº¦ä¸‹é™æ³•åŠ¨é‡é¡¹æ¢¯åº¦ä¸‹é™æ³•é€šè¿‡å¼•å…¥åŠ¨é‡é¡¹è§£å†³æ­¤é—®é¢˜ï¼Œç±»ä¼¼äºç‰©ç†ä¸­çš„åŠ¨é‡ï¼Œä¾é æƒ¯æ€§ä¿æŒè¿­ä»£æ—¶çš„å‰è¿›æ–¹å‘åŠ¨é‡é¡¹çš„è®¡ç®—å…¬å¼ä¸ºå®ƒæ˜¯ä¸Šæ¬¡è¿­ä»£æ—¶çš„åŠ¨é‡é¡¹ä¸æœ¬æ¬¡è´Ÿæ¢¯åº¦å€¼çš„åŠ æƒå’Œï¼Œå…¶ä¸­$\alpha$æ˜¯å­¦ä¹ ç‡ï¼Œå…¶ä½œç”¨ä¸æ ‡å‡†çš„æ¢¯åº¦ä¸‹é™æ³•ç›¸åŒï¼Œ$\mu$æ˜¯åŠ¨é‡é¡¹ç³»æ•°å¦‚æœæŒ‰ç…§æ—¶é—´çº¿å±•å¼€ï¼Œåˆ™ç¬¬$k$æ¬¡è¿­ä»£æ—¶ä½¿ç”¨äº†ä»1åˆ°$k$æ¬¡è¿­ä»£æ—¶çš„æ‰€æœ‰è´Ÿæ¢¯åº¦å€¼ï¼Œä¸”è´Ÿæ¢¯åº¦å€¼æŒ‰ç³»æ•°$\mu$æŒ‡æ•°çº§è¡°å‡ï¼Œå³ä½¿ç”¨äº†ç§»åŠ¨æŒ‡æ•°åŠ æƒå¹³å‡åå¤åˆ©ç”¨ä¸Šå¼ï¼Œå±•å¼€ä¹‹åçš„åŠ¨é‡é¡¹ä¸ºæ›´æ–°ä¼˜åŒ–å˜é‡å€¼æ—¶ä½¿ç”¨åŠ¨é‡é¡¹ä»£æ›¿è´Ÿæ¢¯åº¦é¡¹ï¼Œæ¢¯åº¦ä¸‹é™æ›´æ–°å…¬å¼ä¸ºåŠ¨é‡é¡¹åŠ å¿«äº†æ¢¯åº¦ä¸‹é™æ³•çš„æ”¶æ•›é€Ÿåº¦ï¼Œå®ƒä½¿ç”¨å†å²ä¿¡æ¯å¯¹å½“å‰æ¢¯åº¦å€¼è¿›è¡Œä¿®æ­£ï¼Œæ¶ˆé™¤ç—…æ€æ¡ä»¶é—®é¢˜ä¸Šçš„æ¥å›æŒ¯è¡ä¸‹å›¾æ˜¾ç¤ºäº†ç”¨åŠ¨é‡é¡¹æ¢¯åº¦ä¸‹é™æ³•æ±‚è§£æå€¼æ—¶çš„è¿­ä»£è¿‡ç¨‹ï¼Œä¸ä¸Šå›¾ç›¸æ¯”ï¼Œè¿­ä»£ä»£åºåˆ—æ›´ä¸ºå¹³æ»‘ï¼Œä¸”æ”¶æ•›æ›´å¿«xxxå›¾ä½¿ç”¨åŠ¨é‡é¡¹åçš„è¿­ä»£è½¨è¿¹AdaGradæ ‡å‡†æ¢¯åº¦ä¸‹é™æ³•çš„æ­¥é•¿å€¼éš¾ä»¥ç¡®å®šï¼Œä¸”ä¼˜åŒ–å˜é‡çš„å„ä¸ªåˆ†é‡é‡‡ç”¨äº†ç›¸åŒçš„æ­¥é•¿ï¼ŒAdaGrad(Adaptive Gradient)ç®—æ³•æ ¹æ®å‰å‡ è½®è¿­ä»£æ—¶çš„å†å²æ¢¯åº¦å€¼åŠ¨æ€è®¡ç®—æ­¥é•¿å€¼ï¼Œä¸”ä¼˜åŒ–å‘é‡çš„æ¯ä¸€ä¸ªåˆ†é‡éƒ½æœ‰è‡ªå·²çš„æ­¥é•¿ï¼Œæ¢¯åº¦ä¸‹é™è¿­ä»£å…¬å¼ä¸ºå…¶ä¸­æ˜¯äººå·¥è®¾å®šçš„å…¨å±€å­¦ä¹ ç‡ï¼Œ$g_{k}$æ˜¯ç¬¬$k$æ¬¡è¿­ä»£æ—¶çš„æ¢¯åº¦å‘é‡ï¼Œ$\varepsilon$æ˜¯ä¸ºé¿å…é™¤0æ“ä½œè€Œå¢åŠ çš„æ¥è¿‘äº0çš„æ­£æ•°ï¼Œ$i$ä¸ºå‘é‡çš„åˆ†é‡ä¸‹æ ‡ï¼Œè¿™é‡Œçš„è®¡ç®—é’ˆå¯¹å‘é‡çš„æ¯ä¸ªåˆ†é‡åˆ†åˆ«è¿›è¡Œä¸æ ‡å‡†æ¢¯åº¦ä¸‹é™æ³•ç›¸æ¯”ï¼Œä¸Šå¼å¤šäº†åˆ†æ¯é¡¹ï¼Œå®ƒç´¯ç§¯äº†åˆ°æœ¬æ¬¡è¿­ä»£ä¸ºæ­¢çš„æ¢¯åº¦çš„å†å²å€¼ä¿¡æ¯ï¼Œç”¨äºè®¡ç®—æ­¥é•¿å€¼å†å²å¯¼æ•°å€¼çš„ç»å¯¹å€¼è¶Šå¤§ï¼Œåœ¨è¯¥åˆ†é‡ä¸Šçš„å­¦ä¹ ç‡è¶Šå°ï¼Œåä¹‹è¶Šå¤§è™½ç„¶å®ç°äº†è‡ªé€‚åº”å­¦ä¹ ç‡ï¼Œä½†è¿™ç§ç®—æ³•è¿˜å­˜åœ¨é—®é¢˜ï¼šéœ€è¦äººå·¥è®¾ç½®å…¨å±€å­¦ä¹ ç‡$\alpha$ï¼›éšç€æ—¶é—´çš„ç´¯ç§¯ï¼Œä¸Šå¼ä¸­çš„åˆ†æ¯ä¼šè¶Šæ¥è¶Šå¤§ï¼Œå¯¼è‡´å­¦ä¹ ç‡è¶‹å‘äº0ï¼Œä¼˜åŒ–å˜é‡æ— æ³•æœ‰æ•ˆæ›´æ–°RMSPropRMSPropç®—æ³•æ˜¯å¯¹AdaGradçš„æ”¹è¿›ï¼Œé¿å…äº†é•¿æœŸç´¯ç§¯æ¢¯åº¦å€¼æ‰€å¯¼è‡´çš„å­¦ä¹ ç‡è¶‹å‘äº0çš„é—®é¢˜ç®—æ³•ç»´æŒä¸€ä¸ªæ¢¯åº¦å¹³æ–¹ç´¯åŠ å€¼çš„å‘é‡$E\left[\boldsymbol{g}^{2}\right]$ï¼Œå…¶åˆå§‹å€¼ä¸º$\mathbf{0}$ï¼Œæ›´æ–°å…¬å¼ä¸ºè¿™é‡Œçš„$g^{2}$æ˜¯å¯¹æ¢¯åº¦å‘é‡çš„æ¯ä¸ªåˆ†é‡åˆ†åˆ«è¿›è¡Œå¹³æ–¹ï¼Œ$\delta$æ˜¯äººå·¥è®¾å®šçš„è¡°å‡ç³»æ•°ä¸åŒäºAdaGradç›´æ¥ç´¯åŠ æ‰€æœ‰å†å²æ¢¯åº¦çš„å¹³æ–¹å’Œï¼ŒRMSPropå°†å†å²æ¢¯åº¦å¹³æ–¹å€¼æŒ‰ç…§ç³»æ•°$\delta$æŒ‡æ•°çº§è¡°å‡ä¹‹åå†ç´¯åŠ ï¼Œå³ä½¿ç”¨äº†ç§»åŠ¨æŒ‡æ•°åŠ æƒå¹³å‡æ¢¯åº¦ä¸‹é™æ³•æ›´æ–°å…¬å¼ä¸º$\alpha$æ˜¯äººå·¥è®¾å®šçš„å…¨å±€å­¦ä¹ ç‡ï¼Œæ ‡å‡†æ¢¯åº¦ä¸‹é™æ–¹æ³•ç›¸æ¯”ï¼Œè¿™é‡Œä¹Ÿåªå¤šäº†ä¸€ä¸ªåˆ†æ¯é¡¹AdaDeltaAdaDeltaç®—æ³•ä¹Ÿæ˜¯å¯¹AdaGradçš„æ”¹è¿›ï¼Œé¿å…äº†é•¿æœŸç´¯ç§¯æ¢¯åº¦å€¼æ‰€å¯¼è‡´çš„å­¦ä¹ ç‡è¶‹å‘äº0çš„é—®é¢˜ï¼Œè¿˜å»æ‰äº†å¯¹äººå·¥è®¾ç½®å…¨å±€å­¦ä¹ ç‡çš„ä¾èµ–ç®—æ³•å®šä¹‰äº†ä¸¤ä¸ªå‘é‡ï¼Œåˆå§‹å€¼å‡ä¸º0$E\left[g^{2}\right]$æ˜¯æ¢¯åº¦å¹³æ–¹(å¯¹æ¯ä¸ªåˆ†é‡åˆ†åˆ«å¹³æ–¹)çš„ç´¯è®¡å€¼ï¼Œä¸RMSPropç®—æ³•ç›¸åŒï¼Œæ›´æ–°å…¬å¼ä¸º$g^{2}$æ˜¯å‘é‡æ¯ä¸ªå…ƒç´ åˆ†åˆ«è®¡ç®—å¹³æ–¹ï¼Œåé¢æ‰€æœ‰çš„è®¡ç®—å…¬å¼éƒ½æ˜¯å¯¹å‘é‡çš„æ¯ä¸ªåˆ†é‡åˆ†åˆ«è¿›è¡Œè®¡ç®—ï¼Œæ¥ä¸‹æ¥è®¡ç®—RMSå‘é‡ç„¶åè®¡ç®—ä¼˜åŒ–å˜é‡çš„æ›´æ–°å€¼è¿™é‡Œæ ¹æ®è®¡ç®—ï¼Œè®¡ç®—å…¬å¼ä¸ç›¸åŒè¿™ä¸ªæ›´æ–°å€¼åŒæ ·é€šè¿‡æ¢¯åº¦æ¥æ„é€ ï¼Œä½†å­¦ä¹ ç‡æ˜¯é€šè¿‡æ¢¯åº¦çš„å†å²å€¼ç¡®å®šçš„$E\left[\Delta x^{2}\right]$æ˜¯ä¼˜åŒ–å˜é‡æ›´æ–°å€¼çš„å¹³æ–¹ç´¯åŠ å€¼ï¼Œå®ƒä»¬çš„æ›´æ–°å…¬å¼ä¸ºåœ¨è¿™é‡Œï¼Œæ˜¯å¯¹çš„æ¯ä¸ªåˆ†é‡è¿›è¡Œå¹³æ–¹ã€‚æ¢¯åº¦ä¸‹é™çš„è¾¾ä»£å…¬å¼ä¸ºAdamAdam(Adaptive Moment Estimation)ç®—æ³•æ•´åˆäº†è‡ªé€‚åº”å­¦ä¹ ç‡ä¸åŠ¨é‡é¡¹ç®—æ³•ç”¨æ¢¯åº¦æ„é€ äº†ä¸¤ä¸ªå‘é‡$m$å’Œ$v$ï¼Œåˆå§‹å€¼ä¸º$0$ï¼Œæ›´æ–°å…¬å¼ä¸ºè¿™é‡Œã€æ˜¯äººå·¥ç½®é¡¶çš„å‚æ•°ï¼Œæ¢¯åº¦ä¸‹é™çš„è¿­ä»£å…¬å¼ä¸º$m$çš„ä½œç”¨ç›¸å½“äºäºåŠ¨é‡é¡¹ï¼Œ$v$ç”¨äºæ„é€ å­¦ä¹ ç‡éšæœºæ¢¯åº¦ä¸‹é™æ³•åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œç›®æ ‡å‡½æ•°é€šå¸¸å®šä¹‰åœ¨ä¸€ä¸ªè®­ç»ƒæ ·æœ¬é›†ä¸Šå‡è®¾è®­ç»ƒæ ·æœ¬é›†æœ‰$N$ä¸ªæ ·æœ¬ï¼Œæœºå™¨å­¦ä¹ æ¨¡å‹åœ¨è®­ç»ƒæ—¶ä¼˜åŒ–çš„ç›®æ ‡æ˜¯è¿™ä¸ªæ•°æ®é›†ä¸Šçš„å¹³å‡æŸå¤±å‡½æ•°å…¶ä¸­æ˜¯å¯¹å•ä¸ªè®­ç»ƒæ ·æœ¬çš„æŸå¤±å‡½æ•°ï¼Œæ˜¯æœºå“­å­¦ä¹ æ¨¡å‹éœ€è¦å­¦ä¹ çš„å‚æ•°ï¼Œæ˜¯ä¼˜åŒ–å˜é‡æ˜¾ç„¶ï¼Œå› æ­¤è®¡ç®—ç›®æ ‡å‡½æ•°æ¢¯åº¦æ—¶éœ€è¦è®¡ç®—å¯¹æ¯ä¸ªè®­ ç»ƒæ ·æœ¬æŸå¤±å‡½æ•°çš„æ¢¯åº¦ï¼Œç„¶åæ±‚å‡å€¼å¦‚æœè®­ç»ƒæ—¶æ¯æ¬¡è¾¾ä»£éƒ½ç”¨æ‰€æœ‰æ ·æœ¬ï¼Œé‚£ä¹ˆè®¡ç®—æˆæœ¬å¤ªé«˜ä½œä¸ºæ”¹è¿›ï¼Œå¯ä»¥åœ¨æ¯æ¬¡è¿­ä»£æ—¶é€‰å–ä¸€æ‰¹æ ·æœ¬ï¼Œå°†æŸå¤±å‡½æ•°å®šä¹‰åœ¨è¿™äº›æ ·æœ¬ä¸Šï¼Œä½œä¸ºæ•´ä¸ªæ ·æœ¬é›†çš„æŸå¤±å‡½æ•°çš„è¿‘ä¼¼å€¼å°æ‰¹é‡éšæœºæ¢¯åº¦ä¸‹é™æ³•(Mini Batch Gradient Descent Methodåœ¨æ¯æ¬¡è¿­ä»£æ—¶ä½¿ç”¨ä¸Šé¢ç›®æ ‡å‡½æ•°çš„éšæœºé€¼è¿‘å€¼ï¼Œåªä½¿ç”¨$M \ll N$ä¸ªæ ·æœ¬æ¥è¿‘ä¼¼è®¡ç®—æŸå¤±å‡½æ•°ï¼Œåœ¨æ¯æ¬¡è¿­ä»£æ—¶ï¼Œè¦ä¼˜åŒ–çš„ç›®æ ‡å‡½æ•°å˜ä¸ºéšæœºæ¢¯åº¦ä¸‹é™æ³•åœ¨æ•°å­¦æœŸæœ›çš„æ„ä¹‰ä¸‹æ”¶æ•›ï¼Œéšæœºé‡‡æ ·äº§ç”Ÿçš„æ¢¯åº¦çš„æœŸæœ›å€¼æ˜¯çœŸå®çš„æ¢¯åº¦åœ¨å…·ä½“å®ç°æ—¶ï¼Œæ¯æ¬¡å…ˆå¯¹æ‰€æœ‰è®­ç»ƒæ ·æœ¬è¿›è¡Œéšæœºæ´—ç‰Œï¼Œæ‰“ä¹±é¡ºåºï¼›ç„¶åå°†å…¶å‡åŒ€åˆ†æˆå¤šä»½ï¼Œæ¯ä»½$M$ä¸ªæ ·æœ¬ï¼›æ¥ä¸‹æ¥ä¾æ¬¡ç”¨æ¯ä¸€ä»½æ‰§è¡Œæ¢¯åº¦ä¸‹é™æ³•è¿­ä»£ä¸€ç§ç‰¹æ®Šæƒ…å†µæ˜¯$M=1$ï¼Œæ¯æ¬¡è¿­ä»£åªä½¿ç”¨ä¸€ ä¸ªè®­ç»ƒæ ·æœ¬éšæœºæ¢¯åº¦ä¸‹é™æ³•å¹¶ä¸èƒ½ä¿è¯æ¯æ¬¡è¿­ä»£åç›®æ ‡å‡½æ•°å€¼ä¸‹é™ï¼Œäº‹å®ä¸Šï¼Œæ¯æ¬¡è¿­ä»£æ—¶ä½¿ç”¨çš„æ˜¯ä¸åŒçš„ç›®æ ‡å‡½æ•°ä½†é€šå¸¸æƒ…å†µä¸‹ç›®æ ‡å‡½æ•°çš„æ•´ä½“è¶‹åŠ¿æ˜¯ä¸‹é™çš„ï¼Œèƒ½å¤Ÿæ”¶æ•›åˆ°å±€éƒ¨æå€¼ç‚¹å¤„ä¸‹å›¾æ˜¯ç”¨éšæœºæ¢¯åº¦ä¸‹é™æ³•è®­ç»ƒç¥ç»ç½‘ç»œæ—¶æŸå¤±å‡½æ•°çš„æ›²çº¿ï¼Œæ¨ªè½´ä¸ºè¿­ä»£æ¬¡æ•°ï¼Œçºµè½´ä¸ºæŸå¤±å‡½æ•°çš„å€¼å¯ä»¥çœ‹åˆ°ï¼Œè¿­ä»£æ—¶å‡½æ•°çš„å€¼ä¼šå‡ºç°æŒ¯è¡ï¼Œä½†æ•´ä½“è¶‹åŠ¿æ˜¯ä¸‹é™çš„ï¼Œæœ€åæ”¶æ•›xxxå›¾ç”¨éšæœºæ¢¯åº¦ä¸‹é™æ³•è®­ç»ƒç¥ç»ç½‘ç»œæ—¶çš„æŸå¤±å‡½æ•°æ›²çº¿é™¤å…·æœ‰å®ç°æ•ˆç‡é«˜çš„ä¼˜ç‚¹ä¹‹å¤–ï¼Œéšæœºæ¢¯åº¦ä¸‹é™æ³•è¿˜ä¼šå½±å“æ”¶æ•›çš„æ•ˆæœå¯¹äºæ·±åº¦ç¥ç»ç½‘ç»œï¼Œéšæœºæ¢¯åº¦ä¸‹é™æ³•æ¯”æ‰¹é‡æ¢¯åº¦ä¸‹é™æ³•æ›´å®¹æ”¶æ•›åˆ°ä¸€ä¸ªå¥½çš„æå€¼ç‚¹å¤„åº”ç”¨ä¸€å·¥ç¥ç»ç½‘ç»œå‡è®¾æœ‰ä¸ªè®­ç»ƒæ ·æœ¬ï¼Œå…¶ä¸­ä¸ºè¾“å…¥å‘é‡ï¼Œä¸ºæ ‡ç­¾å‘é‡è®­ç»ƒçš„ç›®æ ‡æ˜¯æœ€å°åŒ–æ ·æœ¬æ ‡ç­¾å€¼ä¸ç¥ç»ç½‘ç»œé¢„æµ‹å€¼ä¹‹é—´çš„è¯¯å·®ï¼Œå¦‚æœä½¿ç”¨å‡æ–¹è¯¯å·®ï¼Œåˆ™ä¼˜åŒ–çš„ç›®æ ‡ä¸ºå…¶ä¸­$w$ä¸ºç¥ç»ç½‘ç»œæ‰€æœ‰å‚æ•°çš„é›†åˆï¼ŒåŒ…æ‹¬å„å±‚çš„æƒé‡å’Œåç½®ï¼Œ$h(x)$æ˜¯ç¥ç»ç½‘ç»œå®ç°çš„æ˜ å°„è¿™ ä¸ªæœ€ä¼˜åŒ–é—®é¢˜æ˜¯ä¸€ä¸ªä¸å¸¦çº¦æŸæ¡ä»¶çš„é—®é¢˜ï¼Œå¯ä»¥ç”¨æ¢¯åº¦ä¸‹é™æ³•æ±‚è§£å¦‚æœè®¡ç®—å‡ºäº†æŸå¤±å‡½æ•°å¯¹å‚æ•°çš„æ¢¯åº¦å€¼ï¼Œæ¢¯åº¦ä¸‹é™æ³•ç¬¬$k+1$æ¬¡è¿­ä»£æ—¶å‚æ•°çš„æ›´æ–°å…¬å¼ä¸ºæ¢¯åº¦å€¼çš„è®¡ç®—é€šè¿‡åå‘ä¼ æ’­ç®—æ³•å®ç°å‚æ•°çš„åˆå§‹åŒ–æ˜¯ä¸€ä¸ªéœ€è¦è€ƒè™‘çš„é—®é¢˜ï¼Œä¸€èˆ¬ç”¨éšæœºæ•°è¿›è¡Œåˆå§‹åŒ–å¦‚æœè®­ç»ƒæ ·æœ¬æ•°å¾ˆå¤§ï¼Œé‚£ä¹ˆé€šå¸¸é‡‡ç”¨éšæœºæ¢¯åº¦ä¸‹é™æ³•ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œéšæœºæ¢¯åº¦ä¸‹é™æ³•æœ‰å¾ˆå¥½çš„æ”¶æ•›æ•ˆæœäºŒé˜¶ä¼˜åŒ–ç®—æ³•æ¢¯åº¦ä¸‹é™æ³•åªåˆ©ç”¨äº†ä¸€é˜¶å¯¼æ•°ä¿¡æ¯ï¼Œæ”¶æ•›é€Ÿåº¦æ…¢ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œåˆ©ç”¨äºŒé˜¶å¯¼æ•°ä¿¡æ¯å¯ä»¥åŠ å¿«æ”¶æ•˜é€Ÿåº¦ï¼Œå…¸å‹ä»£è¡¨æ˜¯ç‰›é¡¿æ³•å’Œæ‹Ÿç‰›é¡¿æ³•ç‰›é¡¿æ³•åœ¨æ¯ä¸ªè¿­ä»£ç‚¹å¤„å°†ç›®æ ‡å‡½æ•°è¿‘ä¼¼ä¸ºäºŒæ¬¡å‡½æ•°ï¼Œç„¶åé€šè¿‡æ±‚è§£æ¢¯åº¦ä¸º0çš„æ–¹ç¨‹å¾—åˆ°è¿­ä»£æ–¹å‘ç‰›é¡¿æ³•åœ¨æ¯æ¬¡è¿­ä»£æ—¶éœ€è¦è®¡ç®—æ¢¯åº¦å‘é‡ä¸é»‘å¡çŸ©é˜µï¼Œå¹¶æ±‚è§£ä¸€ä¸ªçº¿æ€§æ–¹ç¨‹ç»„ï¼Œè®¡ç®—é‡å¤§ä¸”é¢ä¸´é»‘å¡çŸ©é˜µä¸å¯é€†çš„é—®é¢˜æ‹Ÿç‰›é¡¿æ³•æ˜¯å¯¹å®ƒçš„æ”¹è¿›ï¼Œç®—æ³•æ„é€ å‡ºä¸€ä¸ªçŸ©é˜µä½œä¸ºé»‘å¡çŸ©é˜µæˆ–å…¶é€†çŸ©é˜µçš„è¿‘ä¼¼ç‰›é¡¿æ³•ç‰›é¡¿æ³•(Newton Method)å¯»æ‰¾ç›®æ ‡å‡½æ•°ä½œäºŒé˜¶è¿‘ä¼¼åæ¢¯åº¦ä¸º$\mathbf{0}$çš„ç‚¹ï¼Œé€æ­¥é€¼è¿‘æå€¼ç‚¹æ ¹æ®è´¹é©¬å¼•ç†ï¼Œå‡½æ•°åœ¨ç‚¹$x$å¤„å–å¾—æå€¼çš„å¿…è¦æ¡ä»¶æ˜¯æ¢¯åº¦ä¸º0ç›´æ¥è®¡ç®—å‡½æ•°çš„æ¢¯åº¦ç„¶åè§£ä¸Šé¢çš„æ–¹ç¨‹ç»„é€šå¸¸å¾ˆå›°éš¾ï¼Œå’Œæ¢¯åº¦ä¸‹é™æ³•ç±»ä¼¼ï¼Œå¯ä»¥é‡‡ç”¨è¿­ä»£æ³•è¿‘ä¼¼æ±‚è§£å¯¹ç›®æ ‡å‡½æ•°åœ¨$x_{0}$å¤„ä½œäºŒé˜¶æ³°å‹’å±•å¼€å¿½ç•¥äºŒæ¬¡ä»¥ä¸Šçš„é¡¹ï¼Œå°†ç›®æ ‡å‡½æ•°è¿‘ä¼¼æˆäºŒæ¬¡å‡½æ•°ï¼Œç­‰å¼ä¸¤è¾¹åŒæ—¶å¯¹$\boldsymbol{x}$æ±‚æ¢¯åº¦ï¼Œå¯å¾—å…¶ä¸­ä¸ºåœ¨å¤„çš„é»‘å¡çŸ©é˜µä»ä¸Šé¢å¯ä»¥çœ‹å‡ºï¼Œè¿™é‡Œè‡³å°‘è¦å±•å¼€åˆ°äºŒé˜¶ï¼Œå¦‚æœåªæœ‰ä¸€é˜¶ï¼Œé‚£ä¹ˆæ— æ³•å»ºç«‹æ¢¯åº¦ä¸º$\mathbf{0}$çš„æ–¹ç¨‹ç»„ï¼Œå› ä¸ºæ­¤æ—¶ä¸€æ¬¡è¿‘ä¼¼å‡½æ•°çš„æ¢¯åº¦å€¼ä¸ºå¸¸æ•°ä»¤å‡½æ•°çš„æ¢¯åº¦ä¸º$\mathbf{0}$ï¼Œæœ‰è§£è¿™ä¸ªçº¿æ€§æ–¹ç¨‹ç»„å¯ä»¥å¾—åˆ°å¦‚æœå°†æ¢¯åº¦å‘é‡ç®€å†™ä¸º$\boldsymbol{g}$ï¼Œé»‘å¡çŸ©é˜µç®€è®°ä¸º$\boldsymbol{H}$ï¼Œä¸Šå¼å¯ä»¥ç®€å†™ä¸ºç”±äºåœ¨æ³°å‹’å…¬å¼ä¸­å¿½ç•¥äº†é«˜é˜¶é¡¹å°†å‡½æ•°è¿›è¡Œäº†è¿‘ä¼¼ï¼Œå› æ­¤è¿™ä¸ªè§£ä¸ä¸€å®šæ˜¯ç›®æ ‡å‡½æ•°çš„é©»ç‚¹ï¼Œéœ€è¦åå¤ç”¨ä¸Šå¼è¿›è¡Œè¿­ä»£ä»åˆå§‹ç‚¹$x_{0}$å¤„å¼€å§‹ï¼Œè®¡ç®—å‡½æ•°åœ¨å½“å‰ç‚¹å¤„çš„é»‘å¡çŸ©é˜µå’Œæ¢¯åº¦å‘é‡ï¼Œç„¶åç”¨ä¸‹é¢çš„å…¬å¼è¿›è¡Œè¿­ä»£ç›´è‡³æ”¶æ•›åˆ°é©»ç‚¹å¤„å³åœ¨æ¯æ¬¡è¿­ä»£ä¹‹åï¼Œåœ¨å½“å‰ç‚¹å¤„å°†ç›®æ ‡å‡½æ•°è¿‘ä¼¼æˆäºŒæ¬¡å‡½æ•°ï¼Œç„¶åå¯»æ‰¾æ¢¯åº¦ä¸º0çš„ç‚¹$-H^{-1} g$ç§°ä¸ºç‰›é¡¿æ–¹å‘ï¼Œè¿­ä»£ç»ˆæ­¢çš„æ¡ä»¶æ˜¯æ¢¯åº¦çš„æ¨¡æ¥è¿‘äº0ï¼Œæˆ–è¾¾åˆ°æŒ‡å®šçš„è¾¾ä»£æ¬¡æ•°ç‰›é¡¿æ³•çš„æµç¨‹å¦‚ä¸‹ç®—æ³•æ‰€ç¤ºğŸ§®ç‰›é¡¿æ³•åˆå§‹åŒ–$x_{0}$ï¼Œ$k=0$while $k&lt;N$ doâ€‹    è®¡ç®—å½“å‰ç‚¹å¤„çš„æ¢¯åº¦å€¼$g_k$ä»¥åŠé»‘å¡çŸ©é˜µ$H_k$â€‹    if $\left|g_{k}\right|&lt;$ eps thenâ€‹        åœæ­¢è¿­ä»£â€‹    end ifâ€‹    è¿­ä»£â€‹    è¿­ä»£â€‹    $k=k+1$end whileå…¶ä¸­$\alpha$æ˜¯äººå·¥è®¾ç½®çš„å­¦ä¹ ç‡ï¼Œéœ€è¦å­¦ä¹ ç‡çš„åŸå› ä¸æ¢¯åº¦ä¸‹é™æ³•ç›¸åŒï¼Œæ˜¯ä¸ºäº†ä¿è¯èƒ½å¤Ÿå¿½ç•¥æ³°å‹’å…¬å¼ä¸­çš„é«˜é˜¶æ— ç©·å°é¡¹å¦‚æœç›®æ ‡å‡½æ•°æ˜¯äºŒæ¬¡å‡½æ•°ï¼Œåˆ™é»‘å¡çŸ©é˜µæ˜¯ä¸€ä¸ªå¸¸æ•°çŸ©é˜µï¼Œä¸”æ³°é¿å…¬å¼ä¸­çš„é«˜é˜¶é¡¹ä¸º0å¯¹äºä»»æ„ç»™å®šçš„åˆå§‹ç‚¹$\boldsymbol{x}_{0}$ï¼Œç‰›é¡¿æ³•åªéœ€è¦ä¸€æ¬¡è¿­ä»£å³å¯æ”¶æ•›åˆ°é©»ç‚¹ä¸æ¢¯åº¦ä¸‹é™æ³•ä¸åŒï¼Œç‰›é¡¿æ³•æ— æ³•ä¿è¯æ¯æ¬¡è¿­ä»£æ—¶ç›®æ ‡å‡½æ•°å€¼ä¸‹é™ã€‚ä¸ºäº†ç¡®å®šå­¦ä¹ ç‡çš„å€¼ï¼Œé€šå¸¸ä½¿ç”¨ç›´çº¿æœç´¢æŠ€æœ¯å…·ä½“åšæ³•æ˜¯è®©$\alpha$å–ä¸€äº›å…¸å‹çš„ç¦»æ•£å€¼ï¼Œå¦‚ä¸‹é¢çš„å€¼é€‰æ‹©ä½¿å¾—æœ€å°åŒ–çš„æ­¥é•¿å€¼ä½œä¸ºæœ€ä¼˜æ­¥é•¿ï¼Œä¿è¯è¿­ä»£ä¹‹åçš„å‡½æ•°å€¼å……åˆ†ä¸‹é™ä¸æ¢¯åº¦ä¸‹é™æ³•ç›¸æ¯”ï¼Œç‰›é¡¿æ³•æœ‰æ›´å¿«çš„æ”¶æ•›é€Ÿåº¦ï¼Œä½†æ¯æ¬¡è¿­ä»£çš„æˆæœ¬ä¹Ÿæ›´é«˜1ï¸âƒ£æ¯æ¬¡è¿­ä»£æ—¶éœ€è¦è®¡ç®—æ¢¯åº¦å‘é‡ä¸é»‘å¡çŸ©é˜µï¼Œå¹¶è®¡ç®—é»‘å¡çŸ©é˜µçš„é€†çŸ©é˜µï¼Œæœ€åè®¡ç®—çŸ©é˜µä¸å‘é‡ä¹˜ç§¯å®ç°æ—¶é€šå¸¸ä¸ç›´æ¥æ±‚é»‘å¡çŸ©é˜µçš„é€†çŸ©é˜µï¼Œè€Œæ˜¯æ±‚è§£å¦‚ä¸‹æ–¹ç¨‹ç»„æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„å¯ä½¿ç”¨è¿­ä»£æ³•ï¼Œå¦‚å…±è½­æ¢¯åº¦æ³•2ï¸âƒ£å¦ä¸€ä¸ªé—®é¢˜æ˜¯é»‘å¡çŸ©é˜µå¯èƒ½ä¸å¯é€†ï¼Œä»è€Œå¯¼è‡´å…¶å¤±æ•ˆæ‹Ÿç‰›é¡¿æ³•æ‹Ÿç‰›é¡¿æ³•(Quasi-Newton Methods)å¯¹ç‰›é¡¿æ³•å­˜åœ¨çš„é—®é¢˜è¿›è¡Œäº†æ”¹è¿›å…¶æ ¸å¿ƒæ€è·¯æ˜¯ä¸ç²¾ç¡®è®¡ç®—ç›®æ ‡å‡½æ•°çš„é»‘å¡çŸ©é˜µç„¶åæ±‚é€†çŸ©é˜µï¼Œè€Œæ˜¯é€šè¿‡å…¶ä»–æ‰‹æ®µå¾—åˆ°é»‘å¡çŸ©é˜µçš„é€†å…·ä½“åšæ³•æ˜¯æ„é€ ä¸€ä¸ªè¿‘ä¼¼é»‘å¡çŸ©é˜µæˆ–å…¶é€†çŸ©é˜µçš„æ­£å®šå¯¹ç§°çŸ©é˜µï¼Œç”¨è¯¥çŸ©é˜µè¿›è¡Œç‰›é¡¿æ³•è¿­ä»£ç”±äºè¦æ¨å¯¼ä¸‹ä¸€ä¸ªè¿­ä»£ç‚¹çš„é»‘å¡çŸ©é˜µéœ€è¦æ»¡è¶³çš„æ¡ä»¶ï¼Œå¹¶å»ºç«‹ä¸ä¸Šä¸€ä¸ªè¿­ä»£ç‚¹å¤„çš„å‡½æ•°å€¼ã€å¯¼æ•°å€¼ä¹‹é—´çš„å…³ç³»ï¼Œä»¥æŒ‡å¯¼è¿‘ä¼¼çŸ©é˜µçš„æ„é€ ï¼Œå› æ­¤éœ€è¦åœ¨ç‚¹å¤„ä½œæ³°å‹’å±•å¼€ï¼Œå¹¶å°†çš„å€¼ä»£å…¥æ³°å‹’å…¬å¼å°†å‡½æ•°åœ¨$x_{k+1}$ç‚¹å¤„ä½œäºŒé˜¶æ³°å‹’å±•å¼€ï¼Œå¿½ç•¥é«˜æ¬¡é¡¹ï¼Œæœ‰ä¸Šå¼ä¸¤è¾¹åŒæ—¶å¯¹$x$å–æ¢¯åº¦ï¼Œå¯ä»¥å¾—åˆ°å¦‚æœä»¤$x=x_{k}$ï¼Œåˆ™æœ‰å°†æ¢¯åº¦å‘é‡ä¸é»‘å¡çŸ©é˜µç®€å†™ï¼Œåˆ™æœ‰å¦‚æœä»¤åˆ™ä¸Šå¼å¯ç®€å†™ä¸ºè¿™é‡Œçš„å’Œéƒ½å¯ä»¥æ ¹æ®ä¹‹å‰çš„è¿­ä»£ç»“æœç›´æ¥ç®—å‡ºï¼Œå¦‚æœå¯é€†ï¼Œé‚£ä¹ˆä¸Šå¼ç­‰ä»·äºä¸Šä¸¤å¼ç§°ä¸ºæ‹Ÿç‰›é¡¿æ¡ä»¶ï¼Œç”¨äºè¿‘ä¼¼ä»£æ›¿é»‘å¡çŸ©é˜µå’Œå®ƒçš„é€†çŸ©é˜µçš„çŸ©é˜µéœ€è¦æ»¡è¶³è¯¥æ¡ä»¶åˆ©ç”¨è¯¥æ¡ä»¶ï¼Œæ ¹æ®ä¸Šä¸€ä¸ªè¿­ä»£ç‚¹å’Œå½“å‰è¿­ä»£ç‚¹çš„å€¼ä»¥åŠè¿™ä¸¤ç‚¹å¤„çš„æ¢¯åº¦å€¼ï¼Œå°±å¯ä»¥è¿‘ä¼¼è®¡ç®—å‡ºå½“å‰ç‚¹çš„é»‘å¡çŸ©é˜µæˆ–å…¶é€†çŸ©é˜µç”±äºé»‘å¡çŸ©é˜µä¸å®ƒçš„é€†çŸ©é˜µå‡å¯¹ç§°ï¼Œå› æ­¤å®ƒä»¬çš„è¿‘ä¼¼çŸ©é˜µä¹Ÿè¦æ±‚æ˜¯å¯¹ç§°çš„æ­¤å¤–ï¼Œé€šå¸¸è¿˜è¦æ±‚è¿‘ä¼¼çŸ©é˜µæ­£å®šï¼Œæ‹Ÿç‰›é¡¿æ³•é€šè¿‡å„ç§æ–¹æ³•æ„é€ å‡ºæ»¡è¶³ä¸Šè¿°æ¡ä»¶çš„è¿‘ä¼¼çŸ©é˜µä¸‹é¢ä»‹ç»å…¸å‹çš„å®ç°ï¼šDFPç®—æ³•ä»¥åŠBFGSç®—æ³•DFPç®—æ³•é—®é¢˜çš„æ ¸å¿ƒæ˜¯æ„é€ é»‘å¡çŸ©é˜µæˆ–å…¶é€†çŸ©é˜µçš„è¿‘ä¼¼çŸ©é˜µ$H_{k}$ï¼Œä¿è¯æ»¡è¶³æ‹Ÿç‰›é¡¿æ¡ä»¶é¦–å…ˆä¸ºè¯¥çŸ©é˜µè®¾å®šåˆå§‹å€¼ï¼Œç„¶ååœ¨æ¯æ¬¡è¿­ä»£æ—¶æ›´æ–°æ­¤è¿‘ä¼¼çŸ©é˜µå…¶ä¸­ç§°ä¸ºæ ¡æ­£çŸ©é˜µï¼Œç°åœ¨çš„ä»»åŠ¡å˜ä¸ºå¯»æ‰¾è¯¥çŸ©é˜µï¼Œæ ¹æ®ä¸Šå¼ï¼Œå¦‚æœä»¥å……å½“é»‘å¡çŸ©é˜µé€†çŸ©é˜µçš„è¿‘ä¼¼ï¼Œæœ‰ä¸Šå¼å˜å½¢åå¾—åˆ°DFPç®—æ³•é‡‡ç”¨äº†è¿™ç§æ€è·¯ï¼ŒDFP(Davidon-Fletcher-Powell)ç®—æ³•ä»¥å…¶3ä½å‘æ˜äººçš„åå­—å‘½åç®—æ³•æ„é€ é»‘å¡çŸ©é˜µé€†çŸ©é˜µçš„è¿‘ä¼¼(Inverse Hessian Approximation)ï¼Œå…¶åˆå§‹å€¼ä¸ºå•ä½çŸ©é˜µ$I$ï¼Œæ¯æ¬¡è¿­ä»£æ—¶æŒ‰ç…§ä¸‹å¼æ›´æ–°è¯¥çŸ©é˜µå³æ ¡æ­£çŸ©é˜µä¸ºå…¶ä¸­å’Œä¸ºå¾…å®šçš„ç»´å‘é‡ï¼Œå’Œä¸ºå¾…å®šçš„ç³»æ•°æ˜¾ç„¶ï¼ŒæŒ‰ç…§ä¸Šå¼æ„é€ çš„$\boldsymbol{H}_{k}$æ˜¯ä¸€ä¸ªå¯¹ç§°çŸ©é˜µæ ¹æ®ä¸Šå‡ ä¸ªå¼å­ï¼Œæ ¡æ­£çŸ©é˜µå¿…é¡»æ»¡è¶³å³æ­¤æ–¹ç¨‹çš„è§£ä¸å”¯ä¸€ï¼Œå¯ä»¥å–æŸäº›ç‰¹æ®Šå€¼ä»è€Œç®€åŒ–é—®é¢˜çš„æ±‚è§£ï¼Œè¿™é‡Œä»¤åŒæ—¶ä»¤å°†è¿™ä¸¤ä¸ªè§£ä»£äººä¸Šé¢çš„ä¸¤ä¸ªæ–¹ç¨‹ï¼Œå¯ä»¥å¾—åˆ°ä»¥åŠä¸Šé¢ä¸¤ä¸ªç»“æœåˆ©ç”¨äº†çŸ©é˜µä¹˜æ³•çš„ç»“åˆå¾‹ä»¥åŠæ˜¯å¯¹ç§°çŸ©é˜µè¿™ä¸€æ¡ä»¶ï¼Œåœ¨è¿™é‡Œä¸å‡ä¸ºæ ‡é‡ï¼Œä»è€Œè§£å¾—å°†ä¸Šé¢çš„è§£ä»£äººå¼ (4.16)ï¼Œç”±æ­¤å¾—åˆ°çŸ©é˜µ$H_{k}$çš„æ›´æ–°å…¬å¼æ­¤æ›´æ–°å…¬å¼å¯ä»¥ä¿è¯$H_{k}$çš„å¯¹ç§°æ­£å®šæ€§æ¯æ¬¡è¿­ä»£æ—¶ï¼Œå¾—åˆ°çŸ©é˜µ$H_{k}$ä¹‹åç”¨ç‰›é¡¿æ³•è¿›è¡Œæ›´æ–°ï¼Œç”±äºæ„é€ çš„æ˜¯é»‘å¡çŸ©é˜µé€†çŸ©é˜µçš„è¿‘ä¼¼ï¼Œå› æ­¤å¯ä»¥ç›´æ¥å°†å…¶ä¸æ¢¯åº¦å‘é‡ç›¸ä¹˜ä»è€Œå¾—åˆ°ç‰›é¡¿æ–¹ å‘DFPç®—æ³•çš„æµç¨‹å¦‚ä¸‹ç®—æ³•æ‰€ç¤ºğŸ§®DFPç®—æ³•åˆå§‹åŒ–$x_{0}$ï¼Œ$H_0$ï¼Œ$k=0$while $k&lt;N$ doâ€‹    è¿­ä»£â€‹    ç”¨ç›´çº¿æœç´¢å¾—åˆ°æ­¥é•¿$\lambda_{k}$â€‹    è¿­ä»£â€‹    if $\left|g_{k+1}\right|&lt;eps$ thenâ€‹        ç»“æŸå¾ªç¯â€‹    end ifâ€‹    è¿­ä»£â€‹    è¿­ä»£â€‹    $k=k+1$end whileå¦‚æœç”¨å•ä½çŸ©é˜µåˆå§‹åŒ–$\boldsymbol{H}_{k}$ï¼Œåˆ™ç¬¬ä¸€æ¬¡è¿­ä»£æ—¶è¿™ç›¸å½“äºä½¿ç”¨æ¢¯åº¦ä¸‹é™æ³•ï¼Œåé¢é€æ­¥ç»†åŒ–$H_{k}$ï¼Œä½¿å…¶æ›´ç²¾ç¡®åœ°é€šè¿‘å½“å‰ç‚¹å¤„é»‘å¡çŸ©é˜µçš„é€†çŸ©é˜µã€‚BFGSç®—æ³•BFGS(Broyden-Fletcher-Goldfarb-Shanno)ç®—æ³•ä»¥å…¶4ä½å‘æ˜äººçš„åå­—å‘½åç®—æ³•æ„é€ é»‘å¡çŸ©é˜µçš„ä¸€ä¸ªè¿‘ä¼¼çŸ©é˜µ$B_{k}$å¹¶ç”¨ä¸‹å¼è¿­ä»£æ›´æ–°è¿™ä¸ªçŸ©é˜µè¯¥çŸ©é˜µçš„åˆå§‹å€¼ä¸ºå•ä½é˜µï¼Œè¦è§£å†³çš„é—®é¢˜å°±æ˜¯æ¯æ¬¡çš„æ ¡æ­£çŸ©é˜µçš„æ„é€ æ ¹æ®å‰é¢çš„å¼å­ï¼Œé»‘å¡çŸ©é˜µçš„è¿‘ä¼¼çŸ©é˜µ$B_{k}$éœ€è¦æ»¡è¶³ä¸DFPç®—æ³•ç›¸åŒï¼Œæ ¡æ­£çŸ©é˜µæ„é€ ä¸ºå¦‚ä¸‹å½¢å¼å°†å…¶ä»£äººå¼ (4.20)ï¼Œå¯ä»¥å¾—åˆ°æ•´ç†åå¯å¾—åŒæ ·ï¼Œå¯ä»¥å–è¿™ä¸ªæ–¹ç¨‹çš„ä¸€ç»„ç‰¹æ®Šè§£ï¼Œè¿™é‡Œç›´æ¥ä»¤åŒæ—¶ä»¤ä¸¤ä¸ªå‘é‡ä¸ºå°†å®ƒä»¬çš„ä»£å…¥ä¸Šé¢ä¸¤ä¸ªæ–¹ç¨‹ï¼Œå¯å¾—ä»¥åŠä»è€Œè§£å¾—ä¸¤ä¸ªç³»æ•°ä¸ºç”±æ­¤å¾—åˆ°æ ¡æ­£çŸ©é˜µä¸ºå¦‚æœåˆå§‹å€¼æ˜¯æ­£å®šçŸ©é˜µï¼Œä¸”åœ¨æ¯æ¬¡è¿­ä»£æ—¶ï¼Œåˆ™æ¯æ¬¡æ›´æ–°åå¾—åˆ°çš„éƒ½æ˜¯æ­£å®šçš„ç”±äºBFGSç®—æ³•æ„é€ çš„æ˜¯é»‘å¡çŸ©é˜µçš„è¿‘ä¼¼ï¼Œå› æ­¤è¿˜éœ€è¦æ±‚è§£æ–¹ç¨‹ç»„ä»¥å¾—åˆ°ç‰›é¡¿æ–¹å‘è€Œ$B_{k}$æ˜¯æ­£å®šå¯¹ç§°çŸ©é˜µï¼Œå¯ä»¥é‡‡ç”¨é«˜æ•ˆçš„æ–¹æ³•æ±‚è§£æ­¤çº¿æ€§æ–¹ç¨‹ç»„æ¯”è¾ƒDFPç®—æ³•ä¸BFGSç®—æ³•å¯ä»¥å‘ç°ï¼ŒäºŒè€…çš„æ ¡æ­£çŸ©é˜µè®¡ç®—å…¬å¼äº’ä¸ºå¯¹å¶ï¼Œå°†ä¸çš„è§’è‰²è¿›è¡Œäº†å¯¹æ¢BFGSç®—æ³•çš„æµç¨‹å¦‚ä¸‹ç®—æ³•æ‰€ç¤ºğŸ§®BFGSç®—æ³•åˆå§‹åŒ–$x_{0}$ï¼Œ$B_0=I$ï¼Œ$k=0$while $k&lt;N$ doâ€‹    è¿­ä»£â€‹    ç”¨ç›´çº¿æœç´¢å¾—åˆ°æ­¥é•¿$\lambda_{k}$â€‹    è¿­ä»£â€‹    if $\left|g_{k+1}\right|&lt;eps$ thenâ€‹        ç»“æŸå¾ªç¯â€‹    end ifâ€‹    è¿­ä»£â€‹    è¿­ä»£â€‹    $k=k+1$end whileBFGS ç®—æ³•åœ¨æ¯æ¬¡è¾¾ä»£æ—¶éœ€è¦è®¡ç®—$n \times n$çš„çŸ©é˜µ$\boldsymbol{B}_{k}$ï¼Œå½“$n$å¾ˆå¤§æ—¶ï¼Œå­˜å‚¨è¯¥çŸ©é˜µå°†è€—è´¹å¤§é‡å†…å­˜ä¸ºæ­¤ï¼Œæå‡ºäº†æ”¹è¿›æ–¹æ¡ˆL-BFGSç®—æ³•(æœ‰é™å­˜å‚¨çš„BFGSç®—æ³•)ï¼Œå…¶æ€æƒ³æ˜¯ä¸å­˜å‚¨å®Œæ•´çš„çŸ©é˜µï¼Œåªå­˜å‚¨å‘é‡å’Œå¯¹äºå¤§å¤šæ•°ç›®æ ‡å‡½æ•°ï¼ŒBFGS ç®—æ³•æœ‰å¾ˆå¥½çš„æ”¶æ•›æ•ˆæœä¸‹å›¾æ˜¯ç”¨L-BFGSç®—æ³•æ±‚è§£$x^{2}+y^{2}$æå€¼çš„è¿­ä»£è¿‡ç¨‹ï¼Œç®—æ³•åªéœ€è¦è¾¾ä»£4æ¬¡å³å¯æ”¶æ•›åˆ°æå°å€¼ç‚¹å¤„xxxå›¾L-BFGSç®—æ³•æ±‚è§£$x^{2}+y^{2}$æå€¼çš„è¿­ä»£è¿‡ç¨‹åˆ†æ²»æ³•åˆ†æ²»æ³•æ˜¯ç®—æ³•è®¾è®¡ä¸­å¸¸ç”¨çš„æ€è·¯ï¼Œå®ƒæŠŠä¸€ä¸ªé—®é¢˜æ‹†åˆ†æˆå¤šä¸ªå­é—®é¢˜ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œå­é—®é¢˜æ›´å®¹æ˜“æ±‚è§£åœ¨æ±‚å¾—å­é—®é¢˜çš„è§£ä¹‹åï¼Œå°†å…¶åˆå¹¶å¾—åˆ°æ•´ä¸ªé—®é¢˜çš„è§£åœ¨ç”¨äºæœ€ä¼˜åŒ–æ–¹æ³•æ—¶çš„é€šè¡Œåšæ³•æ˜¯æ¯æ¬¡åªä¼˜åŒ–éƒ¨åˆ†å˜é‡ï¼Œå°†é«˜ç»´ä¼˜åŒ–é—®é¢˜åˆ†è§£ä¸ºä½ç»´ä¼˜åŒ–é—®é¢˜åæ ‡ä¸‹é™æ³•åæ ‡ä¸‹é™æ³•(Coordinate Descent)æ˜¯åˆ†æ²»æ³•çš„å…¸å‹ä»£è¡¨å¯¹äºå¤šå…ƒå‡½æ•°çš„ä¼˜åŒ–é—®é¢˜ï¼Œåæ ‡ä¸‹é™æ³•æ¯æ¬¡åªå¯¹ä¸€ä¸ªåˆ†é‡è¿›è¡Œä¼˜åŒ–ï¼Œå°†å…¶ä»–åˆ†é‡å›ºå®šä¸åŠ¨ç®—æ³•ä¾æ¬¡ä¼˜åŒ–æ¯ä¸€ä¸ªå˜é‡ï¼Œç›´è‡³æ”¶æ•›ï¼Œå‡è®¾è¦æ±‚è§£çš„ä¼˜åŒ–é—®é¢˜ä¸ºç®—æ³•åœ¨æ¯æ¬¡è¿­ä»£æ—¶ä¾æ¬¡é€‰æ‹©è¿›è¡Œä¼˜åŒ–ï¼Œæ±‚è§£å•ä¸ªå˜é‡çš„ä¼˜åŒ–é—®é¢˜å®Œæ•´çš„ç®—æ³•æµç¨‹å¦‚ä¸‹ç®—æ³•æ‰€ç¤ºğŸ§®åæ ‡ä¸‹é™æ³•åˆå§‹åŒ–$x_{0}$while æ²¡æœ‰æ”¶æ•› doâ€‹    for i=1,2, $\cdots$, n doâ€‹        æ±‚è§£ $min_{x_i}{f(x)}$â€‹    end forend whileç®—æ³•æ¯æ¬¡è¿­ä»£æ—¶åœ¨å½“å‰ç‚¹å¤„æ²¿ä¸€ä¸ªåæ ‡è½´æ–¹å‘è¿›è¡Œä¸€ç»´æœç´¢ï¼Œå›ºå®šå…¶ä»–åæ ‡è½´æ–¹å‘å¯¹åº”çš„åˆ†é‡ï¼Œæ±‚è§£ä¸€å…ƒå‡½æ•°çš„æå€¼åœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­ä¾æ¬¡å¾ªç¯ä½¿ç”¨ä¸åŒåæ ‡è½´æ–¹å‘å¯¹åº”çš„åˆ†é‡è¿›è¡Œè¾¾ä»£ï¼Œæ›´æ–°è¿™äº›åˆ†é‡çš„å€¼ï¼Œä¸€ä¸ªå‘¨æœŸçš„ä¸€ç»´æœç´¢è¿­ä»£è¿‡ç¨‹ç›¸å½“äºä¸€æ¬¡æ¢¯åº¦ä¸‹é™æ³•é€ ä»£å®Œæˆå¯¹ä¼˜åŒ–å˜é‡æ¯ä¸ªåˆ†é‡çš„ä¸€æ¬¡æ›´æ–°åæ ‡ä¸‹é™æ³•çš„æ±‚è§£è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¿™é‡Œæ˜¯äºŒç»´ä¼˜åŒ–é—®é¢˜xxxå›¾åæ ‡ä¸‹é™æ³•æ±‚è§£äºŒç»´ä¼˜åŒ–é—®é¢˜çš„è¿­ä»£è¿‡ç¨‹åœ¨æ¯æ¬¡è¿ä»£æ—¶ï¼Œé¦–å…ˆå›ºå®š$y$è½´åˆ†é‡ï¼Œä¼˜åŒ–$x$è½´åˆ†é‡ï¼›ç„¶åå›ºå®š$x$è½´åˆ†é‡ï¼Œä¼˜åŒ–$y$è½´åˆ†é‡ï¼Œæ•´ä¸ªä¼˜åŒ–è¿‡ç¨‹åœ¨å„ä¸ªåæ ‡è½´æ–¹å‘ä¹‹é—´è½®æ¢ åæ ‡ä¸‹é™æ³•å…·æœ‰è®¡ç®—é‡å°ã€å®ç°æ•ˆç‡é«˜çš„ä¼˜ç‚¹ï¼Œåœ¨æœºå™¨å­¦ä¹ é¢†åŸŸå¾—åˆ°äº†æˆåŠŸçš„åº”ç”¨å…¸å‹çš„æ˜¯æ±‚è§£çº¿æ€§æ¨¡å‹çš„è®­ç»ƒé—®é¢˜ï¼Œåœ¨å¼€æºåº“liblinearä¸­æœ‰å®ç°ï¼Œæ­¤å¤–ï¼Œåœ¨æ±‚è§£éè´ŸçŸ©é˜µåˆ†è§£é—®é¢˜ä¸­ä¹Ÿæœ‰åº”ç”¨ç¼ºç‚¹åæ ‡ä¸‹é™æ³•çš„ç¼ºç‚¹æ˜¯å¯¹éå…‰æ»‘(ä¸å¯å¯¼)çš„å¤šå…ƒç›®æ ‡å‡½æ•°å¯èƒ½æ— æ³•è¿›è¡Œæœ‰æ•ˆå¤„ç†ï¼Œä»¥åŠéš¾ä»¥å¹¶è¡ŒåŒ–è€ƒè™‘ä¸‹é¢çš„ç›®æ ‡å‡½æ•°f(x, y)=|x+y|+3|y-x|å¦‚æœå½“å‰è¿­ä»£ç‚¹ä¸º$(-2,-2)$ï¼Œå•ç‹¬åœ¨$x$è½´å’Œ$y$è½´æ–¹å‘è¿›è¡Œè¿­ä»£å‡æ— æ³•ä¿è¯ç›®æ ‡å‡½æ•°å€¼ä¸‹é™ï¼Œæ­¤æ—¶åæ ‡ä¸‹é™æ³•å¤±æ•ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå›¾ä¸­ç”»å‡ºäº†ç›®æ ‡å‡½æ•°çš„ç­‰é«˜çº¿ï¼Œ$(0,0)$æ˜¯æå°å€¼ç‚¹ï¼Œåœ¨$(-2,-2)$ç‚¹å¤„ï¼Œå•ç‹¬æ”¹å˜$x$æˆ–$y$çš„å€¼å‡ä¸èƒ½ä½¿ç›®æ ‡å‡½æ•°å€¼ä¸‹é™xxxå›¾ 4.16 åæ ‡ä¸‹é™æ³•å¤±æ•ˆçš„ä¾‹å­SMOç®—æ³•SMO(Sequential Minimal Optimization)ç®—æ³•æ˜¯æ±‚è§£æ”¯æŒå‘é‡æœºå¯¹å¶é—®åŸçš„é«˜æ•ˆç®—æ³•ç®—æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯æ¯æ¬¡ä»ä¼˜åŒ–å˜é‡ä¸­æŒ‘å‡ºä¸¤ä¸ªåˆ†é‡è¿›è¡Œä¼˜åŒ–ï¼Œè®©å…¶ä»–åˆ†é‡å›ºå®šï¼Œè¿™æ ·èƒ½ä¿è¯æ»¡è¶³ç­‰å¼çº¦æŸæ¡ä»¶å‡è®¾è®­ç»ƒæ ·æœ¬é›†ä¸ºï¼Œå…¶ä¸­ä¸ºæ ·æœ¬çš„ç‰¹å¾å‘é‡ï¼Œä¸ºæ ‡ç­¾å€¼åœ¨ä½¿ç”¨æ ¸å‡½æ•°ä¹‹åï¼Œæ”¯æŒå‘é‡æœºåœ¨è®­ç»ƒæ—¶æ±‚è§£çš„å¯¹å¶é—®é¢˜ä¸º$C$ä¸ºæƒ©ç½šå› å­ï¼Œæ˜¯äººå·¥è®¾å®šçš„æ­£å¸¸æ•°ï¼Œæ ¸çŸ©é˜µçš„å…ƒç´ ä¸ºè¿™é‡Œä¸ºæ ¸å‡½æ•°ï¼Œå°†ä¸¤ä¸ªå‘é‡æ˜ å°„ä¸ºä¸€ä¸ªå®æ•°è¯¥å¯¹å¶é—®é¢˜æ˜¯äºŒæ¬¡è§„åˆ’é—®é¢˜ï¼Œé—®é¢˜è§„æ¨¡ç”±è®­ç»ƒæ ·æœ¬æ•°$l$å†³å®šï¼Œå…¶å€¼å¾ˆå¤§æ—¶ï¼Œå¸¸è§„çš„æ±‚è§£ç®—æ³•å°†é¢ä¸´è®¡ç®—æ•ˆç‡ä½å’Œå­˜å‚¨ç©ºé—´å ç”¨å¤ªå¤§çš„é—®é¢˜SMOç®—æ³•æ¯æ¬¡é€‰æ‹©ä¸¤ä¸ªå˜é‡è¿›è¡Œä¼˜åŒ–ï¼Œå‡è®¾é€‰å–çš„ä¸¤ä¸ªåˆ†é‡ä¸ºå’Œï¼Œå…¶ä»–åˆ†é‡éƒ½å›ºå®šï¼Œå½“æˆå¸¸æ•°ç”±äºã€ï¼Œå¯¹è¿™ä¸¤ä¸ªå˜é‡çš„ç›®æ ‡å‡½æ•°å¯ä»¥å†™æˆå…¶ä¸­$c$æ˜¯ä¸€ä¸ªå¸¸æ•°ã€‚è¿™é‡Œå®šä¹‰è¿™é‡Œçš„$\alpha^{*}$ä¸º$\alpha$åœ¨ä¸Šä¸€è½®è¿­ä»£åçš„å€¼å­é—®é¢˜çš„ç›®æ ‡å‡½æ•°æ˜¯äºŒå…ƒäºŒæ¬¡å‡½æ•°ï¼Œå¯ä»¥ç›´æ¥ç»™å‡ºæœ€å°å€¼ çš„è§£æè§£ï¼Œè¿™ä¸ªé—®é¢˜çš„çº¦æŸæ¡ä»¶ä¸ºåˆ©ç”¨ä¸Šé¢çš„ç­‰å¼çº¦æŸå¯ä»¥æ¶ˆæ‰ï¼Œä»è€Œåªå‰©ä¸‹å˜é‡ï¼Œç›®æ ‡å‡½æ•°æ˜¯çš„äºŒæ¬¡å‡½æ•°ï¼Œç›´æ¥æ±‚å¾—è§£æè§£åˆ†é˜¶æ®µä¼˜åŒ–AdaBoostç®—æ³•åœ¨è®­ç»ƒæ—¶åŒæ ·é‡‡å–äº†åˆ†æ²»æ³•çš„ç­–ç•¥ï¼Œæ¯æ¬¡è¿­ä»£æ—¶å…ˆè®­ç»ƒå¼±åˆ†ç±»å™¨ï¼Œç„¶åç¡®å®šå¼±åˆ†ç±»å™¨çš„æƒé‡ç³»æ•°AdaBoostç®—æ³•åœ¨è®­ç»ƒæ—¶çš„ç›®æ ‡æ˜¯æœ€å°åŒ–æŒ‡æ•°æŸå¤±å‡½æ•°å‡è®¾å¼ºåˆ†ç±»å™¨ä¸º$F(x)$ï¼Œ$x \in \mathbb{R}^{n}$ä¸ºç‰¹å¾å‘é‡ï¼Œ$y=\pm 1$ä¸ºæ ‡ç­¾å€¼ï¼Œå•ä¸ªè®­ç»ƒæ ·æœ¬çš„æŒ‡æ•°æŸå¤±å‡½æ•°ä¸ºå¼ºåˆ†ç±»å™¨æ˜¯å¼±åˆ†ç±»å™¨çš„åŠ æƒç»„åˆï¼Œå®šä¹‰ä¸ºå…¶ä¸­æ˜¯ç¬¬ä¸ªå¼±åˆ†ç±»å™¨ï¼Œæ˜¯å…¶æƒé‡ï¼Œä¸ºå¼±åˆ†ç±»å™¨çš„æ•°é‡è®­ç»ƒæ—¶ä¾æ¬¡è®­ç»ƒæ¯ä¸ªå¼±åˆ†ç±»å™¨ï¼Œå°†å…¶åŠ äººå¼ºåˆ†ç±»å™¨ä¸­å°†å¼ºåˆ†ç±»å™¨çš„è®¡ç®—å…¬å¼ä»£äººä¸Šé¢çš„æŸå¤±å‡½æ•°ä¸­ï¼Œå¾—åˆ°è®­ç»ƒç¬¬$j$ä¸ªå¼±åˆ†ç±»å™¨æ—¶å¯¹æ•´ä¸ªè®­ç»ƒæ ·æœ¬é›†çš„è®­ç»ƒæŸå¤±å‡½æ•°ä¸ºè¿™é‡Œå°†å¼ºåˆ†ç±»å™¨æ‹†æˆä¸¤éƒ¨åˆ†ç¬¬ä¸€éƒ¨åˆ†æ˜¯ä¹‹å‰çš„è¿­ä»£å·²ç»å¾—åˆ°çš„å¼ºåˆ†ç±»å™¨$F_{j-1}$ç¬¬äºŒéƒ¨åˆ†æ˜¯å½“å‰è¦è®­ç»ƒçš„å¼±åˆ†ç±»å™¨$f$ä¸å…¶æƒé‡$\beta$çš„ä¹˜ç§¯å¯¹è®­ç»ƒæ ·æœ¬çš„æŸå¤±å‡½æ•°å‰è€…åœ¨ä¹‹å‰çš„è¿­ä»£ä¸­å·²ç»æ±‚å‡ºï¼Œå› æ­¤å¯ä»¥çœ‹æˆå¸¸æ•°ï¼Œä¸Šå¼ç›®æ ‡å‡½æ•°å¯ä»¥ç®€åŒ–ä¸ºå…¶ä¸­å®ƒåªå’Œå‰é¢è¿­ä»£å¾—åˆ°çš„å¼ºåˆ†ç±»å™¨æœ‰å…³ï¼Œä¸å½“å‰çš„å¼±åˆ†ç±»å™¨ã€å¼±åˆ†ç±»å™¨æƒé‡æ— å…³ï¼Œè¿™å°±æ˜¯æ ·æœ¬æƒé‡ä¸Šä¸Šå¼çš„é—®é¢˜å¯ä»¥åˆ†ä¸¤æ­¥æ±‚è§£ï¼Œé¦–å…ˆå°†$\beta$çœ‹æˆå¸¸æ•°ç”±äºå’Œçš„å–å€¼åªèƒ½ä¸ºæˆ–ï¼Œä¸”æ ·æœ¬æƒé‡éè´Ÿï¼Œè¦è®©ä¸Šä¸Šå¼çš„ç›®æ ‡å‡½æ•°æœ€å°åŒ–ï¼Œå¿…é¡»è®©äºŒè€…ç›¸ç­‰å› æ­¤æŸå¤±å‡½æ•°å¯¹$f(x)$çš„æœ€ä¼˜è§£ä¸ºå…¶ä¸­$I$æ˜¯æŒ‡æ ‡å‡½æ•°ï¼Œå¦‚æœæ‹¬å·é‡Œçš„æ¡ä»¶æˆç«‹ï¼Œå…¶å€¼ä¸º1ï¼Œå¦åˆ™ä¸º0ä¸Šå¼çš„æœ€ä¼˜è§£æ˜¯ä½¿å¾—å¯¹æ ·æœ¬çš„åŠ æƒè¯¯å·®æœ€å°çš„å¼±åˆ†ç±»å™¨ï¼Œåœ¨å¾—åˆ°å¼±åˆ†ç±»å™¨ä¹‹åï¼Œå¼å­çš„ä¼˜åŒ–ç›®æ ‡å¯ä»¥è¡¨ç¤ºæˆ$\beta$çš„å‡½æ•°ä¸Šå¼å‰åŠéƒ¨åˆ†æ˜¯è¢«å½“å‰çš„å¼±åˆ†ç±»å™¨æ­£ç¡®åˆ†ç±»çš„æ ·æœ¬ï¼Œæ­¤æ—¶ä¸åŒå·ä¸”ï¼Œï¼ŒååŠéƒ¨åˆ†æ˜¯è¢«å½“å‰çš„å¼±åˆ†ç±»å™¨é”™è¯¯åˆ†ç±»çš„æ ·æœ¬ï¼Œè¿™ç§æƒ…å†µæœ‰ï¼Œç›®æ ‡å‡½æ•°å¯ä»¥è¿›ä¸€æ­¥å†™æˆå…·ä½“æ¨å¯¼è¿‡ç¨‹ä¸ºå‡½æ•°åœ¨æå€¼ç‚¹çš„å¯¼æ•°ä¸º0ï¼Œå¯¹$\beta$æ±‚å¯¼å¹¶ä»¤å…¶ä¸º0ä¸Šå¼ä¸¤è¾¹åŒé™¤ä»¥ï¼Œç”±æ­¤å¾—åˆ°å…³äºçš„æ–¹ç¨‹æœ€åå¾—åˆ°æœ€ä¼˜è§£ä¸ºå…¶ä¸­$err_{j}$ä¸ºå½“å‰å¼±åˆ†ç±»å™¨å¯¹è®­ç»ƒæ ·æœ¬é›†çš„åŠ æƒé”™è¯¯ç‡åœ¨å¾—åˆ°å½“å‰å¼±åˆ†ç±»å™¨ä¹‹åï¼Œå¯¹å¼ºåˆ†ç±»å™¨è¿›è¡Œæ›´æ–°ä¸‹æ¬¡è¿­ä»£æ—¶æ ·æœ¬çš„æƒé‡ä¸ºå³AdaBoostè®­ç»ƒç®—æ³•ä¸­çš„æ ·æœ¬æƒé‡æ›´æ–°å…¬å¼åº”ç”¨logisticå›å½’ä¸‹é¢ä»‹ç»åæ ‡ä¸‹é™æ³•åœ¨æ±‚è§£logisticå›å½’è®­ç»ƒé—®é¢˜ä¸­çš„åº”ç”¨ï¼Œç»™å®š$l$ä¸ªè®­ç»ƒæ ·æœ¬ï¼Œï¼Œå…¶ä¸­ä¸ºç‰¹å¾å‘é‡ï¼Œä¸ºæ ‡ç­¾å€¼L2æ­£åˆ™åŒ–logisticå›å½’çš„å¯¹å¶é—®é¢˜ä¸ºå…¶ä¸­$C$ä¸ºæƒ©ç½šå› å­ï¼ŒçŸ©é˜µ$Q$å®šä¹‰ä¸ºå¦‚æœå®šä¹‰å®ƒä¸ä¸‹é¢çš„æé™æ˜¯ä¸€è‡´çš„æœ€å°åŒ–å¼å¯ä»¥ç®€åŒ–ä¸ºä¸Šå¼çš„ç›®æ ‡å‡½æ•°ä¸­å¸¦æœ‰å¯¹æ•°å‡½æ•°ï¼Œå¯ä»¥é‡‡ç”¨åæ ‡ä¸‹é™æ³•æ±‚è§£ä¸å…¶ä»–æœ€ä¼˜åŒ–æ–¹æ³•(å¦‚å…±è½­æ¢¯åº¦æ³•ã€æ‹Ÿç‰›é¡¿æ³•)ç›¸æ¯”ï¼Œåæ ‡ä¸‹é™æ³•æœ‰æ›´å¿«çš„è¿­ä»£é€Ÿåº¦ï¼Œæ›´é€‚åˆå¤§è§„æ¨¡é—®é¢˜çš„æ±‚è§£ä¸‹é¢æˆ‘ä»¬ä»‹ç»å¸¦çº¦æŸæ¡ä»¶çš„åæ ‡ä¸‹é™æ³•æ±‚è§£æ€è·¯åœ¨ç”¨åæ ‡ä¸‹é™æ³•æ±‚è§£æ—¶ï¼Œé‡‡ç”¨äº†ä¸€ä¸ªæŠ€å·§ï¼Œä¸æ˜¯ç›´æ¥ä¼˜åŒ–ä¸€ä¸ªå˜é‡ï¼Œè€Œæ˜¯ä¼˜åŒ–è¯¥å˜é‡çš„å¢é‡å‡è®¾æœ¬æ¬¡è¿­ä»£æ—¶è¦ä¼˜åŒ–ï¼Œå°†å…¶ä»–çš„å›ºå®šä¸åŠ¨å‡è®¾æœ¬æ¬¡è¿­ä»£ä¹‹åçš„å€¼ä¸ºï¼Œåœ¨è¿™é‡Œä¸ºä¸€ä¸ªå¸¸æ•°ï¼Œæ˜¯ä¸Šä¸€æ¬¡è¿­ä»£åçš„å€¼ç”¨æ›¿æ¢ï¼Œæœ€å°åŒ–å¼å­çš„ç›®æ ‡å‡½æ•°ä»¥åŠä¸ç­‰å¼çº¦æŸå¯ä»¥å†™æˆçš„å‡½æ•°å…¶ä¸­æ‰€æœ‰å¸¸æ•°å®šä¹‰ä¸ºå› ä¸ºç›®æ ‡å‡½æ•°å«æœ‰å¯¹æ•°å‡½æ•°ï¼Œä¸Šé¢çš„å‡½æ•°æ˜¯ä¸€ä¸ªè¶…è¶Šå‡½æ•°ï¼Œæ— æ³•ç»™å‡ºæå€¼çš„å…¬å¼è§£é‡‡ç”¨ç‰›é¡¿æ³•æ±‚è§£ä¸Šé¢çš„é—®é¢˜ï¼Œä¸è€ƒè™‘ä¸ç­‰å¼çº¦æŸæ¡ä»¶ï¼Œè¿­ä»£å…¬å¼ä¸ºè¿™æ˜¯ç‰›é¡¿æ³•å¯¹ä¸€å…ƒå‡½æ•°çš„æƒ…å†µï¼Œæ¢¯åº¦ä¸ºä¸€é˜¶å¯¼æ•°ï¼Œé»‘å¡çŸ©é˜µä¸ºäºŒé˜¶å¯¼æ•°ï¼Œå­é—®é¢˜ç›®æ ‡å‡½æ•°çš„ä¸€é˜¶å¯¼æ•°å’ŒäºŒé˜¶å¯¼æ•°åˆ†åˆ«ä¸ºä¸ºäº†ä¿è¯ç‰›é¡¿æ³•æ”¶æ•›ï¼Œè¿˜éœ€è¦ä½¿ç”¨ç›´çº¿æœç³»ï¼Œæ£€æŸ¥è¿­ä»£ä¹‹åçš„å‡½æ•°å€¼æ˜¯å¦å……åˆ†ä¸‹é™å‡¸ä¼˜åŒ–é—®é¢˜æ±‚è§£ä¸€èˆ¬çš„æœ€ä¼˜åŒ–é—®é¢˜çš„å…¨å±€æœ€ä¼˜è§£é€šå¸¸æ˜¯å›°éš¾çš„ï¼Œè‡³å°‘ä¼šé¢ä¸´å±€éƒ¨æå€¼ä¸éç‚¹é—®é¢˜ï¼Œå¦‚æœå¯¹ä¼˜åŒ–é—®é¢˜åŠ ä»¥é™å®šï¼Œåˆ™å¯ä»¥æœ‰æ•ˆåœ°é¿å…è¿™äº›é—®é‰ï¼Œä¿è¯æ±‚å¾—å…¨å±€æå€¼ç‚¹å…¸å‹çš„é™å®šé—®é¢˜ä¸ºå‡¸ä¼˜åŒ–(Convex Optimization)é—®é¢˜æ•°å€¼ä¼˜åŒ–é¢ä¸´çš„é—®é¢˜å…¶äºå¯¼æ•°çš„æ•°å€¼ä¼˜åŒ–ç®—æ³•åˆ¤æ–­æ”¶æ•›çš„ä¾æ®æ˜¯æ¢¯åº¦ä¸º$\mathbf{0}$ï¼Œä½†æ¢¯åº¦ä¸º$\mathbf{0}$åªæ˜¯å‡½æ•°å–å¾—å±€éƒ¨æå€¼çš„å¿…è¦æ¡ä»¶è€Œéå……åˆ†æ¡ä»¶ï¼Œæ›´ä¸æ˜¯å–å¾—å…¨å±€æå€¼çš„å……åˆ†æ¡ä»¶ï¼Œå› æ­¤ï¼Œè¿™ç±»ç®—æ³•ä¼šé¢ä¸´å¦‚ä¸‹é—®é¢˜æ— æ³•æ”¶æ•›åˆ°æ¢¯åº¦ä¸º$\mathbf{0}$çš„ç‚¹ï¼Œæ­¤æ—¶ç®—æ³•ä¸æ”¶æ•›èƒ½å¤Ÿæ”¶æ•›åˆ°æ¢¯åº¦ä¸º$\mathbf{0}$çš„ç‚¹ï¼Œä½†åœ¨è¯¥ç‚¹å¤„é»‘å¡çŸ©é˜µä¸æ­£å®šï¼Œå› æ­¤ä¸æ˜¯å±€éƒ¨æå€¼ç‚¹ï¼Œç§°ä¸ºéç‚¹é—®é¢˜èƒ½å¤Ÿæ”¶æ•›åˆ°æ¢¯åº¦ä¸º$0$çš„ç‚¹ï¼Œåœ¨è¯¥ç‚¹å¤„é»‘å¡çŸ©é˜µæ­£å®šï¼Œæ‰¾åˆ°äº†å±€éƒ¨æå€¼ç‚¹ï¼Œä½†ä¸æ˜¯å…¨å±€æå€¼ç‚¹xxxå›¾ 4.17$-x^{2}+y^{2}$çš„å‡»ç‚¹å¯¹äºä¸Šå›¾æ‰€ç¤ºçš„ç›®æ ‡å‡½æ•°ï¼Œå¦‚æœä»¥$(0,4)$ä½œä¸ºåˆå§‹è¿­ä»£ç‚¹ï¼Œè¿­ä»£æ³•æœ€åä¼šé™·äººéç‚¹$(0,0)$ï¼Œåœ¨$(0,0)$ç‚¹å¤„æ¢¯åº¦ä¸º$\mathbf{0}$ï¼Œé»‘å¡çŸ©é˜µä¸ºè¯¥çŸ©é˜µçš„ç‰¹å¾å€¼ä¸º$-2$å’Œ2ï¼Œæ˜¾ç„¶çŸ©é˜µä¸å®šï¼Œç›¸æ¯”éç‚¹ï¼Œåˆ¤å®šä¸€ä¸ªå±€éƒ¨æå°å€¼ç‚¹æ˜¯å¦ä¸ºå…¨å±€æå°å€¼ç‚¹æ›´ä¸ºå›°éš¾ï¼Œå› ä¸ºç›®æ ‡å‡½æ•°å¯èƒ½å­˜åœ¨å¤šä¸ªå±€éƒ¨æå€¼ï¼Œéœ€è¦æ‰¾åˆ°æ‰€æœ‰çš„å±€éƒ¨æå€¼ï¼Œç„¶åè¿›è¡Œæ¯”è¾ƒï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªNPéš¾é—®é¢˜å¯¹äºè®©è¿­ä»£æ³•å¦‚ä½•æ‘†è„±å±€éƒ¨æå°å€¼ä»¥åŠéç‚¹ï¼Œæ¢¯åº¦ä¸‹é™æ³•çš„å„ç§æ”¹è¿›ç‰ˆæœ¬ä»¥åŠéšæœºæ¢¯åº¦ä¸‹é™æ³•ï¼Œå‡æœ‰ä¸€å®šç¨‹åº¦è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜çš„èƒ½åŠ›å‡¸é›†å®šä¹‰å¯¹äº$n$ç»´ç©ºé—´ä¸­çš„ç‚¹é›†$C$ï¼Œå¦‚æœå¯¹è¯¥é›†åˆä¸­çš„ä»»æ„ä¸¤ç‚¹$x$å’Œ$y$ï¼Œä»¥åŠå®æ•°$0 \leqslant \theta \leqslant 1$ï¼Œéƒ½æœ‰åˆ™ç§°è¯¥é›†åˆä¸ºå‡¸é›†ä»ç›´è§‚ä¸Šæ¥çœ‹ï¼Œå‡¸é›†çš„å½¢çŠ¶æ˜¯å‡¸çš„ï¼Œæ²¡æœ‰å‡¹è¿›å»çš„åœ°æ–¹ï¼ŒæŠŠé›†åˆä¸­çš„ä»»æ„ä¸¤ç‚¹ç”¨ç›´çº¿è¿èµ·æ¥ï¼Œç›´çº¿æ®µä¸Šçš„æ‰€æœ‰ç‚¹éƒ½å±äºè¯¥é›†åˆç§°ä¸ºç‚¹$\boldsymbol{x}$å’Œ$y$çš„å‡¸ç»„åˆï¼Œä¸‹å›¾æ˜¯å‡¸é›†å’Œéå‡¸é›†çš„ç¤ºä¾‹ï¼Œå·¦è¾¹ä¸ºå‡¸é›†ï¼Œå³è¾¹ä¸ºéå‡¸é›†xxxå›¾å‡¸é›†å’Œéå‡¸é›†ç¤ºä¾‹ä¸‹é¢åˆ—ä¸¾å®é™…åº”ç”¨ä¸­å¸¸è§çš„å‡¸é›†$n$ç»´å®å‘é‡ç©ºé—´$\mathbb{R}^{n}$æ˜¯å‡¸é›†ï¼Œæ˜¾ç„¶ï¼Œå¦‚æœ$\boldsymbol{x},\boldsymbol{y} \in \mathbb{R}^{n}$ï¼Œåˆ™æœ‰ç»™å®š$m \times n$çŸ©é˜µ$\boldsymbol{A}$å’Œ$m$ç»´å‘é‡$\boldsymbol{b}$ï¼Œä»¿å°„å­ç©ºé—´æ˜¯éé½æ¬¡çº¿æ€§æ–¹ç¨‹ç»„çš„è§£ï¼Œä¹Ÿæ˜¯å‡¸é›†å‡è®¾$x,y \in \mathbb{R}^{n}$å¹¶ä¸”$\boldsymbol{A x}=\boldsymbol{b},\boldsymbol{A y}=\boldsymbol{b}$ï¼Œå¯¹äºä»»æ„$0 \leqslant \theta \leqslant 1$ï¼Œæœ‰å› æ­¤ç»“è®ºæˆç«‹è¿™ä¸€ç»“è®ºæ„å‘³ç€ï¼Œç”±ä¸€ç»„çº¿æ€§ç­‰å¼çº¦æŸæ¡ä»¶å®šä¹‰çš„å¯è¡ŒåŸŸæ˜¯å‡¸é›†å¤šé¢ä½“æ˜¯å¦‚ä¸‹çº¿æ€§ä¸ç­‰å¼ç»„å®šä¹‰çš„å‘é‡é›†åˆå®ƒä¹Ÿæ˜¯å‡¸é›†å¯¹äºä»»æ„$\boldsymbol{x},\boldsymbol{y} \in \mathbb{R}^{n}$å¹¶ä¸”$\boldsymbol{A x} \leqslant \boldsymbol{b},\boldsymbol{A} y \leqslant \boldsymbol{b}ï¼Œ0 \leqslant \theta \leqslant 1$ï¼Œéƒ½æœ‰å› æ­¤ç»“è®ºæˆç«‹æ­¤ç»“è®ºæ„å‘³ç€ç”±çº¿æ€§ä¸ç­‰å¼çº¦æŸæ¡ä»¶å®šä¹‰çš„å¯è¡ŒåŸŸæ˜¯å‡¸é›†å®é™…é—®é¢˜ä¸­ç­‰å¼å’Œä¸ç­‰å¼çº¦æŸé€šå¸¸æ˜¯çº¿æ€§çš„ï¼Œå› æ­¤å®ƒä»¬ç¡®å®šçš„å¯è¡ŒåŸŸæ˜¯å‡¸é›†å¤šä¸ªå‡¸é›†çš„äº¤é›†ä¹Ÿæ˜¯å‡¸é›†å‡è®¾ä¸ºå‡¸é›†ï¼Œå®ƒä»¬çš„äº¤é›†ä¸ºå¯¹äºä»»æ„ç‚¹ï¼Œå¹¶ä¸”ï¼Œç”±äºä¸ºå‡¸é›†ï¼Œå› æ­¤æœ‰ç”±æ­¤å¾—åˆ°è¿™ä¸ªç»“è®ºæ„å‘³ç€å¦‚æœæ¯ä¸ªç­‰å¼æˆ–è€…ä¸ç­‰å¼çº¦æŸæ¡ä»¶å®šä¹‰çš„é›†åˆéƒ½æ˜¯å‡¸é›†ï¼Œé‚£ä¹ˆè¿™äº›æ¡ä»¶è”åˆèµ·æ¥å®šä¹‰çš„é›†åˆè¿˜æ˜¯å‡¸é›†å‡¸é›†çš„å¹¶é›†ä¸æ˜¯å‡¸é›†ï¼Œè¿™æ ·çš„åä¾‹å¾ˆå®¹æ˜“æ„é€ ç»™å®šä¸€ä¸ªå‡¸å‡½æ•°$f(x)$ä»¥åŠå®æ•°$\alpha$ï¼Œæ­¤å‡½æ•°çš„$\alpha$ä¸‹æ°´å¹³é›†(Sub-level Set)å®šä¹‰ä¸ºå‡½æ•°å€¼å°äºæˆ–ç­‰äº$\alpha$çš„ç‚¹æ„æˆçš„é›†åˆå…¶ä¸­$D(f)$ä¸ºå‡½æ•°$f(\boldsymbol{x})$çš„å®šä¹‰åŸŸï¼Œå¯¹äºä¸‹æ°´å¹³é›†ä¸­çš„ä»»æ„ä¸¤ç‚¹$\boldsymbol{x},\boldsymbol{y}$ï¼Œå®ƒä»¬æ»¡è¶³å¯¹äº$0 \leqslant \theta \leqslant 1$ï¼Œæ ¹æ®å‡¸å‡½æ•°çš„å®šä¹‰æœ‰$\theta \boldsymbol{x}+(1-\theta) \boldsymbol{y}$ä¹Ÿå±äºè¯¥ä¸‹æ°´å¹³é›†ï¼Œå› æ­¤ä¸‹æ°´å¹³é›†æ˜¯å‡¸é›†ä¸‹é¢ä¸¾ä¾‹è¯´æ˜ï¼Œå¯¹äºå¦‚ä¸‹å‡¸å‡½æ•°å¦‚æœ$\alpha=1$ï¼Œåˆ™ä¸‹æ°´å¹³é›†$x^{2}+y^{2} \leqslant 1$æ˜¯åœ†å¿ƒä¸ºåŸç‚¹çš„å•ä½åœ†æ‰€å›´æˆçš„åŒºåŸŸï¼Œä¸ºå‡¸é›†ï¼›å¦‚æœ$f(\boldsymbol{x})$ä¸æ˜¯å‡¸å‡½æ•°ï¼Œåˆ™ä¸èƒ½ä¿è¯ä¸‹æ°´å¹³é›†æ˜¯å‡¸é›†å¯¹äºä¸‹é¢çš„å‡¹å‡½æ•°å¦‚æœ$\alpha=1$ï¼Œåˆ™ä¸‹æ°´å¹³é›†$-x^{2}-y^{2} \leqslant 1$ä¸ºäºŒç»´ç©ºé—´é™¤æ‰å•ä½åœ†ä¹‹åçš„åŒºåŸŸï¼Œæ˜¾ç„¶ä¸æ˜¯å‡¸é›†è¿™ä¸€ç»“è®ºçš„ç”¨é€”åœ¨äºæˆ‘ä»¬éœ€è¦ç¡®ä¿ä¼˜åŒ–é—®é¢˜ä¸­ä¸€äº›ä¸ç­‰å¼çº¦æŸæ¡ä»¶å®šä¹‰çš„å¯è¡ŒåŸŸæ˜¯å‡¸é›†å‡¸ä¼˜åŒ–é—®é¢˜åŠå…¶æ€§è´¨å¦‚æœä¸€ä¸ªæœ€ä¼˜åŒ–é—®é¢˜çš„å¯è¡ŒåŸŸæ˜¯å‡¸é›†ä¸”ç›®æ ‡å‡½æ•°æ˜¯å‡¸å‡½æ•°ï¼Œåˆ™è¯¥é—®é¢˜ä¸ºå‡¸ä¼˜åŒ–é—®é¢˜å‡¸ä¼˜åŒ–é—®é¢˜å¯ä»¥å½¢å¼åŒ–åœ°å†™æˆå…¶ä¸­$x$ä¸ºä¼˜åŒ–å˜é‡ï¼›$f$ä¸ºå‡¸ç›®æ ‡å‡½æ•°ï¼›$C$æ˜¯ä¼˜åŒ–å˜é‡çš„å¯è¡ŒåŸŸï¼Œä¸ºå‡¸é›†å‡¸ä¼˜åŒ–é—®é¢˜çš„å¦ä¸€ç§é€šç”¨å†™æ³•æ˜¯å…¶ä¸­æ˜¯ä¸ç­‰å¼çº¦æŸå‡½æ•°ï¼Œä¸ºå‡¸å‡½æ•°ï¼›æ˜¯ç­‰å¼çº¦æŸå‡½æ•°ï¼Œä¸ºä»¿å°„(çº¿æ€§)å‡½æ•°ä¸Šå¼ä¸­ä¸ç­‰å¼çš„æ–¹å‘éå¸¸é‡è¦ï¼Œå› ä¸ºä¸€ä¸ªå‡¸å‡½æ•°çš„0ä¸‹æ°´å¹³é›†æ˜¯å‡¸é›†ï¼Œå¯¹äºå‡¹å‡½æ•°åˆ™ä¸æˆç«‹è¿™äº›ä¸ç­‰å¼å…±åŒå®šä¹‰çš„å¯è¡ŒåŸŸæ˜¯ä¸€ç»„å‡¸é›†çš„äº¤é›†ï¼Œä»ç„¶ä¸ºå‡¸é›†é€šè¿‡å°†å¤§äºæˆ–ç­‰äºå·å½¢å¼çš„ä¸ç­‰å¼ä¸¤è¾¹åŒæ—¶ä¹˜ä»¥$-1$ï¼Œå¯ä»¥æŠŠä¸ç­‰å¼ç»Ÿä¸€å†™æˆå°äºæˆ–ç­‰äºå·çš„å½¢å¼ä»¿å°„ç©ºé—´æ˜¯å‡¸é›†ï¼Œå› æ­¤åŠ ä¸Šè¿™äº›ç­‰å¼çº¦æŸåå¯è¡ŒåŸŸè¿˜æ˜¯å‡¸é›†éœ€è¦å¼ºè°ƒçš„æ˜¯ï¼Œå¦‚æœç­‰å¼çº¦æŸä¸æ˜¯ä»¿å°„å‡½æ•°ï¼Œé‚£ä¹ˆé€šå¸¸æ— æ³•ä¿è¯å…¶å®šä¹‰çš„å¯è¡ŒåŸŸæ˜¯å‡¸é›†ä¾‹å¦‚ç­‰å¼çº¦æŸ$x^{2}+y^{2}+z^{2}=1$ç¡®å®šçš„å¯è¡ŒåŸŸæ˜¯ä¸‰ç»´ç©ºé—´çš„çƒé¢ï¼Œæ˜¾ç„¶ä¸æ˜¯å‡¸é›†å‡¸é›†è¯æ˜ä¸Šé¢çš„å®šä¹‰ä¹Ÿç»™å‡ºäº†è¯æ˜ä¸€ä¸ªä¼˜åŒ–é—®é¢˜æ˜¯å‡¸ä¼˜åŒ–é—®é¢˜çš„ä¸€èˆ¬æ€§æ–¹æ³•ï¼Œå³è¯æ˜ç›®æ ‡å‡½æ•°æ˜¯å‡¸å‡½æ•°ï¼Œç­‰å¼å’Œä¸ç­‰å¼çº¦æŸæ„æˆçš„å¯è¡ŒåŸŸæ˜¯å‡¸é›†å¯¹äºå‡¸ä¼˜åŒ–é—®é¢˜ï¼Œæ‰€æœ‰å±€éƒ¨æœ€ä¼˜è§£éƒ½æ˜¯å…¨å±€æœ€ä¼˜è§£è¿™ä¸ªç‰¹æ€§å¯ä»¥ä¿è¯åœ¨æ±‚è§£æ—¶ä¸ä¼šé™·å…¥å±€éƒ¨æå€¼é—®é¢˜ï¼Œå¦‚æœæ‰¾åˆ°äº†é—®é¢˜çš„ä¸€ä¸ªå±€éƒ¨æœ€ä¼˜è§£ï¼Œåˆ™å®ƒä¸€å®šä¹Ÿæ˜¯å…¨å±€æœ€ä¼˜è§£ï¼Œè¿™æå¤§åœ°ç®€åŒ–äº†é—®é¢˜çš„æ±‚è§£ä¸‹é¢é‡‡ç”¨åè¯æ³•è¯æ˜æ­¤ç»“è®ºå‡è®¾$\boldsymbol{x}$æ˜¯ä¸€ä¸ªå±€éƒ¨æœ€ä¼˜è§£ä½†ä¸æ˜¯å…¨å±€æœ€ä¼˜è§£ï¼Œåˆ™å­˜åœ¨ä¸€ä¸ªå¯è¡Œè§£$\boldsymbol{y}$ï¼Œæ»¡è¶³æ ¹æ®å±€éƒ¨æœ€ä¼˜è§£çš„å®šä¹‰ï¼Œå¯¹äºç»™å®šçš„é‚»åŸŸåŠå¾„$\delta$ï¼Œä¸å­˜åœ¨æ»¡è¶³$|\boldsymbol{x}-\boldsymbol{z}|_{2}&lt;\delta$å¹¶ä¸”$f(\boldsymbol{z})&lt;f(\boldsymbol{x})$çš„ ç‚¹$z$ï¼Œé€‰æ‹©ä¸€ä¸ªç‚¹å…¶ä¸­åˆ™æœ‰å³è¯¥ç‚¹åœ¨$\boldsymbol{x}$çš„$\delta$é‚»åŸŸå†…ï¼Œæ ¹æ®å‡¸å‡½æ•°çš„æ€§è´¨ä»¥åŠå‰é¢çš„å‡è®¾æœ‰è¿™ä¸$x$æ˜¯å±€éƒ¨æœ€ä¼˜è§£çŸ›ç›¾å¦‚æœä¸€ä¸ªå±€éƒ¨æœ€ä¼˜è§£ä¸æ˜¯å…¨å±€æœ€ä¼˜è§£ï¼Œåœ¨å®ƒçš„ä»»ä½•é‚»åŸŸå†…è¿˜å¯ä»¥æ‰¾åˆ°å‡½æ•°å€¼æ¯”è¯¥ç‚¹å‡½æ•°å€¼æ›´å°çš„ç‚¹ï¼Œè¿™ä¸è¯¥ç‚¹æ˜¯å±€éƒ¨æœ€ä¼˜è§£çŸ›ç›¾ä¹‹æ‰€ä»¥å‡¸ä¼˜åŒ–é—®é¢˜çš„å®šä¹‰è¦æ±‚ç›®æ ‡å‡½æ•°æ˜¯å‡¸å‡½æ•°ï¼Œå¹¶ä¸”ä¼˜åŒ–å˜é‡çš„å¯è¡ŒåŸŸæ˜¯å‡¸é›†ï¼Œæ˜¯å› ä¸ºç¼ºå°‘å…¶ä¸­ä»»ä½•ä¸€ä¸ªæ¡ä»¶éƒ½ä¸èƒ½ä¿è¯å±€éƒ¨æœ€ä¼˜è§£æ˜¯å…¨å±€æœ€ä¼˜è§£ï¼Œä¸‹é¢æ¥çœ‹ä¸¤ä¸ªåä¾‹å¯è¡ŒåŸŸæ˜¯å‡¸é›†ï¼Œç›®æ ‡å‡½æ•°ä¸æ˜¯å‡¸å‡½æ•°ï¼Œå¦‚ä¸‹æ–¹å·¦å›¾æ‰€ç¤ºï¼Œæ˜¾ç„¶ï¼Œæ­¤éå‡¸å‡½ æ•°å­˜åœ¨å¤šä¸ªå±€éƒ¨æå°å€¼ç‚¹ï¼Œä½†åªæœ‰ä¸€ä¸ªæ˜¯å…¨å±€æå°å€¼ç‚¹å¯è¡ŒåŸŸä¸æ˜¯å‡¸é›†ï¼Œç›®æ ‡å‡½æ•°æ˜¯å‡¸å‡½æ•°ï¼Œå¦‚ä¸‹æ–¹å³å›¾æ‰€ç¤ºï¼Œå¯è¡ŒåŸŸä¸æ˜¯å‡¸é›†ï¼Œä¸­é—´æœ‰æ–­è£‚ï¼Œç›®æ ‡å‡½æ•°æ˜¯å‡¸å‡½æ•°å·¦è¾¹å’Œå³è¾¹çš„æ›²çº¿å„æœ‰ä¸€ä¸ª å±€éƒ¨æå°å€¼ç‚¹ï¼Œåˆ†åˆ«ä¸º$x=-1$ä»¥åŠ$x=1$ï¼Œä¸èƒ½ä¿è¯å±€éƒ¨æå°å€¼å°±æ˜¯å…¨å±€æå°å€¼xxxå›¾å¯è¡ŒåŸŸæ˜¯å‡¸é›†ï¼Œç›®æ ‡å‡½æ•°ä¸æ˜¯å‡¸å‡½æ•°+å¯è¡ŒåŸŸä¸æ˜¯å‡¸é›†ï¼Œç›®æ ‡å‡½æ•°æ˜¯å‡¸å‡½æ•°å¯ä»¥å¾ˆå®¹æ˜“æŠŠè¿™ä¸ªä¾‹å­æ¨å¹¿åˆ°ä¸‰ç»´ç©ºé—´é‡Œçš„äºŒå…ƒå‡½æ•°(æ›²é¢)ç”±äºå‡¸å‡½æ•°çš„é»‘å¡çŸ©é˜µæ˜¯åŠæ­£å®šçš„ï¼Œä¸å­˜åœ¨éç‚¹ï¼Œå› æ­¤å‡¸ä¼˜åŒ–é—®é¢˜ä¹Ÿä¸ä¼šå‡ºç°éç‚¹é—®é¢˜å¸¦çº¦æŸçš„ä¼˜åŒ–é—®é¢˜æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•å®šä¹‰æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•(Lagrange Multiplier Method)ç”¨äºæ±‚è§£å¸¦ç­‰å¼çº¦æŸæ¡ä»¶çš„å‡½æ•°æå€¼ï¼Œç»™å‡ºäº†æ­¤ç±»é—®é¢˜å–å¾—æå€¼çš„ä¸€é˜¶å¿…è¦æ¡ä»¶(First-order Necessary Conditions)ï¼Œå‡è®¾æœ‰å¦‚ä¸‹æå€¼é—®é¢˜æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•æ„é€ å¦‚ä¸‹æ‹‰æ ¼æœ—æ—¥ä¹˜å­å‡½æ•°å…¶ä¸­$\boldsymbol{\lambda}$ä¸ºæ–°å¼•å…¥çš„è‡ªå˜é‡ï¼Œç§°ä¸ºæ‹‰æ ¼æœ—æ—¥ä¹˜å­(Lagrange Multipliers)åœ¨æ„é€ è¯¥å‡½æ•°ä¹‹åï¼Œå»æ‰äº†å¯¹ä¼˜åŒ–å˜é‡çš„ç­‰å¼çº¦æŸå¯¹æ‹‰æ ¼æœ—æ—¥ä¹˜å­å‡½æ•°çš„æ‰€æœ‰è‡ªå˜é‡æ±‚åå¯¼æ•°ï¼Œå¹¶ä»¤å…¶ä¸º0ï¼Œè¿™åŒ…æ‹¬å¯¹$x$æ±‚å¯¼ã€å¯¹$\boldsymbol{\lambda}$æ±‚å¯¼ï¼Œå¾—åˆ°ä¸‹åˆ—æ–¹ç¨‹ç»„æ±‚è§£è¯¥æ–¹ç¨‹ç»„å³å¯å¾—åˆ°å‡½æ•°çš„å€™é€‰æå€¼ç‚¹ï¼Œæ˜¾ç„¶ï¼Œæ–¹ç¨‹ç»„çš„è§£æ»¡è¶³æ‰€æœ‰çš„ç­‰å¼çº¦æŸæ¡ä»¶å‡ ä½•è§£é‡Šåœ¨æå€¼ç‚¹å¤„ç›®æ ‡å‡½æ•°çš„æ¢¯åº¦æ˜¯çº¦æŸå‡½æ•°æ¢¯åº¦çš„çº¿æ€§ç»„åˆä¸‹é¢ç”¨ä¸€ä¸ªå®é™…ä¾‹å­æ¥è¯´æ˜æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•çš„ä½¿ç”¨ï¼Œæ±‚è§£å¦‚ä¸‹æå€¼é—®é¢˜é¦–å…ˆæ„é€ æ‹‰æ ¼æœ—æ—¥ä¹˜å­å‡½æ•°å¯¹ä¼˜åŒ–å˜é‡ã€ä¹˜å­å˜é‡æ±‚åå¯¼æ•°ï¼Œå¹¶ä»¤å…¶ä¸º0ï¼Œå¾—åˆ°ä¸‹é¢çš„æ–¹ç¨‹ç»„æœ€åè§£å¾—ç›®æ ‡å‡½æ•°çš„é»‘å¡çŸ©é˜µä¸ºé»‘å¡çŸ©é˜µæ­£å®šï¼Œå› æ­¤è¯¥æå€¼ç‚¹æ˜¯æå°å€¼ç‚¹å¦‚æœä¸‰è§’å½¢çš„å‘¨é•¿ç¡®å®šï¼Œä¸ºå¸¸æ•°$2 C$ï¼Œè¯æ˜å½“ä¸‰è§’å½¢ä¸ºç­‰è¾¹ä¸‰è§’å½¢çš„æ—¶å€™é¢ç§¯æœ€å¤§å‡è®¾ä¸‰è§’å½¢ä¸‰ä¸ªè¾¹é•¿åº¦ä¸º$x ã€ y ã€ z$ï¼Œæ˜¾ç„¶æœ‰æ ¹æ®æµ·ä¼¦å…¬å¼ï¼Œä¸‰è§’å½¢çš„é¢ç§¯ä¸ºæ„é€ æ‹‰æ ¼æœ—æ—¥ä¹˜å­å‡½æ•°å¯¹ä¼˜åŒ–å˜é‡ä»¥åŠä¹˜å­å˜é‡æ±‚åå¯¼æ•°ï¼Œå¹¶ä»¤å®ƒä»¬ä¸º0ï¼Œå¾—åˆ°ä¸‹é¢çš„æ–¹ç¨‹ç»„è§£æ­¤æ–¹ç¨‹ç»„å¯ä»¥å¾—åˆ°è¿™å°±è¯æ˜äº†é¢ç§¯æœ€å¤§æ—¶ä¸‰è§’å½¢æ˜¯ç­‰è¾¹ä¸‰è§’å½¢åº”ç”¨ä¸€çº¿æ€§åˆ¤åˆ«åˆ†æä¸‹é¢ä»‹ç»æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•åœ¨çº¿æ€§åˆ¤åˆ«åˆ†æä¸­çš„åº”ç”¨ï¼Œçº¿æ€§åˆ¤åˆ«åˆ†æçš„ç›®æ ‡æ˜¯å°†å‘é‡æŠ•å½±åˆ°ä½ç»´ç©ºé—´ï¼Œä½¿å¾—åŒä¸€ç±»æ ·æœ¬ä¹‹é—´çš„è·ç¦»å°½å¯èƒ½è¿‘ï¼Œä¸åŒç±»æ ·æœ¬ä¹‹é—´çš„è·ç¦»å°½å¯èƒ½è¿œç±»å†…è·ç¦»ç”±ç±»å†…æ•£å¸ƒçŸ©é˜µæè¿°ï¼Œç±»é—´è·ç¦»ç”±ç±»é—´æ•£å¸ƒçŸ©é˜µæè¿°å‡è®¾ä¸ºæ€»ç±»é—´æ•£å¸ƒçŸ©é˜µï¼Œä¸ºæ€»ç±»å†…æ•£å¸ƒçŸ©é˜µï¼Œç®—æ³•è¦ä¼˜åŒ–çš„ç›®æ ‡å‡½æ•°ä¸ºä¸‹é¢çš„å¹¿ä¹‰ç‘åˆ©å•†ä¸Šå¼çš„åˆ†æ¯ä¸ºç±»å†…å·®å¼‚ï¼Œåˆ†å­ä¸ºç±»é—´å·®å¼‚ï¼Œ$w$ä¸ºæŠ•å½±æ–¹å‘å‘é‡è¿™ä¸ªæœ€ä¼˜åŒ–é—®é¢˜çš„è§£ä¸å”¯ä¸€ï¼Œå¯ä»¥è¯æ˜å¦‚æœæ˜¯æœ€ä¼˜è§£ï¼Œå°†å®ƒä¹˜ä¸Šä¸€ä¸ªéé›¶ç³»æ•°ä¹‹åï¼Œè¿˜æ˜¯æœ€ä¼˜è§£å› æ­¤å¯ä»¥åŠ ä¸Šä¸€ä¸ªçº¦æŸæ¡ä»¶æ¶ˆæ‰å†—ä½™ï¼ŒåŒæ—¶ç®€åŒ–é—®é¢˜è¿™æ ·ä¸Šé¢çš„æœ€ä¼˜åŒ–é—®é¢˜è½¬åŒ–ä¸ºå¸¦ç­‰å¼çº¦æŸçš„æå¤§å€¼é—®é¢˜ä¸‹é¢ç”¨æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•æ±‚è§£ï¼Œæ„é€ æ‹‰æ ¼æœ—æ—¥ä¹˜å­å‡½æ•°å¯¹$\boldsymbol{w}$æ±‚æ¢¯åº¦å¹¶ä»¤æ¢¯åº¦ä¸º$\mathbf{0}$ï¼Œå¯ä»¥å¾—åˆ°å³æœ‰å¦‚æœå¯é€†ï¼Œä¸Šå¼ä¸¤è¾¹å·¦ä¹˜åå¯ä»¥å¾—åˆ°å³æ˜¯çŸ©é˜µçš„ç‰¹å¾å€¼ï¼Œä¸ºå¯¹åº”çš„ç‰¹å¾å‘é‡ï¼Œå‡è®¾å’Œæ˜¯ä¸Šé¢å¹¿ä¹‰ç‰¹å¾å€¼é—®é¢˜çš„è§£ï¼Œ ä»£å…¥ç›®æ ‡å‡½æ•°å¯ä»¥å¾—åˆ°è¿™é‡Œçš„ç›®æ ‡æ˜¯è¦è®©è¯¥æ¯”å€¼æœ€å¤§åŒ–ï¼Œå› æ­¤æœ€å¤§çš„ç‰¹å¾å€¼$\lambda$åŠå…¶å¯¹åº”çš„ç‰¹å¾å‘é‡æ˜¯æœ€ä¼˜è§£æ‹‰æ ¼æœ—æ—¥å¯¹å¶å¯¹å¶æ˜¯æ±‚è§£æœ€ä¼˜åŒ–é—®é¢˜çš„ä¸€ç§æ‰‹æ®µï¼Œå®ƒå°†ä¸€ä¸ªæœ€ä¼˜åŒ–é—®é¢˜è½¬åŒ–ä¸ºå¦å¤–ä¸€ä¸ªæ›´å®¹æ˜“æ±‚è§£çš„é—®é¢˜ï¼Œè¿™ä¸¤ä¸ªé—®é¢˜æ˜¯ç­‰ä»·çš„å…ˆä»‹ç»æ‹‰æ ¼æœ—æ—¥å¯¹å¶ï¼Œå¯¹äºå¦‚ä¸‹å¸¦ç­‰å¼çº¦æŸå’Œä¸ç­‰å¼çº¦æŸçš„ä¼˜åŒ–é—®é¢˜ä»¿ç…§æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•æ„é€ å¹¿ä¹‰æ‹‰æ ¼æœ—æ—¥ä¹˜å­å‡½æ•°ç§°å’Œä¸ºæ‹‰æ ¼æœ—æ—¥ä¹˜å­ï¼Œå¿…é¡»æ»¡è¶³çš„çº¦æŸï¼Œç¨åä¼šè§£é‡ŠåŸå› æ¥ä¸‹æ¥å°†ä¸Šé¢çš„é—®é¢˜è½¬åŒ–ä¸ºå¦‚ä¸‹æ‰€è°“çš„åŸé—®é¢˜ï¼Œå…¶æœ€ä¼˜è§£ä¸º$p^{*}$ä¸Šå¼ç¬¬ä¸€ä¸ªç­‰å·å³è¾¹çš„å«ä¹‰æ˜¯å…ˆå›ºå®šå˜é‡$x$ï¼Œå°†å…¶çœ‹æˆå¸¸æ•°ï¼Œè®©æ‹‰æ ¼æœ—æ—¥å‡½æ•°å¯¹ä¹˜å­å˜é‡$\lambda$å’Œ$\nu$æ±‚æå¤§å€¼ï¼›æ¶ˆæ‰å˜é‡$\lambda$å’Œ$\nu$ä¹‹åï¼Œå†å¯¹å˜é‡$x$æ±‚æå°å€¼ï¼Œä¸ºäº†ç®€åŒ–è¡¨è¿°ï¼Œå®šä¹‰å¦‚ä¸‹æå¤§å€¼é—®é¢˜è¿™æ˜¯ä¸€ä¸ªå¯¹å˜é‡$\lambda$å’Œ$\nu$æ±‚å‡½æ•°$L$çš„æå¤§å€¼çš„é—®é¢˜ï¼Œå°†$x$çœ‹æˆå¸¸æ•°è¿™æ ·ï¼ŒåŸå§‹é—®é¢˜è¢«è½¬åŒ–ä¸ºå…ˆå¯¹å˜é‡$\lambda$å’Œ$\nu$æ±‚æå¤§å€¼ï¼Œå†å¯¹$x$æ±‚æå°å€¼è¿™ä¸ªåŸé—®é¢˜å’Œæˆ‘ä»¬è¦æ±‚è§£çš„åŸå§‹é—®é¢˜æœ‰åŒæ ·çš„è§£ï¼Œä¸‹é¢ç»™å‡ºè¯æ˜ï¼Œå¯¹äºä»»æ„çš„$x$ï¼Œåˆ†ä¸¤ç§æƒ…å†µè¿›è¡Œè®¨è®º1ï¸âƒ£å¦‚æœ$\boldsymbol{x}$æ˜¯ä¸å¯è¡Œè§£ï¼Œå¯¹äºæŸäº›$i$æœ‰$g_{i}(\boldsymbol{x})&gt;0$ï¼Œå³$\boldsymbol{x}$è¿åäº†ä¸ç­‰å¼çº¦æŸæ¡ä»¶æˆ‘ä»¬è®©æ‹‰æ ¼æœ—æ—¥ä¹˜å­ï¼Œæœ€ç»ˆä½¿å¾—ç›®æ ‡å‡½æ•°å€¼å¦‚æœå¯¹äºæŸäº›$i$æœ‰$h_{i}(\boldsymbol{x}) \neq 0$ï¼Œè¿åäº†ç­‰å¼çº¦æŸï¼Œæˆ‘ä»¬å¯ä»¥è®©ä»è€Œä½¿å¾—å³å¯¹äºä»»æ„ä¸æ»¡è¶³ç­‰å¼æˆ–ä¸ç­‰å¼çº¦æŸæ¡ä»¶çš„$\boldsymbol{x}ï¼Œ\theta_{P}(\boldsymbol{x})$çš„å€¼æ˜¯$+\infty$2ï¸âƒ£å¦‚æœæ˜¯å¯è¡Œè§£ï¼Œè¿™æ—¶ï¼Œå› ä¸ºæœ‰ï¼Œå¹¶ä¸”è€Œæˆ‘ä»¬è¦æ±‚ï¼Œå› æ­¤çš„æå¤§å€¼å°±æ˜¯ä¸ºäº†è¾¾åˆ°è¿™ä¸ªæå¤§å€¼ï¼Œæˆ‘ä»¬è®©å’Œä¸º0ï¼Œå‡½æ•°çš„æå¤§å€¼å°±æ˜¯ç»¼åˆä»¥ä¸Šä¸¤ç§æƒ…å†µï¼Œé—®é¢˜$\theta_{P}(\boldsymbol{x})$å’Œæˆ‘ä»¬è¦ä¼˜åŒ–çš„åŸå§‹é—®é¢˜çš„å…³ç³»å¯ä»¥è¡¨è¿°ä¸ºå³$\theta_{P}(\boldsymbol{x})$æ˜¯åŸå§‹ä¼˜åŒ–é—®é¢˜çš„æ— çº¦æŸç‰ˆæœ¬å¯¹ä»»ä½•ä¸å¯è¡Œçš„$\boldsymbol{x}$ï¼Œæœ‰$\theta_{P}(\boldsymbol{x})=+\infty$ï¼Œä»è€Œä½¿å¾—åŸå§‹é—®é¢˜çš„ç›®æ ‡å‡½æ•°å€¼è¶‹å‘äºæ— ç©·å¤§ï¼Œæ’é™¤æ‰$\boldsymbol{x}$çš„ä¸å¯è¡ŒåŒºåŸŸï¼Œæœ€ååªå‰©ä¸‹å¯è¡Œçš„$\boldsymbol{x}$ç»„æˆçš„åŒºåŸŸè¿™æ ·æˆ‘ä»¬è¦æ±‚è§£çš„å¸¦çº¦æŸä¼˜åŒ–é—®é¢˜è¢«è½¬åŒ–æˆäº†å¯¹$x$ä¸å¸¦çº¦æŸçš„ä¼˜åŒ–é—®é¢˜ï¼Œå¹¶ä¸”äºŒè€…ç­‰ä»·æ¥ä¸‹æ¥å®šä¹‰å¯¹å¶é—®é¢˜ä¸å…¶æœ€ä¼˜è§£$d^{*}$å…¶ä¸­ä¸ä¸Šé¢çš„å®šä¹‰ç›¸åï¼Œè¿™é‡Œæ˜¯å…ˆå›ºå®šæ‹‰æ ¼æœ—æ—¥ä¹˜å­$\lambda$å’Œ$\nu$ï¼Œè°ƒæ•´$x$è®©æ‹‰æ ¼æœ—æ—¥å‡½æ•°å¯¹$x$æ±‚æå°å€¼ï¼›ç„¶åè°ƒæ•´$\lambda$å’Œ$\nu$å¯¹å‡½æ•°æ±‚æå¤§å€¼åŸé—®é¢˜å’Œå¯¹å¶é—®é¢˜åªæ˜¯æ”¹å˜äº†æ±‚æå¤§å€¼å’Œæå°å€¼çš„é¡ºåºï¼Œæ¯æ¬¡æ“æ§çš„å˜é‡æ˜¯ä¸€æ ·çš„å¼±å¯¹å¶å®šç†å¦‚æœåŸé—®é¢˜å’Œå¯¹å¶é—®é¢˜éƒ½å­˜åœ¨æœ€ä¼˜è§£ï¼Œåˆ™å¯¹å¶é—®é¢˜çš„æœ€ä¼˜å€¼ä¸å¤§äºåŸé—®é¢˜çš„æœ€ä¼˜å€¼ï¼Œå³è¿™ä¸€ç»“è®ºç§°ä¸ºå¼±å¯¹å¶å®šç†(Weak Duality )ä¸‹é¢ç»™å‡ºè¯æ˜ï¼Œå‡è®¾åŸé—®é¢˜çš„æœ€ä¼˜è§£ä¸ºï¼Œå¯¹å¶é—®é¢˜çš„æœ€ä¼˜è§£ä¸ºï¼Œç”±äºåŸé—®é¢˜æ˜¯å…ˆå¯¹å–æå¤§å€¼ï¼Œå¯¹å¶é—®é¢˜æ˜¯å…ˆå¯¹å–æå°å€¼ï¼Œå› æ­¤æœ‰ä»è€Œå¾—åˆ°é¦–å…ˆç”¨çŸ©é˜µå¼±å¯¹å¶çš„ä¾‹å­è§£é‡Šå…¶ç›´è§‚å«ä¹‰å‡è®¾è¡Œæ–¹å‘(æ°´å¹³æ–¹å‘)ä¸º$x$æ–¹å‘ï¼Œåˆ—æ–¹å‘(å‚ç›´æ–¹å‘)ä¸º$\lambda$æ–¹å‘ğŸŒ¾åŸé—®é¢˜é¦–å…ˆå›ºå®š$x$ï¼Œå˜åŠ¨$\lambda$æ±‚æå¤§å€¼ï¼Œå³å–æ¯ä¸€åˆ—çš„æå¤§å€¼ï¼Œå¾—åˆ°ç„¶åå˜åŠ¨$x$ï¼Œæ±‚ä¸Šé¢è¿™ä¸ªè¡Œçš„æå°å€¼ï¼Œç»“æœä¸º3ğŸ’å¯¹å¶é—®é¢˜é¦–å…ˆå›ºå®š$\lambda$ï¼Œå˜åŠ¨$x$ï¼Œæ±‚æå°å€¼ï¼Œå³å…ˆ æ±‚æ¯ä¸€è¡Œçš„æå°å€¼ï¼Œå¾—åˆ°ç„¶åæ±‚è¿™ä¸ªåˆ—çš„æå¤§å€¼ï¼Œç»“æœä¸º1å¯ä»¥çœ‹åˆ°åŸé—®é¢˜çš„æœ€ä¼˜è§£æ¯”å¯¹å¶é—®é¢˜çš„æœ€ä¼˜è§£è¦å¤§å¼±å¯¹å¶çš„åŸç†å¦‚ä¸‹å›¾æ‰€ç¤ºxxxå›¾å¼±å¯¹å¶è¯æ˜è¿‡ç¨‹å›¾ä¸­æ¨ªè½´æ–¹å‘ä¸ºä¼˜åŒ–å˜é‡$\boldsymbol{x}$ï¼Œçºµè½´ä¸ºä¹˜å­å˜é‡$\boldsymbol{\lambda}$å’Œ$\boldsymbol{\nu}$ï¼Œä¸ºäº†ç›´è§‚ï¼Œå°†è¿™äº›å˜é‡éƒ½æ˜¾ç¤ºä¸ºä¸€ç»´çš„æƒ…å†µå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¼±å¯¹å¶å®šç†å¯¹äºæ‰€æœ‰æœ€ä¼˜åŒ–é—®é¢˜éƒ½æ˜¯æˆç«‹çš„å¯¹å¶é—´éš™åŸé—®é¢˜æœ€ä¼˜å€¼å’Œå¯¹å¶é—®é¢˜æœ€ä¼˜å€¼çš„å·®ç§°ä¸ºå¯¹å¶é—´éš™å¦‚æœåŸé—®é¢˜å’Œå¯¹å¶é—®é¢˜æœ‰ç›¸åŒçš„æœ€ä¼˜è§£ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æŠŠæ±‚è§£åŸé—®é¢˜è½¬åŒ–ä¸ºæ±‚è§£å¯¹å¶é—®é¢˜ï¼Œæ­¤æ—¶å¯¹å¶é—´éš™ä¸º0ï¼Œè¿™ç§æƒ…å†µç§°ä¸ºå¼ºå¯¹å¶å¼ºå¯¹å¶æˆç«‹çš„ä¸€ç§å……åˆ†æ¡ä»¶å°±æ˜¯ä¸‹é¢è¦è®²è¿°çš„Slateræ¡ä»¶Slateræ¡ä»¶æŒ‡å‡ºï¼Œä¸€ä¸ªå‡¸ä¼˜åŒ–é—®é¢˜å¦‚æœå­˜åœ¨ä¸€ä¸ªå€™é€‰$x$ä½¿å¾—æ‰€æœ‰ä¸ç­‰å¼çº¦æŸéƒ½æ˜¯ä¸¥æ ¼æ»¡è¶³çš„ï¼Œå³å¯¹äºæ‰€æœ‰çš„$i$éƒ½æœ‰$g_{i}(\boldsymbol{x})&lt;0$ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ä¸ç­‰å¼çº¦æŸåŒºåŸŸçš„å†…éƒ¨è‡³å°‘æœ‰ä¸€ä¸ªå¯è¡Œç‚¹(éè¾¹ç•Œç‚¹)ï¼Œåˆ™å­˜åœ¨ä½¿å¾—å®ƒä»¬åŒæ—¶ä¸ºåŸé—®é¢˜å’Œå¯¹å¶é—®é¢˜çš„æœ€ä¼˜è§£Slateræ¡ä»¶æ˜¯å¼ºå¯¹å¶æˆç«‹çš„å……åˆ†æ¡ä»¶è€Œä¸æ˜¯å¿…è¦æ¡ä»¶å¼ºå¯¹å¶çš„æ„ä¹‰åœ¨äºæˆ‘ä»¬å¯ä»¥å°†æ±‚è§£åŸæˆå¯¹å¶é—®é¢˜ï¼Œè€Œè¿™ä¸ªå¯¹å¶é—®é¢˜æ€ä¹ˆæ±‚è§£åˆ™æ˜¯å¦å¤–ä¸€ä¸ªé—®é¢˜ä¸‹é¢ä¸¾ä¾‹è¯´æ˜å¦‚ä½•å°†ä¸€ä¸ªä¼˜åŒ–é—®é¡Œè½¬åŒ–ä¸ºæ‹‰æ ¼æœ—æ—¥å¯¹å¶é—®é¢˜ï¼Œå¯¹äºå¦‚ä¸‹çš„æœ€ä¼˜åŒ–é—®é¢˜æ˜¾ç„¶ç›®æ ‡å‡½æ•°æ˜¯å‡¸å‡½æ•°ï¼Œå¯è¡ŒåŸŸæ˜¯çº¿æ€§ä¸ç­‰å¼å›´æˆçš„åŒºåŸŸï¼Œæ˜¯å‡¸é›†ï¼Œå› æ­¤è¿™æ˜¯ä¸€ä¸ªå‡¸ä¼˜åŒ–é—®é¢˜ä¸‹é¢çš„ä¸€ç»„è§£å³å¯ä½¿å¾—ä¸ç­‰å¼çº¦æŸä¸¥æ ¼æ»¡è¶³æ˜¾ç„¶å› æ­¤Slateræ¡ä»¶æˆç«‹å°†ä¸ç­‰å¼çº¦æŸå†™æˆæ ‡å‡†å½¢å¼æ„é€ å¹¿ä¹‰æ‹‰æ ¼æœ—æ—¥ä¹˜å­å‡½æ•°åŸé—®é¢˜ä¸ºå¯¹å¶é—®é¢˜ä¸ºä¸‹é¢æ±‚è§£å¯¹å¶é—®é¢˜ï¼Œå¯¹$x_{i}$æ±‚åå¯¼æ•°å¹¶ä»¤å…¶ä¸º0ï¼Œå¯ä»¥å¾—åˆ°è§£å¾—ç„¶åå°†å…¶ä»£å…¥æ‹‰æ ¼æœ—æ—¥ä¹˜å­å‡½æ•°ï¼Œæ¶ˆæ‰è¿™äº›å˜é‡åŸå§‹é—®é¢˜çš„æ‹‰æ ¼æœ—æ—¥å¯¹å¶é—®é¢˜ä¸ºè¿™é‡Œçš„ç­‰å¼çº¦æŸæ˜¯åœ¨æ¶ˆæ‰åŸå§‹ä¼˜åŒ–å˜é‡çš„è¿‡ç¨‹ä¸­å¼•å…¥çš„KKTæ¡ä»¶KKT(Karush-Kuhn-Tucker)æ¡ä»¶ç”¨äºæ±‚è§£å¸¦æœ‰ç­‰å¼å’Œä¸ç­‰å¼çº¦æŸçš„ä¼˜åŒ–é—®é¢˜ï¼Œæ˜¯æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•çš„æ¨å¹¿KKTæ¡ä»¶ç»™å‡ºäº†è¿™ç±»é—®é¢˜å–å¾—æå€¼çš„ä¸€é˜¶å¿…è¦æ¡ä»¶ï¼Œå¯¹äºå¦‚ä¸‹å¸¦æœ‰ç­‰å¼å’Œä¸ç­‰å¼çº¦æŸçš„ä¼˜åŒ–é—®é¢˜ä¸æ‹‰æ ¼æœ—æ—¥å¯¹å¶çš„åšæ³•ç±»ä¼¼ï¼Œä¸ºå…¶æ„é€ æ‹‰æ ¼æœ—æ—¥ä¹˜å­å‡½æ•°æ¶ˆæ‰ç­‰å¼å’Œä¸ç­‰å¼çº¦æŸ$\lambda$å’Œ$\mu$ç§°ä¸º KKT ä¹˜å­ï¼Œå…¶ä¸­$\mu_{i} \geqslant 0,i=1,\cdots,q$åŸå§‹ä¼˜åŒ–é—®é¢˜çš„æœ€ä¼˜è§£åœ¨æ‹‰æ ¼æœ—æ—¥ä¹˜å­å‡½æ•°çš„éç‚¹å¤„å–å¾—ï¼Œå¯¹äº$x$å–æå°å€¼ï¼Œå¯¹äºKKTä¹˜å­å˜é‡å–æå¤§å€¼æœ€ä¼˜è§£$x$æ»¡è¶³å¦‚ä¸‹æ¡ä»¶ç­‰å¼çº¦æŸå’Œä¸ç­‰å¼çº¦æŸæ˜¯æœ¬èº«åº”è¯¥æ»¡è¶³çš„çº¦æŸï¼Œå’Œæ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•ç›¸åŒåªå¤šäº†å…³äºä»¥åŠå…¶å¯¹åº”çš„ä¹˜å­å˜é‡çš„æ–¹ç¨‹è¿™å¯ä»¥åˆ†ä¸¤ç§æƒ…å†µè®¨è®ºæƒ…å†µä¸€ï¼šå¦‚æœå¯¹äºæŸä¸ª$k$æœ‰è¦æ»¡è¶³çš„æ¡ä»¶ï¼Œåˆ™æœ‰ï¼Œå› æ­¤æœ‰è¿™æ„å‘³ç€ç¬¬$k$ä¸ªä¸ç­‰å¼çº¦æŸä¸èµ·ä½œç”¨ï¼Œæ­¤æ—¶æå€¼åœ¨ä¸ç­‰å¼çº¦æŸå›´æˆçš„åŒºåŸŸå†…éƒ¨å–å¾—ã€‚è¿™ç§æƒ…å…„å¦‚ä¸‹å·¦å›¾æ‰€ç¤ºxxxå›¾KKT æ¡ä»¶ä¸­ä¸ç­‰å¼çº¦æŸçš„ä¹˜å­å˜é‡å„ç§å–å€¼æƒ…å†µæƒ…å†µäºŒï¼šå¦‚æœå¯¹äºæŸä¸ª$k$æœ‰åˆ™$\mu_{k}$çš„å–å€¼è‡ªç”±ï¼Œåªè¦æ»¡è¶³å¤§äºæˆ–ç­‰äº0å³å¯ï¼Œæ­¤æ—¶æå€¼åœ¨ä¸ç­‰å¼å›´æˆçš„åŒºåŸŸçš„è¾¹ç•Œç‚¹å¤„å–å¾—ï¼Œä¸ç­‰å¼çº¦æŸèµ·ä½œç”¨è¿™ç§æƒ…å†µå¦‚ä¸Šå³å›¾æ‰€ç¤ºéœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒKKTæ¡ä»¶åªæ˜¯å–å¾—æå€¼çš„å¿…è¦æ¡ä»¶è€Œéå……åˆ†æ¡ä»¶å¦‚æœä¸€ä¸ªæœ€ä¼˜åŒ–é—®é¢˜æ˜¯å‡¸ä¼˜åŒ–é—®é¢˜ï¼Œåˆ™KKTæ¡ä»¶æ˜¯å–å¾—æå°å€¼çš„å……åˆ†æ¡ä»¶å¤šç›®æ ‡ä¼˜åŒ–é—®é¢˜å‰é¢è®²è¿°çš„ä¼˜åŒ–ç®—æ³•æ±‚è§£çš„æ˜¯å•ç›®æ ‡å‡½æ•°çš„æå€¼ï¼Œå¯¹äºæŸäº›åº”ç”¨ï¼Œéœ€è¦åŒæ—¶ä¼˜åŒ–å¤šä¸ªç›®æ ‡ä¾‹å¦‚è¦è®¾è®¡ä¸€ä¸ªæ–¹æ¡ˆä½¿å¾—è¿è¾“é€Ÿåº¦æœ€å¿«ï¼Œè€Œè¿è´¹åˆæœ€å°‘è¿™ç±»é—®é¢˜ç§°ä¸ºå¤šç›®æ ‡ä¼˜åŒ–(Multi-Objective Optimization)é—®é¢˜åŸºæœ¬æ¦‚å¿µå¤šç›®æ ‡ä¼˜åŒ–é—®é¢˜æœ‰å¤šä¸ªç›®æ ‡å‡½æ•°ï¼Œä¹Ÿç§°ä¸ºå‘é‡ä¼˜åŒ–ï¼Œå¯ä»¥å½¢å¼åŒ–åœ°è¡¨è¿°ä¸ºå…¶ä¸­$X$ä¸ºä¼˜åŒ–å˜é‡çš„å¯è¡ŒåŸŸï¼Œ$p$ä¸ºç›®æ ‡å‡½æ•°çš„æ•°é‡æ‰€æœ‰ç›®æ ‡å‡½æ•°çš„å€¼å½¢æˆä¸€ä¸ª$p$ç»´å‘é‡ï¼Œå› æ­¤å¤šç›®æ ‡ä¼˜åŒ–çš„ç›®æ ‡å‡½æ•°æ˜¯å¦‚ä¸‹çš„æ˜ å°„åœ¨å•ç›®æ ‡ä¼˜åŒ–ä¸­å¾ˆå®¹æ˜“å®šä¹‰æœ€ä¼˜è§£çš„æ¦‚å¿µï¼Œä½†åœ¨å¤šç›®æ ‡ä¼˜åŒ–é—®é¢˜ä¸­æœ€ä¼˜è§£çš„å®šä¹‰æ›´ä¸ºå› éš¾ï¼Œ å› ä¸ºå¤šä¸ªç›®æ ‡å‡½æ•°ä¹‹é—´å¯èƒ½å­˜åœ¨åŒ–çªï¼Œæ— æ³•ä½¿å¾—å®ƒä»¬åŒæ—¶è¾¾åˆ°æœ€ä¼˜å€¼ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸å­˜åœ¨ä¸€ä¸ªæœ€ä¼˜è§£$x^{*}$ä½¿å¾—æ‰€æœ‰ç›®æ ‡å‡½æ•°åœ¨è¯¥ç‚¹å¤„å–å¾—æå°å€¼ï¼Œå„ä¸ªè§£ä¹‹é—´å¯èƒ½æ— æ³•æ¯”è¾ƒä¼˜åŠ£å¦‚æœæœ‰ä¸¤ä¸ªå¯è¡Œè§£å’Œï¼Œå¯¹äºä»»æ„ä¸€ä¸ªç›®æ ‡å‡½æ•°éƒ½æœ‰å¹¶ä¸”è‡³å°‘å­˜åœ¨ä¸€ä¸ª$i$ä½¿å¾—åˆ™ç§°ä¼˜äºï¼Œå³åœ¨æ‰€æœ‰å…¶ä»–ç›®æ ‡å‡½æ•°çš„å€¼ä¸å¢åŠ çš„å‰æä¸‹è‡³å°‘æœ‰ä¸€ä¸ªç›®æ ‡å‡½æ•°çš„å€¼æ›´å°è¿™ä¸€æ¦‚å¿µçš„ç›´è§‚è§£é‡Šæ˜¯å¸•ç´¯æ‰˜æ”¹è¿›(Pareto Improvement)å¯¹äºå¤šç›®æ ‡ä¼˜åŒ–é—®é¢˜ï¼Œåœ¨ä¸é™ä½å…¶ä»–æ‰€æœ‰ç›®æ ‡å‡½æ•°çš„å€¼çš„æƒ…å†µä¸‹ï¼Œä½¿å¾—è‡³å°‘ä¸€ä¸ªç›®æ ‡å‡½æ•°çš„å€¼å¾—åˆ°æ”¹è¿›ï¼Œç§°ä¸ºå¸•ç´¯æ‰˜æ”¹è¿›æœ‰ä¸€ä¸ªå¯è¡Œè§£ï¼Œå¦‚æœå¯¹äºå¯è¡ŒåŸŸä¸­çš„ä»»æ„è§£ï¼Œéƒ½ä¼˜äºï¼Œåˆ™ç§°æ˜¯æœ€ä¼˜è§£æœ€ä¼˜è§£æ˜¯ä½¿æ‰€æœ‰ç›®æ ‡å‡½æ•°åŒæ—¶è¾¾åˆ°æœ€ä¼˜çš„è§£ï¼Œå¯¹äºå¤§å¤šæ•°å¤šç›®æ ‡ä¼˜åŒ–é—®é¢˜ï¼Œæœ€ä¼˜è§£æ˜¯ä¸å­˜åœ¨çš„å¯¹äºä¸‹é¢çš„é—®é¢˜æ­¤é—®é¢˜å­˜åœ¨æœ€ä¼˜è§£ï¼Œä¸º$x=2$ï¼Œä¸¤ä¸ªç›®æ ‡å‡½æ•°çš„æœ€å°å€¼ç‚¹åˆšå¥½é‡åˆï¼Œå¦‚ä¸‹å·¦å›¾æ‰€ç¤ºï¼Œå›¾ä¸­ä¸‹æ–¹çš„æ›²çº¿ä¸ºç›®æ ‡å‡½æ•°$(x-2)^{2}+1$ï¼Œä¸Šæ–¹çš„æ›²çº¿ä¸ºç›®æ ‡å‡½æ•°$(x-2)^{2}+15$xxxå›¾å¤šç›®æ ‡ä¼˜åŒ–é—®é¢˜çš„æœ€ä¼˜è§£+å¸•ç´¯æ‰˜æœ€ä¼˜è§£å¯¹äºå¤šç›®æ ‡ä¼˜åŒ–é—®é¢˜ï¼Œå¦‚æœæ˜¯ä¸€ä¸ªå¯è¡Œè§£å¹¶ä¸”ä¸å­˜åœ¨æ¯”æ›´ä¼˜çš„è§£ï¼Œåˆ™ç§°å…¶ä¸ºå¸•ç´¯æ‰˜æœ€ä¼˜è§£(Pareto Optimality)å¸•ç´¯æ‰˜æœ€ä¼˜è§£åªæ˜¯ä¸€ä¸ªä¸åçš„è§£ï¼Œä¸”åœ¨å¾ˆå¤šæƒ…å†µä¸‹å­˜åœ¨å¤šä¸ªå¸•ç´¯æ‰˜æœ€ä¼˜è§£å¯¹äºå¦‚ä¸‹ä¼˜åŒ–é—®é¢˜å…¶ä¸­ç›®æ ‡å‡½æ•°è¯¥é—®é¢˜çš„æœ€ä¼˜è§£ä¸å­˜åœ¨ï¼ŒåŒºé—´$[-2,2]$ä¸ºå¸•ç´¯æ‰˜æœ€ä¼˜è§£ï¼Œè¿™ä¸€åŒºé—´å†…çš„ä»»æ„ä¸¤ç‚¹ä¹‹é—´æ— æ³•æ¯”è¾ƒä¼˜åŠ£å¯¹äºè¯¥åŒºé—´çš„ä¸¤ä¸ªä¸åŒç‚¹ã€ï¼Œè‹¥ï¼Œåˆ™è€Œï¼Œå› æ­¤è¿™ä¸¤ä¸ªç‚¹æ— æ³•æ¯”è¾ƒä¼˜åŠ£å¯¹è¯¥åŒºé—´å†…çš„ä»»æ„ç‚¹$x_{1}$ï¼Œå‡ä¸å­˜åœ¨å…¶ä»–ç‚¹ä¼˜äºè¯¥ç‚¹å¦‚æœï¼Œåˆ™æ€»èƒ½æ‰¾åˆ°è‡³å°‘ä¸€ä¸ªä½¿å¾—ä¼˜äºï¼Œå¦‚å³å¯æ»¡è¶³è¦æ±‚å¯¹äº$x_{1} \in(-2,+\infty)$æœ‰åŒæ ·çš„ç»“è®ºï¼Œå› æ­¤è¿™ä¸¤ä¸ªåŒºé—´å†…çš„è§£ä¸æ˜¯å¸•ç´¯æ‰˜æœ€ä¼˜è§£è¯¥æœ€ä¼˜åŒ–é—®é¢˜çš„ç›®æ ‡å‡½æ•°å¦‚ä¸Šå³å›¾æ‰€ç¤ºå›¾ä¸­æ›²çº¿ä¸ºï¼Œæ›²çº¿ä¸ºå¸•ç´¯æ‰˜æœ€ä¼˜æºè‡ªç»æµå­¦ï¼Œæ˜¯èµ„æºåˆ†é…çš„ä¸€ç§ç†æƒ³çŠ¶æ€ç»™å®šä¸€ç¾¤äººå’Œä¸€äº›å¯åˆ†é…çš„èµ„æºï¼Œå¦‚æœä»ä¸€ç§åˆ†é…çŠ¶æ€åˆ°å¦ä¸€ç§åˆ†é…çŠ¶æ€çš„å˜åŒ–ä¸­ï¼Œåœ¨æ²¡æœ‰ä½¿ä»»ä½•äººå¢ƒå†µå˜åçš„å‰æä¸‹ï¼Œä½¿å¾—è‡³å°‘ä¸€ ä¸ªäººå˜å¾—æ›´å¥½ï¼Œåˆ™ç§°ä¸ºå¸•ç´¯æ‰˜æ”¹è¿›ï¼Œå¸•ç´¯æ‰˜æœ€ä¼˜çš„çŠ¶æ€æ˜¯ä¸å¯èƒ½å†æœ‰å¸•ç´¯æ‰˜æ”¹è¿›çš„çŠ¶æ€å¯¹äºå¤šç›®æ ‡ä¼˜åŒ–é—®é¢˜ï¼Œä¸€ç§è§£å†³æ€è·¯æ˜¯æ‰¾åˆ°å¸•ç´¯æ‰˜æœ€ä¼˜è§£çš„é›†åˆï¼Œç„¶åä»è¯¥é›†åˆä¸­é€‰æ‹©ä¸€ è§£ä½œä¸ºé—®é¢˜çš„è§£æ±‚è§£ç®—æ³•æ±‚è§£å¤šç›®æ ‡ä¼˜åŒ–é—®é¢˜çš„ä¸€ç§æ€è·¯æ˜¯è½¬åŒ–ä¸ºå•ç›®æ ‡ä¼˜åŒ–é—®é¢˜ï¼ŒåŒ…æ‹¬æ ‡é‡åŒ–ã€$\varepsilon$çº¦æŸæ³•æ ‡é‡åŒ–æ ‡é‡åŒ–æ ¹æ®å¤šä¸ªç›®æ ‡å‡½æ•°è®¾è®¡å‡ºå•ä¸ªç›®æ ‡å‡½æ•°ï¼Œä½¿å¾—å•ç›®æ ‡ä¼˜åŒ–é—®é¢˜çš„æœ€ä¼˜è§£æ˜¯å¤šç›®æ ‡ä¼˜åŒ–é—®é¢˜çš„å¸•å‚«æ‰˜æœ€ä¼˜è§£é™„åŠ è¦æ±‚æ˜¯å¯¹äºæŸäº›æ ‡é‡åŒ–å‚æ•°ï¼Œæ‰€æœ‰å¸•ç´¯æ‰˜æœ€ä¼˜è§£å¯¹äºå•ç›®æ ‡ä¼˜åŒ–é—®é¢˜éƒ½æ˜¯å¯è¾¾çš„å¯¹äºä¸åŒçš„æ ‡é‡åŒ–å‚æ•°ï¼Œä¼šäº§ç”Ÿä¸åŒçš„å¸•ç´¯æ‰˜æœ€ä¼˜è§£ï¼Œå¯¹äºå¦‚ä¸‹ä¼˜åŒ–é—®é¢˜å®ƒçš„æ ‡é‡åŒ–é—®é¢˜å¯ä»¥å†™æˆä¸‹é¢çš„å½¢å¼åœ¨è¿™é‡Œï¼Œæ˜¯äººå·¥è®¾è®¡çš„æ ‡é‡åŒ–å‡½æ•°ï¼Œä»¥æ‰€æœ‰ç›®æ ‡å‡½æ•°è¾“å‡ºå€¼ä»¥åŠäººå·¥è®¾å®šçš„å‚æ•°å‘é‡ä½œä¸ºè¾“äººï¼Œè¾“å‡ºä¸€ä¸ªæ ‡é‡å€¼$X_{\theta} \subseteq X$ä¸ºæ ‡é‡åŒ–é—®é¢˜çš„å¯è¡ŒåŸŸï¼Œç”±å‚æ•°$\theta$ä»¥åŠåŸå§‹çš„å¯è¡ŒåŸŸå†³å®šçº¿æ€§æ ‡é‡åŒ–æ˜¯æœ€ç®€å•çš„æ ‡é‡åŒ–ï¼Œé€šè¿‡å¯¹å¤šä¸ªç›®æ ‡å‡½æ•°çº¿æ€§åŠ æƒæ„é€ å‡ºå•ç›®æ ‡å‡½æ•°ï¼Œä¸Šå¼æœ€å°åŒ–é—®é¢˜çº¿æ€§æ ‡é‡åŒ–ä¹‹åå˜ä¸º$w_{i}&gt;0$ä¸ºæƒé‡ç³»æ•°ï¼Œäººå·¥è®¾å®šé™¤çº¿æ€§æ ‡é‡åŒ–ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ç”¨å…¶ä»–å‡½æ•°å°†å¤šç›®æ ‡å‡½æ•°åˆå¹¶æˆå•ç›®æ ‡å‡½æ•°ï¼Œå¦‚åŠ æƒä¹˜ç§¯æ³•$\varepsilon$çº¦æŸæ³•$\varepsilon$çº¦æŸæ³•åªä¿ç•™ä¸€ä¸ªç›®æ ‡å‡½æ•°ï¼Œå°†å…¶ä»–ç›®æ ‡å‡½æ•°è½¬åŒ–ä¸ºä¸ç­‰å¼çº¦æŸï¼Œè½¬åŒ–ä¹‹åçš„ä¼˜åŒ–é—®é¢˜å˜ä¸ºå‚æ•°$\varepsilon$ç”±äººå·¥è®¾å®šå…¶æ„ä¹‰æ˜¯åœ¨ä¿è¯ä¸å¤ªå·®çš„å‰æä¸‹ä¼˜åŒ–ï¼Œæ±‚è§£å¸¦ä¸ç­‰å¼çº¦æŸçš„ä¼˜åŒ–é—®é¢˜å¯ä»¥å¾—åˆ°åŸå§‹é—®é¢˜çš„è§£åº”ç”¨ä¸€å¤šç›®æ ‡ç¥ç»ç»“æ„æœç´¢ä¸‹é¢ä»‹ç»å¤šç›®æ ‡ä¼˜åŒ–åœ¨ç¥ç»ç»“æ„æœç´¢ä¸­çš„åº”ç”¨ï¼Œç¥ç»ç»“æ„æœç´¢( Neural Architecture Searchï¼ŒNAS)å±äºè‡ªåŠ¨åŒ–æœºå™¨å­¦ä¹ (AutoML)çš„èŒƒç•´ï¼Œå…¶ç›®æ ‡æ˜¯ç”¨ç®—æ³•è‡ªåŠ¨è®¾è®¡å‡ºç¥ç»ç½‘ç»œç»“æ„ï¼Œä¿è¯ç¥ç»ç½‘ç»œæœ‰é«˜çš„ç²¾åº¦å¤šç›®æ ‡ç¥ç»ç»“æ„æœç´¢(Multi-objective Neural Architecture Searchï¼ŒMONAS)çš„ç›®æ ‡åˆ™æ˜¯ç”¨ç®—æ³•è®¾è®¡å‡ºé«˜ç²¾åº¦ä¸”è®¡ç®—é‡å°ã€å ç”¨å­˜å‚¨ç©ºé—´å°çš„ç¥ç»ç½‘ç»œç»“æ„ï¼Œéœ€è¦åŒæ—¶æ»¡è¶³å¤šä¸ªç›®æ ‡å¯¹äºæœ‰äº›åº”ç”¨ï¼Œæ¨¡å‹å¤§å°ã€é¢„æµ‹æ—¶é—´ä¹Ÿéå¸¸é‡è¦ï¼Œå°¤å…¶æ˜¯å¯¹äºè®¡ç®—èƒ½åŠ›å¼±çš„å¹³å°ï¼Œå¦‚åµŒå…¥å¼ç³»ç»Ÿã€ç§»åŠ¨ãŸ¨å¯¹äºè¿™äº›åº”ç”¨åœºæ™¯ï¼ŒNASç­«æ³•éœ€è¦è€…è™‘ç²¾åº¦ä¹‹å¤–çš„ç›®æ ‡ï¼Œå› æ­¤éœ€è¦å¤šç›®æ ‡NASç®—æ³•å¤šç›®æ ‡NASå¯æŠ½è±¡ä¸ºå¤šç›®æ ‡ä¼˜åŒ–é—®é¢˜ä¸€èˆ¬é‡‡ç”¨å¸•ç´¯æ‰˜æœ€ä¼˜åŸåˆ™æ¥å¯»æ‰¾ç½‘ç»œç»“æ„ï¼Œå¤šç›®æ ‡NASç®—æ³•ä»¥æ­¤ä¸ºå‡†åˆ™åœ¨å„ç§ç›®æ ‡ä¹‹é—´åšå‡ºæŠ˜ä¸­ä¼˜åŒ–è¿™äº›ç®—æ³•ç²¾åº¦ä¹‹å¤–çš„å…¶ä»–å› ç´ ï¼Œå¸¸ç”¨çš„æœ‰ä¸‹é¢ä¸€äº›ä¼˜åŒ–æŒ‡æ ‡ç¥ç»ç½‘ç»œè¿è¡Œæ—¶çš„åŠŸè€—ï¼Œå¯¹äºèƒ½é‡æ•æ„Ÿçš„åœºæ™¯ï¼ŒåŠŸè€—æ˜¯æ ¸å¿ƒæŒ‡æ ‡ç¥ç»ç½‘ç»œè¿è¡Œæ—¶çš„é¢„æµ‹æ—¶é—´ï¼Œä¹Ÿç§°ä¸ºå»¶è¿Ÿç¥ç»ç½‘ç»œçš„å‚æ•°æ•°é‡ä¸æ¨¡å‹å¤§å°ï¼Œç”¨äºé™åˆ¶å¯¹å­˜å‚¨ç©ºé—´çš„å ç”¨ç¥ç»ç½‘ç»œé¢„æµ‹æ—¶çš„è¿ç®—é‡ï¼Œå…¸å‹çš„æ˜¯FLOPSï¼Œå³æ¯ç§’çš„æµ®ç‚¹è¿ç®—æ¬¡æ•°æœç´¢ç®—æ³•å¯ä»¥é‡‡ç”¨å¼ºåŒ–å­¦ä¹ ã€é—ä¼ ç®—æ³•ã€è´å¶æ–¯ä¼˜åŒ–å®ƒä»¬ä»¥ç¥ç»ç½‘ç»œçš„ç»“æ„ä¸ºä¼˜åŒ–å˜é‡ï¼Œä½¿å¾—ä¼˜åŒ–ç›®æ ‡(å¦‚ç¥ç»ç½‘ç»œçš„é¢„æµ‹ç²¾åº¦)æœ€ä¼˜åŒ–ï¼Œä»¥æ­¤æ‰¾åˆ°æœ€ä¼˜çš„ç¥ç»ç½‘ç»œç»“æ„MONASMONASçš„ç›®æ ‡æ˜¯åŒæ—¶ä¼˜åŒ–ç¥ç»ç½‘ç»œçš„ç²¾åº¦ä¸èƒ½è€—ï¼Œæˆ–è¿ç®—é‡æ•´ä½“ä¸Šé‡‡ç”¨äº†å’ŒNASç±»ä¼¼çš„æ–¹æ³•ï¼Œç”±ä¸€ä¸ªç§°ä¸ºRobot Network (RN)çš„ç½‘ç»œç”ŸæˆCNNçš„è¶…å‚æ•°åºåˆ—åœ¨è¯„ä¼°é˜¶æ®µï¼Œè®­ç»ƒæ­¤$\mathrm{CNN}$ï¼Œç§°ä¸ºTarget Network (TN)ï¼Œä»¥ç›®æ ‡ç½‘ç»œçš„ç²¾åº¦ï¼Œèƒ½è€—ä½œä¸ºRNçš„å¥–åŠ±å€¼ï¼Œç”¨å¼ºåŒ–å­¦ä¹ ç®—æ³•å¯¹RNè¿›è¡Œæ›´æ–°ç®—æ³•æ¯æ¬¡è¿­ä»£æ—¶å¾—åˆ°ä¸€ä¸ªç½‘ç»œç»“æ„ï¼Œå–å¥–åŠ±å€¼æœ€é«˜çš„ç½‘ç»œç»“æ„ä½œä¸ºæœç´¢ç®—æ³•çš„è¿”å›ç»“æœå…³é”®çš„é—®é¢˜æ˜¯ä¼˜åŒ–ç›®æ ‡(å³å¥–åŠ±å€¼)çš„å®šä¹‰è¿™é‡Œè€ƒè™‘äº†å¤šä¸ªæŒ‡æ ‡ï¼ŒåŒ…æ‹¬ç²¾åº¦å€¼ã€æ º å‹é¢„æµ‹æ—¶çš„å³°å€¼èƒ½è€—å’Œå¹³å‡èƒ½è€—ï¼Œå¥–åŠ±å‡½æ•°çš„è®¡ç®—å…¬å¼ä¸ºå…¶ä¸­$A C C$ä¸ºç¥ç»ç½‘ç»œçš„é¢„æµ‹ç²¾åº¦å€¼ï¼ŒEnergy ä¸ºç¥ç»ç½‘ç»œè¿è¡Œæ—¶çš„èƒ½è€—ï¼Œ$m$æ˜¯ç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œä¸ºç®—æ³•çš„ä¼˜åŒ–å˜é‡ï¼Œ$0&lt;\alpha&lt;1$ä¸ºäººå·¥è®¾å®šçš„æƒé‡ç³»æ•°å®ƒçš„ç›®æ ‡æ˜¯æœ€å¤§åŒ–é¢„æµ‹ç²¾åº¦çš„åŒæ—¶æœ€å°åŒ–èƒ½è€—ï¼Œä»¥ä½¿å¾—æ­¤å¥–åŠ±å‡½æ•°æœ€å¤§åŒ–è¿™ç§ç›®æ ‡å‡½æ•°ç»¼åˆè€ƒè™‘äº†ç²¾åº¦å€¼å’Œèƒ½è€—å€¼ï¼Œä½¿ç”¨çº¿æ€§æ ‡é‡åŒ–å°†å¤šç›®æ ‡ä¼˜åŒ–é—®é¢˜è½¬åŒ–ä¸ºå•ç›®æ ‡ä¼˜åŒ–é—®é¢˜MnasNetMnasNetç”¨åŠ æƒä¹˜ç§¯æ³•å°†å¤šç›®æ ‡ä¼˜åŒ–é—®é¢˜æ ‡é‡åŒ–ï¼ŒåŒæ—¶ä¼˜åŒ–ç¥ç»ç½‘ç»œçš„ç²¾åº¦ä¸é¢„æµ‹æ—¶é—´ç»™å®šæ¨¡å‹$m$ï¼Œè®°$A C C(m)$ä¸ºå®ƒå¯¹ç›®æ ‡ä»»åŠ¡çš„ç²¾åº¦ï¼Œ$L A T(m)$ä¸ºå…¶åœ¨ç›®æ ‡ç§»åŠ¨è®¾å¤‡ä¸Šçš„é¢„æµ‹å»¶è¿Ÿ(å³é¢„æµ‹æ—¶é—´)ï¼Œ$T$ä¸ºç›®æ ‡å»¶è¿Ÿå¯¹äºæœ¬ä»»åŠ¡ï¼Œæ¨¡å‹æ˜¯å¸•ç´¯æ‰˜æœ€ä¼˜çš„ï¼Œå½“ä¸”ä»…å½“åœ¨ä¸å¢åŠ å»¶è¿Ÿæ—¶å…¶ç²¾åº¦æ˜¯æœ€é«˜çš„ï¼Œæˆ–è€…åœ¨ä¸é™ä½ç²¾åº¦æ—¶å…¶å»¶è¿Ÿæ˜¯æœ€å°çš„MnasNeté‡‡ç”¨åŠ æƒä¹˜ç§¯æ³•é€¼è¿‘å¸•ç´¯æ‰˜æœ€ä¼˜è§£ï¼Œç›®æ ‡å‡½æ•°å®šä¹‰ä¸º$\alpha$å’Œ$\beta$ä¸ºä¸åº”ç”¨ç›¸å…³çš„å¸¸æ•°ï¼Œæ ¹æ®ç»éªŒè®¾å®šå®ƒä»¬çš„å€¼ï¼Œä½¿å¾—åœ¨å»¶è¿Ÿè¶…è¿‡æŒ‡å®šé˜ˆå€¼æ—¶ç›®æ ‡å‡½æ•°çš„å€¼æ›´å°æ³›å‡½æå€¼ä¸å˜åˆ†æ³•å‰é¢æåˆ°çš„ä¼˜åŒ–é—®é¢˜å‡ä¸ºæ±‚è§£å‡½æ•°æå€¼ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œæœ‰ä¸€ç±»æœ€ä¼˜åŒ–é—®é¢˜ï¼Œå…¶ä¼˜åŒ–å˜é‡ä¸æ˜¯æ•°è€Œæ˜¯å‡½æ•°ï¼Œç§°ä¸ºæ³›å‡½æå€¼é—®é¢˜æ±‚è§£è¿™ç±»é—®é¢˜çš„ç»å…¸æ–¹æ³•æ˜¯å˜åˆ†æ³•ï¼Œç”±äºé—®é¢˜çš„è§£æ˜¯å‡½æ•°ï¼Œå› æ­¤å¯ä»¥çŒœæµ‹ä»å–å¾—æå€¼çš„å¿…è¦æ¡ä»¶æ‰€å¯¼å‡ºçš„æ˜¯å¾®åˆ†æ–¹ç¨‹æ³›å‡½ä¸å˜åˆ†å‡½æ•°æ˜¯ä»æ•°é›†åˆ°æ•°é›†çš„æ˜ å°„ï¼Œå¦‚å®å˜å‡½æ•°å°†å®æ•°æ˜ å°„ä¸ºå®æ•°ï¼Œå¤å˜å‡½æ•°å°†å¤æ•°æ˜ å°„æˆå¤æ•°æ³›å‡½(Functional, ä¹Ÿç§°ä¸ºæ³›å‡½æ•°)æ˜¯å¯¹å‡½æ•°çš„æ‹“å±•ï¼Œæ˜¯ä»å‡½æ•°é›†åˆ°æ•°é›†çš„æ˜ å°„å¯å°†å‡½æ•°çœ‹ä½œç©ºé—´ä¸­çš„â€ç‚¹â€ï¼Œç§°ä¸ºå‡½æ•°ç©ºé—´(Function Space)ï¼Œæ³›å‡½å®ç°ä»è¿™ç§â€ç‚¹â€åˆ°å®æ•°é›†çš„æ˜ å°„ï¼Œå› æ­¤ä¹Ÿç§°ä¸ºå‡½æ•°çš„å‡½æ•°(Functions of Functions)è¿™é‡Œçš„å‡½æ•°é›†ç§°ä¸ºæ³›å‡½çš„å®šä¹‰åŸŸï¼Œ éœ€è¦æ³¨æ„æ³›å‡½ä¸å¤åˆå‡½æ•°çš„åŒºåˆ«ï¼Œå‰è€…å°†å‡½æ•°æ˜ å°„æˆå®æ•°ï¼Œåè€…è¿˜æ˜¯ä¸€ä¸ªå°†å®æ•°æ˜ å°„æˆå®æ•°çš„å‡½æ•°ä¸‹é¢æ˜¯ä¸€ä¸ªæœ€ç®€å•çš„æ³›å‡½å®ƒå¯¹å‡½æ•°è®¡ç®—$[0,1]$å†…çš„å®šç§¯åˆ†ï¼Œå¯¹äºæ­¤åŒºé—´ä¸Šä»»æ„çš„å¯ç§¯å‡½æ•°$y(x)$éƒ½æœ‰ä¸€ä¸ªå®æ•°ç§¯åˆ†å€¼æ­¤æ³›å‡½çš„å®šä¹‰åŸŸä¸º$[0,1]$ä¸Šå¯ç§¯åˆ†å‡½æ•°çš„å…¨ä½“ï¼Œå€¼åŸŸä¸ºå®æ•°é›†$\mathbb{R}$ç»™å®šä¸€ä¸ªå¯ç§¯åˆ†å‡½æ•°å¯ä»¥å¾—åˆ°å®ƒçš„æ³›å‡½çš„å€¼ï¼Œå¦‚æœå‡½æ•°ä¸ºå…¶æ³›å‡½å€¼ä¸ºå¦‚æœå‡½æ•°ä¸ºåˆ™æ³›å‡½çš„å€¼ä¸ºå®šç§¯åˆ†å°†å¯ç§¯å‡½æ•°æ˜ å°„æˆå®æ•°ï¼Œå› æ­¤é€šå¸¸æƒ…å†µä¸‹æ³›å‡½ä»¥å®šç§¯åˆ†çš„å½¢å¼å‡ºç°ï¼Œå¦‚ä¸‹é¢çš„æ³›å‡½è¢«ç§¯å‡½æ•°ä¸­é™¤å‡½æ•°$y(x)$ä¹‹å¤–ï¼Œè¿˜å¯ä»¥åŒ…æ‹¬å…¶å„é˜¶å¯¼æ•°å¦‚åŒºé—´$[aï¼Œb]$å†…æ›²çº¿$y(x)$å¼§é•¿çš„è®¡ç®—å…¬å¼æ˜¯ä¸€ä¸ªæ³›å‡½ï¼Œå…¶ä¸­åŒ…å«ä¸€é˜¶å¯¼æ•°æ¦‚ç‡è®ºé‡Œä»‹ç»çš„æ•°å­¦æœŸæœ›å’Œæ–¹å·®ï¼Œä¿¡æ¯è®ºé‡Œä»‹ç»çš„å«¡ä¹Ÿæ˜¯æ³›å‡½ï¼Œéšæœºå˜é‡$X$çš„æ•°å­¦æœŸæœ›æ˜¯å¦‚ä¸‹çš„ç§¯åˆ†å…¶ä¸­$p(x)$ä¸ºæ¦‚ç‡å¯†åº¦å‡½æ•°ï¼Œä¸å‡½æ•°ç±»ä¼¼ï¼Œå¯ä»¥å®šä¹‰æ³›å‡½çš„æå€¼ï¼Œç»™å®šä¸€ä¸ªå‡½æ•°$y_{0}(x)$ï¼Œå¦‚æœå¯¹äºæ³›å‡½å®šä¹‰åŸŸä¸­ä»»æ„å‡½æ•°$y(x)$éƒ½æœ‰åˆ™ç§°$y_{0}(x)$ä¸ºæ³›å‡½çš„æå°å€¼ï¼Œå¦‚æœ‰åˆ™ç§°ä¸ºæ³›å‡½çš„æå¤§å€¼ï¼Œå¦‚æœå¯¹äºé‚»åŸŸå†…çš„æ‰€æœ‰éƒ½æœ‰ä¸Šä¸Šå¼æˆç«‹ï¼Œåˆ™ç§°ä¸ºæ³›å‡½çš„å±€éƒ¨æå°å€¼å¦‚æœä¸Šå¼æˆç«‹ï¼Œåˆ™ç§°$y_{0}(x)$ä¸ºæ³›å‡½çš„å±€éƒ¨æå¤§å€¼ï¼Œè¿™é‡Œçš„é‚»åŸŸç”±å‡½æ•°ä¹‹é—´çš„è·ç¦»æ¥å®šä¹‰å¯¹äºå®šä¹‰åœ¨åŒºé—´å†…çš„ä¸¤ä¸ªä¸€é˜¶å¯å¯¼å‡½æ•°ï¼Œå®ƒä»¬çš„è·ç¦»å¯ä»¥å®šä¹‰ä¸ºè¿™é‡Œç”¨ä¸¤ä¸ªå‡½æ•°åœ¨åŒºé—´å†…æ‰€æœ‰ç‚¹å¤„çš„å‡½æ•°å€¼ä»¥åŠå¯¼æ•°å€¼çš„å·®è¡¡é‡å®ƒä»¬çš„å·®å¼‚é™¤æ­¤ä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥æœ‰å…¶ä»–è·ç¦»å®šä¹‰æ–¹å¼ï¼Œå‡½æ•°$y_{0}(x)$çš„$\delta$é‚»åŸŸå®šä¹‰ä¸ºå¦‚æœå®šä¹‰åœ¨åŒºé—´å†…çš„ä¸¤ä¸ªå‡½æ•°ä¸åœ¨å’Œç‚¹å¤„å‡½æ•°å€¼ç›¸ç­‰ï¼Œåˆ™ç§°ä¸ºå‡½æ•°åœ¨ç‚¹å¤„çš„å˜åˆ†(Variation )ï¼Œè®°ä¸ºå¯å°†å˜åˆ†ç±»æ¯”ä¸ºå¾®åˆ†ï¼Œä¸å¾®åˆ†ä¸åŒçš„æ˜¯ï¼Œå˜åˆ†æ˜¯å‡½æ•°å˜åŒ–ã€è‡ªå˜é‡ä¸å˜æ‰€å¯¼è‡´çš„å˜åŒ–ï¼›è€Œå¾®åˆ†åˆ™æ˜¯å‡½æ•°ä¸å˜ã€è‡ªå˜é‡æ”¹å˜æ‰€å¯¼è‡´çš„å˜åŒ–å¯¹äºå¤§å¤šæ•°å®é™…é—®é¢˜ï¼Œæ³›å‡½å¯ä»¥å†™æˆå¦‚ä¸‹çš„ä¸€èˆ¬å½¢å¼å‡½æ•°$L$ç§°ä¸ºæ³›å‡½çš„æ ¸ï¼Œå®ƒåŒ…å«äº†å‡½æ•°çš„è‡ªå˜é‡$x$ï¼Œå‡½æ•°æœ¬èº«$y$ä»¥åŠå…¶ä¸€é˜¶å¯¼æ•°$y^{\prime}$åœ¨è¿™é‡Œï¼Œ$y$æ˜¯ äºŒé˜¶è¿ç»­å¯å¯¼çš„å‡½æ•°ï¼Œ$L$å¯¹å…¶è‡ªå˜é‡$x,y,y^{\prime}$äºŒé˜¶è¿ç»­å¯å¯¼(å°†å‡½æ•°$y$ä»¥åŠå…¶ä¸€é˜¶å¯¼æ•°$y^{\prime}$å‡çœ‹ä½œæ™®é€šçš„å˜é‡åé¢çš„æ¨å¯¼ä¸­å¦‚ä¸ä½œç‰¹æ®Šè¯´æ˜å‡ä½¿ç”¨è¿™ç§å½¢å¼çš„æ³›å‡½æ¬§æ‹‰-æ‹‰æ ¼æœ—æ—¥æ–¹ç¨‹è®¡ç®—æ³›å‡½æå€¼ç‚¹çš„é—®é¢˜ç§°æ³›å‡½æå€¼é—®é¢˜ï¼Œå…¶æœ€ä¼˜è§£ä¸ºå‡½æ•°è€Œä¸æ˜¯å‡½æ•°æå€¼é—®é¢˜ä¸­çš„æ•°ä»¥ç­‰å‘¨é—®é¢˜ä¸ºä¾‹ï¼Œå¯¹äºå¹³é¢å†…çš„å°é—­æ›²çº¿ï¼Œåœ¨æ›²çº¿å¼§é•¿ä¸€å®šçš„æƒ…å†µä¸‹åœ†çš„é¢ç§¯æœ€å¤§å‡è®¾æ›²çº¿ç»è¿‡$(-aï¼Œ0)$å’Œ$(aï¼Œ0)$ä¸¤ç‚¹ï¼Œæ­¤é—®é¢˜çš„çº¦æŸæ¡ä»¶ä¸ºå®ƒé™åˆ¶æ›²çº¿çš„å¼§é•¿ï¼Œç›®æ ‡æ³›å‡½ä¸ºæ˜¯æ›²çº¿$y(x)$ä¸$x$è½´æ‰€å›´æˆçš„åŒºåŸŸçš„é¢ç§¯ï¼Œå¦‚æœ$a=2$ï¼Œæ­¤é—®é¢˜çš„è§£ä¸ºåŠåœ†å¼§çº¿ï¼Œå…¶æ–¹ç¨‹ä¸ºåŠåœ†çš„æ›²çº¿å¦‚ä¸‹å·¦å›¾æ‰€ç¤ºxxxå›¾ç­‰å‘¨é—®é¢˜çš„åŠåœ†æ›²çº¿+å¯¹å‡½æ•°è¿›è¡Œæ‰°åŠ¨æ±‚è§£æ³›å‡½æå€¼é—®é¢˜çš„ç»å…¸æ–¹æ³•æ˜¯å˜åˆ†æ³•(Calculus of Variations)ï¼Œå…¶æ ¸å¿ƒæ˜¯æ¬§æ‹‰-æ‹‰æ ¼æœ—æ—¥æ–¹ç¨‹åœ¨å¾®ç§¯åˆ†ä¸­ï¼Œé€šè¿‡æ±‚è§£é©»ç‚¹è€Œå¾—åˆ°æå€¼ç‚¹ï¼Œåœ¨æ³›å‡½ä¸­ï¼Œé€šè¿‡æ±‚è§£å˜åˆ†ä¸º0çš„ç‚¹è€Œæ±‚è§£æ³›å‡½çš„æå€¼ï¼Œè¿™é‡Œçš„å˜åˆ†ç±»ä¼¼äºå‡½æ•°çš„å¯¼æ•°(å¾®åˆ†)å¯¹äºä¸‹é¢çš„æ³›å‡½é€šå¸¸é™å®šå‡½æ•°$y(x)$åœ¨èµ·ç‚¹å’Œç»ˆç‚¹å¤„çš„å‡½æ•°å€¼ï¼Œç§°ä¸ºè¾¹ç•Œæ¡ä»¶æ¬§æ‹‰-æ‹‰æ ¼æœ—æ—¥æ–¹ç¨‹(Euler-Lagrange Equationï¼ŒE-Læ–¹ç¨‹)æ˜¯ä¸€ä¸ªå¾®åˆ†æ–¹ç¨‹ï¼Œç»™å‡ºäº†æ³›å‡½å–å¾—æå€¼çš„å¿…è¦æ¡ä»¶å¯¹äºä¸Šå¼çš„æ³›å‡½ï¼Œå…¶å–å¾—æå€¼çš„$y(x)$éœ€è¦æ»¡è¶³å¼å­å·¦è¾¹ç¬¬ä¸€é¡¹æ˜¯æ³›å‡½çš„æ ¸$L$å¯¹$y$æ±‚åå¯¼ï¼Œå°†$y$å½“ä½œå˜é‡ï¼›ç¬¬äºŒé¡¹æ˜¯$L$å…ˆå¯¹$y^{\prime}$æ±‚åå¯¼æ•°ï¼Œå†å¯¹$x$æ±‚å¯¼è§£æ­¤å¾®åˆ†æ–¹ç¨‹å³å¯å¾—åˆ°æ³›å‡½çš„æå€¼è¯¥æ–¹ç¨‹çš„ä½œç”¨ç±»ä¼¼äºè´¹é©¬å¼•ç†æ‰€ç¡®å®šçš„å‡½æ•°æå€¼éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¯¥æ–¹ç¨‹æ˜¯æ³›å‡½å–å¾—æå€¼çš„å¿…è¦æ¡ä»¶è€Œéå……åˆ†æ¡ä»¶ä¸‹é¢å¯¹ä¸€ç»´æƒ…å†µçš„æ¬§æ‹‰-æ‹‰æ ¼æœ—æ—¥æ–¹ç¨‹è¿›è¡Œæ¨å¯¼ï¼Œå…¶æ€è·¯æ˜¯å°†æ³›å‡½æå€¼é—®é¢˜è½¬åŒ–ä¸ºå‡½æ•°æå€¼é—®é¢˜å¯¹äºä¸Šä¸Šå¼çš„æ³›å‡½ï¼Œç›®æ ‡æ˜¯å¯»æ‰¾æ»¡è¶³è¾¹ç•Œæ¡ä»¶$y(a)=A$ã€$ y(b)=B$ä¸”ä½¿å¾—æ³›å‡½å–æå€¼çš„$y(x)$å‡è®¾$L$äºŒé˜¶è¿ç»­å¯å¾®ï¼Œå¦‚æœ$y(x)$ä½¿å¾—æ³›å‡½å–æå¤§å€¼ï¼Œåˆ™å¯¹$y(x)$çš„ä»»ä½•æ‰°åŠ¨éƒ½ä¼šå¯¼è‡´æ³›å‡½çš„å€¼å˜å°å¯¹äºæ³›å‡½å–æå°å€¼çš„æƒ…å†µåˆ™å¯¼è‡´æ³›å‡½çš„å€¼å˜å¤§ï¼Œå‡è®¾æ˜¯å¯¹$y(x)$æ‰°åŠ¨åçš„ç»“æœï¼Œå…¶ä¸­$\varepsilon \eta(x)$æ˜¯æ‰°åŠ¨é¡¹ï¼›$\varepsilon$æ˜¯ä¸€ä¸ªå¾ˆå°çš„å®æ•°ï¼›$\eta(x)$æ˜¯å¯å¾®å‡½æ•°ä¸”æ»¡è¶³$\eta(a)=\eta(b)=0$ï¼Œä»¥ç¡®ä¿æ‰°åŠ¨ä¹‹åè¿˜æ»¡è¶³è¾¹ç•Œæ¡ä»¶è¿™ç§éšæœºæ‰°åŠ¨çš„åŸç†å¦‚ä¸Šå³å›¾æ‰€ç¤ºï¼Œå›¾ä¸­ä¸­é—´çš„æ›²çº¿ä¸ºæ‰°åŠ¨ä¹‹å‰çš„å‡½æ•°$y(x)$ï¼Œæœ€ä¸‹æ–¹çš„æ›²çº¿ä¸ºæ‰°åŠ¨å‡½æ•°$\varepsilon \eta(x)$ï¼Œæœ€ä¸Šæ–¹çš„æ›²çº¿ä¸ºæ‰°åŠ¨ä¹‹åçš„å‡½æ•°$y(x)+\varepsilon \eta(x)$ï¼Œå®šä¹‰æ³›å‡½å…¶ä¸­ï¼Œè¦ä¿è¯åœ¨ç‚¹å¤„æ³›å‡½å–å¾—æå€¼ï¼Œåˆ™å¯¹å®ƒçš„ä»»ä½•æ‰°åŠ¨éƒ½ä¼šå¯¼è‡´æ³›å‡½å€¼å˜å¤§æˆ–å˜å°ï¼Œå› æ­¤å¿…å®šæœ‰å°†ä¸Šå¼çš„æ³›å‡½çœ‹ä½œ$\varepsilon$çš„å‡½æ•°ï¼Œå¯¹$\varepsilon$æ±‚å¯¼ï¼Œåˆ™åœ¨$\varepsilon=0$ç‚¹ å¤„å¯¼æ•°å€¼ä¸º$0$ï¼Œç”±äºæ±‚å¯¼å’Œæ±‚ç§¯åˆ†å¯ä»¥äº¤æ¢æ¬¡åºï¼Œæœ‰æ ¹æ®å…¨å¯¼æ•°å…¬å¼æœ‰åœ¨è¿™é‡Œä»¥åŠå› æ­¤æœ‰ç”±äºåœ¨$y(x)$ç‚¹å¤„ï¼Œå³$\varepsilon=0$æ˜¯æ³›å‡½çš„æå€¼ç‚¹æ ¹æ®è´¹é©¬å¼•ç†ï¼Œåœ¨ç‚¹å¤„ï¼Œå‡½æ•°å¯¹çš„å¯¼æ•°å¿…å®šä¸ºï¼Œåœ¨ç‚¹å¤„ã€ã€ï¼Œå› æ­¤æœ‰ä½¿ç”¨åˆ†éƒ¨ç§¯åˆ†æ³•ï¼Œä¸Šå¼ç¬¬äºŒä¸ªç­‰å¼ä¸­çš„ç¬¬äºŒé¡¹ä¸ºå› æ­¤æœ‰ç”±äºæœ‰è¾¹å€¼æ¡ä»¶$\eta(a)=\eta(b)=0$ï¼Œå› æ­¤ä¸Šå¼å·¦ä¾§ç¬¬äºŒé¡¹çš„å€¼ä¸º0ï¼Œä¸Šå¼å˜ä¸ºç”±äºå¯¹ä»»æ„æ»¡è¶³è¾¹å€¼æ¡ä»¶çš„$\eta(x)$ï¼Œä¸Šå¼éƒ½æˆç«‹ï¼Œæ ¹æ®ä¸€å…ƒå‡½æ•°å¾®ç§¯åˆ†ä¸­è¯æ˜çš„ç»“è®ºï¼Œæœ‰é€šå¸¸æƒ…å†µä¸‹ï¼ŒEuler-Lagrangeæ–¹ç¨‹æ˜¯ä¸€ä¸ªäºŒé˜¶å¸¸å¾®åˆ†æ–¹ç¨‹ï¼Œè§£æ­¤æ–¹ç¨‹å¯ä»¥å¾—åˆ°æ³›å‡½çš„æå€¼ç‚¹åº”ç”¨ä¸€è¯æ˜ä¸¤ç‚¹ä¹‹é—´ç›´çº¿æœ€çŸ­ä¸‹é¢ç”¨æ¬§æ‹‰-æ‹‰æ ¼æœ—æ—¥æ–¹ç¨‹è¯æ˜å‡ ä½•ä¸­çš„åŸºæœ¬ç»“è®ºï¼šä¸¤ç‚¹ä¹‹é—´ç›´çº¿æœ€çŸ­å‡è®¾æ›²çº¿$y(x)$é€šè¿‡$(a,A)$ä¸$(b,B)$ä¸¤ç‚¹ï¼Œå³æœ‰è¾¹ç•Œæ¡ä»¶$y(a)=A$ã€$y(b)=B$ï¼Œæ ¹æ®æ›²çº¿é•¿åº¦å…¬å¼ï¼Œæœ‰åœ¨è¿™é‡Œï¼Œæ³›å‡½çš„æ ¸ä¸º$L\left(x,y,y^{\prime}\right)=\sqrt{1+y^{\prime 2}}$æ ¹æ®æ¬§æ‹‰-æ‹‰æ ¼æœ—æ—¥æ–¹ç¨‹ï¼Œæœ‰å› æ­¤æœ‰ä¸Šå¼å¯¹$x$æ±‚ç§¯åˆ†æœ‰å…¶ä¸­$C$ä¸ºå¸¸æ•°ï¼Œè§£å¾—å¯¹ä¸Šå¼è¿›è¡Œç§¯åˆ†ï¼Œå¯ä»¥å¾—åˆ°å…¶ä¸­$C^{\prime}$ä¸ºå¸¸æ•°ï¼Œè¿™å°±æ˜¯ç›´çº¿çš„æ–¹ç¨‹ï¼Œæ ¹æ®è¾¹ç•Œæ¡ä»¶å¯ä»¥ç¡®å®š$\frac{C}{\sqrt{1-C^{2}}}$ï¼Œ$C^{\prime}$çš„å€¼æ¦‚ç‡è®ºä¸­å°†ç”¨å˜åˆ†æ³•è¯æ˜åœ¨ç»™å®šæ•°å­¦æœŸæœ›å’Œæ–¹å·®çš„å€¼æ—¶ï¼Œåœ¨æ‰€æœ‰å®šä¹‰äº$\mathbb{R}$ä¸Šçš„è¿ç»­å‹æ¦‚ç‡åˆ†å¸ƒä¸­ï¼Œæ­£æ€åˆ†å¸ƒçš„ç†µæœ€å¤§å˜åˆ†æ¨æ–­å’Œå˜åˆ†è‡ªåŠ¨ç¼–ç å™¨ä¹Ÿä½¿ç”¨äº†å˜åˆ†çš„æ¦‚å¿µ</content>
	</entry>
	<entry>
		<title>é«˜æ–¯åˆ†å¸ƒç›¸å…³ç®—æ³•</title>
		<url>/article/8896.html</url>
		<content>å­¦æ´¾å¯¹æ¦‚ç‡çš„è¯ é‡Šæœ‰ä¸¤å¤§å­¦æ´¾ï¼Œä¸€ç§æ˜¯é¢‘ç‡æ´¾å¦ä¸€ç§æ˜¯è´å¶æ–¯æ´¾ï¼Œåé¢æˆ‘ä»¬å¯¹è§‚æµ‹é›†é‡‡ç”¨ä¸‹é¢è®°å·ï¼š$X$è¿™ä¸ªçŸ©é˜µå±•å¼€å¦‚ä¸‹è¡¨ç¤ºæœ‰$N$ä¸ªæ ·æœ¬ï¼Œæ¯ä¸ªæ ·æœ¬éƒ½æ˜¯$p$ç»´å‘é‡ï¼Œå…¶ä¸­å‡è®¾æ¯ä¸ªè§‚æµ‹éƒ½æ˜¯ç”± $p(x|\theta)$ç”Ÿæˆçš„é¢‘ç‡æ´¾é¢‘ç‡æ´¾è®¤ä¸º$p(x|\theta)$ä¸­çš„$\theta$æ˜¯ä¸€ä¸ªæœªçŸ¥çš„å¸¸é‡ï¼Œè€Œæ•°æ®æ˜¯ä¸€ä¸ªéšæœºå˜é‡ï¼Œå…³å¿ƒçš„æ˜¯æ•°æ®ï¼Œç›®æ ‡æ˜¯ä¼°è®¡æœªçŸ¥çš„å¸¸é‡$\theta$å¸¸ç”¨çš„æ–¹æ³•æ˜¯æœ€å¤§ä¼¼ç„¶ä¼°è®¡å…¶ä¸­æ¯ä¸ªæ ·æœ¬$x_{i}$ç‹¬ç«‹åŒåˆ†å¸ƒäº$P(x \mid \theta)$ï¼Œå› æ­¤ä¸Šé¢çš„ç´¯ä¹˜å¯ä»¥æ”¹å†™æˆç´¯åŠ çš„å½¢å¼è´å¶æ–¯æ´¾è´å¶æ–¯æ´¾è®¤ä¸º$p(x|\theta)$ä¸­çš„$\theta$æ˜¯ä¸€ä¸ªéšæœºå˜é‡ï¼Œä¸”$\theta$æœä»ä¸€å®šçš„æ¦‚ç‡åˆ†$\theta\sim p(\theta)$ï¼Œé€šå¸¸å°†$p(\theta)$æˆä¸ºå…ˆéªŒæ ¹æ®è´å¶æ–¯å®šç†ï¼Œå°†å‚æ•°çš„å…ˆéªŒå’ŒåéªŒç”¨ä¼¼ç„¶å‡½æ•°è”ç³»èµ·æ¥å…¶ä¸­å…ˆéªŒæ˜¯$ p(\theta)$ï¼ŒåéªŒæ˜¯$p(\theta|X)$ï¼Œä¼¼ç„¶å‡½æ•°ä¸º$p(\theta){p(X)}$æœ€å¤§åéªŒä¼°è®¡ä¸ºäº†ä¼°è®¡$\theta$çš„å€¼ï¼Œæˆ‘ä»¬ä½¿ç”¨æœ€å¤§åéªŒä¼°è®¡MAPè¿›è¡Œæ±‚è§£ï¼Œå…¶ç›®çš„æ˜¯æ‰¾åˆ°ä¸€ä¸ª$\theta$ä½¿ç”¨ä¼°è®¡å‡ºæ¥çš„ç»“æœæœ€å¤§å…¶ä¸­$\propto$æ˜¯å› ä¸ºå¯¹äºåˆ†ç±»é—®é¢˜è€Œè¨€$p(X)$éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå¯ä»¥çœ‹æˆä¸€ä¸ªå¸¸æ•°ï¼Œä¸¥æ ¼æ„ä¹‰ä¸ŠMAPå¹¶ä¸æ˜¯æ ‡å‡†çš„è´å¶æ–¯æ–¹æ³•è´å¶æ–¯ä¼°è®¡çœŸæ­£çš„è´å¶æ–¯ä¼°è®¡æ˜¯å®å®åœ¨åœ¨çš„å»æ±‚è§£åéªŒæ¦‚ç‡å…¶ä¸­$\int _{\theta}p(X|\theta)\cdot p(\theta)d\theta$é€šå¸¸æ±‚è§£éš¾åº¦è¾ƒå¤§ï¼Œå› æ­¤å¯ä»¥éšæœºé‡‡æ ·ç®—æ³•ï¼Œå¦‚è’™ç‰¹å¡æ´›MCMCç®—æ³•è¿›è¡Œè¿‘ä¼¼æ±‚è§£æ±‚å‡ºæ¥çš„åéªŒæ¦‚ç‡å¯ä»¥åœ¨è´å¶æ–¯é¢„æµ‹æ—¶ä½¿ç”¨ï¼Œå‡è®¾è¿™æ—¶å€™æ¥äº†ä¸ªæ–°æ ·æœ¬$\tilde{x}$ï¼Œé¢„æµ‹é—®é¢˜å°±æ˜¯æ±‚$p(\tilde{x}|X)$é€šè¿‡$\theta$è¿™ä¸ªæ¡¥æ¢ï¼Œå³$X \rightarrow \theta \rightarrow \tilde{x}$ï¼Œä¸Šå¼å¯ä»¥å˜æ¢å¦‚ä¸‹å…¶ä¸­$p(\theta | X)$å°±æ˜¯è´å¶æ–¯ä¼°è®¡æ±‚å‡ºæ¥çš„åéªŒå°ç»“é¢‘ç‡æ´¾å’Œè´å¶æ–¯æ´¾åˆ†åˆ«ç»™å‡ºäº†ä¸€ç³»åˆ—çš„æœºå™¨å­¦ä¹ ç®—æ³•é¢‘ç‡æ´¾çš„è§‚ç‚¹å¯¼å‡ºäº†ä¸€ç³»åˆ—çš„ç»Ÿè®¡æœºå™¨å­¦ä¹ ç®—æ³•ï¼Œè€Œè´å¶æ–¯æ´¾å¯¼å‡ºäº†æ¦‚ç‡å›¾ç†è®ºsuccess@é¢‘ç‡æ´¾ä¸»è¦å¯¹åº”çš„é—®é¢˜æ˜¯ä¼˜åŒ–é—®é¢˜ é¢‘ç‡æ´¾ä¸»è¦å¯¹åº”çš„é—®é¢˜æ˜¯ä¼˜åŒ–é—®é¢˜ï¼Œé€šå¸¸çš„æ­¥éª¤æ˜¯å®šä¹‰æ¨¡å‹å®šä¹‰loss functionä¼˜åŒ–ç®—æ³•è´å¶æ–¯æ´¾ä¸»è¦æ˜¯æ±‚ç§¯åˆ†çš„é—®é¢˜æ¡ä»¶æ¦‚ç‡ä¸ä¼¼ç„¶å‡½æ•°åœ¨æå¤§ä¼¼ç„¶ä¼°è®¡ç›¸å…³åšæ–‡ä¸­ï¼Œå‡ºç°é¢‘ç‡æœ€é«˜çš„å°±æ˜¯è¿™ä¸ªå…¬å¼:å…¬å¼çš„è¾“å…¥åˆ†åˆ«ä¸ºå‚æ•°$\theta$ä»¥åŠç»“æœ$x$æ ¹æ®$\theta$å’Œ$x$çš„å·²çŸ¥æˆ–è€…æœ«çŸ¥çš„æƒ…å†µï¼Œè¯¥å…¬å¼æœ‰ä¸¤ä¸ªä¸åŒçš„æ„ä¹‰:å½“$\theta$æ˜¯å·²çŸ¥çš„å¹¶ä¸”ä¿æŒä¸å˜ï¼Œ$x$æ˜¯å˜é‡æ—¶ï¼Œè¯¥å…¬å¼æè¿°çš„æ˜¯åœ¨å‚æ•°ç¡®å®šçš„æƒ…å†µä¸‹ï¼ŒæŸä¸€äº‹ä»¶(ç»“æœ)$x$å‡ºç°çš„æ¦‚ç‡ï¼Œæ˜¯æ¦‚ç‡å‡½æ•°å½“$\theta$æ˜¯å˜é‡ï¼Œ$x$æ˜¯å·²çŸ¥çš„å¹¶ä¸”ä¿æŒä¸å˜ï¼Œè¯¥å…¬å¼æè¿°çš„æ˜¯äº‹ä»¶(ç»“æœ)åœ¨ä¸åŒ$\theta$ä¸‹å‡ºç°çš„æ¦‚ç‡ï¼Œæ˜¯ä¼¼ç„¶å‡½æ•°åœ¨åé¢æå¤§ä¼¼ç„¶ä¼°è®¡ä¸­ï¼Œç”¨åˆ°çš„æ˜¯å°±æ˜¯ä¼¼ç„¶å‡½æ•°åœ¨ä¼¼ç„¶çš„æ„ä¹‰ä¸‹ï¼Œ$P(x \mid \theta)$è¿˜å¯ä»¥å†™æˆ$p\left(x_{i} ; \theta\right)$ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¸ºäº†ç‰¹åˆ«çš„åŒºåˆ†ä¼¼ç„¶å‡½æ•°å’Œæ¦‚ç‡å‡½æ•°ï¼Œéƒ½ä¼šé‡‡ç”¨åé¢çš„å†™æ³•é«˜æ–¯åˆ†å¸ƒç¬”è®°æ•´ç†è‡ªï¼šBilibiliç«™ä¸Šshuhuai008å¼ºåŠ¿æ‰‹æ¨è®²è§£çš„ç™½æ¿æ¨å¯¼CRFç³»åˆ—è¯¾ç¨‹ï¼Œè¯¾ç¨‹è´¨é‡å¾ˆé«˜ï¼Bç«™scywè¯»è€…æ•´ç†çš„ç¬”è®°é«˜æ–¯åˆ†å¸ƒåœ¨æœºå™¨å­¦ä¹ ä¸­å æœ‰ä¸¾è¶³è½»é‡çš„ä½œç”¨ï¼Œå°¤å…¶åœ¨ç»Ÿè®¡æœºå™¨å­¦ä¹ ä¸­ï¼Œæ¯”å¦‚çº¿æ€§é«˜æ–¯æ¨¡å‹çº¿æ€§é«˜æ–¯æ¨¡å‹æ˜¯ä¸€ä¸ªä½“ç³»ï¼Œæ¯”å¦‚å¡æ›¼æ»¤æ³¢ï¼Œéšå˜é‡æœä»çº¿æ€§é«˜æ–¯åˆ†å¸ƒï¼Œå³ï¼Œå…¶ä¸­æ˜¯ä¸€ä¸ªé«˜æ–¯å™ªå£°å…¶ä¸­ï¼Œç‹¬ç«‹åŒåˆ†å¸ƒäº$N(\mu, \Sigma)$å‚æ•°ä¼°è®¡é«˜æ–¯åˆ†å¸ƒä¸‹çš„MLEå¯ä»¥è¡¨è¿°ä¸ºè¿™é‡Œå…ˆå†™å‡ºä¸€ç»´çš„é«˜æ–¯åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°é«˜ç»´çš„é«˜æ–¯åˆ†å¸ƒå¯†åº¦å‡½æ•°ä¸ºä¸€ç»´æƒ…å†µå‡è®¾$p=1$ï¼Œ$\theta=(\mu, \sigma ^2)$ï¼Œå°†ä¸€ç»´é«˜æ–¯åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°å¸¦å…¥åˆ°MLEä¸­ï¼Œå¯ä»¥å¾—åˆ°æ±‚è§£$\mu$æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ±‚è§£å‚æ•°$\theta$ï¼Œè¿™é‡Œå…ˆæ±‚è§£$\mu$ï¼Œå¯ä»¥å¾—åˆ°å¯¹$\mu$æ±‚åå¯¼å¯ä»¥å¾—åˆ°è¿™é‡Œçš„$\mu$æ˜¯æ— åä¼°è®¡ï¼Œå› ä¸ºå¦‚æœå¯¹$\mu$æ±‚æœŸæœ›ï¼Œå¯ä»¥å¾—åˆ°æ±‚è§£$\Sigma$åŒç†å¯¹$\sigma$æ±‚åå¯¼ï¼Œå¯ä»¥å¾—åˆ°è¿™é‡Œçš„$\mu$å®é™…ä¸Šåº”è¯¥æ—¶$\mu _{MLE}$ï¼Œæ‰€ä»¥ç»§ç»­æ¨å¯¼å¯ä»¥å¾—åˆ°ä¸Šå¼ä¸­çš„$\mu$ä¸¥æ ¼æ„ä¹‰ä¸Šåº”è¯¥æ˜¯ï¼Œæ­¤æ—¶æ˜¯æœ‰åä¼°è®¡ï¼Œæˆ‘ä»¬å¯¹$\sigma_{M L E}^{2}$æ±‚æœŸæœ›å¯ä»¥å¾—åˆ°æ³¨æ„ä»¥ä¸Šå…¬å¼æ¨å¯¼ä¸­ç”¨åˆ°äº†ä»¥ä¸‹çš„å…¬å¼å˜æ¢å…¶ä¸­$E[x_i^2]-\mu^2 = Var(x_i)$çš„å˜æ¢è¿‡ç¨‹å¦‚ä¸‹$E[\mu {MLE}^2] - E^2[\mu {MLE}] = Var(\mu _{MLE})$çš„å˜æ¢è¿‡ç¨‹å¦‚ä¸‹$Var(\mu _{MLE}) = \frac {\sigma ^2}{N}$çš„å˜æ¢è¿‡ç¨‹å¦‚ä¸‹è‡³æ­¤å¯ä»¥çœ‹åˆ°æœ‰åä½“ç°åœ¨äº†$\frac {N-1}{N}$ï¼Œå…¶å®æ–¹å·®è¢«å¾€å°çš„æ–¹å‘ä¼°è®¡äº†ï¼Œå…¶ä¸­å› æ­¤çœŸå®çš„æ— åä¼°è®¡$\hat{\sigma}$åº”è¯¥æ˜¯å¤šç»´æƒ…å†µé«˜ç»´çš„é«˜æ–¯åˆ†å¸ƒé«˜ç»´çš„é«˜æ–¯åˆ†å¸ƒå¯†åº¦å‡½æ•°ä¸ºå…¶ä¸­$x \in \mathbb{R}^p$ï¼Œæ˜¯ä¸€ä¸ª$p$ç»´éšæœºå˜é‡ï¼Œ$\mu$ä¹Ÿæ˜¯$p$ç»´å˜é‡ï¼Œ$\Sigma$æ˜¯$p \times p$ç»´çš„çŸ©é˜µï¼Œä¸ºåæ–¹å·®çŸ©é˜µä¸€èˆ¬æƒ…å†µä¸‹$\Sigma$æ˜¯åŠæ­£å®šçš„ï¼Œå¹¶ä¸”æ˜¯å¯¹ç§°çš„ï¼Œè¿™é‡Œå‡è®¾$\Sigma$æ˜¯æ­£å®šçš„ï¼Œå³$\lambda \gt 0$ï¼Œæ–¹ä¾¿åé¢å™è¿°è¿™é‡Œ$(x-\mu)^{T} \Sigma^{-1}(x-\mu)$è®¡ç®—å‡ºæ¥çš„ç»“æœæ˜¯ä¸€ä¸ªæ•°ï¼Œå¯ä»¥çœ‹ä½œ$x$å’Œ$\mu$çš„é©¬æ°è·ç¦»é©¬æ°è·ç¦»ä¾‹å­è®¾æ­¤æ—¶é©¬æ°è·ç¦»ä¸ºå½“$\Sigma=I$ä¸ºå•ä½çŸ©é˜µæ—¶ï¼Œæ­¤æ—¶é©¬æ°è·ç¦»å°±å˜æˆäº†æ¬§æ°è·ç¦»ï¼Œå³åæ–¹å·®çŸ©é˜µè®¡ç®—å¯¹äºå¯¹ç§°çš„åæ–¹å·®çŸ©é˜µ$\Sigma$å¯è¿›è¡Œç‰¹å¾å€¼åˆ†è§£å…¶ä¸­$U = (u{1},u{2},\cdots,u_{p})$ï¼Œå¼€å§‹æ¨å¯¼åŒç†å¯ä»¥æ¨å¾—äºŒæ¬¡å‹æ¨å¯¼æ¥ä¸‹æ¥å¯¹äºŒæ¬¡å‹$\Delta=(x-\mu)^{T}\Sigma^{-1}(x-\mu)$è¿›è¡Œæ¨å¯¼ä»¤æ‰€ä»¥æœ‰é‚£ä¹ˆè¿™é‡Œçš„é©¬æ°è·ç¦»æ€ä¹ˆç†è§£å‘¢ï¼Œè¿™é‡Œå…ˆä»¤$p=2$è¿›è¡Œåˆ†æï¼Œæ­¤æ—¶è¿™é‡Œçš„1æ˜¯æˆ‘ä»¬ç»™å®šçš„ï¼Œæ­¤æ—¶è¡¨ç¤ºçš„ä¸€ä¸ªæ¤­åœ†å›¾(1)æ˜¯$(x-\mu)^{T} \Sigma^{-1}(x-\mu)=r$ä¸åŒå€¼çš„æƒ…å†µï¼Œå›¾(1)æ˜¯ä¸‰ç»´ä¸‹çš„ç¤ºä¾‹å›¾ï¼Œzè½´å–ä¸åŒå€¼è¡¨ç¤ºåœ¨xyè½´ä¸Šçš„æŠ•å½±ï¼Œä¹Ÿå°±æ˜¯å›¾(1)çš„æƒ…å†µå¦‚æœç‰¹å¾å€¼åˆ†è§£$\Sigma = U\Lambda U^{T}$ä¸­çš„$\Lambda=c$ï¼Œç­‰äºä¸€ä¸ªå¸¸é‡æ—¶ï¼Œå°±æ˜¯å›¾(3)çš„åœ†ï¼Œå½“$\Sigma$æ˜¯ä¸€ä¸ªå¯¹è§’çŸ©é˜µæ—¶ï¼Œæ¤­åœ†å°±å˜æˆäº†å›¾(3)ä¸­çš„æ¤­åœ†ï¼Œå³è½´å¹³è¡Œäºxyè½´å±€é™æ€§å‚æ•°å¤š$\Sigma_{p \times p}$çš„å‚æ•°çš„ä¸ªæ•°æ˜¯$p^2$ï¼Œç”±äºæ˜¯å¯¹ç§°çš„ï¼Œæ‰€ä»¥å‚æ•°çš„ä¸ªæ•°å‡å°‘çº¦ä¸€åŠï¼Œå˜ä¸ºäº†å³å‚æ•°ä¸ªæ•°ä¸º$O(p^2)$çº§åˆ«å› æ­¤éœ€è¦å¯¹åæ–¹å·®çŸ©é˜µåšç®€åŒ–åæ–¹å·®çŸ©é˜µä¸ºå¯¹è§’çŸ©é˜µæ—¶ï¼Œæ­¤æ—¶å°±ä¸éœ€è¦åšç‰¹å¾å€¼åˆ†è§£æ­¤æ—¶çš„æ¤­åœ†è½´å¹³è¡ŒäºåŸæ¥çš„è½´å¯¹è§’çŸ©é˜µï¼Œå¹¶å¯¹è§’å…ƒç´ éƒ½ç›¸ç­‰æ­¤æ—¶çš„æ¤­åœ†è½´ä¸ä»…å¹³è¡ŒäºåŸæ¥çš„è½´ï¼Œè¿˜å˜æˆäº†æ ‡å‡†çš„åœ†ï¼Œè¿™ç§æƒ…å†µè¢«ç§°ä¸ºå„å‘åŒæ€§åˆ†å¸ƒæ˜¯å•å³°çš„å•ä¸ªé«˜æ–¯åˆ†å¸ƒæ˜¯å•å³°çš„ï¼Œå¯¹æœ‰å¤šä¸ªå³°çš„æ•°æ®åˆ†å¸ƒä¸èƒ½å¾—åˆ°å¥½çš„ç»“æœï¼Œè§£å†³æ–¹æ¡ˆï¼šé«˜æ–¯æ··åˆGMMæ¨¡å‹</content>
	</entry>
	<entry>
		<title>æœºå™¨å­¦ä¹ _æ¦‚ç‡è®º</title>
		<url>/article/8271.html</url>
		<content>å†™åœ¨å‰é¢ï¼Œæœ¬ç³»åˆ—ä¸»è¦æ˜¯å¯¹ä¸‹é¢è¿™æœ¬ä¹¦åšçš„å­¦ä¹ ç¬”è®°å¸¸ç”¨æ•°å­¦ç¬¦å·çš„ LaTeX è¡¨ç¤ºæ–¹æ³•Markdown å¸¸ç”¨æ•°å­¦ç¬¦å·å’Œå…¬å¼éšæœºäº‹ä»¶ä¸æ¦‚ç‡æ¦‚ç‡è®ºåŒæ ·åœ¨æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ ä¸­æœ‰è‡³å…³é‡è¦çš„ä½œç”¨ã€‚å¦‚æœå°†æœºå™¨å­¦ä¹ ç®—æ³•çš„è¾“å…¥æ•°æ®å’Œè¾“å‡ºæ•°æ®çœ‹ä½œéšæœºå˜é‡ï¼Œåˆ™å¯ç”¨æ¦‚ç‡è®ºçš„æ–¹æ³•å¯¹æ•°æ®è¿›è¡Œè®¡ç®—ï¼Œä»¥æ­¤å¯¹ä¸ç¡®å®šæ€§è¿›è¡Œå»ºæ¨¡ä½¿ç”¨æ¦‚ç‡æ¨¡å‹ï¼Œå¯ä»¥è¾“å‡ºæ¦‚ç‡å€¼è€Œéç¡®å®šæ€§çš„å€¼ï¼Œè¿™å¯¹æŸäº›åº”ç”¨æ˜¯è‡³å…³é‡è¦çš„å¯¹äºæŸäº›åº”ç”¨é—®é¢˜ï¼Œéœ€è¦å¯¹å˜é‡ä¹‹é—´çš„æ¦‚ç‡ä¾èµ–å…³ç³»è¿›è¡Œå»ºæ¨¡ï¼Œä¹Ÿéœ€è¦æ¦‚ç‡è®ºçš„æŠ€æœ¯ï¼Œæ¦‚ç‡å›¾æ¨¡å‹æ˜¯å…¸å‹ä»£è¡¨éšæœºæ•°ç”Ÿæˆç®—æ³•ï¼Œå³é‡‡æ ·ç®—æ³•ï¼Œéœ€è¦ä»¥æ¦‚ç‡è®ºä½œä¸ºç†è®ºæŒ‡å¯¼æŸäº›éšæœºç®—æ³•ï¼Œå¦‚è’™ç‰¹å¡æ´›ç®—æ³•ã€é—ä¼ ç®—æ³•ï¼ŒåŒæ ·éœ€è¦ä»¥æ¦‚ç‡è®ºä½œä¸ºç†è®ºæˆ–å®ç°ä¾æ®ã€‚éšæœºäº‹ä»¶å’Œæ¦‚ç‡æ˜¯æ¦‚ç‡è®ºä¸­åŸºæœ¬çš„æ¦‚å¿µï¼Œä¹Ÿæ˜¯ç†è§£éšæœºå˜é‡çš„åŸºç¡€éšæœºäº‹ä»¶æ¦‚ç‡éšæœºäº‹ä»¶æ˜¯å¯èƒ½å‘ç”Ÿä¹Ÿå¯èƒ½ä¸å‘ç”Ÿçš„äº‹ä»¶ï¼Œè¿™ç§äº‹ä»¶æ¯æ¬¡å‡ºç°çš„ç»“æœå…·æœ‰ä¸ç¡®å®šæ€§ä¾‹å¦‚ï¼Œå¤©æ°”å¯èƒ½æ˜¯æ™´å¤©ã€é›¨å¤©ã€é˜´å¤©ï¼›è€ƒè¯•åˆ†æ•°å¯èƒ½ä¸º0ä¸100ä¹‹é—´çš„æ•´æ•°ï¼›æ·éª°å­ï¼Œ1åˆ°6è¿™å‡ ç§ç‚¹æ•°éƒ½å¯èƒ½å‡ºç°ä»¥é›†åˆè®ºä½œä¸ºå·¥å…·ï¼Œç»™å‡ºéšæœºäº‹ä»¶çš„å®šä¹‰å¯¹äºä¸€ä¸ªéšæœºè¯•éªŒï¼Œå…¶æ‰€æœ‰å¯èƒ½ç»“æœç»„æˆçš„é›†åˆç§°ä¸ºæ ·æœ¬ç©ºé—´è®°ä¸º$\Omega$éšæœºè¯•éªŒå¯èƒ½çš„ç»“æœç§°ä¸ºæ ·æœ¬ç‚¹ï¼Œè®°ä¸º$\omega$ï¼Œå®ƒæ˜¯æ ·æœ¬ç©ºé—´$\Omega$ä¸­çš„å…ƒç´ å¯¹äºå¤©æ°”ï¼Œæ ·æœ¬ç©ºé—´ä¸ºï¼Œæ¯ç§å¤©æ°”å‡ä¸ºä¸€ä¸ªæ ·æœ¬ç‚¹å¯¹äºè€ƒè¯•æˆç»©ï¼Œæ ·æœ¬ç©ºé—´ä¸ºï¼Œæ¯ä¸ªåˆ†æ•°å‡ä¸ºä¸€ä¸ªæ ·æœ¬ç‚¹å¯¹äºæ·éª°å­ï¼Œæ ·æœ¬ç©ºé—´ä¸ºç¦»æ•£äº‹ä»¶å’Œè¿ç»­äº‹ä»¶æ ·æœ¬ç©ºé—´å¯ä»¥æ˜¯æœ‰é™é›†ï¼Œä¹Ÿå¯ä»¥æ˜¯æ— é™é›†å¯¹äºæ— é™çš„æ ·æœ¬ç©ºé—´ï¼Œå¯ä»¥æ˜¯å¯æ•°é›†(ç¦»æ•£çš„)ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸å¯æ•°é›†(è¿ç»­çš„)æœ‰é™æ ·æœ¬ç©ºé—´ä¸æ— é™å¯æ•°æ ·æœ¬ç©ºé—´ä¸­å®šä¹‰çš„éšæœºäº‹ä»¶ç§°ä¸ºç¦»æ•£å‹æ— é™å¯æ•°æ ·æœ¬ç©ºé—´: æŠ›ä¸€æšç¡¬å¸ï¼Œå¦‚æœä»¤$n$ä¸ºç¬¬ä¸€æ¬¡å‡ºç°æ­£é¢æ—¶æ‰€è¯•éªŒçš„æ¬¡æ•°ï¼Œåˆ™å…¶å–å€¼ä¸º$[1,+\infty)$å†…çš„æ•´æ•°è¿™ç§æƒ…å†µçš„æ ·æœ¬ç©ºé—´æ˜¯æ— é™å¯æ•°é›†ï¼Œå¦‚æœè®°äº‹ä»¶$A_{n}$ä¸ºç›´åˆ°æ‰”åˆ°ç¬¬$n$æ¬¡æ‰ç¬¬ä¸€æ¬¡å‡ºç°æ­£é¢æœä¸Šï¼Œåˆ™è¿™æ ·çš„äº‹ä»¶æœ‰æ— ç©·å¤šä¸ªæ— é™ä¸å¯æ•°æ ·æœ¬ç©ºé—´: åœ¨åŒºé—´$[0,1]$å†…éšæœºæ‰”ä¸€ä¸ªç‚¹ï¼Œè¿™ä¸ªç‚¹çš„å–å€¼ä¸ºæ­¤åŒºé—´å†…æ‰€æœ‰å®æ•°ï¼Œæ˜¯æ— é™ä¸å¯æ•°é›†æ­¤æ—¶, æˆ‘ä»¬æ— æ³•å°†æ ·æœ¬ç©ºé—´ä¸­æ‰€æœ‰çš„æ ·æœ¬ç‚¹åˆ—å‡ºæ ·æœ¬ç©ºé—´$\Omega$ å…ƒç´ æ„æˆçš„é›†åˆç§°ä¸ºéšæœºäº‹ä»¶ï¼Œé€šå¸¸ç”¨å¤§å†™æ–œä½“å­—æ¯è¡¨ç¤ºï¼Œå¦‚è®°ä¸º$A$æ˜¾ç„¶$\Omega$ä¹Ÿæ˜¯éšæœºæœ¬ä»¶ï¼Œå®ƒä¸€å®šä¼šå‘ç”Ÿï¼Œç§°ä¸ºå¿…ç„¶äº‹ä»¶ï¼›ç©ºé›†$\varnothing$åˆ™ä¸å¯èƒ½å‘ç”Ÿï¼Œç§°ä¸ºä¸å¯èƒ½äº‹ä»¶è¡¡é‡éšæœºäº‹ä»¶çš„å¯èƒ½æ€§éšæœºäº‹ä»¶å‘ç”Ÿçš„å¯èƒ½æ€§ç”¨æ¦‚ç‡è¿›è¡Œåº¦é‡ï¼Œéšæœºäº‹ä»¶$A$å‘ç”Ÿçš„æ¦‚ç‡è®°ä¸º$p(A)$ï¼Œè¡¨ç¤ºæ­¤äº‹ä»¶å‘ç”Ÿçš„å¯èƒ½æ€§ï¼Œå…¶å€¼æ»¡è¶³æ¦‚ç‡å€¼è¶Šå¤§åˆ™äº‹ä»¶è¶Šå¯èƒ½å‘ç”Ÿã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå‡è®¾æ ·æœ¬ç©ºé—´ä¸­æ¯ä¸ªæ ·æœ¬ç‚¹å‘ç”Ÿçš„æ¦‚ç‡æ˜¯ç›¸ç­‰çš„(ç§°ä¸ºç­‰æ¦‚ç‡å‡è®¾)å› æ­¤äº‹ä»¶$A$å‘ç”Ÿçš„æ¦‚ç‡æ˜¯è¯¥é›†åˆçš„åŸºæ•°ä¸æ•´ä¸ªæ ·æœ¬ç©ºé—´åŸºæ•°çš„æ¯”å€¼:æ ¹æ®å®šä¹‰ï¼Œæ‰€æœ‰å•ä¸ªæ ·æœ¬ç‚¹æ„æˆçš„éšæœºäº‹ä»¶çš„æ¦‚ç‡ä¹‹å’Œä¸ºå…¶ä¸­ä¸ºæ ·æœ¬ç©ºé—´ä¸­æ‰€æœ‰å•ä¸ªæ ·æœ¬ç‚¹æ„æˆçš„éšæœºäº‹ä»¶å¯¹äºæœ‰é™æ ·æœ¬ç©ºé—´ä¸­çš„éšæœºäº‹ä»¶ï¼Œå¯ç›´æ¥æ ¹æ®é›†åˆçš„åŸºæ•°è®¡ç®—çš„æ¦‚ç‡å€¼æŠ›ç¡¬å¸é—®é¢˜: è®°æ­£é¢æœä¸Šä¸ºäº‹ä»¶$A$ï¼Œåé¢æœä¸Šä¸ºäº‹ä»¶$B$ï¼Œåˆ™æœ‰$p(A)=p(B)=\frac{1}{2}$è¡¨ç¤ºæ­£é¢æœä¸Šå’Œåé¢æœä¸Šçš„æ¦‚ç‡æ˜¯ç›¸ç­‰çš„æ·éª°å­é—®é¢˜: è®°äº‹ä»¶$A$ä¸ºå‡ºç°çš„ç‚¹æ•°ä¸º 1 , åˆ™æœ‰$p(A)=\frac{1}{6}$1è‡³6ç‚¹å‡ºç°çš„æ¦‚ç‡ç›¸ç­‰ï¼Œå‡ä¸º$\frac{1}{6}$ æ˜¾ç„¶ï¼Œä¸å¯èƒ½äº‹ä»¶å‘ç”Ÿçš„æ¦‚ç‡ä¸º0ï¼›å¿…ç„¶äº‹ä»¶å‘ç”Ÿçš„æ¦‚ç‡ä¸º1ä¸¤ä¸ªéšæœºäº‹ä»¶å¯¹åº”é›†åˆçš„äº¤è¿ç®—ä¸å¹¶è¿ç®—ï¼Œå¯ä»¥å®šä¹‰ä¸¤ä¸ªéšæœºäº‹ä»¶åŒæ—¶å‘ç”Ÿçš„æ¦‚ç‡ï¼Œä»¥åŠä¸¤ä¸ªéšæœºäº‹ä»¶è‡³å°‘æœ‰ä¸€ä¸ªå‘ç”Ÿçš„æ¦‚ç‡ğŸä¸¤ä¸ªéšæœºäº‹ä»¶$A$å’Œ$B$åŒæ—¶å‘ç”Ÿå³ä¸ºå®ƒä»¬çš„äº¤é›†ï¼Œè®°ä¸º$A \cap B$ï¼Œå…¶æ¦‚ç‡ä¸ºä»¥æ·éª°å­ä¸ºä¾‹ï¼Œè®°$A$ä¸ºå‡ºç°çš„ç‚¹æ•°ä¸ºå¥‡æ•°ï¼Œ$B$ä¸ºå‡ºç°çš„ç‚¹æ•°ä¸è¶…è¿‡3ï¼Œåˆ™æœ‰ä¸¤ä¸ªäº‹ä»¶åŒæ—¶å‘ç”Ÿçš„æ¦‚ç‡ä¹Ÿå¯ä»¥ç®€è®°ä¸º$p(A, B)$ å¯ä»¥å°†ä¸¤ä¸ªäº‹ä»¶åŒæ—¶å‘ç”Ÿçš„æ¦‚ç‡æ¨å¹¿åˆ°å¤šä¸ªäº‹ä»¶å¦‚æœä¸¤ä¸ªéšæœºäº‹ä»¶æ»¡è¶³$A \cap B=\varnothing$åˆ™ç§°ä¸ºäº’ä¸ç›¸å®¹äº‹ä»¶ï¼Œå³ä¸¤ä¸ªäº‹ä»¶ä¸å¯èƒ½åŒæ—¶å‘ç”Ÿï¼Œå› æ­¤äº’ä¸ç›¸å®¹äº‹ä»¶åŒæ—¶å‘ç”Ÿçš„æ¦‚ç‡ä¸º0ğŸ’ä¸¤ä¸ªéšæœºäº‹ä»¶$A$å’Œ$B$è‡³å°‘æœ‰ä¸€ä¸ªå‘ç”Ÿå³ä¸ºå®ƒä»¬çš„å¹¶é›†ï¼Œè®°ä¸º$A \cup B$ç§°ä¸ºåŠ æ³•å…¬å¼ï¼Œä¸¤ä¸ªé›†åˆçš„å¹¶é›†å…ƒç´ æ•°ç­‰äºå®ƒä»¬å…ƒç´ æ•°ä¹‹å’Œå‡æ‰å®ƒä»¬é‡å¤çš„éƒ¨åˆ†å› ä¸ºé‡å¤çš„éƒ¨åˆ†è¢«ç®—äº†ä¸¤æ¬¡ï¼Œæ‰€ä»¥æœ‰è€ƒè™‘æ‹¼éª°å­é—®é¢˜ï¼Œå®šä¹‰äº‹ä»¶$A$ä¸ºç‚¹æ•°å¤§äºæˆ–ç­‰äº2ï¼Œå®šä¹‰äº‹ä»¶$B$ä¸ºç‚¹æ•°å°äºæˆ–ç­‰äº4å› æ­¤æœ‰$p(A \cup B)=\frac{6}{6}=1$å¦‚æœç”¨åŠ æ³•å…¬å¼è¿›è¡Œè®¡ç®—ï¼Œåˆ™æœ‰å¦‚æœä¸¤ä¸ªäº‹ä»¶$A$å’Œ$B$æ˜¯äº’ä¸ç›¸å®¹çš„ï¼Œåˆ™åŠ æ³•å…¬å¼å˜ä¸ºè¿™ä¸€ç»“è®ºå¯ä»¥æ¨å¹¿åˆ°å¤šä¸ªéšæœºäº‹ä»¶çš„æƒ…å†µå®Œå¤‡äº‹ä»¶ç»„å®Œå¤‡äº‹ä»¶ç»„æ˜¯å¯¹æ ·æœ¬ç©ºé—´çš„ä¸€ä¸ªåˆ’åˆ†ï¼Œæ˜¾ç„¶ï¼Œå¯¹äºå®Œå¤‡äº‹ä»¶ç»„ï¼Œæœ‰è€ƒè™‘é›†åˆçš„è¡¥è¿ç®—ï¼Œå¯¹åº”äºå¯¹ç«‹äº‹ä»¶ï¼Œäº‹ä»¶$A$çš„è¡¥é›†ç§°ä¸ºå®ƒçš„å¯¹ç«‹äº‹ä»¶ï¼Œè®°ä¸º$\bar{A}$ï¼Œå³$A$ä¸å‘ç”Ÿï¼Œæ˜¾ç„¶æœ‰å¯¹äºæ·ç¾–å­é—®é¢˜ï¼Œå¦‚æœè®°$A$ä¸ºå‡ºç°çš„ç‚¹æ•°ä¸ºå¶æ•°ï¼Œåˆ™å…¶å¯¹ç«‹äº‹ä»¶ä¸ºå‡ºç°çš„ç‚¹æ•°ä¸ºå¥‡æ•°ï¼Œå› ä¸ºç‚¹æ•°ä¸æ˜¯å¶æ•°å°±æ˜¯å¥‡æ•°è€ƒè™‘æ— é™å¯æ•°çš„æ ·æœ¬ç©ºé—´: åšä¸€ä¸ªè¯•éªŒï¼Œæ¯æ¬¡æˆåŠŸçš„æ¦‚ç‡ä¸º$p$ï¼Œå‡è®¾å„æ¬¡è¯•éªŒä¹‹é—´æ— å…³ï¼Œäº‹ä»¶$A_{n}$å®šä¹‰ä¸ºè¯•éªŒ$n$æ¬¡æ‰å–å¾—ç¬¬ä¸€æ¬¡æˆåŠŸï¼Œå³å‰é¢$n-1$æ¬¡éƒ½å¤±è´¥ï¼Œç¬¬$n$æ¬¡æˆåŠŸï¼Œæ˜¾ç„¶ï¼Œæ•´ä¸ªæ ·æœ¬ç©ºé—´ä¸ºå¯ä»¥å¾—åˆ°æ¦‚ç‡å€¼å…¶ä¸­$(1-p)^{n-1}$æ˜¯å‰é¢$n-1$æ¬¡éƒ½å¤±è´¥çš„æ¦‚ç‡ï¼Œ$p$æ˜¯ç¬¬$n$æ¬¡æ—¶æˆåŠŸçš„æ¦‚ç‡ï¼Œæ˜¾ç„¶æœ‰æ»¡è¶³æ‰€æœ‰åŸºæœ¬äº‹ä»¶çš„æ¦‚ç‡ä¹‹å’Œä¸º1çš„è¦æ±‚ï¼Œè¿™é‡Œåˆ©ç”¨äº†ä¸‹é¢çš„å¹‚çº§æ•°æ±‚å’Œç»“æœå‡ ä½•å‹æ¦‚ç‡å‰é¢ä»‹ç»çš„æ¦‚ç‡å‡é’ˆå¯¹æœ‰é™çš„æˆ–æ— é™å¯æ•°çš„æ ·æœ¬ç©ºé—´ï¼Œä¸‹é¢ä»‹ç»æ— é™ä¸å¯æ•°æ ·æœ¬ç©ºé—´æ¦‚ç‡çš„è®¡ç®—ï¼Œç§°ä¸ºå‡ ä½•å‹æ¦‚ç‡å‡ ä½•å‹æ¦‚ç‡å®šä¹‰åœ¨æ— é™ä¸å¯æ•°é›†ä¸Šï¼Œæ ¹æ®ç§¯åˆ†å€¼(ä¹Ÿç§°ä¸ºæµ‹åº¦å€¼ï¼Œå¦‚é•¿åº¦ã€é¢ç§¯ã€ä½“ç§¯)å®šä¹‰äº‹ä»¶$A$å‘ç”Ÿçš„æ¦‚ç‡ä¸ºåŒºåŸŸ$A$çš„æµ‹åº¦å€¼ä¸$\Omega$æµ‹åº¦å€¼çš„æ¯”å€¼ï¼Œå³å…¶ä¸­$s(A)$ä¸ºé›†åˆ$A$çš„æµ‹åº¦è¿™é‡ŒåŒæ ·å‡è®¾è½åœ¨åŒºåŸŸå†…ä»»æ„ç‚¹å¤„çš„å¯èƒ½æ€§ç›¸ç­‰ï¼ŒåŒæ—¶ä¿è¯æ•´ä¸ªæ ·æœ¬ç©ºé—´çš„æ¦‚ç‡ä¸º1ä¸€ç»´å‡ ä½•åœ¨$[0,1]$åŒºé—´å†…éšæœºæ‰”ä¸€ä¸ªç‚¹ï¼Œè®¡ç®—è¯¥ç‚¹è½åœ¨$[0,0.7]$å†…çš„æ¦‚ç‡å‡è®¾ç‚¹çš„åæ ‡ä¸º$x$ï¼Œè½åœ¨åŒºé—´$[0,0.7]$å†…ï¼Œå³$0 \leqslant x \leqslant 0.7$ï¼Œç”±äºè½åœ¨åŒºé—´ä¸­ä»»æ„ç‚¹å¤„çš„å¯èƒ½æ€§ç›¸ç­‰ï¼Œå› æ­¤æ¦‚ç‡å€¼ä¸ºæ˜¯çŸ­çº¿æ®µä¸é•¿çº¿æ®µçš„é•¿åº¦ä¹‹æ¯”äºŒç»´å‡ ä½•æ¨å¹¿åˆ°äºŒç»´çš„æƒ…å†µï¼Œå¯ç”¨é¢ç§¯è®¡ç®—æ¦‚ç‡åœ¨å•ä½æ­£æ–¹å½¢$0 \leqslant x, y \leqslant 1$å†…éƒ¨éšæœºåœ°æ‰”ä¸€ä¸ªç‚¹ï¼Œè®¡ç®—è¯¥ç‚¹è½åœ¨åŒºåŸŸ$x \leqslant 0.2, y \leqslant 0.3$å†…çš„æ¦‚ç‡ç”±äºè½åœ¨ä»»æ„ç‚¹å¤„çš„å¯èƒ½æ€§ç›¸ç­‰ï¼Œå› æ­¤æ˜¯ä¸¤ä¸ªçŸ©å½¢åŒºåŸŸçš„é¢ç§¯ä¹‹æ¯”è€ƒè™‘ä¸€ä¸ªæ›´å¤æ‚çš„ä¾‹å­ï¼Œåœ¨åœ†å‘¨ä¸Šéšæœºé€‰æ‹©ä¸¤ä¸ªç‚¹ï¼Œè®¡ç®—è¿™ä¸¤ä¸ªç‚¹ä¸åœ†å¿ƒçš„è¿çº¿ä¹‹é—´æ²¿ç€é€†æ—¶é’ˆæ–¹å‘çš„å¤¹è§’æ˜¯é”è§’çš„æ¦‚ç‡å‡è®¾ç‚¹è½åœ¨åœ†å‘¨ä¸Šä»»æ„ä½ç½®å¤„çš„å¯èƒ½æ€§ç›¸ç­‰å¦‚å›¾æ‰€ç¤ºï¼Œå‡è®¾åœ†å‘¨ä¸Šçš„ä¸¤ä¸ªç‚¹ $A ã€ B$ ä¸åœ†å¿ƒçš„è¿çº¿å’Œ$x$è½´æ­£åŠè½´çš„å¤¹è§’(æŒ‰ç…§é€†æ—¶é’ˆæ–¹å‘è®¡ç®—)åˆ†åˆ«ä¸ºä¸æ˜¾ç„¶æœ‰ï¼Œè¿™é‡Œé‡‡ç”¨å¼§åº¦ä½œä¸ºè®¡é‡å•ä½ä¸¤ä¸ªç‚¹ä¸åœ†å¿ƒçš„è¿çº¿ä¹‹é—´çš„å¤¹è§’ä¸ºï¼Œå¤¹è§’ä¸ºé”è§’ï¼Œå³ï¼Œè¿™ç­‰ä»·äºå¤¹è§’ä¸ºé”è§’çš„åŒºåŸŸä¸ºç›´çº¿ä¹‹ä¸‹ã€ç›´çº¿ä¹‹ä¸Šçš„åŒºåŸŸï¼Œå› æ­¤æ˜¯å¤¹åœ¨è¿™ä¸¤æ¡ç›´çº¿ä¹‹é—´çš„åŒºåŸŸï¼Œä¸¤ç‚¹ä¹‹é—´é€†æ—¶é’ˆæ–¹å‘å¤¹è§’ä¸ºé”è§’çš„æ¦‚ç‡ä¸ºä¸‰ç»´å‡ ä½•å¯¹äºä¸‰ç»´çš„æƒ…å†µï¼Œå¯ç”¨ä½“ç§¯å€¼æ¥è®¡ç®—æ¦‚ç‡å€¼ï¼Œå¯¹äºæ›´é«˜ç»´çš„æƒ…å†µï¼Œåˆ™å€ŸåŠ©å¤šé‡ç§¯åˆ†çš„å€¼è¿›è¡Œè®¡ç®—æ¡ä»¶æ¦‚ç‡æ¡ä»¶æ¦‚ç‡ä¸»è¦æè¿°çš„æ˜¯å¤šä¸ªéšæœºä»¶çš„æ¦‚ç‡å…³ç³»æ¡ä»¶æ¦‚ç‡å®šä¹‰å¯¹äºéšæœºäº‹ä»¶$A$å’Œ$B$ï¼Œåœ¨$A$å‘ç”Ÿçš„æ¡ä»¶ä¸‹$B$å‘ç”Ÿçš„æ¦‚ç‡ç§°ä¸º(æ¡ä»¶æ¦‚ç‡)ï¼Œè®°ä¸º$p(B \mid A)$å¦‚æœäº‹ä»¶$A$çš„æ¦‚ç‡å¤§äº0ï¼Œåˆ™æ¡ä»¶æ¦‚ç‡å¯æŒ‰ä¸‹å¼è®¡ç®—æ ¹æ®å®šä¹‰ï¼Œæ¡ä»¶æ¦‚ç‡æ˜¯$A$å’Œ$B$åŒæ—¶å‘ç”Ÿçš„æ¦‚ç‡ä¸$A$å‘ç”Ÿçš„æ¦‚ç‡çš„æ¯”å€¼æ¡ä»¶æ¦‚ç‡è®¡ç®—çš„ä¾‹å­ä¸‹é¢ç”¨ä¸€ä¸ªä¾‹å­è¯´æ˜æ¡ä»¶æ¦‚ç‡çš„è®¡ç®—å¯¹äºæ·éª°å­é—®é¢˜ï¼Œå‡è®¾äº‹ä»¶$A$ä¸ºç‚¹æ•°æ˜¯å¥‡æ•°ï¼Œäº‹ä»¶$B$ä¸ºç‚¹æ•°å°äºæˆ–ç­‰äº3ï¼Œåˆ™äºŒè€…çš„æ¡ä»¶æ¦‚ç‡ä¸ºç±»ä¼¼åœ°ï¼Œæœ‰å¯¹æ¡ä»¶æ¦‚ç‡å…¬å¼è¿›è¡Œå˜å½¢ï¼Œå¯ä»¥å¾—åˆ°ä¹˜æ³•å…¬å¼ä¸¤ä¸ªä»¥ä¸Šçš„éšæœºäº‹ä»¶ä¸‹çš„æ¡ä»¶æ¦‚ç‡å°†æ¡ä»¶æ¦‚ç‡æ¨å¹¿åˆ°ä¸¤ä¸ªä»¥ä¸Šçš„éšæœºäº‹ä»¶ï¼Œå¯¹äºä¸¤ç»„éšæœºäº‹ä»¶ä¸, å®ƒä»¬çš„æ¡ä»¶æ¦‚ç‡å®šä¹‰ä¸ºå°†ä¹˜æ³•å…¬å¼æ¨å¹¿åˆ° 3 ä¸ªéšæœºäº‹ä»¶ï¼Œå¯ä»¥å¾—åˆ°éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ç§åˆ†è§£çš„é¡ºåºä¸æ˜¯å”¯ä¸€çš„ï¼Œæ¨å¹¿åˆ°$n$ä¸ªéšæœºäº‹ä»¶ï¼Œæœ‰éšæœºäº‹ä»¶çš„ç‹¬ç«‹æ€§å¦‚æœ$p(B \mid A)=p(B)$ï¼Œæˆ–$p(A \mid B)=p(A)$ï¼Œåˆ™ç§°éšæœºäº‹ä»¶$A$å’Œ$B$ç‹¬ç«‹éšæœºäº‹ä»¶ç‹¬ç«‹æ„å‘³ç€ä¸€ä¸ªäº‹ä»¶æ˜¯å¦å‘ç”Ÿå¹¶ä¸å½±å“å¦å¤–ä¸€ä¸ªäº‹ä»¶å¦‚æœéšæœºäº‹ä»¶$A$å’Œ$B$ç‹¬ç«‹ï¼Œæ ¹æ®å¼ (5.4), æœ‰å°†ä¸Šé¢çš„å®šä¹‰è¿›è¡Œæ¨å¹¿ï¼Œå¦‚æœ$n$ä¸ªéšæœºäº‹ä»¶$A_{i}, i=1, \cdots, n$ ç›¸äº’ç‹¬ç«‹ï¼Œåˆ™å¯¹æ‰€æœ‰å¯èƒ½çš„ç»„åˆ$1 \leqslant i&lt;j&lt;k&lt;\cdots \leqslant n$ï¼Œéƒ½æœ‰å…¨æ¦‚ç‡å…¬å¼å®šä¹‰å¦‚æœéšæœºäº‹ä»¶æ˜¯ä¸€ä¸ªå®Œå¤‡äº‹ä»¶ç»„ï¼Œä¸”ï¼Œæ˜¯ä»»æ„éšæœºäº‹ä»¶ï¼Œåˆ™æœ‰ç§°ä¸ºå…¨æ¦‚ç‡å…¬å¼ï¼Œå€ŸåŠ©äºæ¡ä»¶æ¦‚ç‡ï¼Œå…¨æ¦‚ç‡å…¬å¼å°†å¯¹å¤æ‚äº‹ä»¶çš„æ¦‚ç‡è®¡ç®—é—®é¢˜è½¬åŒ–ä¸ºåœ¨ä¸åŒæƒ…å†µä¸‹å‘ç”Ÿçš„ç®€å•äº‹ä»¶çš„æ¦‚ç‡çš„æ±‚å’Œé—®é¢˜ä¾‹å­ç®±å­çº¢çƒç™½çƒç®±å­164ç®±å­255ç®±å­328å…ˆéšæœºæŠ½å–ä¸€ä¸ªç®±å­ï¼Œç„¶åä»ä¸­éšæœºæŠ½å–ä¸€ä¸ªçƒï¼Œè®¡ç®—æŠ½ä¸­çº¢çƒçš„æ¦‚ç‡ä»¤$A_{i}$ä¸ºæŠ½ä¸­ç¬¬$i$ä¸ªç®±å­ï¼Œ$B$ä¸ºæŠ½ä¸­çº¢çƒæ ¹æ®å…¨æ¦‚ç‡å…¬å¼ï¼Œæœ‰è´å¶æ–¯å…¬å¼è´å¶æ–¯å…¬å¼ç”±æ•°å­¦å®¶è´å¶æ–¯(Bayes)æå‡ºï¼Œå®ƒé˜æ˜äº†éšæœºäº‹ä»¶ä¹‹é—´çš„å› æœæ¦‚ç‡å…³ç³»ï¼Œæ ¹æ®æ¡ä»¶æ¦‚ç‡çš„å®šä¹‰ï¼Œæœ‰å˜å½¢å¯å¾—è´å¶æ–¯å…¬å¼å…ˆåéªŒå’Œä¼¼ç„¶å‡½æ•°å®ƒæè¿°äº†å…ˆéªŒæ¦‚ç‡å’ŒåéªŒæ¦‚ç‡ä¹‹é—´çš„å…³ç³»ï¼Œå¦‚æœäº‹ä»¶$A$æ˜¯å› ï¼Œäº‹ä»¶ä»¶$B$æ˜¯æœå…ˆéªŒæ¦‚ç‡: ç§°$p(A)$ä¸ºå…ˆéªŒæ¦‚ç‡(Prior Probability)ï¼Œæ„ä¸ºäº‹å…ˆå·²ç»çŸ¥é“å…¶å€¼åéªŒæ¦‚ç‡: $p(A \mid B)$ ç§°ä¸ºåéªŒæ¦‚ç‡(Posterior Probability)ï¼Œæ„ä¸ºäº‹åæ‰çŸ¥é“å…¶å€¼ä¼¼ç„¶å‡½æ•°: æ¡ä»¶æ¦‚ç‡$p(B \mid A)$åˆ™ç§°ä¸ºä¼¼ç„¶å‡½æ•°å…ˆéªŒæ¦‚ç‡æ˜¯æ ¹æ®ä»¥å¾€ç»éªŒå’Œåˆ†æå¾—åˆ°çš„æ¦‚ç‡ï¼Œåœ¨éšæœºäº‹ä»¶å‘ç”Ÿä¹‹å‰å·²ç»çŸ¥é“ï¼Œæ˜¯åŸå› å‘ç”Ÿçš„æ¦‚ç‡åéªŒæ¦‚ç‡æ˜¯æ ¹æ®ç»“æœä¿¡æ¯æ‰€è®¡ç®—å‡ºçš„å¯¼è‡´è¯¥ç»“æœçš„åŸå› æ‰€å‡ºç°çš„æ¦‚ç‡åéªŒæ¦‚ç‡ç”¨äºåœ¨äº‹æƒ…å·²ç»å‘ç”Ÿçš„æ¡ä»¶ä¸‹ï¼Œåˆ†æä½¿å¾—è¿™ä»¶äº‹æƒ…å‘ç”Ÿçš„åŸå› æ¦‚ç‡æ ¹æ®è´å¶æ–¯å…¬å¼å¯ä»¥å®ç°è¿™ç§å› æœæ¨ç†ï¼Œè¿™åœ¨æœºå™¨å­¦ä¹ ä¸­æ˜¯å¸¸ç”¨çš„ä¼¼ç„¶å‡½æ•°ä¸æ¦‚ç‡ç»™å®šè”åˆæ ·æœ¬å€¼$x$å…³äº$\theta$çš„å‡½æ•°å…¶ä¸­$f(x|\theta)$æ˜¯å¯†åº¦å‡½æ•°ï¼Œè¡¨ç¤ºç»™å®š$\theta$ä¸‹çš„è”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°ï¼Œè€Œä¼¼ç„¶å‡½æ•°çš„å…³äº$\theta$çš„å‡½æ•°ï¼Œå¯†åº¦å‡½æ•°æ˜¯å…³äº$x$çš„æ¦‚ç‡è¡¨è¾¾äº†åœ¨ç»™å®šå‚æ•°$\theta$ä¸‹$X=x$çš„å¯èƒ½æ€§ï¼Œè€Œä¼¼ç„¶è¡¨ç¤ºçš„æ˜¯ç»™å®šæ ·æœ¬$X=x$æ—¶ï¼Œå‚æ•°çš„å¯èƒ½æ€§å¦‚æœä¸‹å¼æˆç«‹ï¼Œåˆ™è¡¨ç¤ºå‚æ•°$\theta_1$ä¸‹éšæœºå˜é‡$X$å–åˆ°$x$å€¼çš„å¯èƒ½æ€§å¤§äº$\theta_2$ ä¸€ä¸ªå½¢è±¡çš„ä¼¼ç„¶ä¾‹å­æ˜¯ï¼ŒNBAæ€»å†³èµ›æ—¶ï¼Œå·²çŸ¥çƒè¿›äº†ï¼Œé—®è°å»æŠ•çƒçš„å¯èƒ½æ€§å¤§å…¨æ¦‚ç‡å…¬å¼ä¸è´å¶æ–¯å…¬å¼å¦‚æœäº‹ä»¶æ„æˆä¸€ä¸ªå®Œå¤‡äº‹ä»¶ç»„ï¼Œä¸”ï¼Œæ ¹æ®å…¨æ¦‚ç‡å…¬å¼ä¸è´å¶æ–¯å…¬å¼ï¼Œå¯ä»¥å¾—åˆ°ä¾‹å­ç®±å­çº¢çƒé»‘çƒç®±å­155ç®±å­273ç®±å­391é¦–å…ˆéšæœºåœ°æŠ½å–ä¸€ä¸ªç®±å­ï¼Œç„¶åä»ä¸­éšæœºæŠ½å–ä¸€ä¸ªçƒï¼Œå¦‚æœæŠ½ä¸­çš„æ˜¯çº¢çƒï¼Œè®¡ç®—è¿™ä¸ªçƒæ¥è‡ªæ¯ä¸ªç®±å­çš„æ¦‚ç‡ä»¤$A_{i}, i=1,2,3$è¡¨ç¤ºæŠ½ä¸­ç¬¬$i$ä¸ªç®±å­ï¼Œ$B$è¡¨ç¤ºæŠ½ä¸­çº¢çƒåˆ™è¿™ä¸ªçº¢çƒæ¥è‡ªç¬¬1ä¸ªç®±å­çš„æ¦‚ç‡ä¸ºæ¥è‡ªç¬¬2ä¸ªç®±å­çš„æ¦‚ç‡ä¸ºæ¥è‡ªç¬¬3ä¸ªç®±å­çš„æ¦‚ç‡ä¸ºæ¡ä»¶ç‹¬ç«‹å®šä¹‰å°†éšæœºäº‹ä»¶çš„ç‹¬ç«‹æ€§ä¸æ¡ä»¶æ¦‚ç‡ç›¸ç»“åˆï¼Œå¯ä»¥å¾—åˆ°æ¡ä»¶ç‹¬ç«‹çš„æ¦‚å¿µå¦‚æœéšæœºäº‹ä»¶$A, B, C$æ»¡è¶³$p(A \mid B, C)=p(A \mid C)$ï¼Œåˆ™ç§°$A$å’Œ$B$å…³äºäº‹ä»¶$C$æ¡ä»¶ç‹¬ç«‹ç›´è§‚å«ä¹‰æ˜¯åœ¨$C$å‘ç”Ÿçš„æƒ…å†µä¸‹ï¼Œ$B$æ˜¯å¦å‘ç”Ÿå¹¶ä¸å½±å“$A$ï¼Œå®ƒä»¬ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œè¿™æ„å‘³ç€äº‹ä»¶$C$çš„å‘ç”Ÿä½¿å¾—$A$å’Œ$B$ç›¸äº’ç‹¬ç«‹$A$å’Œ$B$å…³äº$C$æ¡ä»¶ç‹¬ç«‹å¯ä»¥è®°ä¸º$A \perp B \mid C$ï¼Œæ¡ä»¶ç‹¬ç«‹çš„æ¦‚å¿µåœ¨æ¦‚ç‡å›¾æ¨¡å‹ä¸­è¢«å¹¿æ³›ä½¿ç”¨éšæœºå˜é‡æ™®é€šçš„å˜é‡åªå…è®¸å–å€¼å¯å˜ï¼Œéšæœºå˜é‡(Random Variable)æ˜¯å–å€¼å¯å˜å¹¶ä¸”å–æ¯ä¸ªå€¼éƒ½æœ‰ä¸€ ä¸ªæ¦‚ç‡çš„å˜é‡ä»å¦å¤–ä¸€ä¸ªè§’åº¦æ¥çœ‹ï¼Œéšæœºå˜é‡æ˜¯ç”¨äºè¡¨ç¤ºéšæœºè¯•éªŒç»“æœçš„å˜é‡éšæœºå˜é‡é€šå¸¸ç”¨å¤§å†™æ–œä½“å­—æ¯è¡¨ç¤ºï¼Œå¦‚$X$ï¼Œ éšæœºå˜é‡çš„å–å€¼ä¸€èˆ¬ç”¨å°å†™æ–œä½“å­—æ¯è¡¨ç¤ºï¼Œå¦‚$x_{i}$ï¼Œéšæœºå˜é‡å¯åˆ†ä¸ºç¦»æ•£å‹å’Œè¿ç»­å‹ä¸¤ç§ç¦»æ•£å‹: å–å€¼é›†åˆä¸ºæœ‰é™é›†æˆ–è€…æ— é™å¯æ•°é›†ï¼Œå¯¹åº”ç¦»æ•£å‹éšæœºäº‹ä»¶è¿ç»­å‹: å–å€¼é›†åˆä¸ºæ— é™ä¸å¯æ•°é›†, å¯¹åº”å‡ ä½•å‹éšæœºäº‹ä»¶éšæœºå˜é‡ç›¸å…³æ¦‚å¿µé¢‘ç‡åˆ†å¸ƒç›´æ–¹å›¾ä¸‹å›¾å·¦è¾¹è¡¨ç¤ºçš„æ˜¯é¢‘ç‡åˆ†å¸ƒç›´æ–¹å›¾ï¼Œ$x$è½´æ˜¯ç»„è·ï¼Œè€Œ$y$è½´æ˜¯é¢‘æ•°è€Œå³è¾¹è¡¨ç¤ºçš„æ˜¯ä¹Ÿæ˜¯é¢‘ç‡åˆ†å¸ƒç›´æ–¹å›¾ï¼Œåªä¸è¿‡$y$è½´æ˜¯é¢‘ç‡/ç»„è·ï¼Œäºæ˜¯æ­¤æ—¶æ¯ä¸ªå°é•¿æ–¹å½¢çš„é¢ç§¯æ˜¯é¢‘ç‡å³å›¾ä¸­æ‰€æœ‰å°é•¿æ–¹å½¢çš„é¢ç§¯ä¹‹å’Œè®°ä¸º$S=1$æ¦‚ç‡å¯†åº¦å‡½æ•°å¤§å­¦çš„æ¦‚ç‡è®ºå°±æ˜¯å¼•å…¥äº†å¾®ç§¯åˆ†ï¼Œè€Œå¾®ç§¯åˆ†å¾ˆé‡è¦çš„ä¸€ä¸ªå°±æ˜¯æé™ï¼Œå½“æˆ‘ä»¬æŠŠè¿™é‡Œçš„ç»„è·å˜å¾—æ— é™å°ï¼Œå°±ä¼šå˜æˆå›¾ä¸­è“è‰²çš„çº¿ï¼Œæ­¤æ—¶è“çº¿ä¸$x$è½´å›´æˆçš„é¢ç§¯å§‹ç»ˆç­‰äº1ï¼Œå¹¶å°†è¿™æ¡è“çº¿å‘½åä¸ºæ¦‚ç‡å¯†åº¦å‡½æ•°ï¼Œè®°ä¸º$f(x)$$X$åœ¨ä»»æ„åŒºé—´$(a,b]$ä¸Šçš„æ¦‚ç‡å¯ä»¥è¡¨ç¤ºä¸ºå¦‚ä¸‹å…¬å¼ï¼Œä»£è¡¨çš„æ˜¯$a$åˆ°$b$åŒºé—´çš„é¢ç§¯ç´¯ç§¯åˆ†å¸ƒå‡½æ•°(åˆ†å¸ƒå‡½æ•°)å¾®ç§¯åˆ†ä¸­å¦ä¸€ä¸ªçŸ¥è¯†æ˜¯ç§¯åˆ†ï¼Œå½“æˆ‘ä»¬å¯¹ä¸‹é¢æ›²çº¿æ±‚ç§¯åˆ†æ—¶ï¼Œæ‰€å¾—åˆ°çš„é¢ç§¯è®°ä¸º$F(x)=\int _{-\infty}^{x} f(t) dt$ï¼Œä¹Ÿå°±æ˜¯ç´¯ç§¯åˆ†å¸ƒå‡½æ•°å…¶ä¸­ç§¯åˆ†ä¸Šé™$x$ä¸ºè‡ªå®šä¹‰çš„å€¼ï¼Œå¦‚ä¸‹å›¾ä¸­çš„æ©˜è‰²çš„çº¿ï¼Œæ­¤æ—¶$F(x)$å¯¹åº”çš„æ˜¯ä¸‹å›¾ä¸­é˜´å½±éƒ¨åˆ†çš„é¢ç§¯è¿ç»­å‹ä¸ç¦»æ•£å‹éšæœºå˜é‡è¿ç»­å‹éšæœºå˜é‡çš„ä¸€ç»´æƒ…å†µå¦‚ä¸Šé¢æ‰€æè¿°ï¼Œæ˜¯ä¸€æ¡çº¿è€Œç¦»æ•£å‹éšæœºå˜é‡ä½¿ç”¨è¡¨æ¥è¡¨ç¤ºï¼Œå¦‚æ·éª°å­å‡ºç°çš„ç‚¹æ•°å³ä¸ºç¦»æ•£å‹éšæœºå˜é‡ï¼Œå–å€¼é›†åˆä¸º1å’Œ6ä¹‹é—´çš„æ•´æ•°X123456p1/61/61/61/61/61/6æ­¤æ—¶è¿™ä¸ªè¡¨å¯ä»¥å«åšåˆ†å¸ƒè¡¨ï¼Œè¿™ä¸ªè¡¨çš„å‰èº«æ˜¯åˆ†å¸ƒç‡(æ¦‚ç‡åˆ†å¸ƒã€æ¦‚ç‡å‡½æ•°)ï¼Œåˆ†å¸ƒç‡æ¯ä¸ªå–å€¼è®°ä¸º$p(X=x)=p_i$åˆ†å¸ƒè¡¨å¯¹åº”çš„æ˜¯è¿ç»­å‹ä¸­çš„æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼Œåˆ†å¸ƒè¡¨ä¹Ÿå¯ä»¥å«åšæ¦‚ç‡è´¨é‡å‡½æ•°ï¼Œå¯¹å…¶åšç´¯ç§¯ï¼Œå…¶ç´¯ç§¯åˆ†å¸ƒå‡½æ•°å¦‚è¡¨æ‰€ç¤ºéšæœºå˜é‡å–å€¼123456æ¦‚ç‡è´¨é‡å‡½æ•°å€¼1/62/63/64/65/61ç´¯ç§¯åˆ†å¸ƒå‡½æ•°ä¹Ÿç§°ä¸ºåˆ†å¸ƒå‡½æ•°ï¼Œæ˜¯æ¦‚ç‡è´¨é‡å‡½æ•°çš„ç´¯åŠ ï¼Œå®šä¹‰ä¸ºäºŒç»´éšæœºå˜é‡å¯¹äºäºŒç»´çš„æƒ…å†µï¼Œä»åŸæ¥çš„ä¸€æ ¹çº¿å˜ä¸ºäº†ä¸€ä¸ªé¢ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè¡¨ç¤ºçš„æ˜¯è”åˆæ¦‚ç‡å¯†åº¦ï¼Œè®°ä¸º$f(x,y)$å¯¹è¿™ä¸ªé¢åˆ‡ä¸¤åˆ€ï¼Œæ±‚å‰©ä½™çš„ä½“ç§¯ï¼Œå°±æ˜¯è”åˆåˆ†å¸ƒå‡½æ•°ï¼Œè®°ä¸º$F(x,y) = \int {- \infty}^{x}{\int {- \infty}^{y} {f(u,v)dudv}}$ï¼Œæˆ–è€…è®°ä¸º$p(X \leq x , Y \leq y)$å¯¹äºäºŒç»´ç¦»æ•£å‹éšæœºå˜é‡ï¼Œç»™å‡ºçš„æ˜¯è”åˆåˆ†å¸ƒè¡¨ï¼Œå‰èº«æ˜¯è”åˆåˆ†å¸ƒå¾‹ï¼Œè”åˆåˆ†å¸ƒç‡æ¯ä¸ªå–å€¼è®°ä¸º$p(X=xi,Y=y_j)=p{ij}$X/Y56Xçš„è¾¹ç¼˜åˆ†å¸ƒè¡¨11/41/83/831/81/25/8Yçš„è¾¹ç¼˜åˆ†å¸ƒè¡¨3/85/81 è¾¹ç¼˜æ¦‚ç‡å¯†åº¦(ä¸€ç»´ä¸‹æ²¡æœ‰è¿™ä¸ªæ¦‚å¿µ)å¯¹äºå¾®ç§¯åˆ†è€Œè¨€ï¼Œæœ‰ä¸ªçŸ¥è¯†ç‚¹æ˜¯åå¯¼æ•°ï¼Œåœ¨è¿™é‡Œå¯ä»¥å¼•ç”³å‡ºè¾¹ç¼˜æ¦‚ç‡ï¼Œå³åœ¨è®¡ç®—æ˜¯æŠŠå¦å¤–çš„å˜é‡çœ‹ä½œå¸¸æ•°è®°ä¸º$fX(x) = \int {- \infty}^{\infty} f(x,y) dy$ï¼Œè¿™é‡Œçš„$X$è¡¨ç¤ºçš„æ˜¯$X$çš„è¾¹ç¼˜æ¦‚ç‡è¾¹ç¼˜åˆ†å¸ƒå‡½æ•°å¯¹åº”äºäºŒç»´çš„è”åˆåˆ†å¸ƒå‡½æ•°ï¼Œè¿™é‡Œè¿ç»­å‹è¿˜æœ‰ä¸€ä¸ªæ¦‚å¿µå«è¾¹ç¼˜åˆ†å¸ƒå‡½æ•°ï¼Œè®°ä¸º$F_X(x)=p(X \leq x, Y \leq +\infty) = p(X \leq x)$ å¯¹äºè”åˆåˆ†å¸ƒè¡¨ï¼Œè¾¹ç¼˜åŒ–ä¹‹åå°±æ˜¯å«åšè¾¹ç¼˜åˆ†å¸ƒè¡¨ï¼Œä¸Šè¡¨çš„$X$å’Œ$Y$çš„è¾¹ç¼˜åˆ†å¸ƒè¡¨å¦‚è¡¨æ‰€ç¤ºç¦»æ•£å‹éšæœºå˜é‡ç¦»æ•£å‹éšæœºå˜é‡çš„å–å€¼é›†åˆæ˜¯ç¦»æ•£é›†åˆï¼Œä¸ºæœ‰é™é›†æˆ–æ— é™å¯æ•°é›†ï¼Œå¯ä»¥å°†æ‰€æœ‰å–å€¼åˆ—ä¸¾å‡ºæ¥ä¾‹å¦‚ï¼Œæ·éª°å­å‡ºç°çš„ç‚¹æ•°å³ä¸ºç¦»æ•£å‹éšæœºå˜é‡ï¼Œå–å€¼é›†åˆä¸º1å’Œ6ä¹‹é—´çš„æ•´æ•°æ¦‚ç‡è´¨é‡å‡½æ•°(Probability Mass Function, PMF)æè¿°ç¦»æ•£å‹éšæœºå˜é‡å–å€¼æ¦‚ç‡çš„æ˜¯æ¦‚ç‡è´¨é‡å‡½æ•°ï¼Œå‡½æ•°ç”±éšæœºå˜é‡å–æ¯ä¸ªå€¼çš„æ¦‚ç‡æ’åˆ—ç»„æˆï¼Œå¯ä»¥å°†ç®€è®°ä¸º $p\left(x_{i}\right)$ è¿™é‡Œçš„è´¨é‡ä¸ç‰©ç†å­¦ä¸­çš„è´¨é‡ç›¸å¯¹åº”ï¼Œå¯çœ‹ä½œæ˜¯ä¸€äº›æœ‰è´¨é‡çš„è´¨ç‚¹ï¼Œæ¦‚ç‡è´¨é‡å‡½æ•°å€¼å¯¹åº”è¿™äº›ç‚¹çš„è´¨é‡æ¦‚ç‡è´¨é‡å‡½æ•°å¿…é¡»æ»¡è¶³ä»¥ä¸‹çº¦æŸæ¡ä»¶ä¸‹è¡¨æ˜¯ä¸€ä¸ªç¦»æ•£å‹éšæœºå˜é‡çš„æ¦‚ç‡è´¨é‡å‡½æ•°ï¼Œå…¶å–å€¼é›†åˆä¸º${1,2,3,4}$éšæœºå˜é‡å–å€¼æ¦‚ç‡è´¨é‡å‡½æ•°å€¼10.120.530.240.2ç¦»æ•£å‹éšæœºå˜é‡çš„å–å€¼å¯èƒ½ä¸ºæ— é™å¯æ•°é›†ï¼Œæ­¤æ—¶è¦ä¿è¯ä¸‹é¢çš„çº§æ•°æ”¶æ•›ï¼Œå¹¶ä¸”å…¶å€¼ä¸º1ç´¯ç§¯åˆ†å¸ƒå‡½æ•°(Cumulative Distribution Function, CDF)ç´¯ç§¯åˆ†å¸ƒå‡½æ•°ä¹Ÿç§°ä¸ºåˆ†å¸ƒå‡½æ•°ï¼Œæ˜¯æ¦‚ç‡è´¨é‡å‡½æ•°çš„ç´¯åŠ ï¼Œå®šä¹‰ä¸ºä¸Šè¡¨æ‰€ç¤ºçš„éšæœºå˜é‡ï¼Œå…¶ç´¯ç§¯åˆ†å¸ƒå‡½æ•°å¦‚è¡¨æ‰€ç¤ºéšæœºå˜é‡å–å€¼ç´¯ç§¯åˆ†å¸ƒå‡½æ•°å€¼10.120.630.841.0è¿ç»­å‹éšæœºå˜é‡å‡ ä½•å‹éšæœºäº‹ä»¶å¯¹åº”çš„æ˜¯è¿ç»­å‹éšæœºå˜é‡ï¼Œè¿ç»­å‹éšæœºå˜é‡çš„å–å€¼é›†åˆä¸ºæ— é™ä¸å¯æ•°é›†ä¸€èˆ¬ä¸ºå®æ•°è½´ä¸Šçš„ä¸€ä¸ªæˆ–å¤šä¸ªåŒºé—´ï¼Œæˆ–è€…æ˜¯æ•´ä¸ªå®æ•°é›†$\mathbb{R}$ä¾‹å¦‚ï¼Œæˆ‘ä»¬è¦è§‚æµ‹æ¯ä¸ªæ—¶é—´ç‚¹çš„æ¸©åº¦ï¼Œæ˜¯ä¸€ä¸ªè¿ç»­å€¼ï¼Œä¸ºè¿ç»­å‹éšæœºå˜é‡è€ƒè™‘è®¡ç®—ä¸€ç»´å‡ ä½•å‹éšæœºäº‹ä»¶æ¦‚ç‡çš„ä¾‹å­ï¼Œéšæœºç‚¹è½åœ¨$[0, x]$åŒºé—´å†…çš„æ¦‚ç‡å°±æ˜¯$x$ï¼Œè¿™æ˜¯$X \leqslant x$è¿™ä¸€éšæœºäº‹ä»¶çš„æ¦‚ç‡å…¶ä¸­$X$æ˜¯ä¸€ä¸ªè¿ç»­å‹éšæœºå˜é‡ï¼Œæ˜¯éšæœºç‚¹çš„ä¸€ç»´åæ ‡ï¼Œå…¶å…è®¸çš„å–å€¼èŒƒå›´ä¸º$[0,1]$ç´¯ç§¯åˆ†å¸ƒå‡½æ•°å¯¹ä¸Šé¢çš„å‡½æ•°è¿›è¡Œæ‰©å……ï¼Œä½¿å¾—$X$çš„å–å€¼èŒƒå›´ä¸ºæ•´ä¸ªå®æ•°é›†$\mathbb{R}$ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹çš„å‡½æ•°è¯¥å‡½æ•°ç§°ä¸ºç´¯ç§¯åˆ†å¸ƒå‡½æ•°æ¦‚ç‡å¯†åº¦å‡½æ•°å¯¹ç´¯ç§¯åˆ†å¸ƒå‡½æ•°è¿›è¡Œæ±‚å¯¼ï¼Œå³å¯å¾—åˆ°æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼Œ è¡¨ç¤ºè¿ç»­å‹éšæœºå˜é‡åœ¨æ¯ä¸€ä¸ªå–å€¼ç‚¹å¤„çš„æ¦‚ç‡å¯†åº¦å€¼é™¤å»0å’Œ1è¿™ä¸¤ç‚¹ï¼Œä¸Šé¢çš„ç´¯ç§¯åˆ†å¸ƒå‡½æ•°æ˜¯å¯å¯¼çš„ï¼Œå…¶å¯¼æ•°ä¸ºæ­¤å‡½æ•°åœ¨åŒºé—´$[0,1]$å†…æ‰€æœ‰ç‚¹å¤„çš„å–å€¼ç›¸ç­‰ï¼Œè¿™æ„å‘³ç€ç‚¹$x$è½åœ¨$[0,1]$å†…æ‰€æœ‰ç‚¹å¤„çš„å¯èƒ½æ€§ç›¸ç­‰æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸ç´¯ç§¯åˆ†å¸ƒå‡½æ•°çš„å®šä¹‰æ¦‚ç‡å¯†åº¦å‡½æ•°(Probability Density Function, PDF)å®šä¹‰äº†è¿ç»­å‹éšæœºå˜é‡çš„æ¦‚ç‡åˆ†å¸ƒå…¶å‡½æ•°å€¼è¡¨ç¤ºéšæœºå˜é‡å–è¯¥å€¼çš„å¯èƒ½æ€§(æ³¨æ„ï¼Œä¸æ˜¯æ¦‚ç‡)æ¦‚ç‡å¯†åº¦å‡½æ•°å¿…é¡»æ»¡è¶³å¦‚ä¸‹çº¦æŸæ¡ä»¶è¿™å¯ä»¥çœ‹ä½œæ˜¯ç¦»æ•£å‹éšæœºå˜é‡çš„æ¨å¹¿ï¼Œç§¯åˆ†å€¼ä¸º1å¯¹åº”å–å„ä¸ªå€¼çš„æ¦‚ç‡ä¹‹å’Œä¸º1è¿ç»­å‹éšæœºå˜é‡è½åœ¨æŸä¸€ç‚¹å¤„çš„æ¦‚ç‡å€¼ä¸º0è½åœ¨æŸä¸€åŒºé—´å†…çš„æ¦‚ç‡å€¼ä¸ºæ¦‚ç‡å¯†åº¦å‡½æ•°åœ¨è¯¥åŒºé—´å†…çš„å®šç§¯åˆ†å…¶ä¸­$F(x)$æ˜¯$f(x)$çš„ä¸€ä¸ªåŸå‡½æ•°ï¼Œä¹Ÿç§°ä¸ºåˆ†å¸ƒå‡½æ•°ï¼Œè¿‘ä¼¼åœ°æœ‰å…¶ä¸­$\xi$æ˜¯$[x, x+\Delta x]$å†…çš„ä¸€ä¸ªç‚¹æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸­çš„å¯†åº¦å¯ç±»æ¯”ç‰©ç†å­¦ä¸­çš„å¯†åº¦ï¼Œæ¦‚ç‡è´¨é‡å‡½æ•°åœ¨æ¯ä¸€ç‚¹å¤„çš„å€¼ä¸ºéšæœºå˜é‡å–è¯¥å€¼çš„æ¦‚ç‡è€Œæ¦‚ç‡å¯†åº¦å‡½æ•°åœ¨æ¯ä¸€ç‚¹å¤„çš„å€¼å¹¶ä¸æ˜¯æ¦‚ç‡å€¼ï¼Œåªæœ‰åŒºé—´ä¸Šçš„ç§¯åˆ†å€¼æ‰æ˜¯éšæœºå˜é‡è½å…¥æ­¤åŒºé—´çš„æ¦‚ç‡éšæœºå˜é‡$X$æœä»æ¦‚ç‡åˆ†å¸ƒ$f(x)$ï¼Œä¸€èˆ¬å¯ä»¥ç®€è®°ä¸ºå¯¹äºè¿ç»­å‹éšæœºå˜é‡ï¼Œåˆ†å¸ƒå‡½æ•°æ˜¯æ¦‚ç‡å¯†åº¦å‡½æ•°çš„å˜ä¸Šé™ç§¯åˆ†ï¼Œå®šä¹‰ä¸ºæ˜¾ç„¶è¿™æ˜¯å¢å‡½æ•°ï¼Œåˆ†å¸ƒå‡½æ•°çš„æ„ä¹‰æ˜¯éšæœºå˜é‡$X \leqslant y$çš„æ¦‚ç‡æ ¹æ®åˆ†å¸ƒå‡½æ•°çš„å®šä¹‰æœ‰æ ¹æ®å®šä¹‰ï¼Œåˆ†å¸ƒå‡½æ•°å•è°ƒé€’å¢è€ƒè™‘æŒ‡æ•°åˆ†å¸ƒï¼Œå…¶æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸ºå…¶ä¸­$\lambda&gt;0$ ï¼Œä¸‹é¢è®¡ç®—å®ƒçš„åˆ†å¸ƒå‡½æ•°ï¼Œå¦‚æœ$x&lt;0$ï¼Œåˆ™æœ‰å¦‚æœ$x \geqslant 0$ï¼Œåˆ™æœ‰å› æ­¤å…¶åˆ†å¸ƒå‡½æ•°ä¸ºä¸‹é¢ä»¥logisticå›å½’ä¸ºä¾‹è¯´æ˜æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸åˆ†å¸ƒå‡½æ•°åœ¨æœºå™¨å­¦ä¹ ä¸­çš„åº”ç”¨ï¼Œlogisticå›å½’çš„åˆ†å¸ƒå‡½æ•°ä¸ºlogisticå‡½æ•°ï¼Œå®šä¹‰ä¸ºå…¶å½¢çŠ¶å¦‚å›¾æ‰€ç¤ºï¼Œè¯¥å‡½æ•°å•è°ƒé€’å¢ï¼Œä¸”æœ‰æ»¡è¶³åˆ†å¸ƒå‡½æ•°çš„å®šä¹‰è¦æ±‚ï¼Œå…¶æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸º$F(x)(1-F(x))$ï¼Œæ¦‚ç‡å¯†åº¦å‡½æ•°çš„å›¾åƒå¦‚å›¾æ‰€ç¤ºæ•°å­¦æœŸæœ›å®šä¹‰æ•°å­¦æœŸæœ›(Mathematical Expectation)æ˜¯å¹³å‡å€¼çš„æ¨å¹¿ï¼Œæ˜¯åŠ æƒå¹³å‡å€¼çš„æŠ½è±¡ï¼Œå¯¹äºéšæœºå˜é‡ï¼Œæ˜¯å…¶åœ¨æ¦‚ç‡æ„ä¹‰ä¸‹çš„å‡å€¼æ™®é€šçš„å‡å€¼æ²¡æœ‰è€ƒè™‘æƒé‡æˆ–æ¦‚ç‡ï¼Œå¯¹äº$n$ä¸ªå˜é‡ï¼Œå®ƒä»¬çš„ç®—æœ¯å¹³å‡å€¼ä¸ºè¿™å¯çœ‹ä½œå˜é‡å–æ¯ä¸ªå€¼çš„å¯èƒ½æ€§ç›¸ç­‰ï¼Œæˆ–è€…æ¯ä¸ªå–å€¼çš„æƒé‡ç›¸ç­‰ä½†å¯¹äºå¾ˆå¤šåº”ç”¨ï¼Œå˜é‡å–æ¯ä¸ªå€¼æœ‰ä¸åŒçš„æ¦‚ç‡ï¼Œå› æ­¤è¿™ç§ç®€å•çš„å‡å€¼æ— æ³•åˆ»ç”»å‡ºå˜é‡çš„æ€§è´¨è¡¨ä¸ºä¹°å½©ç¥¨æ—¶å„ç§å¥–çš„ä¸­å¤šé‡‘é¢ä»¥åŠå¯¹åº”çš„æ¦‚ç‡å€¼ï¼Œä¸­å¥–é‡‘é¢å¯çœ‹ä½œç¦»æ•£å‹éšæœºå˜é‡å¦‚æœè¦è®¡ç®—ä¹°ä¸€å¼ å½©ç¥¨çš„å¹³å‡ä¸­å¥–é‡‘é¢ï¼Œç›´æ¥ç”¨å„ç§å¥–çš„ä¸­å¥–é‡‘é¢è®¡ç®—å¹³å‡å€¼æ˜¾ç„¶æ˜¯ä¸åˆç†çš„æ­£ç¡®çš„åšæ³•æ˜¯è€ƒè™‘ä¸­å„ç§å¥–çš„æ¦‚ç‡ï¼Œä»¥å…¶ä½œä¸ºæƒé‡æ¥è®¡ç®—å‡å€¼è¿™ç§è®¡ç®—æ–¹å¼å°±æ˜¯æ±‚æ•°å­¦æœŸæœ›ç¦»æ•£å‹éšæœºå˜é‡çš„æ•°å­¦æœŸæœ›å¯¹äºç¦»æ•£å‹éšæœºå˜é‡æ•°å­¦æœŸæœ›å®šä¹‰ä¸ºæ•°å­¦æœŸæœ›ä¹Ÿå¯ä»¥å†™æˆæˆ–ï¼Œè¡¨ç¤ºç”¨æ¦‚ç‡åˆ†å¸ƒå¯¹éšæœºå˜é‡$X$è®¡ç®—æ•°å­¦æœŸæœ›å¦‚æœå¼$E[X]$çš„çº§æ•°æ”¶æ•›ï¼Œåˆ™ç§°æ•°å­¦æœŸæœ›å­˜åœ¨è¿ç»­å‹éšæœºå˜é‡çš„æ•°å­¦æœŸæœ›å¯¹äºè¿ç»­å‹éšæœºå˜é‡ï¼Œæ•°å­¦æœŸæœ›é€šè¿‡å®šç§¯åˆ†å®šä¹‰å‡è®¾è¿ç»­å‹éšæœºå˜é‡$X$çš„æ¦‚ç‡å¯†åº¦å‡½æ•°æ˜¯$f(x)$ï¼Œå®ƒçš„æ•°å­¦æœŸæœ›ä¸ºæ ¹æ®å®šç§¯åˆ†çš„å®šä¹‰ï¼Œè¿ç»­å‹æ˜¯ç¦»æ•£å‹æ•°å­¦æœŸæœ›çš„æé™æƒ…å†µå¯¹äºè¿ç»­å‹éšæœºå˜é‡ï¼Œå…¶æ•°å­¦æœŸæœ›æ˜¯ä¸€ä¸ªæ³›å‡½æ ¹æ®å®šä¹‰ï¼Œå¸¸æ•°çš„æ•°å­¦æœŸæœ›ä¸ºå…¶è‡ªèº«ï¼Œå³$E[c]=c$æ ¹æ®æ•°å­¦æœŸæœ›çš„å®šä¹‰, ä¸‹é¢çš„å…¬å¼æˆç«‹å…¶ä¸­$k$ä¸ºå¸¸æ•°å¦‚æœ$g(X)$æ˜¯éšæœºå˜é‡$X$çš„å‡½æ•°ï¼Œåˆ™ç”±å®ƒå®šä¹‰çš„éšæœºå˜é‡çš„æ•°å­¦æœŸæœ›ä¸ºä¸€èˆ¬ç®€è®°ä¸º$E_{X \sim p(x)}[g(X)]$å¯¹äºè¿ç»­å‹æ¤­æœºå˜é‡$X$ï¼Œå…¶å‡½æ•°$g(X)$çš„æ•°å­¦æœŸæœ›ä¸ºæ ¹æ®è¿™ç§å®šä¹‰, ä¸‹é¢çš„å…¬å¼æˆç«‹ä»¥ä¸‹è¡¨ä¸­çš„éšæœºå˜é‡ä¸ºä¾‹ï¼Œ$X^{2}$çš„æ•°å­¦æœŸæœ›ä¸ºéšæœºå˜é‡å–å€¼æ¦‚ç‡è´¨é‡å‡½æ•°å€¼10.120.530.240.2ä¸‹é¢ä»¥æŒ‡æ•°åˆ†å¸ƒä¸ºä¾‹è®¡ç®—è¿ç»­å‹æ¦‚ç‡åˆ†å¸ƒçš„æ•°å­¦æœŸæœ›ï¼Œå¦‚æœ$X$æœä»å‚æ•°ä¸º$\lambda$çš„æŒ‡æ•°åˆ†å¸ƒï¼Œåˆ™å…¶æ•°å­¦æœŸæœ›ä¸ºç‰©ç†æ„ä¹‰å¦‚æœå°†éšæœºå˜é‡çœ‹ä½œç‰©ä½“å„ç‚¹åœ¨ç©ºé—´ä¸­çš„åæ ‡ï¼Œæ¦‚ç‡å¯†åº¦å‡½æ•°æ˜¯å…¶åœ¨ç©ºé—´å„ç‚¹å¤„çš„å¯†åº¦ï¼Œåˆ™æ•°å­¦æœŸæœ›çš„ç‰©ç†æ„ä¹‰æ˜¯ç‰©ä½“çš„è´¨å¿ƒæ–¹å·®ä¸æ ‡å‡†å·®å®šä¹‰æ–¹å·®(Variance, var)åæ˜ éšæœºå˜é‡å–å€¼çš„æ³¢åŠ¨ç¨‹åº¦ï¼Œæ˜¯éšæœºå˜é‡ä¸å…¶æ•°å­¦æœŸæœ›å·®å€¼å¹³å·®çš„æ•°å­¦æœŸæœ›æ–¹å·®ä¹Ÿå¯è®°ä¸º$D[X]$ï¼Œå¦‚æœä¸ä½¿ç”¨å¹³æ–¹ï¼Œåˆ™éšæœºå˜é‡æ‰€æœ‰å€¼ä¸å…¶æ•°å­¦æœŸæœ›çš„å·®å€¼ä¹‹å’Œä¸º0ç¦»æ•£å‹éšæœºå˜é‡çš„æ–¹å·®å¯¹äºç¦»æ•£éšæœºå˜é‡ï¼Œæ–¹å·®å®šä¹‰ä¸ºå¯¹äºä¸‹è¡¨ä¸­çš„éšæœºå˜é‡ï¼Œå®ƒçš„æ–¹å·®ä¸ºéšæœºå˜é‡å–å€¼æ¦‚ç‡è´¨é‡å‡½æ•°å€¼10.120.530.240.2è¿ç»­å‹éšæœºå˜é‡çš„æ–¹å·®å¯¹äºè¿ç»­å‹éšæœºå˜é‡ï¼Œæ–¹å·®åŒæ ·é€šè¿‡ç§¯åˆ†å®šä¹‰å…¶ä¸­ï¼Œ$f(x)$ä¸ºæ¦‚ç‡å¯†åº¦å‡½æ•°ï¼Œæ ¹æ®å®šä¹‰ï¼Œæ–¹å·®æ˜¯éè´Ÿçš„è®¡ç®—æŒ‡æ•°åˆ†å¸ƒçš„æ–¹å·®ï¼Œå…¶æ•°å­¦æœŸæœ›ä¸º$1 / \lambda$ï¼Œå…¶æ–¹å·®ä¸ºæ–¹å·®åæ˜ äº†éšæœºå˜é‡åç¦»å‡å€¼çš„ç¨‹åº¦ï¼Œæ–¹å·®è¶Šå°ï¼Œéšæœºå˜é‡çš„å˜åŒ–å¹…åº¦è¶Šå°ï¼Œåä¹‹åˆ™è¶Šå¤§æ ‡å‡†å·®(Standard Deviation)æ ‡å‡†å·®å®šä¹‰ä¸ºæ–¹å·®çš„å¹³æ–¹æ ¹æ ¹æ®æ–¹å·®çš„å®šä¹‰ï¼Œä¸‹é¢å…¬å¼æˆç«‹å®é™…è®¡ç®—æ–¹å·®æ—¶ç»å¸¸é‡‡ç”¨æ­¤å¼ï¼Œåœ¨æœºå™¨å­¦ä¹ ä¸­è¢«å¹¿æ³›ä½¿ç”¨æ ¹æ®æ–¹å·®çš„å®šä¹‰ï¼Œæœ‰$\operatorname{var}[k X]=k^{2} \operatorname{var}[X]$ï¼Œè¿™æ˜¯å› ä¸ºè¿™æ„å‘³ç€å°†éšæœºå˜é‡çš„å–å€¼æ‰©å¤§$k$å€ï¼Œå…¶æ–¹å·®æ‰©å¤§$k^{2}$å€ç‰©ç†æ„ä¹‰å¦‚æœå°†éšæœºå˜é‡çœ‹ä½œç‰©ä½“å„ç‚¹åœ¨ç©ºé—´ä¸­çš„åæ ‡ï¼Œæ¦‚ç‡å¯†åº¦å‡½æ•°æ˜¯å…¶åœ¨ç©ºé—´å„ç‚¹å¤„çš„å¯†åº¦ï¼Œåˆ™æ–¹å·®çš„ç‰©ç†æ„ä¹‰æ˜¯ç‰©ä½“çš„è½¬åŠ¨æƒ¯é‡Jensenä¸ç­‰å¼ä»‹ç»æ•°å­¦æœŸæœ›çš„ä¸€ä¸ªé‡è¦ä¸ç­‰å¼ï¼ŒJensenä¸ç­‰å¼(Jensenâ€™s Inequality)ï¼Œå®ƒåœ¨æœºå™¨å­¦ä¹ æŸäº›ç®—æ³•çš„æ¨å¯¼ä¸­èµ·ç€è‡³å…³é‡è¦çš„ä½œç”¨å›é¡¾å‡¸å‡½æ•°çš„å®šä¹‰ï¼Œå¦‚æœ$f(x)$æ˜¯ä¸€ä¸ªå‡¸å‡½æ•°ï¼Œ$0 \leqslant \theta \leqslant 1$ï¼Œåˆ™æœ‰å°†ä¸Šå¼ä»ä¸¤ä¸ªç‚¹æ¨å¹¿åˆ°$m$ä¸ªç‚¹ï¼Œå¦‚æœå¯ä»¥å¾—åˆ°ï¼Œå¯¹äºæœ‰å¦‚æœå°†$x$çœ‹ä½œæ˜¯ä¸€ä¸ªéšæœºå˜é‡ï¼Œæ˜¯å…¶æ¦‚ç‡åˆ†å¸ƒï¼Œåˆ™æœ‰ä»è€Œå¾—åˆ°Jensenä¸ç­‰å¼å¯¹äºå‡¹å‡½æ•°ï¼Œä¸Šé¢çš„ä¸ç­‰å¼åå·å¯ä»¥æ ¹æ®å®šä¹‰å¼ç”¨å½’çº³æ³•è¯æ˜å¼å¤šç‚¹æƒ…å†µä¸‹çš„å…¬å¼æˆç«‹é¦–å…ˆè€ƒè™‘$m=2$çš„æƒ…å†µï¼Œä¸”ï¼Œå³ï¼Œæ ¹æ®å‡¸å‡½æ•°çš„å®šä¹‰ï¼Œå¯¹äºæœ‰å‡è®¾$m=n$æ—¶ä¸ç­‰å¼æˆç«‹ï¼Œåˆ™å½“$m=n+1$æ—¶æœ‰ä¸Šé¢ç¬¬2æ­¥åˆ©ç”¨äº†å‡¸å‡½æ•°çš„å®šä¹‰ï¼Œç¬¬3æ­¥æˆç«‹æ˜¯å› ä¸ºæ ¹æ®å½’çº³æ³•çš„å‡è®¾ï¼Œ$m=n$æ—¶ä¸ç­‰å¼æˆç«‹å¦‚æœ$f(x)$æ˜¯ä¸¥æ ¼å‡¸å‡½æ•°ä¸”$x$ä¸æ˜¯å¸¸æ•°ï¼Œåˆ™æœ‰è¿™åŒæ ·å¯ä»¥ç”¨å½’çº³æ³•è¯æ˜ï¼Œä¸å‰é¢çš„è¯æ˜è¿‡ç¨‹ç±»ä¼¼å¦‚æœ$f(x)$æ˜¯ä¸¥æ ¼å‡¸å‡½æ•°ï¼Œå½“ä¸”ä»…å½“éšæœºå˜é‡$x$æ˜¯å¸¸æ•°æ—¶ï¼Œä¸ç­‰å¼å–ç­‰å·ä¸‹é¢ç»™å‡ºè¯æ˜ï¼Œå¦‚æœéšæœºå˜é‡$x$æ˜¯å¸¸æ•°ï¼Œåˆ™æœ‰å› æ­¤ä»¥åŠå› æ­¤æœ‰æ¥ä¸‹æ¥è¯æ˜å¦‚æœä¸ç­‰å¼å–ç­‰å·ï¼Œåˆ™æœ‰å¯ç”¨åè¯æ³•è¯æ˜ï¼Œå¦‚æœï¼Œç”±äºæ˜¯ä¸¥æ ¼å‡¸å‡½æ•°ï¼Œæ ¹æ®å‰é¢çš„ç»“è®ºæœ‰Jensenä¸ç­‰å¼å¯ä»¥æ¨å¹¿åˆ°éšæœºå‘é‡çš„æƒ…å†µï¼Œåœ¨åé¢å°†åˆ©ç”¨æ­¤ä¸ç­‰å¼æ¨å¯¼å‡ºæ±‚è§£å«æœ‰éšå˜é‡çš„æœ€å¤§ä¼¼ç„¶ä¼°è®¡é—®é¢˜çš„EMç®—æ³•å¸¸ç”¨æ¦‚ç‡åˆ†å¸ƒç¦»æ•£å‹æ¦‚ç‡åˆ†å¸ƒåŒ…æ‹¬å‡åŒ€åˆ†å¸ƒã€ä¼¯åŠªåˆ©åˆ†å¸ƒã€ äºŒé¡¹åˆ†å¸ƒã€å¤šé¡¹åˆ†å¸ƒã€å‡ ä½•åˆ†å¸ƒè¿ç»­å‹æ¦‚ç‡åˆ†å¸ƒåŒ…æ‹¬å‡åŒ€åˆ†å¸ƒã€æ­£æ€åˆ†å¸ƒ, ä»¥åŠ$t$åˆ†å¸ƒå‡åŒ€åˆ†å¸ƒå®šä¹‰å¯¹äºç¦»æ•£å‹éšæœºå˜é‡$X$ï¼Œå¦‚æœæœä»å‡åŒ€åˆ†å¸ƒ(Uniform Distribution)ï¼Œåˆ™å…¶å–æ¯ä¸ªå€¼çš„æ¦‚ç‡ç›¸ç­‰ï¼Œå³å¯¹äºè¿ç»­å‹éšæœºå˜é‡$X$ï¼Œå¦‚æœæœä»åŒºé—´$[a, b]$ä¸Šçš„å‡åŒ€åˆ†å¸ƒï¼Œåˆ™å…¶æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸ºåˆ†æ®µå¸¸æ•°å‡½æ•°ï¼Œå®šä¹‰ä¸ºåœ¨å…è®¸å–å€¼çš„åŒºé—´å†…ï¼Œæ¦‚ç‡å¯†åº¦å‡½æ•°å€¼ç›¸ç­‰ï¼Œç­‰äºåŒºé—´é•¿åº¦çš„å€’æ•°ä¸‹é¢è®¡ç®—å®ƒçš„åˆ†å¸ƒå‡½æ•°ï¼Œå¦‚æœ$x&lt;a$ï¼Œåˆ™æœ‰å¦‚æœ$a \leqslant x \leqslant b$ï¼Œåˆ™æœ‰å¦‚æœ$x&gt;b$ï¼Œåˆ™æœ‰å› æ­¤ï¼Œå…¶åˆ†å¸ƒå‡½æ•°ä¸ºéšæœºå˜é‡$X$æœä»åŒºé—´$[a, b]$ä¸Šçš„å‡åŒ€åˆ†å¸ƒï¼Œç®€è®°ä¸º$X \sim U(a, b)$ä¾‹å­ä¸‹é¢è®¡ç®—æœä»åŒºé—´$[a, b]$ä¸Šå‡åŒ€åˆ†å¸ƒçš„éšæœºå˜é‡çš„æ•°å­¦æœŸæœ›å’Œæ–¹å·®ï¼Œæ ¹æ®æ•°å­¦æœŸæœ›çš„å®šä¹‰å› æ­¤ï¼Œå‡åŒ€åˆ†å¸ƒçš„å‡å€¼ä¸ºåŒºé—´çš„ä¸­ç‚¹ï¼Œæ ¹æ®æ–¹å·®çš„å®šä¹‰å‡åŒ€åˆ†å¸ƒçš„æ–¹å·®ä¸åŒºé—´é•¿åº¦çš„å¹³æ–¹æˆæ­£æ¯”å‡åŒ€åˆ†å¸ƒæ˜¯æœ€ç®€å•çš„æ¦‚ç‡åˆ†å¸ƒ, åœ¨ç¨‹åºè®¾è®¡ä¸­å„ç§æ¦‚ç‡åˆ†å¸ƒçš„éšæœºæ•°ä¸€èˆ¬é€šè¿‡å‡åŒ€åˆ†å¸ƒéšæœº æ•°æ„é€ ã€‚ç®—æ³•ç”Ÿæˆçš„éšæœºæ•°ä¸æ˜¯çœŸéšæœºè€Œæ˜¯ä¼ªéšæœºã€‚é€šå¸¸æƒ…å†µä¸‹, åŸºæœ¬çš„éšæœºæ•°ç”Ÿæˆç®—æ³•ç”Ÿæˆçš„ æ˜¯æŸä¸€åŒºé—´ $\left[0, n_{\max }\right]$ ä¸Šå‡åŒ€åˆ†å¸ƒçš„éšæœºæ•´æ•°ã€‚å¯¹å‡åŒ€åˆ†å¸ƒéšæœºæ•´æ•°è¿›è¡Œå˜æ¢ï¼Œå¯ä»¥å°†å…¶å˜ä¸ºå¦å¤–ä¸€ä¸ªåŒºé—´ä¸Šçš„å‡åŒ€åˆ†å¸ƒéšæœºæ•°ä¾‹å¦‚ï¼Œå¯¹ä¸Šå‡åŒ€åˆ†å¸ƒéšæœºæ•´æ•°$x$é™¤ä»¥å…¶æœ€å¤§å€¼å¯ä»¥å°†å…¶å˜æ¢ä¸ºåŒºé—´$[0,1]$ä¸Šçš„è¿ç»­å‹å‡åŒ€éšæœºæ•°å¦‚æœè¦ç”ŸæˆæŸä¸€åŒºé—´ä¸Šå‡åŒ€åˆ†å¸ƒçš„æ•´æ•°, åˆ™å¯å€ŸåŠ©äºå–ä½™è¿ç®—å®ç°å¦‚æœè¦ç”Ÿæˆ$[0, k]$ä¸Šå‡åŒ€åˆ†å¸ƒçš„æ•´æ•°ï¼Œåˆ™å¯ä»¥å°†$x$é™¤ä»¥$k+1$å–ä½™æ•°è¿™é‡Œå‡è®¾$k&lt;n_{\max }$ï¼Œæ˜¾ç„¶ï¼Œè¯¥ä½™æ•°åœ¨$[0, k]$ä¸Šå‡åŒ€åˆ†å¸ƒä¼¯åŠªåˆ©åˆ†å¸ƒå®šä¹‰æœä»ä¼¯åŠªåˆ©åˆ†å¸ƒ(Bernoulli Distribution)çš„éšæœºå˜é‡$X$çš„å–å€¼ä¸º0æˆ–1ä¸¤ç§æƒ…å†µï¼Œè¯¥åˆ†å¸ƒä¹Ÿç§°ä¸º$0-1$åˆ†å¸ƒå–å€¼ä¸º1çš„æ¦‚ç‡ä¸º$p$ï¼Œå–å€¼ä¸º0çš„æ¦‚ç‡ä¸º$1-p$ï¼Œå…¶ä¸­$p$ä¸º$(0,1)$å†…çš„å®æ•°ï¼Œæ˜¯æ­¤æ¦‚ç‡åˆ†å¸ƒçš„å‚æ•°ï¼Œå³æ¦‚ç‡è´¨é‡å‡½æ•°å¯ç»Ÿä¸€å†™æˆå…¶ä¸­$x \in{0,1}$ï¼Œå¦‚æœ$x=0$ï¼Œåˆ™æœ‰å¦‚æœ$x=1$ï¼Œåˆ™æœ‰å¦‚æœ$p=\frac{1}{2}$ï¼Œé‚£ä¹ˆæ­¤æ—¶çš„ä¼¯åŠªåˆ©åˆ†å¸ƒä¸ºç¦»æ•£å‹å‡åŒ€åˆ†å¸ƒï¼Œä¸ºæ–¹ä¾¿èµ·è§ï¼Œé€šå¸¸å°†$1-p$ç®€è®°ä¸º$q$å¦‚æœå°†éšæœºå˜é‡å–å€¼ä¸º1çœ‹ä½œè¯•éªŒæˆåŠŸï¼Œå–å€¼ä¸º0çœ‹ä½œè¯•éªŒå¤±è´¥ï¼Œåˆ™ä¼¯åŠªåˆ©åˆ†å¸ƒæ˜¯æè¿°è¯•éªŒç»“æœçš„ä¸€ç§æ¦‚ç‡åˆ†å¸ƒéšæœºå˜é‡$X$æœä»å‚æ•°ä¸º$p$çš„ä¼¯åŠªåˆ©åˆ†å¸ƒç®€è®°ä¸ºæœºå™¨å­¦ä¹ ä¸­çš„äºŒåˆ†ç±»é—®é¢˜å¯ä»¥ç”¨ä¼¯åŠªåˆ©åˆ†å¸ƒæè¿°ï¼Œlogisticå›å½’æ‹Ÿåˆçš„æ˜¯è¿™ç§åˆ†å¸ƒæ ¹æ®å®šä¹‰ï¼Œä¼¯åŠªåˆ©åˆ†å¸ƒçš„æ•°å­¦æœŸæœ›ä¸ºæ–¹å·®ä¸ºå¯ä»¥çœ‹åˆ°ï¼Œå½“$p=\frac{1}{2}$æ—¶ï¼Œæ–¹å·®æœ‰æå¤§å€¼æ ¹æ®æœä»å‡åŒ€åˆ†å¸ƒçš„éšæœºæ•°å¯ä»¥ç”Ÿæˆæœä»ä¼¯åŠªåˆ©åˆ†å¸ƒçš„éšæœºæ•°ï¼Œå¯¹äºä¼¯åŠªåˆ©åˆ†å¸ƒå°†$[0,1]$åŒºé—´åˆ’åˆ†æˆä¸¤ä¸ªå­åŒºé—´ï¼Œç¬¬1ä¸ªå­åŒºé—´çš„é•¿åº¦ä¸º$p$ï¼Œç¬¬äºŒä¸ªå­åŒºé—´çš„é•¿åº¦ä¸º$1-p$å¦‚æœæœ‰ä¸€ä¸ª$[0,1]$ä¸Šå‡åŒ€åˆ†å¸ƒçš„éšæœºæ•°ï¼Œåˆ™å®ƒè½åœ¨ç¬¬1ä¸ªå­åŒºé—´å†…çš„æ¦‚ç‡å³ä¸º$p$ï¼Œè½åœ¨ç¬¬2ä¸ªå­åŒºé—´å†…çš„æ¦‚ç‡å³ä¸º$1-p$å› æ­¤ï¼Œå¯ä»¥å…ˆç”Ÿæˆ$[0,1]$ä¸Šå‡åŒ€åˆ†å¸ƒçš„éšæœºæ•°$\zeta$ï¼Œç„¶ååˆ¤å®šå…¶æ‰€åœ¨çš„å­åŒºé—´ï¼Œå¦‚æœå®ƒè½åœ¨ç¬¬1ä¸ªå­åŒºé—´ï¼Œå³åˆ™è¾“å‡º1ï¼Œå¦åˆ™è¾“å‡º0ç®—æ³•è¾“å‡ºçš„å€¼å³æœä»ä¼¯åŠªåˆ©åˆ†å¸ƒï¼Œæ·±åº¦å­¦ä¹ ä¸­çš„Dropoutæœºåˆ¶ã€ç¨€ç–è‡ªåŠ¨ç¼–ç å™¨éƒ½ä½¿ç”¨äº†ä¼¯åŠªåˆ©åˆ†å¸ƒäºŒé¡¹åˆ†å¸ƒå®šä¹‰$n$ä¸ªç‹¬ç«‹åŒåˆ†å¸ƒçš„ä¼¯åŠªåˆ©åˆ†å¸ƒéšæœºå˜é‡ä¹‹å’Œæœä»$n$é‡ä¼¯åŠªåˆ©åˆ†å¸ƒï¼Œä¹Ÿç§°ä¸ºäºŒé¡¹åˆ†å¸ƒ(Binomial Distribution)æ­¤æ—¶ï¼Œéšæœºå˜é‡$X$è¡¨ç¤º$n$æ¬¡è¯•éªŒä¸­æœ‰$k$æ¬¡æˆåŠŸçš„æ¦‚ç‡ï¼Œå…¶æ¦‚ç‡è´¨é‡å‡½æ•°ä¸ºå…¶ä¸­$\mathrm{C}_{n}^{k}$ä¸ºç»„åˆæ•°ï¼Œæ˜¯$n$ä¸ªæ•°ä¸­æœ‰$k$ä¸ªå–å€¼æ˜¯1çš„æ‰€æœ‰å¯èƒ½æƒ…å†µæ•°ï¼Œ$p$æ˜¯æ¯æ¬¡è¯•éªŒæ—¶æˆåŠŸçš„æ¦‚ç‡ï¼Œå–å€¼èŒƒå›´ä¸º$(0,1)$äºŒé¡¹åˆ†å¸ƒçš„æ¦‚ç‡$p(X=k)$ä¹Ÿæ˜¯å¯¹$(p+(1-p))^{n}$è¿›è¡ŒäºŒé¡¹å¼å±•å¼€æ—¶ç¬¬$k+1$ä¸ªå±•å¼€é¡¹ï¼Œå› æ­¤è€Œå¾—ååœ¨$n$æ¬¡è¯•éªŒä¸­ï¼Œ$k$æ¬¡æˆåŠŸçš„æ¦‚ç‡ä¸º$p^{k}$ï¼Œ$n-k$æ¬¡å¤±è´¥çš„æ¦‚ç‡ä¸º$(1-p)^{n-k}$ï¼Œè€Œ$k$æ¬¡æˆåŠŸå¯ä»¥æ˜¯$n$æ¬¡è¯•éªŒä¸­çš„ä»»æ„$k$æ¬¡ï¼Œå› æ­¤æœ‰ç»„åˆç³»æ•°$\mathrm{C}_{n}^{k}$ éšæœºå˜é‡$X$æœä»å‚æ•°ä¸º$n, p$çš„äºŒé¡¹åˆ†å¸ƒï¼Œå¯ä»¥ç®€è®°ä¸ºä¸‹å›¾æ˜¯ä¸€ä¸ªäºŒé¡¹åˆ†å¸ƒçš„å›¾åƒï¼Œå…¶ä¸­$n=5, p=0.5$ï¼Œæ¨ªè½´ä¸ºéšæœºå˜é‡çš„å–å€¼ï¼Œçºµè½´ä¸ºå–å„ç¦»æ•£å€¼çš„æ¦‚ç‡æ­¤æ—¶äºŒé¡¹åˆ†å¸ƒçš„å±•å¼€é¡¹æ˜¯å¯¹ç§°çš„ï¼Œå› æ­¤å…¶æ¦‚ç‡è´¨é‡å‡½æ•°çš„å›¾åƒæ˜¯å¯¹ç§°çš„ä»å›¾å¯ä»¥çœ‹å‡ºï¼ŒäºŒé¡¹åˆ†å¸ƒåœ¨ä¸­é—´ä½ç½®çš„æ¦‚ç‡å€¼æ›´å¤§ï¼Œåœ¨ä¸¤ç«¯å¤„çš„æ¦‚ç‡å€¼æ›´å°ï¼Œéšç€$n$çš„å€¼å¢å¤§ï¼Œå®ƒå°†ä»¥æ­£æ€åˆ†å¸ƒä¸ºæé™åˆ†å¸ƒè®¡ç®—äºŒé¡¹åˆ†å¸ƒçš„æ•°å­¦æœŸæœ›å„ç§å‡å€¼å’Œæ–¹å·®çš„æ­£æ€åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸‹é¢è®¡ç®—äºŒé¡¹åˆ†å¸ƒçš„æ•°å­¦æœŸæœ›ï¼Œæ ¹æ®å®šä¹‰æœ‰ä¸Šå¼ç¬¬6æ­¥è¿›è¡Œäº†æ¢å…ƒï¼Œä»¤$a=k-1, b=n-1, n-k=b-a$ï¼Œæ–¹å·®ä¸ºè€Œä¸Šå¼ç¬¬2æ­¥åˆ©ç”¨äº†ï¼Œå› æ­¤ç”±äºäºŒé¡¹åˆ†å¸ƒæ˜¯å¤šä¸ªç›¸äº’ç‹¬ç«‹åŒåˆ†å¸ƒçš„ä¼¯åŠªåˆ©åˆ†å¸ƒä¹‹å’Œï¼Œå› æ­¤å…¶å‡å€¼ä¸æ–¹å·®å’Œä¼¯åŠªåˆ©åˆ†å¸ƒåˆšå¥½ä¸º$n$å€çš„å…³ç³»å¤šé¡¹åˆ†å¸ƒå®šä¹‰å¤šé¡¹åˆ†å¸ƒ(Multinomial Distribution)æ˜¯ä¼¯åŠªåˆ©åˆ†å¸ƒçš„æ¨å¹¿ï¼Œéšæœºå˜é‡$X$çš„å–å€¼æœ‰$k$ç§æƒ…å†µå‡è®¾å–å€¼ä¸º${1, \cdots, k}$å†…çš„æ•´æ•°ï¼Œåˆ™æœ‰å¯¹$X$çš„å–å€¼è¿›è¡ŒOne-Hotå‘é‡ç¼–ç ï¼Œç”±$k$ä¸ªåˆ†é‡ç»„æˆï¼Œå¦‚æœ$X$å–å€¼ä¸º$i$ï¼Œåˆ™ç¬¬$i$ä¸ªåˆ†é‡ä¸º1ï¼Œå…¶ä½™åˆ†é‡å‡ä¸º0å‡è®¾One-Hotç¼–ç ç»“æœä¸ºï¼Œåˆ™æ¦‚ç‡è´¨é‡å‡½æ•°å¯ä»¥ç»Ÿä¸€å†™æˆå¦‚æœ$p_{i}=\frac{1}{k}, i=1, \cdots, k$ï¼Œåˆ™å¤šé¡¹åˆ†å¸ƒä¸ºç¦»æ•£å‹å‡åŒ€åˆ†å¸ƒï¼Œå¤šé¡¹åˆ†å¸ƒå¯¹åº”å¤šåˆ†ç±»é—®é¢˜ï¼Œsoftmaxå›å½’æ‹Ÿåˆçš„å°±æ˜¯è¿™ç§åˆ†å¸ƒæ ¹æ®æœä»å‡åŒ€åˆ†å¸ƒçš„éšæœºæ•°å¯ä»¥ç”Ÿæˆæœä»å¤šé¡¹åˆ†å¸ƒçš„éšæœºæ•°ï¼Œå…¶æ–¹æ³•ä¸ç”Ÿæˆä¼¯åŠªåˆ©åˆ†å¸ƒéšæœºæ•°ç›¸åŒï¼Œå¯¹äºå¤šé¡¹åˆ†å¸ƒå°†$[0,1]$åŒºé—´åˆ’åˆ†æˆ$k$ä¸ªå­åŒºé—´ï¼Œç¬¬$i$ä¸ªå­åŒºé—´çš„é•¿åº¦ä¸º$p_{i}$å¦‚æœæœ‰ä¸€ä¸ª$[0,1]$ä¸Šå‡åŒ€åˆ†å¸ƒçš„éšæœºæ•°ï¼Œåˆ™å®ƒè½åœ¨ç¬¬$i$ä¸ªå­åŒºé—´å†…çš„æ¦‚ç‡ä¸º$p_{i}$å› æ­¤ï¼Œå¯ä»¥å…ˆç”Ÿæˆ$[0,1]$ä¸Šå‡åŒ€åˆ†å¸ƒçš„éšæœºæ•°$\zeta$ï¼Œç„¶ååˆ¤å®šå…¶æ‰€åœ¨çš„å­åŒºé—´ï¼Œå¦‚æœå®ƒè½åœ¨ç¬¬$i$å­åŒºé—´ï¼Œå³åˆ™è¾“å‡º$i$ï¼Œç®—æ³•è¾“å‡ºçš„æ•°å³æœä»å¤šé¡¹åˆ†å¸ƒå¯¹å¤šä¸ªæ ·æœ¬æŒ‰ç…§æƒé‡æŠ½æ ·å€ŸåŠ©äºå¤šé¡¹åˆ†å¸ƒéšæœºæ•°å¯ä»¥å®ç°å¯¹å¤šä¸ªæ ·æœ¬æŒ‰ç…§æƒé‡æŠ½æ ·ï¼Œæœ‰$n$ä¸ªæ ·æœ¬ï¼Œå®ƒä»¬å¯¹åº”çš„å½’ä¸€åŒ–æƒé‡ä¸ºç°åœ¨è¦å¯¹è¿™äº›æ•°è¿›è¡ŒæŠ½æ ·ï¼Œä¿è¯æŠ½ä¸­æ¯ä¸ªæ ·æœ¬çš„æ¦‚ç‡ä¸º$w_{i}$ï¼Œå€ŸåŠ©äºå†…å¤šé¡¹åˆ†å¸ƒçš„éšæœºæ•°ï¼Œå³å¯å®ç°æ­¤åŠŸèƒ½åœ¨ç²’å­æ»¤æ³¢å™¨ã€é—ä¼ ç®—æ³•ä¸­å‡æœ‰è¿™æ ·çš„éœ€æ±‚å‡ ä½•åˆ†å¸ƒå®šä¹‰å‰é¢å·²ç»è¯´æ˜äº†æ— é™å¯æ•°æ ·æœ¬ç©ºé—´çš„æ¦‚ç‡å€¼ï¼Œå‡ ä½•åˆ†å¸ƒæ˜¯è¿™ç§å–å€¼ä¸ºæ— é™ç§å¯èƒ½çš„ç¦»æ•£å‹æ¦‚ç‡åˆ†å¸ƒåšä¸€ä¸ªè¯•éªŒï¼Œæ¯æ¬¡æˆåŠŸçš„æ¦‚ç‡ä¸º$p$ï¼Œå‡è®¾å„æ¬¡è¯•éªŒä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œäº‹ä»¶$A_{n}$å®šä¹‰ä¸ºè¯•éªŒ$n$æ¬¡æ‰å–å¾—ç¬¬ä¸€æ¬¡æˆåŠŸï¼Œä¸å…¶å¯¹åº”ï¼Œå®šä¹‰éšæœºå˜é‡$X$è¡¨ç¤ºç¬¬ä¸€æ¬¡å–å¾—æˆåŠŸæ‰€éœ€è¦çš„è¯•éªŒæ¬¡æ•°ï¼Œå…¶æ¦‚ç‡ä¸ºå¦‚æœä»¤$q=1-p$ï¼Œåˆ™ä¸Šå¼å¯ä»¥å†™æˆè¿™å°±æ˜¯å‡ ä½•åˆ†å¸ƒ(Geometric Distribution)ï¼Œå‡ ä½•åˆ†å¸ƒå› å…¶åˆ†å¸ƒå‡½æ•°ä¸ºå‡ ä½•çº§æ•°è€Œå¾—åéšæœºå˜é‡$X$æœä»å‚æ•°ä¸º$p$çš„å‡ ä½•åˆ†å¸ƒï¼Œå¯ä»¥ç®€è®°ä¸º$X \sim \mathrm{Geo}(p)$åˆ†å¸ƒå‡½æ•°è®¡ç®—å‡ ä½•åˆ†å¸ƒçš„åˆ†å¸ƒå‡½æ•°ï¼Œæ ¹æ®å®šä¹‰ï¼Œæœ‰å‡ ä½•åˆ†å¸ƒçš„æ•°å­¦æœŸæœ›ä¸ºä¸Šå¼åˆ©ç”¨äº†å¹‚çº§æ•°æ±‚å¯¼å…¬å¼ï¼Œå½“$0&lt;q&lt;1$æ—¶ï¼Œå¹‚çº§æ•°$\sum_{n=0}^{+\infty} q^{n}$æ”¶æ•›äº$\frac{1}{1-q}$æ ¹æ®æ–¹å·®çš„å®šä¹‰ï¼Œæœ‰è€ŒåŒæ ·ï¼Œè¿™é‡Œåˆ©ç”¨äº†å¹‚çº§æ•°æ±‚å¯¼å…¬å¼ï¼Œå› æ­¤å‡ ä½•åˆ†å¸ƒçš„æ–¹å·®ä¸ºå‡ ä½•åˆ†å¸ƒçš„éšæœºæ•°ä¹Ÿå¯ä»¥å€ŸåŠ©äºå‡åŒ€åˆ†å¸ƒçš„éšæœºæ•°ç”Ÿæˆï¼Œæ–¹æ³•ä¸ä¼¯åŠªåˆ©åˆ†å¸ƒç±»ä¼¼ç®—æ³•å¾ªç¯è¿›è¡Œå°è¯•ï¼Œæ¯æ¬¡ç”Ÿæˆä¸€ä¸ªä¼¯åŠªåˆ©åˆ†å¸ƒéšæœºæ•°ï¼Œå¦‚æœé‡åˆ°1ï¼Œåˆ™ç»“æŸå¾ªç¯ï¼Œè¿”å›å°è¯•çš„æ¬¡æ•°æ­£æ€åˆ†å¸ƒå®šä¹‰æ­£æ€åˆ†å¸ƒ(Normal Distribution)ä¹Ÿç§°ä¸ºé«˜æ–¯åˆ†å¸ƒ(Gaussian Distribution)ï¼Œå®ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸ºå…¶ä¸­$\mu$å’Œ$\sigma^{2}$åˆ†åˆ«ä¸ºå‡å€¼å’Œæ–¹å·®è¯¥å‡½æ•°åœ¨$(-\infty,+\infty)$ä¸Šçš„ç§¯åˆ†ä¸º1ï¼Œä»¤$t=\frac{x-\mu}{\sqrt{2} \sigma}$ï¼Œåˆ™æœ‰æ˜¾ç„¶ï¼Œæ¦‚ç‡å¯†åº¦å‡½æ•°å…³äºæ•°å­¦æœŸæœ›$x=\mu$å¯¹ç§°ï¼Œä¸”åœ¨è¯¥ç‚¹å¤„æœ‰æå¤§å€¼åœ¨è¿œç¦»æ•°å­¦æœŸæœ›æ—¶ï¼Œæ¦‚ç‡å¯†åº¦å‡½æ•°çš„å€¼å•è°ƒé€’å‡å…·ä½“åœ°ï¼Œåœ¨$(-\infty, \mu)$å†…å•è°ƒé€’å¢ï¼Œåœ¨$(\mu,+\infty)$å†…å•è°ƒé€’å‡ï¼Œè¯¥å‡½æ•°çš„æé™ä¸ºç°å®ä¸–ç•Œä¸­çš„å¾ˆå¤šæ•°æ®ï¼Œä¾‹å¦‚äººçš„èº«é«˜ã€ä½“é‡ã€å¯¿å‘½ç­‰ï¼Œè¿‘ä¼¼æœä»æ­£æ€åˆ†å¸ƒéšæœºå˜é‡$X$æœä»å‡å€¼ä¸º$\mu$ ã€æ–¹å·®ä¸º$\sigma^{2}$çš„æ­£æ€åˆ†å¸ƒï¼Œç®€è®°ä¸º$X \sim N\left(\mu, \sigma^{2}\right)$æ ‡å‡†æ­£æ€åˆ†å¸ƒå¦‚æœæ­£æ€åˆ†å¸ƒçš„å‡å€¼ä¸º0ï¼Œæ–¹å·®ä¸º1ï¼Œåˆ™ç§°ä¸ºæ ‡å‡†æ­£æ€åˆ†å¸ƒï¼Œæ­¤æ—¶çš„æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸ºè¯¥å‡½æ•°æ˜¯ä¸€ä¸ªå¶å‡½æ•°ï¼Œä¸‹å›¾çº¢è‰²ä¸ºæ ‡å‡†æ­£æ€åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°å›¾åƒï¼Œå…¶å½¢çŠ¶åƒé’Ÿï¼Œå› æ­¤ä¹Ÿç§°ä¸ºé’Ÿå½¢åˆ†å¸ƒæ­£æ€åˆ†å¸ƒçš„å‡å€¼å†³å®šäº†å…¶æ¦‚ç‡å¯†åº¦å‡½æ•°å³°å€¼å‡ºç°çš„ä½ç½®ï¼Œæ–¹å·®åˆ™å†³å®šäº†æ›²çº¿çš„å®½å’Œçª„ï¼Œæ–¹å·®è¶Šå¤§ï¼Œæ›²çº¿è¶Šå®½ï¼Œåä¹‹åˆ™è¶Šçª„æ­£æ€åˆ†å¸ƒ$N\left(\mu, \sigma^{2}\right)$çš„åˆ†å¸ƒå‡½æ•°ä¸ºç”±äº$\mathrm{e}^{-x^{2}}$çš„ä¸å®šç§¯åˆ†ä¸æ˜¯åˆç­‰å‡½æ•°ï¼Œå› æ­¤è¯¥å‡½æ•°æ— è§£æè¡¨è¾¾å¼å‡è®¾éšæœºå˜é‡$Z$æœä»æ ‡å‡†æ­£æ€åˆ†å¸ƒ$N(0,1)$ï¼Œåˆ™éšæœºå˜é‡$X=\sigma Z+\mu$æœä»æ­£æ€åˆ†å¸ƒ$N\left(\mu, \sigma^{2}\right)$ç›¸åï¼Œå¦‚æœéšæœºå˜é‡$X$æœä»æ­£æ€åˆ†å¸ƒ$N\left(\mu, \sigma^{2}\right)$ï¼Œåˆ™éšæœºå˜é‡$Z=\frac{X-\mu}{\sigma}$æœä»æ ‡å‡†æ­£æ€åˆ†å¸ƒ$N(0,1)$ç½®ä¿¡åŒºé—´æ­£æ€åˆ†å¸ƒçš„$k-\sigma$ç½®ä¿¡åŒºé—´å®šä¹‰ä¸º$[\mu-k \sigma, \mu+k \sigma]$ï¼Œå…¶ä¸­$k$ä¸ºä¸€ä¸ªæ­£æ•´æ•°éšæœºå˜é‡è½å…¥è¯¥åŒºé—´çš„æ¦‚ç‡ä¸ºéšæœºå˜é‡åœ¨$\sigma, 2 \sigma, 3 \sigma$åŒºé—´å†…çš„æ¦‚ç‡åˆ†åˆ«ä¸ºæ•°å­¦æœŸæœ›ä¸‹é¢è®¡ç®—æ­£æ€åˆ†å¸ƒçš„æ•°å­¦æœŸæœ›ï¼Œä½¿ç”¨æ¢å…ƒæ³•ï¼Œä»¤åˆ™æœ‰æ ¹æ®æ•°å­¦æœŸæœ›çš„å®šä¹‰ï¼Œæœ‰ä¸Šå¼ç¬¬5æ­¥æˆç«‹æ˜¯å› ä¸º$z \mathrm{e}^{-\frac{x^{2}}{2}}$æ˜¯å¥‡å‡½æ•°ï¼Œå®ƒåœ¨$(-\infty,+\infty)$ä¸Šçš„ç§¯åˆ†ä¸º0ç¬¬6æ­¥åˆ©ç”¨äº†ä¸‹é¢çš„ç»“è®ºè¿™å¯ä»¥ç”¨å¼æ¢å…ƒæ³•è¯æ˜æ–¹å·®ä¸‹é¢è®¡ç®—æ–¹å·®ï¼ŒåŒæ ·ä»¤$z=\frac{x-\mu}{\sigma}$ï¼Œåˆ™æœ‰ä¸Šå¼ç¬¬5æ­¥åˆ©ç”¨äº†åˆ†éƒ¨ç§¯åˆ†æ³•ï¼Œç¬¬6æ­¥æˆç«‹æ˜¯å› ä¸ºæ­£æ€åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°ç”±å‡å€¼å’Œæ–¹å·®å†³å®šï¼Œè¿™æ˜¯éå¸¸å¥½çš„ä¸€ä¸ªæ€§è´¨ï¼Œé€šè¿‡æ§åˆ¶è¿™ä¸¤ä¸ªå‚æ•°ï¼Œå³å¯æ¥åˆ¶å‡å€¼å’Œæ–¹å·®ä¸­å¿ƒæé™å®šç†æŒ‡å‡ºæ­£æ€åˆ†å¸ƒæ˜¯æŸäº›æ¦‚ç‡åˆ†å¸ƒçš„æé™åˆ†å¸ƒæ­£æ€åˆ†å¸ƒå…·æœ‰$(-\infty,+\infty)$çš„æ”¯æ’‘åŒºé—´ï¼Œä¸”åœ¨æ‰€æœ‰å®šä¹‰äºæ­¤åŒºé—´å†…çš„è¿ç»­å‹æ¦‚ç‡åˆ†å¸ƒä¸­ï¼Œæ­£æ€åˆ†å¸ƒçš„ç†µæœ€å¤§ï¼Œè¿™äº›ä¼˜è‰¯çš„æ€§è´¨ä½¿å¾—æ­£æ€åˆ†å¸ƒåœ¨æœºå™¨å­¦ä¹ ä¸­å¾—åˆ°äº†å¤§é‡çš„ä½¿ç”¨å¤šä¸ªæ­£æ€åˆ†å¸ƒçš„åŠ æƒç»„åˆå¯å½¢æˆé«˜æ–¯æ··åˆæ¨¡å‹ï¼Œæ˜¯æ··åˆæ¨¡å‹çš„ä¸€ç§ï¼Œå®ƒå¯ä»¥é€¼è¿‘ä»»æ„è¿ç»­å‹tåˆ†å¸ƒå®šä¹‰$t$åˆ†å¸ƒå…¶æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸ºå…¶ä¸­$\Gamma$ä¸ºä¼½é©¬å‡½æ•°ï¼Œ$\nu$ä¸ºè‡ªç”±åº¦ï¼Œæ˜¯ä¸€ä¸ªæ­£æ•´æ•°æ˜¾ç„¶ï¼Œå½“$x=0$æ—¶ï¼Œæ¦‚ç‡å¯†åº¦å‡½æ•°æœ‰æå¤§å€¼ä¸”å‡½æ•°æ˜¯å¶å‡½æ•°ï¼Œä¼½é©¬å‡½æ•°æ˜¯é˜¶ä¹˜çš„æ¨å¹¿ï¼Œå°†å…¶ä»æ­£æ•´æ•°æ¨å¹¿åˆ°æ­£å®æ•°ï¼Œé€šè¿‡ç§¯åˆ†å®šä¹‰æ­¤å‡½æ•°çš„å®šä¹‰åŸŸä¸º$(0,+\infty)$ä¸”åœ¨è¯¥å®šä¹‰åŸŸå†…è¿ç»­æ ¹æ®å®šä¹‰ï¼Œæœ‰ä¼½é©¬å‡½æ•°æ»¡è¶³ä¸é˜¶ä¹˜ç›¸åŒçš„é€’æ¨å…³ç³»è¿™å¯ä»¥é€šè¿‡åˆ†éƒ¨ç§¯åˆ†éªŒè¯æ ¹æ®è¿™ä¸¤ä¸ªç»“æœï¼Œå¯¹äº$n \in \mathbb{N}$ï¼Œæœ‰$t$åˆ†å¸ƒæ¦‚ç‡å¯†åº¦å‡½æ•°çš„å½¢çŠ¶ä¸æ­£æ€åˆ†å¸ƒç±»ä¼¼ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºå•§å•§å•§å…¶åˆ†å¸ƒå‡½æ•°ä¸ºå…¶ä¸­ä¸ºè¶…å‡ ä½•å‡½æ•°(Hypergeometric Function)ï¼Œå®šä¹‰ä¸ºä¸Šå›¾æ˜¾ç¤ºäº†å„ç§è‡ªç”±åº¦å–å€¼æ—¶çš„$t$åˆ†å¸ƒæ¦‚ç‡å¯†åº¦å‡½æ•°æ›²çº¿ä»¥åŠæ ‡å‡†æ­£æ€åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°æ›²çº¿$t$åˆ†å¸ƒå…·æœ‰é•¿å°¾çš„ç‰¹ç‚¹ï¼Œåœ¨è¿œç¦»ä¸­å¿ƒç‚¹çš„ä½ç½®ä¾ç„¶æœ‰è¾ƒå¤§çš„æ¦‚ç‡å¯†åº¦å‡½æ•°å€¼ï¼Œä¸”è‡ªç”±åº¦è¶Šå°ï¼Œé•¿å°¾æ€§è¶Šå¼ºéšç€è‡ªç”±åº¦çš„å¢åŠ ï¼Œå®ƒä»¥æ ‡å‡†æ­£æ€åˆ†å¸ƒä¸ºæé™åˆ†å¸ƒè€ƒè™‘$\nu \rightarrow+\infty$æ—¶çš„æé™æƒ…å†µï¼Œæœ‰ä¸Šé¢ç¬¬2æ­¥è¿›è¡Œäº†æ¢å…ƒï¼Œä»¤$t=\frac{1}{\nu}$ï¼Œç¬¬4æ­¥åˆ©ç”¨äº†ç­‰ä»·æ— ç©·å°ï¼ŒåŒæ—¶å› æ­¤$\nu \rightarrow+\infty$æ—¶$t$åˆ†å¸ƒçš„æé™åˆ†å¸ƒæ˜¯æ ‡å‡†æ­£æ€åˆ†å¸ƒ$t$åˆ†å¸ƒå…·æœ‰é•¿å°¾çš„ç‰¹ç‚¹ï¼Œè¿œç¦»æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸­å¿ƒç‚¹çš„ä½ç½®ä»ç„¶æœ‰è¾ƒå¤§çš„æ¦‚ç‡å¯†åº¦å‡½æ•°å€¼ï¼Œå› æ­¤æ›´æ˜“äºäº§ç”Ÿè¿œç¦»å‡å€¼çš„æ ·æœ¬ï¼Œå®ƒåœ¨æœºå™¨å­¦ä¹ ä¸­çš„å…¸å‹åº”ç”¨æ˜¯$t$-SNEé™ç»´ç®—æ³•åˆ†å¸ƒå˜æ¢å·²çŸ¥ä»æŸä¸€æ¦‚ç‡åˆ†å¸ƒçš„éšæœºå˜é‡$X$ï¼Œå¯ä»¥å¯¹å®ƒè¿›è¡Œå˜æ¢ï¼Œå¾—åˆ°æœä»å…¶ä»–æ¦‚ç‡åˆ†å¸ƒçš„éšæœºå˜é‡$Y$ï¼Œå³æ ¹æ®ä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒçš„æ ·æœ¬å¾—åˆ°å¦ä¸€ä¸ªæ¦‚ç‡åˆ†å­˜çš„æ ·æœ¬éšæœºå˜é‡å‡½æ•°å®šä¹‰éšæœºå˜é‡å‡½æ•°æ˜¯ä»¥éšæœºå˜é‡ä¸ºè‡ªå˜é‡çš„å‡½æ•°ï¼Œå®ƒå°†ä¸€ä¸ªéšæœºå˜é‡æ˜ å°„æˆå¦å¤–ä¸€ä¸ªéšæœºå˜é‡ï¼ŒäºŒè€…ä¸€èˆ¬æœ‰ä¸åŒçš„åˆ†å¸ƒå‡è®¾éšæœºå˜é‡$X$çš„æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸ºï¼Œåˆ†å¸ƒå‡½æ•°ä¸ºï¼Œå¯¹äº$X$çš„å‡½æ•°å‡è®¾è¯¥å‡½æ•°ä¸¥æ ¼å•è°ƒï¼Œåå‡½æ•°å­˜åœ¨ä¸”$g^{-1}(x)=h(x)$ï¼Œç°åœ¨è®¡ç®—$Y$æ‰€æœä»çš„æ¦‚ç‡åˆ†å¸ƒé¦–å…ˆè®¡ç®—$Y$çš„åˆ†å¸ƒå‡½æ•°ï¼Œç”±äº$X$çš„åˆ†å¸ƒå‡½æ•°æ˜¯å·²çŸ¥çš„ï¼Œå› æ­¤éœ€è¦å€ŸåŠ©äºå®ƒçš„åˆ†å¸ƒå‡½æ•°ï¼Œå¦‚æœ$g(x)$å•è°ƒå¢ï¼Œæ ¹æ®åˆ†å¸ƒå‡½æ•°çš„å®šä¹‰ï¼Œ$Y$çš„åˆ†å¸ƒå‡½æ•°ä¸ºå³æœ‰å¯¹è¯¥å‡½æ•°è¿›è¡Œæ±‚å¯¼å³å¯å¾—åˆ°$Y$çš„æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼Œæ ¹æ®å˜ä¸Šé™ç§¯åˆ†ä¸å¤åˆå‡½æ•°æ±‚å¯¼å…¬å¼ï¼Œæœ‰å¦‚æœ$g(X)$å•è°ƒé€’å‡ï¼Œåˆ™æœ‰æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸ºæ­¤æ—¶$h^{\prime}(x)&lt;0$ï¼Œç»¼åˆè¿™ä¸¤ç§æƒ…å†µï¼Œæœ‰æœ¬è´¨ä¸Šæ˜¯å®šç§¯åˆ†çš„æ¢å…ƒæ³•ä¾‹å­å‡è®¾éšæœºå˜é‡$X$æœä»å‡åŒ€åˆ†å¸ƒ$U(0,1)$ï¼Œè®¡ç®—$Y=\exp (X)$çš„æ¦‚ç‡åˆ†å¸ƒï¼Œ$X$çš„æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸ºæ ¹æ®å¼$f_{Y}(y)$å®šä¹‰ï¼Œå½“$1 \leqslant y \leqslant \mathrm{e}$æ—¶ï¼Œæœ‰æ ¹æ®å¼$f_{Y}(y)$å¯ä»¥å¾—åˆ°é€†å˜æ¢é‡‡æ ·ç®—æ³•ï¼Œå®ç°å„ç§æ¦‚ç‡åˆ†å¸ƒä¹‹é—´çš„è½¬æ¢ï¼Œå¯¹æœä»ç®€å•åˆ†å¸ƒçš„éšæœºæ•°è¿›è¡Œå˜æ¢ï¼Œå¾—åˆ°æƒ³è¦çš„æ¦‚ç‡åˆ†å¸ƒçš„éšæœºæ•°è¯æ˜: å‡è®¾éšæœºå˜é‡$X$æœä»æ ‡å‡†æ­£æ€åˆ†å¸ƒ$N(0,1)$ï¼Œåˆ™éšæœºå˜é‡$X=\sigma Z+\mu$æœä»æ­£æ€åˆ†å¸ƒ$N\left(\mu, \sigma ^{2}\right)$ä»$Z$åˆ°$X$çš„å˜æ›å‡½æ•°ä¸º$X=\sigma Z+\mu$ï¼Œå…¶åå‡½æ•°ä¸ºåå‡½æ•°çš„å¯¼æ•°ä¸ºåˆ©ç”¨å¼$f_{Y}(y)$ï¼Œ$X$ çš„æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸ºå› æ­¤ï¼Œéšæœºå˜é‡$X$æœä»æ­£æ€åˆ†å¸ƒ$N\left(\mu, \sigma^{2}\right)$é€†å˜æ¢é‡‡æ ·ç®—æ³•é‡‡æ ·åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œé€šå¸¸éœ€è¦ç”ŸæˆæŸç§æ¦‚ç‡åˆ†å¸ƒçš„éšæœºæ•°ï¼Œç§°ä¸ºé‡‡æ ·ï¼Œé‡‡æ ·å¯ä»¥é€šè¿‡æ¦‚ç‡åˆ†å¸ƒå˜æ¢è€Œå®ç°åœ¨è®¡ç®—æœºä¸­ï¼Œèƒ½å¤Ÿç›´æ¥å¾—åˆ°çš„éšæœºæ•°é€šå¸¸æ˜¯å‡åŒ€åˆ†å¸ƒçš„éšæœºæ•°(äº‹å®ä¸Šæ˜¯ä¼ªéšæœºæ•°)ï¼Œå¯¹å®ƒè¿›è¡Œå˜æ¢ï¼Œå¯ä»¥å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„æ¦‚ç‡åˆ†å¸ƒçš„éšæœºæ•°ï¼Œé€†å˜æ¢ç®—æ³•(Inverse Transform Sampling)æ˜¯ä¸€ç§å…¸å‹çš„é‡‡æ ·ç®—æ³•å‡è®¾éšæœºå˜é‡$X$çš„åˆ†å¸ƒå‡½æ•°ä¸ºï¼Œéšæœºå˜é‡$Y$çš„åˆ†å¸ƒå‡½æ•°ä¸ºï¼Œå®ƒä»¬å‡å·²çŸ¥$Y$é€šè¿‡å•è°ƒé€’å¢çš„éšæœºå˜é‡å‡½æ•°$Y=g(X)$å¯¹$X$è¿›è¡Œå˜æ¢è€Œå¾—åˆ°ï¼Œç°åœ¨è¦ç¡®å®šè¯¥å‡½æ•°ï¼Œå·²çŸ¥ç”±äºåˆ†å¸ƒå‡½æ•°æ˜¯å•è°ƒé€’å¢çš„ï¼Œå¯ä»¥è§£å¾—æ ¹æ®$X$å’Œ$Y$çš„åˆ†å¸ƒå‡½æ•°å¯ä»¥ç¡®å®šæ­¤å˜æ¢é‡è¦ç»“è®ºä¸‹é¢å‡è®¾$X$æˆ–$Y$ä¸ºå‡åŒ€åˆ†å¸ƒçš„éšæœºæ•°ï¼Œæ ¹æ®ä¸Šå¼æ¥è®¡ç®—æ­¤å˜æ¢å‡½æ•°ï¼Œå¾—åˆ°å¦‚ä¸‹çš„ä¸¤ä¸ªç»“è®ºç»“è®º1: å‡è®¾éšæœºå˜é‡$X$çš„åˆ†å¸ƒå‡½æ•°ä¸ºï¼Œè¯¥å‡½æ•°æ˜¯ä¸¥æ ¼å•è°ƒå¢å‡½æ•°ï¼Œåˆ™éšæœºå˜é‡$Y=F_{X}(X)$æœä»å‡åŒ€åˆ†å¸ƒ$U(0,1)$ä¸‹é¢ç»™å‡ºè¯æ˜ï¼Œæ ¹æ®åˆ†å¸ƒå‡½æ•°çš„å®šä¹‰ï¼Œæœ‰è¿™å°±æ˜¯å‡åŒ€åˆ†å¸ƒçš„åˆ†å¸ƒå‡½æ•°ï¼Œä¸Šå¼ç¬¬1æ­¥å’Œç¬¬4æ­¥ä½¿ç”¨äº†åˆ†å¸ƒå‡½æ•°çš„å®šä¹‰ï¼Œç¬¬5æ­¥ä½¿ç”¨äº†åå‡½æ•°çš„æ’ç­‰å¼è¿™ä¸€ç»“è®ºç»™å‡ºäº†æ ¹æ®ä¸€ä¸ªå·²çŸ¥æ¦‚ç‡åˆ†å¸ƒçš„éšæœºæ•°æ„é€ å‡åŒ€åˆ†å¸ƒéšæœºæ•°çš„æ–¹æ³•ä¹Ÿå¯ä»¥æ ¹æ®å¼$g^{-1}(y)$æ±‚è§£å‡º$g(X)$ï¼Œç”±äº$Y$æœä»å‡åŒ€åˆ†å¸ƒ$U(0,1)$ï¼Œå› æ­¤$F_{Y}(y)=y$ï¼Œä»è€Œæœ‰å³$g(X)=F_{X}(X)$ç»“è®º2: å‡è®¾éšæœºå˜é‡$X$æœä»å‡åŒ€åˆ†å¸ƒ$U(0,1)$ï¼Œéšæœºå˜é‡$Y$çš„åˆ†å¸ƒå‡½æ•°ä¸ºï¼Œåˆ™éšæœºå˜é‡æœä»æ¦‚ç‡åˆ†å¸ƒ ä¸‹é¢ç»™å‡ºè¯æ˜ï¼Œæ ¹æ®åˆ†å¸ƒå‡½æ•°çš„å®šä¹‰ï¼Œæœ‰ä¸Šå¼ç¬¬1æ­¥åˆ©ç”¨äº†åˆ†å¸ƒå‡½æ•°çš„å®šä¹‰ï¼Œç¬¬4æ­¥æˆç«‹æ˜¯å› ä¸º$X$æœä»å‡åŒ€åˆ†å¸ƒï¼Œå…¶åˆ†å¸ƒå‡½æ•°ä¸ºæ­¤ç»“è®ºç»™å‡ºäº†æ ¹æ®å‡åŒ€åˆ†å¸ƒéšæœºæ•°æ„é€ å‡ºæŸä¸€åˆ†å¸ƒå‡½æ•°å·²çŸ¥çš„æ¦‚ç‡åˆ†å¸ƒéšæœºæ•°çš„æ–¹æ³•ï¼Œåªéœ€è¦å°†å‡åŒ€åˆ†å¸ƒéšæœºæ•°$X$ç”¨ç›®æ ‡æ¦‚ç‡åˆ†å¸ƒçš„åå‡½æ•°è¿›è¡Œæ˜ å°„åŒæ ·ï¼Œæ ¹æ®å¼$g^{-1}(y)$å¯ä»¥ç›´æ¥è§£å‡º$g(X)$ï¼Œç”±äº$X$æœä»å‡åŒ€åˆ†å¸ƒï¼Œå› æ­¤ä»è€Œæœ‰å³ä¾‹å­ä¸‹é¢ä»¥æŒ‡æ•°åˆ†å¸ƒä¸ºä¾‹è¯´æ˜é€†å˜æ¢é‡‡æ ·ç®—æ³•ï¼Œå…¶åˆ†å¸ƒå‡½æ•°ä¸ºå…¶åå‡½æ•°ä¸ºé¦–å…ˆäº§ç”Ÿå‡åŒ€åˆ†å¸ƒ$U(0,1)$çš„éšæœºæ•°$u$ï¼Œç„¶åè®¡ç®—åˆ™$x$å°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„æŒ‡æ•°åˆ†å¸ƒçš„éšæœºæ•°é€†å˜æ¢é‡‡æ ·ç®—æ³•å¯ä»¥æ ¹æ®å‡åŒ€åˆ†å¸ƒçš„éšæœºæ•°ç”Ÿæˆä»»æ„æ¦‚ç‡åˆ†å¸ƒçš„éšæœºæ•°ï¼Œä½†å®ç°æ—¶å¯èƒ½å­˜åœ¨å›°éš¾å¯¹äºæŸäº›æ¦‚ç‡åˆ†å¸ƒï¼Œæˆ‘ä»¬æ— æ³•å¾—åˆ°åˆ†å¸ƒå‡½æ•°åå‡½æ•°$F_{Y}^{-1}(x)$çš„è§£æè¡¨è¾¾å¼ï¼Œå¦‚æ­£æ€åˆ†å¸ƒéšæœºå‘é‡å‘é‡æ˜¯æ ‡é‡çš„æ¨å¹¿ï¼Œå°†éšæœºå˜é‡æ¨å¹¿åˆ°å¤šç»´å³ä¸ºéšæœºå‘é‡ï¼Œæ¯ä¸ªåˆ†é‡éƒ½æ˜¯éšæœºå˜é‡ï¼Œå› æ­¤éšæœºæœºå‘é‡æ˜¯å¸¦æœ‰æ¦‚ç‡å€¼çš„å‘é‡æè¿°éšæœºå‘é‡çš„æ˜¯å¤šç»´æ¦‚ç‡åˆ†å¸ƒç¦»æ•£å‹éšæœºå‘é‡æ¨å¹¿åˆ°å¤šä¸ªå˜é‡å¯ä»¥å¾—åˆ°éšæœºå‘é‡ï¼Œéšæœºå‘é‡$\boldsymbol{x}$æ˜¯ä¸€ä¸ªå‘é‡ï¼Œå®ƒçš„æ¯ä¸ªåˆ†é‡éƒ½æ˜¯éšæœºå˜é‡ï¼Œå„åˆ†é‡ä¹‹é—´å¯èƒ½å­˜åœ¨ç›¸å…³æ€§ä¾‹å¦‚ï¼Œæè¿°ä¸€ä¸ªäººçš„åŸºæœ¬ä¿¡æ¯çš„å‘é‡$(æ€§åˆ« \quad å¹´é¾„ \quad å­¦å† \quad æ”¶äºº)$ï¼Œæ˜¯ä¸€ä¸ªéšæœºå‘é‡ï¼Œå„ä¸ªåˆ†é‡ä¹‹é—´å­˜åœ¨ä¾èµ–å…³ç³»ï¼Œæ”¶å…¥ä¸å­¦å†ã€å¹´é¾„æœ‰å…³æ€§åˆ«ä¸ºç”·å’Œå¥³çš„æ¦‚ç‡å„ä¸º$0.5$ï¼Œå¹´é¾„ä¸º$0$å’Œ$120$ä¹‹é—´çš„æ•´æ•°ï¼Œæœä»å„å¹´é¾„æ®µçš„äººå£ç»Ÿè®¡åˆ†å¸ƒè§„å¾‹éšæœºå‘é‡ä¹Ÿåˆ†ä¸ºç¦»æ•£å‹å’Œè¿ç»­å‹ä¸¤ç§æƒ…å†µï¼Œæè¿°ç¦»æ•£å‹éšæœºå‘é‡åˆ†å¸ƒçš„æ˜¯è”åˆæ¦‚ç‡è´¨é‡å‡½æ•°ï¼Œæ˜¯æ¦‚ç‡è´¨é‡å‡½æ•°çš„æ¨å¹¿å®šä¹‰äº†éšæœºå‘é‡å–æ¯ä¸ªå€¼çš„æ¦‚ç‡å¯¹äºäºŒç»´ç¦»æ•£å‹éšæœºå‘é‡ï¼Œè”åˆæ¦‚ç‡è´¨é‡å‡½æ•°æ˜¯ä¸€ä¸ªäºŒç»´è¡¨(çŸ©é˜µ)ï¼Œæ¯ä¸ªä½ç½®å¤„çš„å…ƒç´ ä¸ºéšæœºå‘é‡$x$å–è¯¥ä½ç½®å¯¹åº”å€¼çš„æ¦‚ç‡è”åˆæ¦‚ç‡è´¨é‡å‡½æ•°å¿…é¡»æ»¡è¶³å¦‚ä¸‹çº¦æŸä¸‹è¡¨æ˜¯ä¸€ä¸ªäºŒç»´éšæœºå‘é‡çš„è”åˆæ¦‚ç‡è´¨é‡å‡½æ•°X \ Y123410.10.10.10.020.250.00.150.0530.10.150.00.0è¡¨ä¸­ç¬¬3è¡Œç¬¬4åˆ—çš„å…ƒç´ è¡¨ç¤º$X$å–å€¼ä¸º$2$ã€$Y$å–å€¼ä¸º3çš„æ¦‚ç‡ä¸º$0.15$è¾¹ç¼˜åˆ†å¸ƒå¯¹è”åˆæ¦‚ç‡è´¨é‡å‡½æ•°ä¸­æŸäº›å˜é‡çš„æ‰€æœ‰å–å€¼æƒ…å†µæ±‚å’Œï¼Œå¯ä»¥å¾—åˆ°è¾¹ç¼˜æ¦‚ç‡è´¨é‡å‡½æ•°(Marginal Probability Mass Function)ï¼Œä¹Ÿç§°ä¸ºè¾¹ç¼˜åˆ†å¸ƒå¯¹äºäºŒç»´éšæœºå‘é‡ï¼Œå¯¹$X$å’Œ$Y$åˆ†åˆ«æ±‚å’Œå¯ä»¥å¾—åˆ°å¦å¤–ä¸€ä¸ªå˜é‡çš„è¾¹ç¼˜åˆ†å¸ƒæœ‰æ—¶å€™ä¼šå°†$p_{X}(x)$ç®€å†™ä¸º$p(x)$å¯¹äºä¸Šè¡¨æ‰€ç¤ºçš„è”åˆæ¦‚ç‡è´¨é‡å‡½æ•°ï¼Œå…¶è¾¹ç¼˜åˆ†å¸ƒå‡½æ•°ä¸‹è¡¨æ‰€ç¤ºX12310.30.450.25Y123410.450.250.250.05å¯¹$X$çš„è¾¹ç¼˜åˆ†å¸ƒæ˜¯å¯¹è”åˆæ¦‚ç‡è´¨é‡å‡½æ•°æŒ‰è¡Œæ±‚å’Œçš„ç»“æœï¼Œè¾¹ç¼˜åˆ†å¸ƒå¯çœ‹ä½œæ˜¯å°†è”åˆæ¦‚ç‡è´¨é‡å‡½æ•°æŠ•å½±åˆ°æŸä¸€ä¸ªåæ ‡è½´åçš„ç»“æœå¯¹$Y$çš„è¾¹ç¼˜åˆ†å¸ƒå‡½æ•°æ˜¯å¯¹è”åˆæ¦‚ç‡è´¨é‡å‡½æ•°æŒ‰åˆ—æ±‚å’Œçš„ç»“æœ$n$ç»´ä¸‹çš„è¾¹ç¼˜åˆ†å¸ƒä¸‹é¢å°†è¾¹ç¼˜åˆ†å¸ƒæ¨å¹¿åˆ°éšæœºå‘é‡çš„å¤šä¸ªåˆ†é‡ï¼Œæœ‰$n$ç»´éšæœºå‘é‡$\boldsymbol{x}$ï¼Œå°†å®ƒæ‹†åˆ†æˆå­å‘é‡ å’Œå¯¹çš„è¾¹ç¼˜åˆ†å¸ƒæ˜¯å¯¹çš„æ‰€æœ‰åˆ†é‡å–å„ä¸ªå€¼æ—¶çš„è”åˆæ¦‚ç‡è´¨é‡å‡½æ•°æ±‚å’Œçš„ç»“æœç±»ä¼¼åœ°æœ‰ç±»ä¼¼äºæ¡ä»¶æ¦‚ç‡,æ¡ä»¶åˆ†å¸ƒå®šä¹‰ä¸ºæœ‰æ—¶å€™ä¼šå°†$p_{X \mid Y}(x \mid y)$ç®€å†™ä¸º$p(x \mid y)$ ï¼Œå°†æ¡ä»¶åˆ†å¸ƒæ¨å¹¿åˆ°éšæœºå‘é‡çš„å¤šä¸ªåˆ†é‡ï¼ŒæŒ‰ç…§æœ¬èŠ‚å‰é¢çš„éšæœºå‘é‡æ‹†åˆ†æ–¹æ¡ˆï¼Œæœ‰å¯¹äºäºŒç»´éšæœºå‘é‡, å¦‚æœå¯¹$\forall x, y$æ»¡è¶³æˆ–è€…å†™æˆåˆ™ç§°éšæœºå˜é‡$X$å’Œ$Y$ç›¸äº’ç‹¬ç«‹ï¼Œè¿™ä¸éšæœºäº‹ä»¶ç‹¬ç«‹æ€§çš„å®šä¹‰ä¸€è‡´æ¨å¹¿åˆ°$n$ç»´éšæœºå‘é‡ï¼Œå¦‚æœæ»¡è¶³åˆ™ç§°è¿™äº›éšæœºå˜é‡ç›¸äº’ç‹¬ç«‹ï¼Œå¯¹äºç¦»æ•£å‹éšæœºå˜é‡ï¼Œè´å¶æ–¯å…¬å¼åŒæ ·é€‚ç”¨è€ƒè™‘ä¸‹è¡¨çš„è”åˆæ¦‚ç‡è´¨é‡å‡½æ•°X \ Y1231$\frac{1}{12}$$\frac{4}{12}$$\frac{1}{12}$2$\frac{1}{12}$$\frac {4}{12}$$\frac{1}{12}$å¯¹$X$çš„è¾¹ç¼˜åˆ†å¸ƒå¦‚è¡¨æ‰€ç¤ºX121$\frac{1}{2}$$\frac{1}{2}$å¯¹$Y$çš„è¾¹ç¼˜åˆ†å¸ƒå¦‚è¡¨æ‰€ç¤ºY1231$\frac{1}{6}$$\frac{2}{3}$$\frac{1}{6}$å¯ä»¥éªŒè¯å¯¹æ‰€æœ‰$X$å’Œ$Y$å–å€¼å’Œï¼Œæœ‰ä¾‹å¦‚å› æ­¤$X$å’Œ$Y$ç›¸äº’ç‹¬ç«‹è¿ç»­å‹éšæœºå‘é‡æè¿°è¿ç»­å‹éšæœºå‘é‡çš„æ˜¯è”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°ï¼Œæ˜¯æ¦‚ç‡å¯†åº¦å‡½æ•°çš„æ¨å¹¿ï¼Œè”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°å¿…é¡»æ»¡è¶³å¦‚ä¸‹çº¦æŸæ¡ä»¶ç¬¬2ä¸ªç­‰å¼ä¸º$n$é‡ç§¯åˆ†ï¼Œå¯¹äºäºŒç»´éšæœºå‘é‡ï¼Œå…¶è”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°æ»¡è¶³çš„çº¦æŸæ¡ä»¶ä¸ºè¿ç»­å‹éšæœºå‘é‡åœ¨æŸä¸€ç‚¹å¤„çš„æ¦‚ç‡ä¸º0åˆ†å¸ƒå‡½æ•°ä¸ºè”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°å¯¹æ‰€æœ‰å˜é‡çš„å˜ä¸Šé™ç§¯åˆ†ï¼Œå¯¹äºäºŒç»´éšæœºå‘é‡ï¼Œåˆ†å¸ƒå‡½æ•°ä¸ºè¾¹ç¼˜æ¦‚ç‡å¯†åº¦å‡½æ•°è¾¹ç¼˜æ¦‚ç‡å¯†åº¦å‡½æ•°(Marginal Probability Density Function)å°†ç¦»æ•£å‹éšæœºå‘é‡è¾¹ç¼˜æ¦‚ç‡è´¨é‡å‡½æ•°è®¡ç®—å…¬å¼ä¸­çš„æ±‚å’Œæ¢æˆç§¯åˆ†å¯¹æ¯ä¸ªéšæœºå˜é‡çš„è¾¹ç¼˜å¯†åº¦ä¸ºå¯¹å…¶ä»–å˜é‡ç§¯åˆ†åçš„ç»“æœï¼Œå¯¹äºäºŒç»´éšæœºå‘é‡ä¸ºä¸‹é¢å°†è¾¹ç¼˜æ¦‚ç‡å¯†åº¦å‡½æ•°æ¨å¹¿åˆ°éšæœºå‘é‡çš„å¤šä¸ªåˆ†é‡ï¼Œæœ‰$n$ç»´éšæœºå‘é‡$x$ï¼Œå°†å®ƒæ‹†åˆ†æˆå­å‘é‡å’Œå¯¹çš„è¾¹ç¼˜æ¦‚ç‡å¯†åº¦å‡½æ•°æ˜¯è”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°å¯¹çš„æ‰€æœ‰åˆ†é‡æ±‚ç§¯åˆ†çš„ç»“æœç±»ä¼¼åœ°æœ‰æœ‰æ—¶ä¼šå°†$f_{X}(x)$ç®€å†™ä¸º$f(x)$è¾¹ç¼˜ç´¯ç§¯åˆ†å¸ƒå‡½æ•°è¾¹ç¼˜ç´¯ç§¯åˆ†å¸ƒå‡½æ•°(Marginal Cumulative Distribution Function )åˆ™ä¸ºè¾¹ç¼˜å¯†åº¦çš„ç§¯åˆ†ï¼Œç±»ä¼¼äºå•éšæœºå˜é‡çš„æƒ…å†µå¯¹äºäºŒç»´éšæœºå‘é‡ï¼Œè¾¹ç¼˜ç´¯ç§¯åˆ†å¸ƒå‡½æ•°ä¸ºå¯¹äºäºŒç»´éšæœºå˜é‡æ¡ä»¶æ¦‚ç‡å¯†åº¦å‡½æ•°å®šä¹‰ä¸ºé€šå¸¸æƒ…å†µä¸‹ï¼Œåœ¨ä½¿ç”¨æ¡ä»¶å¯†åº¦å‡½æ•°$f_{X \mid Y}(x \mid y)$æ—¶ï¼Œ$y$çš„å€¼æ˜¯å·²çŸ¥çš„æœ‰æ—¶ä¼šå°†$f_{X \mid Y}(x \mid y)$ç®€å†™ä¸º$f(x \mid y)$å°†æ¡ä»¶æ¦‚ç‡å¯†åº¦å‡½æ•°æ¨å¹¿åˆ°éšæœºå‘é‡çš„å¤šä¸ªåˆ†é‡ï¼ŒæŒ‰ç…§æœ¬èŠ‚å‰é¢çš„éšæœºå‘é‡æ‹†åˆ†æ–¹æ¡ˆï¼Œæœ‰éšæœºå‘é‡çš„è”åˆæ¦‚ç‡ç¬¦åˆé“¾å¼æ³•åˆ™æ¡ä»¶åˆ†å¸ƒå‡½æ•°æ˜¯å¯¹æ¡ä»¶å¯†åº¦å‡½æ•°çš„ç§¯åˆ†ï¼Œå¯¹äºäºŒç»´éšæœºå‘é‡ï¼Œå®šä¹‰ä¸ºå¯¹äºä¸¤ä¸ªéšæœºå˜é‡$(X, Y)$ï¼Œå¦‚æœä¸‹å¼å‡ ä¹å¤„å¤„æˆç«‹(ä¸æˆç«‹ç‚¹ä¸ºæœ‰é™é›†æˆ–æ— é™å¯æ•°é›†ï¼‰åˆ™ç§°å®ƒä»¬ç›¸äº’ç‹¬ç«‹å¯¹äº$n$ç»´éšæœºå‘é‡ï¼Œå¦‚æœä¸‹å¼å‡ ä¹å¤„å¤„æˆç«‹åˆ™ç§°å®ƒä»¬ç›¸äº’ç‹¬ç«‹ç‹¬ç«‹åŒåˆ†å¸ƒå¦‚æœä¸€ç»„éšæœºå˜é‡ç›¸äº’ä¹‹é—´ç‹¬ç«‹ï¼Œä¸”æœä»åŒä¸€ç§æ¦‚ç‡åˆ†å¸ƒï¼Œåˆ™ç§°å®ƒä»¬ç‹¬ç«‹åŒåˆ†å¸ƒ(Independent And Identically Distributed, IID )åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œä¸€èˆ¬å‡è®¾å„ä¸ªæ ·æœ¬ä¹‹é—´ç‹¬ç«‹ åŒåˆ†å¸ƒï¼Œå¦‚æœæ ·æœ¬é›†$x_{i}, i=1, \cdots, l$ç‹¬ç«‹åŒåˆ†å¸ƒï¼Œå‡æœä»æ¦‚ç‡åˆ†å¸ƒ$p(\boldsymbol{x})$ï¼Œåˆ™å®ƒä»¬çš„è”åˆæ¦‚ç‡ä¸ºåœ¨å‚æ•°ä¼°è®¡å¦‚æœ€å¤§ä¼¼ç„¶ä¼°è®¡ï¼Œä»¥åŠå„ç§æœºå™¨å­¦ä¹ ã€æ·±åº¦å­¦ä¹ ç®—æ³•ä¸­ï¼Œç»å¸¸ä½¿ç”¨æ­¤å‡è®¾ï¼Œä»¥ç®€åŒ–è”åˆæ¦‚ç‡çš„è®¡ç®—è´å¶æ–¯å…¬å¼å¯¹äºè¿ç»­å‹éšæœºå˜é‡åŒæ ·é€‚ç”¨ï¼Œå¦‚æœ$X, Y$å‡ä¸ºè¿ç»­å‹éšæœºå˜é‡ï¼Œå®ƒä»¬çš„è”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°ä¸º$f(x, y)$ï¼Œåˆ™æœ‰åœ¨è´å¶æ–¯åˆ†ç±»å™¨ç­‰æ¨æ–­ç®—æ³•ä¸­è¿™ä¸ªå…¬å¼ç»å¸¸è¢«ä½¿ç”¨æ•°å­¦æœŸæœ›éšæœºå‘é‡çš„æ•°å­¦æœŸæœ›$\mu$æ˜¯ä¸€ä¸ªå‘é‡ï¼Œå®ƒçš„åˆ†é‡æ˜¯å¯¹å•ä¸ªéšæœºå˜é‡çš„æ•°å­¦æœŸæœ›å…¶å…·ä½“çš„è®¡ç®—æ–¹å¼ä¸éšæœºå˜é‡ç›¸åŒï¼Œå¯¹äºç¦»æ•£å‹éšæœºå‘é‡ï¼Œåˆ†é‡$x_{i}$çš„æ•°å­¦æœŸæœ›ä¸ºå¯¹äºè¿ç»­å‹éšæœºå‘é‡ï¼Œåˆ†é‡çš„æ•°å­¦æœŸæœ›ä¸º$n$é‡ç§¯åˆ†å¯¹äºä¸‹è¡¨ä¸­çš„éšæœºå‘é‡X \ Y123410.10.10.10.020.250.00.150.0530.10.150.00.0å…¶å¯¹$X$çš„æ•°å­¦æœŸæœ›ä¸ºç±»ä¼¼åœ°å¯ä»¥å®šä¹‰éšæœºå‘é‡å‡½æ•°çš„æ•°å­¦æœŸæœ›ï¼Œå¯¹äºç¦»æ•£å‹éšæœºå‘é‡$\boldsymbol{x}$ï¼Œå®šä¹‰ä¸ºå¯¹äºè¿ç»­å‹éšæœºå‘é‡$\boldsymbol{x}, g(\boldsymbol{x})$çš„æ•°å­¦æœŸæœ›ä¸ºæ ¹æ®æ•°å­¦æœŸæœ›çš„å®šä¹‰å¯ä»¥è¯æ˜å¦‚æœä¸¤ä¸ªéšæœºå˜é‡$X$å’Œ$Y$ç›¸äº’ç‹¬ç«‹ï¼Œåˆ™ä¸‹é¢å¯¹è¿ç»­å‹æ¦‚ç‡åˆ†å¸ƒè¿›è¡Œè¯æ˜ï¼Œå‡è®¾$X$å’Œ$Y$çš„è”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°ä¸º$f(x, y)$ï¼Œç”±äºç›¸äº’ç‹¬ç«‹ï¼Œå› æ­¤æ ¹æ®æ•°å­¦æœŸæœ›çš„å®šä¹‰ï¼Œæœ‰å¯¹äºéšæœºå‘é‡å‡½æ•°ï¼Œæœ‰åæ–¹å·®å®šä¹‰åæ–¹å·®(Covariance, cov)æ˜¯æ–¹å·®å¯¹ä¸¤ä¸ªéšæœºå˜é‡çš„æ¨å¹¿ï¼Œå®ƒåæ˜ äº†ä¸¤ä¸ªéšæœºå˜é‡$X$ä¸$Y$è”åˆå˜åŠ¨çš„ç¨‹åº¦åæ–¹å·®å®šä¹‰ä¸ºæ˜¯ä¸¤ä¸ªéšæœºå˜é‡å„è‡ªçš„åå·®ä¹‹ç§¯çš„æ•°å­¦æœŸæœ›ï¼Œå¯¹äºç¦»æ•£å‹éšæœºå˜é‡ï¼Œåæ–¹å·®çš„è®¡ç®—å…¬å¼ä¸ºä¾‹å¦‚å¯¹äºå¦‚ä¸‹çš„æ¦‚ç‡åˆ†å¸ƒX \ Y1231$\frac {1}{4}$$\frac {1}{4}$020$\frac {1}{4}$$\frac {1}{4}$å¯ä»¥å¾—åˆ°$X$çš„è¾¹ç¼˜æ¦‚ç‡åˆ†å¸ƒä¸ºX121$\frac {1}{2}$$\frac {1}{2}$$X$çš„æ•°å­¦æœŸæœ›ä¸ºå¯ä»¥å¾—åˆ°$Y$çš„è¾¹ç¼˜æ¦‚ç‡åˆ†å¸ƒä¸ºY1231$\frac {1}{4}$$\frac {1}{2}$$\frac {1}{4}$$Y$çš„æ•°å­¦æœŸæœ›ä¸ºæ ¹æ®å®šä¹‰ï¼Œåæ–¹å·®ä¸ºå¯¹äºè¿ç»­å‹éš¨æœºå˜é‡ï¼Œåæ–¹å·®çš„è®¡ç®—å…¬å¼ä¸ºéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåæ–¹å·®ä¸èƒ½ä¿è¯æ˜¯éè´Ÿçš„æ ¹æ®å®šä¹‰ï¼Œåæ–¹å·®å…·æœ‰å¯¹ç§°æ€§å¯ä»¥è¯æ˜ä¸‹å¼æˆç«‹æ ¹æ®å®šä¹‰ï¼Œæœ‰é€šå¸¸ç”¨å¼$\operatorname{cov}(X, Y)=E[X Y]-E[X] E[Y]$è®¡ç®—åæ–¹å·®ï¼Œæ ¹æ®å®šä¹‰ï¼Œä¸€ä¸ªéšæœºå˜é‡ä¸å…¶è‡ªèº«çš„åæ–¹å·®å°±æ˜¯è¯¥éšæœºå˜é‡çš„æ–¹å·®æ ¹æ®åæ–¹å·®çš„å®šä¹‰ï¼Œå¯ä»¥è¯æ˜ä¸‹é¢çš„ç­‰å¼æˆç«‹ä¾‹å­ä¸‹é¢è®¡ç®—ä¸¤ä¸ªç¦»æ•£å‹éšæœºå˜é‡åœ¨å–å€¼ä¸ºæœ‰é™ç§å¯èƒ½ï¼Œä¸”å–æ¯ç§å€¼çš„æ¦‚ç‡ç›¸ç­‰æ—¶çš„åæ–¹å·®æœ‰éšæœºå‘é‡$(X, Y)$ï¼Œå…¶å–å€¼ä¸ºå–æ¯ä¸€å¯¹å€¼çš„æ¦‚ç‡ç›¸ç­‰ï¼Œå³$p_{i}=\frac{1}{n}$ï¼Œåˆ™è¿™ä¸¤ä¸ªéšæœºå˜é‡çš„åæ–¹å·®ä¸ºå¯è¿›ä¸€æ­¥ç®€åŒ–ä¸ºå¦‚æœä¸¤ä¸ªéšæœºå˜é‡çš„åæ–¹å·®ä¸º0ï¼Œåˆ™ç§°å®ƒä»¬ä¸ç›¸å…³(Uncorrelated)ï¼Œå¦‚æœä¸¤ä¸ªéšæœºå˜é‡ç›¸äº’ç‹¬ç«‹ï¼Œåˆ™å®ƒä»¬çš„åæ–¹å·®ä¸º0å› æ­¤ï¼Œç›¸äº’ç‹¬ç«‹çš„éšæœºå˜é‡ä¸€å®šä¸ç›¸å…³ä¸¤ä¸ªéšæœºå˜é‡çš„åæ–¹å·®ä¸º0ï¼Œä¸èƒ½æ¨å¯¼å‡ºè¿™ä¸¤ä¸ªéšæœºå˜é‡ç›¸äº’ç‹¬ç«‹ä¾‹å¦‚$X$æœä»å‡åŒ€åˆ†å¸ƒ$U(-1,1)$ï¼Œä»¤$Y=X^{2}$ï¼Œåˆ™æœ‰ä½†$X$å’Œ$Y$ä¸ç›¸äº’ç‹¬ç«‹ï¼Œå®ƒä»¬ä¹‹é—´å­˜åœ¨ç¡®å®šçš„éçº¿æ€§å…³ç³»ï¼Œåæ–¹å·®è¡¡é‡çš„æ˜¯çº¿æ€§ç›¸å…³æ€§ï¼Œåæ–¹å·®ä¸º0åªèƒ½è¯´æ˜ä¸¤ä¸ªéšæœºå˜é‡çº¿æ€§ç‹¬ç«‹å¦‚æœä¸¤ä¸ªéšæœºå˜é‡æœä»æ­£æ€åˆ†å¸ƒï¼Œåˆ™ä¸ç›¸å…³ä¸ç‹¬ç«‹ç­‰ä»·ï¼Œå¯¹äºä¸¤ä¸ªéšæœºå˜é‡$X$å’Œ$Y$ï¼Œæœ‰æ ¹æ®æ–¹å·®çš„å®šä¹‰ï¼Œæœ‰æ¨å¹¿åˆ°å¤šä¸ªéšæœºå˜é‡ï¼Œå¯¹äºéšæœºå˜é‡ï¼Œæœ‰å¦‚æœä¸¤ä¸ªéšæœºå˜é‡$X$å’Œ$Y$ç›¸äº’ç‹¬ç«‹ï¼Œå®ƒä»¬ä¹‹å’Œçš„æ–¹å·®ç­‰äºå„è‡ªçš„æ–¹å·®ä¹‹å’Œæ¨å¹¿åˆ°å¤šä¸ªéšæœºå˜é‡ï¼Œå¦‚æœç›¸äº’ç‹¬ç«‹ï¼Œåˆ™æœ‰åæ–¹å·®çŸ©é˜µå¯¹äº$n$ç»´éšæœºå‘é‡$\boldsymbol{x}$ï¼Œå…¶ä»»æ„ä¸¤ä¸ªåˆ†é‡å’Œä¹‹é—´çš„åæ–¹å·®ç»„æˆçš„çŸ©é˜µç§°ä¸ºåæ–¹å·®çŸ©é˜µç”±äºåæ–¹å·®å…·æœ‰å¯¹ç§°æ€§ï¼Œå› æ­¤åæ–¹å·®çŸ©é˜µæ˜¯å¯¹ç§°çŸ©é˜µè¿›ä¸€æ­¥å¯ä»¥è¯æ˜ï¼Œåæ–¹å·®çŸ©é˜µæ˜¯åŠæ­£å®šçŸ©é˜µï¼Œä¸‹é¢å¯¹è¿ç»­å‹æ¦‚ç‡åˆ†å¸ƒè¿›è¡Œè¯æ˜ï¼Œå¯¹äºç¦»æ•£å‹æ¦‚ç‡åˆ†å¸ƒæ–¹æ³•ç±»ä¼¼å‡è®¾æœ‰$n$ç»´éšæœºå‘é‡$x$ï¼Œå…¶è”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°ä¸º$f(\boldsymbol{x})$ï¼Œåæ–¹å·®çŸ©é˜µä¸º$\boldsymbol{\Sigma}$ï¼Œå¯¹äºä»»æ„é$\boldsymbol{0}$å‘é‡$\boldsymbol{y}$ï¼Œæœ‰å› æ­¤$\Sigma$åŠæ­£å®šï¼Œåæ–¹å·®çŸ©é˜µçš„åŠæ­£å®šæ€§ä¸æ–¹å·®çš„éè´Ÿæ€§æ˜¯ç»Ÿä¸€çš„å¸¸ç”¨æ¦‚ç‡åˆ†å¸ƒå¤šç»´å‡åŒ€åˆ†å¸ƒæ˜¯ä¸€ç»´å‡åŒ€åˆ†å¸ƒçš„æ¨å¹¿ï¼Œåœ¨å°é—­åŒºåŸŸ$D$å†…ï¼Œè”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°ä¸ºé0å¸¸æ•°ï¼›åœ¨æ­¤èŒƒå›´ä¹‹å¤–ï¼Œè”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°å–å€¼ä¸º0ï¼Œå…¶è”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°ä¸ºå…¶ä¸­$s(D)$ä¸ºå°é—­åŒºåŸŸ$D$çš„æµ‹åº¦ï¼Œå¯¹äºä¸€ç»´å‘é‡æ˜¯åŒºé—´çš„é•¿åº¦ï¼Œå¯¹äºäºŒç»´å‘é‡æ˜¯åŒºåŸŸçš„é¢ç§¯ï¼Œå¯¹äºä¸‰ç»´å‘é‡æ˜¯åŒºåŸŸçš„ä½“ç§¯å¤šç»´æ­£æ€åˆ†å¸ƒ(Multivariate Normal Distribution)åœ¨æœºå™¨å­¦ä¹ ä¸­è¢«å¹¿æ³›ä½¿ç”¨ï¼Œå°†ä¸€ç»´çš„æ­£æ€ åˆ†å¸ƒæ¨å¹¿åˆ°é«˜ç»´, å¯ä»¥å¾—åˆ°å¤šç»´æ­£æ€åˆ†å¸ƒæ¦‚ç‡å¯†åº¦å‡½æ•°å…¶ä¸­$x$ä¸º$n$ç»´éšæœºå‘é‡ï¼Œ$\mu$ä¸º$n$ç»´å‡å€¼å‘é‡ï¼Œ$\Sigma$ä¸º$n$é˜¶åæ–¹å·®çŸ©é˜µï¼Œé€šå¸¸è¦æ±‚åæ–¹å·®çŸ©é˜µæ­£å®šè¿™ä¸ä¸€ç»´æ­£æ€åˆ†å¸ƒ$N\left(\mu, \sigma^{2}\right)$æ¦‚ç‡å¯†åº¦å‡½æ•°çš„è¡¨è¾¾å¼åœ¨å½¢å¼ä¸Šæ˜¯ç»Ÿä¸€çš„ï¼Œå‡å€¼ä¸º$\mu$ï¼Œåæ–¹å·®ä¸º${\Sigma}$çš„æ­£æ€åˆ†å¸ƒç®€è®°ä¸º$N(\boldsymbol{\mu}, \boldsymbol{\Sigma})$å¦‚æœ$n=1, \boldsymbol{\mu}=\mu, \boldsymbol{\Sigma}=\sigma^{2}$ï¼Œåˆ™ä¸Šå¼å³ä¸ºä¸€ç»´æ­£æ€åˆ†å¸ƒ$N\left(\mu, \sigma^{2}\right)$ä¸Šå¼æ¦‚ç‡å¯†åº¦å‡½æ•°åœ¨ $\mathbb{R}^{n}$ å†…çš„ç§¯åˆ†å€¼ä¸º1å¦‚æœ$\mu=0, \Sigma=I$åˆ™ç§°ä¸ºæ ‡å‡†æ­£æ€åˆ†å¸ƒï¼Œç®€è®°ä¸º$N(0, I)$è”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°ä¸ºæ­¤æ—¶éšæœºå‘é‡çš„å„ä¸ªåˆ†é‡ç›¸äº’ç‹¬ç«‹ï¼Œä¸”å‡æœä»ä¸€ç»´æ ‡å‡†æ­£æ€åˆ†å¸ƒ$N(0,1)$ï¼ŒäºŒç»´æ­£æ€åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°å¦‚å›¾æ‰€ç¤ºï¼Œæ˜¯é’Ÿå½¢æ›²é¢ï¼Œåœ¨å‡å€¼ç‚¹å¤„æœ‰æå¤§å€¼ï¼Œè¿œç¦»å‡å€¼ç‚¹æ—¶ï¼Œå‡½æ•°å€¼é€’å‡ äºŒç»´æ­£æ€åˆ†å¸ƒä¸‹é¢è€ƒè™‘äºŒç»´æ­£æ€åˆ†å¸ƒï¼Œå…¶æ¦‚ç‡å¯†åº¦å‡½æ•°å¯ä»¥å†™æˆä¸‹é¢çš„å½¢å¼å…¶å‡å€¼å‘é‡ä¸ºp271-p276æé™å®šç†åˆ‡æ¯”é›ªå¤«ä¸ç­‰å¼å¤§æ•°å®šç†ä¸­å¿ƒæé™å®šç†å‚æ•°ä¼°è®¡åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œé€šå¸¸å‡è®¾éšæœºå˜é‡æœä»æŸç§æ¦‚ç‡åˆ†å¸ƒ$p(\boldsymbol{x})$ï¼Œä½†è¿™ç§åˆ†å¸ƒçš„å‚æ•°$\theta$æ˜¯æœ«çŸ¥çš„ç®—æ³•éœ€è¦æ ¹æ®ä¸€ç»„æœä»æ­¤æ¦‚ç‡åˆ†å¸ƒçš„æ ·æœ¬æ¥ä¼°è®¡å‡ºæ¦‚ç‡åˆ†å¸ƒçš„å‚æ•°ï¼Œç§°ä¸ºå‚æ•°ä¼°è®¡é—®é¢˜å·²çŸ¥æ¦‚ç‡å¯†åº¦å‡½æ•°å½¢å¼çš„é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨çš„æ˜¯æœ€å¤§ä¼¼ç„¶ä¼°è®¡ã€æœ€å¤§åéªŒæ¦‚ç‡ä¼°è®¡ä»¥åŠè´å¶æ–¯ä¼°è®¡å¦‚æœä¸æŒ‡å®šæ¦‚ç‡å¯†åº¦å‡½æ•°çš„å…·ä½“å½¢å¼ï¼Œåˆ™å¯ç”¨æ ¸å¯†åº¦ä¼°è®¡æŠ€æœ¯ï¼Œè¿™æ˜¯ä¸€ç§æ— å‚çš„æ–¹æ³•æœ€å¤§ä¼¼ç„¶ä¼°è®¡å®šä¹‰æœ€å¤§ä¼¼ç„¶ä¼°è®¡(Maximum Likelihood Estimation, MLE)ä¸ºæ ·æœ¬é›†æ„é€ ä¸€ä¸ªä¼¼ç„¶å‡½æ•°ï¼Œé€šè¿‡è®©ä¼¼ç„¶å‡½æ•°æœ€å¤§åŒ–ï¼Œæ±‚è§£å‡ºå‚æ•°$\theta$å…¶ç›´è§‚è§£é‡Šæ˜¯ï¼Œå¯»æ±‚å‚æ•°çš„å€¼ä½¿å¾—ç»™å®šçš„æ ·æœ¬é›†å‡ºç°çš„æ¦‚ç‡(æˆ–æ¦‚ç‡å¯†åº¦å‡½æ•°å€¼)æœ€å¤§æœ€å¤§ä¼¼ç„¶ä¼°è®¡è®¤ä¸ºä½¿å¾—è§‚æµ‹æ•°æ®(æ ·æœ¬é›†)å‡ºç°æ¦‚ç‡æœ€å¤§çš„å‚æ•°ä¸ºæœ€ä¼˜å‚æ•°ï¼Œè¿™ä¸€æ–¹æ³•ä½“ç°äº†å­˜åœ¨çš„å°±æ˜¯åˆç†çš„è¿™ä¸€æœ´ç´ çš„å“²å­¦æ€æƒ³ï¼šæ—¢ç„¶è¿™ç»„æ ·æœ¬å‡ºç°äº†ï¼Œé‚£ä¹ˆå®ƒä»¬å‡ºç°çš„æ¦‚ç‡ç†åº”æ˜¯æœ€å¤§åŒ–çš„æ–¹æ³•å‡è®¾æ ·æœ¬æœä»çš„æ¦‚ç‡åˆ†å¸ƒä¸º$p(\boldsymbol{x} ; \boldsymbol{\theta})$ï¼Œå…¶ä¸­$x$ä¸ºéšæœºå˜é‡$\theta$ä¸ºè¦ä¼°è®¡çš„å‚æ•°ç»™å®šä¸€ç»„æ ·æœ¬$x_{i}, i=1, \cdots, l$ï¼Œå®ƒä»¬éƒ½æœä»è¿™ç§åˆ†å¸ƒä¸”ç›¸äº’ç‹¬ç«‹ï¼Œå› æ­¤ï¼Œå®ƒä»¬çš„è”åˆæ¦‚ç‡ä¸ºè¿™ä¸ªè”åˆæ¦‚ç‡ä¹Ÿç§°ä¸ºä¼¼ç„¶å‡½æ•°ï¼Œå…¶ä¸­$x_{i}$æ˜¯å·²çŸ¥é‡ï¼Œ$\theta$æ˜¯å¾…ç¡®å®šçš„æœ«çŸ¥æ•°ï¼Œä¼¼ç„¶å‡½æ•°æ˜¯ä¼˜åŒ–å˜é‡$\theta$çš„å‡½æ•°ç›®æ ‡æ˜¯è®©è¯¥å‡½æ•°çš„å€¼æœ€å¤§åŒ–ï¼Œè¿™æ ·åšçš„ä¾æ®æ˜¯è¿™ç»„æ ·æœ¬å‡ºç°äº†ï¼Œå› æ­¤åº”è¯¥æœ€å¤§åŒ–å®ƒä»¬å‡ºç°çš„æ¦‚ç‡å³æ±‚è§£å¦‚ä¸‹æœ€ä¼˜åŒ–é—®é¢˜æ±‚è§£é©»ç‚¹æ–¹ç¨‹å¯ä»¥å¾—åˆ°é—®é¢˜çš„è§£ä¹˜ç§¯æ±‚å¯¼ä¸æ˜“å¤„ç†ä¸”è¿ä¹˜å®¹æ˜“é€ æˆæµ®ç‚¹æ•°æº¢å‡ºï¼Œå°†ä¼¼ç„¶å‡½æ•°å–å¯¹æ•°ï¼Œå¾—åˆ°å¯¹æ•°ä¼¼ç„¶å‡½æ•°å¯¹æ•°å‡½æ•°æ˜¯å¢å‡½æ•°ï¼Œå› æ­¤æœ€å¤§åŒ–ä¼¼ç„¶å‡½æ•°ç­‰ä»·äºæœ€å¤§åŒ–å¯¹æ•°ä¼¼ç„¶å‡½æ•°æœ€åè¦æ±‚è§£çš„é—®é¢˜ä¸ºè¿™æ˜¯ä¸€ä¸ªä¸å¸¦çº¦æŸçš„ä¼˜åŒ–é—®é¢˜ï¼Œä¸€èˆ¬æƒ…å†µä¸‹å¯ç›´æ¥æ±‚å¾—è§£æè§£ä¹Ÿå¯ç”¨æ¢¯åº¦ä¸‹é™æ³•æˆ–è€…ç‰›é¡¿æ³•æ±‚è§£ï¼Œå¯¹äºç¦»æ•£å‹æ¦‚ç‡åˆ†å¸ƒå’Œè¿ç»­å‹ç©Šç‡åˆ†å¸ƒï¼Œè¿™ç§å¤„ç†æ–¹æ³•æ˜¯ç»Ÿä¸€çš„ä¾‹å­_ä¼°è®¡ä¼¯åŠªåˆ©åˆ†å¸ƒçš„å‚æ•°å¯¹äºä¼¯åŠªåˆ©åˆ†å¸ƒ$B(p)$ï¼Œæœ‰$n$ä¸ªæ ·æœ¬ï¼Œå…¶ä¸­å–å€¼ä¸º1çš„æœ‰$a$ä¸ªï¼Œå–å€¼ä¸º0çš„æœ‰$n-a$ä¸ªï¼Œæ ·æœ¬é›†çš„ä¼¼ç„¶å‡½æ•°ä¸ºå¦‚æœ$n=10, a=3$ï¼Œé‚£ä¹ˆä¼¼ç„¶å‡½æ•°çš„å›¾åƒå¦‚å›¾æ‰€ç¤ºï¼Œå›¾ä¸­æ¨ªåæ ‡ä¸ºå‚æ•°$p$ï¼Œçºµåæ ‡æ˜¯ä¼¼ç„¶å‡½æ•°çš„å€¼ä»å›¾åƒæ¥çœ‹ï¼Œè¯¥å‡½æ•°åœ¨$0.3$æ—¶å–æå¤§å€¼ï¼Œå¯¹æ•°ä¼¼ç„¶å‡½æ•°ä¸ºå¯¹$p$æ±‚å¯¼å¹¶ä»¤å¯¼æ•°ä¸º0ï¼Œå¯å¾—è§£å¾—å°†$n=10, a=3$ä»£äººï¼Œå¯ä»¥å¾—åˆ°è¿™ä¸å›¾çš„ç›´è§‚ç»“æœä¸€è‡´ä¾‹å­_ä¼°è®¡æ­£æ€åˆ†å¸ƒçš„å‚æ•°å¯¹äºæ­£æ€åˆ†å¸ƒ$N\left(\mu, \sigma^{2}\right)$ï¼Œæœ‰æ ·æœ¬é›†ï¼Œè¯¥æ ·æœ¬é›†çš„ä¼¼ç„¶å‡½æ•°ä¸ºå¯¹æ•°ä¼¼ç„¶å‡½æ•°ä¸ºå¯¹$\mu$å’Œ$\sigma$æ±‚åå¯¼æ•°å¹¶ä»¤å…¶ä¸º0ï¼Œå¾—åˆ°ä¸‹é¢çš„æ–¹ç¨‹ç»„è§£å¾—æ­£æ€åˆ†å¸ƒæœ€å¤§ä¼¼ç„¶ä¼°è®¡çš„å‡å€¼ä¸ºæ ·æœ¬é›†çš„å‡å€¼ï¼Œæ–¹å·®ä¸ºæ ·æœ¬é›†çš„æ–¹å·®å‡è®¾ç”±ä¸€ç»´æ­£æ€åˆ†å¸ƒäº§ç”Ÿäº†ä¸€ç»„æ ·æœ¬$[0.4,0.5,0.49,0.51,0.52,0.48,0.8,0.7,0.6]$æ ·æœ¬é›†ä¼¼ç„¶å‡½æ•°æœ‰ä¸€ä¸ªå³°å€¼ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¼¼ç„¶å‡½æ•°æ˜¯å‡¹å‡½æ•°ï¼Œå› æ­¤æœ‰å…¨å±€æå¤§å€¼ç‚¹ï¼Œå¯¹äºå¤šç»´æ­£æ€åˆ†å¸ƒæœ‰ç±»ä¼¼çš„ç»“æœæœ‰$n$ç»´æ­£æ€åˆ†å¸ƒ$N(\boldsymbol{\mu}, \boldsymbol{\Sigma})$ï¼Œç»™å®šä¸€ç»„æ ·æœ¬ï¼Œå…¶å¯¹æ•°ä¼¼ç„¶å‡½æ•°ä¸ºå¯¹$\boldsymbol{\mu}$æ±‚æ¢¯åº¦å¹¶ä»¤æ¢¯åº¦ä¸º0ä¸¤è¾¹å·¦ä¹˜$\boldsymbol{\Sigma}$ï¼Œè§£å¾—å¯¹$\Sigma$çš„æ±‚è§£æ›´ä¸ºå¤æ‚ï¼Œå› ç«å®ƒè¦æ»¡è¶³å¯¹ç§°æ­£å®šæ€§çº¦æŸæ¡ä»¶ï¼Œå¯ä»¥è§£å¾—$\boldsymbol{\mu}$ åœ¨å‰é¢å·²ç»è¢«ç®—å‡ºï¼Œè¿™ä¸ä¸€ç»´æ­£æ€åˆ†å¸ƒçš„æœ€å¤§ä¼¼ç„¶ä¼°è®¡ç‹œæœåœ¨å½¢å¼ä¸Šæ˜¯ç»Ÿä¸€çš„æœ€å¤§åéªŒæ¦‚ç‡ä¼°è®¡æœ€å¤§ä¼¼ç„¶ä¼°è®¡å°†å‚æ•°$\theta$çœ‹ä½œç¡®å®šå€¼(æ™®é€šçš„å˜é‡)ï¼Œä½†å…¶å€¼æœ«çŸ¥ï¼Œé€šè¿‡æœ€å¤§åŒ–å¯¹æ•°ä¼¼ç„¶å‡½æ•°ç¡®å®šå…¶å€¼æœ€å¤§åéªŒæ¦‚ç‡ä¼°è®¡(Maximum A Posteriori Probability Estimate, MAP)åˆ™å°†å‚æ•°$\theta$çœ‹ä½œéšæœºå˜é‡ï¼Œå‡è®¾å®ƒæœä»æŸç§æ¦‚ç‡åˆ†å¸ƒï¼Œé€šè¿‡æœ€å¤§åŒ–åéªŒæ¦‚ç‡$p(\boldsymbol{\theta} \mid \boldsymbol{x})$ç¡®å®šå…¶å€¼å…¶æ ¸å¿ƒæ€æƒ³æ˜¯ä½¿å¾—åœ¨æ ·æœ¬å‡ºç°çš„æ¡ä»¶ä¸‹å‚æ•°çš„åéªŒæ¦‚ç‡æœ€å¤§åŒ–æ±‚è§£æ—¶éœ€è¦å‡è®¾å‚æ•°$\theta$æœä»æŸç§åˆ†å¸ƒ(ç§°ä¸ºå…ˆéªŒåˆ†å¸ƒ)å‡è®¾å‚æ•°æœä»æ¦‚ç‡åˆ†å¸ƒ$p(\theta)$ï¼Œæ ¹æ®è´å¶æ–¯å…¬å¼ï¼Œå‚æ•°å¯¹æ ·æœ¬é›†çš„åéªŒæ¦‚ç‡(å³å·²çŸ¥æ ·æœ¬é›†$x$çš„æ¡ä»¶ä¸‹å‚æ•°$\theta$çš„æ¡ä»¶æ¦‚ç‡)ä¸ºå…¶ä¸­$p(x \mid \theta)$æ˜¯ç»™å®šå‚æ•°å€¼æ—¶æ ·æœ¬çš„æ¦‚ç‡åˆ†å¸ƒï¼Œå°±æ˜¯$x$çš„æ¦‚ç‡å¯†åº¦å‡½æ•°æˆ–æ¦‚ç‡è´¨é‡å‡½æ•°ï¼Œå¯ä»¥æ ¹æ®æ ·æœ¬çš„å€¼$x$è¿›è¡Œè®¡ç®—ï¼Œä¸æœ€å¤§ä¼¼ç„¶ä¼°è®¡ç›¸åŒï¼Œ$\theta$æ˜¯éšæœºå˜é‡ï¼Œå› æ­¤ï¼Œæœ€å¤§åŒ–è¯¥åéªŒæ¦‚ç‡ç­‰ä»·äºä¸Šå¼ç¬¬äºŒæ­¥å¿½ç•¥äº†åˆ†æ¯çš„å€¼ï¼Œå› ä¸ºå®ƒå’Œå‚æ•°$\theta$æ— å…³ä¸”ä¸ºæ­£æœ€å¤§åéªŒæ¦‚ç‡ä¼°è®¡ä¸æœ€å¤§ä¼¼ç„¶ä¼°è®¡ä¸€è‡´ï¼Œå®ç°æ—¶ï¼ŒåŒæ ·å¯ä»¥å°†ç›®æ ‡å‡½æ•°å–å¯¹æ•°ç„¶åè®¡ç®—ä¾‹å­_ç”¨æœ€å¤§åéªŒæ¦‚ç‡ä¼°è®¡è®¡ç®—ä¼¯åŠªåˆ©åˆ†å¸ƒçš„å‚æ•°å¯¹äºä¼¯åŠªåˆ©åˆ†å¸ƒå‚æ•°ä¼°è®¡é—®é¢˜ï¼Œå‡è®¾å‚æ•°$p$æœä»æ­£æ€åˆ†å¸ƒ$N\left(0.3,0.1^{2}\right)$ï¼Œåˆ™ç›®æ ‡å‡½æ•°ä¸ºå…¶å›¾åƒä¸ºå…¶å¯¹æ•°ä¸ºå¯¹$p$æ±‚å¯¼å¹¶ä»¤å¯¼æ•°ä¸º0ï¼Œå°†$n=10, a=3$ä»£äººä¸Šå¼ï¼Œå¯ä»¥å¾—åˆ°ç”±äº$0&lt;p&lt;1$ï¼Œå› æ­¤è§£æ­¤æ–¹ç¨‹å³å¯å¾—åˆ°$p$çš„å€¼æœ€å¤§å€¼åœ¨$0.3$ç‚¹é™„è¿‘å–å¾—ï¼Œä¸ä¸Šå›¾æœ‰æ‰€å·®å¼‚ï¼Œå›¾ä¸­æ¨ªåæ ‡ä¸ºå‚æ•°$p$ï¼Œçºµåæ ‡ä¸ºç›®æ ‡å‡½æ•°å€¼æ¥ä¸‹æ¥è®¡ç®—æ­£æ€åˆ†å¸ƒçš„å‚æ•°ï¼Œå‡è®¾æœ‰æ­£æ€åˆ†å¸ƒï¼Œå…¶å‡å€¼æœ«çŸ¥ï¼Œè€Œæ–¹å·®å·²çŸ¥æœ‰ç»„é‡‡æ ·è‡ªè¯¥åˆ†å¸ƒçš„ç‹¬ç«‹åŒåˆ†å¸ƒæ ·æœ¬ï¼Œå‡è®¾å‚æ•°æœä»ä»æ­£æ€åˆ†å¸ƒæœ€å¤§åéªŒæ¦‚ç‡ä¼°è®¡çš„ç›®æ ‡å‡½æ•°ä¸ºå°†è¯¥å‡½æ•°å–å¯¹æ•°, å¯å¾—æœ€å¤§åŒ–æ­¤ç›®æ ‡å‡½æ•°ç­‰ä»·äºæœ€å°åŒ–å¦‚ä¸‹å‡½æ•°å¯¹$\mu$æ±‚å¯¼å¹¶ä»¤å¯¼æ•°ä¸º0ï¼Œå¯ä»¥è§£å¾—è¿™å°±æ˜¯å‡å€¼çš„æœ€å¤§åéªŒæ¦‚ç‡ä¼°è®¡ç»“æœå¦‚æœå¿½ç•¥ä¸Šå¼åˆ†å­å’Œåˆ†æ¯çš„ç¬¬äºŒéƒ¨åˆ†å³å‡è®¾$\mu$çš„æ–¹å·®$\sigma_{v}$ä¸º0ï¼Œåˆ™ä¸æœ€å¤§ä¼¼ç„¶ä¼°è®¡çš„ç»“æœç›¸åŒï¼Œæ­¤æ—¶çš„$\mu$é€€åŒ–æˆä¸€ä¸ªç¡®å®šå€¼è´å¶æ–¯ä¼°è®¡å®šä¹‰è´å¶æ–¯ä¼°è®¡ä¸æœ€å¤§åéªŒæ¦‚ç‡ä¼°è®¡çš„æ€æƒ³ç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äºä¸æ±‚å‡ºå‚æ•°çš„å…·ä½“å€¼ï¼Œè€Œæ˜¯æ±‚å‡ºå‚æ•°æ‰€æœä»çš„æ¦‚ç‡åˆ†å¸ƒä¸ŠèŠ‚ä¸­å·²ç»æ¨å¯¼è¿‡ï¼Œå‚æ•°$\theta$çš„åéªŒæ¦‚ç‡åˆ†å¸ƒä¸ºåŒæ ·çš„ï¼Œ$p(\boldsymbol{\theta})$ä¸ºå‚æ•°çš„å…ˆéªŒåˆ†å¸ƒï¼Œ$p(\boldsymbol{x} \mid \boldsymbol{\theta})$ä¸ºç»™å®šå‚æ•°æ—¶æ ·æœ¬çš„æ¦‚ç‡åˆ†å¸ƒï¼Œè¿™é‡Œå¾—åˆ°çš„æ˜¯å‚æ•°çš„æ¦‚ç‡åˆ†å¸ƒï¼Œé€šå¸¸å–å…¶æ•°å­¦æœŸæœ›ä½œä¸ºå‚æ•°çš„ä¼°è®¡å€¼ï¼Œå³å‚æ•°çš„ä¼°è®¡å€¼ä¸ºå¼$p(\boldsymbol{\theta} \mid \boldsymbol{x})$åˆ†æ¯ä¸­çš„ç§¯åˆ†é€šå¸¸éš¾ä»¥è®¡ç®—ï¼Œä¿¡æ¯è®ºç« èŠ‚å°†è®²è¿°å‚æ•°åéªŒæ¦‚ç‡çš„è¿‘ä¼¼è®¡ç®—æ–¹æ³•ä¸€å˜åˆ†æ¨æ–­æ ¸å¯†åº¦ä¼°è®¡å®šä¹‰å‰é¢ä»‹ç»çš„å‚æ•°ä¼°è®¡æ–¹æ³•å‡éœ€è¦å·²çŸ¥æ¦‚ç‡å¯†åº¦å‡½æ•°çš„å½¢å¼ï¼Œç®—æ³•åªç¡®å®šæ¦‚ç‡å¯†åº¦å‡½æ•°çš„å‚æ•°å¯¹äºå¾ˆå¤šåº”ç”¨ï¼Œæˆ‘ä»¬æ— æ³•ç»™å‡ºæ¦‚ç‡å¯†åº¦å‡½æ•°çš„æ˜¾å¼è¡¨è¾¾å¼ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨æ ¸å¯†åº¦ä¼°è®¡æ ¸å¯†åº¦ä¼°è®¡(Kernel Density Estimation, KDE)ä¹Ÿç§°ä¸ºParzençª—æŠ€æœ¯ï¼Œæ˜¯ä¸€ç§éå‚æ•°æ–¹æ³•ï¼Œå®ƒæ— é¡»æ±‚è§£æ¦‚ç‡å¯†åº¦å‡½æ•°çš„å‚æ•°ï¼Œè€Œæ˜¯ç”¨ä¸€ç»„æ ‡å‡†å‡½æ•°çš„å åŠ è¡¨ç¤ºæ¦‚ç‡å¯†åº¦å‡½æ•°æ–¹æ³•æœ‰$d$ç»´ç©ºé—´ä¸­çš„æ ·æœ¬ç‚¹$\boldsymbol{x}_{i}, i=1, \cdots, n$ï¼Œå®ƒä»¬æœä»æŸä¸€æœ«çŸ¥çš„æ¦‚ç‡åˆ†å¸ƒç»™å®šæ ¸å‡½æ•°$K(\boldsymbol{x})$ï¼Œåœ¨ä»»æ„ç‚¹$x$å¤„çš„æ¦‚ç‡å¯†åº¦å‡½æ•°ä¼°è®¡å€¼æ ¹æ®æ‰€æœ‰çš„æ ·æœ¬ç‚¹è®¡ç®—å…¶ä¸­$h$ä¸ºæ ¸å‡½æ•°çš„çª—å£åŠå¾„ï¼Œæ˜¯äººå·¥è®¾å®šçš„æ­£å‚æ•°æ ¸å‡½æ•°è¦ä¿è¯å‡½æ•°å€¼éšç€å¾…ä¼°è®¡ç‚¹ç¦»æ ·æœ¬ç‚¹çš„è·ç¦»å¢åŠ è€Œé€’å‡æ ¹æ®è¿™ä¸€åŸåˆ™ï¼Œå¦‚æœ$x$é™„è¿‘çš„æ ·æœ¬ç‚¹å¯†é›†ï¼Œåˆ™åœ¨è¯¥ç‚¹å¤„çš„æ¦‚ç‡å¯†åº¦å‡½æ•°ä¼°è®¡å€¼æ›´å¤§å¦‚æœé™„è¿‘çš„æ ·æœ¬ç‚¹ç¨€ç–ï¼Œåˆ™æ¦‚ç‡å¯†åº¦å‡½æ•°çš„ä¼°è®¡å€¼å°ï¼Œè¿™ç¬¦åˆå¯¹æ¦‚ç‡å¯†åº¦å‡½æ•°çš„ç›´è§‚è¦æ±‚ç³»æ•°$\frac{1}{n h^{d}}$æ˜¯ä¸ºäº†ç¡®ä¿$p(\boldsymbol{x})$çš„ç§¯åˆ†ä¸º1ï¼Œä½¿å¾—å®ƒæ˜¯ä¸€ä¸ªåˆæ³•çš„æ¦‚ç‡å¯†åº¦å‡½æ•°å…¶ä¸­$\frac{1}{n}$å¯¹åº”äº$n$ä¸ªæ±‚å’Œé¡¹ï¼›$\frac{1}{h^{d}}$æ˜¯ä¸ºäº†ç¡®ä¿æ ¸å‡½æ•°è¿›è¡Œ$d$ç»´æ¢å…ƒä¹‹åç§¯åˆ†å€¼ä¸º1ï¼Œå³æ ¸å‡½æ•°èƒ½ç¡®ä¿ç§¯åˆ†å€¼ä¸º1å¦‚æœä»¤$\frac{x-x_{i}}{h}=y$å…¶é€†å˜æ¢ä¸ºæ­¤æ¢å…ƒçš„é›…å¯æ¯”è¡Œåˆ—å¼ä¸ºå› æ­¤æœ‰å¸¸ç”¨çš„æ ¸å‡½æ•°æ˜¯å¾„å‘å¯¹ç§°æ ¸(Radially Symmetric Kernel)ï¼Œå¯ä»¥å†™æˆå¦‚ä¸‹å½¢å¼å…¶ä¸­$k(x)$ä¸ºæ ¸çš„å‰–é¢(profile)å‡½æ•°ï¼Œæ˜¯$|\boldsymbol{x}|$çš„å‡å‡½æ•°ä¸”å¯¹ç‚¹$x$å…³äºåŸç‚¹å¾„å‘å¯¹ç§°ï¼Œè¿™ä¹Ÿæ˜¯å¾„å‘å¯¹ç§°æ ¸è¿™ä¸€åç§°çš„æ¥å†å½’ä¸€åŒ–å¸¸æ•°$c_{k, d}$ç¡®ä¿$K(x)$çš„ç§¯åˆ†å€¼ä¸º1ï¼Œå³æ ¸å‡½æ•°æˆç«‹ï¼Œæ­¤å¸¸æ•°æ ¹æ®å…·ä½“çš„æ ¸å‡½æ•°è€Œå®šç»å…¸æ ¸å‡½æ•°Epanechnikovå‰–é¢å‡½æ•°å®šä¹‰ä¸ºå…¶å¯¹åº”çš„å¾„å‘å¯¹ç§°æ ¸ç§°ä¸ºEpanechnikovæ ¸ï¼Œå®šä¹‰ä¸ºå…¶ä¸­$c_{d}$æ˜¯$d$ç»´å•ä½çƒçš„ä½“ç§¯ï¼ŒEpanechnikovå‰–é¢å‡½æ•°åœ¨$x=1$ç‚¹å¤„ä¸å¯å¯¼é«˜æ–¯æ ¸çš„å‰–é¢å‡½æ•°å®šä¹‰ä¸ºå…¶å¯¹åº”çš„å¤šå˜é‡é«˜æ–¯æ ¸(Multivariate Gaussian Kernel)ä¸ºå®ƒçš„å½’ä¸€åŒ–ç³»æ•°ä¸º$(2 \pi)^{-d / 2}$ï¼Œå› ä¸ºæ ¹æ®3.8.3èŠ‚çš„ç»“è®ºè¿™å°±æ˜¯æ ‡å‡†å¤šç»´æ­£æ€åˆ†å¸ƒï¼Œæ ¸å¯†åº¦å€¼è¶Šå¤§å³æ ·æœ¬ç‚¹è¶Šå¯†é›†çš„ç‚¹å¤„çš„äº®åº¦å€¼è¶Šå¤§ï¼Œåä¹‹åˆ™è¶Šå°åº”ç”¨å€ŸåŠ©äºå‰–é¢å‡½æ•°ï¼Œå¼å­å¯ä»¥å†™æˆå¯¹äºæŸäº›å®é™…åº”ç”¨ï¼Œéœ€è¦è®¡ç®—æ ¸å¯†åº¦å‡½æ•°çš„æå¤§å€¼ç‚¹ï¼Œå…¸å‹çš„æ˜¯è§†è§‰ç›®æ ‡è·Ÿè¸ªã€æ¡ƒç±»ç®—æ³•å¦‚æœç”¨æ¢¯åº¦ä¸Šå‡æ³•æ±‚è§£æ­¤é—®é¢˜ï¼Œé‚£ä¹ˆå¯ä»¥å¾—åˆ°è‘—åçš„å‡å€¼æ¼‚ç§»(Mean Shift)ç®—æ³•</content>
	</entry>
	<entry>
		<title>éšé©¬å°”å¯å¤«æ¨¡å‹HMM</title>
		<url>/article/4987.html</url>
		<content>éšé©¬å°”å¯å¤«HMMå®šä¹‰ä¸€ç«™å¼è§£å†³ï¼šéšé©¬å°”å¯å¤«æ¨¡å‹ï¼ˆHMMï¼‰å…¨è¿‡ç¨‹æ¨å¯¼åŠå®ç°å…³äºHMMã€MEMMã€CRFçš„ä¸€äº›çŸ¥è¯†æ•´ç†æ•´ç†å›¾è§£éšé©¬å°”å¯å¤«æ¨¡å‹HMM_é€šä¿—æ˜“æ‡‚éšé©¬å°”å¯å¤«æ¨¡å‹(hidden Markov model, HMM)æ˜¯å¯ç”¨äºæ ‡æ³¨é—®é¢˜çš„ç»Ÿè®¡å­¦ä¹ æ¨¡å‹æè¿°ç”±éšè—çš„é©¬å°”å¯å¤«é“¾éšæœºç”Ÿæˆè§‚æµ‹åºåˆ—çš„è¿‡ç¨‹ï¼Œå±äºç”Ÿæˆæ¨¡å‹éšè—çš„é©¬å°”å¯å¤«é“¾éšæœºç”Ÿæˆçš„çŠ¶æ€çš„åºåˆ—ï¼Œç§°ä¸ºçŠ¶æ€åºåˆ—(state sequence)æ¯ä¸ªçŠ¶æ€ç”Ÿæˆä¸€ä¸ªè§‚æµ‹è€Œç”±æ­¤äº§ç”Ÿçš„è§‚æµ‹çš„éšæœºåºåˆ—ï¼Œç§°ä¸ºè§‚æµ‹åºåˆ—(observation sequence)åºåˆ—çš„æ¯ä¸€ä¸ªä½ç½®åˆå¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªæ—¶åˆ»è¿™é‡Œçš„$Z$å°±æ˜¯çŠ¶æ€åºåˆ—ï¼Œ$x$æ˜¯è§‚æµ‹åºåˆ—ï¼Œè®¾Qæ˜¯æ‰€æœ‰å¯èƒ½çš„çŠ¶æ€çš„é›†åˆï¼ŒVæ˜¯æ‰€æœ‰å¯èƒ½çš„è§‚æµ‹çš„é›†åˆï¼Œ$N$æ˜¯å¯èƒ½çš„çŠ¶æ€æ•°ï¼Œ$M$æ˜¯å¯èƒ½çš„è§‚æµ‹æ•°ä¸‰è¦ç´ éšé©¬å°”å¯å¤«ä¸‰è¦ç´ éšé©¬å°”å¯å¤«æ¨¡å‹ç”±åˆå§‹çŠ¶æ€æ¦‚ç‡$\pi$ã€çŠ¶æ€è½¬ç§»çŸ©é˜µ$A$ã€è§‚æµ‹æ¦‚ç‡çŸ©é˜µ(æˆ–è€…å«å‘å°„çŸ©é˜µ)$B$å†³å®šï¼Œè®°ä½œå…¶ä¸­$\pi$çš„ç»´åº¦ä¸º$N$ï¼Œ$A$çš„ç»´åº¦ä¸º$N \times N$ï¼Œ$B$çš„ç»´åº¦ä¸º$N \times M$ä¾‹å­ğŸŒ°ğŸŒ±å‡è®¾æœ‰4ä¸ªç›’å­ï¼Œæ¯ä¸ªç›’å­é‡Œé¢æœ‰ä¸åŒæ•°é‡çš„çº¢ã€ç™½ä¸¤ç§é¢œè‰²çš„çƒï¼Œå…·ä½“å¦‚ä¸‹è¡¨ç›’å­ç¼–å·1234çº¢çƒæ•°5368ç™½çƒæ•°5742æŒ‰ç…§ä¸‹é¢çš„æ–¹æ³•æŠ½çƒï¼Œäº§ç”Ÿä¸€ä¸ªçƒçš„é¢œè‰²çš„è§‚æµ‹åºåˆ—ï¼šå¼€å§‹ï¼Œä»4ä¸ªç›’å­é‡Œä»¥ç­‰æ¦‚ç‡éšæœºé€‰å–1ä¸ªç›’å­ï¼Œä»è¿™ä¸ªç›’å­é‡ŒéšæœºæŠ½å‡º1ä¸ªçƒï¼Œè®°å½•å…¶é¢œè‰²åï¼Œæ”¾å›ç„¶åï¼Œä»å½“å‰ç›’å­éšæœºè½¬ç§»åˆ°ä¸‹ä¸€ä¸ªç›’å­ï¼Œè§„åˆ™å¦‚ä¸‹ï¼šå¦‚æœå½“å‰ç›’å­æ˜¯ç›’å­1ï¼Œé‚£ä¹ˆä¸‹ä¸€ç›’å­ä¸€å®šæ˜¯ç›’å­2å¦‚æœå½“å‰æ˜¯ç›’å­2æˆ–3ï¼Œé‚£ä¹ˆåˆ†åˆ«ä»¥æ¦‚ç‡0.4å’Œ0.6è½¬ç§»åˆ°å·¦è¾¹æˆ–å³è¾¹çš„ç›’å­å¦‚æœå½“å‰æ˜¯ç›’å­4ï¼Œé‚£ä¹ˆå„ä»¥0.5çš„æ¦‚ç‡åœç•™åœ¨ç›’å­4æˆ–è½¬ç§»åˆ°ç›’å­3ç¡®å®šè½¬ç§»çš„ç›’å­åï¼Œå†ä»è¿™ä¸ªç›’å­é‡ŒéšæœºæŠ½å‡º1ä¸ªçƒï¼Œè®°å½•å…¶é¢œè‰²ï¼Œæ”¾å›å¦‚æ­¤ä¸‹å»ï¼Œé‡å¤è¿›è¡Œ5æ¬¡ï¼Œå¾—åˆ°ä¸€ä¸ªçƒçš„é¢œè‰²çš„è§‚æµ‹åºåˆ—ï¼š$Oï¼{çº¢,çº¢,ç™½,ç™½,çº¢}$æ ¹æ®æ‰€ç»™æ¡ä»¶ï¼Œå¯ä»¥æ˜ç¡®çŠ¶æ€é›†åˆã€è§‚æµ‹é›†åˆã€åºåˆ—é•¿åº¦ä»¥åŠæ¨¡å‹çš„ä¸‰è¦ç´ ç›’å­å¯¹åº”çŠ¶æ€ï¼ŒçŠ¶æ€çš„é›†åˆæ˜¯$Qï¼{ç›’å­1,ç›’å­2,ç›’å­3,ç›’å­4}$ï¼Œ$N=4$çƒçš„é¢œè‰²å¯¹åº”è§‚æµ‹ã€‚è§‚æµ‹çš„é›†åˆæ˜¯$Vï¼{çº¢,ç™½}$ï¼Œ$Mï¼2$çŠ¶æ€åºåˆ—å’Œè§‚æµ‹åºåˆ—é•¿åº¦$Tï¼5$åˆ™åˆå§‹æ¦‚ç‡åˆ†å¸ƒä¸ºçŠ¶æ€è½¬ç§»æ¦‚ç‡åˆ†å¸ƒä¸ºè§‚æµ‹æ¦‚ç‡åˆ†å¸ƒä¸º (æœ€ç»ˆç›’å­çº¢ç™½çƒçš„æ¦‚ç‡)ä¸‰ä¸ªå‡è®¾é©¬å°”ç§‘å¤«æ€§å‡è®¾: $t$æ—¶åˆ»çš„çŠ¶æ€å‡ºç°çš„æ¦‚ç‡åªå’Œ$t-1$æ—¶åˆ»çš„çŠ¶æ€æœ‰å…³é½æ¬¡é©¬å°”å¯å¤«å‡è®¾(å‡è®¾1)è§‚æµ‹ç‹¬ç«‹æ€§å‡è®¾(å‡è®¾2)å‡è®¾1å’Œå‡è®¾2åœ¨å‰åå‘ç®—æ³•æ¨å¯¼ä¸Šæœ‰ç”¨åˆ°è§‚æµ‹åºåˆ—ç”Ÿæˆè¾“å…¥ï¼šéšé©¬å°”å¯å¤«æ¨¡å‹ $\lambda=(A ,B ,\pi )$ ï¼Œè§‚æµ‹åºåˆ—é•¿åº¦$T$è¾“å‡ºï¼šè§‚æµ‹åºåˆ—æŒ‰ç…§åˆå§‹çŠ¶æ€åˆ†å¸ƒ $\pi$ äº§ç”ŸçŠ¶æ€$i_1$ä»¤t $=1$æŒ‰ç…§çŠ¶æ€$\mathrm{t}$çš„è§‚æµ‹æ¦‚ç‡åˆ†å¸ƒ ç”Ÿæˆ æŒ‰ç…§çŠ¶æ€  çš„çŠ¶æ€è½¬ç§»æ¦‚ç‡åˆ†å¸ƒ  äº§ç”ŸçŠ¶æ€ ï¼Œä»¤ $\mathrm{t}=\mathrm{t}+1$; å¦‚æœ $\mathrm{t}&lt;\mathrm{T}$ ï¼Œè½¬æ­¥ $(3)$ ï¼›å¦åˆ™ï¼Œç»ˆæ­¢æ¦‚ç‡åŸºç¡€è”åˆæ¦‚ç‡è”åˆæ¦‚ç‡æŒ‡çš„æ˜¯åŒ…å«å¤šä¸ªæ¡ä»¶ä¸”æ‰€æœ‰æ¡ä»¶åŒæ—¶æˆç«‹çš„æ¦‚ç‡ï¼Œè®°ä½œè¾¹ç¼˜æ¦‚ç‡ä»…ä¸å•ä¸ªéšæœºå˜é‡æœ‰å…³çš„æ¦‚ç‡ï¼Œè®°ä½œæ¡ä»¶æ¦‚ç‡æ¡ä»¶æ¦‚ç‡è¡¨ç¤ºåœ¨æ¡ä»¶$Y=b$æˆç«‹çš„æƒ…å†µä¸‹ï¼Œ$X=a$çš„æ¦‚ç‡ï¼Œè®°ä½œå…·æœ‰æ€§è´¨ï¼šåœ¨æ¡ä»¶$Y=b$ä¸‹$X$çš„æ¡ä»¶åˆ†å¸ƒï¼Œä¹Ÿæ˜¯ä¸€ç§$X$çš„æ¦‚ç‡åˆ†å¸ƒï¼Œç©·ä¸¾$X$çš„å¯å–å€¼ä¹‹åï¼Œæ‰€æœ‰è¿™äº›å€¼å¯¹åº”çš„æ¦‚ç‡ä¹‹å’Œä¸º$1$ï¼Œå³:ğŸŒ¿è”åˆæ¦‚ç‡ã€è¾¹ç¼˜æ¦‚ç‡ä¸æ¡ä»¶æ¦‚ç‡ä¹‹é—´çš„å…³ç³»: è”=è¾¹*æ¡å¯ä»¥ç†è§£æˆåœ¨$Y$é€‰ä¸­$b$çš„æƒ…å†µä¸‹ï¼ŒåŒæ—¶$X$é€‰ä¸­$b$çš„æ¦‚ç‡å°±æ˜¯è”åˆæ¦‚ç‡ï¼Œè¡¨ç¤ºä¸¤ä¸ªæ¡ä»¶åŒæ—¶æ»¡è¶³ğŸŒ°ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æœ‰3ä¸ªç›’å­ï¼Œæ¯ä¸ªç›’å­ä¸­æœ‰ç™½è‰²å’Œçº¢è‰²ä¸¤ç§é¢œè‰²çš„çƒï¼Œé‚£ä¹ˆä»ç¬¬äºŒä¸ªç›’å­ä¸­å–å‡ºç™½çƒçš„æ¦‚ç‡ï¼Œç­‰ä»·äºæŠ½åˆ°ç¬¬äºŒä¸ªç›’å­çš„æ¦‚ç‡$\times$ç¬¬äºŒä¸ªç›’å­ä¸­æŠ½åˆ°ç™½è‰²æ±‚çš„æ¦‚ç‡è´å¶æ–¯å…¬å¼å…ˆéªŒæ¦‚ç‡ï¼šçŸ¥é“åŸå› æ¨ç»“æœçš„ï¼ŒP(åŸå› )ã€P(ç»“æœ|åŸå› )ç­‰åéªŒæ¦‚ç‡ï¼šæ ¹æ®ç»“æœæ¨åŸå› çš„ï¼ŒP(åŸå› |ç»“æœ)ç­‰HMMçš„ä¸‰ä¸ªé—®é¢˜HMMçš„åŸºæœ¬é—®é¢˜ä¸€å…±æœ‰ä¸‰ä¸ª:æ¦‚ç‡è®¡ç®—ï¼šç»™å®šå‚æ•°$ \lambda =( \pi , A, B) $å’Œè§‚æµ‹åºåˆ—$ X=(x_1,x_2, \cdots ,x_T) $ï¼Œè®¡ç®—è§‚æµ‹åºåˆ—$ X $çš„æ¡ä»¶æ¦‚ç‡$ P(X|\lambda)$å‚æ•°å­¦ä¹ ï¼šç»™å®šè§‚æµ‹åºåˆ—$ X $ï¼Œåæ¨å‚æ•°$\pi$ã€$A$ã€$B$è§£ç é—®é¢˜ï¼šç»™å®šå‚æ•°$\lambda$å’Œè§‚æµ‹åºåˆ—$ X=(x_1,x_2, \cdots ,x_T) $ï¼Œæ±‚å¯èƒ½æ€§æœ€å¤§çš„$ Z=(z_1, \cdots ,z_T)$æ¦‚ç‡è®¡ç®—HMMæ¨¡å‹å®šä¹‰ğŸŒ±å‡è®¾æœ‰4ä¸ªç›’å­ï¼Œæ¯ä¸ªç›’å­é‡Œé¢æœ‰ä¸åŒæ•°é‡çš„çº¢ã€ç™½ä¸¤ç§é¢œè‰²çš„çƒï¼Œå…·ä½“å¦‚ä¸‹è¡¨ç›’å­ç¼–å·1234çº¢çƒæ•°5368ç™½çƒæ•°5742ç°åœ¨ä»è¿™äº›ç›’å­ä¸­æŠ½å–$T$ä¸ªçƒï¼Œæ¯æ¬¡æŠ½å–åè®°å½•é¢œè‰²ï¼Œå†æ”¾å›åŸç›’å­åºåˆ—å¦‚ä¸‹å›¾æ‰€ç¤ºå…¶ä¸­$z_i$ä»£è¡¨ç¬¬$i$ä¸ªéšåºåˆ—å€¼ï¼Œ$q_i$ä»£è¡¨ç¬¬$i$ä¸ªéšçŠ¶æ€ï¼Œ$x_i$ä»£è¡¨ç¬¬$i$ä¸ªè§‚æµ‹åºåˆ—å€¼ï¼Œæ³¨æ„éšåºåˆ—å€¼æŒ‡çš„æ˜¯ç¬¬å‡ ä¸ªä½ç½®ï¼Œæ¯”å¦‚ç¬¬å‡ ä¸ªç›’å­ã€æˆ–è€…ç¬¬å‡ ä¸ªå•è¯éšçŠ¶æ€æŒ‡çš„æ˜¯ç¬¬å‡ ä¸ªçŠ¶æ€ï¼Œæ¯”å¦‚çº¢çƒè¿˜æ˜¯ç™½çƒï¼Œæˆ–è€…åè¯è¿˜æ˜¯åŠ¨è¯æ­¤æ—¶$z_t = q_i$è¡¨è¾¾çš„å«ä¹‰å°±æ˜¯$t$æ—¶åˆ»ï¼ŒæŠ½å–ç¬¬$q_i$ä¸ªç›’å­ï¼Œå› ä¸ºæœ‰$4$ä¸ªç›’å­ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œ$i={1,2,3,4}$å¯¹åº”å–åˆ°çš„çƒçš„é¢œè‰²å¯ä»¥è®°ä¸º$x_i$ï¼Œå…¶ä¸­$x_i \in {ç™½è‰², çº¢è‰²}$ç›´æ¥è®¡ç®—ç»™å®šæ¨¡å‹ $\lambda=(A, B, \pi)$ å’Œè§‚æµ‹åºåˆ— ï¼Œç®—è§‚æµ‹åºåˆ— $O$ å‡ºç°çš„ æ¦‚ç‡  ï¼Œæœ€ç›´æ¥çš„æ–¹æ³•æ˜¯æŒ‰æ¦‚ç‡å…¬å¼ç›´æ¥è®¡ç®—.é€šè¿‡åˆ—ä¸¾æ‰€æœ‰å¯èƒ½çš„é•¿åº¦ä¸º$T$çš„çŠ¶æ€åºåˆ—ï¼Œæ±‚å„ä¸ªçŠ¶æ€åºåˆ—$I$ä¸è§‚æµ‹åºåˆ— çš„è”åˆæ¦‚ç‡ ï¼Œç„¶åå¯¹æ‰€æœ‰å¯èƒ½çš„çŠ¶æ€åºåˆ—æ±‚å’Œï¼Œå¾—åˆ° çŠ¶æ€åºåˆ—  çš„æ¦‚ç‡æ˜¯å¯¹å›ºå®šçš„çŠ¶æ€åºåˆ— ï¼Œè§‚æµ‹åºåˆ—  çš„æ¦‚ç‡æ˜¯ $O$ å’Œ $I$ åŒæ—¶å‡ºç°çš„è”åˆæ¦‚ç‡ä¸ºç„¶å, å¯¹æ‰€æœ‰å¯èƒ½çš„çŠ¶æ€åºåˆ— $I$ æ±‚å’Œ, å¾—åˆ°è§‚æµ‹åºåˆ— $O$ çš„æ¦‚ç‡ $P(O \mid \lambda)$, å³ä½†æ˜¯ï¼Œåˆ©ç”¨ä¸Šè¿°å…¬å¼è®¡ç®—é‡å¾ˆå¤§ï¼Œæ˜¯ $O\left(T N^{T}\right)$ é˜¶çš„ï¼Œè¿™ç§ç®—æ³•ä¸å¯è¡ŒğŸœå‰å‘æ¦‚ç‡å®šä¹‰å‰å‘æ¦‚ç‡$ \alpha _t (i) $ï¼Œå®ƒæ˜¯$t$æ—¶åˆ»çš„çŠ¶æ€ä»¥åŠ$1, 2, \cdots , t$æ—¶åˆ»çš„è§‚æµ‹åœ¨ç»™å®šå‚æ•°ä¸‹çš„è”åˆæ¦‚ç‡ä¹Ÿå°±æ˜¯ä¸Šå›¾ä¸­æ ‡è®°çš„é‚£ä¸€éƒ¨åˆ†ï¼Œ$ \alpha _t (i) $è¡¨ç¤ºçš„æ˜¯åœ¨$t$æ—¶åˆ»ï¼ŒéšçŠ¶æ€ä¸º$q_i$çš„æ¦‚ç‡å‰å‘æ¦‚ç‡åˆå€¼æ ¹æ®å®šä¹‰å¯ä»¥å¾—åˆ°åˆå€¼:å…¶ä¸­$P(x_1|z_1=q_i, \lambda)$è¡¨è¾¾çš„æ˜¯ï¼Œç»™å®š$\lambda$å’ŒçŠ¶æ€$z_1=q_i$çš„æƒ…å†µä¸‹ï¼Œè§‚æµ‹å€¼æ˜¯$x_1$çš„æ¦‚ç‡å‡è®¾æ­¤æ—¶$x_1=ç™½è‰²$ï¼Œè¿™é‡Œå¯ä»¥é€šä¿—ç†è§£ä¸º$z_1$è¡¨ç¤ºçš„ç¬¬$1$ä¸ªç›’å­ï¼Œå³ä»ç¬¬ä¸€ä¸ªç›’å­ä¸­å–å‡ºç™½çƒçš„æ¦‚ç‡åŒæ—¶$ b_i(x) $è¡¨ç¤ºç”±çŠ¶æ€$ q_i $ç”Ÿæˆç»™å®šè§‚æµ‹æ•°æ®çš„æ¦‚ç‡ï¼Œä¾‹å¦‚è®¾$ t $æ—¶åˆ»è§‚æµ‹æ•°æ®$ x_t=v_j $ï¼Œæœ‰ä¸Šè¿°ç”¨åˆ°çš„å…¬å¼ä¸ºä¸ºæ¦‚ç‡åŸºç¡€éƒ¨åˆ†çš„çŸ¥è¯†æ¨å¯¼é€’æ¨å…¬å¼ç”±å‰å‘æ¦‚ç‡$ \alpha _t (i) $ç»§ç»­æ¨å¯¼å¯ä»¥å¾—åˆ°$ \alpha _T (i) $æ ¹æ®è¿™ä¸ªå…¬å¼ï¼Œéå†$ z_T $çš„å–å€¼æ±‚å’Œï¼Œå¯ä»¥å¾—åˆ°$X$çš„è¾¹é™…æ¦‚ç‡å…¶ä¸­$N$è¡¨ç¤ºçš„æ˜¯çŠ¶æ€æ•°é‡ï¼Œæ¯”å¦‚ç›’å­ä¸­åªæœ‰çº¢çƒå’Œç™½çƒï¼Œå³çŠ¶æ€é›†åˆä¸º${ç™½çƒ, çº¢çƒ}$ï¼Œæ­¤æ—¶$N=2$ç”±å‰å‘æ¦‚ç‡æ¨å¯¼å¯ä»¥å¾—åˆ°å¼•å…¥å˜é‡$z_t=q_i$ï¼Œæ³¨æ„($t+1$æ—¶åˆ»$=$$z_t$æ‰€æœ‰çŠ¶æ€æ±‚å’Œ)ï¼Œæ‰€ä»¥æœ‰æ‰¾åˆ°äº†$t$åˆ°$t+1$æ—¶åˆ»çš„é€’æ¨å…¬å¼ï¼Œåˆ†åˆ«çœ‹ä¸‹å…¬å¼çš„ä¸¤ä¸ªéƒ¨åˆ†å‰åŠéƒ¨åˆ†æ ¹æ®è§‚æµ‹ç‹¬ç«‹å‡è®¾ååŠéƒ¨åˆ†æ ¹æ®é½æ¬¡é©¬å°”å¯å¤«å‡è®¾å°†ä¸Šè¿°ç»“æœä»£å…¥$\alpha _{t+1}(j)$å¯ä»¥å¾—åˆ°æ¡ä»¶æ¦‚ç‡ä¾‹å­HMMå‰å‘å’Œåå‘ç®—æ³•åœ¨è®¡ç®—ä»€ä¹ˆï¼Ÿè€ƒè™‘ç›’å­å’Œçƒæ¨¡å‹$\lambda (\pi,A,B)$ï¼ŒçŠ¶æ€é›†åˆ$Qï¼{1,2,3}$ï¼Œè§‚æµ‹é›†åˆ$Vï¼{çº¢,ç™½}$è§‚æµ‹åºåˆ— $O={ çº¢, ç™½, çº¢ }$è¾“å‡º: è§‚æµ‹åºåˆ— $O={ çº¢, ç™½, çº¢ }$ çš„æ¦‚ç‡$t=1$æ—¶åˆ»çš„å‰å‘æ¦‚ç‡éšè—çŠ¶æ€ä¸ºç›’å­1ä¸”ä¸ºçº¢è‰²çƒçš„æ¦‚ç‡ä¸º: éšè—çŠ¶æ€ä¸ºç›’å­ 2 ä¸”ä¸ºçº¢è‰²çƒçš„æ¦‚ç‡ä¸º: éšè—çŠ¶æ€ä¸ºç›’å­3ä¸”ä¸ºçº¢è‰²çƒçš„æ¦‚ç‡ä¸º: $t=2$æ—¶åˆ»çš„å‰å‘æ¦‚ç‡(åœ¨å‰ä¸€ä¸ªè§‚æµ‹çŠ¶æ€ä¸ºçº¢è‰²çƒçš„åŸºç¡€ä¸‹)éšè—çŠ¶æ€æ˜¯ç›’å­1ä¸”ä¸ºç™½è‰²çƒçš„æ¦‚ç‡ä¸º å…³é”® : è¿™é‡Œå¯ä»¥ç†è§£æˆï¼Œåœ¨$t=2$çš„æ—¶å€™ï¼Œä¸”ç›’å­ä¸º1æ—¶ï¼Œå®ƒçš„$t=1$æ—¶åˆ»å¯èƒ½æ˜¯ç›’å­1æˆ–ç›’å­2æˆ–ç›’å­3ä¹Ÿå°±æ˜¯$t=2$çš„è·¯å¾„æœ‰(ç›’å­1-&gt;ç›’å­1ã€ç›’å­2-&gt;ç›’å­1ã€ç›’å­3-&gt;ç›’å­1)ï¼Œç”±å…¬å¼è¡¨è¿°å°±æ˜¯$$\sum_{i=1}^{3} \alpha_{1}(i) a_{i 1}$$éšè—çŠ¶æ€æ˜¯ç›’å­2ä¸”ä¸ºç™½è‰²çƒçš„æ¦‚ç‡ä¸º:$$\alpha_{2}(2)=\left[\sum_{i=1}^{3} \alpha_{1}(i) a_{i 2}\right] b_{2}\left(o_{2}\right)=[0.1 * 0.2+0.16 * 0.5+0.28 * 0.3] \times 0.6=0.1104$$éšè—çŠ¶æ€æ˜¯ç›’å­ 3 ä¸”ä¸ºç™½è‰²çƒçš„æ¦‚ç‡ä¸º:$$\alpha_{2}(3)=\left[\sum_{i=1}^{3} \alpha_{1}(i) a_{i 3}\right] b_{3}\left(o_{2}\right)=[0.1 * 0.3+0.16 * 0.2+0.28 * 0.5] \times 0.3=0.0606$$* $t=3$æ—¶åˆ»çš„å‰å‘æ¦‚ç‡(åœ¨1æ—¶åˆ»ä¸ºçº¢è‰²çƒï¼Œ2æ—¶åˆ»ä¸ºç™½è‰²çƒçš„åŸºç¡€ä¸‹)éšè—çŠ¶æ€æ˜¯ç›’å­1ä¸”ä¸ºçº¢è‰²çƒçš„æ¦‚ç‡ä¸º:$$\begin{array}{l}\alpha_{3}(1)=\left[\sum_{i=1}^{3} \alpha_{2}(i) a_{i 1}\right] b_{1}\left(o_{3}\right)=[0.077 * 0.5+0.1104 * 0.3+0.0606 * 0.2] \times 0.5 = 0.04187\end{array}$$éšè—çŠ¶æ€æ˜¯ç›’å­2ä¸”ä¸ºçº¢è‰²çƒçš„æ¦‚ç‡ä¸º:$$\begin{array}{l}\alpha_{3}(2)=\left[\sum_{i=1}^{3} \alpha_{2}(i) a_{i 2}\right] b_{2}\left(o_{3}\right)=[0.077 * 0.2+0.1104 * 0.5+0.0606 * 0.3] \times 0.4 =0.03551\end{array}$$éšè—çŠ¶æ€æ˜¯ç›’å­3ä¸”ä¸ºçº¢è‰²çƒçš„æ¦‚ç‡ä¸º:$$\begin{array}{l}\alpha_{3}(3)=\left[\sum_{i=1}^{3} \alpha_{2}(i) a_{i 3}\right] b_{3}\left(o_{3}\right)=[0.077 * 0.3+0.1104 * 0.2+0.0606 * 0.5] \times 0.7 =0.05284\end{array}$$æœ€ç»ˆè§‚æµ‹åºåˆ— $$O=\{ çº¢, ç™½, çº¢ \}$$ çš„æ¦‚ç‡ä¸º: $$P(O \mid \lambda)=\sum_{i=1}^{3} \alpha_{3}(i)= 0.04187+0.03551+0.05284 = 0.13022$$123456789101112131415161718192021222324252627282930313233343536import numpy as npdef cal_step(pa, pb, state, last):    pa = np.array(pa)    pb = np.array(pb)    res = []    for idx, s in enumerate(np.array(pb)[:, state]):        tmp = sum([last[i] * a for i, a in enumerate(pa[:, idx])]) * s        res.append(round(tmp, 4))    return resdef cal_forward(pa, pb, ppi, po):    &quot;&quot;&quot; å‰å‘ç®—æ³• &quot;&quot;&quot;    # åˆå§‹åŒ–çŠ¶æ€    init_state = [round(p * pb[idx][0], 4) for idx, p in enumerate(ppi)]    print(init_state)    state = init_state    for step in range(1, len(po)):        state = cal_step(pa=pa, pb=pb, state=po[step], last=state)        print(state)    print(round(sum(state), 4))if __name__ == '__main__':    pi = [0.2, 0.4, 0.4]    B = [[0.5, 0.5], [0.4, 0.6], [0.7, 0.3], ]    A = [[0.5, 0.2, 0.3], [0.3, 0.5, 0.2], [0.2, 0.3, 0.5], ]    # çº¢ ç™½ çº¢    O = [0, 1, 0]    cal_forward(pa=A, pb=B, ppi=pi, po=O)    print(&quot;ç»“æŸ&quot;)ğŸåå‘æ¦‚ç‡å®šä¹‰ä¹Ÿå°±æ˜¯ä¸‹å›¾ä¸­æ ‡è®°çš„é‚£ä¸€éƒ¨åˆ†ï¼Œ$ \beta _t (i) $è¡¨ç¤ºçš„æ˜¯åœ¨$t$æ—¶åˆ»ï¼ŒéšçŠ¶æ€ä¸º$q_i$çš„æ¦‚ç‡åå‘æ¦‚ç‡åˆå€¼ï¼Œå®šä¹‰ä¸º1æ ¹æ®åå‘æ¦‚ç‡å®šä¹‰å¯ä»¥æ¨å‡ºç„¶åæ¥çœ‹ä¸Šå¼å’Œè¦è®¡ç®—çš„æ¦‚ç‡$ P(X| \lambda ) $ä¹‹é—´çš„å…³ç³»ä¸Šé¢$b_i(x_1) \pi _i$ä¹Ÿå°±æ˜¯$ \alpha _1(i) $çš„å®šä¹‰ï¼Œå®é™…ä¸Šï¼Œå¯¹äºä»»æ„æ—¶åˆ»$ t $ï¼Œå­˜åœ¨ä»¥ä¸‹ç­‰å¼æ¥ç€ï¼Œå‡è®¾å·²çŸ¥æ‰€æœ‰çš„ï¼Œæ¥æ¨å¯¼è§‚å¯Ÿä¸Šå¼ï¼Œåéƒ¨åˆ†å®é™…ä¸Šå°±æ˜¯$\alpha _{ij}$ï¼Œè€Œå‰åŠéƒ¨åˆ†ï¼Œæ ¹æ®å‰å‘æ¦‚ç‡ä¸­çš„è§‚æµ‹ç‹¬ç«‹æ€§å‡è®¾ï¼Œ$z_t$ä¸$x_1, \cdots ,x_T$éƒ½æ˜¯æ— å…³çš„ï¼Œå³ç›¸äº’ç‹¬ç«‹ï¼Œå¯ä»¥çœå»ï¼Œå› æ­¤ç¬¬äºŒéƒ¨åˆ†å¯ä»¥å˜ä¸ºå°†ç»“è®ºä»£å…¥$\beta _t{i}$å¾—åˆ°æ¡ä»¶æ¦‚ç‡ä¾‹å­é¢˜ç›®ä»ä¸ºå‰å‘æ¦‚ç‡å°èŠ‚æ‰€æè¿°$t=2$æ—¶åˆ»çš„åå‘æ¦‚ç‡2æ—¶åˆ»éšè—çŠ¶æ€ä¸ºç›’å­1çš„æ¡ä»¶ä¸‹ï¼Œ 3è§‚æµ‹ä¸ºçº¢çš„æ¦‚ç‡ä¸º $\beta_{2}(1)=0.5 \times 0.5+0.2 \times 0.4+0.3 \times 0.7=0.54$2æ—¶åˆ»éšè—çŠ¶æ€ä¸ºç›’å­2çš„æ¡ä»¶ä¸‹ï¼Œ 3è§‚æµ‹ä¸ºçº¢çš„æ¦‚ç‡ä¸º $\beta_{2}(2)=0.3 \times 0.5+0.5 \times 0.4+0.2 \times 0.7=0.49$2æ—¶åˆ»éšè—çŠ¶æ€ä¸ºä€‚å­3çš„æ¡ä»¶ä¸‹ï¼Œ 3è§‚æµ‹ä¸ºçº¢çš„æ¦‚ç‡ä¸º $\beta_{2}(3)=0.2 \times 0.5+0.3 \times 0.4+0.5 \times 0.7=0.57$$t=1$æ—¶åˆ»çš„åå‘æ¦‚ç‡1æ—¶åˆ»éšè—çŠ¶æ€ä¸ºç›’å­1çš„æ¡ä»¶ä¸‹ï¼Œ2ä¸ºç™½3ä¸ºçº¢çš„æ¦‚ç‡:1æ—¶åˆ»éšè—çŠ¶æ€ä¸ºç›’å­2çš„æ¡ä»¶ä¸‹ï¼Œ2ä¸ºç™½3ä¸ºçº¢çš„æ¦‚ç‡:1æ—¶åˆ»éšè—çŠ¶æ€ä¸ºç›’å­2çš„æ¡ä»¶ä¸‹ï¼Œ2ä¸ºç™½3ä¸ºçº¢çš„æ¦‚ç‡:æœ€ç»ˆè§‚æµ‹åºåˆ—$O={ çº¢, ç™½,  çº¢ }$ çš„æ¦‚ç‡ä¸º:å‚æ•°å­¦ä¹ è§£ç é—®é¢˜</content>
	</entry>
	<entry>
		<title>æ¡ä»¶éšæœºåœºCRF</title>
		<url>/article/12117.html</url>
		<content>å‰ç½®çŸ¥è¯†ç¬”è®°æ•´ç†è‡ªï¼šBilibiliç«™ä¸Šshuhuai008å¼ºåŠ¿æ‰‹æ¨è®²è§£çš„ç™½æ¿æ¨å¯¼CRFç³»åˆ—è¯¾ç¨‹ï¼Œè¯¾ç¨‹è´¨é‡å¾ˆé«˜ï¼æ¡ä»¶éšæœºåœºã€NLPã€‘ä»éšé©¬å°”ç§‘å¤«åˆ°æ¡ä»¶éšæœºåœºåˆ†ç±»é—®é¢˜æ ¹æ®è¾“å‡ºçš„ç±»å‹ï¼Œå¯ä»¥å°†å…¶åˆ’åˆ†ä¸ºç¡¬æ¨¡å‹å’Œè½¯æ¨¡å‹ç¡¬è¾“å‡º: è¾“å‡ºä¸º0æˆ–1è½¯è¾“å‡º: å¼•å…¥æ¦‚ç‡ï¼Œä¸ç›´æ¥è®¡ç®—è¾¹ç•Œï¼Œè€Œæ˜¯è®¡ç®—å–å„ç±»åˆ«çš„æ¦‚ç‡è½¯ç¡¬æ¨¡å‹ç¡¬æ¨¡å‹svmæ”¯æŒå‘é‡æœº(æœ€å¤§é—´éš”)å‡ ä½•è§’åº¦å‡ºå‘ï¼Œæ±‚çš„æ˜¯max margin classifierï¼Œå¼å­æœ€ç»ˆçš„å½¢å¼ä¸ºPLAæ„ŸçŸ¥æœºï¼Œå¯ä»¥çœ‹ä½œæœ€åŸºæœ¬çš„ç¥ç»å…ƒLDAçº¿æ€§åˆ¤åˆ«åˆ†æ(è¯¯åˆ†ç±»é©±åŠ¨)æ ¸å¿ƒæ€æƒ³: ç±»é—´å¤§ã€ç±»å†…å°è½¯æ¨¡å‹æ¦‚ç‡åˆ¤åˆ«æ¨¡å‹å»ºæ¨¡æ ¸å¿ƒæ˜¯å¯¹è¿›è¡Œå»ºæ¨¡ä¾‹å­_é€»è¾‘å›å½’(Logistics Regression, LR)ï¼Œæˆ–è€…ä¹Ÿå¯ä»¥å«SoftMax Regressionä¾‹å­_æœ€å¤§ç†µæ¨¡å‹(Maximum Entropy Model, MEM)åˆ©ç”¨æœ€å¤§ç†µæ€æƒ³(Maximum Entropy Model)é©±åŠ¨æ¨¡å‹ï¼Œä»ç†µæ¨¡å‹æ¥çœ‹ï¼ŒLGæ˜¯ç†µæ¨¡å‹çš„ä¸€ä¸ªç‰¹ä¾‹åœ¨æœ€å¤§ç†µåŸåˆ™ä¸‹ï¼Œå¦‚æœç»™å®šå‡å€¼å’Œæ–¹å·®ï¼Œé‚£ä¹ˆGaussian Distç†µæœ€å¤§ä¾‹å­_æœ€å¤§ç†µé©¬å°”ç§‘å¤«æ¨¡å‹(Maximum Entropy Markov Model, MEMM)ç»“åˆäº†MEMå’ŒHMMå½¢æˆäº†MEMMï¼Œå›¾æ¨¡å‹å¯ä»¥è¡¨è¾¾æˆé»„çº¿éƒ¨åˆ†(å…¨å±€å½±å“)æˆ–ç»¿çº¿éƒ¨åˆ†(å±€éƒ¨å½±å“)ï¼Œè¡¨è¾¾æˆç»¿çº¿æ˜¯ä¸ºäº†å’ŒHMMå¯¹æ¯”æ½œåœ¨é—®é¢˜: æ ‡æ³¨åå·®é—®é¢˜æ ‡æ³¨åå·®é—®é¢˜(Label Bias Problem): åŸå› æ˜¯å› ä¸ºå±€éƒ¨å½’ä¸€åŒ–ï¼Œä¸Šå›¾ä¸­ç°è‰²è™šçº¿å¯ä»¥è¡¨è¾¾ä¸ºï¼Œè¿™éƒ¨åˆ†è¦æ±‚ç¬¦åˆæ¦‚ç‡åˆ†å¸ƒï¼Œå› æ­¤éœ€è¦å½’ä¸€åŒ–ï¼Œå¼ºåˆ¶å˜ä¸ºæ¦‚ç‡åˆ†å¸ƒä¸å…¶ä»–æ¨¡å‹çš„å…³ç³»ä¸HMMçš„å…³ç³»HMMç›´æ¥æ±‚è”åˆæ¦‚ç‡åˆ†å¸ƒï¼Œå¯¹äºæ ‡æ³¨é—®é¢˜è€Œè¨€ï¼Œæ˜¾ç„¶ä¸éœ€è¦æ±‚è”åˆæ¦‚ç‡åˆ†å¸ƒï¼Œæ±‚æ¡ä»¶æ¦‚ç‡å°±å¯ä»¥äº†ï¼Œå› æ­¤MEMMæ¯”HMMæ›´ç®€å•æ‰“ç ´äº†HMMçš„è§‚æµ‹ç‹¬ç«‹å‡è®¾ï¼Œæ¯”å¦‚çš„æ ‡æ³¨ä¸ä»…å’Œæœ‰å…³ï¼Œä¹Ÿå’Œæœ‰å…³ï¼Œç”šè‡³å¯ä»¥è¯´å’Œæ•´ä¸ªéƒ½æœ‰å…³ç³»ï¼Œè¿™ä¸ªå‡è®¾æ›´åŠ åˆç†ï¼Œè§‚æµ‹é—´ä¸åº”è¯¥æ˜¯ç›¸äº’ç‹¬ç«‹çš„CRFå°†MEMMçš„æœ‰å‘è°ƒæ•´ä¸ºäº†æ— å‘ï¼Œå› æ­¤æ­¤æ—¶çš„å½’ä¸€åŒ–å˜ä¸ºäº†å…¨å±€å½’ä¸€åŒ–ï¼Œè§£å†³äº†æ ‡æ³¨åå·®é—®é¢˜æ¦‚ç‡ç”Ÿæˆæ¨¡å‹å»ºæ¨¡æ ¸å¿ƒæ˜¯å¯¹è¿›è¡Œå»ºæ¨¡ä¾‹å­_æœ´ç´ è´å¶æ–¯(Naive Bayes, NB)æœ´ç´ è´å¶æ–¯å‡è®¾å…¬å¼å¦‚ä¸‹æœ´ç´ è´å¶æ–¯æ¨¡å‹ç®€åŒ–ä¸ºä¸‹å›¾:è¯¥å›¾å¯ä»¥å…¬å¼è¡¨è¾¾ä¸ºï¼Œæ„æ€æ˜¯åœ¨ç»™å®šçš„æƒ…å†µä¸‹ï¼Œç‹¬ç«‹äºæˆ–è€…å¯ä»¥è§£é‡Šä¸ºå’Œä¹‹é—´å—åˆ°çš„é˜»éš”ï¼Œå› æ­¤åœ¨ç»™å®šçš„æƒ…å†µä¸‹ï¼Œç‹¬ç«‹äºä¾‹å­_éšé©¬å°”ç§‘å¤«(Hidden Markov Model, HMM)æœ´ç´ è´å¶æ–¯ä¸­çš„æ˜¯åˆ†ç±»é—®é¢˜ï¼Œå¦‚æœè¿™é‡ŒæŠŠçœ‹ä½œæ˜¯ä¸€ä¸ªæ ‡æ³¨é—®é¢˜ï¼Œæ­¤æ—¶æ¼”åŒ–ä¸ºåºåˆ—é¢„æµ‹HMMæœ‰ä¸¤ä¸ªé‡è¦å‡è®¾é½æ¬¡Markovå‡è®¾ï¼šè§‚æµ‹ç‹¬ç«‹å‡è®¾ï¼šå…¬å¼è¡¨è¾¾ä¸ºï¼Œæ„æ€æ˜¯åœ¨ç»™å®šçš„æƒ…å†µä¸‹ï¼Œç‹¬ç«‹äºä¾‹å­_é«˜æ–¯æ··åˆæ¨¡å‹(Gaussian mixture model, GMM)NB-(0/1 å˜ seq)-&gt; HMMGMM-(+times)-&gt; HMMæ¦‚ç‡å›¾æ¨¡å‹ç»“æ„D-Separationæ˜¯ä¸€ç§ç”¨æ¥åˆ¤æ–­å˜é‡æ˜¯å¦æ¡ä»¶ç‹¬ç«‹çš„å›¾å½¢åŒ–æ–¹æ³•ã€‚æ¢è¨€ä¹‹ï¼Œå¯¹äºä¸€ä¸ªDAG(æœ‰å‘æ— ç¯å›¾)Eï¼ŒD-Separationæ–¹æ³•å¯ä»¥å¿«é€Ÿçš„åˆ¤æ–­å‡ºä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´æ˜¯å¦æ˜¯æ¡ä»¶ç‹¬ç«‹çš„head-to-head(a-&gt;c&lt;-b)graph TB    A --&gt; C    B --&gt; Cåœ¨cæœªçŸ¥çš„æ¡ä»¶ä¸‹ï¼Œaã€bè¢«é˜»æ–­(blocked)ï¼Œæ˜¯ç‹¬ç«‹çš„ã€‚åè¿‡æ¥è®²ï¼Œåœ¨cå·²çŸ¥çš„æ¡ä»¶ä¸‹ï¼Œaã€bæ˜¯è¿é€šçš„ï¼Œä¸ç‹¬ç«‹ã€‚æ•°å­¦è¡¨ç¤ºæ˜¯tail-to-tailgraph TB    C --&gt; A    C --&gt; Båœ¨cç»™å®šçš„æ¡ä»¶ä¸‹ï¼Œaï¼Œbè¢«é˜»æ–­(blocked)ï¼Œæ˜¯ç‹¬ç«‹çš„ã€‚æ•°å­¦è¡¨ç¤ºæ˜¯head-to-tailgraph LR    A --&gt; C --&gt; Båœ¨cç»™å®šçš„æ¡ä»¶ä¸‹ï¼Œaï¼Œbè¢«é˜»æ–­(blocked)ï¼Œæ˜¯ç‹¬ç«‹çš„ã€‚æ•°å­¦è¡¨ç¤ºæ˜¯åŒ–ç®€åå¯å¾—æ— å‘å›¾å› å­åˆ†è§£è¿™é‡Œçš„æ— å‘å›¾ä»¥é©¬å°”ç§‘å¤«éšæœºåœºMRFä¸¾ä¾‹å…¶ä¸­ï¼Œæ˜¯æœ€å¤§å›¢çš„ä¸ªæ•°ï¼Œæ˜¯ç¬¬ä¸ªæœ€å¤§å›¢ï¼Œæ ¹æ®å› å­åˆ†è§£å®šç†ï¼Œè¦æ±‚åŠ¿å‡½æ•°ï¼Œæ˜¯æœ€å¤§å›¢çš„è¡¨è¾¾é€šå¸¸æŒ‡å®šåŠ¿å‡½æ•°æ˜¯ä¸€ä¸ªæŒ‡æ•°å‡½æ•°ï¼Œæ˜¯ä¸€ä¸ªèƒ½é‡å‡½æ•°ï¼Œæ˜¯çš„ç®€åŒ–è¡¨è¾¾ï¼Œéƒ½æ˜¯ä¸€ä¸ªå‡½æ•°å›¢çš„å®šä¹‰æ˜¯å­å›¾ä¸­æ¯ä¸ªç‚¹éƒ½èƒ½ç›¸äº’è¿é€šå¤šä¸ªå˜é‡ä¹‹é—´çš„è”åˆæ¦‚ç‡åˆ†å¸ƒèƒ½åŸºäºå›¢åˆ†è§£ä¸ºå¤šä¸ªå› å­çš„ä¹˜ç§¯ï¼Œæ¯ä¸ªå› å­ä»…ä¸ä¸€ä¸ªå›¢ç›¸å…³æ¼”åŒ–ä»¥ä¸‹æ˜¯ä»æœ´ç´ è´å¶æ–¯åˆ°CRFçš„æ¼”å˜ï¼Œé˜´å½±é«˜äº®éƒ¨åˆ†æ˜¯æ¯æ¬¡æ”¹å˜çš„åœ°æ–¹æœ´ç´ è´å¶æ–¯çš„åºåˆ—å½¢æ€(æˆ–è€…è¯´å¼•å…¥æ—¶é—´)å°±å˜æˆäº†HMMæ¨¡å‹ï¼Œæœ´ç´ è´å¶æ–¯çš„è§‚å¯Ÿç‹¬ç«‹å‡è®¾ï¼Œè¿™é‡Œä»å­˜åœ¨ï¼ŒåŒæ—¶HMMè¿˜å¤šäº†ä¸€é˜¶é©¬å°”ç§‘å¤«å‡è®¾ä»HMMåˆ°MEMMï¼Œä¸»è¦æ˜¯æ”¹å˜äº†è§‚æµ‹å˜é‡ä¸ºè¾“å…¥ï¼Œæ­¤æ—¶$x_2$ä¸ä»…å—$y_2$çš„å½±å“ï¼Œä¹Ÿä¼šå—åˆ°$y_1$çš„å½±å“ï¼Œä»è€Œæ‰“ç ´äº†è§‚æµ‹ç‹¬ç«‹å‡è®¾ï¼Œä½†ç”±äº$x_2,y_1,y_2$éœ€è¦åšå±€éƒ¨å½’ä¸€åŒ–ï¼Œå› æ­¤ä¼šäº§ç”Ÿæ ‡æ³¨åå·®é—®é¢˜ps: HMMåœ¨é¢„æµ‹æ—¶ï¼Œè¿˜å¯ä»¥åˆ†ä¸ºé¢„æµ‹é—®é¢˜å’Œæ»¤æ³¢é—®é¢˜é¢„æµ‹é—®é¢˜å®šä¹‰ä¸º$P(i_{t+1}| o_1,o_2, \cdots, o_t)$ï¼Œå³å·²çŸ¥å½“å‰å’Œå†å²æ—¶åˆ»ï¼Œé¢„æµ‹ä¸‹ä¸€æ—¶åˆ»çš„éšçŠ¶æ€æ»¤æ³¢é—®é¢˜å®šä¹‰ä¸º$P(i_{t}| o_1,o_2, \cdots, o_t)$ï¼Œå³å·²çŸ¥å½“å‰å’Œå†å²æ—¶åˆ»ï¼Œæ±‚å½“å‰æ—¶åˆ»çš„éšçŠ¶æ€CRFçš„å°±èƒ½è§£å†³æ ‡æ³¨åå·®é—®é¢˜ï¼Œå®ƒå°†$y$ä¹‹é—´çš„é¡ºåºï¼Œæ”¹ä¸ºäº†æ— å‘å›¾ï¼Œè¿™æ„å‘³ç€ï¼Œ$y$ä¹‹é—´çš„å½’ä¸€åŒ–æ˜¯å…¨å±€çš„ï¼Œå› æ­¤è§£å†³äº†æ ‡æ³¨åå·®é—®é¢˜HMMé©¬å°”ç§‘å¤«éšæœºåœº(MRF)åœ¨å›¾åƒå¤„ç†ä¸­çš„åº”ç”¨-å›¾åƒåˆ†å‰²ã€çº¹ç†è¿ç§»HMMæ˜¯ä¸€ä¸ªç”Ÿæˆæ¨¡å‹ï¼Œå¯ä»¥çœ‹æˆæ˜¯NBæˆ–GMMçš„æ³›åŒ–å‚æ•°å®šä¹‰ä¸ºï¼Œå…¶ä¸­æ˜¯åˆå§‹çŠ¶æ€åˆ†å¸ƒã€æ˜¯yä¹‹é—´çš„çŠ¶æ€è½¬ç§»çŸ©é˜µ(åˆ°çš„æ¦‚ç‡)ã€æ˜¯ä»å‘å°„åˆ°çš„å‘å°„çŸ©é˜µHMMæœ‰ä¸¤ä¸ªé‡è¦å‡è®¾(éå¿…é¡»ï¼ŒæŠ˜ä¸­çš„æ–¹å¼ï¼Œå‡å°‘è®¡ç®—é‡)ä¸€é˜¶é½æ¬¡Markovå‡è®¾ï¼šä¸€é˜¶: å«ä¹‰ä¸ºåªå’Œæœ‰å…³ç³»ï¼Œæˆ–è€…è¡¨è¿°ä¸ºç»™å®šçš„æƒ…å†µä¸‹å’Œæ˜¯æ— å…³çš„ï¼ŒäºŒé˜¶çš„è¯å°±æ˜¯ç»™å®šå’Œçš„æƒ…å†µä¸‹å’Œæ˜¯æ— å…³çš„é½æ¬¡: å«ä¹‰ä¸ºæ¯ä¸ªçš„æ¦‚ç‡æ˜¯æ˜¯ä¸€è‡´ï¼Œä¹Ÿå¯ä»¥è¡¨è¿°ä¸ºå’Œæ˜¯ç›¸ç­‰çš„ï¼Œä¹Ÿå°±æ˜¯ä¸æ—¶é—´æ— å…³æœ¯è¯­åŒ–è¡¨è¾¾: è§‚æµ‹ç‹¬ç«‹å‡è®¾ï¼šå…¬å¼è¡¨è¾¾ä¸ºï¼Œæ„æ€æ˜¯åœ¨ç»™å®šçš„æƒ…å†µä¸‹ï¼Œç‹¬ç«‹äºæœ¯è¯­åŒ–è¡¨è¾¾: å»ºæ¨¡å¯¹è±¡å¦‚ä¸‹è®¡ç®—å¤æ‚åº¦å¤ªé«˜ï¼Œäºæ˜¯å¼•å…¥äº†å‰å‘åå‘ç®—æ³•MEMMä¸HMMæ¯”è¾ƒï¼Œå°†å˜ä¸ºäº†çš„è¾“å…¥ï¼Œæ­¤æ—¶ç»™å®šçš„æƒ…å†µä¸‹ï¼Œå’Œä¸æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œä»è€Œæ‰“ç ´è§‚æµ‹ç‹¬ç«‹æ€§å‡è®¾æ­¤æ—¶çš„MEMMå»ºæ¨¡å¯¹è±¡å˜ä¸ºäº†æ¡ä»¶æ¦‚ç‡ï¼Œä¸ºåˆ¤åˆ«æ¨¡å‹åœ¨è¿™é‡Œï¼Œåˆ¤åˆ«å¼çš„æ¨¡å‹æ¯”ç”Ÿæˆå¼æ¨¡å‹è¦å¥½å› ä¸ºï¼šä»»åŠ¡é©±åŠ¨çš„ï¼Œåœ¨è¿™æ ·çš„åºåˆ—æ ‡æ³¨ä»»åŠ¡ä¸Šï¼Œåœ¨ç»™å®šä¸€ä¸ªå¾…æ ‡æ³¨åºåˆ—ï¼Œæˆ‘ä»¬æ›´å…³æ³¨çš„æ˜¯æ ‡æ³¨çš„æ˜¯ä»€ä¹ˆï¼Œå› æ­¤ï¼Œå¯¹äºè¿™æ ·çš„ä»»åŠ¡æˆ‘ä»¬åªéœ€è¦å¯¹æ¡ä»¶æ¦‚ç‡å»ºæ¨¡å°±è¶³çŸ£äº†ï¼Œè€Œå»æ±‚è”åˆæ¦‚ç‡åˆ†å¸ƒå°±å°†é—®é¢˜å¤æ‚åŒ–äº†(è®¡ç®—ä¹Ÿå¤æ‚åŒ–äº†)è¿™é‡ŒæŠŠæ•´ä¸ªè¾“å…¥åˆ†æˆäº†2ä¸ªéƒ¨åˆ†ï¼Œï¼Œå³å¯¹çš„å½±å“åˆ†æˆä¸¤ä¸ªéƒ¨åˆ†ï¼šå…¨å±€çš„å½±å“+å±€éƒ¨çš„å½±å“ä¸»è¦ç¼ºç‚¹æ˜¯ä¼šé€ æˆLabel Bias Problemï¼Œï¼ˆåœ¨John Laffertyè®ºæ–‡ä¸­ï¼ŒæŒ‡å‡ºäº†MEMMä¼šé€ æˆLabel Bias Problemé—®é¢˜ï¼‰çœ‹ä¸Šæ–¹ç°è‰²æ¡†å†…çš„å±€éƒ¨ï¼Œå¯ä»¥ç®€å•çœ‹æˆæ˜¯é€»è¾‘å›å½’ï¼Œåœ¨è¿™ä¸ªæœ€å°å•å…ƒæˆ‘ä»¬æŠŠå®ƒå½“æˆä¸€ä¸ªç³»ç»Ÿï¼Œç³»ç»Ÿä»åˆ°çš„è¿™æ ·ä¸€ä¸ªè½¬ç§»ç”¨æ•°å­¦å¯ä»¥è¡¨ç¤ºæˆä¸€ä¸ªå‡½æ•°ï¼Œæ˜¯å—ã€ä¸å…±åŒä½œç”¨çš„ä¸€ä¸ªå‡½æ•°ï¼Œç³»ç»Ÿå¯¹å¤–æ˜¯æœ‰ä¸€å®šèƒ½é‡çš„ï¼Œè¿™ä¸ªå‡½æ•°è¢«ç§°ä¸ºMass Scoreï¼Œè€Œä¸”æ˜¯å¤§äº0çš„ã€‚ä½†æ˜¯é—®é¢˜å‡ºç°åœ¨ï¼šè¿™ä¸ªMass Scoreè¢«å±€éƒ¨å½’ä¸€åŒ–äº†ã€‚æ¡ä»¶æ¦‚ç‡ç†µè¶Šå°ï¼Œé‚£ä¹ˆå¯¹äºè§‚æµ‹å€¼çš„è€ƒè™‘è¶Šå°‘ä¸ºäº†èƒ½å¤Ÿæ›´å¥½åœ°ç†è§£å®ƒçš„é—®é¢˜æ‰€åœ¨ï¼Œè¿™é‡Œä¸¾ä¸€ä¸ªæ¯”è¾ƒæç«¯çš„ä¾‹å­æ¯”å¦‚ï¼Œæˆ‘ä»¬è®­ç»ƒå¥½äº†è¿™æ ·çš„ä¸€ä¸ªæ¨¡å‹ï¼Œç°æœ‰ä¸€ä¸ªè§‚æµ‹åºåˆ—æ˜¯ribåœ¨çŠ¶æ€0æ—¶ï¼Œç”±äºï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹©ä»è½¬ç§»è·¯å¾„ï¼›é—®é¢˜å‡ºç°åœ¨äº†ç¬¬äºŒæ­¥è½¬ç§»ä¸Šï¼šç”±äºï¼Œæ˜¯å—åˆ°äº†å±€éƒ¨å½’ä¸€åŒ–çš„å½±å“ï¼Œä»4çŠ¶æ€è½¬ç§»ä»…æœ‰1æ¡è·¯å¾„é€‰æ‹©ï¼Œå…¶è½¬ç§»çš„æ¡ä»¶æ¦‚ç‡ä¸º1ï¼Œå…¶æ‰€å…·æœ‰çš„ç†µå€¼ä¸º0ä¸ºä»€ä¹ˆä»4çŠ¶æ€å‘5è½¬ç§»çš„æ¡ä»¶æ¦‚ç‡ä¸º1æ­£æ˜¯å› ä¸ºMEMMåœ¨æ¯ä¸€æ­¥è½¬ç§»çš„æ¦‚ç‡éƒ½æ˜¯è¦åšå±€éƒ¨å½’ä¸€åŒ–çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä»4çŠ¶æ€å‘å¤–è½¬ç§»çš„æ‰€æœ‰çš„æƒ…å†µåŠ å’Œè¦ä¸º1ï¼Œåœ¨è¿™é‡Œï¼Œä»…æœ‰1ä¸­è½¬ç§»æƒ…å†µï¼Œæ‰€ä»¥åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ— è®ºè§‚æµ‹å€¼ä¸ºä»€ä¹ˆï¼Œéƒ½ä¸ä¼šå½±å“çš„è½¬ç§»ï¼Œä½†æ˜¯ï¼Œè¿™æ ·æ ‡æ³¨å‡ºæ¥çš„åºåˆ—ï¼Œå³robå°±ä¸å®¢è§‚äº‹å®ä¸ç¬¦äº†ï¼Œè¿™ä¹Ÿå°±æ˜¯é—®é¢˜çš„æ‰€åœ¨CRFæ‰€ä»¥ï¼Œä¸ºäº†è§£å†³å±€éƒ¨å½’ä¸€åŒ–çš„é—®é¢˜ï¼ŒCRFå–æ¶ˆäº†Yåºåˆ—çš„è½¬ç§»æ–¹å‘ï¼Œä¹Ÿå°±æ˜¯å–æ¶ˆäº†å±€éƒ¨å½’ä¸€åŒ–ï¼Œæ”¹å˜ä¸ºäº†å…¨å±€å½’ä¸€åŒ– CRFCRFæ˜¯é©¬å°”ç§‘å¤«éšæœºåœºMRFçš„ç‰¹ä¾‹ï¼Œå®ƒå‡è®¾é©¬å°”ç§‘å¤«éšæœºåœºä¸­åªæœ‰ğ‘‹å’Œğ‘Œä¸¤ç§å˜é‡ï¼Œğ‘‹ä¸€èˆ¬æ˜¯ç»™å®šçš„ï¼Œè€Œğ‘Œä¸€èˆ¬æ˜¯åœ¨ç»™å®šğ‘‹çš„æ¡ä»¶ä¸‹æˆ‘ä»¬çš„è¾“å‡ºã€‚è¿™æ ·é©¬å°”ç§‘å¤«éšæœºåœºå°±ç‰¹åŒ–æˆäº†æ¡ä»¶éšæœºåœºæ¡ä»¶ä½“ç°åœ¨å®ƒæ˜¯åˆ¤åˆ«å¼æ¨¡å‹ï¼Œè®¡ç®—æ¡ä»¶æ¦‚ç‡éšæœºåœºä½“ç°åœ¨æ˜¯æ— å‘å›¾æ¨¡å‹ï¼Œæˆ–è€…è¯´æ˜¯é©¬å°”ç§‘å¤«éšæœºåœºMRFå›¾ä¸­å’Œæ˜¯ä¸ºäº†è¡¨è¾¾ä¸Šçš„æ–¹ä¾¿é€šå¸¸åœ¨æ²¡æœ‰è¯´æ˜çš„æƒ…å†µä¸‹ï¼ŒCRFæŒ‡çš„å°±æ˜¯çº¿æ€§é“¾æ¡ä»¶éšæœºåœºæ¦‚ç‡å¯†åº¦å‡½æ•°å‚æ•°åŒ–æ ¹æ®æ— å‘å›¾å› å­åˆ†è§£å…¬å¼ï¼Œæ¦‚ç‡å¯†åº¦å‡½æ•°å¯ä»¥è¡¨è¾¾ä¸ºå…¶ä¸­æœ€å¤§å›¢å±•å¼€ä¹‹åå°±æ˜¯å› ä¸ºè¿™é‡Œæ˜¯çº¿æ€§é“¾ï¼Œæ¯ä¸ªç»“æ„éƒ½ä¸€æ ·ï¼Œæ²¡æœ‰å¿…è¦ä¸ºæ¯ä¸€ä¸ªéƒ½è®¾ä¸€ä¸ªå‡½æ•°ï¼Œå› æ­¤è¿™é‡Œè¡¨è¾¾ä¸ºè€Œä¸æ˜¯æ¥ç€ï¼Œæˆ‘ä»¬å›¾ä¸­ç°è‰²æ¡†éƒ¨åˆ†ä¸¾ä¾‹ï¼Œè¿™é‡Œå¯ä»¥æŠŠæ‹†æˆä¸‰éƒ¨åˆ†æ¥çœ‹ï¼Œã€å’Œå®ƒä»¬ä¹‹é—´è¾¹çš„å…³ç³»å‰ä¸¤ä¸ªå¯ä»¥çœ‹æˆçŠ¶æ€å‡½æ•°ï¼Œç¬¬ä¸‰ä¸ªå¯ä»¥çœ‹æˆæ˜¯çŠ¶æ€è½¬ç§»å‡½æ•°åŒæ—¶ç¬¬ä¸€ä¸ªå¯ä»¥å¿½ç•¥æ‰ï¼ŒåŸå› åœ¨äºç›®å‰æ˜¯åœ¨æ—¶åˆ»ï¼Œè€Œåœ¨æ—¶åˆ»æ—¶ï¼Œå·²ç»æœ‰äº†ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢çš„ç¬¬äºŒéƒ¨åˆ†è¿™é‡Œçš„ä¸ºä»€ä¹ˆå¯ä»¥æŠŠFæ‹†æˆä¸‰éƒ¨åˆ†å‘¢ï¼Œä»å›¾ä¸Šçœ‹å¯èƒ½æœ‰äº›çªå…€ï¼Œè¿™é‡Œå¯ä»¥å¸¦å…¥åˆ°æ ‡æ³¨é—®é¢˜æ¥ç†è§£æ¯”å¦‚è¿™é‡Œæœ‰ä¸€å¥è¯: å°æ˜ æ˜¯ ä¸­å›½äººå‡è®¾è¿™é‡Œå·²ç»åˆ†è¿‡è¯äº†ï¼Œè¿™é‡Œè¦å»åˆ¤æ–­è¯æ€§ï¼Œè¿™é‡Œå’Œæ˜¯å±äºè¯æ€§{åè¯ã€å½¢å®¹è¯ã€åŠ¨è¯ã€â€¦}çš„é›†åˆå› æ­¤è¿™é‡Œå‰ä¸¤ä¸ªå¯ä»¥çœ‹æˆçŠ¶æ€å‡½æ•°è€Œç¬¬ä¸‰ä¸ªå°±è¡¨ç¤ºä¸¤ä¸ªçŠ¶æ€ä¹‹é—´çš„è½¬ç§»å‡½æ•°çŠ¶æ€å‡½æ•°å’Œè½¬ç§»å‡½æ•°å…¶ä¸­æ˜¯ä¸€ä¸ªç‰¹å¾å‡½æ•°ï¼Œä¸€èˆ¬æ˜¯æŒ‡ç¤ºå‡½æ•°ï¼Œæ¯”å¦‚\Delta{y{t}, x{1:T}} = \sum {l=1}^{L}{\eta l g_l (y_t, x{1:T})}p(Y|X) = \frac {1}{Z} exp (\sum {i=1}^{K} {F_i(x{ci})}) = \frac {1}{Z} exp (\sum {t=1}^{T} {F(y{t-1},y_t, x{1:T})}) = \\frac {1}{Z} exp (\sum {t=1}^{T} [\sum {k=1}^{K}{\lambda k f_k(y{t-1}, t{t}, x{1:T})} + \sum {l=1}^{L}{\eta _l g_l (y_t, x{1:T})}]$$å†™å‡ºæ¦‚ç‡å¯†åº¦å‡½æ•°ä¹‹åï¼Œå°±å¯ä»¥æ±‚è§£äº†æœºå™¨å­¦ä¹ åŸºç¡€ï¼ˆä¸ƒï¼‰ï¼šæ¦‚ç‡å›¾æ¨¡å‹ï¼ˆHMMã€MRFã€CRFã€è¯é¢˜æ¨¡å‹ã€æ¨æ–­æ–¹æ³•ï¼‰https://blog.csdn.net/weixin_44949421/article/details/120523212æ¦‚ç‡å›¾æ¨¡å‹ï¼ˆPGMï¼‰ï¼ˆæˆ–ç®€ç§°å›¾æ¨¡å‹ï¼‰åœ¨å½¢å¼ä¸Šæ˜¯ç”±å›¾ç»“æ„ç»„æˆçš„ã€‚å›¾çš„æ¯ä¸ªèŠ‚ç‚¹ï¼ˆnodeï¼‰éƒ½å…³è”äº†ä¸€ä¸ªéšæœºå˜é‡ï¼Œè€Œå›¾çš„è¾¹ï¼ˆedgeï¼‰åˆ™è¢«ç”¨äºç¼–ç è¿™äº›éšæœºå˜é‡ä¹‹é—´çš„å…³ç³»ã€‚æ ¹æ®å›¾æ˜¯æœ‰å‘çš„è¿˜æ˜¯æ— å‘çš„ï¼Œæˆ‘ä»¬å¯ä»¥å°†å›¾çš„æ¨¡å¼åˆ†ä¸ºä¸¤å¤§ç±»â€”â€”è´å¶æ–¯ç½‘ç»œï¼ˆâ€ŠBayesian networkï¼‰å’Œé©¬å°”å¯å¤«ç½‘ç»œï¼ˆMarkov networksï¼‰0.æ¦‚ç‡å›¾ï¼šç”¨å›¾æ¥è¡¨è¾¾å˜é‡ä¹‹å‰ç›¸å…³å…³ç³»çš„æ¦‚ç‡æ¨¡å‹ã€‚å…¶ä¸­å›¾ä¸­çš„ç‚¹è¡¨ç¤ºä¸€ç»„éšæœºå˜é‡ï¼Œè¾¹è¡¨ç¤ºéšæœºå˜é‡ä¹‹é—´çš„æ¦‚ç‡ç›¸å…³å…³ç³» 1.æœ‰å‘å›¾æ¨¡å‹/è´å¶æ–¯ç½‘ï¼šæœ‰å‘æ— ç¯å›¾ã€‚å½“å˜é‡ä¹‹é—´æœ‰æ˜ç¡®çš„å› æœå…³ç³»æ—¶ä½¿ç”¨ 2.æ— å‘å›¾æ¨¡å‹/é©¬å°”ç§‘å¤«ç½‘ï¼šæ— å‘å›¾ã€‚å½“å˜é‡ä¹‹é—´æœ‰å…³ç³»ï¼Œä½†éš¾ä»¥è·å¾—æ˜ç¡®çš„å› æœå…³ç³»æ—¶ä½¿ç”¨ 3.ç”Ÿæˆå¼æ¨¡å‹ï¼šå¯¹è”åˆæ¦‚ç‡è¿›è¡Œå»ºæ¨¡ï¼Œå¦‚éšé©¬å°”å¯å¤«æ¨¡å‹ã€é©¬å°”å¯å¤«éšæœºåœº 4.åˆ¤åˆ«å¼æ¨¡å‹ï¼šå¯¹æ¡ä»¶æ¦‚ç‡è¿›è¡Œå»ºæ¨¡ï¼Œå¦‚æ¡ä»¶éšæœºåœºé©¬å°”å¯å¤«æ€§1.å…¨å±€é©¬å°”å¯å¤«æ€§ï¼šç»™å®šä¸¤ä¸ªå˜é‡å­é›†çš„åˆ†ç¦»é›†ï¼Œåˆ™è¿™ä¸¤ä¸ªå˜é‡å­é›†æ¡ä»¶ç‹¬ç«‹ã€‚2.å±€éƒ¨é©¬å°”å¯å¤«æ€§ï¼šç»™å®šæŸå˜é‡çš„é‚»æ¥å˜é‡ï¼Œåˆ™è¯¥å˜é‡ç›¸å¯¹å…¶ä»–å˜é‡æ¡ä»¶ç‹¬ç«‹ã€‚3.å¯¹ç§°é©¬å°”å¯å¤«æ€§ï¼šç»™å®šæ‰€æœ‰å…¶ä»–å˜é‡ï¼Œä¸¤ä¸ªéé‚»æ¥å˜é‡æ¡ä»¶ç‹¬ç«‹ã€‚å¯¹æ¯”MRFå’ŒCRFï¼Œéƒ½æ˜¯ä½¿ç”¨å›¢ä¸Šçš„åŠ¿å‡½æ•°æ¥å®šä¹‰æ¦‚ç‡ï¼Œåªæ˜¯ä¸€ä¸ªæ˜¯è”åˆæ¦‚ç‡ï¼Œä¸€ä¸ªæ˜¯æ¡ä»¶æ¦‚ç‡7.1éšé©¬å°”å¯å¤«æ¨¡å‹Hidden Markov Modelï¼ŒHMMç»“æ„æœ€ç®€å•çš„åŠ¨æ€è´å¶æ–¯ç½‘dynamic Bayesian networkï¼Œç”Ÿæˆå¼æœ‰å‘å›¾æ¨¡å‹ï¼Œä¸»è¦ç”¨äºæ—¶åºæ•°æ®å»ºæ¨¡ï¼ˆè¯­éŸ³è¯†åˆ«ã€è‡ªç„¶è¯­è¨€å¤„ç†ç­‰é¢†åŸŸï¼‰7.2é©¬å°”å¯å¤«éšæœºåœºMarkov Random Fieldï¼ŒMRFå…¸å‹çš„é©¬å°”å¯å¤«ç½‘ï¼Œç”Ÿæˆå¼æ— å‘å›¾æ¨¡å‹ä¸ºæ»¡è¶³éè´Ÿæ€§ï¼ŒæŒ‡æ•°å‡½æ•°å¸¸è¢«ç”¨äºå®šä¹‰åŠ¿å‡½æ•°æ¯ä¸ªçŠ¶æ€çš„è½¬ç§»åªä¾èµ–äºä¹‹å‰çš„nä¸ªçŠ¶æ€ï¼Œè¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸º1ä¸ªné˜¶çš„æ¨¡å‹ï¼Œå…¶ä¸­næ˜¯å½±å“è½¬ç§»çŠ¶æ€çš„æ•°ç›®ã€‚æœ€ç®€å•çš„é©¬å°”å¯å¤«è¿‡ç¨‹å°±æ˜¯ä¸€é˜¶è¿‡ç¨‹ï¼Œæ¯ä¸€ä¸ªçŠ¶æ€çš„è½¬ç§»åªä¾èµ–äºå…¶ä¹‹å‰çš„é‚£ä¸€ä¸ªçŠ¶æ€ï¼Œè¿™ä¸ªä¹Ÿå«ä½œé©¬å°”å¯å¤«æ€§è´¨ã€‚é©¬å°”å¯å¤«æ€§è´¨ï¼šä¸€å¥è¯æ€»ç»“å°±æ˜¯â€œæœªæ¥åªä¸ç°åœ¨æœ‰å…³â€ï¼Œå³ç»™å®šä¸€ä¸ªè¿‡ç¨‹å½“å‰çŠ¶æ€åŠå†å²çš„æ‰€æœ‰çŠ¶æ€ï¼Œå…¶æœªæ¥çŠ¶æ€ä»…ä¾èµ–äºå½“å‰çŠ¶æ€ï¼Œä¸å†å²çŠ¶æ€æ— å…³ï¼Œè¿™ç§æ€§è´¨å«åšé©¬å°”ç§‘å¤«æ€§è´¨ã€‚è¿™é‡Œæ¯”è¾ƒæœ‰æ„æ€çš„äº‹æƒ…æ˜¯ï¼Œæœ‰äº›éé©¬å°”å¯å¤«è¿‡ç¨‹å¯ä»¥é€šè¿‡æ‰©å±•â€œç°åœ¨â€å’Œâ€œæœªæ¥â€çŠ¶æ€çš„æ¦‚å¿µæ¥æ„é€ ä¸€ä¸ªé©¬å°”å¯å¤«è¿‡ç¨‹ï¼Œè¿™ç§æƒ…å†µç§°ä¸ºäºŒé˜¶é©¬å°”å¯å¤«è¿‡ç¨‹ã€‚ä»¥æ­¤ç±»æ¨ï¼Œè¿˜å¯ä»¥æ„é€ æ›´é«˜é˜¶çš„é©¬å°”å¯å¤«è¿‡ç¨‹ã€‚é©¬å°”å¯å¤«é“¾ï¼šæ˜¯ä¸€ç§æœ€ç®€å•çš„é©¬å°”å¯å¤«è¿‡ç¨‹ï¼Œä¸“æŒ‡ç¦»æ•£æŒ‡æ•°é›†çš„é©¬å°”å¯å¤«è¿‡ç¨‹ã€‚ç»å…¸çš„é©¬å°”å¯å¤«é“¾ä¸»è¦æ˜¯ç ”ç©¶å½“å‰çŠ¶æ€å’Œæœªæ¥çŠ¶æ€ä¹‹é—´çš„è½¬ç§»æ¦‚ç‡ï¼Œå¹¶å¯ä»¥è®¡ç®—å‡ºå¤šæ¬¡è¯•éªŒä¹‹åçš„æ¯ä¸ªçŠ¶æ€çš„æ¦‚ç‡åˆ†å¸ƒï¼Œä»è€Œå°†çœ‹èµ·æ¥æ¯«æ— è§„å¾‹çš„ä¸€äº›éšæœºç°è±¡å˜æˆäº†æ•´ä½“æœ‰åºçš„çŠ¶æ€å˜åŒ–ã€‚é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ï¼Œæ˜¯å°†é©¬å°”å¯å¤«æ€§è´¨åº”ç”¨äºæ—¶åºå†³ç­–å»ºæ¨¡çš„æ–¹æ³•ï¼Œè®¾å®šæ™ºèƒ½ä½“çš„éšæœºæ€§ç­–ç•¥å’Œå›æŠ¥ç¬¦åˆé©¬å°”å¯å¤«æ€§è´¨ï¼Œè¿™æ ·å°±å°†æ™ºèƒ½ä½“åœ¨ä¸ç¯å¢ƒäº¤äº’ä¸­çš„çŠ¶æ€è½¬ç§»è®¡ç®—è¿‡ç¨‹å®šä¹‰ä¸ºé©¬å°”å¯å¤«æ€§è´¨çš„çŠ¶æ€è½¬ç§»è¿‡ç¨‹è®¡ç®—ã€‚é€šè¿‡ä½¿ç”¨åŠ¨æ€è§„åˆ’ã€éšæœºé‡‡æ ·ç­‰æ–¹æ³•ï¼ŒMDPå¯ä»¥æ±‚è§£ä½¿å›æŠ¥æœ€å¤§åŒ–çš„æ™ºèƒ½ä½“ç­–ç•¥ã€‚å½“ä»Šäººå·¥æ™ºèƒ½ç ”ç©¶ä¸­ç«çƒ­çš„å¼ºåŒ–å­¦ä¹ æ–¹å‘ï¼Œæ–¹æ³•çš„åŸºçŸ³å°±æ˜¯é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹ï¼ˆMarkov Decision Processes, MDPï¼‰ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯Bellmané€šè¿‡ç¦»æ•£éšæœºæœ€ä¼˜æ§åˆ¶æ¨¡å‹é¦–æ¬¡æå‡ºçš„ï¼Œå¯¹äºæ—¶åºå†³ç­–é—®é¢˜å…·æœ‰å¾ˆå¥½çš„å»ºæ¨¡èƒ½åŠ›ã€‚éšé©¬å°”å¯å¤«æ¨¡å‹ï¼Œæ˜¯å¯¹é©¬å°”å¯å¤«æ¨¡å‹çš„æ‰©å±•ï¼Œè¿™ç§æ¨¡å‹çš„æ€æƒ³æ ¸å¿ƒæ˜¯æŠŠé©¬å°”ç§‘å¤«çš„çŠ¶æ€è½¬ç§»è®¾å®šä¸ºæœªçŸ¥çš„éšå«é‡ï¼Œé€šè¿‡å¯è§‚æµ‹çš„çŠ¶æ€è½¬ç§»è¿‡ç¨‹æ¥ä¼°è®¡éšå«çš„çŠ¶æ€ï¼Œç„¶åå†ç”¨éšå«çŠ¶æ€æ¥é¢„è®¡æœªæ¥çš„å˜åŒ–ï¼Œåˆ©ç”¨è¿™ç§æ–¹æ³•å‘ç°å¾ˆå¤šå®é™…é—®é¢˜èƒ½å¤Ÿå¾—åˆ°æœ‰æ•ˆçš„å»ºæ¨¡ï¼Œå…¸å‹çš„åº”ç”¨åŒ…æ‹¬äº†è¯­éŸ³è¯†åˆ«ã€ç”Ÿç‰©ä¿¡æ¯ç§‘å­¦çš„DNAåˆ†æå’Œæ•…éšœè¯Šæ–­ç­‰é¢†åŸŸã€‚é©¬å°”å¯å¤«éšæœºåœºï¼Œç»™éšæœºåœºå®šä¹‰ä¸€ç§é©¬å°”å¯å¤«æ€§è´¨ï¼Œå³éšæœºåœºä¸­æ¯ä¸ªä½ç½®çš„å±æ€§å®šä¹‰æ˜¯é©¬å°”å¯å¤«æ€§çš„ï¼Œç®€å•ç†è§£å°±æ˜¯éšæœºåœºä¸­æ¯ä¸ªä½ç½®çš„å±æ€§åªä¸é‚»è¿‘çš„ä½ç½®æœ‰å…³ï¼Œä¸å…¶ä»–ä½ç½®æ— å…³ã€‚è¿™ç§æ–¹æ³•è¢«åº”ç”¨äºå›¾åƒåˆ†å‰²å–å¾—è¾ƒå¥½æ•ˆæœã€‚CRFå’ŒMRFåŒºåˆ«ï¼šMRFå’ŒCRFå»ºæ¨¡æ€è·¯æ˜¯ä¸ä¸€æ ·çš„ï¼ŒMRFæ˜¯ä¸€ç§generativeæ¨¡å‹ã€‚æ‰€è°“generativeæ¨¡å‹å°±æ˜¯éœ€è¦å…ˆå¾—å‡ºå˜é‡çš„æ¦‚ç‡æ¨¡å‹å‚æ•°ï¼Œç„¶ååœ¨è¿›è¡Œæ¨æ–­ä»»åŠ¡ã€‚å¦‚bayes æ¨æ–­ä¸­ï¼Œå¯ä»¥å…ˆå‡å®šå˜é‡æœä»é«˜æ–¯åˆ†å¸ƒï¼Œç„¶ååˆ©ç”¨ä¼¼ç„¶å‡½æ•°æ–¹æ³•æ±‚å–é«˜æ–¯åˆ†å¸ƒçš„å‡å€¼å’Œæ–¹å·®è¿™äº›å‚æ•°ï¼Œä»è€Œå¾—å‡ºå˜é‡çš„æ¦‚ç‡åˆ†å¸ƒæ¨¡å‹ï¼ŒåæœŸæ¨æ–­æ—¶ä¾æ®è¯¥æ¨¡å‹å¾—å‡ºç›¸åº”çš„ç»“è®ºã€‚å¯¹äºMRFæ¨¡å‹è€Œè¨€ï¼Œç”±äºéœ€è¦è€ƒè™‘è§‚å¯Ÿå˜é‡yå’Œæ ‡å·å˜é‡xæ¦‚ç‡åˆ†å¸ƒé—®é¢˜ï¼Œè¿™æœ¬èº«å°±æ˜¯ä¸€ä¸ªéå¸¸å›°éš¾çš„é—®é¢˜ã€‚å› ä¸ºä¸€èˆ¬è‡ªç„¶å›¾ç‰‡åƒç´ å’Œå…¶æ ‡å·åˆ†å¸ƒï¼Œå¾ˆéš¾é‡‡ç”¨ä¸€ä¸ªç®€å•çš„æ¨¡å‹åŠ ä»¥æè¿°ï¼ŒMRFæ˜¯è¡¨è¾¾è¿™ç§æ¨¡å‹çš„ä¸€ç§æ–¹æ³•ã€‚å¯¹äºæŸä¸€å¼ å›¾ç‰‡æˆ‘ä»¬çš„å…´è¶£ç‚¹åœ¨äºå…¶æ ‡å·ï¼Œè€Œä¸å…³å¿ƒåŸå§‹åƒç´ yçš„åˆ†å¸ƒï¼Œæ‰€ä»¥æ²¡æœ‰å¿…è¦èŠ±è´¹èµ„æºè€ƒè™‘yçš„æ¦‚ç‡åˆ†å¸ƒé—®é¢˜ã€‚CRFä¾¿æ˜¯åŸºäºè¿™ä¸€ç‚¹ï¼Œæå‡ºä¸€ç§discriminativeæ¨¡å‹ã€‚æ‰€è°“discriminativeæ¨¡å‹ï¼Œå°±æ˜¯ä¸ç”¨è€ƒè™‘åŸå§‹å˜é‡å®é™…çš„æ¦‚ç‡åˆ†å¸ƒé—®é¢˜ï¼Œç›´æ¥ç ”ç©¶æ ‡å·æ¨æ–­é—®é¢˜ã€‚æ¯”å¦‚å¯¹äºäºŒåˆ†é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è·å–å…¶åˆ¤åˆ«å¼hï¼Œå½“h&gt;0æ—¶å±äºAç±»ï¼Œåä¹‹å±äºBç±»ã€‚è¿™æ ·åœ¨ä¸çŸ¥é“å˜é‡åœ¨Aï¼ŒBä¸¤ç±»ä¸­çš„å®é™…æ¦‚ç‡åˆ†å¸ƒï¼Œä¾¿å¯ä»¥å¾—å‡ºæˆ‘ä»¬å…³å¿ƒçš„åˆ†ç±»ç»“æœã€‚MRFå’ŒCRFéƒ½æ˜¯å±äºå›¾ç†è®ºä¸­çš„é—®é¢˜ï¼ŒåŒºåˆ«åœ¨äºä»–ä»¬èƒ½é‡å‡½æ•°å»ºç«‹ç»†èŠ‚ä¸åŒã€‚MRFç†è®ºä¸Šéœ€è¦æ˜¾å¾—å‡ºè§‚å¯Ÿå˜é‡yå’Œæ ‡å·å˜é‡xçš„å®é™…æ¦‚ç‡åˆ†å¸ƒã€‚ä½†æ˜¯ç”±äºè®¡ç®—èƒ½åŠ›çš„é™åˆ¶ï¼Œè¿™ä¸€ç‚¹æ— æ³•æ»¡è¶³ï¼Œæ‰€ä»¥ç›®å‰ç ”ç©¶ä¸­ï¼Œé‡‡ç”¨äº†è¿‘ä¼¼çš„æ–¹æ³•ã€‚å‡å®šxçš„å…ˆéªŒåˆ†å¸ƒå’Œyæ²¡æœ‰å…³ç³»ï¼Œåªå’Œç›¸é‚»ä¸¤èŠ‚ç‚¹æœ‰å…³ã€‚è€Œyä¸­æŸä¸€ä¸ªèŠ‚ç‚¹yiçš„åˆ†å¸ƒåªä¸å½“å‰æ ‡å·å˜é‡xiæœ‰å…³ï¼Œä¸€èˆ¬å‡å®šæ»¡è¶³é«˜æ–¯åˆ†å¸ƒã€‚è¿™æ ·çš„å‡è®¾æ˜¯ä¸€ç§å¦¥åï¼Œå‰Šå¼±äº†MRFçš„èƒ½åŠ›ï¼Œä½†æ˜¯ä¾¿äºè®¡ç®—å®ç°ã€‚åœ¨è‡ªç„¶å›¾ç‰‡ä¸­è¿™äº›å‡è®¾å¾ˆéš¾æˆç«‹ã€‚é’ˆå¯¹ä¸Šé¢çš„é—®é¢˜ï¼Œä¸ºäº†æé«˜MRFçš„èƒ½åŠ›ï¼ŒåŒæ—¶ä¿æŒå…¶å¯è®¡ç®—æ€§ï¼ŒCRFè¢«æäº†å‡ºæ¥ã€‚åœ¨CRFä¸­xiå’Œæ‰€æœ‰çš„è§‚å¯Ÿå˜é‡yæœ‰å…³ï¼Œè¿™ä¸ªæ„æˆèŠ‚ç‚¹èƒ½é‡ï¼Œxiå’Œxjä¹Ÿå’Œæ‰€æœ‰çš„è§‚å¯Ÿå˜é‡yæœ‰å…³ï¼Œæ„æˆè¾¹ç¼˜èƒ½é‡ã€‚è¿™æ ·æé«˜äº†MRFçš„é€‚ç”¨æ€§ã€‚CRFä¸­èŠ‚ç‚¹èƒ½é‡å’Œè¾¹ç¼˜èƒ½é‡å‡æ˜¯é€šè¿‡discriminativeæ–¹å¼å®ç°ï¼Œå…¶ä¸­èŠ‚ç‚¹èƒ½é‡é€šè¿‡çº¿æ€§åˆ†ç±»å™¨å®ç°ã€‚è€Œåœ¨MRFä¸­èŠ‚ç‚¹èƒ½é‡æ˜¯é€šè¿‡generativeæ¨¡å‹å®ç°ï¼Œå¦‚é«˜æ–¯åˆ†å¸ƒã€‚é©¬å°”å¯å¤«ç½‘ç»œä¸€èˆ¬æŒ‡é©¬å°”å¯å¤«éšæœºåœºã€‚ é©¬å°”å¯å¤«éšæœºåœºï¼ˆMarkov Random Fieldï¼‰ï¼Œä¹Ÿæœ‰äººç¿»è¯‘ä¸ºé©¬å°”ç§‘å¤«éšæœºåœºï¼Œé©¬å°”å¯å¤«éšæœºåœºæ˜¯å»ºç«‹åœ¨é©¬å°”å¯å¤«æ¨¡å‹å’Œè´å¶æ–¯ç†è®ºåŸºç¡€ä¹‹ä¸Šçš„ï¼Œå®ƒåŒ…å«ä¸¤å±‚æ„æ€ï¼šä¸€æ˜¯ä»€ä¹ˆæ˜¯é©¬å°”å¯å¤«ï¼ŒäºŒæ˜¯ä»€ä¹ˆæ˜¯éšæœºåœºæ¡ä»¶éšæœºåœºï¼ˆConditional random fieldï¼ŒCRFï¼‰æ˜¯æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒæ¨¡å‹ P(Y|X) ï¼Œè¡¨ç¤ºçš„æ˜¯ç»™å®šä¸€ç»„è¾“å…¥éšæœºå˜é‡ X çš„æ¡ä»¶ä¸‹å¦ä¸€ç»„è¾“å‡ºéšæœºå˜é‡ Y çš„é©¬å°”å¯å¤«éšæœºåœºï¼Œä¹Ÿå°±æ˜¯è¯´ CRF çš„ç‰¹ç‚¹æ˜¯å‡è®¾è¾“å‡ºéšæœºå˜é‡æ„æˆé©¬å°”å¯å¤«éšæœºåœºã€‚æ¡ä»¶éšæœºåœºå¯è¢«çœ‹ä½œæ˜¯æœ€å¤§ç†µé©¬å°”å¯å¤«æ¨¡å‹åœ¨æ ‡æ³¨é—®é¢˜ä¸Šçš„æ¨å¹¿ç»™å‡ºä¸€ä¸ªæ ·æœ¬xï¼Œåˆ¤åˆ«çŒ«å’Œç‹—ï¼Œåˆ¤åˆ«å¼æ¨¡å‹ç›´æ¥å¯ä»¥ç”¨ argâ¡maxyP(y|x) æ¥è¿›è¡Œåˆ¤æ–­ï¼Œè¿™ä¹Ÿæ˜¯åˆ¤åˆ«å¼æ¨¡å‹çš„å»ºæ¨¡ç›®æ ‡ï¼›å¯¹äºç”Ÿæˆå¼æ¨¡å‹ï¼Œæ˜¯é€šè¿‡çœ‹ ï¼ŒçŒ«P(xï¼ŒY=çŒ«) å’Œ ç‹—P(x,Y=ç‹—) è°å¤§æ¥è¿›è¡Œåˆ¤æ–­ã€‚å¯ä»¥çœ‹å‡ºï¼Œåˆ¤åˆ«æ¨¡å‹èƒ½æ›´ç›´æ¥åº”ç”¨åˆ°åˆ†ç±»ä»»åŠ¡ä¸­ï¼Œè€Œç”Ÿæˆæ¨¡å‹ç”¨äºåˆ†ç±»ä»»åŠ¡æ—¶ï¼Œè¿˜éœ€è¦â€ç»•â€ä¸€ä¸‹è‡ªç„¶è¯­è¨€å¤„ç†åºåˆ—æ¨¡å‹â€”â€”MRFå’ŒCRFæ¡ä»¶éšæœºåœº</content>
	</entry>
	<entry>
		<title>è´ªå¿ƒç®—æ³•</title>
		<url>/article/51855.html</url>
		<content>è´ªå¿ƒç®—æ³•æ¦‚å¿µæ¡ˆä¾‹</content>
	</entry>
	<entry>
		<title>åŠ¨æ€è§„åˆ’</title>
		<url>/article/55046.html</url>
		<content>åŠ¨æ€è§„åˆ’æ¦‚å¿µåŠ¨æ€è§„åˆ’(è‹±è¯­ï¼šDynamic programmingï¼Œç®€ç§° DP)ï¼Œæ˜¯ä¸€ç§åœ¨æ•°å­¦ã€ç®¡ç†ç§‘å­¦ã€è®¡ç®—æœºç§‘å­¦ã€ç»æµå­¦å’Œç”Ÿç‰©ä¿¡æ¯å­¦ä¸­ä½¿ç”¨çš„ï¼Œé€šè¿‡æŠŠåŸé—®é¢˜åˆ†è§£ä¸ºç›¸å¯¹ç®€å•çš„å­é—®é¢˜çš„æ–¹å¼æ±‚è§£å¤æ‚é—®é¢˜çš„æ–¹æ³•åŠ¨æ€è§„åˆ’å¸¸å¸¸é€‚ç”¨äºæœ‰é‡å å­é—®é¢˜å’Œæœ€ä¼˜å­ç»“æ„æ€§è´¨çš„é—®é¢˜é€‚ç”¨æƒ…å†µåŠ¨æ€è§„åˆ’æœ‰å‡ ä¸ªå…¸å‹ç‰¹å¾ï¼Œæœ€ä¼˜å­ç»“æ„ã€çŠ¶æ€è½¬ç§»æ–¹ç¨‹ã€è¾¹ç•Œã€é‡å å­é—®é¢˜æœ€ä¼˜å­ç»“æ„: å¦‚æœæŸæ¡è·¯å¾„æ˜¯èµ·ç‚¹åˆ°ç»ˆç‚¹çš„æœ€çŸ­è·¯å¾„ï¼Œåˆ™èµ·ç‚¹åˆ°è¯¥è·¯å¾„ä¸Šçš„æ¯ä¸€ç‚¹éƒ½æ˜¯æœ€çŸ­è·¯å¾„ï¼Œä¸€ä¸ªæœ€ä¼˜åŒ–ç­–ç•¥çš„å­ç­–ç•¥æ€»æ˜¯æœ€ä¼˜çš„ï¼Œæœ€ä¼˜åŒ–åŸç†æ˜¯åŠ¨æ€è§„åˆ’çš„åŸºç¡€æ— åæ•ˆæ€§: å½“å‰é€‰æ‹©ä»»ä½•ä¸€æ¡è¾¹éƒ½ä¸ä¼šå½±å“ä»¥åé€‰æ‹©å…¶ä»–è¾¹ï¼Œå¦‚æœå½“å‰é€‰æ‹©ä¼šå½±å“åé¢çš„é€‰æ‹©åˆ™ä¸é€‚ç”¨ï¼Œæ¯ä¸ªçŠ¶æ€éƒ½æ˜¯è¿‡å»å†å²çš„ä¸€ä¸ªå®Œæ•´æ€»ç»“åŠ¨æ€è§„åˆ’è§£é¢˜çš„æ­¥éª¤æ‰¾å‡ºæœ€ä¼˜å­ç»“æ„å†™å‡ºåŠ¨æ€è§„åˆ’æ–¹ç¨‹ä½¿ç”¨è‡ªåº•å‘ä¸Šæˆ–è€…è‡ªé¡¶å‘ä¸‹çš„æ–¹æ³•æ±‚è§£é€†æ¨æ±‚è§£å°ç»“åŠ¨æ€è§„åˆ’çš„é€‚ç”¨æ¡ä»¶ä»»ä½•æ€æƒ³æ–¹æ³•éƒ½æœ‰ä¸€å®šçš„å±€é™æ€§ï¼Œè¶…å‡ºäº†ç‰¹å®šæ¡ä»¶ï¼Œå®ƒå°±å¤±å»äº†ä½œç”¨åŒæ ·,åŠ¨æ€è§„åˆ’ä¹Ÿå¹¶ä¸æ˜¯ä¸‡èƒ½çš„ï¼Œé€‚ç”¨åŠ¨æ€è§„åˆ’çš„é—®é¢˜å¿…é¡»æ»¡è¶³æœ€ä¼˜åŒ–åŸç†å’Œæ— åæ•ˆæ€§åŠ¨æ€è§„åˆ’çš„å®è´¨æ˜¯åˆ†æ²»æ€æƒ³å’Œè§£å†³å†—ä½™ï¼Œå› æ­¤ï¼ŒåŠ¨æ€è§„åˆ’æ˜¯ä¸€ç§å°†é—®é¢˜å®ä¾‹åˆ†è§£ä¸ºæ›´å°çš„ã€ç›¸ä¼¼çš„å­é—®é¢˜ï¼Œå¹¶å­˜å‚¨å­é—®é¢˜çš„è§£è€Œé¿å…è®¡ç®—é‡å¤çš„å­é—®é¢˜ï¼Œä»¥è§£å†³æœ€ä¼˜åŒ–é—®é¢˜çš„ç®—æ³•ç­–ç•¥åŠ¨æ€è§„åˆ’æ€æƒ³è®¾è®¡çš„ç®—æ³•ä»æ•´ä½“ä¸Šæ¥çœ‹åŸºæœ¬éƒ½æ˜¯æŒ‰ç…§å¾—å‡ºçš„é€’æ¨å…³ç³»å¼è¿›è¡Œé€’æ¨ï¼Œè¿™ç§é€’æ¨ç›¸å¯¹äºè®¡ç®—æœºæ¥è¯´ï¼Œåªè¦è®¾è®¡å¾—å½“ï¼Œæ•ˆç‡å¾€å¾€æ˜¯æ¯”è¾ƒé«˜çš„ï¼Œè¿™æ ·åœ¨æ—¶é—´ä¸Šæº¢å‡ºçš„å¯èƒ½æ€§ä¸å¤§ç›¸ååœ°ï¼ŒåŠ¨æ€è§„åˆ’éœ€è¦å¾ˆå¤§çš„ç©ºé—´ä»¥å­˜å‚¨ä¸­é—´äº§ç”Ÿçš„ç»“æœï¼Œè¿™æ ·å¯ä»¥ä½¿åŒ…å«åŒä¸€ä¸ªå­é—®é¢˜çš„æ‰€æœ‰é—®é¢˜å…±ç”¨ä¸€ä¸ªå­é—®é¢˜è§£ï¼Œä»è€Œä½“ç°åŠ¨æ€è§„åˆ’çš„ä¼˜è¶Šæ€§ä½†è¿™æ˜¯ä»¥ç‰ºç‰²ç©ºé—´ä¸ºä»£ä»·çš„ï¼Œä¸ºäº†æœ‰æ•ˆåœ°è®¿é—®å·²æœ‰ç»“æœï¼Œæ•°æ®ä¹Ÿä¸æ˜“å‹ç¼©å­˜å‚¨ï¼Œå› è€Œç©ºé—´çŸ›ç›¾æ˜¯æ¯”è¾ƒçªå‡ºçš„å¦ä¸€æ–¹é¢ï¼ŒåŠ¨æ€è§„åˆ’çš„é«˜æ—¶æ•ˆæ€§å¾€å¾€è¦é€šè¿‡å¤§çš„æµ‹è¯•æ•°æ®ä½“ç°å‡ºæ¥(ä»¥ä¸æœç´¢ä½œæ¯”è¾ƒ)ï¼Œå› è€Œï¼Œå¯¹äºå¤§è§„æ¨¡çš„é—®é¢˜å¦‚ä½•åœ¨åŸºæœ¬ä¸å½±å“è¿è¡Œé€Ÿåº¦çš„æ¡ä»¶ä¸‹ï¼Œè§£å†³ç©ºé—´æº¢å‡ºçš„é—®é¢˜ï¼Œæ˜¯åŠ¨æ€è§„åˆ’è§£å†³é—®é¢˜æ—¶ä¸€ä¸ªæ™®éä¼šé‡åˆ°çš„é—®é¢˜æ—¶ç©ºçŸ›ç›¾ä¸€ä¸ªæ€è€ƒæ–¹å‘æ˜¯å°½å¯èƒ½å°‘å ç”¨ç©ºé—´ã€‚å¦‚ä»ç»“ç‚¹çš„æ•°æ®ç»“æ„ä¸Šè€ƒè™‘ï¼Œä»…ä»…å­˜å‚¨å¿…ä¸å¯å°‘çš„å†…å®¹ï¼Œä»¥åŠæ•°æ®å­˜å‚¨èŒƒå›´ä¸Šç²¾æ‰“ç»†ç®—(æŒ‰ä½å­˜å‚¨ã€å‹ç¼©å­˜å‚¨ç­‰)ï¼Œå½“ç„¶è¿™è¦å› é—®é¢˜è€Œå¼‚ï¼Œè¿›è¡Œåˆ†æï¼Œå¦å¤–ï¼Œåœ¨å®ç°åŠ¨æ€è§„åˆ’æ—¶ï¼Œä¸€ä¸ªæˆ‘ä»¬ç»å¸¸é‡‡ç”¨çš„æ–¹æ³•æ˜¯ç”¨ä¸€ä¸ªä¸ç»“ç‚¹æ•°ä¸€æ ·å¤šçš„æ•°ç»„æ¥å­˜å‚¨æ¯ä¸€æ­¥çš„å†³ç­–ï¼Œè¿™å¯¹äºå€’æ¨æ±‚å¾—ä¸€ç§å®ç°æœ€ä¼˜è§£çš„æ–¹æ³•æ˜¯ååˆ†æ–¹ä¾¿çš„ï¼Œè€Œä¸”å¤„ç†é€Ÿåº¦ä¹Ÿæœ‰ä¸€äº›æé«˜ä½†æ˜¯åœ¨å†…å­˜ç©ºé—´ç´§å¼ çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°±åº”è¯¥æŠ“ä½é—®é¢˜çš„ä¸»è¦çŸ›ç›¾ã€‚çœå»è¿™ä¸ªå­˜å‚¨å†³ç­–çš„æ•°ç»„ï¼Œè€Œæ”¹æˆåœ¨ä»æœ€ä¼˜è§£é€çº§å€’æ¨æ—¶ï¼Œå†è®¡ç®—ä¸€æ¬¡ï¼Œé€‰æ‹©æŸä¸ªå¯èƒ½è¾¾åˆ°è¿™ä¸ªå€¼çš„ä¸Šä¸€é˜¶æ®µçš„çŠ¶æ€ï¼Œç›´åˆ°æ¨å‡ºç»“æœä¸ºæ­¢ã€‚è¿™æ ·åš,åœ¨ç¨‹åºç¼–å†™ä¸Šæ¯”ä¸Šä¸€ç§åšæ³•ç¨å¾®å¤šèŠ±ä¸€ç‚¹æ—¶é—´ï¼Œè¿è¡Œçš„æ—¶æ•ˆä¹Ÿå¯èƒ½ä¼šæœ‰ä¸€äº›(ä½†å¾€å¾€å¾ˆå°)çš„ä¸‹é™ï¼Œä½†å´æ¢æ¥äº†å¾ˆå¤šçš„ç©ºé—´ã€‚å› è€Œè¿™ç§æ€æƒ³åœ¨å¤„ç†æŸäº›é—®é¢˜æ—¶,æ˜¯å¾ˆæœ‰æ„ä¹‰çš„æ¡ˆä¾‹ğŸ¸é’è›™è·³é˜¶é¢˜ç›®åŠ¨æ€è§„åˆ’è¯¦è§£æ€è·¯é€’å½’: é’è›™ğŸ¸è·³é˜¶å¯ä»¥ä½¿ç”¨é€’å½’æ±‚è§£å¸¦è®°å¿†çš„é€’å½’: è€Œé€’å½’æ±‚è§£ä¸­å­˜åœ¨å¤§é‡çš„é‡å¤è®¡ç®—ï¼Œå¯ä»¥å¼•å…¥çŠ¶æ€è®°å¿†ï¼Œé¿å…å¤§é‡çš„é‡å¤è®¡ç®—é€’æ¨: é™¤äº†é€’å½’æ–¹å¼ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨é€’æ¨çš„æ–¹å¼è®¡ç®—ï¼Œç›®æ ‡æ˜¯ç®—å‡ºF(1)ã€F(2)â€¦F(N)ï¼Œåªéœ€è¦ä¸¤ä¸ªçŠ¶æ€å˜é‡å­˜å‚¨åŠ¨æ€è§„åˆ’: ä½¿ç”¨åŠ¨æ€è§„åˆ’çš„æ–¹å¼ï¼Œæ‹†åˆ†å­é—®é¢˜ï¼Œè®°ä½è¿‡å¾€ï¼Œå‡å°‘é‡å¤è®¡ç®—ï¼Œå…³é”®åœ¨äºçŠ¶æ€è½¬ç§»è½¬çŸ©é˜µè®¡ç®—çŠ¶æ€è½¬ç§»æ±‚è§£æ‰“å®¶åŠ«èˆhttps://leetcode.cn/problems/house-robber/1234567891011121314151617181920212223242526def run():    samples = [[1, 2, 3, 1], [2, 7, 9, 3, 1]]    for sample in samples:        one, two = sample[0], sample[1]  # è¡¨ç¤ºn-2ä½ç½®å¤„çš„æœ€å¤§ä»·å€¼ å’Œ n-1ä½ç½®å¤„çš„æœ€å¤§ä»·å€¼        res_sum = max(one, two)        for idx, s in enumerate(sample[2:], start=2):            # n-2ä½ç½®å¤„çš„æœ€å¤§ä»·å€¼+nä½ç½®å¤„çš„ä»·å€¼ å’Œ n-1ä½ç½®å¤„çš„æœ€å¤§ä»·å€¼            res_sum = max(one + s, two)            one, two = two, res_sum        print(res_sum)        # æš´åŠ›æ³•éªŒè¯    for sample in samples:        idx_lst = gen_bin(n=len(sample))        res_sum = max([sum([sample[idx] for idx, i in enumerate(bin(idx)[2:][::-1]) if int(i) == 1]) for idx in idx_lst])        print(res_sum)def gen_bin(n: int):    &quot;&quot;&quot; åˆ—å‡ºæ‰€æœ‰å¯èƒ½æ€§ &quot;&quot;&quot;    n = 1 &lt;&lt; n    res = []    while n := n - 1:        if '11' not in bin(n):            res.append(n)    return res</content>
	</entry>
	<entry>
		<title>é€’æ¨å’Œé€’å½’</title>
		<url>/article/54551.html</url>
		<content>é€’æ¨å’Œé€’å½’æ¦‚å¿µé€’å½’: ä»é—®é¢˜çš„æœ€ç»ˆç›®æ ‡å‡ºå‘ï¼Œé€æ¸å°†å¤æ‚é—®é¢˜åŒ–ä¸ºç®€å•é—®é¢˜ï¼Œæœ€ç»ˆæ±‚å¾—é—®é¢˜ï¼Œæ˜¯é€†å‘çš„é€’æ¨: æ˜¯ä»ç®€å•é—®é¢˜å‡ºå‘ï¼Œä¸€æ­¥æ­¥çš„å‘å‰å‘å±•ï¼Œæœ€ç»ˆæ±‚å¾—é—®é¢˜ã€‚æ˜¯æ­£å‘çš„ä¸€èˆ¬æ¥è¯´ï¼Œé€’æ¨çš„æ•ˆç‡é«˜äºé€’å½’(å½“ç„¶æ˜¯é€’æ¨å¯ä»¥è®¡ç®—çš„æƒ…å†µä¸‹)ï¼Œæ¯”å¦‚ï¼šæ–æ³¢é‚£å¥‘æ•°åˆ—æ¡ˆä¾‹é€’å½’å®ç°æŒ‡æ•°å‹æšä¸¾é¢˜ç›®æè¿°ä» $1âˆ¼n$ è¿™ $n$ ä¸ªæ•´æ•°ä¸­éšæœºé€‰å–ä»»æ„å¤šä¸ªï¼Œè¾“å‡ºæ‰€æœ‰å¯èƒ½çš„é€‰æ‹©æ–¹æ¡ˆéš¾åº¦ç®€å•è¾“å…¥æ ¼å¼è¾“å…¥ä¸€ä¸ªæ•´æ•° $n$è¾“å‡ºæ ¼å¼æ¯è¡Œè¾“å‡ºä¸€ç§æ–¹æ¡ˆåŒä¸€è¡Œå†…çš„æ•°å¿…é¡»å‡åºæ’åˆ—ï¼Œç›¸é‚»ä¸¤ä¸ªæ•°ç”¨æ°å¥½ $1$ ä¸ªç©ºæ ¼éš”å¼€ã€‚å¯¹äºæ²¡æœ‰é€‰ä»»ä½•æ•°çš„æ–¹æ¡ˆï¼Œè¾“å‡ºç©ºè¡Œæœ¬é¢˜æœ‰è‡ªå®šä¹‰æ ¡éªŒå™¨ï¼ˆSPJï¼‰ï¼Œå„è¡Œï¼ˆä¸åŒæ–¹æ¡ˆï¼‰ä¹‹é—´çš„é¡ºåºä»»æ„æ•°æ®èŒƒå›´è¾“å…¥æ ·ä¾‹13è¾“å‡ºæ ·ä¾‹1234567322 311 31 21 2 3æ±‚è§£é€’å½’æ–¹å¼1234567891011n = input()def dfs(u, state):    if u == n:        res = [str(i + 1) for i in range(n) if state &gt;&gt; i &amp; 1]        print(&quot; &quot;.join(res))        return    dfs(u + 1, state)    dfs(u + 1, state | 1 &lt;&lt; u)    dfs(0, 0)   ä½è¿ç®—æ–¹å¼ç»™å®šnï¼Œæ±‚å‡º$[1,n]$çš„ç»„åˆï¼Œæ¯”å¦‚$n=5$ï¼Œå…¶ç»„åˆæ•°ä¸º$C_5^1+C_5^2+C_5^3+C_5^4+C_5^5 = 32$è¿™é‡Œå¯ä»¥æŠŠæ¯ä½æ˜¯å¦é€‰æ‹©ç”¨$n$ä½çš„äºŒè¿›åˆ¶è¡¨è¾¾ï¼Œæ¯”å¦‚$11 \cdots 11$ï¼Œä¸€ç›´å‡1ï¼Œå‡åˆ°0æ—¶ç»“æŸï¼ŒæœŸé—´æ¯ä¸ªäºŒè¿›åˆ¶å°±æ˜¯é€‰æ‹©çš„ç»“æœï¼Œè¾“å‡ºå¯¹åº”ç»“æœå°±å¥½1234567891011def solution(n):    a = 1 &lt;&lt; n    ct = 0    import time    t0 = time.time()    res = []    while a := a - 1:        ct += 1        res.append(bin(a))    print('\n'.join(res))    print(&quot;ct&quot;, ct, time.time() - t0)é€’å½’å®ç°ç»„åˆå‹æšä¸¾é¢˜ç›®æè¿°ä» $1âˆ¼n$ è¿™ $n$ ä¸ªæ•´æ•°ä¸­éšæœºé€‰å–$m$ä¸ªï¼Œè¾“å‡ºæ‰€æœ‰å¯èƒ½çš„é€‰æ‹©æ–¹æ¡ˆéš¾åº¦ç®€å•è¾“å…¥æ ¼å¼ä¸¤ä¸ªæ•´æ•° $n$ï¼Œ$m$åœ¨åŒä¸€è¡Œç”¨ç©ºæ ¼éš”å¼€è¾“å‡ºæ ¼å¼æŒ‰ç…§ä»å°åˆ°å¤§çš„é¡ºåºè¾“å‡ºæ‰€æœ‰æ–¹æ¡ˆï¼Œæ¯è¡Œ 1 ä¸ªé¦–å…ˆï¼ŒåŒä¸€è¡Œå†…çš„æ•°å‡åºæ’åˆ—ï¼Œç›¸é‚»ä¸¤ä¸ªæ•°ç”¨ä¸€ä¸ªç©ºæ ¼éš”å¼€å…¶æ¬¡ï¼Œå¯¹äºä¸¤ä¸ªä¸åŒçš„è¡Œï¼Œå¯¹åº”ä¸‹æ ‡çš„æ•°ä¸€ä¸€æ¯”è¾ƒï¼Œå­—å…¸åºè¾ƒå°çš„æ’åœ¨å‰é¢ï¼ˆä¾‹å¦‚ 1 3 5 7 æ’åœ¨ 1 3 6 8 å‰é¢ï¼‰æ•°æ®èŒƒå›´è¾“å…¥æ ·ä¾‹15 3è¾“å‡ºæ ·ä¾‹123456789101 2 3 1 2 4 1 2 5 1 3 4 1 3 5 1 4 5 2 3 4 2 3 5 2 4 5 3 4 5 æ±‚è§£é€’å½’æ–¹å¼123456789101112131415n = input()m = input()def dfs(u, sum_, state):    # ä¸æ»¡è¶³è¦æ±‚çš„å‰ªæ    if sum_ + n - u &lt; m:        return    if u == n:        res = [str(i + 1) for i in range(n) if state &gt;&gt; i &amp; 1]        print(&quot; &quot;.join(res))    dfs(u + 1, sum_, state)    dfs(u + 1, sum_ + 1, state | 1 &lt;&lt; u)dfs(0, 0, 0)ä½è¿ç®—æ–¹å¼123456789101112131415161718192021222324def lowbit(x: int):    return x &amp; -x    def cal_one(v):    ct = 0    while v:        v -= lowbit(v)        ct += 1    return ctdef solution_m(n, m):    # è·å–mä½çš„ç»„åˆ    a = 1 &lt;&lt; n    ct = 0    while a := a - 1:        if cal_one(a) == m:            ct += 1            print(bin(a))    print(&quot;ct&quot;, ct)if __name__ == '__main__':    solution_m(5, 3)é€’å½’å®ç°æ’åˆ—å‹æšä¸¾é¢˜ç›®æè¿°ä» $1âˆ¼n$ è¿™ $n$ ä¸ªæ•´æ•°æ’æˆä¸€è¡Œåéšæœºæ‰“ä¹±é¡ºåºï¼Œè¾“å‡ºæ‰€æœ‰å¯èƒ½çš„æ¬¡åºéš¾åº¦ç®€å•è¾“å…¥æ ¼å¼ä¸€ä¸ªæ•´æ•° $n$è¾“å‡ºæ ¼å¼æŒ‰ç…§ä»å°åˆ°å¤§çš„é¡ºåºè¾“å‡ºæ‰€æœ‰æ–¹æ¡ˆï¼Œæ¯è¡Œ 1 ä¸ªé¦–å…ˆï¼ŒåŒä¸€è¡Œç›¸é‚»ä¸¤ä¸ªæ•°ç”¨ä¸€ä¸ªç©ºæ ¼éš”å¼€ã€‚å…¶æ¬¡ï¼Œå¯¹äºä¸¤ä¸ªä¸åŒçš„è¡Œï¼Œå¯¹åº”ä¸‹æ ‡çš„æ•°ä¸€ä¸€æ¯”è¾ƒï¼Œå­—å…¸åºè¾ƒå°çš„æ’åœ¨å‰é¢ã€‚æ•°æ®èŒƒå›´è¾“å…¥æ ·ä¾‹13è¾“å‡ºæ ·ä¾‹1234561 2 31 3 22 1 32 3 13 1 23 2 1æ€è·¯æ¯æ¬¡é€‰å–æ²¡æœ‰é€‰è¿‡çš„æ•°æ±‚è§£12345678910111213141516n = input()path = []def dfs(u, state):    if u == n:        print(&quot; &quot;.join(path))        return    for i in range(n):        if not (state &gt;&gt; i &amp; 1):            path.append(str(i + 1))            dfs(u + 1, state | (1 &lt;&lt; i))            path.pop()dfs(0, 0)è´¹è§£çš„å¼€å…³é¢˜ç›®æè¿°æ±‚açš„bæ¬¡æ–¹å¯¹på–æ¨¡çš„å€¼éš¾åº¦ç®€å•è¾“å…¥æ ¼å¼ä¸‰ä¸ªæ•´æ•°a,b,pï¼Œåœ¨åŒä¸€è¡Œç”¨ç©ºæ ¼éš”å¼€è¾“å‡ºæ ¼å¼è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤º$(a^b) \% p$çš„ç»“æœæ•°æ®èŒƒå›´è¾“å…¥æ ·ä¾‹123 2 7123456789 0 1è¾“å‡ºæ ·ä¾‹1220æ€è·¯å¿«é€Ÿå¹‚12345678910113 ^ 10000000# å…ˆè®¡ç®—å‡º3 ^ 1 = 33 ^ 2 = 93 ^ 4 = 813 ^ 8 = 3 ^ 16 = 3 ^ 32 = ...3 ^ (2^19) = xxxğŸ¥•æ ¸å¿ƒ: å†çœ‹ä¸‹10000000çš„äºŒè¿›åˆ¶è¡¨ç¤ºï¼ŒæŠŠå¯¹åº”ä¸º1çš„ä½ä¹˜èµ·æ¥å°±å¯ä»¥10000000çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸º0b100110001001011010000000ï¼Œå› æ­¤åªè¦å¯¹åº”ä½ç½®çš„å€¼ä¹˜èµ·æ¥å°±æ˜¯3 ^ 10000000ğŸ¥•æ ¹æ®æ•°å­¦å¸¸è¯†ï¼Œæ¯ä¸€ä¸ªæ­£æ•´æ•°å¯ä»¥å”¯ä¸€è¡¨ç¤ºä¸ºè‹¥å¹²æŒ‡æ•°ä¸é‡å¤çš„2çš„æ¬¡å¹•çš„å’Œ12345678910111213141516171819def ck_sum_of_power(in_n: int):    &quot;&quot;&quot;    æ£€éªŒæ•´æ•°å¯ä»¥ç”±è‹¥å¹²ä¸ªä¸é‡å¤çš„2çš„æ¬¡å¹‚çš„å’Œ    @param in_n:    @return:    &quot;&quot;&quot;    nb = in_n    res = 0    v = 1    while nb:        if nb &amp; 1:            res += v        v *= 2        nb &gt;&gt;= 1    return resif __name__ == '__main__':    print(all([ck_sum_of_power(in_n=i) == i for i in range(100)]))ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœbåœ¨äºŒè¿›åˆ¶è¡¨ç¤ºä¸‹æœ‰$k$ä½ï¼Œå…¶ä¸­ç¬¬$i(0&lt;i&lt;k)$ä½çš„æ•°å­—æ˜¯$c_i$ï¼Œåˆ™äºæ˜¯å› ä¸º$k= \lceil log2(b+1) \rceil $ï¼Œæ‰€ä»¥ä¸Šå¼ä¹˜ç§¯é¡¹çš„æ•°é‡ä¸å¤šäº$\lceil log2(b+1) \rceil$ä¸ªåˆå› ä¸º$a^{2^i} = {a^{(2^{i-1})}}^2$ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾ˆå®¹æ˜“é€šè¿‡$k$æ¬¡é€’æ¨æ±‚å‡ºæ¯ä¸ªä¹˜ç§¯é¡¹ï¼Œå½“$c_i=1$æ—¶ï¼ŒæŠŠè¯¥ä¹˜ç§¯é¡¹ç´¯ç§¯åˆ°ç­”æ¡ˆä¸­b&amp;1è¿ç®—å¯ä»¥å–å‡ºbåœ¨äºŒè¿›åˆ¶è¡¨ç¤ºä¸‹çš„æœ€ä½ä½ï¼Œè€Œb&gt;&gt;1è¿ç®—å¯ä»¥èˆå»æœ€ä½ä½ï¼Œåœ¨é€’æ¨çš„è¿‡ç¨‹ä¸­å°†äºŒè€…ç»“åˆï¼Œå°±å¯ä»¥éå†båœ¨äºŒè¿›åˆ¶è¡¨ç¤ºä¸‹çš„æ‰€æœ‰æ•°ä½$c_i$ï¼Œæ•´ä¸ªç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸ºO($log2(b)$)æ±‚è§£123456789101112def solution(a: int, b: int, p: int) -&gt; int:    res = 1 % p    while b:        # å¦‚æœbçš„ä¸ªä½æ˜¯1        if b &amp; 1:            res = res *  a % p        # å‡†å¤‡åä½        a = a * a % p        # å»æ‰å„ä½        b &gt;&gt;= 1    return resä¸‰å±‚æ±‰è¯ºå¡”12345678910111213141516171819202122232425262728293031def hanoi(n, from_, temp, to):    &quot;&quot;&quot;    @param n: å‰©ä½™ç›˜å­æ•°é‡    @param from_: å½“å‰ä½ç½®    @param temp: ä¸´æ—¶ä½ç½®    @param to: ç›®æ ‡ä½ç½®    @return:    &quot;&quot;&quot;    if n == 1:        print(from_ + &quot; -&gt; &quot; + to)        return    hanoi(n - 1, from_, to, temp)    print(from_ + &quot; -&gt; &quot; + to)    hanoi(n - 1, temp, from_, to)def solution(n: int, from_, temp, to):    hanoi(n, from_, temp, to)if __name__ == '__main__':    solution(n=3, from_='A', temp='B', to='C')    # è¾“å‡ºA -&gt; CA -&gt; BC -&gt; BA -&gt; CB -&gt; AB -&gt; CA -&gt; CğŸ¸é’è›™è·³é˜¶é¢˜ç›®æ€è·¯é€’å½’: é’è›™è·³é˜¶å¯ä»¥ä½¿ç”¨é€’å½’æ±‚è§£å¸¦è®°å¿†çš„é€’å½’: è€Œé€’å½’æ±‚è§£ä¸­å­˜åœ¨å¤§é‡çš„é‡å¤è®¡ç®—ï¼Œå¯ä»¥å¼•å…¥çŠ¶æ€è®°å¿†ï¼Œé¿å…å¤§é‡çš„é‡å¤è®¡ç®—é€’æ¨: é™¤äº†é€’å½’æ–¹å¼ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨é€’æ¨çš„æ–¹å¼è®¡ç®—ï¼Œç›®æ ‡æ˜¯ç®—å‡ºF(1)ã€F(2)â€¦F(N)ï¼Œåªéœ€è¦ä¸¤ä¸ªçŠ¶æ€å˜é‡å­˜å‚¨åŠ¨æ€è§„åˆ’: ä½¿ç”¨åŠ¨æ€è§„åˆ’çš„æ–¹å¼ï¼Œæ‹†åˆ†å­é—®é¢˜ï¼Œè®°ä½è¿‡å¾€ï¼Œå‡å°‘é‡å¤è®¡ç®—ï¼Œå…³é”®åœ¨äºçŠ¶æ€è½¬ç§»è½¬çŸ©é˜µè®¡ç®—çŠ¶æ€è½¬ç§»æ±‚è§£1234567891011121314151617181920212223from functools import lru_cache@lru_cache()def fab(n: int):    # å¸¦è®°å¿†çš„é€’å½’    return 1 if n &lt;= 1 else fab(n - 1) + fab(n - 2)def fab_no_stock(n: int):    # é€’æ¨    res = 0    one, two = 1, 1    while n := n - 1:        res = one + two        one, two = two, res    return resif __name__ == '__main__':    p_t = 10    res = fab(n=p_t)    print(res)    res_no = fab_no_stock(n=p_t)    print(res_no)</content>
	</entry>
	<entry>
		<title>ç®—æ³•ç»¼è¿°</title>
		<url>/article/39101.html</url>
		<content>ç®—æ³•ç®—æ³•å®šä¹‰ç®—æ³•æ˜¯ä¸€ç³»åˆ—è§£å†³é—®é¢˜çš„æ¸…æ™°æŒ‡ä»¤ç®—æ³•ä»£è¡¨ç€ç”¨ç³»ç»Ÿçš„æ–¹æ³•æè¿°è§£å†³é—®é¢˜çš„ç­–ç•¥æœºåˆ¶ä¹Ÿå°±æ˜¯è¯´ï¼Œèƒ½å¤Ÿå¯¹ä¸€å®šè§„èŒƒçš„è¾“å…¥ï¼Œåœ¨æœ‰é™æ—¶é—´å†…è·å¾—æ‰€è¦æ±‚çš„è¾“å‡ºå¦‚æœä¸€ä¸ªç®—æ³•æœ‰ç¼ºé™·ï¼Œæˆ–ä¸é€‚åˆäºæŸä¸ªé—®é¢˜ï¼Œæ‰§è¡Œè¿™ä¸ªç®—æ³•å°†ä¸ä¼šè§£å†³è¿™ä¸ªé—®é¢˜ä¸åŒçš„ç®—æ³•å¯èƒ½ç”¨ä¸åŒçš„æ—¶é—´ã€ç©ºé—´æˆ–æ•ˆç‡æ¥å®ŒæˆåŒæ ·çš„ä»»åŠ¡ç®—æ³•çš„ä¼˜åŠ£å¯ä»¥ç”¨ç©ºé—´å¤æ‚åº¦ä¸æ—¶é—´å¤æ‚åº¦æ¥è¡¡é‡åˆ†ç±»æœ‰é™çš„ï¼Œç¡®å®šæ€§ç®—æ³•: è¿™ç±»ç®—æ³•åœ¨æœ‰é™çš„ä¸€æ®µæ—¶é—´å†…ç»ˆæ­¢ã€‚ä»–ä»¬å¯èƒ½è¦èŠ±å¾ˆé•¿æ—¶é—´æ¥æ‰§è¡ŒæŒ‡å®šçš„ä»»åŠ¡ï¼Œä½†ä»å°†åœ¨ä¸€å®šçš„æ—¶é—´å†…ç»ˆæ­¢ï¼Œè¿™ç±»ç®—æ³•å¾—å‡ºçš„ç»“æœå¸¸å–å†³äºè¾“å…¥å€¼æœ‰é™çš„ï¼Œéç¡®å®šç®—æ³•: è¿™ç±»ç®—æ³•åœ¨æœ‰é™çš„æ—¶é—´å†…ç»ˆæ­¢ã€‚ç„¶è€Œï¼Œå¯¹äºä¸€ä¸ª(æˆ–ä¸€äº›)ç»™å®šçš„æ•°å€¼ï¼Œç®—æ³•çš„ç»“æœå¹¶ä¸æ˜¯å”¯ä¸€çš„æˆ–ç¡®å®šçš„æ— é™çš„ç®—æ³•: æ˜¯é‚£äº›ç”±äºæ²¡æœ‰å®šä¹‰ç»ˆæ­¢å®šä¹‰æ¡ä»¶ï¼Œæˆ–å®šä¹‰çš„æ¡ä»¶æ— æ³•ç”±è¾“å…¥çš„æ•°æ®æ»¡è¶³è€Œä¸ç»ˆæ­¢è¿è¡Œçš„ç®—æ³•é€šå¸¸ï¼Œæ— é™ç®—æ³•çš„äº§ç”Ÿæ˜¯ç”±äºæœªèƒ½ç¡®å®šçš„å®šä¹‰ç»ˆæ­¢æ¡ä»¶ç®—æ³•å¤æ‚åº¦å®šä¹‰ç®—æ³•å¤æ‚åº¦ï¼Œå³ç®—æ³•åœ¨ç¼–å†™å†™æˆå¯æ‰§è¡Œç¨‹åºåï¼Œè¿è¡Œæ—¶æ‰€éœ€è¦çš„èµ„æºï¼Œèµ„æºåŒ…æ‹¬æ—¶é—´èµ„æºå’Œå†…å­˜èµ„æºå¤æ‚åº¦è¡¨ç¤ºæˆ‘ä»¬è®°ä¸€ä¸ªç®—æ³•çš„å¤æ‚åº¦ä¸ºO(n)ï¼Œè¡¨ç¤ºæ•°æ®è§„æ¨¡ä¸ºnçš„æƒ…å†µä¸‹ï¼Œç®—æ³•ä½¿ç”¨çš„æ—¶é—´å’Œç©ºé—´èµ„æºä¹Ÿå¯ä»¥ç”¨O(n)æè¿°ï¼Œä»£ç æ‰§è¡ŒèŠ±è´¹çš„æ—¶é—´å’Œç©ºé—´éšç€nå¢å¤§å˜åŒ–çš„è¶‹åŠ¿ç®—æ³•å¤æ‚åº¦ä»æ—¶é—´ä¸Šè€ƒè™‘æ˜¯æ—¶é—´å¤æ‚åº¦(å¿«ä¸å¿«)ï¼Œä»ç©ºé—´ä¸Šè€ƒè™‘æ˜¯ç©ºé—´å¤æ‚åº¦(å çš„å†…å­˜å¤šä¸å¤š)æ—¶é—´å¤æ‚åº¦æ—¶é—´å¤æ‚åº¦çš„å››ç§ç±»å‹æœ€å¥½æ—¶é—´å¤æ‚åº¦æŒ‡çš„æ˜¯åœ¨ç†æƒ³æƒ…å†µ(æœ€å¥½æƒ…å†µ)ä¸‹ï¼Œæ‰§è¡Œè¿™æ®µä»£ç çš„æ—¶é—´å¤æ‚åº¦æœ€åæ—¶é—´å¤æ‚åº¦æŒ‡çš„æ˜¯åœ¨æœ€åæƒ…å†µä¸‹ï¼Œæ‰§è¡Œè¿™æ®µä»£ç çš„æ—¶é—´å¤æ‚åº¦å¹³å‡æ—¶é—´å¤æ‚åº¦æŒ‡çš„æ˜¯æ¦‚ç‡è®ºä¸­çš„åŠ æƒå¹³å‡å€¼ï¼Œä¹Ÿå«ä½œæœŸæœ›å€¼ï¼Œæ‰€ä»¥å¹³å‡æ—¶é—´å¤æ‚åº¦çš„å…¨ç§°åº”è¯¥å«åŠ æƒå¹³å‡æ—¶é—´å¤æ‚åº¦æˆ–è€…æœŸæœ›æ—¶é—´å¤æ‚åº¦å…¶ä¸­$A(n)$è¡¨ç¤ºå¹³å‡æ—¶é—´å¤æ‚åº¦ï¼Œ$S$æ˜¯è§„æ¨¡ä¸º$n$çš„å®ä¾‹é›†ï¼Œå®ä¾‹$ I \in S$çš„æ¦‚ç‡ä¸º$P_I$ï¼Œç®—æ³•å¯¹å®ä¾‹$I$æ‰§è¡Œçš„åŸºæœ¬è¿ç®—æ¬¡æ•°æ˜¯$t_I$å‡æ‘Šæ—¶é—´å¤æ‚åº¦å‡æ‘Šæ—¶é—´å¤æ‚åº¦(amortized time complexity)ï¼Œå®ƒå¯¹åº”çš„åˆ†ææ–¹æ³•ä¸ºæ‘Šè¿˜åˆ†ææˆ–è€…å¹³æ‘Šåˆ†æå¬èµ·æ¥ä¸å¹³å‡æ—¶é—´å¤æ‚åº¦æœ‰ç‚¹ç±»ä¼¼ï¼Œæ¯”è¾ƒå®¹æ˜“å¼„æ··ï¼Œå¹³å‡å¤æ‚åº¦åªåœ¨æŸäº›ç‰¹æ®Šæƒ…å†µä¸‹æ‰ä¼šç”¨åˆ°è€Œå‡æ‘Šæ—¶é—´å¤æ‚åº¦åº”ç”¨çš„åœºæ™¯æ¯”å®ƒæ›´åŠ ç‰¹æ®Šã€æ›´åŠ æœ‰é™å¯¹ä¸€ä¸ªæ•°æ®ç»“æ„è¿›è¡Œä¸€ç»„è¿ç»­æ“ä½œä¸­ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹æ—¶é—´å¤æ‚åº¦éƒ½å¾ˆä½ï¼Œåªæœ‰ä¸ªåˆ«æƒ…å†µä¸‹æ—¶é—´å¤æ‚åº¦æ¯”è¾ƒé«˜ï¼Œè€Œä¸”è¿™äº›æ“ä½œä¹‹é—´å­˜åœ¨å‰åè¿è´¯çš„æ—¶åºå…³ç³»ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†è¿™ä¸€ç»„æ“ä½œæ”¾åœ¨ä¸€å—å„¿åˆ†æï¼Œçœ‹æ˜¯å¦èƒ½å°†è¾ƒé«˜æ—¶é—´å¤æ‚åº¦é‚£æ¬¡æ“ä½œçš„è€—æ—¶ï¼Œå¹³æ‘Šåˆ°å…¶ä»–é‚£äº›æ—¶é—´å¤æ‚åº¦æ¯”è¾ƒä½çš„æ“ä½œä¸Šåœ¨èƒ½å¤Ÿåº”ç”¨å‡æ‘Šæ—¶é—´å¤æ‚åº¦åˆ†æçš„åœºåˆï¼Œä¸€èˆ¬å‡æ‘Šæ—¶é—´å¤æ‚åº¦å°±ç­‰äºæœ€å¥½æƒ…å†µæ—¶é—´å¤æ‚åº¦ç©ºé—´å¤æ‚åº¦æ—¶é—´å¤æ‚åº¦çš„å…¨ç§°æ˜¯æ¸è¿›æ—¶é—´å¤æ‚åº¦ï¼Œè¡¨ç¤ºç®—æ³•çš„æ‰§è¡Œæ—¶é—´ä¸æ•°æ®è§„æ¨¡ä¹‹é—´çš„å¢é•¿å…³ç³»ç±»æ¯”ä¸€ä¸‹ï¼Œç©ºé—´å¤æ‚åº¦å…¨ç§°å°±æ˜¯æ¸è¿›ç©ºé—´å¤æ‚åº¦ï¼Œè¡¨ç¤ºç®—æ³•çš„å­˜å‚¨ç©ºé—´ä¸æ•°æ®è§„æ¨¡ä¹‹é—´çš„å¢é•¿å…³ç³»å®ƒçš„åˆ†æè§„åˆ™ä¸æ—¶é—´å¤æ‚åº¦ä¸€æ ·ï¼Œä¹Ÿæ˜¯åªè¦é«˜é˜¶é¡¹ï¼Œä¸è¦ä½é˜¶é¡¹ç®—æ³•ç§ç±»ğŸŒ¿æš‚æ—¶ç•™å‘ï¼Œåç»­æ€»ç»“ç®—æ³•æ—¶å†æ…¢æ…¢è¡¥åŸºæœ¬ç®—æ³•æšä¸¾è´ªå¿ƒé€’å½’å’Œåˆ†æ²»é€’æ¨æ’åºç®—æ³•å›¾ç®—æ³•å“ˆå¤«æ›¼ç¼–ç ï¼Œæ ‘çš„éå†ï¼Œæœ€çŸ­è·¯å¾„ç®—æ³•ï¼Œæœ€å°ç”Ÿæˆæ ‘ç®—æ³•æ•°æ®ç»“æ„ä»£æ•°ç®—æ³•</content>
	</entry>
	<entry>
		<title>ä½è¿ç®—</title>
		<url>/article/60366.html</url>
		<content>ä½è¿ç®—åŸºç¡€ä½è¿ç®—åŸºç¡€å¯ä»¥è§pythonåŸºç¡€çŸ¥è¯†è®¡ç®—ä½è¿ç®—è®¡ç®—æ—¶é—´ä¸ºO(1)ç§»ä½è¿ç®—å·¦ç§»:é€»è¾‘å³ç§»: å°±æ˜¯ä¸è€ƒè™‘ç¬¦å·ä½ï¼Œå³ç§»ä¸€ä½ï¼Œå·¦è¾¹è¡¥é›¶å³å¯ç®—æœ¯å³ç§»: è€ƒè™‘ç¬¦å·ä½ï¼Œå³ç§»ä¸€ä½ï¼Œè‹¥ç¬¦å·ä½ä¸º1ï¼Œå°±åœ¨å·¦è¾¹è¡¥1ï¼›å¦åˆ™ï¼Œå°±è¡¥0ç®—æœ¯å³ç§»ä¹Ÿå¯ä»¥è¿›è¡Œæœ‰ç¬¦å·ä½çš„é™¤æ³•ï¼Œå³ç§»nä½å°±ç­‰äºé™¤2çš„næ¬¡æ–¹ğŸ†n&gt;&gt;1æ˜¯å‘ä¸‹å–æ•´ï¼Œn/2æ˜¯æ•´æ•°é™¤æ³•ï¼Œæ˜¯å‘0å–æ•´1234567[(i // 2, i &gt;&gt; 1) for i in range(10)]# è¾“å‡º[(0, 0), (0, 0), (1, 1), (1, 1), (2, 2), (2, 2), (3, 3), (3, 3), (4, 4), (4, 4)]ä½è¿ç®—å°æŠ€å·§ç”¨å¼‚æˆ–å®ç°é…å¶123456789100, 12, 34, 56, 70 ^ 1 = 1, 1 ^ 1 = 02 ^ 1 = 3, 3 ^ 1 = 2...4 ^ 1 = 5, 5 ^ 1 = 4...12345678[i ^ 1 for i in range(10)]Out[3]: [1, 0, 3, 2, 5, 4, 7, 6, 9, 8][i ^ 2 for i in range(10)]Out[4]: [2, 3, 0, 1, 6, 7, 4, 5, 10, 11][i ^ 3 for i in range(10)]Out[5]: [3, 2, 1, 0, 7, 6, 5, 4, 11, 10][i ^ 4 for i in range(10)]Out[6]: [4, 5, 6, 7, 0, 1, 2, 3, 12, 13]lowbitè¿ç®—: æ±‚1æœ€ä½çš„ä½æ•°12345lowbit = lambda n: (-n) &amp; næˆ–lowbit = lambda n: (~n+1 ) &amp; nlowbit(11110010000) = 10000åˆ¤æ–­å¥‡å¶åªè¦æ ¹æ®æœ€æœªä½æ˜¯0è¿˜æ˜¯1æ¥å†³å®šï¼Œä¸º0å°±æ˜¯å¶æ•°ï¼Œä¸º1å°±æ˜¯å¥‡æ•°ã€‚å› æ­¤å¯ä»¥ç”¨if ((a &amp; 1) == 0)ä»£æ›¿if (a % 2 == 0)æ¥åˆ¤æ–­aæ˜¯ä¸æ˜¯å¶æ•°å–ä¸€ä¸ªæ•°ä¸­æŒ‡å®šä½å–Xçš„ä½4ä½ï¼Œç”¨ X &amp; 0000 1111 = 00001110 å³å¯å¾—åˆ°å¯¹ä¸€ä¸ªæ•°çš„æŸäº›ä½ç½®1æ‰¾åˆ°ä¸€ä¸ªæ•°ï¼Œå¯¹åº”Xè¦ç½®1çš„ä½ï¼Œè¯¥æ•°çš„å¯¹åº”ä½ä¸º1ï¼Œå…¶ä½™ä½ä¸ºé›¶ã€‚æ­¤æ•°ä¸Xç›¸æˆ–å¯ä½¿Xä¸­çš„æŸäº›ä½ç½®1ä½¿ç‰¹å®šä½ç¿»è½¬ä½¿ç‰¹å®šä½ç¿»è½¬ï¼Œè¯¥æ•°å¯¹åº”Xè¦ç¿»è½¬çš„å¯¹åº”ä½ä¸º1ï¼Œå…¶ä½™ä½ä¸ºé›¶ï¼Œæ­¤æ•°ä¸Xå¯¹åº”ä½å¼‚æˆ–å³å¯ä¾‹ï¼šX=10101110ï¼Œä½¿Xä½4ä½ç¿»è½¬ï¼Œç”¨X ^0000 1111 = 1010 0001å³å¯å¾—åˆ°å¼‚æˆ–çš„å‡ æ¡æ€§è´¨ï¼šå¼‚æˆ–å…¶å®å°±æ˜¯ä¸è¿›ä½åŠ æ³•1ã€äº¤æ¢å¾‹ a ^ b = c ===&gt; a ^ c = b , b ^ c = a2ã€ç»“åˆå¾‹ å³ (a ^ b) ^ c == a ^ (b ^ c)3ã€å¯¹äºä»»ä½•æ•°xï¼Œéƒ½æœ‰x ^ x = 0ï¼Œx ^ 0 = x4ã€è‡ªåæ€§: a ^ b ^ b = a ^ 0 = a1000æ”¾åœ¨å«æœ‰1001ä¸ªå…ƒç´ çš„æ•°ç»„ä¸­ï¼Œåªæœ‰å”¯ä¸€çš„ä¸€ä¸ªå…ƒç´ å€¼é‡å¤ï¼Œå…¶å®ƒå‡åªå‡ºç°ä¸€æ¬¡ã€‚æ¯ä¸ªæ•°ç»„å…ƒç´ åªèƒ½è®¿é—®ä¸€æ¬¡ï¼Œè®¾è®¡ä¸€ä¸ªç®—æ³•ï¼Œå°†å®ƒæ‰¾å‡ºæ¥ï¼›ä¸ç”¨è¾…åŠ©å­˜å‚¨ç©ºé—´å°†æ‰€æœ‰çš„æ•°å…¨éƒ¨å¼‚æˆ–ï¼Œå¾—åˆ°çš„ç»“æœä¸1 ^ 2 ^ 3 ^ â€¦ ^ 1000çš„ç»“æœè¿›è¡Œå¼‚æˆ–ï¼Œå¾—åˆ°çš„ç»“æœå°±æ˜¯é‡å¤æ•°æšä¸¾ä¸€ä¸ªæ— é‡å¤å­—ç¬¦ä¸²æ‰€æœ‰å­é›†çš„æŠ€å·§ç”¨äºŒè¿›åˆ¶æ•°ç»„è¡¨ç¤ºå•è¯ä¸­é‚£äº›å­—æ¯å‡ºç°ï¼ˆ1è¡¨ç¤ºï¼‰ï¼Œé‚£äº›æ²¡å‡ºç°ï¼ˆ0è¡¨ç¤ºï¼‰ï¼Œæ‰¾å‡ºè¯¥å•è¯çš„æ‰€æœ‰å­é›†ã€‚ace å¯¹åº”äºŒè¿›åˆ¶ int origin = 21 (äºŒè¿›åˆ¶10101)ï¼ŒåŒ…å«çš„å­é›†(nä»£è¡¨å­é›†,åˆå§‹ n = origin)æœ‰ï¼š123456789ace 10101ce 10100ae 10001ac 00101e 10000c 00100a 00001éå†æ ¸å¿ƒä»£ç ï¼šn = (n - 1) &amp; origin;// n-1 AND puzzleBitï¼Œç”Ÿæˆä¸€ä¸ªpuzzleBitçš„æ–°çš„å­é›†åˆå¯ä»¥è‡ªå·±æ‰‹åŠ¨æ¨ç®—ä¸€ä¸‹ï¼Œæ˜¯å¯¹çš„ï¼Œnåˆšå¥½éå†å®Œæ‰€æœ‰æƒ…å†µæ‰¾mapä¸­ å­˜åœ¨çš„ å­—ç¬¦ä¸²str = aceï¼ˆå¿…å«æœ‰é¦–å­—æ¯aï¼‰å­é›†çš„ä¸ªæ•°12345678910int first = 1 &lt;&lt; (str[0] - 'a');while (n &gt; 0) { // éå†origin çš„æ‰€æœ‰å­—æ¯ç»„åˆï¼Œå½“n=0æ—¶ç»ˆæ­¢éå†           // æŒ‰ä½éƒ½æ˜¯1æ‰ä¸º1ï¼Œå¦åˆ™ä¸º0ï¼Œå³nè¿™ä¸ªç»„åˆåŒ…å«origin çš„é¦–å­—æ¯           // è€Œä¸”nè¿™ä¸ªç»„åˆåœ¨mapä¸­æœ‰å€¼ï¼Œå³æœ‰å•è¯é•¿nè¿™æ ·ï¼Œå€¼ç´¯åŠ ç»™res[i]           if ((n &amp; first) != 0 &amp;&amp; map[n] &gt; 0) {               res[i] += map[n];           }           // n-1 AND puzzleBitï¼Œç”Ÿæˆä¸€ä¸ªpuzzleBitçš„æ–°çš„å­é›†åˆ           n = (n - 1) &amp; puzzleBit;       }å¸¸ç”¨ä½è¿ç®—å…¬å¼a &gt;&gt; b &amp; 1 ä»£è¡¨æ£€æŸ¥ a çš„ç¬¬ b ä½æ˜¯å¦ä¸º 1ï¼Œæœ‰ä¸¤ç§å¯èƒ½æ€§ 0 æˆ–è€… 1a += 1 &lt;&lt; b ä»£è¡¨å°† a çš„ç¬¬ b ä½è®¾ç½®ä¸º 1 (å½“ç¬¬ b ä½ä¸º 0 çš„æ—¶å€™é€‚ç”¨)çŠ¶æ€å‹ç¼©å®šä¹‰äºŒè¿›åˆ¶çŠ¶æ€å‹ç¼©ï¼Œæ˜¯æŒ‡å°†ä¸€ä¸ªé•¿åº¦ä¸º$m$çš„boolæ•°ç»„ç”¨ä¸€ä¸ª$m$ä½äºŒè¿›åˆ¶æ•´æ•°è¡¨ç¤ºå¹¶å­˜å‚¨çš„æ–¹æ³•åˆ©ç”¨ä¸‹åˆ—ä½è¿ç®—æ“ä½œå¯ä»¥å®ç°åŸboolæ•°ç»„ä¸­å¯¹åº”ä¸‹æ ‡å…ƒç´ çš„å­˜å–æ“ä½œè¿ç®—å–å‡ºæ•´æ•°$n$åœ¨äºŒè¿›åˆ¶è¡¨ç¤ºä¸‹çš„ç¬¬$k$ä½n &gt;&gt; k &amp; 1å–å‡ºæ•´æ•°$n$åœ¨äºŒè¿›åˆ¶è¡¨ç¤ºä¸‹çš„ç¬¬$0 \sim k-1$ä½(å$k$ä½)n &amp; ((1 &lt;&lt; k) - 1)æŠŠæ•´æ•°$n$åœ¨äºŒè¿›åˆ¶è¡¨ç¤ºä¸‹çš„ç¬¬$k$ä½å–ån ^ (1 &lt;&lt; k)å¯¹æ•´æ•°$n$åœ¨äºŒè¿›åˆ¶è¡¨ç¤ºä¸‹çš„ç¬¬$k$ä½èµ‹å€¼$1$n $\vert$ (1 &lt;&lt; k)å¯¹æ•´æ•°$n$åœ¨äºŒè¿›åˆ¶è¡¨ç¤ºä¸‹çš„ç¬¬$k$ä½èµ‹å€¼$0$n &amp; (~(1 &lt;&lt; k))è¿™ç§æ–¹æ³•è¿ç®—ç®€ä¾¿ï¼Œå¹¶ä¸”èŠ‚çœäº†ç¨‹åºè¿è¡Œçš„æ—¶é—´å’Œç©ºé—´å½“$m$ä¸å¤ªå¤§æ—¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ä¸€ä¸ªæ•´æ•°ç±»å‹å­˜å‚¨å½“$m$è¾ƒå¤§æ—¶ï¼Œå¯ä»¥ä½¿ç”¨è‹¥å¹²ä¸ªæ•´æ•°ç±»å‹(intæ•°ç»„)ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åˆ©ç”¨C++ STLä¸ºæˆ‘ä»¬æä¾›çš„bitsetå®ç°æ¡ˆä¾‹a^bé¢˜ç›®æè¿°æ±‚açš„bæ¬¡æ–¹å¯¹på–æ¨¡çš„å€¼éš¾åº¦ç®€å•è¾“å…¥æ ¼å¼ä¸‰ä¸ªæ•´æ•°a,b,pï¼Œåœ¨åŒä¸€è¡Œç”¨ç©ºæ ¼éš”å¼€è¾“å‡ºæ ¼å¼è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤º$(a^b) \% p$çš„ç»“æœæ•°æ®èŒƒå›´è¾“å…¥æ ·ä¾‹123 2 7123456789 0 1è¾“å‡ºæ ·ä¾‹1220æ€è·¯å¿«é€Ÿå¹‚12345678910113 ^ 10000000# å…ˆè®¡ç®—å‡º3 ^ 1 = 33 ^ 2 = 93 ^ 4 = 813 ^ 8 = 3 ^ 16 = 3 ^ 32 = ...3 ^ (2^19) = xxxğŸ¥•æ ¸å¿ƒ: å†çœ‹ä¸‹10000000çš„äºŒè¿›åˆ¶è¡¨ç¤ºï¼ŒæŠŠå¯¹åº”ä¸º1çš„ä½ä¹˜èµ·æ¥å°±å¯ä»¥10000000çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸º0b100110001001011010000000ï¼Œå› æ­¤åªè¦å¯¹åº”ä½ç½®çš„å€¼ä¹˜èµ·æ¥å°±æ˜¯3 ^ 10000000ğŸ¥•æ ¹æ®æ•°å­¦å¸¸è¯†ï¼Œæ¯ä¸€ä¸ªæ­£æ•´æ•°å¯ä»¥å”¯ä¸€è¡¨ç¤ºä¸ºè‹¥å¹²æŒ‡æ•°ä¸é‡å¤çš„2çš„æ¬¡å¹•çš„å’Œ12345678910111213141516171819def ck_sum_of_power(in_n: int):    &quot;&quot;&quot;    æ£€éªŒæ•´æ•°å¯ä»¥ç”±è‹¥å¹²ä¸ªä¸é‡å¤çš„2çš„æ¬¡å¹‚çš„å’Œ    @param in_n:    @return:    &quot;&quot;&quot;    nb = in_n    res = 0    v = 1    while nb:        if nb &amp; 1:            res += v        v *= 2        nb &gt;&gt;= 1    return resif __name__ == '__main__':    print(all([ck_sum_of_power(in_n=i) == i for i in range(100)]))ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœbåœ¨äºŒè¿›åˆ¶è¡¨ç¤ºä¸‹æœ‰$k$ä½ï¼Œå…¶ä¸­ç¬¬$i(0&lt;i&lt;k)$ä½çš„æ•°å­—æ˜¯$c_i$ï¼Œåˆ™äºæ˜¯å› ä¸º$k= \lceil log2(b+1) \rceil $ï¼Œæ‰€ä»¥ä¸Šå¼ä¹˜ç§¯é¡¹çš„æ•°é‡ä¸å¤šäº$\lceil log2(b+1) \rceil$ä¸ªåˆå› ä¸º$a^{2^i} = {a^{(2^{i-1})}}^2$ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾ˆå®¹æ˜“é€šè¿‡$k$æ¬¡é€’æ¨æ±‚å‡ºæ¯ä¸ªä¹˜ç§¯é¡¹ï¼Œå½“$c_i=1$æ—¶ï¼ŒæŠŠè¯¥ä¹˜ç§¯é¡¹ç´¯ç§¯åˆ°ç­”æ¡ˆä¸­b&amp;1è¿ç®—å¯ä»¥å–å‡ºbåœ¨äºŒè¿›åˆ¶è¡¨ç¤ºä¸‹çš„æœ€ä½ä½ï¼Œè€Œb&gt;&gt;1è¿ç®—å¯ä»¥èˆå»æœ€ä½ä½ï¼Œåœ¨é€’æ¨çš„è¿‡ç¨‹ä¸­å°†äºŒè€…ç»“åˆï¼Œå°±å¯ä»¥éå†båœ¨äºŒè¿›åˆ¶è¡¨ç¤ºä¸‹çš„æ‰€æœ‰æ•°ä½$c_i$ï¼Œæ•´ä¸ªç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸ºO($log2(b)$)æ±‚è§£123456789101112def solution(a: int, b: int, p: int) -&gt; int:    res = 1 % p    while b:        # å¦‚æœbçš„ä¸ªä½æ˜¯1        if b &amp; 1:            res = res *  a % p        # å‡†å¤‡åä½        a = a * a % p        # å»æ‰å„ä½        b &gt;&gt;= 1    return resa*b%pé¢˜ç›®æè¿°æ±‚aä¹˜bæ¬¡æ–¹å¯¹på–æ¨¡çš„å€¼éš¾åº¦ç®€å•è¾“å…¥æ ¼å¼ä¸‰ä¸ªæ•´æ•°a,b,pï¼Œåœ¨åŒä¸€è¡Œç”¨ç©ºæ ¼éš”å¼€è¾“å‡ºæ ¼å¼è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤º$(a*b) \% p$çš„ç»“æœæ•°æ®èŒƒå›´è¾“å…¥æ ·ä¾‹123 4 5111 999 1000000è¾“å‡ºæ ·ä¾‹122110889æ€è·¯12345678a * ba * 1 = aa * 2 = 2aa * 4 = 4aa * 8 = 8a...a * (2^k) = (2^k) * aæ±‚è§£123456789def solution(a: int, b: int, p: int) -&gt; int:    res = 0    while b:        if b &amp; 1:            res = (res + a) % p        a = a * 2 % p        b &gt;&gt;= 1    return resæœ€çŸ­Hamiltonè·¯å¾„å“ˆå¯†é¡¿è·¯å¾„å“ˆå¯†é¡¿è·¯å¾„ä¹Ÿç§°ä½œå“ˆå¯†é¡¿é“¾ï¼ŒæŒ‡åœ¨ä¸€ä¸ªå›¾ä¸­æ²¿è¾¹è®¿é—®æ¯ä¸ªé¡¶ç‚¹æ°å¥½ä¸€æ¬¡çš„è·¯å¾„ã€‚å¯»æ‰¾è¿™æ ·çš„ä¸€ä¸ªè·¯å¾„æ˜¯ä¸€ä¸ªå…¸å‹çš„NP-å®Œå…¨(NP-completeï¼‰é—®é¢˜ã€‚åæ¥äººä»¬ä¹Ÿè¯æ˜äº†ï¼Œæ‰¾ä¸€æ¡å“ˆå¯†é¡¿è·¯çš„è¿‘ä¼¼æ¯”ä¸ºå¸¸æ•°çš„è¿‘ä¼¼ç®—æ³•ä¹Ÿæ˜¯NPå®Œå…¨çš„æ—…è¡Œå•†é—®é¢˜æ—…è¡Œå•†é—®é¢˜ (Traveling Salesman Problemï¼ŒTSP)ï¼Œåˆå«è´§éƒæ‹…é—®é¢˜ï¼Œå®ƒæ˜¯å›¾è®ºä¸­ä¸€ä¸ªç»å…¸çš„ç»„åˆä¼˜åŒ–é—®é¢˜ã€‚ç»å…¸çš„TSPå¯ä»¥æè¿°ä¸ºï¼šä¸€ä¸ªå•†å“æ¨é”€å‘˜è¦å»è‹¥å¹²ä¸ªåŸå¸‚æ¨é”€å•†å“ï¼Œè¯¥æ¨é”€å‘˜ä»ä¸€ä¸ªåŸå¸‚å‡ºå‘ï¼Œéœ€è¦ç»è¿‡æ‰€æœ‰åŸå¸‚ä¸€æ¬¡å¹¶ä¸”ä»…ä¸€æ¬¡ä¹‹ååï¼Œå›åˆ°å‡ºå‘åŸå¸‚ã€‚é—®ä»–åº”å¦‚ä½•é€‰æ‹©åœ¨åŸå¸‚ä¹‹é—´çš„è¡Œç¨‹è·¯çº¿ï¼Œä»¥ä½¿ä»–èµ°è¿‡çš„æ€»è·¯ç¨‹æœ€çŸ­ã€‚ä»å›¾è®ºçš„è§’åº¦æ¥çœ‹ï¼Œè¯¥é—®é¢˜å…¶å®å°±æ˜¯åœ¨ä¸€ä¸ªèµ‹æƒçš„æ— å‘å›¾ä¸­ï¼Œå»æ‰¾ä¸€ä¸ªå“ˆå¯†å°”é¡¿å›è·¯ï¼Œå¹¶ä¸”ä½¿å¾—è¯¥å›è·¯çš„æ€»æƒå€¼æœ€å°ã€‚å®¹æ˜“çœ‹å‡ºï¼Œæ—…è¡Œå•†é—®é¢˜çš„å¯è¡Œè§£æ˜¯Nä¸ªé¡¶ç‚¹çš„å…¨æ’åˆ—(æŠŠ[1,2,3,4ï¼Œâ€¦,N]æ‰“ä¹±é¡ºåºéšæœºæ’åˆ—)ï¼Œå…¶å¯è¡Œè§£çš„ä¸ªæ•°æœ‰N!ä¸ªï¼Œä¹Ÿå°±æ˜¯è·¯çº¿æœ‰N!ä¸ªã€‚å¦‚æœæŒ‰ç…§ç©·ä¸¾æ³•å°†N!ä¸ªå¯è¡Œè§£ä¸€ä¸€æ‰¾å‡ºæ¥ï¼Œç„¶åä»ä¸­æ‰¾å‡ºè¡Œç¨‹æœ€çŸ­çš„è·¯çº¿ã€‚éšç€é¡¶ç‚¹æ•°Nçš„å¢åŠ ï¼Œä¼šäº§ç”Ÿç»„åˆçˆ†ç‚¸ã€‚ä»è®¡ç®—å¤æ‚æ€§çš„è§’åº¦æ¥çœ‹ï¼Œå®ƒæ˜¯NP-å®Œå…¨é—®é¢˜æ‹“å±•Pé—®é¢˜ï¼ŒNPé—®é¢˜ï¼ŒNPCé—®é¢˜ï¼ŒNP-Hardé—®é¢˜é¢˜ç›®æè¿°ç»™å®šä¸€å¼  $n$ ä¸ªç‚¹çš„å¸¦æƒæ— å‘å›¾ï¼Œç‚¹ä» $0âˆ¼nâˆ’1$ æ ‡å·ï¼Œæ±‚èµ·ç‚¹ $0$ åˆ°ç»ˆç‚¹ $nâˆ’1$ çš„æœ€çŸ­ Hamilton è·¯å¾„ã€‚Hamilton è·¯å¾„çš„å®šä¹‰æ˜¯ä» $0$ åˆ° $nâˆ’1$ ä¸é‡ä¸æ¼åœ°ç»è¿‡æ¯ä¸ªç‚¹æ°å¥½ä¸€æ¬¡ã€‚éš¾åº¦ä¸­ç­‰è¾“å…¥æ ¼å¼ç¬¬ä¸€è¡Œè¾“å…¥æ•´æ•° $n$æ¥ä¸‹æ¥ $n$ è¡Œæ¯è¡Œ $n$ ä¸ªæ•´æ•°ï¼Œå…¶ä¸­ç¬¬ $i$ è¡Œç¬¬ $j$ ä¸ªæ•´æ•°è¡¨ç¤ºç‚¹ $i$ åˆ° $j$ çš„è·ç¦»ï¼ˆè®°ä¸º $a[i,j]$]ï¼‰å¯¹äºä»»æ„çš„ $x,y,z$ï¼Œæ•°æ®ä¿è¯ $a[x,x]=0, a[x,y]=a[y,x]$ å¹¶ä¸” $a[x,y]+a[y,z] \geq a[x,z]$è¾“å‡ºæ ¼å¼è¾“å‡ºä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæœ€çŸ­ Hamilton è·¯å¾„çš„é•¿åº¦æ•°æ®èŒƒå›´è¾“å…¥æ ·ä¾‹12345650 2 4 5 12 0 6 5 34 6 0 8 35 5 8 0 51 3 3 5 0è¾“å‡ºæ ·ä¾‹118æ€è·¯è€ƒè™‘ä¸¤ä¸ªç‚¹å“ªäº›ç‚¹è¢«ç”¨è¿‡ç›®å‰åœåœ¨å“ªä¸ªç‚¹ä¸Šç¬¬ä¸€ç»´æœ‰$n$ä¸ªç‚¹ï¼Œå–å€¼ä¸º0æˆ–1ï¼Œè¡¨ç¤ºç”¨æˆ–ä¸ç”¨ç¬¬äºŒç»´æœ‰$n$ä¸ªç‚¹ï¼Œæ‰€ä»¥çŠ¶æ€çŸ©é˜µå¤§å°ä¸ºä½¿ç”¨æš´åŠ›æ–¹æ³•ï¼ŒçŠ¶æ€æ•°ä¸º$2^{20}$æ¥ä¸‹æ¥è€ƒè™‘æ¯ä¸ªçŠ¶æ€æ˜¯å¦‚ä½•è®¡ç®—çš„$state_k$æ˜¯$state$å»æ‰$j$ä¹‹åçš„é›†åˆï¼Œ$state_k$è¦åŒ…å«$k$å…³é”®ç‚¹è¿™é‡Œå¯ä»¥ç”¨äºŒè¿›åˆ¶çš„æ•´æ•°è¡¨ç¤º$state$æ¯”å¦‚åŒ…å«$0,1,4$ï¼Œåˆ™$state=10011$æ±‚è§£12345678910111213141516171819202122232425262728293031323334353637383940def solution(n, f, weight):    # ä¸€å¼€å§‹åœåœ¨0,0è¢«é€‰ä¸­æ•…çŠ¶æ€ä½ä¸º00..0001, æ­¤æ—¶çš„è·ç¦»ä¸º0    f[1][0] = 0    # æšä¸¾    for i in range(1 &lt;&lt; n):        # æœ€ååœç•™çš„ä½ç½®        for j in range(n):            # içš„äºŒè¿›åˆ¶ä¸‹ç¬¬jä½æ˜¯ä¸æ˜¯1            if i &gt;&gt; j &amp; 1:                for k in range(n):                    # æ­¤æ—¶ i^(1 &lt;&lt; j) == n &amp; (~(1 &lt;&lt; k))è¡¨ç¤ºiçš„ç¬¬jä½å–å                    # å¹¶ä¸”ç¬¬kä½ä¸º1(è¡¨ç¤ºæœ‰è·¯å¾„åˆ°è¾¾j)                    if i ^ (1 &lt;&lt; j) &gt;&gt; k &amp; 1:                        # æ›´æ–°æœ€çŸ­è·¯å¾„                        f[i][j] = min(f[i][j], f[i ^ (1 &lt;&lt; j)][k] + weight[k][j])if __name__ == '__main__':    N, M = 20, 1 &lt;&lt; 20    # f[i][j]è¡¨ç¤ºçŠ¶æ€æ˜¯içš„æƒ…å†µä¸‹ï¼Œåœåœ¨ç‚¹jçš„æœ€å°è·¯å¾„æ˜¯å¤šå°‘    f, weight = [], []    for i in range(M):        f.append([1e10] * N)    for i in range(N):        weight.append([0] * N)    # è¾“å…¥nå’Œæƒé‡    # n: int = int(input())    # weight = input()    n = 5    s = &quot;&quot;&quot;0 2 4 5 1           2 0 6 5 3           4 6 0 8 3           5 5 8 0 5           1 3 3 5 0&quot;&quot;&quot;    weight = [[int(j) for j in i.strip().split(' ')] for i in s.split('\n')]    solution(n=n, f=f, weight=weight)    print(f[(1 &lt;&lt; n) - 1][n - 1])å¼ºè°ƒä¸€ä¸‹(1&lt;&lt;n)-1çš„æ„æ€ï¼š1&lt;&lt;næ˜¯å°†1å·¦ç§»nä½ä¹Ÿå°±æ˜¯10000â€¦(nä¸ª0)ï¼Œå‡å»1ä»¥åå°±ä¼šæ˜¯1111â€¦(nä¸ª1)ï¼Œç†è§£ä¸€ä¸‹ï¼Œå‰ä¸€ä¸ªæ•°æ˜¯n+1ä½ï¼Œåä¸€ä¸ªæ•°æ˜¯nä½ï¼Œæ‰€ä»¥è¯´æ­¤æ—¶(1&lt;&lt;n)-1ä¹Ÿå°±æ˜¯æ‰€æœ‰ä½éƒ½æ˜¯1</content>
	</entry>
	<entry>
		<title>mdæ•°å­¦å…¬å¼å’Œemojiè¡¨æƒ…</title>
		<url>/article/21745.html</url>
		<content>è¡¨æƒ…âš“è¡¨æƒ…ç½‘ç«™â›ªemojiè¡¨æƒ…å®˜ç½‘â›ºtimwhitlockè¡¨æƒ…ğŸŒ´å¸¸ç”¨è¡¨æƒ…ğŸ˜€ ğŸ˜ƒ ğŸ¥° ğŸ˜ ğŸ˜˜â¤ï¸ âœ¨ â­ â—â“ â•â”âœŠ âœŒï¸ âœ‹ âœ‹ â˜ï¸ ğŸ‘ ğŸ¤â˜€ï¸ â˜” â˜ï¸ â„ï¸ â›„ âš¡ â›…â›ª â›º â›² â›µ â›µ âš“ âœˆï¸ â›½ âš ï¸ â™¨ï¸1ï¸âƒ£ 2ï¸âƒ£ 3ï¸âƒ£ 4ï¸âƒ£ 5ï¸âƒ£ 6ï¸âƒ£ 7ï¸âƒ£ 8ï¸âƒ£ 9ï¸âƒ£ 0ï¸âƒ£ï¸âƒ£ â—€ï¸ â¬‡ï¸ â–¶ï¸ â¬…ï¸ â†™ï¸ â†˜ï¸ â¡ï¸ â¬†ï¸ â†–ï¸ â†—ï¸â¬ â« â¤µï¸ â¤´ï¸ â†©ï¸ â†ªï¸ â†”ï¸ â†•ï¸ âª â© â„¹ï¸ ï¸ ï¸ ï¸â™¿ ãŠ™ï¸ ãŠ—ï¸ â“‚ï¸ â›” âœ³ï¸ â‡ï¸ âœ´ï¸â™ˆ â™‰ â™Š â™‹ â™Œ â™ â™ â™ â™ â™‘ â™’ â™“ â›â ï¸ ï¸ ï¸ â™»ï¸ Â©ï¸ Â®ï¸ â„¢ï¸ âŒ â— â€¼ï¸ â‰ï¸ â­• âœ–ï¸ â• â– â— âœ”ï¸â˜‘ï¸ â° ã€°ï¸ ã€½ï¸ â–ªï¸ â–«ï¸ â—¾ â—½ â—¼ï¸ â—»ï¸ â¬› â¬œ âœ… âš« âšªğŸŒ¿ ğŸƒ ğŸŒ¾ ğŸŒ´ ğŸŒ² ğŸ¥ ğŸ¥‘ ğŸ‡ ğŸ’ ğŸ ğŸŒ¼ ğŸ ğŸ¥­ ğŸŒ¸ ğŸ„ğŸ‹ ğŸ¬ ğŸ¶ ğŸ³ ğŸ° ğŸ¦€â˜ï¸ â­ ğŸ‘‰ ğŸ‘€ğŸŒš ğŸŒ ğŸ§¡à¾€à½² ğŸ’›à¾€à½² â¤ï¸à¾€à½²â¤ï¸ ğŸŒˆ ğŸ’¯ ğŸ¾ ğŸ­ ğŸ¥‚ ğŸ¼ ğŸ€ ğŸ‘Latexå…¬å¼Markdown æ•°å­¦å…¬å¼æ€»ç»“ğŸŒˆä»¥ä¸‹éƒ¨åˆ†å…¬å¼ï¼Œhexoæ— æ³•è§£æï¼Œå¯èƒ½éœ€è¦è£…ä»€ä¹ˆæ’ä»¶æ”¯æŒæˆ–è€…æ˜¯ä¿®æ”¹æºç ï¼Œä¸å¤ªæ¸…æ¥šï¼Œæœ‰è°çŸ¥é“çš„å¯ä»¥è¯„è®ºç•™è¨€~é€šç”¨ç¬¦å·ä¸Šä¸‹æ ‡ç®—å¼markdowna0, a{pre}$ a^0, a^{[0]} $a^0, a^{[0]}æ‹¬å·ç®—å¼markdown(, )[, ]\lang, \rang æˆ– \langle, \rangle\lvert, \rvert\lVert, \rVert\lbrace, \rbrace æˆ– {, }å¢å¤§æ‹¬å·æ–¹æ³•å¦‚ä¸‹è¡¨ï¼šç®—å¼markdown(x)\big( x \big)\Big( x \Big)\bigg( x \bigg)\Bigg( x \Bigg)å–æ•´ç¬¦å·ç®—å¼markdownç»“æŸ$\lfloor x \rfloor$\lfloor x \rfloorå‘ä¸‹å–æ•´$\lceil x \rceil$\lceil x \rceilå‘ä¸Šå–æ•´åˆ†æ•°ç®—å¼markdown\frac{a}{b}å¼€æ–¹ç®—å¼markdown\sqrt{a + b}\sqrt[n]{a + b}ç´¯åŠ /ç´¯ä¹˜ç®—å¼markdown\sum_{i = 0}^{n}\frac{1}{i^2}\prod_{i = 0}^{n}\frac{1}{x^2}ç¬¦å·å †å ç®—å¼markdownè¯´æ˜\overset {@} {ABC}ä¸Šå †å \underset {@} {ABC}ä¸‹å †å X \overset {a} { \underset{b} { \to } }Yä¸Šä¸‹å †å ä¸‰è§’å‡½æ•°ç®—å¼markdown\sin\cos\tan\cot\sec\csc\bot\angle40^\circå¯¹æ•°å‡½æ•°ç®—å¼markdown\ln{a + b}\log_{a}^{b}\lg{a + b}äºŒå…ƒè¿ç®—ç¬¦ç®—å¼markdownæè¿°\pmæ­£è´Ÿå·\mpè´Ÿæ­£å·\timesä¹˜å·\divé™¤å·\astæ˜Ÿå·\star\midç«–çº¿\nmid\circåœˆ\bullet\cdotç‚¹\wr\diamond\Diamond\triangle\bigtriangleup\bigtriangledown\triangleleft\triangleright\lhd\rhd\unlhd\unrhd\circ\bigcirc\odot\bigodotç‚¹ç§¯\oslash\ominus\otimes\bigotimeså…‹ç½—å†…å…‹ç§¯\oplus\bigopluså¼‚æˆ–\dagger\ddagger\amalgå…³ç³»ç¬¦å·ç®—å¼markdownæè¿°\leqå°äºç­‰äº\geqå¤§äºç­‰äº\equivå…¨ç­‰äº\models\prec\succ\sim\perp\preceq\succeq\simeq\mid\ll\gg\asymp\parallel\approx\cong\neqä¸ç­‰äº\doteq\propto\bowtie\Join\smile\frown\vdash\dashvæé™ç®—å¼markdown\lim\rightarrow\infty\lim_{n\rightarrow+\infty}nå‘é‡ç®—å¼markdown\vec{a}ç®­å¤´ç®—å¼markdown\uparrow\downarrow\updownarrow\Uparrow\Downarrow\Updownarrow\rightarrow\leftarrow\leftrightarrow\Rightarrow\Leftarrow\Leftrightarrow\longrightarrow\longleftarrow\longleftrightarrow\Longrightarrow\Longleftarrow\Longleftrightarrow\mapsto\longmapsto\hookleftarrow\hookrightarrow\rightharpoonup\leftharpoondown\rightleftharpoons\leftharpoonup\rightharpoondown\leadsto\nearrow\searrow\swarrow\nwarrowé›†åˆç®—å¼markdownæè¿° ã€\emptysetæˆ–\varnothingç©ºé›†\inå±äº\ni\notinä¸å±äº\subsetå­é›†\supset\not\subsetéå­é›†\subseteqçœŸå­é›†\supseteq\cupå¹¶é›†\bigcupå¹¶é›†\capäº¤é›†\bigcapäº¤é›†\upluså¤šé‡é›†\bigupluså¤šé‡é›†\sqsubset\sqsupset\sqcap\sqsubseteq\sqsupseteq\vee\wedge\setminusé›†åˆä¸­çš„å‡æ³•å¾®ç§¯åˆ†ç®—å¼markdownæè¿°\prime\intç§¯åˆ†\iintåŒé‡ç§¯åˆ†\iiintä¸‰é‡ç§¯åˆ†\ointæ›²çº¿ç§¯åˆ†\nablaæ¢¯åº¦\int_0^2 x^2 dxå…¶ä»–çš„ç§¯åˆ†ç¬¦å·ç±»ä¼¼é€»è¾‘è¿ç®—ç®—å¼markdownæè¿°\becauseå› ä¸º\thereforeæ‰€ä»¥\forallä»»æ„$ \exist $\existå­˜åœ¨\veeé€»è¾‘ä¸\wedgeé€»è¾‘æˆ–\bigveeé€»è¾‘ä¸\bigwedgeé€»è¾‘æˆ–ä¸Šä¸‹æ ‡ç¬¦å·ç®—å¼markdown\bar{a}\acute{a}\breve{a}\grave{a}\dot{a}\ddot{a}\hat{a}\check{a}\breve{a}\tilde{a}\vec{a}\overline{a + b + c + d}\underline{a + b + c + d}\overbrace{a + b + c + d}\underbrace{a + b + c + d}\overbrace{a + \underbrace{b + c}_{1.0} + d}^{2.0}å¸Œè…Šå­—æ¯å¤§å†™markdownå°å†™markdown\Alpha\alpha\Beta\beta\Gamma\gamma\Delta\delta\Epsilon\epsilon\varepsilon\Zeta\zeta\Eta\eta\Theta\theta\Iota\iota\Kappa\kappa\Lambda\lambda\Mu\mu\Nu\nu\Xi\xi\Omicron\omicron\Pi\pi\Rho\rho\Sigma\sigma\Tau\tau\Upsilon\upsilon\Phi\phi\varphi\Chi\chi\Psi\psi\Omega\omegaçœç•¥å·ç®—å¼markdownæè¿°\dotsä¸€èˆ¬ç”¨äºæœ‰ä¸‹æ ‡çš„åºåˆ—\ldots\cdotsçºµå‘ä½ç½®æ¯”\dotsç¨é«˜\vdotsç«–å‘\ddotsç©ºæ ¼ç®—å¼markdownæè¿°123!123ç©ºæ ¼è·ç¦»ï¼š-3/18 em123,123ç©ºæ ¼è·ç¦»ï¼š3/18 em123:123ç©ºæ ¼è·ç¦»ï¼š4/18 em123;123 or 123 \ 123ç©ºæ ¼è·ç¦»ï¼š5/18 em123 \quad 123ç©ºæ ¼è·ç¦»ï¼š1 em123 \qquad 123ç©ºæ ¼è·ç¦»ï¼š2 emä¸Šè¡¨ä¸­çš„ em æ˜¯æŒ‡å½“å‰æ–‡æœ¬ä¸­æ–‡æœ¬çš„å­—ä½“å°ºå¯¸å…¶ä»–ç¬¦å·ç®—å¼markdown\aleph\hbar\imath\jmath\ell\wp\Re\Im\mho\nabla\surd\top\bot\neg\flat\natural\sharp\backslash\partial\Box\clubsuit\diamondsuit\heartsuit\spadesuitåˆ†æ”¯å…¬å¼12345678$$y=\begin{cases}-x,\quad x\leq 0\\x, \quad x&gt;0\end{cases}\tag{1}$$çŸ©é˜µä¸å¸¦æ‹¬å·12345678$$\begin{matrix}1 &amp; 2 &amp; 3\\4 &amp; 5 &amp; 6 \\7 &amp; 8 &amp; 9\end{matrix}\tag{1}$$æ‹¬å·ï¼Œleftåçš„æ‹¬å· å¯ä»¥æ¢ä¸º[æˆ–{12345678\left(\begin{matrix}1 &amp; 2 &amp; 3\\4 &amp; 5 &amp; 6 \\7 &amp; 8 &amp; 9\end{matrix}\right)\tag{2}åˆ†å—çŸ©é˜µ1234567\left(\begin{array}{c|cc}     1  &amp;  0   &amp; 0 \\     \hline   -5  &amp;  2   &amp; 3\\ \end{array}\right)å­—ä½“ä¸é¢œè‰²è°ƒæ•´å¤§å°è°ƒæ•´å¤§å°æ—¶ï¼Œåªéœ€è¦åœ¨å…¬å¼ä¹‹å‰æ·»åŠ ç›¸åº”çš„æ ‡è¯†ï¼Œå¦‚ \Large1$$ \Large E=mc^2 $$å–å€¼æœ‰Hugeã€hugeã€LARGEã€Largeã€largeã€normalsize(é»˜è®¤)ã€samllã€footnotesizeã€scriptsizeã€tinyç²—ä½“æ–œä½“ç¼–ç å­—ä½“æ•ˆæœ\rmç½—é©¬ä½“\itæ„å¤§åˆ©ä½“(é»˜è®¤)\bfç²—ä½“\boldsymbolé»‘ä½“\Bbbé»‘æ¿ç²—ä½“ä¿®æ”¹é¢œè‰²æ³¨æ„typoraé‡Œæ”¯æŒï¼Œä½†ç¼–è¯‘åˆ°hexoä¼šæœ‰é—®é¢˜123$$P \left ( x_{l} \mid y_{l} \right) = \frac {P(x_l,y_l)} {P(y_l)} = \frac { \textcolor{#FF0000} {P(y_l \mid x_l)} P(x_l) } {P(y_l)}$$å¸¸ç”¨é¢œè‰²ï¼šredï¼šçº¢è‰²greenï¼šç»¿è‰²blueï¼šè“è‰²yellowï¼šé»„è‰²èŠ±ä½“å­—æ¯123456789\mathbb{R}\mathcal{R}\mathscr{R}\mathrm{R}\mathbf{R}\mathit{R}\mathsf{R}\mathtt{R}\mathfrak{R}</content>
	</entry>
	<entry>
		<title>æœºå™¨å­¦ä¹ _çº¿æ€§ä»£æ•°ä¸çŸ©é˜µè®º</title>
		<url>/article/47032.html</url>
		<content>å‘é‡åŠå…¶è¿ç®—åŸºæœ¬æ¦‚å¿µçº¿æ€§ä»£æ•°æ˜¯å¤šå…ƒå‡½æ•°å¾®ç§¯åˆ†çš„åŸºç¡€å®šä¹‰å‘é‡(Vector)æ˜¯å…·æœ‰å¤§å°å’Œæ–¹å‘çš„é‡ï¼Œæ˜¯ç”±å¤šä¸ªæ•°æ„æˆçš„ä¸€ç»´æ•°ç»„ï¼Œæ¯ä¸ªæ•°ç§°ä¸ºå‘é‡çš„åˆ†é‡ï¼Œå‘é‡åˆ†é‡çš„æ•°é‡ç§°ä¸ºå‘é‡çš„ç»´æ•°å‘é‡çš„è¡¨ç¤ºç‰©ç†ä¸­çš„åŠ›ã€é€Ÿåº¦ä»¥åŠåŠ é€Ÿåº¦æ˜¯å…¸å‹çš„å‘é‡ï¼Œ$n$ç»´å‘é‡$x$æœ‰$n$ä¸ªåˆ†é‡ï¼Œå¯ä»¥å†™æˆè¡Œå‘é‡çš„å½¢å¼$(x_1 \cdots x_n)$é€šå¸¸å°†å‘é‡å†™æˆå°å†™é»‘ä½“æ–œä½“å­—ç¬¦ï¼Œå¦‚æœå†™æˆåˆ—çš„å½¢å¼åˆ™ç§°ä¸ºåˆ—å‘é‡ï¼Œè¿™äº›åˆ†é‡åœ¨åˆ—æ–¹å‘æ’åˆ—è¿™äº›å‘é‡çš„åˆ†é‡æ˜¯å®æ•°ï¼Œåˆ™æˆä¸ºå®å‘é‡ï¼Œå¦‚æœæ˜¯å¤æ•°ï¼Œåˆ™æˆä¸ºå¤å‘é‡ï¼Œ$n$ç»´å®å‘é‡çš„é›†åˆè®°ä¸º$\mathbb{R}^n$ä¸å‘é‡ç›¸å¯¹çš„æ˜¯æ ‡é‡(Scalar)ï¼Œæ ‡é‡åªæœ‰å¤§å°è€Œæ— æ–¹å‘ï¼Œç‰©ç†ä¸­çš„æ—¶é—´ã€è´¨é‡ä»¥åŠç”µæµæ˜¯å…¸å‹çš„æ ‡é‡åœ¨æ•°å­¦ä¸­é€šå¸¸æŠŠå‘é‡è¡¨ç¤ºæˆåˆ—å‘é‡ï¼Œè€Œè®¡ç®—æœºä¸­é€šå¸¸æŒ‰è¡Œå­˜å‚¨äºŒç»´å¹³é¢å†…çš„ä¸€ä¸ªå‘é‡ï¼Œå…¶åœ¨$x$è½´æ–¹å‘å’Œ$y$è½´æ–¹å‘çš„åˆ†é‡åˆ†åˆ«ä¸º$3$å’Œ$1$ï¼Œå†™æˆè¡Œå‘é‡å½¢å¼ä¸º$\left[ \begin{matrix} 3 &amp; 1 \end{matrix} \right]$å›¾ä¸­çš„å‘é‡ä»¥è™šçº¿ç®­å¤´è¡¨ç¤ºï¼Œèµ·ç‚¹ä¸ºåŸç‚¹ï¼Œç»ˆç‚¹æ˜¯ä»¥å‘é‡çš„åˆ†é‡ä¸ºåæ ‡çš„ç‚¹ï¼Œä¸‰ç»´ç©ºé—´ä¸­çš„åŠ›æ˜¯ä¸‰ç»´å‘é‡ï¼Œå†™æˆå‘é‡å½¢å¼ä¸ºåŠ›çš„åŠ æ³•éµå®ˆå¹³è¡Œå››è¾¹å½¢æ³•åˆ™é›¶å‘é‡æ‰€æœ‰åˆ†é‡å…¨ä¸º$0$çš„å‘é‡ç§°ä¸ºé›¶å‘é‡ï¼Œå³ä¸º$0$ï¼Œå®ƒçš„æ–¹å‘æ˜¯ä¸ç¡®å®šçš„å‘é‡ä¸ç©ºé—´çš„ç‚¹æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œå‘é‡$x$æ˜¯ä»¥åŸç‚¹ä¸ºèµ·ç‚¹ï¼Œä»¥$x$ç‚¹ä¸ºç»ˆç‚¹åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œæ ·æœ¬æ•°æ®é€šå¸¸ç”¨å‘é‡çš„å½¢å¼è¡¨è¾¾ï¼Œç§°ä¸ºç‰¹å¾å‘é‡(Feature Vectos)ï¼Œç”¨äºæè¿°æ ·æœ¬çš„ç‰¹å¾ä½†æ˜¯è¿™é‡Œçš„ç‰¹å¾å‘é‡å’ŒçŸ©é˜µçš„ç‰¹å¾å‘é‡æ˜¯ä¸åŒçš„æ¦‚å¿µï¼Œä¸è¦æ··æ·†åŸºæœ¬è¿ç®—è½¬ç½®è¿ç®—(Transpose)å°†åˆ—å‘é‡å˜æˆè¡Œå‘é‡ï¼Œå°†åˆ—å‘é‡è½¬è¡Œå‘é‡ï¼Œå‘é‡$x$çš„è½¬ç½®è®°ä¸º$x^T$åŠ æ³•ä¸¤ä¸ªå‘é‡çš„åŠ æ³•å®šä¹‰ä¸ºå¯¹åº”åˆ†é‡ç›¸åŠ ï¼Œè¦æ±‚å‚ä¸è¿ç®—çš„ä¸¤ä¸ªå‘é‡ç»´æ•°ç›¸ç­‰å‘é‡$x$å’Œ$y$ç›¸åŠ è®°ä¸º$x+y$ï¼Œæ¯”å¦‚$\left[ \begin{matrix} 1 &amp; 0 &amp; 0 \end{matrix} \right] + \left[ \begin{matrix} 4 &amp; 0 &amp; 1 \end{matrix} \right] = \left[ \begin{matrix} 5 &amp; 2 &amp; 4 \end{matrix} \right]$è¿™ä¸åŠ›çš„åŠ æ³•çš„å¹³è¡Œå››è¾¹å½¢æ³•åˆ™ä¸€è‡´ï¼Œæ˜¯å…¶åœ¨é«˜ç»´ç©ºé—´çš„æ¨å¹¿å‘é‡æ»¡è¶³äº¤æ¢å¾‹å’Œç»“åˆå¾‹å‡æ³•ä¸¤ä¸ªå‘é‡çš„å‡æ³•ä¸ºå®ƒä»¬å¯¹åº”åˆ†é‡ç›¸å‡ï¼ŒåŒæ ·è¦æ±‚å‚ä¸è¿ç®—çš„ä¸¤ä¸ªå‘é‡ç»´æ•°ç›¸ç­‰ä¸å‘é‡åŠ æ³•çš„å¹³è¡Œå››è¾¹å½¢æ³•åˆ™ç›¸å¯¹åº”ï¼Œå‘é‡å‡æ³•ç¬¦åˆä¸‰è§’å½¢æ³•åˆ™ï¼Œ$x-y$çš„ç»“æœæ˜¯ä»¥$y$ä¸ºèµ·ç‚¹ï¼Œä»¥$x$ä¸ºç»ˆç‚¹çš„å‘é‡ä¹˜ç§¯å‘é‡$x$ä¸æ ‡é‡$k$çš„ä¹˜ç§¯$kx$å®šä¹‰ä¸ºæ ‡é‡ä¸å‘é‡çš„æ¯ä¸ªåˆ†é‡ç›¸ä¹˜ï¼Œæ¯”å¦‚ä¹˜ç§¯è¿ç®—å¯ä»¥æ”¹å˜å‘é‡çš„å¤§å°å’Œæ–¹å‘åŠ æ³•å’Œæ•°ä¹˜æ»¡è¶³åˆ†é…å¾‹å†…ç§¯ä¸¤ä¸ªå‘é‡$x$å’Œ$y$å†…ç§¯(Inner Product)å®šä¹‰ä¸ºå®ƒä»¬å¯¹åº”åˆ†é‡ä¹˜ç§¯ä¹‹å’Œå†…ç§¯å¯ä»¥è®°ä¸º$x \cdot y$ä¸¤ä¸ª$n$ç»´å‘é‡çš„å†…ç§¯è¿ç®—éœ€è¦æ‰§è¡Œ$n$æ¬¡ä¹˜æ³•è¿ç®—å’Œ$n-1$æ¬¡åŠ æ³•è¿ç®—å†…ç§¯è¿ç®—æ»¡è¶³ä¸‹é¢çš„è§„å¾‹åˆ©ç”¨å†…ç§¯å¯ä»¥ç®€åŒ–çº¿æ€§å‡½æ•°(ä¸€æ¬¡å‡½æ•°)çš„è¡¨è¿°å¯¹äºæœºå™¨å­¦ä¹ ä¸­å¹¿æ³›ä½¿ç”¨çš„çº¿æ€§æ¨¡å‹çš„é¢„æµ‹å‡½æ•°$\omega _1x_1 + \cdots \omega _nx_n + b$å®šä¹‰ç³»æ•°(æƒé‡)å‘é‡$\omega = (\omega _1 \cdots \omega _n)^T$ï¼Œè¾“å…¥å‘é‡$x = (x_1 \cdots x_n)^T$ï¼Œ$b$ä¸ºåç½®é¡¹ï¼Œé¢„æµ‹å‡½æ•°å†™æˆå‘é‡å†…ç§¯çš„è¯ä¸ºå‘é‡ä¸è‡ªèº«å†…ç§¯çš„ç»“æœä¸ºå…¶æ‰€æœ‰åˆ†é‡çš„å¹³æ–¹å’Œï¼Œå³$x^Tx=\sum _{i=1}^{n}{x_i^2}$ä¸¤ä¸ªå‘é‡çš„å†…ç§¯ä¸º$0$ï¼Œåˆ™ç§°å®ƒä»¬æ­£äº¤æ­£äº¤æ˜¯å‡ ä½•å‚ç›´è¿™ä¸€æ¦‚å¿µåœ¨é«˜ç»´ç©ºé—´çš„æ¨å¹¿é˜¿è¾¾ç›ç§¯ä¸¤ä¸ªå‘é‡çš„é˜¿è¾¾ç›(Hadamard)ç§¯å®šä¹‰ä¸ºå®ƒä»¬å¯¹åº”åˆ†é‡ç›¸ä¹˜ï¼Œç»“æœä¸ºç›¸åŒç»´æ•°çš„å‘é‡ï¼Œè®°ä¸º$x \odot y$å¯¹äºä¸¤ä¸ªå‘é‡å®ƒä»¬çš„é˜¿è¾¾ç›ç§¯ä¸ºé˜¿è¾¾ç›ç§¯å¯ä»¥ç®€åŒ–é—®é¢˜çš„è¡¨è¿°ï¼Œåœ¨åå‘ä¼ æ’­ç®—æ³•ã€å„ç§æ¢¯åº¦ä¸‹é™æ³•ä¸­è¢«ä½¿ç”¨å‘é‡çš„èŒƒæ•°å®šä¹‰å‘é‡çš„èŒƒæ•°(Norm)æ˜¯å‘é‡çš„æ¨¡(é•¿åº¦)è¿™ä¸€æ¦‚å¿µçš„æ¨å¹¿ï¼Œå‘é‡çš„$L-p$èŒƒæ•°æ˜¯ä¸€ä¸ªæ ‡é‡ï¼Œå®šä¹‰ä¸º$p$ä¸ºæ•´æ•°ï¼Œå¸¸ç”¨çš„æ˜¯$L1$å’Œ$L2$èŒƒæ•°ï¼Œ$p$çš„å–å€¼åˆ†åˆ«ä¸º$1$å’Œ$2$L1èŒƒæ•°L2èŒƒæ•°æ— ç©·èŒƒæ•°$L1$èŒƒæ•°æ˜¯æ‰€æœ‰åˆ†é‡çš„ç»å¯¹å€¼ä¹‹å’Œå¯¹äºå‘é‡$x = \left[ \begin{matrix} 1 &amp; -1 &amp; 2 \end{matrix} \right]$çš„$L1$èŒƒæ•°ä¸º$||x||_1 = |1|+|-1|+|2| = 4$$L2$èŒƒæ•°ä¹Ÿç§°ä¸ºå‘é‡çš„æ¨¡ã€‚å³å‘é‡çš„é•¿åº¦ï¼Œå®šä¹‰ä¸ºé•¿åº¦ä¸º$1$çš„å‘é‡ç§°ä¸ºå•ä½å‘é‡ï¼Œå‘é‡$x = \left[ \begin{matrix} 1 &amp; -1 &amp; 2 \end{matrix} \right]$çš„$L1$èŒƒæ•°ä¸º$||x||_2 = \sqrt {1^2+(-1)^2+2^2} = \sqrt {6}$$L1$èŒƒæ•°å’Œ$L2$èŒƒæ•°è¢«ç”¨äºæ„é€ æœºå™¨å­¦ä¹ çš„æ­£åˆ™åŒ–é¡¹å‘é‡èŒƒæ•°é»˜è®¤æŒ‡$L2$èŒƒæ•°å½“$p=\infty$æ—¶ï¼Œç§°ä¸º$L - \infty$èŒƒæ•°ï¼Œå…¶å®šä¹‰ä¸ºå³å‘é‡åˆ†é‡ç»å¯¹å€¼çš„æœ€å¤§å€¼ï¼Œå‘é‡$x = \left[ \begin{matrix} 1 &amp; -1 &amp; 2 \end{matrix} \right]$çš„$L1$èŒƒæ•°ä¸º$||x||_1 = 2$$L - \infty$èŒƒæ•°æ˜¯$L-p$èŒƒæ•°çš„æé™æ€§è´¨å‘é‡æ•°ä¹˜ä¹‹åçš„èŒƒæ•°ä¸º$||kx|| = |k| \cdot ||x||$ï¼Œæ˜¾ç„¶æœ‰$x^Tx = ||x||_2^2$å¯¹äºé$0$å‘é‡ï¼Œé€šè¿‡æ•°ä¹˜å‘é‡æ¨¡çš„å€’æ•°ï¼Œå¯ä»¥å°†å‘é‡å•ä½åŒ–(æ ‡å‡†åŒ–)ï¼Œä½¿å…¶é•¿åº¦ä¸º$1$å¯¹äºä¸Šé¢çš„$L2$èŒƒæ•°ï¼Œå½’ä¸€åŒ–ä¹‹åä¸º$\left[ \begin{matrix} \frac {1}{\sqrt 6} &amp; \frac {-1}{\sqrt 6} &amp; \frac {2}{\sqrt 6} \end{matrix} \right]$å‘é‡å†…ç§¯å’Œ$L2$èŒƒæ•°æ»¡è¶³è‘—åçš„æŸ¯è¥¿-æ–½ç“¦èŒ¨(Cauchy-Schwarz)ä¸ç­‰å¼å¯ä»¥é€šè¿‡æ„é€ ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹è¯æ˜ç”±äº$(x+ty)^T (x+ty) = y^Tyt^2 + 2x^Tyt + x^Tx \geq 0$å¯¹äº$t$çš„ä¸€å…ƒäºŒæ¬¡æ–¹ç¨‹$y^Tyt^2+2x^Tyt+x^Tx = 0$ï¼Œåªæœ‰$x+ty=0$æ—¶æ‰æœ‰å®æ•°è§£ï¼Œæ ¹æ®äºŒæ¬¡æ–¹ç¨‹çš„åˆ¤åˆ«æ³•åˆ™æœ‰å³$(x^Ty)^2 \leq ||x||^2 ||y||^2$ï¼Œå½“ä¸”ä»…å½“$x+ty=0$å³ä¸¤ä¸ªå‘é‡æˆæ¯”ä¾‹æ—¶ä¸ç­‰å¼å–ç­‰å·å‘é‡å†…ç§¯ã€å‘é‡æ¨¡ä¸å‘é‡å¤¹è§’ä¹‹é—´çš„å…³ç³»å¯ä»¥è¡¨ç¤ºä¸º$x^Ty = ||x|| \cdot ||y|| \cdot cos \theta$å…¶ä¸­$\theta$ä¸ºä¸¤ä¸ªå‘é‡ä¹‹é—´çš„å¤¹è§’ï¼Œå…¶å–å€¼èŒƒå›´ä¸º$[0, \pi]$ï¼Œå˜å½¢åå¾—åˆ°å‘é‡å¤¹è§’è®¡ç®—å…¬å¼å½“å‘é‡ä¹‹é—´çš„å¤¹è§’è¶…è¿‡$\frac {\pi}{2}$æ—¶ï¼Œå®ƒä»¬çš„å†…ç§¯ä¸ºè´Ÿå¯¹äºä¸¤ä¸ªé•¿åº¦ç¡®å®šçš„å‘é‡ï¼Œå½“å¤¹è§’ä¸º$0$æ—¶å®ƒä»¬çš„å†…ç§¯æœ€å¤§ï¼Œæ­¤æ—¶$cos \theta=1$ï¼›å¤¹è§’ä¸º$\pi$æ—¶å®ƒä»¬çš„å†…ç§¯æœ€å°ï¼Œæ­¤æ—¶$cos \theta=-1$è¿™ä¸€ç»“è®ºå¸¸åœ¨æ¢¯åº¦ä¸‹é™æ³•å’Œæœ€é€Ÿä¸‹é™æ³•çš„æ¨å¯¼ä¸­è¢«ä½¿ç”¨å¯¹äºå‘é‡$x = \left[ \begin{matrix} 1 &amp; 1 &amp; 0 \end{matrix} \right]$ã€$y=\left[ \begin{matrix} 0 &amp; 1 &amp; 1 \end{matrix} \right]$ï¼Œå®ƒä»¬å¤¹è§’çš„ä½™å¼¦ä¸ºå› æ­¤å®ƒä»¬çš„å¤¹è§’ä¸º$\frac {\pi}{3}$å¯¹äºå‘é‡$x = \left[ \begin{matrix} 1 &amp; 0 &amp; 0 \end{matrix} \right]$ã€$y=\left[ \begin{matrix} 0 &amp; 1 &amp; 0 \end{matrix} \right]$ï¼Œå®ƒä»¬å¤¹è§’çš„ä½™å¼¦ä¸ºå› æ­¤å®ƒä»¬çš„å¤¹è§’ä¸º$\frac {\pi}{2}$ï¼Œä¸¤ä¸ªå‘é‡æ­£äº¤ï¼Œæ­£å¥½æ˜¯$x$è½´å’Œ$y$è½´èŒƒæ•°æ»¡è¶³ä¸‰è§’ä¸ç­‰å¼ï¼Œæ˜¯å¹³é¢å‡ ä½•ä¸­ä¸‰è§’ä¸ç­‰å¼çš„æŠ½è±¡å°†ä¸‰è§’ä¸ç­‰å¼ä¸¤è¾¹åŒæ—¶å¹³æ–¹ï¼Œæœ‰ä»¥åŠæ¬§æ°è·ç¦»ä¸¤ä¸ªå‘é‡ç›¸å‡ä¹‹åçš„$L2$èŒƒæ•°æ˜¯å®ƒä»¬å¯¹åº”çš„ç‚¹ä¹‹é—´çš„è·ç¦»ï¼Œç§°ä¸ºæ¬§æ°è·ç¦»ï¼Œå³$||x-y||$å¯¹äºä¸‰ç»´ç©ºé—´ä¸­çš„ä¸¤ä¸ªç‚¹$x_1 = \left[ \begin{matrix} 1 &amp; 2 &amp; 1 \end{matrix} \right]$ä¸$x_2 = \left[ \begin{matrix} 1 &amp; 2 &amp; 3 \end{matrix} \right]$ï¼Œå®ƒä»¬ä¹‹é—´çš„è·ç¦»ä¸ºé™¤äº†æ¬§æ°è·ç¦»è¿˜å¯ä»¥å®šä¹‰å…¶ä»–çš„è·ç¦»ä¸€ä¸ªå°†ä¸¤ä¸ªå‘é‡æ˜ å°„ä¸ºå®æ•°çš„å‡½æ•°$d(x_1,x_2)$åªè¦æ»¡è¶³ä¸‹é¢çš„æ€§è´¨ï¼Œå‡å¯ä»¥ä½œä¸ºè·ç¦»å‡½æ•°éè´Ÿæ€§: è·ç¦»å¿…é¡»æ˜¯éè´Ÿçš„ï¼Œå¯¹äº$ \forall x_1,x_2 \in \mathbb {R}^n$ï¼Œå‡æœ‰$d(x_1,x_2) \geq 0$å¯¹ç§°æ€§: è·ç¦»æ˜¯å¯¹ç§°çš„ï¼Œå¯¹äº$ \forall x_1,x_2 \in \mathbb {R}^n$ï¼Œå‡æœ‰$d(x_1,x_2) = d(x_2, x_1)$ä¸‰è§’ä¸ç­‰å¼: å¯¹äº$ \forall x_1,x_2,x_3 \in \mathbb {R}^n$ï¼Œå‡æœ‰$d(x_1,x_2) + d(x_2,x_3) \geq d(x_1, x_2)$è¿™äº›æ€§è´¨æ˜¯æ¬§å¼å‡ ä½•ä¸­è·ç¦»ç‰¹æ€§çš„æŠ½è±¡è§£æå‡ ä½•å®šä¹‰ä»‹ç»ä¸‹çº¿æ€§ä»£æ•°åœ¨è§£æå‡ ä½•ä¸­çš„åº”ç”¨ï¼Œç»“è®ºå¯ä»¥ä»äºŒç»´å¹³é¢å’Œä¸‰ç»´ç©ºé—´å¹³é¢è§£æå‡ ä½•ä¸­ç›´çº¿æ–¹ç¨‹ä¸º$ax+by+x=0$ï¼Œç©ºé—´è§£æå‡ ä½•ä¸­å¹³é¢æ–¹ç¨‹ä¸º$ax+by+cz+d = 0$å°†å…¶æ¨å¹¿åˆ°$n$ç»´ç©ºé—´ï¼Œå¾—åˆ°è¶…å¹³é¢(Hyperplane)æ–¹ç¨‹$\omega ^Tx+b = 0$æ³•å‘é‡è¶…å¹³é¢ä¸­çš„$\omega$ç§°ä¸ºæ³•å‘é‡ï¼Œå®ƒä¸è¶…å¹³é¢å†…ä»»æ„ä¸¤ä¸ªä¸åŒç‚¹ä¹‹é—´è¿æˆçš„ç›´çº¿å‚ç›´å›¾ä¸­é»‘è‰²è™šçº¿ä¸ºå¹³é¢çš„æ³•å‘é‡ï¼Œå®ƒä¸å¹³é¢å‚ç›´ï¼Œå¯¹äºå¹³é¢å†…ä»»æ„ä¸¤ç‚¹$x_1$å’Œ$x_2$ï¼Œå®ƒä»¬çš„è¿çº¿(å¹³é¢ä¸Šè™šçº¿)å‡ä¸æ³•å‘é‡å‚ç›´äº‹å®ä¸Šï¼Œå¦‚æœè¿™ä¸¤ä¸ªç‚¹åœ¨å¹³é¢å†…ï¼Œåˆ™å®ƒä»¬æ»¡è¶³å¹³é¢æ–¹ç¨‹ï¼Œæœ‰$\omega ^Tx_1 + b = 0$å’Œ$\omega ^Tx_2 + b = 0$ä¸¤å¼ç›¸å‡å¯ä»¥å¾—åˆ°$\omega ^T(x_1-x_2) = 0$ï¼Œå› æ­¤æ³•å‘é‡$\omega$ä¸å¹³é¢å†…ä»»æ„ä¸¤ç‚¹ä¹‹é—´çš„è¿çº¿$x_1x_2$æ­£äº¤å°†çº¿æ€§æ–¹ç¨‹å¼çš„ä¸¤ä¾§åŒæ—¶ä¹˜ä»¥ä¸€ä¸ªé$0$çš„ç³»æ•°ï¼Œè¡¨ç¤ºçš„è¿˜æ˜¯åŒä¸€ä¸ªè¶…å¹³é¢ç‚¹åˆ°è¶…å¹³é¢çš„è·ç¦»å¹³é¢è§£æç©ºé—´è§£æè¶…å¹³é¢åœ¨å¹³é¢è§£æå‡ ä½•ä¸­ï¼Œç‚¹$(x,y)$åˆ°ç›´æ¥çš„è·ç¦»ä¸ºåœ¨ç©ºé—´è§£æå‡ ä½•ä¸­ï¼Œç‚¹åˆ°å¹³é¢çš„è·ç¦»ä¸ºå°†å…¶æ¨å¹¿åˆ°$n$ç»´ç©ºé—´ï¼Œæ ¹æ®å‘é‡å†…ç§¯å’ŒèŒƒæ•°å¯ä»¥è®¡ç®—å‡ºç‚¹åˆ°è¶…å¹³é¢çš„è·ç¦»ï¼Œå¯¹äºä¸Šé¢å®šä¹‰çš„è¶…å¹³é¢ï¼Œç‚¹$x$åˆ°å®ƒçš„è·ç¦»ä¸ºè¿™ä¸äºŒç»´å¹³é¢ã€ä¸‰ç»´ç©ºé—´ä¸­ç‚¹åˆ°ç›´çº¿å’Œå¹³é¢çš„è·ç¦»å…¬å¼åœ¨å½¢å¼ä¸Šæ˜¯ç»Ÿä¸€çš„ï¼Œåœ¨æ”¯æŒå‘é‡æœºçš„æ¨å¯¼è¿‡ç¨‹ä¸­ä¼šç”¨åˆ°è®¡ç®—ç‚¹$\left[ \begin{matrix} 1 &amp; 1 &amp; 1 &amp; 1 \end{matrix} \right]$åˆ°è¶…å¹³é¢$x_1-2x_2+x_3-3x_4+1=0$çš„è·ç¦»çº¿æ€§ç›¸å…³æ€§çº¿æ€§ç›¸å…³æ ¹æ®æ•°ä¹˜å’ŒåŠ æ³•è¿ç®—å®šä¹‰çº¿æ€§ç»„åˆçš„æ¦‚å¿µï¼Œæœ‰å‘é‡ç»„$x_1, \cdots ,x_l$ï¼Œå¦‚æœå­˜åœ¨ä¸€ç»„å®æ•°$k_1, \cdots ,k_l$ä½¿å¾—åˆ™ç§°å‘é‡$x$å¯ç”±å‘é‡ç»„$x_1, \cdots ,x_l$çº¿æ€§è¡¨è¾¾å³ä¾§ç§°ä¸ºå‘é‡ç»„$x_1, \cdots ,x_l$çš„çº¿æ€§ç»„åˆï¼Œ$k_1, \cdots ,k_l$ä¸ºç»„åˆç³»æ•°å¯¹äºå‘é‡ç»„$x_1 = \left[ \begin{matrix} 1 &amp; 2 &amp; 3 \end{matrix} \right] \qquad x_2 = \left[ \begin{matrix} 1 &amp; 0 &amp; 2 \end{matrix} \right] \qquad x_3 = \left[ \begin{matrix} 0 &amp; 0 &amp; 1 \end{matrix} \right] $å‘é‡$x= x_1+2_x2+x_3 = \left[ \begin{matrix} 3 &amp; 2 &amp; 8 \end{matrix} \right] $ï¼Œå¯ç”±è¯¥å‘é‡ç»„çº¿æ€§è¡¨è¾¾ï¼Œç»„åˆç³»æ•°ä¸º$\left[ \begin{matrix} 1 &amp; 2 &amp; 1 \end{matrix} \right]$å¯¹äºå‘é‡ç»„$x_1, \cdots ,x_l$ï¼Œå¦‚æœå­˜åœ¨ä¸€ç»„ä¸å…¨ä¸º$0$çš„æ•°$kx_1, \cdots ,k_l$ï¼Œä½¿å¾—åˆ™ç§°è¿™ç»„å‘é‡çº¿æ€§ç›¸å…³ï¼Œå¦‚æœä¸å­˜åœ¨ä¸€ç»„ä¸å…¨ä¸º$0$çš„æ•°ä½¿å¾—ä¸Šå¼æˆç«‹ï¼Œåˆ™ç§°ä¸ºè¿™ç»„å‘é‡çº¿æ€§æ— å…³ï¼Œä¹Ÿç§°ä¸ºçº¿æ€§ç‹¬ç«‹çº¿æ€§æ— å…³çº¿æ€§ç›¸å…³æ„å‘³ç€è¿™ç»„å‘é‡å­˜åœ¨å†—ä½™ï¼Œè‡³å°‘æœ‰ä¸€ä¸ªå‘é‡å¯ä»¥ç”±å…¶ä»–å‘é‡çº¿æ€§è¡¨è¾¾ï¼Œå¦‚æœ$x_1 \neq 0$ï¼Œåˆ™æœ‰æ¯”å¦‚ä¸‹é¢çš„è¡Œå‘é‡çº¿æ€§æ— å…³$x_1 = \left[ \begin{matrix} 1 &amp; 0 &amp; 0 \end{matrix} \right] \qquad x_2 = \left[ \begin{matrix} 0 &amp; 1 &amp; 0 \end{matrix} \right] \qquad x_3 = \left[ \begin{matrix} 0 &amp; 0 &amp; 1 \end{matrix} \right] $ç»™å®šç»„åˆç³»æ•°$k_1$ã€$k_2$ã€$k_3$ï¼Œæœ‰$k_1 \left[ \begin{matrix} 1 &amp; 0 &amp; 0 \end{matrix} \right] + k_2 \left[ \begin{matrix} 0 &amp; 1 &amp; 0 \end{matrix} \right] + k_3 \left[ \begin{matrix} 0 &amp; 0 &amp; 1 \end{matrix} \right] = \left[ \begin{matrix} k_1 &amp; k_2 &amp; k_3 \end{matrix} \right]$æ¬²ä½¿è¯¥å‘é‡ä¸º$0$ï¼Œåˆ™æœ‰$k_1=k_2=k_3=0$ï¼Œå› æ­¤è¿™ç»„å‘é‡çº¿æ€§æ— å…³ä¸‹é¢çš„è¡Œå‘é‡çº¿æ€§ç›¸å…³ï¼Œå› ä¸ºå­˜åœ¨ç³»æ•°$\left[ \begin{matrix} 1 &amp; 1 &amp; -1 \end{matrix} \right]$æ˜¯çš„å‘é‡ä¸º$0$$x_1 = \left[ \begin{matrix} 1 &amp; 1 &amp; 0 \end{matrix} \right] \qquad x_2 = \left[ \begin{matrix} 2 &amp; 2 &amp; 0 \end{matrix} \right] \qquad x_3 = \left[ \begin{matrix} 3 &amp; 3 &amp; 0 \end{matrix} \right] $æå¤§çº¿æ€§æ— å…³ç»„ä¸€ä¸ªå‘é‡ç»„æ•°é‡æœ€å¤§çš„çº¿æ€§æ— å…³å‘é‡å­é›†ç§°ä¸ºæå¤§çº¿æ€§æ— å…³ç»„ç»™å®šå‘é‡ç»„ï¼Œå¦‚æœçº¿æ€§æ— å…³ï¼Œä½†ä»»æ„åŠ å…¥ä¸€ä¸ªå‘é‡ä¹‹åçº¿æ€§ç›¸å…³åˆ™æ˜¯æå¤§çº¿æ€§æ— å…³ç»„ï¼Œæå¤§çº¿æ€§æ— å…³ç»„ä¸å”¯ä¸€$n$ç»´å‘é‡çš„æå¤§çº¿æ€§æ— å…³ç»„æœ€å¤šæœ‰$n$ä¸ªå‘é‡ï¼Œè¿™æ„å‘³ç€ä»»æ„ä¸€ä¸ªå‘é‡å‡å¯ä»¥ç”±$n$ä¸ªçº¿æ€§æ— å…³çš„$n$ç»´å‘é‡çº¿æ€§è¡¨è¾¾å‘é‡ç©ºé—´å®šä¹‰æœ‰$n$ç»´å‘é‡çš„é›†åˆ$X$ï¼Œå¦‚æœåœ¨å…¶ä¸Šå®šä¹‰äº†åŠ æ³•å’Œæ•°ä¹˜è¿ç®—ï¼Œä¸”å¯¹ä¸¤ç§è®¡ç®—å°é—­ï¼Œå³è¿ç®—ç»“æœä»å±äºæ­¤é›†åˆï¼Œåˆ™ç§°$X$ä¸ºå‘é‡ç©ºé—´(Vector Sapce)ï¼Œä¹Ÿç§°ä¸ºçº¿æ€§ç©ºé—´ï¼Œå¯¹äºä»»æ„çš„å‘é‡$x,y \in X$éƒ½æœ‰$x+y \in X \qquad kx \in X$ï¼Œåˆ™é›†åˆ$X$ä¸ºå‘é‡ç©ºé—´æ ¹æ®çº¿æ€§ç»„åˆçš„å®šä¹‰ï¼Œå‘é‡ç©ºé—´ä¸­ä»»æ„å‘é‡çš„çº¿æ€§ç»„åˆä»å±äºæ­¤ç©ºé—´è®¾$S$æ˜¯å‘é‡ç©ºé—´$X$çš„å­é›†ï¼Œå¦‚æœ$S$å¯¹åŠ æ³•å’Œæ•°ä¹˜è¿ç®—éƒ½å°é—­ï¼Œåˆ™ç§°$S$ä¸º$X$çš„å­ç©ºé—´ä¾‹å¦‚ï¼Œç”±ä¸‰ç»´å®å‘é‡æ„æˆçš„é›†åˆ$\mathbb {R}^3$æ˜¯ä¸€ä¸ªçº¿æ€§ç©ºé—´ï¼Œæ˜¾ç„¶å¯¹äºä»»æ„$x,y \in \mathbb {R}^3$ä»¥åŠ$k \in \mathbb {R}^3$ï¼Œéƒ½æœ‰é›†åˆ$S = { x \in \mathbb {R}^3, x_i &gt; 0 }$ï¼Œå³åˆ†é‡å…¨ä¸ºæ­£çš„ä¸‰ç»´å‘é‡çš„é›†åˆä¸æ˜¯çº¿æ€§ç©ºé—´ï¼Œå› ä¸ºå®ƒå¯¹æ•°ä¹˜ä¸å°é—­$S$ä¸­çš„å‘é‡$x$æ•°ä¹˜ä¸€ä¸ªè´Ÿæ•°ï¼Œç»“æœå‘é‡çš„åˆ†é‡ä¸ºè´Ÿï¼Œä¸å†å±äºè¯¥é›†åˆåŸº(ç»´æ•°)å‘é‡ç©ºé—´çš„æå¤§çº¿æ€§æ— å…³ç»„ç§°ä¸ºç©ºé—´çš„åŸºï¼ŒåŸºæ‰€åŒ…å«çš„å‘é‡æ•°ç§°ä¸ºç©ºé—´çš„ç»´æ•°å¦‚æœ$u_1, \cdots ,u_n$æ˜¯ç©ºé—´çš„ä¸€ç»„åŸºï¼Œç©ºé—´ä¸­çš„ä»»æ„å‘é‡$x$å‡å¯ç”±è¿™ç»„åŸºçº¿æ€§è¡¨è¾¾$x = k_1u_1 + cdots + k_nu_n$åˆ™$k_1, \cdots k_n$ç§°ä¸ºå‘é‡$x$åœ¨è¿™ç»„åŸºä¸‹çš„åæ ‡æ­£äº¤åŸºå¦‚æœåŸºå‘é‡$u_1, \cdots ,u_n$ç›¸äº’æ­£äº¤åˆ™ç§°ä¸ºæ­£äº¤åŸºï¼Œå¦‚æœåŸºå‘é‡ç›¸äº’æ­£äº¤ä¸”é•¿åº¦å‡ä¸º$1$åˆ™ç§°ä¸ºæ ‡å‡†æ­£äº¤åŸºå‘é‡ç»„$\left[ \begin{matrix} 1 &amp; 0 &amp; 0 \end{matrix} \right] \qquad \left[ \begin{matrix} 0 &amp; 1 &amp; 0 \end{matrix} \right] \qquad \left[ \begin{matrix} 0 &amp; 0 &amp; 1 \end{matrix} \right]$ä¸º$\mathbb {R}^3$çš„ä¸€ç»„æ ‡å‡†æ­£äº¤åŸºï¼Œå…¶æ–¹å‘å¯¹åº”ä¸‰ç»´ç©ºé—´çš„$3$ä¸ªåæ ‡è½´æ–¹å‘éœ€è¦å¼ºè°ƒçš„æ˜¯ï¼Œç©ºé—´çš„åŸºå’Œæ ‡å‡†æ­£äº¤åŸºä¸å”¯ä¸€æ ¼æ‹‰å§†-æ–½å¯†ç‰¹(Gram-Schmidt)æ­£äº¤åŒ–ç»™å®šä¸€ç»„çº¿æ€§æ— å…³çš„å‘é‡ï¼Œå¯ä»¥æ ¹æ®å®ƒä»¬æ„é€ å‡ºæ ‡å‡†æ­£äº¤åŸºï¼Œç”¨çš„æ˜¯æ ¼æ‹‰å§†-æ–½å¯†ç‰¹(Gram-Schmidt)æ­£äº¤åŒ–å…·ä½“æ–¹æ³•: ç»™å®šä¸€ç»„é$0$ä¸”çº¿æ€§æ— å…³çš„å‘é‡$x_1, \cdots ,x_l$ï¼Œæ ¼æ‹‰å§†-æ–½å¯†ç‰¹æ­£äº¤åŒ–å…ˆæ„é€ å‡ºä¸€ç»„æ­£äº¤åŸº$u_1, \cdots ,u_l$ç„¶åå°†è¿™ç»„æ­£äº¤åŸºè¿›è¡Œæ ‡å‡†åŒ–å¾—åˆ°æ ‡å‡†æ­£äº¤åŸº$e_1, \cdots ,e_l$é¦–å…ˆé€‰æ‹©å‘é‡$x_1$ä½œä¸ºä¸€ä¸ªæ­£äº¤åŸºæ–¹å‘ï¼Œä»¤$u_1=x_1$ç„¶ååŠ å…¥ï¼Œæ„é€ å’Œçš„çº¿æ€§ç»„åˆï¼Œä½¿å¾—å®ƒä¸æ­£äº¤ï¼Œå³ç”±äºä¸æ­£äº¤ï¼Œå› æ­¤æœ‰è§£å¾—$\alpha _{21} = \frac {x_2^Tu_1}{u_1^Tu_1}$è§£é‡Šä¸‹è¿™ç§åšæ³•çš„å‡ ä½•æ„ä¹‰ï¼Œç”±äº$x_2^Tu_1 = ||x_2||||u_1|| cos \theta$å› æ­¤$\frac {x_2^Tu_1}{||u_1||} = ||x_2|| cos \theta$å°±æ˜¯$x_2$åœ¨$u_1$æ–¹å‘ä¸ŠæŠ•å½±å‘é‡çš„é•¿åº¦ï¼Œæ˜¯å›¾ä¸­ç›´è§’ä¸‰è§’å½¢$ABC$çš„ç›´è§’è¾¹$AB$çš„é•¿åº¦ï¼Œè¿™é‡Œ$x_2$æ˜¯ä¸‰è§’å½¢çš„æ–œè¾¹$AC$ç”±äº$\frac {u_1}{||u_1||}$æ˜¯$u_1$æ–¹å‘çš„å•ä½å‘é‡ï¼Œ$\frac {x_2^Tu_1}{||u_1||} \frac {u_1}{||u_1||} = \frac {x_2^Tu_1}{u_1^Tu_1} u_1$å°±æ˜¯$x_2$åœ¨$u_1$æ–¹å‘ä¸Šçš„æŠ•å½±å‘é‡ï¼Œæ˜¯å›¾ä¸­çš„å‘é‡$AB$æ ¹æ®å‘é‡å‡æ³•çš„ä¸‰è§’å½¢æ³•åˆ™ï¼Œ$x_2- \frac {x_2^Tu_1}{u_1^Tu_1} u_1$å°±æ˜¯å›¾ä¸­çš„å‘é‡$BC$ï¼Œä¸$u_1$å‚ç›´åŠ ä¸‹æ¥åŠ å…¥$x_3$ï¼Œæ„é€ å‡º$u_3$ï¼Œæ˜¯$u_1$ã€$u_2$å’Œ$x_3$çš„çº¿æ€§ç»„åˆï¼Œä½¿å¾—å®ƒä¸$u_1$åŠ$u_2$å‡æ­£äº¤ç”±äº$u_3$ä¸$u_1$æ­£äº¤ï¼Œå› æ­¤æœ‰è€Œä¸æ­£äº¤ï¼Œï¼Œå› æ­¤å¯ä»¥è§£å¾—ç”±äº$u_3$ä¸$u_2$æ­£äº¤ï¼Œå› æ­¤æœ‰è€Œä¸æ­£äº¤ï¼Œï¼Œå› æ­¤å¯ä»¥è§£å¾—ä»¥æ­¤ç±»æ¨ï¼Œåœ¨åŠ å…¥$x_k$æ—¶æ„é€ ä¸‹é¢çš„çº¿æ€§ç»„åˆç”±äºå®ƒä¸å‡æ­£äº¤ï¼Œå› æ­¤è€Œ$u_j$ä¸$u_i,i=1, \cdots, k-1 ,i \neq j$å‡æ­£äº¤ï¼Œä»è€Œè§£å¾—åå¤æ‰§è¡Œä¸Šè¿°æ­¥éª¤ï¼Œå¯ä»¥å¾—åˆ°ä¸€ç»„æ­£äº¤åŸº$u_1, \cdots , u_l$å°†å®ƒä»¬åˆ†åˆ«æ ‡å‡†åŒ–ï¼Œå¾—åˆ°æ ‡å‡†æ­£äº¤åŸº$ \frac {u_1}{||u_1||} , \cdots , \frac {u_l}{||u_l||}$æ ¼æ‹‰å§†-æ–½å¯†ç‰¹æ­£äº¤åŒ–çš„å‡ ä½•æ„ä¹‰é¦–å…ˆè€ƒè™‘äºŒç»´çš„æƒ…å†µå›¾ä¸­å‘é‡$\frac {x_2^Tu_1}{u_1^Tu_1}u_1$ä¸$u_1$åŒå‘ï¼Œæ˜¯å‘é‡$x_2$åœ¨$x_1$æ–¹å‘çš„æŠ•å½±ï¼Œæ˜¾ç„¶$x_2$å‡æ‰è¯¥æŠ•å½±ä¹‹åçš„å‘é‡ï¼Œå³å‘é‡$u_2$ï¼Œä¸$u_1$å‚ç›´ä¸‹é¢è€ƒè™‘ä¸‰ç»´çš„æƒ…å†µé¦–å…ˆæ„é€ å‡º$u_2$ï¼Œä¸äºŒç»´å¹³é¢çš„æ–¹æ³•ç›¸åŒï¼Œä¿è¯$u_2$ä¸$u_1$å‚ç›´ï¼Œç„¶åå¤„ç†$x_3$ï¼Œé¦–å…ˆå‡æ‰å…¶åœ¨$u_1$æ–¹å‘çš„æŠ•å½±ï¼Œä¿è¯ç›¸å‡ä¹‹åä¸$u_1$å‚ç›´ï¼Œç„¶åå‡æ‰åœ¨$u_2$æ–¹å‘çš„æŠ•å½±ï¼Œä¿è¯ä¸$u_2$å‚ç›´ä¸‹é¢ä¸¾ä¾‹è¯´æ˜ï¼Œæœ‰å¦‚ä¸‹çš„å‘é‡ç»„é¦–å…ˆç”Ÿæˆ$u_1=x_2= \left[ \begin{matrix} 1 \ 0 \ 1 \end{matrix} \right]$ç„¶åç”Ÿæˆ$u_2$ï¼Œç»„åˆç³»æ•°ä¸ºå› æ­¤æœ€åç”Ÿæˆ$u_3$ï¼Œç»„åˆç³»æ•°ä¸ºä»¥åŠå› æ­¤æœ€åå¯¹$u_1$ã€$u_2$å’Œ$u_3$è¿›è¡Œå•ä½åŒ–å³ä¸ºä¸€ç»„æ ‡å‡†æ­£äº¤åŸºåº”ç”¨ä¹‹çº¿æ€§å›å½’åº”ç”¨ä¹‹çº¿æ€§åˆ†ç±»å™¨ä¸æ”¯æŒå‘é‡æœºçŸ©é˜µåŠå…¶è¿ç®—åŸºæœ¬æ¦‚å¿µå®šä¹‰çŸ©é˜µ$A$æ˜¯äºŒç»´æ•°ç»„ï¼Œä¸€ä¸ª$m \times n$çš„çŸ©é˜µæœ‰$m$è¡Œå’Œ$n$åˆ—ï¼Œæ¯ä¸ªä½ç½®$(i,j)$å¤„çš„å…ƒç´ $a_{i,j}$æ˜¯ä¸€ä¸ªæ•°ï¼Œè®°ä¸ºçŸ©é˜µé€šå¸¸ç”¨å¤§å†™çš„é»‘ä½“ã€æ–œä½“å­—æ¯è¡¨ç¤ºçŸ©é˜µçš„å…ƒç´ å¯ä»¥æ˜¯å®æ•°ï¼Œç§°ä¸ºå®çŸ©é˜µï¼Œå…ƒç´ ä¸ºå¤æ•°ï¼Œç§°ä¸ºå¤çŸ©é˜µï¼Œå…¨ä½“$m \times n$å®çŸ©é˜µçš„é›†åˆè®°ä¸º$\mathbb R ^{m \times n}$æ–¹é˜µå¦‚æœçŸ©é˜µè¡Œæ•°å’Œåˆ—æ•°ç›¸ç­‰ï¼Œåˆ™ç§°ä¸ºæ–¹é˜µï¼Œ$n \times n$çš„æ–¹é˜µç§°ä¸º$n$é˜¶æ–¹é˜µå¯¹ç§°çŸ©é˜µå¦‚æœä¸€ä¸ªæ–¹é˜µçš„å…ƒç´ æ»¡è¶³ï¼Œåˆ™ç§°ä¸ºå¯¹ç§°çŸ©é˜µï¼Œæ¯”å¦‚å¯¹è§’çŸ©é˜µçŸ©é˜µæ‰€æœ‰è¡Œå·å’Œåˆ—å·ç›¸ç­‰çš„å…ƒç´ $a_{ii}$çš„å…¨ä½“ç§°ä¸ºä¸»å¯¹è§’çº¿ï¼Œå¦‚æœä¸€ä¸ªçŸ©é˜µå‡ºä¸»å¯¹è§’çº¿ä¹‹å¤–æ‰€æœ‰çš„å…ƒç´ å‡ä¸º$0$ï¼Œåˆ™ç§°ä¸ºå¯¹è§’çŸ©é˜µè¯¥å¯¹è§’çŸ©é˜µå¯ä»¥ç®€è®°ä¸º$diag(1,2,3)$ï¼Œé€šå¸¸å°†å¯¹è§’çŸ©é˜µè®°ä¸º$A$å•ä½çŸ©é˜µå¦‚æœçŸ©é˜µçš„ä¸»å¯¹è§’çº¿çš„å…ƒç´ ä¸º$1$ï¼Œå…¶ä»–å…ƒç´ ä¸º$0$ï¼Œåˆ™ç§°ä¸ºå•ä½çŸ©é˜µï¼Œè®°ä¸º$I$å•ä½çŸ©é˜µçš„ä½œç”¨ç±»ä¼¼äºå®æ•°ä¸­çš„$1$ï¼Œåœ¨çŸ©é˜µä¹˜æ³•ä¸­ä¼šè¯´æ˜ï¼Œ$n$é˜¶å•ä½çŸ©é˜µè®°ä¸º$I_n$é›¶çŸ©é˜µå¦‚æœçŸ©é˜µçš„æ‰€æœ‰å…ƒç´ éƒ½ä¸º$0$ï¼Œåˆ™ç§°ä¸ºé›¶çŸ©é˜µï¼Œè®°ä¸º$0$ï¼Œå…¶ä½œç”¨ç±»ä¼¼äºå®æ•°ä¸­çš„$0$ä¸Šä¸‰è§’çŸ©é˜µå¦‚æœçŸ©é˜µçš„ä¸»å¯¹è§’çº¿ä¸‹æ–¹çš„å…ƒç´ å…¨ä¸º$0$ï¼Œåˆ™ç§°ä¸ºä¸Šä¸‰è§’çŸ©é˜µä¸‹ä¸‰è§’çŸ©é˜µå¦‚æœçŸ©é˜µçš„ä¸»å¯¹è§’çº¿ä¸Šæ–¹çš„å…ƒç´ å…¨ä¸º$0$ï¼Œåˆ™ç§°ä¸ºä¸‹ä¸‰è§’çŸ©é˜µæ ¼æ‹‰å§†(Gram)çŸ©é˜µä¸€ä¸ªå‘é‡ç»„çš„æ ¼æ‹‰å§†(Gram)çŸ©é˜µæ˜¯ä¸€ä¸ª$n \times  n$çš„çŸ©é˜µï¼Œå…¶æ¯ä¸€ä¸ªçŸ©é˜µå…ƒç´ ä¸ºå‘é‡ä¸çš„å†…ç§¯ï¼Œå³ç”±äº$x_i^Tx_j = x_j^Tx_i$ï¼Œå› æ­¤æ ¼æ‹‰å§†çŸ©é˜µæ˜¯ä¸€ä¸ªå¯¹ç§°çŸ©é˜µå¯¹äºå‘é‡ï¼Œå…¶æ ¼æ‹‰å§†çŸ©é˜µä¸ºåœ¨æœºå™¨å­¦ä¹ ä¸­è¯¥çŸ©é˜µå¸¸è¢«ä½¿ç”¨ï¼Œæ¯”å¦‚ä¸»æˆåˆ†åˆ†æã€æ ¸ä¸»æˆåˆ†åˆ†æã€çº¿æ€§åˆ¤åˆ«åˆ†æã€çº¿æ€§å›å½’ã€logisiticå›å½’ä»¥åŠæ”¯æŒå‘é‡æœºçš„æ¨å¯¼å’Œè¯æ˜åŸºæœ¬è¿ç®—è½¬ç½®çŸ©é˜µçš„è½¬ç½®(Transpose)å®šä¹‰ä¸ºè¡Œå’Œåˆ—ä¸‹æ ‡ç›¸äº’äº¤æ¢ï¼Œä¸€ä¸ª$m \times n$çš„çŸ©é˜µè½¬ç½®ä¹‹åä¸º$n \times m$çš„çŸ©é˜µï¼ŒçŸ©é˜µ$A$çš„è½¬ç½®è®°ä¸º$A^T$åŠ æ³•çŸ©é˜µçš„åŠ æ³•ä¸ºå¯¹åº”ä½ç½®çš„å…ƒç´ ç›¸åŠ ï¼Œéœ€è¦ä¿è¯ä¸¤ä¸ªçŸ©é˜µæœ‰ç›¸åŒçš„å°ºå¯¸ï¼ŒçŸ©é˜µ$A$å’Œ$B$ç›¸åŠ è®°ä¸º$A+B$åŠ æ³•å’Œè½¬ç½®æ»¡è¶³$(A+B)^T = A^T+B^T$åŠ æ³•æ»¡è¶³äº¤æ¢å¾‹å’Œç»“åˆå¾‹$A+B=B+A \qquad A+B+C = A+(B+C)$æ•°ä¹˜çŸ©é˜µå’Œæ ‡é‡çš„ä¹˜æ³•å³æ•°ä¹˜ï¼Œå®šä¹‰ä¸ºæ ‡é‡å’ŒçŸ©é˜µæ¯ä¸ªå…ƒç´ ç›¸ä¹˜ï¼ŒçŸ©é˜µ$A$å’Œ$k$æ•°ä¹˜è®°ä¸º$kA$æ•°ä¹˜å’ŒåŠ æ³•æ»¡è¶³åˆ†é…å¾‹$k(A+B) = kA + kB$ä¹˜æ³•çŸ©é˜µä¹˜æ³•å®šä¹‰ä¸ºç¬¬ä¸€ä¸ªçŸ©é˜µçš„æ¯ä¸ªè¡Œå‘é‡å’Œç¬¬äºŒä¸ªçŸ©é˜µçš„æ¯ä¸ªåˆ—å‘é‡åšå†…ç§¯ï¼Œå½¢æˆç»“æœçŸ©é˜µçš„æ¯ä¸ªå…ƒç´ ï¼ŒçŸ©é˜µç›¸ä¹˜è®°ä¸º$AB$è¦æ±‚ç¬¬ä¸€ä¸ªçŸ©é˜µçš„åˆ—æ•°è¦ç­‰äºç¬¬äºŒä¸ªçŸ©é˜µçš„è¡Œæ•°ç»“æœçŸ©é˜µç¬¬$i$è¡Œç¬¬$j$åˆ—ä½ç½®å¤„çš„å…ƒç´ ä¸º$A$çš„ç¬¬$i$è¡Œä¸$B$çš„ç¬¬$j$åˆ—çš„å†…ç§¯ç»“æœçŸ©é˜µçš„æ¯ä¸ªå…ƒç´ éœ€è¦$p$æ¬¡ä¹˜æ³•è¿ç®—ã€$p-1$æ¬¡åŠ æ³•è¿ç®—å¾—åˆ°ï¼Œç»“æœçŸ©é˜µæœ‰$m \times n$ä¸ªå…ƒç´ å› æ­¤ï¼ŒçŸ©é˜µä¹˜æ³•éœ€è¦$m \times n \times p$æ¬¡ä¹˜æ³•å’Œ$m \times n \times (p-1)$æ¬¡åŠ æ³•ä½¿ç”¨çŸ©é˜µä¹˜æ³•å¯ä»¥ç®€åŒ–çº¿æ€§æ–¹ç¨‹ç»„çš„è¡¨è¿°ï¼Œå¯¹äºå¦‚ä¸‹çš„çº¿æ€§æ–¹ç¨‹ç»„å®šä¹‰ç³»æ•°çŸ©é˜µä¸ºå®šä¹‰è§£å‘é‡å’Œå¸¸æ•°å‘é‡ä¸ºæ—¢å¯ä»¥å°†æ–¹ç¨‹ç»„å†™æˆçŸ©é˜µçš„å½¢å¼$Ax=b$è¿™ç§è¡¨ç¤ºå¯ä»¥ä¸ä¸€å…ƒä¸€æ¬¡æ–¹ç¨‹$ax=b$è¾¾æˆå½¢å¼ä¸Šçš„ç»Ÿä¸€ï¼Œç³»æ•°çŸ©é˜µå’Œå¸¸æ•°å‘é‡åˆå¹¶ä¹‹åç§°ä¸ºå¢å¹¿çŸ©é˜µï¼Œæ¯”å¦‚ä»¥ä¸Šçš„å¢å¹¿çŸ©é˜µä¸ºé˜¿è¾¾ç›ç§¯çŸ©é˜µçš„é˜¿è¾¾ç›ç§¯å®šä¹‰ä¸ºå¯¹åº”ä½ç½®å…ƒç´ ä¹˜ç§¯å½¢æˆçš„çŸ©é˜µï¼Œè®°ä¸º$A \odot B$çŸ©é˜µåˆ†å—è¡¨ç¤ºå¯¹äºä¸‹é¢çš„çŸ©é˜µå¯ä»¥å°†å…¶åˆ†å—ä¸ºå…¶ä¸­å¦‚æœçŸ©é˜µçš„å­çŸ©é˜µä¸º$0$çŸ©é˜µï¼Œæˆ–è€…å•ä½çŸ©é˜µç­‰ç‰¹æ®Šç±»å‹çš„çŸ©é˜µï¼Œè¿™è¾¹è¡¨ç¤ºä¼šéå¸¸æœ‰æ•ˆå¦‚æœçŸ©é˜µ$A,B$åˆ†å—åå„å—çš„å°ºå¯¸ä»¥åŠæ°´å¹³ã€å‚ç›´æ–¹å‘çš„å—æ•°é‡ç›¸å®¹ï¼Œé‚£å¯ä»¥å°†å—å½“åšæ ‡é‡æ¥è®¡ç®—ä¹˜ç§¯$AB$å¦‚æœå„ä¸ªä½ç½®å¤„å¯¹åº”çš„ä¸¤ä¸ªå­—å—å°ºå¯¸ç›¸å®¹ï¼Œé‚£ä¹ˆå¯ä»¥è¿›è¡ŒçŸ©é˜µä¹˜ç§¯è¿ç®—ğŸŒ°ä¸¾ä¸ªåˆ†å—ä¹˜æ³•çš„ä¾‹å­å°†$A$åˆ†ä¸º4å—å°†$B$åˆ†å—ä¸ºå› æ­¤å®ƒä»¬çš„ä¹˜ç§¯ä¸ºå…¶ä¸­å› æ­¤åœ¨å¤šæ€æ­£æ€åˆ†å¸ƒä¸­ï¼Œå°†ä¼šå¯¹åæ–¹å·®çŸ©é˜µè¿›è¡Œåˆ†å—ç‰¹æ€§1ï¸âƒ£å•ä½çŸ©é˜µä¸ä»»æ„çŸ©é˜µçš„å·¦ä¹˜å’Œå³ä¹˜éƒ½ç­‰äºè¯¥çŸ©é˜µæœ¬èº«ï¼Œå³2ï¸âƒ£çŸ©é˜µ$A$å·¦ä¹˜å¯¹è§’çŸ©é˜µ$\Lambda = diag(k_1, \cdots, k_n)$ç›¸å½“äºå°†$A$çš„ç¬¬$i$è¡Œçš„æ‰€æœ‰å…ƒç´ éƒ½ä¹˜ä»¥$k_i$3ï¸âƒ£çŸ©é˜µ$A$å³ä¹˜å¯¹è§’çŸ©é˜µ$\Lambda = diag(k_1, \cdots, k_n)$ç›¸å½“äºå°†$A$çš„ç¬¬$i$åˆ—çš„æ‰€æœ‰å…ƒç´ éƒ½ä¹˜ä»¥$k_i$4ï¸âƒ£å‘é‡ç»„çš„æ ¼æ‹‰å§†çŸ©é˜µå¯ä»¥å†™æˆä¸€ä¸ªçŸ©é˜µä¸å…¶è½¬ç½®çš„ä¹˜ç§¯å…¶ä¸­æ˜¯æ‰€æœ‰å‘é‡æŒ‰åˆ—å½¢æˆçš„çŸ©é˜µ5ï¸âƒ£çŸ©é˜µçš„ä¹˜æ³•æ»¡è¶³ç»“åˆå¾‹è¿™äº›ç”±æ ‡é‡ä¹˜æ³•çš„ç»“åˆå¾‹å¯æ¨å¾—6ï¸âƒ£çŸ©é˜µä¹˜æ³•å’ŒåŠ æ³•æ»¡è¶³å·¦åˆ†é…å¾‹å’Œå³åˆ†é…å¾‹æ³¨æ„çŸ©é˜µçš„ä¹˜æ³•ä¸æ»¡è¶³äº¤æ¢å¾‹ï¼Œå³ä¸€èˆ¬æƒ…å†µä¸‹$AB \neq BA$7ï¸âƒ£çŸ©é˜µä¹˜æ³•å’Œè½¬ç½®æ»¡è¶³ç©¿è„±åŸåˆ™é€†çŸ©é˜µå®šä¹‰é€†çŸ©é˜µå¯¹åº”æ ‡é‡çš„å€’æ•°è¿ç®—ï¼Œå¯¹äº$n$é˜¶çŸ©é˜µ$A$ï¼Œå¦‚æœå­˜åœ¨å¦ä¸€ä¸ª$n$é˜¶çŸ©é˜µ$B$ï¼Œä½¿å¾—å®ƒä»¬çš„ä¹˜ç§¯ä¸ºå•ä½çŸ©é˜µå¯¹äº$AB=I$ï¼Œ$B$ç§°ä¸º$A$çš„å³é€†çŸ©é˜µï¼Œå¯¹äº$BA=I$ï¼Œ$B$ç§°ä¸º$A$çš„å·¦é€†çŸ©é˜µå¦‚æœçŸ©é˜µçš„å·¦é€†çŸ©é˜µå’Œå³é€†çŸ©é˜µå­˜åœ¨ï¼Œåˆ™å®ƒä»¬ç›¸ç­‰ï¼Œç»Ÿç§°ä¸ºçŸ©é˜µçš„é€†ï¼Œè®°ä¸º$A^{-1}$å‡è®¾$B_1$æ˜¯$A$çš„å·¦é€†ï¼Œ$B_2$æ˜¯$A$çš„å³é€†ï¼Œåˆ™æœ‰å› æ­¤$B_1=B_2$éå¥‡å¼‚çŸ©é˜µå’Œå¥‡å¼‚çŸ©é˜µå¦‚æœçŸ©é˜µçš„é€†çŸ©é˜µå­˜åœ¨ï¼Œåˆ™ç§°å…¶å¯é€†(Invertable)ã€‚å¯é€†çŸ©é˜µä¹Ÿç§°ä¸ºéå¥‡å¼‚çŸ©é˜µï¼Œä¸å¯é€†çŸ©é˜µä¹Ÿç§°ä¸ºå¥‡å¼‚çŸ©é˜µå¦‚æœçŸ©é˜µå¯é€†ï¼Œåˆ™å…¶é€†çŸ©é˜µå”¯ä¸€å‡è®¾$B$å’Œ$C$éƒ½æ˜¯$A$çš„é€†çŸ©é˜µï¼Œåˆ™æœ‰$AB=BA=I$å’Œ$AC=CA-I$ä»è€Œæœ‰$CAB=(CA)B=IB=B$å’Œ$CAB=C(AB)=CI=C$ï¼Œå› æ­¤B=Cå¯¹äºçº¿æ€§æ–¹ç¨‹ç»„ï¼Œå¦‚æœèƒ½å¾—åˆ°ç³»æ•°çŸ©é˜µçš„é€†çŸ©é˜µï¼Œæ–¹ç¨‹ä¸¤è¾¹åŒä¹˜ä»¥è¯¥é€†çŸ©é˜µï¼Œå¯ä»¥å¾—åˆ°æ–¹ç¨‹çš„è§£è¿™ä¸ä¸€å…ƒä¸€æ¬¡æ–¹ç¨‹çš„æ±‚è§£å½¢å¼ä¸Šæ˜¯ç»Ÿä¸€çš„$ax=b \Rightarrow x=a^{-1b}$å¦‚æœå¯¹è§’çŸ©é˜µ$A$çš„ä¸»å¯¹è§’çº¿é$0$ï¼Œåˆ™å…¶é€†çŸ©é˜µå­˜åœ¨ï¼Œä¸”é€†çŸ©é˜µä¸ºå¯¹è§’çŸ©é˜µï¼Œä¸»å¯¹è§’çº¿å…ƒç´ ä¸ºçŸ©é˜µ$A$çš„ä¸»å¯¹è§’çº¿å…ƒç´ çš„é€†å¯ä»¥æ¨å‡ºï¼Œä¸Šä¸‰è§’çŸ©é˜µçš„é€†çŸ©é˜µä»ç„¶æ˜¯ä¸Šä¸‰è§’çŸ©é˜µç¬¬1ä¸ªç­‰å¼ä¸çŸ©é˜µä¹˜æ³•çš„è½¬ç½®ç±»ä¼¼å› æ­¤ç¬¬1ä¸ªç­‰å¼æˆç«‹ï¼Œè¿™é‡Œåˆ©ç”¨äº†çŸ©é˜µä¹˜æ³•çš„ç»“åˆå¾‹ç”±äº$AA^{-1}=I$æ ¹æ®é€†çŸ©é˜µçš„å®šä¹‰ï¼Œç¬¬2ä¸ªç­‰å¼æˆç«‹ç”±äº$(A^{-1})^TA^T = (AA^{-1})^T = I^T = I$æ ¹æ®é€†çŸ©é˜µçš„å®šä¹‰ï¼Œç¬¬3ä¸ªç­‰å¼æˆç«‹è¯¥ç­‰å¼å¯ä»¥è¯æ˜å¯¹ç§°çŸ©é˜µçš„é€†çŸ©é˜µä¹Ÿæ˜¯å¯¹ç§°çŸ©é˜µï¼Œç”¨ç±»ä¼¼çš„æ–¹æ³•å¯ä»¥è¯æ˜ç¬¬4ä¸ªç­‰å¼æˆç«‹çŸ©é˜µçš„ç§©çŸ©é˜µçš„ç§©å®šä¹‰ä¸ºçŸ©é˜µçº¿æ€§æ— å…³çš„è¡Œå‘é‡æˆ–åˆ—å‘é‡çš„æœ€å¤§æ•°é‡ï¼Œè®°ä¸º$r(A)$è¯¥çŸ©é˜µç§©ä¸º$2$ï¼Œè¯¥çŸ©é˜µçš„æå¤§çº¿æ€§æ— å…³ç»„ä¸ºçŸ©é˜µçš„å‰ä¸¤ä¸ªè¡Œå‘é‡æˆ–åˆ—å‘é‡å¦‚æœ$n$é˜¶æ–¹é˜µçš„ç§©ä¸º$n$ï¼Œåˆ™ç§°å…¶æ»¡ç§©ï¼ŒçŸ©é˜µå¯é€†çš„å……åˆ†å¿…é›¶æ¡ä»¶æ˜¯æ»¡ç§©å¯¹äº$m \times n$çš„çŸ©é˜µ$A$ï¼Œå…¶ç§©æ»¡è¶³$r(A) \leq min(m,n)$ï¼Œå³çŸ©é˜µçš„ç§©ä¸è¶…è¿‡å…¶è¡Œæ•°å’Œåˆ—æ•°çš„è¾ƒå°å€¼çŸ©é˜µçš„ç§©ç›¸å…³ç»“è®ºåˆç­‰è¡Œå˜æ¢æ‰€è°“çŸ©é˜µçš„åˆç­‰è¡Œå˜æ¢æ˜¯æŒ‡ä»¥ä¸‹3ç§å˜æ¢ç”¨ä¸€ä¸ªéé›¶çš„æ•°$k$ä¹˜çŸ©é˜µçš„æŸä¸€è¡ŒæŠŠçŸ©é˜µçš„æŸä¸€è¡Œçš„$k$å€åŠ åˆ°å¦ä¸€è¡Œï¼Œè¿™é‡Œçš„$k$æ˜¯ä»»æ„å®æ•°äº’æ¢çŸ©é˜µçš„ä¸¤è¡ŒğŸŒ´åˆç­‰å˜æ¢æ˜¯å•ä½çŸ©é˜µ$I$ç»è¿‡ä¸€æ¬¡åˆç­‰å˜æ¢ä¹‹åå¾—åˆ°çš„çŸ©é˜µå¯¹äºç¬¬ä¸€ç§åˆç­‰è¡Œå˜åŒ–ï¼Œå¯¹åº”çš„åˆç­‰çŸ©é˜µå’Œé€†çŸ©é˜µåˆ†åˆ«å¦‚ä¸‹ï¼Œè¿™æ„å‘³ç€å°†å•ä½çŸ©é˜µçš„ç¬¬$i$è¡Œä¹˜ä»¥$k$ï¼Œç„¶åå†ä¹˜ä»¥$\frac{1}{k}$ï¼Œå°†å˜ä¸ºå•ä½çŸ©é˜µå¯¹äºç¬¬äºŒç§åˆç­‰è¡Œå˜åŒ–ï¼Œå¯¹åº”çš„åˆç­‰çŸ©é˜µå’Œé€†çŸ©é˜µåˆ†åˆ«å¦‚ä¸‹ï¼Œæ„å‘³ç€å°†å•ä½çŸ©é˜µçš„ç¬¬$i$è¡Œä¹˜ä»¥$k$ä¹‹ååŠ åˆ°ç¬¬$j$è¡Œï¼Œç„¶åå†å°†ç¬¬$i$è¡Œä¹˜ä»¥$-k$ä¹‹ååŠ åˆ°ç¬¬$j$è¡Œï¼Œå°†å˜ä¸ºå•ä½çŸ©é˜µå¯¹äºç¬¬ä¸‰ç§åˆç­‰è¡Œå˜åŒ–ï¼Œå¯¹åº”çš„åˆç­‰çŸ©é˜µå’Œé€†çŸ©é˜µç›¸ç­‰ï¼Œè¿™æ„å‘³ç€ï¼Œå°†å•ä½çŸ©é˜µçš„ç¬¬$i$è¡Œå’Œ$j$è¡Œäº’æ¢ï¼Œç„¶åå†äº’æ¢ä¸€æ¬¡ï¼Œå°†å˜ä¸ºå•ä½çŸ©é˜µğŸ’å¯¹çŸ©é˜µåšåˆç­‰å˜æ¢ï¼Œç­‰ä»·äºå·¦ä¹˜å¯¹åº”çš„åˆç­‰çŸ©é˜µå¯¹äºç¬¬ä¸€ç§è¡Œå˜æ¢å¯¹äºç¬¬äºŒç§è¡Œå˜æ¢å¯¹äºç¬¬ä¸‰ç§è¡Œå˜æ¢åˆç­‰è¡Œå˜æ¢è®¡ç®—é€†çŸ©é˜µå¦‚æœçŸ©é˜µ$A$å¯é€†ï¼Œåˆ™å¯ä»¥åˆ©ç”¨åˆç­‰è¡Œå˜æ¢å°†å…¶å˜æ¢ä¸ºå•ä½çŸ©é˜µï¼Œå¯¹åº”äºä¸€æ¬¡å·¦ä¹˜åˆç­‰çŸ©é˜µ$P1,P2,\cdots,P_s$ä¸¤ä¾§åŒæ—¶å³ä¹˜$A^{-1}$å¯ä»¥å¾—åˆ°è¿™æ„å‘³ç€åŒæ ·çš„åˆç­‰è¡Œå˜æ¢åºåˆ—ï¼Œåœ¨å°†çŸ©é˜µ$A$åŒ–ä¸ºå•ä½çŸ©é˜µçš„åŒæ—¶ï¼Œå¯å°†çŸ©é˜µ$I$åŒ–ä¸º$A^{-1}$ï¼Œè¿™å°±æ˜¯é€†çŸ©é˜µğŸŒ°ç”¨åˆç­‰è¡Œå˜æ¢æ±‚è§£$A$çš„é€†çŸ©é˜µæ±‚è§£è¿‡ç¨‹å¦‚ä¸‹pythonçš„linalgåº“ä¸­çš„invå‡½æ•°å®ç°äº†é€†çŸ©é˜µçš„è®¡ç®—123import numpy as npA = np.array([[1,0,0], [0,1,0], [0,0,5]])B = np.linalg.inv(A)æ­£äº¤çŸ©é˜µå¦‚æœä¸€ä¸ªæ–¹é˜µæ»¡è¶³åˆ™ç§°ä¸ºæ­£äº¤çŸ©é˜µï¼Œæ­£äº¤çŸ©é˜µçš„è¡Œå‘é‡å‡ä¸ºå•ä½å‘é‡ä¸”ç›¸äº’æ­£äº¤ï¼Œæ„æˆæ ‡å‡†æ­£äº¤åŸºï¼Œå¯¹äºçŸ©é˜µæŒ‰è¡Œåˆ†å—ï¼Œæœ‰å› æ­¤æœ‰å¦‚æœä¸€ä¸ªçŸ©é˜µæ˜¯æ­£äº¤çŸ©é˜µï¼Œæ ¹æ®é€†çŸ©é˜µçš„å®šä¹‰ï¼Œæœ‰ä¸‹é¢æ˜¯ä¸€ä¸ªæ­£äº¤çŸ©é˜µçš„ä¾‹å­å¯ä»¥éªŒè¯å…¶è¡Œå‘é‡å’Œåˆ—å‘é‡å‡ä¸ºå•ä½å‘é‡ï¼Œä¸”ç›¸äº’æ­£äº¤æ­£äº¤çŸ©é˜µçš„ä¹˜ç§¯ä»ç„¶æ˜¯æ­£äº¤çŸ©é˜µï¼Œå¦‚æœåˆ™æ­£äº¤çŸ©é˜µçš„é€†çŸ©é˜µä»ç„¶æ˜¯æ­£äº¤çŸ©é˜µã€‚å¦‚æœæœ‰åˆ™æ­£äº¤çŸ©é˜µçš„è½¬ç½®ä»ç„¶æ˜¯æ­£äº¤çŸ©é˜µï¼Œå› ä¸ºè€Œ$A^{-1}$æ˜¯æ­£äº¤çŸ©é˜µï¼Œå› æ­¤$A^{\mathrm{T}}$ä¹Ÿæ˜¯æ­£äº¤çŸ©é˜µçŸ©é˜µçš„èŒƒæ•°è¯±å¯¼èŒƒæ•°çŸ©é˜µ$\boldsymbol{W}$çš„èŒƒæ•°å®šä¹‰ä¸ºè¯¥èŒƒæ•°é€šè¿‡å‘é‡çš„L-pèŒƒæ•°å®šä¹‰ï¼Œå› æ­¤ä¹Ÿç§°ä¸ºè¯±å¯¼èŒƒæ•°(Induced Norm)å¼ä¸­å³ä¾§åˆ†æ¯ä¸ºå‘é‡$x$çš„L-pèŒƒæ•°ï¼Œåˆ†å­æ˜¯ç»è¿‡çŸ©é˜µå¯¹åº”çš„çº¿æ€§æ˜ å°„ä½œç”¨ä¹‹åçš„å‘é‡çš„L-pèŒƒæ•°å› æ­¤è¯±å¯¼èŒƒæ•°çš„å‡ ä½•æ„ä¹‰æ˜¯çŸ©é˜µæ‰€ä»£è¡¨çš„çº¿æ€§å˜æ¢å¯¹å‘é‡è¿›è¡Œå˜æ¢åï¼Œå‘é‡é•¿åº¦çš„æœ€å¤§æ‹‰ä¼¸å€æ•°è°±èŒƒæ•°å¦‚æœ$p=2$ï¼Œæ­¤æ—¶è¯±å¯¼èŒƒæ•°ä½ ä¸ºè°±èŒƒæ•°(Spectral Norm)FèŒƒæ•°çŸ©é˜µçš„FrobeniusèŒƒæ•°(FèŒƒæ•°)å®šä¹‰ä¸ºè¿™ç­‰ä»·äºå‘é‡çš„L2èŒƒæ•°ï¼Œå°†çŸ©é˜µæŒ‰è¡Œæˆ–åˆ—å±•å¼€ä¹‹åå½¢æˆå‘é‡ï¼Œç„¶åè®¡ç®—L2èŒƒæ•°å¯¹äºä¸‹é¢çš„çŸ©é˜µå…¶$\mathrm{F}$èŒƒæ•°ä¸ºæ ¹æ®æŸ¯è¥¿ä¸ç­‰å¼ï¼Œå¯¹äºä»»æ„çš„$\boldsymbol{x}$ï¼Œä¸‹é¢ä¸ç­‰å¼æˆç«‹å¦‚æœ$x \neq 0$ï¼Œä¸Šå¼ä¸¤è¾¹åŒæ—¶é™¤ä»¥$|x|$å¯ä»¥å¾—åˆ°å› æ­¤$(\mathrm{F}$èŒƒæ•°)æ˜¯è°±èŒƒæ•°çš„ä¸€ä¸ªä¸Šç•ŒçŸ©é˜µçš„èŒƒæ•°å¯¹äºåˆ†æçº¿æ€§æ˜ å°„å‡½æ•°çš„ç‰¹æ€§æœ‰é‡è¦çš„ä½œç”¨ï¼Œå…¸å‹çš„åº”ç”¨æ˜¯æ·±åº¦ç¥ç»ç½‘ç»œç¨³å®šæ€§ä¸æ³›åŒ–æ€§èƒ½çš„åˆ†æçº¿æ€§å˜æ¢å®šä¹‰çŸ©é˜µä¸å‘é‡çš„ä¹˜æ³•å¯ä»¥è§£é‡Šä¸ºçº¿æ€§å˜æ¢(Linear Transformation)ï¼Œå®ƒå°†ä¸€ä¸ªå‘é‡å˜æˆå¦å¤–ä¸€ä¸ªå‘é‡å¯¹äºçº¿æ€§ç©ºé—´$X$ï¼Œå¦‚æœåœ¨å…¶ä¸Šå®šä¹‰äº†ä¸€ç§å˜æ¢(å³æ˜ å°„)$A$ï¼Œå¯¹ä»»æ„$\boldsymbol{x} ã€ y \in X$ä»¥åŠæ•°åŸŸä¸­çš„æ•°$k$å‡æ»¡è¶³ä»¥åŠå³å¯¹åŠ æ³•å’Œæ•°ä¹˜å…·æœ‰çº¿æ€§å…³ç³»ï¼Œåˆ™ç§°è¿™ç§æ˜ å°„ä¸ºçº¿æ€§å˜æ¢çº¿æ€§å˜æ¢å¯¹å‘é‡çš„åŠ æ³•ä¸æ•°ä¹˜è¿ç®—å…·æœ‰çº¿æ€§çŸ©é˜µä¹˜æ³•æ˜¯ä¸€ç§çº¿æ€§å˜æ¢ï¼Œå®ƒæ»¡è¶³çº¿æ€§å˜æ¢çš„å®šä¹‰è¦æ±‚ï¼Œå¯¹ä»»æ„çš„å‘é‡$x, y \in \mathbb{R}^{n}$ä»¥åŠå®æ•°$k$æœ‰å‡ ä½•ä¸­çš„æ—‹è½¬å˜æ¢æ˜¯ä¸€ç§çº¿æ€§å˜æ¢ï¼Œä¸‹é¢ä»¥äºŒç»´å¹³é¢çš„æ—‹è½¬ä¸ºä¾‹è¿›è¡Œè¯´æ˜å¯¹äºäºŒç»´å¹³é¢å†…çš„å‘é‡ï¼Œå…¶åœ¨æåæ ‡ç³»ä¸‹çš„åæ ‡ä¸ºï¼Œä»æåæ ‡ç³»åˆ°ç›´è§’åæ ‡ç³»çš„è½¬æ¢å…¬å¼ä¸ºå°†æåæ ‡ä¸º$(r \quad \alpha)^{\mathrm{T}}$çš„å‘é‡é€†æ—¶é’ˆæ—‹è½¬$\alpha$åº¦ä¹‹åçš„ç»“æœå‘é‡$\boldsymbol{x}^{\prime}$çš„æåæ ‡ä¸ºï¼Œå…¶ç›´è§’åæ ‡ä¸ºå› æ­¤æ—‹è½¬å˜æ¢çš„å˜æ¢çŸ©é˜µä¸ºæ­£äº¤å˜æ¢å¦‚æœä¸€ä¸ªçº¿æ€§å˜æ¢èƒ½ä¿æŒå‘é‡ä¹‹é—´çš„è§’åº¦ä»¥åŠå‘é‡çš„é•¿åº¦ä¸å˜ï¼Œå³å˜æ¢ä¹‹åä¸¤ä¸ªå‘é‡çš„å¤¹è§’ä¸å˜ï¼Œä¸”å‘é‡çš„é•¿åº¦ä¸å˜ï¼Œåˆ™ç§°ä¸ºæ­£äº¤å˜æ¢ï¼Œæ­£äº¤å˜æ¢å¯¹åº”çš„çŸ©é˜µæ˜¯æ­£äº¤çŸ©é˜µä¸‹é¢ç»™å‡ºè¯æ˜: å¦‚æœ$\boldsymbol{A}$æ˜¯æ­£äº¤çŸ©é˜µï¼Œä½¿ç”¨å®ƒå¯¹å‘é‡$\boldsymbol{x}$è¿›è¡Œå˜æ¢ä¹‹åçš„å‘é‡é•¿åº¦ä¸ºå˜æ¢ä¹‹åå‘é‡é•¿åº¦ä¸å˜ï¼Œå¯¹å‘é‡$\boldsymbol{x}$å’Œ$\boldsymbol{y}$å˜æ¢ä¹‹åçš„å†…ç§¯ä¸ºæ ¹æ®å‘é‡å¤¹è§’å…¬å¼å†…ç§¯å’Œå‘é‡é•¿åº¦å‡ä¸å˜ï¼Œå› æ­¤ä¿æŒå‘é‡å¤¹è§’ä¸å˜æ—‹è½¬å˜æ¢æ˜¯æ­£äº¤å˜æ¢ï¼Œä»¥äºŒç»´å¹³é¢çš„æ—‹è½¬çŸ©é˜µä¸ºä¾‹ï¼Œæœ‰æ—‹è½¬å˜æ¢çŸ©é˜µæ˜¯æ­£äº¤çŸ©é˜µï¼Œå› æ­¤æ—‹è½¬å˜æ¢æ˜¯æ­£äº¤å˜æ¢å‡ ä½•ä¸­çš„ç¼©æ”¾å˜æ¢ä¹Ÿæ˜¯ä¸€ç§çº¿æ€§å˜æ¢ï¼Œå¯¹äºäºŒç»´å¹³é¢çš„å‘é‡ï¼Œå¦‚æœæœ‰ä¸‹é¢çš„ç¼©æ”¾å˜æ¢çŸ©é˜µåˆ™å˜æ¢ä¹‹åçš„å‘é‡ä¸ºè¿™ç›¸å½“äºåœ¨æ–¹å‘æ‹‰ä¼¸2å€ï¼Œåœ¨æ–¹å‘æ‹‰ä¼¸3å€ç¼©æ”¾å˜æ¢å¯¹åº”çš„çŸ©é˜µä¸ºå¯¹è§’çŸ©é˜µï¼Œä¸»å¯¹è§’çº¿å…ƒç´ ä¸ºåœ¨è¯¥æ–¹å‘ä¸Šçš„æ‹‰ä¼¸å€æ•°ï¼Œå¦‚æœä¸ºè´Ÿï¼Œåˆ™è¡¨ç¤ºåå‘ç¼©æ”¾å˜æ¢å’Œæ—‹è½¬å˜æ¢è¢«å¹¿æ³›åº”ç”¨äºæ•°å­—å›¾åƒå¤„ç†ã€è®¡ç®—æœºå›¾å½¢å­¦ï¼Œä»¥åŠæœºå™¨è§†è§‰ç­‰é¢†åŸŸï¼Œå®ç°å¯¹å‡ ä½•ä½“å’Œå›¾åƒçš„æ—‹è½¬å’Œç¼©æ”¾ç­‰æ“ä½œè¡Œåˆ—å¼è¡Œåˆ—å¼(Determinant, det)æ˜¯å¯¹çŸ©é˜µçš„ä¸€ç§è¿ç®—ï¼Œå®ƒä½œç”¨äºæ–¹é˜µï¼Œå°†å…¶æ˜ å°„æˆä¸€ä¸ªæ ‡é‡è¡Œåˆ—å¼çš„å®šä¹‰ä¸æ€§è´¨$n$é˜¶æ–¹é˜µ$\boldsymbol{A}$çš„è¡Œåˆ—å¼è®°ä¸º$|\boldsymbol{A}|$æˆ–$\operatorname{det}(\boldsymbol{A})$ï¼Œç§°ä¸º$n$é˜¶è¡Œåˆ—å¼ã€‚è®¡ç®—å…¬å¼ä¸ºå…¶ä¸­ä¸ºæ­£æ•´æ•°$1,2, \cdots, n$çš„ä¸€ä¸ªæ’åˆ—ï¼Œ$S_{n}$æ˜¯è¿™$n$ä¸ªæ­£æ•´æ•°æ‰€æœ‰æ’åˆ—æ„æˆçš„é›†åˆï¼Œ æ˜¾ç„¶æœ‰ ç§æ’åˆ—è¿™é‡Œä¸ºæ’åˆ—çš„é€†åºæ•°å¯¹äºä¸€ä¸ªæ’åˆ—ï¼Œå¦‚æœï¼Œä½†ï¼Œåˆ™ç§°ä¸ºä¸€ä¸ªé€†åºæ’åˆ—ä¸­æ‰€æœ‰é€†åºçš„æ•°é‡ç§°ä¸ºæ’åˆ—çš„é€†åºæ•°ä¸‹é¢ä¸¾ä¾‹è¯´æ˜ï¼Œå¯¹äº3ä¸ªæ­£æ•´æ•°$1,2,3$ï¼Œå…¶æ‰€æœ‰æ’åˆ—çš„é›†åˆ$S_{n}$ä¸ºæ’åˆ—$3,2,1$çš„æ‰€æœ‰é€†åºä¸ºå› æ­¤å…¶é€†åºæ•°ä¸º3æ’åˆ—$2,1,3$çš„æ‰€æœ‰é€†åºä¸ºå› æ­¤å…¶é€†åºæ•°ä¸º1æ ¹æ®å®šä¹‰ï¼Œ$n$é˜¶è¡Œåˆ—å¼çš„æ±‚å’Œé¡¹æœ‰$n!$ é¡¹ï¼Œæ¯ä¸ªæ±‚å’Œé¡¹ä¸­çš„è¡¨ç¤ºæŒ‰è¡Œå·é€’å¢çš„é¡ºåºä»$\boldsymbol{A}$çš„æ¯ä¸€è¡Œå„æŠ½å–ä¸€ä¸ªå…ƒç´ ç›¸ä¹˜ä¸”è¿™äº›å…ƒç´ çš„åˆ—å·ä¸èƒ½é‡å¤ï¼Œå®ƒä»¬çš„åˆ—å·æ˜¯çš„ä¸€ä¸ªæ’åˆ—è¿™é‡Œå†³å®šäº†æ±‚å’Œé¡¹çš„ç¬¦å·ï¼Œå®ƒæ„å‘³ç€å¦‚æœè¿™äº›å…ƒç´ çš„åˆ—å·æ’åˆ—çš„é€†åºæ•°ä¸ºå¶æ•°ï¼Œåˆ™å…¶å€¼ä¸º1ï¼›å¦‚æœä¸ºå¥‡æ•°ï¼Œåˆ™ä¸º-1$n!$ ç§æ’åˆ—ä¸­é€†åºæ•°ä¸ºå¥‡æ•°çš„æ’åˆ—å’Œé€†åºæ•°ä¸ºå¶æ•°çš„æ’åˆ—å„å ä¸€åŠï¼Œæ­¤æ±‚å’Œé¡¹ä¸­æ­£å·å’Œè´Ÿå·å„å ä¸€åŠä¸‹é¢æŒ‰ç…§å®šä¹‰è®¡ç®—3é˜¶è¡Œåˆ—å¼çš„å€¼ä¸‹é¢æ¨å¯¼2é˜¶å’Œ3é˜¶è¡Œåˆ—å¼çš„è®¡ç®—å…¬å¼ï¼Œ2é˜¶çŸ©é˜µçš„è¡Œåˆ—å¼çš„è®¡ç®—å…¬å¼ä¸ºä¸‹é¢çš„2é˜¶è¡Œåˆ—å¼å€¼ä¸º3é˜¶çŸ©é˜µçš„è¡Œåˆ—å¼çš„è®¡ç®—å…¬å¼ä¸ºä¸‹é¢çš„3é˜¶è¡Œåˆ—å¼å€¼ä¸ºè¡Œåˆ—å¼å¯ä»¥è¡¨ç¤ºå¹³è¡Œå››è¾¹å½¢ä¸å¹³è¡Œå…­é¢ä½“çš„æœ‰å‘é¢ç§¯å’Œä½“ç§¯ï¼Œä¹Ÿæ˜¯çº¿æ€§å˜æ¢çš„ä¼¸ç¼©å› å­å¦‚æœå°†æ–¹é˜µçœ‹ä½œçº¿æ€§å˜æ¢ï¼Œåˆ™å…¶è¡Œåˆ—å¼çš„ç»å¯¹å€¼è¡¨ç¤ºè¯¥å˜æ¢å¯¼è‡´çš„ä½“ç§¯å…ƒå˜åŒ–ç³»æ•°é›…å…‹æ¯”è¡Œåˆ—å¼è¢«å¹¿æ³›åº”ç”¨äºå¤šå…ƒå‡½æ•°å¾®åˆ†ä¸ç§¯åˆ†çš„è®¡ç®—ï¼Œä»£è¡¨äº†å¤šå…ƒæ¢å…ƒåçš„æ¯”ä¾‹é‡æŒ‰ç…§å®šä¹‰ï¼Œä¸€ä¸ªè¡Œåˆ—å¼å¯ä»¥æŒ‰ç…§è¡Œæˆ–åˆ—è¿›è¡Œé€’å½’å±•å¼€ï¼Œç§°ä¸ºæ‹‰æ™®æ‹‰æ–¯å±•å¼€(Laplace Expan-sion)å…¶ä¸­æ˜¯å»æ‰çŸ©é˜µ$\boldsymbol{A}$çš„ç¬¬$i$è¡Œå’Œç¬¬$j$ åçš„$n-1$é˜¶çŸ©é˜µçš„è¡Œåˆ—å¼ï¼Œå¹¶ä¸”å¸¦æœ‰ç¬¦å·$(-1)^{i+j}, i+j$ä¸ºè¡Œå·å’Œåˆ—å·ä¹‹å’Œï¼Œç§°ä¸ºçš„ä»£æ•°ä½™å­å¼ï¼Œä¸å¸¦ç¬¦å·çš„å­è¡Œåˆ—å¼åˆ™ç§°ä¸ºä½™å­å¼ä¸‹é¢çš„è¡Œåˆ—å¼å¯ä»¥æŒ‰ç¬¬ä¸€è¡Œå±•å¼€ä¸ºç‰¹æ®Šè¡Œåˆ—å¼çš„å€¼æŸä¸€è¡Œ(åˆ—)å…¨ä¸º0çš„è¡Œåˆ—å¼å€¼ä¸º0ï¼Œæ ¹æ®æ‹‰æ™®æ‹‰æ–¯å±•å¼€å¯ä»¥å¾—åˆ°æ­¤ç»“è®ºï¼Œæ ¹æ®è¡Œåˆ—å¼çš„å®šä¹‰ä¹Ÿå¯ä»¥ç›´æ¥å¾—åˆ°æ­¤ç»“æœï¼Œ$n!$ ä¸ªæ±‚å’Œé¡¹ä¸­æ¯ä¸€é¡¹éƒ½å¿…ç„¶åŒ…å«æŸä¸€ è¡Œåˆ—çš„ä¸€ä¸ªå…ƒç´ ï¼Œæ ¹æ®æ­¤ç»“è®ºï¼Œä¸‹é¢çš„è¡Œåˆ—å¼å€¼ä¸º0æ ¹æ®å®šä¹‰ï¼Œå¦‚æœä¸€ä¸ªçŸ©é˜µä¸ºå¯¹è§’çŸ©é˜µï¼Œåˆ™å…¶è¡Œåˆ—å¼ä¸ºçŸ©é˜µä¸»å¯¹è§’çº¿å…ƒç´ çš„ä¹˜ç§¯ï¼Œè¿™æ˜¯å› ä¸º$n !$ ä¸ªæ±‚å’Œé¡¹ä¸­ï¼Œé™¤äº†å…¨éƒ¨ç”±ä¸»å¯¹è§’çº¿å…ƒç´ æ„æˆçš„é¡¹ä¹‹å¤–ï¼Œå…¶ä»–çš„é¡¹çš„ä¹˜ç§¯ä¸­éƒ½å«æœ‰0ä¸‹é¢çš„å¯¹è§’çŸ©é˜µçš„è¡Œåˆ—å¼å€¼ä¸ºå•ä½çŸ©é˜µçš„è¡Œåˆ—å¼ä¸º1ä¸Šä¸‰è§’çŸ©é˜µå’Œä¸‹ä¸‰è§’çŸ©é˜µçš„è¡Œåˆ—å¼ä¸ºå…¶ä¸»å¯¹è§’çº¿å…ƒç´ çš„ä¹˜ç§¯ï¼Œè¿™æ˜¯å› ä¸º$n$ ! ä¸ªæ±‚å’Œé¡¹ä¸­ï¼Œé™¤äº†å…¨éƒ¨ç”±ä¸»å¯¹è§’çº¿å…ƒç´ æ„æˆçš„é¡¹ä¹‹å¤–ï¼Œå…¶ä»–çš„é¡¹çš„ä¹˜ç§¯ä¸­éƒ½å«æœ‰0æ ¹æ®è¿™ä¸€ç»“è®ºæœ‰è¡Œåˆ—å¼çš„é‡è¦æ€§è´¨è¡Œåˆ—å¼å…·æœ‰å¤šçº¿æ€§ï¼Œå¯ä»¥æŒ‰ç…§æŸä¸€è¡Œæˆ–åˆ—çš„çº¿æ€§ç»„åˆæ‹†åˆ†æˆä¸¤ä¸ªè¡Œåˆ—å¼ä¹‹å’Œå› ä¸ºæŒ‰ç…§è¿™ä¸€ç»“è®ºæœ‰å¦‚æœè¡Œåˆ—å¼çš„ä¸¤è¡Œæˆ–åˆ—ç›¸ç­‰ï¼Œé‚£ä¹ˆè¡Œåˆ—å¼çš„å€¼ä¸º0ï¼Œå³ä¸‹é¢ç»™å‡ºè¯æ˜ï¼Œå‡è®¾è¡Œåˆ—å¼çš„ç¬¬$i$è¡Œå’Œç¬¬$k$è¡Œç›¸ç­‰ï¼Œ$n!$ ä¸ªæ±‚å’Œé¡¹å¯ä»¥åˆ†æˆä¸¤ç»„ï¼Œå³ä¸ç”±äºä¸”æ’åˆ—ä¸çš„é€†åºæ•°çš„å¥‡å¶æ€§ç›¸å(äºŒè€…é€šè¿‡ä¸€æ¬¡ç½®æ¢å¯ä»¥äº’ç›¸å¾—åˆ°)ï¼Œå› æ­¤è¿™ä¸¤é¡¹çš„ç¬¦å·ç›¸åï¼Œæ•…è¡Œåˆ—å¼çš„å€¼ä¸º0æ ¹æ®è¿™ä¸€ç»“è®ºï¼Œä¸‹é¢çš„è¡Œåˆ—å¼ä¸º0æ ¹æ®è¿™ä¸€ç»“è®ºå¯ä»¥æ„é€ å‡ºå¯é€†çŸ©é˜µçš„é€†çŸ©é˜µï¼Œå¯¹äºçŸ©é˜µå‡è®¾æ˜¯çš„ä»£æ•°ä½™å­å¼ï¼Œåˆ©ç”¨å®ƒä»¬æ„é€ å¦‚ä¸‹çš„ä¼´éšçŸ©é˜µæ ¹æ®æ‹‰æ™®æ‹‰æ–¯å±•å¼€ï¼Œç¬¬$i$è¡Œä¸å…¶ä»£æ•°ä½™å­å¼çš„å†…ç§¯ä¸ºè¡Œåˆ—å¼æœ¬èº«ç¬¬$i$è¡Œä¸ç¬¬$j, j \neq i$è¡Œçš„ä»£æ•°ä½™å­å¼çš„å†…ç§¯ä¸º0ï¼Œè¿™æ˜¯å› ä¸ºå®ƒæ˜¯ç¬¬$j$è¡Œä¸ç¬¬$i$è¡Œç›¸ç­‰çš„è¡Œåˆ—å¼çš„æ‹‰æ™®æ‹‰æ–¯å±•å¼€ï¼Œå…¶å€¼ä¸º0å› æ­¤æœ‰å¦‚æœ$|\boldsymbol{A}| \neq 0$ï¼Œåˆ™æœ‰å› æ­¤è¿™ä¹Ÿè¯æ˜äº†çŸ©é˜µ$\boldsymbol{A}$å¯é€†çš„å……åˆ†å¿…è¦æ¡ä»¶æ˜¯$|\boldsymbol{A}| \neq 0$å¦‚æœæŠŠè¡Œåˆ—å¼çš„æŸä¸€è¡Œå…ƒç´ éƒ½ä¹˜ä»¥$k$ï¼Œåˆ™è¡Œåˆ—å¼å˜ä¸ºä¹‹å‰çš„$k$å€ï¼Œå³å¦‚æœå°†è¡Œåˆ—å¼çš„ä¸¤è¡Œäº¤æ¢ï¼Œè¡Œåˆ—å¼åå·å¦‚æœä¸€ä¸ªè¡Œåˆ—å¼çš„ä¸¤è¡Œæˆæ¯”ä¾‹å…³ç³»ï¼Œå…¶å€¼ä¸º0è¡Œåˆ—å¼çš„ä¸€è¡ŒåŠ ä¸Šå¦ä¸€è¡Œçš„$k$å€ï¼Œè¡Œåˆ—å¼å€¼ä¸å˜æŒ‰ç…§è¿™ä¸€ç»“è®ºï¼Œä¸‹é¢ä¸¤ä¸ªè¡Œåˆ—å¼çš„å€¼ç›¸ç­‰å¯ä»¥é€šè¿‡è¿™ç§å˜æ¢å°†çŸ©é˜µåŒ–ä¸ºä¸‰è§’çŸ©é˜µï¼Œç„¶åè®¡ç®—å…¶è¡Œåˆ—å¼çš„å€¼æ ¹æ®æ‹‰æ™®æ‹‰æ–¯å±•å¼€å¯ä»¥è¯æ˜ä¸‹é¢çš„ç»“è®ºæˆç«‹å¦‚æœçŸ©é˜µ$A$å’Œ$B$æ˜¯å°ºå¯¸ç›¸åŒçš„$n$é˜¶çŸ©é˜µï¼Œåˆ™æœ‰å³çŸ©é˜µä¹˜ç§¯çš„è¡Œåˆ—å¼ç­‰äºçŸ©é˜µè¡Œåˆ—å¼çš„ä¹˜ç§¯ï¼Œä¸‹é¢ç»™å‡ºè¯æ˜ï¼Œç”±äºå°†$n+1$è¡Œä¹˜ä»¥åŠ åˆ°ç¬¬1è¡Œï¼Œç¬¬è¡Œä¹˜ä»¥åŠ åˆ°ç¬¬1è¡Œï¼Œâ€¦ ï¼Œ å°†ç¬¬è¡Œä¹˜ä»¥åŠ åˆ°ç¬¬1è¡Œï¼Œå¯ä»¥å¾—åˆ°å¯¹ç¬¬$2 \sim n$è¡Œæ‰§è¡Œç±»ä¼¼çš„æ“ä½œï¼Œå°†ä¸Šå¼å³ä¾§è¡Œåˆ—å¼çš„å·¦ä¸Šè§’å…¨éƒ¨æ¶ˆä¸º0ï¼Œæœ€åå¯ä»¥å¾—åˆ°ä¸Šå¼ç¬¬3æ­¥å°†è¡Œåˆ—å¼å·¦ä¾§çš„$n$åˆ—ä¸å³ä¾§çš„$n$åˆ—å¯¹æ¢ï¼Œå› æ­¤å‡ºç°$(-1)^{n}$ï¼Œç¬¬4æ­¥åˆ©ç”¨äº†æ‹‰æ™®æ‹‰æ–¯å±•å¼€ï¼Œç¬¬5æ­¥åˆ©ç”¨äº†å¯¹è§’çŸ©é˜µçš„è¡Œåˆ—å¼è®¡ç®—å…¬å¼ï¼Œé€šå¸¸ä½¿ç”¨å®ƒè®¡ç®—çŸ©é˜µä¹˜ç§¯çš„è¡Œåˆ—å¼æ ¹æ®ä¸Šå¼å¯ä»¥ç›´æ¥å¾—åˆ°ä¸‹é¢çš„ç»“è®º: å¦‚æœçŸ©é˜µå¯é€†ï¼Œåˆ™å…¶è¡Œåˆ—å¼ä¸ä¸º0ï¼Œä¸”å…¶é€†çŸ©é˜µçš„è¡Œåˆ—å¼ç­‰äºè¡Œåˆ—å¼çš„é€†ï¼Œå³è¿™æ˜¯å› ä¸º$A A^{-1}=I$ï¼Œå› æ­¤çŸ©é˜µä¸æ ‡é‡ä¹˜æ³•çš„è¡Œåˆ—å¼ä¸ºå…¶ä¸­$n$ä¸ºçŸ©é˜µçš„é˜¶æ•°ï¼Œè¿™å¯ä»¥æ ¹æ®è¡Œåˆ—å¼çš„å®šä¹‰ç›´æ¥è¯æ˜ï¼Œæ‰€æœ‰æ±‚å’Œé¡¹ä¸­å‡å˜ä¸ºï¼Œå› æ­¤æœ€åå‡ºç°$\alpha^{n}$ï¼Œæ ¹æ®è¿™ä¸€ç»“è®ºæœ‰çŸ©é˜µè½¬ç½®ä¹‹åè¡Œåˆ—å¼ä¸å˜è¿™å¯ä»¥æ ¹æ®è¡Œåˆ—å¼çš„å®šä¹‰ä»¥åŠè¡Œåˆ—å¯¹æ¢è¿›è¡Œè¯æ˜æ­£äº¤çŸ©é˜µçš„è¡Œåˆ—å¼ä¸º$\pm 1$ï¼Œå¦‚æœ$A$æ˜¯æ­£äº¤çŸ©é˜µï¼Œåˆ™æœ‰å› æ­¤$|\boldsymbol{A}|=\pm 1$è®¡ç®—æ–¹æ³•è¡Œåˆ—å¼çš„è®¡ç®—åˆ†ä¸ºæ‰‹åŠ¨è®¡ç®—ä¸ç¼–ç¨‹è®¡ç®—ä¸¤ç§æ–¹å¼æ‰‹åŠ¨è®¡ç®—å¯¹äºæ‰‹åŠ¨è®¡ç®—ï¼Œé‡ç‚¹ä»‹ç»å°†çŸ©é˜µåŒ–ä¸ºä¸Šä¸‰è§’çŸ©é˜µçš„æ–¹æ³•ä¸Šä¸‰è§’çŸ©é˜µæˆ–ä¸‹ä¸‰è§’çŸ©é˜µçš„è¡Œåˆ—å¼æ˜¯æ˜“äºè®¸ç®—çš„ï¼Œç­‰äºå…¶ä¸»å¯¹è§’çº¿å…ƒç´ çš„ä¹˜ç§¯æ ¹æ®ä¸‹é¢çš„åˆç­‰è¡Œå˜æ¢å°†è¡Œåˆ—å¼çš„ä¸¤è¡Œäº¤æ¢å°†è¡Œåˆ—å¼çš„æŸä¸€è¡Œä¹˜ä»¥$k$å€ä¹‹ååŠ åˆ°å¦å¤–ä¸€è¡Œå¯ä»¥å°†è¡Œåˆ—å¼åŒ–ä¸ºä¸Šä¸‰è§’å½¢å¼ï¼Œæ ¹æ®å‰é¢ä»‹ç»çš„è¡Œåˆ—å¼çš„æ€§è´¨ï¼Œç¬¬ä¸€ç§å˜æ¢ä½¿å¾—è¡Œåˆ—å¼çš„å€¼åå·ï¼Œç¬¬äºŒç§å˜æ¢ä¿è¯è¡Œåˆ—å¼çš„å€¼ä¸å˜ä¸‹é¢ä¸¾ä¾‹è¯´æ˜ï¼Œå¯¹äºä¸‹é¢çš„è¡Œåˆ—å¼å°†å…¶åŒ–ä¸ºä¸Šä¸‰è§’çŸ©é˜µï¼Œç„¶åè®¡ç®—è¡Œåˆ—å¼çš„å€¼ç¼–ç¨‹è®¡ç®—Pythonä¸­linalgçš„detå‡½æ•°å®ç°äº†è®¡ç®—æ–¹é˜µè¡Œåˆ—å¼çš„åŠŸèƒ½ï¼Œä¸‹é¢æ˜¯è®¡ç®—çŸ©é˜µè¡Œåˆ—å¼çš„ç¤ºä¾‹ä»£ç 1234import numpy  A = np.array([[1,0,0],[0,1,0],[0,0,5]])d = np.linalg.det(A)print(d)ç¨‹åºè¿è¡Œç»“æœä¸º5ï¼Œå¯¹è§’çŸ©é˜µçš„è¡Œåˆ—å¼ä¸ºä¸»å¯¹è§’çº¿å…ƒç´ çš„ä¹˜ç§¯çº¿æ€§æ–¹ç¨‹ç»„é«˜æ–¯æ¶ˆå…ƒæ³•é«˜æ–¯æ¶ˆå…ƒæ³•(Gaussian Elimination Method)å³åŠ å‡æ¶ˆå…ƒæ³•ï¼Œæ˜¯æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„çš„ç»å…¸æ–¹æ³•é€šè¿‡å°†ä¸€ä¸ªæ–¹ç¨‹å‡æ‰å¦ä¸€ä¸ªæ–¹ç¨‹çš„å€æ•°æ¶ˆæ‰æœ«çŸ¥æ•°ï¼Œå¾—åˆ°é˜¶æ¢¯å‹æ–¹ç¨‹ç»„ï¼Œç„¶åä¾æ¬¡è§£å‡ºæ¯ä¸€ä¸ªæœ«çŸ¥æ•°ä¸‹é¢ç”¨ä¸€ä¸ªç®€å•çš„ä¾‹å­è¿›è¡Œè¯´æ˜ï¼Œå¯¹äºå¦‚ä¸‹çš„çº¿æ€§æ–¹ç¨‹ç»„å…ˆæ¶ˆå»æ–¹ç¨‹2å’Œæ–¹ç¨‹3çš„ç¬¬ä¸€ä¸ªæœ«çŸ¥æ•°ï¼Œå°†æ–¹ç¨‹2å‡å»æ–¹ç¨‹1çš„3å€ï¼Œå°†æ–¹ç¨‹3åŠ ä¸Šæ–¹ç¨‹1ï¼Œæ¶ˆæ‰æ–¹ç¨‹2å’Œæ–¹ç¨‹3ä¸­çš„$x_{1}$ï¼Œå¾—ç„¶åå°†æ–¹ç¨‹3åŠ ä¸Šæ–¹ç¨‹2çš„3å€ï¼Œæ¶ˆæ‰æ–¹ç¨‹3ä¸­çš„$x_{2}$ï¼Œå¾—å¯ä»¥è§£å¾—ä¸‹é¢ç”¨çŸ©é˜µçš„å½¢å¼æè¿°è¿™ä¸€æ±‚è§£è¿‡ç¨‹ï¼Œå¦‚ä¸‹æ‰€ç¤ºä¸‹é¢å°†è¿™ç§æ¶ˆå…ƒæ³•è¿›è¡Œæ¨å¹¿ï¼Œå¯¹äºä»»æ„çš„çº¿æ€§æ–¹ç¨‹ç»„ï¼Œé‡‡ç”¨å¦‚ä¸‹çš„åˆç­‰å˜æ¢å¯¹å…¶è¿›è¡Œå˜å½¢ï¼Œæ–¹ç¨‹ç»„çš„è§£ä¸å˜äº¤æ¢ä¸¤ä¸ªæ–¹ç¨‹çš„ä½ç½®ç”¨é0çš„å¸¸æ•°ä¹˜ä»¥æŸæ–¹ç¨‹çš„ä¸¤ç«¯å°†ä¸€ä¸ªæ–¹ç¨‹çš„å¸¸æ•°å€åŠ åˆ°å¦ä¸€ä¸ªæ–¹ç¨‹ä¸Šå»é‡‡ç”¨è¿™ç§åˆç­‰å˜æ¢ï¼Œæ¯æ¬¡æ¶ˆæ‰ä¸€ä¸ªæœ«çŸ¥æ•°ï¼Œæœ€åå¾—åˆ°ä¸€ä¸ªé˜¶æ¢¯å½¢æ–¹ç¨‹ç»„ï¼Œå³å¯æ±‚å‡ºæ–¹ç¨‹çš„è§£é½æ¬¡æ–¹ç¨‹ç»„é½æ¬¡çº¿æ€§æ–¹ç¨‹ç»„(Homogeneous Linear Equations)æ˜¯å¸¸æ•°é¡¹å…¨éƒ¨ä¸º0çš„çº¿æ€§æ–¹ç¨‹ç»„ï¼Œå¯ä»¥å†™æˆå¦‚ä¸‹å½¢å¼å…¶ä¸­$\boldsymbol{A} \in \mathbb{R}^{m \times n}, \boldsymbol{x} \in \mathbb{R}^{n}$ å°†ç³»æ•°çŸ©é˜µ$\boldsymbol{A}$æŒ‰åˆ—åˆ†å—ä¸ºï¼Œé½æ¬¡æ–¹ç¨‹å¯ä»¥å†™æˆä»¥è§£å‘é‡ä¸ºç»„åˆç³»æ•°ï¼Œå‘é‡ç»„çš„çº¿æ€§ç»„åˆä¸º0å‘é‡æ˜¾ç„¶$\boldsymbol{x}=\mathbf{0}$æ˜¯æ–¹ç¨‹ç»„çš„è§£ï¼Œå› æ­¤é½æ¬¡æ–¹ç¨‹ä¸€å®šæœ‰è§£ï¼Œæ›´é‡è¦çš„æ˜¯ï¼Œé™¤$\boldsymbol{x}=\mathbf{0}$ å¤–çš„è§£ï¼Œç§°ä¸ºé0è§£ï¼Œä¸‹é¢è®¨è®ºè¿™ç§è§£çš„å­˜åœ¨æ€§æ ¹æ®çº¿æ€§ç›¸å…³æ€§çš„å®šä¹‰ï¼Œå¦‚æœå‘é‡ç»„çº¿æ€§æ— å…³ï¼Œåˆ™ä¸å­˜åœ¨ä¸€ç»„ä¸å…¨ä¸º0çš„ç³»æ•°ä½¿å¾—å…¶çº¿æ€§ç»„åˆä¸º0å¦‚æœå‘é‡ç»„çº¿æ€§ç›¸å…³ï¼Œåˆ™å­˜åœ¨ä¸€ç»„ä¸å…¨ä¸º0çš„ç³»æ•°ä½¿å¾—å…¶çº¿æ€§ç»„åˆä¸º0ï¼Œè¿™å°±æ˜¯æ–¹ç¨‹ç»„çš„é0è§£å‰è€…å¯¹åº”äºçŸ©é˜µ$A$çš„ç§©ä¸º$n$ï¼Œåè€…ç§©å°äº$n$ï¼Œç”±æ­¤å¾—åˆ°é½æ¬¡æ–¹ç¨‹ç»„è§£çš„å­˜åœ¨æ€§åˆ¤å®šæ¡ä»¶ï¼Œåˆ†ä¸‹é¢ä¸¤ç§æƒ…å†µå¦‚æœ$r(\boldsymbol{A})=n$ï¼Œæ–¹ç¨‹ç»„åªæœ‰0è§£å¦‚æœ$r(\boldsymbol{A}) \lt n$ï¼Œæ–¹ç¨‹ç»„æœ‰é0è§£æ–¹ç¨‹ç»„æœ‰é$\boldsymbol{0}$è§£çš„å……åˆ†å¿…è¦æ¡ä»¶æ˜¯$r(\boldsymbol{A})&lt;n$å¦‚æœ$\boldsymbol{A}$æ˜¯æ–¹é˜µï¼Œ$r(\boldsymbol{A})&lt;n$ç­‰åŒäº$\boldsymbol{A}$ä¸å¯é€†ï¼Œ å¦‚æœ$m&lt;n$ï¼Œå³(æ–¹ç¨‹çš„æ•°é‡)å°äºæœªçŸ¥æ•°çš„æ•°é‡ï¼Œåˆ™æœ‰æ­¤æ—¶æ–¹ç¨‹ç»„å¿…å®šæœ‰é$\boldsymbol{0}$è§£ï¼Œå¯¹äºå¦‚ä¸‹çš„çº¿æ€§æ–¹ç¨‹ç»„å…¶ç³»æ•°çŸ©é˜µçš„ç§©ä¸ºå› æ­¤æ–¹ç¨‹ç»„åªæœ‰$\mathbf{0}$è§£ï¼Œå¯¹äºå¦‚ä¸‹çš„æ–¹ç¨‹ç»„å…¶ç³»æ•°çŸ©é˜µçš„ç§©ä¸ºä¹Ÿæ˜¯æ–¹ç¨‹ç»„çš„è§£ï¼Œè¯æ˜å¦‚ä¸‹å‡è®¾éƒ½æ˜¯æ–¹ç¨‹ç»„çš„è§£ï¼Œå¦‚æœè¿™ç»„è§£çº¿æ€§æ— å…³ä¸”æ–¹ç¨‹ç»„çš„ä»»æ„ä¸€ä¸ªè§£éƒ½å¯ä»¥ç”±è¿™ç»„è§£çº¿æ€§è¡¨ç¤ºï¼Œåˆ™ç§°æ˜¯æ–¹ç¨‹ç»„çš„ä¸€ä¸ªåŸºç¡€è§£ç³»å¦‚æœ$r(\boldsymbol{A})&lt;n$ï¼Œåˆ™å­˜åœ¨åŸºç¡€è§£ç³»ï¼Œä¸”åŸºç¡€è§£ç³»ä¸­åŒ…å«$n-r(\boldsymbol{A})$ä¸ªè§£é½æ¬¡çº¿æ€§æ–¹ç¨‹ç»„çš„æ±‚è§£æ–¹æ³•é€šå¸¸é‡‡ç”¨çš„æ˜¯åˆç­‰è¡Œå˜æ¢æ³•ï¼Œå¯¹åº”é«˜æ–¯æ¶ˆå…ƒæ³•ï¼Œç»è¿‡åˆç­‰è¡Œå˜æ¢å°†ç³»æ•°çŸ©é˜µåŒ–ä¸ºé˜¶æ¢¯å½¢çŸ©é˜µä¹‹åå¦‚æœå‡ºç°è‡ªç”±æœªçŸ¥æ•°ï¼Œå¯ä»¥å°†å®ƒä»¬è®¾ä¸ºç‰¹æ®Šå€¼ï¼Œå½¢æˆåŸºç¡€è§£ç³»ï¼Œç„¶åå¾—åˆ°æ–¹ç¨‹ç»„çš„é€šè§£(General Solution)å¦‚æœæ˜¯è‡ªç”±æœ«çŸ¥æ•°ï¼Œé€šå¸¸å°†å®ƒä»¬çš„å€¼ä¾æ¬¡è®¾ä¸ºè¿™æ˜¯$\mathbb{R}^{n-r}$ç©ºé—´ä¸€ç»„æœ€ç®€å•çš„æ ‡å‡†æ­£äº¤åŸºï¼Œç„¶åæ ¹æ®å®ƒä»¬çš„å€¼è§£å‡ºå…¶ä»–çš„æœ«çŸ¥æ•°ï¼Œå¯¹äºå¦‚ä¸‹çš„æ–¹ç¨‹ç»„å¯¹å…¶ç³»æ•°çŸ©é˜µè¿›è¡Œåˆç­‰è¡Œå˜æ¢ç”±äº$r(\boldsymbol{A})=2&lt;4$ï¼Œå› æ­¤æ–¹ç¨‹ç»„æœ‰é$\mathbf{0}$è§£ï¼Œæœ€åä¸™ä¸ªæœ«çŸ¥æ•°ä¸ºè‡ªç”±å˜é‡ä»¤ï¼Œå¾—åˆ°åŸºç¡€è§£ç³»çš„ç¬¬ä¸€ä¸ªè§£ä»¤ï¼Œå¾—åˆ°åŸºç¡€è§£ç³»çš„ç¬¬äºŒä¸ªè§£æ–¹ç¨‹ç»„çš„é€šè§£ä¸ºå…¶ä¸­ä¸ºä»»æ„å¸¸æ•°éé½æ¬¡æ–¹ç¨‹ç»„éé½æ¬¡çº¿æ€§æ–¹ç¨‹ç»„(Non-homogeneous Linear Equations)çš„å¸¸æ•°é¡¹ä¸å…¨ä¸º0ï¼Œå¯å†™æˆå¦‚ä¸‹å½¢å¼è¿™ä¸ä¸€å…ƒä¸€æ¬¡æ–¹ç¨‹$a x=0$åœ¨å½¢å¼ä¸Šæ˜¯ç»Ÿä¸€çš„ï¼Œæ–¹ç¨‹ç»„çš„å¢å¹¿çŸ©é˜µæ˜¯ç³»æ•°çŸ©é˜µå’Œå¸¸æ•°å‘é‡åˆå¹¶æ„æˆçš„çŸ©é˜µå¯¹äºå¦‚ä¸‹çš„çº¿æ€§æ–¹ç¨‹ç»„å…¶ç³»æ•°çŸ©é˜µä¸ºå¢å¹¿çŸ©é˜µä¸ºå‡è®¾$\boldsymbol{A} \in \mathbb{R}^{m \times n}, \boldsymbol{x} \in \mathbb{R}^{n}$ ï¼Œç³»æ•°çŸ©é˜µ$\boldsymbol{A}$æ‰©åˆ—åˆ†å—ä¸ºï¼Œéé½æ¬¡æ–¹ç¨‹å¯ä»¥å†™æˆä»¥$x$ä¸ºç»„åˆç³»æ•°ï¼Œå‘é‡ç»„çš„çº¿æ€§ç»„åˆä¸ºå‘é‡ï¼Œå¦‚æœå¯ä»¥ç”±çš„åˆ—å‘é‡çº¿æ€§è¡¨ç¤ºï¼Œåˆ™æ–¹ç¨‹ç»„æœ‰è§£ï¼Œå¦åˆ™æ–¹ç¨‹ç»„æ— è§£ç”¨åˆç­‰è¡Œå˜æ¢å°†å¢å¹¿çŸ©é˜µåŒ–ä¸ºé˜¶æ¢¯çŸ©é˜µå¦‚æœï¼Œåˆ™æ„å‘³ç€å‡ºç°çŸ›ç›¾æ–¹ç¨‹ï¼Œæ–¹ç¨‹æ— è§£ï¼Œå¦‚æœï¼Œåˆ™æ–¹ç¨‹ç»„æœ‰è§£ï¼Œå¯¹äºç¬¬äºŒç§æƒ…å†µï¼Œå¢å¹¿çŸ©é˜µçš„ç§©ä¸ç³»æ•°çŸ©é˜µçš„ç§©å°äºå¢å¹¿çŸ©é˜µçš„ç§©ï¼Œä¸”ç”±æ­¤å¾—åˆ°éé½æ¬¡æ–¹ç¨‹ç»„è§£çš„å­˜åœ¨æ€§åˆ¤å®šæ¡ä»¶å¦‚æœ$r(\boldsymbol{A})=r(\boldsymbol{B})$ï¼Œé‚£ä¹ˆæ–¹ç¨‹ç»„çš„è§£å­˜åœ¨å¦‚æœ$r(\boldsymbol{A})&lt;r(\boldsymbol{B})$ï¼Œé‚£ä¹ˆæ–¹ç¨‹ç»„çš„è§£ä¸å­˜åœ¨å¯¹äºç¬¬ä¸€ç§æƒ…å†µï¼Œå¦‚æœ$r(\boldsymbol{A})=n$ï¼Œé‚£ä¹ˆæ–¹ç¨‹ç»„æœ‰å”¯ä¸€è§£ï¼Œå¦‚æœ$r(\boldsymbol{A})&lt;n$ï¼Œé‚£ä¹ˆæ–¹ç¨‹ç»„æœ‰æ— ç©·å¤šç»„è§£è§£çš„æ€§è´¨ä¸ç»“æ„å¦‚æœæ˜¯éé½æ¬¡æ–¹ç¨‹ç»„æ‰€å¯¹åº”çš„é½æ¬¡æ–¹ç¨‹çš„ä¸€ç»„è§£ï¼Œæ˜¯éé½æ¬¡æ–¹ç¨‹çš„ä¸€ä¸ªè§£ï¼Œåˆ™æ˜¯éé½æ¬¡æ–¹ç¨‹çš„è§£ï¼Œæ˜¾ç„¶å¦‚æœæ˜¯é½æ¬¡æ–¹ç¨‹ç»„çš„åŸºç¡€è§£ç³»ï¼Œæ˜¯éé½æ¬¡æ–¹ç¨‹ç»„çš„ä¸€ä¸ªè§£ï¼Œåˆ™éé½æ¬¡æ–¹ç¨‹ç»„çš„è§£å¯ä»¥è¡¨ç¤ºä¸ºåŒæ ·å¯ä»¥ç”¨åˆç­‰è¡Œå˜æ¢æ±‚è§£éé½æ¬¡æ–¹ç¨‹ç»„ï¼Œå…¶è§£ä¸ºå¯¹åº”çš„é½æ¬¡æ–¹ç¨‹ç»„çš„é€šè§£åŠ ä¸Šå®ƒçš„ä¸€ä¸ªç‰¹è§£(Particular Solution)é½æ¬¡æ–¹ç¨‹ç»„é€šè§£çš„æ±‚è§£æ–¹æ³•åœ¨å‰é¢å·²ç»ä»‹ç»ï¼Œéé½æ¬¡æ–¹ç¨‹ç»„çš„ç‰¹è§£å¯ä»¥ä»»æ„é€‰å–ï¼Œé€šå¸¸ä»¤è‡ªç”±æœ«çŸ¥æ•°çš„å€¼å…¨ä¸º0ç”¨åˆç­‰è¡Œå˜æ¢è§£ä¸‹é¢çš„éé½æ¬¡çº¿æ€§æ–¹ç¨‹ç»„å¯¹å…¶å¢å¹¿çŸ©é˜µè¿›è¡Œåˆç­‰è¡Œå˜æ¢è¿™é‡Œæ˜¯è‡ªç”±æœªçŸ¥æ•°ï¼Œä»¤ï¼Œå¾—åˆ°ä¸€ä¸ªç‰¹è§£æ–¹æ¬¡æ–¹ç¨‹ç»„çš„åŸºç¡€è§£ç³»ä¸ºå› æ­¤æ–¹ç¨‹çš„è§£ä¸ºå…¶ä¸­ä¸ºä»»æ„å¸¸æ•°Pythonä¸­linalgçš„solveå‡½æ•°æä¾›äº†æ±‚è§£éé½æ¬¡çº¿æ€§æ–¹ç¨‹ç»„çš„åŠŸèƒ½ï¼Œå‡½æ•°çš„ä¼ äººå‚æ•°ä¸ºç³»æ•°çŸ©é˜µ$A$ï¼Œä»¥åŠå¸¸æ•°å‘é‡$\boldsymbol{b}$ï¼Œè¿”å›å€¼æ˜¯æ–¹ç¨‹ç»„$\boldsymbol{A x}=\boldsymbol{b}$çš„è§£å‘é‡$x$ï¼Œå¯¹äºæ–¹ç¨‹ç»„ä¸‹é¢æ˜¯æ±‚è§£è¯¥æ–¹ç¨‹ç»„çš„ä»£ç 12345import numpy as npA = np.array([3,1], [1,2])b = np.array([9,8])x = np.linalg.solve(A, b)print(x)ç¨‹åºè¿è¡Œç»“æœä¸º$[2,3]$ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡ç‰¹å¾å€¼(Eigenvalueï¼Œä¹Ÿç§°ä¸ºæœ¬å¾å€¼)ä¸ç‰¹å¾å‘é‡(Eigenvectorï¼Œä¹Ÿç§°ä¸ºæœ¬å¾å‘é‡)å†³å®šäº†çŸ©é˜µçš„å¾ˆå¤šæ€§è´¨ä»å‡ ä½•çš„è§’åº¦æ¥çœ‹ï¼ŒæŒå¾å‘é‡æ˜¯ç»è¿‡çŸ©é˜µçš„çº¿æ€§å˜æ¢ä»ç„¶å¤„äºåŒä¸€æ¡ç›´çº¿ä¸Šçš„å‘é‡ç‰¹å¾å€¼ä¸ç‰¹å¾å‘é‡ç‰¹å¾å€¼ä¸ç‰¹å¾å‘é‡å¯¹äº$n$é˜¶çŸ©é˜µ$A$ï¼Œå…¶ç‰¹å¾å‘é‡æ˜¯ç»è¿‡è¿™ä¸ªçŸ©é˜µçš„çº¿æ€§å˜æ¢ä¹‹åä»ç„¶å¤„äºåŒä¸€æ¡ç›´çº¿ä¸Šçš„å‘é‡ï¼Œæ–°å‘é‡çš„æ–¹å‘å¯èƒ½ä¼šç›¸åï¼Œé•¿åº¦å¯èƒ½ä¼šæ”¹å˜ï¼Œå³å­˜åœ¨ä¸€ä¸ªæ•°$\lambda$ä»¥åŠé$0$å‘é‡$x$ï¼Œæ»¡è¶³åˆ™ç§°$\lambda$ä¸ºçŸ©é˜µ$A$çš„ç‰¹å¾å€¼ï¼Œ$x$ä¸ºè¯¥ç‰¹å¾å€¼å¯¹åº”çš„ç‰¹å¾å‘é‡ç‰¹å¾å€¼æ˜¯ç‰¹å¾å‘é‡åœ¨çŸ©é˜µçš„çº¿æ€§å˜æ¢ä¸‹çš„ç¼©æ”¾ä»£ï¼Œå¦‚æœæŒå¾å€¼å¤§äº0ï¼Œé‚£ä¹ˆç»è¿‡çº¿æ€§å˜æ¢ä¹‹åç‰¹å¾å‘é‡çš„æ–¹å‘ä¸å˜ï¼›å¦‚æœç‰¹å¾å€¼å°äº0ï¼Œé‚£ä¹ˆç»è¿‡çº¿æ€§å˜æ¢ä¹‹åç‰¹å¾å‘é‡çš„æ–¹å‘ç›¸åï¼Œå¦‚æœç‰¹å¾å€¼ä¸º0ï¼Œåˆ™ç»è¿‡çº¿æ€§å˜æ¢ä¹‹åç‰¹å¾å‘é‡æ”¶ç¼©å›åŸç‚¹ç‰¹å¾çŸ©é˜µå’Œç‰¹å¾æ–¹ç¨‹ä¸Šå¼å˜å½¢åå¯ä»¥å¾—åˆ°$A-\lambda I$ ç§°ä¸ºç‰¹å¾çŸ©é˜µï¼ŒæŒ‰ç…§çº¿æ€§æ–¹ç¨‹ç»„çš„ç†è®ºï¼Œä¸Šé¢çš„é½æ¬¡æ–¹ç¨‹æœ‰é0è§£çš„æ¡ä»¶æ˜¯ç³»æ•°çŸ©é˜µçš„è¡Œåˆ—å¼å¿…é¡»ä¸º0ï¼Œå³å¼å­ç§°ä¸ºç‰¹å¾æ–¹ç¨‹(Eigenvalue Equation)å¯¹äºçŸ©é˜µå…¶ç‰¹å¾æ–¹ç¨‹ä¸ºç‰¹å¾å¤šé¡¹å¼ä¸Šé¢çš„è¡Œåˆ—å¼å±•å¼€ä¹‹åæ˜¯$\lambda$çš„$n$æ¬¡å¤šé¡¹å¼ï¼Œç§°ä¸ºçŸ©é˜µçš„ç‰¹å¾å¤šé¡¹å¼(Characteristic Polynomial)ï¼Œä¸ºå¦‚ä¸‹å½¢å¼æ±‚è§£è¿™ä¸ªç‰¹å¾å¤šé¡¹å¼å¯¹åº”çš„ç‰¹å¾æ–¹ç¨‹å¯ä»¥å¾—åˆ°æ‰€æœ‰ç‰¹å¾å€¼ï¼Œæ–¹ç¨‹çš„æ ¹å¯èƒ½æ˜¯å¤æ•°ï¼Œæ­¤æ—¶çš„ç‰¹å¾å€¼ä¸ºå¤æ•°ï¼Œç‰¹å¾å‘é‡ä¸ºå¤å‘é‡æ ¹æ®å¯¹è§’è¡Œåˆ—å¼çš„è®¡ç®—å…¬å¼ï¼Œå¯¹è§’çŸ©é˜µçš„ç‰¹å¾ä¸ºå…¶ä¸»å¯¹è§’çº¿å…ƒç´ ï¼Œå¯¹äºå¦‚ä¸‹å¯¹è§’çŸ©é˜µå…¶ç‰¹å¾æ–¹ç¨‹ä¸ºç±»ä¼¼åœ°ï¼Œä¸Šä¸‰è§’çŸ©é˜µçš„ç‰¹å¾å€¼ä¸ºå…¶ä¸»å¯¹è§’çº¿å…ƒç´ ï¼Œå¯¹äºå¦‚ä¸‹çš„ä¸Šä¸‰è§’çŸ©é˜µå…¶ç‰¹å¾æ–¹ç¨‹ä¸ºå¯¹äºä¸‹ä¸‰è§’çŸ©é˜µæœ‰ç›¸åŒçš„ç»“è®ºï¼Œä¸€ç§è®¡ç®—ç‰¹å¾å€¼çš„æ–¹æ³•æ˜¯é€šè¿‡ç›¸ä¼¼å˜æ¢å°†çŸ©é˜µå˜ä¸ºä¸Šä¸‰è§’çŸ©é˜µä»£æ•°é‡æ•°ã€è°±æ ¹æ®å¤šé¡¹å¼åˆ†è§£å®šç†ï¼Œç‰¹å¾æ–¹ç¨‹å¯ä»¥å†™æˆå…¶ä¸­ç§°ä¸ºç‰¹å¾å€¼çš„ä»£æ•°é‡æ•°(Algebraic Multiplicity)ï¼Œæ ¹æ®ä»£æ•°æ–¹ç¨‹çš„ç†è®ºï¼Œæœ‰æ‰€æœ‰$N_{\lambda}$ä¸ªä¸åŒçš„ç‰¹å¾å€¼æ„æˆçš„é›†åˆç§°ä¸ºçŸ©é˜µçš„è°±(Spectrum)çŸ©é˜µçš„è°±åŠå¾„(Spectral Radius)å®šä¹‰ä¸ºæ‰€æœ‰ç‰¹å¾å€¼ç»å¯¹å€¼çš„æœ€å¤§å€¼ï¼Œè®°ä¸ºå¦‚æœçŸ©é˜µ$\boldsymbol{A}$ä¸å¯é€†ï¼Œåˆ™å› æ­¤0æ˜¯å®ƒçš„ç‰¹å¾å€¼ï¼Œåä¹‹ï¼Œå¦‚æœå¯é€†ï¼Œåˆ™0ä¸æ˜¯å®ƒçš„ç‰¹å¾å€¼å‡ ä½•é‡æ•°å¾—åˆ°æ¯ä¸ªç‰¹å¾å€¼$\lambda_{i}$ä¹‹åï¼Œè§£ä¸‹é¢çš„çº¿æ€§æ–¹ç¨‹ç»„å³å¯å¾—åˆ°å…¶å¯¹åº”çš„ç‰¹å¾å‘é‡ï¼Œæ­¤æ–¹ç¨‹ç»„æœ‰$1 \leq m_i \leq n_i$ï¼Œä¸ªçº¿æ€§æ— å…³çš„è§£ï¼Œç§°$m_i$ä¸º$\lambda _i$çš„å‡ ä½•é‡æ•°(Geometric Multiplicity)è¿™äº›çº¿æ€§æ— å…³çš„è§£æ„æˆçš„ç©ºé—´ç§°ä¸ºçŸ©é˜µ$\boldsymbol{A}$å…³äºç‰¹å¾å€¼çš„ç‰¹å¾å­ç©ºé—´ï¼Œè®°ä¸ºæ ¹æ®é½æ¬¡çº¿æ€§æ–¹ç¨‹ç»„è§£çš„ç†è®ºï¼Œç‰¹å¾å­ç©ºé—´çš„ç»´æ•°ä¸ºå±äºä¸åŒç‰¹å¾å€¼çš„ç‰¹å¾å‘é‡çº¿æ€§æ— å…³ï¼ŒçŸ©é˜µæ‰€æœ‰çº¿æ€§æ— å…³çš„ç‰¹å¾å‘é‡çš„æ•°é‡ä¸ºæ˜¾ç„¶æœ‰$N_{x} \leqslant n$ç‰¹å¾å€¼ä¸ç‰¹å¾å‘é‡çš„è®¡ç®—ä¸‹é¢ç”¨ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜ç‰¹å¾å€¼ä¸ç‰¹å¾å‘é‡çš„è®¡ç®—ï¼Œå¯¹äºå¦‚ä¸‹çŸ©é˜µå…¶ç‰¹å¾å¤šé¡¹å¼ä¸ºç‰¹å¾æ–¹ç¨‹$-(1-\lambda)(1+\lambda)=0$çš„æ ¹ä¸º$\lambda=1$ä¸$\lambda=-1$ï¼Œå› æ­¤è¯¥çŸ©é˜µçš„ç‰¹å¾å€¼ä¸º1ä¸-1å°†ç‰¹å¾å€¼1ä»£äººï¼Œå¯å¾—è¯¥é½æ¬¡æ–¹ç¨‹çš„è§£ä¸ºæ­¤å³ç‰¹å¾å€¼1å¯¹åº”çš„ç‰¹å¾å‘é‡å°†å¦å¤–ä¸€ä¸ªç‰¹å¾å€¼-1ä»£äººï¼Œå¯å¾—è¯¥é½æ¬¡æ–¹ç¨‹çš„è§£ä¸ºå³ç‰¹å¾å€¼-1å¯¹åº”çš„ç‰¹å¾å‘é‡ä¸Šä¸‰è§’çŸ©é˜µçš„ç‰¹å¾å€¼ä¸ºå…¶ä¸»å¯¹è§’çº¿å…ƒç´ ï¼Œå¯¹äºå¦‚ä¸‹çŸ©é˜µæ ¹æ®å‰é¢çš„ç»“è®ºï¼Œå…¶ç‰¹å¾å¤šé¡¹å¼ä¸ºå…¶ç‰¹å¾å€¼ä¸º $1 ã€ 2 ã€ 3$å¯¹äºä¸è¶…è¿‡4é˜¶çš„çŸ©é˜µï¼Œå¯é€šè¿‡è§£ç‰¹å¾æ–¹ç¨‹å¾—åˆ°ç‰¹å¾å€¼ä½†æ›´é«˜æ¬¡æ–¹ç¨‹çš„æ±‚æ ¹å­˜åœ¨å›°éš¾ï¼Œé˜¿è´å°”-é²è²å°¼(Abel-Ruffini)å®šç†æŒ‡å‡ºï¼Œ4æ¬¡ä»¥ä¸Šçš„ä»£æ•°æ–¹ç¨‹æ²¡æœ‰å…¬å¼è§£ï¼Œå¯¹äºä¸€èˆ¬çš„é«˜æ¬¡æ–¹ç¨‹ï¼Œæ–¹ç¨‹ç³»æ•°çš„æœ‰é™æ¬¡å››åˆ™è¿ç®—ã€å¼€æ–¹è¿ç®—çš„ç»“æœå‡ä¸å¯èƒ½æ˜¯æ–¹ç¨‹çš„æ ¹ï¼Œå› æ­¤é«˜é˜¶çŸ©é˜µçš„ç‰¹å¾å€¼åªèƒ½æ±‚è¿‘ä¼¼è§£ç›´æ¥æ±‚è§£ç‰¹å¾æ–¹ç¨‹å¹¶ä¸æ˜¯ä¸€ç§å¥½çš„é€‰æ‹©ï¼Œæ›´æœ‰æ•ˆçš„æ–¹æ³•æ˜¯è¿­ä»£æ³•Pythonä¸­linalgçš„eigå‡½æ•°å®ç°äº†è®¡ç®—çŸ©é˜µçš„ç‰¹å¾å€¼ä¸ç‰¹å¾å‘é‡çš„åŠŸèƒ½ï¼Œå‡½æ•°çš„è¾“å…¥ä¸ºæ–¹é˜µï¼Œè¾“å‡ºä¸ºæ‰€æœ‰çš„ç‰¹å¾å€¼ä»¥åŠè¿™äº›ç‰¹å¾å€¼å¯¹åº”çš„ç‰¹å¾å‘é‡12345import numpy as npA = np.array([[1,0,0],[0,1,0],[0,0,5]])eigvalues, eigvectors = np.1inalg.eig(A)print(eigvalues)print(eigvectors)ç¨‹åºè¿è¡Œç»“æœä¸º123456#  ç‰¹å¾å€¼[1. 1. 5.]# ç‰¹å¾å‘é‡[[1. 0. 0.] [0. 1. 0.] [0. 0. 1.]]çŸ©é˜µçš„è¿¹ä¸‹é¢ä»‹ç»ç‰¹å¾å€¼ä¸çŸ©é˜µä¸»å¯¹è§’çº¿å…ƒç´ ä»¥åŠè¡Œåˆ—å¼çš„å…³ç³»ï¼ŒçŸ©é˜µçš„è¿¹(Trace)å®šä¹‰ä¸ºå…¶ä¸»å¯¹è§’çº¿å…ƒç´ ä¹‹å’Œå¯¹äºå¦‚ä¸‹çŸ©é˜µå…¶è¿¹ä¸ºå…³äºçŸ©é˜µçš„è¿¹ï¼Œæœ‰ä¸‹é¢çš„å…¬å¼æˆç«‹æ ¹æ®éŸ¦è¾¾å®šç†ï¼Œä¸‹é¢çš„$n$æ¬¡æ–¹ç¨‹æ‰€æœ‰æ ¹ä¹‹å’Œä¸ºæ‰€æœ‰æ ¹çš„ä¹˜ç§¯ä¸ºä¸‹é¢è®¡ç®—$n$é˜¶çŸ©é˜µçš„ç‰¹å¾å¤šé¡¹å¼ï¼Œé¦–å…ˆå°†è¡Œåˆ—å¼å†™æˆä¸‹é¢çš„å½¢å¼ç„¶åæŒ‰ç…§ç¬¬1åˆ—æ‹†å¼€ã€å˜ä¸ºä¸¤ä¸ªè¡Œåˆ—å¼ä¹‹å’Œæ¥ä¸‹æ¥å°†è¿™ä¸¤ä¸ªè¡Œåˆ—å¼å‡æŒ‰ç…§ç¬¬2åˆ—æ‹†å¼€ï¼Œå˜ä¸º4ä¸ªè¡Œåˆ—å¼ä¹‹å’Œä¾æ­¤ç±»æ¨ï¼Œå°†ä¸Šä¸€æ­¥çš„ç»“æœä¸­æ‰€æœ‰è¡Œåˆ—å¼æŒ‰ç…§ä¸‹ä¸€åˆ—æ‹†å¼€ï¼Œæœ€åå¯ä»¥å¾—åˆ°$2^{n}$ä¸ªè¡Œåˆ—å¼ï¼Œç‰¹å¾å€¼å¤šé¡¹å¼æ˜¯å®ƒä»¬ä¹‹å’Œè¿™äº›è¡Œåˆ—å¼çš„å±•å¼€ç»“æœä¸­ï¼Œå«æœ‰$\lambda^{n}$çš„åªæœ‰å› æ­¤ç‰¹å¾å¤šé¡¹å¼çš„é¦–æ¬¡é¡¹å°±æ˜¯$(-1)^{n} \lambda^{n}$ ï¼Œå«æœ‰$\lambda^{n-1}$çš„æ˜¯ä¸‹é¢$n$ä¸ªè¡Œåˆ—å¼å®ƒä»¬ä¹‹å’Œä¸ºå› æ­¤ç‰¹å¾å¤šé¡¹å¼çš„$\lambda^{n-1}$é¡¹ç³»æ•°æ˜¯ï¼Œä¸å«çš„åªæœ‰ä¸‹é¢ä¸€ä¸ªè¡Œåˆ—å¼å› æ­¤ç‰¹å¾å¤šé¡¹å¼ä¸­å¸¸æ•°é¡¹çš„ç³»æ•°ä¸º$|\boldsymbol{A}|$ï¼Œç”±æ­¤å¯ä»¥å¾—åˆ°ç‰¹å¾å¤šé¡¹å¼ä¸ºå°†ç‰¹å¾å¤šé¡¹å¼ä¹˜ä»¥$(-1)^{n}$å¯ä»¥å˜ä¸ºå› æ­¤çŸ©é˜µæ‰€æœ‰ç‰¹å¾å€¼çš„å’Œä¸ºçŸ©é˜µçš„è¿¹æ‰€æœ‰ç‰¹å¾å€¼çš„ç§¯ä¸ºçŸ©é˜µçš„è¡Œåˆ—å¼ç‰¹å¾å€¼çš„è‹¥å¹²é‡è¦æ€§è´¨1ï¸âƒ£å¦‚æœçŸ©é˜µå¯é€†ä¸”ä¸ºå®ƒçš„ç‰¹å¾å€¼ï¼Œåˆ™æ˜¯çš„ç‰¹å¾å€¼ï¼Œæ ¹æ®ç‰¹å¾å€¼ä¸ç‰¹å¾å‘é‡çš„å®šä¹‰æœ‰ä¸Šå¼ä¸¤è¾¹åŒæ—¶å·¦ä¹˜$A^{-1}$ï¼Œå¯ä»¥å¾—åˆ°å³å› æ­¤æ˜¯çš„ç‰¹å¾å€¼ï¼Œä¸ºå¯¹åº”çš„ç‰¹å¾å‘é‡2ï¸âƒ£å¦‚æœ$\lambda$æ˜¯çŸ©é˜µ$A$çš„ç‰¹å¾å€¼ï¼Œåˆ™$\lambda^{n}$æ˜¯$\boldsymbol{A}^{n}$çš„ç‰¹å¾å€¼ï¼Œæ ¹æ®ç‰¹å¾å€¼ä¸ç‰¹å¾å‘é‡çš„å®šä¹‰æœ‰åå¤åˆ©ç”¨æ­¤å¼ï¼Œæœ‰å› æ­¤$\lambda^{n}$æ˜¯$\boldsymbol{A}^{n}$çš„ç‰¹å¾å€¼ï¼Œç±»ä¼¼åœ°å¯ä»¥è¯æ˜å¦‚æœ$\lambda$æ˜¯çŸ©é˜µ$\boldsymbol{A}$çš„ç‰¹å¾å€¼ï¼Œåˆ™$k \lambda$æ˜¯$k \boldsymbol{A}$çš„ç‰¹å¾å€¼ï¼Œå¯¹äºå¦‚ä¸‹çš„å¤šé¡¹å¼3ï¸âƒ£å¦‚æœ$\lambda$æ˜¯çŸ©é˜µ$\boldsymbol{A}$çš„ç‰¹å¾å€¼ï¼Œåˆ™$f(\lambda)$æ˜¯$f(\boldsymbol{A})$çš„ç‰¹å¾å€¼4ï¸âƒ£çŸ©é˜µ$A$ä¸$A^{\mathrm{T}}$æœ‰ç›¸åŒçš„ç‰¹å¾å€¼ï¼Œæ˜¾ç„¶å› æ­¤ç‰¹å¾å‘é‡çš„è‹¥å¹²é‡è¦æ€§1ï¸âƒ£å¦‚æœå‘é‡éƒ½æ˜¯çŸ©é˜µå…³äºåŒä¸€ä¸ªç‰¹å¾å€¼çš„ç‰¹å¾å‘é‡ï¼Œåˆ™å®ƒä»¬çš„é$\mathbf{0}$çº¿æ€§ç»„åˆä¹Ÿæ˜¯çŸ©é˜µ$\boldsymbol{A}$å…³äº$\lambda$çš„ç‰¹å¾å‘é‡ï¼Œæ ¹æ®ç‰¹å¾å€¼ä¸ç‰¹å¾å‘é‡çš„å®šä¹‰æœ‰å› æ­¤æ˜¯å…³äºçš„ç‰¹å¾å‘é‡2ï¸âƒ£çŸ©é˜µå±äºä¸åŒç‰¹å¾å€¼çš„ç‰¹å¾å‘é‡çº¿æ€§æ— å…³å‡è®¾çŸ©é˜µ$A$çš„$l$ä¸ªä¸åŒç‰¹å¾å€¼ä¸ºï¼Œå®ƒä»¬å¯¹åº”çš„ç‰¹å¾å‘é‡ä¸ºï¼Œä¸‹é¢ç”¨å½’çº³æ³•è¿›è¡Œè¯æ˜å½“$l=1$æ—¶ç»“è®ºæˆç«‹ï¼Œå› ä¸ºï¼Œå¦‚æœï¼Œåˆ™å¿…å®šæœ‰å‡è®¾å½“$l=m$æ—¶ç»“è®ºæˆç«‹ï¼Œå½“$l=m+1$æ—¶ï¼Œæœ‰å¼å­ä¸¤è¾¹å·¦ä¹˜$\boldsymbol{A}$ï¼Œæœ‰ç”±äºå› æ­¤å°†ç¬¬ä¸€ä¸ªå¼å­ä¹˜ä»¥$\lambda_{m+1}$ï¼Œç„¶åå‡å»ä¸Šå¼ï¼Œå¯å¾—ç”±äºçº¿æ€§æ— å…³ï¼Œå› æ­¤è€Œï¼Œå› æ­¤ï¼Œå°†ä»£å…¥ç¬¬ä¸€ä¸ªå¼å­å¯å¾—ç”±äºæ˜¯ç‰¹å¾å‘é‡ï¼Œå› æ­¤ï¼Œæ•…ï¼Œå› æ­¤çº¿æ€§æ— å…³3ï¸âƒ£å®å¯¹ç§°çŸ©é˜µçš„ç‰¹å¾å€¼å‡ä¸ºå®æ•°é¦–å…ˆå®šä¹‰çŸ©é˜µçš„å…±è½­è¿ç®—ï¼Œå¤æ•°çŸ©é˜µ$\boldsymbol{A}$çš„å…±è½­$\overline{\boldsymbol{A}}$ä¸ºå°†å…¶æ‰€æœ‰å…ƒç´ å…±è½­åå½¢æˆçš„çŸ©é˜µï¼Œä¾‹å¦‚å¯¹äºä¸‹é¢çš„çŸ©é˜µå…¶å…±è½­çŸ©é˜µä¸ºå¯ä»¥è¯æ˜å…±è½­è¿ç®—æ»¡è¶³ä¸‹é¢çš„æ€§è´¨æ˜¾ç„¶å¯¹äºå®çŸ©é˜µæœ‰å‡è®¾$\lambda$æ˜¯å®å¯¹ç§°çŸ©é˜µ$\boldsymbol{A}$çš„ç‰¹å¾å€¼ï¼Œ$x$æ˜¯å¯¹åº”çš„ç‰¹å¾å‘é‡ç”±äºæ˜¯å®å¯¹ç§°çŸ©é˜µï¼Œå› æ­¤$\bar{A}^{\mathrm{T}}=A$ï¼Œç”±äº$A x=\lambda x$ï¼Œå› æ­¤ä¸Šå¼ä¸¤è¾¹åŒæ—¶å³ä¹˜$\boldsymbol{x}$å¯ä»¥å¾—åˆ°ä»è€Œæœ‰ç”±äº$x \neq 0$ï¼Œå› æ­¤$\overline{x^T} x&gt;0$ï¼Œå¯ä»¥å¾—åˆ° $\lambda=\bar{\lambda}$ï¼Œè¿™æ„å‘ ç€$\lambda$æ˜¯å®æ•°4ï¸âƒ£å®å¯¹ç§°çŸ©é˜µå±äºä¸åŒç‰¹å¾å€¼çš„ç‰¹å¾å‘é‡ç›¸äº’æ­£äº¤å‡è®¾$A$ä¸ºå®å¯¹ç§°çŸ©é˜µï¼Œæ˜¯å®ƒçš„ä¸¤ä¸ªä¸åŒçš„ç‰¹å¾å€¼ï¼Œåˆ†åˆ«ä¸ºå±äºçš„ç‰¹å¾å‘é‡ï¼Œåˆ™æœ‰ä¸Šå¼çš„ç¬¬ä¸€å¼ä¸¤è¾¹å·¦ä¹˜$x_{2}^{\mathrm{T}}$å¯ä»¥å¾—åˆ°è€Œå› æ­¤æœ‰ç”±äºï¼Œå› æ­¤æœºå™¨å­¦ä¹ ä¸­ä½¿ç”¨çš„çŸ©é˜µä¸€èˆ¬ä¸ºå®å¯¹ç§°çŸ©é˜µï¼Œå› æ­¤ç‰¹å¾å€¼å‡ä¸ºå®æ•°ï¼Œä¸”ä¸åŒç‰¹å¾å€¼çš„ç‰¹å¾å‘é‡æ­£äº¤ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡è¢«å¤§é‡ç”¨äºæœºå™¨å­¦ä¹ ç®—æ³•ï¼Œå…¸å‹çš„åŒ…æ‹¬ä¸»æˆåˆ†åˆ†æ(PCA)ï¼Œçº¿æ€§åˆ¤åˆ«åˆ†æ(LDA)ï¼Œæµå½¢å­¦ä¹ ç­‰é™ç»´ç®—æ³•ç›¸ä¼¼å˜æ¢é€šè¿‡ç›¸ä¼¼å˜æ¢å¯ä»¥å°†ä¸€ä¸ªçŸ©é˜µå˜ä¸ºå¯¹è§’çŸ©é˜µå®šä¹‰å¦‚æœæœ‰ä¸¤ä¸ªçŸ©é˜µ$A$ã€$B$ä»¥åŠä¸€ä¸ªå¯é€†çŸ©é˜µ$P$æ»¡è¶³åˆ™ç§°çŸ©é˜µ$A$ï¼Œ$B$ç›¸ä¼¼ï¼Œè®°ä¸º$A \sim B$ï¼Œä¸Šå¼ç§°ä¸ºç›¸ä¼¼å˜æ¢ï¼Œ$P$ä¸ºç›¸ä¼¼å˜æ¢çŸ©é˜µæ€§è´¨ç›¸ä¼¼å…·æœ‰è‡ªåæ€§ï¼ŒçŸ©é˜µä¸å…¶è‡ªèº«ç›¸ä¼¼ï¼Œå³$A \sim A$ï¼Œæ˜¾ç„¶ç›¸ä¼¼å…·æœ‰å¯¹ç§°æ€§ï¼Œå¦‚æœ$A \sim B$ï¼Œåˆ™$B \sim A$ï¼Œç”±äºä¸Šå¼ä¸¤è¾¹å·¦ä¹˜$P$ï¼Œå³ä¹˜$P^{-1}$ï¼Œå¯ä»¥å¾—åˆ°ç›¸ä¼¼å…·æœ‰ä¼ é€’æ€§ï¼Œå¦‚æœ$A \sim B$ä¸”$B \sim C$ï¼Œåˆ™$A \sim C$ï¼Œç”±äº$A \sim B$ä¸”$B \sim C$ï¼Œå› æ­¤æœ‰ä»è€Œæœ‰ç›¸ä¼¼çŸ©é˜µæœ‰ç›¸åŒçš„ç‰¹å¾å€¼ï¼Œè¿™æ„æ˜©ç€ç›¸ä¼¼å˜æ¢ä¿æŒçŸ©é˜µçš„ç‰¹å¾å€¼ä¸å˜å‡è®¾$A \sim B$ï¼Œåˆ™å­˜åœ¨å¯é€†çŸ©é˜µ$\boldsymbol{P}$ä½¿å¾—å› æ­¤è¿™ä¸€æ€§è´¨å¯ç”¨äºæ±‚è§£ç‰¹å¾å€¼ï¼Œé€šè¿‡ç›¸ä¼¼å˜æ¢å°†çŸ©é˜µ$A$å˜ä¸ºå¯¹è§’çŸ©é˜µæˆ–ä¸‰è§’çŸ©é˜µç‰¹å¾å€¼ä¸å˜ï¼Œå¯¹è§’çŸ©é˜µæˆ–ä¸‰è§’çŸ©é˜µçš„ä¸»å¯¹è§’çº¿å…ƒç´ å³ä¸º$A$çš„ç‰¹å¾å€¼å¦‚æœçŸ©é˜µæ»¡è¶³ä¸€å®šçš„æ¡ä»¶ï¼Œé€šè¿‡ç›¸ä¼¼å˜æ¢å¯å°†å…¶è½¬ä¸ºå¯¹è§’çŸ©é˜µå‡è®¾æ˜¯$n$é˜¶çŸ©é˜µ$A$çš„$n$ä¸ªç‰¹ä½‚å€¼ï¼Œæ˜¯å®ƒä»¬å¯¹åº”çš„ç‰¹å¾å‘é‡æ ¹æ®ç‰¹å¾å€¼ä¸ç‰¹å¾å‘é‡çš„å®šä¹‰æœ‰å¦‚æœä»¤çŸ©é˜µï¼Œå¯¹è§’çŸ©é˜µæ ¹æ®å³ä¹˜å¯¹è§’çŸ©é˜µçš„æ€§è´¨æœ‰å³å¦‚æœçŸ©é˜µ$P$å¯é€†ï¼Œé‚£ä¹ˆä¸Šå¼ä¸¤è¾¹åŒæ—¶å·¦ä¹˜$P^{-1}$å¯ä»¥å¾—åˆ°é€šè¿‡è¿™ç§ç›¸ä¼¼å˜æ¢å¯ä»¥å°†çŸ©é˜µåŒ–ä¸ºå¯¹è§’çŸ©é˜µï¼Œç§°ä¸ºçŸ©é˜µçš„ç›¸ä¼¼å¯¹è§’åŒ–å¼å­æ„å‘³ç€å¯ä»¥ä»¥çŸ©é˜µ$A$çš„ç‰¹å¾å‘é‡ä¸ºåˆ—æ„é€ ä¸€ä¸ªçŸ©é˜µ$P$ï¼Œé€šè¿‡å®ƒå°†çŸ©é˜µå¯¹è§’åŒ–ï¼Œå¾—åˆ°ä»¥$A$çš„ç‰¹å¾å€¼ä¸ºä¸»å¯¹è§’çº¿çš„å¯¹è§’çŸ©é˜µ$\boldsymbol{\Lambda}$è¿™ç§åšæ³•æˆç«‹çš„æ¡ä»¶æ˜¯çŸ©é˜µ$\boldsymbol{P}$å¯é€†ï¼Œå³çŸ©é˜µ$A$æœ‰$n$ä¸ªçº¿æ€§æ— å…³çš„ç‰¹å¾å‘é‡æ­£äº¤å˜æ¢å¯¹äºå®å¯¹ç§°çŸ©é˜µï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸ªæ­£äº¤çš„ç›¸ä¼¼å˜æ¢å°†å…¶å¯¹è§’åŒ–ç”¨å½’çº³æ³•è¯æ˜å®å¯¹ç§°çŸ©é˜µä¸€å®šå¯ä»¥å¯¹è§’åŒ–è¿™æ„å‘³ç€$n$é˜¶å®å¯¹ç§°çŸ©é˜µæœ‰$n$ä¸ªçº¿æ€§æ— å…³çš„ç‰¹å¾å‘é‡ï¼Œå®å¯¹ç§°çŸ©é˜µ$A$å±äºä¸åŒç‰¹å¾å€¼çš„ç‰¹å¾å‘é‡æ˜¯ç›¸äº’æ­£äº¤çš„å¦‚æœç”¨æ ¼æ‹‰å§†-æ–½å¯†ç‰¹æ­£äº¤åŒ–å°†åŒä¸€ä¸ªç‰¹å¾å€¼çš„æ‰€æœ‰ç‰¹å¾å‘é‡æ­£äº¤åŒ–ï¼Œç„¶åå°†æ‰€æœ‰ç‰¹å¾å‘é‡å•ä½åŒ–ï¼Œå¯ä»¥å¾—åˆ°ä¸€ç»„æ ‡å‡†æ­£äº¤åŸºä»¥å®ƒä»¬ä¸ºåˆ—æ„é€ ç›¸ä¼¼å˜æ¢çŸ©é˜µ$\boldsymbol{P}$ï¼Œåˆ™çŸ©é˜µ$\boldsymbol{P}$æ˜¯æ­£äº¤çŸ©é˜µï¼Œå¯é€šè¿‡æ­£äº¤å˜æ¢(Orthogonal Transformation)å°†çŸ©é˜µåŒ–ä¸ºå¯¹è§’é˜µç”±äº$P^{T}=P^{-1}$ï¼Œå› æ­¤è¿™æ˜¯ä¸€ç§æ›´ç‰¹æ®Šçš„ç›¸ä¼¼å˜æ¢ï¼Œå®ç°æ—¶åªéœ€è¦å¯¹åŒä¸€ä¸ªç‰¹å¾å€¼çš„ä¸åŒç‰¹å¾å‘é‡æ­£äº¤åŒ–ï¼Œç„¶åå°†æ‰€æœ‰æ­£äº¤åŒ–ä¹‹åçš„ç‰¹å¾å‘é‡è¿›è¡Œæ ‡å‡†åŒ–å³å¯ä¾‹å­å°†çŸ©é˜µé€šè¿‡æ­£äº¤å˜æ¢åŒ–ä¸ºå¯¹è§’çŸ©é˜µã€‚å¯¹äºä¸‹é¢çš„çŸ©é˜µå…¶ç‰¹å¾å¤šé¡¹å¼ä¸ºå› æ­¤å…¶ç‰¹å¾å€¼ä¸º$2,-1 ï¼Œ-1$ï¼Œå½“$\lambda=2$æ—¶ï¼Œæœ‰è§£å¾—å½“$\lambda=-1$æ—¶ï¼Œæœ‰è§£å¾—æ­£äº¤å•ä½åŒ–ä¹‹åä¸ºä»¤åˆ™æœ‰æ­£äº¤å˜æ¢å…·æœ‰ä¸€ä¸ªä¼˜è‰¯çš„æ€§è´¨ï¼Œå®ƒå¯ä»¥ä¿æŒçŸ©é˜µçš„å¯¹ç§°æ€§å‡è®¾$A$æ˜¯å¯¹ç§°çŸ©é˜µï¼Œ$P$æ˜¯æ­£äº¤çŸ©é˜µï¼Œä½¿ç”¨ä¸‹é¢çš„æ­£äº¤å˜æ¢$B$ä»ç„¶æ˜¯å¯¹ç§°çŸ©é˜µï¼Œä¸‹é¢ç»™å‡ºè¯æ˜ï¼Œæ˜¾ç„¶æœ‰è±ªæ–¯éœå°”å¾·(Householder)å˜æ¢ç‰¹æ®Šçš„æ­£äº¤å˜æ¢è±ªæ–¯éœå°”å¾·(Householder)å˜æ¢ï¼Œå®ƒåœ¨QRç®—æ³•ä»¥åŠå…¶ä»–çŸ©é˜µç®—æ³•ä¸­æœ‰é‡è¦çš„åº”ç”¨é¦–å…ˆå®šä¹‰HouseholderçŸ©é˜µï¼Œä¸ºå¦‚ä¸‹å½¢å¼å…¶ä¸­$\boldsymbol{w}$æ˜¯$n$ç»´é0åˆ—å‘é‡ï¼Œä¸”æœ‰$|\boldsymbol{w}|=1$ï¼Œæ˜¾ç„¶çŸ©é˜µ$\boldsymbol{P}$æ˜¯å¯¹ç§°çŸ©é˜µï¼Œå¹¶ä¸”æ˜¯æ­£äº¤çŸ©é˜µç”±äº$P$æ˜¯å¯¹ç§°çŸ©é˜µï¼Œå› æ­¤æœ‰æ•…è¯¥çŸ©é˜µæ˜¯æ­£äº¤çŸ©é˜µï¼Œé€šå¸¸å°†$P$å†™æˆå¦‚ä¸‹å½¢å¼å…¶ä¸­$u$ä¸ºä»»æ„é$\mathbf{0}$å‘é‡ä¸”è¿™é‡Œç”¨$H$å¯¹$u$è¿›è¡Œäº†æ ‡å‡†åŒ–å¯¹äº$n$ç»´åˆ—å‘é‡$\boldsymbol{x}$ï¼Œæ„é€ ä¸‹é¢çš„å‘é‡å…¶ä¸­å•ä½å‘é‡$\boldsymbol{e}_{1}=\left(\begin{array}{llll}1 &amp; 0 &amp; \cdots &amp; 0\end{array}\right)^{\mathrm{T}}$æ ¹æ®$\boldsymbol{u}$ç”¨ä¸Šé¢çš„å¼å­æ„é€ HouseholderçŸ©é˜µ$\boldsymbol{P}$ï¼Œä¸‹é¢å°†å‘é‡$x$å·¦ä¹˜$P$çš„ç»“æœå…¶ä¸­$x_{1}$æ˜¯$x$çš„ç¬¬1ä¸ªåˆ†é‡è¿™è¡¨æ˜å°†åˆ—å‘é‡$\boldsymbol{x}$å·¦ä¹˜$\boldsymbol{P}$ä¹‹åå°†é›¶åŒ–$\boldsymbol{x}$é™¤ç¬¬1ä¸ªå…ƒç´ ä¹‹å¤–çš„æ‰€æœ‰å…ƒç´ ï¼ŒåŒæ—¶ä¿æŒå‘é‡çš„é•¿åº¦ä¸å˜ï¼Œå°†è¡Œå‘é‡å³ä¹˜è¯¥çŸ©é˜µä¹‹åæœ‰ç±»ä¼¼çš„æ•ˆæœæ ¹æ®è¿™ä¸€ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ ä»¥HouseholderçŸ©é˜µä¸ºåŸºç¡€çš„æ­£äº¤å˜æ¢ï¼Œå°†çŸ©é˜µè½¬åŒ–ä¸ºç±»ä¼¼å¯¹è§’çŸ©é˜µçš„å½¢å¼ï¼Œé›¶åŒ–ä¸»å¯¹è§’çº¿ä¹‹å¤–çš„å…ƒç´ å¯¹äºå¯¹ç§°çŸ©é˜µ$\boldsymbol{A}$ï¼Œä½¿ç”¨å®ƒçš„ç¬¬1åˆ—è®¡ç®—å‘é‡$u$ï¼ŒæŒ‰ç…§ä¸Šé¢çš„å¼å­æ„é€ HouseholderçŸ©é˜µ$P$ç„¶åå¯¹$A$è¿›è¡Œæ­£äº¤å˜æ¢ï¼Œè¿™é‡Œçš„æ­£äº¤å˜æ¢é€šè¿‡å°†çŸ©é˜µ$A$å…ˆå·¦ä¹˜$P$ï¼Œç„¶åå³ä¹˜$P$å®ç°å·¦ä¹˜$P$å®ç°$A$çš„ç¬¬1åˆ—çš„é›¶åŒ–ï¼Œå³ä¹˜$P$å®ç°$A$çš„ç¬¬1è¡Œçš„é›¶åŒ–ä¸‹é¢æ¥çœ‹çŸ©é˜µ$P$çš„æ„é€ å¦‚æœç”¨$A$çš„æ•´ä¸ªç¬¬1åˆ—ä½œä¸ºå‘é‡ï¼ŒæŒ‰ç…§ä¸Šé¢çš„å¼å­æ„é€ $P$ï¼Œè™½ç„¶å¯åœ¨å·¦ä¹˜$P$ä¹‹åå°†$A$çš„ç¬¬1åˆ—é™¤ç¬¬1ä¸ªå…ƒç´ ä¹‹å¤–çš„æ‰€æœ‰å…ƒç´ å…¨éƒ¨é›¶åŒ–ï¼Œä½†ä¼šæ”¹å˜$A$çš„ç¬¬1è¡Œæ‰€æœ‰å…ƒç´ çš„å€¼æ¥ä¸‹æ¥åœ¨å³ä¹˜$P$çš„æ—¶å€™æ— æ³•ä¿è¯å°†$P A$çš„ç¬¬1è¡Œé›¶åŒ–ï¼Œå› æ­¤$P$éœ€è¦ä¿è¯å°†$A$çš„ç¬¬1åˆ—çš„å…ƒç´ é›¶åŒ–çš„åŒæ—¶ç¡®ä¿$A$çš„ç¬¬1è¡Œçš„å…ƒç´ ä¸å˜ï¼Œä»¥ä¾¿åœ¨å³ä¹˜$P$çš„æ—¶å€™å°†è¿™ä¸ªè¡Œé›¶åŒ–æˆ‘ä»¬å¯ä»¥æŒ‰ç…§ä¸‹é¢çš„å½¢å¼æ„é€ $P$å…¶ä¸­æ˜¯ç”¨$\boldsymbol{A}$çš„ç¬¬1åˆ—çš„åé¢$n-1$ä¸ªå…ƒç´ æŒ‰ç…§ä¸Šé¢å¼å­æ„é€ çš„æˆ‘ä»¬å°†ä¸Šä¸Šå¼çš„çŸ©é˜µä½œä¸ºç¬¬1æ¬¡è±ªæ–¯éœå°”å¾·å˜æ¢çš„çŸ©é˜µï¼Œè®°ä¸ºï¼Œå°†å·¦ä¹˜ä¹‹åå¯ä»¥ä¿è¯çš„ç¬¬1è¡Œå…ƒç´ ä¸å˜ï¼ŒåŒæ—¶å°†çš„ç¬¬1åˆ—çš„åé¢ä¸ªå…ƒç´ å…¨éƒ¨å˜ä¸º0æ¥ä¸‹æ¥å³ä¹˜ï¼Œç”±äºæ˜¯å¯¹ç§°çŸ©é˜µï¼Œå› æ­¤ç¬¬1åˆ—å’Œç¬¬1è¡Œç›¸åŒï¼Œå³ä¹˜å¯ä»¥å°†ç¬¬1è¡Œåé¢ä¸ªå…ƒç´ å…¨éƒ¨å˜ä¸º0ï¼Œå¹¶ä¸”ä¸æ”¹å˜ç¬¬1åˆ—æ‰€æœ‰å…ƒç´ çš„å€¼ï¼Œå› æ­¤ä¸ä¼šç ´åå‰é¢çš„åˆ—é›¶åŒ–ç»“æœç„¶åè¿›è¡Œç¬¬2æ¬¡è±ªæ–¯éœå°”å¾·å˜æ¢ç”±äºæ­£äº¤å˜æ¢å¯ä»¥ä¿æŒçŸ©é˜µçš„å¯¹ç§°æ€§ï¼Œå› æ­¤ä»ç„¶æ˜¯å¯¹ç§°çŸ©é˜µï¼Œç”¨çš„ç¬¬2åˆ—çš„åé¢ä¸ªå…ƒç´ æ„é€ å…¶ä¸­æ ¹æ®$A_{1}$çš„ç¬¬2åˆ—çš„åé¢$n-2$ä¸ªå…ƒç´ æŒ‰ç…§ä¸Šé¢çš„å¼å­æ„é€ ç»è¿‡ç¬¬2æ¬¡è±ªæ–¯éœå°”å¾·å˜æ¢å¯ä»¥å°†$A_{1}$çš„ç¬¬2åˆ—çš„åé¢$n-3$ä¸ªå…ƒç´ ï¼Œç¬¬2è¡Œçš„åé¢$n-3$ä¸ªå…ƒç´ å…¨éƒ¨å˜ä¸º0ä¾æ­¤ç±»æ¨ï¼Œç»è¿‡$n-2$æ¬¡è±ªæ–¯éœå°”å¾·å˜æ¢ï¼Œå¯ä»¥å°†å¯¹ç§°çŸ©é˜µåŒ–ä¸ºå¦‚ä¸‹çš„å¯¹ç§°ä¸‰å¯¹è§’çŸ©é˜µ(Tridiagonal Matrix)è¿™ç§çŸ©é˜µé™¤ä¸»å¯¹è§’çº¿ã€ä¸»å¯¹è§’çº¿ä»¥ä¸ŠåŠä»¥ä¸‹çš„å¯¹è§’çº¿ä¹‹å¤–ï¼Œå…¶ä»–å…ƒç´ å‡ä¸º0å¯¹äºä¸€èˆ¬çš„$n$é˜¶çŸ©é˜µ$\boldsymbol{A}$ï¼Œç”¨åŒæ ·çš„æ–¹æ³•æ„é€ è±ªæ–¯éœå°”å¾·çŸ©é˜µå·¦ä¹˜$P$ä¹‹åå°†$A$çš„ç¬¬1åˆ—åé¢$n-2$ä¸ªå…ƒç´ é›¶åŒ–ï¼ŒåŒæ—¶ä¿æŒ$\boldsymbol{A}$çš„ç¬¬1è¡Œå…ƒç´ ä¸å˜ç”±äº$\boldsymbol{A}$ä¸æ˜¯å¯¹è§’çŸ©é˜µï¼Œå…¶è¡Œå’Œåˆ—ä¸ç›¸ç­‰ï¼Œå› æ­¤å³ä¹˜$\boldsymbol{P}$ æ—¶å€™æ— æ³•å°†å…¶ç¬¬1è¡Œå…ƒç´ é›¶åŒ–åŒæ ·ä¸èƒ½ç”¨å®Œæ•´çš„åˆ—æ„é€ è±ªæ–¯éœå°”å¾·å˜æ¢çŸ© é˜µï¼Œå¦åˆ™å³ä¹˜è¯¥çŸ©é˜µçš„æ—¶å€™ä¼šç ´åå‰é¢é›¶åŒ–çš„ç»“æœç”¨å’Œå¯¹ç§°çŸ©é˜µç›¸åŒçš„æ–¹æ³•æ„é€ å˜æ¢çŸ©é˜µï¼Œç¬¬ä¸€æ¬¡è±ªæ–¯éœå°”å¾·å˜æ¢ä¹‹åçš„ç»“æœä¸ºç¬¬äºŒæ¬¡è±ªæ–¯éœå°”å¾·å˜æ¢å¯ä»¥å°†ç¬¬2åˆ—çš„åé¢$n-3$ä¸ªå…ƒç´ é›¶åŒ–ï¼Œå˜æ¢ä¹‹åçš„ç»“æœä¸ºä¾æ¬¡ç±»æ¨ï¼Œé€šè¿‡$n-2$æ¬¡è±ªæ–¯éœå°”å¾·å˜æ¢å¯ä»¥å°†$A$åŒ–ä¸ºå¦‚ä¸‹å½¢å¼çš„ä¸Šæµ·æ£®å ¡çŸ©é˜µ(upper-Hessenberg form)è¿™ç§çŸ©é˜µé™¤ä¸»å¯¹è§’çº¿åŠä»¥ä¸Šï¼Œä¸»å¯¹è§’çº¿ä¸‹é¢çš„å¯¹è§’çº¿çš„å…ƒç´ å¤–ï¼Œå…¶ä»–çš„å…ƒç´ å‡ä¸º0QR ç®—æ³•ä¸‹é¢ä»‹ç»æ±‚è§£é«˜é˜¶çŸ©é˜µç‰¹å¾å€¼çš„QRç­«æ³•ï¼Œå®ƒè¢«èª‰ä¸º20ä¸–çºªåå¤§ç®—æ³•ä¹‹ä¸€å®ƒä¾èµ–äº$\mathrm{QR}$åˆ†è§£ï¼Œå¯¹äºä¸€ä¸ªçŸ©é˜µ$A$ï¼Œ$\mathrm{QR}$åˆ†è§£å°†å…¶åŒ–ä¸ºä¸€ä¸ªæ­£äº¤çŸ©é˜µ$Q$ä¸ä¸€ä¸ªä¸Šä¸‰è§’çŸ©é˜µ$R$çš„ä¹˜ç§¯$\mathrm{QR}$ç®—æ³•æ˜¯ä¸€ç§è¿­ä»£æ³•ï¼Œä»çŸ©é˜µå¼€å§‹ï¼Œæ¯æ¬¡æ„é€ ä¸€ä¸ªç›¸ä¼¼å˜æ¢ï¼Œå°†å˜æ¢ä¸ºï¼Œæœ€åæ”¶æ•›åˆ°ä¸€ä¸ªä¸Šè§’çŸ©é˜µï¼Œä¸»å¯¹è§’çº¿å…ƒç´ å³ä¸ºå…¶ç‰¹å¾å€¼ç”±äºçŸ©é˜µä¸ç›¸ä¼¼ï¼Œå› æ­¤å®ƒä»¬æœ‰ç›¸åŒçš„ç‰¹å¾å€¼ï¼Œå¾—åˆ°äº†çš„ç‰¹å¾å€¼å³å¾—åˆ°äº†çš„ç‰¹å¾å€¼é—®é¢˜çš„æ ¸å¿ƒæ˜¯å¦‚ä½•æ„é€ è¿™ç§ç›¸ä¼¼å˜æ¢ï¼Œè¿™å€ŸåŠ©äº$\mathrm{QR}$åˆ†è§£å®ç°ï¼Œæ¯æ¬¡è¿­ä»£æ—¶ï¼Œé¦–å…ˆå¯¹$\boldsymbol{A}_{k}$è¿›è¡Œ$\mathrm{QR}$åˆ†è§£ç„¶åç”¨åˆ†è§£ç»“æœæ„é€ ä¸€ä¸ªæ–°çš„çŸ©é˜µ$\boldsymbol{A}_{k+1}$ï¼Œè¿™é‡Œå°†$\mathrm{QR}$åˆ†è§£çš„ç»“æœçŸ©é˜µäº¤æ¢é¡ºåºåç›¸ä¹˜ä¸Šé¢ä¸¤ä¸ªå¼å­ç»™å‡ºäº†æ ¹æ®å½“å‰çŸ©é˜µæ„é€ ä¸‹ä¸€ä¸ªçŸ©é˜µçš„æ–¹å¼ï¼Œç§°ä¸º$\mathrm{QR}$è¿­ä»£å› ä¸ºä¸æ˜¯ç›¸ä¼¼çš„ï¼Œå¼ä¸¤è¾¹åŒæ—¶å·¦ä¹˜å¯ä»¥å¾—åˆ°å°†å…¶ä»£äººå¼$A_{k+1}$å¯å¾—ç”±äºç›¸ä¼¼å…·æœ‰ä¼ é€’æ€§ï¼Œå› æ­¤$A$ä¸$A_{k}, k=1, \cdots, n$ç›¸ä¼¼å¦‚æœ$\boldsymbol{A}$æ»¡è¶³ä¸€å®šçš„æ¡ä»¶ï¼Œé‚£ä¹ˆ$\mathrm{QR}$è¿­ä»£æ‰€äº§ç”Ÿçš„çŸ©é˜µåºåˆ—${\boldsymbol{A}_{k}}$å°†æ”¶æ•›åˆ°ä¸€ä¸ªä¸Šä¸‰è§’çŸ©é˜µï¼Œä¸»å¯¹è§’çº¿å…ƒç´ å³ä¸º$\boldsymbol{A}$çš„ç‰¹å¾å€¼$Q R$è¿­ä»£æ˜¯æ­£äº¤å˜æ¢ï¼Œå¦‚æœ$A$æ˜¯å¯¹ç§°çŸ©é˜µï¼Œè¿™ç§å˜æ¢å°†ä¿æŒå¯¹ç§°æ€§ï¼Œä¸”æ”¶æ•›åˆ°ä¸Šä¸‰è§’çŸ©é˜µï¼Œå› æ­¤æœ€ç»ˆä¼šæ”¶æ•›åˆ°å¯¹è§’çŸ©é˜µå¯¹äºå®å¯¹ç§°çŸ©é˜µ$A$ï¼Œ$Q R$è¿­ä»£ä»£äº§ç”Ÿçš„æ‰€æœ‰æ­£äº¤çŸ©é˜µ$Q_{k}$çš„ä¹˜ç§¯çš„æ‰€æœ‰åˆ—ï¼Œå³ä¸º$\boldsymbol{A}$çš„ç‰¹å¾å‘é‡ï¼Œç”±äºå› æ­¤å¦‚æœä»¤åˆ™å› æ­¤$P$çš„åˆ—ä¸º$A$çš„ç‰¹å¾å‘é‡ä¸‹é¢æ¥çœ‹$\mathrm{QR}$ç®—æ³•çš„ä¸€ä¸ªä¾‹å­ï¼Œå¯¹äºå¦‚ä¸‹çŸ©é˜µ$Q R$ç®—æ³•ç¬¬1æ¬¡è¿­ä»£çš„ç»“æœä¸ºå†ç»è¿‡5æ¬¡è¿­ä»£åçš„ç»“æœä¸ºæ­¤æ—¶çŸ©é˜µ$A_{6}$å·²ç»æ¥è¿‘äºä¸Šä¸‰è§’çŸ©é˜µï¼Œä¸»å¯¹è§’çº¿å…ƒç´ æ¥è¿‘äº$A$çš„ç‰¹å¾å€¼ï¼Œäº‹å®ä¸Šï¼ŒçŸ©é˜µ$A$çš„ç‰¹å¾å€¼ä¸º$1,2,3$ ä¸ºäº†åŠ é€Ÿæ”¶æ•›ï¼Œé€šå¸¸é‡‡ç”¨å¸¦ä½ç§»çš„$QR$ç®—æ³•(Shifted QR Algorithm)ï¼Œåœ¨ç¬¬$k$æ¬¡è¿­ä»£æ—¶ï¼Œå¯¹äºè®¾å®šçš„ç§»ä½å¸¸æ•°$s_{k}$ï¼Œè¿­ä»£å…¬å¼ä¸ºå³å…ˆå°†çŸ©é˜µå‡æ‰åå†è¿›è¡Œåˆ†è§£ï¼Œåœ¨æ„é€ æ—¶å†å°†åŠ å›æ¥æŒ‰ç…§è¿™ç§è¿­ä»£å…¬å¼ï¼Œä¸ä¹Ÿæ˜¯ç›¸ä¼¼çš„ï¼Œæ ¹æ®ä¸Šå¼çš„1å¼æœ‰å°†å…¶ä»£äººä¸Šå¼çš„2å¼ï¼Œå¯å¾—å› æ­¤ä¸ç›¸ä¼¼ç§»ä½ç³»æ•°$s_{k}$çš„è®¡ç®—ä¸€ç§æ–¹æ¡ˆæ˜¯é€‰æ‹©å³ä¸‹è§’å­çŸ©é˜µçš„ä¸¤ä¸ªç‰¹å¾å€¼ä¸­æ¥è¿‘äºå…ƒç´ çš„é‚£ä¸ªç‰¹å¾å€¼ï¼Œä»¥ä¾¿äºä½¿å¾—ç»è¿‡æ­¤æ¬¡è¿­ä»£åçš„å˜ä¸º0è®¡ç®—æ­¤å­çŸ©é˜µçš„ç‰¹å¾å€¼å¯ä»¥é€šè¿‡æ±‚è§£ç‰¹å¾æ–¹ç¨‹å®ç°è¿™é‡Œçš„å³ä¸ºçš„ä¸€ä¸ªç‰¹å¾å€¼ï¼Œå¯¹å‰©ä¸‹çš„çŸ©é˜µç»§ç»­è¿›è¡Œç®—æ³•è¿­ä»£ï¼Œ å¾—åˆ°æ‰€æœ‰çš„ç‰¹å¾å€¼å¯¹äºä¸€èˆ¬çš„çŸ©é˜µï¼ŒQRç®—æ³•çš„æ”¶æ•›é€Ÿåº¦å¯èƒ½å¾ˆæ…¢ï¼Œå¦‚æœå°†çŸ©é˜µå˜æ¢æˆæ¥è¿‘äºä¸‰è§’é˜µï¼Œåˆ™èƒ½åŠ å¿«æ”¶æ•›é€Ÿåº¦å¦‚æœæ˜¯å¯¹ç§°çŸ©é˜µï¼Œå¯å…ˆç”¨è±ªæ–¯éœå°”å¾·å˜æ¢å°†å…¶åŒ–ä¸ºå¯¹ç§°ä¸‰å¯¹è§’çŸ©é˜µï¼Œç„¶åç”¨$Q R$ç®—æ³•è¿›è¡Œè¾¾ä»£ï¼Œæ”¶æ•›åˆ°å¯¹è§’çŸ©é˜µæ±‚è§£ç‰¹å¾å€¼çš„æ•´ä¸ªæµç¨‹ä¸º: å¯¹ç§°çŸ©é˜µ$\rightarrow$å¯¹ç§°ä¸‰å¯¹è§’çŸ©é˜µ$\rightarrow$å¯¹è§’çŸ©é˜µå¯¹äºæ™®é€šçŸ©é˜µï¼Œå¯ç”¨è±ªæ–¯éœå°”å¾·å˜æ¢å°†å…¶åŒ–ä¸ºä¸Šæµ·æ£®å ¡çŸ©é˜µï¼Œç„¶åç”¨QRç®—æ³•è¿›è¡Œè¿­ä»£ï¼Œæ”¶æ•›åˆ°ä¸Šä¸‰è§’çŸ©é˜µæ•´ä¸ªæµç¨‹ä¸º: æ™®é€šçŸ©é˜µ$\rightarrow$ä¸Šæµ·æ£®å ¡çŸ©é˜µ$\rightarrow$ä¸‰è§’çŸ©é˜µå¹¿ä¹‰ç‰¹å¾å€¼å¹¿ä¹‰ç‰¹å¾å€¼(Generalized Eigenvalue)æ˜¯ç‰¹å¾å€¼çš„æ¨å¹¿ï¼Œå®šä¹‰äºä¸¤ä¸ªçŸ©é˜µä¹‹ä¸Šå¯¹äºæ–¹é˜µ$A$å’Œ$B$ï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªæ•°$\lambda$åŠé0å‘é‡$\boldsymbol{x}$ï¼Œæ»¡è¶³åˆ™ç§°$\lambda$ä¸ºå¹¿ä¹‰ç‰¹å¾å€¼ï¼Œ$x$ä¸ºå¹¿ä¹‰ç‰¹å¾å‘é‡ï¼Œç±»ä¼¼çš„æœ‰ç‰¹å¾æ–¹ç¨‹å¦‚æœçŸ©é˜µ$B$å¯é€†ï¼Œå¯¹ç¬¬ä¸€ä¸ªå¼å­å·¦ä¹˜$B^{-1}$ï¼Œåˆ™å¼1çš„é—®é¢˜ç­‰ä»·äºä¸‹é¢çš„ç‰¹å¾å€¼é—®é¢˜å¹¿ä¹‰ç‰¹å¾å€¼åœ¨æœºå™¨å­¦ä¹ ä¸­è¢«å¹¿æ³›ä½¿ç”¨ï¼ŒåŒ…æ‹¬æµå½¢å­¦ä¹ ã€è°±èšç±»ç®—æ³•ï¼Œä»¥åŠçº¿æ€§åˆ¤åˆ«åˆ†æç­‰ç‘åˆ©å•†ç‘åˆ©å•†æ–¹é˜µ$A$å’Œé0å‘é‡$x$çš„ç‘åˆ©å•†(Rayleigh Quotient)å®šä¹‰ä¸ºå¦‚ä¸‹æ¯”å€¼æ ¹æ®å¼å­çš„å®šä¹‰ï¼Œå¯¹äºä»»æ„çš„é0å®æ•°$k$ï¼Œæœ‰å³å¯¹å‘é‡ç¼©æ”¾ä¹‹åå…¶ç‘åˆ©å•†ä¸å˜ï¼Œç‘åˆ©å•†å­˜åœ¨å†—ä½™ï¼Œè¯æ˜å¦‚ä¸‹å‡è®¾æ˜¯çŸ©é˜µçš„æœ€å°ç‰¹å¾å€¼ï¼Œæ˜¯æœ€å¤§ç‰¹å¾å€¼ï¼Œåˆ™æœ‰å³ç‘åˆ©å•†çš„æœ€å°å€¼ä¸ºçŸ©é˜µçš„æœ€å°ç‰¹å¾å€¼ï¼Œæœ€å¤§å€¼ä¸ºçŸ©é˜µçš„æœ€å¤§ç‰¹å¾å€¼å¹¶ä¸”å½“$x$åˆ†åˆ«ä¸ºæœ€å°å’Œæœ€å¤§çš„ç‰¹å¾å€¼å¯¹åº”çš„ç‰¹å¾å‘é‡çš„æ—¶å€™å–å¾—è¿™ä¸¤ä¸ªå€¼ï¼Œå¯ä»¥ç”¨æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•è¯æ˜ç”±äºå°†å‘é‡ä¹˜ä»¥é0ç³»æ•°ä¹‹åç‘åˆ©å•†ä¸å˜ï¼Œå› æ­¤å¼1æå€¼é—®é¢˜çš„è§£ä¸å”¯ä¸€ä¸ºæ­¤å¢åŠ ä¸€ä¸ªçº¦æŸæ¡ä»¶ä»¥ä¿è¯è§£çš„å”¯ä¸€æ€§ï¼ŒåŒæ—¶ç®€åŒ–é—®é¢˜çš„è¡¨è¿°ï¼Œé™å®š$x$ä¸ºå•ä½å‘é‡ï¼Œæœ‰ä¸‹é¢çš„ç­‰å¼çº¦æŸå¢åŠ æ­¤çº¦æŸä¹‹åï¼Œç‘åˆ©å•†å˜ä¸ºæ„é€ æ‹‰æ ¼æœ—æ—¥ä¹˜å­å‡½æ•°å¯¹$\boldsymbol{x}$æ±‚æ ·åº¦å¹¶ä»¤æ –åº¦ä¸º$\boldsymbol{0}$å¯ä»¥å¾—åˆ°è¿™é‡Œåˆ©ç”¨äº†çŸ©é˜µä¸å‘é‡æ±‚å¯¼å…¬å¼ï¼Œä¸Šå¼ç­‰ä»·äºæ­¤ç»“æœæ„å‘³ç€ç‘åˆ©å•†çš„æ‰€æœ‰æå€¼åœ¨çŸ©é˜µçš„ç‰¹å¾å€¼ä¸ç‰¹å¾å‘é‡å¤„å–å¾—å‡è®¾æ˜¯çš„ç¬¬ä¸ªå¾…å¾å€¼ã€æ˜¯å…¶å¯¹åº”çš„ç‰¹å¾å‘é‡ï¼Œå°†å®ƒä»¬ä»£äººç‘åˆ©å•†çš„å®šä¹‰ï¼Œå¯ä»¥å¾—åˆ°å› æ­¤ï¼Œåœ¨æœ€å¤§çš„ç‰¹å¾å€¼å¤„ï¼Œç‘åˆ©å•†æœ‰æœ€å¤§å€¼ï¼›åœ¨æœ€å°çš„ç‰¹å¾å€¼å¤„ï¼Œç‘åˆ©å•†æœ‰æœ€å°å€¼ç‘åˆ©å•†åœ¨æœºå™¨å­¦ä¹ é¢†åŸŸçš„å…¸å‹åº”ç”¨æ˜¯ä¸»æˆåˆ†åˆ†æå¹¿ä¹‰ç‘åˆ©å•†å¯¹ç‘åˆ©å•†è¿›è¡Œæ¨å¹¿ï¼Œå¾—åˆ°å¹¿ä¹‰ç‘åˆ©å•†ï¼Œå®šä¹‰ä¸ºåŒæ ·ï¼Œå¹¿ä¹‰ç‘åˆ©å•†å­˜åœ¨ä½™ï¼Œå°†å‘é‡$x$ç¼©æ”¾ä¹‹åå¹¿ä¹‰ç‘åˆ©å•†ä¸å˜å‡è®¾å¯¹ä»»æ„çš„é0å‘é‡$x$ï¼Œæœ‰$\boldsymbol{x}^{\mathrm{T}} B x&gt;0$å¦‚æœä»¤$B=C C^{\mathrm{T}}$ï¼Œè¿™æ˜¯å¯¹çŸ©é˜µ$B$çš„æ¥šåˆ—æ–¯åŸº(Cholesky)åˆ†è§£ï¼ŒåŒæ—¶ä»¤$x=\left(C^{\mathrm{T}}\right)^{-1} y$ï¼Œåˆ™å¯ä»¥å°†å¹¿ä¹‰ç‘åˆ©å•†è½¬åŒ–æˆç‘åˆ©å•†çš„å½¢å¼æ ¹æ®ç‘åˆ©å•†çš„ç»“è®ºï¼Œå¹¿ä¹‰ç‘åˆ©å•†çš„æœ€å¤§å€¼å’Œæœ€å°å€¼ç”±çŸ©é˜µ$C^{-1} A\left(C^{\mathrm{T}}\right)^{-1}$çš„æœ€å¤§å’Œæœ€å°ç‰¹ä½‚å€¼å†³å®šä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡å¹¿ä¹‰ç‰¹å¾å€¼å¾—åˆ°å¹¿ä¹‰ç‘åˆ©å•†çš„æå€¼ï¼Œä¸ç‘åˆ©å•†ç±»ä¼¼ï¼ŒåŠ ä¸Šç­‰å¼çº¦æŸæ¶ˆæ‰æœ€ä¼˜è§£çš„å†—ä½™å¹¿ä¹‰ç‘åˆ©å•†å˜ä¸ºå¯ä»¥ç”¨æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•æ±‚è§£ï¼Œæ„é€ æ‹‰æ ¼æœ—æ—¥ä¹˜å­å‡½æ•°å¯¹$\boldsymbol{x}$æ±‚æ¢¯åº¦å¹¶ä»¤æ¢¯åº¦ä¸º$\boldsymbol{0}$ï¼Œå¯ä»¥å¾—åˆ°è¿™ç­‰ä»·äºè¿™æ˜¯å¹¿ä¹‰ç‰¹å¾å€¼é—®é¢˜ï¼Œå¦‚æœçŸ©é˜µ$\boldsymbol{B}$å¯é€†ï¼Œé‚£ä¹ˆä¸Šå¼ä¸¤è¾¹åŒä¹˜ä»¥å…¶é€†çŸ©é˜µå¯ä»¥å¾—åˆ°å› æ­¤å¹¿ä¹‰ç‘åˆ©å•†çš„æ‰€æœ‰æå€¼åœ¨ä¸Šé¢çš„å¹¿ä¹‰ç‰¹å¾å€¼å¤„å–å¾—ï¼Œå‡è®¾æ˜¯ç¬¬ä¸ªå¹¿ä¹‰ç‰¹å¾å€¼ï¼Œæ˜¯å…¶å¯¹åº”çš„ç‰¹å¾å‘é‡ï¼Œå°†å®ƒä»¬ä»£äººå¹¿ä¹‰ç‘åˆ©å•†çš„å®šä¹‰ï¼Œå¯ä»¥å¾—åˆ°å› æ­¤å¹¿ä¹‰ç‘åˆ©å•†çš„æå¤§å€¼åœ¨æœ€å¤§å¹¿ä¹‰ç‰¹å¾å€¼å¤„å–å¾—ï¼Œæå°å€¼åœ¨æœ€å°å¹¿ä¹‰ç‰¹å¾å€¼å¤„å–å¾—çº¿æ€§åˆ¤åˆ¥åˆ†æçš„ä¼˜åŒ–ç›®æ ‡å‡½æ•°å³ä¸ºå¹¿ä¹‰ç‘åˆ©å•†è°±èŒƒæ•°ä¸ç‰¹å¾å€¼çš„å…³ç³»å‰é¢å®šä¹‰äº†è°±èŒƒæ•°çš„æ¦‚å¿µï¼Œå¯ä»¥è¯æ˜çŸ©é˜µ$\boldsymbol{W}$çš„è°±èŒƒæ•°ç­‰äº$\boldsymbol{W}^{\mathrm{T}} \boldsymbol{W}$çš„æœ€å¤§ç‰¹å¾å€¼çš„å¹³æ–¹æ ¹ï¼Œå³$\boldsymbol{W}$æœ€å¤§çš„å¥‡å¼‚å€¼å…¶ä¸­ä¸ºçš„å¥‡å¼‚å€¼ï¼Œæ˜¯çš„ç‰¹å¾å€¼çš„å¹³æ–¹æ ¹ï¼Œå¥‡å¼‚å€¼å°†åœ¨åé¢è¯¦ç»†ä»‹ç»ï¼Œæ ¹æ®å®šä¹‰ï¼Œè°±èŒƒæ•°çš„å¹³æ–¹ä¸ºå®ƒå°±æ˜¯ç‘åˆ©å•†çš„æå¤§å€¼ï¼Œä¸Šä¸€èŠ‚å·²ç»è¯æ˜äº†è¿™ä¸€æœ€ä¼˜åŒ–é—®é¢˜çš„è§£æ˜¯çŸ©é˜µ$\boldsymbol{W}^{\mathrm{T}} \boldsymbol{W}$çš„æœ€å¤§ç‰¹å¾å€¼ï¼Œå› æ­¤ç»“è®ºæˆç«‹Pythonä¸­linalgçš„normå‡½æ•°æä¾›äº†è®¡ç®—çŸ©é˜µèŒƒæ•°çš„åŠŸèƒ½ï¼Œå‡½æ•°çš„è¾“äººå‚æ•°ä¸ºè¦è®¡ç®—çš„çŸ©é˜µï¼Œä»¥åŠèŒƒæ•°çš„ç±»å‹ï¼Œå¦‚æœç±»å‹å€¼ä¸º2ï¼Œåˆ™è®¡ç®—è°±èŒƒæ•°1234import numpy as npA = np.array([[0,1,2,3],[4,5,6,7],[8,9,10,11]])print(n)ç¨‹åºè¿è¡Œç»“æœä¸º22æ¡ä»¶æ•°å¦‚æœçŸ©é˜µ$W$å¯é€†ï¼Œæ¡ä»¶æ•°(Condition Number)å®šä¹‰ä¸ºå®ƒçš„èŒƒæ•°ä¸å®ƒçš„é€†çŸ©é˜µèŒƒæ•°çš„ä¹˜ç§¯è¿™é‡Œçš„èŒƒæ•°å¯ä»¥æ˜¯ä»»ä½•ä¸€ç§èŒƒæ•°å¦‚æœä½¿ç”¨è°±èŒƒæ•°ï¼Œåˆ™$|\boldsymbol{W}|$ç­‰äº$\boldsymbol{W}$çš„æœ€å¤§å¥‡å¼‚å€¼ï¼Œ$\left|\boldsymbol{W}^{-1}\right|$ç­‰äº$W$æœ€å°å¥‡å¼‚å€¼çš„é€†ï¼Œæ ¹æ®è°±èŒƒæ•°çš„å®šä¹‰æœ‰ä¸Šå¼ç¬¬äºŒæ­¥è¿›è¡Œäº†æ¢å…ƒï¼Œä»¤$\boldsymbol{W}^{-1} y=x$ï¼Œæ ¹æ®å‰äºŒèŠ‚çš„ç»“è®ºï¼Œ$\frac{|\boldsymbol{W} \boldsymbol{x}|}{|\boldsymbol{x}|}$çš„æœ€å°å¥‡å¼‚å€¼æ­¤æ—¶æ¡ä»¶æ•°ç­‰äºçŸ©é˜µçš„æœ€å¤§å¥‡å¼‚å€¼ä¸æœ€å°å¥‡å¼‚å€¼çš„æ¯”å€¼å…¶ä¸­ä¸ºçš„å¥‡å¼‚å€¼ï¼Œæ˜¾ç„¶çŸ©é˜µçš„æ¡ä»¶æ•°æ€»æ˜¯å¤§äºæˆ–ç­‰äº1æ¡ä»¶æ•°å†³å®šäº†çŸ©é˜µçš„ç¨³å®šæ€§ï¼Œä¸€ä¸ªçŸ©é˜µçš„æ¡ä»¶æ•°è¶Šå¤§ï¼Œåˆ™å®ƒè¶Šæ¥è¿‘äºä¸å¯é€†çŸ©é˜µï¼ŒçŸ©é˜µè¶Šâ€ç—…æ€â€æ¡ä»¶æ•°åœ¨è¯¸å¤šç®—æ³•çš„ç¨³å®šæ€§åˆ†æä¸­æœ‰é‡è¦çš„ä½œç”¨ï¼ŒPythonä¸­linalgçš„condå‡½æ•°å®ç°äº†è®¡ç®—çŸ©é˜µæ¡ä»¶æ•°çš„åŠŸèƒ½12345import numpy as npA = np.array([[1,0,0],[0,1,0],[0,0,5]])c = np.linalg.cond(A)print(c)ç¨‹åºè¿è¡Œç»“æœä¸º$5.0$ï¼Œæ˜¯è¯¥çŸ©é˜µæœ€å¤§ç‰¹å¾å€¼ä¸æœ€å°ç‰¹å¾å€¼çš„æ¯”å€¼ï¼Œåœ¨è¿™é‡Œå¥‡å¼‚å€¼ç­‰äºç‰¹å¾å€¼åº”ç”¨â€”â€”è°±å½’ä¸€åŒ–ä¸è°±æ­£åˆ™åŒ–æ­£åˆ™åŒ–æ­£åˆ™åŒ–æ˜¯æœºå™¨å­¦ä¹ ä¸­å‡è½»è¿‡æ‹Ÿåˆçš„ä¸€ç§æŠ€æœ¯ï¼Œå®ƒè¿«ä½¿æ¨¡å‹çš„å‚æ•°å€¼å¾ˆå°ï¼Œä½¿æ¨¡å‹å˜å¾—æ›´ç®€å•ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç®€å•çš„æ¨¡å‹æœ‰æ›´å¥½çš„æ³›åŒ–æ€§èƒ½æ­£åˆ™åŒ–å¯ä»¥é€šè¿‡åœ¨ç›®æ ‡å‡½æ•°ä¸­å¢åŠ æ­£åˆ™åŒ–é¡¹å®ç°ï¼Œæ­£åˆ™åŒ–é¡¹é€šå¸¸ä¸ºå‚æ•°å‘é‡çš„L1èŒƒæ•°ï¼Œæˆ–L2èŒƒæ•°çš„å¹³æ–¹è°±æ­£åˆ™åŒ–(Spectral Regularization)ç”¨è°±èŒƒæ•°æ„é€ æ­£åˆ™åŒ–é¡¹å¦å¤–ä¸€ç§æŠ€æœ¯æ˜¯è°±å½’ä¸€åŒ–(Spectral Normalization)ï¼Œé€šè¿‡ç”¨è°±èŒƒæ•°å¯¹çº¿æ€§æ˜ å°„çš„çŸ©é˜µè¿›è¡Œè°±å½’ä¸€åŒ–è€Œç¡®ä¿æ˜ å°„æœ‰è¾ƒå°çš„ææ™®å¸ŒèŒ¨å¸¸æ•°ï¼Œä»è€Œä¿è¯æœºå™¨å­¦ä¹ æ¨¡å‹å¯¹è¾“äººæ•°æ®çš„æ‰°åŠ¨ä¸æ•æ„Ÿç¥ç»ç½‘ç»œä¸­ç”¨æƒé‡çŸ©é˜µ$\boldsymbol{W}$ä¸åç½®å‘é‡$\boldsymbol{b}$å¯¹è¾“äººæ•°æ®$\boldsymbol{x}$è¿›è¡Œæ˜ å°„ï¼Œå¾—åˆ°è¾“å‡ºç»“æœ$W x+b$ï¼Œå¦‚æœæ­¤æ˜ å°„æ»¡è¶³ææ™®å¸ŒèŒ¨æ¡ä»¶(è¿™é‡Œå°†å…¶æ¨å¹¿åˆ°å¤šå…ƒå‡½æ•°ï¼Œå°†ç»å¯¹å€¼æ”¹ä¸ºå‘é‡çš„èŒƒæ•°)ï¼Œåˆ™æœ‰å…¶ä¸­$K$ä¸ºææ™®å¸ŒèŒ¨å¸¸æ•°ï¼Œå°†å¼å­å˜å½¢åå¯ä»¥å¾—åˆ°ä¸Šå¼å·¦ä¾§éƒ¨åˆ†çš„æå¤§å€¼å°±æ˜¯æƒé‡çŸ©é˜µçš„è°±èŒƒæ•°å¦‚æœæƒé‡çŸ©é˜µçš„è°±èŒƒæ•°å­˜åœ¨ä¸€ä¸ªè¾ƒå°çš„ä¸Šç•Œï¼Œåˆ™ç¥ç»ç½‘ç»œè¯¥å±‚çš„æ˜ å°„æœ‰è¾ƒå°çš„ææ™®å¸ŒèŒ¨å¸¸æ•°ï¼Œä»è€Œä¿è¯è¾“äººå€¼çš„è¾ƒå°æ”¹å˜ä¸ä¼šå¯¼è‡´è¾“å‡ºå€¼çš„çªå˜ï¼Œæ˜ å°„æ›´ä¸ºå¹³æ»‘å‡è®¾æƒé‡çŸ©é˜µçš„è°±èŒƒæ•°ä¸º$\sigma(\boldsymbol{W})$ï¼Œå¦‚æœç”¨å®ƒå¯¹çŸ©é˜µè¿›è¡Œå½’ä¸€åŒ–åˆ™èƒ½ä¿è¯å½’ä¸€åŒ–ä¹‹åçš„æƒé‡çŸ©é˜µæ»¡è¶³$\sigma(\boldsymbol{W})=1$ï¼Œè¿™ç”±çŸ©é˜µä¹˜ä»¥å¸¸æ•°ä¹‹åçš„ç‰¹å¾å€¼çš„æ€§è´¨ä¿è¯å‰ä¸¤èŠ‚å·²ç»è¯æ˜è°±èŒƒæ•°æ˜¯çŸ©é˜µ$W$çš„æœ€å¤§å¥‡å¼‚å€¼ï¼Œè®¡ç®—çŸ©é˜µå¥‡å¼‚å€¼çš„ä»£ä»·å¤ªå¤§ï¼Œå› æ­¤åœ¨å®ç°æ—¶éœ€è¦å¯¹è°±èŒƒæ•°$\sigma(\boldsymbol{W})$çš„å€¼è¿‘ä¼¼è®¡ç®—ï¼Œå¯ä»¥é‡‡ç”¨å¹‚è¿­ä»£æ³•æ¥ä¸‹æ¥è€ƒè™‘å¦‚ä½•ç”¨è°±èŒƒæ•°ä¸ºç¥ç»ç½‘ç»œçš„ç›®æ ‡å‡½æ•°æ„é€ æ­£åˆ™åŒ–é¡¹(Spectral Norm Regularizer)ç»™å®šè®­ç»ƒæ ·æœ¬é›†ä¸ºè¾“äººå‘é‡ï¼Œä¸ºæ ‡ç­¾å‘é‡ï¼ŒåŠ ä¸Šè°±æ­£åˆ™åŒ–é¡¹åçš„ç›®æ ‡å‡½æ•°ä¸ºå…¶ä¸­ä¸ºå¯¹å•ä¸ªæ ·æœ¬çš„æŸå¤±å‡½æ•°ï¼Œä¸ºç¥ç»ç½‘ç»œçš„å±‚æ•°ï¼Œä¸ºç¬¬å±‚çš„æƒé‡çŸ©é˜µä¸Šå¼ç¬¬2é¡¹ä¸ºè°±æ­£åˆ™åŒ–é¡¹ï¼Œ$\lambda&gt;0$ä¸ºæ­£åˆ™åŒ–é¡¹çš„æƒé‡ï¼Œè°±æ­£åˆ™åŒ–é¡¹ç”±ç¥ç»ç½‘ç»œæ‰€æœ‰å±‚æƒé‡çŸ©é˜µçš„è°±èŒƒæ•°å¹³æ–¹ä¹‹å’Œæ„æˆå¯ä»¥é˜²æ­¢æƒé‡çŸ©é˜µå‡ºç°å¤§çš„è°±èŒƒæ•°ï¼Œä»è€Œä¿è¯ç¥ç»ç½‘ç»œçš„æ˜ å°„æœ‰è¾ƒå°çš„ææ™®å¸ŒèŒ¨å¸¸æ•°äºŒæ¬¡å‹äºŒæ¬¡å‹æ˜¯ä¸€ç§ç‰¹æ®Šçš„äºŒæ¬¡å‡½æ•°ï¼Œåªå«æœ‰äºŒæ¬¡é¡¹ï¼Œå®ƒåœ¨çº¿æ€§ä»£æ•°ä¸å¤šå…ƒå‡½æ•°å¾®ç§¯åˆ†ä¸­è¢«å¹¿æ³›ä½¿ç”¨åœ¨æœºå™¨å­¦ä¹ ä¸­äºŒæ¬¡å‹ç»å¸¸ä½œä¸ºç›®æ ‡å‡½æ•°å‡ºç°åŸºæœ¬æ¦‚å¿µäºŒæ¬¡å‹(Quadric Form) æ˜¯ç”±çº¯äºŒæ¬¡é¡¹æ„æˆçš„å‡½æ•°ï¼Œå³äºŒæ¬¡é½æ¬¡å¤šé¡¹å¼ï¼Œå¦‚ä¸‹é¢çš„å‡½æ•°äºŒæ¬¡å‹å¯ä»¥å†™æˆçŸ©é˜µå½¢å¼å…¶ä¸­$\boldsymbol{A}$æ˜¯$n$é˜¶å¯¹ç§°çŸ©é˜µï¼Œ$\boldsymbol{x}$æ˜¯ä¸€ä¸ªåˆ—å‘é‡ï¼Œä¸Šé¢çš„äºŒæ¬¡å‹å±•å¼€ä¹‹åä¸ºè¿™é‡Œè¦æ±‚ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸€èˆ¬çš„äºŒæ¬¡å‡½æ•°ä¸ä¸€å®šæ˜¯äºŒæ¬¡å‹ï¼Œå®ƒå¯èƒ½æœ‰ä¸€æ¬¡é¡¹å’Œå¸¸æ•°é¡¹ä¸Šå¼çš„äºŒæ¬¡å‹å¯¹åº”çš„çŸ©é˜µä¸ºå¹³æ–¹é¡¹çš„ç³»æ•°æ˜¯çŸ©é˜µçš„ä¸»å¯¹è§’çº¿å…ƒç´ ï¼Œäº¤å‰ä¹˜ç§¯é¡¹çš„ç³»æ•°ç”±ä¸å‡åˆ†ï¼Œå®å¯¹ç§°çŸ©é˜µä¸äºŒæ¬¡å‹ä¸€ä¸€å¯¹åº”æ­£å®šäºŒæ¬¡å‹ä¸æ­£å®šçŸ©é˜µåœ¨æŸäº›æ•°å­¦è¯æ˜æˆ–è®¡ç®—ä¸­ï¼Œä¼šå°†äºŒæ¬¡å‡½æ•°é…æ–¹æˆå®Œå…¨å¹³æ–¹çš„å½¢å¼ä»¥å¾—åˆ°æƒ³è¦çš„ç»“æœï¼Œå¦‚ä¸‹é¢çš„ä¾‹å­å¹³æ–¹é¡¹æ˜¯éè´Ÿçš„ï¼Œ$(2,-5,7)$æ˜¯è¯¥å‡½æ•°çš„æå°å€¼ï¼Œç”±æ­¤å¼•å…¥äºŒæ¬¡å‹å’ŒçŸ©é˜µæ­£å®šçš„æ¦‚å¿µï¼Œå¦‚æœä¸€ä¸ªäºŒæ¬¡å‹å¯¹äºä»»æ„é$\boldsymbol{0}$å‘é‡$\boldsymbol{x}$éƒ½æœ‰åˆ™ç§°è¯¥äºŒæ¬¡å‹ä¸ºæ­£å®š(Positive Definite)äºŒæ¬¡å‹ï¼ŒçŸ©é˜µ$\boldsymbol{A}$ä¸ºæ­£å®šçŸ©é˜µï¼Œå¦‚æœå¯¹äºä»»æ„é$\boldsymbol{0}$å‘é‡$\boldsymbol{x}$éƒ½æœ‰åˆ™è¯¥äºŒæ¬¡å‹ä¸ºåŠæ­£å®š(Positive Semi-definite)äºŒæ¬¡å‹ï¼ŒçŸ©é˜µ$\boldsymbol{A}$ä¸ºåŠæ­£å®šçŸ©é˜µï¼Œå¦‚æœå¯¹äºä»»æ„é0å‘é‡$\boldsymbol{x}$éƒ½åœ¨åˆ™è¯¥äºŒæ¬¡å‹ä¸ºè´Ÿå®š(Negative Definite)äºŒæ¬¡å‹ï¼ŒçŸ©é˜µ$A$ä¸ºè´Ÿå®šçŸ©é˜µï¼Œç±»ä¼¼åœ°å¯ä»¥å®šä¹‰åŠè´Ÿå®šçš„æ¦‚å¿µå¦‚æœæ—¢ä¸æ­£å®šä¹Ÿä¸è´Ÿå®šï¼Œåˆ™ç§°ä¸ºä¸å®šä¸‹é¢çš„äºŒæ¬¡å‹ä¸ºæ­£å®šäºŒæ¬¡å‹å…¶å¯¹åº”çš„çŸ©é˜µä¸ºæ­£å®šçŸ©é˜µä¸‹é¢çš„äºŒæ¬¡å‹ä¸ºåŠæ­£å®šäºŒæ¬¡å‹å…¶å¯¹åº”çš„çŸ©é˜µä¸ºåŠæ­£å®šçŸ©é˜µå¦‚æœä»¤ï¼ŒäºŒæ¬¡å‹çš„å€¼ä¸º0ä¸‹é¢çš„äºŒæ¬¡å‹æ˜¯è´Ÿå®šäºŒæ¬¡å‹å…¶å¯¹åº”çš„çŸ©é˜µä¸ºè´Ÿå®šçŸ©é˜µæ­£å®šäºŒæ¬¡å‹è¢«ç”¨äºå¤šå…ƒå‡½æ•°æå€¼çš„åˆ¤å®šæ³•åˆ™æ­£å®šçŸ©é˜µçš„æ‰€æœ‰ä¸»å¯¹è§’çº¿å…ƒç´ $a_{i i}&gt;0ï¼Œi=1ï¼Œ\cdotsï¼Œn$æ ¹æ®æ­£å®šçš„å®šä¹‰ï¼Œç”±äºå¯¹äºä»»æ„é0å‘é‡$\boldsymbol{x}$éƒ½æœ‰$\boldsymbol{x}^{\mathrm{T}} \boldsymbol{A} \boldsymbol{x}&gt;0$ï¼Œå› æ­¤å¯ä»¥æ„é€ ä¸€ä¸ªç¬¬$i$ä¸ªåˆ†é‡ä¸º1ï¼Œå…¶ä»–åˆ†é‡å‡ä¸º0çš„å‘é‡$\boldsymbol{x}$åˆ™æœ‰å› æ­¤ç»“è®ºæˆç«‹è¯æ˜ä¸€ä¸ªå¯¹ç§°çŸ©é˜µ$\boldsymbol{A}$æ­£å®šå¯ä»¥æŒ‰ç…§å®šä¹‰è¿›è¡Œï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥é‡‡ç”¨ä¸‹é¢çš„æ–¹æ³•çŸ©é˜µçš„ä¸ªç‰¹å¾å€¼å‡å¤§äº0å­˜åœ¨å¯é€†çŸ©é˜µ$\boldsymbol{P}$ä½¿å¾—$\boldsymbol{A}=\boldsymbol{P}^{\mathrm{T}} \boldsymbol{P}$å¦‚æœ$\boldsymbol{A}$æ˜¯æ­£å®šçŸ©é˜µï¼Œåˆ™$\boldsymbol{A}^{\mathrm{T}}$ä¹Ÿæ˜¯æ­£å®šçŸ©é˜µçŸ©é˜µ$\boldsymbol{A}$çš„æ‰€æœ‰é¡ºåºä¸»å­å¼å‡ä¸ºæ­£ç¬¬ä¸€æ¡åˆ¤å®šè§„åˆ™å¯ä»¥é€šè¿‡æ­£äº¤å˜æ¢å°†äºŒæ¬¡å‹åŒ–ä¸ºæ ‡å‡†å‹è¯æ˜ï¼ŒåŒ–ä¸ºæ ‡å‡†å‹(å¯¹åº”äºå¯¹è§’çŸ©é˜µ)ä¹‹åä¸ºæ­£å®šäºŒæ¬¡å‹ä¸‹é¢è¯æ˜ç¬¬2æ¡åˆ¤å®šè§„åˆ™ï¼Œå¯¹äºä»»æ„æ›²$\boldsymbol{\theta}$å‘é‡$\boldsymbol{x}$åœ¨å› ä¸º$P$å¯é€†ï¼Œå¯¹äºä»»æ„é$\boldsymbol{0}$å‘é‡$\boldsymbol{x}$æœ‰$\boldsymbol{P x} \neq \mathbf{0}$ä¸‹é¢è¯æ˜ç¬¬3æ¡åˆ¤å®šè§„åˆ™ï¼Œå¦‚æœ$A$æ˜¯æ­£å®šçŸ©é˜µï¼Œå¯¹äºä»»æ„é0å‘é‡$x$éƒ½æœ‰$x^{\mathrm{T}} A \boldsymbol{x}&gt;0$ï¼Œå¯¹äºä»»æ„é$\boldsymbol{0}$å‘é‡$\boldsymbol{x}$æœ‰å¯¹äº$n$é˜¶çŸ©é˜µ$A$å…¶å‰$k, 1 \leqslant k \leqslant n$è¡Œå‰$k$åˆ—å…ƒç´ å½¢æˆçš„è¡Œåˆ—å¼ç§°ä¸ºé¡ºåºä¸»å­å¼ï¼Œè¿™æ˜¯çŸ©é˜µå·¦ä¸Šè§’çš„å­æ–¹é˜µå½¢æˆçš„è¡Œåˆ—å¼ï¼Œå¯¹äºä¸‹é¢çš„4é˜¶çŸ©é˜µå…¶1é˜¶é¡ºåºä¸»å­å¼ä¸º2é˜¶é¡ºåºä¸»å­å¼ä¸º3é˜¶é¡ºåºä¸»å­å¼ä¸º4é˜¶é¡ºåºä¸»å­å¼ä¸ºçŸ©é˜µ$A$ä¸æ˜¯æ­£å®šçš„ï¼Œå› ä¸ºå…¶äºŒé˜¶é¡ºåºä¸»å­å¼ä¸ºè´Ÿå¯¹äºä»»æ„çš„$m \times n$çŸ©é˜µ$\boldsymbol{A}$ï¼Œ$\boldsymbol{A}^{\mathrm{T}} \boldsymbol{A}$æ˜¯å¯¹ç§°åŠæ­£å®šçŸ©é˜µï¼Œä¸‹é¢ç»™å‡ºè¯æ˜ï¼Œæ˜¾ç„¶è¯¥çŸ©é˜µæ˜¯å¯¹ç§°çš„å¯¹äºä»»æ„é$\boldsymbol{0}$å‘é‡$\boldsymbol{x}$ï¼Œæœ‰ç±»ä¼¼åœ°å¯ä»¥è¯æ˜$\boldsymbol{A A ^ { \mathrm { T } }}$ä¹Ÿæ˜¯å¯¹ç§°åŠæ­£å®šçŸ©é˜µåœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œè¿™ç§çŸ©é˜µç»å¸¸å‡ºç°ï¼Œå¦‚å‘é‡ç»„çš„æ ¼æ‹‰å§†çŸ©é˜µï¼ŒåŒ…æ‹¬çº¿æ€§å›å½’ã€æ”¯æŒå‘é‡æœºä»¥åŠlogisticå›å½’ç­‰çº¿æ€§æ¨¡å‹å®ƒä»¬ç›®æ ‡å‡½æ•°çš„é»‘å¡çŸ©é˜µä¸ºè¿™ç§ç±»å‹çš„çŸ©é˜µï¼Œå› æ­¤æ˜¯å‡¸å‡½æ•°ï¼Œå¯ä»¥ä¿è¯æ±‚å¾—å…¨å±€æå°å€¼ç‚¹ç±»ä¼¼åœ°ï¼Œå®å¯¹ç§°çŸ©é˜µè´Ÿå®šå¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹æ³•è¿›è¡Œåˆ¤å®šçŸ©é˜µçš„ä¸ªç‰¹å¾å€¼å‡å°äº0å­˜åœ¨å¯é€†çŸ©é˜µ$\boldsymbol{P}$ä½¿å¾—$\boldsymbol{A}=-\boldsymbol{P}^{\mathrm{T}} \boldsymbol{P}$çŸ©é˜µ$A$çš„æ‰€æœ‰å¥‡æ•°é˜¶é¡ºåºä¸»å­å¼å‡ä¸ºè´Ÿï¼Œå¶æ•°é˜¶é¡ºåºä¸»å­å¼å‡ä¸ºæ­£æ ‡å‡†å‹æ ‡å‡†å‹æŒ‡å¯¹äºä»»æ„çš„ï¼ŒäºŒæ¬¡å‹ä¸­é¡¹çš„ç³»æ•°å‡ä¸º0ï¼ŒäºŒæ¬¡å‹ç”±çº¯å¹³æ–¹é¡¹æ„æˆï¼Œå¯å†™æˆå¦‚ä¸‹å½¢å¼ä¸‹é¢æ˜¯ä¸€ä¸ªæ ‡å‡†å‹æ ‡å‡†å‹å¯¹åº”çš„çŸ©é˜µä¸ºå¯¹è§’çŸ©é˜µï¼Œä¸Šé¢çš„æ ‡å‡†å‹å¯¹åº”çš„çŸ©é˜µä¸ºåœ¨æ ‡å‡†å‹ä¸­ï¼Œæ­£å¹³æ–¹é¡¹çš„æ•°é‡ç§°ä¸ºæ­£æƒ¯æ€§æŒ‡æ•°ï¼Œè´Ÿå¹³æ–¹é¡¹çš„æ•°é‡ç§°ä¸ºè´Ÿæƒ¯æ€§æŒ‡æ•°ä¸Šé¢çš„æ ‡å‡†å‹çš„æ­£æƒ¯æ€§æŒ‡æ•°ä¸º2ï¼Œè´Ÿæƒ¯æ€§æŒ‡æ•°ä¸º1ç”±äºäºŒæ¬¡å‹çš„çŸ©é˜µä¸ºå¯¹ç§°çŸ©é˜µï¼Œå› æ­¤ä¸€å®šå¯ä»¥å¯¹è§’åŒ–é€šè¿‡æ­£äº¤å˜æ¢å¯ä»¥å°†äºŒæ¬¡å‹åŒ–ä¸ºæ ‡å‡†å‹ï¼Œä¸å®å¯¹ç§°çŸ©é˜µçš„æ­£äº¤å˜æ¢å¯¹è§’åŒ–ç›¸åŒå¯¹äºäºŒæ¬¡å‹$x^{\mathrm{T}} A \boldsymbol{x}$ï¼Œé€šè¿‡æ­£äº¤å˜æ¢å°†$A$åŒ–ä¸ºå¯¹è§’çŸ©é˜µä»è€Œæœ‰è¿™é‡Œ$\boldsymbol{P}$æ˜¯æ­£äº¤çŸ©é˜µï¼Œå¦‚æœä»¤$\boldsymbol{y}=\boldsymbol{P}^{\mathrm{T}} \boldsymbol{x}$æˆ–è€…$\boldsymbol{x}=\boldsymbol{P} \boldsymbol{y}$ï¼Œåˆ™$\boldsymbol{y}^{\mathrm{T}} \boldsymbol{A} \boldsymbol{y}$æ˜¯æ ‡å‡†å‹è¿™å¯¹åº”äºé€šè¿‡å°†$\boldsymbol{x}$æ¢å…ƒä¸º$y$ï¼Œä½¿å¾—æ¢å…ƒä¹‹åçš„äºŒæ¬¡å‹ä¸ºæ ‡å‡†å‹å¦‚æœçŸ©é˜µçš„ä¸ªç‰¹å¾å€¼å‡å¤§äº0ï¼Œåˆ™çŸ©é˜µæ­£å®šå¯¹äºä»»æ„é0å‘é‡$x$ï¼Œç”±äº$P$æ˜¯æ­£äº¤çŸ©é˜µï¼Œ$y=P^{\mathrm{T}} x \neq 0$ï¼Œå› æ­¤$A$æ­£å®šä¸‹é¢ä¸¾ä¾‹è¯´æ˜ï¼Œå¯¹äºä¸‹é¢çš„äºŒæ¬¡å‹å…¶å¯¹åº”çš„ç³»æ•°çŸ©é˜µä¸ºç‰¹å¾å¤šé¡¹å¼ä¸ºè§£å¾—ç‰¹å¾å€¼ä¸º$0,5,6$å½“$\lambda=5$æ—¶ï¼Œæœ‰æ–¹ç¨‹$(A-\lambda I) x=0$çš„è§£ä¸ºå½“$\lambda=6$æ—¶ï¼Œæœ‰æ–¹ç¨‹$(A-\lambda I) x=0$çš„è§£ä¸ºå½“$\lambda=0$æ—¶ï¼Œæœ‰æ–¹ç¨‹$(A-\lambda I) x=0$çš„è§£ä¸ºç”±äºäºŒæ¬¡å‹çš„ç³»æ•°çŸ©é˜µæ˜¯å®å¯¹ç§°çŸ©é˜µï¼Œå…¶ä¸åŒç‰¹å¾å€¼å¯¹åº”çš„ç‰¹å¾å‘é‡ç›¸äº’æ­£äº¤ï¼Œå› æ­¤åªéœ€è¦å°†è¿™äº›ç‰¹å¾å‘é‡å•ä½åŒ–å³å¯ä»¤é€šè¿‡æ­£äº¤å˜æ¢$x=\boldsymbol{P y}$å¯å°†äºŒæ¬¡å‹åŒ–ä¸ºå¦‚ä¸‹çš„æ ‡å‡†å‹çŸ©é˜µåˆ†è§£çŸ©é˜µåˆ†è§£æ˜¯çŸ©é˜µåˆ†æçš„é‡è¦å†…å®¹ï¼Œè¿™ç§æŠ€æœ¯å°†ä¸€ä¸ªçŸ©é˜µåˆ†è§£ä¸ºè‹¥å¹²çŸ©é˜µçš„ä¹˜ç§¯ï¼Œé€šå¸¸ä¸º2ä¸ªæˆ–3ä¸ªçŸ©é˜µçš„ä¹˜ç§¯åœ¨æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„ï¼Œè®¡ç®—é€†çŸ©é˜µã€è¡Œåˆ—å¼ä»¥åŠç‰¹å¾å€¼ï¼Œå¤šé‡ç§¯åˆ†æ¢å…ƒç­‰é—®é¢˜ä¸Šï¼ŒçŸ©é˜µåˆ†è§£æœ‰å¹¿æ³›çš„åº”ç”¨æ¥šåˆ—æ–¯åŸºåˆ†è§£å¯¹äº$n$é˜¶å¯¹ç§°åŠæ­£å®šçŸ©é˜µ$\boldsymbol{A}$ï¼Œæ¥šåˆ—æ–¯åŸº(Cholesky)åˆ†è§£å°†å…¶åˆ†è§£ä¸º$n$é˜¶ä¸‹ä¸‰è§’çŸ©é˜µ$L$ä»¥åŠå…¶è½¬ç½®$L^{\mathrm{T}}$çš„ä¹˜ç§¯å¦‚æœ$A$æ˜¯å®å¯¹ç§°æ­£å®šçŸ©é˜µï¼Œåˆ™ä¸Šå¼çš„åˆ†è§£å”¯ä¸€ä¸‹é¢æ˜¯å¯¹ç§°çŸ©é˜µæ¥šåˆ—æ–¯åŸºåˆ†è§£çš„ä¸€ä¸ª ä¾‹å­æ¥šåˆ—æ–¯åŸºåˆ†è§£å¯ç”¨äºæ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„ï¼Œå¯¹äºå¦‚ä¸‹çš„çº¿æ€§æ–¹ç¨‹ç»„å¦‚æœ$A$æ˜¯å¯¹ç§°æ­£å®šçŸ©é˜µï¼Œå®ƒå¯ä»¥åˆ†è§£ä¸º$L L^{\mathrm{T}}$ï¼Œåˆ™æœ‰å¦‚æœä»¤åˆ™å¯å…ˆæ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„å¾—åˆ°$y$ã€‚ç„¶åæ±‚è§£å¾—åˆ°$x$ï¼Œè¿™ä¸¤ä¸ªæ–¹ç¨‹ç»„çš„ç³»æ•°çŸ©é˜µåˆ†åˆ«ä¸ºä¸‹ä¸‰è§’å’Œä¸Šä¸‰è§’çŸ©é˜µï¼Œå‡å¯é«˜æ•ˆåœ°æ±‚è§£åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¦‚æœç³»æ•°çŸ©é˜µ$A$ä¸å˜è€Œå¸¸æ•°å‘é‡$b$ä¼šæ”¹å˜ï¼Œåˆ™é¢„å…ˆå°†$A$è¿›è¡Œæ¥šåˆ—æ–¯åŸºåˆ†è§£ï¼Œæ¯æ¬¡å¯¹äºä¸åŒçš„$b$å‡å¯é«˜æ•ˆåœ°æ±‚è§£åœ¨æ±‚è§£æœ€ä¼˜åŒ–é—®é¢˜çš„æ‹Ÿç‰›é¡¿æ³•ä¸­ï¼Œéœ€è¦æ±‚è§£å¦‚ä¸‹çš„æ–¹ç¨‹ç»„å…¶ä¸­ä¸ºç¬¬æ¬¡è¿­ä»£æ—¶çš„é»‘å¡(Hessian)çŸ©é˜µçš„è¿‘ä¼¼çŸ©é˜µï¼Œä¸ºç‰›é¡¿æ–¹å‘ï¼Œä¸ºç¬¬æ¬¡è¿­ä»£æ—¶çš„æ¢¯åº¦å€¼æ­¤æ–¹ç¨‹å¯ä»¥ä½¿ç”¨æ¥šåˆ—æ–¯åŸºåˆ†è§£æ±‚è§£æ¥šåˆ—æ–¯åŸºåˆ†è§£è¿˜å¯ä»¥ç”¨äºæ£€æŸ¥çŸ©é˜µçš„æ­£å®šæ€§å¯¹ä¸€ä¸ªçŸ©é˜µè¿›è¡Œæ¥šåˆ—æ–¯åŸºåˆ†è§£ï¼Œå¦‚æœåˆ†è§£å¤±è´¥ï¼Œåˆ™è¯´æ˜çŸ©é˜µä¸æ˜¯åŠæ­£å®šçŸ©é˜µï¼›å¦åˆ™ä¸ºåŠæ­£å®šçŸ©é˜µä¸‹é¢ä»¥3é˜¶çŸ©é˜µä¸ºä¾‹æ¨å¯¼æ¥šåˆ—æ–¯åŸºåˆ†è§£çš„è®¡ç®—å…¬å¼ï¼Œå¦‚æœåˆ™æœ‰é¦–å…ˆå¯ä»¥å¾—åˆ°ä¸»å¯¹è§’çš„ç¬¬ä¸€ä¸ªå…ƒç´ æ ¹æ®$l_{11}$å¯ä»¥å¾—åˆ°ç¬¬2è¡Œçš„æ‰€æœ‰å…ƒç´ è¿›ä¸€æ­¥å¾—åˆ°ç¬¬3è¡Œçš„å…ƒç´ æ‰€æœ‰å…ƒç´ é€è¡Œç®—å‡ºï¼Œé¦–å…ˆè®¡ç®—å‡ºç¬¬1è¡Œçš„å…ƒç´ ï¼Œç„¶åè®¡ç®—ç¬¬2è¡Œçš„å…ƒç´ ï¼Œæ¥ä¸‹æ¥è®¡ç®—ï¼Œä¾æ­¤ç±»æ¨è¿™é‡Œä¸æœ‰å…³ï¼Œè¿™äº›å€¼å·²ç»è¢«ç®—å‡ºå¯¹äº$n$é˜¶çŸ©é˜µï¼Œæ¥šåˆ—æ–¯åŸºåˆ†è§£çš„è®¡ç®—å…¬å¼ä¸ºPythonä¸­linalgçš„choleskyå‡½æ•°å®ç°äº†å¯¹ç§°æ­£å®šçŸ©é˜µçš„æ¥šåˆ—æ–¯åŸºåˆ†è§£å‡½æ•°çš„è¾“å…¥æ˜¯è¢«åˆ†è§£çŸ©é˜µ$\boldsymbol{A}$ï¼Œè¾“å‡ºä¸ºä¸‹ä¸‰è§’çŸ©é˜µ$\boldsymbol{L}$12345import numpy as npA = np.array([[6,3,4,8],[3,6,5,1],[4,5,10,7],[8,1,7,25]])L = np.1inalg.cholesky(A)print(L)ç¨‹åºè¾“å‡ºç»“æœä¸º1234[[2.44948974  0.0         0.0         0.0 ], [1.22474487  2.12132034  0.0         0.0], [1.63299316  1.41421356  2.30940108  0.0], [3.26598632  -1.41421356 1.58771324  3.13249102]]å¯ä»¥éªŒè¯çŸ©é˜µ$\boldsymbol{L}$ä¸å…¶è½¬ç½®çš„ä¹˜ç§¯å³ä¸ºçŸ©é˜µ$\boldsymbol{A}$QR åˆ†è§£QRåˆ†è§£(æ­£äº¤ä¸‰è§’åˆ†è§£)å°†çŸ©é˜µåˆ†è§£ä¸ºæ­£äº¤çŸ©é˜µä¸ä¸Šä¸‰è§’çŸ©é˜µçš„ä¹˜ç§¯ï¼Œè¿™ç§åˆ†è§£è¢«å¹¿æ³›åœ°åº”ç”¨äºæ±‚è§£æŸäº›é—®é¢˜ï¼Œå¦‚çŸ©é˜µçš„ç‰¹å¾å€¼äº‹å®ä¸Šï¼Œ$\mathrm{QR}$åˆ†è§£æ˜¯æ ¼æ‹‰å§†-æ–½å¯†ç‰¹æ­£äº¤åŒ–çš„å¦å¤–ä¸€ç§è¡¨ç°å½¢å¼é¦–å…ˆè€ƒè™‘æ–¹é˜µçš„æƒ…å†µï¼Œå¯¹äºä»»æ„çš„$n$é˜¶æ–¹é˜µ$\boldsymbol{A}$ï¼Œ$\mathrm{QR}$åˆ†è§£å°†å…¶åˆ†è§£ä¸ºä¸€ä¸ª$n$é˜¶æ­£äº¤çŸ©é˜µ$\boldsymbol{Q}$ä¸ä¸€ä¸ª$n$é˜¶ä¸Šä¸‰è§’çŸ©é˜µ$\boldsymbol{R}$çš„ä¹˜ç§¯å¦‚æœçŸ©é˜µ$\boldsymbol{A}$å¯é€†ä¸”è¦æ±‚çŸ©é˜µ$\boldsymbol{R}$çš„ä¸»å¯¹è§’å…ƒä¸ºæ­£ï¼Œåˆ™ä¸Šå¼çš„åˆ†è§£å”¯ä¸€å¦‚æœ$\boldsymbol{A}$æœ‰$m(m \leqslant n$) ä¸ªçº¿æ€§æ— å…³çš„åˆ—ï¼Œåˆ™$\boldsymbol{Q}$çš„å‰$m$ä¸ªåˆ—æ„æˆ$\boldsymbol{A}$çš„åˆ—ç©ºé—´çš„æ ‡å‡†æ­£äº¤åŸºä¸‹é¢æ¥çœ‹$\mathrm{QR}$åˆ†è§£çš„å®é™…ä¾‹å­ï¼Œå¯¹äºå¦‚ä¸‹çŸ©é˜µå…¶$\mathrm{QR}$åˆ†è§£çš„ç»“æœä¸ºä¸‹é¢è€ƒè™‘éæ–¹é˜µçš„æƒ…å†µï¼Œå¯¹äº$m \times n, m&gt;n$çš„çŸ©é˜µ$\boldsymbol{A}$ï¼ŒQR åˆ†è§£å°†å…¶åˆ†è§£ä¸ºä¸€ä¸ª$m$é˜¶æ­£äº¤çŸ©é˜µä¸å¦‚ä¸‹å½¢å¼çš„$m \times n$çŸ©é˜µ$\boldsymbol{R}$çš„ä¹˜ç§¯å…¶ä¸­$\boldsymbol{R}_{n}$æ˜¯$n$é˜¶ä¸Šä¸‰è§’çŸ©é˜µï¼Œ$\boldsymbol{0}$æ˜¯ä¸€ä¸ª$(m-n) \times n$çš„é›¶çŸ©é˜µã€‚ å¦‚æœ$m&lt;n$, åˆ™åˆ†è§£çš„ç»“æœä¸ºå…¶ä¸­$\boldsymbol{Q}$æ˜¯ä¸€ä¸ª$m$é˜¶æ­£äº¤çŸ©é˜µï¼Œæ˜¯é˜¶ä¸Šä¸‰è§’çŸ©é˜µï¼Œæ˜¯ä¸€ä¸ªçš„çŸ©é˜µ$\mathrm{QR}$åˆ†è§£æœ‰ 3 ç§å®ç°æ–¹å¼åˆ†åˆ«æ˜¯æ ¼æ‹‰å§†-æ–½å¯†ç‰¹æ­£äº¤åŒ–ã€è±ªæ–¯éœå°”å¾·å˜æ¢ä»¥åŠå‰æ–‡æ–¯(Givens)æ—‹è½¬ä¸‹é¢ä»‹ç»æ ¼æ‹‰å§†-æ–½å¯†ç‰¹æ­£äº¤åŒ–ä»¥åŠè±ªæ–¯éœå°”å¾·å˜æ¢è€ƒè™‘$A$ä¸º$n$é˜¶æ–¹é˜µçš„æƒ…å†µï¼Œä½¿ç”¨æ ¼æ‹‰å§†-æ–½å¯†ç‰¹æ­£äº¤åŒ–æŠ€æœ¯å¯¹çŸ©é˜µ$A$çš„åˆ—è¿›è¡Œæ­£äº¤åŒ–ï¼Œå°†çŸ©é˜µ$\boldsymbol{A}$æŒ‰åˆ—åˆ†å—å‡è®¾è¿™äº›åˆ—å‘é‡çº¿æ€§æ— å…³ï¼Œé¦–å…ˆå°†å®ƒçš„åˆ—æ­£äº¤åŒ–ç„¶åè¿›è¡Œå•ä½åŒ–$A$çš„å„ä¸ªåˆ—å‘é‡åœ¨æ ‡å‡†æ­£äº¤åŸºä¸‹çš„åæ ‡ä¸ºå…¶åœ¨å„ä¸ªåŸºå‘é‡ä¸Šçš„æŠ•å½±ï¼Œç”±äºåœ¨è¿›è¡Œæ ¼æ‹‰å§†-æ–½å¯†ç‰¹æ­£äº¤åŒ–æ—¶åªä¸æœ‰å…³å› æ­¤åœ¨æ–¹å‘çš„æŠ•å½±å‡ä¸º0ï¼Œæœ‰å†™æˆçŸ©é˜µå½¢å¼ä¸ºä»¤ï¼Œä»¥åŠ$Q$çš„åˆ—æ˜¯ç”¨$A$çš„åˆ—æ„é€ çš„æ ‡å‡†æ­£äº¤åŸºï¼Œ$R$çš„ç¬¬$i$åˆ—ä¸º$\boldsymbol{A}$çš„ç¬¬$i$åˆ—åœ¨å‰$i$ä¸ªåŸºå‘é‡æ–¹å‘çš„æŠ•å½±ï¼Œæ­¤å³$Q R$åˆ†è§£ç»“æœä¾‹å­ä¸‹é¢ä¸¾ä¾‹è¯´æ˜ï¼Œå¯¹äºå¦‚ä¸‹çš„çŸ©é˜µé¦–å…ˆå¯¹å®ƒçš„åˆ—å‘é‡è¿›è¡Œæ­£äº¤åŒ–ï¼Œå¾—åˆ°å¦‚ä¸‹çŸ©é˜µç„¶åå°†è¯¥çŸ©é˜µçš„åˆ—å•ä½åŒ–ï¼Œå¯ä»¥å¾—åˆ°ç”±æ­¤å¯ä»¥å¾—åˆ°ä¸Šä¸‰è§’çŸ©é˜µç”¨è±ªæ–¯éœå°”å¾·å˜æ¢è¿›è¡Œ$Q R$åˆ†è§£çš„æ€è·¯ä¸ä¹‹å‰è®²è¿°çš„ç±»ä¼¼ï¼Œé¦–å…ˆç”¨çŸ©é˜µ$A$çš„ç¬¬1åˆ—æ„é€ ç¬¬1ä¸ªè±ªæ–¯éœå°”å¾·çŸ©é˜µ$\boldsymbol{P}_{1}$å·¦ä¹˜è¯¥çŸ©é˜µå°†$\boldsymbol{A}$çš„ç¬¬1åˆ—åé¢$n-1$ä¸ªå…ƒç´ å…¨éƒ¨é›¶åŒ–æ¥ä¸‹æ¥æ„é€ ç¬¬2ä¸ªè±ªæ–¯éœå°”å¾·çŸ©é˜µ$P_{2}$ï¼Œä¸ºå¦‚ä¸‹å½¢å¼å…¶ä¸­ä½¿ç”¨çš„ç¬¬2åˆ—çš„åé¢ä¸ªå…ƒç´ æ„é€ ï¼Œå°†å·¦ä¹˜ï¼Œå¯ä»¥å°†å…¶ç¬¬2åˆ—åé¢ä¸ªå…ƒç´ é›¶åŒ–æ„é€ ç¬¬3ä¸ªè±ªæ–¯éœå°”å¾·çŸ©é˜µ$\boldsymbol{P}_{3}$ï¼Œä¸ºå¦‚ä¸‹å½¢å¼å…¶ä¸­ç”¨çš„ç¬¬3åˆ—çš„åé¢ä¸ªå…ƒç´ æ„é€ ï¼Œå°†å·¦ä¹˜ï¼Œå¯ä»¥å°†å…¶ç¬¬3åˆ—åé¢ä¸ªå…ƒç´ é›¶åŒ–ä¾æ­¤ç±»æ¨ï¼Œç»è¿‡$n-1$æ¬¡è±ªæ–¯éœå°”å¾·å˜æ¢ï¼Œå¯ä»¥å°†$\boldsymbol{A}$åŒ–ä¸ºä¸Šä¸‰è§’çŸ©é˜µä»¤ç”±äº$P_{0}, i=1, \cdots, n-1$éƒ½æ˜¯æ­£äº¤çŸ©é˜µï¼Œå› æ­¤$Q$ä¹Ÿæ˜¯ä¸€ä¸ªæ­£äº¤çŸ©é˜µï¼Œè¿™å°±æ˜¯$\mathrm{QR}$åˆ†è§£çš„ç»“æœ$\mathrm{QR}$åˆ†è§£å¯ä»¥ç”±Pythonä¸­linalgçš„qrå‡½æ•°å®ç°ï¼Œå‡½æ•°çš„è¾“å…¥ä¸ºè¢«åˆ†è§£çŸ©é˜µ$A$ï¼Œè¾“å‡ºä¸ºæ­£äº¤çŸ©é˜µ$Q$å’Œä¸Šä¸‰è§’çŸ©é˜µ$R$ä¸‹é¢ç”¨ä¾‹å­è¿›è¡Œè¯´æ˜ï¼Œé¦–å…ˆè€ƒè™‘æ–¹é˜µï¼Œå¯¹äºå¦‚ä¸‹çš„æ–¹é˜µå…¶$\mathrm{QR}$åˆ†è§£çš„ä»£ç å¦‚ä¸‹123456import numpy as npA = np.array([[1,2,3],[4,5,6],[7,8,9]])Q, R = np.linalg.qr(A)print(Q)print(R)ç¨‹åºè¿è¡Œç»“æœå¦‚ä¸‹1234567[[-0.12309149  0.90453403    0.40824829], [-0.49236596  0.30151134    -0.81649658], [-0.86164044  -0.301511340  0.40824829]][[-8.12403840e+00  -9.60113630e+00  -1.10782342e+01], [0.00000000e+00   9.04534034e-01   1.80906807e+00], [0.00000000e+00   0.00000000e+00   -8.88178420e-16]] å¯ä»¥éªŒè¯è¿™ä¸¤ä¸ªçŸ©é˜µçš„ä¹˜ç§¯å°±æ˜¯åŸå§‹çŸ©é˜µ$\boldsymbol{A}$ï¼Œæ¥ä¸‹æ¥è€ƒè™‘ä¸æ˜¯æ–¹é˜µçš„æƒ…å†µï¼Œå¯¹äºå¦‚ä¸‹çš„çŸ©é˜µå…¶$\mathrm{QR}$åˆ†è§£çš„ä»£ç å¦‚ä¸‹123456import numpy as npA = np.array([[1,2,3],[4,5,6]])Q, R = np.linalg.qr(A)print(Q)print(R)ç¨‹åºè¿è¡Œç»“æœå¦‚ä¸‹12345[[-0.24253563-0.9701425] [-0.97014250 .24253563]][[-4.12310563-5.33578375-6.54846188] [0,-0.72760688-1.45521375]]ç‰¹å¾å€¼åˆ†è§£å®šä¹‰ç‰¹å¾å€¼åˆ†è§£(Eigen Decomposition)ä¹Ÿç§°ä¸ºè°±åˆ†è§£(Spectral Decomposition)ï¼Œæ˜¯çŸ©é˜µç›¸ä¼¼å¯¹è§’åŒ–çš„å¦ä¸€ç§è¡¨è¿°å¯¹äº$n$é˜¶çŸ©é˜µ$\boldsymbol{A}$ï¼Œå¦‚æœå®ƒæœ‰$n$ä¸ªçº¿æ€§æ— å…³çš„ç‰¹å¾å‘é‡ï¼Œåˆ™å¯å°†å…¶åˆ†è§£ä¸ºå¦‚ä¸‹3ä¸ªçŸ©é˜µçš„ä¹˜ç§¯å…¶ä¸­$\Lambda$ä¸ºå¯¹è§’çŸ©é˜µï¼ŒçŸ©é˜µ$\Lambda$çš„å¯¹è§’çº¿å…ƒç´ ä¸ºçŸ©é˜µ$A$çš„ç‰¹å¾å€¼$Q$ä¸º$n$é˜¶çŸ©é˜µï¼Œå®ƒçš„åˆ—ä¸º$A$çš„ç‰¹å¾å‘é‡ï¼Œä¸å¯¹è§’çŸ©é˜µä¸­ç‰¹å¾å€¼çš„æ’åˆ—é¡ºåºä¸€è‡´ä¸€ä¸ª$n$é˜¶çŸ©é˜µå¯ä»¥è¿›è¡Œç‰¹å¾å€¼åˆ†è§£çš„å……åˆ†å¿…è¦æ¡ä»¶æ˜¯å®ƒæœ‰$n$ä¸ªçº¿æ€§æ— å…³çš„ç‰¹å¾å‘é‡ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œè¿™äº›ç‰¹å¾å‘é‡$x_{i}$éƒ½æ˜¯å•ä½åŒ–çš„ç”¨äºè®¡ç®—é€†çŸ©é˜µç‰¹å¾å€¼åˆ†è§£å¯ä»¥ç”¨äºè®¡ç®—é€†çŸ©é˜µï¼Œå¦‚æœçŸ©é˜µ$\boldsymbol{A}$å¯ä»¥è¿›è¡Œç‰¹å¾å€¼åˆ†è§£ï¼Œä¸”å…¶æ‰€æœ‰ç‰¹å¾å€¼éƒ½é0ï¼Œåˆ™å…¶é€†çŸ©é˜µä¸ºå¯¹è§’çŸ©é˜µçš„é€†çŸ©é˜µå®¹æ˜“è®¡ç®—ï¼Œæ˜¯ä¸»å¯¹è§’çº¿æ‰€æœ‰å…ƒç´ çš„å€’æ•°ç‰¹å¾å€¼åˆ†è§£è¿˜å¯ç”¨äºè®¡ç®—çŸ©é˜µçš„å¤šé¡¹å¼æˆ–è€…å¹‚ï¼Œå¯¹äºå¦‚ä¸‹å¤šé¡¹å¼å¦‚æœçŸ©é˜µ$\boldsymbol{A}$å¯ä»¥è¿›è¡Œç‰¹å¾å€¼åˆ†è§£ï¼Œä¸”åˆ™æœ‰å¯¹è§’çŸ©é˜µçš„å¹‚ä»ç„¶æ˜¯å¯¹è§’çŸ©é˜µï¼Œæ˜¯ä¸»å¯¹è§’çº¿å…ƒç´ åˆ†åˆ«æ±‚å¹‚ï¼Œå› æ­¤æœ‰å€ŸåŠ©äºç‰¹å¾å€¼åˆ†è§£ï¼Œå¯ä»¥é«˜æ•ˆåœ°è®¡ç®—å‡º$f(A)$ï¼Œç‰¹åˆ«åœ°ï¼Œæœ‰å¦‚æœ$A$æ˜¯å®å¯¹ç§°çŸ©é˜µï¼Œå¯å¯¹å…¶ç‰¹å¾å‘é‡è¿›è¡Œæ­£äº¤åŒ–ï¼Œç‰¹å¾å€¼åˆ†è§£ä¸ºå…¶ä¸­$Q$ä¸ºæ­£äº¤çŸ©é˜µï¼Œå®ƒçš„åˆ—æ˜¯$A$çš„æ­£äº¤åŒ–ç‰¹å¾å‘é‡ï¼Œ$A$åŒæ ·ä¸º$A$çš„æ‰€æœ‰ç‰¹å¾å€¼æ„æˆçš„å¯¹è§’çŸ©é˜µç‰¹å¾å€¼åˆ†è§£å¯ä»¥å€ŸåŠ©äº$\mathrm{QR}$ç®•æ³•å®ç°ï¼Œæœºå™¨å­¦ä¹ ä¸­å¸¸ç”¨çš„çŸ©é˜µå¦‚åæ–¹å·®çŸ©é˜µç­‰éƒ½æ˜¯å®å¯¹ç§°çŸ©é˜µï¼Œå› æ­¤éƒ½å¯ä»¥è¿›è¡Œç‰¹å¾å€¼åˆ†è§£ç‰¹å¾å€¼åˆ†è§£å¯ä»¥ç”±Pythonä¸­linalgçš„eigå‡½æ•°å®ç°ï¼Œå‡½æ•°çš„è¾“å…¥ä¸ºè¢«åˆ†è§£çŸ©é˜µ$A$ï¼Œè¾“å‡ºä¸ºæ‰€æœ‰ç‰¹å¾å€¼ï¼Œä»¥åŠè¿™äº›ç‰¹å¾å€¼å¯¹åº”çš„å•ä½åŒ–ç‰¹å¾å‘é‡123456import numpy as npA = np.array([[1,2,3],[4,5,6],[7,8,9]])V, U = np.linalg.eig(A)print(U)print(V)ç¨‹åºç»“æœå¦‚ä¸‹12345[[-0.23197069-0.785830240 .40824829] [-0.52532209-0.08675134-0.81649658] [-0.81867350 .612327560 .40824829]][1.61168440e+01   -1.11684397e+00  -1.30367773e-15]è¿™é‡Œçš„Væ‰€æœ‰ç‰¹å¾å€¼å½¢æˆçš„å‘é‡ï¼ŒUçš„åˆ—æ˜¯å•ä½åŒ–çš„ç‰¹å¾å‘é‡å¥‡å¼‚å€¼åˆ†è§£ç‰¹å¾å€¼åˆ†è§£åªé€‚ç”¨äºæ–¹é˜µï¼Œä¸”è¦æ±‚æ–¹é˜µæœ‰$n$ä¸ªçº¿æ€§æ— å…³çš„ç‰¹å¾å‘é‡å¥‡å¼‚å€¼åˆ†è§£(Singular Value Decomposition, SVD)æ˜¯å¯¹å®ƒçš„æ¨å¹¿ï¼Œå¯¹äºä»»æ„çš„çŸ©é˜µå‡å¯ç”¨ç‰¹å¾å€¼ä¸ç‰¹å¾å‘é‡è¿›è¡Œåˆ†è§£å…¶æ€è·¯æ˜¯å¯¹$A A^{\mathrm{T}}$å’Œ$\boldsymbol{A}^{\mathrm{T}} \boldsymbol{A}$è¿›è¡Œç‰¹å¾å€¼åˆ†è§£ï¼Œå¯¹äºä»»æ„çŸ©é˜µ$\boldsymbol{A}$ï¼Œè¿™ä¸¤ä¸ªçŸ©é˜µéƒ½æ˜¯å¯¹ç§°åŠæ­£å®šçŸ©é˜µï¼Œä¸€å®šèƒ½è¿›è¡Œç‰¹å¾å€¼åˆ†è§£å¹¶ä¸”è¿™ä¸¤ä¸ªçŸ©é˜µçš„ç‰¹å¾å€¼éƒ½æ˜¯éè´Ÿçš„ï¼Œåé¢å°†ä¼šè¯æ˜å®ƒä»¬æœ‰ç›¸åŒçš„é0ç‰¹å¾å€¼å‡è®¾$A \in \mathbb{R}^{m \times n}$ï¼Œå…¶ä¸­$m \geqslant n$ï¼Œåˆ™æœ‰å…¶ä¸­$\boldsymbol{U}$ä¸º$m$é˜¶æ­£äº¤çŸ©é˜µï¼Œå…¶åˆ—ç§°ä¸ºçŸ©é˜µ$\boldsymbol{A}$çš„å·¦å¥‡å¼‚å‘é‡ï¼Œä¹Ÿæ˜¯$\boldsymbol{A} \boldsymbol{A}^{\mathrm{T}}$çš„ç‰¹å¾å‘é‡ï¼Œ$\boldsymbol{\Sigma}$ä¸ºå¦‚ä¸‹å½¢å¼çš„$m \times n$çŸ©é˜µå…¶å°ºå¯¸ä¸$\boldsymbol{A}$ç›¸åŒï¼Œåœ¨è¿™é‡Œ$\boldsymbol{\Sigma}_{n}$æ˜¯$n$é˜¶å¯¹è§’çŸ©é˜µä¸”ä¸»å¯¹è§’çº¿å…ƒç´ æŒ‰ç…§å…¶å€¼å¤§å°é™åºæ’åˆ—$\sigma_{i}$ç§°ä¸º$\boldsymbol{A}$çš„å¥‡å¼‚å€¼ï¼Œæ˜¯$\boldsymbol{A} \boldsymbol{A}^{\mathrm{T}}$ç‰¹å¾å€¼çš„éè´Ÿå¹³æ–¹æ ¹ï¼Œä¹Ÿæ˜¯$\boldsymbol{A}^{\mathrm{T}} \boldsymbol{A}$ç‰¹å¾å€¼çš„éè´Ÿå¹³æ–¹æ ¹$\boldsymbol{V}$ä¸º$n$é˜¶æ­£äº¤çŸ©é˜µï¼Œå…¶è¡Œç§°ä¸ºçŸ©é˜µ$\boldsymbol{A}$çš„å³å¥‡å¼‚å‘é‡ï¼Œä¹Ÿæ˜¯$\boldsymbol{A}^{\mathrm{T}} \boldsymbol{A}$çš„ç‰¹å¾å‘é‡å¼1ä¸¤è¾¹å·¦ä¹˜$\boldsymbol{U}$ï¼Œå³ä¹˜$\boldsymbol{V}^{\mathrm{T}}$ï¼Œç”±äº$\boldsymbol{U}$ã€$\boldsymbol{V}$éƒ½æ˜¯æ­£äº¤çŸ©é˜µï¼Œå› æ­¤æœ‰ä¸Šå¼ç§°ä¸ºçŸ©é˜µçš„å¥‡å¼‚å€¼åˆ†è§£ï¼Œå¯¹äº$m \leqslant n$çš„æƒ…å†µï¼Œæœ‰ç±»ä¼¼çš„ç»“æœï¼Œæ­¤æ—¶ä¸‹é¢è¯æ˜$\boldsymbol{A} A^{\mathrm{T}}$ä¸$\boldsymbol{A}^{\mathrm{T}} \boldsymbol{A}$æœ‰ç›¸åŒçš„é0ç‰¹å¾å€¼ï¼Œå‡è®¾$\lambda \neq 0$æ˜¯$A A^{\mathrm{T}}$çš„ç‰¹å¾å€¼,$\boldsymbol{x}$æ˜¯å¯¹åº”çš„ç‰¹å¾å‘é‡ï¼Œåˆ™æœ‰ä¸Šå¼ä¸¤è¾¹åŒæ—¶å·¦ä¹˜$\boldsymbol{A}^{\mathrm{T}}$å¯ä»¥å¾—åˆ°å³ä¸‹é¢è¯æ˜$\boldsymbol{A}^{\mathrm{T}} \boldsymbol{x} \neq \mathbf{0}$ï¼Œå¼ (2.65) ä¸¤è¾¹åŒæ—¶å·¦ä¹˜$\boldsymbol{x}^{\mathrm{T}}$, ç”±äº$\lambda \neq 0, \boldsymbol{x} \neq \mathbf{0}$å› æ­¤$A^{\mathrm{T}} x \neq 0$ï¼Œ$\lambda$æ˜¯$A^{\mathrm{T}} A$çš„ç‰¹å¾å€¼ï¼Œ$\boldsymbol{A}^{\mathrm{T}} \boldsymbol{x}$æ˜¯å¯¹åº”çš„ç‰¹å¾å‘é‡åŒæ ·ï¼Œå¦‚æœ$\lambda \neq 0$æ˜¯$A^{\mathrm{T}} A$çš„ç‰¹å¾å€¼,$\boldsymbol{x}$æ˜¯å¯¹åº”çš„ç‰¹å¾å‘é‡ï¼Œåˆ™æœ‰ä¸Šå¼ä¸¤è¾¹åŒæ—¶å·¦ä¹˜$\boldsymbol{A}$å¯ä»¥å¾—åˆ°å³ä¸‹é¢è¯æ˜$A x \neq 0$ï¼Œä¸Šä¸Šä¸Šå¼ä¸¤è¾¹åŒæ—¶å·¦ä¹˜$x^{\mathrm{T}}$ï¼Œç”±äº$\lambda \neq 0, x \neq 0$å› æ­¤$A x \neq 0$ï¼Œ$\lambda$æ˜¯$A A^{\mathrm{T}}$çš„ç‰¹å¾å€¼ï¼Œ$A \boldsymbol{x}$æ˜¯å¯¹åº”çš„ç‰¹å¾å‘é‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ$\boldsymbol{A A ^ { \mathrm { T } }}$çš„0ç‰¹å¾å€¼ä¸ä¸€å®šæ˜¯$A^{\mathrm{T}} \boldsymbol{A}$çš„0ç‰¹å¾å€¼ï¼Œä¸‹é¢ä¸¾ä¾‹è¯´æ˜ï¼Œå¯¹äºå¦‚ä¸‹çš„çŸ©é˜µæœ‰$A A^{\mathrm{T}}$çš„ç‰¹å¾å€¼ä¸ºå¯çŸ¥ç‰¹å¾å€¼ä¸ºï¼Œ0æ˜¯çš„ç‰¹å¾å€¼ä½†ä¸æ˜¯çš„ç‰¹å¾å€¼ä¸‹é¢æ¥çœ‹å¥‡å¼‚å€¼åˆ†è§£çš„ä¸€ä¸ªä¾‹å­ã€‚å¯¹äºå¦‚ä¸‹çš„çŸ©é˜µæœ‰ä»¥åŠè¿™é‡Œçš„ç‰¹å¾å€¼ä¸ºï¼Œçš„ç‰¹å¾å€¼ä¸ºå› æ­¤$\boldsymbol{A}$çš„é0å¥‡å¼‚å€¼ä¸ºã€è®¡ç®—$\boldsymbol{A} \boldsymbol{A}^{\mathrm{T}}$ä¸$\boldsymbol{A}^{\mathrm{T}} \boldsymbol{A}$çš„ç‰¹å¾å‘é‡å¹¶è¿›è¡Œå•ä½åŒ–ï¼Œæœ€åå¾—åˆ°å¥‡å¼‚å€¼åˆ†è§£ç»“æœä¸ºå¦‚æœ$m \geqslant n$å³åœ¨è¿™é‡Œæ˜¯$n$é˜¶å¯¹è§’é˜µï¼Œä¸Šå¼å°±æ˜¯$A^{\mathrm{T}} \boldsymbol{A}$çš„ç‰¹å¾å€¼åˆ†è§£ç±»ä¼¼åœ°æœ‰å³åœ¨è¿™é‡Œæ˜¯$m$é˜¶å¯¹è§’é˜µï¼Œä¸Šä¸Šå¼å°±æ˜¯$A A^{\mathrm{T}}$çš„ç‰¹å¾å€¼åˆ†è§£ï¼Œå¯¹äº$m \leqslant n$æœ‰ç›¸åŒçš„ç»“è®ºå¦‚æœ$A$æ˜¯å¯¹ç§°çŸ©é˜µï¼Œåˆ™$A^{\mathrm{T}} A=A A^{\mathrm{T}}=A \boldsymbol{A}$ï¼Œå› æ­¤$A^{\mathrm{T}} A$å’Œ$\boldsymbol{A} \boldsymbol{A}^{\mathrm{T}}$çš„ç‰¹å¾å€¼åˆ†è§£æ˜¯ç›¸åŒçš„ï¼Œè¿™æ„å‘³ç€$U$å’Œ$V$ç›¸åŒå‡è®¾$\lambda$æ˜¯$A$çš„ç‰¹å¾å€¼ï¼Œæ ¹æ®ç‰¹å¾å€¼çš„æ€§è´¨ï¼Œ$\lambda^{2}$æ˜¯$A^{\mathrm{T}} \boldsymbol{A}$ä¸$\boldsymbol{A A ^ { \mathrm { T } }}$çš„ç‰¹å¾å€¼ï¼Œå› æ­¤$A$çš„å¥‡å¼‚å€¼ä¸ºå…¶ç‰¹å¾å€¼çš„ç»å¯¹å€¼Pythonä¸­linalgçš„svdå‡½æ•°å®ç°äº†å¥‡å¼‚å€¼åˆ†è§£ï¼Œå‡½æ•°çš„è¾“å…¥å€¼ä¸ºè¢«åˆ†è§£çŸ©é˜µ$A$ï¼Œè¾“å‡ºä¸ºæ­£äº¤çŸ©é˜µ$U$å’Œ$V^{\mathrm{T}}$ï¼Œä»¥åŠé0å¥‡å¼‚å€¼$\sigma_{i}$12345678from numpy import *data = [[1,2,3],[4,5,6]]u, sigma, vt = linalg.svd(data)print(u)print(sigma)print(vt)è¾“å‡ºç»“æœå¦‚ä¸‹1234567[[-0.3863177   -0.92236578] [-0.92236578   0.3863177] [9.508032      0.77286964]]  [[-0.42866713   -0.56630692   -0.7039467] [0.80596391    0.11238241    -0.58119908] [0.40824829   -0.81649658    0.40824829]]  è¿™é‡Œçš„uæ˜¯å…¬å¼ä¸­çš„$U$ï¼Œ$\mathrm{vt}$æ˜¯å…¬å¼ä¸­çš„$V^{\mathrm{T}}$ï¼Œsigmaæ˜¯æ‰€æœ‰é0å¥‡å¼‚å€¼ï¼Œå®ƒä»¬æ„æˆå¦‚ä¸‹$2 \times 3$çš„çŸ©é˜µ$\boldsymbol{\Sigma}$å¯ä»¥éªŒè¯ï¼Œè¿™3ä¸ªçŸ©é˜µçš„ä¹˜ç§¯ä¸ºåŸå§‹çŸ©é˜µå¥‡å¼‚å€¼åˆ†è§£çš„å‡ ä½•æ„ä¹‰å‘é‡$\boldsymbol{x}$å·¦ä¹˜ä»»æ„çŸ©é˜µ$\boldsymbol{A}$æ‰€å®ç°çš„çº¿æ€§å˜æ¢å¯ä»¥åˆ†è§£ä¸º3æ¬¡å˜æ¢é¦–å…ˆæ˜¯$\boldsymbol{x}$å·¦ä¹˜æ­£äº¤çŸ©é˜µ$V^{\mathrm{T}}$æ‰€ä»£è¡¨çš„æ—‹è½¬å˜æ¢ï¼Œæ¥ä¸‹æ¥æ˜¯$V^{\mathrm{T}} x$å·¦ä¹˜çŸ©é˜µ$\boldsymbol{\Sigma}$æ‰€ä»£è¡¨çš„æ‹‰ä¼¸å˜æ¢æœ€åæ˜¯$\Sigma V^{\mathrm{T}} x$å·¦ä¹˜æ­£äº¤çŸ©é˜µ$U$æ‰€ä»£è¡¨çš„æ—‹è½¬å˜æ¢å¥‡å¼‚å€¼åˆ†è§£æ­ç¤ºäº†çŸ©é˜µçš„æœ¬è´¨ç‰¹å¾ï¼Œå¯¹åˆ†æçŸ©é˜µçš„æ€§è´¨æœ‰é‡è¦çš„ä»·å€¼åœ¨å¯¹äººå·¥ç¥ç»ç½‘ç»œæƒé‡çŸ©é˜µçš„ç†è®ºåˆ†æä¸­ï¼Œå¥‡å¼‚å€¼å’Œå¥‡å¼‚å‘é‡ç»å¸¸è¢«ä½¿ç”¨ï¼Œåœ¨å›¾åƒå‹ç¼©ä¸æ¨èç³»ç»Ÿä¸­ï¼Œå¥‡å¼‚å€¼åˆ†è§£ä¹Ÿæœ‰åº”ç”¨</content>
	</entry>
	<entry>
		<title>dockeråŸºæœ¬ä½¿ç”¨</title>
		<url>/article/50622.html</url>
		<content>dockerdockerå®˜æ–¹æ–‡æ¡£Docker å¿«é€Ÿå…¥é—¨dockeræ˜¯ä»€ä¹ˆDocker æ˜¯ä¸€ä¸ªåº”ç”¨æ‰“åŒ…ã€åˆ†å‘ã€éƒ¨ç½²çš„å·¥å…·ä½ ä¹Ÿå¯ä»¥æŠŠå®ƒç†è§£ä¸ºä¸€ä¸ªè½»é‡çš„è™šæ‹Ÿæœºï¼Œå®ƒåªè™šæ‹Ÿä½ è½¯ä»¶éœ€è¦çš„è¿è¡Œç¯å¢ƒï¼Œå¤šä½™çš„ä¸€ç‚¹éƒ½ä¸è¦è€Œæ™®é€šè™šæ‹Ÿæœºåˆ™æ˜¯ä¸€ä¸ªå®Œæ•´è€Œåºå¤§çš„ç³»ç»Ÿï¼ŒåŒ…å«å„ç§ä¸ç®¡ä½ è¦ä¸è¦çš„è½¯ä»¶è·Ÿæ™®é€šè™šæ‹Ÿæœºçš„å¯¹æ¯”ç‰¹æ€§æ™®é€šè™šæ‹ŸæœºDockerè·¨å¹³å°é€šå¸¸åªèƒ½åœ¨æ¡Œé¢çº§ç³»ç»Ÿè¿è¡Œï¼Œä¾‹å¦‚ Windows/Macï¼Œæ— æ³•åœ¨ä¸å¸¦å›¾å½¢ç•Œé¢çš„æœåŠ¡å™¨ä¸Šè¿è¡Œæ”¯æŒçš„ç³»ç»Ÿéå¸¸å¤šï¼Œå„ç±» windows å’Œ Linux éƒ½æ”¯æŒæ€§èƒ½æ€§èƒ½æŸè€—å¤§ï¼Œå†…å­˜å ç”¨é«˜ï¼Œå› ä¸ºæ˜¯æŠŠæ•´ä¸ªå®Œæ•´ç³»ç»Ÿéƒ½è™šæ‹Ÿå‡ºæ¥äº†æ€§èƒ½å¥½ï¼Œåªè™šæ‹Ÿè½¯ä»¶æ‰€éœ€è¿è¡Œç¯å¢ƒï¼Œæœ€å¤§åŒ–å‡å°‘æ²¡ç”¨çš„é…ç½®è‡ªåŠ¨åŒ–éœ€è¦æ‰‹åŠ¨å®‰è£…æ‰€æœ‰ä¸œè¥¿ä¸€ä¸ªå‘½ä»¤å°±å¯ä»¥è‡ªåŠ¨éƒ¨ç½²å¥½æ‰€éœ€ç¯å¢ƒç¨³å®šæ€§ç¨³å®šæ€§ä¸é«˜ï¼Œä¸åŒç³»ç»Ÿå·®å¼‚å¤§ç¨³å®šæ€§å¥½ï¼Œä¸åŒç³»ç»Ÿéƒ½ä¸€æ ·éƒ¨ç½²æ–¹å¼æ‰“åŒ…ã€åˆ†å‘ã€éƒ¨ç½²æ‰“åŒ…ï¼šå°±æ˜¯æŠŠä½ è½¯ä»¶è¿è¡Œæ‰€éœ€çš„ä¾èµ–ã€ç¬¬ä¸‰æ–¹åº“ã€è½¯ä»¶æ‰“åŒ…åˆ°ä¸€èµ·ï¼Œå˜æˆä¸€ä¸ªå®‰è£…åŒ…åˆ†å‘ï¼šä½ å¯ä»¥æŠŠä½ æ‰“åŒ…å¥½çš„â€œå®‰è£…åŒ…â€ä¸Šä¼ åˆ°ä¸€ä¸ªé•œåƒä»“åº“ï¼Œå…¶ä»–äººå¯ä»¥éå¸¸æ–¹ä¾¿çš„è·å–å’Œå®‰è£…éƒ¨ç½²ï¼šæ‹¿ç€â€œå®‰è£…åŒ…â€å°±å¯ä»¥ä¸€ä¸ªå‘½ä»¤è¿è¡Œèµ·æ¥ä½ çš„åº”ç”¨ï¼Œè‡ªåŠ¨æ¨¡æ‹Ÿå‡ºä¸€æ‘¸ä¸€æ ·çš„è¿è¡Œç¯å¢ƒï¼Œä¸ç®¡æ˜¯åœ¨ Windows/Mac/Linuxdockerå®‰è£…å®¹å™¨æ˜¯ç”±é•œåƒå®ä¾‹åŒ–è€Œæ¥ï¼Œç®€å•æ¥è¯´ï¼Œé•œåƒæ˜¯æ–‡ä»¶ï¼Œå®¹å™¨æ˜¯è¿›ç¨‹å®¹å™¨æ˜¯åŸºäºé•œåƒåˆ›å»ºçš„ï¼Œå³å®¹å™¨ä¸­çš„è¿›ç¨‹ä¾èµ–äºé•œåƒä¸­çš„æ–‡ä»¶docker çš„é•œåƒæ¦‚å¿µç±»ä¼¼è™šæ‹Ÿæœºçš„é•œåƒã€‚æ˜¯ä¸€ä¸ªåªè¯»çš„æ¨¡æ¿ï¼Œä¸€ä¸ªç‹¬ç«‹çš„æ–‡ä»¶ç³»ç»Ÿï¼ŒåŒ…æ‹¬è¿è¡Œå®¹å™¨æ‰€éœ€çš„æ•°æ®ï¼Œå¯ä»¥ç”¨æ¥åˆ›å»ºæ–°çš„å®¹å™¨é•œåƒè¿è¡Œèµ·æ¥å°±æ˜¯å®¹å™¨ï¼Œå®¹å™¨æœåŠ¡è¿è¡Œçš„è¿‡ç¨‹ä¸­ï¼ŒåŸºäºåŸå§‹é•œåƒåšäº†æ”¹å˜ï¼Œæ¯”å¦‚å®‰è£…äº†ç¨‹åºï¼Œæ·»åŠ äº†æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æäº¤å›å» (commit)æˆä¸ºé•œåƒdockerå®‰è£…åˆ†ä¸ºå®‰è£…åŒ…å’Œå‘½ä»¤è¡Œä¸¤ç§win11å®‰è£…åŒ…centos7å‘½ä»¤è¡Œä¸‹è½½dockerå®‰è£…åŒ…ï¼ŒæŒ‰ç…§æŒ‡ç¤ºå®‰è£…å³å¯windowséœ€è¦æ‰“å¼€å¯ç”¨æˆ–å…³é—­WindowsåŠŸèƒ½ä¸‹çš„Hyper-Vã€å®¹å™¨å’Œé€‚ç”¨äºLinuxçš„Windowså­ç³»ç»Ÿé€‰é¡¹å®‰è£…å®Œè¦æ‰“å¼€Docker Desktopè½¯ä»¶ï¼Œæ‰“å¼€ä¼šå¯åŠ¨å¼•æ“ï¼Œè¿™æ ·æ‰èƒ½ä½¿ç”¨dockeré‡è¦ï¼šæ‰“å¼€Docker Desktopè½¯ä»¶ï¼Œæ‰“å¼€Settingsä¸‹çš„Resourcesï¼Œé€‰æ‹©Advancedä¸‹çš„Disk image locationï¼Œé€‰æ‹©åˆé€‚çš„æ–‡ä»¶å¤¹å­˜æ”¾dockerçš„é•œåƒå’Œå®¹å™¨ï¼Œæ³¨æ„åæœŸå®¹å™¨å¤šçš„è¯ï¼Œè¿™ä¸ªæ–‡ä»¶å¤¹å¾ˆå ç©ºé—´çš„1curl -fsSL https://get.docker.com | bash -s docker --mirror Aliyuné…ç½®é•œåƒåŠ é€Ÿè¿›å…¥é˜¿é‡Œäº‘ï¼Œç™»é™†åç‚¹å‡»å·¦ä¾§çš„é•œåƒåŠ é€Ÿï¼Œç”Ÿæˆè‡ªå·±çš„é•œåƒåŠ é€Ÿåœ°å€æ‰§è¡Œé˜¿é‡Œäº‘æ¨èçš„ç»ˆç«¯å‘½ä»¤ï¼Œå³å¯æ›´æ–°dockerçš„é•œåƒæºä¸ºé˜¿é‡Œäº‘é•œåƒ12345678sudo mkdir -p /etc/dockersudo tee /etc/docker/daemon.json &lt;&lt;-'EOF'{  &quot;registry-mirrors&quot;: [&quot;https://xk5lrhin.mirror.aliyuncs.com&quot;]}EOFsudo systemctl daemon-reloadsudo systemctl restart dockerä»£ç†é…ç½®ä¸ºdockeræœåŠ¡åˆ›å»ºä¸€ä¸ªå†…åµŒçš„systemdç›®å½•1mkdir -p /etc/systemd/system/docker.service.dåˆ›å»º/etc/systemd/system/docker.service.d/http-proxy.confæ–‡ä»¶ï¼Œå¹¶æ·»åŠ HTTP_PROXYç¯å¢ƒå˜é‡ï¼Œå…¶ä¸­[proxy-addr]å’Œ[proxy-port]åˆ†åˆ«æ”¹æˆå®é™…æƒ…å†µçš„ä»£ç†åœ°å€å’Œç«¯å£12[Service]Environment=&quot;HTTP_PROXY=http://192.168.4.xx:xx&quot; &quot;HTTPS_PROXY=http://192.168.4.xx:xx&quot;å¦‚æœè¿˜æœ‰å†…éƒ¨çš„ä¸éœ€è¦ä½¿ç”¨ä»£ç†æ¥è®¿é—®çš„Docker registriesï¼Œé‚£ä¹ˆè¿˜éœ€è¦åˆ¶å®šNO_PROXYç¯å¢ƒå˜é‡12[Service]Environment=&quot;HTTP_PROXY=http://192.168.4.xx:xx&quot; &quot;HTTPS_PROXY=http://192.168.4.xx:xx&quot; &quot;NO_PROXY=localhost,127.0.0.1,docker-registry.somecorporation.com&quot;æ›´æ–°é…ç½®å¹¶é‡å¯DockeræœåŠ¡12systemctl daemon-reloadsystemctl restart dockeråŠ é€Ÿæ ¼å¼ï¼šâ€registry-mirrorsâ€: [â€œhttps://registry.docker-cn.comâ€œ]é•œåƒåŠ é€Ÿå™¨é•œåƒåŠ é€Ÿå™¨åœ°å€Docker ä¸­å›½å®˜æ–¹é•œåƒhttps://registry.docker-cn.comDaoCloud é•œåƒç«™http://f1361db2.m.daocloud.ioAzure ä¸­å›½é•œåƒhttps://dockerhub.azk8s.cnç§‘å¤§é•œåƒç«™https://docker.mirrors.ustc.edu.cné˜¿é‡Œäº‘https://ud6340vz.mirror.aliyuncs.comä¸ƒç‰›äº‘https://reg-mirror.qiniu.comç½‘æ˜“äº‘https://hub-mirror.c.163.comè…¾è®¯äº‘https://mirror.ccs.tencentyun.comåŸºæœ¬å‘½ä»¤å­¦ä¹ åŸºæœ¬å‘½ä»¤123456789101112131415161718192021# æŸ¥çœ‹ç‰ˆæœ¬å·docker version# å¯åŠ¨dockersystemctl start docker# å…³é—­dockersystemctl stop docker# é‡å¯dockersystemctl restart docker# dockerè®¾ç½®éšæœåŠ¡å¯åŠ¨è€Œè‡ªå¯åŠ¨systemctl enable docker# æŸ¥çœ‹docker è¿è¡ŒçŠ¶æ€systemctl status docker# æŸ¥çœ‹volumeåˆ—è¡¨docker volume ls# æŸ¥çœ‹ç½‘ç»œåˆ—è¡¨docker network lsé•œåƒDockeré»˜è®¤æ‹‰å–çš„æ¶æ„æ˜¯ä¸ä¸»æœºçš„æ¶æ„ç›¸åŒï¼Œå½“ä½ åœ¨ä¸€ä¸ªç‰¹å®šçš„æ¶æ„ä¸Šè¿è¡ŒDockerå‘½ä»¤æ—¶ï¼ŒDockerå°†è‡ªåŠ¨å°è¯•æ‹‰å–ä¸è¯¥æ¶æ„åŒ¹é…çš„é•œåƒã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ åœ¨x86æ¶æ„çš„ä¸»æœºä¸Šè¿è¡ŒDockerå‘½ä»¤ï¼ŒDockerå°†å°è¯•æ‹‰å–x86æ¶æ„çš„é•œåƒè¿™æ„å‘³ç€Dockerä¼šè‡ªåŠ¨é€‚é…ä¸»æœºçš„æ¶æ„ï¼Œå¹¶æ‹‰å–ç›¸åº”çš„é•œåƒä¾›ä½¿ç”¨ã€‚å¦‚æœéœ€è¦æŒ‡å®šæ¶æ„ï¼Œå¯ä»¥åŠ ä¸Š--platform=arm64å‚æ•°1234567891011121314151617181920212223# æŸ¥çœ‹æœ¬åœ°é•œåƒdocker images# æœç´¢é•œåƒdocker search neo4j# æ‹‰å–é•œåƒ  å¦‚æœéœ€è¦æŒ‡å®šæ¶æ„ï¼Œå¯ä»¥åŠ ä¸Š`--platform=arm64`å‚æ•°docker pull é•œåƒå:tag# åˆ é™¤é•œåƒ ------å½“å‰é•œåƒæ²¡æœ‰è¢«ä»»ä½•å®¹å™¨ä½¿ç”¨æ‰å¯ä»¥åˆ é™¤docker rmi -f é•œåƒå/é•œåƒID# åˆ é™¤å¤šä¸ª å…¶é•œåƒIDæˆ–é•œåƒç”¨ç”¨ç©ºæ ¼éš”å¼€å³å¯docker rmi -f é•œåƒå/é•œåƒID é•œåƒå/é•œåƒID# ä¿å­˜é•œåƒï¼Œå°†æˆ‘ä»¬çš„é•œåƒä¿å­˜ä¸ºtarå‹ç¼©æ–‡ä»¶ï¼Œè¿™æ ·æ–¹ä¾¿é•œåƒè½¬ç§»å’Œä¿å­˜# ç„¶åå¯ä»¥åœ¨ä»»ä½•ä¸€å°å®‰è£…äº†dockerçš„æœåŠ¡å™¨ä¸ŠåŠ è½½è¿™ä¸ªé•œåƒdocker save é•œåƒå/é•œåƒID -o é•œåƒä¿å­˜åœ¨å“ªä¸ªä½ç½®ä¸åå­—docker save -o my_ubuntu_v3.tar runoob/ubuntu:v3# åŠ è½½é•œåƒdocker load --input my_ubuntu_v3.tar# é•œåƒé‡å‘½ådocker tag &lt;IMAGE_ID&gt; &lt;NEW_REPOSITORY&gt;:&lt;TAG&gt;å®¹å™¨1234567891011121314151617181920212223242526# åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„å®¹å™¨ï¼Œä¸ä¼šç«‹å³è¿è¡Œdocker create  --name my_container nginx:latest# åˆ›å»ºå’Œå¯åŠ¨çš„ç»„åˆï¼Œåˆ›å»ºäº†ä¸€ä¸ªæ–°å®¹å™¨å¹¶ç«‹å³å¯åŠ¨å®ƒï¼Œ-dè¡¨ç¤ºåå°docker run --name my_container -d nginx:latest# å¯åŠ¨å·²ç»ˆæ­¢å®¹å™¨docker container start# åœæ­¢å®¹å™¨docker stop å®¹å™¨IDæˆ–è€…å®¹å™¨å# é‡å¯å®¹å™¨docker restart å®¹å™¨IDæˆ–è€…å®¹å™¨å# åˆ—å‡ºæ‰€æœ‰åœ¨è¿è¡Œçš„å®¹å™¨ä¿¡æ¯docker ps# æŸ¥çœ‹æœ¬åœ°æ‰€æœ‰å®¹å™¨docker ps -a# åˆ é™¤æŒ‡å®šå®¹å™¨docker rm -f &lt;container_id0&gt; &lt;container_id1&gt;# åˆ é™¤æœªå¯åŠ¨æˆåŠŸçš„å®¹å™¨docker rm $(docker ps -a|grep Created|awk '{print $1}')# åˆ é™¤æ‰€æœ‰æœªè¿è¡Œçš„å®¹å™¨docker rm $(docker ps -a|grep Created|awk '{print $1}')# å®¹å™¨é‡å‘½ådocker rename CONTAINER NEW_NAMEé•œåƒæ‰“åŒ…å·¥å…·  Buildpacksã€DockerfileDocker, Dockerfile, å’ŒDocker ComposeåŒºåˆ« | BaeldungDocker Composeå…è®¸æˆ‘ä»¬å®šä¹‰å®¹å™¨å…±äº«çš„å…±åŒå¯¹è±¡ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä¸€æ¬¡æ€§å®šä¹‰ä¸€ä¸ªå·ï¼Œç„¶åæŠŠå®ƒæŒ‚åœ¨æ¯ä¸ªå®¹å™¨é‡Œï¼Œè¿™æ ·å®ƒä»¬å°±å¯ä»¥å…±äº«ä¸€ä¸ªå…±åŒçš„æ–‡ä»¶ç³»ç»Ÿã€‚æˆ–è€…ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ç”¨æ¥é€šä¿¡çš„ç½‘ç»œã€‚Docker Composeåªæ˜¯ä¸€ä¸ªåè°ƒå¤šä¸ªå®¹å™¨çš„å·¥å…·ã€‚å…¶ä»–é€‰æ‹©åŒ…æ‹¬Kubernetesã€Openshiftå’ŒApache MesosDockerå®¹å™¨è¿ç§»åˆ°å…¶ä»–æœåŠ¡å™¨çš„5ç§æ–¹æ³•è¯¦è§£_dockerç›®å½•æŒ‚è½½ä½¿ç”¨ Docker è¿è¡Œåï¼Œæˆ‘ä»¬æ”¹äº†é¡¹ç›®ä»£ç ä¸ä¼šç«‹åˆ»ç”Ÿæ•ˆï¼Œéœ€è¦é‡æ–°buildå’Œrunï¼Œå¾ˆæ˜¯éº»çƒ¦å®¹å™¨é‡Œé¢äº§ç”Ÿçš„æ•°æ®ï¼Œä¾‹å¦‚ log æ–‡ä»¶ï¼Œæ•°æ®åº“å¤‡ä»½æ–‡ä»¶ï¼Œå®¹å™¨åˆ é™¤åå°±ä¸¢å¤±äº†ç›®å½•æŒ‚è½½è§£å†³ä»¥ä¸Šé—®é¢˜bind mount ç›´æ¥æŠŠå®¿ä¸»æœºç›®å½•æ˜ å°„åˆ°å®¹å™¨å†…ï¼Œé€‚åˆæŒ‚ä»£ç ç›®å½•å’Œé…ç½®æ–‡ä»¶ã€‚å¯æŒ‚åˆ°å¤šä¸ªå®¹å™¨ä¸Švolume ç”±å®¹å™¨åˆ›å»ºå’Œç®¡ç†ï¼Œåˆ›å»ºåœ¨å®¿ä¸»æœºï¼Œæ‰€ä»¥åˆ é™¤å®¹å™¨ä¸ä¼šä¸¢å¤±ï¼Œå®˜æ–¹æ¨èï¼Œæ›´é«˜æ•ˆï¼ŒLinux æ–‡ä»¶ç³»ç»Ÿï¼Œé€‚åˆå­˜å‚¨æ•°æ®åº“æ•°æ®ã€‚å¯æŒ‚åˆ°å¤šä¸ªå®¹å™¨ä¸Štmpfs mount é€‚åˆå­˜å‚¨ä¸´æ—¶æ–‡ä»¶ï¼Œå­˜å®¿ä¸»æœºå†…å­˜ä¸­ã€‚ä¸å¯å¤šå®¹å™¨å…±äº«æ¼”ç¤º12345# bind mount æ–¹å¼docker run -p 8080:8080 --name test-hello -v D:/code:/app -d test:v1# volume æ–¹å¼docker run -p 8080:8080 --name test-hello -v db-data:/app -d test:v1å¤šå®¹å™¨é€šä¿¡è™šæ‹Ÿç½‘ç»œè¦æƒ³å¤šå®¹å™¨ä¹‹é—´äº’é€šï¼Œä» Web å®¹å™¨è®¿é—® Redis å®¹å™¨ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠä»–ä»¬æ”¾åˆ°åŒä¸ªç½‘ç»œä¸­å°±å¯ä»¥äº†åˆ›å»ºä¸€ä¸ªåä¸ºtest-netçš„ç½‘ç»œï¼š1docker network create test-netè¿è¡Œ Redis åœ¨ test-net ç½‘ç»œä¸­ï¼Œåˆ«åredis12# network-aliasæŒ‡çš„æ˜¯ç½‘ç»œçš„åˆ«ådocker run -d --name redis --network redis-net --network-alias redis redis:latestä½¿ç”¨æ—¶urlå¡«å†™redisï¼š//redis:6379è¿è¡Œ Web é¡¹ç›®ï¼Œä½¿ç”¨åŒä¸ªç½‘ç»œ1docker run -p 8080:8080 --name test -v D:/test:/app --network redis-net -d test:v0Docker-Composeå‡è®¾è¿è¡Œäº†ä¸¤ä¸ªå®¹å™¨ï¼šWeb é¡¹ç›® + Rediså¦‚æœé¡¹ç›®ä¾èµ–æ›´å¤šçš„ç¬¬ä¸‰æ–¹è½¯ä»¶ï¼Œæˆ‘ä»¬éœ€è¦ç®¡ç†çš„å®¹å™¨å°±æ›´åŠ å¤šï¼Œæ¯ä¸ªéƒ½è¦å•ç‹¬é…ç½®è¿è¡Œï¼ŒæŒ‡å®šç½‘ç»œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ docker-compose æŠŠé¡¹ç›®çš„å¤šä¸ªæœåŠ¡é›†åˆåˆ°ä¸€èµ·ï¼Œä¸€é”®è¿è¡Œå®‰è£… Docker Composeå¦‚æœä½ æ˜¯å®‰è£…çš„æ¡Œé¢ç‰ˆ Dockerï¼Œä¸éœ€è¦é¢å¤–å®‰è£…ï¼Œå·²ç»åŒ…å«äº†å¦‚æœæ˜¯æ²¡å›¾å½¢ç•Œé¢çš„æœåŠ¡å™¨ç‰ˆ Dockerï¼Œä½ éœ€è¦å•ç‹¬å®‰è£… å®‰è£…æ–‡æ¡£è¿è¡Œdocker-composeæ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸç¼–å†™è„šæœ¬è¦æŠŠé¡¹ç›®ä¾èµ–çš„å¤šä¸ªæœåŠ¡é›†åˆåˆ°ä¸€èµ·ï¼Œæˆ‘ä»¬éœ€è¦ç¼–å†™ä¸€ä¸ªdocker-compose.ymlæ–‡ä»¶ï¼Œæè¿°ä¾èµ–å“ªäº›æœåŠ¡å®¹å™¨é»˜è®¤æ—¶é—´ä¸æ˜¯åŒ—äº¬æ—¶é—´ï¼Œå¢åŠ  TZ=Asia/Shanghai å¯ä»¥æ”¹ä¸ºåŒ—äº¬æ—¶é—´1234567891011121314151617181920version: &quot;3.7&quot;services:  app:    build: ./  # æˆ–è€…ç›´æ¥ä½¿ç”¨é•œåƒ  image: narutohyc/ubuntu:v0    ports:      - 80:8080    volumes:      - ./:/app    environment:      - TZ=Asia/Shanghai  redis:    image: redis:5.0.13    volumes:      - redis:/data    environment:      - TZ=Asia/Shanghaivolumes:  redis:åœ¨docker-compose.yml æ–‡ä»¶æ‰€åœ¨ç›®å½•ï¼Œæ‰§è¡Œï¼šdocker-compose upå°±å¯ä»¥è·‘èµ·æ¥äº†ï¼Œæ–‡æ¡£åœ¨è¿™åœ¨åå°è¿è¡Œåªéœ€è¦åŠ ä¸€ä¸ª -d å‚æ•°docker-compose up -dåŠ¨ä½œå‘½ä»¤æŸ¥çœ‹è¿è¡ŒçŠ¶æ€docker-compose psåœæ­¢è¿è¡Œdocker-compose stopé‡å¯docker-compose restarté‡å¯å•ä¸ªæœåŠ¡docker-compose restart service-nameè¿›å…¥å®¹å™¨å‘½ä»¤è¡Œdocker-compose exec service-name shæŸ¥çœ‹å®¹å™¨è¿è¡Œlogdocker-compose logs [service-name]hello worldåˆ›å»ºdockfileï¼Œæ–°å»ºä¸€ä¸ªDockerfileæ–‡ä»¶123456789# ä½¿ç”¨åŸºç¡€é•œåƒï¼Œé€‰æ‹©é€‚åˆæ‚¨çš„ç¯å¢ƒFROM ubuntu:20.04# å®‰è£…ä¾èµ–åº“å’Œå·¥å…·RUN apt updateRUN apt-get install -y wget# è®¾ç½®å·¥ä½œç›®å½•WORKDIR /appæ„å»ºé•œåƒï¼Œåœ¨Dockerfileç›®å½•ä¸‹ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œ-tåé¢è·Ÿçš„æ˜¯é•œåƒåå’Œç‰ˆæœ¬ï¼Œè¿™é‡Œä¼šæ„å»ºä¸€ä¸ªfastchaté•œåƒï¼Œç‰ˆæœ¬å·ä¸ºv0ï¼Œ1docker build -t fastchat:v0 .å¦‚æœå‡ºç°ç½‘ç»œé—®é¢˜ï¼Œéœ€è¦é…ç½®ä»£ç†ï¼Œå¯ä»¥å¸¦ä¸Š--build-argå‚æ•°1docker build -t fastchat:v0 --build-arg http_proxy=http://192.168.0.xx:xx --build-arg https_proxy=http://192.168.0.xx:xx .å¦‚æœéœ€è¦æŒ‡å®šdockfileæ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨-få‚æ•°1docker build -f Q:\pyCharmWS\chatgpts\dockfiles\Dockerfile-ubuntu -t ubuntu:v0 . é™¤äº†è‡ªå·±å†™dockfileï¼Œè¿˜å¯ä»¥ä½¿ç”¨docker pullæ‹‰å–ç°æˆçš„é•œåƒæŸ¥çœ‹é•œåƒåˆ—è¡¨1234docker imagesREPOSITORY   TAG       IMAGE ID       CREATED          SIZEfastchat     v0        20ee81939779   20 seconds ago   115MBå¯åŠ¨é•œåƒ123docker run -itd -p 8080:80 --name ubuntu-test fastchat:v0&gt;&gt;&gt; 918a3b2ccc42436e01c5033021ba97d5bd4c56df48b2c549bf01855d9979333cdocker run -itdè¡¨ç¤ºåœ¨åå°è¿è¡Œå®¹å™¨ï¼Œå¹¶å…è®¸ä¸å®¹å™¨è¿›è¡Œäº¤äº’ï¼ŒåŒæ—¶ä¸ºå®¹å™¨åˆ†é…ä¸€ä¸ªä¼ªç»ˆç«¯å°†å®¹å™¨çš„80ç«¯å£æ˜ å°„åˆ°ä¸»æœºçš„8080ç«¯å£--name ubuntu-testç”¨äºæŒ‡å®šå®¹å™¨çš„åç§°ä¸º`ubuntu-testï¼Œè¿”å›ä¸€ä¸ªå®¹å™¨idå¦‚æœå·²æ‰§è¡Œå°±é€€å‡ºâ€™Exit(0)â€™ï¼Œå¯ä»¥åŠ ä¸Šå‚æ•°--entrypoint=/bin/bashï¼Œè¿™é‡Œä¼šè‡ªåŠ¨é€€å‡ºæ˜¯å› ä¸ºDockerå®¹å™¨åå°è¿è¡Œï¼Œå°±å¿…é¡»æœ‰ä¸€ä¸ªå‰å°è¿›ç¨‹ã€‚å®¹å™¨è¿è¡Œçš„å‘½ä»¤å¦‚æœä¸æ˜¯é‚£äº›ä¸€ç›´æŒ‚èµ·çš„å‘½ä»¤(æ¯”å¦‚è¿è¡Œtopï¼Œtail)å°±æ˜¯ä¼šè‡ªåŠ¨é€€å‡ºçš„æŸ¥çœ‹å®¹å™¨åˆ—è¡¨1234docker psCONTAINER ID   IMAGE         COMMAND       CREATED          STATUS          PORTS     NAMES918a3b2ccc42   fastchat:v0   &quot;/bin/bash&quot;   20 seconds ago   Up 19 seconds             ubuntu-testCONTAINER IDæŒ‡çš„æ˜¯å®¹å™¨IDè¿›å…¥å®¹å™¨execæ–¹å¼attachæ–¹å¼1docker exec -it ubuntu-test bashè¾“å…¥exité€€å‡ºï¼Œcontaineræ˜¯ä¸ä¼šè¢«å…³é—­çš„1docker attach ubuntu-testä½¿ç”¨å¿«æ·é”®é€€å‡ºï¼šæŒ‰ä¸‹é”®ç›˜ä¸Šçš„Ctrl + Pï¼Œç„¶åæŒ‰ä¸‹Ctrl + Qï¼Œcontaineræ˜¯ä¸ä¼šè¢«å…³é—­çš„æˆ–è€…è¾“å…¥exité€€å‡ºï¼Œcontaineræ˜¯ä¼šè¢«å…³é—­çš„è¿™ä¸ªç»„åˆé”®å¯ä»¥åˆ†ç¦»ç»ˆç«¯ä¸å®¹å™¨çš„è¿æ¥ï¼Œä½†ä¸ä¼šåœæ­¢å®¹å™¨çš„è¿è¡Œï¼Œå°†è¿”å›åˆ°å®¿ä¸»æœºçš„ç»ˆç«¯ï¼Œè€Œå®¹å™¨ä¼šç»§ç»­åœ¨åå°è¿è¡Œåœæ­¢å®¹å™¨1docker stop ubuntu-testå½“æ‚¨æ‰§è¡Œdocker stopå‘½ä»¤åœæ­¢å®¹å™¨åï¼Œå®¹å™¨çš„åç§°å¯èƒ½ä»ç„¶ä¿ç•™åœ¨Dockerä¸­ã€‚å¦‚æœæ‚¨å°è¯•ä½¿ç”¨ç›¸åŒçš„å®¹å™¨åç§°å†æ¬¡è¿è¡Œå®¹å™¨ï¼Œä¼šå‡ºç°â€é‡åâ€çš„é”™è¯¯123Q:\pyCharmWS\chatgpts\dockfiles&gt;docker run -itd --name ubuntu-test fastchat:v0docker: Error response from daemon: Conflict. The container name &quot;/ubuntu-test&quot; is already in use by container &quot;918a3b2ccc42436e01c5033021ba97d5bd4c56df48b2c549bf01855d9979333c&quot;. You have to remove (or rename) that container to be able to reuse that name.See 'docker run --help'.è¿™æ˜¯å› ä¸ºDockerè¦æ±‚å®¹å™¨åç§°åœ¨ç»™å®šçš„å‘½åç©ºé—´ä¸­å¿…é¡»æ˜¯å”¯ä¸€çš„ã€‚å½“æ‚¨åœæ­¢å®¹å™¨æ—¶ï¼Œè¯¥å®¹å™¨çš„åç§°ä¸ä¼šç«‹å³ä»Dockerä¸­åˆ é™¤ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥æŸ¥çœ‹å·²åœæ­¢å®¹å™¨çš„çŠ¶æ€å’Œæ—¥å¿—ç­‰ä¿¡æ¯è¿™æ—¶å€™å¯ä»¥æ›´æ”¹åŸæ¥å®¹å™¨çš„åç§°æˆ–åˆ é™¤å·²åœæ­¢çš„å®¹å™¨docker rename ubuntu-old ubuntu-test123Q:\pyCharmWS\chatgpts\dockfiles&gt;docker ps -aCONTAINER ID   IMAGE         COMMAND       CREATED          STATUS                        PORTS     NAMES918a3b2ccc42   fastchat:v0   &quot;/bin/bash&quot;   41 minutes ago   Exited (130) 11 minutes ago             ubuntu-testdocker rm ubuntu-testé‡å¯å®¹å™¨1docker restart ubuntu-testå°†å®¹å™¨ä¿å­˜ä¸ºé•œåƒï¼Œä»¥ä¾¿ç¨åå†æ¬¡ä½¿ç”¨æˆ–ä¸å…¶ä»–äººå…±äº«è¦å°†å®¹å™¨ä¿å­˜ä¸ºé•œåƒï¼Œå¯ä»¥ä½¿ç”¨docker commitå‘½ä»¤ã€‚ä»¥ä¸‹æ˜¯ä¿å­˜å®¹å™¨ä¸ºé•œåƒçš„æ­¥éª¤ï¼šç¡®ä¿æ‚¨çš„å®¹å™¨å¤„äºåœæ­¢çŠ¶æ€ã€‚å¦‚æœå®¹å™¨æ­£åœ¨è¿è¡Œï¼Œè¯·å…ˆåœæ­¢å®ƒï¼š1docker stop &lt;container_name_or_id&gt;ä½¿ç”¨docker commitå‘½ä»¤å°†å®¹å™¨ä¿å­˜ä¸ºé•œåƒã€‚åœ¨å‘½ä»¤ä¸­æŒ‡å®šå®¹å™¨çš„åç§°æˆ–IDä»¥åŠè¦ä¸ºæ–°é•œåƒæŒ‡å®šçš„åç§°å’Œæ ‡ç­¾ï¼š1docker commit &lt;container_name_or_id&gt; &lt;new_image_name:tag&gt;ä¾‹å¦‚ï¼š1docker commit mycontainer myimage:v1è¿™å°†åˆ›å»ºä¸€ä¸ªåä¸ºmyimageï¼Œæ ‡ç­¾ä¸ºv1çš„æ–°é•œåƒç­‰å¾…docker commitå‘½ä»¤å®Œæˆï¼Œå®ƒä¼šå°†å®¹å™¨çš„æ–‡ä»¶ç³»ç»Ÿå’Œå…ƒæ•°æ®ä¿å­˜ä¸ºæ–°çš„é•œåƒã€‚ä¸€æ—¦å®Œæˆï¼Œæ‚¨å¯ä»¥ä½¿ç”¨docker imageså‘½ä»¤æŸ¥çœ‹æ–°åˆ›å»ºçš„é•œåƒç°åœ¨ï¼Œæ‚¨å·²ç»å°†å®¹å™¨ä¿å­˜ä¸ºæ–°çš„é•œåƒã€‚æ‚¨å¯ä»¥ä½¿ç”¨è¯¥é•œåƒåˆ›å»ºæ–°çš„å®¹å™¨ï¼Œæˆ–å°†å…¶æ¨é€åˆ°é•œåƒä»“åº“ä»¥ä¾›å…¶ä»–äººä½¿ç”¨è¯·æ³¨æ„ï¼Œä½¿ç”¨docker commitå‘½ä»¤ä¿å­˜å®¹å™¨ä¸ºé•œåƒæ—¶ï¼Œé•œåƒå°†åŒ…å«å®¹å™¨ä¸­å½“å‰çš„æ–‡ä»¶ç³»ç»ŸçŠ¶æ€å’Œé…ç½®ã€‚è¿™æ„å‘³ç€å¦‚æœå®¹å™¨ä¸­æœ‰ä»»ä½•ä¸å¿…è¦çš„æ–‡ä»¶æˆ–æ•æ„Ÿä¿¡æ¯ï¼Œå®ƒä»¬ä¹Ÿä¼šåŒ…å«åœ¨ä¿å­˜çš„é•œåƒä¸­ã€‚å› æ­¤ï¼Œåœ¨ä¿å­˜å®¹å™¨ä¹‹å‰ï¼Œæœ€å¥½ç¡®ä¿å®¹å™¨ä¸­ä¸åŒ…å«ä¸å¿…è¦çš„æ–‡ä»¶ï¼Œå¹¶éµå¾ªæœ€ä½³å®è·µæ¥ä¿æŠ¤æ•æ„Ÿä¿¡æ¯å€¼å¾—ä¸€æçš„æ˜¯ï¼Œdocker commit å‘½ä»¤æ˜¯å°†å®¹å™¨çš„çŠ¶æ€ä¿å­˜ä¸ºé•œåƒï¼Œè€Œä¸æ˜¯æ¨èçš„æ–¹æ³•æ›´å¥½çš„åšæ³•æ˜¯ä½¿ç”¨ Dockerfile æ¥å®šä¹‰å®¹å™¨çš„é…ç½®å’ŒçŠ¶æ€ï¼Œå¹¶ä½¿ç”¨ docker build å‘½ä»¤æ„å»ºé•œåƒã€‚è¿™æ ·å¯ä»¥æ›´å¥½åœ°è·Ÿè¸ªå’Œç®¡ç†é•œåƒçš„å˜æ›´dockfileæ„å»ºä¸€ä¸ªåŸºäºubuntuçš„anacondaç¯å¢ƒ123456789101112131415161718192021222324252627# ä½¿ç”¨åŸºç¡€é•œåƒï¼Œé€‰æ‹©é€‚åˆæ‚¨çš„ç¯å¢ƒ# FROM arm64v8/ubuntu:20.04FROM ubuntu:20.04# å®‰è£…ä¾èµ–åº“å’Œå·¥å…·RUN apt updateRUN apt-get install -y wget# ä¸‹è½½å¹¶å®‰è£… Anaconda  https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/RUN wget -qO ~/anaconda.sh https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/Anaconda3-2023.03-0-Linux-x86_64.sh# RUN wget -qO ~/anaconda.sh https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/Anaconda3-2023.03-0-Linux-aarch64.shRUN /bin/bash ~/anaconda.sh -b -p /opt/anaconda3RUN rm ~/anaconda.sh# å°† Anaconda æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ENV PATH=&quot;/opt/anaconda3/bin:${PATH}&quot;RUN conda create -y -n chat38 python=3.8 anaconda# è®¾ç½®å·¥ä½œç›®å½•WORKDIR /app# æŒ‡å®šå…¨å±€ shell ç¯å¢ƒï¼Œè¿™æ ·æ‰èƒ½ç”¨sourceSHELL [&quot;/bin/bash&quot;, &quot;-c&quot;]# åˆ‡æ¢pyç¯å¢ƒCMD source activate chat38RUN pip install simplejsoné™¤äº†SHELL [&quot;/bin/bash&quot;, &quot;-c&quot;]ï¼Œè¿˜å¯ä»¥æ¯æ¬¡æŒ‡å®šbashç¯å¢ƒï¼ŒCMD /bin/bash -c &quot;source activate chat38&quot;å‘å¸ƒå’Œéƒ¨ç½²è¦å°†é•œåƒå‘å¸ƒåˆ° Docker Hub ä¸Šï¼Œéœ€è¦æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œæ“ä½œï¼šæ³¨å†Œ Docker Hub è´¦å·ï¼Œå¦‚æœä½ è¿˜æ²¡æœ‰ Docker Hub è´¦å·ï¼Œé¦–å…ˆéœ€è¦åœ¨Docker Hubçš„å®˜æ–¹ç½‘ç«™ä¸Šè¿›è¡Œæ³¨å†Œç™»å½• Docker Hubï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åœ¨ç»ˆç«¯ä¸­ç™»å½•åˆ° Docker Hub123Q:\pyCharmWS\chatgpts\dockfiles&gt;docker login -u narutohycPassword:Login Succeededæ ‡è®°é•œåƒï¼Œåœ¨å‘å¸ƒåˆ° Docker Hub ä¹‹å‰ï¼Œéœ€è¦ä¸ºé•œåƒæ·»åŠ ä¸€ä¸ªé€‚å½“çš„æ ‡ç­¾ï¼Œä»¥ä¾¿å°†å…¶ä¸ä½ çš„ Docker Hub ç”¨æˆ·åå’Œå­˜å‚¨åº“å…³è”èµ·æ¥ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä¸ºé•œåƒæ·»åŠ æ ‡ç­¾1docker tag &lt;IMAGE_ID&gt; &lt;DOCKER_HUB_USERNAME&gt;/&lt;REPOSITORY_NAME&gt;:&lt;TAG&gt;å…¶ä¸­ï¼Œ&lt;IMAGE_ID&gt; æ˜¯ä½ è¦å‘å¸ƒçš„é•œåƒçš„ IDï¼Œ&lt;DOCKER_HUB_USERNAME&gt; æ˜¯ä½ çš„ Docker Hub ç”¨æˆ·åï¼Œ&lt;REPOSITORY_NAME&gt; æ˜¯ä½ æƒ³è¦ä¸ºé•œåƒè®¾ç½®çš„å­˜å‚¨åº“åç§°ï¼Œ&lt;TAG&gt; æ˜¯ä¸€ä¸ªå¯é€‰çš„æ ‡ç­¾ï¼Œç”¨äºæ ‡è¯†é•œåƒçš„ç‰ˆæœ¬å·å‘å¸ƒé•œåƒï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å°†æ ‡è®°åçš„é•œåƒå‘å¸ƒåˆ° Docker Hub1docker push &lt;DOCKER_HUB_USERNAME&gt;/&lt;REPOSITORY_NAME&gt;:&lt;TAG&gt;è¿™å°†æŠŠé•œåƒæ¨é€åˆ° Docker Hub ä¸Šçš„æŒ‡å®šå­˜å‚¨åº“ä¸­ç¡®è®¤å‘å¸ƒï¼Œç™»å½•åˆ° Docker Hub çš„ç½‘ç«™ï¼Œè®¿é—®ä½ çš„ Docker Hub è´¦å·ï¼Œä½ åº”è¯¥èƒ½å¤Ÿåœ¨ç›¸åº”çš„å­˜å‚¨åº“ä¸­çœ‹åˆ°å·²å‘å¸ƒçš„é•œåƒè¯·æ³¨æ„ï¼Œå‘å¸ƒåˆ° Docker Hub çš„é•œåƒå°†æˆä¸ºå…¬å¼€å¯è®¿é—®çš„ï¼Œä»»ä½•äººéƒ½å¯ä»¥ä» Docker Hub ä¸Šè·å–å¹¶ä½¿ç”¨è¯¥é•œåƒã€‚å¦‚æœä½ å¸Œæœ›é™åˆ¶è®¿é—®æƒé™ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ç§æœ‰ä»“åº“ï¼Œæˆ–è€…åœ¨ Docker Hub ä¸Šåˆ›å»ºä¸€ä¸ªç§æœ‰çš„ç»„ç»‡æ¥ç®¡ç†é•œåƒçš„è®¿é—®æƒé™ç¤ºä¾‹æ¼”ç¤º Docker å®‰è£… Redisä¸€ä¸ªå‘½ä»¤è·‘èµ·æ¥ï¼šdocker run -d -p 6379:6379 --name redis redis:latestå‘½ä»¤å‚è€ƒï¼šhttps://docs.docker.com/engine/reference/commandline/run/å®‰è£… Wordpresså®šä¹‰docker-compose.ymlæ–‡ä»¶12345678910111213141516171819202122232425262728293031version: '3.1'services:  wordpress:    image: wordpress    restart: always    ports:      - 8080:80    environment:      WORDPRESS_DB_HOST: db      WORDPRESS_DB_USER: exampleuser      WORDPRESS_DB_PASSWORD: examplepass      WORDPRESS_DB_NAME: exampledb    volumes:      - wordpress:/var/www/html  db:    image: mysql:5.7    restart: always    environment:      MYSQL_DATABASE: exampledb      MYSQL_USER: exampleuser      MYSQL_PASSWORD: examplepass      MYSQL_RANDOM_ROOT_PASSWORD: '1'    volumes:      - db:/var/lib/mysqlvolumes:  wordpress:  db:æ‰§è¡Œdocker-compose up -då®æˆ˜neo4jdockerå®‰è£…éƒ¨ç½²neo4jå®‰è£…neo4jæ‹‰å–neo4jé•œåƒä»dockerå®˜æ–¹é•œåƒä¸­æ‰¾åˆé€‚çš„é•œåƒ1docker search neo4jæ‹‰å–é•œåƒæº1docker pull neo4j(:ç‰ˆæœ¬å·) # ç¼ºçœ &quot;:ç‰ˆæœ¬å·&quot; æ—¶é»˜è®¤å®‰è£…latestç‰ˆæœ¬çš„æŸ¥çœ‹æœ¬åœ°é•œåƒï¼Œæ£€éªŒæ˜¯å¦æ‹‰å–æˆåŠŸ1docker imageså›¾ç®—æ³•æ’ä»¶neo4jæä¾›äº†ä¸€ç³»åˆ—å¸¸ç”¨çš„å›¾ç®—æ³•ï¼Œè¯¥ç®—æ³•åº“éœ€è¦å•ç‹¬å®‰è£…ï¼Œæ³¨æ„ç‰ˆæœ¬å¯¹åº”å…³ç³»ç‚¹å‡»ä¸Šæ–¹å®˜ç½‘é“¾æ¥ï¼Œä¸‹è½½Neo4j Graph Data Scienceä¸‹çš„æ–‡ä»¶ï¼Œæ”¾åˆ°$NEO4J_HOME/pluginsç›®å½•ä¸­å°†ä»¥ä¸‹å†…å®¹æ·»åŠ åˆ°æ‚¨çš„$NEO4J_HOME/conf/neo4j.confæ–‡ä»¶ä¸­ï¼Œå‚è€ƒè¿™é‡Œ1dbms.security.procedures.unrestricted=apoc.*,gds.*æ­¤é…ç½®æ¡ç›®æ˜¯å¿…éœ€çš„ï¼Œå› ä¸º GDS åº“è®¿é—® Neo4j çš„ä½çº§ç»„ä»¶ä»¥æœ€å¤§åŒ–æ€§èƒ½é‡å¯ Neo4jï¼Œåœ¨dockerä¸‹å°±æ˜¯é‡å¯ä¸ºäº†éªŒè¯æ‚¨çš„å®‰è£…ï¼Œå¯ä»¥è¾“å…¥ä»¥ä¸‹å‘½ä»¤1RETURN gds.version()è¦åˆ—å‡ºæ‰€æœ‰å·²å®‰è£…çš„ç®—æ³•ï¼Œè¯·è¿è¡Œä»¥ä¸‹gds.list()è¿‡ç¨‹1CALL gds.list()ä¾‹å­: neo4jå®ç°PageRankç®—æ³•å¯åŠ¨neo4jæ‰¾ä¸€ä¸ªç›®å½•å­˜æ”¾dockerçš„å„é•œåƒè¿è¡Œç›®å½•ï¼Œæ¯”å¦‚æˆ‘è¿™é‡Œé€‰çš„æ˜¯/home/huangyc/dockerç„¶åå†åœ¨è¿™ä¸ªç›®å½•æ–°å»ºå…·ä½“çš„é•œåƒå¯¹åº”çš„æ–‡ä»¶å¤¹/home/huangyc/docker/neo4jï¼Œåœ¨ä¸‹é¢æ–°å»ºå››ä¸ªæ–‡ä»¶å¤¹(å®é™…ä¸Šå¥½åƒä¸éœ€è¦æ‰‹åŠ¨å»ºï¼Œæ‰§è¡Œå‘½ä»¤æ—¶è‡ªåŠ¨ä¼šæ–°å»º)data: æ•°æ®å­˜æ”¾çš„æ–‡ä»¶å¤¹logs: è¿è¡Œçš„æ—¥å¿—æ–‡ä»¶å¤¹conf: æ•°æ®åº“é…ç½®æ–‡ä»¶å¤¹(åœ¨é…ç½®æ–‡ä»¶neo4j.confä¸­é…ç½®åŒ…æ‹¬å¼€æ”¾è¿œç¨‹è¿æ¥ã€è®¾ç½®é»˜è®¤æ¿€æ´»çš„æ•°æ®åº“)import: ä¸ºäº†å¤§æ‰¹é‡å¯¼å…¥csvæ¥æ„å»ºæ•°æ®åº“ï¼Œéœ€è¦å¯¼å…¥çš„èŠ‚ç‚¹æ–‡ä»¶nodes.csvå’Œå…³ç³»æ–‡ä»¶rel.csvéœ€è¦æ”¾åˆ°è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹plugins: å­˜æ”¾jaræ’ä»¶å¯åŠ¨å‘½ä»¤æ ¼å¼å¦‚ä¸‹123456789docker run -d --name container_name \  //-dè¡¨ç¤ºå®¹å™¨åå°è¿è¡Œ --nameæŒ‡å®šå®¹å™¨åå­—-p 7474:7474 -p 7687:7687 \  //æ˜ å°„å®¹å™¨çš„ç«¯å£å·åˆ°å®¿ä¸»æœºçš„ç«¯å£å·-v /home/huangyc/docker/neo4j/data:/data \  //æŠŠå®¹å™¨å†…çš„æ•°æ®ç›®å½•æŒ‚è½½åˆ°å®¿ä¸»æœºçš„å¯¹åº”ç›®å½•ä¸‹-v /home/huangyc/docker/neo4j/logs:/logs \  //æŒ‚è½½æ—¥å¿—ç›®å½•-v /home/huangyc/docker/neo4j/conf:/var/lib/neo4j/conf   //æŒ‚è½½é…ç½®ç›®å½•-v /home/huangyc/docker/neo4j/import:/var/lib/neo4j/import \  //æŒ‚è½½æ•°æ®å¯¼å…¥ç›®å½•-v /home/huangyc/docker/neo4j/plugins:/var/lib/neo4j/plugins \  //æŒ‚è½½æ•°æ®å¯¼å…¥ç›®å½•--env NEO4J_AUTH=neo4j/password \  //è®¾å®šæ•°æ®åº“çš„ç”¨æˆ·åå’Œå’Œå¯†ç neo4j //æŒ‡å®šä½¿ç”¨çš„é•œåƒä¹Ÿå¯ä»¥å†™æˆå•è¡Œå‘½ä»¤1docker run -d --name neo4j_hyc -p 7474:7474 -p 7687:7687 -v /home/huangyc/docker/neo4j/data:/data -v /home/huangyc/docker/neo4j/logs:/logs -v /home/huangyc/docker/neo4j/conf:/var/lib/neo4j/conf -v /home/huangyc/docker/neo4j/import:/var/lib/neo4j/import -v /home/huangyc/docker/neo4j/plugins:/var/lib/neo4j/plugins --env NEO4J_AUTH=neo4j/hyc neo4jpyåº“ä½¿ç”¨Pythonè®¿é—®å›¾æ•°æ®åº“ï¼Œä¸»è¦ä½¿ç”¨çš„åº“æ—¶py2neoå’Œneo4jï¼Œpy2neoé€šè¿‡æ“ä½œpythonå˜é‡ï¼Œè¾¾åˆ°æ“ä½œneo4jçš„ç›®çš„ï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒcypherè¯­æ³•neo4jä¸»è¦æ—¶æ‰§è¡ŒCQL(cypher)è¯­å¥cypher è¯­æ³•py2neoneo4jå®‰è£…1pip install py2neoä½¿ç”¨ä¾‹å­12345678910111213141516171819202122232425262728293031323334# coding:utf-8from py2neo import Graph, Node, Relationship # è¿æ¥neo4jæ•°æ®åº“ï¼Œè¾“å…¥åœ°å€ã€ç”¨æˆ·åã€å¯†ç graph = Graph(&quot;http://192.168.1.106:7474&quot;, name=&quot;neo4j&quot;)graph.delete_all()# åˆ›å»ºç»“ç‚¹test_node_1 = Node('ru_yi_zhuan', name='çš‡å¸') # ä¿®æ”¹çš„éƒ¨åˆ†test_node_2 = Node('ru_yi_zhuan', name='çš‡å') # ä¿®æ”¹çš„éƒ¨åˆ†test_node_3 = Node('ru_yi_zhuan', name='å…¬ä¸»') # ä¿®æ”¹çš„éƒ¨åˆ† graph.create(test_node_1)graph.create(test_node_2)graph.create(test_node_3) # åˆ›å»ºå…³ç³»# åˆ†åˆ«å»ºç«‹äº†test_node_1æŒ‡å‘test_node_2å’Œtest_node_2æŒ‡å‘test_node_1ä¸¤æ¡å…³ç³»ï¼Œå…³ç³»çš„ç±»å‹ä¸º&quot;ä¸ˆå¤«ã€å¦»å­&quot;ï¼Œä¸¤æ¡å…³ç³»éƒ½æœ‰å±æ€§countï¼Œä¸”å€¼ä¸º1ã€‚node_1_zhangfu_node_1 = Relationship(test_node_1, 'ä¸ˆå¤«', test_node_2)node_1_zhangfu_node_1['count'] = 1node_2_qizi_node_1 = Relationship(test_node_2, 'å¦»å­', test_node_1)node_2_munv_node_1 = Relationship(test_node_2, 'æ¯å¥³', test_node_3) node_2_qizi_node_1['count'] = 1 graph.create(node_1_zhangfu_node_1)graph.create(node_2_qizi_node_1)graph.create(node_2_munv_node_1) print(graph)print(test_node_1)print(test_node_2)print(node_1_zhangfu_node_1)print(node_2_qizi_node_1)print(node_2_munv_node_1) å®‰è£…1pip install neo4jä½¿ç”¨ä¾‹å­12345678910111213141516171819from neo4j import GraphDatabasedriver = GraphDatabase.driver(&quot;bolt://localhost:7687&quot;, auth=(&quot;neo4j&quot;, &quot;password&quot;))def add_friend(tx, name, friend_name):    tx.run(&quot;MERGE (a:Person {name: $name}) &quot;           &quot;MERGE (a)-[:KNOWS]-&gt;(friend:Person {name: $friend_name})&quot;,           name=name, friend_name=friend_name)def print_friends(tx, name):    for record in tx.run(&quot;MATCH (a:Person)-[:KNOWS]-&gt;(friend) WHERE a.name = $name &quot;                         &quot;RETURN friend.name ORDER BY friend.name&quot;, name=name):        print(record[&quot;friend.name&quot;])with driver.session() as session:    session.write_transaction(add_friend, &quot;Arthur&quot;, &quot;Guinevere&quot;)    session.write_transaction(add_friend, &quot;Arthur&quot;, &quot;Lancelot&quot;)    session.write_transaction(add_friend, &quot;Arthur&quot;, &quot;Merlin&quot;)    session.read_transaction(print_friends, &quot;Arthur&quot;)å®æˆ˜nebulaåŸºæœ¬ä»‹ç»NebulaGraph ç”±ä¸‰ç§æœåŠ¡æ„æˆï¼šGraph æœåŠ¡ã€Meta æœåŠ¡å’Œ Storage æœåŠ¡ï¼Œæ˜¯ä¸€ç§å­˜å‚¨ä¸è®¡ç®—åˆ†ç¦»çš„æ¶æ„Meta æœåŠ¡Meta æœåŠ¡æ˜¯ç”± nebula-metad è¿›ç¨‹æä¾›çš„ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®åœºæ™¯é…ç½® nebula-metad è¿›ç¨‹æ•°é‡ï¼šæµ‹è¯•ç¯å¢ƒä¸­ï¼Œç”¨æˆ·å¯ä»¥åœ¨ NebulaGraph é›†ç¾¤ä¸­éƒ¨ç½² 1 ä¸ªæˆ– 3 ä¸ª nebula-metad è¿›ç¨‹ã€‚å¦‚æœè¦éƒ¨ç½² 3 ä¸ªï¼Œç”¨æˆ·å¯ä»¥å°†å®ƒä»¬éƒ¨ç½²åœ¨ 1 å°æœºå™¨ä¸Šï¼Œæˆ–è€…åˆ†åˆ«éƒ¨ç½²åœ¨ä¸åŒçš„æœºå™¨ä¸Šã€‚ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå»ºè®®åœ¨ NebulaGraph é›†ç¾¤ä¸­éƒ¨ç½² 3 ä¸ª nebula-metad è¿›ç¨‹ã€‚è¯·å°†è¿™äº›è¿›ç¨‹éƒ¨ç½²åœ¨ä¸åŒçš„æœºå™¨ä¸Šä»¥ä¿è¯é«˜å¯ç”¨ã€‚æ‰€æœ‰ nebula-metad è¿›ç¨‹æ„æˆäº†åŸºäº Raft åè®®çš„é›†ç¾¤ï¼Œå…¶ä¸­ä¸€ä¸ªè¿›ç¨‹æ˜¯ leaderï¼Œå…¶ä»–è¿›ç¨‹éƒ½æ˜¯ followerã€‚leader æ˜¯ç”±å¤šæ•°æ´¾é€‰ä¸¾å‡ºæ¥ï¼Œåªæœ‰ leader èƒ½å¤Ÿå¯¹å®¢æˆ·ç«¯æˆ–å…¶ä»–ç»„ä»¶æä¾›æœåŠ¡ï¼Œå…¶ä»– follower ä½œä¸ºå€™è¡¥ï¼Œå¦‚æœ leader å‡ºç°æ•…éšœï¼Œä¼šåœ¨æ‰€æœ‰ follower ä¸­é€‰ä¸¾å‡ºæ–°çš„ leaderã€‚Graph æœåŠ¡Graph æœåŠ¡æ˜¯ç”±nebula-graphd è¿›ç¨‹æä¾›ï¼ŒæœåŠ¡ä¸»è¦è´Ÿè´£å¤„ç†æŸ¥è¯¢è¯·æ±‚ï¼ŒåŒ…æ‹¬è§£ææŸ¥è¯¢è¯­å¥ã€æ ¡éªŒè¯­å¥ã€ç”Ÿæˆæ‰§è¡Œè®¡åˆ’ä»¥åŠæŒ‰ç…§æ‰§è¡Œè®¡åˆ’æ‰§è¡Œå››ä¸ªå¤§æ­¥éª¤ï¼ŒæŸ¥è¯¢è¯·æ±‚å‘é€åˆ° Graph æœåŠ¡åï¼Œä¼šç”±å¦‚ä¸‹æ¨¡å—ä¾æ¬¡å¤„ç†ï¼šParserï¼šè¯æ³•è¯­æ³•è§£ææ¨¡å—ã€‚Validatorï¼šè¯­ä¹‰æ ¡éªŒæ¨¡å—ã€‚Plannerï¼šæ‰§è¡Œè®¡åˆ’ä¸ä¼˜åŒ–å™¨æ¨¡å—ã€‚Executorï¼šæ‰§è¡Œå¼•æ“æ¨¡å—ã€‚Storage æœåŠ¡NebulaGraph çš„å­˜å‚¨åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸€ä¸ªæ˜¯ Meta ç›¸å…³çš„å­˜å‚¨ï¼Œç§°ä¸º Meta æœåŠ¡ï¼Œåœ¨å‰æ–‡å·²æœ‰ä»‹ç»ã€‚å¦ä¸€ä¸ªæ˜¯å…·ä½“æ•°æ®ç›¸å…³çš„å­˜å‚¨ï¼Œç§°ä¸º Storage æœåŠ¡ã€‚å…¶è¿è¡Œåœ¨ nebula-storaged è¿›ç¨‹ä¸­ç¯å¢ƒæ­å»ºä»¥nebula 3.2.1ä¸ºä¾‹ä¸‹è½½å¹¶å®‰è£…NebulaGraph12wget https://oss-cdn.nebula-graph.com.cn/package/3.2.1/nebula-graph-3.2.1.el7.x86_64.rpmsudo rpm -ivh --prefix=/home/huangyc/nebula nebula-graph-3.2.1.el7.x86_64.rpm--prefixä¸ºå¯é€‰é¡¹ï¼Œç”¨äºæŒ‡å®šå®‰è£…è·¯å¾„å¦‚ä¸è®¾ç½®ï¼Œç³»ç»Ÿä¼šå°† NebulaGraph å®‰è£…åˆ°é»˜è®¤è·¯å¾„/usr/local/nebula/é›†ç¾¤é…ç½®é›†ç¾¤é…ç½®éœ€è¦ä¿è¯é›†ç¾¤æœºå™¨é…ç½®sshå…å¯†ä¿®æ”¹æ¯ä¸ªæœåŠ¡å™¨ä¸Šçš„ NebulaGraph é…ç½®æ–‡ä»¶NebulaGraph çš„æ‰€æœ‰é…ç½®æ–‡ä»¶å‡ä½äºå®‰è£…ç›®å½•çš„etcç›®å½•å†…ï¼ŒåŒ…æ‹¬nebula-graphd.confã€nebula-metad.confå’Œnebula-storaged.confï¼Œç”¨æˆ·å¯ä»¥åªä¿®æ”¹æ‰€éœ€æœåŠ¡çš„é…ç½®æ–‡ä»¶ã€‚å„ä¸ªæœºå™¨éœ€è¦ä¿®æ”¹çš„é…ç½®æ–‡ä»¶å¦‚ä¸‹ã€‚æœºå™¨åç§°å¾…ä¿®æ”¹é…ç½®æ–‡ä»¶Anebula-graphd.confã€nebula-storaged.confã€nebula-metad.confBnebula-graphd.confã€nebula-storaged.confã€nebula-metad.confCnebula-graphd.confã€nebula-storaged.confã€nebula-metad.confDnebula-graphd.confã€nebula-storaged.confEnebula-graphd.confã€nebula-storaged.confæœºå™¨ A é…ç½®nebula-graphd.conf1234567891011########## networking ########### Comma separated Meta Server Addresses--meta_server_addrs=192.168.10.111:9559,192.168.10.112:9559,192.168.10.113:9559# Local IP used to identify the nebula-graphd process.# Change it to an address other than loopback if the service is distributed or# will be accessed remotely.--local_ip=192.168.10.111# Network device to listen on--listen_netdev=any# Port to listen on--port=9669nebula-storaged.conf123456789########## networking ########### Comma separated Meta server addresses--meta_server_addrs=192.168.10.111:9559,192.168.10.112:9559,192.168.10.113:9559# Local IP used to identify the nebula-storaged process.# Change it to an address other than loopback if the service is distributed or# will be accessed remotely.--local_ip=192.168.10.111# Storage daemon listening port--port=9779nebula-metad.conf123456789########## networking ########### Comma separated Meta Server addresses--meta_server_addrs=192.168.10.111:9559,192.168.10.112:9559,192.168.10.113:9559# Local IP used to identify the nebula-metad process.# Change it to an address other than loopback if the service is distributed or# will be accessed remotely.--local_ip=192.168.10.111# Meta daemon listening port--port=9559æœºå™¨ D é…ç½®nebula-graphd.conf1234567891011########## networking ########### Comma separated Meta Server Addresses--meta_server_addrs=192.168.10.111:9559,192.168.10.112:9559,192.168.10.113:9559# Local IP used to identify the nebula-graphd process.# Change it to an address other than loopback if the service is distributed or# will be accessed remotely.--local_ip=192.168.10.114# Network device to listen on--listen_netdev=any# Port to listen on--port=9669nebula-storaged.conf123456789########## networking ########### Comma separated Meta server addresses--meta_server_addrs=192.168.10.111:9559,192.168.10.112:9559,192.168.10.113:9559# Local IP used to identify the nebula-storaged process.# Change it to an address other than loopback if the service is distributed or# will be accessed remotely.--local_ip=192.168.10.114# Storage daemon listening port--port=9779ABCä¸‰å°é…ç½®é™¤äº†local_ipï¼Œå…¶ä»–éƒ½ä¸€è‡´ï¼ŒDEä¸¤å°é…ç½®é™¤äº†local_ipï¼Œå…¶ä»–éƒ½ä¸€è‡´å¯åŠ¨æœåŠ¡å‘½ä»¤å­¦ä¹ ä½¿ç”¨è„šæœ¬nebula.serviceç®¡ç†æœåŠ¡ï¼ŒåŒ…æ‹¬å¯åŠ¨ã€åœæ­¢ã€é‡å¯ã€ä¸­æ­¢å’ŒæŸ¥çœ‹nebula.serviceçš„é»˜è®¤è·¯å¾„æ˜¯/usr/local/nebula/scriptsï¼Œå¦‚æœä¿®æ”¹è¿‡å®‰è£…è·¯å¾„ï¼Œè¯·ä½¿ç”¨å®é™…è·¯å¾„è¯­æ³•1234sudo /usr/local/nebula/scripts/nebula.service[-v] [-c &lt;config_file_path&gt;]&lt;start | stop | restart | kill | status&gt;&lt;metad | graphd | storaged | all&gt;æ¯”å¦‚å¯¹äºéå®¹å™¨éƒ¨ç½²çš„ NebulaGraphï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å¯åŠ¨æœåŠ¡ï¼š1234567sudo /usr/local/nebula/scripts/nebula.service start all[INFO] Starting nebula-metad...[INFO] Done[INFO] Starting nebula-graphd...[INFO] Done[INFO] Starting nebula-storaged...[INFO] Doneæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹ NebulaGraph æœåŠ¡çŠ¶æ€1sudo /usr/local/nebula/scripts/nebula.service status allå¦‚æœè¿”å›å¦‚ä¸‹ç»“æœï¼Œè¡¨ç¤º NebulaGraph æœåŠ¡æ­£å¸¸è¿è¡Œ12345[INFO] nebula-metad(33fd35e): Running as 29020, Listening on 9559[INFO] nebula-graphd(33fd35e): Running as 29095, Listening on 9669[WARN] nebula-storaged after v3.0.0 will not start service until it is added to cluster.[WARN] See Manage Storage hosts:ADD HOSTS in https://docs.nebula-graph.io/[INFO] nebula-storaged(33fd35e): Running as 29147, Listening on 9779æ­£å¸¸å¯åŠ¨ NebulaGraph åï¼Œnebula-storagedè¿›ç¨‹çš„ç«¯å£æ˜¾ç¤ºçº¢è‰²ã€‚è¿™æ˜¯å› ä¸ºnebula-storagedåœ¨å¯åŠ¨æµç¨‹ä¸­ä¼šç­‰å¾…nebula-metadæ·»åŠ å½“å‰ Storage æœåŠ¡ï¼Œå½“å‰ Storage æœåŠ¡æ”¶åˆ° Ready ä¿¡å·åæ‰ä¼šæ­£å¼å¯åŠ¨æœåŠ¡ã€‚ä» 3.0.0 ç‰ˆæœ¬å¼€å§‹ï¼Œåœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ çš„ Storage èŠ‚ç‚¹æ— æ³•ç›´æ¥è¯»å†™ï¼Œé…ç½®æ–‡ä»¶çš„ä½œç”¨ä»…ä»…æ˜¯å°† Storage èŠ‚ç‚¹æ³¨å†Œè‡³ Meta æœåŠ¡ä¸­ã€‚å¿…é¡»ä½¿ç”¨ADD HOSTSå‘½ä»¤åï¼Œæ‰èƒ½æ­£å¸¸è¯»å†™ Storage èŠ‚ç‚¹ã€‚æ³¨å†Œå…·ä½“æ˜¯é€šè¿‡nebula-consoleå‘½ä»¤è¡Œæˆ–è€…studioé¡µé¢æ‰§è¡Œï¼Œç”¨ java client ä¹Ÿå¯ä»¥çš„, åº•å±‚é€»è¾‘éƒ½æ˜¯é€šè¿‡å®¢æˆ·ç«¯å‘é€ä¸€æ¡ add hosts xxxxx query1ADD HOSTS 192.168.40.39:9779, 192.168.40.40:9779, 192.168.40.41:9779;æ¯”å¦‚ä½¿ç”¨pythonå®¢æˆ·ç«¯12345678910111213141516from nebula3.gclient.net import ConnectionPoolfrom nebula3.Config import Config# define a configconfig = Config()config.max_connection_pool_size = 10# init connection poolconnection_pool = ConnectionPool()# if the given servers are ok, return true, else return falseok = connection_pool.init([('192.168.123.xx', 9669)], config)# option 1 control the connection release yourself# get session from the poolsession = connection_pool.get_session('root', 'nebula')session.execute(&quot;ADD HOSTS 192.168.123.24:9779&quot;)ç­‰å¾…20såï¼Œé‡æ–°æŸ¥çœ‹æœåŠ¡çŠ¶æ€ï¼Œå‘ç°è­¦å‘Šæ²¡æœ‰å°±è¯´æ˜æˆåŠŸäº†12345[root@localhost nebula]# sudo scripts/nebula.service status all[WARN] The maximum files allowed to open might be too few: 1024[INFO] nebula-metad(bb2e684): Running as 11660, Listening on 9559[INFO] nebula-graphd(bb2e684): Running as 11727, Listening on 9669[INFO] nebula-storaged(bb2e684): Running as 11764, Listening on 9779æ¸…ç©ºå›¾æ•°æ®æ¸…é™¤åï¼Œå¦‚æ— å¤‡ä»½ï¼Œæ— æ³•æ¢å¤ã€‚ä½¿ç”¨è¯¥åŠŸèƒ½åŠ¡å¿…è°¨æ…CLEAR SPACEä¸æ˜¯åŸå­æ€§æ“ä½œã€‚å¦‚æœæ‰§è¡Œå‡ºé”™ï¼Œè¯·é‡æ–°æ‰§è¡Œï¼Œé¿å…æ®‹ç•™æ•°æ®å›¾ç©ºé—´ä¸­çš„æ•°æ®é‡è¶Šå¤§ï¼ŒCLEAR SPACEæ¶ˆè€—çš„æ—¶é—´è¶Šé•¿å¦‚æœCLEAR SPACEçš„æ‰§è¡Œå› å®¢æˆ·ç«¯è¿æ¥è¶…æ—¶è€Œå¤±è´¥ï¼Œå¯ä»¥å¢å¤§ Graph æœåŠ¡é…ç½®ä¸­storage_client_timeout_mså‚æ•°çš„å€¼åœ¨CLEAR SPACEçš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå‘è¯¥å›¾ç©ºé—´å†™å…¥æ•°æ®çš„è¡Œä¸ºä¸ä¼šè¢«è‡ªåŠ¨ç¦æ­¢è¿™æ ·çš„å†™å…¥è¡Œä¸ºå¯èƒ½å¯¼è‡´CLEAR SPACEæ¸…é™¤æ•°æ®ä¸å®Œå…¨ï¼Œæ®‹ç•™çš„æ•°æ®ä¹Ÿå¯èƒ½å—åˆ°æŸå1CLEAR SPACE [IF EXISTS] &lt;space_name&gt;;ä¿ç•™çš„æ•°æ®Â¶å›¾ç©ºé—´ä¸­ï¼ŒCLEAR SPACEä¸ä¼šåˆ é™¤çš„æ•°æ®åŒ…æ‹¬ï¼šTag ä¿¡æ¯Edge type ä¿¡æ¯åŸç”Ÿç´¢å¼•å’Œå…¨æ–‡ç´¢å¼•çš„å…ƒæ•°æ®DROP SPACEè¯­å¥ç”¨äºåˆ é™¤æŒ‡å®šå›¾ç©ºé—´ä»¥åŠå…¶ä¸­çš„æ‰€æœ‰ä¿¡æ¯1DROP SPACE [IF EXISTS] &lt;graph_space_name&gt;;å®¢æˆ·ç«¯NebulaGraph æ”¯æŒå¤šç§ç±»å‹çš„å®¢æˆ·ç«¯ï¼ŒåŒ…æ‹¬å‘½ä»¤è¡Œå®¢æˆ·ç«¯ã€å¯è§†åŒ–ç•Œé¢å®¢æˆ·ç«¯å’Œæµè¡Œç¼–ç¨‹è¯­è¨€å®¢æˆ·ç«¯è¯¦æƒ…å‚è§å®¢æˆ·ç«¯åˆ—è¡¨åŸç”ŸCLIå®¢æˆ·ç«¯pythonå®¢æˆ·ç«¯å‰ææ¡ä»¶Â¶å®˜æ–¹æ–‡æ¡£NebulaGraph æœåŠ¡å·²å¯åŠ¨è¿è¡Œ NebulaGraph Console çš„æœºå™¨å’Œè¿è¡Œ NebulaGraph çš„æœåŠ¡å™¨ç½‘ç»œäº’é€šNebulaGraph Console çš„ç‰ˆæœ¬å…¼å®¹ NebulaGraph çš„ç‰ˆæœ¬ä½¿ç”¨å‘½ä»¤archï¼ŒæŸ¥çœ‹ç³»ç»Ÿç»“æ„ï¼Œå»å®˜ç½‘ä¸‹è½½å®‰è£…åŒ…ï¼Œé‡å‘½åæ–‡ä»¶ä¸ºnebula_consoleä¸ºç”¨æˆ·æˆäºˆ nebula-console æ–‡ä»¶çš„æ‰§è¡Œæƒé™1chmod 111 nebula-consoleåœ¨å‘½ä»¤è¡Œç•Œé¢ä¸­ï¼Œåˆ‡æ¢å·¥ä½œç›®å½•è‡³ nebula-console æ–‡ä»¶æ‰€åœ¨ç›®å½•ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤è¿æ¥ NebulaGraph1./nebula-console -addr &lt;ip&gt; -port &lt;port&gt; -u &lt;username&gt; -p &lt;password&gt; [-t 120] [-e &quot;nGQL_statement&quot; | -f filename.nGQL]ä¾‹å¦‚ï¼Œè¦è¿æ¥åˆ°éƒ¨ç½²åœ¨ 192.168.10.8 ä¸Šçš„ Graph æœåŠ¡ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤1./nebula_console -addr 192.168.10.8 -port 9669 -u root -p nebulaå·²å®‰è£… Pythonï¼Œç‰ˆæœ¬ä¸º 3.6 åŠä»¥ä¸Šï¼Œç‰ˆæœ¬å¯¹ç…§è¡¨Â¶NebulaGraph ç‰ˆæœ¬NebulaGraph Python ç‰ˆæœ¬3.2.13.1.02.6.x2.6.0pipå®‰è£…1$ pip install nebula3-python==&lt;version&gt;åˆå§‹åŒ–ä¸€äº›æ•°æ®æ‰§è¡Œå¦‚ä¸‹è¯­å¥åˆ›å»ºåä¸ºbasketballplayerçš„å›¾ç©ºé—´1CREATE SPACE basketballplayer(partition_num=15, replica_factor=1, vid_type=fixed_string(32));æ‰§è¡Œå‘½ä»¤SHOW HOSTSæ£€æŸ¥åˆ†ç‰‡çš„åˆ†å¸ƒæƒ…å†µï¼Œç¡®ä¿å¹³è¡¡åˆ†å¸ƒ12345678nebula&gt; SHOW HOSTS;+-------------+-----------+-----------+-----------+--------------+----------------------------------+------------------------+---------+| Host        | Port      | HTTP port | Status    | Leader count | Leader distribution              | Partition distribution | Version |+-------------+-----------+-----------+-----------+--------------+----------------------------------+------------------------+---------+| &quot;storaged0&quot; | 9779      | 19669     | &quot;ONLINE&quot;  | 5            | &quot;basketballplayer:5&quot;             | &quot;basketballplayer:5&quot;   | &quot;3.1.0&quot; || &quot;storaged1&quot; | 9779      | 19669     | &quot;ONLINE&quot;  | 5            | &quot;basketballplayer:5&quot;             | &quot;basketballplayer:5&quot;   | &quot;3.1.0&quot; || &quot;storaged2&quot; | 9779      | 19669     | &quot;ONLINE&quot;  | 5            | &quot;basketballplayer:5&quot;             | &quot;basketballplayer:5&quot;   | &quot;3.1.0&quot; |+-------------+-----------+-----------+-----------+--------------+----------------------------------+------------------------+---------+é€‰æ‹©å›¾ç©ºé—´basketballplayer1nebula[(none)]&gt; USE basketballplayer;ç”¨æˆ·å¯ä»¥æ‰§è¡Œå‘½ä»¤SHOW SPACESæŸ¥çœ‹åˆ›å»ºçš„å›¾ç©ºé—´123456nebula&gt; SHOW SPACES;+--------------------+| Name               |+--------------------+| &quot;basketballplayer&quot; |+--------------------+åˆ›å»º Tag å’Œ Edge typeè¯­æ³•:12345678CREATE {TAG | EDGE} [IF NOT EXISTS] {&lt;tag_name&gt; | &lt;edge_type_name&gt;}    (      &lt;prop_name&gt; &lt;data_type&gt; [NULL | NOT NULL] [DEFAULT &lt;default_value&gt;] [COMMENT '&lt;comment&gt;']      [{, &lt;prop_name&gt; &lt;data_type&gt; [NULL | NOT NULL] [DEFAULT &lt;default_value&gt;] [COMMENT '&lt;comment&gt;']} ...]     )    [TTL_DURATION = &lt;ttl_duration&gt;]    [TTL_COL = &lt;prop_name&gt;]    [COMMENT = '&lt;comment&gt;'];åˆ›å»º Tag:playerå’Œteamï¼Œä»¥åŠ Edge type:followå’Œserveã€‚è¯´æ˜å¦‚ä¸‹è¡¨ã€‚| åç§°   | ç±»å‹      | å±æ€§                             || â€”â€”â€” | â€”â€”â€”â€”- | â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” || player | Tag       | name (string), age (int)         || team   | Tag       | name (string)                    || follow | Edge type | degree (int)                     || serve  | Edge type | start_year (int), end_year (int) |1234CREATE TAG player(name string, age int);CREATE TAG team(name string);CREATE EDGE follow(degree int);CREATE EDGE serve(start_year int, end_year int);æ’å…¥ç‚¹å’Œè¾¹æ’å…¥ç‚¹12345678INSERT VERTEX [IF NOT EXISTS] [tag_props, [tag_props] ...]VALUES &lt;vid&gt;: ([prop_value_list])tag_props:  tag_name ([prop_name_list])prop_name_list: [prop_name [, prop_name] ...]prop_value_list: [prop_value [, prop_value] ...]  vidæ˜¯ Vertex ID çš„ç¼©å†™ï¼Œvidåœ¨ä¸€ä¸ªå›¾ç©ºé—´ä¸­æ˜¯å”¯ä¸€çš„ã€‚å‚æ•°è¯¦æƒ…è¯·å‚è§ INSERT VERTEXæ’å…¥è¾¹123456INSERT EDGE [IF NOT EXISTS] &lt;edge_type&gt; ( &lt;prop_name_list&gt; ) VALUES &lt;src_vid&gt; -&gt; &lt;dst_vid&gt;[@&lt;rank&gt;] : ( &lt;prop_value_list&gt; )[, &lt;src_vid&gt; -&gt; &lt;dst_vid&gt;[@&lt;rank&gt;] : ( &lt;prop_value_list&gt; ), ...];&lt;prop_name_list&gt; ::= [ &lt;prop_name&gt; [, &lt;prop_name&gt; ] ...]&lt;prop_value_list&gt; ::= [ &lt;prop_value&gt; [, &lt;prop_value&gt; ] ...]å‚æ•°è¯¦æƒ…è¯·å‚è§ INSERT EDGEæ’å…¥ä»£è¡¨çƒå‘˜å’Œçƒé˜Ÿçš„ç‚¹1234nebula&gt; INSERT VERTEX player(name, age) VALUES &quot;player100&quot;:(&quot;Tim Duncan&quot;, 42);nebula&gt; INSERT VERTEX player(name, age) VALUES &quot;player101&quot;:(&quot;Tony Parker&quot;, 36);nebula&gt; INSERT VERTEX player(name, age) VALUES &quot;player102&quot;:(&quot;LaMarcus Aldridge&quot;, 33);nebula&gt; INSERT VERTEX team(name) VALUES &quot;team203&quot;:(&quot;Trail Blazers&quot;), &quot;team204&quot;:(&quot;Spurs&quot;);æ’å…¥ä»£è¡¨çƒå‘˜å’Œçƒé˜Ÿä¹‹é—´å…³ç³»çš„è¾¹1234nebula&gt; INSERT EDGE follow(degree) VALUES &quot;player101&quot; -&gt; &quot;player100&quot;:(95);nebula&gt; INSERT EDGE follow(degree) VALUES &quot;player101&quot; -&gt; &quot;player102&quot;:(90);nebula&gt; INSERT EDGE follow(degree) VALUES &quot;player102&quot; -&gt; &quot;player100&quot;:(75);nebula&gt; INSERT EDGE serve(start_year, end_year) VALUES &quot;player101&quot; -&gt; &quot;team204&quot;:(1999, 2018),&quot;player102&quot; -&gt; &quot;team203&quot;:(2006,  2015);æŸ¥è¯¢æ•°æ®Â¶GO è¯­å¥å¯ä»¥æ ¹æ®æŒ‡å®šçš„æ¡ä»¶éå†æ•°æ®åº“ã€‚GOè¯­å¥ä»ä¸€ä¸ªæˆ–å¤šä¸ªç‚¹å¼€å§‹ï¼Œæ²¿ç€ä¸€æ¡æˆ–å¤šæ¡è¾¹éå†ï¼Œè¿”å›YIELDå­å¥ä¸­æŒ‡å®šçš„ä¿¡æ¯ã€‚FETCH è¯­å¥å¯ä»¥è·å¾—ç‚¹æˆ–è¾¹çš„å±æ€§ã€‚LOOKUP è¯­å¥æ˜¯åŸºäºç´¢å¼•çš„ï¼Œå’ŒWHEREå­å¥ä¸€èµ·ä½¿ç”¨ï¼ŒæŸ¥æ‰¾ç¬¦åˆç‰¹å®šæ¡ä»¶çš„æ•°æ®ã€‚MATCH è¯­å¥æ˜¯æŸ¥è¯¢å›¾æ•°æ®æœ€å¸¸ç”¨çš„ï¼Œå¯ä»¥çµæ´»çš„æè¿°å„ç§å›¾æ¨¡å¼ï¼Œä½†æ˜¯å®ƒä¾èµ–ç´¢å¼•å»åŒ¹é… NebulaGraph ä¸­çš„æ•°æ®æ¨¡å‹ï¼Œæ€§èƒ½ä¹Ÿè¿˜éœ€è¦è°ƒä¼˜ã€‚ğŸŒ¶æ³¨æ„æ— å±æ€§ç´¢å¼•çš„æ—¶å€™ï¼Œåœ¨æ²¡æœ‰æŒ‡å®šæ¡ä»¶çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡æ•°æ®æ‰«æçš„sampleä¸‹æ¨å»æ‰«å¾— limit çš„æ•°æ®è€Œå¸¦æœ‰filteræ¡ä»¶æ—¶ï¼Œéœ€è¦å…¨æ‰«æ‰è¡Œï¼Œè¿™ä¸ªæƒ…å†µåœ¨nebulaé‡Œæ˜¯è¢«ç¦æ­¢çš„ï¼Œéœ€è¦åˆ›å»ºè¿™ä¸ªtagä¸Šçš„ç´¢å¼•æ‰èƒ½æŸ¥è¯¢1234567891011# åœ¨ Tag player çš„ name å±æ€§å’Œ Edge type belong_to ä¸Šåˆ›å»ºç´¢å¼•CREATE TAG INDEX IF NOT EXISTS name ON player(name(20));CREATE EDGE INDEX IF NOT EXISTS belong_to_index on belong_to();# é‡å»ºç´¢å¼•ä½¿å…¶ç”Ÿæ•ˆREBUILD EDGE INDEX name;REBUILD EDGE INDEX belong_to_index;# å¼€å§‹æŸ¥è¯¢MATCH ()&lt;-[e:belong_to]-() WHERE e.industry_name=='æ°´åŠ›å‘ç”µ'RETURN eLIMIT 3;å›¾æ¨¡å¼æ¨¡å¼(pattern)å’Œå›¾æ¨¡å¼åŒ¹é…ï¼Œæ˜¯å›¾æŸ¥è¯¢è¯­è¨€çš„æ ¸å¿ƒåŠŸèƒ½å•ç‚¹æ¨¡å¼1(a)ç¤ºä¾‹ä¸ºä¸€ä¸ªç®€å•çš„æ¨¡å¼ï¼Œæè¿°äº†å•ä¸ªç‚¹ï¼Œå¹¶ä½¿ç”¨å˜é‡aå‘½åè¯¥ç‚¹å¤šç‚¹å…³è”æ¨¡å¼å¤šä¸ªç‚¹é€šè¿‡è¾¹ç›¸è¿æ˜¯å¸¸è§çš„ç»“æ„ï¼Œæ¨¡å¼ç”¨ç®­å¤´æ¥æè¿°ä¸¤ä¸ªç‚¹ä¹‹é—´çš„è¾¹ã€‚ä¾‹å¦‚ï¼š1(a)-[]-&gt;(b)ç¤ºä¾‹ä¸ºä¸€ä¸ªç®€å•çš„æ•°æ®ç»“æ„ï¼šä¸¤ä¸ªç‚¹å’Œä¸€æ¡è¿æ¥ä¸¤ä¸ªç‚¹çš„è¾¹ï¼Œä¸¤ä¸ªç‚¹åˆ†åˆ«ä¸ºaå’Œbï¼Œè¾¹æ˜¯æœ‰æ–¹å‘çš„ï¼Œä»aåˆ°bè¿™ç§æè¿°ç‚¹å’Œè¾¹çš„æ–¹å¼å¯ä»¥æ‰©å±•åˆ°ä»»æ„æ•°é‡çš„ç‚¹å’Œè¾¹ï¼Œä¾‹å¦‚ï¼š1(a)-[]-&gt;(b)&lt;-[]-(c)è¿™æ ·çš„ä¸€ç³»åˆ—ç‚¹å’Œè¾¹ç§°ä¸ºè·¯å¾„(path)åªæœ‰åœ¨æ¶‰åŠæŸä¸ªç‚¹æ—¶ï¼Œæ‰éœ€è¦å‘½åè¿™ä¸ªç‚¹ã€‚å¦‚æœä¸æ¶‰åŠè¿™ä¸ªç‚¹ï¼Œåˆ™å¯ä»¥çœç•¥åç§°ï¼Œä¾‹å¦‚ï¼š1(a)-[]-&gt;()&lt;-[]-(c)Tagæ¨¡å¼nGQL ä¸­çš„Tagæ¦‚å¿µä¸ openCypher ä¸­çš„Labelæœ‰ä¸€äº›ä¸åŒã€‚ä¾‹å¦‚ï¼Œå¿…é¡»åˆ›å»ºä¸€ä¸ªTagä¹‹åæ‰èƒ½ä½¿ç”¨å®ƒï¼Œè€Œä¸”Tagè¿˜å®šä¹‰äº†å±æ€§çš„ç±»å‹æ¨¡å¼é™¤äº†ç®€å•åœ°æè¿°å›¾ä¸­çš„ç‚¹ä¹‹å¤–ï¼Œè¿˜å¯ä»¥æè¿°ç‚¹çš„ Tagã€‚ä¾‹å¦‚ï¼š1(a:User)-[]-&gt;(b)æ¨¡å¼ä¹Ÿå¯ä»¥æè¿°æœ‰å¤šä¸ª Tag çš„ç‚¹ï¼Œä¾‹å¦‚ï¼š1(a:User:Admin)-[]-&gt;(b)å±æ€§æ¨¡å¼ç‚¹å’Œè¾¹æ˜¯å›¾çš„åŸºæœ¬ç»“æ„ã€‚nGQL åœ¨è¿™ä¸¤ç§ç»“æ„ä¸Šéƒ½å¯ä»¥å¢åŠ å±æ€§ï¼Œæ–¹ä¾¿å®ç°æ›´ä¸°å¯Œçš„æ¨¡å‹ã€‚åœ¨æ¨¡å¼ä¸­ï¼Œå±æ€§çš„è¡¨ç¤ºæ–¹å¼ä¸ºï¼šç”¨èŠ±æ‹¬å·æ‹¬èµ·ä¸€äº›é”®å€¼å¯¹ï¼Œç”¨è‹±æ–‡é€—å·åˆ†éš”ã€‚ä¾‹å¦‚ä¸€ä¸ªç‚¹æœ‰ä¸¤ä¸ªå±æ€§ï¼š1(a {name: 'Andres', sport: 'Brazilian Ju-Jitsu'})åœ¨è¿™ä¸ªç‚¹ä¸Šå¯ä»¥æœ‰ä¸€æ¡è¾¹æ˜¯ï¼š1(a)-[{blocked: false}]-&gt;(b)è¾¹æ¨¡å¼æè¿°ä¸€æ¡è¾¹æœ€ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨ç®­å¤´è¿æ¥ä¸¤ä¸ªç‚¹ã€‚å¯ä»¥ç”¨ä»¥ä¸‹æ–¹å¼æè¿°è¾¹ä»¥åŠå®ƒçš„æ–¹å‘æ€§ã€‚å¦‚æœä¸å…³å¿ƒè¾¹çš„æ–¹å‘ï¼Œå¯ä»¥çœç•¥ç®­å¤´ï¼Œä¾‹å¦‚ï¼š1(a)-[]-(b)å’Œç‚¹ä¸€æ ·ï¼Œè¾¹ä¹Ÿå¯ä»¥å‘½åã€‚ä¸€å¯¹æ–¹æ‹¬å·ç”¨äºåˆ†éš”ç®­å¤´ï¼Œå˜é‡æ”¾åœ¨ä¸¤è€…ä¹‹é—´ã€‚ä¾‹å¦‚ï¼š1(a)-[r]-&gt;(b)å’Œç‚¹ä¸Šçš„ Tag ä¸€æ ·ï¼Œè¾¹ä¹Ÿå¯ä»¥æœ‰ç±»å‹ã€‚æè¿°è¾¹çš„ç±»å‹ï¼Œä¾‹å¦‚ï¼š1(a)-[r:REL_TYPE]-&gt;(b)å’Œç‚¹ä¸Šçš„ Tag ä¸åŒï¼Œä¸€æ¡è¾¹åªèƒ½æœ‰ä¸€ç§ Edge typeã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬æƒ³æè¿°å¤šä¸ªå¯é€‰ Edge typeï¼Œå¯ä»¥ç”¨ç®¡é“ç¬¦å·ï¼ˆ|ï¼‰å°†å¯é€‰å€¼åˆ†å¼€ï¼Œä¾‹å¦‚ï¼š1(a)-[r:TYPE1|TYPE2]-&gt;(b)å’Œç‚¹ä¸€æ ·ï¼Œè¾¹çš„åç§°å¯ä»¥çœç•¥ï¼Œä¾‹å¦‚ï¼š1(a)-[:REL_TYPE]-&gt;(b)å˜é•¿æ¨¡å¼åœ¨å›¾ä¸­æŒ‡å®šè¾¹çš„é•¿åº¦æ¥æè¿°å¤šæ¡è¾¹ï¼ˆä»¥åŠä¸­é—´çš„ç‚¹ï¼‰ç»„æˆçš„ä¸€æ¡é•¿è·¯å¾„ï¼Œä¸éœ€è¦ä½¿ç”¨å¤šä¸ªç‚¹å’Œè¾¹æ¥æè¿°ã€‚ä¾‹å¦‚ï¼š1(a)-[*2]-&gt;(b)è¯¥æ¨¡å¼æè¿°äº† 3 ç‚¹ 2 è¾¹ç»„æˆçš„å›¾ï¼Œå®ƒä»¬éƒ½åœ¨ä¸€æ¡è·¯å¾„ä¸Šï¼ˆé•¿åº¦ä¸º 2ï¼‰ï¼Œç­‰ä»·äºï¼š1(a)-[]-&gt;()-[]-&gt;(b)ä¹Ÿå¯ä»¥æŒ‡å®šé•¿åº¦èŒƒå›´ï¼Œè¿™æ ·çš„è¾¹æ¨¡å¼ç§°ä¸ºvariable-length edgesï¼Œä¾‹å¦‚ï¼š1(a)-[*3..5]-&gt;(b)*3..5è¡¨ç¤ºæœ€å°é•¿åº¦ä¸º 3ï¼Œæœ€å¤§é•¿åº¦ä¸º 5ã€‚è¯¥æ¨¡å¼æè¿°äº† 4 ç‚¹ 3 è¾¹ã€5 ç‚¹ 4 è¾¹æˆ– 6 ç‚¹ 5 è¾¹ç»„æˆçš„å›¾ã€‚ä¹Ÿå¯ä»¥å¿½ç•¥æœ€å°é•¿åº¦ï¼ŒåªæŒ‡å®šæœ€å¤§é•¿åº¦ï¼Œä¾‹å¦‚ï¼š1(a)-[*..5]-&gt;(b)å¿…é¡»æŒ‡å®šæœ€å¤§é•¿åº¦ï¼Œä¸æ”¯æŒä»…æŒ‡å®šæœ€å°é•¿åº¦ï¼ˆ(a)-[*3..]-&gt;(b)ï¼‰æˆ–éƒ½ä¸æŒ‡å®šï¼ˆ(a)-[*]-&gt;(b)ï¼‰ã€‚è·¯å¾„å˜é‡ä¸€ç³»åˆ—è¿æ¥çš„ç‚¹å’Œè¾¹ç§°ä¸ºè·¯å¾„ã€‚nGQL å…è®¸ä½¿ç”¨å˜é‡æ¥å‘½åè·¯å¾„ï¼Œä¾‹å¦‚ï¼š1p = (a)-[*3..5]-&gt;(b)å¯ä»¥åœ¨ MATCH è¯­å¥ä¸­ä½¿ç”¨è·¯å¾„å˜é‡æ³¨é‡Šæ”¯æŒå››ç§æ³¨é‡Šæ–¹å¼ï¼š#ã€//ã€/* */nGQL è¯­å¥ä¸­çš„åæ–œçº¿ï¼ˆ\ï¼‰ä»£è¡¨æ¢è¡Œæ•°æ®ç±»å‹å­—ç¬¦ä¸²çš„è¡¨ç¤ºæ–¹å¼ä¸ºç”¨åŒå¼•å·æˆ–å•å¼•å·åŒ…è£¹ï¼Œä¾‹å¦‚&quot;Hello, Cooper&quot;æˆ–'Hello, Cooper'æ—¥æœŸå’Œæ—¶é—´çš„ç±»å‹ï¼ŒåŒ…æ‹¬DATEã€TIMEã€DATETIMEã€TIMESTAMPå’ŒDURATION12345678910111213141516171819202122232425262728nebula&gt; RETURN DATE({year:-123, month:12, day:3});+------------------------------------+| date({year:-(123),month:12,day:3}) |+------------------------------------+| -123-12-03                         |+------------------------------------+nebula&gt; RETURN DATE(&quot;23333&quot;);+---------------+| date(&quot;23333&quot;) |+---------------+| 23333-01-01   |+---------------+# ä¼ å…¥å½“å‰æ—¶é—´ã€‚nebula&gt; RETURN timestamp();+-------------+| timestamp() |+-------------+| 1625469277  |+-------------+# ä¼ å…¥æŒ‡å®šæ—¶é—´ã€‚nebula&gt; RETURN timestamp(&quot;2022-01-05T06:18:43&quot;);+----------------------------------+| timestamp(&quot;2022-01-05T06:18:43&quot;) |+----------------------------------+| 1641363523                       |+----------------------------------+date()æ”¯æŒçš„å±æ€§åç§°åŒ…æ‹¬yearã€monthå’Œdayã€‚date()æ”¯æŒè¾“å…¥YYYYã€YYYY-MMæˆ–YYYY-MM-DDï¼Œæœªè¾“å…¥çš„æœˆä»½æˆ–æ—¥æœŸé»˜è®¤ä¸º01time()æ”¯æŒçš„å±æ€§åç§°åŒ…æ‹¬hourã€minuteå’Œseconddatetime()æ”¯æŒçš„å±æ€§åç§°åŒ…æ‹¬yearã€monthã€dayã€hourã€minuteå’Œsecondåˆ—è¡¨ï¼ˆListï¼‰æ˜¯å¤åˆæ•°æ®ç±»å‹ï¼Œä¸€ä¸ªåˆ—è¡¨æ˜¯ä¸€ç»„å…ƒç´ çš„åºåˆ—ï¼Œå¯ä»¥é€šè¿‡å…ƒç´ åœ¨åºåˆ—ä¸­çš„ä½ç½®è®¿é—®åˆ—è¡¨ä¸­çš„å…ƒç´ nGQL çš„ä¸‹æ ‡æ”¯æŒä»å‰å¾€åæŸ¥è¯¢ï¼Œä» 0 å¼€å§‹ï¼Œ0 è¡¨ç¤ºç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œ1 è¡¨ç¤ºç¬¬äºŒä¸ªå…ƒç´ ï¼Œä»¥æ­¤ç±»æ¨ï¼›ä¹Ÿæ”¯æŒä»åå¾€å‰æŸ¥è¯¢ï¼Œä»-1 å¼€å§‹ï¼Œ-1 è¡¨ç¤ºæœ€åä¸€ä¸ªå…ƒç´ ï¼Œ-2 è¡¨ç¤ºå€’æ•°ç¬¬äºŒä¸ªå…ƒç´ ï¼Œä»¥æ­¤ç±»æ¨ã€‚[M]ï¼šè¡¨ç¤ºä¸‹æ ‡ä¸º M çš„å…ƒç´ ã€‚[M..N]ï¼šè¡¨ç¤ºM â‰¤ ä¸‹æ ‡ ï¼œ Nçš„å…ƒç´ ã€‚Nä¸º 0 æ—¶ï¼Œè¿”å›ä¸ºç©ºã€‚[M..]ï¼šè¡¨ç¤ºM â‰¤ ä¸‹æ ‡çš„å…ƒç´ ã€‚[..N]ï¼šè¡¨ç¤ºä¸‹æ ‡ ï¼œ Nçš„å…ƒç´ ã€‚Nä¸º 0 æ—¶ï¼Œè¿”å›ä¸ºç©ºã€‚å¯è§†åŒ–NebulaGraph Studioï¼ˆç®€ç§° Studioï¼‰æ˜¯ä¸€æ¬¾å¯ä»¥é€šè¿‡ Web è®¿é—®çš„å¼€æºå›¾æ•°æ®åº“å¯è§†åŒ–å·¥å…·ï¼Œæ­é… NebulaGraph å†…æ ¸ä½¿ç”¨ï¼Œæä¾›æ„å›¾ã€æ•°æ®å¯¼å…¥ã€ç¼–å†™ nGQL æŸ¥è¯¢ç­‰ä¸€ç«™å¼æœåŠ¡ã€‚å‰ææ¡ä»¶Â¶åœ¨éƒ¨ç½² RPM ç‰ˆ Studio ä¹‹å‰ï¼Œç”¨æˆ·éœ€è¦ç¡®è®¤ä»¥ä¸‹ä¿¡æ¯ï¼šNebulaGraph æœåŠ¡å·²ç»éƒ¨ç½²å¹¶å¯åŠ¨ã€‚è¯¦ç»†ä¿¡æ¯ï¼Œå‚è€ƒ NebulaGraph å®‰è£…éƒ¨ç½²ä½¿ç”¨çš„ Linux å‘è¡Œç‰ˆä¸º CentOS ï¼Œå·²å®‰è£… lsofç¡®ä¿ä»¥ä¸‹ç«¯å£æœªè¢«å ç”¨ï¼Œ7001æ˜¯Studio æä¾› web æœåŠ¡ä½¿ç”¨çš„ä»å®˜ç½‘ä¸‹è½½nebula-graph-studio-3.4.1.x86_64.rpmï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…åˆ°æŒ‡å®šè·¯å¾„1sudo rpm -i nebula-graph-studio-3.4.1.x86_64.rpm --prefix=&lt;path&gt; å®‰è£…å®Œï¼Œè‡ªåŠ¨ä¼šå¯åŠ¨ï¼Œå½“å±å¹•è¿”å›ä»¥ä¸‹ä¿¡æ¯æ—¶ï¼Œè¡¨ç¤º PRM ç‰ˆ Studio å·²ç»æˆåŠŸå¯åŠ¨ã€‚123Start installing NebulaGraph Studio now...NebulaGraph Studio has been installed.NebulaGraph Studio started automatically.å¯åŠ¨æˆåŠŸåï¼Œåœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥ http://&lt;ip address&gt;:7001æ³¨æ„: hostå¤„å¡«å†™ä¸º ip:portæ ¼å¼ç”¨æˆ·åå’Œå¯†ç ï¼šæ ¹æ® Nebula Graph çš„èº«ä»½éªŒè¯è®¾ç½®å¡«å†™ç™»å½•è´¦å·å’Œå¯†ç å¦‚æœæœªå¯ç”¨èº«ä»½éªŒè¯ï¼Œå¯ä»¥å¡«å†™é»˜è®¤ç”¨æˆ·å root å’Œä»»æ„å¯†ç ã€‚å¦‚æœå·²å¯ç”¨èº«ä»½éªŒè¯ï¼Œä½†æ˜¯æœªåˆ›å»ºè´¦å·ä¿¡æ¯ï¼Œç”¨æˆ·åªèƒ½ä»¥ GOD è§’è‰²ç™»å½•ï¼Œå¿…é¡»å¡«å†™ root åŠå¯¹åº”çš„å¯†ç  nebulaã€‚å¦‚æœå·²å¯ç”¨èº«ä»½éªŒè¯ï¼ŒåŒæ—¶åˆåˆ›å»ºäº†ä¸åŒçš„ç”¨æˆ·å¹¶åˆ†é…äº†è§’è‰²ï¼Œä¸åŒè§’è‰²çš„ç”¨æˆ·ä½¿ç”¨è‡ªå·±çš„è´¦å·å’Œå¯†ç ç™»å½•ã€‚å¦‚æœåœ¨æµè§ˆå™¨çª—å£ä¸­èƒ½çœ‹åˆ°ä»¥ä¸‹ç™»å½•ç•Œé¢ï¼Œè¡¨ç¤ºå·²ç»æˆåŠŸéƒ¨ç½²å¹¶å¯åŠ¨ Studioå¼‚å¸¸å¤„ç†Â¶å¦‚æœåœ¨å®‰è£…è¿‡ç¨‹ä¸­è‡ªåŠ¨å¯åŠ¨å¤±è´¥æˆ–æ˜¯éœ€è¦æ‰‹åŠ¨å¯åŠ¨æˆ–åœæ­¢æœåŠ¡ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼šæ‰‹åŠ¨å¯åŠ¨æœåŠ¡1bash /usr/local/nebula-graph-studio/scripts/rpm/start.shæ‰‹åŠ¨åœæ­¢æœåŠ¡1bash /usr/local/nebula-graph-studio/scripts/rpm/stop.shå¦‚æœå¯åŠ¨æœåŠ¡æ—¶é‡åˆ°æŠ¥é”™æŠ¥é”™ ERROR: bind EADDRINUSE 0.0.0.0:7001ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹ç«¯å£ 7001 æ˜¯å¦è¢«å ç”¨ã€‚1lsof -i:7001å¦‚æœç«¯å£è¢«å ç”¨ï¼Œä¸”æ— æ³•ç»“æŸè¯¥ç«¯å£ä¸Šè¿›ç¨‹ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤ä¿®æ”¹ Studio æœåŠ¡å¯åŠ¨ç«¯å£ï¼Œå¹¶é‡æ–°å¯åŠ¨æœåŠ¡ã€‚123456//ä¿®æ”¹ studio æœåŠ¡å¯åŠ¨ç«¯å£vi etc/studio-api.yam//ä¿®æ”¹Port: 7001 // ä¿®æ”¹è¿™ä¸ªç«¯å£å·ï¼Œæ”¹æˆä»»æ„ä¸€ä¸ªå½“å‰å¯ç”¨çš„å³å¯//é‡å¯æœåŠ¡systemctl restart nebula-graph-studio.serviceé›†ç¾¤ç›‘æ§NebulaGraph Dashboard(ç®€ç§°Dashboard)æ˜¯ä¸€æ¬¾ç”¨äºç›‘æ§NebulaGraphé›†ç¾¤ä¸­æœºå™¨å’ŒæœåŠ¡çŠ¶æ€çš„å¯è§†åŒ–å·¥å…·æ•°æ®å¯¼å…¥Nebula Importer æ•°æ®å¯¼å…¥å®è·µNebula ç›®å‰ä½œä¸ºè¾ƒä¸ºæˆç†Ÿçš„äº§å“ï¼Œå·²ç»æœ‰ç€å¾ˆä¸°å¯Œçš„ç”Ÿæ€ã€‚æ•°æ®å¯¼å…¥çš„ç»´åº¦è€Œè¨€å°±å·²ç»æä¾›äº†å¤šç§é€‰æ‹©ã€‚æœ‰å¤§è€Œå…¨çš„Nebula Exchangeï¼Œå°è€Œç²¾ç®€çš„Nebula Importer, è¿˜æœ‰ä¸º Spark / Flink å¼•æ“æä¾›çš„Nebula Spark Connector å’Œ Nebula Flink Connectorã€‚ä½¿ç”¨åœºæ™¯ä»‹ç»ï¼šNebula Exchangeéœ€è¦å°†æ¥è‡ª Kafkaã€Pulsar å¹³å°çš„æµå¼æ•°æ®, å¯¼å…¥ Nebula Graph æ•°æ®åº“éœ€è¦ä»å…³ç³»å‹æ•°æ®åº“ï¼ˆå¦‚ MySQLï¼‰æˆ–è€…åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼ˆå¦‚ HDFSï¼‰ä¸­è¯»å–æ‰¹å¼æ•°æ®éœ€è¦å°†å¤§æ‰¹é‡æ•°æ®ç”Ÿæˆ Nebula Graph èƒ½è¯†åˆ«çš„ SST æ–‡ä»¶Nebula ImporterImporter é€‚ç”¨äºå°†æœ¬åœ° CSV æ–‡ä»¶çš„å†…å®¹å¯¼å…¥è‡³ Nebula Graph ä¸­Nebula Spark Connector:åœ¨ä¸åŒçš„ Nebula Graph é›†ç¾¤ä¹‹é—´è¿ç§»æ•°æ®åœ¨åŒä¸€ä¸ª Nebula Graph é›†ç¾¤å†…ä¸åŒå›¾ç©ºé—´ä¹‹é—´è¿ç§»æ•°æ®Nebula Graph ä¸å…¶ä»–æ•°æ®æºä¹‹é—´è¿ç§»æ•°æ®ç»“åˆ Nebula Algorithm è¿›è¡Œå›¾è®¡ç®—Nebula Flink Connectoråœ¨ä¸åŒçš„ Nebula Graph é›†ç¾¤ä¹‹é—´è¿ç§»æ•°æ®åœ¨åŒä¸€ä¸ª Nebula Graph é›†ç¾¤å†…ä¸åŒå›¾ç©ºé—´ä¹‹é—´è¿ç§»æ•°æ®Nebula Graph ä¸å…¶ä»–æ•°æ®æºä¹‹é—´è¿ç§»æ•°æ®æ€»ä½“æ¥è¯´ï¼ŒExchange å¤§è€Œå…¨ï¼Œå¯ä»¥å’Œå¤§éƒ¨åˆ†çš„å­˜å‚¨å¼•æ“ç»“åˆï¼Œå¯¼å…¥åˆ° Nebula ä¸­ï¼Œä½†æ˜¯éœ€è¦éƒ¨ç½²Spark ç¯å¢ƒã€‚Importer ä½¿ç”¨ç®€å•ï¼Œæ‰€éœ€ä¾èµ–è¾ƒå°‘ï¼Œä½†éœ€è¦è‡ªå·±æå‰ç”Ÿæˆæ•°æ®æ–‡ä»¶ï¼Œé…ç½®å¥½ schema ä¸€åŠ³æ°¸é€¸ï¼Œä½†æ˜¯ä¸æ”¯æŒæ–­ç‚¹ç»­ä¼ ï¼Œé€‚åˆæ•°æ®é‡ä¸­ç­‰ã€‚Spark / Flink Connector éœ€è¦å’Œæµæ•°æ®ç»“åˆã€‚ä¸åŒçš„åœºæ™¯é€‰æ‹©ä¸åŒçš„å·¥å…·ï¼Œå¦‚æœä½œä¸ºæ–°äººä½¿ç”¨ Nebula åœ¨å¯¼å…¥æ•°æ®æ—¶ï¼Œå»ºè®®ä½¿ç”¨ Nebula Importer å·¥å…·ï¼Œç®€å•å¿«é€Ÿä¸Šæ‰‹ã€‚k8sk8så®˜ç½‘ä¸­æ–‡æ–‡æ¡£Kubernetesï¼ˆK8Sï¼‰æ•™ç¨‹Kubernetes Clusters-ç‹‚ä¹±çš„è´µå…¬å­ç®€ä»‹Kubernetes (K8S) æ˜¯ä»€ä¹ˆå®ƒæ˜¯ä¸€ä¸ªä¸º å®¹å™¨åŒ– åº”ç”¨æä¾›é›†ç¾¤éƒ¨ç½²å’Œç®¡ç†çš„å¼€æºå·¥å…·ï¼Œç”± Google å¼€å‘Kubernetes è¿™ä¸ªåå­—æºäºå¸Œè…Šè¯­ï¼Œæ„ä¸ºâ€œèˆµæ‰‹â€æˆ–â€œé£è¡Œå‘˜â€ã€‚k8s è¿™ä¸ªç¼©å†™æ˜¯å› ä¸º k å’Œ s ä¹‹é—´æœ‰å…«ä¸ªå­—ç¬¦çš„å…³ç³»ã€‚ Google åœ¨ 2014 å¹´å¼€æºäº† Kubernetes é¡¹ç›®ä¸»è¦ç‰¹æ€§ï¼šé«˜å¯ç”¨ï¼Œä¸å®•æœºï¼Œè‡ªåŠ¨ç¾éš¾æ¢å¤ç°åº¦æ›´æ–°ï¼Œä¸å½±å“ä¸šåŠ¡æ­£å¸¸è¿è½¬ä¸€é”®å›æ»šåˆ°å†å²ç‰ˆæœ¬æ–¹ä¾¿çš„ä¼¸ç¼©æ‰©å±•ï¼ˆåº”ç”¨ä¼¸ç¼©ï¼Œæœºå™¨åŠ å‡ï¼‰ã€æä¾›è´Ÿè½½å‡è¡¡æœ‰ä¸€ä¸ªå®Œå–„çš„ç”Ÿæ€éƒ¨ç½²æ–¹æ¡ˆä¼ ç»Ÿéƒ¨ç½²æ–¹å¼ï¼šåº”ç”¨ç›´æ¥åœ¨ç‰©ç†æœºä¸Šéƒ¨ç½²ï¼Œæœºå™¨èµ„æºåˆ†é…ä¸å¥½æ§åˆ¶ï¼Œå‡ºç°Bugæ—¶ï¼Œå¯èƒ½æœºå™¨çš„å¤§éƒ¨åˆ†èµ„æºè¢«æŸä¸ªåº”ç”¨å ç”¨ï¼Œå¯¼è‡´å…¶ä»–åº”ç”¨æ— æ³•æ­£å¸¸è¿è¡Œï¼Œæ— æ³•åšåˆ°åº”ç”¨éš”ç¦»è™šæ‹Ÿæœºéƒ¨ç½²åœ¨å•ä¸ªç‰©ç†æœºä¸Šè¿è¡Œå¤šä¸ªè™šæ‹Ÿæœºï¼Œæ¯ä¸ªè™šæ‹Ÿæœºéƒ½æ˜¯å®Œæ•´ç‹¬ç«‹çš„ç³»ç»Ÿï¼Œæ€§èƒ½æŸè€—å¤§å®¹å™¨éƒ¨ç½²æ‰€æœ‰å®¹å™¨å…±äº«ä¸»æœºçš„ç³»ç»Ÿï¼Œè½»é‡çº§çš„è™šæ‹Ÿæœºï¼Œæ€§èƒ½æŸè€—å°ï¼Œèµ„æºéš”ç¦»ï¼ŒCPUå’Œå†…å­˜å¯æŒ‰éœ€åˆ†é…Kubernetes å¯ä»¥ä¸ºä½ æä¾›é›†ä¸­å¼çš„ç®¡ç†é›†ç¾¤æœºå™¨å’Œåº”ç”¨ï¼ŒåŠ æœºå™¨ã€ç‰ˆæœ¬å‡çº§ã€ç‰ˆæœ¬å›æ»šï¼Œé‚£éƒ½æ˜¯ä¸€ä¸ªå‘½ä»¤å°±æå®šçš„äº‹ï¼Œä¸åœæœºçš„ç°åº¦æ›´æ–°ï¼Œç¡®ä¿é«˜å¯ç”¨ã€é«˜æ€§èƒ½ã€é«˜æ‰©å±•é‡è¦æ¦‚å¿µ Podè±†èšï¼ŒK8S è°ƒåº¦ã€ç®¡ç†çš„æœ€å°å•ä½ï¼Œä¸€ä¸ª Pod å¯ä»¥åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ï¼Œæ¯ä¸ª Pod æœ‰è‡ªå·±çš„è™šæ‹ŸIPã€‚ä¸€ä¸ªå·¥ä½œèŠ‚ç‚¹å¯ä»¥æœ‰å¤šä¸ª podï¼Œä¸»èŠ‚ç‚¹ä¼šè€ƒé‡è´Ÿè½½è‡ªåŠ¨è°ƒåº¦ pod åˆ°å“ªä¸ªèŠ‚ç‚¹è¿è¡ŒKubernetes ç»„ä»¶Kubernetes æ˜¯ä¸€ä¸ªå¼€æºçš„å®¹å™¨ç¼–æ’å’Œç®¡ç†å¹³å°ï¼Œç”±å¤šä¸ªç»„ä»¶ç»„æˆã€‚ä¸‹é¢æ˜¯ Kubernetes çš„ä¸€äº›æ ¸å¿ƒç»„ä»¶ï¼škube-apiserverï¼šä½œä¸º Kubernetes API çš„å‰ç«¯ç»„ä»¶ï¼Œå¤„ç†æ¥è‡ªç”¨æˆ·ã€kubectl å‘½ä»¤è¡Œå·¥å…·ä»¥åŠå…¶ä»–ç»„ä»¶çš„ API è¯·æ±‚ï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨ etcd ä¸­etcdï¼šæ˜¯ä¸€ä¸ªé«˜åº¦å¯ç”¨ä¸”ä¸€è‡´æ€§çš„åˆ†å¸ƒå¼é”®å€¼å­˜å‚¨ï¼Œç”¨äºä¿å­˜ Kubernetes é›†ç¾¤çš„é…ç½®æ•°æ®ã€å…ƒæ•°æ®å’ŒçŠ¶æ€ä¿¡æ¯kube-schedulerï¼šè´Ÿè´£ç›‘è§†æ–°åˆ›å»ºçš„ Podï¼Œå¹¶æ ¹æ®å¯ç”¨çš„è®¡ç®—èµ„æºã€ç¡¬ä»¶å’Œè½¯ä»¶è¦æ±‚é€‰æ‹©åˆé€‚çš„èŠ‚ç‚¹è¿›è¡Œè°ƒåº¦kube-controller-managerï¼šåŒ…å«å¤šä¸ªæ§åˆ¶å™¨ï¼Œç”¨äºç®¡ç†é›†ç¾¤ä¸­çš„å„ç§èµ„æºï¼Œä¾‹å¦‚èŠ‚ç‚¹æ§åˆ¶å™¨ã€å‰¯æœ¬æ§åˆ¶å™¨ã€æœåŠ¡æ§åˆ¶å™¨ç­‰ã€‚å®ƒè´Ÿè´£ä¿æŒæœŸæœ›çŠ¶æ€å’Œå®é™…çŠ¶æ€ä¹‹é—´çš„ä¸€è‡´æ€§kubeletï¼šåœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šè¿è¡Œçš„ä»£ç†ç»„ä»¶ï¼Œè´Ÿè´£ç®¡ç†èŠ‚ç‚¹ä¸Šçš„å®¹å™¨ï¼Œä¸å®¹å™¨è¿è¡Œæ—¶è¿›è¡Œäº¤äº’ï¼Œæ¥æ”¶æ¥è‡ª kube-apiserver çš„æŒ‡ä»¤ï¼Œå¹¶ç¡®ä¿å®¹å™¨æŒ‰ç…§æœŸæœ›çŠ¶æ€è¿è¡Œkube-proxyï¼šè´Ÿè´£ä¸º Service å¯¹è±¡æä¾›ç½‘ç»œä»£ç†å’Œè´Ÿè½½å‡è¡¡åŠŸèƒ½ï¼Œå°†ç½‘ç»œæµé‡è·¯ç”±åˆ°æ­£ç¡®çš„å®¹å™¨ä¸ŠContainer Runtimeï¼šKubernetes æ”¯æŒå¤šç§å®¹å™¨è¿è¡Œæ—¶ï¼Œå¦‚ Dockerã€containerdã€CRI-O ç­‰ï¼Œç”¨äºåˆ›å»ºå’Œç®¡ç†å®¹å™¨kube-dns/corednsï¼šæä¾›é›†ç¾¤å†… DNS æœåŠ¡ï¼Œç”¨äºè§£æ Kubernetes é›†ç¾¤ä¸­çš„æœåŠ¡åç§°Dashboardï¼šæä¾›å¯è§†åŒ–çš„ Kubernetes é›†ç¾¤ç®¡ç†ç•Œé¢ï¼Œç”¨äºæŸ¥çœ‹å’Œæ“ä½œé›†ç¾¤ä¸­çš„èµ„æºé™¤äº†è¿™äº›æ ¸å¿ƒç»„ä»¶ä¹‹å¤–ï¼Œè¿˜æœ‰å…¶ä»–çš„è¾…åŠ©ç»„ä»¶å’Œæ’ä»¶ï¼Œå¦‚Ingress Controllerï¼ˆç”¨äºç®¡ç†å…¥å£æµé‡ï¼‰ã€Heapsterï¼ˆç”¨äºé›†ç¾¤ç›‘æ§å’Œæ€§èƒ½åˆ†æï¼‰ã€Prometheusï¼ˆç”¨äºæŒ‡æ ‡æ”¶é›†å’Œç›‘æ§ï¼‰ã€Fluentdï¼ˆç”¨äºæ—¥å¿—æ”¶é›†å’Œèšåˆï¼‰ç­‰ï¼Œè¿™äº›ç»„ä»¶å¯ä»¥æ ¹æ®å…·ä½“éœ€æ±‚é€‰æ‹©å®‰è£…å’Œé…ç½®å®‰è£…å’Œéƒ¨ç½²å ä½â€¦</content>
	</entry>
	<entry>
		<title>å¦é—¨æ–¹ç‰¹æ¢¦å¹»ç‹å›½ä¸€æ—¥æ”»ç•¥</title>
		<url>/article/63632.html</url>
		<content>æ–¹ç‰¹ç‹å›½å›­åŒºåœ°å›¾æ‰“å¡å¦é—¨æ–¹ç‰¹æ¢¦å¹»ç‹å›½ å¤å¤©å»çš„è¯å¸¦å¥½é®é˜³ä¼ã€å¸½å­ã€é˜²æ™’éœœç­‰ï¼Œé˜²æ™’å·¥ä½œè¦åšå¥½,ç›¸æœºæ›´æ˜¯å¿…ä¸å¯å°‘æ°´å°½é‡å°‘å¸¦ã€‚æ‰€æœ‰æ¶²ä½“ã€é£Ÿå“(å«600mlä»¥ä¸Šé¥®æ–™)ã€æ˜“ç‡ƒæ˜“çˆ†å“ã€è¿ç¦å“ã€åŒ–å­¦å“ç¦æ­¢å¸¦å…¥å›­ã€‚å›­åŒºçš„æ°´è¾ƒå…¶ä»–æ™¯åŒºä¹Ÿä¸è´µï¼Œæ˜¯ç»Ÿä¸€ä»·ï¼ŒçŸ¿æ³‰æ°´8-10å…ƒï¼Œå…¶ä»–æ±½æ°´æœæ±10å…ƒï¼Œå‡ ä¹æ¯ä¸€ä¸ªåœºé¦†æ—è¾¹éƒ½æœ‰æ°´å§å¾ˆæ–¹ä¾¿çš„ã€‚å›­åŒºå°ç«è½¦æ˜¯å…è´¹çš„ï¼Œä¼šä¸€ç›´åœ¨å›­åŒºé‡Œè½¬ï¼Œèµ°ç´¯äº†çœ‹åˆ°å¯ä»¥æ‹›æ‰‹éšåœéšä¸Šã€‚è®°å¾—å¸¦ï¼šèº«ä»½è¯ï¼Œé¥®æ–™ï¼Œæ™šé¤ï¼Œå¸¦ä¹¦åŒ…ï¼Œè€³æœºï¼Œå……ç”µå®ï¼Œå……ç”µå™¨ä¸›æ—çš„æ•…äº‹é€‚å®œäººç¾¤ï¼šæ‰€æœ‰äººï¼›èº«é«˜è¦æ±‚ï¼šæ— ï¼›é¡¹ç›®ç‰¹è‰²ï¼šå¤§å‹ä¸»é¢˜èˆè¹ˆç§€æ—¶é—´å®‰æ’202221.30-22.30æ‰“é“å›åºœ21.00-21.30çœ‹çƒŸèŠ±è¡¨æ¼”19.30-21.00åƒé¥­æ—¶é—´(æ™¯åŒºå†…ç‰©ä»·æ¯”å¤–é¢ç¨é«˜ï¼Œæ­£é¤äººå‡30~40å·¦å³)+è‡ªç”±å®‰æ’psé¤é¥®ï¼šä¹å›­å†…æœ‰éå¸¸å¤šçš„é¤é¥®å°åƒåº—ï¼Œæ­£é¤åƒç«¥è¯é¤å…ã€ç†Šè®°æ±‰å ¡ã€æ¬¢ä¹é¤å…ã€å¼€å¿ƒè‚‰å¤¹é¦ã€å°æ·®å¨˜é¸­è¡€ç²‰ä¸ç­‰ç­‰ï¼Œå£å‘³ä¼—å¤šä¸°ä¿­ç”±äººï¼›é™¤äº†æ­£é¤ï¼Œæ›´å¤šçš„æ˜¯å°åƒé©¿ç«™ï¼Œæ¯”å¦‚å›´ç‚‰é”…ç›”ã€é™é¾™çˆªçˆªã€æ¯ä¸­çš„é±¼ã€æ­£æ–°é¸¡æ’ã€é‡‘å±±å®¢æ ˆã€è€å¡å’–å•¡ã€å¿«ä¹å†°å®¤ç­‰ç­‰ï¼Œå¾ˆå®¹æ˜“ç®¡ä¸ä½å˜´ï¼Œæœ€åé¢„ç®—å’Œå¡è·¯é‡ŒåŒåŒè¶…æ ‡18.30-19.30 å®¤å†…åœºé¦†é­”æ³•åŸå ¡é­”æ³•åŸå ¡ï¼Œå¡”ç½—ç‰Œæµ®ç©ºï¼Œå†’å¤±ç›—è´¼çš„å˜æˆé’è›™ï¼Œè¡€è…¥çš„æƒ¨åƒè¿é¢è¢­æ¥ï¼Œè¿™ç©¶ç«Ÿæ˜¯å“ªï¼Ÿå¤§å‹DARK RIDEè¡¨æ¼”é¡¹ç›®ï¼Œé­”æ³•åŸå ¡å°†ä»¥ä¸å¯æ€è®®çš„è¡¨ç°æ‰‹æ®µï¼Œä¸ºä½ å‘ˆç°ä¸€ä¸ªä¸å¯æ€è®®çš„é­”æ³•ä¸–ç•Œã€‚å®‡å®™å°å‹‡å£«å„¿ç«¥é¡¹ç›®ï¼Œå¤§äººå°±ä¸ç”¨æµªè´¹æ—¶é—´å°è¯•äº†ï¼ˆå¸¦å°å­©å¦è¯´ï¼‰ã€‚ç‰¹åˆ«æ˜¯å®‡å®™å°å‹‡å£«é€ å‹æ˜¾çœ¼å¾ˆæœ‰è¿·æƒ‘æ€§ï¼Œå…¶å®æ˜¯ä¸€ä¸ªå„¿ç«¥å°„å‡»é¡¹ç›®ç«¥æ¢¦å¤©åœ°ç«¥æ¢¦å¤©åœ°ï¼Œè¿™æ˜¯ä¸€ä¸ªå„¿ç«¥çš„å¤©å ‚ï¼Œå„ä¸ªå¹´é¾„æ®µçš„å°æœ‹å‹éƒ½å¯ä»¥åœ¨é‡Œé¢æ‰¾åˆ°é€‚åˆè‡ªå·±çš„æ¸¸ç©é¡¹ç›®ï¼Œé‡Œé¢è®¾æœ‰åŠ¨ç”»å‰§åœºï¼Œä½é¾„æ¸¸ç©åŒºï¼Œå¤§å‹æ”€çˆ¬æ¸¸æˆåŒºå’Œäº’åŠ¨æŠ•å½±åŒºã€‚å®‡å®™åšè§ˆä¼š19.00-19.30ä¸€å®šè¦å»çœ‹çš„åœ°æ–¹é£è¶Šæé™é£è·ƒæé™ï¼Œä½œä¸ºä¸€æ¬¾é«˜ç©ºé£ç¿”ä½“éªŒé¡¹ç›®ï¼Œä¸€ç§’å¤©ä¸Šä¸€ç§’æ·±æ¸ŠçœŸçš„ä¸æ˜¯åœ¨è¯´ç¬‘ï¼Œæƒ³ä½“éªŒä»æ²¡æœ‰è¿‡çš„å‡Œç©ºé£ç¿”ä½“éªŒï¼Œæ¥åˆ°è¿™é‡Œå‡†æ²¡æœ‰é”™ã€‚ç”Ÿå‘½ä¹‹å…‰è®²è¿°äº†åœ°çƒç”Ÿå‘½æ¼”åŒ–çš„å†å²ï¼Œç”Ÿå‘½çš„è¯ç”Ÿã€æé¾™çš„ç­ç»ã€å“ºä¹³åŠ¨ç‰©çš„å´›èµ·ã€äººç±»çš„ç™»é¡¶ï¼Œéå¸¸æ£’çš„ç§‘æ™®ç±»ç‰¹æ•ˆå‰§åœºã€‚ã€Šç”Ÿå‘½ä¹‹å…‰ã€‹å¯¹å¤§äººæ¥è¯´å¯çœ‹å¯ä¸çœ‹ï¼Œä½†æ˜¯å®ƒå¯¹å°æœ‹å‹çš„å¸å¼•åŠ›å´éå¸¸å¤§ï¼Œæé¾™ã€ç”Ÿç‰©è¿›åŒ–ã€é™¨çŸ³è¢­å‡»å®Œå…¨æŠ“ä½äº†ä»–ä»¬çš„æ³¨æ„åŠ›ï¼Œ è®©ä»–ä»¬æ´¥æ´¥æœ‰å‘³çœ‹å®Œä¸€åœºâ€˜ç§‘æ™®å¤§ç”µå½±â€™ã€‚18.00-19.00æ¬¡æ·±å¤„æ™¯åŒºæ¸¸ç©ï¼šå”å¤æ‹‰é›ªå±±å”å¤æ‹‰é›ªå±±ï¼ŒæƒŠé™©æŒ‡æ•°äº”é¢—æ˜Ÿï¼Œæ¬¢ä¹æŒ‡æ•°äº”é¢—æ˜Ÿï¼Œå¥‡å¹»æŒ‡æ•°äº”é¢—æ˜Ÿï¼Œä½ å‡†å¤‡å¥½ä»é›ªå±±é’»å…¥å²©æµ†ä¸­äº†å—?å”å¤æ‹‰å°é•‡è§‚å…‰ç±»å‹å›­åŒºä¸­å¿ƒåŒå±‚è½¬é©¬ï¼šæœ€æµªæ¼«çš„é¡¹ç›®-ç²‰è‰²åŒå±‚è½¬é©¬ã€‚ååœ¨è‰²å½©æ–‘æ–“ã€å¯Œä¸½å ‚çš‡çš„æœ¨é©¬ä¸Šè·³è·ƒæ—‹è½¬ï¼Œå®›å¦‚ç½®èº«äºç«¥è¯ä¸–ç•Œä¹‹ä¸­ã€‚éŸ³ä¹é£˜èµ·ï¼Œç‚¹äº®æ¢¦å¹»èˆ¬çš„éœ“è™¹ç¯ï¼Œä¸å¿ƒä¸­çš„å…¬ä¸»ç‹å­ç»“ä¼´ç­–éª‘ï¼Œæ»¡è¶³æ¯ä¸€ä¸ªå°ä»™å¥³çš„ç²‰è‰²ç«¥è¯æ¢¦ã€‚ç§¦é™µå†é™©ç§¦é™µå†é™©ï¼Œå°†ç°å®åœºæ™¯å’Œç«‹ä½“ç”µå½±ç¯å…‰æ•ˆæœç›¸ç»“åˆï¼Œå……åˆ†è¿˜åŸå‡ºåƒå¹´ç§¦é™µçš„å¹½æ·±é»‘æš—ï¼Œå¯»å®çš„ç¯èŠ‚è¶£å‘³åè¶³ï¼Œè®©äººæ·±é™·å…¶ä¸­ï¼Œæ¬²ç½¢ä¸èƒ½ï¼Œæ˜¯ä¸€ä¸ªå¤§å‹çš„å®¤å†…æ¸¸å†é¡¹ç›®ã€‚16.30-18.00æ·±å¤„æ™¯åŒºæ¸¸ç©ï¼šå¤ªç©ºé£æ¢­å¤ªç©ºé£æ¢­ï¼Œè¿™ä¸ªé¡¹ç›®èƒ½è®©ä½ æ·±åˆ»æ˜ç™½ï¼Œä»€ä¹ˆæ˜¯å¤±é‡!ç¬é—´æ¥åˆ°40ç±³é«˜ç©ºå†ç¬é—´ä¸‹è½ï¼Œä¸æ€•è„šè½¯å°±æ¥æŒ‘æˆ˜å§ã€‚ç†Šå‡ºæ²¡å„¿ç«¥é¡¹ç›®ï¼Œå¤§äººå°±ä¸ç”¨æµªè´¹æ—¶é—´å°è¯•äº†ï¼ˆå¸¦å°å­©å¦è¯´ï¼‰ã€‚ç‰¹åˆ«æ˜¯å®‡å®™å°å‹‡å£«é€ å‹æ˜¾çœ¼å¾ˆæœ‰è¿·æƒ‘æ€§ï¼Œå…¶å®æ˜¯ä¸€ä¸ªå„¿ç«¥å°„å‡»é¡¹ç›®æš´é£çœ¼æ‰­æ›²çš„è½¨é“ï¼Œ720åº¦ååŠç©ºéª¤åœï¼Œè¿™æ‰æ˜¯çœŸæ­£çš„åˆºæ¿€ï¼ŒçœŸæ­£çš„è¿‡ç˜¾ã€‚æåœ°å¿«è½¦æåœ°å¿«è½¦ï¼Œè¿™æ¬¾è¿‡å±±è½¦æ˜¯çœŸæ­£çš„è¿‡å±±è½¦ä¸­çš„æˆ˜æ–—æœº!é›†åˆäº†æˆ˜æ–—æœºç‰¹æ•ˆåŠ¨ä½œçš„å®ƒï¼Œå°†è®©ä½ å……åˆ†æ„Ÿå—å¿ƒæ‚¬åœ¨å—“å­çœ¼æ˜¯ä¸€ç§ä»€ä¹ˆæ ·çš„æ„Ÿå—!é€ƒå‡ºæé¾™å²›é€ƒå‡ºæé¾™å²›ï¼Œå´å“¥çªŸå¼çš„å»ºç­‘é£æ ¼ï¼Œåœ¨è¿™é‡Œï¼Œä½ å°†ä¹˜ä¸Šå°èˆ¹è¿›å…¥ä¾ç½—çºªæ—¶ä»£ï¼Œåœ¨èŒ‚å¯†çš„é›¨æ—ä¸­ç»å†ä¸€åœºæƒŠå¿ƒåŠ¨é­„çš„å†’é™©ï¼Œå‹‡å£«ï¼Œä½ å‡†å¤‡å¥½äº†å—?16.00 å‡†å¤‡å…¥å›­å•¦~ï¼Œé—¨å£ä¼šæœ‰ç©å¶å¯ä»¥åˆå½±ï¼Œå…¥åœºåï¼Œè·¯æ—çš„å®¤å†…å…ˆä¸è¦ç©ï¼Œç›´å¥”å›­åŒºæœ€æ·±å¤„12.00-14.00åƒå®Œåˆé¤ï¼Œä»å¤©ä¼¦åŒ»é™¢å‡ºå‘ï¼Œå‰å¾€æ–¹ç‰¹ä¹å›­å…¥å£çš„å½©è™¹æ¡¥é¡¹ç›®å¼€æ”¾æ—¶é—´ç±»  åˆ«é¡¹ç›®åç§°èº«é«˜è¦æ±‚é¡¹ç›®å¼€æ”¾æ—¶é—´ ï¼ˆå¹³æ—¶ï¼‰é¡¹ç›®å¼€æ”¾æ—¶é—´ ï¼ˆå‘¨æœ«ï¼‰é£è¶Šæé™1.2Mä»¥ä¸Š10:10 10:30 11:3012:30 13:30 14:30 15:30 16:3009:40 10:30 11:3012:30 13:3014:30 15:30 16:30 17:10ç”Ÿå‘½ä¹‹å…‰å„¿ç«¥éœ€æˆäººé™ªåŒ13:00 15:00 17:0010:30 13:00 15:00 16:00å®‡å®™åšè§ˆä¼š1.2Mä»¥ä¸Šæš‚ä¸å¼€æ”¾æš‚ä¸å¼€æ”¾ç†Šç†Šä¹å›­å„¿ç«¥éœ€æˆäººé™ªåŒ11:00-17:0009:30-17:30å®‡å®™å°å‹‡å£«1Mä»¥ä¸Š11:30-17:0009:30-17:30é­”æ³•åŸå ¡1.2Mä»¥ä¸Š10:00-17:0009:30-17:30ç§¦é™µå†é™©1.2Mä»¥ä¸Š11:00-17:0010:30-17:30èŠæ–‹1Mä»¥ä¸Š13:30 15:3012:30 13:30 14:30 15:30 16:30å†³æˆ˜é‡‘å±±å¯ºå„¿ç«¥éœ€æˆäººé™ªåŒ11:00 12:00 13:0016:00 16:3011:00 12:00 14:0015:00 16:00 17:00ä¸›æ—çš„æ•…äº‹å„¿ç«¥éœ€æˆäººé™ªåŒæš‚ä¸å¼€æ”¾æš‚ä¸å¼€æ”¾å®¤å¤–é¡¹ç›®ç±»  åˆ«é¡¹ç›®åç§°èº«é«˜è¦æ±‚é¡¹ç›®å¼€æ”¾æ—¶é—´ ï¼ˆå¹³æ—¶ï¼‰é¡¹ç›®å¼€æ”¾æ—¶é—´ ï¼ˆå‘¨æœ«ï¼‰æµ·ç›—èˆ¹1.1Mä»¥ä¸Š10:00-17:0009:30-17:30UFO1.4Mä»¥ä¸Š10:00-17:0009:30-17:30åŒå±‚è½¬é©¬å„¿ç«¥éœ€æˆäººé™ªåŒ10:00-17:0009:30-17:30è½¬è½¬æ¯1Mä»¥ä¸Š10:00-17:0009:30-17:30æœè™«æ»‘è½¦0.9M-1.4M10:00-17:0009:30-17:30æ³¢æµªç¿»æ»š1.3Mä»¥ä¸Š12:30-17:0009:30-17:30å¤§æ‘†é”¤1.2Mä»¥ä¸Š10:00-17:0009:30-17:30å¤ªç©ºé£æ¢­1.4Mä»¥ä¸Š10:00-17:0009:30-17:30ç©ºä¸­é£èˆ1.2Mä»¥ä¸Š12:30-17:0009:30-17:30æåœ°å¿«è½¦1.2M-2.05M10:00-17:0009:30-17:30æš´é£çœ¼1.3M-2M10:00-17:0009:30-17:30å”å¤æ‹‰é›ªå±±1.1Mä»¥ä¸Š10:00-17:0009:30-17:30é€ƒå‡ºæé¾™å²›1.2Mä»¥ä¸Š12:30-17:0009:30-17:30</content>
	</entry>
	<entry>
		<title>é˜¿é‡Œäº‘éƒ¨ç½²</title>
		<url>/article/14386.html</url>
		<content>é˜¿é‡Œäº‘éƒ¨ç½²é˜¿é‡Œäº‘éƒ¨ç½²ç¬”è®°(centosç‰ˆæœ¬)ï¼Œè´­ä¹°é˜¿é‡Œäº‘ä¸»æœºï¼Œå¼€å¯å®‰å…¨ç»„äº‘ä¸»æœºå®ä¾‹é…ç½®å®‰å…¨ç»„ç¯å¢ƒå®‰è£…å®‰è£…gitã€jdkå’Œnodejså®‰è£…jdk12# å®‰è£…jdkrpm -ivh jdk-8u241-linux-x64.rpmé…ç½®jdkç¯å¢ƒå˜é‡vi /etc/profile1234export JAVA_HOME=/usr/java/jdk1.8.0_241-amd64export JRE_HOME=/usr/java/jdk1.8.0_241-amd64/jreexport PATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/binexport CLASSPATH=.:$CLASSPATH:$JAVA_HOME/lib:$JRE_HOME/libps: è‹¥åŸå…ˆå­˜åœ¨openjdkï¼Œéœ€è¦å…ˆå¸è½½1234# æŸ¥çœ‹jdkåˆ—è¡¨rpm -qa|grep java# å¸è½½rpm -e --nodeps java-1.8.0-openjdk-1.8.0.181-7.b13.el7.x86_64å®‰è£…å’Œé…ç½®nodejs12345678910111213141516# å®‰è£…å’Œé…ç½®nodejscp node-v12.16.1-linux-x64.tar.xz /usr/local/cd /usr/local/tar -xvf node-v12.16.1-linux-x64.tar.xzmv node-v12.16.1-linux-x64/ nodejscd nodejsmkdir node_globalmkdir node_cachenpm config set prefix &quot;/usr/local/nodejs/node_global&quot;npm config set cache &quot;/usr/local/nodejs/node_cache&quot;# é…ç½®nodejsvim /etc/profile# åœ¨æœ«å°¾æ·»åŠ export PATH=$PATH:/usr/local/nodejs/bin # config nodejs# æ‰§è¡Œç”Ÿæ•ˆå‘½ä»¤source /etc/profileå®‰è£…å’Œé…ç½®git123456# å®‰è£…å’Œé…ç½®gityum install gitgit config --global user.name &quot;yourname&quot;git config --global user.mail &quot;xxxxxxxxxx@mail.com&quot;# é…ç½®è¿œç¨‹ä»“åº“ å°†pub_keyé»è´´åˆ°gitssh-keygen -t rsa -C &quot;xxxxxxxxxx@mail.com&quot;å®‰è£…å’Œé…ç½®git123456# å®‰è£…å’Œé…ç½®gityum install gitgit config --global user.name &quot;narutohyc&quot;git config --global user.mail &quot;1832044043@qq.com&quot;# é…ç½®è¿œç¨‹ä»“åº“ å°†pub_keyé»è´´åˆ°gitssh-keygen -t rsa -C &quot;1832044043@qq.com&quot;å®‰è£…gitbook123456# å®‰è£…gitbooknpm install gitbook-cli -g# æ·»åŠ gitbookè½¯é“¾æ¥ln -s /usr/local/nodejs/node_global/bin/gitbook /usr/bin/gitbook# gitbookæŒ‡ä»¤æµ‹è¯•gitbook -Vgitè®¿é—®æ…¢é…ç½®Githubä¸‹è½½é€Ÿåº¦å¤ªæ…¢æ€ä¹ˆåŠï¼Ÿå®Œç¾è§£å†³æœåŠ¡å™¨æŸ¥è¯¢github hostsä¸‹è½½, å®æ—¶æ›´æ–°é€šè¿‡ä¿®æ”¹ hostsæ–‡ä»¶ï¼Œé‡å®šå‘ç½‘ç«™çš„è®¿é—®åˆ°ä»£ç†æœåŠ¡å™¨ä¸Š| ç³»ç»Ÿ        | hostsæ–‡ä»¶è·¯å¾„                             || :â€”â€”â€”â€”â€”â€”â€” | :â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” || Window      | %systemroot%\system32\drivers\etc\hosts || Mac / Linux | /etc/hosts                              |1234# github219.76.4.4 github-cloud.s3.amazonaws.com140.82.113.4 github.com151.101.185.194 github.global.ssl.fastly.netåˆ·æ–°DNSç¼“å­˜ï¼ŒLinux/Mac/Windows-åˆ·æ–°DNSçš„æ–¹æ³•centos: æ–¹å¼ä¸€: /etc/rc.d/init.d/nscd restartæ–¹å¼äºŒ: yum install -y nscdsystemctl restart nscdwindows: ipconfig /flushdnså¸¸ç”¨å‘½ä»¤netstat -atunlpæŸ¥çœ‹ç«¯å£å ç”¨æ€æ­»æŒ‡å®šè¿›ç¨‹gitbookæŒ‡å®šç«¯å£å¹¶åå°æ‰§è¡Œ12# æŒ‡å®šç«¯å£ä¸º4001ï¼Œå¹¶æ”¾åœ¨åå°æ‰§è¡Œsetsid gitbook serve --lrport=35729 --port=4001è‹¥å¯åŠ¨gitbookæŠ¥é”™1234Starting server ...Serving book on http://localhost:4000Error: ENOSPC: System limit for number of file watchers reached, watch '/home/hyc/github/bk_python/node_modules/entities/mathjax/jax/output/HTML-CSS/fonts/Neo-Euler/Symbols'åˆ™æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å³å¯12echo fs.inotify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf &amp;&amp; sudo sysctl -psudo sysctl --systemæ‰¹é‡æ€æ­»è¿›ç¨‹æŸ¥çœ‹è¿›ç¨‹å·1234[root@iZ2zeh6nc313zs4azjijjnZ ~]# ps -ef | grep gitbook | grep -v grep|awk '{print $2}'240642938730425æ–¹å¼ä¸€ï¼šbatch_shell12345678#!/bin/shdsp_admin_id=`ps -ef | grep gitbook | grep -v grep|awk '{print $2}'`echo $dsp_admin_idfor id in $dsp_admin_iddo    kill -9 $id      echo &quot;killed $id&quot; doneæ–¹å¼äºŒï¼šå•è¡Œæ‰§è¡Œ12#!/bin/shps -ef | grep gitbook | grep -v grep|grep 4000|  awk '{print $2}' | xargs kill -9</content>
	</entry>
	<entry>
		<title>Linuxå¸¸ç”¨å‘½ä»¤</title>
		<url>/article/48230.html</url>
		<content>linuxå¸¸ç”¨æŒ‡ä»¤linuxæŒ‡ä»¤å…¥é—¨æ–‡ä»¶ç±»è¿œç¨‹æ‹·è´æ–‡ä»¶(-P æ˜¯æŒ‡å®šç«¯å£ï¼Œ-r æ˜¯å¾ªç¯å¤åˆ¶)1scp -P port -r root@192.168.2.1:/home/hyc/test /home/hyc/æ–‡ä»¶æƒé™åˆ é™¤æ–‡ä»¶åˆ é™¤æ–‡ä»¶å¤¹ç§»åŠ¨æˆ–æ›´åæŸ¥æ‰¾æœç´¢: å¯»æ‰¾ç‰¹å®šæ¡£æ¡ˆï¼šfindã€locateã€whereisæŒ‰ç…§æ–‡ä»¶åæœç´¢12# è¯­æ³•: find æœç´¢è·¯å¾„ [é€‰é¡¹] æœç´¢å†…å®¹find / -name label_studio.sqlite3é€‰é¡¹ï¼š-name: æŒ‰ç…§æ–‡ä»¶åæœç´¢-iname: æŒ‰ç…§æ–‡ä»¶åæœç´¢ï¼Œä¸åŒºåˆ†æ–‡ä»¶åå¤§å°-inum: æŒ‰ç…§ inode å·æœç´¢æŒ‰ç…§æ–‡ä»¶ç±»å‹æœç´¢12# è¯­æ³•: find æœç´¢è·¯å¾„ [é€‰é¡¹] æœç´¢å†…å®¹find /home -type d -name huangycé€‰é¡¹:-type dï¼šæŸ¥æ‰¾ç›®å½•-type fï¼šæŸ¥æ‰¾æ™®é€šæ–‡ä»¶-type lï¼šæŸ¥æ‰¾è½¯é“¾æ¥æ–‡ä»¶å¯»æ‰¾ã€æ‰§è¡ŒæŒ¡ã€‘ï¼šwhichæŸ¥çœ‹æ–‡ä»¶å¤¹åŠå­ç›®å½•ä¸‹æ–‡ä»¶æ•°é‡12[root@uslave02 datasets]# ls -lR /home/hyc/ | grep -E &quot;.jpg|.png|.jpeg|.jpe&quot; |wc -l6599ç£ç›˜ç±»æŸ¥çœ‹æŸä¸ªæ–‡ä»¶æˆ–ç›®å½•å ç”¨ç£ç›˜ç©ºé—´çš„å¤§å°(éœ€è¦è¿›å…¥åˆ°å½“å‰ç›®å½•)1du -ah --max-depth=1æŸ¥çœ‹å…¨å±€æ–‡ä»¶ç³»ç»Ÿç£ç›˜å ç”¨1df -hæŸ¥çœ‹å½“å‰è·¯å¾„ä¸‹ å„æ–‡ä»¶å¤¹çš„ç£ç›˜å ç”¨1du -sh *é˜²ç«å¢™ç«¯å£ç±»é˜²ç«å¢™1234567891011121314151617181920# é‡å¯é˜²ç«å¢™firewall-cmd --reload# å…³é—­ç«¯å£ï¼ˆå…³é—­åéœ€è¦è¦é‡å¯é˜²ç«å¢™æ‰ç”Ÿæ•ˆï¼‰firewall-cmd --zone=public --remove-port=3338/tcp --permanent# å¼€æœºå¯åŠ¨é˜²ç«å¢™systemctl enable firewalld# å¼€å¯é˜²ç«å¢™systemctl start firewalld# æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€firewall-cmd --state# ç¦æ­¢é˜²ç«å¢™å¼€æœºå¯åŠ¨systemctl disable firewalld# åœæ­¢é˜²ç«å¢™systemctl stop firewalldæŸ¥çœ‹ç«¯å£å ç”¨123456# æŸ¥çœ‹å·²å¼€æ”¾çš„ç«¯å£firewall-cmd --list-ports# æˆ–# yum install net-toolsnetstat -atunlpå¼€å¯ç«¯å£1234# å¼€æ”¾ç«¯å£ï¼ˆå¼€æ”¾åéœ€è¦è¦é‡å¯é˜²ç«å¢™æ‰ç”Ÿæ•ˆï¼‰firewall-cmd --zone=public --add-port=3338/tcp --permanent# é…ç½®ç«‹å³ç”Ÿæ•ˆfirewall-cmd --reloadwinç«¯å£æ‹“å±•ä¸‹windowsä¸‹çš„ç«¯å£æŸ¥æ‰¾å’Œkillæ“ä½œ1234567891011C:\Users\Administrator&gt;netstat -aon | findstr &quot;4000&quot;  TCP    0.0.0.0:4000           0.0.0.0:0              LISTENING       12128  TCP    127.0.0.1:4000         127.0.0.1:57174        TIME_WAIT       0  TCP    127.0.0.1:4000         127.0.0.1:57175        TIME_WAIT       0  TCP    [::]:4000              [::]:0                 LISTENING       12128C:\Users\Administrator&gt;tasklist|findstr &quot;12128&quot;node.exe                     12128 Console                    3    141,152 KC:\Users\Administrator&gt;taskkill /T /F /PID 12128æˆåŠŸ: å·²ç»ˆæ­¢ PID 12128 (å±äº PID 24224 å­è¿›ç¨‹)çš„è¿›ç¨‹ã€‚è¿›ç¨‹ç±»æ€æ­»æŒ‡å®šè¿›ç¨‹æ‰¹é‡æ€æ­»è¿›ç¨‹æŸ¥çœ‹è¿›ç¨‹å·1234[root@iZ2zeh6nc313zs4azjijjnZ ~]# ps -ef | grep gitbook | grep -v grep|awk '{print $2}'240642938730425æ–¹å¼ä¸€ï¼šbatch_shell12345678#!/bin/shdsp_admin_id=`ps -ef | grep gitbook | grep -v grep|awk '{print $2}'`echo $dsp_admin_idfor id in $dsp_admin_iddo    kill -9 $id      echo &quot;killed $id&quot; doneæ–¹å¼äºŒï¼šå•è¡Œæ‰§è¡Œ12#!/bin/shps -ef | grep gitbook | grep -v grep|grep 4000|  awk '{print $2}' | xargs kill -9è§£å‹ç¼©å‹ç¼©123456tar -cvf jpg.tar *.jpg //å°†ç›®å½•é‡Œæ‰€æœ‰jpgæ–‡ä»¶æ‰“åŒ…æˆjpg.tartar -czf jpg.tar.gz *.jpg //å°†ç›®å½•é‡Œæ‰€æœ‰jpgæ–‡ä»¶æ‰“åŒ…æˆjpg.taråï¼Œå¹¶ä¸”å°†å…¶ç”¨gzipå‹ç¼©rar a jpg.rar *.jpg //raræ ¼å¼çš„å‹ç¼©ï¼Œéœ€è¦å…ˆä¸‹è½½rar for linuxzip jpg.zip *.jpg //zipæ ¼å¼çš„å‹ç¼©ï¼Œéœ€è¦å…ˆä¸‹è½½zip for linuxè§£å‹ç¼©12345678tar -xvf file.tar -C DestPath 1.txt //è§£å‹ taråŒ…  1.txtè¡¨ç¤ºåªéœ€è¦è§£å‹å‡ºè¿™ä¸ªæ–‡ä»¶,é»˜è®¤è§£å‹æ‰€æœ‰tar -xzvf file.tar.gz //è§£å‹tar.gztar -xjvf file.tar.bz2 //è§£å‹ tar.bz2tar -xZvf file.tar.Z //è§£å‹tar.Zunrar e file.rar DestPath //è§£å‹rarunzip file.zip //è§£å‹zipæ—¥æœŸæ—¶é—´æ˜¾ç¤ºæ—¥æœŸ12[root@iZ2zeh6nc313zs4azjijjnZ ~]# date2022å¹´ 03æœˆ 12æ—¥ æ˜ŸæœŸå…­ 10:57:52 CSTæ˜¾ç¤ºæ—¥å†12345678[root@iZ2zeh6nc313zs4azjijjnZ ~]# cal      ä¸‰æœˆ 2022     æ—¥ ä¸€ äºŒ ä¸‰ å›› äº” å…­       1  2  3  4  5 6  7  8  9 10 11 1213 14 15 16 17 18 1920 21 22 23 24 25 2627 28 29 30 31ç¯å¢ƒå˜é‡åœ¨CentOSæ“ä½œç³»ç»Ÿä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å‡ ç§æ–¹å¼æ¥è®¾ç½®ç¯å¢ƒå˜é‡ã€‚ä»¥ä¸‹æ˜¯å…¶ä¸­ä¸€äº›å¸¸è§çš„æ–¹æ³•ï¼š/etc/profileæ–‡ä»¶é€šè¿‡/etc/profileæ–‡ä»¶ï¼šåœ¨CentOSä¸­ï¼Œå¯ä»¥ç¼–è¾‘/etc/profileæ–‡ä»¶æ¥è®¾ç½®ç³»ç»ŸèŒƒå›´çš„ç¯å¢ƒå˜é‡ã€‚æ‰“å¼€è¯¥æ–‡ä»¶å¹¶åœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ æ‚¨æƒ³è¦è®¾ç½®çš„ç¯å¢ƒå˜é‡ï¼Œä¾‹å¦‚ï¼š1export MY_VARIABLE=/path/to/my/directoryä¿å­˜æ–‡ä»¶åï¼Œé‡æ–°ç™»å½•æˆ–è¿è¡Œsource /etc/profileä»¥ä½¿æ›´æ”¹ç”Ÿæ•ˆ~/.bash_profileæˆ–~/.bashrcé€šè¿‡~/.bash_profileæˆ–~/.bashrcæ–‡ä»¶ï¼šæ¯ä¸ªç”¨æˆ·å¯ä»¥åœ¨å…¶ä¸»ç›®å½•ä¸­çš„.bash_profileæˆ–.bashrcæ–‡ä»¶ä¸­è®¾ç½®ä¸ªäººç¯å¢ƒå˜é‡ã€‚è¿™äº›æ–‡ä»¶ä¼šåœ¨ç”¨æˆ·ç™»å½•æ—¶è‡ªåŠ¨åŠ è½½ã€‚æ‰“å¼€å…¶ä¸­ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶åœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ ç±»ä¼¼çš„è¡Œï¼š1export MY_VARIABLE=/path/to/my/directoryä¿å­˜æ–‡ä»¶åï¼Œæ³¨é”€å¹¶é‡æ–°ç™»å½•ï¼Œæˆ–è€…ä½¿ç”¨å‘½ä»¤source ~/.bash_profileï¼ˆæˆ–source ~/.bashrcï¼‰æ¥åŠ è½½æ›´æ”¹/etc/environmentæ–‡ä»¶é€šè¿‡/etc/environmentæ–‡ä»¶ï¼šå¯ä»¥ç¼–è¾‘/etc/environmentæ–‡ä»¶æ¥è®¾ç½®ç³»ç»ŸèŒƒå›´çš„å…¨å±€ç¯å¢ƒå˜é‡ã€‚è¯¥æ–‡ä»¶åŒ…å«é€è¡Œçš„â€key=valueâ€å¯¹ã€‚ä¾‹å¦‚ï¼š1MY_VARIABLE=/path/to/my/directoryä¿å­˜æ–‡ä»¶åï¼Œé‡æ–°ç™»å½•æˆ–é‡å¯ç³»ç»Ÿä»¥ä½¿æ›´æ”¹ç”Ÿæ•ˆå‘½ä»¤è¡Œä¸´æ—¶è®¾ç½®å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­ä¸´æ—¶è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œä»…å¯¹å½“å‰ä¼šè¯æœ‰æ•ˆã€‚ä½¿ç”¨ä»¥ä¸‹è¯­æ³•ï¼š1export MY_VARIABLE=/path/to/my/directoryè¿™å°†åœ¨å½“å‰ä¼šè¯ä¸­è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œä½†åœ¨æ³¨é”€æˆ–é‡æ–°å¯åŠ¨åä¸ä¼šä¿ç•™è¯·æ³¨æ„ï¼Œè®¾ç½®ç¯å¢ƒå˜é‡åï¼Œæ‚¨å¯èƒ½éœ€è¦é‡æ–°å¯åŠ¨ç›¸å…³åº”ç”¨ç¨‹åºæˆ–ç»ˆç«¯çª—å£ï¼Œä»¥ä¾¿å®ƒä»¬èƒ½å¤Ÿè¯»å–æ–°çš„ç¯å¢ƒå˜é‡å€¼åå°æ‰§è¡Œcloudreveç§æœ‰äº‘ç›˜é…ç½®åå°è¿è¡Œsystemctlæ–¹å¼12345678910111213141516171819202122vi /usr/lib/systemd/system/cloudreve.service# è¾“å…¥ä»¥ä¸‹å†…å®¹ï¼Œæ³¨æ„æœ€å¥½åˆ«å¸¦ä¸­æ–‡[Unit]Description=CloudreveDocumentation=https://docs.cloudreve.orgAfter=network.targetWants=network.target[Service]Type=simpleWorkingDirectory=/home/software/cloudreveExecStart=/home/software/cloudreve/cloudreveRestart=on-abnormalRestartSec=5sKillMode=mixedStandardOutput=nullStandardError=syslog[Install]WantedBy=multi-user.targetæ›´æ–°é‡å¯æœåŠ¡12345678# æ›´æ–°é…ç½®systemctl daemon-reload# å¯åŠ¨æœåŠ¡systemctl start cloudreve# è®¾ç½®å¼€æœºå¯åŠ¨systemctl enable cloudreveç®¡ç†å‘½ä»¤1234567891011# å¯åŠ¨æœåŠ¡systemctl start cloudreve# åœæ­¢æœåŠ¡systemctl stop cloudreve# é‡å¯æœåŠ¡systemctl restart cloudreve# æŸ¥çœ‹çŠ¶æ€systemctl status cloudrevenohupæ–¹å¼1nohup python run.pt &gt; log.log &amp;svnåŸºæœ¬ä½¿ç”¨centoså®‰è£…svnå®¢æˆ·ç«¯12345# å®‰è£…svnå®¢æˆ·ç«¯yum install mod_dav_svn# æŸ¥çœ‹å½“å‰svnçš„ç‰ˆæœ¬svnserve --versionæ‹‰å–é¡¹ç›®(å·²å­˜åœ¨)1svn checkout svn://10.10.13.13æäº¤ä¸Šä¼ æ–‡ä»¶123svn add &lt;æ–‡ä»¶è·¯å¾„&gt;svn commit -m &quot;æäº¤è¯´æ˜&quot; &lt;æ–‡ä»¶è·¯å¾„&gt;å¦‚æœè¦æäº¤æ•´ä¸ªç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œå¯ä»¥å°† &lt;æ–‡ä»¶è·¯å¾„&gt; æ›¿æ¢ä¸ºç›®å½•çš„è·¯å¾„æ›´æ–°æ–‡ä»¶checkoutåªåœ¨ç¬¬ä¸€æ¬¡é“¾æ¥æ—¶ä½¿ç”¨ä¸€æ¬¡ï¼Œä»¥åå¦‚æœè¿›è¡Œæ›´æ–°æ“ä½œè¯·ä½¿ç”¨updateæŒ‡ä»¤ç³»ç»Ÿçº§ç‰ˆæœ¬ä¿¡æ¯12345678[root@iZ2zeh6nc313zs4azjijjnZ ~]# uname -r3.10.0-1062.12.1.el7.x86_64[root@iZ2zeh6nc313zs4azjijjnZ ~]# lsb_release -aLSB Version:    :core-4.1-amd64:core-4.1-noarchDistributor ID: CentOSDescription:    CentOS Linux release 7.7.1908 (Core)Release:        7.7.1908Codename:       Coreè½¯é“¾æ¥lnæ˜¯linuxä¸­åˆä¸€ä¸ªéå¸¸é‡è¦å‘½ä»¤ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯ä¸ºæŸä¸€ä¸ªæ–‡ä»¶åœ¨å¦å¤–ä¸€ä¸ªä½ç½®å»ºç«‹ä¸€ä¸ªåŒæ­¥çš„é“¾æ¥å½“æˆ‘ä»¬éœ€è¦åœ¨ä¸åŒçš„ç›®å½•ï¼Œç”¨åˆ°ç›¸åŒçš„æ–‡ä»¶æ—¶ï¼Œæˆ‘ä»¬ä¸éœ€è¦åœ¨æ¯ä¸€ä¸ªéœ€è¦çš„ç›®å½•ä¸‹éƒ½æ”¾ä¸€ä¸ªå¿…é¡»ç›¸åŒçš„æ–‡ä»¶æˆ‘ä»¬åªè¦åœ¨æŸä¸ªå›ºå®šçš„ç›®å½•ï¼Œæ”¾ä¸Šè¯¥æ–‡ä»¶ï¼Œç„¶ååœ¨ å…¶å®ƒçš„ç›®å½•ä¸‹ç”¨lnå‘½ä»¤é“¾æ¥(link)å®ƒå°±å¯ä»¥ï¼Œä¸å¿…é‡å¤çš„å ç”¨ç£ç›˜ç©ºé—´è¿™ä¸ªå‘½ä»¤æœ€å¸¸ç”¨çš„å‚æ•°æ˜¯-s,å…·ä½“ç”¨æ³•æ˜¯ï¼šln -s æºæ–‡ä»¶ ç›®æ ‡æ–‡ä»¶æŠ¥é”™ä¾‹å­1ImportError: /lib64/libstdc++.so.6: version `GLIBCXX_3.4.21' not found (required by /home/anaconda/install/envs/stk37/lib/python3.7/site-packages/pandas/_libs/window/aggregations.cpython-37m-x86_64-linux-gnu.so)è§£å†³æ–¹æ¡ˆ1234567891011# æŸ¥æ‰¾libåº“sudo find / -name &quot;libstdc++.so.6*&quot;# ä»ä¸Šè¿°åˆ—è¡¨é‡Œæ‰¾ä¸€ä¸ªè·¯å¾„ï¼ŒæŸ¥çœ‹æ˜¯å¦å­˜åœ¨æˆ‘ä»¬éœ€è¦çš„'GLIBCXX_3.4.21'strings /home/anaconda/lib/x86_64-conda_cos6-linux-gnu/sysroot/lib/libstdc++.so.6 |grep GLIBCXX_3.4.21# å¦‚æœå­˜åœ¨çš„è¯ï¼Œå»ºç«‹è½¯é“¾æ¥åˆ°æˆ‘ä»¬éœ€è¦çš„åœ°æ–¹ï¼Œè¿™é‡Œä¾‹å­é‡Œæ˜¯/lib64/libstdc++.so.6ln -s /home/anaconda/lib/x86_64-conda_cos6-linux-gnu/sysroot/lib/libstdc++.so.6 /lib64/libstdc++.so.6# æ³¨æ„å¦‚æœ/lib64/libstdc++.so.6 å·²ç»å­˜åœ¨ï¼Œæ­¤æ—¶ä¸Šè¿°å‘½ä»¤ä¼šæŠ¥é”™ï¼Œéœ€è¦å…ˆå¤‡ä»½ååˆ é™¤ï¼Œå†æ‰§è¡Œlnï¼Œ(ä½†æ˜¯é‡Œé¢æ²¡æœ‰æˆ‘ä»¬éœ€è¦çš„'GLIBCXX_3.4.21'ï¼Œå¯ä»¥ç”¨stringsæŸ¥çœ‹)cp /lib64/libstdc++.so.6 /lib64/libstdc++.so.6_bakrm /lib64/libstdc++.so.6ln -s /home/anaconda/lib/x86_64-conda_cos6-linux-gnu/sysroot/lib/libstdc++.so.6 /lib64/libstdc++.so.6# è‡³æ­¤å®Œæˆè½¯é“¾æ¥é…ç½®ä»£ç†é…ç½®ç³»ç»Ÿä»£ç†yumä»£ç†wgetä»£ç†ä¿®æ”¹é…ç½®æ–‡ä»¶/etc/profileï¼Œå³å¯é…ç½®centosé€šè¿‡ä»£ç†è¿›è¡Œä¸Šç½‘123456789# ç¼–è¾‘é…ç½®æ–‡ä»¶vi /etc/profile# æ·»åŠ ä»£ç†æœåŠ¡å™¨ipåœ°å€å’Œç«¯å£å·export http_proxy=http://192.168.xx.xx:portexport https_proxy=http://192.168.xx.xx:portexport ftp_proxy=$http_proxy# ä½¿é…ç½®æ–‡ä»¶ç”Ÿæ•ˆsource /etc/profileåœ¨/etc/yum.confåé¢æ·»åŠ ä»¥ä¸‹å†…å®¹123456# ç¼–è¾‘é…ç½®æ–‡ä»¶vi /etc/yum.confproxy=http://127.0.0.1:8080# ä½¿é…ç½®æ–‡ä»¶ç”Ÿæ•ˆsource /etc/yum.confç¼–è¾‘é…ç½®æ–‡ä»¶/etc/wgetrcæ·»åŠ ä¸‹é¢ä¸¤è¡Œ1234567# ç¼–è¾‘é…ç½®æ–‡ä»¶vi /etc/wgetrchttp_proxy=http://127.0.0.1:8080https_proxy=http://127.0.0.1:8080# ä½¿é…ç½®æ–‡ä»¶ç”Ÿæ•ˆsource /etc/wgetrcåŒ…ç®¡ç†å®‰è£… RPM åŒ…1sudo rpm -ivh --prefix=&lt;installation_path&gt; &lt;package_name&gt;--prefixä¸ºå¯é€‰é¡¹ï¼Œç”¨äºæŒ‡å®šå®‰è£…è·¯å¾„ã€‚å¦‚ä¸è®¾ç½®ï¼Œç³»ç»Ÿä¼šå°†å®‰è£…åˆ°é»˜è®¤è·¯å¾„</content>
	</entry>
	<entry>
		<title>githubåä½œ</title>
		<url>/article/51084.html</url>
		<content>githubåä½œGitHub å¤šäººåä½œå¼€å‘ä¸‰ç§æ–¹å¼Fork æ–¹å¼æš‚æ— Organizationsæ–¹å¼å‡†å¤‡é¡¹ç›®æ–°å»ºç»„ç»‡(åˆ›å»ºå…è´¹çš„å³å¯ï¼Œæœ‰æ¯æœˆå…è´¹2000åˆ†é’Ÿ)åˆ›å»ºteam(ä¸å»ºä¹Ÿæ˜¯å¯ä»¥ï¼Œå»ºäº†å®¹æ˜“ç®¡ç†)æ·»åŠ teamæˆå‘˜ï¼Œåœ¨ç»„ç»‡ä¸‹é€‰æ‹©teamï¼Œç»™teamæ‹‰é˜Ÿå‹ï¼Œé˜Ÿå‹æ”¶åˆ°é‚®ä»¶åï¼ŒåŒæ„äº†å°±å¯ä»¥åŠ å…¥ä»“åº“è½¬å…¥(åŸæ¥å·²æœ‰çš„ä»“åº“ï¼Œè¿›å…¥ä»“åº“é€‰æ‹©settingsï¼Œä¸‹æ»‘é€‰Transfer)æˆ–åœ¨æ–°å»ºé¡¹ç›®ä¸ºç»„ç»‡ä¸‹çš„ä»“åº“æ·»åŠ åˆä½œè€…ï¼Œé…ç½®æƒé™è®¾ç½®ä¸»åˆ†æ”¯ä¿æŠ¤ï¼Œä¸è®©å…¶ä»–äººç›´æ¥pushåˆ°ä¸»åˆ†æ”¯ï¼Œæ‰“å¼€ä»“åº“ä¸‹çš„settingsï¼Œé€‰æ‹©branchsæ·»åŠ Branch protection ruleså¼€å§‹åä½œåä½œè€…åœ¨ç»„ç»‡ä¸‹æ‰¾åˆ°å¯¹åº”çš„ä»“åº“ï¼Œå…‹éš†ä»“åº“åˆ°æœ¬åœ°1git clone git@github.com:hycBook/bk_python.gitå¼€å§‹ç¼–å†™ï¼Œå®Œæˆåæäº¤è‡³æ–°åˆ†æ”¯ï¼Œä¸€èˆ¬å‘½åä¸ºdev_xxxæ–°åˆ†æ”¯åˆ›å»ºä¸€æ¬¡å°±å¯ä»¥ï¼Œcommitä¹‹åï¼Œå†pushåˆ°è‡ªå·±çš„dev_xxxåˆ†æ”¯æ³¨æ„ï¼šåœ¨ä¿®æ”¹æ–‡ä»¶ä¹‹å‰ä¸€èˆ¬æ˜¯å…ˆä»ä¸»åˆ†æ”¯æ‹‰å–æœ€æ–°å†…å®¹ï¼Œä¿®æ”¹å®Œæˆåå°½æ—©æäº¤ï¼Œè¾ƒå°‘å†²çªcommitå’Œpushæ“ä½œéƒ½æ˜¯åœ¨è‡ªå·±çš„dev_xxxåˆ†æ”¯ï¼Œpullæ“ä½œæ˜¯ä»ä¸»åˆ†æ”¯æ¥åˆ°githubç•Œé¢ï¼Œé€‰æ‹©Pull requestsï¼Œåœ¨é€‰æ‹©New pull requestï¼Œé€‰æ‹©åˆ†æ”¯æäº¤åˆå¹¶è¯·æ±‚åï¼Œç­‰å¾…åˆå¹¶å³å¯åˆä½œè€…æš‚æ— githun actionsGithub Actions æ˜¯ Github æ¨å‡ºçš„è‡ªåŠ¨åŒ–æ„å»ºå·¥å…·ï¼Œä¸€èˆ¬æ¥è¯´ï¼ŒCI / CD ï¼ˆæŒç»­é›†æˆ / æŒç»­éƒ¨ç½²ï¼‰éƒ½éœ€è¦è‡ªå·±çš„è®¡ç®—èµ„æºï¼Œä½† Github Actions æä¾›å…è´¹çš„è®¡ç®—èµ„æºï¼Œè¿™æ˜¯å®ƒçš„ä¼˜åŠ¿ä¹‹ä¸€ï¼Œç”¨æˆ·åªç”¨æ“å¿ƒ workflow æ–‡ä»¶ï¼Œä¸ç”¨å…³å¿ƒç¯å¢ƒç›¸å…³çš„çç¢ï¼Œä¾¿å¯éƒ¨ç½² CI / CDï¼ŒåŠ é€Ÿäº†æµç¨‹ã€‚åœ¨ GitHub Actions ä¸­ï¼Œä¸€æ¬¡æ‰§è¡Œè¿‡ç¨‹è¢«ç§°ä¸ºä¸€ä¸ª workflowï¼Œä¸€ä¸ª workflow ä¸­å¯ä»¥æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ª jobï¼Œjob åˆç”± step ç»„æˆï¼Œstep ä¸­å¯ä»¥æ‰§è¡Œ actionï¼Œå°±æ˜¯ä¸€æ¡æ¡å‘½ä»¤githubåŒæ­¥giteeHub Mirror Actionä¸€ä¸ªç”¨äºåœ¨hubé—´ï¼ˆä¾‹å¦‚Githubï¼ŒGiteeï¼‰è´¦æˆ·ä»£ç ä»“åº“åŒæ­¥çš„actionå‡†å¤‡æ­¥éª¤æœ¬åœ°ç”Ÿæˆå…¬é’¥å’Œç§˜é’¥1ssh-keygen -t -C &quot;1832044043@qq.com&quot;å…¬é’¥æ”¾åœ¨giteegithubé¡¹ç›®ä¸‹æ–°å»ºï¼šname=GITEE_PRIVATE_KEYï¼Œvalue=ç§˜é’¥giteeç”Ÿæˆtokengithubé¡¹ç›®ä¸‹æ–°å»ºï¼šname=GITEE_TOKENï¼Œvalue=giteeç”Ÿæˆçš„tokenåŸºæœ¬ç”¨æ³•1234567891011121314steps:    - name: Sync Github Repos To Gitee  # åå­—éšä¾¿èµ·      uses: Yikun/hub-mirror-action@master  # ä½¿ç”¨Yikun/hub-mirror-action      with:        src: github/hycBook  # æºç«¯è´¦æˆ·å(github),å¦‚æœæ˜¯ç»„ç»‡çš„è¯è¦ç”¨ç»„ç»‡å,æ­¤æ—¶account_type=org        dst: gitee/hycBook  # ç›®çš„ç«¯è´¦æˆ·å(gitee),å¦‚æœæ˜¯ç»„ç»‡çš„è¯è¦ç”¨ç»„ç»‡å,æ­¤æ—¶account_type=org        dst_key: ${{ secrets.GITEE_PRIVATE_KEY }}  # SSHå¯†é’¥å¯¹ä¸­çš„ç§é’¥        dst_token:  ${{ secrets.GITEE_TOKEN }}  # Giteeè´¦æˆ·çš„ç§äººä»¤ç‰Œ        account_type: org  # è´¦æˆ·ç±»å‹,        # clone_style: &quot;ssh&quot;  # ä½¿ç”¨httpsæ–¹å¼è¿›è¡Œcloneï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ssh        debug: true  # å¯ç”¨åä¼šæ˜¾ç¤ºæ‰€æœ‰æ‰§è¡Œå‘½ä»¤        force_update: true  # å¯ç”¨åï¼Œå¼ºåˆ¶åŒæ­¥ï¼Œå³å¼ºåˆ¶è¦†ç›–ç›®çš„ç«¯ä»“åº“        static_list: &quot;bk_index&quot;  # é™æ€åŒæ­¥åˆ—è¡¨ï¼Œåœ¨æ­¤å¡«å†™éœ€è¦åŒæ­¥çš„ä»“åº“åç§°ï¼Œå¯å¡«å†™å¤šä¸ª        timeout: '660s'  # gitè¶…æ—¶è®¾ç½®ï¼Œè¶…æ—¶åä¼šè‡ªåŠ¨é‡è¯•gitæ“ä½œå¿…é€‰å‚æ•°src éœ€è¦è¢«åŒæ­¥çš„æºç«¯è´¦æˆ·åï¼Œå¦‚github/kunpengcomputeï¼Œè¡¨ç¤ºGithubçš„kunpengcomputeè´¦æˆ·ã€‚dst éœ€è¦åŒæ­¥åˆ°çš„ç›®çš„ç«¯è´¦æˆ·åï¼Œå¦‚gitee/kunpengcomputeï¼Œè¡¨ç¤ºGiteeçš„kunpengcomputeè´¦æˆ·ã€‚dst_key ç”¨äºåœ¨ç›®çš„ç«¯ä¸Šä¼ ä»£ç çš„ç§é’¥(é»˜è®¤å¯ä»¥ä»~/.ssh/id_rsaè·å–ï¼‰ï¼Œå¯å‚è€ƒç”Ÿæˆ/æ·»åŠ SSHå…¬é’¥æˆ–generating SSH keysç”Ÿæˆï¼Œå¹¶ç¡®è®¤å¯¹åº”å…¬é’¥å·²ç»è¢«æ­£ç¡®é…ç½®åœ¨ç›®çš„ç«¯ã€‚å¯¹åº”å…¬é’¥ï¼ŒGithubå¯ä»¥åœ¨è¿™é‡Œé…ç½®ï¼ŒGiteeå¯ä»¥è¿™é‡Œé…ç½®ã€‚dst_token åˆ›å»ºä»“åº“çš„API tokensï¼Œ ç”¨äºè‡ªåŠ¨åˆ›å»ºä¸å­˜åœ¨çš„ä»“åº“ï¼ŒGithubå¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ï¼ŒGiteeå¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ã€‚å¯é€‰å‚æ•°account_type é»˜è®¤ä¸ºuserï¼Œæºå’Œç›®çš„çš„è´¦æˆ·ç±»å‹ï¼Œå¯ä»¥è®¾ç½®ä¸ºorgï¼ˆç»„ç»‡ï¼‰æˆ–è€…userï¼ˆç”¨æˆ·ï¼‰ï¼Œè¯¥å‚æ•°æ”¯æŒåŒç±»å‹è´¦æˆ·ï¼ˆå³ç»„ç»‡åˆ°ç»„ç»‡ï¼Œæˆ–ç”¨æˆ·åˆ°ç”¨æˆ·ï¼‰çš„åŒæ­¥ã€‚å¦‚æœæºç›®çš„ä»“åº“æ˜¯ä¸åŒç±»å‹ï¼Œè¯·å•ç‹¬ä½¿ç”¨src_account_typeå’Œdst_account_typeé…ç½®ã€‚src_account_type é»˜è®¤ä¸ºaccount_typeï¼Œæºè´¦æˆ·ç±»å‹ï¼Œå¯ä»¥è®¾ç½®ä¸ºorgï¼ˆç»„ç»‡ï¼‰æˆ–è€…userï¼ˆç”¨æˆ·ï¼‰ã€‚dst_account_type é»˜è®¤ä¸ºaccount_typeï¼Œç›®çš„è´¦æˆ·ç±»å‹ï¼Œå¯ä»¥è®¾ç½®ä¸ºorgï¼ˆç»„ç»‡ï¼‰æˆ–è€…userï¼ˆç”¨æˆ·ï¼‰ã€‚clone_style é»˜è®¤ä¸ºhttpsï¼Œå¯ä»¥è®¾ç½®ä¸ºsshæˆ–è€…httpsã€‚å½“è®¾ç½®ä¸ºsshæ—¶ï¼Œä½ éœ€è¦å°†dst_keyæ‰€å¯¹åº”çš„å…¬é’¥åŒæ—¶é…ç½®åˆ°æºç«¯å’Œç›®çš„ç«¯ã€‚cache_path é»˜è®¤ä¸ºâ€™â€™, å°†ä»£ç ç¼“å­˜åœ¨æŒ‡å®šç›®å½•ï¼Œç”¨äºä¸actions/cacheé…åˆä»¥åŠ é€Ÿé•œåƒè¿‡ç¨‹ã€‚black_list é»˜è®¤ä¸ºâ€™â€™, é…ç½®åï¼Œé»‘åå•ä¸­çš„reposå°†ä¸ä¼šè¢«åŒæ­¥ï¼Œå¦‚â€œrepo1,repo2,repo3â€ã€‚white_list é»˜è®¤ä¸ºâ€™â€™, é…ç½®åï¼Œä»…åŒæ­¥ç™½åå•ä¸­çš„reposï¼Œå¦‚â€œrepo1,repo2,repo3â€ã€‚static_list é»˜è®¤ä¸ºâ€™â€™, é…ç½®åï¼Œä»…åŒæ­¥é™æ€åˆ—è¡¨ï¼Œä¸ä¼šå†åŠ¨æ€è·å–éœ€åŒæ­¥åˆ—è¡¨ï¼ˆé»‘ç™½åå•æœºåˆ¶ä¾æ—§ç”Ÿæ•ˆï¼‰ï¼Œå¦‚â€œrepo1,repo2,repo3â€ã€‚force_update é»˜è®¤ä¸ºfalse, é…ç½®åï¼Œå¯ç”¨git push -få¼ºåˆ¶åŒæ­¥ï¼Œæ³¨æ„ï¼šå¼€å¯åï¼Œä¼šå¼ºåˆ¶è¦†ç›–ç›®çš„ç«¯ä»“åº“ã€‚debug é»˜è®¤ä¸ºfalse, é…ç½®åï¼Œå¯ç”¨debugå¼€å…³ï¼Œä¼šæ˜¾ç¤ºæ‰€æœ‰æ‰§è¡Œå‘½ä»¤ã€‚timeout é»˜è®¤ä¸ºâ€™30mâ€™, ç”¨äºè®¾ç½®æ¯ä¸ªgitå‘½ä»¤çš„è¶…æ—¶æ—¶é—´ï¼Œâ€™600â€™=&gt;600s, â€˜30mâ€™=&gt;30 mins, â€˜1hâ€™=&gt;1 hoursmappings æºä»“åº“æ˜ å°„è§„åˆ™ï¼Œæ¯”å¦‚â€™A=&gt;B, C=&gt;CCâ€™, Aä¼šè¢«æ˜ å°„ä¸ºBï¼ŒCä¼šæ˜ å°„ä¸ºCCï¼Œæ˜ å°„ä¸å…·æœ‰ä¼ é€’æ€§ã€‚ä¸»è¦ç”¨äºæºå’Œç›®çš„ä»“åº“åä¸åŒçš„é•œåƒã€‚éƒ¨ç½²github pagesGitHub Pages Deploy Actionè‡ªåŠ¨å‘å¸ƒåˆ°github pagesåˆ†æ”¯(å¯ä»¥è‡ªå·±è®¾ç½®åˆ†æ”¯)é…ç½®tokengithubé¡¹ç›®ä¸‹æ–°å»ºï¼šname=TOKENï¼Œvalue=githubç”Ÿæˆçš„tokenåŸºæœ¬ç”¨æ³•123456- name: Deploy #æ­¥éª¤4ï¼šæŠŠç¼–è¯‘å¥½çš„é™æ€ç›®å½•ä¸Šä¼ åˆ°gh-pagesåˆ†æ”¯ä¸Š  uses: JamesIves/github-pages-deploy-action@3.1.5 #è¿™é‡Œè°ƒç”¨ç¬¬ä¸‰æ–¹ä¾èµ–ï¼Œç”¨äºä¸Šä¼ ä»£ç åˆ°æŒ‡å®šåˆ†æ”¯ä¸Š  with:    ACCESS_TOKEN: ${{ secrets.TOKEN }}    BRANCH: gh-pages #github pages é»˜è®¤çš„åˆ†æ”¯    FOLDER: _book #ä¸Šä¼ æ–‡ä»¶çš„ç›®å½•ï¼Œæˆ‘è¿™ä¸ªç›®å½•åœ¨æ ¹ç›®å½•ä¸‹ï¼Œå¦‚æœæ˜¯å­ç›®å½•å¯ä»¥è¿™ä¹ˆå†™  docs/.vuepress/distå‘å¸ƒreleaseaction-automatic-releases@latestè‡ªåŠ¨åˆ›å»ºreleaseï¼Œå¹¶å‘å¸ƒåŸºæœ¬ç”¨æ³•123456789- name: Create GitHub release  uses: marvinpinto/action-automatic-releases@latest  with:    repo_token: ${{ secrets.TOKEN }}    automatic_release_tag: 'ebook_index' # å‘å¸ƒæ ‡ç­¾    title: ${{ env.ReleaseVersion }}    prerelease: false    files: |      _ebook/* # å‘å¸ƒçš„ç›®å½•build gitee pagesGitee å¦‚ä½•è‡ªåŠ¨éƒ¨ç½² Pagesï¼Ÿè¿˜æ˜¯ç”¨ GitHub Actions!ä½¿ç”¨ GitHub Actions è§£å†³äº† GitHub ä»£ç è‡ªåŠ¨åŒæ­¥ Gitee çš„é—®é¢˜ï¼Œä½†æˆ‘ä»¬çš„åšå®¢ä»“åº“ä»£ç åŒæ­¥åˆ° Gitee åï¼Œå¹¶ä¸èƒ½åƒ GitHub ä¸€æ ·è‡ªåŠ¨éƒ¨ç½² Pagesï¼Œå¦‚æœä¸ä½¿ç”¨ä»˜è´¹çš„ Gitee Pages Pro æœåŠ¡ï¼Œé‚£æˆ‘ä»¬è¯¥æ€ä¹ˆå®ç° Gitee è‡ªåŠ¨éƒ¨ç½² Pages å‘¢åŸºæœ¬ç”¨æ³•æ–°å»ºä¸€ä¸ªname=GITEE_PASSWORD, value=giteeç™»é™†å¯†ç çš„secrets1234567891011- name: Build Gitee Pages  uses: yanglbme/gitee-pages-action@main  with:    # æ³¨æ„æ›¿æ¢ä¸ºä½ çš„ Gitee ç”¨æˆ·å    gitee-username: narutohyc    # æ³¨æ„åœ¨ Settings-&gt;Secrets é…ç½® GITEE_PASSWORD    gitee-password: ${{ secrets.GITEE_PASSWORD }}    # æ³¨æ„æ›¿æ¢ä¸ºä½ çš„ Gitee ä»“åº“ï¼Œä»“åº“åä¸¥æ ¼åŒºåˆ†å¤§å°å†™ï¼Œè¯·å‡†ç¡®å¡«å†™ï¼Œå¦åˆ™ä¼šå‡ºé”™    gitee-repo: hycBook/bk_index    # è¦éƒ¨ç½²çš„åˆ†æ”¯ï¼Œé»˜è®¤æ˜¯ masterï¼Œè‹¥æ˜¯å…¶ä»–åˆ†æ”¯ï¼Œåˆ™éœ€è¦æŒ‡å®šï¼ˆæŒ‡å®šçš„åˆ†æ”¯å¿…é¡»å­˜åœ¨ï¼‰    branch: gh-pagesgithubåŸºæœ¬å‘½ä»¤å¼ºåˆ¶è¦†ç›–æœ¬åœ°æ–‡ä»¶123456git fetch --allgit reset --hard origin/mastergit pull# å•æ¡æ‰§è¡Œgit fetch --all &amp;&amp;  git reset --hard origin/master &amp;&amp; git pull</content>
	</entry>
	<entry>
		<title>gitbookåšå®¢æ­å»º</title>
		<url>/article/44835.html</url>
		<content>gitbookä½¿ç”¨ Gitbook æ‰“é€ ä½ çš„ç”µå­ä¹¦gitbookå®˜ç½‘ç¯å¢ƒæ­å»ºnodejså®˜ç½‘ä¸‹è½½ï¼Œè¿™é‡Œå¯ä»¥é€‰æ‹©12.16.1ç‰ˆæœ¬ï¼Œå¤ªæ–°çš„ç‰ˆæœ¬åé¢å¯èƒ½ä¼šå‡ºç°å¥‡æ€ªçš„é—®é¢˜ï¼Œè¿™æ˜¯ç¬”è€…ä½¿ç”¨çš„ç‰ˆæœ¬æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…gitbookå‘½ä»¤123456npm install -g gitbook-cli# æŸ¥çœ‹æ˜¯å¦å®‰è£…å®Œæˆ, èƒ½æ­£ç¡®æ˜¾ç¤ºç‰ˆæœ¬å·å°±è¡Œï¼Œè¿™é‡Œæ¨ègitBook==3.2.3gitbook -VCLI version: 2.3.2GitBook version: 3.2.3åˆå§‹åŒ–ç”µå­ä¹¦åˆå§‹åŒ–ç”µå­ä¹¦1gitbook initè¿™æ—¶å€™ä¼šç”Ÿæˆä¸‹é¢ä¸¤ä¸ªæ–‡ä»¶README.mdå’ŒSUMMARY.mdREADME.md ä¹¦ç±çš„ä»‹ç»å†™åœ¨è¿™ä¸ªæ–‡ä»¶é‡Œï¼›SUMMARY.mdä¹¦ç±çš„ç›®å½•ç»“æ„åœ¨è¿™é‡Œé…ç½®å®‰è£…æ’ä»¶æœ‰é…ç½®book.jsonæ—¶ï¼Œæ‰§è¡Œgitbook installä¼šå®‰è£…æ’ä»¶åˆ°node_modulesç›®å½•ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨gitbookï¼Œæ‰“å¼€http://localhost:4000å°±å¯ä»¥è®¿é—®äº†ï¼Œ1gitbook serveé‡è¦æ–‡ä»¶book.jsonï¼Œæ²¡æœ‰çš„è¯ï¼Œè‡ªå·±æ–°å»ºä¸€ä¸ªå°±å¥½ç”¨äºé…ç½®æ’ä»¶å’Œä¹¦ç±çš„åŸºæœ¬ä¿¡æ¯123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116{    &quot;title&quot;: &quot;ä¹¦ç±ç›®å½•&quot;,    &quot;author&quot;: &quot;narutohyc&quot;,    &quot;description&quot;: &quot;ä¹¦ç±ç›®å½•ï¼Œè®°å½•ä¸€äº›å·¥ä½œå’Œå­¦ä¹ ä¸­çš„ç¬”è®°&quot;,    &quot;language&quot;: &quot;zh-hans&quot;,    &quot;structure&quot;: {        &quot;readme&quot;: &quot;README.md&quot;    },    &quot;links&quot;: {        &quot;sidebar&quot;: {            &quot;æˆ‘ã®å°çª~&quot;: &quot;https://github.com/narutohyc&quot;        }    },    &quot;plugins&quot;: [        &quot;-sharing&quot;,        &quot;splitter&quot;,        &quot;expandable-chapters-small&quot;,        &quot;anchors&quot;,        &quot;github&quot;,        &quot;github-buttons&quot;,        &quot;donate&quot;,        &quot;sharing-plus&quot;,        &quot;anchor-navigation-ex&quot;,        &quot;mathjax&quot;,        &quot;mermaid-gb3&quot;,        &quot;tbfed-pagefooter&quot;,        &quot;code&quot;,        &quot;search-plus&quot;, &quot;-lunr&quot;, &quot;-search&quot;,        &quot;lightbox&quot;,        &quot;theme-comscore&quot;,        &quot;valine&quot;,        &quot;pageview-count&quot;,        &quot;favicon-absolute&quot;,        &quot;copyright-v&quot;    ],    &quot;pluginsConfig&quot;: {        &quot;theme-default&quot;: {            &quot;showLevel&quot;: true        },        &quot;github&quot;: {            &quot;url&quot;: &quot;https://github.com/narutohyc&quot;        },        &quot;tbfed-pagefooter&quot;: {            &quot;copyright&quot;: &quot;Copyright Â© narutohyc.com 2021&quot;,            &quot;modify_label&quot;: &quot;è¯¥æ–‡ä»¶ä¿®è®¢æ—¶é—´ï¼š&quot;,            &quot;modify_format&quot;: &quot;YYYY-MM-DD HH:mm:ss&quot;        },        &quot;github-buttons&quot;: {            &quot;buttons&quot;: [{                &quot;user&quot;: &quot;narutohyc&quot;,                &quot;repo&quot;: &quot;bk_index&quot;,                &quot;type&quot;: &quot;star&quot;,                &quot;size&quot;: &quot;small&quot;,                &quot;count&quot;: true                }            ]        },        &quot;donate&quot;: {            &quot;wechat&quot;: &quot;https://s2.loli.net/2022/03/23/WDiTVSamQBJdEA4.png&quot;,            &quot;alipay&quot;: &quot;https://s2.loli.net/2022/03/23/dEYjkaSGXwe7rnu.png&quot;,            &quot;title&quot;: &quot;&quot;,            &quot;button&quot;: &quot;æ¬¢è¿æ‰“èµ&quot;,            &quot;alipayText&quot;: &quot;alipayæ‰“èµ&quot;,            &quot;wechatText&quot;: &quot;wechatæ‰“èµ&quot;        },        &quot;sharing&quot;: {            &quot;douban&quot;: true,            &quot;facebook&quot;: true,            &quot;google&quot;: true,            &quot;hatenaBookmark&quot;: false,            &quot;instapaper&quot;: false,            &quot;line&quot;: false,            &quot;linkedin&quot;: false,            &quot;messenger&quot;: false,            &quot;pocket&quot;: false,            &quot;qq&quot;: true,            &quot;qzone&quot;: true,            &quot;stumbleupon&quot;: false,            &quot;twitter&quot;: true,            &quot;viber&quot;: false,            &quot;vk&quot;: false,            &quot;weibo&quot;: true,            &quot;whatsapp&quot;: false,            &quot;all&quot;: [                &quot;google&quot;, &quot;facebook&quot;, &quot;weibo&quot;, &quot;twitter&quot;,                &quot;qq&quot;, &quot;qzone&quot;, &quot;linkedin&quot;, &quot;pocket&quot;            ]        },        &quot;anchor-navigation-ex&quot;: {            &quot;showLevel&quot;: false        },        &quot;valine&quot;: {            &quot;appId&quot;: &quot;leancloudç”³è¯·çš„appId&quot;,            &quot;appKey&quot;: &quot;leancloudç”³è¯·çš„appKey&quot;,            &quot;avatar&quot;: &quot;wavatar&quot;,            &quot;placeholder&quot;: &quot;æ¬¢è¿ç•™ä¸‹è¯„è®ºäº¤æµ~&quot;,            &quot;pageSize&quot;: 15        },        &quot;favicon-absolute&quot;:{            &quot;favicon&quot;: &quot;./chapters/res/other/favicon.ico&quot;,            &quot;appleTouchIconPrecomposed152&quot;: &quot;./chapters/res/other/favicon.ico&quot;        },        &quot;fontSettings&quot;: {            &quot;family&quot;: &quot;msyh&quot;,            &quot;size&quot;: 2        },        &quot;copyright-v&quot;: {            &quot;site&quot;: &quot;https://hycbook.github.io/bk_python/&quot;,            &quot;author&quot;: &quot;narutohyc&quot;,            &quot;website&quot;: &quot;pythonå…ƒçŸ¥è¯†é©¿ç«™&quot;,            &quot;image&quot;: &quot;https://s2.loli.net/2022/03/24/pbMd1BCgUNzi7mG.png&quot;,            &quot;copyProtect&quot;: true,        &quot;enableFooter&quot;: false        }    }}Gitbook é»˜è®¤å¸¦æœ‰ 5 ä¸ªæ’ä»¶ï¼šhighlightsearchsharingfont-settingslivereloadé‡è¦æ’ä»¶è¯´æ˜:github: å³ä¸Šè§’æ·»åŠ githubå›¾æ ‡donate: æ–‡ç« æ‰“èµæ’ä»¶ï¼Œåœ¨æ–‡æœ«ç‚¹å‡»å±•ç¤ºä»˜æ¬¾ç sharing-plus: æ¯”é»˜è®¤çš„åˆ†äº«æ’ä»¶ï¼Œå¤šäº†æ›´å¤šçš„åˆ†äº«æŒ‰é’®mathjax: LaTeXå…¬å¼æ˜¾ç¤ºæ’ä»¶ï¼Œå¯ä»¥æ”¯æŒç»å¤§å¤šæ•°çš„æ•°æ®å…¬å¼ï¼Œä¸ªåˆ«çš„å…¬å¼è¿˜æ˜¯ä¼šæœ‰é—®é¢˜mermaid-gb3: Mermaidæ¸²æŸ“æ’ä»¶ï¼Œå¯ä»¥æ”¯æŒç”»å›¾code: ä¸ºä»£ç å—æ·»åŠ è¡Œå·å’Œå¤åˆ¶æŒ‰é’®ï¼Œå¤åˆ¶æŒ‰é’®å¯å…³é—­ï¼Œå•è¡Œä»£ç æ— è¡Œå·search-plus: æ–‡ç« å†…å®¹æœç´¢æ’ä»¶ï¼Œæ”¯æŒä¸­æ–‡ï¼Œä½¿ç”¨è¿™ä¸ªæ’ä»¶æ—¶è¦ç§»é™¤é»˜è®¤çš„lunrå’Œsearchæ’ä»¶lightbox: å½“å‰é¡µæ˜¾ç¤ºå¤§å›¾ï¼Œç‚¹å‡»å›¾ç‰‡ä¼šæ”¾å¤§æ˜¾ç¤ºï¼Œä¸æ”¯æŒåˆ‡æ¢å›¾ç‰‡theme-comscore: ä¸»é¢˜æ’ä»¶ï¼Œé»˜è®¤ä¸»é¢˜æ˜¯é»‘ç™½çš„ï¼Œcomscore ä¸»é¢˜æ˜¯å½©è‰²çš„ï¼Œæ ‡é¢˜å’Œæ­£æ–‡é¢œè‰²æœ‰æ‰€åŒºåˆ†valine: è¯ç”Ÿäº2017å¹´8æœˆ7æ—¥ï¼Œæ˜¯ä¸€æ¬¾åŸºäºLeanCloudçš„å¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„æ— åç«¯è¯„è®ºç³»ç»Ÿpageview-count: é¡µé¢æµè§ˆé‡ç»Ÿè®¡ï¼Œä½†å¥½åƒç”¨ä¸äº†ï¼Œè‡ªå·±ç»“åˆcutercounterè¿›è¡Œäº†æ”¹é€ favicon-absolute: ç½‘é¡µiconå›¾æ ‡å®šä¹‰copyright-v: ç‰ˆæƒæ’ä»¶ï¼Œå¤åˆ¶æ–‡ç« å†…å®¹æ—¶ä¼šé™„å¸¦ä¸Šå®šä¹‰å¥½çš„ç‰ˆæƒä¿¡æ¯ï¼Œå’ŒçŸ¥ä¹å¤åˆ¶çš„æ•ˆæœä¸€æ ·.bookignoreï¼Œå­˜æ”¾ä¸æƒ³è¢«æ‰“åŒ…çš„èµ„æº123456.gitignore.bookignorebook_default.json_book/chapters/*.md*.bat*.pdf_bookä½¿ç”¨gitbook buildå‘½ä»¤ï¼Œä¼šåœ¨é¡¹ç›®çš„ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ª _book ç›®å½•ï¼Œé‡Œé¢çš„å†…å®¹ä¸ºé™æ€ç«™ç‚¹çš„èµ„æºæ–‡ä»¶å‘å¸ƒå‡ºæ¥çš„å°±æ˜¯è¿™ä¸ªç›®å½•ä¸‹çš„èµ„æºgitbook buildåªè´Ÿè´£ç”Ÿæˆé™æ€æ–‡ä»¶ï¼Œgitbook serveä¸ä»…ç”Ÿæˆæ–‡ä»¶ï¼Œè¿˜ä¼šå¯åŠ¨ç½‘ç«™æœåŠ¡ä½¿ç”¨é€‰é¡¹ --log=debug å’Œ --debug æ¥è·å–æ›´å¥½çš„é”™è¯¯æ¶ˆæ¯1gitbook build ./ --log=debug --debugSUMMARY.mdï¼Œç”¨äºå­˜æ”¾æ•°æ®ç›®å½•12345678# Summary* [Introduction](README.md)* [alicloud_deployment](./chapters/1.alicloud_deployment.md)* [reinstall_the_system](./chapters/2.reinstall_the_system.md)* [Linuxå¸¸ç”¨å‘½ä»¤](./chapters/3.Linuxå¸¸ç”¨å‘½ä»¤.md)* [githubåä½œ](./chapters/4.githubåä½œ.md)* [gitbookåšå®¢æ­å»º](./chapters/5.gitbookåšå®¢æ­å»º.md)node_modulesç»ˆç«¯æ‰§è¡Œgitbook installå¯ä»¥å®‰è£…book.jsoné…ç½®çš„æ’ä»¶ï¼Œä¸‹è½½çš„æ’ä»¶ä¼šåœ¨node_modulesæ–‡ä»¶å¤¹markdownè¯­æ³•åŸºæœ¬æ’°å†™å’Œæ ¼å¼è¯­æ³•Markdownæ˜¯ä¸€ç§è½»é‡çº§æ ‡è®°è¯­è¨€ï¼Œåˆ›å§‹äººæ˜¯çº¦ç¿°Â·æ ¼é²ä¼¯(John Gruber)å®ƒå…è®¸äººä»¬ä½¿ç”¨æ˜“è¯»æ˜“å†™çš„çº¯æ–‡æœ¬æ ¼å¼ç¼–å†™æ–‡æ¡£ï¼Œç„¶åè½¬æ¢æˆæœ‰æ•ˆçš„ HTML æ–‡æ¡£æ¨èé…åˆTyporaç¼–è¾‘å™¨ä¸€èµ·é£Ÿç”¨æ”¹é€ è®¿å®¢æ•°valineåšå®¢Valineè¯„è®ºæ ·å¼ç¾åŒ–ç¾åŒ–éƒ¨ç½²æ‰“é€ å®Œç¾å†™ä½œç³»ç»Ÿï¼šGitbook+Github Pages+Github ActionsTravis CIç®€ä»‹ä»€ä¹ˆæ˜¯æŒç»­é›†æˆ(CI)/æŒç»­äº¤ä»˜(CD)ç®¡é“ï¼ŸGitHub ActionsGitHub Actions æ˜¯ä»€ä¹ˆï¼Ÿå‰é¢éƒ¨åˆ†çš„å†…å®¹ä¸»è¦è®²è§£äº†gitbookçš„æ„å»ºå’Œç¾åŒ–ä¼˜åŒ–ç­‰å†…å®¹è¿™éƒ¨åˆ†è®²ä¸€ä¸‹å¦‚ä½•å€ŸåŠ©github pageså’Œgitee pageséƒ¨ç½²è‡ªå·±çš„åšå®¢ç½‘ç«™ï¼Œæ­£æ–‡å¼€å§‹å‰ï¼Œå…ˆè®²è§£ä¸‹Github Actionsçš„åŸºç¡€æ¦‚å¿µGithub ActionsCI/CD:  æŒç»­é›†æˆ(CI)/æŒç»­äº¤ä»˜(CD)ç®¡é“æ˜¯ä¸€ç³»åˆ—æ­¥éª¤ï¼Œå…¶ä¸­åŒ…æ‹¬ä»CI/CDæµç¨‹å¼€å§‹çš„æ‰€æœ‰é˜¶æ®µï¼Œå¹¶è´Ÿè´£åˆ›å»ºè‡ªåŠ¨åŒ–å’Œæ— ç¼çš„è½¯ä»¶äº¤ä»˜ã€‚è€Œä½¿ç”¨CI/CDç®¡é“ï¼Œè½¯ä»¶å‘å¸ƒå·¥ä»¶å¯ä»¥ä»ä»£ç æ£€å…¥é˜¶æ®µåˆ°æµ‹è¯•ã€æ„å»ºã€éƒ¨ç½²å’Œç”Ÿäº§é˜¶æ®µä¸€ç›´åœ¨ç®¡é“ä¸­å‰è¿›è¿™ä¸€æ¦‚å¿µä¹‹æ‰€ä»¥å¼ºå¤§ï¼Œæ˜¯å› ä¸ºä¸€æ—¦æŒ‡å®šäº†ç®¡é“ï¼Œå°±å¯ä»¥å°†å…¶éƒ¨åˆ†æˆ–å…¨éƒ¨å®ç°è‡ªåŠ¨åŒ–ï¼Œä»è€ŒåŠ å¿«äº†æµç¨‹ï¼Œå¹¶å‡å°‘äº†é”™è¯¯ã€‚æ¢å¥è¯è¯´ï¼ŒCI/CDç®¡é“ä½¿ç»„ç»‡æ¯å¤©æ›´è½»æ¾åœ°è‡ªåŠ¨å¤šæ¬¡äº¤ä»˜è½¯ä»¶Travis CI: æä¾›çš„æ˜¯æŒç»­é›†æˆæœåŠ¡ï¼ˆContinuous Integrationï¼Œç®€ç§° CIï¼‰ã€‚å®ƒç»‘å®š Github ä¸Šé¢çš„é¡¹ç›®ï¼Œåªè¦æœ‰æ–°çš„ä»£ç ï¼Œå°±ä¼šè‡ªåŠ¨æŠ“å–ã€‚ç„¶åï¼Œæä¾›ä¸€ä¸ªè¿è¡Œç¯å¢ƒï¼Œæ‰§è¡Œæµ‹è¯•ï¼Œå®Œæˆæ„å»ºï¼Œè¿˜èƒ½éƒ¨ç½²åˆ°æœåŠ¡å™¨Github Actions: GitHub Actionsæ˜¯ä½ åœ¨GitHubåº“ä¸­åˆ›å»ºè‡ªå®šä¹‰çš„å·¥ä½œæµï¼Œå·¥ä½œæµæŒ‡çš„å°±æ˜¯è‡ªåŠ¨åŒ–çš„æµç¨‹ï¼Œæ¯”å¦‚æ„å»ºã€æµ‹è¯•ã€æ‰“åŒ…ã€å‘å¸ƒã€éƒ¨ç½²ç­‰ç­‰ï¼Œå¯ä»¥è®¾ç½®è§¦å‘æ¡ä»¶æˆ–å®šæ—¶æ‰§è¡Œï¼Œç”±githubæä¾›æœåŠ¡å™¨ç¯å¢ƒæŒç»­é›†æˆ(CI)/æŒç»­äº¤ä»˜(CD)æ˜¯ä¸€ç§è‡ªåŠ¨åŒ–ç®¡ç†æµç¨‹ï¼Œè€ŒTravis CIå’ŒGithub Actionséƒ½æ˜¯å…·ä½“çš„å®ç°ï¼Œåè€…æ˜¯githubå®˜æ–¹æä¾›çš„githun actionsçš„ä½¿ç”¨æ¡ˆä¾‹å¯ä»¥è‡ªå·±ç™¾åº¦æˆ–å‚è€ƒgithubåä½œgithub pagesGitHub Pages Deploy Actionè‡ªåŠ¨å‘å¸ƒåˆ°github pagesåˆ†æ”¯(å¯ä»¥è‡ªå·±è®¾ç½®åˆ†æ”¯)é…ç½®tokengithubé¡¹ç›®ä¸‹æ–°å»ºï¼šname=TOKENï¼Œvalue=githubç”Ÿæˆçš„tokenåŸºæœ¬ç”¨æ³•123456- name: Deploy #æ­¥éª¤4ï¼šæŠŠç¼–è¯‘å¥½çš„é™æ€ç›®å½•ä¸Šä¼ åˆ°gh-pagesåˆ†æ”¯ä¸Š  uses: JamesIves/github-pages-deploy-action@3.1.5 #è¿™é‡Œè°ƒç”¨ç¬¬ä¸‰æ–¹ä¾èµ–ï¼Œç”¨äºä¸Šä¼ ä»£ç åˆ°æŒ‡å®šåˆ†æ”¯ä¸Š  with:    ACCESS_TOKEN: ${{ secrets.TOKEN }}    BRANCH: gh-pages #github pages é»˜è®¤çš„åˆ†æ”¯    FOLDER: _book #ä¸Šä¼ æ–‡ä»¶çš„ç›®å½•ï¼Œæˆ‘è¿™ä¸ªç›®å½•åœ¨æ ¹ç›®å½•ä¸‹ï¼Œå¦‚æœæ˜¯å­ç›®å½•å¯ä»¥è¿™ä¹ˆå†™  docs/.vuepress/distgitee pagesGitee å¦‚ä½•è‡ªåŠ¨éƒ¨ç½² Pagesï¼Ÿè¿˜æ˜¯ç”¨ GitHub Actions!ä½¿ç”¨ GitHub Actions è§£å†³äº† GitHub ä»£ç è‡ªåŠ¨åŒæ­¥ Gitee çš„é—®é¢˜ï¼Œä½†æˆ‘ä»¬çš„åšå®¢ä»“åº“ä»£ç åŒæ­¥åˆ° Gitee åï¼Œå¹¶ä¸èƒ½åƒ GitHub ä¸€æ ·è‡ªåŠ¨éƒ¨ç½² Pagesï¼Œå¦‚æœä¸ä½¿ç”¨ä»˜è´¹çš„ Gitee Pages Pro æœåŠ¡ï¼Œé‚£æˆ‘ä»¬è¯¥æ€ä¹ˆå®ç° Gitee è‡ªåŠ¨éƒ¨ç½² Pages å‘¢åŸºæœ¬ç”¨æ³•æ–°å»ºä¸€ä¸ªname=GITEE_PASSWORD, value=giteeç™»é™†å¯†ç çš„secrets1234567891011- name: Build Gitee Pages  uses: yanglbme/gitee-pages-action@main  with:    # æ³¨æ„æ›¿æ¢ä¸ºä½ çš„ Gitee ç”¨æˆ·å    gitee-username: narutohyc    # æ³¨æ„åœ¨ Settings-&gt;Secrets é…ç½® GITEE_PASSWORD    gitee-password: ${{ secrets.GITEE_PASSWORD }}    # æ³¨æ„æ›¿æ¢ä¸ºä½ çš„ Gitee ä»“åº“ï¼Œä»“åº“åä¸¥æ ¼åŒºåˆ†å¤§å°å†™ï¼Œè¯·å‡†ç¡®å¡«å†™ï¼Œå¦åˆ™ä¼šå‡ºé”™    gitee-repo: hycBook/bk_index    # è¦éƒ¨ç½²çš„åˆ†æ”¯ï¼Œé»˜è®¤æ˜¯ masterï¼Œè‹¥æ˜¯å…¶ä»–åˆ†æ”¯ï¼Œåˆ™éœ€è¦æŒ‡å®šï¼ˆæŒ‡å®šçš„åˆ†æ”¯å¿…é¡»å­˜åœ¨ï¼‰    branch: gh-pages</content>
	</entry>
	<entry>
		<title>é‡è£…ç³»ç»Ÿ</title>
		<url>/article/41279.html</url>
		<content>é‡è£…ç³»ç»Ÿå®‰è£…ç³»ç»Ÿä¸åŒºåˆ†windowså’Œlinuxï¼Œæ–¹å¼éƒ½æ˜¯ä¸€æ ·çš„uç›˜å¯åŠ¨ç›˜åˆ¶ä½œå®˜ç½‘å·¥å…·è‡ªå·±åšé•œåƒç™¾åº¦æœç´¢å¾®è½¯å®˜ç½‘å·¥å…·ä¸‹è½½åï¼Œä½¿ç”¨ç®¡ç†å‘˜èº«ä»½è¿è¡ŒæŒ‰æ­¥éª¤æ“ä½œï¼Œå…¶ä¸­ä¸‹è½½é•œåƒä¼šæ¯”è¾ƒè€—æ—¶(å¥½åƒåªèƒ½ä¸‹è½½win10)åˆ¶ä½œå¯åŠ¨ç›˜å®Œæˆåï¼Œå°±å¯ä»¥å¼€å§‹å®‰è£…ç³»ç»Ÿäº†ç™¾åº¦æœç´¢itellyouï¼Œä¸‹è½½ç³»ç»Ÿé•œåƒä¸‹è½½uç›˜å¯åŠ¨ç›˜åˆ¶ä½œå·¥å…·UltraISOï¼Œå®‰è£…åæ‰§è¡Œåˆ¶ä½œå¯åŠ¨ç›˜å®Œæˆåï¼Œå°±å¯ä»¥å¼€å§‹å®‰è£…ç³»ç»Ÿäº†ç£ç›˜æ ¼å¼åŒ–ä»¥ UEFI å¯åŠ¨çš„ Windows ç£ç›˜å¿…é¡»æ˜¯ GPT æ ¼å¼ï¼Œè¿™é‡Œä»‹ç»å¦‚ä½•åœ¨å®‰è£… Windows æœŸé—´å°†ç£ç›˜ä» MBR è½¬æ¢æˆ GPTã€‚åœ¨å®‰è£…ç•Œé¢æŒ‰Shift+F10æˆ–Fn+Shift+F10è¿›å…¥cmdç•Œé¢è¾“å…¥diskpartï¼Œè¿›å…¥ç®¡ç†ç•Œé¢è¾“å…¥list diskæŸ¥çœ‹æ‰€æœ‰çš„ç£ç›˜æƒ…å†µ12345ç£ç›˜ ###  çŠ¶æ€           å¤§å°     å¯ç”¨     Dyn  Gpt--------  -------------  -------  -------  ---  ---ç£ç›˜ 0    è”æœº              119 GB   118 GB        *ç£ç›˜ 1    è”æœº              465 GB  1024 KBç£ç›˜ 2    è”æœº               28 GB      0 B        *é€‰æ‹©ç£ç›˜select disk 1æ³¨æ„è¿™é‡Œé€‰æ‹©çš„æ˜¯ç£ç›˜ï¼Œè€Œä¸æ˜¯åˆ†åŒºï¼ä¸æ˜¯é€šå¸¸æ‰€è¯´çš„ C ç›˜/D ç›˜ï¼Œè€Œæ˜¯ä¸€å— SSDï¼Œæˆ–ä¸€å—æœºæ¢°ç¡¬ç›˜ã€‚æ‰§è¡Œcleanæˆ–clean allæ¸…é™¤æ‰€æœ‰æ•°æ®æ“ä½œä¼šæ¸…é™¤é€‰ä¸­ç£ç›˜ä¸­çš„æ‰€æœ‰æ•°æ®ï¼Œæ˜¯æ‰€æœ‰æ•°æ®ï¼Œæ¯«æ— ä¿ç•™ï¼æ¸…é™¤ç»“æŸï¼Œç„¶åæ•²å…¥ convert gpt å‘½ä»¤å®Œæˆè½¬æ¢æ“ä½œç»“æŸä¹‹åè¾“å…¥exitåˆ‡æ¢åˆ° Windows å®‰è£…ç¨‹åºç»§ç»­å®‰è£…å³å¯æ¿€æ´»å·¥å…·(ç‚¹å‡»ä¸‹è½½)ä¸»æ¿å¯åŠ¨çƒ­é”®è¡¨ä¸­æ²¡æœ‰çš„æœºå‹å°è¯•ï¼šESCã€ä¸‹F8ã€9ã€F10ã€11ã€F2å°å¼æœºå“ç‰Œå¯åŠ¨æŒ‰é”®ç¬”è®°æœ¬å“ç‰Œå¯åŠ¨æŒ‰é”®ä¸»æ¿å“ç‰Œå¯åŠ¨æŒ‰é”®è”æƒ³F12è”æƒ³F12åç¡•F8æƒ æ™®F12æˆ´å°”F12å¾®æ˜ŸF11åç¡•F8åç¡•ESCæˆ´å°”ESCæƒ æ™®F9ç¥èˆŸF12è”æƒ³F12æœ‰äº›è”æƒ³ç”µè„‘æœ‰NOVOé”®æ˜¯ä¸€é”®æ¢å¤æŒ‰é”®ã€‚åœ¨ç”µè„‘çš„ä¾§é¢æœ‰ä¸ªå¾ˆå°çš„æŒ‰é’®ï¼Œæ—è¾¹æœ‰æ ‡å·â€”â€”â€œä¸€ä¸ªé€†æ—¶é’ˆç®­å¤´â€ï¼Œä½œç”¨æ˜¯ï¼šå…³æœºçŠ¶æ€ä¸‹ï¼ŒæŒ‰æ­¤æŒ‰é”®å¯å¯åŠ¨è”æƒ³ä¸€é”®æ¢å¤ç³»ç»Ÿæˆ–,BIOSï¼Œè®¾ç½®ç¨‹åºï¼Œæˆ–è€…è¿›å…¥å¯åŠ¨èœå•åˆ†åŒºåˆå¹¶å·¥å…·ä½¿ç”¨ç£ç›˜ç®¡ç†å·¥å…·åˆå¹¶åˆ†åŒºæ­¥éª¤1. æŒ‰Win+Rè¾“å…¥diskmgmt.mscå¹¶æŒ‰Enteré”®æ‰“å¼€ç£ç›˜ç®¡ç†å·¥å…·ã€‚æ­¥éª¤2. åœ¨ä¸»ç•Œé¢ä¸­å³é”®å•å‡»ä¸ç›®æ ‡åˆ†åŒºï¼ˆCåˆ†åŒºï¼‰ç›¸é‚»å³ä¾§çš„åˆ†åŒºï¼Œç„¶åé€‰æ‹©â€œåˆ é™¤å·â€æ­¥éª¤3. å³é”®å•å‡»ä¸åˆšåˆšåˆ é™¤äº§ç”Ÿçš„æœªåˆ†é…ç©ºé—´ç›¸é‚»å·¦ä¾§çš„ç›®æ ‡åˆ†åŒºï¼ˆCåˆ†åŒºï¼‰ï¼Œç„¶åé€‰æ‹©â€œæ‰©å±•å·â€æ­¥éª¤4. åœ¨å¼¹å‡ºé¡µé¢ä¸­è®¾ç½®æ‚¨æƒ³è¦æ‰©å±•çš„ç©ºé—´é‡ï¼Œç„¶åä¾æ¬¡å•å‡»â€œä¸‹ä¸€æ­¥â€&gt;â€œå®Œæˆâ€å³å¯å®ŒæˆWindows11åˆå¹¶åˆ†åŒºä»»åŠ¡ï¼Œè½»æ¾å°†æœªåˆ†é…ç£ç›˜åˆå¹¶åˆ°Cç›˜ä½¿ç”¨å‚²æ¢…åˆ†åŒºåŠ©æ‰‹åˆå¹¶åˆ†åŒº(æ¨è)ç³»ç»Ÿå†…ç½®çš„ç£ç›˜ç®¡ç†å·¥å…·æƒ³è¦å®ç°Win11åˆå¹¶åˆ†åŒºéœ€æ±‚ï¼Œéœ€è¦ç”¨åˆ°æ‰©å±•å·åŠŸèƒ½ã€‚è€Œæ‰©å±•å·åŠŸèƒ½å­˜åœ¨é™åˆ¶æ¡ä»¶ï¼Œåˆéœ€è¦ç›®æ ‡åˆ†åŒºå³ä¾§ç›¸é‚»å¤„æœ‰æœªåˆ†é…ç©ºé—´ï¼Œå¦åˆ™æ‰©å±•å·é€‰é¡¹å˜ç°ï¼Œæ— æ³•ä½¿ç”¨ã€‚è€Œå¯¹äºæˆ‘ä»¬æ—¥å¸¸å·¥ä½œç”Ÿæ´»ä¸­æ­£å¸¸ä½¿ç”¨çš„ç¡¬ç›˜è€Œè¨€ï¼Œé€šå¸¸æ¥è¯´æ˜¯ä¸ä¼šå‡ºç°æœªåˆ†é…ç©ºé—´çš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åˆ é™¤å·²æœ‰åˆ†åŒºæ¥åˆ›é€ æœªåˆ†é…ç£ç›˜ï¼Œè¿™ä¼šå¯¼è‡´åˆ†åŒºä¸Šçš„æ•°æ®ä¸¢å¤±ï¼Œå¾ˆä¸å‹å¥½ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæ˜¯å¦æœ‰ä¸€ç§åˆ†åŒºåˆå¹¶è½¯ä»¶èƒ½å¤Ÿå®ç°æ— æŸåˆå¹¶ç¡¬ç›˜åˆ†åŒºå‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚å‚²æ¢…åˆ†åŒºåŠ©æ‰‹å³ä¸ºç¬¦åˆä»¥ä¸Šè¦æ±‚çš„ä¸“ä¸šç£ç›˜åˆ†åŒºç®¡ç†å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©ç”¨æˆ·è½»æ¾åˆå¹¶åŒä¸€ç¡¬ç›˜ä¸Šå¤„äºä»»æ„ä½ç½®çš„æœªåˆ†é…ç©ºé—´ï¼Œå³ä½¿æ²¡æœ‰æœªåˆ†é…ç©ºé—´ä¹Ÿå¯ä»¥è½»æ¾å°†ä¸¤ä¸ªç›¸é‚»çš„æ­£åœ¨ä½¿ç”¨çš„æ­£å¸¸åˆ†åŒºåˆå¹¶ä¸ºä¸€ä¸ªåˆ†åŒºï¼Œè€Œä¸éœ€è¦åˆ é™¤åˆ†åŒºï¼Œå¹¶ä¸”å…¼å®¹æ€§å¼ºï¼Œåœ¨å¤§å¤šæ•°Windows PCå’ŒWindows Serveræ“ä½œç³»ç»Ÿä¸­çš†å¯ç¨³å®šè¿è¡ŒDiskGeniusæ˜¯ä¸€æ¬¾ä¸“ä¸šçº§çš„ æ•°æ®æ¢å¤è½¯ä»¶ ,ç®—æ³•ç²¾æ¹›ã€åŠŸèƒ½å¼ºå¤§,ç”¨æˆ·ç¾¤ä½“å¹¿æ³›;æ”¯æŒå„ç§æƒ…å†µä¸‹çš„æ–‡ä»¶æ¢å¤ã€åˆ†åŒºæ¢å¤,æ¢å¤æ•ˆæœå¥½;æ–‡ä»¶é¢„è§ˆã€æ‰‡åŒºç¼–è¾‘ã€åŠ å¯†åˆ†åŒºæ¢å¤ã€Ext4åˆ†åŒºæ¢å¤ã€RAIDæ¢å¤ç­‰é«˜çº§åŠŸèƒ½å…¶ä»–é«˜çº§ç”¨æ³•ç¦ç”¨æ›´æ–°è¦å®Œå…¨ç¦æ­¢ Win11 æ›´æ–°ï¼Œæ‚¨å¿…é¡»ä½¿ç”¨æœåŠ¡çª—å£ï¼Œæ“ä½œæ–¹æ³•å¦‚ä¸‹ï¼šæŒ‰Win + Ræ‰“å¼€ RUN å¯¹è¯æ¡†ï¼Œé”®å…¥services.mscï¼Œç„¶åæŒ‰Enterç°åœ¨ï¼Œå‘ä¸‹æ»šåŠ¨å¹¶åŒå‡»Windows Updateå¦‚æœå®ƒæ­£åœ¨è¿è¡Œï¼Œè¯·å•å‡»åœæ­¢ç„¶åå•å‡»å¯åŠ¨ç±»å‹æ—è¾¹çš„ä¸‹æ‹‰èœå•é€‰æ‹©ç¦ç”¨å•å‡»ç¡®å®šè½¯è¿æ¥mklinkå‘½ä»¤(éœ€è¦ç®¡ç†å‘˜)1æ ¼å¼ï¼šMKLINK [[/D]|[/H]|[/J]] åˆ›å»ºçš„é“¾æ¥å æºç›®æ ‡åœ°å€/d ç»™ç›®å½•åˆ›å»ºç¬¦å·é“¾æ¥ï¼Œç®€ç§°ç¬¦å·é“¾æ¥ã€è½¯é“¾æ¥/h åˆ›å»ºç¡¬é“¾æ¥ï¼Œç®€ç§°ç¡¬é“¾æ¥/j ç»™ç›®å½•åˆ›å»ºè”æ¥ç‚¹ï¼Œç®€ç§°è½¯é“¾æ¥ä¾‹å­ï¼šåˆ›å»ºç›®å½•è½¯è¿æ¥åˆ°æŒ‡å®šç›®å½•1mklink /j &quot;D:\å£çº¸&quot; &quot;S:\å®é™…å£çº¸æ–‡ä»¶å¤¹&quot;ç±»å‹èƒ½å¦é“¾æ¥åˆ°æ–‡ä»¶èƒ½å¦é“¾æ¥åˆ°ç›®å½•èƒ½å¦è·¨ç£ç›˜èƒ½å¦æŒ‡å‘ä¸å­˜åœ¨çš„ç›®æ ‡èƒ½å¦æŒ‡å‘ç›¸å¯¹ç›®å½•å¦‚ä½•åˆ é™¤å¿«æ·æ–¹å¼èƒ½èƒ½èƒ½èƒ½å¦del fileç¡¬é“¾æ¥èƒ½å¦å¦å¦å¦del fileè½¯é“¾æ¥å¦èƒ½èƒ½èƒ½å¦rd folderç¬¦å·é“¾æ¥èƒ½èƒ½èƒ½èƒ½èƒ½rd folder or del fileå›ºå®šipbatè„šæœ¬(æ¨è)å›¾å½¢åŒ–ç•Œé¢è‡ªåŠ¨è·å–ip12345678910111213@echo //-=-=-=-=-=-=-=-=-=-=-=-=-=-=@echo //  ã€è‡ªåŠ¨è·å–ã€‘@echo //  è®¾ç½®IPï¼Œå­ç½‘æ©ç ï¼Œç½‘å…³@echo //-=-=-=-=-=-=-=-=-=-=-=-=-=-=%1 mshta vbscript:CreateObject(&quot;Shell.Application&quot;).ShellExecute(&quot;cmd.exe&quot;,&quot;/c %~s0 ::&quot;,&quot;&quot;,&quot;runas&quot;,1)(window.close)&amp;&amp;exitcd /d &quot;%~dp0&quot;netsh interface ip set address name=&quot;WLAN&quot; source=dhcp @echo //-=-=-=-=-=-=-=-=-=-=-=-=-=-=@echo //  è®¾ç½®DNS@echo //-=-=-=-=-=-=-=-=-=-=-=-=-=-=netsh interface ip set dns name = &quot;WLAN&quot; static addr = none@echo //  è‡ªåŠ¨è·å–IPè®¾ç½®å®Œæˆï¼@pauseå›ºå®šæŒ‡å®šip1234567891011121314@echo //-=-=-=-=-=-=-=-=-=-=-=-=-=-=@echo //  ã€å›ºå®šè®¾ç½®ã€‘@echo //  è®¾ç½®IPï¼Œå­ç½‘æ©ç ï¼Œç½‘å…³@echo //-=-=-=-=-=-=-=-=-=-=-=-=-=-=%1 mshta vbscript:CreateObject(&quot;Shell.Application&quot;).ShellExecute(&quot;cmd.exe&quot;,&quot;/c %~s0 ::&quot;,&quot;&quot;,&quot;runas&quot;,1)(window.close)&amp;&amp;exitcd /d &quot;%~dp0&quot;netsh interface ip set address name=&quot;WLAN&quot; source=static addr=192.168.0.16 mask=255.255.255.0 gateway=192.168.0.1 @echo //-=-=-=-=-=-=-=-=-=-=-=-=-=-=@echo //  è®¾ç½®DNS@echo //-=-=-=-=-=-=-=-=-=-=-=-=-=-=netsh interface ip set dns &quot;WLAN&quot; static 192.168.0.1 primarynetsh interface ip add dns &quot;WLAN&quot; 192.168.0.1 @echo //  å›ºå®šIPè®¾ç½®å®Œæˆï¼@pauseè¿™é‡Œçš„addræ˜¯ä½ è¦å›ºå®šçš„ipï¼Œmaskæ˜¯æ©ç ï¼Œgatewayæ˜¯ç½‘å…³ï¼Œè¿˜æœ‰DNSï¼Œè¿™ä¸‰ä¸ªå‚è€ƒå›¾å½¢åŒ–ç•Œé¢æ ‡ç­¾ä¸‹é€‚é…å™¨ipè¯¦ç»†æƒ…å†µæŸ¥è¯¢æ‰“å¼€ç½‘ç»œé€‚é…å™¨ï¼Œå³é”®æŸ¥çœ‹é€‚é…å™¨ipè¯¦ç»†æƒ…å†µå°†ipå¯¹åº”çš„åœ°å€ã€æ©ç å’Œç½‘å…³å¡«ä¸‹åœ¨è‡ªå®šä¹‰çš„IPåœ°å€ä¸‹(æ³¨æ„è¿™é‡Œåªèƒ½å›ºå®šIPçš„æœ€åä¸€ä½ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œä¹Ÿå°±æ˜¯å‰ä¸‰ä½åœ°å€ä¸èƒ½å˜)è“å±å’Œè¿›ä¸å»ç³»ç»Ÿå¦‚æœæ‚¨çš„è®¡ç®—æœºå‡ºç°è“å±å¹¶ä¸”æ— æ³•è¿›å…¥ç³»ç»Ÿï¼Œæˆ–è€…ç³»ç»Ÿä¸€ç›´åœ¨å¯åŠ¨å¾ªç¯ä¸­è½¬åœˆï¼Œè¿™å¯èƒ½æ˜¯ç”±äºå¤šç§åŸå› å¼•èµ·çš„ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„è§£å†³æ–¹æ³•ï¼šå®‰å…¨æ¨¡å¼å¯åŠ¨ï¼šå°è¯•è¿›å…¥å®‰å…¨æ¨¡å¼æ¥è§£å†³é—®é¢˜ã€‚é‡å¯è®¡ç®—æœºï¼Œåœ¨å¼•å¯¼è¿‡ç¨‹ä¸­æŒ‰ä¸‹F8é”®ï¼ˆæˆ–é€‚ç”¨äºæ‚¨çš„è®¡ç®—æœºçš„å…¶ä»–åŠŸèƒ½é”®ï¼‰ï¼Œç„¶åé€‰æ‹©â€å®‰å…¨æ¨¡å¼â€ã€‚å®‰å…¨æ¨¡å¼ä¼šä»¥æœ€å°çš„é©±åŠ¨ç¨‹åºå’ŒæœåŠ¡å¯åŠ¨ç³»ç»Ÿï¼Œæœ‰åŠ©äºæ’é™¤å¯èƒ½å¯¼è‡´é—®é¢˜çš„é©±åŠ¨ç¨‹åºæˆ–è½¯ä»¶ã€‚ç³»ç»Ÿè¿˜åŸï¼šå¦‚æœæ‚¨çš„è®¡ç®—æœºä¹‹å‰æ­£å¸¸å·¥ä½œï¼Œæ‚¨å¯ä»¥å°è¯•ä½¿ç”¨ç³»ç»Ÿè¿˜åŸå°†ç³»ç»Ÿæ¢å¤åˆ°ä¹‹å‰çš„å·¥ä½œçŠ¶æ€ã€‚åœ¨å®‰å…¨æ¨¡å¼ä¸‹ï¼Œæ‰“å¼€â€æ§åˆ¶é¢æ¿â€ï¼Œæ‰¾åˆ°â€ç³»ç»Ÿå’Œå®‰å…¨â€æˆ–â€ç³»ç»Ÿâ€é€‰é¡¹ï¼Œç„¶åé€‰æ‹©â€ç³»ç»Ÿä¿æŠ¤â€ã€‚åœ¨ç³»ç»Ÿä¿æŠ¤é€‰é¡¹å¡ä¸­ï¼Œé€‰æ‹©â€ç³»ç»Ÿè¿˜åŸâ€ï¼ŒæŒ‰ç…§æç¤ºé€‰æ‹©ä¹‹å‰çš„è¿˜åŸç‚¹å¹¶æ‰§è¡Œè¿˜åŸè¿‡ç¨‹ã€‚ä¿®å¤å¯åŠ¨ï¼šä½¿ç”¨Windowså®‰è£…åª’ä½“æˆ–æ¢å¤åˆ†åŒºï¼Œæ‚¨å¯ä»¥å°è¯•ä¿®å¤å¯åŠ¨é—®é¢˜ã€‚æ’å…¥Windowså®‰è£…åª’ä½“ï¼ˆä¾‹å¦‚å®‰è£…å…‰ç›˜æˆ–USBé©±åŠ¨å™¨ï¼‰ï¼Œé‡æ–°å¯åŠ¨è®¡ç®—æœºå¹¶ä»å®‰è£…åª’ä½“å¼•å¯¼ã€‚é€‰æ‹©â€ä¿®å¤æ‚¨çš„è®¡ç®—æœºâ€æˆ–ç±»ä¼¼é€‰é¡¹ï¼Œç„¶åæŒ‰ç…§å±å¹•ä¸Šçš„æŒ‡ç¤ºé€‰æ‹©â€å¯åŠ¨ä¿®å¤â€æˆ–â€è‡ªåŠ¨ä¿®å¤â€ã€‚æ£€æŸ¥ç¡¬ä»¶é—®é¢˜ï¼šç¡¬ä»¶é—®é¢˜ï¼ˆå¦‚å†…å­˜æ•…éšœæˆ–ç¡¬ç›˜é—®é¢˜ï¼‰ä¹Ÿå¯èƒ½å¯¼è‡´ç³»ç»Ÿæ— æ³•å¯åŠ¨ã€‚æ‚¨å¯ä»¥å°è¯•ä»¥ä¸‹æ­¥éª¤æ¥æ’é™¤ç¡¬ä»¶é—®é¢˜ï¼šæ£€æŸ¥å†…å­˜ï¼šæ‰“å¼€è®¡ç®—æœºå¹¶é‡æ–°å®‰è£…å†…å­˜æ¨¡å—ï¼Œæˆ–å°è¯•ä½¿ç”¨ä¸€æ¡å·²çŸ¥å·¥ä½œçš„å†…å­˜æ¨¡å—è¿›è¡Œæµ‹è¯•ã€‚æ£€æŸ¥ç¡¬ç›˜ï¼šç¡®ä¿ç¡¬ç›˜è¿æ¥æ­£å¸¸ï¼Œå¹¶å°è¯•ä½¿ç”¨ç¡¬ç›˜æµ‹è¯•å·¥å…·æ¥æ£€æŸ¥ç¡¬ç›˜çš„å¥åº·çŠ¶å†µã€‚ä¸“ä¸šæŠ€æœ¯æ”¯æŒï¼šå¦‚æœä¸Šè¿°æ–¹æ³•æ— æ³•è§£å†³é—®é¢˜ï¼Œæ‚¨å¯èƒ½éœ€è¦å¯»æ±‚ä¸“ä¸šçš„æŠ€æœ¯æ”¯æŒã€‚è”ç³»è®¡ç®—æœºåˆ¶é€ å•†æˆ–æŠ€æœ¯æ”¯æŒä¸“å®¶ï¼Œä»–ä»¬å¯ä»¥æä¾›æ›´è¿›ä¸€æ­¥çš„å¸®åŠ©å’ŒæŒ‡å¯¼ã€‚è¯·æ³¨æ„ï¼Œä»¥ä¸Šæ–¹æ³•å¯èƒ½å› å…·ä½“æƒ…å†µè€Œå¼‚ã€‚åœ¨å°è¯•ä»»ä½•è§£å†³æ–¹æ³•ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨äº†è§£å¯èƒ½äº§ç”Ÿçš„å½±å“ï¼Œå¹¶åœ¨å¯èƒ½çš„æƒ…å†µä¸‹å¤‡ä»½é‡è¦æ•°æ®ã€‚æŸäº›æ“ä½œç³»ç»Ÿï¼ˆå¦‚Windowsï¼‰åœ¨è¿ç»­å‘ç”Ÿå¯åŠ¨é—®é¢˜æ—¶ï¼Œå¯èƒ½ä¼šå°è¯•è‡ªåŠ¨ä¿®å¤ã€‚é€šè¿‡è¿ç»­å¼€å…³æœºä¸‰æ¬¡ï¼Œç³»ç»Ÿå¯èƒ½ä¼šæ£€æµ‹åˆ°å¯åŠ¨å¼‚å¸¸ï¼Œå¹¶å°è¯•è‡ªåŠ¨ä¿®å¤å¯åŠ¨é—®é¢˜ï¼Œæ­¤æ—¶è¿›å»åå°±èƒ½é€‰åˆ°å®‰å…¨æ¨¡å¼å¯åŠ¨äº†ä¸ªäººå®é™…æ“ä½œï¼Œå½“æ‚¨çš„è®¡ç®—æœºå‡ºç°é—®é¢˜æ—¶ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹æœ‰æ¡ç†çš„æ­¥éª¤è¿›è¡Œæ•…éšœæ’é™¤å’Œä¿®å¤ï¼šå°è¯•å®‰å…¨æ¨¡å¼ï¼šé‡å¯è®¡ç®—æœºï¼Œå¹¶åœ¨å¼•å¯¼è¿‡ç¨‹ä¸­æŒ‰ä¸‹F8é”®æˆ–é€‚ç”¨äºæ‚¨çš„è®¡ç®—æœºçš„å…¶ä»–åŠŸèƒ½é”®é€‰æ‹©â€å®‰å…¨æ¨¡å¼â€ä»¥æœ€å°çš„é©±åŠ¨ç¨‹åºå’ŒæœåŠ¡å¯åŠ¨ç³»ç»Ÿè¿›å…¥å®‰å…¨æ¨¡å¼åï¼Œè¿›è¡Œä»¥ä¸‹æ“ä½œï¼šè¿è¡Œæ€æ¯’è½¯ä»¶æ‰«æä»¥æ£€æŸ¥æ¶æ„è½¯ä»¶æˆ–ç—…æ¯’å¸è½½æœ€è¿‘å®‰è£…çš„è½¯ä»¶ï¼Œç‰¹åˆ«æ˜¯ä¸é—®é¢˜å‘ç”Ÿæ—¶é—´ç›¸å…³çš„è½¯ä»¶æ£€æŸ¥ç³»ç»Ÿæ—¥å¿—æˆ–äº‹ä»¶æŸ¥çœ‹å™¨ï¼Œä»¥äº†è§£æ˜¯å¦æœ‰ä»»ä½•é”™è¯¯æˆ–è­¦å‘Šæç¤ºè‡ªåŠ¨ä¿®å¤å¯åŠ¨ï¼šå¦‚æœå®‰å…¨æ¨¡å¼æ— æ³•è§£å†³é—®é¢˜ï¼Œæ‚¨å¯ä»¥å°è¯•è‡ªåŠ¨ä¿®å¤å¯åŠ¨è¿ç»­å¼€å…³æœºä¸‰æ¬¡ï¼Œä»¥è§¦å‘è‡ªåŠ¨ä¿®å¤å¯åŠ¨æ“ä½œç³»ç»Ÿä¼šå°è¯•è‡ªåŠ¨ä¿®å¤å¯åŠ¨é—®é¢˜ï¼Œå¦‚ä¿®å¤æŸåçš„å¯åŠ¨æ–‡ä»¶æˆ–é…ç½®å¸è½½æœ€æ–°çš„æ›´æ–°ï¼šå¦‚æœè‡ªåŠ¨ä¿®å¤å¯åŠ¨å¤±è´¥æˆ–é—®é¢˜ä»ç„¶å­˜åœ¨ï¼Œæ‚¨å¯ä»¥è€ƒè™‘å¸è½½æœ€è¿‘çš„åŠŸèƒ½æ›´æ–°æˆ–è´¨é‡æ›´æ–°è¿›å…¥è®¡ç®—æœºçš„æ§åˆ¶é¢æ¿æˆ–è®¾ç½®å¯»æ‰¾â€ç¨‹åºå’ŒåŠŸèƒ½â€æˆ–â€åº”ç”¨å’ŒåŠŸèƒ½â€é€‰é¡¹é€‰æ‹©â€å®‰è£…çš„æ›´æ–°â€æˆ–â€æ›´æ–°å†å²è®°å½•â€å¸è½½æœ€è¿‘å®‰è£…çš„åŠŸèƒ½æ›´æ–°æˆ–è´¨é‡æ›´æ–°é‡ç½®ç”µè„‘ï¼šå¦‚æœé—®é¢˜ä»ç„¶å­˜åœ¨ï¼Œæœ€åçš„é€‰æ‹©æ˜¯é‡ç½®ç”µè„‘è¿›å…¥è®¡ç®—æœºçš„è®¾ç½®æˆ–æ¢å¤é€‰é¡¹æ‰¾åˆ°â€æ¢å¤â€æˆ–â€é‡ç½®æ­¤ç”µè„‘â€é€‰é¡¹æ ¹æ®æç¤ºé€‰æ‹©é‡ç½®é€‰é¡¹ã€‚æ‚¨å¯ä»¥é€‰æ‹©ä¿ç•™ä¸ªäººæ–‡ä»¶æˆ–å®Œå…¨æ¢å¤å‡ºå‚è®¾ç½®è¯·æ³¨æ„ï¼Œé‡ç½®ç”µè„‘å°†æ¸…é™¤æ‰€æœ‰ä¸ªäººæ–‡ä»¶å’Œå®‰è£…çš„è½¯ä»¶ï¼Œéœ€è¦é‡æ–°å®‰è£…æ‚¨éœ€è¦çš„è½¯ä»¶æ‰‹åŠ¨é‡è£…ç³»ç»Ÿï¼šå¦‚æœä»¥ä¸Šæ–¹æ³•éƒ½æ— æ³•è§£å†³é—®é¢˜ï¼Œæœ€åä¸€æ­¥æ˜¯æ‰‹åŠ¨é‡è£…æ“ä½œç³»ç»Ÿè·å–é€‚ç”¨äºæ‚¨çš„æ“ä½œç³»ç»Ÿçš„å®‰è£…åª’ä½“å¯åŠ¨è®¡ç®—æœºå¹¶ä»å®‰è£…åª’ä½“å¼•å¯¼æŒ‰ç…§å±å¹•ä¸Šçš„æŒ‡ç¤ºè¿›è¡Œæ“ä½œç³»ç»Ÿçš„é‡æ–°å®‰è£…è¯·æ³¨æ„ï¼Œåœ¨æ‰§è¡Œè¿™äº›æ­¥éª¤ä¹‹å‰ï¼Œè¯·åŠ¡å¿…å¤‡ä»½é‡è¦çš„æ•°æ®ã€‚å¦‚æœæ‚¨ä¸ç¡®å®šå¦‚ä½•æ“ä½œæˆ–é‡åˆ°å›°éš¾ï¼Œè¯·è€ƒè™‘å¯»æ±‚ä¸“ä¸šæŠ€æœ¯æ”¯æŒæˆ–å’¨è¯¢è®¾å¤‡åˆ¶é€ å•†çš„æ”¯æŒè½¯ä»¶å®‰è£…å¿…è£…è½¯ä»¶å¾®è½¯OfficeåŠå…¬è½¯ä»¶æ˜¯æŒ‡å¯ä»¥è¿›è¡Œæ–‡å­—å¤„ç†ã€è¡¨æ ¼åˆ¶ä½œã€å¹»ç¯ç‰‡åˆ¶ä½œã€å›¾å½¢å›¾åƒå¤„ç†ã€ç®€å•æ•°æ®åº“çš„å¤„ç†ç­‰æ–¹é¢å·¥ä½œçš„è½¯ä»¶ã€‚åŠå…¬è½¯ä»¶æœç€æ“ä½œç®€å•åŒ–ï¼ŒåŠŸèƒ½ç»†åŒ–ç­‰æ–¹å‘å‘å±•ã€‚é“¾æ¥ä¸‹è½½(ç‚¹æˆ‘ä¸‹è½½2016ç‰ˆ)åˆ é™¤è½¯ä»¶IOBitIObit Uninstalleræœ€æ–°ç‰ˆæ˜¯æ¬¾åŠŸèƒ½é«˜æ•ˆçš„å¸è½½å·¥å…·ã€‚IObit Uninstallerå®˜æ–¹ç‰ˆå¯è½»æ¾å¸è½½å¹¶æ¶ˆé™¤æ‚¨ç”µè„‘ä¸­çš„æ‰€æœ‰ç¨‹åºåŠæ–‡ä»¶ï¼Œå¹¶åœ¨å¸è½½åæé€Ÿæœç´¢æ³¨å†Œè¡¨ï¼Œæ‰¾å‡ºæ®‹ä½™ä¿¡æ¯å¹¶åˆ é™¤ã€‚å¹¶ä¸”IObit Uninstallerä¸­è¿˜æœ‰ä¸€é”®ç§»é™¤å·¥å…·åˆ—ï¼Œæ‰¹æ¬¡ç§»é™¤å’Œå¼ºåˆ¶ç§»é™¤ç­‰åŠŸèƒ½ã€‚ç‚¹æˆ‘ä¸‹è½½chromeæµè§ˆå™¨ç™¾åº¦æœç´¢chromeæµè§ˆå™¨ï¼Œä¸‹è½½æœ€æ–°ç‰ˆæœ¬å®‰è£…å³å¯å¯ç‰›çœ‹å›¾ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ä¸”ä½“ç§¯å°å·§çš„ç”µè„‘çœ‹å›¾å·¥å…·ï¼Œæ‹¥æœ‰ä¸°å¯Œå¤šæ ·çš„å›¾ç‰‡æµè§ˆæ–¹å¼ä»¥åŠç‚«é…·åŠ¨æ„Ÿ3Då›¾ç‰‡å¢™ï¼Œæ”¯æŒæ‰¹é‡å›¾ç‰‡ä¸Šä¼ ã€æ”¯æŒå›¾ç‰‡æ‰¹é‡ä¸‹è½½(å®˜ç½‘ä¸‹è½½ï¼Œå¾®äº‘ä¸‹è½½)æé€ŸPDFé˜…è¯»å™¨æé€ŸPDFé˜…è¯»å™¨(ç‚¹æˆ‘ä¸‹è½½)æ˜¯ä¸€æ¬¾é—ªç”µèˆ¬å¥½ç”¨çš„PDFé˜…è¯»å™¨,ä½“ç§¯å°ã€å¯åŠ¨é€Ÿåº¦å¿«,ååˆ†è½»å·§ä¸”å ç”¨å†…å­˜æå°‘;æä¾›å•é¡µã€ä¹¦æœ¬æ¨¡å¼ä¸ªæ€§é˜…è¯»,åˆæœ‰å…¨å±ã€å¹»ç¯ç‰‡ç­‰åŠŸèƒ½å¸ƒè°·é¸Ÿé…éŸ³(æ”¶è´¹)å¸ƒè°·é¸Ÿé…éŸ³(ç‚¹æˆ‘ä¸‹è½½)æä¾›ä¸€ç«™å¼æ™ºèƒ½é…éŸ³çš„ä¸“ä¸šå·¥å…·ï¼Œè¾“å…¥æ–‡å­—è½¬è¯­éŸ³ï¼Œä¸€é”®å°†æ–‡å­—åˆæˆè¯­éŸ³ï¼ŒçœŸäººæƒ…æ„Ÿé…éŸ³é‡å¯è¿˜åŸ(å…è´¹ç‰ˆã€ä¸“ä¸šç‰ˆ)é‡å¯è¿˜åŸç‚¹æˆ‘ä¸‹è½½æ˜¯ä¸€æ¬¾ä¸å½±å“ç”µè„‘æ€§èƒ½ï¼Œä¸å CPUä½¿ç”¨ç‡çš„è¿˜åŸå·¥å…·ï¼ŒçœŸæ­£åšåˆ°é›¶å†…å­˜å ç”¨ï¼Œå…¨ç¨‹ä½¿ç”¨æ— æ„ŸçŸ¥ï¼Œè¿›å…¥è™šæ‹Ÿç³»ç»Ÿé€Ÿåº¦å’Œæ™®é€šç³»ç»Ÿé€Ÿåº¦ç›¸å·®æ— å‡ è¿›é˜¶è½¯ä»¶æ•ˆç‡ä¸‰ä»¶å¥—AnyTXT Searcher(ç‚¹æˆ‘ä¸‹è½½)æ˜¯ä¸€æ¬¾å…è´¹çš„åŠŸèƒ½å¼ºå¤§çš„æœ¬åœ°æ–‡æ¡£å’Œæ–‡æœ¬æœç´¢åº”ç”¨ç¨‹åº,å°±åƒæœ¬åœ°ç£ç›˜è°·æ­Œæœç´¢å¼•æ“,é€Ÿåº¦æ¯”Windows æœç´¢å¿«å¾—å¤š,æ˜¯æ‚¨ç†æƒ³çš„æ¡Œé¢æ–‡ä»¶å†…å®¹å…¨æ–‡æœç´¢å¼•æ“[æœæ–‡ä»¶å†…å®¹]Everything(ç‚¹æˆ‘ä¸‹è½½)æ˜¯voidtoolså¼€å‘çš„ä¸€æ¬¾æ–‡ä»¶æœç´¢å·¥å…·ï¼Œå®ƒä½“ç§¯å°å·§ï¼Œç•Œé¢ç®€æ´æ˜“ç”¨ï¼Œå¿«é€Ÿå»ºç«‹ç´¢å¼•ï¼Œå¿«é€Ÿæœç´¢ï¼ŒåŒæ—¶å ç”¨æä½çš„ç³»ç»Ÿèµ„æºï¼Œå®æ—¶è·Ÿè¸ªæ–‡ä»¶å˜åŒ–ï¼Œå¹¶ä¸”è¿˜å¯ä»¥é€šè¿‡httpæˆ–ftpå½¢å¼åˆ†äº«æœç´¢[æœæ–‡ä»¶]uTools(ç‚¹æˆ‘ä¸‹è½½)æ˜¯ä¸€ä¸ªæç®€ã€æ’ä»¶åŒ–ã€è·¨å¹³å°çš„ç°ä»£åŒ–æ¡Œé¢è½¯ä»¶ã€‚é€šè¿‡è‡ªç”±é€‰é…ä¸°å¯Œçš„æ’ä»¶,æ‰“é€ ä½ å¾—å¿ƒåº”æ‰‹çš„å·¥å…·é›†åˆã€‚ å½“ä½ ç†Ÿæ‚‰å®ƒå,èƒ½å¤Ÿä¸ºä½ èŠ‚çº¦å¤§é‡æ—¶é—´,è®©ä½ å¯ä»¥æ›´åŠ ä¸“æ³¨åœ°æ”¹å˜ä¸–ç•Œ[æœè½¯ä»¶å’Œæ’ä»¶]TreesizeTreeSize Proæ˜¯ä¸€æ¬¾ä¼˜ç§€çš„ç£ç›˜ç©ºé—´ç®¡ç†å·¥å…·ã€‚å‡­å€Ÿå…¶å¤šæ ·åŒ–çš„åŠŸèƒ½æ·±å—ç”¨æˆ·å–œçˆ±ã€‚é€šè¿‡è¯¥è½¯ä»¶èƒ½å¤Ÿæœ‰æ•ˆç®¡ç†å’Œæ¸…ç†ç£ç›˜ç©ºé—´ï¼Œå¯è§†åŒ–ç£ç›˜ç©ºé—´çš„ä½¿ç”¨æƒ…å†µï¼Œè¯¦ç»†åˆ†æç›®å½•çº§åˆ«ï¼Œæ˜¾ç¤ºç›®å½•å¤§å°ï¼ŒåŒ…æ‹¬æ‰€æœ‰å­ç›®å½•ï¼Œç›´è§‚å‘ˆç°ä¸ºé¥¼å›¾æˆ–æ¡å½¢çŠ¶ï¼Œæ‰€æœ‰ä¿¡æ¯ä¸€ç›®äº†ç„¶(å®˜ç½‘-éœ€è¦è‡ªå·±æ‰¾æ³¨å†Œç ã€ç™¾åº¦äº‘ä¸‹è½½-æå–ç : wqd1)visioMicrosoft Visioæ˜¯Windows æ“ä½œç³»ç»Ÿä¸‹è¿è¡Œçš„æµç¨‹å›¾è½¯ä»¶ï¼Œå®ƒç°åœ¨æ˜¯Microsoft Officeè½¯ä»¶çš„ä¸€ä¸ªéƒ¨åˆ†ã€‚Visioå¯ä»¥åˆ¶ä½œçš„å›¾è¡¨èŒƒå›´ååˆ†å¹¿æ³›ï¼Œæœ‰äº›äººåˆ©ç”¨Visioçš„å¼ºå¤§ç»˜å›¾åŠŸèƒ½ç»˜åˆ¶åœ°å›¾ã€ä¼ä¸šæ ‡å¿—ç­‰ï¼ŒåŒæ—¶Visioæ”¯æŒå°†æ–‡ä»¶ä¿å­˜ä¸ºsvgã€dwgç­‰çŸ¢é‡å›¾å½¢é€šç”¨æ ¼å¼ï¼Œå› æ­¤å—åˆ°å¹¿æ³›æ¬¢è¿ã€‚é“¾æ¥ä¸‹è½½(ç‚¹æˆ‘ä¸‹è½½2016ç‰ˆ)GowGow(ç‚¹æˆ‘ä¸‹è½½)æ˜¯ä¸€ä¸ªè½»é‡çº§çš„Cygwinæ›¿ä»£è½¯ä»¶ï¼Œå®ƒèƒ½åšçš„äº‹æƒ…æ˜¯ç»™Liunxè½¯ä»¶æä¾›ä¸€ä¸ªWindowsç³»ç»Ÿä¸Šçš„è¿è¡Œç¯å¢ƒå®‰è£…åå¯ä»¥ç›´æ¥åœ¨windowsä¸Šæ‰§è¡Œlinuxçš„å¤§éƒ¨åˆ†å‘½ä»¤VmwareVMware Workstation Pro ç‚¹æˆ‘ä¸‹è½½æ˜¯è¡Œä¸šæ ‡å‡†æ¡Œé¢ Hypervisorï¼Œä½¿ç”¨å®ƒå¯åœ¨ Windows æˆ– Linux æ¡Œé¢ä¸Šè¿è¡Œ Windowsã€Linux å’Œ BSD è™šæ‹Ÿæœºã€‚æ¿€æ´»ç å…¨å®¶æ¡¶ï¼Œå†å²ç‰ˆæœ¬ä¸‹è½½å°†ä¸Šé¢çš„Nameé¡¹å†…å®¹ï¼Œæ‹¼æ¥åˆ°ä¸‹é¢é“¾æ¥åé¢https://download3.vmware.com/software/wkst/file/ï¼Œå¤åˆ¶åˆ°æµè§ˆå™¨ä¸‹è½½ï¼Œä¾‹å¦‚:https://download3.vmware.com/software/wkst/file/VMware-workstation-full-16.2.1-18811642.exetyporaTypora(ç‚¹æˆ‘ä¸‹è½½)æ˜¯ä¸€æ¬¾è·¨å¹³å°çš„Markdownç¼–è¾‘å™¨è½¯ä»¶,æ‹¥æœ‰Windowsã€macOSå®¢æˆ·ç«¯neatreaderNeat Reader(ç‚¹æˆ‘ä¸‹è½½)ç‡å…ˆåœ¨ä¸šç•Œå®ç°äº†ä¸»æµå¹³å°çš„å…¨é¢æ”¯æŒï¼Œè®©ä½ æ— éœ€å†åœ¨å„ä¸ªè½¯ä»¶é—´æ¥å›åˆ‡æ¢ï¼ŒçœŸæ­£å®ç°äº†æ— æ‹˜æ— æŸï¼Œéšæ—¶éšåœ°é˜…è¯»ä½“éªŒï¼Œè‡´åŠ›äºæ‰“é€ ä¸€ä¸ªæ»¡è¶³ç°ä»£éœ€æ±‚çš„ EPUB/TXT é˜…è¯»å™¨PandaOCRPandaOCR(æ™®é€šç‰ˆï¼Œä¸“ä¸šç‰ˆ)æ˜¯ä¸€æ¬¾ä¸“æ³¨äº Windows æ¡Œé¢ç«¯ OCR æ–‡å­—è¯†åˆ«çš„å…è´¹è½¯ä»¶ï¼Œæ”¯æŒå¤šåŠŸèƒ½ OCR è¯†åˆ«ã€å³æ—¶ç¿»è¯‘å’Œæœ—è¯»ç­‰ã€‚è€Œä¸”è¯†åˆ«å’Œç¿»è¯‘ç­‰å¼•æ“éƒ½æ˜¯å¯ä»¥è‡ªç”±è°ƒæ¢çš„ï¼Œç•Œé¢ç®€æ´ï¼Œä½¿ç”¨èµ·æ¥ä¹Ÿå¾ˆæ–¹ä¾¿PandaOCR.ProåŒæ ·æ˜¯å…è´¹ä½¿ç”¨ï¼Œä½†å®ƒæœ‰ä¸€ä¸ªæ¿€æ´»ä¸“ä¸šç‰ˆæœ¬çŠ¶æ€ï¼Œåœ¨æœªæ¿€æ´»çŠ¶æ€ä¸‹æ‚¨å¯ä»¥ä½¿ç”¨é™¤é«˜çº§åŠŸèƒ½å¤–çš„å…¨éƒ¨åŠŸèƒ½ï¼ŒåŒæ—¶è¯†åˆ«æˆ–ç¿»è¯‘ç­‰åŠŸèƒ½å¯ä½¿ç”¨æ¼”ç¤ºæ¥å£å’Œç™¾åº¦APIç‰ˆæ¥å£ï¼Œæ™®é€šä½¿ç”¨åŸºæœ¬è¶³å¤ŸITè½¯ä»¶gitgitå®˜ç½‘ä¸‹è½½12345git config --global user.name &quot;narutohyc&quot;git config --global user.mail &quot;1832044043@qq.com&quot;# é…ç½®è¿œç¨‹ä»“åº“ å°†pub_keyé»è´´åˆ°gitssh-keygen -t rsa -C &quot;1832044043@qq.com&quot;å¦‚æœéœ€è¦æŒ‡å®šçš„æ–‡ä»¶åï¼Œå¯ä»¥åœ¨ssh-keygen -t rsa -C &quot;xxxxxxxxx@xx.com&quot;å‘½ä»¤åè¾“å…¥è‡ªå·±çš„åå­—(å¦‚: /root/.ssh/hyc_github)ä½†æ˜¯ ssh å‘½ä»¤é»˜è®¤åªä¼šè¯»å–id_rsaè¿™ä¸ªç§é’¥æ–‡ä»¶ï¼Œæ‰€ä»¥å¦‚æœæ˜¯å…¶å®ƒçš„åå­—éœ€è¦æ·»åŠ é…ç½®æ–‡ä»¶ï¼Œè¿™é‡Œæ–°å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶12touch ~/.ssh/configvi ~/.ssh/configè¾“å…¥ä»¥ä¸‹å†…å®¹12345Host www.github.comIdentityFile /root/.ssh/hyc_githubHost www.gitlab.comIdentityFile C:\Users\hyc\.ssh\gitlab_id_rsaps: è¿™é‡Œå»ºè®®githubçš„keyç›´æ¥é»˜è®¤åå­—(å› ä¸ºæ¢åå­—çš„è¯ï¼Œåé¢é…ç½®æœ‰ç‚¹éš¾ï¼Œæˆ‘æ²¡è¯•æˆåŠŸï¼Œæµ‹è¯•å‘½ä»¤ssh -T git@github.com)ï¼Œå…¶ä»–keyçš„å¯ä»¥æ¢ä¸ªåå­—æ¯”å¦‚ssh-keygen -t rsa -C &quot;huangyc@gitlab.com.cn&quot;ï¼Œåå­—è¾“å…¥gitlab_id_rsaï¼Œç„¶ååœ¨configé‡Œé…ç½®12Host www.gitlab.comIdentityFile C:\Users\hyc\.ssh\gitlab_id_rsaTortoiseGit(æµ·é¾Ÿ Git)æ˜¯TortoiseSVNçš„ Git ç‰ˆæœ¬ï¼Œç”¨äºè¿ç§» TortoiseSVN åˆ°TortoiseGitï¼ŒTortoiseGit æ˜¯ä¸€ä¸ª Git ç‰ˆæœ¬æ§åˆ¶å®¢æˆ·ç«¯ï¼Œä½œä¸º Microsoft Windows çš„å¤–å£³æ‰©å±•å®ç°ï¼Œé…ç½®æ•™ç¨‹å®‰è£…TortoiseGitå®‰è£…è¯­è¨€åŒ…æ‰§è¡ŒPuTTYgenï¼Œç”Ÿæˆå¯†é’¥ä¿å­˜å…¬é’¥å’Œå¯†é’¥å…¬é’¥é…ç½®åˆ°gitæ‰“å¼€ Pageantï¼Œæ·»åŠ å…¬é’¥(è®¾ç½®å¼€æœºè‡ªåŠ¨å¯åŠ¨å¹¶åŠ è½½å¯†é’¥)æŒ‰win + r æ‰“å¼€windowsçš„è¿è¡Œå‘½ä»¤æ¡†ï¼Œè¾“å…¥shell:startupï¼Œä¼šæ‰“å¼€windowså¼€æœºå¯åŠ¨çš„æ–‡ä»¶å¤¹ï¼Œé‡Œé¢æ”¾çš„æ‰€æœ‰exeç¨‹åºå°±ä¼šå¼€æœºå¯åŠ¨æ‰¾åˆ°pageant.exeæ–‡ä»¶ï¼Œé¼ æ ‡å³é”®æ–°å»ºå¿«æ·æ–¹å¼æˆ–å‘é€åˆ°æ¡Œé¢å¿«æ·æ–¹å¼å¤åˆ¶åˆ°å¯åŠ¨æ–‡ä»¶å¤¹ï¼Œå³é”®å±æ€§ï¼Œä¿®æ”¹ç›®æ ‡ä¸ºâ€C:\Program Files\TortoiseGit\bin\pageant.exeâ€ â€œC:\Users\.ssh\github_tor.ppkâ€tortoisegit å¸¸è§é”™è¯¯ï¼šdisconnected no supported authentication methods available(server sent: publickey)å¤šåŠæ˜¯å› ä¸ºgitå’Œå°ä¹Œé¾Ÿæœ‰å†²çªï¼Œè§£å†³æ–¹æ³•ï¼šå³é”®â€”å°ä¹Œé¾Ÿâ€”-settingsâ€”networkâ€”ä¿®æ”¹ssh clientä¸ºgitçš„ssh.exegitçš„ssh.exeåœ¨Git\usr\bin\ssh.exeä¸‹æˆ–è€…æ˜¯æ‰“å¼€ç¼–è¾‘æœ¬åœ°git/config(L),æ·»åŠ puttykeyfile1234[remote &quot;origin&quot;]url = git@github.com:hycBook/hycBlog.gitfetch = +refs/heads/*:refs/remotes/origin/*puttykeyfile = C:\\Users\\hyc\\.ssh\\tor_pri.ppkjdkå®˜ç½‘ä¸‹è½½ï¼Œjdk1.8å®˜ç½‘åœ°å€ä¸»è¦é…ç½®å‚è€ƒ1234export JAVA_HOME=/usr/java/jdk1.8.0_241-amd64export JRE_HOME=/usr/java/jdk1.8.0_241-amd64/jreexport PATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/binexport CLASSPATH=.:$CLASSPATH:$JAVA_HOME/lib:$JRE_HOME/libpycharmå®˜ç½‘ä¸‹è½½ï¼ŒIDEå…¨å®¶æ¡¶æ¿€æ´»ç ï¼ŒéªŒè¯ç è¾“å…¥lookdiv.comnavicatæä¾›ç®€ä¾¿çš„ç®¡ç†æ–¹æ³•ï¼Œè®¾è®¡å’Œæ“ä½œMySQLã€MariaDBã€SQL Serverã€Oracleã€PostgreSQLå’ŒSQLiteçš„æ•°æ®(ç‚¹æˆ‘ä¸‹è½½-æå–ç : 6sp9)Power Designeræ˜¯Sybaseå…¬å¸çš„CASEå·¥å…·é›†ï¼Œä½¿ç”¨å®ƒå¯ä»¥æ–¹ä¾¿åœ°å¯¹ç®¡ç†ä¿¡æ¯ç³»ç»Ÿè¿›è¡Œåˆ†æè®¾è®¡ï¼Œå®ƒå‡ ä¹åŒ…æ‹¬äº†æ•°æ®åº“æ¨¡å‹è®¾è®¡çš„å…¨è¿‡ç¨‹ã€‚åˆ©ç”¨PowerDesignerå¯ä»¥åˆ¶ä½œæ•°æ®æµç¨‹å›¾ã€æ¦‚å¿µæ•°æ®æ¨¡å‹(ConceptualDataModel)ã€ç‰©ç†æ•°æ®æ¨¡å‹(PhysicalDataModel)ï¼Œè¿˜å¯ä»¥ä¸ºæ•°æ®ä»“åº“åˆ¶ä½œç»“æ„æ¨¡å‹ï¼Œä¹Ÿèƒ½å¯¹å›¢é˜Ÿè®¾è®¡æ¨¡å‹è¿›è¡Œæ§åˆ¶ã€‚(å®˜ç½‘-éœ€è¦è‡ªå·±æ‰¾æ³¨å†Œç ã€ç™¾åº¦äº‘ä¸‹è½½-æå–ç : n3xz)finalshellå…è´¹çš„å›½äº§çš„é›† SSH å·¥å…·ã€æœåŠ¡å™¨ç®¡ç†ã€è¿œç¨‹æ¡Œé¢åŠ é€Ÿçš„è‰¯å¿ƒè½¯ä»¶ï¼ŒåŒæ—¶æ”¯æŒ Windowsï¼ŒmacOSï¼ŒLinuxï¼Œå®ƒä¸å•å•æ˜¯ä¸€ä¸ª SSH å·¥å…·ï¼Œå®Œæ•´çš„è¯´æ³•åº”è¯¥å«ä¸€ä½“åŒ–çš„æœåŠ¡å™¨ï¼Œç½‘ç»œç®¡ç†è½¯ä»¶ï¼Œåœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå¯ä»¥å…è´¹æ›¿ä»£ XShellï¼Œæ˜¯å›½äº§ä¸­ä¸å¤šè§çš„è‰¯å¿ƒäº§å“ï¼Œå…·æœ‰å…è´¹æµ·å¤–æœåŠ¡å™¨è¿œç¨‹æ¡Œé¢åŠ é€Ÿï¼Œssh åŠ é€Ÿï¼ŒåŒè¾¹ tcp åŠ é€Ÿï¼Œå†…ç½‘ç©¿é€ç­‰ç‰¹è‰²åŠŸèƒ½(ç‚¹æˆ‘ä¸‹è½½)Officeboxå®Œå…¨å…è´¹çš„PDFå·¥å…·/ä¸‡èƒ½æ ¼å¼è½¬æ¢/è¯†åˆ«å·¥å…·/å›¾ç‰‡å¤„ç†ï¼Œå¤šè¾¾60+ä¸ªå°å·¥å…·ï¼Œæä¾›ç»¿è‰²ç‰ˆ(ç‚¹æˆ‘ä¸‹è½½)Wolfram Mathematicaä¸€æ¬¾æ•°å­¦è®¡ç®—è½¯ä»¶ï¼Œå…·æœ‰ç¼–ç¨‹è¯­è¨€ã€æ–‡æœ¬ç³»ç»Ÿã€è®¡ç®—å¼•æ“ã€å›¾å½¢ç³»ç»Ÿç­‰å¤šç§ç‰¹è‰²åŠŸèƒ½ï¼Œå¹¶ä¸”è¿˜å®Œç¾æ”¯æŒæ”¯æŒé«˜æ€§èƒ½è®¡ç®—ï¼Œè®©ç”¨æˆ·ç§‘å­¦è®¡ç®—çš„è¿‡ç¨‹ä¸­ï¼Œå……åˆ†çš„å‘æŒ¥å‡ºè‡ªèº«çš„ä¼˜åŠ¿ç­‰ã€‚å¯ä»¥ç”¨äºç”»å‡½æ•°å›¾åƒ(ç‚¹æˆ‘ä¸‹è½½-æå–ç : 52qa)å†…ç½‘ç©¿é€cpolaré€Ÿåº¦ä¸€èˆ¬ï¼Œå®˜ç½‘ç½‘å€æ“ä½œç®€å•ï¼Œç›´æ¥æ‰§è¡Œå‘½ä»¤å¯åŠ¨ç‰¹ç‚¹ï¼šéšæœºURL/ç«¯å£ä¸Šçš„HTTP/TCPéš§é“1ä¸ªåœ¨çº¿cpolarè¿›ç¨‹4ä¸ªéš§é“/cpoloarè¿›ç¨‹40ä¸ªè¿æ¥æ•°/åˆ†é’Ÿæ¯æ¬¡åœ°å€ä¼šä¸€ç›´å˜starryfrpæ˜Ÿç©ºå†…ç½‘ç©¿é€ï¼Œå®˜ç½‘ç½‘å€å…è´¹ç‰ˆé€šè¿‡ç­¾åˆ°å¯ä»¥éšæœºè·å¾— 1 ~ 10 GiB æµé‡5 æ¡éš§é“ï¼ˆå®ååèµ é€ 5 æ¡å¯ç”¨éš§é“æ•°ï¼‰8Mbps é™é€Ÿ(å®é™…ä¸‹è½½é€Ÿåº¦ 200kå·¦å³)æ¯æ—¥ç­¾åˆ°è·å– 1 ~ 5 GiB éšæœºæµé‡æ”¯æŒ TCP/UDP/HTTP/HTTPS/STCP éš§é“å¤§å¸¦å®½ç‰ˆ  ï¿¥10 /æœˆ   15 æ¡éš§é“   10Mbps é™é€Ÿæ¯æ—¥ç­¾åˆ°è·å– 1 ~ 5 GiB éšæœºæµé‡æ”¯æŒ TCP/UDP/HTTP/HTTPS/STCP éš§é“è§£é”VIPèŠ‚ç‚¹natfrpæ¨±èŠ±å†…ç½‘ç©¿é€ï¼Œå®˜ç½‘ç½‘å€10Mbps (é€Ÿåº¦å¿«  æµé‡æ¶ˆè€—æŒºå¿«çš„)æ™®é€šç”¨æˆ·   å®Œå…¨å…è´¹éš§é“é™é€Ÿ10 Mibpséš§é“æ•°é‡2 æ¡æ¯æœˆæµé‡5 GiBè§£é”èŠ‚ç‚¹æ™®é€šèŠ‚ç‚¹é’é“œVIP   ï¿¥68 ï¿¥10 / æœˆéš§é“é™é€Ÿ24 Mibpséš§é“æ•°é‡10 æ¡æ¯æœˆæµé‡5 GiB + 66 GiBè§£é”èŠ‚ç‚¹+ VIPèŠ‚ç‚¹æ–‡ä»¶å…±äº«ä¸‹è½½å®¢æˆ·ç«¯(ç‚¹æˆ‘ä¸‹è½½)ï¼ŒæŸ¥çœ‹pythonæºç æ–‡ä»¶ï¼Œå¯ä»¥ä¾æ®è‡ªå·±çš„éœ€æ±‚ä¿®æ”¹ä½¿ç”¨æ–¹æ³•ï¼šå°†noup_server_pig.exeæ”¾åœ¨éœ€è¦å…±äº«çš„ç›®å½•ä¸‹ï¼ŒåŒå‡»å¯åŠ¨å°±å¥½ï¼Œé»˜è®¤ç«¯å£ä¸º8282å¦‚æœéœ€è¦ä¿®æ”¹ç«¯å£æˆ–æ–‡ä»¶å¤¹æ—¶ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ‰§è¡Œ1noup_server_pig.exe --port 8282 -d S:\portè¡¨ç¤ºå¼€æ”¾çš„ç«¯å£ï¼Œé»˜è®¤ä¸º8282dè¡¨ç¤ºæ˜¯å…±äº«çš„æ–‡ä»¶å¤¹ï¼Œé»˜è®¤ä¸ºHç›˜ç«¯å£å¼€æ”¾ï¼Œæ²¡æœ‰å¼€æ”¾ç«¯å£çš„è¯ï¼Œå…¶ä»–è®¾å¤‡æ˜¯æ— æ³•è®¿é—®ä½ çš„(æ³¨æ„åˆ°è¿™ä¸€æ­¥ï¼Œåªèƒ½åœ¨å±€åŸŸç½‘å†…è®¿é—®)windowsï¼šå‘½ä»¤è¡Œæ‰“å¼€è¾“å…¥Firewall.cplï¼Œæ‰“å¼€é«˜çº§è®¾ç½®   ç‚¹å‡»å…¥ç«™è§„åˆ™åå†æ–°å»ºè§„åˆ™   æœ€åè¾“å…¥åç§°å°±å¯ä»¥å¼€æ”¾8282ç«¯å£äº†   å¦‚æœå¼€æ”¾åæ²¡æœ‰æ•ˆæœï¼Œç›´æ¥å…³é—­é˜²ç«å¢™è¯•è¯•å†…ç½‘ç©¿é€ä¸ºäº†è®©å±€åŸŸç½‘å¤–çš„è®¾å¤‡è®¿é—®åˆ°ï¼Œéœ€è¦å®‰è£…å†…ç½‘ç©¿é€è½¯ä»¶ï¼Œå¯ä»¥å‚è€ƒä¸Šæ–‡çš„è½¯ä»¶å®‰è£…éƒ¨åˆ†è‡³æ­¤å®Œæˆæ–‡ä»¶å…±äº«Chromeæ‰©å±•ç¨‹åºæ²¡æœ‰æ’ä»¶çš„æµè§ˆå™¨æ— å¼‚äºæ²¡æœ‰çµé­‚ï¼ä»¥ä¸‹æ‰©å±•ç¨‹åºçš„ç¦»çº¿åŒ…å¾®äº‘ä¸‹è½½æ’ä»¶ä¸‹è½½åœ°å€crx4chrome: ä¸‹è½½æŒ‡å®šæ‰©å±•idçš„crxæ–‡ä»¶extfanshuajiakejicrxdownåº”ç”¨å•†åº—ç¿»å¢™ç±»Astar VPNAstar VPN- é€‚åˆæ‰€æœ‰äººçš„å…è´¹ä¸”å¿«é€Ÿçš„ VPNGhelperå®˜ç½‘éœ€è¦ç¿»å¢™è„šæœ¬ç®¡ç†å·¥å…·æ‰©å±•æ²¹çŒ´Tampermonkeyæš´åŠ›çŒ´Violentmonkeyè„šæœ¬ä¸‹è½½ä¸æ¨èè„šæœ¬ä¸‹è½½åœ°å€openuserjsgreasyforkè„šæœ¬æ¨èç™¾åº¦ç½‘ç›˜ç›´æ¥ä¸‹è½½åŠ©æ‰‹ç½‘ç›˜ç›´é“¾ä¸‹è½½åŠ©æ‰‹è§£é”Bç«™å¤§ä¼šå‘˜ç•ªå‰§ã€Bç«™è§†é¢‘è§£æä¸‹è½½ï¼›å…¨ç½‘VIPè§†é¢‘å…è´¹ç ´è§£å»å¹¿å‘Šï¼›å…¨ç½‘éŸ³ä¹ç›´æ¥ä¸‹è½½ï¼›æ²¹ç®¡ã€Facebookç­‰å›½å¤–è§†é¢‘è§£æä¸‹è½½ï¼›ç½‘ç›˜æœç´¢å¼•æ“ç ´è§£æ— é™ä¸‹è½½ç­‰ç ´è§£VIPä¼šå‘˜è§†é¢‘é›†åˆä¸‹è½½ç±»Chronoä¸‹è½½ç®¡ç†å™¨: åšChromeæµè§ˆå™¨ä¸­æœ€å¥½çš„ä¸‹è½½ç®¡ç†å™¨nternet Download Manager: æ‚¨å¯ä»¥ä½¿ç”¨Internetä¸‹è½½ç®¡ç†å™¨ä¸‹è½½Stream Recorder: å¯ä»¥ä¸‹è½½99%åœ¨çº¿è§†é¢‘ï¼ŒåŒ…æ‹¬ç›´æ’­æµã€m3u8æµFatkunå›¾ç‰‡æ‰¹é‡ä¸‹è½½: å¯ä»¥ä¸‹è½½å½“å‰æ ‡ç­¾æˆ–è€…æ˜¯æ‰€æœ‰æ ‡ç­¾çš„å›¾ç‰‡ï¼Œæä¾›æŒ‰åˆ†è¾¨ç‡ã€é“¾æ¥ç­‰ç­›é€‰å›¾ç‰‡æ•ˆç‡ç±»ä¹¦ç­¾ç®¡ç†: åœ¨ä»»ä½•é¡µé¢éƒ½å¯ä»¥é€šè¿‡ä¹¦ç­¾å…³é”®å­—å¿«é€Ÿæœç´¢æ‰“å¼€ä¹¦ç­¾,ç®¡ç†æ‚¨çš„ä¹¦ç­¾ä¹¦ç­¾åœ°çƒåŠ©æ‰‹: ä¸€æ¬¾å¾ˆä¼˜ç§€å¥½ç”¨çš„ç½‘é¡µæµè§ˆå™¨ä¸Šçš„ä¹¦ç­¾ç®¡ç†åŠ©æ‰‹ï¼Œå¸®åŠ©ç”¨æˆ·ä¸€é”®æ•´ç†ç½‘é¡µæ ‡ç­¾ï¼Œè‡ªå®šä¹‰æ ‡ç­¾è®¾ç½®æ–¹æ³•ï¼ŒåŒæ—¶è¿˜å¯ä»¥æŸ¥è¯¢æœç´¢å†å²è®°å½•å¹¿å‘Šæ‹¦æˆªAdGuard å¹¿å‘Šæ‹¦æˆªå™¨æ˜¯ä¸€æ¬¾æ— ä¸ä¼¦æ¯”çš„å¹¿å‘Šæ‹¦æˆªæ‰©å±•ï¼Œç”¨ä»¥å¯¹æŠ—å„å¼å¹¿å‘Šä¸å¼¹çª—ã€‚å¯ä»¥æ‹¦æˆª Facebookã€YouTube å’Œå…¶å®ƒæ‰€æœ‰ç½‘ç«™çš„å¹¿å‘Šå¹¿å‘Šç»ˆç»“è€…èƒ½æ¸…é™¤ç½‘é¡µä¸Šçš„æ‰€æœ‰å¹¿å‘Šï¼šæµ®åŠ¨å¹¿å‘Šï¼Œè´­ç‰©å¹¿å‘Šï¼Œæ¶æ„å¼¹çª—ï¼Œè·Ÿè¸ªä»£ç ã€‚è®©ä½ æµè§ˆç½‘é¡µæ›´å¿«æ›´æ¸…çˆ½æ‰©å±•ç®¡ç†å™¨(Extension Manager): ä¸€é”®ç®¡ç†æ‰€æœ‰æ‰©å±•ï¼Œå¿«é€Ÿå¼€å¯/ç¦ç”¨ã€æ‰¹é‡é—ªç”µç®¡ç†ï¼Œæ™ºèƒ½æ’åºï¼Œå³é”®å¸è½½ã€é”å®šã€é€‰é¡¹é…ç½®ï¼Œè§’æ ‡æé†’ï¼Œå¤§å°å¸ƒå±€éšå¿ƒé…ã€‚å¿«æ·ã€ç®€å•ã€å®‰å…¨Simple Allow Copy: ç®€æ˜“å¤åˆ¶Reader View: å‰¥ç¦»æŒ‰é’®ã€èƒŒæ™¯å›¾åƒç­‰æ‚ç‰©ï¼Œæ”¹å˜é¡µé¢çš„æ–‡å­—å¤§å°ã€å¯¹æ¯”åº¦å’Œå¸ƒå±€ï¼Œä»¥æé«˜å¯è¯»æ€§Diigo Web Collector - Capture and Annotate: ç”¨æ¥åœ¨ç½‘é¡µä¸Šåšç¬”è®°ï¼Œé«˜äº®æ˜¾ç¤ºé€‰ä¸­çš„æ–‡æœ¬ï¼Œå°±åƒåœ¨æœ¬å­ä¸Šå‹¾ç”»é‡ç‚¹ä¸€æ ·(éœ€è¦ç™»å½•ä½¿ç”¨ï¼Œå…è´¹ç‰ˆæ”¯æŒ100ä¸ªç½‘é¡µ)åœ¨çº¿åˆå¹¶PDF: å¿«é€Ÿå…è´¹åˆå¹¶PDFæ–‡ä»¶ï¼Diigo Web Collector: åƒåœ¨æœ¬å­ä¸Šä¸€æ ·ä¸ºç½‘é¡µåšç¬”è®°Docs Online Viewer: ç›´æ¥åœ¨è°·æ­Œæµè§ˆå™¨ä¸­åœ¨çº¿æŸ¥çœ‹ä»»ä½•æ–‡ä»¶Instapaper: æ˜¯ä¸€æ¬¾è¿è¡Œåœ¨chrområ†…æ ¸çš„èƒ½å¤Ÿå³æ—¶ä¿å­˜ç½‘é¡µçš„chromeç½‘é¡µç¦»çº¿é˜…è¯»æ’ä»¶Mate Translate: æ˜¯ä¸€æ¬¾è¯å…¸ç¿»è¯‘ç±»æ’ä»¶ï¼Œå¯è½»æ¾ç¿»è¯‘ 103 ç§è¯­è¨€çš„å•è¯ã€çŸ­è¯­æˆ–æ–‡ä»¶ã€‚åŠŸèƒ½åŒ…å« [å…¨é¡µç¿»è¯‘]: åªè¦å•å‡»é¼ æ ‡ï¼ŒMate å°±ä¼šä¸ºæ‚¨ç¿»è¯‘æ•´ä¸ªç½‘é¡µï¼åœ¨ä»»ä½•é¡µé¢ä¸Šï¼Œåªè¦ä½¿ç”¨ä¸Šä¸‹æ–‡èœå•ä¸­çš„â€œç¿»è¯‘æ­¤é¡µé¢â€åŠŸèƒ½ï¼Œå°±å¯ç«‹å³ç¿»è¯‘ä¸ºæ‚¨æƒ³è¦çš„è¯­è¨€Video Downloader professional: æ˜¯ä¸€æ¬¾ç½‘é¡µè§†é¢‘ä¸‹è½½å·¥å…·ï¼Œä¸‹è½½å‰è¯·å…ˆæ’­æ”¾è§†é¢‘FireShot: ä¸ä»…æ”¯æŒåŒºåŸŸæˆªå›¾ï¼Œè¿˜æ”¯æŒå®Œæ•´çš„é•¿ç½‘é¡µæˆªå›¾Grammarly for Chrome: å›½å¤–æœ€ç«çš„æ–‡å­—çº é”™å·¥å…·ï¼Œè‹±è¯­å†™ä½œåŠ©æ‰‹ï¼Œå¸®åŠ©ä½ åœ¨è¾“å‡ºè¿‡ç¨‹ä¸­æ‰¾å‡ºè‹±è¯­å•è¯æ‹¼å†™ã€è¯­æ³•ã€è¯­è°ƒç­‰é—®é¢˜ï¼Œå®ƒä¸ºä½ æä¾›å…·ä½“çš„å»ºè®®ï¼Œå¸®åŠ©ä½ æé«˜è‹±è¯­å†™ä½œæ°´å¹³ç¨‹åºå‘˜ç±»Octotree - GitHub code treePostman InterceptorSourcegraphGitZip for githubJSON Viewer Proæµè§ˆå™¨ç¾åŒ–ç±»MONKNOW æ–°æ ‡ç­¾é¡µ - ä¸ªæ€§åŒ–é¢æ¿Stylish-ä¸ºä»»æ„ç½‘ç«™è‡ªå®šä¹‰ä¸»é¢˜: åˆ©ç”¨ç”¨æˆ·æ ·å¼ç®¡ç†å™¨Stylishæ¥é‡æ–°ç¼–è¾‘ç½‘ç«™çš„æ ·å¼ï¼Œå¯åˆ©ç”¨Stylishä¸ºè®¸å¤šç½‘ç«™å®‰è£…ä¸»é¢˜å’Œçš®è‚¤ï¼Œä¹Ÿå¯åˆ›å»ºè‡ªå·±çš„ä¸»é¢˜å’Œçš®è‚¤æ–‡ä»¶å…±äº«å±€åŸŸç½‘ftpå…±äº«centos7.6ä¸‹æ­å»ºNFSå…±äº«å¹¶æŒ‚è½½åˆ°windowså®¢æˆ·ç«¯-ç½‘ç»œé”™è¯¯53è§£å†³æ–¹æ³•FTP(File Transfer Protocol)æ˜¯TCP/IPç½‘ç»œä¸Šä¸¤å°è®¡ç®—æœºä¼ é€æ–‡ä»¶çš„åè®®ï¼Œä½¿å¾—ä¸»æœºé—´å¯ä»¥å…±äº«æ–‡ä»¶ç›®å‰æœ‰å¾ˆå¤šè½¯ä»¶éƒ½èƒ½å®ç°è¿™ä¸€åŠŸèƒ½ï¼Œç„¶è€Œwindows 8ç³»ç»Ÿè‡ªå¸¦çš„IISå°±å¯ä»¥å¸®åŠ©ä½ æ­å»ºFTPæœåŠ¡å™¨æ‰“å¼€æ§åˆ¶é¢æ¿ -&gt; ç¨‹åº -&gt; å¯ç”¨æˆ–å…³é—­windowsåŠŸèƒ½æ‰¾åˆ°Internetä¿¡æ¯æœåŠ¡ï¼Œå¹¶é€‰ä¸­FTPæœåŠ¡ã€FTPæ‰©å±•æ€§å’ŒIISç®¡ç†æ§åˆ¶å°å‰çš„å¤é€‰æ¡†ï¼Œç‚¹å‡»ç¡®å®šæ‰“å¼€IISç®¡ç†å™¨ï¼Œåœ¨å·¦æ çš„ç½‘ç«™ä¸Šç‚¹å‡»å³é”®ï¼Œæ‰“å¼€æ·»åŠ FTPç«™ç‚¹win+råè¾“å…¥inetmgrï¼Œå³å¯æ‰“å¼€IISç®¡ç†å™¨å¼€å§‹é…ç½®ï¼Œé€‰æ‹©æ— SSLåœ¨ç”µè„‘æµè§ˆå™¨åœ°å€æ ä¸­è¾“å…¥ftp://æœ¬æœºipæµ‹è¯•ä¸€ä¸‹åœ¨å¯åŠ¨ä½ çš„FTPæœåŠ¡å™¨æ—¶å»ºè®®å…³é—­é˜²ç«å¢™å¸¸è§é—®é¢˜æœ¬æœºå¯ä»¥è®¿é—®ï¼Œå…¶ä»–æœºå­æ— æ³•è®¿é—®ï¼Œå¯èƒ½æ˜¯é˜²ç«å¢™é—®é¢˜æˆ–ftpæœåŠ¡æƒé™é—®é¢˜æ–¹å¼ä¸€: å…³é—­é˜²ç«å¢™  æ–¹å¼äºŒ(æ¨è): å…è®¸FTPæœåŠ¡é€šè¿‡é˜²ç«å¢™  å…³é—­è¢«åŠ¨FTP å°†æ–‡ä»¶å¤åˆ¶åˆ°ftpæœåŠ¡å™¨å‡ºé”™ï¼Œè¯·æ£€æŸ¥æ˜¯å¦æœ‰æƒé™å°†æ–‡ä»¶æ”¾åˆ°è¯¥æœåŠ¡å™¨ä¸Šwin+råè¾“å…¥inetmgrï¼Œæ‰“å¼€IISç®¡ç†å™¨ï¼Œè¿›å…¥æœåŠ¡å™¨ç®¡ç†å™¨ï¼Œå•å‡»å³ä¾§çš„[é«˜çº§è®¾ç½®]é€‰é¡¹ï¼Œè¿›å…¥FTPé«˜çº§è®¾ç½®å¯¹è¯æ¡†ï¼Œåœ¨é«˜çº§è®¾ç½®å¯¹è¯æ¡†ä¸­æ‰¾åˆ°å…è®¸ UTF-8é€‰é¡¹ï¼Œå•å‡»ä¸‹æ‹‰åˆ—ï¼Œç„¶åé€‰æ‹©Falseé€‰é¡¹ï¼Œé‡å¯æœåŠ¡å³å¯nfså…±äº«æœåŠ¡éƒ¨ç½²centoséƒ¨ç½²win10éƒ¨ç½²å‡†å¤‡å·¥ä½œæ¦‚è¿°ï¼šNFSæ˜¯ä¸€ç§åŸºäºTCP/IPä¼ è¾“çš„ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿåè®®ï¼Œæœ€åˆç”±SUNå…¬å¸å¼€å‘ã€‚é€šè¿‡NFSåè®®ï¼Œå®¢æˆ·æœºå¯ä»¥åƒè®¿é—®æœ¬åœ°ç›®å½•ä¸€æ ·è®¿é—®è¿œç¨‹æœåŠ¡å™¨ä¸­çš„å…±äº«èµ„æºã€‚NFSå¾—åˆ°äº†å¦‚NASç­‰ç½‘ç»œå­˜å‚¨çš„è®¾å¤‡æå¥½æ”¯æŒã€‚ä¹Ÿæ˜¯LVSå…±äº«å­˜å‚¨çš„é¦–é€‰ã€‚è¿™é‡Œç”¨centos7ç¯å¢ƒæ¼”ç¤ºæœåŠ¡ç«¯å®‰è£…nfs-utilsã€rcpbindè½¯ä»¶åŒ…1yum -y install nfs-utils rpcbindé…ç½®nfsåè®®ï¼Œè®¾ç½®å„ç§*port=â€¦å‚æ•°1vi /etc/sysconfig/nfså…±äº«ç›®å½•åˆ›å»ºï¼Œå¹¶ä¿®æ”¹æƒé™ï¼š12mkdir /home/hycchmod 777 /home/hycé…ç½®nasï¼Œæ‰“å¼€é…ç½®æ–‡ä»¶ï¼š/etc/exports12/home/hyc 10.xx.xx.xx/22(rw,sync,no_root_squash,no_all_squash)/home/hyc 192.xx.xx.xx/22(rw,sync,no_root_squash,no_all_squash)é‡æ–°åŠ è½½NFSé…ç½®1exportfs -r/etc/exportså‚æ•°è¯´æ˜rwï¼šå¯è¯»å†™çš„æƒé™roï¼šåªè¯»çš„æƒé™anonuidï¼šå¯ä»¥è‡ªè¡Œè®¾å®šè¿™ä¸ªUIDçš„å€¼ï¼Œè¿™ä¸ªUIDå¿…éœ€è¦å­˜åœ¨äºä½ çš„/etc/passwdå½“ä¸­anongidï¼šåŒanonuidï¼Œä½†æ˜¯å˜æˆgroupIDå°±æ˜¯äº†syncï¼šèµ„æ–™åŒæ­¥å†™å…¥åˆ°å†…å­˜ä¸ç¡¬ç›˜å½“ä¸­asyncï¼šèµ„æ–™ä¼šå…ˆæš‚å­˜äºå†…å­˜å½“ä¸­ï¼Œè€Œéç›´æ¥å†™å…¥ç¡¬ç›˜insecureï¼šå…è®¸ä»è¿™å°æœºå™¨è¿‡æ¥çš„éæˆæƒè®¿é—®no_root_squashï¼šç™»å…¥NFSä¸»æœºï¼Œä½¿ç”¨è¯¥å…±äº«ç›®å½•æ—¶ç›¸å½“äºè¯¥ç›®å½•çš„æ‹¥æœ‰è€…å¦‚æœæ˜¯rootçš„è¯ï¼Œé‚£ä¹ˆå¯¹äºè¿™ä¸ªå…±äº«çš„ç›®å½•æ¥è¯´ï¼Œä»–å°±å…·æœ‰rootçš„æƒé™ï¼Œè¿™ä¸ªå‚æ•°ã€æä¸å®‰å…¨ã€ï¼Œä¸å»ºè®®ä½¿ç”¨root_squashï¼šç™»å…¥NFSä¸»æœºï¼Œä½¿ç”¨è¯¥å…±äº«ç›®å½•æ—¶ç›¸å½“äºè¯¥ç›®å½•çš„æ‹¥æœ‰è€…ä½†æ˜¯å¦‚æœæ˜¯ä»¥rootèº«ä»½ä½¿ç”¨è¿™ä¸ªå…±äº«ç›®å½•çš„æ—¶å€™ï¼Œé‚£ä¹ˆè¿™ä¸ªä½¿ç”¨è€…ï¼ˆrootï¼‰çš„æƒé™å°†è¢«å‹ç¼©æˆä¸ºåŒ¿åä½¿ç”¨è€…ï¼Œå³é€šå¸¸ä»–çš„UIDä¸GIDéƒ½ä¼šå˜æˆnobodyé‚£ä¸ªèº«ä»½all_squashï¼šä¸è®ºç™»å…¥NFSçš„ä½¿ç”¨è€…èº«ä»½ä¸ºä½•ï¼Œä»–çš„èº«ä»½éƒ½ä¼šè¢«å‹ç¼©æˆä¸ºåŒ¿åä½¿ç”¨è€…ï¼Œé€šå¸¸ä¹Ÿå°±æ˜¯nobodyå¯åŠ¨æœåŠ¡123456# å¯åŠ¨æœåŠ¡systemctl start rpcbindsystemctl start nfs# è®¾ç½®å¼€æœºå¯åŠ¨systemctl enable rpcbindsystemctl enable nfsæŸ¥çœ‹ç«¯å£å ç”¨ï¼Œä»¥ä¾¿å¼€ç€é˜²ç«å¢™çš„æ—¶å€™è®¾ç½®1rpcinfo -pæŸ¥çœ‹æœ¬æœºå…±äº«ç›®å½•123[root@uslave02 hyc]# showmount -e 192.xx.xx.23Export list for 192.xx.xx.23:/home/hyc 10.xx.xx.xx/22,192.xx.xx.xx/22ä»¥ä¸‹æ“ä½œéœ€è¦æ‰“å¼€å¯ç”¨æˆ–å…³é—­windowsåŠŸèƒ½ï¼Œå‹¾é€‰NFSå®¢æˆ·ç«¯å’Œç®¡ç†å·¥å…·ï¼Œç„¶åç¡®å®šå®‰è£…nfsæœåŠ¡é¦–å…ˆéœ€è¦åˆ°å®˜ç½‘ä¸‹è½½hanewinï¼Œæˆ‘è¿™é‡Œç”¨çš„æ˜¯NFS Server 1.2.64å®‰è£…å®Œæ¯•åæ¥åˆ°å®‰è£…ç›®å½•ï¼Œä»¥ç®¡ç†å‘˜èº«ä»½æ‰§è¡Œfirewall.batæ·»åŠ é˜²ç«å¢™è§„åˆ™æ‰“å¼€é˜²ç«å¢™ï¼Œæ£€æŸ¥å…¥ç«™è§„åˆ™ä¸­æœ‰æ²¡æœ‰hanewin å¼€å¤´çš„è¿™ä¸¤é¡¹ï¼Œè‹¥æ²¡æœ‰è¯·æ£€æŸ¥ä¸Šä¸€æ­¥æˆ–è€…è‡ªå·±æ·»åŠ ç«¯å£å·ï¼Œå‚è€ƒä¸Šæ–‡`å±€åŸŸç½‘ftpå…±äº«ï¼Œè‡ªå·±çš„è¯å°±æ˜¯æ·»åŠ 111ã€1058å’Œ2049è¿™ä¸‰ä¸ªç«¯å£å³é”®ä»¥ç®¡ç†å‘˜æ¨¡å¼è¿è¡Œæ¡Œé¢çš„nfs serverå¿«æ·æ–¹å¼ç‚¹å‡»å·¦ä¸Šè§’edit -&gt; preferences å¦‚å›¾è®¾ç½®å†æ‰“å¼€Edit -&gt; Preferences -&gt; Exports -&gt; Edit exports fileè®¾ç½®å…±äº«ç£ç›˜è·¯å¾„ï¼Œæ ¹æ®è‡ªå·±çš„æƒ…å†µæ¥ï¼Œæ¯”å¦‚å…±äº«/Hæ‰§è¡ŒæŒ‚è½½linuxæŒ‚è½½win10æŒ‚è½½ç•Œé¢æ–¹å¼win10æŒ‚è½½å‘½ä»¤è¡Œå¼€å§‹æŒ‚è½½123mkdir /mnt/datachmod 777 /mnt/datamount -t nfs 192.xx.xx.23:/home/hyc /mnt/dataå–æ¶ˆæŒ‚è½½1unmount /mnt/dataç”¨è¿™ç§æ–¹å¼æŒ‚è½½centosçš„nfsæœåŠ¡ï¼Œå¥½åƒä¼šå¡æ­»ï¼Œä¸€ç›´åœ¨åˆ·æ–°ï¼Œå¯¼è‡´èµ„æºç®¡ç†å™¨æ— å“åº”å¯ç”¨æˆ–å…³é—­windowsåŠŸèƒ½ä¸‹ï¼Œå‹¾é€‰NFSå®¢æˆ·ç«¯å’Œç®¡ç†å·¥å…·ï¼Œç„¶åç¡®å®šåœ¨æˆ‘çš„ç”µè„‘ä¸‹ï¼Œé€‰æ‹©æ˜ å°„ç½‘è·¯é©±åŠ¨å™¨ï¼Œæ·»åŠ \\192.xx.xx.23\home\hycå³å¯1234567# æŒ‚è½½C:\Users\Administrator&gt;mount 192.xx.xx.xx:/home/hyc Z:Z: ç°å·²æˆåŠŸè¿æ¥åˆ° 192.xx.xx.xx:/home/hycå‘½ä»¤å·²æˆåŠŸå®Œæˆã€‚# å–æ¶ˆæŒ‚è½½C:\Users\Administrator&gt;umount Z:</content>
	</entry>
	<entry>
		<title>KafkaåŸºæœ¬å®‰è£…ä¸ä½¿ç”¨</title>
		<url>/article/26285.html</url>
		<content>Kafkaç®€ä»‹kafkaå®˜ç½‘ä¸‹è½½åŸºæœ¬æ¦‚å¿µKafkaå®‰è£…å’Œæµ‹è¯•ä¸‹è½½kafka_2.12-2.8.0ä¸‹è½½é…ç½®zookeeper.properties1234# the directory where the snapshot is stored.dataDir=/home/huangyc/kafka_2.12-2.8.0/zk_logs# the port at which the clients will connectclientPort=2183server.properties1234567891011121314151617# The address the socket server listens on. It will get the value returned from # java.net.InetAddress.getCanonicalHostName() if not configured.#   FORMAT:#     listeners = listener_name://host_name:port#   EXAMPLE:#     listeners = PLAINTEXT://your.host.name:9092listeners=PLAINTEXT://:9092# Zookeeper connection string (see zookeeper docs for details).# This is a comma separated host:port pairs, each corresponding to a zk# server. e.g. &quot;127.0.0.1:3000,127.0.0.1:3001,127.0.0.1:3002&quot;.# You can also append an optional chroot string to the urls to specify the# root directory for all kafka znodes.zookeeper.connect=localhost:2183# A comma separated list of directories under which to store log fileslog.dirs=/home/huangyc/kafka_2.12-2.8.0/kafka_logså¯åŠ¨å¯åŠ¨zookeeper1./bin/zookeeper-server-start.sh ./config/zookeeper.propertieså¯åŠ¨kafka1./bin/kafka-server-start.sh ./config/server.propertiesæŸ¥çœ‹Kafkaè¿›ç¨‹12[root@Hmaster kafka_2.12-2.8.0]# jps | grep Kafka23425 Kafkaæµ‹è¯•æŸ¥çœ‹ä¸»é¢˜åˆ—è¡¨1bin/kafka-topics.sh --zookeeper localhost:2183 --listæ¶ˆæ¯ç”Ÿäº§è€…1bin/kafka-console-producer.sh --broker-list localhost:9092 --topic test æ¶ˆæ¯æ¶ˆè´¹è€…123bin/kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic test --from-beginning0.9ä»¥å‰ç‰ˆæœ¬: kafka-console-consumer.bat --zookeeper localhost:2183 --topic test --from-beginningå¦ä¸€å¥—æ–¹æ¡ˆserver.properties12345678910111213141516171819202122# The address the socket server listens on. It will get the value returned from # java.net.InetAddress.getCanonicalHostName() if not configured.#   FORMAT:#     listeners = listener_name://host_name:port#   EXAMPLE:#     listeners = PLAINTEXT://your.host.name:9092listeners=PLAINTEXT://:9092# Hostname and port the broker will advertise to producers and consumers. If not set, # it uses the value for &quot;listeners&quot; if configured.  Otherwise, it will use the value# returned from java.net.InetAddress.getCanonicalHostName().advertised.listeners=PLAINTEXT://192.168.123.21:9092# A comma separated list of directories under which to store log fileslog.dirs=/home/huangyc/kafka_2.12-2.8.0/kafka_logs# Zookeeper connection string (see zookeeper docs for details).# This is a comma separated host:port pairs, each corresponding to a zk# server. e.g. &quot;127.0.0.1:3000,127.0.0.1:3001,127.0.0.1:3002&quot;.# You can also append an optional chroot string to the urls to specify the# root directory for all kafka znodes.zookeeper.connect=localhost:2183æ¶ˆæ¯ç”Ÿäº§è€…1bin/kafka-console-producer.sh --broker-list localhost:9092 --topiestæ¶ˆæ¯æ¶ˆè´¹è€…1bin/kafka-console-consumer.sh --bootstrap-server 192.168.123.21:9092å…¶ä»–é—®é¢˜win10è®¿é—®éœ€è¦é…ç½®hostC:\Windows\System32\drivers\etc\hosts192.168.123.21 Hmaster1234567891011# æŸ¥çœ‹ hostname[root@Hmaster ~]# hostnamectl   Static hostname: Hmaster         Icon name: computer-desktop           Chassis: desktop        Machine ID: 87af5eaaaf7c48f6b1cd9f42bfb51c76           Boot ID: 9fe58388f3274f0e838b7cd1b720eacd  Operating System: CentOS Linux 7 (Core)       CPE OS Name: cpe:/o:centos:centos:7            Kernel: Linux 3.10.0-1160.el7.x86_64      Architecture: x86-64é˜²ç«å¢™å¼€å¯systemctl start firewalldç«¯å£å¼€å¯firewall-cmd â€”zone=public â€”add-port=9092/tcp â€”permanentç”Ÿæ•ˆfirewall-cmd â€”reload</content>
	</entry>
	<entry>
		<title>è¯­æ³•_ç®€å•å¥</title>
		<url>/article/2509a8a1.html</url>
		<content>è‹±è¯­å¥å­åŸºæœ¬ç»“æ„ä¸»è°“ç”±ä¸»è¯­å’Œè°“è¯­æ„æˆä¸€å¥è¯ï¼Œå°±å«ä¸»è°“ç»“æ„ä¾‹å­The elephant die?  å¤§è±¡æ­»äº†ä¸€å¥è¯åªæœ‰ä¸»è°“ï¼Œä¸»è¯­æ˜¯è°“è¯­çš„å‘å‡ºè¿™è¿˜ä¸å¤Ÿï¼Œè°“è¯­å¿…é¡»æœ‰æ—¶æ€æ­£ç¡®å†™æ³•ï¼šThe elephant died.ä¸»è°“å®¾åŒä¸»è°“è¡¨ä¸€èµ·è®²ä¸»è°“è¡¨ä¸»è°“å®¾å’Œä¸»è°“è¡¨çš„å…³é”®å·®åˆ«ï¼šä¸»è°“å®¾çš„è°“è¯­ä¸€å®šæ˜¯å®ä¹‰åŠ¨è¯ï¼Œå‡¡æ˜¯èƒ½å¤Ÿè¡¨è¾¾åŠ¨ä½œçš„è¯éƒ½å«å®ä¹‰åŠ¨è¯ï¼Œä¹Ÿå«è¡Œä¸ºåŠ¨è¯ä¸»è°“è¡¨çš„è°“è¯­ä¸€å®šæ˜¯ç³»åŠ¨è¯ï¼Œä¹Ÿç§°è¿ç³»åŠ¨è¯æœ‰äº›åŠ¨è¯éå¸¸ç‹¡çŒ¾ï¼Œå®ƒä»¬ä¸ä»…ä»…å¯ä»¥åšç³»åŠ¨è¯ï¼Œä¹Ÿå¯ä»¥åšå®ä¹‰åŠ¨è¯è¦æƒ³çŸ¥é“ä»¥ä¸ŠåŠ¨è¯åœ¨å¥å­ä¸­æ˜¯å®ä¹‰åŠ¨è¯è¿˜æ˜¯ç³»åŠ¨è¯ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®å¥å­çš„æ„æ€æ¥åŒºåˆ†I grew up in this small town.  æˆ‘åœ¨è¿™ä¸ªå°åŸé•‡ä¸­é•¿å¤§ã€‚ (grewä¸ºå®ä¹‰åŠ¨è¯)The sweater grew dirty. è¿™ä»¶æ¯›è¡£å˜è„äº†ã€‚ (grewä¸ºç³»åŠ¨è¯)ä¸»è°“åŒå®¾ä¸»è°“åŒå®¾å°±æ˜¯ä¸»è¯­+è°“è¯­+é—´æ¥å®¾è¯­+ç›´æ¥å®¾è¯­ä¾‹å­He teachers us English.He gave me five sugars.He bought me a birthday gift.ç¬¬ä¸€å¥ä¸­çš„usä½œé—´æ¥å®¾è¯­ï¼ŒEnglishä½œç›´æ¥å®¾è¯­ç›´æ¥å®¾è¯­ä¸ºä¸»è¦å®¾è¯­ï¼Œè¡¨ç¤ºåŠ¨ä½œæ˜¯å¯¹è°åšçš„æˆ–è€…æ˜¯ä¸ºè°åšçš„ï¼Œåœ¨å¥ä¸­ä¸å¯æˆ–ç¼ºï¼Œå¸¸å¸¸æœ‰è¡¨ç¤ºç‰©çš„åè¯æœ‰å……å½“é—´æ¥å®¾è¯­è¢«ç§°ä¸ºç¬¬äºŒå®¾è¯­ï¼Œå»æ‰ä¹‹åå¯¹æ•´ä¸ªå¥å­çš„å½±å“ä¸å¤§ï¼Œå¤šç”±æŒ‡äººçš„åè¯æˆ–ä»£è¯æ‰¿æ‹…ä¸»è°“å®¾å®¾è¡¥å®¾è¯­+è¡¥è¯­ç»Ÿç§°ä¸ºå¤åˆå®¾è¯­ï¼Œå®¾è¯­è¡¥è¶³è¯­çš„ä¸»è¦ä½œç”¨ä¸ºè¡¥å……è¯´æ˜å®¾è¯­çš„ç‰¹ç‚¹ã€èº«ä»½ï¼Œæˆ–è®©å®¾è¯­å®ŒæˆæŸä¸ªåŠ¨ä½œæ‹…ä»»è¡¥è¯­çš„å¸¸å¸¸æ˜¯åè¯ã€å½¢å®¹è¯ã€å‰¯è¯ã€ä»‹è¯çŸ­è¯­ã€åˆ†è¯ï¼ŒåŠ¨è¯ä¸å®šå¼ç­‰ï¼Œå…·ä½“ç”¨å“ªä¸€ä¸ªéœ€è¦æ ¹æ®å…·ä½“çš„æ„æ€æ¥å†³å®šå¥å­çš„æˆåˆ†å¥å­çš„ä¸»è¦æˆåˆ†å¯ä»¥åˆ†ä¸ºä¸»å¹²æˆåˆ†å’Œä¿®é¥°æˆåˆ†ä¸»å¹²æˆåˆ†ï¼šä¸»è¯­ã€è°“è¯­ã€å®¾è¯­ã€è¡¨è¯­ä¿®é¥°æˆåˆ†ï¼šåŒä½è¯­ã€å®šè¯­ã€çŠ¶è¯­ã€è¡¥è¯­èƒ½å¤Ÿå……å½“ä»¥ä¸Šå¥å­çš„æˆåˆ†ï¼Œæ€»å…±æœ‰åè¯(çŸ­è¯­)ã€ä»£è¯ã€åŠ¨è¯(è¯ç»„)ã€å½¢å®¹è¯(çŸ­è¯­)ã€å‰¯è¯(çŸ­è¯­)ã€ä»‹è¯çŸ­è¯­ã€éè°“è¯­ç»“æ„ã€ä»å¥ä¸Šè¿°è¿™äº›è¯å’ŒçŸ­è¯­èƒ½å¤Ÿåœ¨å¥ä¸­æ‰®æ¼”ä»€ä¹ˆè§’è‰²å‘¢ä¸»è¯­ï¼šåè¯(çŸ­è¯­)ã€ä»£è¯ã€éè°“è¯­ç»“æ„ã€ä»å¥è°“è¯­ï¼šåŠ¨è¯(è¯ç»„)å®¾è¯­ï¼šåè¯(çŸ­è¯­)ã€ä»£è¯ã€éè°“è¯­ç»“æ„ã€ä»å¥è¡¨è¯­ï¼šåè¯(çŸ­è¯­)ã€ä»£è¯ã€éè°“è¯­ç»“æ„ã€ä»å¥ã€å½¢å®¹è¯(çŸ­è¯­)ã€ä»‹è¯çŸ­è¯­åŒä½è¯­ï¼šåè¯(çŸ­è¯­)ã€ä»£è¯ã€éè°“è¯­ç»“æ„ã€ä»å¥å®šè¯­ï¼šåè¯(çŸ­è¯­)ã€ä»£è¯ã€éè°“è¯­ç»“æ„ã€ä»å¥ã€å½¢å®¹è¯(çŸ­è¯­)ã€ä»‹è¯çŸ­è¯­çŠ¶è¯­ï¼šå‰¯è¯(çŸ­è¯­)ã€ä»‹è¯çŸ­è¯­ã€éè°“è¯­ç»“æ„ã€ä»å¥ä¾‹å­ä»–ä¸€å¥è¯éƒ½æ²¡è¯´å°±ç¦»å¼€äº†ã€‚He left saying nothing. (åˆ†è¯ä½œçŠ¶è¯­)He left without a word. (ä»‹è¯çŸ­è¯­ä½œçŠ¶è¯­)When he left, he said nothing. (ä»å¥ä½œçŠ¶è¯­)He left decisively. (å‰¯è¯ä½œçŠ¶è¯­)å˜²ç¬‘åˆ«äººæ˜¯ä¸å¯¹çš„ã€‚Laughing at others is not right. (éè°“è¯­ç»“æ„ä½œä¸»è¯­)That you laugh at others is not right. (ä»å¥ä½œä¸»è¯­)You are not right if you laugh at others. (ä»£è¯ä½œä¸»è¯­)ä¸€ç›ç¾ä¸½ã€å¯çˆ±çš„å°æ²¹ç¯æ­£ç…§äº®é»‘æš—ã€‚A pretty and lovely lamp is brightening the darkness. (å½¢å®¹è¯çŸ­è¯­ä½œå®šè¯­)A lamp which looks pretty and lovely is brightening the darkness. (ä»å¥ä½œå®šè¯­ï¼‰A lamp looking pretty and lovely is brightening the darkness. (éè°“è¯­ç»“æ„ä½œå®šè¯­)åˆ†è¯ä½œå®šè¯­ï¼Œè™½ç„¶æ„æ€è¡¨è¾¾æ˜¯è¢«åŠ¨ï¼Œä½†æ˜¯ç³»åŠ¨è¯æ²¡æœ‰è¢«åŠ¨å½¢å¼ï¼Œæ‰€ä»¥åªèƒ½åŠ -ingé•¿æ€»ç»“é™¤äº†è°“è¯­åªèƒ½æ¥åŠ¨è¯(è¯ç»„)ï¼Œå…¶ä»–å„ä¸ªæˆåˆ†çš„è¯æ€§éƒ½å¾ˆçµæ´»ï¼Œä¸è¦æŠŠè¯­æ³•å­¦å¾—é‚£ä¹ˆæ­»æ¿ï¼Œå†™ä½œä¸­å°½é‡é¿å…é‡å¤å‡ºç°åŒæ ·çš„è¯­æ³•ç‚¹æ¯”å¦‚ä½ å‰ä¸€ä¸ªåè¯(çŸ­è¯­)å·²ç»è¡¥å……äº†å®šè¯­ä»å¥ï¼Œåé¢çš„è¿™ä¸ªåè¯(çŸ­è¯­)å°±å¯ä»¥ä½¿ç”¨å…¶ä»–è¯ä½œå®šè¯­è°“è¯­è°“è¯­æˆåˆ†è°“è¯­ä¸€å®šæ˜¯ç³»åŠ¨è¯æˆ–å®ä¹‰åŠ¨è¯(è¯ç»„)ï¼Œå¹¶ä¸”å…·æœ‰æ—¶æ€å’Œè¯­æ€æƒ…æ€åŠ¨è¯ä¸èƒ½å•ç‹¬ä½œè°“è¯­å¤šä¸ªåŠ¨è¯ä¸€å¥è¯ä¸­åªèƒ½æœ‰ä¸€ä¸ªè°“è¯­åŠ¨è¯ï¼Œä¸ä½œè°“è¯­çš„åŠ¨è¯éœ€è¦å˜ä¸ºéåŠ¨è¯ç»“æ„æŠŠä¸€ä¸ªåŠ¨è¯(è¯ç»„)å˜ä¸ºéåŠ¨è¯ç»“æ„ï¼Œæ–¹æ³•æœ‰ä»¥ä¸‹ä¸‰ç§ï¼šç°åœ¨åˆ†è¯ï¼šå¤šåœ¨å…¶ååŠ -ingï¼Œå˜ä¸ºV.ingï¼Œè¡¨ç¤ºä¸»åŠ¨æˆ–è¿›è¡Œ(ä¸»åŠ¨å±…å¤š)è¿‡å»åˆ†è¯ï¼šå¤šåœ¨å…¶ååŠ -edï¼Œå˜ä¸ºV.edï¼Œè¡¨ç¤ºè¢«åŠ¨æˆ–å®Œæˆ(è¢«åŠ¨å±…å¤š)ä¸å®šå¼ï¼šå‰é¢åŠ toï¼Œå˜ä¸ºto doï¼Œè¡¨ç¤ºç›®çš„æˆ–å°†æ¥(ç›®çš„å±…å¤š)éè°“è¯­æˆåˆ†éè°“è¯­åœ¨å¥ä¸­èƒ½ä½œé™¤è°“è¯­ä»¥å¤–çš„ä»»æ„æˆåˆ†ä¸»è¯­To finish the work by yourself is very hard.  ç‹¬è‡ªå®Œæˆè¿™é¡¹å·¥ä½œæ˜¯å¾ˆå›°éš¾çš„ã€‚To lose your heart means failure.  ç°å¿ƒæ„å‘³ç€å¤±è´¥ã€‚åŠ¨è¯ä¸å®šå¼çŸ­è¯­åšä¸»è¯­æ—¶ï¼Œå¸¸ç”¨itåšå½¢å¼ä¸»è¯­ï¼Œè€ŒæŠŠçœŸæ­£çš„ä¸»è¯­ä¸å®šå¼åç½®It is very hard to finish the work by yourself.It is means failure to lose your heart.è¡¨è¯­Her job is to look after the babies.  å¥¹çš„å·¥ä½œæ˜¯ç…§é¡¾å©´å„¿ã€‚My dream is becoming a teacher.  æˆ‘çš„æ¢¦æƒ³æ˜¯æˆä¸ºä¸€åè€å¸ˆã€‚å®¾è¯­He enjoys staying with his family.  ä»–å¾ˆå–œæ¬¢è·Ÿå®¶äººåœ¨ä¸€èµ·ã€‚I hope to see you soon.  å¸Œæœ›ä¸ä¹…èƒ½è§åˆ°ä½ ã€‚å®šè¯­He found a good house to live in.  ä»–æ‰¾åˆ°äº†ä¸€ä¸ªé€‚åˆå±…ä½çš„å¥½æˆ¿å­ã€‚In the following years he worked even harder.  åœ¨åæ¥çš„å‡ å¹´ä¸­ï¼Œä»–å­¦ä¹ æ›´åŠªåŠ›äº†ã€‚çŠ¶è¯­He worked day and night to get the money.  ä¸ºäº†èµšé’±ï¼Œä»–å¤œä»¥ç»§æ—¥åœ°å·¥ä½œã€‚Seeing the thief walk into the room, he called the police.  çœ‹åˆ°å°å·èµ°è¿›æˆ¿é—´ï¼Œä»–æŠ¥äº†è­¦ã€‚åŒä½è¯­His habit, eating snack before sleeping, has not been changed.  ä»–ç¡å‰åƒé›¶é£Ÿçš„ä¹ æƒ¯è¿˜æ²¡æ”¹ã€‚ä¸€å¥è¯ä¸­å¦‚ä½•ç¡®å®šå“ªä¸ªä½œè°“è¯­ï¼Œå“ªä¸ªä½œéè°“è¯­ï¼Ÿå¥å­ä¸»è¦æƒ³è¡¨è¾¾å“ªä¸ªåŠ¨ä½œï¼Œå°±ç•™å“ªä¸ªåŠ¨ä½œä½œè°“è¯­ã€‚ä¸€èˆ¬è·Ÿåœ¨ä¸»è¯­åé¢çš„å°±æ˜¯ä¸»è¦åŠ¨ä½œï¼Œå‰©ä¸‹çš„éƒ½å˜æˆéè°“è¯­å°ç»“è°“è¯­å¿…é¡»æ˜¯å®ä¹‰åŠ¨è¯(è¯ç»„)æˆ–ç³»åŠ¨è¯ï¼Œå¹¶ä¸”å¿…é¡»æœ‰æ—¶æ€å’Œè¯­æ€ä¸€å¥è¯ä¸­åŠ¨è¯(è¯ç»„)æœ‰ä¸”åªèƒ½æœ‰ä¸€ä¸ªï¼Œå¤šä½™çš„å˜æˆéè°“è¯­ç»“æ„ï¼Œå°‘äº†çš„å°±åŠ beåŠ¨è¯ä¸»è¯­ä¸»è¯­æˆåˆ†I am a teacher.My job is to teach English.Helping you learn English well is my task.èƒ½ä½œä¸»è¯­çš„æˆåˆ†ï¼Œä»ä¸Šé¢ä¾‹å­ä¸­èƒ½å¤Ÿçœ‹å‡ºæœ‰ä»£è¯ã€åè¯(çŸ­è¯­)ã€éè°“è¯­ç»“æ„å’Œä»å¥è‹±è¯­ä¸­ä¸èƒ½æ²¡æœ‰ä¸»è¯­ï¼Œä¸­æ–‡å¥å­å¾ˆå¤šæ—¶å€™æ²¡æœ‰ä¸»è¯­ï¼Œç¿»è¯‘æˆè‹±æ–‡æ˜¯åº”è¯¥æ€ä¹ˆåŠï¼Ÿitä½œä¸»è¯­å¤–é¢å¾ˆçƒ­ã€‚æ­¤æ—¶çš„é‡åº†å¾ˆå†·ã€‚é›¨ä¸€ç›´åœ¨ä¸‹ã€‚è¿™ä¸‰å¥è¯çš„å…±åŒç‚¹æ˜¯å®ƒä»¬éƒ½å’Œå¤©æ°”ã€æ¸©åº¦æœ‰å…³ç³»ã€‚æ‰€ä»¥æ­¤æ—¶å°±ç”¨itä½œä¸»è¯­ã€‚å¯¹åº”è‹±æ–‡ç¿»è¯‘æˆï¼šIt is hot outside.It is cold in Chongqing now.It is raining.there beå¥å‹äºŒå¸ˆå…„çš„å¤´ä¸Šæœ‰æœµèŠ±ã€‚æœ‰å¾ˆå¤šäººå–œæ¬¢æˆ‘ã€‚æœ‰å¾ˆå¤šåŸå› èƒ½è§£é‡Šæˆ‘çš„è§‚ç‚¹ã€‚å…±åŒç‚¹æ˜¯ï¼šéƒ½æœ‰â€œæœ‰â€å­—éƒ½æ²¡æœ‰ä¸»è¯­æ³¨æ„ä¸è¦è®¤ä¸ºç¬¬ä¸€å¥è¯æœ‰ä¸»è¯­ã€‚ç¬¬ä¸€å¥è¯on the head of the second brother ä¸èƒ½ä½œä¸»è¯­ï¼Œå› ä¸ºå®ƒæ˜¯ä»‹è¯çŸ­è¯­ã€‚ä½¿ç”¨There beå¥å‹çš„å‰æä¸æ˜¯æŸå¤„æœ‰æŸç‰©ï¼Œåªè¦æ»¡è¶³ä»¥ä¸Šä¸¤ä¸ªæ¡ä»¶éƒ½å¯ä»¥ä½¿ç”¨è¯¥å¥å‹ï¼Œä¸Šé¢ä¸‰å¥è¯çš„æ­£ç¡®ç¿»è¯‘ä¸ºï¼šThere is a flower on the head of the second brother.There are loads of individuals having affection for me.There are numerous factors accounting for my perspective.ä¸»åŠ¨å˜è¢«åŠ¨è§£å†³æ— ä¸»è¯­çš„ç¬¬ä¸‰ä¸ªæ–¹æ³•ï¼šå˜ä¸»åŠ¨ä¸ºè¢«åŠ¨å¿…é¡»æŒ‡å‡ºè¯­æ³•åœ¨è€ƒç ”ä¸­è¿˜æ˜¯ç›¸å½“é‡è¦çš„ã€‚è¯¥å¥ç¿»è¯‘æˆï¼šGrammar must be pointed out to be quite crucial in the examination of postgraduates.ä½œæ–‡ä¸­ä¸ä½†æ— ä¸»è¯­çš„å¥å­å¯ä»¥æ”¹ä¸ºè¢«åŠ¨ï¼Œä¸€èˆ¬äººç§°ä»£è¯ä½œä¸»è¯­çš„å¥å­ä¹Ÿå¯ä»¥å†™æˆè¢«åŠ¨å®¾è¯­å®¾è¯­çš„æˆåˆ†ï¼šI love you.I love Liu Xiang.I love singing songs.å¦‚æœæ­¤å¤„å…ˆæš‚æ—¶å¿½ç•¥ä»å¥ï¼Œèƒ½ä½œå®¾è¯­çš„æˆåˆ†å’Œä¸»è¯­å®Œå…¨ä¸€æ ·ï¼šä»£è¯ã€åè¯(çŸ­è¯­)å’Œéè°“è¯­ç»“æ„è¡¨è¯­è¡¨è¯­çš„æˆåˆ†ï¼šItâ€™s me.I am a teacher.I am in Chongqing.I am beautiful.My dream is to become a poet.My dream is becoming a poet.ä»ä¸Šé¢çš„ä¾‹å­ä¸­å¯ä»¥çœ‹å‡ºï¼Œèƒ½ä½œè¡¨è¯­çš„æˆåˆ†æœ‰ï¼šä»£è¯ã€åè¯(çŸ­è¯­)ã€éè°“è¯­ç»“æ„ã€å½¢å®¹è¯(çŸ­è¯­)å’Œä»‹è¯çŸ­è¯­æ¯”å®¾è¯­å¤šäº†å½¢å®¹è¯(çŸ­è¯­)å’Œä»‹è¯çŸ­è¯­æ—¶æ€å’Œè¯­æ€p15</content>
	</entry>
	<entry>
		<title>è¯­æ³•_å¹¶åˆ—å¥</title>
		<url>/article/d4db6f86.html</url>
		<content>å¹¶åˆ—å¥å®šä¹‰é¦–å…ˆä¸¾ä¸ªä¾‹å­ï¼Œå¼•å‡ºå¹¶åˆ—å¥ï¼šI love you,you love that dog.æ˜¾ç„¶ä¸èƒ½ç›´æ¥ç”¨é€—å·è¿æ¥ä¸¤å¥è¯ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œé€—å·å‰ååªèƒ½æ˜¯ä¸€ä¸ªå¥å­ï¼Œä¸èƒ½æ˜¯ä¸¤ä¸ªå¥å­é‚£å¦‚æœéå¾—è®©é€—å·å‰åæ˜¯ä¸¤ä¸ªå¥å­æ€ä¹ˆåŠå‘¢ï¼Ÿæ–¹æ³•æœ‰äºŒï¼šåŠ å…¥å¹¶åˆ—è¿è¯è¿æ¥ä¸¤ä¸ªåˆ†å¥ï¼Œé‚£å°±æ˜¯ï¼šI love you but you love that dog.å°†å…¶ä¸­çš„ä¸€ä¸ªå¥å­å˜æˆä»å¥ï¼Œé‚£å°±æ˜¯ï¼šAlthough I love you,you love that dog.è‹±è¯­ä¸­ä¸èƒ½ç›´æ¥ç”¨é€—å·è¿æ¥ä¸¤ä¸ªå¥å­ï¼Œå¦‚æœæˆ‘ä»¬æƒ³åœ¨å¥å­ä¹‹é—´ç”¨é€—å·ï¼Œå°±éœ€è¦ä¸€ä¸ªä¸œè¥¿çš„å­˜åœ¨ï¼Œé‚£å°±æ˜¯å¹¶åˆ—è¿è¯æ‰€ä»¥è¯´ï¼šå¹¶åˆ—å¥å°±æ˜¯ç”±å¹¶åˆ—è¿è¯è¿æ¥çš„ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„å¥å­ï¼Œè¿™ä¸ªå¥å­å¯ä»¥æ˜¯ç®€å•å¥ï¼Œä¹Ÿå¯ä»¥æ˜¯ä»å¥ä¾‹å­He always takes everything seriously,so he can achieve success effortlessly.ä»–åšä»»ä½•äº‹æƒ…ä¸€ç›´éƒ½å¾ˆè®¤çœŸï¼Œå› æ­¤æˆåŠŸå¯¹ä»–æ¥è¯´æ˜¯è½»è€Œæ˜“ä¸¾çš„ã€è§£æã€‘soæ˜¯å¹¶åˆ—è¿è¯ï¼Œè¡¨ç¤ºå› æœå…³ç³»ï¼Œè¿æ¥çš„å¥å­æ˜¯ä¸¤ä¸ªç®€å•å¥As you are trapped in a dilemma,those who donâ€™t understand you and who donâ€™t accompany you will not deserve your love.åœ¨ä½ å¤„å¢ƒå›°éš¾æ—¶ï¼Œé‚£äº›ä¸ç†è§£ä½ çš„äººå’ŒæŠ›å¼ƒä½ çš„äººä¸é…æ‹¥æœ‰ä½ çš„çˆ±ã€è§£æã€‘ä¸»å¥ä¸­çš„å¹¶åˆ—è¿è¯andè¿æ¥äº†ä¸¤ä¸ªç”±whoå¼•å¯¼çš„å®šè¯­ä»å¥ï¼Œè¡¨ç¤ºå¹³è¡Œå…³ç³»å¹¶åˆ—è¿è¯å’Œé€»è¾‘å…³ç³»è¯å¸¸è§è¿è¯å’Œå‰¯è¯å¸¸è§çš„å¹¶åˆ—è¿è¯å¹³è¡Œå…³ç³»(å¹¶ä¸”ã€è€Œä¸”)ï¼šand, both â€¦ and, either â€¦ or, neither â€¦ norç­‰è½¬æŠ˜å…³ç³»(ç„¶è€Œã€ä½†æ˜¯)ï¼šbut, while, yet, whereasç­‰é€‰æ‹©å…³ç³»(æˆ–è€…ã€è¦ä¹ˆ)ï¼šor, whether â€¦ or, either â€¦ or â€¦ç­‰å› æœå…³ç³»(å› ä¸ºã€æ‰€ä»¥)ï¼šforï¼Œsoç­‰é€’è¿›å…³ç³»(ç„¶åã€å†è€…)ï¼šnot only â€¦ but also, thenç­‰å…¶å®çœ‹åˆ°è¿™å„¿ï¼Œå¤§å®¶ä¼šæœ‰äº›ç–‘æƒ‘ï¼Œé‚£äº›ç†Ÿæ‚‰çš„è¯æ€ä¹ˆæ²¡æœ‰å‡ºç°ï¼Ÿæ¯”å¦‚è¯´however, therefore, thusç­‰ï¼Œè¿™äº›å•è¯åœ¨å®é™…è¿ç”¨ä¸­ï¼Œç»å¸¸å……å½“å‰¯è¯ï¼Œè€Œä¸æ˜¯è¿è¯é‚£ä¹ˆï¼Œå¸¸è§çš„è¡¨ç¤ºé€»è¾‘å…³ç³»çš„å‰¯è¯æˆ–ä»‹è¯çŸ­è¯­æœ‰å“ªäº›ï¼Ÿä¸å¹¶åˆ—è¿è¯åŒä¹‰çš„é€»è¾‘å…³ç³»è¯å¹³è¡Œå…³ç³»ï¼š* å‰¯è¯ï¼šsimilarly, equally, likewiseç­‰ä»‹è¯çŸ­è¯­ï¼šat the same time, in the meanwhileç­‰è½¬æŠ˜å…³ç³»ï¼šå‰¯è¯ï¼šhowever, nevertheless, nonetheless, conversely, contrarily, unexpectedly, unfortunatelyç­‰ä»‹è¯çŸ­è¯­ï¼šon the contrary, in/by contrastç­‰é€‰æ‹©å…³ç³»ï¼š* å‰¯è¯ï¼šalternativelyç­‰å› æœå…³ç³»ï¼šå‰¯è¯ï¼štherefore, thus, consequentlyç­‰ã€‚ä»‹è¯çŸ­è¯­ï¼šas a result, as a consequenceç­‰é€’è¿›å…³ç³»ï¼šå‰¯è¯ï¼šbesides, additionally, subsequentlyç­‰ä»‹è¯çŸ­è¯­ï¼šin additionç­‰è¿è¯å’Œå‰¯è¯çš„åŒºåˆ«ä½¿ç”¨è¿è¯æ—¶ï¼Œå¯ä»¥åŠ é€—å·ï¼Œä¹Ÿå¯ä»¥ä¸åŠ I love you, but you love my money.æˆ– I love you but you love my money.ä½¿ç”¨å‰¯è¯æˆ–ä»‹è¯çŸ­è¯­æ—¶ï¼Œå¿…é¡»æŠŠé€—å·å˜å¥å·ï¼Œæˆ–è€…æ˜¯åœ¨å‰¯è¯æˆ–ä»‹è¯çŸ­è¯­å‰åŠ è¿è¯ andI love you. However you love my money.æˆ– I love you, and however you love my money.ä¾‹å­å¤©ç©ºæ²¡æœ‰ç—•è¿¹ï¼Œä½†æ˜¯é¸Ÿå„¿å·²ç»é£è¿‡ã€‚There were no trails in the sky, but the birds had flown away.There were no trails in the sky, and conversely the birds had flown away.å¾ˆå¤šäººäº«å—ç€ç”µè„‘å’Œç½‘ç»œæ‰€å¸¦æ¥çš„å¿«ä¹å’Œä¾¿åˆ©ï¼Œç„¶è€Œå®ƒä»¬å·²ç»æ”¹å˜äº†æˆ‘ä»¬çš„ç”Ÿæ´»æ–¹å¼ å¹¶å¼•èµ·äº†å¾ˆå¤šé—®é¢˜ã€‚Many people enjoy the pleasure and convenience of using the computer and Internet, yet they have changed our lifestyle and caused a lot of problems.Many people enjoy the pleasure and convenience of using the computer and Internet.On the contrary they have changed our lifestyle and caused a lot of problems.è¿™å¹…ç”»å¼•äººæ·±æ€ï¼Œå¹¶ä¸”å®ƒæç»˜å’Œæƒ³è¦è¡¨è¾¾çš„æ˜¯å½“ä»Šç¤¾ä¼šçš„ä¸€ç§æ™®éç°è±¡ã€‚The picture is thought-provoking, and what it illustrates and tries to convey is a common phenomenon in contemporary society.The picture is thought-provoking. Also what it illustrates and tries to convey is a common phenomenon in contemporary society.å¾ˆå¤šäººéƒ½æƒ³ä¸åŠ³è€Œè·ï¼Œä½†ä¹Ÿè®¸ä»–ä»¬å¿½ç•¥äº†å‡¡äº‹éƒ½æœ‰ä»£ä»·ã€‚A host of people desire to achieve what they want without any work, whereas they may just ignore that no act comes without a sacrifice.A host of people desire to achieve what they want without any work. Nonetheless they may just ignore that no act comes without a sacrifice.å¹¶åˆ—å¥åŸåˆ™å¯¹ç§°åŸåˆ™è¯æ€§å¯¹ç§°å¹¶åˆ—è¿è¯å‰åçš„è¯æ€§ã€å•å¤æ•°ã€æ—¶æ€å’Œè¯­æ€ç­‰å¿…é¡»ä¸€è‡´ï¼Œé€šä¿—æ¥è¯´ï¼Œè¿è¯å‰æ˜¯ä»€ä¹ˆï¼Œè¿è¯åä¹Ÿè¦æ˜¯ä»€ä¹ˆè¿è¯è¿æ¥ä¸‰ä¸ªæˆ–è€…ä¸‰ä¸ªä»¥ä¸Šçš„è¯æ—¶ï¼Œå‰é¢çš„è¯ä¹‹é—´ç”¨é€—å·éš”å¼€ï¼Œåªéœ€è¦åœ¨æœ€åä¸€ä¸ªè¯å‰åŠ å¹¶åˆ—è¿è¯He went shopping, bought some gifts and visited his old friend.ä»–å»è´­ç‰©äº†ï¼Œä¹°äº†äº›ç¤¼ç‰©å¹¶ä¸”æ‹œè®¿äº†ä»–çš„è€æœ‹å‹ã€è§£æã€‘è¿™æ˜¯ç”±è¿è¯andè¿æ¥çš„ä¸‰ä¸ªåŠ¨ä½œï¼Œå‰ä¸¤ä¸ªåŠ¨ä½œç”¨é€—å·éš”å¼€ï¼Œåœ¨æœ€åä¸€ä¸ªåŠ¨ä½œå‰ç”¨andå³å¯å¹¶ä¸”æ ¹æ®å¯¹ç§°åŸåˆ™ï¼Œè¿è¯å‰åçš„æ—¶æ€å¿…é¡»ä¸€è‡´ï¼Œç¬¬ä¸€ä¸ªåŠ¨ä½œæ˜¯wentï¼Œæ˜¯åŠ¨è¯çš„è¿‡å»å¼ï¼Œé‚£ä¹ˆè¿è¯åä¹Ÿå¿…é¡»æ˜¯åŠ¨è¯çš„è¿‡å»å¼ï¼Œå³boughtï¼ŒvisitedHe is an ambitious and positive student.ä»–æ˜¯ä¸€ä¸ªç§¯æå‘ä¸Šã€å¿—å‘è¿œå¤§çš„å­¦ç”Ÿã€è§£æã€‘å¹¶åˆ—è¿è¯and å‰æ˜¯å½¢å®¹è¯ï¼Œåé¢ä¹Ÿæ˜¯å½¢å®¹è¯Humans can learn languages by making mistakes and correcting them.äººç±»å¯ä»¥é€šè¿‡çŠ¯é”™å’Œä¿®æ­£é”™è¯¯æ¥å­¦ä¹ è¯­è¨€ã€è§£æã€‘å¹¶åˆ—è¿è¯andçš„å‰é¢æ˜¯åŠ¨è¯çš„-ingå½¢å¼ï¼Œåé¢ä¹Ÿå¿…é¡»æ˜¯-ingå½¢å¼ç»“æ„å¯¹ç§°è¿è¯æ‰€è¿æ¥çš„å¥å­ç»“æ„è¦ä¿æŒä¸€è‡´çœç•¥ç°è±¡çœç•¥çš„æˆåˆ†è‹±è¯­è®²ç©¶ç»“æ„ç¾ï¼Œå¼ºè°ƒè¯­æ³•å’Œå¥æ³•çš„å®Œæ•´æ€§å’Œåˆç†æ€§ï¼Œå› æ­¤è‹±è¯­å¥å­ä¸­æœ‰ä¸€ä¸ªå¥æ³•åŸåˆ™ï¼Œå«ä½œé¿å…é‡å¤åŸåˆ™åœ¨å¹¶åˆ—å¥ä¸­ï¼Œè¯­æ³•ä¸Šçš„è¦æ±‚æ˜¯å¥å­å‰åå¯¹ç§°ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæœ‰æ—¶å€™ä¼šåœ¨ç»“æ„å’Œå†…å®¹ä¸Šå‡ºç°é‡å¤å› æ­¤ï¼Œä¸ºäº†ä½¿å¾—å¥å¼ä¼˜ç¾ï¼Œä¸€èˆ¬å¹¶åˆ—å¥åé¢çš„å¥å­è¦çœç•¥æ‰é‡å¤çš„å†…å®¹ï¼Œè¿™æ ·å°±å‡ºç°äº†å¹¶åˆ—å¥çš„çœç•¥è™½ç„¶çœç•¥äº†é‡å¤çš„å†…å®¹ï¼Œä½†æ˜¯è¿è¯ä¸¤è¾¹çš„ç»“æ„ä¾ç„¶æ˜¯å¯¹ç§°å’Œå¹³è¡¡çš„åŸºäºä»¥ä¸Šæ‰€è¯´ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹ï¼Œå¹¶åˆ—å¥çš„çœç•¥ä¸€èˆ¬ä¼šçœç•¥ä»€ä¹ˆæˆåˆ†çœç•¥ä¸»è°“ï¼šå¹¶åˆ—è¿è¯åçš„ä¸»è°“å’Œå‰é¢çš„ä¸»è°“ä¸€è‡´ï¼Œå¯ä»¥å°†åé¢çš„çœç•¥He is not only a nice teacher in class but a nice friend to his students in private.ä»–åœ¨è¯¾å ‚ä¸Šæ˜¯ä¸€ä¸ªå¥½è€å¸ˆï¼Œåœ¨ç§åº•ä¸‹æ˜¯å­¦ç”Ÿä»¬çš„å¥½æœ‹å‹ã€‚ã€è§£æã€‘å¹¶åˆ—è¿è¯æ˜¯butï¼Œå¹¶åˆ—å¥è¦æ±‚å¯¹ç§°åŸåˆ™ï¼Œä½†æ˜¯åœ¨butçš„åé¢åªæœ‰è¡¨è¯­ a nice friendï¼Œè¿è¯åçš„ä¸»è°“åº”å’Œå‰é¢ä¸€è‡´ï¼Œå¾ˆæ˜æ˜¾è¿™å¥è¯åé¢çœç•¥äº†ä¸»è°“ he isçœç•¥beåŠ¨è¯ï¼šå¹¶åˆ—å¥å‰åä¸»è¯­ä¸åŒï¼Œä½†æ˜¯å‡ ä¸ªå¥å­æœ‰ç›¸åŒçš„beåŠ¨è¯ï¼Œé‚£ä¹ˆæ­¤æ—¶å¯ä»¥çœç•¥beåŠ¨è¯Failing hips can be replaced,clinical depression controlled,and cataracts removed in a 30-minute surgical procedure.é«‹éª¨åäº†å¯ä»¥æ›´æ¢ï¼Œä¸´åºŠå¿§éƒç—‡å¯ä»¥å¾—åˆ°æ§åˆ¶ï¼Œç™½å†…éšœä»…ç”¨30åˆ†é’Ÿæ‰‹æœ¯ä¾¿å¯ä»¥åˆ‡é™¤ã€‚ã€è§£æã€‘ç”±å¹¶åˆ—è¿è¯andè¿æ¥äº†ä¸‰å¥è¯ï¼Œè¿™ä¸‰å¥è¯çš„ä¸»è¯­åˆ†åˆ«æ˜¯ï¼šfailing hipsï¼Œclinical depressionï¼Œcataractså¹¶åˆ—å¥å‰åä¸»è¯­ä¸åŒï¼Œä½†è°“è¯­åŠ¨è¯éƒ½æ˜¯beåŠ¨è¯ï¼Œæ­¤æ—¶å¯ä»¥å°†beåŠ¨è¯çœç•¥çœç•¥ä¸»è¯­ï¼šè¿è¯åçš„ä¸»è¯­ä¸å‰é¢çš„ä¸»è¯­ä¸€æ ·æ—¶å¯ä»¥çœç•¥He is rich,but leads a modest life.ä»–è™½ç„¶å¾ˆå¯Œæœ‰ï¼Œä½†ä¾ç„¶è¿‡ç€èŠ‚ä¿­çš„ç”Ÿæ´»ã€‚ã€è§£æã€‘ç”±å¹¶åˆ—è¿è¯butè¿æ¥çš„ä¸¤å¥è¯ï¼Œä¸»è¯­éƒ½æ˜¯heã€‚è¿è¯åçš„ä¸»è¯­ä¸å‰é¢çš„ä¸»è¯­ä¸€æ ·æ—¶ï¼Œå¯ä»¥å°†è¿è¯åçš„ä¸»è¯­çœç•¥çœç•¥é‡å¤çš„æˆåˆ†ï¼šå¦‚æœå¹¶åˆ—å¥ä¸­å‰åä¸¤ä¸ªå¥å­å‡ºç°é‡å¤çš„éƒ¨åˆ†ï¼Œé‚£ä¹ˆåä¸€ä¸ªå¥å­å¯ä»¥çœç•¥é‡å¤çš„éƒ¨åˆ†ï¼Œä½†æ˜¯æ²¡é‡å¤çš„éƒ¨åˆ†è¦ä¿ç•™ã€‚(è¿™ä¸ªæˆåˆ†å¯ä»¥æ˜¯çŸ­è¯­ï¼Œä¹Ÿå¯ä»¥æ˜¯å¥å­ã€‚)Do you still remember all those years when scientists argued that smoking would kill us but the doubters insisted that we did not know for sure?ä½ è¿˜è®°å¾—å—ï¼Ÿé‚£äº›å¹´ç§‘å­¦å®¶è¯´å¸çƒŸä¼šè‡´å‘½ï¼Œä½†æ€€ç–‘è€…åšæŒè¯´æˆ‘ä»¬å¹¶ä¸ç¡®å®šå¸çƒŸæ˜¯å¦çœŸçš„ä¼šè‡´å‘½ã€‚ã€è§£æã€‘ç”±å¹¶åˆ—è¿è¯butè¿æ¥çš„ä¸¤ä¸ªç”±thatå¼•å¯¼çš„å®¾è¯­ä»å¥ï¼Œå‰é¢çš„ä¸»è°“æ˜¯scientists arguedï¼Œå®¾è¯­æ˜¯thatä»å¥ã€‚åé¢å¥å­ä¸­knowçš„å®¾è¯­å…¶å®æ˜¯smoking would kill usï¼Œä¸å‰é¢çš„å¥å­çš„å®¾è¯­ä¸€æ ·ï¼Œå› æ­¤çœç•¥äº†å®¾è¯­ã€‚è¡¥å……å®Œæ•´å°±æ˜¯ï¼šDo you still remember all those years when scientists argued that smoking would kill us but the doubters insisted that we did not know ( smoking would kill us) for sure?æŸ¥æ‰¾çœç•¥çœç•¥æ˜¯è‹±è¯­ä¸­å¸¸è§çš„è¯­æ³•ç°è±¡ï¼Œå¯ä»¥ä½¿å¥å­è¡¨è¾¾ç®€æ´ï¼Œä½†åœ¨åˆ†æå¥å­çš„è¯­æ³•ç»“æ„æ—¶å¾€å¾€ä¼šç»™æˆ‘ä»¬é€ æˆç†è§£çš„éšœç¢å”¯ä¸€çš„è§£å†³åŠæ³•å°±æ˜¯è¯†ç ´å…¶çœŸé¢ç›®ï¼Œæ‰¾åˆ°å¥å­çœç•¥çš„å†…å®¹ä¾‹å­I was beaten and you too.è¿™å¥è¯å¦‚æœç›´æ¥ç¿»è¯‘ï¼Œé‚£ä¹ˆç»“æœæ˜¯ï¼šæˆ‘æŒ¨æ‰“äº†ï¼Œä½ ä¹Ÿã€‚æ˜¯ä¸æ˜¯è§‰å¾—å¥å­ä¸å®Œæ•´ï¼Ÿè¿™å°±æ˜¯æ‰¾å¹¶åˆ—è¿è¯çš„åŸå› æ‰€åœ¨ä¸€â€”æœ‰å¹¶åˆ—è¿è¯å‡ºç°çš„åœ°æ–¹ï¼Œé€šå¸¸ä¼šæœ‰çœç•¥ç¿»è¯‘çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæŠŠçœç•¥çš„éƒ¨åˆ†è¡¥å……ä¸Šç„¶åå†ç¿»è¯‘æœ¬å¥è¯è¡¥å……å®Œæ•´åå°±æ˜¯ï¼šI was beaten and you were beaten too.  (æˆ‘æŒ¨æ‰“äº†ï¼Œä½ ä¹ŸæŒ¨æ‰“äº†ã€‚ï¼‰ä¸‹é¢æˆ‘ä»¬çš„ä»»åŠ¡å°±æ˜¯å­¦ä¼šå¦‚ä½•æŸ¥æ‰¾çœç•¥çš„å†…å®¹ã€‚ä»¥ä¸‹æ˜¯ä¸‰ç‚¹æ€»ç»“ï¼šä¸€å¥è¯åªè¦æœ‰çœç•¥å°±ä¸€å®šä¼šçœç•¥åˆ°å¹¶åˆ—è¿è¯çš„åé¢æ‰€ä»¥å¹¶åˆ—è¿è¯åé¢æœ‰çš„æˆåˆ†å¹¶åˆ—è¿è¯å‰é¢é€šå¸¸éƒ½è¦æœ‰å¹¶åˆ—è¿è¯å‰é¢æœ‰ï¼Œè€Œå¹¶åˆ—è¿è¯åé¢æ²¡æœ‰çš„æˆåˆ†ä¾¿æ˜¯çœç•¥çš„å†…å®¹</content>
	</entry>
	<entry>
		<title>è¯­æ³•_åè¯æ€§ä»å¥</title>
		<url>/article/be621570.html</url>
		<content>åè¯èƒ½åšçš„æˆåˆ†ç”¨æˆ‘ä»¬å¤§å®¶ç†ŸçŸ¥çš„ç”µå½±Forrest Gumpæ¥ä¸¾å‡ ä¸ªä¾‹å­ï¼šThe movie is so moving and encouraging.I appreciate his mother.Gump is a real man.I enjoy the part,the warm end.è¿™å››å¥è¯ä¸­ï¼Œåè¯çŸ­è¯­åˆ†åˆ«ä½œä¸»è¯­ã€å®¾è¯­ã€è¡¨è¯­ã€åŒä½è¯­å’Œåè¯(çŸ­è¯­)è¿™é‡Œéœ€è¦è§£é‡Šä¸€ä¸‹åŒä½è¯­ï¼Œä½¿ç”¨åŒä½è¯­åˆ™è¯´æ˜å‰åä¸¤éƒ¨åˆ†æŒ‡çš„æ˜¯åŒä¸€ä¸ªä¸œè¥¿æ¯”å¦‚ï¼šæˆ‘çˆ±æˆ‘çš„å¥³æœ‹å‹â€”â€”ç‹å¤§ä¾ ã€‚å†å¦‚ï¼šæˆ‘ä»¬â€”â€”æ–°æ—¶ä»£çš„å¤§å­¦ç”Ÿï¼Œåº”è¯¥å¿§å›½å¿§æ°‘ã€‚ä¹Ÿå°±æ˜¯è¯´ä¸¤ä¸ªåè¯(çŸ­è¯­)æŒ‡çš„æ˜¯åŒä¸€ä¸ªä¸œè¥¿ï¼Œäº‹å®ä¸Šï¼Œåœ¨ä½œæ–‡ä¸­åªè¦å‡ºç°åè¯(çŸ­è¯­)ï¼Œéƒ½å¯ä»¥è¯•å›¾åŠ å¦å¤–ä¸€ä¸ªåè¯(çŸ­è¯­)ä½œå®ƒçš„åŒä½è¯­ï¼Œä½†æ˜¯å‰åè¦ç”¨é€—å·æˆ–ç ´æŠ˜å·éš”å¼€ä¾‹å­English is playing a key role in our communicating with others.åŠ ä¸ŠåŒä½è¯­çš„æ•ˆæœæ˜¯ï¼šEnglish, a worldwide language, is playing a key role in our communicating with others.A boy writes the name of Beckham on his face. (2006å¹´è€ƒç ”å†™ä½œçœŸé¢˜)åŠ ä¸ŠåŒä½è¯­çš„æ•ˆæœæ˜¯ï¼šA boy-a crazy football fan-writes the name of Beckham, quite a well-known superstar, on his face.åè¯æ€§ä»å¥ä»å¥å®šä¹‰è¿™åœ¨ç®€å•å¥ä¸­å°±å·²ç»æœ‰æ‰€æç¤ºï¼Œä»å¥å°±æ˜¯å¼•å¯¼è¯+åˆ†å¥ï¼Œä¹Ÿå°±æ˜¯è¯´å¼•å¯¼è¯+ä¸»è¯­+è°“è¯­å®ƒå’Œä¸€ä¸ªç®€å•å¥çš„åŒºåˆ«æ˜¯ï¼Œå‰é¢åŠ äº†ä¸€ä¸ªå«ä½œå¼•å¯¼è¯çš„ä¸œè¥¿(æ¯”å¦‚that, who, where, whenå‡ä¸ºå¼•å¯¼è¯)åè¯æ€§ä»å¥æˆ‘ä»¬å…ˆç»†çœ‹ä¸‹ï¼Œä¸‹é¢çš„å››å¥è¯å’Œå‰æ–‡çš„å››å¥è¯æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚What I saw repeatedly is so moving and encouraging.I appreciate what his mother said.Gump is who we should learn from.I enjoy the part that a feather is flying in the sky.æ˜¾è€Œæ˜“è§ï¼Œåœ¨å‰æ–‡çš„å››å¥è¯ä¸­ï¼Œåè¯çŸ­è¯­åˆ†åˆ«ä½œä¸»è¯­ã€å®¾è¯­ã€è¡¨è¯­å’ŒåŒä½è¯­ï¼›è€Œè¿™å››å¥è¯ä¸­ï¼Œåˆ™ç”¨ä»å¥(å¼•å¯¼è¯+ä¸»è¯­+è°“è¯­)å……å½“äº†åè¯çŸ­è¯­æœ¬æ¥å……å½“çš„æˆåˆ†ä»å¥ä½œä¸»è¯­ï¼Œå°±æ˜¯ä¸»è¯­ä»å¥ï¼›åŒæ ·ï¼Œä»å¥ä½œå®¾è¯­ï¼Œå°±æ˜¯å®¾è¯­ä»å¥ï¼›ä»å¥ä½œè¡¨è¯­ï¼Œå°±æ˜¯è¡¨è¯­ä»å¥ï¼›ä»å¥ä½œåŒä½è¯­ï¼Œå°±æ˜¯åŒä½è¯­ä»å¥æ‰€ä»¥ï¼Œåè¯æ€§ä»å¥å°±æ˜¯åè¯(çŸ­è¯­)èƒ½å¤Ÿå……å½“çš„æˆåˆ†ï¼Œä»å¥ä¹Ÿèƒ½å……å½“ã€‚å®ƒä¸€å…±åŒ…æ‹¬å››ç±»ï¼šä¸»è¯­ä»å¥å®¾è¯­ä»å¥è¡¨è¯­ä»å¥åŒä½è¯­ä»å¥å¼•å¯¼è¯æˆ‘çˆ±ä½ æ˜¯æˆ‘çš„é”™ã€‚I love you is my fault.I love youè¿™ä¸ªå®Œæ•´çš„å¥å­èƒ½åœ¨å¦å¤–ä¸€ä¸ªå¥å­é‡Œä½œä¸»è¯­å—ï¼Ÿå½“ç„¶ä¸èƒ½ï¼Œåªæœ‰ä»å¥æ‰èƒ½åœ¨å¦å¤–ä¸€ä¸ªå¥å­é‡Œé¢å……å½“æˆåˆ†ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨I love youå‰åŠ ä¸ªå¼•å¯¼è¯ï¼ŒæŠŠå®ƒå˜æˆä»å¥ä¸€ä¸ªå®Œæ•´çš„å¥å­åœ¨å¦å¤–ä¸€ä¸ªå¥å­ä¸­æ˜¯ä¸èƒ½ä½œä»»ä½•æˆåˆ†çš„ï¼Œå¦‚æœæƒ³è®©ä¸€ä¸ªå¥å­åœ¨å¦å¤–ä¸€ä¸ªå¥å­ä¸­ä½œæˆåˆ†ï¼Œå°±å¿…é¡»åœ¨å®ƒå‰é¢åŠ ä¸Šå¼•å¯¼è¯ï¼Œå˜æˆä»å¥ä½ çˆ±æˆ‘å—æ˜¯æ˜¾è€Œæ˜“è§çš„ã€‚Do you love me is obvious.è¿™å¥è¯å’Œä¸Šå¥æ˜¯åŒæ ·çš„é”™è¯¯ï¼Œä¸€ä¸ªå¥å­åœ¨å¦å¤–ä¸€ä¸ªå¥å­ä¸­ä¸èƒ½ä½œä¸»è¯­ï¼ŒåŒæ ·çš„è§£å†³åŠæ³•ï¼šåŠ å¼•å¯¼è¯ä½ çˆ±è°çœŸæ˜¯ä¸€ä¸ªç§˜å¯†ã€‚Who do you love is really a secret.å‡­ä½ é‚£ä¹ˆå¤šå¹´æ‰€è°“çš„è¯­æ„Ÿï¼ŒWhoåº”è¯¥æ˜¯ä¸ªå¼•å¯¼è¯ï¼Œå®é™…ä¸Šå¹¶ä¸æ˜¯åè¯æ€§ä»å¥çš„å¼•å¯¼è¯å°±æ˜¯æŒ‰ç…§ä»å¥çš„ç±»å‹æ¥åˆ’åˆ†ï¼Œä¸€å…±åˆ†æˆä¸‰ç±»é™ˆè¿°å¥: æˆ‘çˆ±ä½ ã€‚ä¸€èˆ¬ç–‘é—®å¥: ä½ çˆ±æˆ‘å—ï¼Ÿç‰¹æ®Šç–‘é—®å¥: ä½ çˆ±è°ï¼Ÿ1ï¼‰that: å½“ä»å¥æ˜¯é™ˆè¿°å¥æ—¶ã€‚éœ€è¦æ³¨æ„çš„æ˜¯thatåœ¨ä»å¥ä¸­ä¸å……å½“æˆåˆ†ï¼Œä¹Ÿæ²¡æœ‰å®ä¹‰ã€‚åœ¨ä¸å½±å“å¥å­æ„æ€çš„æƒ…å†µä¸‹ï¼Œå®¾è¯­ä»å¥çš„å¼•å¯¼è¯thatå¯ä»¥çœç•¥2ï¼‰whether/ifå½“ä»å¥æ˜¯ä¸€èˆ¬ç–‘é—®å¥æ—¶ã€‚whether/ifåœ¨ä»å¥ä¸­ä¸å……å½“æˆåˆ†ï¼Œä½†æ„æ€ä¸ºâ€œæ˜¯å¦â€éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸¤ä¸ªå¼•å¯¼è¯ä¸­åªæœ‰whetherå¯ä»¥å¼•å¯¼æ‰€æœ‰çš„åè¯æ€§ä»å¥ï¼Œè€Œifåªèƒ½å¼•å¯¼å®¾è¯­ä»å¥3ï¼‰ç‰¹æ®Šç–‘é—®è¯ï¼šå½“ä»å¥æ˜¯ç‰¹æ®Šç–‘é—®å¥æ—¶ã€‚å¸¸è§çš„è¿æ¥å‰¯è¯æœ‰ï¼šwhenï¼Œwhereï¼Œwhyï¼Œhowï¼›å¸¸è§çš„è¿æ¥ä»£è¯æœ‰ï¼šwhoï¼Œwhomï¼Œwhat,whichï¼Œwhoseï¼Œå¹¶ä¸”è¿™äº›ç‰¹æ®Šç–‘é—®è¯ä¸€èˆ¬éƒ½æœ‰å›ºå®šçš„æ„æ€ï¼Œä¸èƒ½çœç•¥æ‰€æœ‰çš„ä»å¥ï¼ŒåŒ…æ‹¬åé¢å®šè¯­ä»å¥ã€çŠ¶è¯­ä»å¥ï¼Œéƒ½åº”è¯¥æ˜¯é™ˆè¿°å¥çš„è¯­åºï¼Œä¹Ÿå°±æ˜¯â€å¼•å¯¼è¯+ä¸»è¯­+è°“è¯­â€çš„é¡ºåºä»å¥è¯¦è§£ä¸»è¯­ä»å¥å¥¹æˆåŠŸåœ°æ‰¾åˆ°äº†æœ‹å‹ï¼Œè¿™ä½¿æˆ‘å¾ˆé«˜å…´ã€‚That she succeeded in finding a friend makes me happy.è¯»ä¹¦çš„ç›®çš„æ˜¯æ¶¤è¡æˆ‘ä»¬çš„çµé­‚ï¼Œè¿™æ˜¯æ¯‹åº¸ç½®ç–‘çš„ã€‚That reading is to purify our minds is beyond dispute.ä¸Šè¿°å¥å­æ˜¯ä¸æ˜¯ç»™äººå¤´é‡è„šè½»çš„æ„Ÿè§‰?äºæ˜¯è‹±è¯­ä¸­é€šå¸¸æŠŠä¸»è¯­ä»å¥æ”¾åˆ°å¥æœ«ï¼Œ ç”¨itä½œå½¢å¼ä¸»è¯­ï¼Œç»“æœå°±æ˜¯ï¼šIt makes me happy that she succeeded in finding a friend.It is beyond dispute that reading is to purify our minds.ä¸»è¯­ä»å¥çš„æ»¡åˆ†è¡¨è¾¾å°±æ˜¯itä½œå½¢å¼ä¸»è¯­It is common knowledge that â€¦  â€¦æ˜¯ä¸€ä¸ªå¸¸è¯†It is my belief that â€¦ = I think that â€¦  æˆ‘è®¤ä¸ºâ€¦It is self-evident that â€¦  â€¦æ˜¯æ˜¾è€Œæ˜“è§çš„It has been found that â€¦ äººä»¬å·²ç»å‘ç°â€¦It is beyond dispute that â€¦ â€¦æ˜¯æ¯‹åº¸ç½®ç–‘çš„It is universally acknowledged that â€¦ äººä»¬æ™®éè®¤ä¸º/ä¼—æ‰€å‘¨çŸ¥â€¦It has been widely accepted that â€¦   äººä»¬æ™®éè®¤ä¸º/ä¼—æ‰€å‘¨çŸ¥â€¦It is generally agreed that â€¦  äººä»¬æ™®éè®¤ä¸º/ä¼—æ‰€å‘¨çŸ¥â€¦ä¸ä»…ä»…æ˜¯åœ¨ä»å¥ä½œä¸»è¯­æ—¶ï¼Œå¯ä»¥ç”¨itä½œå½¢å¼ä¸»è¯­ï¼Œå½“ä¸å®šå¼ï¼ˆçŸ­è¯­ï¼‰ã€åŠ¨åè¯ï¼ˆçŸ­è¯­ï¼‰åœ¨å¥å­ä¸­ä½œä¸»è¯­æ—¶ï¼Œä¸ºäº†ä¿æŒå¥å­ç»“æ„å¹³è¡¡ï¼Œé¿å…å¥å¼ç»“æ„æ··ä¹±ï¼Œä¹Ÿå¸¸ç”¨itä½œå½¢å¼ä¸»è¯­ï¼Œè€Œå°†çœŸæ­£çš„ä¸»è¯­æ”¾åœ¨å¥å°¾æ­¤æ—¶tä»åªèµ·å…ˆè¡Œå¼•å¯¼ä½œç”¨ï¼Œæœ¬èº«æ— è¯ä¹‰ã€‚æ¦‚æ‹¬èµ·æ¥å¸¸è§çš„æƒ…å†µå¦‚ä¸‹ï¼šIt+is+adj./n.+to do sth.It is a good idea to think in this way.  ç”¨è¿™ç§æ–¹å¼æ€è€ƒæ˜¯ä¸ªå¥½åŠæ³•ã€‚It is indispensable to train ourselves before any examination.  åœ¨è€ƒè¯•å‰å¥½å¥½è®­ç»ƒè‡ªå·±æ˜¯å¾ˆé‡è¦çš„ã€‚It is so kind of him to help his classmates in need.  ä»–å¾ˆå–„è‰¯ï¼Œæ€»æ˜¯å¸®åŠ©éœ€è¦å¸®åŠ©çš„åŒå­¦ã€‚It+v.+to do sth.It took us 3 hours to finish the homework.  æˆ‘ä»¬èŠ±äº†ä¸‰ä¸ªå°æ—¶æ¥å®Œæˆè¿™ä»½ä½œä¸šã€‚It happens to me to come across her on the way home.  æˆ‘ç¢°å·§åœ¨å›å®¶çš„è·¯ä¸Šé‡è§äº†å¥¹ã€‚Itâ€™s+adj./n.+doing sth.   åœ¨itä½œå½¢å¼ä¸»è¯­çš„å¥å‹ä¸­ï¼ŒåŠ¨åè¯ä½œä¸»è¯­ä¸€èˆ¬ç”¨åœ¨no good,wasteï¼Œuselessï¼Œno useï¼Œ dangerous ç­‰è¯åIt is useless doing that.  é‚£æ ·åšæ˜¯æ²¡ç”¨çš„ã€‚It is no good playing games in bed on weekends.  å‘¨æœ«èººåœ¨åºŠä¸Šæ‰“æ¸¸æˆæ˜¯æ²¡æœ‰ä»€ä¹ˆå¥½å¤„çš„ã€‚It is dangerous staying with wild animals including tigers and lions.  å’Œè€è™ã€ç‹®å­è¿™æ ·çš„é‡ç”Ÿ åŠ¨ç‰©å¾…åœ¨ä¸€èµ·æ˜¯å¾ˆå±é™©çš„ã€‚åŒä½è¯­ä»å¥æ²¡æœ‰äººä¼šæ— ç¼˜æ— æ•…å°±å˜å¾—ä¼˜ç§€ï¼Œè¿™ä¸ªäº‹å®æ€»æ˜¯è¢«å¾ˆå¤šäººå¿½ç•¥ã€‚è¿™å¥è¯ä¸­ï¼Œæ˜¾ç„¶â€æ²¡æœ‰äººä¼šæ— ç¼˜æ— æ•…å°±å˜å¾—ä¼˜ç§€â€å’Œâ€è¿™ä¸ªäº‹å®â€æ˜¯åŒä½è¯­ï¼Œå®ƒä»¬æŒ‡å‘ä¸€è‡´ä½†æ˜¯è‹±æ–‡å’Œæ±‰è¯­ä¸åŒï¼Œåœ¨è‹±æ–‡ä¸­ï¼Œå½“ä¸€ä¸ªåè¯(çŸ­è¯­)æˆ–ä»å¥æ˜¯åŒä½è¯­æ—¶ï¼Œåº”è¯¥å†™åœ¨å®ƒæ‰€è¦è§£é‡Šè¯´æ˜çš„åè¯(çŸ­è¯­)ä¹‹åå…¶é¡ºåºä¹Ÿå°±æ˜¯â€åè¯(çŸ­è¯­)+å¼•å¯¼è¯+ä»å¥â€ï¼Œ(åŒä½è¯­ä»å¥æ”¾åœ¨å¥æœ«)ã€ç¿»è¯‘ã€‘The truth that nobody can become brilliant without endeavors is ignored by a sea of men.æˆ– The truth is ignored by a sea of men that nobody can become brilliant without endeavors.æ²¡æœ‰ä»€ä¹ˆèƒ½å¤Ÿæ©ç›–å¥¹æ­£åœ¨å˜è€è¿™ä¸ªäº‹å®ã€‚åŒæ ·ï¼Œâ€å¥¹æ­£åœ¨å˜è€â€å’Œâ€è¿™ä¸ªäº‹å®â€æ˜¯åŒä½è¯­ï¼Œåº”è¯¥å…ˆå†™åè¯(çŸ­è¯­)å†å†™ä»å¥ï¼Œå…¶ä»–éƒ¨åˆ†è¯¥æ˜¯ä»€ä¹ˆé¡ºåºå°±æ˜¯ä»€ä¹ˆé¡ºåºã€‚ã€ç¿»è¯‘ã€‘Nothing can hide the truth that she is growing old.å¾ˆå¤šå¥³ç”Ÿéƒ½ç©¿ä¸Šäº†æ¼‚äº®çš„è£™å­è¿™ä¸ªäº‹å®è¡¨æ˜å¤å¤©å·²ç»æ¥äº†ã€‚è¿™ä¸ªå¥å­ä¸­æœ‰ä¸¤ä¸ªä»å¥ï¼Œç¬¬ä¸€ä¸ªæ˜¯åŒä½è¯­ä»å¥ï¼Œç¬¬äºŒä¸ªæ˜¯å®¾è¯­ä»å¥ã€‚ã€ç¿»è¯‘ã€‘The evidence that many girls have worn attractive skirts manifests that summer is coming.ç§‘å­¦å®¶ä»¬å·²ç»å¾—å‡ºç»“è®ºï¼šåœ°çƒä¸Šçš„æ¸©åº¦å°†ä¼šå˜å¾—è¶Šæ¥è¶Šé«˜ã€‚ä¸»å¥æ˜¯ä¸»è°“å®¾ç»“æ„ï¼Œå®¾è¯­æ˜¯â€ç»“è®ºâ€ï¼Œç»“è®ºåè·Ÿäº†ä¸€ä¸ªä»å¥æ¥è§£é‡Šè¿™ä¸ªç»“è®ºçš„å†…å®¹ï¼Œå³åŒä½è¯­ä»å¥ã€‚ã€ç¿»è¯‘ã€‘Scientists have reached the conclusion that the temperature on earth will get higher and higher.åŒä½è¯­ä»å¥çš„æ»¡åˆ†è¡¨è¾¾å°±æ˜¯:The evidence/truth that..manifests/indicates/suggests that.. ï¼Œç¿»è¯‘æˆæ±‰è¯­å°±æ˜¯ï¼šâ€¦â€¦è¿™ä¸ªäº‹å®è¡¨æ˜â€¦â€¦ æ¯”å¦‚ï¼šå¥¹é•¿ç€ä¸€åŒå¤§çœ¼ç›è¿™ä¸ªäº‹å®è¡¨æ˜å¥¹æ˜¯ä¸€ä¸ªç¾å¥³ã€‚The evidence that she has a pair of big eyes manifests that she is really a beauty.</content>
	</entry>
	<entry>
		<title>è¯­æ³•_ç‰¹æ®Šç»“æ„</title>
		<url>/article/b80bb25bce.html</url>
		<content>æµ‹è¯•</content>
	</entry>
	<entry>
		<title>IDEå¿«æ·é”®</title>
		<url>/article/7978bafd.html</url>
		<content>å‚è€ƒ: https://mp.weixin.qq.com/s/r70Q0eqy5-R1CrwihREeQAï¼ˆIntelliJ IDEA å¿«æ·é”®ç»ˆæå¤§å…¨ï¼Œé€Ÿåº¦æ”¶è—ï¼ï¼‰è‡ªåŠ¨ä»£ç å¸¸ç”¨çš„æœ‰fori/sout/psvm+Tabå³å¯ç”Ÿæˆå¾ªç¯ã€System.outã€mainæ–¹æ³•ç­‰boilerplateæ ·æ¿ä»£ç  ã€‚ä¾‹å¦‚è¦è¾“å…¥for(User user : users)åªéœ€è¾“å…¥user.for+Tab ï¼›å†æ¯”å¦‚ï¼Œè¦è¾“å…¥Date birthday = user.getBirthday()åªéœ€è¾“å…¥user.getBirthday().var+Tabå³å¯ã€‚ä»£ç æ ‡ç­¾è¾“å…¥å®Œæˆåï¼ŒæŒ‰Tabï¼Œç”Ÿæˆä»£ç ã€‚123456789101112131415161718192021222324&gt;Ctrl+Alt+O ä¼˜åŒ–å¯¼å…¥çš„ç±»å’ŒåŒ… &gt;Alt+Insert ç”Ÿæˆä»£ç (å¦‚get,setæ–¹æ³•,æ„é€ å‡½æ•°ç­‰)   æˆ–è€…å³é”®ï¼ˆGenerateï¼‰ &gt;fori/sout/psvm + Tab  &gt;Ctrl+Alt+T  ç”Ÿæˆtry catch  æˆ–è€… Alt+enter &gt;CTRL+ALT+T  æŠŠé€‰ä¸­çš„ä»£ç æ”¾åœ¨ TRY{} IF{} ELSE{} é‡Œ &gt;Ctrl + O é‡å†™æ–¹æ³•  &gt;Ctrl + I å®ç°æ–¹æ³• &gt;Ctr+shift+U å¤§å°å†™è½¬åŒ–  &gt;ALT+å›è½¦    å¯¼å…¥åŒ…,è‡ªåŠ¨ä¿®æ­£  &gt;ALT+/       ä»£ç æç¤º &gt;CTRL+J      è‡ªåŠ¨ä»£ç   &gt;Ctrl+Shift+Jï¼Œæ•´åˆä¸¤è¡Œä¸ºä¸€è¡Œ &gt;CTRL+ç©ºæ ¼   ä»£ç æç¤º  &gt;CTRL+SHIFT+SPACE è‡ªåŠ¨è¡¥å…¨ä»£ç   &gt;CTRL+ALT+L  æ ¼å¼åŒ–ä»£ç   &gt;CTRL+ALT+I  è‡ªåŠ¨ç¼©è¿›  &gt;CTRL+ALT+O  ä¼˜åŒ–å¯¼å…¥çš„ç±»å’ŒåŒ…  &gt;ALT+INSERT  ç”Ÿæˆä»£ç (å¦‚GET,SETæ–¹æ³•,æ„é€ å‡½æ•°ç­‰)  &gt;CTRL+E      æœ€è¿‘æ›´æ”¹çš„ä»£ç   &gt;CTRL+ALT+SPACE  ç±»åæˆ–æ¥å£åæç¤º  &gt;CTRL+P   æ–¹æ³•å‚æ•°æç¤º  &gt;CTRL+Qï¼Œå¯ä»¥çœ‹åˆ°å½“å‰æ–¹æ³•çš„å£°æ˜ &gt;Shift+F6  é‡æ„-é‡å‘½å (åŒ…ã€ç±»ã€æ–¹æ³•ã€å˜é‡ã€ç”šè‡³æ³¨é‡Šç­‰) &gt;Ctrl+Alt+V æå–å˜é‡ æŸ¥è¯¢å¿«æ·é”®123456789101112131415161718192021222324252627282930313233343536373839404142Ctrlï¼‹Shiftï¼‹Backspaceå¯ä»¥è·³è½¬åˆ°ä¸Šæ¬¡ç¼–è¾‘çš„åœ° CTRL+ALT+ left/right å‰åå¯¼èˆªç¼–è¾‘è¿‡çš„åœ°æ–¹ ALT+7  é å·¦çª—å£æ˜¾ç¤ºå½“å‰æ–‡ä»¶çš„ç»“æ„ Ctrl+F12 æµ®åŠ¨æ˜¾ç¤ºå½“å‰æ–‡ä»¶çš„ç»“æ„ ALT+F7 æ‰¾åˆ°ä½ çš„å‡½æ•°æˆ–è€…å˜é‡æˆ–è€…ç±»çš„æ‰€æœ‰å¼•ç”¨åˆ°çš„åœ°æ–¹ CTRL+ALT+F7  æ‰¾åˆ°ä½ çš„å‡½æ•°æˆ–è€…å˜é‡æˆ–è€…ç±»çš„æ‰€æœ‰å¼•ç”¨åˆ°çš„åœ°æ–¹ Ctrl+Shift+Alt+N æŸ¥æ‰¾ç±»ä¸­çš„æ–¹æ³•æˆ–å˜é‡ åŒå‡»SHIFT åœ¨é¡¹ç›®çš„æ‰€æœ‰ç›®å½•æŸ¥æ‰¾æ–‡ä»¶ Ctrl+N   æŸ¥æ‰¾ç±» Ctrl+Shift+N æŸ¥æ‰¾æ–‡ä»¶ CTRL+G   å®šä½è¡Œ  CTRL+F   åœ¨å½“å‰çª—å£æŸ¥æ‰¾æ–‡æœ¬  CTRL+SHIFT+F  åœ¨æŒ‡å®šçª—å£æŸ¥æ‰¾æ–‡æœ¬  CTRL+R   åœ¨ å½“å‰çª—å£æ›¿æ¢æ–‡æœ¬  CTRL+SHIFT+R  åœ¨æŒ‡å®šçª—å£æ›¿æ¢æ–‡æœ¬  ALT+SHIFT+C  æŸ¥æ‰¾ä¿®æ”¹çš„æ–‡ä»¶  CTRL+E   æœ€è¿‘æ‰“å¼€çš„æ–‡ä»¶  F3   å‘ä¸‹æŸ¥æ‰¾å…³é”®å­—å‡ºç°ä½ç½®  SHIFT+F3  å‘ä¸Šä¸€ä¸ªå…³é”®å­—å‡ºç°ä½ç½®  é€‰ä¸­æ–‡æœ¬ï¼ŒæŒ‰Alt+F3 ï¼Œé«˜äº®ç›¸åŒæ–‡æœ¬ï¼ŒF3é€ä¸ªå¾€ä¸‹æŸ¥æ‰¾ç›¸åŒæ–‡æœ¬ F4   æŸ¥æ‰¾å˜é‡æ¥æº  CTRL+SHIFT+O  å¼¹å‡ºæ˜¾ç¤ºæŸ¥æ‰¾å†…å®¹ Ctrl+W é€‰ä¸­ä»£ç ï¼Œè¿ç»­æŒ‰ä¼šæœ‰å…¶ä»–æ•ˆæœ F2 æˆ–Shift+F2 é«˜äº®é”™è¯¯æˆ–è­¦å‘Šå¿«é€Ÿå®šä½ Ctrl+Up/Down å…‰æ ‡è·³è½¬åˆ°ç¬¬ä¸€è¡Œæˆ–æœ€åä¸€è¡Œä¸‹ Ctrl+B å¿«é€Ÿæ‰“å¼€å…‰æ ‡å¤„çš„ç±»æˆ–æ–¹æ³•  CTRL+ALT+B  æ‰¾æ‰€æœ‰çš„å­ç±»  CTRL+SHIFT+B  æ‰¾å˜é‡çš„ç±»  Ctrl+Shift+ä¸Šä¸‹é”®  ä¸Šä¸‹ç§»åŠ¨ä»£ç  Ctrl+Alt+ left/right è¿”å›è‡³ä¸Šæ¬¡æµè§ˆçš„ä½ç½® Ctrl+X åˆ é™¤è¡Œ Ctrl+D å¤åˆ¶è¡Œ Ctrl+/ æˆ– Ctrl+Shift+/  æ³¨é‡Šï¼ˆ// æˆ–è€…/*...*/ ï¼‰ Ctrl+H æ˜¾ç¤ºç±»ç»“æ„å›¾ Ctrl+Q æ˜¾ç¤ºæ³¨é‡Šæ–‡æ¡£ Alt+F1 æŸ¥æ‰¾ä»£ç æ‰€åœ¨ä½ç½® Alt+1 å¿«é€Ÿæ‰“å¼€æˆ–éšè—å·¥ç¨‹é¢æ¿ Alt+ left/right åˆ‡æ¢ä»£ç è§†å›¾ ALT+ â†‘/â†“  åœ¨æ–¹æ³•é—´å¿«é€Ÿç§»åŠ¨å®šä½  CTRL+ALT+ left/right å‰åå¯¼èˆªç¼–è¾‘è¿‡çš„åœ°æ–¹ Ctrlï¼‹Shiftï¼‹Backspaceå¯ä»¥è·³è½¬åˆ°ä¸Šæ¬¡ç¼–è¾‘çš„åœ° Alt+6    æŸ¥æ‰¾TODO å…¶ä»–å¿«æ·é”®12345678910SHIFT+ENTER å¦èµ·ä¸€è¡Œ CTRL+Z   å€’é€€(æ’¤é”€) CTRL+SHIFT+Z  å‘å‰(å–æ¶ˆæ’¤é”€) CTRL+ALT+F12  èµ„æºç®¡ç†å™¨æ‰“å¼€æ–‡ä»¶å¤¹  ALT+F1   æŸ¥æ‰¾æ–‡ä»¶æ‰€åœ¨ç›®å½•ä½ç½®  SHIFT+ALT+INSERT ç«–ç¼–è¾‘æ¨¡å¼  CTRL+F4  å…³é—­å½“å‰çª—å£ Ctrl+Alt+Vï¼Œå¯ä»¥å¼•å…¥å˜é‡ã€‚ä¾‹å¦‚ï¼šnew String(); è‡ªåŠ¨å¯¼å…¥å˜é‡å®šä¹‰ Ctrl+~ï¼Œå¿«é€Ÿåˆ‡æ¢æ–¹æ¡ˆï¼ˆç•Œé¢å¤–è§‚ã€ä»£ç é£æ ¼ã€å¿«æ·é”®æ˜ å°„ç­‰èœå•ï¼‰ svnå¿«æ·é”®12ctrl+k æäº¤ä»£ç åˆ°SVN ctrl+t æ›´æ–°ä»£ç  è°ƒè¯•å¿«æ·é”®å…¶å®å¸¸ç”¨çš„ å°±æ˜¯F8 F7 F9 æœ€å€¼å¾—ä¸€æçš„å°±æ˜¯Drop Frame å¯ä»¥è®©è¿è¡Œè¿‡çš„ä»£ç ä»å¤´å†æ¥ã€‚æ¨èï¼šIntellij IDEA Debug è°ƒè¯•æŠ€å·§ã€‚12345678910111213141516alt+F8    debugæ—¶é€‰ä¸­æŸ¥çœ‹å€¼ Alt+Shift+F9ï¼Œé€‰æ‹© Debug Alt+Shift+F10ï¼Œé€‰æ‹© Run Ctrl+Shift+F9ï¼Œç¼–è¯‘ Ctrl+Shift+F8ï¼ŒæŸ¥çœ‹æ–­ç‚¹ F7ï¼Œæ­¥å…¥ Shift+F7ï¼Œæ™ºèƒ½æ­¥å…¥ Alt+Shift+F7ï¼Œå¼ºåˆ¶æ­¥å…¥ F8ï¼Œæ­¥è¿‡ Shift+F8ï¼Œæ­¥å‡º Alt+Shift+F8ï¼Œå¼ºåˆ¶æ­¥è¿‡ Alt+F9ï¼Œè¿è¡Œè‡³å…‰æ ‡å¤„ Ctrl+Alt+F9ï¼Œå¼ºåˆ¶è¿è¡Œè‡³å…‰æ ‡å¤„ F9ï¼Œæ¢å¤ç¨‹åº Alt+F10ï¼Œå®šä½åˆ°æ–­ç‚¹ é‡æ„123456Ctrl+Alt+Shift+Tï¼Œå¼¹å‡ºé‡æ„èœå• Shift+F6ï¼Œé‡å‘½å F6ï¼Œç§»åŠ¨ F5ï¼Œå¤åˆ¶ Alt+Deleteï¼Œå®‰å…¨åˆ é™¤ Ctrl+Alt+Nï¼Œå†…è” IDEAå¼‚å¸¸å¤„ç†idea æºå‘è¡Œç‰ˆ 8 éœ€è¦ç›®æ ‡å‘è¡Œç‰ˆ 1.81ï¼ŒProject Structureé‡Œç¡®è®¤ä¸¤ä¸ªåœ°æ–¹:Project sdkä»¥åŠproject language level2ï¼ŒProject Structure-&gt;Modulesé‡ŒSourcesé‡Œçš„Language level3ï¼Œsettings-&gt;java Compiler -&gt;target bytecode Versionè¿™äº›ä¸ªåœ°æ–¹éœ€è¦ä¸€è‡´ã€‚åå¤§Intellij IDEAå¿«æ·é”®Intellij IDEAä¸­æœ‰å¾ˆå¤šå¿«æ·é”®è®©äººçˆ±ä¸é‡Šæ‰‹ï¼Œstackoverflowä¸Šä¹Ÿæœ‰ä¸€äº›æœ‰è¶£çš„è®¨è®ºã€‚æ¯ä¸ªäººéƒ½æœ‰è‡ªå·±çš„æœ€çˆ±ï¼Œæƒ³æ’å‡ºä¸ªç†æƒ³çš„æ¦œå•è¿˜çœŸæ˜¯å›°éš¾ã€‚ ä»¥å‰ä¹Ÿæ•´ç†è¿‡Intellijçš„å¿«æ·é”®ï¼Œè¿™æ¬¡å°±æŒ‰ç…§æˆ‘æ—¥å¸¸å¼€å‘æ—¶çš„ä½¿ç”¨é¢‘ç‡ï¼Œç®€å•åˆ†ç±»åˆ—ä¸€ä¸‹æˆ‘æœ€å–œæ¬¢çš„åå¤§å¿«æ·-ç¥-é”®å§ã€‚ æ™ºèƒ½æç¤ºIntellijé¦–å½“å…¶å†²çš„å½“ç„¶å°±æ˜¯Intelligenceæ™ºèƒ½ï¼åŸºæœ¬çš„ä»£ç æç¤ºç”¨Ctrl+Spaceï¼Œè¿˜æœ‰æ›´æ™ºèƒ½åœ°æŒ‰ç±»å‹ä¿¡æ¯æç¤ºCtrl+Shift+Spaceï¼Œä½†å› ä¸ºIntellijæ€»æ˜¯éšç€æˆ‘ä»¬æ•²å‡»è€Œè‡ªåŠ¨æç¤ºï¼Œæ‰€ä»¥å¾ˆå¤šæ—¶å€™éƒ½ä¸ä¼šæ‰‹åŠ¨æ•²è¿™ä¸¤ä¸ªå¿«æ·é”®(é™¤éæç¤ºæ¡†æ¶ˆå¤±äº†)ã€‚æ¨èï¼šIntellij Ideaéå¸¸6çš„10ä¸ªå§¿åŠ¿ï¼ç”¨F2/ Shift+F2ç§»åŠ¨åˆ°æœ‰é”™è¯¯çš„ä»£ç ï¼ŒAlt+Enterå¿«é€Ÿä¿®å¤(å³Eclipseä¸­çš„Quick FixåŠŸèƒ½)ã€‚å½“æ™ºèƒ½æç¤ºä¸ºæˆ‘ä»¬è‡ªåŠ¨è¡¥å…¨æ–¹æ³•åæ—¶ï¼Œæˆ‘ä»¬é€šå¸¸è¦è‡ªå·±è¡¥ä¸Šè¡Œå°¾çš„åæ‹¬å·å’Œåˆ†å·ï¼Œå½“æ‹¬å·åµŒå¥—å¾ˆå¤šå±‚æ—¶ä¼šå¾ˆéº»çƒ¦ï¼Œè¿™æ—¶æˆ‘ä»¬åªéœ€æ•²Ctrl+Shift+Enterå°±èƒ½è‡ªåŠ¨è¡¥å…¨æœ«å°¾çš„å­—ç¬¦ã€‚è€Œä¸”ä¸åªæ˜¯æ‹¬å·ï¼Œä¾‹å¦‚æ•²å®Œif/foræ—¶ä¹Ÿå¯ä»¥è‡ªåŠ¨è¡¥ä¸Š{}èŠ±æ‹¬å·ã€‚ æœ€åè¦è¯´ä¸€ç‚¹ï¼ŒIntellijèƒ½å¤Ÿæ™ºèƒ½æ„ŸçŸ¥Springã€Hibernateç­‰ä¸»æµæ¡†æ¶çš„é…ç½®æ–‡ä»¶å’Œç±»ï¼Œä»¥é™åˆ¶åŠ¨ï¼Œåœ¨çœ‹ä¼¼â€œé™æ€â€çš„å¤–è¡¨ä¸‹ï¼Œæ™ºèƒ½åœ°æ‰«æç†è§£ä½ çš„é¡¹ç›®æ˜¯å¦‚ä½•æ„é€ å’Œé…ç½®çš„ã€‚ é‡æ„Intellijé‡æ„æ˜¯å¦ä¸€å®Œçˆ†Eclipseçš„åŠŸèƒ½ï¼Œå…¶æ™ºèƒ½ç¨‹åº¦ä»¤äººç ç›®ç»“èˆŒï¼Œæ¯”å¦‚æå–å˜é‡æ—¶è‡ªåŠ¨æ£€æŸ¥åˆ°æ‰€æœ‰åŒ¹é…åŒæ—¶æå–æˆä¸€ä¸ªå˜é‡ç­‰ã€‚å°¤å…¶çœ‹è¿‡ã€Šé‡æ„-æ”¹å–„æ—¢æœ‰ä»£ç è®¾è®¡ã€‹ä¹‹åï¼Œæœ‰äº†Intellijçš„é…åˆç®€ç›´æ˜¯ä»¤äººå¤§å‘¼è¿‡ç˜¾ï¼ä¹Ÿæ­£æ˜¯å¼ºå¤§çš„æ™ºèƒ½å’Œé‡æ„åŠŸèƒ½ï¼Œä½¿Intellijä¸‹çš„TDDå¼€å‘éå¸¸é¡ºç•…ã€‚æ¨èï¼š Intellij IDEA é‚£äº›éšè—å¥½ç”¨çš„å°æŠ€å·§åˆ‡å…¥æ­£é¢˜ï¼Œå…ˆè¯´ä¸€ä¸ªæ— æ•Œçš„é‡æ„åŠŸèƒ½å¤§æ±‡æ€»å¿«æ·é”®Ctrl+Shift+Alt+Tï¼Œå«åšRefactor Thisã€‚æŒ‰æ³•æœ‰ç‚¹å¤æ‚ï¼Œä½†ä¹Ÿç¬¦åˆIntellijçš„é£æ ¼ï¼Œå¾ˆå¤šå¿«æ·é”®éƒ½è¦åŒæ‰‹å®Œæˆï¼Œè€Œä¸åƒEclipseä¸å°‘æœ€æœ‰ç”¨çš„å¿«æ·é”®å¯ä»¥æ½‡æ´’åœ°å•æ‰‹å®Œæˆ(ä¸çŸ¥é“ç®—ä¸ç®—Eclipseçš„ä¸€å¤§ä¼˜ç‚¹)ï¼Œä½†å„ä½ç”¨è¿‡Emacsçš„è¯å°±ä¼šè§‰å¾—ä¹Ÿæ²¡ä»€ä¹ˆäº†(éEmacsé»‘)ã€‚æ­¤å¤–ï¼Œè¿˜æœ‰äº›æœ€å¸¸ç”¨çš„é‡æ„æŠ€å·§ï¼Œå› ä¸ºå¤ªå¸¸ç”¨äº†ï¼Œè‹¥æ¯æ¬¡éƒ½åœ¨Refactor Thisèœå•é‡Œé€‰çš„è¯æ•ˆç‡æœ‰äº›ä½ã€‚æ¯”å¦‚Shift+F6ç›´æ¥å°±æ˜¯æ”¹åï¼ŒCtrl+Alt+Våˆ™æ˜¯æå–å˜é‡ã€‚å…³æ³¨JavaæŠ€æœ¯æ ˆå¾®ä¿¡å…¬ä¼—å·ï¼Œåœ¨åå°å›å¤å…³é”®å­—ï¼šIDEAï¼Œå¯ä»¥è·å–ä¸€ä»½æ ˆé•¿æ•´ç†çš„ IDEA æœ€æ–°æŠ€æœ¯å¹²è´§ã€‚ ä»£ç ç”Ÿæˆè¿™ä¸€ç‚¹ç±»ä¼¼Eclipseï¼Œè™½ä¸æ˜¯ç‹¬åˆ°ä¹‹å¤„ï¼Œä½†å› ä¸ºæ—¥å¸¸ä½¿ç”¨é¢‘ç‡æé«˜ï¼Œæ‰€ä»¥è¿˜æ˜¯ç½—åˆ—åœ¨æ¦œå•å‰é¢ã€‚å¸¸ç”¨çš„æœ‰fori/sout/psvm+Tabå³å¯ç”Ÿæˆå¾ªç¯ã€System.outã€mainæ–¹æ³•ç­‰boilerplateæ ·æ¿ä»£ç ï¼Œç”¨Ctrl+Jå¯ä»¥æŸ¥çœ‹æ‰€æœ‰æ¨¡æ¿ã€‚åé¢â€œè¾…åŠ©â€ä¸€èŠ‚ä¸­å°†ä¼šè®²åˆ°Alt+Insertï¼Œåœ¨ç¼–è¾‘çª—å£ä¸­ç‚¹å‡»å¯ä»¥ç”Ÿæˆæ„é€ å‡½æ•°ã€toStringã€getter/setterã€é‡å†™çˆ¶ç±»æ–¹æ³•ç­‰ã€‚è¿™ä¸¤ä¸ªæŠ€å·§å®åœ¨å¤ªå¸¸ç”¨äº†ï¼Œå‡ ä¹æ¯å¤©éƒ½è¦ç”Ÿæˆä¸€å †mainã€System.outå’Œgetter/setterã€‚ å¦å¤–ï¼ŒIntellij IDEA 13ä¸­åŠ å…¥äº†åç¼€è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½(Postfix Completion)ï¼Œæ¯”æ¨¡æ¿ç”Ÿæˆæ›´åŠ çµæ´»å’Œå¼ºå¤§ã€‚ä¾‹å¦‚è¦è¾“å…¥for(User user : users)åªéœ€è¾“å…¥user.for+Tabã€‚å†æ¯”å¦‚ï¼Œè¦è¾“å…¥Date birthday = user.getBirthday();åªéœ€è¾“å…¥user.getBirthday().var+Tabå³å¯ã€‚ ç¼–è¾‘ç¼–è¾‘ä¸­ä¸å¾—ä¸è¯´çš„ä¸€å¤§ç¥é”®å°±æ˜¯èƒ½å¤Ÿè‡ªåŠ¨æŒ‰è¯­æ³•é€‰ä¸­ä»£ç çš„Ctrl+Wä»¥åŠåå‘çš„Ctrl+Shift+Wäº†ã€‚æ­¤å¤–ï¼ŒCtrl+Left/Rightç§»åŠ¨å…‰æ ‡åˆ°å‰/åå•è¯ï¼ŒCtrl+[/]ç§»åŠ¨åˆ°å‰/åä»£ç å—ï¼Œè¿™äº›ç±»Vimé£æ ¼çš„å…‰æ ‡ç§»åŠ¨ä¹Ÿæ˜¯ä¸€å¤§äº®ç‚¹ã€‚ä»¥ä¸ŠCtrl+Left/Right/[]åŠ ä¸ŠShiftçš„è¯å°±èƒ½é€‰ä¸­è·³è·ƒèŒƒå›´å†…çš„ä»£ç ã€‚Alt+Forward/Backwardç§»åŠ¨åˆ°å‰/åæ–¹æ³•ã€‚è¿˜æœ‰äº›éå¸¸æ™®é€šçš„åƒCtrl+Yåˆ é™¤è¡Œã€Ctrl+Då¤åˆ¶è¡Œã€Ctrl+æŠ˜å ä»£ç å°±ä¸å¤šè¯´äº†ã€‚ å…³äºå…‰æ ‡ç§»åŠ¨å†å¤šæ‰©å±•ä¸€ç‚¹ï¼Œé™¤äº†Intellijæœ¬èº«å·²æä¾›çš„åŠŸèƒ½å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å®‰è£…ideaVimæˆ–è€…emacsIDEAsäº«å—åˆ°Vimçš„å¿«é€Ÿç§»åŠ¨å’ŒEmacsçš„AceJumpåŠŸèƒ½(è¶…çˆ½ï¼)ã€‚å¦å¤–ï¼ŒIntellijçš„ä¹¦ç­¾åŠŸèƒ½ä¹Ÿæ˜¯ä¸é”™çš„ï¼Œç”¨Ctrl+Shift+Numå®šä¹‰1-10ä¹¦ç­¾(å†æ¬¡æŒ‰è¿™ç»„å¿«æ·é”®åˆ™æ˜¯åˆ é™¤ä¹¦ç­¾)ï¼Œç„¶åé€šè¿‡Ctrl+Numè·³è½¬ã€‚è¿™é¿å…äº†å¤šæ¬¡ä½¿ç”¨å‰/ä¸‹ä¸€ç¼–è¾‘ä½ç½®Ctrl+Left/Rightæ¥å›è·³è½¬çš„éº»çƒ¦ï¼Œè€Œä¸”æ­¤å¿«æ·é”®é»˜è®¤ä¸Windowsçƒ­é”®å†²çª(é»˜è®¤å¤šäº†Altï¼Œä¸Windowsæ”¹å˜æ˜¾ç¤ºå™¨æ˜¾ç¤ºæ–¹å‘å†²çªï¼Œä¸€ä¸å°å¿ƒæ˜¾ç¤ºå™¨å°±å˜æˆå€’ç€æ˜¾å¼çš„äº†ï¼Œå†å•Š)ã€‚ æ¨èï¼šIntellij IDEA æ’¸ç æœ€å¤´å¤§çš„é—®é¢˜ã€‚æŸ¥æ‰¾æ‰“å¼€  ç±»ä¼¼Eclipseï¼ŒIntellijçš„Ctrl+N/Ctrl+Shift+Nå¯ä»¥æ‰“å¼€ç±»æˆ–èµ„æºï¼Œä½†Intellijæ›´åŠ æ™ºèƒ½ä¸€äº›ï¼Œæˆ‘ä»¬è¾“å…¥çš„ä»»ä½•å­—ç¬¦éƒ½å°†çœ‹ä½œæ¨¡ç³ŠåŒ¹é…ï¼Œçœå´äº†Eclipseä¸­è¿˜æœ‰è¾“å…¥*çš„éº»çƒ¦ã€‚æœ€æ–°ç‰ˆæœ¬çš„IDEAè¿˜åŠ å…¥äº†Search EverywhereåŠŸèƒ½ï¼Œåªéœ€æŒ‰Shift+Shiftå³å¯åœ¨ä¸€ä¸ªå¼¹å‡ºæ¡†ä¸­æœç´¢ä»»ä½•ä¸œè¥¿ï¼ŒåŒ…æ‹¬ç±»ã€èµ„æºã€é…ç½®é¡¹ã€æ–¹æ³•ç­‰ç­‰ã€‚ ç±»çš„ç»§æ‰¿å…³ç³»åˆ™å¯ç”¨Ctrl+Hæ‰“å¼€ç±»å±‚æ¬¡çª—å£ï¼Œåœ¨ç»§æ‰¿å±‚æ¬¡ä¸Šè·³è½¬åˆ™ç”¨Ctrl+B/Ctrl+Alt+Båˆ†åˆ«å¯¹åº”çˆ¶ç±»æˆ–çˆ¶æ–¹æ³•å®šä¹‰å’Œå­ç±»æˆ–å­æ–¹æ³•å®ç°ï¼ŒæŸ¥çœ‹å½“å‰ç±»çš„æ‰€æœ‰æ–¹æ³•ç”¨Ctrl+F12ã€‚ è¦æ‰¾ç±»æˆ–æ–¹æ³•çš„ä½¿ç”¨ä¹Ÿå¾ˆç®€å•ï¼ŒAlt+F7ã€‚è¦æŸ¥æ‰¾æ–‡æœ¬çš„å‡ºç°ä½ç½®å°±ç”¨Ctrl+F/Ctrl+Shift+Fåœ¨å½“å‰çª—å£æˆ–å…¨å·¥ç¨‹ä¸­æŸ¥æ‰¾ï¼Œå†é…åˆF3/Shift+F3å‰åç§»åŠ¨åˆ°ä¸‹ä¸€åŒ¹é…å¤„ã€‚ Intellijæ›´åŠ æ™ºèƒ½çš„åˆä¸€ä½è¯æ˜¯åœ¨ä»»æ„èœå•æˆ–æ˜¾ç¤ºçª—å£ï¼Œéƒ½å¯ä»¥ç›´æ¥è¾“å…¥ä½ è¦æ‰¾çš„å•è¯ï¼ŒIntellijå°±ä¼šè‡ªåŠ¨ä¸ºä½ è¿‡æ»¤ã€‚ å…³æ³¨JavaæŠ€æœ¯æ ˆå¾®ä¿¡å…¬ä¼—å·ï¼Œåœ¨åå°å›å¤å…³é”®å­—ï¼šIDEAï¼Œå¯ä»¥è·å–ä¸€ä»½æ ˆé•¿æ•´ç†çš„ IDEA æœ€æ–°æŠ€æœ¯å¹²è´§ã€‚ å…¶ä»–è¾…åŠ©ä»¥ä¸Šè¿™äº›ç¥é”®é…ä¸Šä¸€äº›è¾…åŠ©å¿«æ·é”®ï¼Œå³å¯è®©ä½ çš„åŒæ‰‹90%ä»¥ä¸Šçš„æ—¶é—´æ‘†è„±é¼ æ ‡ï¼Œä¸“æ³¨äºé”®ç›˜ä»¿ä½›åœ¨è¿›è¡Œé’¢ç´è¡¨æ¼”ã€‚è¿™äº›ä¸èµ·çœ¼å´æ˜¯è‡³å…³é‡è¦çš„æœ€åä¸€å—æ‹¼å›¾æœ‰ï¼šå‘½ä»¤ï¼šCtrl+Shift+Aå¯ä»¥æŸ¥æ‰¾æ‰€æœ‰Intellijçš„å‘½ä»¤ï¼Œå¹¶ä¸”æ¯ä¸ªå‘½ä»¤åé¢è¿˜æœ‰å…¶å¿«æ·é”®ã€‚æ‰€ä»¥å®ƒä¸ä»…æ˜¯ä¸€å¤§ç¥é”®ï¼Œä¹Ÿæ˜¯æŸ¥æ‰¾å­¦ä¹ å¿«æ·é”®çš„å·¥å…·ã€‚ Ã˜  æ–°å»ºï¼šAlt+Insertå¯ä»¥æ–°å»ºç±»ã€æ–¹æ³•ç­‰ä»»ä½•ä¸œè¥¿ã€‚ Ã˜  æ ¼å¼åŒ–ä»£ç ï¼šæ ¼å¼åŒ–importåˆ—è¡¨Ctrl+Alt+Oï¼Œæ ¼å¼åŒ–ä»£ç Ctrl+Alt+Lã€‚ Ã˜  åˆ‡æ¢çª—å£ï¼šAlt+Numï¼Œå¸¸ç”¨çš„æœ‰1-é¡¹ç›®ç»“æ„ï¼Œ3-æœç´¢ç»“æœï¼Œ4/5-è¿è¡Œè°ƒè¯•ã€‚Ctrl+Tabåˆ‡æ¢æ ‡ç­¾é¡µï¼ŒCtrl+E/Ctrl+Shift+Eæ‰“å¼€æœ€è¿‘æ‰“å¼€è¿‡çš„æˆ–ç¼–è¾‘è¿‡çš„æ–‡ä»¶ã€‚ Ã˜  å•å…ƒæµ‹è¯•ï¼šCtrl+Alt+Tåˆ›å»ºå•å…ƒæµ‹è¯•ç”¨ä¾‹ã€‚ Ã˜  è¿è¡Œï¼šAlt+Shift+F10è¿è¡Œç¨‹åºï¼ŒShift+F9å¯åŠ¨è°ƒè¯•ï¼ŒCtrl+F2åœæ­¢ã€‚ Ã˜  è°ƒè¯•ï¼šF7/F8/F9åˆ†åˆ«å¯¹åº”Step intoï¼ŒStep overï¼ŒContinueã€‚ æ­¤å¤–è¿˜æœ‰äº›æˆ‘è‡ªå®šä¹‰çš„ï¼Œä¾‹å¦‚æ°´å¹³åˆ†å±Ctrl+|ç­‰ï¼Œå’Œä¸€äº›ç¥å¥‡çš„å°åŠŸèƒ½Ctrl+Shift+Vç²˜è´´å¾ˆæ—©ä»¥å‰æ‹·è´è¿‡çš„ï¼ŒAlt+Shift+Insertè¿›å…¥åˆ°åˆ—æ¨¡å¼è¿›è¡ŒæŒ‰åˆ—é€‰ä¸­ã€‚ Ã˜  Top #10åˆ‡æ¥åˆ‡å»ï¼šCtrl+TabÃ˜  Top #9é€‰ä½ æ‰€æƒ³ï¼šCtrl+WÃ˜  Top #8ä»£ç ç”Ÿæˆï¼šTemplate/Postfix +TabÃ˜  Top #7å‘å·æ–½ä»¤ï¼šCtrl+Shift+AÃ˜  Top #6æ— å¤„è—èº«ï¼šShift+ShiftÃ˜  Top #5è‡ªåŠ¨å®Œæˆï¼šCtrl+Shift+EnterÃ˜  Top #4åˆ›é€ ä¸‡ç‰©ï¼šAlt+Insertå¤ªéš¾å‰²èˆï¼Œå‰ä¸‰åå¹¶åˆ—å§ï¼ Ã˜  Top #1æ™ºèƒ½è¡¥å…¨ï¼šCtrl+Shift+SpaceÃ˜  Top #1è‡ªæˆ‘ä¿®å¤ï¼šAlt+EnterÃ˜  Top #1é‡æ„ä¸€åˆ‡ï¼šCtrl+Shift+Alt+TCTRL+ALT+ left/right å‰åå¯¼èˆªç¼–è¾‘è¿‡çš„åœ°æ–¹ Ctrlï¼‹Shiftï¼‹Backspaceå¯ä»¥è·³è½¬åˆ°ä¸Šæ¬¡ç¼–è¾‘çš„åœ°æ–¹</content>
	</entry>
	<entry>
		<title>JDBC</title>
		<url>/article/8fe47ff4.html</url>
		<content></content>
	</entry>
	<entry>
		<title>JDBC_JDBCTemplate</title>
		<url>/article/e73474f0.html</url>
		<content>ã€é»‘é©¬ç¨‹åºå‘˜-Javaè¯­è¨€é«˜çº§éƒ¨åˆ†11ã€‘JDBCSpring JDBCä¸»è¦åŠŸèƒ½Springæ¡†æ¶å¯¹JDBCçš„ç®€å•å°è£…ã€‚æä¾›äº†ä¸€ä¸ªJDBCTemplateå¯¹è±¡ç®€åŒ–JDBCçš„å¼€å‘æ­¥éª¤ï¼šå¯¼å…¥jaråŒ…åˆ›å»ºJdbcTemplateå¯¹è±¡ã€‚ä¾èµ–äºæ•°æ®æºDataSourceJdbcTemplate template = new JdbcTemplate(ds);è°ƒç”¨JdbcTemplateçš„æ–¹æ³•æ¥å®ŒæˆCRUDçš„æ“ä½œupdate(): æ‰§è¡ŒDMLè¯­å¥ã€‚å¢ã€åˆ ã€æ”¹è¯­å¥queryForMap(): æŸ¥è¯¢ç»“æœå°†ç»“æœé›†å°è£…ä¸ºmapé›†åˆï¼Œå°†åˆ—åä½œä¸ºkeyï¼Œå°†å€¼ä½œä¸ºvalue å°†è¿™æ¡è®°å½•å°è£…ä¸ºä¸€ä¸ªmapé›†åˆæ³¨æ„ï¼šè¿™ä¸ªæ–¹æ³•æŸ¥è¯¢çš„ç»“æœé›†é•¿åº¦åªèƒ½æ˜¯1queryForList(): æŸ¥è¯¢ç»“æœå°†ç»“æœé›†å°è£…ä¸ºlisté›†åˆæ³¨æ„ï¼šå°†æ¯ä¸€æ¡è®°å½•å°è£…ä¸ºä¸€ä¸ªMapé›†åˆï¼Œå†å°†Mapé›†åˆè£…è½½åˆ°Listé›†åˆä¸­query(): æŸ¥è¯¢ç»“æœï¼Œå°†ç»“æœå°è£…ä¸ºJavaBeanå¯¹è±¡queryçš„å‚æ•°ï¼šRowMapperä¸€èˆ¬æˆ‘ä»¬ä½¿ç”¨BeanPropertyRowMapperå®ç°ç±»ã€‚å¯ä»¥å®Œæˆæ•°æ®åˆ°JavaBeançš„è‡ªåŠ¨å°è£…new BeanPropertyRowMapper&lt;ç±»å‹&gt;(ç±»å‹.class)queryForObject()ï¼šæŸ¥è¯¢ç»“æœï¼Œå°†ç»“æœå°è£…ä¸ºå¯¹è±¡ä¸€èˆ¬ç”¨äºèšåˆå‡½æ•°çš„æŸ¥è¯¢ä½¿ç”¨ç¤ºä¾‹123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131import cn.itcast.utils.JDBCUtils;import org.junit.Test;import org.springframework.jdbc.core.BeanPropertyRowMapper;import org.springframework.jdbc.core.JdbcTemplate;import org.springframework.jdbc.core.RowMapper;import java.sql.ResultSet;import java.sql.SQLException;import java.util.List;import java.util.Map;import java.util.Date;public class JdbcTemplateDemo {    //1. è·å–JDBCTemplateå¯¹è±¡    private JdbcTemplate template = new JdbcTemplate(JDBCUtils.getDataSource());    /**     * 1. ä¿®æ”¹1å·æ•°æ®çš„ salary ä¸º 10000     */    @Test    public void test1(){        //2. å®šä¹‰sql        String sql = &quot;update emp set salary = 10000 where id = 1001&quot;;        //3. æ‰§è¡Œsql        int count = template.update(sql);        System.out.println(count);    }    /**     * 2. æ·»åŠ ä¸€æ¡è®°å½•     */    @Test    public void test2(){        String sql = &quot;insert into emp(id,ename,dept_id) values(?,?,?)&quot;;        int count = template.update(sql, 1015, &quot;éƒ­é–&quot;, 10);        System.out.println(count);    }    /**     * 3.åˆ é™¤åˆšæ‰æ·»åŠ çš„è®°å½•     */    @Test    public void test3(){        String sql = &quot;delete from emp where id = ?&quot;;        int count = template.update(sql, 1015);        System.out.println(count);    }    /**     * 4.æŸ¥è¯¢idä¸º1001çš„è®°å½•ï¼Œå°†å…¶å°è£…ä¸ºMapé›†åˆ     * æ³¨æ„ï¼šè¿™ä¸ªæ–¹æ³•æŸ¥è¯¢çš„ç»“æœé›†é•¿åº¦åªèƒ½æ˜¯1     */    @Test    public void test4(){        String sql = &quot;select * from emp where id = ? or id = ?&quot;;        Map&lt;String, Object&gt; map = template.queryForMap(sql, 1001,1002);        System.out.println(map);        //{id=1001, ename=å­™æ‚Ÿç©º, job_id=4, mgr=1004, joindate=2000-12-17, salary=10000.00, bonus=null, dept_id=20}    }    /**     * 5. æŸ¥è¯¢æ‰€æœ‰è®°å½•ï¼Œå°†å…¶å°è£…ä¸ºList     */    @Test    public void test5(){        String sql = &quot;select * from emp&quot;;        List&lt;Map&lt;String, Object&gt;&gt; list = template.queryForList(sql);        for (Map&lt;String, Object&gt; stringObjectMap : list) {            System.out.println(stringObjectMap);        }    }    /**     * 6. æŸ¥è¯¢æ‰€æœ‰è®°å½•ï¼Œå°†å…¶å°è£…ä¸ºEmpå¯¹è±¡çš„Listé›†åˆ     */    @Test    public void test6(){        String sql = &quot;select * from emp&quot;;        List&lt;Emp&gt; list = template.query(sql, new RowMapper&lt;Emp&gt;() {            @Override            public Emp mapRow(ResultSet rs, int i) throws SQLException {                Emp emp = new Emp();                int id = rs.getInt(&quot;id&quot;);                String ename = rs.getString(&quot;ename&quot;);                int job_id = rs.getInt(&quot;job_id&quot;);                int mgr = rs.getInt(&quot;mgr&quot;);                Date joindate = rs.getDate(&quot;joindate&quot;);                double salary = rs.getDouble(&quot;salary&quot;);                double bonus = rs.getDouble(&quot;bonus&quot;);                int dept_id = rs.getInt(&quot;dept_id&quot;);                emp.setId(id);                emp.setEname(ename);                emp.setJob_id(job_id);                emp.setMgr(mgr);                emp.setJoindate(joindate);                emp.setSalary(salary);                emp.setBonus(bonus);                emp.setDept_id(dept_id);                return emp;            }        });        for (Emp emp : list) {            System.out.println(emp);        }    }    /**     * 6. æŸ¥è¯¢æ‰€æœ‰è®°å½•ï¼Œå°†å…¶å°è£…ä¸ºEmpå¯¹è±¡çš„Listé›†åˆ     */    @Test    public void test6_2(){        String sql = &quot;select * from emp&quot;;        List&lt;Emp&gt; list = template.query(sql, new BeanPropertyRowMapper&lt;Emp&gt;(Emp.class));        for (Emp emp : list) {            System.out.println(emp);        }    }    /**     * 7. æŸ¥è¯¢æ€»è®°å½•æ•°     */    @Test    public void test7(){        String sql = &quot;select count(id) from emp&quot;;        Long total = template.queryForObject(sql, Long.class);        System.out.println(total);    }}1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889import java.sql.Date;public class Emp {    private Integer id;    private String ename;    private Integer job_id;    private Integer mgr;    private Date joindate;    private Double salary;    private Double bonus;    private Integer dept_id;    public Integer getId() {        return id;    }    public void setId(Integer id) {        this.id = id;    }    public String getEname() {        return ename;    }    public void setEname(String ename) {        this.ename = ename;    }    public Integer getJob_id() {        return job_id;    }    public void setJob_id(Integer job_id) {        this.job_id = job_id;    }    public Integer getMgr() {        return mgr;    }    public void setMgr(Integer mgr) {        this.mgr = mgr;    }    public Date getJoindate() {        return joindate;    }    public void setJoindate(Date joindate) {        this.joindate = joindate;    }    public Double getSalary() {        return salary;    }    public void setSalary(Double salary) {        this.salary = salary;    }    public Double getBonus() {        return bonus;    }    public void setBonus(Double bonus) {        this.bonus = bonus;    }    public Integer getDept_id() {        return dept_id;    }    public void setDept_id(Integer dept_id) {        this.dept_id = dept_id;    }    @Override    public String toString() {        return &quot;Emp{&quot; +                &quot;id=&quot; + id +                &quot;, ename='&quot; + ename + '\'' +                &quot;, job_id=&quot; + job_id +                &quot;, mgr=&quot; + mgr +                &quot;, joindate=&quot; + joindate +                &quot;, salary=&quot; + salary +                &quot;, bonus=&quot; + bonus +                &quot;, dept_id=&quot; + dept_id +                '}';    }}</content>
	</entry>
	<entry>
		<title>JDBC_JDBCè¿æ¥æ± </title>
		<url>/article/ae528721.html</url>
		<content>ã€é»‘é©¬ç¨‹åºå‘˜-Javaè¯­è¨€é«˜çº§éƒ¨åˆ†11ã€‘JDBCæ•°æ®åº“è¿æ¥æ± æ¦‚å¿µï¼šå…¶å®å°±æ˜¯ä¸€ä¸ªå®¹å™¨(é›†åˆ)ï¼Œå­˜æ”¾æ•°æ®åº“è¿æ¥çš„å®¹å™¨ã€‚   å½“ç³»ç»Ÿåˆå§‹åŒ–å¥½åï¼Œå®¹å™¨è¢«åˆ›å»ºï¼Œå®¹å™¨ä¸­ä¼šç”³è¯·ä¸€äº›è¿æ¥å¯¹è±¡ï¼Œå½“ç”¨æˆ·æ¥è®¿é—®æ•°æ®åº“æ—¶ï¼Œä»å®¹å™¨ä¸­è·å–è¿æ¥å¯¹è±¡ï¼Œç”¨æˆ·è®¿é—®å®Œä¹‹åï¼Œä¼šå°†è¿æ¥å¯¹è±¡å½’è¿˜ç»™å®¹å™¨ã€‚å¥½å¤„ï¼šèŠ‚çº¦èµ„æº+ç”¨æˆ·è®¿é—®é«˜æ•ˆæ ‡å‡†æ¥å£ï¼šDataSource   javax.sqlåŒ…ä¸‹çš„æ–¹æ³•ï¼šè·å–è¿æ¥ï¼šgetConnection()å½’è¿˜è¿æ¥ï¼šConnection.close()ã€‚å¦‚æœè¿æ¥å¯¹è±¡Connectionæ˜¯ä»è¿æ¥æ± ä¸­è·å–çš„ï¼Œé‚£ä¹ˆè°ƒç”¨Connection.close()æ–¹æ³•ï¼Œåˆ™ä¸ä¼šå†å…³é—­è¿æ¥äº†ã€‚è€Œæ˜¯å½’è¿˜è¿æ¥ä¸€èˆ¬æˆ‘ä»¬ä¸å»å®ç°å®ƒï¼Œæœ‰æ•°æ®åº“å‚å•†æ¥å®ç°C3P0ï¼šæ•°æ®åº“è¿æ¥æ± æŠ€æœ¯Druidï¼šæ•°æ®åº“è¿æ¥æ± å®ç°æŠ€æœ¯ï¼Œç”±é˜¿é‡Œå·´å·´æä¾›çš„C3P0æ•°æ®åº“è¿æ¥æ± æŠ€æœ¯æ­¥éª¤ï¼šå¯¼å…¥jaråŒ… (ä¸¤ä¸ª) c3p0-0.9.5.2.jar mchange-commons-java-0.2.12.jar ï¼Œä¸è¦å¿˜è®°å¯¼å…¥æ•°æ®åº“é©±åŠ¨jaråŒ…å®šä¹‰é…ç½®æ–‡ä»¶ï¼šåç§°ï¼š c3p0.properties æˆ–è€… c3p0-config.xmlè·¯å¾„ï¼šç›´æ¥å°†æ–‡ä»¶æ”¾åœ¨srcç›®å½•ä¸‹å³å¯ã€‚```xml    &lt;!--  è¿æ¥å‚æ•° --&gt;&lt;property name=&quot;driverClass&quot;&gt;com.mysql.jdbc.Driver&lt;/property&gt;&lt;property name=&quot;jdbcUrl&quot;&gt;jdbc:mysql://localhost:3306/db4&lt;/property&gt;&lt;property name=&quot;user&quot;&gt;root&lt;/property&gt;&lt;property name=&quot;password&quot;&gt;root&lt;/property&gt;&lt;!-- è¿æ¥æ± å‚æ•° --&gt;&lt;!--åˆå§‹åŒ–ç”³è¯·çš„è¿æ¥æ•°é‡--&gt;&lt;property name=&quot;initialPoolSize&quot;&gt;5&lt;/property&gt;&lt;!--æœ€å¤§çš„è¿æ¥æ•°é‡--&gt;&lt;property name=&quot;maxPoolSize&quot;&gt;10&lt;/property&gt;&lt;!--è¶…æ—¶æ—¶é—´--&gt;&lt;property name=&quot;checkoutTimeout&quot;&gt;3000&lt;/property&gt;  &lt;/default-config&gt;  &lt;!--  è¿æ¥å‚æ•° --&gt;&lt;property name=&quot;driverClass&quot;&gt;com.mysql.jdbc.Driver&lt;/property&gt;&lt;property name=&quot;jdbcUrl&quot;&gt;jdbc:mysql://localhost:3306/db3&lt;/property&gt;&lt;property name=&quot;user&quot;&gt;root&lt;/property&gt;&lt;property name=&quot;password&quot;&gt;root&lt;/property&gt;&lt;!-- è¿æ¥æ± å‚æ•° --&gt;&lt;property name=&quot;initialPoolSize&quot;&gt;5&lt;/property&gt;&lt;property name=&quot;maxPoolSize&quot;&gt;8&lt;/property&gt;&lt;property name=&quot;checkoutTimeout&quot;&gt;1000&lt;/property&gt;  &lt;/named-config&gt;&lt;/c3p0-config&gt;123456789&gt;3. åˆ›å»ºæ ¸å¿ƒå¯¹è±¡ æ•°æ®åº“è¿æ¥æ± å¯¹è±¡ ComboPooledDataSource&gt;4. è·å–è¿æ¥ï¼š getConnection&gt;```java&gt;// 1. åˆ›å»ºæ•°æ®åº“è¿æ¥æ± å¯¹è±¡DataSource ds  = new ComboPooledDataSource();// 2. è·å–è¿æ¥å¯¹è±¡Connection conn = ds.getConnection();Druidæ•°æ®åº“è¿æ¥æ± å®ç°æŠ€æœ¯ï¼Œç”±é˜¿é‡Œå·´å·´æä¾›çš„æ­¥éª¤ï¼šå¯¼å…¥jaråŒ… druid-1.0.9.jarå®šä¹‰é…ç½®æ–‡ä»¶ï¼šdruid.propertieså½¢å¼å¯ä»¥å«ä»»æ„åç§°ï¼Œå¯ä»¥æ”¾åœ¨ä»»æ„ç›®å½•ä¸‹```propertiesdriverClassName=com.mysql.jdbc.Driverurl=jdbc:mysql:///db3username=rootpassword=rootåˆå§‹åŒ–è¿æ¥æ•°é‡initialSize=5æœ€å¤§è¿æ¥æ•°maxActive=10æœ€å¤§ç­‰å¾…æ—¶é—´maxWait=3000123456789101112131415163. åŠ è½½propertiesé…ç½®æ–‡ä»¶4. è·å–æ•°æ®åº“è¿æ¥æ± å¯¹è±¡ï¼šé€šè¿‡å·¥å‚æ¥æ¥è·å–  DruidDataSourceFactory5. è·å–è¿æ¥ï¼šgetConnection```java// 3. åŠ è½½é…ç½®æ–‡ä»¶Properties pro = new Properties();InputStream is = DruidDemo.class.getClassLoader().getResourceAsStream(&quot;druid.properties&quot;);pro.load(is);// 4. è·å–è¿æ¥æ± å¯¹è±¡DataSource ds = DruidDataSourceFactory.createDataSource(pro);// 5. è·å–è¿æ¥Connection conn = ds.getConnection();JDBCUtils.java1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677import com.alibaba.druid.pool.DruidDataSourceFactory;import javax.sql.DataSource;import java.io.IOException;import java.sql.Connection;import java.sql.ResultSet;import java.sql.SQLException;import java.sql.Statement;import java.util.Properties;/** * Druidè¿æ¥æ± çš„å·¥å…·ç±» */public class JDBCUtils {    //1.å®šä¹‰æˆå‘˜å˜é‡ DataSource    private static DataSource ds ;    static{        try {            //1.åŠ è½½é…ç½®æ–‡ä»¶            Properties pro = new Properties();            pro.load(JDBCUtils.class.getClassLoader().getResourceAsStream(&quot;druid.properties&quot;));            //2.è·å–DataSource            ds = DruidDataSourceFactory.createDataSource(pro);        } catch (IOException e) {            e.printStackTrace();        } catch (Exception e) {            e.printStackTrace();        }    }    /**     * è·å–è¿æ¥     */    public static Connection getConnection() throws SQLException {        return ds.getConnection();    }    /**     * é‡Šæ”¾èµ„æº     */    public static void close(Statement stmt,Connection conn){       close(null,stmt,conn);    }    public static void close(ResultSet rs , Statement stmt, Connection conn){        if(rs != null){            try {                rs.close();            } catch (SQLException e) {                e.printStackTrace();            }        }        if(stmt != null){            try {                stmt.close();            } catch (SQLException e) {                e.printStackTrace();            }        }        if(conn != null){            try {                conn.close();//å½’è¿˜è¿æ¥            } catch (SQLException e) {                e.printStackTrace();            }        }    }    /**     * è·å–è¿æ¥æ± æ–¹æ³•     */    public static DataSource getDataSource(){        return  ds;    }}</content>
	</entry>
	<entry>
		<title>Java core programming</title>
		<url>/article/d13ef431.html</url>
		<content>Java æ ¸å¿ƒç¼–ç¨‹æŠ€æœ¯å¹²è´§å‚è€ƒ: https://mp.weixin.qq.com/s/-KbOyp4gXYY4Ok8S-rPa6Qï¼ˆJava æ ¸å¿ƒç¼–ç¨‹æŠ€æœ¯å¹²è´§ï¼‰è‡ªåŠ¨ä»£ç </content>
	</entry>
	<entry>
		<title>JavaåŸºç¡€</title>
		<url>/article/f7ede91d.html</url>
		<content></content>
	</entry>
	<entry>
		<title>JavaåŸºç¡€_åå°„æœºåˆ¶</title>
		<url>/article/3c274368.html</url>
		<content>åå°„æœºåˆ¶åå°„â€”â€”Javaé«˜çº§å¼€å‘å¿…é¡»æ‡‚çš„Javaé«˜çº§ç‰¹æ€§â€”â€”åå°„Classç±»çš„ä½¿ç”¨Classç±»åœ¨é¢å‘å¯¹è±¡çš„ä¸–ç•Œé‡Œï¼Œä¸‡äº‹ä¸‡ç‰©çš†å¯¹è±¡ã€‚javaè¯­è¨€ä¸­ï¼Œé™æ€çš„æˆå‘˜ã€æ™®é€šæ•°æ®ç±»å‹ç±»æ˜¯ä¸æ˜¯å¯¹è±¡å‘¢ï¼Ÿç±»æ˜¯è°çš„å¯¹è±¡å‘¢ï¼Ÿç±»æ˜¯å¯¹è±¡ï¼Œç±»æ˜¯java.lang.Classç±»çš„å®ä¾‹å¯¹è±¡è¿™ä¸ªå¯¹è±¡åˆ°åº•å¦‚ä½•è¡¨ç¤ºï¼ŸThere is a class named Class12345678910111213141516171819202122232425262728293031323334353637383940414243class Foo {    void print() {        System.out.println(&quot;foo&quot;);    }}public class ClassDemo1 {    public static void main(String[] args) {        // ç¬¬ä¸€ç§è¡¨ç¤ºæ–¹å¼---&gt;å®é™…åœ¨å‘Šè¯‰æˆ‘ä»¬ä»»ä½•ä¸€ä¸ªç±»éƒ½æœ‰ä¸€ä¸ªéšå«çš„é™æ€æˆå‘˜å˜é‡class        Class c1 = Foo.class;        // ç¬¬äºŒç§è¡¨è¾¾æ–¹å¼  å·²ç»çŸ¥é“è¯¥ç±»çš„å¯¹è±¡é€šè¿‡getClassæ–¹æ³•        // ç±»ä¹Ÿæ˜¯å¯¹è±¡ï¼Œæ˜¯Classç±»çš„å®ä¾‹å¯¹è±¡        // è¿™ä¸ªå¯¹è±¡æˆ‘ä»¬ç§°ä¸ºè¯¥ç±»çš„ç±»ç±»å‹        // ä¸ç®¡c1 or c2éƒ½ä»£è¡¨äº†Fooç±»çš„ç±»ç±»å‹ï¼Œä¸€ä¸ªç±»åªå¯èƒ½æ˜¯Classç±»çš„ä¸€ä¸ªå®ä¾‹å¯¹è±¡        Class c2 = new Foo().getClass();        System.out.println(c1 == c2);        //ç¬¬ä¸‰ç§è¡¨è¾¾æ–¹å¼        Class c3 = null;        try {            c3 = Class.forName(&quot;com.imooc.reflect.Foo&quot;);        } catch (ClassNotFoundException e) {            e.printStackTrace();        }        System.out.println(c2 == c3);        // æˆ‘ä»¬å®Œå…¨å¯ä»¥é€šè¿‡ç±»çš„ç±»ç±»å‹åˆ›å»ºè¯¥ç±»çš„å¯¹è±¡å®ä¾‹----&gt;é€šè¿‡c1 or c2 or c3åˆ›å»ºFooçš„å®ä¾‹å¯¹è±¡        try {            Foo foo = (Foo) c1.newInstance();//éœ€è¦æœ‰æ— å‚æ•°çš„æ„é€ æ–¹æ³•            foo.print();        } catch (InstantiationException e) {            e.printStackTrace();        } catch (IllegalAccessException e) {            e.printStackTrace();        }    }}// è¾“å‡ºtruetruefooåŠ¨æ€åŠ è½½ç±»Classç±»Class.forName(â€œç±»çš„å…¨ç§°â€ï¼‰ä¸ä»…è¡¨ç¤ºäº†ç±»çš„ç±»ç±»å‹ï¼Œè¿˜ä»£è¡¨äº†åŠ¨æ€åŠ è½½ç±» Â·è¯·å¤§å®¶åŒºåˆ†ç¼–è¯‘ã€è¿è¡Œç¼–è¯‘æ—¶åˆ»åŠ è½½ç±»æ˜¯é™æ€åŠ è½½ç±»ã€è¿è¡Œæ—¶åˆ»åŠ è½½ç±»æ˜¯åŠ¨æ€åŠ è½½ç±» 12345678910111213141516171819202122232425262728293031323334&gt;interface OfficeAble {   void start();&gt;}&gt;class Word implements OfficeAble {   @Override   public void start() {       System.out.println(&quot;word..starts.â€¦&quot;);   }&gt;}&gt;class Excel implements OfficeAble {   @Override   public void start() {       System.out.println(&quot;Excel..starts.â€¦&quot;);   }&gt;}&gt;public class OfficeBetter {   public static void main(String[] args) {       try {           // åŠ¨æ€åŠ è½½ç±»ï¼Œåœ¨è¿è¡Œæ—¶åˆ»åŠ è½½           Class c = Class.forName(&quot;com.imooc.reflect.Word&quot;);           // é€šè¿‡ç±»ç±»å‹ï¼Œåˆ›å»ºè¯¥ç±»å¯¹è±¡           OfficeAble oa = (OfficeAble) c.newInstance();           oa.start();       } catch (Exception e) {           e.printStackTrace();       }   }&gt;}&gt;// è¾“å‡º&gt;word..starts.â€¦è·å–æ–¹æ³•ä¿¡æ¯123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354import java.lang.reflect.Constructor;import java.lang.reflect.Field;import java.lang.reflect.Method;public class ClassUtil {/** * æ‰“å°ç±»çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç±»çš„æˆå‘˜å‡½æ•°ã€æˆå‘˜å˜é‡(åªè·å–æˆå‘˜å‡½æ•°) * @param obj è¯¥å¯¹è±¡æ‰€å±ç±»çš„ä¿¡æ¯ */static void printClassMethodMessage(Object obj){// è¦è·å–ç±»çš„ä¿¡æ¯  é¦–å…ˆè¦è·å–ç±»çš„ç±»ç±»å‹Class c = obj.getClass();//ä¼ é€’çš„æ˜¯å“ªä¸ªå­ç±»çš„å¯¹è±¡  cå°±æ˜¯è¯¥å­ç±»çš„ç±»ç±»å‹//è·å–ç±»çš„åç§°System.out.println(&quot;ç±»çš„åç§°æ˜¯:&quot;+c.getName());/* * Methodç±»ï¼Œæ–¹æ³•å¯¹è±¡ * ä¸€ä¸ªæˆå‘˜æ–¹æ³•å°±æ˜¯ä¸€ä¸ªMethodå¯¹è±¡ * getMethods()æ–¹æ³•è·å–çš„æ˜¯æ‰€æœ‰çš„publicçš„å‡½æ•°ï¼ŒåŒ…æ‹¬çˆ¶ç±»ç»§æ‰¿è€Œæ¥çš„ * getDeclaredMethods()è·å–çš„æ˜¯æ‰€æœ‰è¯¥ç±»è‡ªå·±å£°æ˜çš„æ–¹æ³•ï¼Œä¸é—®è®¿é—®æƒé™ */Method[] ms = c.getMethods(); //c.getDeclaredMethods()for(int i = 0; i &lt; ms.length;i++){// å¾—åˆ°æ–¹æ³•çš„è¿”å›å€¼ç±»å‹çš„ç±»ç±»å‹Class returnType = ms[i].getReturnType();System.out.print(returnType.getName()+&quot; &quot;);// å¾—åˆ°æ–¹æ³•çš„åç§°System.out.print(ms[i].getName()+&quot;(&quot;);// è·å–å‚æ•°ç±»å‹---&gt;å¾—åˆ°çš„æ˜¯å‚æ•°åˆ—è¡¨çš„ç±»å‹çš„ç±»ç±»å‹Class[] paramTypes = ms[i].getParameterTypes();for (Class class1 : paramTypes) {System.out.print(class1.getName()+&quot;,&quot;);}System.out.println(&quot;)&quot;);}}}public class ClassDemo3 {public static void main(String[] args) {String s = &quot;hello&quot;;ClassUtil.printClassMethodMessage(s);    Integer n1 = 1;    ClassUtil.printClassMethodMessage(n1);}}// è¾“å‡ºç±»çš„åç§°æ˜¯:java.lang.Stringboolean equals(java.lang.Object,)java.lang.String toString()int hashCode()int compareTo(java.lang.String,)...è·å–æˆå‘˜å˜é‡æ„é€ å‡½æ•°ä¿¡æ¯12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849import java.lang.reflect.Constructor;import java.lang.reflect.Field;import java.lang.reflect.Method;public class ClassUtil {    /**     * è·å–æˆå‘˜å˜é‡çš„ä¿¡æ¯     */public static void printFieldMessage(Object obj) {Class c = obj.getClass();/* * æˆå‘˜å˜é‡ä¹Ÿæ˜¯å¯¹è±¡ * java.lang.reflect.Field * Fieldç±»å°è£…äº†å…³äºæˆå‘˜å˜é‡çš„æ“ä½œ * getFields()æ–¹æ³•è·å–çš„æ˜¯æ‰€æœ‰çš„publicçš„æˆå‘˜å˜é‡çš„ä¿¡æ¯ * getDeclaredFieldsè·å–çš„æ˜¯è¯¥ç±»è‡ªå·±å£°æ˜çš„æˆå‘˜å˜é‡çš„ä¿¡æ¯ *///Field[] fs = c.getFields();Field[] fs = c.getDeclaredFields();for (Field field : fs) {//å¾—åˆ°æˆå‘˜å˜é‡çš„ç±»å‹çš„ç±»ç±»å‹Class fieldType = field.getType();String typeName = fieldType.getName();//å¾—åˆ°æˆå‘˜å˜é‡çš„åç§°String fieldName = field.getName();System.out.println(typeName+&quot; &quot;+fieldName);}}}public class ClassDemo4 {public static void main(String[] args) {ClassUtil.printFieldMessage(&quot;hello&quot;);System.out.println(&quot;=============&quot;);ClassUtil.printFieldMessage(new Integer(1));}}// è¾“å‡º[C valueint hashlong serialVersionUID[Ljava.io.ObjectStreamField; serialPersistentFieldsjava.util.Comparator CASE_INSENSITIVE_ORDER=============int MIN_VALUEint MAX_VALUEjava.lang.Class TYPE...12345678910111213141516171819202122232425262728293031323334353637383940414243import java.lang.reflect.Constructor;import java.lang.reflect.Field;import java.lang.reflect.Method;public class ClassUtil {/** * æ‰“å°å¯¹è±¡çš„æ„é€ å‡½æ•°çš„ä¿¡æ¯ * @param obj */public static void printConMessage(Object obj){Class c = obj.getClass();/* * æ„é€ å‡½æ•°ä¹Ÿæ˜¯å¯¹è±¡ * java.lang. Constructorä¸­å°è£…äº†æ„é€ å‡½æ•°çš„ä¿¡æ¯ * getConstructorsè·å–æ‰€æœ‰çš„publicçš„æ„é€ å‡½æ•° * getDeclaredConstructorså¾—åˆ°æ‰€æœ‰çš„æ„é€ å‡½æ•° *///Constructor[] cs = c.getConstructors();Constructor[] cs = c.getDeclaredConstructors();for (Constructor constructor : cs) {System.out.print(constructor.getName()+&quot;(&quot;);//è·å–æ„é€ å‡½æ•°çš„å‚æ•°åˆ—è¡¨---&gt;å¾—åˆ°çš„æ˜¯å‚æ•°åˆ—è¡¨çš„ç±»ç±»å‹Class[] paramTypes = constructor.getParameterTypes();for (Class class1 : paramTypes) {System.out.print(class1.getName()+&quot;,&quot;);}System.out.println(&quot;)&quot;);}}}public class ClassDemo5 {public static void main(String[] args) {ClassUtil.printConMessage(&quot;hello&quot;);ClassUtil.printConMessage(new Integer(1));}}// è¾“å‡ºjava.lang.String([B,int,int,)java.lang.String([B,java.nio.charset.Charset,)java.lang.String([B,java.lang.String,)...æ–¹æ³•åå°„çš„åŸºæœ¬æ“ä½œæ–¹æ³•çš„åå°„å¦‚ä½•è·å–æŸä¸ªæ–¹æ³• æ–¹æ³•çš„åç§°å’Œæ–¹æ³•çš„å‚æ•°åˆ—è¡¨æ‰èƒ½å”¯ä¸€å†³å®šæŸä¸ªæ–¹æ³•æ–¹æ³•åå°„çš„æ“ä½œmethod.invoke(å¯¹è±¡ï¼Œå‚æ•°åˆ—è¡¨ï¼‰12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849import java.lang.reflect.Method;class A {     public void print() {           System.out.println(&quot;helloworld&quot;);       }       public void print(int a, int b) {           System.out.println(a + b);       }       public void print(String a, String b) {           System.out.println(a.toUpperCase() + &quot;,&quot; + b.toLowerCase());       }}public class MethodDemo1 {     public static void main(String[] args) {          // è·å–æ–¹æ³•åç§°å’Œå‚æ•°åˆ—è¡¨æ¥å†³å®š           // getMethodè·å–çš„æ˜¯publicçš„æ–¹æ³•           // getDelcaredMethodè‡ªå·±å£°æ˜çš„æ–¹æ³•           A a1 = new A();           Class c = a1.getClass();           try {               // 1.è·å–æ–¹æ³•print(int,int)               // Method m =  c.getMethod(&quot;print&quot;, new Class[]{int.class,int.class});               Method m = c.getMethod(&quot;print&quot;, int.class, int.class);               // æ–¹æ³•çš„åå°„æ“ä½œæ˜¯ç”¨må¯¹è±¡æ¥è¿›è¡Œæ–¹æ³•è°ƒç”¨ å’Œa1.printè°ƒç”¨çš„æ•ˆæœå®Œå…¨ç›¸åŒ               // Object o = m.invoke(a1,new Object[]{10,20});               Object o = m.invoke(a1, 10, 20);               System.out.println(&quot;==================&quot;);              // 2.è·å–æ–¹æ³•print(String,String)               Method m1 = c.getMethod(&quot;print&quot;, String.class, String.class);               o = m1.invoke(a1, &quot;hello&quot;, &quot;WORLD&quot;);               System.out.println(&quot;===================&quot;);              // 3.è·å–æ–¹æ³•print()               // Method m2 = c.getMethod(&quot;print&quot;, new Class[]{});               Method m2 = c.getMethod(&quot;print&quot;);               // m2.invoke(a1, new Object[]{});               m2.invoke(a1);           } catch (Exception e) {               e.printStackTrace();           }       }}// è¾“å‡º30==================HELLO,world===================helloworldé€šè¿‡åå°„äº†è§£é›†åˆæ³›å‹çš„æœ¬è´¨å¯ä»¥ç”¨åå°„ç»•è¿‡æ³›å‹123456789101112131415161718192021222324252627282930313233343536373839import java.lang.reflect.Method;import java.util.ArrayList;public class MethodDemo4 {public static void main(String[] args) {ArrayList list = new ArrayList();ArrayList&lt;String&gt; list1 = new ArrayList&lt;String&gt;();list1.add(&quot;hello&quot;);//list1.add(20);é”™è¯¯çš„Class c1 = list.getClass();Class c2 = list1.getClass();System.out.println(c1 == c2);//åå°„çš„æ“ä½œéƒ½æ˜¯ç¼–è¯‘ä¹‹åçš„æ“ä½œ/* * c1==c2ç»“æœè¿”å›trueè¯´æ˜ç¼–è¯‘ä¹‹åé›†åˆçš„æ³›å‹æ˜¯å»æ³›å‹åŒ–çš„ * Javaä¸­é›†åˆçš„æ³›å‹ï¼Œæ˜¯é˜²æ­¢é”™è¯¯è¾“å…¥çš„ï¼Œåªåœ¨ç¼–è¯‘é˜¶æ®µæœ‰æ•ˆï¼Œ * ç»•è¿‡ç¼–è¯‘å°±æ— æ•ˆäº† * éªŒè¯ï¼šæˆ‘ä»¬å¯ä»¥é€šè¿‡æ–¹æ³•çš„åå°„æ¥æ“ä½œï¼Œç»•è¿‡ç¼–è¯‘ */try {Method m = c2.getMethod(&quot;add&quot;, Object.class);m.invoke(list1, 20);//ç»•è¿‡ç¼–è¯‘æ“ä½œå°±ç»•è¿‡äº†æ³›å‹System.out.println(list1.size());System.out.println(list1);/*for (String string : list1) {System.out.println(string);}*///ç°åœ¨ä¸èƒ½è¿™æ ·éå†} catch (Exception e) {  e.printStackTrace();}}}// è¾“å‡ºtrue2[hello, 20]jOORåå°„apijOORåå°„api123456&lt;!-- https://mvnrepository.com/artifact/org.jooq/joor --&gt;&lt;dependency&gt;    &lt;groupId&gt;org.jooq&lt;/groupId&gt;    &lt;artifactId&gt;joor&lt;/artifactId&gt;    &lt;version&gt;0.9.5&lt;/version&gt;&lt;/dependency&gt;12345678910111213141516171819import org.joor.Reflect;/** * åŸºäºJoorçš„åå°„å­¦ä¹ */private static void joorReflex() {    Properties pro = GetProperties.getPro(pathname);    String fruitClass = pro.getProperty(&quot;apple&quot;);    Reflect reflect = Reflect.on(fruitClass).create();    reflect.call(&quot;setPrice&quot;,25.4);    // ä¸ºåŒ…è£…ç±»å»ºç«‹ä¸€ä¸ªä»£ç†    Fruit fruitProxy = Reflect.on(fruitClass).create().as(Fruit.class);    Reflect.on(fruitProxy).call(&quot;setPrice&quot;,13.2);    Fruit fruit = FruitFactory.getInstance(fruitClass);    Reflect.on(fruit).call(&quot;setPrice&quot;,17.6);    System.out.println();}</content>
	</entry>
	<entry>
		<title>JavaåŸºç¡€_åå°æœåŠ¡å™¨å¼€å‘</title>
		<url>/article/3b72c11.html</url>
		<content>åå°æœåŠ¡å™¨å¼€å‘è¿œç¨‹é€šä¿¡æ–¹å¼WebServiceå¹³å°æŠ€æœ¯XML+XSD,SOAPå’ŒWSDLå°±æ˜¯æ„æˆWebServiceå¹³å°çš„ä¸‰å¤§æŠ€æœ¯XML+XSDWebServiceé‡‡ç”¨HTTPåè®®ä¼ è¾“æ•°æ®ï¼Œé‡‡ç”¨XMLæ ¼å¼å°è£…æ•°æ®ï¼ˆå³XMLä¸­è¯´æ˜è°ƒç”¨è¿œç¨‹æœåŠ¡å¯¹è±¡çš„å“ªä¸ªæ–¹æ³•ï¼Œä¼ é€’çš„å‚æ•°æ˜¯ä»€ä¹ˆï¼Œä»¥åŠæœåŠ¡å¯¹è±¡çš„è¿”å›ç»“æœæ˜¯ä»€ä¹ˆï¼‰ã€‚XMLæ˜¯WebServiceå¹³å°ä¸­è¡¨ç¤ºæ•°æ®çš„æ ¼å¼ã€‚é™¤äº†æ˜“äºå»ºç«‹å’Œæ˜“äºåˆ†æå¤–ï¼ŒXMLä¸»è¦çš„ä¼˜ç‚¹åœ¨äºå®ƒæ—¢æ˜¯å¹³å°æ— å…³çš„ï¼Œåˆæ˜¯å‚å•†æ— å…³çš„ã€‚æ— å…³æ€§æ˜¯æ¯”æŠ€æœ¯ä¼˜è¶Šæ€§æ›´é‡è¦çš„ï¼šè½¯ä»¶å‚å•†æ˜¯ä¸ä¼šé€‰æ‹©ä¸€ä¸ªç”±ç«äº‰å¯¹æ‰‹æ‰€å‘æ˜çš„æŠ€æœ¯çš„ã€‚XMLè§£å†³äº†æ•°æ®è¡¨ç¤ºçš„é—®é¢˜ï¼Œä½†å®ƒæ²¡æœ‰å®šä¹‰ä¸€å¥—æ ‡å‡†çš„æ•°æ®ç±»å‹ï¼Œæ›´æ²¡æœ‰è¯´æ€ä¹ˆå»æ‰©å±•è¿™å¥—æ•°æ®ç±»å‹ã€‚ä¾‹å¦‚ï¼Œæ•´å½¢æ•°åˆ°åº•ä»£è¡¨ä»€ä¹ˆï¼Ÿ16ä½ï¼Œ32ä½ï¼Œ64ä½ï¼Ÿè¿™äº›ç»†èŠ‚å¯¹å®ç°äº’æ“ä½œæ€§å¾ˆé‡è¦ã€‚XML Schema(XSD)å°±æ˜¯ä¸“é—¨è§£å†³è¿™ä¸ªé—®é¢˜çš„ä¸€å¥—æ ‡å‡†ã€‚å®ƒå®šä¹‰äº†ä¸€å¥—æ ‡å‡†çš„æ•°æ®ç±»å‹ï¼Œå¹¶ç»™å‡ºäº†ä¸€ç§è¯­è¨€æ¥æ‰©å±•è¿™å¥—æ•°æ®ç±»å‹ã€‚WebServiceå¹³å°å°±æ˜¯ç”¨XSDæ¥ä½œä¸ºå…¶æ•°æ®ç±»å‹ç³»ç»Ÿçš„ã€‚å½“ä½ ç”¨æŸç§è¯­è¨€(å¦‚VB.NETæˆ–C#)æ¥æ„é€ ä¸€ä¸ªWeb serviceæ—¶ï¼Œä¸ºäº†ç¬¦åˆWebServiceæ ‡å‡†ï¼Œæ‰€æœ‰ä½ ä½¿ç”¨çš„æ•°æ®ç±»å‹éƒ½å¿…é¡»è¢«è½¬æ¢ä¸ºXSDç±»å‹ã€‚ä½ ç”¨çš„å·¥å…·å¯èƒ½å·²ç»è‡ªåŠ¨å¸®ä½ å®Œæˆäº†è¿™ä¸ªè½¬æ¢ï¼Œä½†ä½ å¾ˆå¯èƒ½ä¼šæ ¹æ®ä½ çš„éœ€è¦ä¿®æ”¹ä¸€ä¸‹è½¬æ¢è¿‡ç¨‹ã€‚SOAPWebServiceé€šè¿‡HTTPåè®®å‘é€è¯·æ±‚å’Œæ¥æ”¶ç»“æœæ—¶ï¼Œå‘é€çš„è¯·æ±‚å†…å®¹å’Œç»“æœå†…å®¹éƒ½é‡‡ç”¨XMLæ ¼å¼å°è£…ï¼Œå¹¶å¢åŠ äº†ä¸€äº›ç‰¹å®šçš„HTTPæ¶ˆæ¯å¤´ï¼Œä»¥è¯´æ˜HTTPæ¶ˆæ¯çš„å†…å®¹æ ¼å¼ï¼Œè¿™äº›ç‰¹å®šçš„HTTPæ¶ˆæ¯å¤´å’ŒXMLå†…å®¹æ ¼å¼å°±æ˜¯SOAPåè®®ã€‚SOAPæä¾›äº†æ ‡å‡†çš„RPCæ–¹æ³•æ¥è°ƒç”¨Web Serviceã€‚SOAPåè®® = HTTPåè®® + XMLæ•°æ®æ ¼å¼SOAPåè®®å®šä¹‰äº†SOAPæ¶ˆæ¯çš„æ ¼å¼ï¼ŒSOAPåè®®æ˜¯åŸºäºHTTPåè®®çš„ï¼ŒSOAPä¹Ÿæ˜¯åŸºäºXMLå’ŒXSDçš„ï¼ŒXMLæ˜¯SOAPçš„æ•°æ®ç¼–ç æ–¹å¼ã€‚æ‰“ä¸ªæ¯”å–»ï¼šHTTPå°±æ˜¯æ™®é€šå…¬è·¯ï¼ŒXMLå°±æ˜¯ä¸­é—´çš„ç»¿è‰²éš”ç¦»å¸¦å’Œä¸¤è¾¹çš„é˜²æŠ¤æ ï¼ŒSOAPå°±æ˜¯æ™®é€šå…¬è·¯ç»è¿‡åŠ éš”ç¦»å¸¦å’Œé˜²æŠ¤æ æ”¹é€ è¿‡çš„é«˜é€Ÿå…¬è·¯ã€‚WSDLå¥½æ¯”æˆ‘ä»¬å»å•†åº—ä¹°ä¸œè¥¿ï¼Œé¦–å…ˆè¦çŸ¥é“å•†åº—é‡Œæœ‰ä»€ä¹ˆä¸œè¥¿å¯ä¹°ï¼Œç„¶åå†æ¥è´­ä¹°ï¼Œå•†å®¶çš„åšæ³•å°±æ˜¯å¼ è´´å¹¿å‘Šæµ·æŠ¥ã€‚ WebServiceä¹Ÿä¸€æ ·ï¼ŒWebServiceå®¢æˆ·ç«¯è¦è°ƒç”¨ä¸€ä¸ªWebServiceæœåŠ¡ï¼Œé¦–å…ˆè¦æœ‰çŸ¥é“è¿™ä¸ªæœåŠ¡çš„åœ°å€åœ¨å“ªï¼Œä»¥åŠè¿™ä¸ªæœåŠ¡é‡Œæœ‰ä»€ä¹ˆæ–¹æ³•å¯ä»¥è°ƒç”¨ï¼Œæ‰€ä»¥ï¼ŒWebServiceåŠ¡å™¨ç«¯é¦–å…ˆè¦é€šè¿‡ä¸€ä¸ªWSDLæ–‡ä»¶æ¥è¯´æ˜è‡ªå·±å®¶é‡Œæœ‰å•¥æœåŠ¡å¯ä»¥å¯¹å¤–è°ƒç”¨ï¼ŒæœåŠ¡æ˜¯ä»€ä¹ˆï¼ˆæœåŠ¡ä¸­æœ‰å“ªäº›æ–¹æ³•ï¼Œæ–¹æ³•æ¥å—çš„å‚æ•°æ˜¯ä»€ä¹ˆï¼Œè¿”å›å€¼æ˜¯ä»€ä¹ˆï¼‰ï¼ŒæœåŠ¡çš„ç½‘ç»œåœ°å€ç”¨å“ªä¸ªurlåœ°å€è¡¨ç¤ºï¼ŒæœåŠ¡é€šè¿‡ä»€ä¹ˆæ–¹å¼æ¥è°ƒç”¨ã€‚WSDL(Web Services Description Language)å°±æ˜¯è¿™æ ·ä¸€ä¸ªåŸºäºXMLçš„è¯­è¨€ï¼Œç”¨äºæè¿°Web ServiceåŠå…¶å‡½æ•°ã€å‚æ•°å’Œè¿”å›å€¼ã€‚å®ƒæ˜¯WebServiceå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯éƒ½èƒ½ç†è§£çš„æ ‡å‡†æ ¼å¼ã€‚å› ä¸ºæ˜¯åŸºäºXMLçš„ï¼Œæ‰€ä»¥WSDLæ—¢æ˜¯æœºå™¨å¯é˜…è¯»çš„ï¼Œåˆæ˜¯äººå¯é˜…è¯»çš„ï¼Œè¿™å°†æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„å¥½å¤„ã€‚ä¸€äº›æœ€æ–°çš„å¼€å‘å·¥å…·æ—¢èƒ½æ ¹æ®ä½ çš„Web serviceç”ŸæˆWSDLæ–‡æ¡£ï¼Œåˆèƒ½å¯¼å…¥WSDLæ–‡æ¡£ï¼Œç”Ÿæˆè°ƒç”¨ç›¸åº”WebServiceçš„ä»£ç†ç±»ä»£ç ã€‚WSDLæ–‡ä»¶ä¿å­˜åœ¨WebæœåŠ¡å™¨ä¸Šï¼Œé€šè¿‡ä¸€ä¸ªurlåœ°å€å°±å¯ä»¥è®¿é—®åˆ°å®ƒã€‚å®¢æˆ·ç«¯è¦è°ƒç”¨ä¸€ä¸ªWebServiceæœåŠ¡ä¹‹å‰ï¼Œè¦çŸ¥é“è¯¥æœåŠ¡çš„WSDLæ–‡ä»¶çš„åœ°å€ã€‚WebServiceæœåŠ¡æä¾›å•†å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼æ¥æš´éœ²å®ƒçš„WSDLæ–‡ä»¶åœ°å€ï¼š1.æ³¨å†Œåˆ°UDDIæœåŠ¡å™¨ï¼Œä»¥ä¾¿è¢«äººæŸ¥æ‰¾ï¼›2.ç›´æ¥å‘Šè¯‰ç»™å®¢æˆ·ç«¯è°ƒç”¨è€…ã€‚å¸¸è§é€šä¿¡åè®®æµ…è°ˆå‡ ç§é€šä¿¡æ–¹å¼(dubbo,webservice,restful)TCP/IP1TCP/IP åè®®æ˜¯ä¸€ä¸ªåè®®æ—ã€‚é‡Œé¢åŒ…æ‹¬å¾ˆå¤šåè®®ã€‚UDP åªæ˜¯å…¶ä¸­çš„ä¸€ä¸ªã€‚å› ä¸ºTCP/IPæ¯”è¾ƒé‡è¦æ‰€ä»¥ç”¨ä»–ä¸¤å‘½åã€‚TCPå’ŒUDP12tcpå’Œudpéƒ½æ˜¯ä¼ è¾“åè®®ï¼Œä¸»è¦åŒºåˆ«æ˜¯tcpåè®®è¿æ¥éœ€è¦3æ¬¡æ¡æ‰‹ï¼Œæ–­å¼€éœ€è¦å››æ¬¡æ¡æ‰‹ï¼Œæ˜¯é€šè¿‡æµæ¥ä¼ è¾“çš„ï¼Œå°±æ˜¯ç¡®å®šè¿æ¥åï¼Œä¸€ç›´å‘é€ä¿¡æ¯ï¼Œä¼ å®Œåæ–­å¼€ã€‚udpä¸éœ€è¦è¿›è¡Œè¿æ¥ï¼Œç›´æ¥æŠŠä¿¡æ¯å°è£…æˆå¤šä¸ªæŠ¥æ–‡ï¼Œç›´æ¥å‘é€ã€‚æ‰€ä»¥udpçš„é€Ÿåº¦æ›´å¿«å†™ï¼Œä½†æ˜¯ä¸ä¿è¯æ•°æ®çš„å®Œæ•´æ€§å’Œæ•°æ®é¡ºåº(è¿™ä¸ªæ˜¯å¯ä»¥åœ¨å®ç°æ—¶é€šè¿‡éªŒè¯æ‰‹æ®µæ¥æ‰‹åŠ¨ç¡®å®šå®Œæ•´æ€§)ã€‚HTTP12httpåè®®æ˜¯å»ºç«‹åœ¨TCPåè®®ä¹‹ä¸Šçš„ä¸€ç§åº”ç”¨ï¼Œæ˜¯Webè”ç½‘çš„åŸºç¡€ï¼Œæœ€æ˜¾è‘—çš„ç‰¹ç‚¹æ˜¯å®¢æˆ·ç«¯å‘é€çš„æ¯æ¬¡è¯·æ±‚éƒ½éœ€è¦æœåŠ¡å™¨å›é€å“åº”ï¼Œåœ¨è¯·æ±‚ç»“æŸåï¼Œä¼šä¸»åŠ¨é‡Šæ”¾è¿æ¥ã€‚ä»å»ºç«‹è¿æ¥åˆ°å…³é—­è¿æ¥çš„è¿‡ç¨‹ç§°ä¸ºâ€œä¸€æ¬¡è¿æ¥â€ã€‚SOCKET12socketå¹¶ä¸æ˜¯ä¸€ç§åè®®ï¼Œæ˜¯åœ¨ç¨‹åºå‘˜å±‚é¢ä¸Šå¯¹TCP/IPåè®®çš„å°è£…å’Œåº”ç”¨ã€‚å…¶å®æ˜¯ä¸€ä¸ªè°ƒç”¨æ¥å£ï¼Œæ–¹ä¾¿ç¨‹åºå‘˜ä½¿ç”¨TCP/IPåè®®æ ˆè€Œå·²ã€‚ç¨‹åºå‘˜é€šè¿‡socketæ¥ä½¿ç”¨tcp/ipåè®®ã€‚ä½†æ˜¯socketå¹¶ä¸æ˜¯ä¸€å®šè¦ä½¿ç”¨tcp/ipåè®®ï¼ŒSocketç¼–ç¨‹æ¥å£åœ¨è®¾è®¡çš„æ—¶å€™ï¼Œå°±å¸Œæœ›ä¹Ÿèƒ½é€‚åº”å…¶ä»–çš„ç½‘ç»œåè®®ã€‚RPC12RPC(Remote Procedure Call)â€”è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼Œå®ƒæ˜¯ä¸€ç§é€šè¿‡ç½‘ç»œä»è¿œç¨‹è®¡ç®—æœºç¨‹åºä¸Šè¯·æ±‚æœåŠ¡ï¼Œè€Œä¸éœ€è¦äº†è§£åº•å±‚ç½‘ç»œæŠ€æœ¯çš„åè®®ã€‚RPCåè®®å‡å®šæŸäº›ä¼ è¾“åè®®çš„å­˜åœ¨ï¼Œå¦‚TCPæˆ–UDPï¼Œä¸ºé€šä¿¡ç¨‹åºä¹‹é—´æºå¸¦ä¿¡æ¯æ•°æ®ã€‚åœ¨OSIç½‘ç»œé€šä¿¡æ¨¡å‹ä¸­ï¼ŒRPCè·¨è¶Šäº†ä¼ è¾“å±‚å’Œåº”ç”¨å±‚ã€‚RPCä½¿å¾—å¼€å‘åŒ…æ‹¬ç½‘ç»œåˆ†å¸ƒå¼å¤šç¨‹åºåœ¨å†…çš„åº”ç”¨ç¨‹åºæ›´åŠ å®¹æ˜“ã€‚SOAP1ç®€å•å¯¹è±¡è®¿é—®åè®®æ˜¯äº¤æ¢æ•°æ®çš„ä¸€ç§åè®®è§„èŒƒï¼Œæ˜¯ä¸€ç§è½»é‡çš„ã€ç®€å•çš„ã€åŸºäºXMLï¼ˆæ ‡å‡†é€šç”¨æ ‡è®°è¯­è¨€ä¸‹çš„ä¸€ä¸ªå­é›†ï¼‰çš„åè®®ï¼Œå®ƒè¢«è®¾è®¡æˆåœ¨WEBä¸Šäº¤æ¢ç»“æ„åŒ–çš„å’Œå›ºåŒ–çš„ä¿¡æ¯ã€‚å¸¸è§é€šä¿¡æ–¹å¼Webservice1&gt;æ•ˆç‡ä¸é«˜åŸºäºsoapåè®®ï¼Œå…¶ä¸»è¦çš„ç‰¹ç‚¹æ˜¯è·¨è¯­è¨€ã€è·¨å¹³å°çš„ã€‚é¡¹ç›®ä¸­ä¸æ¨èä½¿ç”¨ï¼Œå¯ç”¨äºä¸åŒå…¬å¸é—´æ¥å£çš„è°ƒç”¨ã€‚restful1&gt;http+jsonã€‚å¾ˆå¤šé¡¹ç›®ä¸­åº”ç”¨ã€‚å¦‚æœæœåŠ¡å¤ªå¤šï¼ŒæœåŠ¡ä¹‹é—´è°ƒç”¨å…³ç³»æ··ä¹±ï¼Œéœ€è¦æ²»ç–—æœåŠ¡ã€‚dubbo1&gt;ä½¿ç”¨rpcåè®®è¿›è¡Œè¿œç¨‹è°ƒç”¨ï¼Œç›´æ¥ä½¿ç”¨socketé€šä¿¡ã€‚ä¼ è¾“æ•ˆç‡é«˜ï¼Œå¹¶ä¸”å¯ä»¥ç»Ÿè®¡å‡ºç³»ç»Ÿä¹‹é—´çš„è°ƒç”¨å…³ç³»ã€è°ƒç”¨æ¬¡æ•°ã€‚ä½¿ç”¨Javaè¯­è¨€å¼€å‘ï¼Œåªèƒ½ç”¨äºJavaè¯­è¨€å¼€å‘çš„é¡¹ç›®é—´çš„é€šä¿¡ï¼Œä¸å…·å¤‡è·¨è¯­è¨€ï¼Œè·¨å¹³å°çš„ç‰¹ç‚¹ï¼webserviceä¹‹Restfulé£æ ¼webserviceä¹‹Restfulé£æ ¼12&gt;ä½¿ç”¨restfulé£æ ¼çš„webservice ä¹Ÿå°±æ˜¯cxfå‘å¸ƒçš„webserviceçš„åœ°å€æ˜¯restfulé£æ ¼çš„&gt;ä½¿ç”¨restfulé£æ ¼å‘å¸ƒçš„webserviceä¸é‡‡ç”¨soapåè®® ï¼Œè½»é‡çº§ é€Ÿåº¦å¿«ï¼Œé‡‡ç”¨httpä¼ è¾“åè®®ã€‚SOAP webserivce å’Œ RESTful webservice å¯¹æ¯”åŠåŒºåˆ« RESTfulè·ŸWebServiceçš„åŒºåˆ«webserver/servletå®¹å™¨å…³äºtomcatå’Œjettyå¯¹æ¯”(ä¸å–œæ¬¢jettyçš„å‹¿çœ‹)tomcatä¸jettyçš„åŒºåˆ«Jettyç¯‡ä¸€ä¹‹åˆè¯†Jettyç›¸åŒç‚¹Tomcatå’ŒJettyéƒ½æ˜¯ä¸€ç§Servletå¼•æ“ï¼Œä»–ä»¬éƒ½æ”¯æŒæ ‡å‡†çš„servletè§„èŒƒå’ŒJavaEEçš„è§„èŒƒã€‚ æ¶æ„æ¯”è¾ƒJettyçš„æ¶æ„æ¯”Tomcatçš„æ›´ä¸ºç®€å•ã€‚Jettyçš„æ¶æ„æ˜¯åŸºäºHandleræ¥å®ç°çš„ï¼Œä¸»è¦çš„æ‰©å±•åŠŸèƒ½éƒ½å¯ä»¥ç”¨Handleræ¥å®ç°ï¼Œæ‰©å±•ç®€å•ã€‚Tomcatçš„æ¶æ„æ˜¯åŸºäºå®¹å™¨è®¾è®¡çš„ï¼Œè¿›è¡Œæ‰©å±•æ˜¯éœ€è¦äº†è§£Tomcatçš„æ•´ä½“è®¾è®¡ç»“æ„ï¼Œä¸æ˜“æ‰©å±•ã€‚æ€§èƒ½æ¯”è¾ƒJettyå’ŒTomcatæ€§èƒ½æ–¹é¢å·®å¼‚ä¸å¤§ã€‚Jettyå¯ä»¥åŒæ—¶å¤„ç†å¤§é‡è¿æ¥è€Œä¸”å¯ä»¥é•¿æ—¶é—´ä¿æŒè¿æ¥ï¼Œé€‚åˆäºwebèŠå¤©åº”ç”¨ç­‰ç­‰ã€‚Jettyçš„æ¶æ„ç®€å•ï¼Œå› æ­¤ä½œä¸ºæœåŠ¡å™¨ï¼ŒJettyå¯ä»¥æŒ‰éœ€åŠ è½½ç»„ä»¶ï¼Œå‡å°‘ä¸éœ€è¦çš„ç»„ä»¶ï¼Œå‡å°‘äº†æœåŠ¡å™¨å†…å­˜å¼€é”€ï¼Œä»è€Œæé«˜æœåŠ¡å™¨æ€§èƒ½ã€‚Jettyé»˜è®¤é‡‡ç”¨NIOç»“æŸåœ¨å¤„ç†I/Oè¯·æ±‚ä¸Šæ›´å ä¼˜åŠ¿ï¼Œåœ¨å¤„ç†é™æ€èµ„æºæ—¶ï¼Œæ€§èƒ½è¾ƒé«˜ã€‚Tomcaté€‚åˆå¤„ç†å°‘æ•°éå¸¸ç¹å¿™çš„é“¾æ¥ï¼Œä¹Ÿå°±æ˜¯è¯´é“¾æ¥ç”Ÿå‘½å‘¨æœŸçŸ­çš„è¯ï¼ŒTomcatçš„æ€»ä½“æ€§èƒ½æ›´é«˜ã€‚Tomcaté»˜è®¤é‡‡ç”¨BIOå¤„ç†I/Oè¯·æ±‚ï¼Œåœ¨å¤„ç†é™æ€èµ„æºæ—¶ï¼Œæ€§èƒ½è¾ƒå·®ã€‚å…¶å®ƒæ¯”è¾ƒJettyçš„åº”ç”¨æ›´åŠ å¿«é€Ÿï¼Œä¿®æ”¹ç®€å•ï¼Œå¯¹æ–°çš„Servletè§„èŒƒçš„æ”¯æŒè¾ƒå¥½ã€‚Tomcatç›®å‰åº”ç”¨æ¯”è¾ƒå¹¿æ³›ï¼Œå¯¹JavaEEå’ŒServletçš„æ”¯æŒæ›´åŠ å…¨é¢ï¼Œå¾ˆå¤šç‰¹æ€§ä¼šç›´æ¥é›†æˆè¿›æ¥ã€‚Google é€‰æ‹© Jetty, æ”¾å¼ƒ TomcatJettyçš„åŸºæœ¬æ¶æ„&gt;Tomcatçš„åŸºæœ¬æ¶æ„ä¸åŒå¼€å‘å®ç°&gt;&gt;&gt;èŠ±äº†è¿‘åå¹´çš„æ—¶é—´ï¼Œæ•´ç†å‡ºå²ä¸Šæœ€å…¨é¢Javaé¢è¯•é¢˜</content>
	</entry>
	<entry>
		<title>JavaåŸºç¡€_å››èˆäº”å…¥</title>
		<url>/article/48f373f3.html</url>
		<content>å››èˆäº”å…¥1234567891011121314151617181920212223242526272829303132333435363738394041424344454647ROUND_UPï¼šè¿œç¦»é›¶æ–¹å‘èˆå…¥ã€‚å‘ç»å¯¹å€¼æœ€å¤§çš„æ–¹å‘èˆå…¥ï¼Œåªè¦èˆå¼ƒä½é0å³è¿›ä½ã€‚ROUND_DOWNï¼šè¶‹å‘é›¶æ–¹å‘èˆå…¥ã€‚å‘ç»å¯¹å€¼æœ€å°çš„æ–¹å‘è¾“å…¥ï¼Œæ‰€æœ‰çš„ä½éƒ½è¦èˆå¼ƒï¼Œä¸å­˜åœ¨è¿›ä½æƒ…å†µã€‚ROUND_CEILINGï¼šå‘æ­£æ— ç©·æ–¹å‘èˆå…¥ã€‚å‘æ­£æœ€å¤§æ–¹å‘é æ‹¢ã€‚è‹¥æ˜¯æ­£æ•°ï¼Œèˆå…¥è¡Œä¸ºç±»ä¼¼äºROUND_UPï¼Œè‹¥ä¸ºè´Ÿæ•°ï¼Œèˆå…¥è¡Œä¸ºç±»ä¼¼äºROUND_DOWNã€‚Math.round()æ–¹æ³•å°±æ˜¯ä½¿ç”¨çš„æ­¤æ¨¡å¼ã€‚ROUND_FLOORï¼šå‘è´Ÿæ— ç©·æ–¹å‘èˆå…¥ã€‚å‘è´Ÿæ— ç©·æ–¹å‘é æ‹¢ã€‚è‹¥æ˜¯æ­£æ•°ï¼Œèˆå…¥è¡Œä¸ºç±»ä¼¼äºROUND_DOWNï¼›è‹¥ä¸ºè´Ÿæ•°ï¼Œèˆå…¥è¡Œä¸ºç±»ä¼¼äºROUND_UPã€‚HALF_UPï¼šæœ€è¿‘æ•°å­—èˆå…¥(5è¿›)ã€‚è¿™æ˜¯æˆ‘ä»¬æœ€ç»å…¸çš„å››èˆäº”å…¥ã€‚HALF_DOWNï¼šæœ€è¿‘æ•°å­—èˆå…¥(5èˆ)ã€‚åœ¨è¿™é‡Œ5æ˜¯è¦èˆå¼ƒçš„ã€‚HAIL_EVENï¼šé“¶è¡Œå®¶èˆå…¥æ³•ã€‚public class Test {    public static void main(String[] args) {        double a = 1.66728D;        double b = 1.33333D;        double c = 1.00000D;        BigDecimal aa = new BigDecimal(a);        BigDecimal bb = new BigDecimal(b);        BigDecimal cc = new BigDecimal(c);        System.out.println(aa.setScale(2, BigDecimal.ROUND_UP));        System.out.println(aa.setScale(2, BigDecimal.ROUND_DOWN));        System.out.println(bb.setScale(2, BigDecimal.ROUND_UP));        System.out.println(bb.setScale(2, BigDecimal.ROUND_DOWN));        System.out.println(cc.setScale(2, BigDecimal.ROUND_UP));        System.out.println(cc.setScale(2, BigDecimal.ROUND_DOWN));        System.out.println(&quot;-------------------------------------&quot;);        System.out.println(aa.setScale(2, RoundingMode.UP));        System.out.println(aa.setScale(2, RoundingMode.DOWN));        System.out.println(bb.setScale(2, RoundingMode.UP));        System.out.println(bb.setScale(2, RoundingMode.DOWN));        System.out.println(cc.setScale(2, RoundingMode.UP));        System.out.println(cc.setScale(2, RoundingMode.DOWN));    }}1.671.661.341.331.001.00-------------------------------------1.671.661.341.331.001.00</content>
	</entry>
	<entry>
		<title>JavaåŸºç¡€_å¯¹è±¡æ­£ååºåˆ—åŒ–</title>
		<url>/article/336a2a82.html</url>
		<content>å¯¹è±¡æ­£ååºåˆ—åŒ–123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687import java.io.*;import java.util.Base64;/** * å¯¹è±¡ç¼–ç å·¥å…·ç±» */public class ObjEncodeUtil {    public static String encodeBase64(Object object) {        if (object == null) {            return null;        }        ObjectOutputStream oos = null;        String result;        try {            ByteArrayOutputStream bos = new ByteArrayOutputStream();            oos = new ObjectOutputStream(bos);            oos.writeObject(object);            result = Base64.getEncoder().encodeToString(bos.toByteArray());        } catch (IOException e) {            throw new RuntimeException(e);        } finally {            try {                if (oos != null) {                    oos.close();                }            } catch (IOException e) {                e.printStackTrace();            }        }        return result;    }    public static &lt;T&gt; T decodeBase64(String str) {        ObjectInputStream ois = null;        T result;        try {            ByteArrayInputStream bis = new ByteArrayInputStream(Base64.getDecoder().decode(str));            ois = new ObjectInputStream(bis);            result = (T) ois.readObject();        } catch (IOException | ClassNotFoundException e) {            throw new RuntimeException(e);        } finally {            if (ois != null) {                try {                    ois.close();                } catch (IOException e) {                    e.printStackTrace();                }            }        }        return result;    }}class Bean{        int length;        double width;        public Bean() {        }        public Bean(int length, double width) {            this.length = length;            this.width = width;        }        public int getLength() {            return length;        }        public void setLength(int length) {            this.length = length;        }        public double getWidth() {            return width;        }        public void setWidth(double width) {            this.width = width;        }    }Bean bean = new Bean(5,3.2);String modelStr = ObjEncodeUtil.encodeBase64(bean);Bean bean2 = ObjEncodeUtil.decodeBase64(modelStr);123456import com.alibaba.fastjson.JSON;ModelBean bean = new ModelBean();String jsonResult = JSON.toJSONString(bean);ModelBean bean2 = JSON.parseObject(jsonResult, ModelBean.class);</content>
	</entry>
	<entry>
		<title>JavaåŸºç¡€_æ‰“jaråŒ…</title>
		<url>/article/e4e21ef8.html</url>
		<content>è¯¦ç»†æ­¥éª¤assembly.xml12345678910111213141516171819202122232425&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;assembly        xmlns=&quot;http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.3&quot;        xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;        xsi:schemaLocation=&quot;http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.3 http://maven.apache.org/xsd/assembly-1.1.3.xsd&quot;&gt;    &lt;id&gt;test&lt;/id&gt;    &lt;formats&gt;        &lt;format&gt;jar&lt;/format&gt;    &lt;/formats&gt;    &lt;includeBaseDirectory&gt;false&lt;/includeBaseDirectory&gt;    &lt;fileSets&gt;        &lt;!--å°†æµ‹è¯•ç±»å’Œåº”ç”¨éƒ½æ‰“åŒ…è¿›jaråŒ…--&gt;        &lt;fileSet&gt;            &lt;directory&gt;${project.build.directory}/test-classes&lt;/directory&gt;            &lt;outputDirectory&gt;/&lt;/outputDirectory&gt;            &lt;includes&gt;                &lt;include&gt;**/*.class&lt;/include&gt;                &lt;include&gt;**/*.properties&lt;/include&gt;                &lt;include&gt;**/*.xml&lt;/include&gt;            &lt;/includes&gt;            &lt;useDefaultExcludes&gt;false&lt;/useDefaultExcludes&gt;        &lt;/fileSet&gt;    &lt;/fileSets&gt;&lt;/assembly&gt;pom.xml1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0         http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;    &lt;parent&gt;        &lt;groupId&gt;com.code.hyc&lt;/groupId&gt;        &lt;artifactId&gt;test&lt;/artifactId&gt;        &lt;version&gt;1.0&lt;/version&gt;    &lt;/parent&gt;    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;    &lt;artifactId&gt;hycCall&lt;/artifactId&gt;    &lt;packaging&gt;jar&lt;/packaging&gt;    &lt;!--æ„å»ºé…ç½®ï¼Œä¸è¦åˆ ï¼Œéœ€è¦çš„è¯æ‰“å¼€--&gt;    &lt;build&gt;        &lt;plugins&gt;            &lt;!--æ‰“æˆå¯æ‰§è¡ŒjaråŒ…--&gt;            &lt;plugin&gt;                &lt;artifactId&gt;maven-assembly-plugin&lt;/artifactId&gt;                &lt;version&gt;2.3&lt;/version&gt;                &lt;configuration&gt;                    &lt;descriptor&gt;src/main/resources/assembly.xml&lt;/descriptor&gt;                &lt;/configuration&gt;                &lt;executions&gt;                    &lt;execution&gt;                        &lt;id&gt;make-assembly&lt;/id&gt;                        &lt;phase&gt;package&lt;/phase&gt;                        &lt;goals&gt;                            &lt;goal&gt;single&lt;/goal&gt;                        &lt;/goals&gt;                        &lt;configuration&gt;                            &lt;archive&gt;                                &lt;manifest&gt;                                    &lt;!--è¯¥å¤„è®¾ç½®ä¸ºè¦æ‰§è¡Œçš„ä¸»ç±»--&gt;                                    &lt;mainClass&gt;                                        com.code.hyc.HycTest                                    &lt;/mainClass&gt;                                &lt;/manifest&gt;                            &lt;/archive&gt;                        &lt;/configuration&gt;                    &lt;/execution&gt;                &lt;/executions&gt;            &lt;/plugin&gt;            &lt;!--ä¾èµ–å¯¼å‡ºæ’ä»¶--&gt;            &lt;plugin&gt;                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;                &lt;artifactId&gt;maven-dependency-plugin&lt;/artifactId&gt;                &lt;executions&gt;                    &lt;execution&gt;                        &lt;id&gt;copy-dependencies&lt;/id&gt;                        &lt;phase&gt;package&lt;/phase&gt;                        &lt;goals&gt;                            &lt;goal&gt;copy-dependencies&lt;/goal&gt;                        &lt;/goals&gt;                        &lt;configuration&gt;                            &lt;outputDirectory&gt;${project.build.directory}/lib&lt;/outputDirectory&gt;                            &lt;excludeTransitive&gt;false&lt;/excludeTransitive&gt;                            &lt;stripVersion&gt;true&lt;/stripVersion&gt;                        &lt;/configuration&gt;                    &lt;/execution&gt;                &lt;/executions&gt;            &lt;/plugin&gt;        &lt;/plugins&gt;    &lt;/build&gt;&lt;/project&gt;HycTest.java12345public class HycTest{    public static void main(String[] args) throws Throwable {        System.out.println(&quot;æ‰“åŒ…æˆåŠŸï¼&quot;);    }}æ‰§è¡Œmaven-&gt;clean-&gt;packageåœ¨targetå°†hycCall.jarç§»åŠ¨åˆ°libæ–‡ä»¶å¤¹ä¸‹ï¼Œæ­¤æ—¶libæ–‡ä»¶å¤¹å’ŒhycCal-testl.jarå°±æ˜¯å¯ä»¥æ‰§è¡Œçš„jaråŒ…äº†å‘½ä»¤è¡Œ1234567891011121314// å‘½ä»¤è¡Œdebugæ¨¡å¼(-Xms4G -Xmx8G -XX:PermSize=4G -XX:MaxPermSize=8Gä¸ºæŒ‡å®šå†…å­˜å¤§å°)java -Xdebug -Xrunjdwp:transport=dt_socket,address=5005,server=y,suspend=y -jar -Xms4G -Xmx8G -XX:PermSize=4G -XX:MaxPermSize=8G -Djava.ext.dirs=./lib mist-calculate-1.0-test.jar// åå°æ‰§è¡Œæ¨¡å¼(nohup xxx &amp;)nohup java -jar -Xms4G -Xmx8G -XX:PermSize=4G -XX:MaxPermSize=8G -Djava.ext.dirs=./lib mist-calculate-1.0-test.jar &amp;// æ—¥å¿—æŸ¥çœ‹tail -10f nohup.out// æŸ¥çœ‹javaå‘½ä»¤çš„è¿›ç¨‹ps -a | grep java// æ€æ­»æŒ‡å®šçº¿ç¨‹å·kill -9  çº¿ç¨‹å·</content>
	</entry>
	<entry>
		<title>JavaåŸºç¡€_æ­£åˆ™åŒ¹é…</title>
		<url>/article/6d8205e4.html</url>
		<content>æ­£åˆ™åŒ¹é…</content>
	</entry>
	<entry>
		<title>JavaåŸºç¡€_æ³›å‹</title>
		<url>/article/73fcdf9d.html</url>
		<content>æ³›å‹</content>
	</entry>
	<entry>
		<title>JavaåŸºç¡€_è§£æä¸ç”ŸæˆXML</title>
		<url>/article/7543a0fc.html</url>
		<content>è§£æä¸ç”ŸæˆXMLJavaç”Ÿæˆxmlæ–‡ä»¶çš„å››ç§æ–¹å¼å››ç§ç”Ÿæˆå’Œè§£æXMLæ–‡æ¡£çš„æ–¹æ³•è¯¦è§£ï¼ˆä»‹ç»+ä¼˜ç¼ºç‚¹æ¯”è¾ƒ+ç¤ºä¾‹ï¼‰Java è‡ªå®šä¹‰ç”Ÿæˆä¸è§£æï¼ˆDom4Jï¼‰XML æ–‡ä»¶12345å››ç§æ–¹å¼æ€»ç»“:    1.domåŸºäºtreeï¼ŒsaxåŸºäºäº‹ä»¶ï¼ŒJDOMå’ŒDOM4JåŸºäºåº•å±‚API    2.domç”Ÿæˆçš„å†…å®¹ä¼šä¿å­˜åˆ°å†…å­˜ä¸­ï¼Œæ–¹ä¾¿åˆ é™¤å’Œä¿®æ”¹    3.saxä¸èƒ½ä¿®æ”¹å·²ç»ç”Ÿæˆçš„æ ‡ç­¾     4.æ·»åŠ JUnitåœ¨Librariesé€‰æ‹©Add Libraryä¸­çš„JUnitå³å¯ã€DOMã€‘DOMæ–¹å¼ç”Ÿæˆxmlæ˜¯åŸºäºDOMæ ‘çš„ç»“æ„ï¼Œæ•´ä¸ªDOMæ ‘ä¼šå­˜åœ¨å†…å­˜ä¸­ï¼Œæ‰€ä»¥ä½¿ç”¨DOMæ–¹å¼å¯ä»¥é¢‘ç¹çš„ä¿®æ”¹xmlçš„å†…å®¹ï¼Œä½†æ˜¯å› ä¸ºDOMæ ‘æ˜¯å­˜åœ¨å†…å­˜ä¸­çš„ï¼Œæ‰€ä»¥å¯¹å†…å­˜æ¶ˆè€—è¾ƒå¤§ã€‚DOMæ–¹å¼æ¯”è¾ƒé€‚ç”¨äºéœ€è¦é¢‘ç¹åˆ æ”¹çš„æƒ…å†µã€‚ã€SAXã€‘SAXæ–¹å¼ç”Ÿæˆxmlæ˜¯é€æ­¥å†™å…¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨SAXå†™å…¥æ—¶ï¼Œå·²ç»å†™å…¥çš„éƒ¨åˆ†æ˜¯æ— æ³•å†å›å¤´ä¿®æ”¹çš„ï¼Œå› ä¸ºSAXæ˜¯åŸºäºäº‹ä»¶é©±åŠ¨çš„ï¼Œåœ¨å†™å®Œä¸€ä¸ªæ ‡ç­¾ä¹‹åæ˜¯ä¸èƒ½å›å¤´çš„ï¼Œä¹Ÿå› æ­¤ï¼ŒSAXçš„æ•ˆç‡æ¯”è¾ƒå¿«ï¼Œä½†æ˜¯ä¸èƒ½è¿›è¡Œåˆ æ”¹ã€‚ã€JDOMã€‘JDOMæ–¹å¼ä¸æ˜¯Javaæä¾›çš„åŸºæœ¬çš„ç”Ÿæˆxmlæ–¹å¼ï¼Œä½¿ç”¨æ—¶éœ€è¦å¯¼å…¥é¢å¤–çš„jaråŒ…ï¼Œä½†æ˜¯å®ƒæ˜¯åŸºäºåŸºç¡€çš„APIå®ç°çš„ã€‚ã€DOM4Jã€‘DOM4Jæ–¹å¼ä¹Ÿä¸æ˜¯Javaæä¾›çš„åŸºæœ¬ç”Ÿæˆxmlçš„æ–¹å¼ï¼Œä½¿ç”¨æ—¶ä¹Ÿéœ€è¦å¯¼å…¥é¢å¤–çš„jaråŒ…ï¼Œå®ƒä¹Ÿæ˜¯åŸºäºåŸºç¡€çš„APIå®ç°çš„ï¼Œå®ƒåŠŸèƒ½å¼ºå¤§ï¼Œæ€§èƒ½ä¼˜å¼‚ï¼Œåœ¨å®é™…å¼€å‘ä¸­ç»å¸¸ä½¿ç”¨ã€‚DOMæ–¹å¼æ˜¯æœ€æ…¢çš„ï¼ŒSAXæ–¹å¼åè€Œæ˜¯æœ€å¿«çš„ï¼ŒDOM4Jæ–¹å¼ä»…æ¬¡äºSAXæ–¹å¼ã€‚Domæ–¹å¼&gt;&gt;1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798&gt;import org.junit.Test;&gt;import org.w3c.dom.DOMConfiguration;&gt;import org.w3c.dom.Document;&gt;import org.w3c.dom.Node;&gt;import org.w3c.dom.bootstrap.DOMImplementationRegistry;&gt;import org.w3c.dom.ls.DOMImplementationLS;&gt;import org.w3c.dom.ls.LSOutput;&gt;import org.w3c.dom.ls.LSSerializer;&gt;import org.xml.sax.InputSource;&gt;import javax.xml.parsers.DocumentBuilder;&gt;import javax.xml.parsers.DocumentBuilderFactory;&gt;import javax.xml.transform.Transformer;&gt;import javax.xml.transform.TransformerFactory;&gt;import javax.xml.transform.dom.DOMSource;&gt;import javax.xml.transform.stream.StreamResult;&gt;import java.io.ByteArrayOutputStream;&gt;import java.io.IOException;&gt;import java.io.StringReader;&gt;import java.util.ArrayList;&gt;import java.util.List;&gt;import java.io.File;&gt;import javax.xml.parsers.DocumentBuilder;&gt;import javax.xml.parsers.DocumentBuilderFactory;&gt;import javax.xml.transform.OutputKeys;&gt;import javax.xml.transform.Transformer;&gt;import javax.xml.transform.TransformerFactory;&gt;import javax.xml.transform.dom.DOMSource;&gt;import javax.xml.transform.stream.StreamResult;&gt;import org.junit.Test;&gt;import org.w3c.dom.Document;&gt;import org.w3c.dom.Element;&gt;public class DomXml {@Testpublic void test(){Long start = System.currentTimeMillis();createXml();System.out.println(&quot;è¿è¡Œæ—¶é—´ï¼š&quot;+ (System.currentTimeMillis() - start));}/**    * ç”Ÿæˆxmlæ–¹æ³•   */   public static void createXml() {       try {           // åˆ›å»ºè§£æå™¨å·¥å‚           DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();           DocumentBuilder db = factory.newDocumentBuilder();           Document document = db.newDocument();           // ä¸æ˜¾ç¤ºstandalone=&quot;no&quot;           document.setXmlStandalone(true);           Element bookstore = document.createElement(&quot;bookstore&quot;);           // å‘bookstoreæ ¹èŠ‚ç‚¹ä¸­æ·»åŠ å­èŠ‚ç‚¹book           Element book = document.createElement(&quot;book&quot;);           Element name = document.createElement(&quot;name&quot;);           // ä¸æ˜¾ç¤ºå†…å®¹ name.setNodeValue(&quot;ä¸å¥½ä½¿&quot;);           name.setTextContent(&quot;é›·ç¥&quot;);           book.appendChild(name);           // ä¸ºbookèŠ‚ç‚¹æ·»åŠ å±æ€§           book.setAttribute(&quot;id&quot;, &quot;1&quot;);           // å°†bookèŠ‚ç‚¹æ·»åŠ åˆ°bookstoreæ ¹èŠ‚ç‚¹ä¸­           bookstore.appendChild(book);           // å°†bookstoreèŠ‚ç‚¹ï¼ˆå·²åŒ…å«bookï¼‰æ·»åŠ åˆ°domæ ‘ä¸­           document.appendChild(bookstore);           // æ–¹å¼ä¸€: ä¿å­˜xmlæ–‡ä»¶           // åˆ›å»ºTransformerFactoryå¯¹è±¡&gt;//            TransformerFactory tff = TransformerFactory.newInstance();           // åˆ›å»º Transformerå¯¹è±¡&gt;//            Transformer tf = tff.newTransformer();           // è¾“å‡ºå†…å®¹æ˜¯å¦ä½¿ç”¨æ¢è¡Œ&gt;//            tf.setOutputProperty(OutputKeys.INDENT, &quot;yes&quot;);           // åˆ›å»ºxmlæ–‡ä»¶å¹¶å†™å…¥å†…å®¹&gt;//            tf.transform(new DOMSource(document), new StreamResult(new File(&quot;book1.xml&quot;)));&gt;//            System.out.println(&quot;ç”Ÿæˆbook1.xmlæˆåŠŸ&quot;);           // æ–¹å¼äºŒ: è½¬å­—ç¬¦ä¸²           // åˆ›å»ºTransformerFactoryå¯¹è±¡           TransformerFactory transformerFactory = TransformerFactory.newInstance();           // åˆ›å»ºTransformerå¯¹è±¡           Transformer transformer = transformerFactory.newTransformer();           // è®¾ç½®è¾“å‡ºæ•°æ®æ—¶æ¢è¡Œ           // tf.setOutputProperty(OutputKeys.INDENT, &quot;yes&quot;);           // xmlæ ¼å¼åŒ–           ByteArrayOutputStream bos = new ByteArrayOutputStream();           transformer.transform(new DOMSource(document), new StreamResult(bos));           String xmlString = bos.toString();           System.out.println(new String(prettyXml(xmlString)));       } catch (Exception e) {           e.printStackTrace();           System.out.println(&quot;ç”Ÿæˆbook1.xmlå¤±è´¥&quot;);       }   }&gt;}123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263/**    * æ ¼å¼åŒ–è¾“å‡º    *    * @param xmlStr: xmlæ–‡æ¡£å­—ç¬¦ä¸²    * @return æ ¼å¼åŒ–xml    */   private static byte[] prettyXml(String xmlStr) {       byte[] data = null;       StringReader stringReader = null;       try {           DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();           DocumentBuilder db = dbf.newDocumentBuilder();           stringReader = new StringReader(xmlStr);           InputSource is = new InputSource(stringReader);           Document doc = db.parse(is);           data = prettyXml(doc);       } catch (Exception e) {           throw new RuntimeException(e);       } finally {           if (stringReader != null) {               stringReader.close();           }       }       return data;   }   /**    * æ ¼å¼åŒ–è¾“å‡º    *    * @param node: æ–‡æ¡£æ ‘èŠ‚ç‚¹    * @return æ ¼å¼åŒ–å®Œçš„èŠ‚ç‚¹    */   private static byte[] prettyXml(Node node) {       ByteArrayOutputStream byteArrayOutputStream = null;       byte[] data = null;       try {           DOMImplementationRegistry registry = DOMImplementationRegistry.newInstance();           DOMImplementationLS impl = (DOMImplementationLS) registry.getDOMImplementation(&quot;XML 3.0&quot;);           LSSerializer serializer = impl.createLSSerializer();           DOMConfiguration domConfiguration = serializer.getDomConfig();           boolean isSupport = domConfiguration.canSetParameter(&quot;format-pretty-print&quot;, true);           if (isSupport) {               domConfiguration.setParameter(&quot;format-pretty-print&quot;, true);           }           LSOutput output = impl.createLSOutput();           output.setEncoding(&quot;UTF-8&quot;);           byteArrayOutputStream = new ByteArrayOutputStream();           output.setByteStream(byteArrayOutputStream);           serializer.write(node, output);           data = byteArrayOutputStream.toByteArray();       } catch (Exception e) {           throw new RuntimeException(e);       } finally {           if (byteArrayOutputStream != null) {               try {                   byteArrayOutputStream.close();               } catch (IOException e) {                   e.printStackTrace();               }           }       }       return data;   }123456&gt;&lt;?xml version=&quot;1.0&quot;encoding=&quot;UTF-8&quot;?&gt;&gt;&lt;bookstore&gt;   &lt;book id=&quot;1&quot;&gt;       &lt;name&gt;é›·ç¥&lt;/name&gt;   &lt;/book&gt;&gt;&lt;/bookstore&gt; Dom4jæ–¹å¼&gt;&gt;123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354&gt;import java.io.File;&gt;import java.io.FileOutputStream;&gt;import org.dom4j.Document;&gt;import org.dom4j.DocumentHelper;&gt;import org.dom4j.Element;&gt;import org.dom4j.io.OutputFormat;&gt;import org.dom4j.io.XMLWriter;&gt;import org.junit.Test;&gt;public class Dom4jXml {@Testpublic void test(){Long start = System.currentTimeMillis();createXml();System.out.println(&quot;è¿è¡Œæ—¶é—´ï¼š&quot;+ (System.currentTimeMillis() - start));}/** * ç”Ÿæˆxmlæ–¹æ³• */public static void createXml(){try {// 1ã€åˆ›å»ºdocumentå¯¹è±¡Document document = DocumentHelper.createDocument();// 2ã€åˆ›å»ºæ ¹èŠ‚ç‚¹rssElement rss = document.addElement(&quot;rss&quot;);// 3ã€å‘rssèŠ‚ç‚¹æ·»åŠ versionå±æ€§rss.addAttribute(&quot;version&quot;, &quot;2.0&quot;);// 4ã€ç”Ÿæˆå­èŠ‚ç‚¹åŠå­èŠ‚ç‚¹å†…å®¹Element channel = rss.addElement(&quot;channel&quot;);Element title = channel.addElement(&quot;title&quot;);title.setText(&quot;å›½å†…æœ€æ–°æ–°é—»&quot;);// 5ã€è®¾ç½®ç”Ÿæˆxmlçš„æ ¼å¼OutputFormat format = OutputFormat.createPrettyPrint();// è®¾ç½®ç¼–ç æ ¼å¼format.setEncoding(&quot;UTF-8&quot;);// 6ã€ç”Ÿæˆxmlæ–‡ä»¶File file = new File(&quot;rss.xml&quot;);XMLWriter writer = new XMLWriter(new FileOutputStream(file), format);// è®¾ç½®æ˜¯å¦è½¬ä¹‰ï¼Œé»˜è®¤ä½¿ç”¨è½¬ä¹‰å­—ç¬¦writer.setEscapeText(false);writer.write(document);writer.close();System.out.println(&quot;ç”Ÿæˆrss.xmlæˆåŠŸ&quot;);} catch (Exception e) {e.printStackTrace();System.out.println(&quot;ç”Ÿæˆrss.xmlå¤±è´¥&quot;);}}&gt;}JDomæ–¹å¼&gt;&gt;1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253&gt;import java.io.File;&gt;import java.io.FileOutputStream;&gt;import org.jdom.Document;&gt;import org.jdom.Element;&gt;import org.jdom.output.Format;&gt;import org.jdom.output.XMLOutputter;&gt;import org.junit.Test;&gt;public class JDomXml {@Testpublic void test(){Long start = System.currentTimeMillis();createXml();System.out.println(&quot;è¿è¡Œæ—¶é—´ï¼š&quot;+ (System.currentTimeMillis() - start));}/** * ç”Ÿæˆxmlæ–¹æ³• */public static void createXml(){try {// 1ã€ç”Ÿæˆä¸€ä¸ªæ ¹èŠ‚ç‚¹Element rss = new Element(&quot;rss&quot;);// 2ã€ä¸ºèŠ‚ç‚¹æ·»åŠ å±æ€§rss.setAttribute(&quot;version&quot;, &quot;2.0&quot;);// 3ã€ç”Ÿæˆä¸€ä¸ªdocumentå¯¹è±¡Document document = new Document(rss);Element channel = new Element(&quot;channel&quot;);rss.addContent(channel);Element title = new Element(&quot;title&quot;);title.setText(&quot;å›½å†…æœ€æ–°æ–°é—»&quot;);channel.addContent(title);Format format = Format.getCompactFormat();// è®¾ç½®æ¢è¡ŒTabæˆ–ç©ºæ ¼format.setIndent(&quot;&quot;);format.setEncoding(&quot;UTF-8&quot;);// 4ã€åˆ›å»ºXMLOutputterçš„å¯¹è±¡XMLOutputter outputer = new XMLOutputter(format);// 5ã€åˆ©ç”¨outputerå°†documentè½¬æ¢æˆxmlæ–‡æ¡£File file = new File(&quot;rssNew.xml&quot;);outputer.output(document, new FileOutputStream(file));System.out.println(&quot;ç”ŸæˆrssNew.xmlæˆåŠŸ&quot;);} catch (Exception e) {System.out.println(&quot;ç”ŸæˆrssNew.xmlå¤±è´¥&quot;);}}&gt;}Saxæ–¹å¼&gt;&gt;&gt;xmlè§£æ&gt;&gt;&gt;123import org.springframework.util.Assert;Assert.notNull(featureDataRow, &quot;æ•°æ®ä¸èƒ½ä¸ºç©º&quot;);   Assert.noNullElements(featureDataRow.getColumns().values().toArray(), &quot;è¯¥æ ·æœ¬å­˜åœ¨nullç‰¹å¾&quot;);</content>
	</entry>
	<entry>
		<title>JavaåŸºç¡€_è¯»å–é…ç½®æ–‡ä»¶</title>
		<url>/article/f3dd51e8.html</url>
		<content>è¯»å–é…ç½®æ–‡ä»¶è¯»å–propertiesé…ç½®æ–‡ä»¶propertiesç±»ä¸­çš„ä¸»è¦æ–¹æ³•1ï¼‰getProperty(String key)ç”¨æŒ‡å®šçš„é”®åœ¨æ­¤å±æ€§åˆ—è¡¨ä¸­æœç´¢å±æ€§ã€‚ä¹Ÿå°±æ˜¯é€šè¿‡å‚æ•°keyï¼Œå¾—åˆ°keyæ‰€å¯¹åº”çš„valueã€‚2ï¼‰load(InputStream inStream)ä»è¾“å…¥æµä¸­è¯»å–å±æ€§åˆ—è¡¨ï¼ˆé”®å’Œå…ƒç´ å¯¹ï¼‰ã€‚ä»¥ä¾›getProperty( String key)æ¥æœç´¢ã€‚3ï¼‰setProperty(String key, String value)è°ƒç”¨Hashtableçš„æ–¹æ³•put ã€‚ä»–é€šè¿‡è°ƒç”¨åŸºç±»çš„putæ–¹æ³•æ¥è®¾ç½®é”®-å€¼å¯¹ã€‚4ï¼‰store(OutputStream out, String comments)ä»¥é€‚åˆä½¿ç”¨loadæ–¹æ³•åŠ è½½åˆ°Propertiesè¡¨ä¸­çš„æ ¼å¼ï¼Œå°†æ­¤Propertiesè¡¨ä¸­çš„å±æ€§åˆ—è¡¨ï¼ˆé”®å’Œå…ƒç´ å¯¹ï¼‰å†™å…¥è¾“å‡ºæµã€‚ä¸loadæ–¹æ³•ç›¸åï¼Œè¯¥æ–¹æ³•å°†é”®-å€¼å¯¹å†™å…¥åˆ°æŒ‡å®šçš„æ–‡ä»¶ä¸­å»ã€‚5ï¼‰clear()æ¸…é™¤æ‰€æœ‰è£…è½½çš„é”®-å€¼å¯¹ã€‚è¯¥æ–¹æ³•åœ¨åŸºç±»ä¸­æä¾›12apple=src.main.java.per.hyc.ReflexAndInvokeTest.Appleorange=src.main.java.per.hyc.ReflexAndInvokeTest.Orange12345678910111213141516171819202122232425262728import java.io.File;import java.io.FileInputStream;import java.io.FileOutputStream;import java.util.Properties;/** * è·å–propertiesæ–‡ä»¶çš„é…ç½® */public class GetProperties {    public static Properties getPro(String pathname) {        Properties pro = new Properties();        File f = new File(pathname);        try {            if (f.exists()) {                pro.load(new FileInputStream(f));            }            //å»ºç«‹ä¸€ä¸ªæ–°çš„å±æ€§æ–‡ä»¶ï¼ŒåŒæ—¶è®¾ç½®å¥½é»˜è®¤å†…å®¹            else {                pro.setProperty(&quot;apple&quot;, &quot;per.hyc.ReflexAndInvokeTest.Apple&quot;);                pro.setProperty(&quot;orange&quot;, &quot;per.hyc.ReflexAndInvokeTest.Orange&quot;);                pro.store(new FileOutputStream(f), &quot;FRUIT CLASS&quot;);            }        } catch (Exception e) {            e.printStackTrace();        }        return pro;    }}è¯»å–xmlé…ç½®æ–‡ä»¶12345&lt;?xml version=&quot;1.0&quot;?&gt;&lt;config&gt;    &lt;className&gt;per.hyc.designPattern.Bridge.Blue&lt;/className&gt;    &lt;className&gt;per.hyc.designPattern.Bridge.SmallPen&lt;/className&gt;&lt;/config&gt;123456789101112131415161718192021222324252627282930313233343536import javax.xml.parsers.*;import org.w3c.dom.*;import java.io.*;/** * ä½¿ç”¨javaåå°„åˆ›å»ºå…·ä½“çš„é¢œè‰²å’Œç”»ç¬” */public class XMLUtilPen {    // è¯¥æ–¹æ³•ç”¨äºä»XMLé…ç½®æ–‡ä»¶ä¸­æå–å…·ä½“ç±»ç±»åï¼Œå¹¶è¿”å›ä¸€ä¸ªå®ä¾‹å¯¹è±¡    public static Object getBean(String args) {        try {            //åˆ›å»ºæ–‡æ¡£å¯¹è±¡            DocumentBuilderFactory dFactory = DocumentBuilderFactory.newInstance();            DocumentBuilder builder = dFactory.newDocumentBuilder();            Document doc;            doc = builder.parse(new File(&quot;.\\src\\main\\resources\\configPen.xml&quot;));            Node classNode = null;            NodeList nl = doc.getElementsByTagName(&quot;className&quot;);            if (args.equals(&quot;color&quot;)) {                //è·å–åŒ…å«ç±»åçš„æ–‡æœ¬èŠ‚ç‚¹                classNode = nl.item(0).getFirstChild();            } else if (args.equals(&quot;pen&quot;)) {                //è·å–åŒ…å«ç±»åçš„æ–‡æœ¬èŠ‚ç‚¹                classNode = nl.item(1).getFirstChild();            }            String cName = classNode.getNodeValue();            //é€šè¿‡ç±»åç”Ÿæˆå®ä¾‹å¯¹è±¡å¹¶å°†å…¶è¿”å›            return Class.forName(cName).newInstance();        } catch (Exception e) {            e.printStackTrace();            return null;        }    }}Spring è¯»å–propertiesæ–‡ä»¶Javaä¸­è¯»å–Propertiesé…ç½®æ–‡ä»¶çš„å‡ ç§æ–¹å¼@ConfigurationProperties(prefix = â€œstudentâ€)@ValueEnvironmentè¯¦è§é¡¹ç›®springbootdemoåˆ©ç”¨ç¬¬ä¸‰æ–¹é…ç½®å·¥å…·ownerè¯»å–é…ç½®æ–‡ä»¶</content>
	</entry>
	<entry>
		<title>JavaåŸºç¡€_é›†åˆ</title>
		<url>/article/d6e2fafb.html</url>
		<content>é›†åˆ</content>
	</entry>
	<entry>
		<title>Javaè¿›é˜¶</title>
		<url>/article/599c28b5.html</url>
		<content></content>
	</entry>
	<entry>
		<title>Javaè¿›é˜¶_æ³¨è§£</title>
		<url>/article/657dc990.html</url>
		<content>ã€é»‘é©¬ç¨‹åºå‘˜-Javaè¯­è¨€é«˜çº§éƒ¨åˆ†9.3ã€‘Java æ³¨è§£æ³¨è§£åŸºç¡€æ¦‚å¿µæ³¨é‡Šï¼šç”¨æ–‡å­—æè¿°ç¨‹åºçš„ï¼Œç»™ç¨‹åºå‘˜çœ‹çš„ç™¾åº¦ä¸Šçš„è§£é‡Šï¼šJava æ³¨è§£ï¼ˆAnnotationï¼‰åˆç§° Java æ ‡æ³¨ï¼Œæ˜¯ JDK5.0 å¼•å…¥çš„ä¸€ç§æ³¨é‡Šæœºåˆ¶ï¼Œæ˜¯ä¸€ç§ä»£ç çº§åˆ«çš„è¯´æ˜ã€‚Java è¯­è¨€ä¸­çš„ç±»ã€æ–¹æ³•ã€å˜é‡ã€å‚æ•°å’ŒåŒ…ç­‰éƒ½å¯ä»¥è¢«æ ‡æ³¨ã€‚å’Œ Javadoc ä¸åŒï¼ŒJava æ ‡æ³¨å¯ä»¥é€šè¿‡åå°„è·å–æ ‡æ³¨å†…å®¹ã€‚åœ¨ç¼–è¯‘å™¨ç”Ÿæˆç±»æ–‡ä»¶æ—¶ï¼Œæ ‡æ³¨å¯ä»¥è¢«åµŒå…¥åˆ°å­—èŠ‚ç ä¸­ã€‚Java è™šæ‹Ÿæœºå¯ä»¥ä¿ç•™æ ‡æ³¨å†…å®¹ï¼Œåœ¨è¿è¡Œæ—¶å¯ä»¥è·å–åˆ°æ ‡æ³¨å†…å®¹ ã€‚ å½“ç„¶å®ƒä¹Ÿæ”¯æŒè‡ªå®šä¹‰ Java æ ‡æ³¨ã€‚æ¦‚å¿µæè¿°ï¼šJDK1.5 ä¹‹åçš„æ–°ç‰¹æ€§ç”¨æ¥è¯´æ˜ç¨‹åºçš„ä½¿ç”¨æ³¨è§£ï¼š@æ³¨è§£åç§°ä½œç”¨åˆ†ç±»ç¼–è¯‘æ£€æŸ¥ï¼šé€šè¿‡ä»£ç é‡Œæ ‡è¯†çš„æ³¨è§£è®©ç¼–è¯‘å™¨èƒ½å¤Ÿå®ç°åŸºæœ¬çš„ç¼–è¯‘æ£€æŸ¥ã€Overrideã€‘ç¼–å†™æ–‡æ¡£ï¼šé€šè¿‡ä»£ç é‡Œæ ‡è¯†çš„æ³¨è§£ç”Ÿæˆæ–‡æ¡£ï¼ŒAPIæ–‡æ¡£æ˜¯é€šè¿‡æŠ½å–ä»£ç ä¸­çš„æ–‡æ¡£æ³¨é‡Šç”Ÿæˆçš„ã€‚ä»£ç åˆ†æï¼šé€šè¿‡ä»£ç é‡Œæ ‡è¯†çš„æ³¨è§£å¯¹ä»£ç è¿›è¡Œåˆ†æã€ä½¿ç”¨åå°„ã€‘å¤§å¤šæ•°æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨æ³¨è§£è€Œä¸æ˜¯è‡ªå®šä¹‰æ³¨è§£æ³¨è§£ç»™ç¼–è¯‘å™¨å’Œè§£æç¨‹åºç”¨æ³¨è§£ä¸æ˜¯ç¨‹åºçš„ä¸€éƒ¨åˆ†ï¼Œå¯ä»¥ç†è§£ä¸ºæ ‡ç­¾é¢„å®šä¹‰æ³¨è§£@Overrideï¼šæ£€æµ‹è¢«è¯¥æ³¨è§£æ ‡æ³¨çš„æ–¹æ³•æ˜¯å¦æœé›†ç»§æ‰¿è‡ªçˆ¶ç±»(æ¥å£)çš„ï¼Œå®šä¹‰åœ¨java.lang.Overrideä¸­ï¼Œæ­¤æ³¨é‡Šåªé€‚ç”¨äºä¿®è¾æ–¹æ³•ï¼Œè¡¨ç¤ºä¸€ä¸ªæ–¹æ³•å£°æ˜æ‰“ç®—é‡å†™è¶…ç±»ä¸­çš„å¦ä¸€ä¸ªæ–¹æ³•å£°æ˜@Deprecatedï¼šå°†è¯¥æ³¨è§£æ ‡æ³¨çš„å†…å®¹ï¼Œè¡¨ç¤ºå·²è¿‡æ—¶ï¼Œå®šä¹‰åœ¨java.lang.Deprecatedä¸­ï¼Œæ­¤æ³¨é‡Šå¯ä»¥ç”¨äºä¿®è¾æ–¹æ³•ï¼Œå±æ€§ï¼Œç±»ï¼Œè¡¨ç¤ºä¸é¼“åŠ±ç¨‹åºå‘˜ä½¿ç”¨è¿™æ ·çš„å…ƒç´ ï¼Œé€šå¸¸æ˜¯å› ä¸ºå®ƒå¾ˆå±é™©æˆ–è€…å­˜åœ¨æ›´å¥½çš„é€‰æ‹©@SuppressWarningsï¼šå‹åˆ¶è­¦å‘Šï¼Œä¸€èˆ¬ä¼ é€’å‚æ•°allï¼Œå®šä¹‰åœ¨java.lang.SuppressWarningsä¸­ï¼Œç”¨æ¥æŠ‘åˆ¶ç¼–è¯‘æ—¶çš„è­¦å‘Šä¿¡æ¯ã€‚ä¸å‰ä¸¤ä¸ªæ³¨é‡Šæœ‰æ‰€ä¸åŒï¼Œä½ éœ€è¦æ·»åŠ ä¸€ä¸ªå‚æ•°æ‰èƒ½æ­£ç¡®ä½¿ç”¨ï¼Œè¿™äº›å‚æ•°éƒ½æ˜¯å·²ç»å®šä¹‰å¥½äº†çš„ï¼Œæˆ‘ä»¬é€‰æ‹©æ€§çš„ä½¿ç”¨å°±å¥½äº†å¦‚@SuppressWarnings(â€œallâ€)ã€@SuppressWarnings(â€œallâ€)ã€@SuppressWarnings(â€œuncheckedâ€)ã€@SuppressWarnings(value={â€œuncheckedâ€,â€deprecationâ€})è‡ªå®šä¹‰æ³¨è§£åŸºæœ¬æ ¼å¼12&gt;@å…ƒæ³¨è§£&gt;public @interface æ³¨è§£åç§°{}æ³¨è§£çš„æœ¬è´¨: æ³¨è§£æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªæ¥å£ï¼Œè¯¥æ¥å£é»˜è®¤ç»§æ‰¿java.lang.annotation.Annotationæ¥å£123456789101112131415&gt;// å°†ä»¥ä¸‹æ³¨è§£ç¼–è¯‘è¿‡åè¿›è¡Œåç¼–è¯‘ï¼Œå¾—åˆ°ç»“æœï¼š&gt;// 1. ç¼–è¯‘å‰&gt;public @interface MyAnno{String name default &quot;hyc&quot;;    // æ¯ä¸€ä¸ªæ–¹æ³•å®é™…ä¸Šæ˜¯å£°æ˜äº†ä¸€ä¸ªé…ç½®å‚æ•°ï¼Œæœ¬è´¨ä¸Šæ˜¯æŠ½è±¡æ–¹æ³•   // æ–¹æ³•çš„åç§°å°±æ˜¯å‚æ•°çš„åç§°   // è¿”å›å€¼ç±»å‹å°±æ˜¯å‚æ•°çš„ç±»å‹ï¼ˆè¿”å›å€¼åªèƒ½æ˜¯åŸºæœ¬ç±»å‹ï¼Œæ³¨è§£ï¼ŒStringï¼ŒEnumï¼Œä»¥ä¸Šç±»å‹çš„æ•°ç»„)   // å¯ä»¥é€šè¿‡defaultæ¥å£°æ˜å‚æ•°çš„é»˜è®¤å€¼   // å¦‚æœåªæœ‰ä¸€ä¸ªå‚æ•°æˆå‘˜ï¼Œä¸€èˆ¬å‚æ•°åä¸ºvalueï¼Œé‚£ä¹ˆvalueå¯ä»¥çœç•¥ï¼Œç›´æ¥èµ‹å€¼å³å¯   // æ³¨è§£å…ƒç´ å¿…é¡»è¦æœ‰å€¼ï¼Œæˆ‘ä»¬å®šä¹‰æ³¨è§£å…ƒç´ æ—¶ï¼Œç»å¸¸ä½¿ç”¨ç©ºå­—ç¬¦ä¸²ï¼Œ0ä½œä¸ºé»˜è®¤å€¼   // æ•°ç»„èµ‹å€¼æ—¶ï¼Œå€¼ä½¿ç”¨å¤§æ‹¬å·åŒ…è£¹ï¼Œå¦‚æœæ•°ç»„ä¸­åªæœ‰ä¸€ä¸ªå€¼ï¼Œé‚£ä¹ˆ{}å¯ä»¥çœç•¥&gt;}&gt;// 2. åç¼–è¯‘å&gt;public interface MyAnno extends java.lang.annotation.Annotation{}å…ƒæ³¨è§£æ¦‚å¿µï¼šç”¨äºæè¿°æ³¨è§£çš„æ³¨è§£ã€‚å…ƒæ³¨è§£çš„ä½œç”¨å°±æ˜¯è´Ÿè´£æ³¨è§£å…¶ä»–æ³¨è§£ï¼ŒJavaå®šä¹‰äº†4ä¸ªæ ‡å‡†çš„meta-annotationç±»å‹ï¼Œä»–ä»¬è¢«ç”¨æ¥æä¾›å¯¹å…¶ä»–annotationç±»å‹ä½œè¯´æ˜ã€‚è¿™äº›ç±»å‹å’Œå®ƒä»¬æ‰€æ”¯æŒçš„ç±»åœ¨java.lang.annotationåŒ…ä¸­å¯ä»¥æ‰¾åˆ°ã€‚@Targetï¼šæè¿°èƒ½å¤Ÿä½œç”¨çš„ä½ç½®ï¼ˆå³ï¼šè¢«æè¿°çš„æ³¨è§£å¯ä»¥ç”¨åœ¨ä»€ä¹ˆåœ°æ–¹ï¼‰123@Target(value = {ElementType.TYPE,ElementType.METHOD,ElementType.FIELD}) //è¡¨ç¤ºè¯¥MyAnnoæ³¨è§£å¯ä»¥åŒæ—¶ä½œç”¨äºç±»ä¸Šï¼Œæ–¹æ³•ä¸Šå’Œæˆå‘˜å˜é‡ä¸Špublic @interface MyAnno {}å…¶ä¸­valueä¸­ElementTypeå–å€¼å¯ä»¥æœ‰ä»¥ä¸‹å‡ ç§æƒ…å†µï¼šTYPE:å¯ä»¥ä½œç”¨åœ¨ç±»ä¸ŠMETHOD:å¯ä»¥ä½œç”¨åœ¨æ–¹æ³•ä¸ŠFIELDï¼šå¯ä»¥ä½œç”¨äºæˆå‘˜å˜é‡ä¸Š@Retentionï¼šæè¿°æ³¨è§£è¢«ä¿ç•™çš„é˜¶æ®µï¼Œç”¨äºæè¿°æ³¨è§£çš„ç”Ÿå‘½å‘¨æœŸ@Retention(RetentionPolicy.RUNTIME)ï¼šå½“å‰è¢«æè¿°çš„æ³¨è§£ï¼Œä¼šä¿ç•™åˆ°å­—èŠ‚ç æ–‡ä»¶ä¸­ï¼Œå¹¶è¢«JVMè¯»å–åˆ°ï¼Œä¸€èˆ¬è‡ªå·±å®šä¹‰çš„æ³¨è§£éƒ½åŠ RUNTIME@Documentedï¼šæè¿°è¯¥æ³¨è§£æ˜¯å¦ä¼šè¢«æŠ½å–åˆ°apiæ–‡æ¡£ä¸­@Inheritedï¼šæè¿°æ³¨è§£æ˜¯å¦è¢«å­ç±»ç»§æ‰¿ä½¿ç”¨æ³¨è§£æ³¨è§£åœ¨ç¨‹åºä¸­ç»å¸¸å’Œåå°„ä¸€èµ·ä½¿ç”¨ï¼Œæ³¨è§£å¤§å¤šæ•°æ¥è¯´éƒ½æ˜¯ç”¨æ¥æ›¿æ¢é…ç½®æ–‡ä»¶çš„1234567891011&gt;import java.lang.annotation.ElementType;&gt;import java.lang.annotation.Retention;&gt;import java.lang.annotation.RetentionPolicy;&gt;import java.lang.annotation.Target;&gt;@Target(ElementType.TYPE) //å¯ä»¥è¢«ä½œç”¨åœ¨ç±»ä¸Š&gt;@Retention(RetentionPolicy.RUNTIME)&gt;public @interface AnnoReflect {  String className();  String methodName();&gt;}1234567891011121314151617181920212223242526272829303132333435363738394041&gt;// ä½¿ç”¨æ³¨è§£çš„æ–¹å¼æ¥æ·˜æ±°é…ç½®æ–‡ä»¶(æ³¨é‡Šå¾ˆé‡è¦)ï¼š&gt;import java.io.InputStream;&gt;import java.lang.reflect.Method;&gt;import java.util.Properties;&gt;@AnnoReflect(className = &quot;cn.other.annotation.AnnoTest&quot;,methodName = &quot;play&quot;)&gt;public class ReflectAnnotationTest {  public static void main(String[] args) throws Exception {      /**       * å‰æï¼šä¸èƒ½æ”¹å˜è¯¥ç±»çš„ä»»ä½•ä»£ç ã€‚å¯ä»¥åˆ›å»ºä»»æ„ç±»çš„å¯¹è±¡ï¼Œå¯ä»¥æ‰§è¡Œä»»æ„æ–¹æ³•       * å³ï¼šæ‹’ç»ç¡¬ç¼–ç        */      //1. è§£ææ³¨è§£      //1.1 è·å–è¯¥ç±»çš„å­—èŠ‚ç æ–‡ä»¶å¯¹è±¡      Class&lt;ReflectAnnotationTest&gt; rac = ReflectAnnotationTest.class;      //1.2 è·å–ä¸Šé¢çš„æ³¨è§£å¯¹è±¡,å…¶å®å°±æ˜¯åœ¨å†…å­˜ä¸­ç”Ÿæˆäº†ä¸€ä¸ªè¯¥æ³¨è§£æ¥å£çš„å­ç±»å®ç°å¯¹è±¡      AnnoReflect an = rac.getAnnotation(AnnoReflect.class);      /* ç›¸å½“äº          public class AnnotationReflect implements AnnoReflect{              public String className(){                  return &quot;cn.other.annotation.AnnoTest1&quot;;              }              public String methodName(){                  return &quot;play&quot;;              }          } */      //2. è°ƒç”¨æ³¨è§£å¯¹è±¡ä¸­å®šä¹‰çš„æŠ½è±¡æ–¹æ³•ï¼Œè·å–è¿”å›å€¼      String className = an.className();      String methodName = an.methodName();      //3.åŠ è½½è¯¥ç±»è¿›å†…å­˜      Class cls = Class.forName(className);      //4.åˆ›å»ºå¯¹è±¡      Object obj = cls.newInstance();      //5.è·å–æ–¹æ³•å¯¹è±¡      Method method = cls.getMethod(methodName);      //6.æ‰§è¡Œæ–¹æ³•      method.invoke(obj);  }&gt;}&gt;åœ¨ç¨‹åºä¸­ä½¿ç”¨æ³¨è§£ï¼šè·å–æ³¨è§£ä¸­å®šä¹‰çš„å±æ€§å€¼è·å–æ³¨è§£å®šä¹‰çš„ä½ç½®çš„å¯¹è±¡ (Class, Method, Field)è·å–æŒ‡å®šçš„æ³¨è§£ï¼šgetAnnotation(Class)è°ƒç”¨æ³¨è§£ä¸­çš„æŠ½è±¡æ–¹æ³•è·å–é…ç½®çš„å±æ€§å€¼æ¡ˆä¾‹åˆ†ææµ‹è¯•æ¡†æ¶éœ€æ±‚ï¼šè®¾è®¡ä¸€ä¸ªæ¡†æ¶ï¼Œæ£€æµ‹ä¸€ä¸ªç±»ä¸­çš„æ–¹æ³•ä½¿ç”¨æœ‰å¼‚å¸¸ï¼Œå¹¶è¿›è¡Œç»Ÿè®¡ã€‚123456789101112131415161718192021&gt;public class calculator {   @Check   public void add(){       System.out.println(&quot;1+0=&quot;+(1+0));  }   @Check   public void sub(){       System.out.println(&quot;1-0=&quot;+(1-0));   }   @Check   public void mul(){       System.out.println(&quot;1*0=&quot;+(1*0));   }   @Check   public void div(){       System.out.println(&quot;1/0=&quot;+(1/0));   }   public void show(){       System.out.println(&quot;ä»Šå¤©å¤©æ°”çœŸä¸é”™ï¼&quot;);   }}1234// è‡ªå®šä¹‰ä¸€ä¸ªæ³¨è§£@Retention(RetentionPolicy.RUNTIME) //è¿è¡Œæ—¶@Target(ElementType.METHOD) //åŠ åœ¨æ–¹æ³•å‰é¢public @interface Check {}ç¼–å†™ä¸€ä¸ªç±»ä¸“é—¨ç”¨äºæ£€æŸ¥(æ³¨æ„æ³¨é‡Š)ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546&gt;import java.io.BufferedWriter;&gt;import java.io.FileWriter;&gt;import java.io.IOException;&gt;import java.lang.reflect.InvocationTargetException;&gt;import java.lang.reflect.Method;&gt;// ç®€å•çš„æµ‹è¯•æ¡†æ¶&gt;// å½“ä¸»æ–¹æ³•æ‰§è¡Œåï¼Œä¼šè‡ªåŠ¨è‡ªè¡Œæ£€æµ‹æ‰€æœ‰æ–¹æ³•(åŠ äº†checkæ³¨è§£çš„æ–¹æ³•)ï¼Œåˆ¤æ–­æ–¹æ³•æ˜¯å¦æœ‰å¼‚å¸¸å¹¶è®°å½•&gt;public class TestCheck {  public static void main(String[] args) throws IOException {      //1. åˆ›å»ºè®¡ç®—æœºå¯¹è±¡      calculator c = new calculator();      //2. è·å–å­—èŠ‚ç æ–‡ä»¶å¯¹è±¡       Class cls = c.getClass();      //3. è·å–æ‰€æœ‰æ–¹æ³•       Method[] methods = cls.getMethods();       int num = 0; //è®°å½•å‡ºç°å¼‚å¸¸çš„æ¬¡æ•°       BufferedWriter bw = new BufferedWriter(new FileWriter(&quot;bug.txt&quot;));       for(Method method:methods){           //4. åˆ¤æ–­æ–¹æ³•ä¸Šæ˜¯å¦æœ‰Checkæ³¨è§£           if(method.isAnnotationPresent(Check.class)){               //5. æœ‰æ³¨è§£å°±æ‰§è¡Œ,æ•è·å¼‚å¸¸               try {                   method.invoke(c);               } catch (Exception e) {                   e.printStackTrace();                   //6.å°†å¼‚å¸¸è®°å½•åœ¨æ–‡ä»¶ä¸­                   num++;                   bw.write(method.getName()+&quot;æ–¹æ³•å‡ºå¼‚å¸¸äº†&quot;);                   bw.newLine();                   bw.write(&quot;å¼‚å¸¸çš„åç§°æ˜¯ï¼š&quot;+e.getCause().getClass().getSimpleName());                   bw.newLine();                   bw.write(&quot;å¼‚å¸¸åŸå› ï¼š&quot;+e.getCause().getMessage());                   bw.newLine();                   bw.write(&quot;=====================&quot;);                   bw.newLine();               }           }       }       bw.write(&quot;æœ¬æ¬¡æµ‹è¯•ä¸€å…±å‡ºç°&quot;+num+&quot;æ¬¡å¼‚å¸¸&quot;);       bw.flush();       bw.close();   }}è¿è¡ŒTestCheckç±»ä¸­çš„ä¸»æ–¹æ³•ï¼Œå°±ä¼šè‡ªåŠ¨æ£€æŸ¥æ‰€æœ‰æ³¨è§£@Checkçš„æ–¹æ³•æ˜¯å¦å¼‚å¸¸ï¼š&gt;ORMå®ä¾‹&gt;12345678910111213&gt;// ç±»åçš„æ³¨è§£ &gt;@Target(ElementType.TYPE) &gt;@Retention(RetentionPolicy.RUNTIME) &gt;@interface Tablekuang{ string value(); }&gt;// å±æ€§çš„æ³¨è§£ &gt;@Target(ElementType.FIELD) &gt;@Retention(RetentionPolicy.RUNTIME) &gt;@interface Fieldkuang{ String columnName(); string type(); int length();&gt;}123456789101112131415&gt;@Tablekuang(&quot;db_student&quot;) &gt;class student{ @Fieldkuang(columnName=&quot;db_id&quot;,type=&quot;int&quot;,length =10) private int id;@Fieldkuang(columnName=&quot;db_age&quot;,type=&quot;int&quot;,length=10) private int age; @Fieldkuang(columnName =&quot;db_name&quot;,type =&quot;&quot;varchar&quot;,length=3) private String name; public student(){}public student(int id,int age,String name){ this.id=id;this.age=age;this.name=name;}&gt;}1234567891011121314151617&gt;public static void main(string[] args) throws ClassNotFoundException { Class c1=Class.forName(&quot;com.huangy.reflection.Student&quot;); //é€šè¿‡åå°„è·å¾—æ³¨è§£ Annotation[] annotations=c1.getAnnotations();   annotations.foreach(System.out::println);      //è·å¾—æ³¨è§£çš„alueçš„å€¼ã€‚   Tablekuang tablekuang =(Tablekuang)c1.getAnnotation(Tablekuang.class);    System.out.printn(ablekuang.value());    //è·å¾—ç±»æŒ‡å®šçš„æ³¨è§£    Field f=c1.getDeclaredField(&quot;name&quot;);    Fieldkuang annotation=f.getAnnotation(Fieldkuang.class);    System.out.println(annotation.columnName());   System.out.println(annotation.type());   System.out.println(annotation.length());&gt;}</content>
	</entry>
	<entry>
		<title>MySQL</title>
		<url>/article/c24675b4.html</url>
		<content></content>
	</entry>
	<entry>
		<title>MySQL_äº‹åŠ¡</title>
		<url>/article/eebdb36a.html</url>
		<content>MySQLå¤šè¡¨æŸ¥è¯¢ä¸äº‹åŠ¡çš„æ“ä½œåŸºæœ¬ä»‹ç»æ¦‚å¿µï¼šä¸€ä¸ªåŒ…å«å¤šä¸ªæ­¥éª¤çš„ä¸šåŠ¡æ“ä½œï¼Œè¢«äº‹åŠ¡ç®¡ç†ï¼Œé‚£ä¹ˆè¿™äº›æ“ä½œè¦ä¹ˆåŒæ—¶æˆåŠŸï¼Œè¦ä¹ˆåŒæ—¶å¤±è´¥ã€‚æ“ä½œï¼šäº‹åŠ¡å››å¤§ç‰¹å¾åŸå­æ€§ï¼šæ˜¯ä¸å¯åˆ†å‰²çš„æœ€å°æ“ä½œå•ä½ï¼Œè¦ä¹ˆåŒæ—¶æˆåŠŸï¼Œè¦ä¹ˆåŒæ—¶å¤±è´¥ã€‚æŒä¹…æ€§ï¼šå½“äº‹åŠ¡æäº¤æˆ–å›æ»šåï¼Œæ•°æ®åº“ä¼šæŒä¹…åŒ–çš„ä¿å­˜æ•°æ®ã€‚éš”ç¦»æ€§ï¼šå¤šä¸ªäº‹åŠ¡ä¹‹é—´ã€‚ç›¸äº’ç‹¬ç«‹ã€‚ä¸€è‡´æ€§ï¼šäº‹åŠ¡æ“ä½œå‰åï¼Œæ•°æ®æ€»é‡ä¸å˜äº‹åŠ¡éš”ç¦»çº§åˆ«æ¦‚å¿µï¼šå¤šä¸ªäº‹åŠ¡ä¹‹é—´éš”ç¦»çš„ï¼Œç›¸äº’ç‹¬ç«‹çš„ã€‚ä½†æ˜¯å¦‚æœå¤šä¸ªäº‹åŠ¡æ“ä½œåŒä¸€æ‰¹æ•°æ®ï¼Œåˆ™ä¼šå¼•å‘ä¸€äº›é—®é¢˜ï¼Œè®¾ç½®ä¸åŒçš„éš”ç¦»çº§åˆ«å°±å¯ä»¥è§£å†³è¿™äº›é—®é¢˜å­˜åœ¨é—®é¢˜è„è¯»ï¼šä¸€ä¸ªäº‹åŠ¡ï¼Œè¯»å–åˆ°å¦ä¸€ä¸ªäº‹åŠ¡ä¸­æ²¡æœ‰æäº¤çš„æ•°æ®ä¸å¯é‡å¤è¯»(è™šè¯»)ï¼šåœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œä¸¤æ¬¡è¯»å–åˆ°çš„æ•°æ®ä¸ä¸€æ ·ã€‚å¹»è¯»ï¼šä¸€ä¸ªäº‹åŠ¡æ“ä½œ(DML)æ•°æ®è¡¨ä¸­æ‰€æœ‰è®°å½•ï¼Œå¦ä¸€ä¸ªäº‹åŠ¡æ·»åŠ äº†ä¸€æ¡æ•°æ®ï¼Œåˆ™ç¬¬ä¸€ä¸ªäº‹åŠ¡æŸ¥è¯¢ä¸åˆ°è‡ªå·±çš„ä¿®æ”¹ã€‚éš”ç¦»çº§åˆ«read uncommittedï¼šè¯»æœªæäº¤(äº§ç”Ÿçš„é—®é¢˜ï¼šè„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»)Aäº‹åŠ¡è¿˜æ²¡æ‰§è¡Œæäº¤ï¼ŒBäº‹åŠ¡å·²ç»å¯ä»¥æŸ¥åˆ°æ•°æ®äº†read committedï¼šè¯»å·²æäº¤ (Oracle)(äº§ç”Ÿçš„é—®é¢˜ï¼šä¸å¯é‡å¤è¯»ã€å¹»è¯»)Aäº‹åŠ¡æ‰§è¡Œæäº¤ï¼ŒBäº‹åŠ¡åœ¨åŒä¸€æ¬¡æŸ¥è¯¢ä¸­æŸ¥åˆ°å·²è¢«ä¿®æ”¹çš„æ•°æ®repeatable readï¼šå¯é‡å¤è¯» (MySQLé»˜è®¤)(äº§ç”Ÿçš„é—®é¢˜ï¼šå¹»è¯»)å¿½ç•¥Aäº‹åŠ¡æ‰§è¡ŒçŠ¶æ€ï¼ŒBäº‹åŠ¡åœ¨åŒä¸€æ¬¡æŸ¥è¯¢ä¸­æ•°æ®ä¸ä¼šå˜åŒ–serializableï¼šä¸²è¡ŒåŒ–(å¯ä»¥è§£å†³æ‰€æœ‰çš„é—®é¢˜)æ³¨æ„ï¼šéš”ç¦»çº§åˆ«ä»å°åˆ°å¤§å®‰å…¨æ€§è¶Šæ¥è¶Šé«˜ï¼Œä½†æ˜¯æ•ˆç‡è¶Šæ¥è¶Šä½æ•°æ®åº“æŸ¥è¯¢éš”ç¦»çº§åˆ«1select @@tx_isolation;æ•°æ®åº“è®¾ç½®éš”ç¦»çº§åˆ«1set global transaction isolation level  çº§åˆ«å­—ç¬¦ä¸²;æ¼”ç¤º12345set global transaction isolation level read uncommitted;start transaction;-- è½¬è´¦æ“ä½œupdate account set balance = balance - 500 where id = 1;update account set balance = balance + 500 where id = 2;ä¾‹å­12345678910111213141516171819202122&gt;CREATE TABLE account (id INT PRIMARY KEY AUTO_INCREMENT,NAME VARCHAR(10),balance DOUBLE&gt;);&gt;-- æ·»åŠ æ•°æ®&gt;INSERT INTO account (NAME, balance) VALUES ('zhangsan', 1000), ('lisi', 1000);&gt;SELECT * FROM account;&gt;UPDATE account SET balance = 1000;&gt;-- å¼ ä¸‰ç»™æå››è½¬è´¦ 500 å…ƒ&gt;-- 0. å¼€å¯äº‹åŠ¡&gt;START TRANSACTION; -- å¤±è´¥çš„è¯ä¼šå›æ»šåˆ°è¿™é‡Œ&gt;-- 1. å¼ ä¸‰è´¦æˆ· -500&gt;UPDATE account SET balance = balance - 500 WHERE NAME = 'zhangsan';&gt;-- 2. æå››è´¦æˆ· +500&gt;-- å‡ºé”™äº†...&gt;UPDATE account SET balance = balance + 500 WHERE NAME = 'lisi';&gt;-- å‘ç°æ‰§è¡Œæ²¡æœ‰é—®é¢˜ï¼Œæäº¤äº‹åŠ¡&gt;COMMIT;&gt;-- å‘ç°å‡ºé—®é¢˜äº†ï¼Œå›æ»šäº‹åŠ¡&gt;ROLLBACK;äº‹åŠ¡æäº¤è‡ªåŠ¨æäº¤ï¼šmysqlå°±æ˜¯è‡ªåŠ¨æäº¤çš„ä¸€æ¡DML(å¢åˆ æ”¹)è¯­å¥ä¼šè‡ªåŠ¨æäº¤ä¸€æ¬¡äº‹åŠ¡æ‰‹åŠ¨æäº¤ï¼šOracle æ•°æ®åº“é»˜è®¤æ˜¯æ‰‹åŠ¨æäº¤äº‹åŠ¡éœ€è¦å…ˆå¼€å¯äº‹åŠ¡ï¼Œå†æäº¤ä¿®æ”¹äº‹åŠ¡çš„é»˜è®¤æäº¤æ–¹å¼ï¼šæŸ¥çœ‹äº‹åŠ¡çš„é»˜è®¤æäº¤æ–¹å¼1SELECT @@autocommit; -- 1 ä»£è¡¨è‡ªåŠ¨æäº¤  0 ä»£è¡¨æ‰‹åŠ¨æäº¤ä¿®æ”¹é»˜è®¤æäº¤æ–¹å¼1set @@autocommit = 0;</content>
	</entry>
	<entry>
		<title>MySQL_åŸºç¡€</title>
		<url>/article/5dca6626.html</url>
		<content>ã€é»‘é©¬ç¨‹åºå‘˜-Javaè¯­è¨€é«˜çº§éƒ¨åˆ†10ã€‘MySQLå…¥é—¨å­¦ä¹ åŸºç¡€æ¦‚å¿µæ•°æ®åº“çš„è‹±æ–‡å•è¯ï¼š DataBase(ç®€ç§°DB)æ•°æ®åº“: ç”¨äºå­˜å‚¨å’Œç®¡ç†æ•°æ®çš„ä»“åº“æ•°æ®åº“çš„ç‰¹ç‚¹ï¼šæŒä¹…åŒ–å­˜å‚¨æ•°æ®çš„ã€‚å…¶å®æ•°æ®åº“å°±æ˜¯ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿæ–¹ä¾¿å­˜å‚¨å’Œç®¡ç†æ•°æ®ä½¿ç”¨äº†ç»Ÿä¸€çš„æ–¹å¼æ“ä½œæ•°æ®åº“ â€” SQLå¸¸è§çš„æ•°æ®åº“è½¯ä»¶æ•°æ®åº“è½¯ä»¶å®‰è£…å¸è½½å»mysqlçš„å®‰è£…ç›®å½•æ‰¾åˆ°my.iniæ–‡ä»¶å¤åˆ¶ datadir=â€C:/ProgramData/MySQL/MySQL Server 5.5/Data/â€œå¸è½½MySQLåˆ é™¤C:/ProgramDataç›®å½•ä¸‹çš„MySQLæ–‡ä»¶å¤¹ã€‚é…ç½®MySQLæœåŠ¡å¯åŠ¨æ‰‹åŠ¨cmdâ€”&gt; services.msc æ‰“å¼€æœåŠ¡çš„çª—å£ä½¿ç”¨ç®¡ç†å‘˜æ‰“å¼€cmdnet start mysql : å¯åŠ¨mysqlçš„æœåŠ¡net stop mysql:å…³é—­mysqlæœåŠ¡MySQLç™»å½•mysql -uroot -på¯†ç mysql -hip -uroot -pè¿æ¥ç›®æ ‡çš„å¯†ç mysql â€”host=ip â€”user=root â€”password=è¿æ¥ç›®æ ‡çš„å¯†ç MySQLé€€å‡º(exit or quit)MySQLç›®å½•ç»“æ„MySQLå®‰è£…ç›®å½•ï¼šbasedir=â€D:/develop/MySQL/â€œé…ç½®æ–‡ä»¶ my.iniMySQLæ•°æ®ç›®å½•ï¼šdatadir=â€C:/ProgramData/MySQL/MySQL Server 5.5/Data/â€œå‡ ä¸ªæ¦‚å¿µæ•°æ®åº“ï¼šæ–‡ä»¶å¤¹è¡¨ï¼šæ–‡ä»¶æ•°æ®ï¼šæ•°æ®SQLåŸºç¡€ä»€ä¹ˆæ˜¯SQLStructured Query Languageï¼šç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€å…¶å®å°±æ˜¯å®šä¹‰äº†æ“ä½œæ‰€æœ‰å…³ç³»å‹æ•°æ®åº“çš„è§„åˆ™ã€‚æ¯ä¸€ç§æ•°æ®åº“æ“ä½œçš„æ–¹å¼å­˜åœ¨ä¸ä¸€æ ·çš„åœ°æ–¹ï¼Œç§°ä¸ºâ€œæ–¹è¨€â€ã€‚SQLé€šç”¨è¯­æ³•SQL è¯­å¥å¯ä»¥å•è¡Œæˆ–å¤šè¡Œä¹¦å†™ï¼Œä»¥åˆ†å·ç»“å°¾ã€‚å¯ä½¿ç”¨ç©ºæ ¼å’Œç¼©è¿›æ¥å¢å¼ºè¯­å¥çš„å¯è¯»æ€§ã€‚MySQL æ•°æ®åº“çš„ SQL è¯­å¥ä¸åŒºåˆ†å¤§å°å†™ï¼Œå…³é”®å­—å»ºè®®ä½¿ç”¨å¤§å†™ã€‚3ç§æ³¨é‡Šå•è¡Œæ³¨é‡Š: â€” æ³¨é‡Šå†…å®¹ æˆ– # æ³¨é‡Šå†…å®¹(mysql ç‰¹æœ‰) å¤šè¡Œæ³¨é‡Š: / æ³¨é‡Š /SQLåˆ†ç±»DDL(Data Definition Language)æ•°æ®å®šä¹‰è¯­è¨€    ç”¨æ¥å®šä¹‰æ•°æ®åº“å¯¹è±¡ï¼šæ•°æ®åº“ï¼Œè¡¨ï¼Œåˆ—ç­‰ã€‚å…³é”®å­—ï¼šcreate, drop,alter ç­‰DML(Data Manipulation Language)æ•°æ®æ“ä½œè¯­è¨€    ç”¨æ¥å¯¹æ•°æ®åº“ä¸­è¡¨çš„æ•°æ®è¿›è¡Œå¢åˆ æ”¹ã€‚å…³é”®å­—ï¼šinsert, delete, update ç­‰DQL(Data Query Language)æ•°æ®æŸ¥è¯¢è¯­è¨€    ç”¨æ¥æŸ¥è¯¢æ•°æ®åº“ä¸­è¡¨çš„è®°å½•(æ•°æ®)ã€‚å…³é”®å­—ï¼šselect, where ç­‰DCL(Data Control Language)æ•°æ®æ§åˆ¶è¯­è¨€(äº†è§£)    ç”¨æ¥å®šä¹‰æ•°æ®åº“çš„è®¿é—®æƒé™å’Œå®‰å…¨çº§åˆ«ï¼ŒåŠåˆ›å»ºç”¨æˆ·ã€‚å…³é”®å­—ï¼šGRANTï¼Œ REVOKE ç­‰DDL: æ“ä½œæ•°æ®åº“ã€è¡¨æ“ä½œæ•°æ®åº“ï¼šCRUDC(Create): åˆ›å»ºåˆ›å»ºæ•°æ®åº“ï¼š1create database æ•°æ®åº“åç§°;åˆ›å»ºæ•°æ®åº“ï¼Œåˆ¤æ–­ä¸å­˜åœ¨ï¼Œå†åˆ›å»ºï¼š1create database if not exists æ•°æ®åº“åç§°;åˆ›å»ºæ•°æ®åº“ï¼Œå¹¶æŒ‡å®šå­—ç¬¦é›†1create database æ•°æ®åº“åç§° character set å­—ç¬¦é›†å;ç»ƒä¹ ï¼š åˆ›å»ºdb4æ•°æ®åº“ï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨ï¼Œå¹¶åˆ¶å®šå­—ç¬¦é›†ä¸ºgbk1create database if not exists db4 character set gbk;R(Retrieve)ï¼šæŸ¥è¯¢æŸ¥è¯¢æ‰€æœ‰æ•°æ®åº“çš„åç§°:1show databases;æŸ¥è¯¢æŸä¸ªæ•°æ®åº“çš„å­—ç¬¦é›†:æŸ¥è¯¢æŸä¸ªæ•°æ®åº“çš„åˆ›å»ºè¯­å¥1show create database æ•°æ®åº“åç§°;U(Update): ä¿®æ”¹ä¿®æ”¹æ•°æ®åº“çš„å­—ç¬¦é›†1alter database æ•°æ®åº“åç§° character set å­—ç¬¦é›†åç§°;D(Delete): åˆ é™¤åˆ é™¤æ•°æ®åº“1drop database æ•°æ®åº“åç§°;åˆ¤æ–­æ•°æ®åº“å­˜åœ¨ï¼Œå­˜åœ¨å†åˆ é™¤1drop database if exists æ•°æ®åº“åç§°;ä½¿ç”¨æ•°æ®åº“æŸ¥è¯¢å½“å‰æ­£åœ¨ä½¿ç”¨çš„æ•°æ®åº“åç§°1select database();ä½¿ç”¨æ•°æ®åº“1use æ•°æ®åº“åç§°;æ“ä½œè¡¨C(Create): åˆ›å»º 123456create table è¡¨å(åˆ—å1 æ•°æ®ç±»å‹1,åˆ—å2 æ•°æ®ç±»å‹2,....åˆ—ån æ•°æ®ç±»å‹n);æ³¨æ„ï¼šæœ€åä¸€åˆ—ï¼Œä¸éœ€è¦åŠ é€—å·ï¼ˆ,ï¼‰æ•°æ®åº“ç±»å‹ï¼šintï¼šæ•´æ•°ç±»å‹age int,double:å°æ•°ç±»å‹score double(5,2)date:æ—¥æœŸï¼ŒåªåŒ…å«å¹´æœˆæ—¥ï¼Œyyyy-MM-dddatetime:æ—¥æœŸï¼ŒåŒ…å«å¹´æœˆæ—¥æ—¶åˆ†ç§’     yyyy-MM-dd HH:mm:sstimestamp:æ—¶é—´é”™ç±»å‹    åŒ…å«å¹´æœˆæ—¥æ—¶åˆ†ç§’     yyyy-MM-dd HH:mm:ss    å¦‚æœå°†æ¥ä¸ç»™è¿™ä¸ªå­—æ®µèµ‹å€¼ï¼Œæˆ–èµ‹å€¼ä¸ºnullï¼Œåˆ™é»˜è®¤ä½¿ç”¨å½“å‰çš„ç³»ç»Ÿæ—¶é—´ï¼Œæ¥è‡ªåŠ¨èµ‹å€¼varcharï¼šå­—ç¬¦ä¸²name varchar(20): å§“åæœ€å¤§20ä¸ªå­—ç¬¦zhangsan 8ä¸ªå­—ç¬¦  å¼ ä¸‰ 2ä¸ªå­—ç¬¦åˆ›å»ºè¡¨:12345678create table student(id int,name varchar(32),age int ,score double(4,1),birthday date,insert_time timestamp);å¤åˆ¶è¡¨ï¼š1create table è¡¨å like è¢«å¤åˆ¶çš„è¡¨å;R(Retrieve): æŸ¥è¯¢æŸ¥è¯¢æŸä¸ªæ•°æ®åº“ä¸­æ‰€æœ‰çš„è¡¨åç§°1show tables;æŸ¥è¯¢è¡¨ç»“æ„1desc è¡¨å;U(Update): ä¿®æ”¹ä¿®æ”¹è¡¨å1alter table è¡¨å rename to æ–°çš„è¡¨å;ä¿®æ”¹è¡¨çš„å­—ç¬¦é›†1alter table è¡¨å character set å­—ç¬¦é›†åç§°;æ·»åŠ ä¸€åˆ—1alter table è¡¨å add åˆ—å æ•°æ®ç±»å‹;ä¿®æ”¹åˆ—åç§° ç±»å‹12alter table è¡¨å change åˆ—å æ–°åˆ—åˆ« æ–°æ•°æ®ç±»å‹;alter table è¡¨å modify åˆ—å æ–°æ•°æ®ç±»å‹;åˆ é™¤åˆ—1alter table è¡¨å drop åˆ—å;D(Delete):åˆ é™¤12drop table è¡¨å;drop table  if exists è¡¨å ;DML: å¢åˆ æ”¹è¡¨ä¸­æ•°æ®æ·»åŠ æ•°æ®ï¼š1insert into è¡¨å(åˆ—å1,åˆ—å2,...åˆ—ån) values(å€¼1,å€¼2,...å€¼n);æ³¨æ„:1234åˆ—åå’Œå€¼è¦ä¸€ä¸€å¯¹åº”ã€‚å¦‚æœè¡¨ååï¼Œä¸å®šä¹‰åˆ—åï¼Œåˆ™é»˜è®¤ç»™æ‰€æœ‰åˆ—æ·»åŠ å€¼insert into è¡¨å values(å€¼1,å€¼2,...å€¼n);é™¤äº†æ•°å­—ç±»å‹ï¼Œå…¶ä»–ç±»å‹éœ€è¦ä½¿ç”¨å¼•å·(å•åŒéƒ½å¯ä»¥)å¼•èµ·æ¥åˆ é™¤æ•°æ®ï¼š1delete from è¡¨å [where æ¡ä»¶]æ³¨æ„:1234å¦‚æœä¸åŠ æ¡ä»¶ï¼Œåˆ™åˆ é™¤è¡¨ä¸­æ‰€æœ‰è®°å½•ã€‚å¦‚æœè¦åˆ é™¤æ‰€æœ‰è®°å½•delete from è¡¨å; -- ä¸æ¨èä½¿ç”¨ã€‚æœ‰å¤šå°‘æ¡è®°å½•å°±ä¼šæ‰§è¡Œå¤šå°‘æ¬¡åˆ é™¤æ“ä½œTRUNCATE TABLE è¡¨å; -- æ¨èä½¿ç”¨ï¼Œæ•ˆç‡æ›´é«˜ å…ˆåˆ é™¤è¡¨ï¼Œç„¶åå†åˆ›å»ºä¸€å¼ ä¸€æ ·çš„è¡¨ã€‚ä¿®æ”¹æ•°æ®ï¼š1update è¡¨å set åˆ—å1 = å€¼1, åˆ—å2 = å€¼2,... [where æ¡ä»¶];æ³¨æ„: å¦‚æœä¸åŠ ä»»ä½•æ¡ä»¶ï¼Œåˆ™ä¼šå°†è¡¨ä¸­æ‰€æœ‰è®°å½•å…¨éƒ¨ä¿®æ”¹ã€‚å¤‡ç”¨DQL: æŸ¥è¯¢è¡¨ä¸­çš„è®°å½•è¯­æ³•1234567891011121314selectå­—æ®µåˆ—è¡¨fromè¡¨ååˆ—è¡¨whereæ¡ä»¶åˆ—è¡¨group byåˆ†ç»„å­—æ®µhavingåˆ†ç»„ä¹‹åçš„æ¡ä»¶order byæ’åºlimitåˆ†é¡µé™å®š;åŸºç¡€æŸ¥è¯¢å¤šä¸ªå­—æ®µçš„æŸ¥è¯¢1select å­—æ®µå1ï¼Œå­—æ®µå2... from è¡¨åï¼›æ³¨æ„ï¼šå¦‚æœæŸ¥è¯¢æ‰€æœ‰å­—æ®µï¼Œåˆ™å¯ä»¥ä½¿ç”¨*æ¥æ›¿ä»£å­—æ®µåˆ—è¡¨ã€‚å»é™¤é‡å¤: distinctè®¡ç®—åˆ—ä¸€èˆ¬å¯ä»¥ä½¿ç”¨å››åˆ™è¿ç®—è®¡ç®—ä¸€äº›åˆ—çš„å€¼ã€‚ï¼ˆä¸€èˆ¬åªä¼šè¿›è¡Œæ•°å€¼å‹çš„è®¡ç®—ï¼‰ifnull(è¡¨è¾¾å¼1,è¡¨è¾¾å¼2)ï¼šnullå‚ä¸çš„è¿ç®—ï¼Œè®¡ç®—ç»“æœéƒ½ä¸ºnullè¡¨è¾¾å¼1ï¼šå“ªä¸ªå­—æ®µéœ€è¦åˆ¤æ–­æ˜¯å¦ä¸ºnullå¦‚æœè¯¥å­—æ®µä¸ºnullåçš„æ›¿æ¢å€¼ã€‚èµ·åˆ«å  asï¼šasä¹Ÿå¯ä»¥çœç•¥å¤‡ç”¨æ¡ä»¶æŸ¥è¯¢whereå­å¥åè·Ÿæ¡ä»¶è¿ç®—ç¬¦1234567891011&gt; ã€&lt; ã€&lt;= ã€&gt;= ã€= ã€&lt;&gt;BETWEEN...AND  IN( é›†åˆ) LIKEï¼šæ¨¡ç³ŠæŸ¥è¯¢å ä½ç¬¦ï¼š_: å•ä¸ªä»»æ„å­—ç¬¦%ï¼šå¤šä¸ªä»»æ„å­—ç¬¦IS NULL  and  æˆ– &amp;&amp;or  æˆ– || not  æˆ– !ç¤ºä¾‹1234567891011121314151617181920212223242526272829303132333435363738-- æŸ¥è¯¢å¹´é¾„å¤§äº20å²SELECT * FROM student WHERE age &gt; 20;SELECT * FROM student WHERE age &gt;= 20;  -- æŸ¥è¯¢å¹´é¾„ç­‰äº20å²SELECT * FROM student WHERE age = 20;  -- æŸ¥è¯¢å¹´é¾„ä¸ç­‰äº20å²SELECT * FROM student WHERE age != 20;SELECT * FROM student WHERE age &lt;&gt; 20;  -- æŸ¥è¯¢å¹´é¾„å¤§äºç­‰äº20 å°äºç­‰äº30SELECT * FROM student WHERE age &gt;= 20 &amp;&amp;  age &lt;=30;SELECT * FROM student WHERE age &gt;= 20 AND  age &lt;=30;SELECT * FROM student WHERE age BETWEEN 20 AND 30;  -- æŸ¥è¯¢å¹´é¾„22å²ï¼Œ18å²ï¼Œ25å²çš„ä¿¡æ¯SELECT * FROM student WHERE age = 22 OR age = 18 OR age = 25SELECT * FROM student WHERE age IN (22,18,25);  -- æŸ¥è¯¢è‹±è¯­æˆç»©ä¸ºnullSELECT * FROM student WHERE english = NULL; -- ä¸å¯¹çš„ã€‚nullå€¼ä¸èƒ½ä½¿ç”¨ = ï¼ˆ!=ï¼‰ åˆ¤æ–­SELECT * FROM student WHERE english IS NULL;  -- æŸ¥è¯¢è‹±è¯­æˆç»©ä¸ä¸ºnullSELECT * FROM student WHERE english  IS NOT NULL;  -- æŸ¥è¯¢å§“é©¬çš„æœ‰å“ªäº›ï¼Ÿ likeSELECT * FROM student WHERE NAME LIKE 'é©¬%';  -- æŸ¥è¯¢å§“åç¬¬äºŒä¸ªå­—æ˜¯åŒ–çš„äººSELECT * FROM student WHERE NAME LIKE &quot;_åŒ–%&quot;;  -- æŸ¥è¯¢å§“åæ˜¯3ä¸ªå­—çš„äººSELECT * FROM student WHERE NAME LIKE '___';  -- æŸ¥è¯¢å§“åä¸­åŒ…å«å¾·çš„äººSELECT * FROM student WHERE NAME LIKE '%å¾·%';å¤‡ç”¨æ’åºæŸ¥è¯¢è¯­æ³•ï¼šorder by å­å¥order by æ’åºå­—æ®µ1 æ’åºæ–¹å¼1 ï¼Œ  æ’åºå­—æ®µ2 æ’åºæ–¹å¼2â€¦æ’åºæ–¹å¼ï¼šASCï¼šå‡åºï¼Œé»˜è®¤çš„ã€‚DESCï¼šé™åºã€‚æ³¨æ„ï¼šå¦‚æœæœ‰å¤šä¸ªæ’åºæ¡ä»¶ï¼Œåˆ™å½“å‰è¾¹çš„æ¡ä»¶å€¼ä¸€æ ·æ—¶ï¼Œæ‰ä¼šåˆ¤æ–­ç¬¬äºŒæ¡ä»¶ã€‚èšåˆå‡½æ•°å°†ä¸€åˆ—æ•°æ®ä½œä¸ºä¸€ä¸ªæ•´ä½“ï¼Œè¿›è¡Œçºµå‘çš„è®¡ç®—countï¼šè®¡ç®—ä¸ªæ•°ä¸€èˆ¬é€‰æ‹©éç©ºçš„åˆ—ï¼šä¸»é”®count(*)maxï¼šè®¡ç®—æœ€å¤§å€¼minï¼šè®¡ç®—æœ€å°å€¼sumï¼šè®¡ç®—å’Œavgï¼šè®¡ç®—å¹³å‡å€¼æ³¨æ„ï¼šèšåˆå‡½æ•°çš„è®¡ç®—ï¼Œæ’é™¤nullå€¼ã€‚è§£å†³æ–¹æ¡ˆï¼šé€‰æ‹©ä¸åŒ…å«éç©ºçš„åˆ—è¿›è¡Œè®¡ç®—IFNULLå‡½æ•°åˆ†ç»„æŸ¥è¯¢è¯­æ³•ï¼šgroup by åˆ†ç»„å­—æ®µï¼›æ³¨æ„ï¼šåˆ†ç»„ä¹‹åæŸ¥è¯¢çš„å­—æ®µï¼šåˆ†ç»„å­—æ®µã€èšåˆå‡½æ•°where å’Œ having çš„åŒºåˆ«ï¼Ÿwhere åœ¨åˆ†ç»„ä¹‹å‰è¿›è¡Œé™å®šï¼Œå¦‚æœä¸æ»¡è¶³æ¡ä»¶ï¼Œåˆ™ä¸å‚ä¸åˆ†ç»„ã€‚havingåœ¨åˆ†ç»„ä¹‹åè¿›è¡Œé™å®šï¼Œå¦‚æœä¸æ»¡è¶³ç»“æœï¼Œåˆ™ä¸ä¼šè¢«æŸ¥è¯¢å‡ºæ¥where åä¸å¯ä»¥è·Ÿèšåˆå‡½æ•°ï¼Œhavingå¯ä»¥è¿›è¡Œèšåˆå‡½æ•°çš„åˆ¤æ–­ã€‚123456789101112-- æŒ‰ç…§æ€§åˆ«åˆ†ç»„ã€‚åˆ†åˆ«æŸ¥è¯¢ç”·ã€å¥³åŒå­¦çš„å¹³å‡åˆ†SELECT sex , AVG(math) FROM student GROUP BY sex;-- æŒ‰ç…§æ€§åˆ«åˆ†ç»„ã€‚åˆ†åˆ«æŸ¥è¯¢ç”·ã€å¥³åŒå­¦çš„å¹³å‡åˆ†,äººæ•°SELECT sex , AVG(math),COUNT(id) FROM student GROUP BY sex;--  æŒ‰ç…§æ€§åˆ«åˆ†ç»„ã€‚åˆ†åˆ«æŸ¥è¯¢ç”·ã€å¥³åŒå­¦çš„å¹³å‡åˆ†,äººæ•° è¦æ±‚ï¼šåˆ†æ•°ä½äº70åˆ†çš„äººï¼Œä¸å‚ä¸åˆ†ç»„SELECT sex , AVG(math),COUNT(id) FROM student WHERE math &gt; 70 GROUP BY sex;--  æŒ‰ç…§æ€§åˆ«åˆ†ç»„ã€‚åˆ†åˆ«æŸ¥è¯¢ç”·ã€å¥³åŒå­¦çš„å¹³å‡åˆ†,äººæ•° è¦æ±‚ï¼šåˆ†æ•°ä½äº70åˆ†çš„äººï¼Œä¸å‚ä¸åˆ†ç»„,åˆ†ç»„ä¹‹åã€‚äººæ•°è¦å¤§äº2ä¸ªäººSELECT sex , AVG(math),COUNT(id) FROM student WHERE math &gt; 70 GROUP BY sex HAVING COUNT(id) &gt; 2;SELECT sex , AVG(math),COUNT(id) äººæ•° FROM student WHERE math &gt; 70 GROUP BY sex HAVING äººæ•° &gt; 2;åˆ†é¡µæŸ¥è¯¢è¯­æ³•ï¼šlimit å¼€å§‹çš„ç´¢å¼•,æ¯é¡µæŸ¥è¯¢çš„æ¡æ•°;å…¬å¼ï¼šå¼€å§‹çš„ç´¢å¼• = ï¼ˆå½“å‰çš„é¡µç  - 1ï¼‰ * æ¯é¡µæ˜¾ç¤ºçš„æ¡æ•°limit æ˜¯ä¸€ä¸ªMySQLâ€æ–¹è¨€â€1234-- æ¯é¡µæ˜¾ç¤º3æ¡è®°å½• SELECT * FROM student LIMIT 0,3; -- ç¬¬1é¡µSELECT * FROM student LIMIT 3,3; -- ç¬¬2é¡µSELECT * FROM student LIMIT 6,3; -- ç¬¬3é¡µDCLï¼šç®¡ç†ç”¨æˆ·å’Œæˆæƒç”¨æˆ·ç®¡ç†æ·»åŠ ç”¨æˆ·1CREATE USER 'ç”¨æˆ·å'@'ä¸»æœºå' IDENTIFIED BY 'å¯†ç ';åˆ é™¤ç”¨æˆ·1DROP USER 'ç”¨æˆ·å'@'ä¸»æœºå';ä¿®æ”¹ç”¨æˆ·å¯†ç 12345UPDATE USER SET PASSWORD = PASSWORD('æ–°å¯†ç ') WHERE USER = 'ç”¨æˆ·å';UPDATE USER SET PASSWORD = PASSWORD('abc') WHERE USER = 'lisi';SET PASSWORD FOR 'ç”¨æˆ·å'@'ä¸»æœºå' = PASSWORD('æ–°å¯†ç ');SET PASSWORD FOR 'root'@'localhost' = PASSWORD('123');å¿˜è®°å¯†ç ç®¡ç†å‘˜è¿è¡Œcmd1net stop mysql --åœæ­¢mysqlæœåŠ¡ä½¿ç”¨æ— éªŒè¯æ–¹å¼å¯åŠ¨mysqlæœåŠ¡1mysqld --skip-grant-tablesä½¿ç”¨æ— éªŒè¯æ–¹å¼å¯åŠ¨mysqlæœåŠ¡æ‰“å¼€æ–°çš„cmdçª—å£,ç›´æ¥è¾“å…¥mysqlå‘½ä»¤ï¼Œæ•²å›è½¦å°±å¯ä»¥ç™»å½•æˆåŠŸ12use mysql;update user set password = password('ä½ çš„æ–°å¯†ç ') where user = 'root';å…³é—­ä¸¤ä¸ªçª—å£æ‰“å¼€ä»»åŠ¡ç®¡ç†å™¨ï¼Œæ‰‹åŠ¨ç»“æŸmysqld.exe çš„è¿›ç¨‹å¯åŠ¨mysqlæœåŠ¡ï¼Œä½¿ç”¨æ–°å¯†ç ç™»å½•æŸ¥è¯¢ç”¨æˆ·12345-- 1. åˆ‡æ¢åˆ°mysqlæ•°æ®åº“USE myql;-- 2. æŸ¥è¯¢userè¡¨SELECT * FROM USER;-- * é€šé…ç¬¦ï¼š % è¡¨ç¤ºå¯ä»¥åœ¨ä»»æ„ä¸»æœºä½¿ç”¨ç”¨æˆ·ç™»å½•æ•°æ®åº“æƒé™ç®¡ç†æŸ¥è¯¢æƒé™12SHOW GRANTS FOR 'ç”¨æˆ·å'@'ä¸»æœºå';SHOW GRANTS FOR 'lisi'@'%';æˆäºˆæƒé™1234-- æˆäºˆæƒé™grant æƒé™åˆ—è¡¨ on æ•°æ®åº“å.è¡¨å to 'ç”¨æˆ·å'@'ä¸»æœºå';-- ç»™å¼ ä¸‰ç”¨æˆ·æˆäºˆæ‰€æœ‰æƒé™ï¼Œåœ¨ä»»æ„æ•°æ®åº“ä»»æ„è¡¨ä¸ŠGRANT ALL ON *.* TO 'zhangsan'@'localhost';æ’¤é”€æƒé™123-- æ’¤é”€æƒé™revoke æƒé™åˆ—è¡¨ on æ•°æ®åº“å.è¡¨å from 'ç”¨æˆ·å'@'ä¸»æœºå';REVOKE UPDATE ON db3.`account` FROM 'lisi'@'%';</content>
	</entry>
	<entry>
		<title>MySQL_å¤šè¡¨æŸ¥è¯¢</title>
		<url>/article/336443d5.html</url>
		<content>MySQLå¤šè¡¨æŸ¥è¯¢ä¸äº‹åŠ¡çš„æ“ä½œsqlå‡†å¤‡123456789101112131415161718192021# åˆ›å»ºéƒ¨é—¨è¡¨CREATE TABLE dept(id INT PRIMARY KEY AUTO_INCREMENT,NAME VARCHAR(20));INSERT INTO dept (NAME) VALUES ('å¼€å‘éƒ¨'),('å¸‚åœºéƒ¨'),('è´¢åŠ¡éƒ¨');# åˆ›å»ºå‘˜å·¥è¡¨CREATE TABLE emp (id INT PRIMARY KEY AUTO_INCREMENT,NAME VARCHAR(10),gender CHAR(1), -- æ€§åˆ«salary DOUBLE, -- å·¥èµ„join_date DATE, -- å…¥èŒæ—¥æœŸdept_id INT,FOREIGN KEY (dept_id) REFERENCES dept(id) -- å¤–é”®ï¼Œå…³è”éƒ¨é—¨è¡¨(éƒ¨é—¨è¡¨çš„ä¸»é”®));INSERT INTO emp(NAME,gender,salary,join_date,dept_id) VALUES('å­™æ‚Ÿç©º','ç”·',7200,'2013-02-24',1);INSERT INTO emp(NAME,gender,salary,join_date,dept_id) VALUES('çŒªå…«æˆ’','ç”·',3600,'2010-12-02',2);INSERT INTO emp(NAME,gender,salary,join_date,dept_id) VALUES('å”åƒ§','ç”·',9000,'2008-08-08',2);INSERT INTO emp(NAME,gender,salary,join_date,dept_id) VALUES('ç™½éª¨ç²¾','å¥³',5000,'2015-10-07',3);INSERT INTO emp(NAME,gender,salary,join_date,dept_id) VALUES('èœ˜è››ç²¾','å¥³',4500,'2011-03-14',1);å†…è¿æ¥æŸ¥è¯¢ä»å“ªäº›è¡¨ä¸­æŸ¥è¯¢æ•°æ®ã€æ¡ä»¶æ˜¯ä»€ä¹ˆã€æŸ¥è¯¢å“ªäº›å­—æ®µéšå¼å†…è¿æ¥ä½¿ç”¨whereæ¡ä»¶æ¶ˆé™¤æ— ç”¨æ•°æ®123456789101112131415-- æŸ¥è¯¢æ‰€æœ‰å‘˜å·¥ä¿¡æ¯å’Œå¯¹åº”çš„éƒ¨é—¨ä¿¡æ¯SELECT * FROM emp,dept WHERE emp.`dept_id` = dept.`id`;-- æŸ¥è¯¢å‘˜å·¥è¡¨çš„åç§°ï¼Œæ€§åˆ«ã€‚éƒ¨é—¨è¡¨çš„åç§°SELECT emp.name,emp.gender,dept.name FROM emp,dept WHERE emp.`dept_id` = dept.`id`;SELECT t1.name, -- å‘˜å·¥è¡¨çš„å§“åt1.gender,-- å‘˜å·¥è¡¨çš„æ€§åˆ«t2.name -- éƒ¨é—¨è¡¨çš„åç§°FROMemp t1,dept t2WHERE t1.`dept_id` = t2.`id`;æ˜¾å¼å†…è¿æ¥è¯­æ³•ï¼š select å­—æ®µåˆ—è¡¨ from è¡¨å1 [inner] join è¡¨å2 on æ¡ä»¶12SELECT * FROM emp INNER JOIN dept ON emp.`dept_id` = dept.`id`;SELECT * FROM emp JOIN dept ON emp.`dept_id` = dept.`id`;å¤–è¿æ¥æŸ¥è¯¢å·¦å¤–è¿æ¥è¯­æ³•ï¼šselect å­—æ®µåˆ—è¡¨ from è¡¨1 left [outer] join è¡¨2 on æ¡ä»¶ï¼›123-- æŸ¥è¯¢çš„æ˜¯å·¦è¡¨æ‰€æœ‰æ•°æ®ä»¥åŠå…¶äº¤é›†éƒ¨åˆ†ã€‚-- æŸ¥è¯¢æ‰€æœ‰å‘˜å·¥ä¿¡æ¯ï¼Œå¦‚æœå‘˜å·¥æœ‰éƒ¨é—¨ï¼Œåˆ™æŸ¥è¯¢éƒ¨é—¨åç§°ï¼Œæ²¡æœ‰éƒ¨é—¨ï¼Œåˆ™ä¸æ˜¾ç¤ºéƒ¨é—¨åç§°SELECT t1.*,t2.`name` FROM emp t1 LEFT JOIN dept t2 ON t1.`dept_id` = t2.`id`;å³å¤–è¿æ¥è¯­æ³•ï¼šselect å­—æ®µåˆ—è¡¨ from è¡¨1 right [outer] join è¡¨2 on æ¡ä»¶ï¼›12-- æŸ¥è¯¢çš„æ˜¯å³è¡¨æ‰€æœ‰æ•°æ®ä»¥åŠå…¶äº¤é›†éƒ¨åˆ†SELECT * FROM dept t2 RIGHT JOIN emp t1 ON t1.`dept_id` = t2.`id`;å­æŸ¥è¯¢æ¦‚å¿µï¼šæŸ¥è¯¢ä¸­åµŒå¥—æŸ¥è¯¢ï¼Œç§°åµŒå¥—æŸ¥è¯¢ä¸ºå­æŸ¥è¯¢12345678&gt;-- æŸ¥è¯¢å·¥èµ„æœ€é«˜çš„å‘˜å·¥ä¿¡æ¯&gt;-- 1 æŸ¥è¯¢æœ€é«˜çš„å·¥èµ„æ˜¯å¤šå°‘ 9000&gt;SELECT MAX(salary) FROM emp;&gt;-- 2 æŸ¥è¯¢å‘˜å·¥ä¿¡æ¯ï¼Œå¹¶ä¸”å·¥èµ„ç­‰äº9000çš„&gt;SELECT * FROM emp WHERE emp.`salary` = 9000;&gt;-- ä¸€æ¡sqlå°±å®Œæˆè¿™ä¸ªæ“ä½œã€‚å­æŸ¥è¯¢&gt;SELECT * FROM emp WHERE emp.`salary` = (SELECT MAX(salary) FROM emp);å­æŸ¥ç»“æœæ˜¯å•è¡Œå•åˆ—å­æŸ¥è¯¢å¯ä»¥ä½œä¸ºæ¡ä»¶ï¼Œä½¿ç”¨è¿ç®—ç¬¦å»åˆ¤æ–­ã€‚ è¿ç®—ç¬¦ï¼š &gt; &gt;= &lt; &lt;= =12&gt;-- æŸ¥è¯¢å‘˜å·¥å·¥èµ„å°äºå¹³å‡å·¥èµ„çš„äºº&gt;SELECT * FROM emp WHERE emp.salary &lt; (SELECT AVG(salary) FROM emp);å­æŸ¥è¯¢ç»“æœæ˜¯å¤šè¡Œå•åˆ—å­æŸ¥è¯¢å¯ä»¥ä½œä¸ºæ¡ä»¶ï¼Œä½¿ç”¨è¿ç®—ç¬¦inæ¥åˆ¤æ–­12345&gt;-- æŸ¥è¯¢'è´¢åŠ¡éƒ¨'å’Œ'å¸‚åœºéƒ¨'æ‰€æœ‰çš„å‘˜å·¥ä¿¡æ¯&gt;SELECT id FROM dept WHERE NAME = 'è´¢åŠ¡éƒ¨' OR NAME = 'å¸‚åœºéƒ¨';&gt;SELECT * FROM emp WHERE dept_id = 3 OR dept_id = 2;&gt;-- å­æŸ¥è¯¢&gt;SELECT * FROM emp WHERE dept_id IN (SELECT id FROM dept WHERE NAME = 'è´¢åŠ¡éƒ¨' OR NAME = 'å¸‚åœºéƒ¨');å­æŸ¥è¯¢ç»“æœæ˜¯å¤šè¡Œå¤šåˆ—å­æŸ¥è¯¢å¯ä»¥ä½œä¸ºä¸€å¼ è™šæ‹Ÿè¡¨å‚ä¸æŸ¥è¯¢123456&gt;-- æŸ¥è¯¢å‘˜å·¥å…¥èŒæ—¥æœŸæ˜¯2011-11-11æ—¥ä¹‹åçš„å‘˜å·¥ä¿¡æ¯å’Œéƒ¨é—¨ä¿¡æ¯&gt;-- å­æŸ¥è¯¢&gt;SELECT * FROM dept t1 ,(SELECT * FROM emp WHERE emp.`join_date` &gt; '2011-11-11') t2 WHERE t1.id = t2.dept_id;&gt;-- æ™®é€šå†…è¿æ¥&gt;SELECT * FROM emp t1,dept t2 WHERE t1.`dept_id` = t2.`id` AND t1.`join_date` &gt;  '2011-11-11'å¤šè¡¨æŸ¥è¯¢ç»ƒä¹ è§è¡¨è¯­å¥è¯¦è§é™„å½•12345678910111213141516&gt;-- 1.æŸ¥è¯¢æ‰€æœ‰å‘˜å·¥ä¿¡æ¯ã€‚æŸ¥è¯¢å‘˜å·¥ç¼–å·ï¼Œå‘˜å·¥å§“åï¼Œå·¥èµ„ï¼ŒèŒåŠ¡åç§°ï¼ŒèŒåŠ¡æè¿°&gt;/*åˆ†æï¼š1.å‘˜å·¥ç¼–å·ï¼Œå‘˜å·¥å§“åï¼Œå·¥èµ„ï¼Œéœ€è¦æŸ¥è¯¢empè¡¨  èŒåŠ¡åç§°ï¼ŒèŒåŠ¡æè¿° éœ€è¦æŸ¥è¯¢jobè¡¨2.æŸ¥è¯¢æ¡ä»¶ emp.job_id = job.id&gt;*/&gt;SELECT    t1.`id`, -- å‘˜å·¥ç¼–å·   t1.`ename`, -- å‘˜å·¥å§“å   t1.`salary`,-- å·¥èµ„   t2.`jname`, -- èŒåŠ¡åç§°   t2.`description` -- èŒåŠ¡æè¿°&gt;FROM emp t1, job t2&gt;WHERE t1.`job_id` = t2.`id`;12345678910111213141516171819&gt;-- 2.æŸ¥è¯¢å‘˜å·¥ç¼–å·ï¼Œå‘˜å·¥å§“åï¼Œå·¥èµ„ï¼ŒèŒåŠ¡åç§°ï¼ŒèŒåŠ¡æè¿°ï¼Œéƒ¨é—¨åç§°ï¼Œéƒ¨é—¨ä½ç½®&gt;/*åˆ†æï¼š1. å‘˜å·¥ç¼–å·ï¼Œå‘˜å·¥å§“åï¼Œå·¥èµ„ emp  èŒåŠ¡åç§°ï¼ŒèŒåŠ¡æè¿° job  éƒ¨é—¨åç§°ï¼Œéƒ¨é—¨ä½ç½® dept2. æ¡ä»¶ï¼š emp.job_id = job.id and emp.dept_id = dept.id&gt;*/&gt;SELECT    t1.`id`, -- å‘˜å·¥ç¼–å·   t1.`ename`, -- å‘˜å·¥å§“å   t1.`salary`,-- å·¥èµ„   t2.`jname`, -- èŒåŠ¡åç§°   t2.`description`, -- èŒåŠ¡æè¿°   t3.`dname`, -- éƒ¨é—¨åç§°   t3.`loc` -- éƒ¨é—¨ä½ç½®&gt;FROM    emp t1, job t2,dept t3&gt;WHERE t1.`job_id` = t2.`id` AND t1.`dept_id` = t3.`id`;   12345678910111213141516&gt;-- 3.æŸ¥è¯¢å‘˜å·¥å§“åï¼Œå·¥èµ„ï¼Œå·¥èµ„ç­‰çº§&gt;/*åˆ†æï¼š1.å‘˜å·¥å§“åï¼Œå·¥èµ„ emp  å·¥èµ„ç­‰çº§ salarygrade2.æ¡ä»¶ emp.salary &gt;= salarygrade.losalary and emp.salary &lt;= salarygrade.hisalaryemp.salary BETWEEN salarygrade.losalary and salarygrade.hisalary&gt;*/&gt;SELECT    t1.ename ,   t1.`salary`,   t2.*&gt;FROM emp t1, salarygrade t2&gt;WHERE t1.`salary` BETWEEN t2.`losalary` AND t2.`hisalary`;1234567891011121314151617181920&gt;-- 4.æŸ¥è¯¢å‘˜å·¥å§“åï¼Œå·¥èµ„ï¼ŒèŒåŠ¡åç§°ï¼ŒèŒåŠ¡æè¿°ï¼Œéƒ¨é—¨åç§°ï¼Œéƒ¨é—¨ä½ç½®ï¼Œå·¥èµ„ç­‰çº§&gt;/*åˆ†æï¼š1. å‘˜å·¥å§“åï¼Œå·¥èµ„ emp ï¼Œ èŒåŠ¡åç§°ï¼ŒèŒåŠ¡æè¿° job éƒ¨é—¨åç§°ï¼Œéƒ¨é—¨ä½ç½®ï¼Œdept  å·¥èµ„ç­‰çº§ salarygrade2. æ¡ä»¶ï¼š emp.job_id = job.id and emp.dept_id = dept.id and emp.salary BETWEEN salarygrade.losalary and salarygrade.hisalary&gt;*/&gt;SELECT t1.`ename`,t1.`salary`,t2.`jname`,t2.`description`,t3.`dname`,t3.`loc`,t4.`grade`&gt;FROM emp t1,job t2,dept t3,salarygrade t4&gt;WHERE t1.`job_id` = t2.`id` AND t1.`dept_id` = t3.`id`AND t1.`salary` BETWEEN t4.`losalary` AND t4.`hisalary`;1234567891011121314151617&gt;-- 5.æŸ¥è¯¢å‡ºéƒ¨é—¨ç¼–å·ã€éƒ¨é—¨åç§°ã€éƒ¨é—¨ä½ç½®ã€éƒ¨é—¨äººæ•°&gt;/*åˆ†æï¼š1.éƒ¨é—¨ç¼–å·ã€éƒ¨é—¨åç§°ã€éƒ¨é—¨ä½ç½® dept è¡¨ã€‚ éƒ¨é—¨äººæ•° empè¡¨2.ä½¿ç”¨åˆ†ç»„æŸ¥è¯¢ã€‚æŒ‰ç…§emp.dept_idå®Œæˆåˆ†ç»„ï¼ŒæŸ¥è¯¢count(id)3.ä½¿ç”¨å­æŸ¥è¯¢å°†ç¬¬2æ­¥çš„æŸ¥è¯¢ç»“æœå’Œdeptè¡¨è¿›è¡Œå…³è”æŸ¥è¯¢&gt;*/&gt;SELECT t1.`id`,t1.`dname`,t1.`loc` , t2.total&gt;FROM dept t1,(SELECTdept_id,COUNT(id) totalFROM empGROUP BY dept_id) t2&gt;WHERE t1.`id` = t2.dept_id;1234567891011121314151617&gt;-- 6.æŸ¥è¯¢æ‰€æœ‰å‘˜å·¥çš„å§“ååŠå…¶ç›´æ¥ä¸Šçº§çš„å§“å,æ²¡æœ‰é¢†å¯¼çš„å‘˜å·¥ä¹Ÿéœ€è¦æŸ¥è¯¢&gt;/*åˆ†æï¼š1.å§“å empï¼Œ ç›´æ¥ä¸Šçº§çš„å§“å emp empè¡¨çš„id å’Œ mgr æ˜¯è‡ªå…³è”2.æ¡ä»¶ emp.id = emp.mgr3.æŸ¥è¯¢å·¦è¡¨çš„æ‰€æœ‰æ•°æ®ï¼Œå’Œ äº¤é›†æ•°æ®ä½¿ç”¨å·¦å¤–è¿æ¥æŸ¥è¯¢&gt;*/&gt;SELECT t1.ename,t1.mgr,t2.`id`,t2.`ename`&gt;FROM emp t1LEFT JOIN emp t2ON t1.`mgr` = t2.`id`;é™„å½•12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394-- éƒ¨é—¨è¡¨CREATE TABLE dept (  id INT PRIMARY KEY PRIMARY KEY, -- éƒ¨é—¨id  dname VARCHAR(50), -- éƒ¨é—¨åç§°  loc VARCHAR(50) -- éƒ¨é—¨æ‰€åœ¨åœ°);-- æ·»åŠ 4ä¸ªéƒ¨é—¨INSERT INTO dept(id,dname,loc) VALUES (10,'æ•™ç ”éƒ¨','åŒ—äº¬'),(20,'å­¦å·¥éƒ¨','ä¸Šæµ·'),(30,'é”€å”®éƒ¨','å¹¿å·'),(40,'è´¢åŠ¡éƒ¨','æ·±åœ³');-- èŒåŠ¡è¡¨ï¼ŒèŒåŠ¡åç§°ï¼ŒèŒåŠ¡æè¿°CREATE TABLE job (  id INT PRIMARY KEY,  jname VARCHAR(20),  description VARCHAR(50));-- æ·»åŠ 4ä¸ªèŒåŠ¡INSERT INTO job (id, jname, description) VALUES(1, 'è‘£äº‹é•¿', 'ç®¡ç†æ•´ä¸ªå…¬å¸ï¼Œæ¥å•'),(2, 'ç»ç†', 'ç®¡ç†éƒ¨é—¨å‘˜å·¥'),(3, 'é”€å”®å‘˜', 'å‘å®¢äººæ¨é”€äº§å“'),(4, 'æ–‡å‘˜', 'ä½¿ç”¨åŠå…¬è½¯ä»¶');-- å‘˜å·¥è¡¨CREATE TABLE emp (  id INT PRIMARY KEY, -- å‘˜å·¥id  ename VARCHAR(50), -- å‘˜å·¥å§“å  job_id INT, -- èŒåŠ¡id  mgr INT , -- ä¸Šçº§é¢†å¯¼  joindate DATE, -- å…¥èŒæ—¥æœŸ  salary DECIMAL(7,2), -- å·¥èµ„  bonus DECIMAL(7,2), -- å¥–é‡‘  dept_id INT, -- æ‰€åœ¨éƒ¨é—¨ç¼–å·  CONSTRAINT emp_jobid_ref_job_id_fk FOREIGN KEY (job_id) REFERENCES job (id),  CONSTRAINT emp_deptid_ref_dept_id_fk FOREIGN KEY (dept_id) REFERENCES dept (id));-- æ·»åŠ å‘˜å·¥INSERT INTO emp(id,ename,job_id,mgr,joindate,salary,bonus,dept_id) VALUES (1001,'å­™æ‚Ÿç©º',4,1004,'2000-12-17','8000.00',NULL,20),(1002,'å¢ä¿Šä¹‰',3,1006,'2001-02-20','16000.00','3000.00',30),(1003,'æ—å†²',3,1006,'2001-02-22','12500.00','5000.00',30),(1004,'å”åƒ§',2,1009,'2001-04-02','29750.00',NULL,20),(1005,'æé€µ',4,1006,'2001-09-28','12500.00','14000.00',30),(1006,'å®‹æ±Ÿ',2,1009,'2001-05-01','28500.00',NULL,30),(1007,'åˆ˜å¤‡',2,1009,'2001-09-01','24500.00',NULL,10),(1008,'çŒªå…«æˆ’',4,1004,'2007-04-19','30000.00',NULL,20),(1009,'ç½—è´¯ä¸­',1,NULL,'2001-11-17','50000.00',NULL,10),(1010,'å´ç”¨',3,1006,'2001-09-08','15000.00','0.00',30),(1011,'æ²™åƒ§',4,1004,'2007-05-23','11000.00',NULL,20),(1012,'æé€µ',4,1006,'2001-12-03','9500.00',NULL,30),(1013,'å°ç™½é¾™',4,1004,'2001-12-03','30000.00',NULL,20),(1014,'å…³ç¾½',4,1007,'2002-01-23','13000.00',NULL,10);-- å·¥èµ„ç­‰çº§è¡¨CREATE TABLE salarygrade (  grade INT PRIMARY KEY,   -- çº§åˆ«  losalary INT,  -- æœ€ä½å·¥èµ„  hisalary INT -- æœ€é«˜å·¥èµ„);-- æ·»åŠ 5ä¸ªå·¥èµ„ç­‰çº§INSERT INTO salarygrade(grade,losalary,hisalary) VALUES (1,7000,12000),(2,12010,14000),(3,14010,20000),(4,20010,30000),(5,30010,99990);-- éœ€æ±‚ï¼š-- 1.æŸ¥è¯¢æ‰€æœ‰å‘˜å·¥ä¿¡æ¯ã€‚æŸ¥è¯¢å‘˜å·¥ç¼–å·ï¼Œå‘˜å·¥å§“åï¼Œå·¥èµ„ï¼ŒèŒåŠ¡åç§°ï¼ŒèŒåŠ¡æè¿°-- 2.æŸ¥è¯¢å‘˜å·¥ç¼–å·ï¼Œå‘˜å·¥å§“åï¼Œå·¥èµ„ï¼ŒèŒåŠ¡åç§°ï¼ŒèŒåŠ¡æè¿°ï¼Œéƒ¨é—¨åç§°ï¼Œéƒ¨é—¨ä½ç½®   -- 3.æŸ¥è¯¢å‘˜å·¥å§“åï¼Œå·¥èµ„ï¼Œå·¥èµ„ç­‰çº§-- 4.æŸ¥è¯¢å‘˜å·¥å§“åï¼Œå·¥èµ„ï¼ŒèŒåŠ¡åç§°ï¼ŒèŒåŠ¡æè¿°ï¼Œéƒ¨é—¨åç§°ï¼Œéƒ¨é—¨ä½ç½®ï¼Œå·¥èµ„ç­‰çº§-- 5.æŸ¥è¯¢å‡ºéƒ¨é—¨ç¼–å·ã€éƒ¨é—¨åç§°ã€éƒ¨é—¨ä½ç½®ã€éƒ¨é—¨äººæ•° -- 6.æŸ¥è¯¢æ‰€æœ‰å‘˜å·¥çš„å§“ååŠå…¶ç›´æ¥ä¸Šçº§çš„å§“å,æ²¡æœ‰é¢†å¯¼çš„å‘˜å·¥ä¹Ÿéœ€è¦æŸ¥è¯¢</content>
	</entry>
	<entry>
		<title>MySQL_æ•°æ®åº“è®¾è®¡</title>
		<url>/article/71074955.html</url>
		<content>è¡¨é—´å…³ç³»MySQLçº¦æŸä¸è®¾è®¡å…³ç³»åˆ†ç±»ä¸€å¯¹ä¸€(äº†è§£)ï¼šå¦‚ï¼šäººå’Œèº«ä»½è¯åˆ†æï¼šä¸€ä¸ªäººåªæœ‰ä¸€ä¸ªèº«ä»½è¯ï¼Œä¸€ä¸ªèº«ä»½è¯åªèƒ½å¯¹åº”ä¸€ä¸ªäººå®ç°æ–¹å¼ï¼šä¸€å¯¹ä¸€å…³ç³»å®ç°ï¼Œå¯ä»¥åœ¨ä»»æ„ä¸€æ–¹æ·»åŠ å”¯ä¸€å¤–é”®æŒ‡å‘å¦ä¸€æ–¹çš„ä¸»é”®ä¸€å¯¹å¤š(å¤šå¯¹ä¸€)ï¼šå¦‚ï¼šéƒ¨é—¨å’Œå‘˜å·¥åˆ†æï¼šä¸€ä¸ªéƒ¨é—¨æœ‰å¤šä¸ªå‘˜å·¥ï¼Œä¸€ä¸ªå‘˜å·¥åªèƒ½å¯¹åº”ä¸€ä¸ªéƒ¨é—¨å®ç°æ–¹å¼ï¼šåœ¨å¤šçš„ä¸€æ–¹å»ºç«‹å¤–é”®ï¼ŒæŒ‡å‘ä¸€çš„ä¸€æ–¹çš„ä¸»é”®å¤šå¯¹å¤šï¼šå¦‚ï¼šå­¦ç”Ÿå’Œè¯¾ç¨‹åˆ†æï¼šä¸€ä¸ªå­¦ç”Ÿå¯ä»¥é€‰æ‹©å¾ˆå¤šé—¨è¯¾ç¨‹ï¼Œä¸€ä¸ªè¯¾ç¨‹ä¹Ÿå¯ä»¥è¢«å¾ˆå¤šå­¦ç”Ÿé€‰æ‹©å®ç°æ–¹å¼ï¼šå¤šå¯¹å¤šå…³ç³»å®ç°éœ€è¦å€ŸåŠ©ç¬¬ä¸‰å¼ ä¸­é—´è¡¨ã€‚ä¸­é—´è¡¨è‡³å°‘åŒ…å«ä¸¤ä¸ªå­—æ®µï¼Œè¿™ä¸¤ä¸ªå­—æ®µä½œä¸ºç¬¬ä¸‰å¼ è¡¨çš„å¤–é”®ï¼Œåˆ†åˆ«æŒ‡å‘ä¸¤å¼ è¡¨çš„ä¸»é”®æ¡ˆä¾‹12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758&gt;-- åˆ›å»ºæ—…æ¸¸çº¿è·¯åˆ†ç±»è¡¨ tab_category&gt;-- cid æ—…æ¸¸çº¿è·¯åˆ†ç±»ä¸»é”®ï¼Œè‡ªåŠ¨å¢é•¿&gt;-- cname æ—…æ¸¸çº¿è·¯åˆ†ç±»åç§°éç©ºï¼Œå”¯ä¸€ï¼Œå­—ç¬¦ä¸² 100&gt;CREATE TABLE tab_category (cid INT PRIMARY KEY AUTO_INCREMENT,cname VARCHAR(100) NOT NULL UNIQUE&gt;);&gt;-- åˆ›å»ºæ—…æ¸¸çº¿è·¯è¡¨ tab_route&gt;/*   rid æ—…æ¸¸çº¿è·¯ä¸»é”®ï¼Œè‡ªåŠ¨å¢é•¿   rname æ—…æ¸¸çº¿è·¯åç§°éç©ºï¼Œå”¯ä¸€ï¼Œå­—ç¬¦ä¸² 100   price ä»·æ ¼   rdate ä¸Šæ¶æ—¶é—´ï¼Œæ—¥æœŸç±»å‹   cid å¤–é”®ï¼Œæ‰€å±åˆ†ç±» */&gt;CREATE TABLE tab_route(rid INT PRIMARY KEY AUTO_INCREMENT,rname VARCHAR(100) NOT NULL UNIQUE,price DOUBLE,rdate DATE,cid INT,FOREIGN KEY (cid) REFERENCES tab_category(cid)&gt;);&gt;/*åˆ›å»ºç”¨æˆ·è¡¨ tab_user   uid ç”¨æˆ·ä¸»é”®ï¼Œè‡ªå¢é•¿   username ç”¨æˆ·åé•¿åº¦ 100ï¼Œå”¯ä¸€ï¼Œéç©º   password å¯†ç é•¿åº¦ 30ï¼Œéç©º   name çœŸå®å§“åé•¿åº¦ 100   birthday ç”Ÿæ—¥   sex æ€§åˆ«ï¼Œå®šé•¿å­—ç¬¦ä¸² 1   telephone æ‰‹æœºå·ï¼Œå­—ç¬¦ä¸² 11   email é‚®ç®±ï¼Œå­—ç¬¦ä¸²é•¿åº¦ 100 */&gt;CREATE TABLE tab_user (uid INT PRIMARY KEY AUTO_INCREMENT,username VARCHAR(100) UNIQUE NOT NULL,PASSWORD VARCHAR(30) NOT NULL,NAME VARCHAR(100),birthday DATE,sex CHAR(1) DEFAULT 'ç”·',telephone VARCHAR(11),email VARCHAR(100)&gt;);&gt;/*åˆ›å»ºæ”¶è—è¡¨ tab_favorite   rid æ—…æ¸¸çº¿è·¯ idï¼Œå¤–é”®   date æ”¶è—æ—¶é—´   uid ç”¨æˆ· idï¼Œå¤–é”®   rid å’Œ uid ä¸èƒ½é‡å¤ï¼Œè®¾ç½®å¤åˆä¸»é”®ï¼ŒåŒä¸€ä¸ªç”¨æˆ·ä¸èƒ½æ”¶è—åŒä¸€ä¸ªçº¿è·¯ä¸¤æ¬¡ */&gt;CREATE TABLE tab_favorite (rid INT, -- çº¿è·¯idDATE DATETIME,uid INT, -- ç”¨æˆ·id-- åˆ›å»ºå¤åˆä¸»é”®PRIMARY KEY(rid,uid), -- è”åˆä¸»é”®FOREIGN KEY (rid) REFERENCES tab_route(rid),FOREIGN KEY(uid) REFERENCES tab_user(uid)&gt;);è®¾è®¡èŒƒå¼åŸºæœ¬æ¦‚å¿µæ¦‚å¿µï¼šè®¾è®¡æ•°æ®åº“æ—¶ï¼Œéœ€è¦éµå¾ªçš„ä¸€äº›è§„èŒƒã€‚è¦éµå¾ªåè¾¹çš„èŒƒå¼è¦æ±‚ï¼Œå¿…é¡»å…ˆéµå¾ªå‰è¾¹çš„æ‰€æœ‰èŒƒå¼è¦æ±‚è®¾è®¡å…³ç³»æ•°æ®åº“æ—¶ï¼Œéµä»ä¸åŒçš„è§„èŒƒè¦æ±‚ï¼Œè®¾è®¡å‡ºåˆç†çš„å…³ç³»å‹æ•°æ®åº“ï¼Œè¿™äº›ä¸åŒçš„è§„èŒƒè¦æ±‚è¢«ç§°ä¸ºä¸åŒçš„èŒƒå¼ï¼Œå„ç§èŒƒå¼å‘ˆé€’æ¬¡è§„èŒƒï¼Œè¶Šé«˜çš„èŒƒå¼æ•°æ®åº“å†—ä½™è¶Šå°ã€‚ç›®å‰å…³ç³»æ•°æ®åº“æœ‰å…­ç§èŒƒå¼ï¼šç¬¬ä¸€èŒƒå¼ï¼ˆ1NFï¼‰ã€ç¬¬äºŒèŒƒå¼ï¼ˆ2NFï¼‰ã€ç¬¬ä¸‰èŒƒå¼ï¼ˆ3NFï¼‰ã€å·´æ–¯-ç§‘å¾·èŒƒå¼ï¼ˆBCNFï¼‰ã€ç¬¬å››èŒƒå¼(4NFï¼‰å’Œç¬¬äº”èŒƒå¼ï¼ˆ5NFï¼Œåˆç§°å®Œç¾èŒƒå¼ï¼‰ã€‚åˆ†ç±»: ç¬¬ä¸€èŒƒå¼(1NF)ï¼šæ¯ä¸€åˆ—éƒ½æ˜¯ä¸å¯åˆ†å‰²çš„åŸå­æ•°æ®é¡¹ç¬¬äºŒèŒƒå¼(2NF)ï¼šåœ¨1NFçš„åŸºç¡€ä¸Šï¼Œéç å±æ€§å¿…é¡»å®Œå…¨ä¾èµ–äºç ï¼ˆåœ¨1NFåŸºç¡€ä¸Šæ¶ˆé™¤éä¸»å±æ€§å¯¹ä¸»ç çš„éƒ¨åˆ†å‡½æ•°ä¾èµ–ï¼‰å‡½æ•°ä¾èµ–ï¼šAâ€”&gt;B,å¦‚æœé€šè¿‡Aå±æ€§(å±æ€§ç»„)çš„å€¼ï¼Œå¯ä»¥ç¡®å®šå”¯ä¸€Bå±æ€§çš„å€¼ã€‚åˆ™ç§°Bä¾èµ–äºAä¾‹å¦‚ï¼šå­¦å·â€”&gt;å§“åå®Œå…¨å‡½æ•°ä¾èµ–ï¼šAâ€”&gt;Bï¼Œ å¦‚æœAæ˜¯ä¸€ä¸ªå±æ€§ç»„ï¼Œåˆ™Bå±æ€§å€¼å¾—ç¡®å®šéœ€è¦ä¾èµ–äºAå±æ€§ç»„ä¸­æ‰€æœ‰çš„å±æ€§å€¼ã€‚ä¾‹å¦‚ï¼š(å­¦å·, è¯¾ç¨‹åç§°) â€”&gt; åˆ†æ•°éƒ¨åˆ†å‡½æ•°ä¾èµ–ï¼šAâ€”&gt;Bï¼Œ å¦‚æœAæ˜¯ä¸€ä¸ªå±æ€§ç»„ï¼Œåˆ™Bå±æ€§å€¼å¾—ç¡®å®šåªéœ€è¦ä¾èµ–äºAå±æ€§ç»„ä¸­æŸä¸€äº›å€¼å³å¯ã€‚ä¾‹å¦‚ï¼š(å­¦å·, è¯¾ç¨‹åç§°) â€” &gt; å§“åä¼ é€’å‡½æ•°ä¾èµ–ï¼šAâ€”&gt;B, B â€” &gt;C . å¦‚æœé€šè¿‡Aå±æ€§(å±æ€§ç»„)çš„å€¼ï¼Œå¯ä»¥ç¡®å®šå”¯ä¸€Bå±æ€§çš„å€¼ï¼Œåœ¨é€šè¿‡Bå±æ€§ï¼ˆå±æ€§ç»„ï¼‰çš„å€¼å¯ä»¥ç¡®å®šå”¯ä¸€Cå±æ€§çš„å€¼ï¼Œåˆ™ç§° C ä¼ é€’å‡½æ•°ä¾èµ–äºA ä¾‹å¦‚ï¼šå­¦å·â€”&gt;ç³»åï¼Œç³»åâ€”&gt;ç³»ä¸»ä»»ç ï¼šå¦‚æœåœ¨ä¸€å¼ è¡¨ä¸­ï¼Œä¸€ä¸ªå±æ€§æˆ–å±æ€§ç»„ï¼Œè¢«å…¶ä»–æ‰€æœ‰å±æ€§æ‰€å®Œå…¨ä¾èµ–ï¼Œåˆ™ç§°è¿™ä¸ªå±æ€§(å±æ€§ç»„)ä¸ºè¯¥è¡¨çš„ç  ä¾‹å¦‚ï¼šè¯¥è¡¨ä¸­ç ä¸ºï¼š(å­¦å·, è¯¾ç¨‹åç§°)ä¸»å±æ€§ï¼šç å±æ€§ç»„ä¸­çš„æ‰€æœ‰å±æ€§éä¸»å±æ€§ï¼šé™¤äº†ç å±æ€§ç»„çš„å±æ€§ç¬¬ä¸‰èŒƒå¼(3NF)ï¼šåœ¨2NFåŸºç¡€ä¸Šï¼Œä»»ä½•éä¸»å±æ€§ä¸ä¾èµ–äºå…¶å®ƒéä¸»å±æ€§ï¼ˆåœ¨2NFåŸºç¡€ä¸Šæ¶ˆé™¤ä¼ é€’ä¾èµ–ï¼‰ç¤ºä¾‹æ™®é€šè¡¨å­¦å·å§“åç³»åç³»ä¸»ä»»è¯¾ç¨‹åç§°åˆ†æ•°10010å¼ æ— å¿Œç»æµç³»å¼ ä¸‰ä¸°é«˜ç­‰æ•°å­¦9510010å¼ æ— å¿Œç»æµç³»å¼ ä¸‰ä¸°å¤§å­¦è‹±è¯­8710010å¼ æ— å¿Œç»æµç³»å¼ ä¸‰ä¸°è®¡ç®—æœºåŸºç¡€6510011ä»¤ç‹å†²æ³•å¾‹ç³»ä»»æˆ‘è¡Œæ³•ç†å­¦7710011ä»¤ç‹å†²æ³•å¾‹ç³»ä»»æˆ‘è¡Œå¤§å­¦è‹±è¯­8710011ä»¤ç‹å†²æ³•å¾‹ç³»ä»»æˆ‘è¡Œæ³•å¾‹ç¤¾ä¼šå­¦6510012æ¨è¿‡æ³•å¾‹ç³»ä»»æˆ‘è¡Œæ³•å¾‹ç¤¾ä¼šå­¦9510012æ¨è¿‡æ³•å¾‹ç³»ä»»æˆ‘è¡Œæ³•ç†å­¦9710012æ¨è¿‡æ³•å¾‹ç³»ä»»æˆ‘è¡Œå¤§å­¦è‹±è¯­991NFå­¦å·å§“åç³»åç³»ä¸»ä»»è¯¾ç¨‹åç§°åˆ†æ•°10010å¼ æ— å¿Œç»æµç³»å¼ ä¸‰ä¸°é«˜ç­‰æ•°å­¦9510010å¼ æ— å¿Œç»æµç³»å¼ ä¸‰ä¸°å¤§å­¦è‹±è¯­8710010å¼ æ— å¿Œç»æµç³»å¼ ä¸‰ä¸°è®¡ç®—æœºåŸºç¡€6510011ä»¤ç‹å†²æ³•å¾‹ç³»ä»»æˆ‘è¡Œæ³•ç†å­¦7710011ä»¤ç‹å†²æ³•å¾‹ç³»ä»»æˆ‘è¡Œå¤§å­¦è‹±è¯­8710011ä»¤ç‹å†²æ³•å¾‹ç³»ä»»æˆ‘è¡Œæ³•å¾‹ç¤¾ä¼šå­¦6510012æ¨è¿‡æ³•å¾‹ç³»ä»»æˆ‘è¡Œæ³•å¾‹ç¤¾ä¼šå­¦9510012æ¨è¿‡æ³•å¾‹ç³»ä»»æˆ‘è¡Œæ³•ç†å­¦9710012æ¨è¿‡æ³•å¾‹ç³»ä»»æˆ‘è¡Œå¤§å­¦è‹±è¯­99è®¡ç®—æœºç³»æ®·å¤©æ­£å­˜åœ¨çš„é—®é¢˜ï¼šå­˜åœ¨éå¸¸ä¸¥é‡çš„æ•°æ®å†—ä½™(é‡å¤)ï¼šå§“åã€ç³»åã€ç³»ä¸»ä»»æ•°æ®æ·»åŠ å­˜åœ¨é—®é¢˜ï¼šæ·»åŠ æ–°å¼€è®¾çš„ç³»å’Œç³»ä¸»ä»»æ—¶ï¼Œæ•°æ®ä¸åˆæ³•æ•°æ®åˆ é™¤å­˜åœ¨é—®é¢˜ï¼šå¼ æ— å¿ŒåŒå­¦æ¯•ä¸šäº†ï¼Œåˆ é™¤æ•°æ®ï¼Œä¼šå°†ç³»çš„æ•°æ®ä¸€èµ·åˆ é™¤ã€‚2NFé€‰è¯¾è¡¨å­¦å·è¯¾ç¨‹åç§°åˆ†æ•°10010é«˜ç­‰æ•°å­¦9510010å¤§å­¦è‹±è¯­8710010è®¡ç®—æœºåŸºç¡€6510011æ³•ç†å­¦7710011å¤§å­¦è‹±è¯­8710011æ³•å¾‹ç¤¾ä¼šå­¦6510012æ³•å¾‹ç¤¾ä¼šå­¦9510012æ³•ç†å­¦9710012å¤§å­¦è‹±è¯­99å­¦ç”Ÿè¡¨å­¦å·å§“åç³»åç³»ä¸»ä»»10010å¼ æ— å¿Œç»æµç³»å¼ ä¸‰ä¸°10011ä»¤ç‹å†²æ³•å¾‹ç³»ä»»æˆ‘è¡Œ10012æ¨è¿‡æ³•å¾‹ç³»ä»»æˆ‘è¡Œè®¡ç®—æœºç³»æ®·å¤©æ­£å­˜åœ¨çš„é—®é¢˜ï¼šæ•°æ®æ·»åŠ å­˜åœ¨é—®é¢˜ï¼šæ·»åŠ æ–°å¼€è®¾çš„ç³»å’Œç³»ä¸»ä»»æ—¶ï¼Œæ•°æ®ä¸åˆæ³•æ•°æ®åˆ é™¤å­˜åœ¨é—®é¢˜ï¼šå¼ æ— å¿ŒåŒå­¦æ¯•ä¸šäº†ï¼Œåˆ é™¤æ•°æ®ï¼Œä¼šå°†ç³»çš„æ•°æ®ä¸€èµ·åˆ é™¤ã€‚3NFé€‰è¯¾è¡¨å­¦å·è¯¾ç¨‹åç§°åˆ†æ•°10010é«˜ç­‰æ•°å­¦9510010å¤§å­¦è‹±è¯­8710010è®¡ç®—æœºåŸºç¡€6510011æ³•ç†å­¦7710011å¤§å­¦è‹±è¯­8710011æ³•å¾‹ç¤¾ä¼šå­¦6510012æ³•å¾‹ç¤¾ä¼šå­¦9510012æ³•ç†å­¦9710012å¤§å­¦è‹±è¯­99å­¦ç”Ÿè¡¨å­¦å·å§“åç³»å10010å¼ æ— å¿Œç»æµç³»10011ä»¤ç‹å†²æ³•å¾‹ç³»10012æ¨è¿‡æ³•å¾‹ç³»ç³»è¡¨ç³»åç³»ä¸»ä»»ç»æµç³»å¼ ä¸‰ä¸°æ³•å¾‹ç³»ä»»æˆ‘è¡Œè®¡ç®—æœºç³»æ®·å¤©æ­£åˆšåˆšæ‰€æœ‰çš„ä¸‰ä¸ªé—®é¢˜å…¨éƒ¨è¢«è§£å†³æ‰ï¼ï¼ï¼æ•°æ®åº“å¤‡ä»½å’Œè¿˜åŸå‘½ä»¤è¡Œï¼šå¤‡ä»½ï¼š 1mysqldump -uç”¨æˆ·å -på¯†ç  æ•°æ®åº“åç§° &gt; ä¿å­˜çš„è·¯å¾„è¿˜åŸï¼šç™»å½•æ•°æ®åº“åˆ›å»ºæ•°æ®åº“ä½¿ç”¨æ•°æ®åº“æ‰§è¡Œæ–‡ä»¶ (source æ–‡ä»¶è·¯å¾„)å›¾å½¢åŒ–å·¥å…·ï¼š</content>
	</entry>
	<entry>
		<title>MySQL_çº¦æŸ</title>
		<url>/article/fcd59143.html</url>
		<content>MySQLçº¦æŸä¸è®¾è®¡ çº¦æŸæ¦‚å¿µï¼š å¯¹è¡¨ä¸­çš„æ•°æ®è¿›è¡Œé™å®šï¼Œä¿è¯æ•°æ®çš„æ­£ç¡®æ€§ã€æœ‰æ•ˆæ€§å’Œå®Œæ•´æ€§ã€‚    åˆ†ç±»ï¼šä¸»é”®çº¦æŸï¼šprimary keyéç©ºçº¦æŸï¼šnot nullå”¯ä¸€çº¦æŸï¼šuniqueå¤–é”®çº¦æŸï¼šforeign keyéç©ºçº¦æŸï¼šnot nullï¼Œå€¼ä¸èƒ½ä¸ºnull12345678910-- åˆ›å»ºè¡¨æ—¶æ·»åŠ çº¦æŸCREATE TABLE stu(   id INT,   NAME VARCHAR(20) NOT NULL -- nameä¸ºéç©º);-- åˆ›å»ºè¡¨å®Œåï¼Œæ·»åŠ éç©ºçº¦æŸALTER TABLE stu MODIFY NAME VARCHAR(20) NOT NULL;-- åˆ é™¤nameçš„éç©ºçº¦æŸALTER TABLE stu MODIFY NAME VARCHAR(20);å”¯ä¸€çº¦æŸï¼šuniqueå€¼ä¸èƒ½é‡å¤123456789101112&gt;-- åˆ›å»ºè¡¨æ—¶ï¼Œæ·»åŠ å”¯ä¸€çº¦æŸ&gt;CREATE TABLE stu(id INT,phone_number VARCHAR(20) UNIQUE -- æ·»åŠ äº†å”¯ä¸€çº¦æŸ&gt;);&gt;-- æ³¨æ„mysqlä¸­ï¼Œå”¯ä¸€çº¦æŸé™å®šçš„åˆ—çš„å€¼å¯ä»¥æœ‰å¤šä¸ªnull&gt;-- åˆ é™¤å”¯ä¸€çº¦æŸ&gt;ALTER TABLE stu DROP INDEX phone_number;&gt;-- åœ¨åˆ›å»ºè¡¨åï¼Œæ·»åŠ å”¯ä¸€çº¦æŸ&gt;ALTER TABLE stu MODIFY phone_number VARCHAR(20) UNIQUE;ä¸»é”®çº¦æŸï¼šprimary keyæ³¨æ„ï¼šå«ä¹‰ï¼šéç©ºä¸”å”¯ä¸€ä¸€å¼ è¡¨åªèƒ½æœ‰ä¸€ä¸ªå­—æ®µä¸ºä¸»é”®ä¸»é”®å°±æ˜¯è¡¨ä¸­è®°å½•çš„å”¯ä¸€æ ‡è¯†1234567891011121314151617181920212223242526-- åœ¨åˆ›å»ºè¡¨æ—¶ï¼Œæ·»åŠ ä¸»é”®çº¦æŸcreate table stu(id int primary key,-- ç»™idæ·»åŠ ä¸»é”®çº¦æŸname varchar(20));-- åˆ é™¤ä¸»é”®-- é”™è¯¯ alter table stu modify id int ;ALTER TABLE stu DROP PRIMARY KEY;-- åˆ›å»ºå®Œè¡¨åï¼Œæ·»åŠ ä¸»é”®ALTER TABLE stu MODIFY id INT PRIMARY KEY;-- è‡ªåŠ¨å¢é•¿ï¼š-- æ¦‚å¿µï¼šå¦‚æœæŸä¸€åˆ—æ˜¯æ•°å€¼ç±»å‹çš„ï¼Œä½¿ç”¨ auto_increment å¯ä»¥æ¥å®Œæˆå€¼å¾—è‡ªåŠ¨å¢é•¿-- åœ¨åˆ›å»ºè¡¨æ—¶ï¼Œæ·»åŠ ä¸»é”®çº¦æŸï¼Œå¹¶ä¸”å®Œæˆä¸»é”®è‡ªå¢é•¿create table stu(id int primary key auto_increment,-- ç»™idæ·»åŠ ä¸»é”®çº¦æŸname varchar(20));-- åˆ é™¤è‡ªåŠ¨å¢é•¿ALTER TABLE stu MODIFY id INT;-- æ·»åŠ è‡ªåŠ¨å¢é•¿ALTER TABLE stu MODIFY id INT AUTO_INCREMENT;å¤–é”®çº¦æŸï¼šforeign keyè®©è¡¨äºè¡¨äº§ç”Ÿå…³ç³»ï¼Œä»è€Œä¿è¯æ•°æ®çš„æ­£ç¡®æ€§ã€‚123456789101112-- åœ¨åˆ›å»ºè¡¨æ—¶ï¼Œå¯ä»¥æ·»åŠ å¤–é”®create table è¡¨å(....å¤–é”®åˆ—constraint å¤–é”®åç§° foreign key (å¤–é”®åˆ—åç§°) references ä¸»è¡¨åç§°(ä¸»è¡¨åˆ—åç§°));-- åˆ é™¤å¤–é”®ALTER TABLE è¡¨å DROP FOREIGN KEY å¤–é”®åç§°;-- åˆ›å»ºè¡¨ä¹‹åï¼Œæ·»åŠ å¤–é”®ALTER TABLE è¡¨å ADD CONSTRAINT å¤–é”®åç§° FOREIGN KEY (å¤–é”®å­—æ®µåç§°) REFERENCES ä¸»è¡¨åç§°(ä¸»è¡¨åˆ—åç§°);çº§è”æ“ä½œ123456-- æ·»åŠ çº§è”æ“ä½œALTER TABLE è¡¨å ADD CONSTRAINT å¤–é”®åç§° FOREIGN KEY (å¤–é”®å­—æ®µåç§°) REFERENCES ä¸»è¡¨åç§°(ä¸»è¡¨åˆ—åç§°) ON UPDATE CASCADE ON DELETE CASCADE;-- åˆ†ç±»ï¼š1. çº§è”æ›´æ–°ï¼šON UPDATE CASCADE 2. çº§è”åˆ é™¤ï¼šON DELETE CASCADE </content>
	</entry>
	<entry>
		<title>Springæ³¨è§£</title>
		<url>/article/51d35c0d.html</url>
		<content></content>
	</entry>
	<entry>
		<title>å¤šçº¿ç¨‹</title>
		<url>/article/5729df21.html</url>
		<content></content>
	</entry>
	<entry>
		<title>å¤šçº¿ç¨‹_JUCåŸå­ç±»</title>
		<url>/article/304974ef.html</url>
		<content>JUCåŸå­ç±»æ ¹æ®ä¿®æ”¹çš„æ•°æ®ç±»å‹ï¼Œå¯ä»¥å°†JUCåŒ…ä¸­çš„åŸå­æ“ä½œç±»å¯ä»¥åˆ†ä¸º4ç±»ã€‚åŸºæœ¬ç±»å‹: AtomicInteger, AtomicLong, AtomicBoolean ;æ•°ç»„ç±»å‹: AtomicIntegerArray, AtomicLongArray, AtomicReferenceArray ;å¼•ç”¨ç±»å‹: AtomicReference, AtomicStampedRerence, AtomicMarkableReference ;å¯¹è±¡çš„å±æ€§ä¿®æ”¹ç±»å‹: AtomicIntegerFieldUpdater, AtomicLongFieldUpdater, AtomicReferenceFieldUpdater ã€‚è¿™äº›ç±»å­˜åœ¨çš„ç›®çš„æ˜¯å¯¹ç›¸åº”çš„æ•°æ®è¿›è¡ŒåŸå­æ“ä½œã€‚æ‰€è°“åŸå­æ“ä½œï¼Œæ˜¯æŒ‡æ“ä½œè¿‡ç¨‹ä¸ä¼šè¢«ä¸­æ–­ï¼Œä¿è¯æ•°æ®æ“ä½œæ˜¯ä»¥åŸå­æ–¹å¼è¿›è¡Œçš„ã€‚AtomicLongä»‹ç»å’Œå‡½æ•°åˆ—è¡¨AtomicLongæ˜¯ä½œç”¨æ˜¯å¯¹é•¿æ•´å½¢è¿›è¡ŒåŸå­æ“ä½œã€‚åœ¨32ä½æ“ä½œç³»ç»Ÿä¸­ï¼Œ64ä½çš„long å’Œ double å˜é‡ç”±äºä¼šè¢«JVMå½“ä½œä¸¤ä¸ªåˆ†ç¦»çš„32ä½æ¥è¿›è¡Œæ“ä½œï¼Œæ‰€ä»¥ä¸å…·æœ‰åŸå­æ€§ã€‚è€Œä½¿ç”¨AtomicLongèƒ½è®©longçš„æ“ä½œä¿æŒåŸå­å‹ã€‚12345678910111213141516171819202122232425262728293031323334353637// AtomicLongå‡½æ•°åˆ—è¡¨// æ„é€ å‡½æ•°AtomicLong()// åˆ›å»ºå€¼ä¸ºinitialValueçš„AtomicLongå¯¹è±¡AtomicLong(long initialValue)// ä»¥åŸå­æ–¹å¼è®¾ç½®å½“å‰å€¼ä¸ºnewValueã€‚final void set(long newValue) // è·å–å½“å‰å€¼final long get() // ä»¥åŸå­æ–¹å¼å°†å½“å‰å€¼å‡ 1ï¼Œå¹¶è¿”å›å‡1åçš„å€¼ã€‚ç­‰ä»·äºâ€œ--numâ€final long decrementAndGet() // ä»¥åŸå­æ–¹å¼å°†å½“å‰å€¼å‡ 1ï¼Œå¹¶è¿”å›å‡1å‰çš„å€¼ã€‚ç­‰ä»·äºâ€œnum--â€final long getAndDecrement() // ä»¥åŸå­æ–¹å¼å°†å½“å‰å€¼åŠ  1ï¼Œå¹¶è¿”å›åŠ 1åçš„å€¼ã€‚ç­‰ä»·äºâ€œ++numâ€final long incrementAndGet() // ä»¥åŸå­æ–¹å¼å°†å½“å‰å€¼åŠ  1ï¼Œå¹¶è¿”å›åŠ 1å‰çš„å€¼ã€‚ç­‰ä»·äºâ€œnum++â€final long getAndIncrement()    // ä»¥åŸå­æ–¹å¼å°†deltaä¸å½“å‰å€¼ç›¸åŠ ï¼Œå¹¶è¿”å›ç›¸åŠ åçš„å€¼ã€‚final long addAndGet(long delta) // ä»¥åŸå­æ–¹å¼å°†deltaæ·»åŠ åˆ°å½“å‰å€¼ï¼Œå¹¶è¿”å›ç›¸åŠ å‰çš„å€¼ã€‚final long getAndAdd(long delta) // å¦‚æœå½“å‰å€¼ == expectï¼Œåˆ™ä»¥åŸå­æ–¹å¼å°†è¯¥å€¼è®¾ç½®ä¸ºupdateã€‚æˆåŠŸè¿”å›trueï¼Œå¦åˆ™è¿”å›falseï¼Œå¹¶ä¸”ä¸ä¿®æ”¹åŸå€¼ã€‚final boolean compareAndSet(long expect, long update)// ä»¥åŸå­æ–¹å¼è®¾ç½®å½“å‰å€¼ä¸ºnewValueï¼Œå¹¶è¿”å›æ—§å€¼ã€‚final long getAndSet(long newValue)// è¿”å›å½“å‰å€¼å¯¹åº”çš„intå€¼int intValue() // è·å–å½“å‰å€¼å¯¹åº”çš„longå€¼long longValue()    // ä»¥ float å½¢å¼è¿”å›å½“å‰å€¼float floatValue()    // ä»¥ double å½¢å¼è¿”å›å½“å‰å€¼double doubleValue()    // æœ€åè®¾ç½®ä¸ºç»™å®šå€¼ã€‚å»¶æ—¶è®¾ç½®å˜é‡å€¼ï¼Œè¿™ä¸ªç­‰ä»·äºset()æ–¹æ³•ï¼Œä½†æ˜¯ç”±äºå­—æ®µæ˜¯volatileç±»å‹çš„ï¼Œå› æ­¤æ¬¡å­—æ®µçš„ä¿®æ”¹ä¼šæ¯”æ™®é€šå­—æ®µï¼ˆévolatileå­—æ®µï¼‰æœ‰ç¨å¾®çš„æ€§èƒ½å»¶æ—¶ï¼ˆå°½ç®¡å¯ä»¥å¿½ç•¥ï¼‰ï¼Œæ‰€ä»¥å¦‚æœä¸æ˜¯æƒ³ç«‹å³è¯»å–è®¾ç½®çš„æ–°å€¼ï¼Œå…è®¸åœ¨â€œåå°â€ä¿®æ”¹å€¼ï¼Œé‚£ä¹ˆæ­¤æ–¹æ³•å°±å¾ˆæœ‰ç”¨ã€‚å¦‚æœè¿˜æ˜¯éš¾ä»¥ç†è§£ï¼Œè¿™é‡Œå°±ç±»ä¼¼äºå¯åŠ¨ä¸€ä¸ªåå°çº¿ç¨‹å¦‚æ‰§è¡Œä¿®æ”¹æ–°å€¼çš„ä»»åŠ¡ï¼ŒåŸçº¿ç¨‹å°±ä¸ç­‰å¾…ä¿®æ”¹ç»“æœç«‹å³è¿”å›ï¼ˆè¿™ç§è§£é‡Šå…¶å®æ˜¯ä¸æ­£ç¡®çš„ï¼Œä½†æ˜¯å¯ä»¥è¿™ä¹ˆç†è§£ï¼‰ã€‚final void lazySet(long newValue)// å¦‚æœå½“å‰å€¼ == é¢„æœŸå€¼ï¼Œåˆ™ä»¥åŸå­æ–¹å¼å°†è¯¥è®¾ç½®ä¸ºç»™å®šçš„æ›´æ–°å€¼ã€‚JSRè§„èŒƒä¸­è¯´ï¼šä»¥åŸå­æ–¹å¼è¯»å–å’Œæœ‰æ¡ä»¶åœ°å†™å…¥å˜é‡ä½†ä¸ åˆ›å»ºä»»ä½• happen-before æ’åºï¼Œå› æ­¤ä¸æä¾›ä¸é™¤ weakCompareAndSet ç›®æ ‡å¤–ä»»ä½•å˜é‡ä»¥å‰æˆ–åç»­è¯»å–æˆ–å†™å…¥æ“ä½œæœ‰å…³çš„ä»»ä½•ä¿è¯ã€‚å¤§æ„å°±æ˜¯è¯´è°ƒç”¨weakCompareAndSetæ—¶å¹¶ä¸èƒ½ä¿è¯ä¸å­˜åœ¨happen-beforeçš„å‘ç”Ÿï¼ˆä¹Ÿå°±æ˜¯å¯èƒ½å­˜åœ¨æŒ‡ä»¤é‡æ’åºå¯¼è‡´æ­¤æ“ä½œå¤±è´¥ï¼‰ã€‚ä½†æ˜¯ä»Javaæºç æ¥çœ‹ï¼Œå…¶å®æ­¤æ–¹æ³•å¹¶æ²¡æœ‰å®ç°JSRè§„èŒƒçš„è¦æ±‚ï¼Œæœ€åæ•ˆæœå’ŒcompareAndSetæ˜¯ç­‰æ•ˆçš„ï¼Œéƒ½è°ƒç”¨äº†unsafe.compareAndSwapInt()å®Œæˆæ“ä½œã€‚final boolean weakCompareAndSet(long expect, long update)123456789101112131415// ä»¥incrementAndGet()ä¸ºä¾‹ï¼Œå¯¹AtomicLongçš„åŸç†è¿›è¡Œè¯´æ˜ã€‚public final long incrementAndGet() {    for (;;) {        // è·å–AtomicLongå½“å‰å¯¹åº”çš„longå€¼        long current = get();        // å°†currentåŠ 1        long next = current + 1;        // é€šè¿‡CASå‡½æ•°ï¼Œæ›´æ–°currentçš„å€¼        if (compareAndSet(current, next))            return next;    }}è¯´æ˜ï¼š(01) incrementAndGet()é¦–å…ˆä¼šæ ¹æ®get()è·å–AtomicLongå¯¹åº”çš„longå€¼ã€‚è¯¥å€¼æ˜¯volatileç±»å‹çš„å˜é‡ï¼Œget()çš„æºç å¦‚ä¸‹ï¼š(02) incrementAndGet()æ¥ç€å°†currentåŠ 1,ç„¶åé€šè¿‡CASå‡½æ•°ï¼Œå°†æ–°çš„å€¼èµ‹å€¼ç»™valueã€‚123456789101112131415161718192021222324252627282930313233343536373839// AtomicLongç¤ºä¾‹// LongTest.javaçš„æºç import java.util.concurrent.atomic.AtomicLong;public class LongTest {    public static void main(String[] args){        // æ–°å»ºAtomicLongå¯¹è±¡        AtomicLong mAtoLong = new AtomicLong();        mAtoLong.set(0x0123456789ABCDEFL);        System.out.printf(&quot; s : 0x6X\n&quot;, &quot;get()&quot;, mAtoLong.get());        System.out.printf(&quot; s : 0x6X\n&quot;, &quot;intValue()&quot;, mAtoLong.intValue());        System.out.printf(&quot; s : 0x6X\n&quot;, &quot;longValue()&quot;, mAtoLong.longValue());        System.out.printf(&quot; s : %s\n&quot;, &quot;doubleValue()&quot;, mAtoLong.doubleValue());        System.out.printf(&quot; s : %s\n&quot;, &quot;floatValue()&quot;, mAtoLong.floatValue());        System.out.printf(&quot; s : 0x6X\n&quot;, &quot;getAndDecrement()&quot;, mAtoLong.getAndDecrement());        System.out.printf(&quot; s : 0x6X\n&quot;, &quot;decrementAndGet()&quot;, mAtoLong.decrementAndGet());        System.out.printf(&quot; s : 0x6X\n&quot;, &quot;getAndIncrement()&quot;, mAtoLong.getAndIncrement());        System.out.printf(&quot; s : 0x6X\n&quot;, &quot;incrementAndGet()&quot;, mAtoLong.incrementAndGet());        System.out.printf(&quot; s : 0x6X\n&quot;, &quot;addAndGet(0x10)&quot;, mAtoLong.addAndGet(0x10));        System.out.printf(&quot; s : 0x6X\n&quot;, &quot;getAndAdd(0x10)&quot;, mAtoLong.getAndAdd(0x10));        System.out.printf(&quot;\n s : 0x6X\n&quot;, &quot;get()&quot;, mAtoLong.get());        System.out.printf(&quot; s : %s\n&quot;, &quot;compareAndSet()&quot;, mAtoLong.compareAndSet(0x12345679L, 0xFEDCBA9876543210L));        System.out.printf(&quot; s : 0x6X\n&quot;, &quot;get()&quot;, mAtoLong.get());    }}   get() : 0x0123456789ABCDEF          intValue() : 0x0000000089ABCDEF         longValue() : 0x0123456789ABCDEF       doubleValue() : 8.1985529216486896E16        floatValue() : 8.1985531E16   getAndDecrement() : 0x0123456789ABCDEF   decrementAndGet() : 0x0123456789ABCDED   getAndIncrement() : 0x0123456789ABCDED   incrementAndGet() : 0x0123456789ABCDEF     addAndGet(0x10) : 0x0123456789ABCDFF     getAndAdd(0x10) : 0x0123456789ABCDFF               get() : 0x0123456789ABCE0F     compareAndSet() : false               get() : 0x0123456789ABCE0FAtomicLongArrayåŸå­ç±»AtomicLongArrayçš„ä½œç”¨åˆ™æ˜¯å¯¹â€é•¿æ•´å½¢æ•°ç»„â€è¿›è¡ŒåŸå­æ“ä½œã€‚123456789101112131415161718192021222324252627282930313233// AtomicLongArrayå‡½æ•°åˆ—è¡¨// åˆ›å»ºç»™å®šé•¿åº¦çš„æ–° AtomicLongArrayã€‚AtomicLongArray(int length)// åˆ›å»ºä¸ç»™å®šæ•°ç»„å…·æœ‰ç›¸åŒé•¿åº¦çš„æ–° AtomicLongArrayï¼Œå¹¶ä»ç»™å®šæ•°ç»„å¤åˆ¶å…¶æ‰€æœ‰å…ƒç´ ã€‚AtomicLongArray(long[] array)// ä»¥åŸå­æ–¹å¼å°†ç»™å®šå€¼æ·»åŠ åˆ°ç´¢å¼• i çš„å…ƒç´ ã€‚long addAndGet(int i, long delta)// å¦‚æœå½“å‰å€¼ == é¢„æœŸå€¼ï¼Œåˆ™ä»¥åŸå­æ–¹å¼å°†è¯¥å€¼è®¾ç½®ä¸ºç»™å®šçš„æ›´æ–°å€¼ã€‚boolean compareAndSet(int i, long expect, long update)// ä»¥åŸå­æ–¹å¼å°†ç´¢å¼• i çš„å…ƒç´ å‡1ã€‚long decrementAndGet(int i)// è·å–ä½ç½® i çš„å½“å‰å€¼ã€‚long get(int i)// ä»¥åŸå­æ–¹å¼å°†ç»™å®šå€¼ä¸ç´¢å¼• i çš„å…ƒç´ ç›¸åŠ ã€‚long getAndAdd(int i, long delta)// ä»¥åŸå­æ–¹å¼å°†ç´¢å¼• i çš„å…ƒç´ å‡ 1ã€‚long getAndDecrement(int i)// ä»¥åŸå­æ–¹å¼å°†ç´¢å¼• i çš„å…ƒç´ åŠ  1ã€‚long getAndIncrement(int i)// ä»¥åŸå­æ–¹å¼å°†ä½ç½® i çš„å…ƒç´ è®¾ç½®ä¸ºç»™å®šå€¼ï¼Œå¹¶è¿”å›æ—§å€¼ã€‚long getAndSet(int i, long newValue)// ä»¥åŸå­æ–¹å¼å°†ç´¢å¼• i çš„å…ƒç´ åŠ 1ã€‚long incrementAndGet(int i)// æœ€ç»ˆå°†ä½ç½® i çš„å…ƒç´ è®¾ç½®ä¸ºç»™å®šå€¼ã€‚void lazySet(int i, long newValue)// è¿”å›è¯¥æ•°ç»„çš„é•¿åº¦ã€‚int length()// å°†ä½ç½® i çš„å…ƒç´ è®¾ç½®ä¸ºç»™å®šå€¼ã€‚void set(int i, long newValue)// è¿”å›æ•°ç»„å½“å‰å€¼çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ã€‚String toString()// å¦‚æœå½“å‰å€¼ == é¢„æœŸå€¼ï¼Œåˆ™ä»¥åŸå­æ–¹å¼å°†è¯¥å€¼è®¾ç½®ä¸ºç»™å®šçš„æ›´æ–°å€¼ã€‚boolean    weakCompareAndSet(int i, long expect, long update)AtomicLongArrayç¤ºä¾‹12345678910111213141516171819202122232425262728293031323334// LongArrayTest.javaçš„æºç import java.util.concurrent.atomic.AtomicLongArray;public class LongArrayTest {    public static void main(String[] args){        // æ–°å»ºAtomicLongArrayå¯¹è±¡        long[] arrLong = new long[] {10, 20, 30, 40, 50};        AtomicLongArray ala = new AtomicLongArray(arrLong);        ala.set(0, 100);        for (int i=0, len=ala.length(); i&lt;len; i++)             System.out.printf(&quot;get(%d) : %s\n&quot;, i, ala.get(i));        System.out.printf(&quot; s : %s\n&quot;, &quot;getAndDecrement(0)&quot;, ala.getAndDecrement(0));        System.out.printf(&quot; s : %s\n&quot;, &quot;decrementAndGet(1)&quot;, ala.decrementAndGet(1));        System.out.printf(&quot; s : %s\n&quot;, &quot;getAndIncrement(2)&quot;, ala.getAndIncrement(2));        System.out.printf(&quot; s : %s\n&quot;, &quot;incrementAndGet(3)&quot;, ala.incrementAndGet(3));        System.out.printf(&quot; s : %s\n&quot;, &quot;addAndGet(100)&quot;, ala.addAndGet(0, 100));        System.out.printf(&quot; s : %s\n&quot;, &quot;getAndAdd(100)&quot;, ala.getAndAdd(1, 100));        System.out.printf(&quot; s : %s\n&quot;, &quot;compareAndSet()&quot;, ala.compareAndSet(2, 31, 1000));        System.out.printf(&quot; s : %s\n&quot;, &quot;get(2)&quot;, ala.get(2));    }}              get(0) : 100              get(1) : 20              get(2) : 30              get(3) : 40              get(4) : 50  getAndDecrement(0) : 100  decrementAndGet(1) : 19  getAndIncrement(2) : 30  incrementAndGet(3) : 41      addAndGet(100) : 199      getAndAdd(100) : 19     compareAndSet() : true              get(2) : 1000AtomicReferenceä»‹ç»å’Œå‡½æ•°åˆ—è¡¨AtomicReferenceæ˜¯ä½œç”¨æ˜¯å¯¹â€å¯¹è±¡â€è¿›è¡ŒåŸå­æ“ä½œã€‚12345678910111213141516171819// AtomicReferenceå‡½æ•°åˆ—è¡¨// ä½¿ç”¨ null åˆå§‹å€¼åˆ›å»ºæ–°çš„ AtomicReferenceã€‚AtomicReference()// ä½¿ç”¨ç»™å®šçš„åˆå§‹å€¼åˆ›å»ºæ–°çš„ AtomicReferenceã€‚AtomicReference(V initialValue)// å¦‚æœå½“å‰å€¼ == é¢„æœŸå€¼ï¼Œåˆ™ä»¥åŸå­æ–¹å¼å°†è¯¥å€¼è®¾ç½®ä¸ºç»™å®šçš„æ›´æ–°å€¼ã€‚boolean compareAndSet(V expect, V update)// è·å–å½“å‰å€¼ã€‚V get()// ä»¥åŸå­æ–¹å¼è®¾ç½®ä¸ºç»™å®šå€¼ï¼Œå¹¶è¿”å›æ—§å€¼ã€‚V getAndSet(V newValue)// æœ€ç»ˆè®¾ç½®ä¸ºç»™å®šå€¼ã€‚void lazySet(V newValue)// è®¾ç½®ä¸ºç»™å®šå€¼ã€‚void set(V newValue)// è¿”å›å½“å‰å€¼çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ã€‚String toString()// å¦‚æœå½“å‰å€¼ == é¢„æœŸå€¼ï¼Œåˆ™ä»¥åŸå­æ–¹å¼å°†è¯¥å€¼è®¾ç½®ä¸ºç»™å®šçš„æ›´æ–°å€¼ã€‚boolean weakCompareAndSet(V expect, V update)123AtomicReferenceçš„æºç æ¯”è¾ƒç®€å•ã€‚å®ƒæ˜¯é€šè¿‡&quot;volatile&quot;å’Œ&quot;Unsafeæä¾›çš„CASå‡½æ•°å®ç°&quot;åŸå­æ“ä½œã€‚(01) valueæ˜¯volatileç±»å‹ã€‚è¿™ä¿è¯äº†ï¼šå½“æŸçº¿ç¨‹ä¿®æ”¹valueçš„å€¼æ—¶ï¼Œå…¶ä»–çº¿ç¨‹çœ‹åˆ°çš„valueå€¼éƒ½æ˜¯æœ€æ–°çš„valueå€¼ï¼Œå³ä¿®æ”¹ä¹‹åçš„volatileçš„å€¼ã€‚(02) é€šè¿‡CASè®¾ç½®valueã€‚è¿™ä¿è¯äº†ï¼šå½“æŸçº¿ç¨‹æ± é€šè¿‡CASå‡½æ•°(å¦‚compareAndSetå‡½æ•°)è®¾ç½®valueæ—¶ï¼Œå®ƒçš„æ“ä½œæ˜¯åŸå­çš„ï¼Œå³çº¿ç¨‹åœ¨æ“ä½œvalueæ—¶ä¸ä¼šè¢«ä¸­æ–­ã€‚AtomicReferenceç¤ºä¾‹123456789101112131415161718192021222324252627282930313233// AtomicReferenceTest.javaçš„æºç import java.util.concurrent.atomic.AtomicReference;public class AtomicReferenceTest {    public static void main(String[] args){        // åˆ›å»ºä¸¤ä¸ªPersonå¯¹è±¡ï¼Œå®ƒä»¬çš„idåˆ†åˆ«æ˜¯101å’Œ102ã€‚        Person p1 = new Person(101);        Person p2 = new Person(102);        // æ–°å»ºAtomicReferenceå¯¹è±¡ï¼Œåˆå§‹åŒ–å®ƒçš„å€¼ä¸ºp1å¯¹è±¡        AtomicReference ar = new AtomicReference(p1);        // é€šè¿‡CASè®¾ç½®arã€‚å¦‚æœarçš„å€¼ä¸ºp1çš„è¯ï¼Œåˆ™å°†å…¶è®¾ç½®ä¸ºp2ã€‚        ar.compareAndSet(p1, p2);        Person p3 = (Person)ar.get();        System.out.println(&quot;p3 is &quot;+p3);        System.out.println(&quot;p3.equals(p1)=&quot;+p3.equals(p1));    }}class Person {    volatile long id;    public Person(long id) {        this.id = id;    }    public String toString() {        return &quot;id:&quot;+id;    }}// ç»“æœè¯´æ˜ï¼šæ–°å»ºAtomicReferenceå¯¹è±¡aræ—¶ï¼Œå°†å®ƒåˆå§‹åŒ–ä¸ºp1ã€‚ç´§æ¥ç€ï¼Œé€šè¿‡CASå‡½æ•°å¯¹å®ƒè¿›è¡Œè®¾ç½®ã€‚å¦‚æœarçš„å€¼ä¸ºp1çš„è¯ï¼Œåˆ™å°†å…¶è®¾ç½®ä¸ºp2ã€‚æœ€åï¼Œè·å–arå¯¹åº”çš„å¯¹è±¡ï¼Œå¹¶æ‰“å°ç»“æœã€‚p3.equals(p1)çš„ç»“æœä¸ºfalseï¼Œè¿™æ˜¯å› ä¸ºPersonå¹¶æ²¡æœ‰è¦†ç›–equals()æ–¹æ³•ï¼Œè€Œæ˜¯é‡‡ç”¨ç»§æ‰¿è‡ªObject.javaçš„equals()æ–¹æ³•ï¼›è€ŒObject.javaä¸­çš„equals()å®é™…ä¸Šæ˜¯è°ƒç”¨&quot;==&quot;å»æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡ï¼Œå³æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡çš„åœ°å€æ˜¯å¦ç›¸ç­‰ã€‚p3 is id:102p3.equals(p1)=falseAtomicLongFieldUpdaterä»‹ç»å’Œå‡½æ•°åˆ—è¡¨AtomicLongFieldUpdaterå¯ä»¥å¯¹æŒ‡å®šâ€ç±»çš„ â€˜volatile longâ€™ç±»å‹çš„æˆå‘˜â€è¿›è¡ŒåŸå­æ›´æ–°ã€‚å®ƒæ˜¯åŸºäºåå°„åŸç†å®ç°çš„ã€‚1234567891011121314151617181920212223242526272829// AtomicLongFieldUpdaterå‡½æ•°åˆ—è¡¨// å—ä¿æŠ¤çš„æ— æ“ä½œæ„é€ æ–¹æ³•ï¼Œä¾›å­ç±»ä½¿ç”¨ã€‚protected AtomicLongFieldUpdater()// ä»¥åŸå­æ–¹å¼å°†ç»™å®šå€¼æ·»åŠ åˆ°æ­¤æ›´æ–°å™¨ç®¡ç†çš„ç»™å®šå¯¹è±¡çš„å­—æ®µçš„å½“å‰å€¼ã€‚long addAndGet(T obj, long delta)// å¦‚æœå½“å‰å€¼ == é¢„æœŸå€¼ï¼Œåˆ™ä»¥åŸå­æ–¹å¼å°†æ­¤æ›´æ–°å™¨æ‰€ç®¡ç†çš„ç»™å®šå¯¹è±¡çš„å­—æ®µè®¾ç½®ä¸ºç»™å®šçš„æ›´æ–°å€¼ã€‚abstract boolean compareAndSet(T obj, long expect, long update)// ä»¥åŸå­æ–¹å¼å°†æ­¤æ›´æ–°å™¨ç®¡ç†çš„ç»™å®šå¯¹è±¡å­—æ®µå½“å‰å€¼å‡ 1ã€‚long decrementAndGet(T obj)// è·å–æ­¤æ›´æ–°å™¨ç®¡ç†çš„åœ¨ç»™å®šå¯¹è±¡çš„å­—æ®µä¸­ä¿æŒçš„å½“å‰å€¼ã€‚abstract long get(T obj)// ä»¥åŸå­æ–¹å¼å°†ç»™å®šå€¼æ·»åŠ åˆ°æ­¤æ›´æ–°å™¨ç®¡ç†çš„ç»™å®šå¯¹è±¡çš„å­—æ®µçš„å½“å‰å€¼ã€‚long getAndAdd(T obj, long delta)// ä»¥åŸå­æ–¹å¼å°†æ­¤æ›´æ–°å™¨ç®¡ç†çš„ç»™å®šå¯¹è±¡å­—æ®µå½“å‰å€¼å‡ 1ã€‚long getAndDecrement(T obj)// ä»¥åŸå­æ–¹å¼å°†æ­¤æ›´æ–°å™¨ç®¡ç†çš„ç»™å®šå¯¹è±¡å­—æ®µçš„å½“å‰å€¼åŠ  1ã€‚long getAndIncrement(T obj)// å°†æ­¤æ›´æ–°å™¨ç®¡ç†çš„ç»™å®šå¯¹è±¡çš„å­—æ®µä»¥åŸå­æ–¹å¼è®¾ç½®ä¸ºç»™å®šå€¼ï¼Œå¹¶è¿”å›æ—§å€¼ã€‚long getAndSet(T obj, long newValue)// ä»¥åŸå­æ–¹å¼å°†æ­¤æ›´æ–°å™¨ç®¡ç†çš„ç»™å®šå¯¹è±¡å­—æ®µå½“å‰å€¼åŠ  1ã€‚long incrementAndGet(T obj)// æœ€åå°†æ­¤æ›´æ–°å™¨ç®¡ç†çš„ç»™å®šå¯¹è±¡çš„å­—æ®µè®¾ç½®ä¸ºç»™å®šæ›´æ–°å€¼ã€‚abstract void lazySet(T obj, long newValue)// ä¸ºå¯¹è±¡åˆ›å»ºå¹¶è¿”å›ä¸€ä¸ªå…·æœ‰ç»™å®šå­—æ®µçš„æ›´æ–°å™¨ã€‚static &lt;U&gt; AtomicLongFieldUpdater&lt;U&gt; newUpdater(Class&lt;U&gt; tclass, String fieldName)// å°†æ­¤æ›´æ–°å™¨ç®¡ç†çš„ç»™å®šå¯¹è±¡çš„å­—æ®µè®¾ç½®ä¸ºç»™å®šæ›´æ–°å€¼ã€‚abstract void set(T obj, long newValue)// å¦‚æœå½“å‰å€¼ == é¢„æœŸå€¼ï¼Œåˆ™ä»¥åŸå­æ–¹å¼å°†æ­¤æ›´æ–°å™¨æ‰€ç®¡ç†çš„ç»™å®šå¯¹è±¡çš„å­—æ®µè®¾ç½®ä¸ºç»™å®šçš„æ›´æ–°å€¼ã€‚abstract boolean weakCompareAndSet(T obj, long expect, long update)1234567891011121314151617181920212223242526272829// AtomicLongFieldUpdaterç¤ºä¾‹// LongTest.javaçš„æºç import java.util.concurrent.atomic.AtomicLongFieldUpdater;public class LongFieldTest {    public static void main(String[] args) {        // è·å–Personçš„classå¯¹è±¡        Class cls = Person.class;         // æ–°å»ºAtomicLongFieldUpdaterå¯¹è±¡ï¼Œä¼ é€’å‚æ•°æ˜¯â€œclasså¯¹è±¡â€å’Œâ€œlongç±»å‹åœ¨ç±»ä¸­å¯¹åº”çš„åç§°â€        AtomicLongFieldUpdater mAtoLong = AtomicLongFieldUpdater.newUpdater(cls, &quot;id&quot;);        Person person = new Person(12345678L);        // æ¯”è¾ƒpersonçš„&quot;id&quot;å±æ€§ï¼Œå¦‚æœidçš„å€¼ä¸º12345678Lï¼Œåˆ™è®¾ç½®ä¸º1000ã€‚        mAtoLong.compareAndSet(person, 12345678L, 1000);        System.out.println(&quot;id=&quot;+person.getId());    }}class Person {    volatile long id;    public Person(long id) {        this.id = id;    }    public void setId(long id) {        this.id = id;    }    public long getId() {        return id;    }}id=1000</content>
	</entry>
	<entry>
		<title>å¤šçº¿ç¨‹_é”</title>
		<url>/article/b4993685.html</url>
		<content>é”æ¦‚å¿µé”çš„åˆ†ç±»å¦‚ä½•ç†è§£äº’æ–¥é”ã€æ¡ä»¶é”ã€è¯»å†™é”ä»¥åŠè‡ªæ—‹é”ï¼Ÿ5000å­— | 24å¼ å›¾å¸¦ä½ å½»åº•ç†è§£21ç§å¹¶å‘é”äº’æ–¥é”å’Œè‡ªæ—‹é”äº’æ–¥é”å’Œè‡ªæ—‹é”æ˜¯æœ€åº•å±‚çš„ä¸¤ç§é”ï¼Œå…¶ä»–çš„å¾ˆå¤šé”éƒ½æ˜¯åŸºäºä»–ä»¬çš„å®ç°ã€‚å½“çº¿ç¨‹Aè·å–åˆ°é”åï¼Œçº¿ç¨‹Bå†å»è·å–é”ï¼Œæœ‰ä¸¤ç§å¤„ç†æ–¹å¼:çº¿ç¨‹Bå¾ªç¯çš„å»å°è¯•è·å–é”ï¼Œç›´åˆ°è·å–æˆåŠŸä¸ºæ­¢å³è‡ªæ—‹é”çº¿ç¨‹Bæ”¾å¼ƒè·å–é”ï¼Œåœ¨é”ç©ºé—²æ—¶ï¼Œç­‰å¾…è¢«å”¤é†’ï¼Œå³äº’æ–¥é”äº’æ–¥é”äº’æ–¥é”ä¼šé‡Šæ”¾å½“å‰çº¿ç¨‹çš„cpuï¼Œå¯¼è‡´åŠ é”çš„ä»£ç é˜»å¡ï¼Œç›´åˆ°çº¿ç¨‹å†æ¬¡è¢«å”¤é†’ã€‚äº’æ–¥é”åŠ é”å¤±è´¥æ—¶ï¼Œä¼šä»ç”¨æˆ·æ€é™·å…¥åˆ°å†…æ ¸æ€ï¼Œè®©å†…æ ¸å¸®æˆ‘ä»¬åˆ‡æ¢çº¿ç¨‹ï¼Œå­˜åœ¨ä¸€å®šçš„æ€§èƒ½å¼€é”€1while (æŠ¢é”(lock) == æ²¡æŠ¢åˆ°) {ç¡çœ ç›´åˆ°é”çŠ¶æ€æ”¹å˜å†å”¤é†’(lock)}å½“çº¿ç¨‹åŠ é”å¤±è´¥ï¼Œå†…æ ¸ä¼šæŠŠçº¿ç¨‹çš„çŠ¶æ€ç”±â€œè¿è¡Œâ€è®¾ç½®ä¸ºâ€œç¡çœ â€ï¼Œè®©å‡ºcpuå½“é”ç©ºé—²æ—¶ï¼Œå†…æ ¸å”¤é†’çº¿ç¨‹ï¼ŒçŠ¶æ€è®¾ç½®ä¸ºâ€œå°±ç»ªâ€ï¼Œè·å–cpuæ‰§è¡Œè‡ªæ—‹é”è‡ªæ—‹é”ä¼šè‡ªç”¨æˆ·æ€ç”±åº”ç”¨ç¨‹åºå®Œæˆï¼Œä¸æ¶‰åŠç”¨æˆ·æ€åˆ°å†…æ ¸æ€çš„è½¬åŒ–ï¼Œæ²¡æœ‰çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæ€§èƒ½ç›¸å¯¹è¾ƒå¥½ï¼Œè‡ªæ—‹é”åŠ é”è¿‡ç¨‹:1while (æŠ¢é”(lock) == æ²¡æŠ¢åˆ°) {}æŸ¥çœ‹é”çš„çŠ¶æ€é”ç©ºé—²ï¼Œè·å–é”ï¼Œå¦åˆ™æ‰§è¡Œ(1)è‡ªæ—‹é”ä¼šåˆ©ç”¨cpuä¸€ç›´å·¥ä½œç›´åˆ°è·å–åˆ°é”ï¼Œä¸­é—´ä¸ä¼šé‡Šæ”¾cpuï¼Œä½†å¦‚æœè¢«é”ä½çš„ä»£ç æ‰§è¡Œæ—¶é—´è¾ƒé•¿ï¼Œå¯¼è‡´cpuç©ºè½¬ï¼Œæµªè´¹èµ„æºè¯»å†™é”è¯»å†™é”ç”±è¯»é”å’Œå†™é”ç»„æˆï¼šè¯»é”åˆç§°ä¸ºå…±äº«é”ï¼ŒSé”å†™é”åˆç§°ä¸ºæ’å®ƒé”ã€Xé”ï¼Œåœ¨mysqlçš„äº‹åŠ¡ä¸­å¤§é‡ä½¿ç”¨å†™é”æ˜¯ç‹¬å é”ï¼Œä¸€æ—¦çº¿ç¨‹è·å–å†™é”ï¼Œå…¶ä»–çº¿ç¨‹ä¸èƒ½è·å–å†™é”å’Œè¯»é”ã€‚è¯»é”æ˜¯å…±äº«é”ï¼Œå½“çº¿ç¨‹è·å–è¯»é”ï¼Œå…¶ä»–çº¿ç¨‹å¯ä»¥è·å–è¯»é”ä¸èƒ½è·å–å†™é”ã€‚å› ä¸ºå¹¶å‘æ•°æ®è¯»å–å¹¶ä¸ä¼šæ”¹å˜å…±äº«æ•°æ®å¯¼è‡´æ•°æ®ä¸ä¸€è‡´ã€‚è¯»å†™é”æŠŠå¯¹å…±äº«èµ„æºçš„è¯»æ“ä½œå’Œå†™æ“ä½œåˆ†åˆ«åŠ é”æ§åˆ¶ï¼Œèƒ½å¤Ÿæé«˜è¯»çº¿ç¨‹çš„å¹¶å‘æ€§ï¼Œé€‚ç”¨äºè¯»å¤šå†™å°‘çš„åœºæ™¯ã€‚è¯»ä¼˜å…ˆé”ã€å†™ä¼˜å…ˆé”ã€å…¬å¹³è¯»å†™é”è¯»ä¼˜å…ˆé”è¯»ä¼˜å…ˆé”å¸Œæœ›çš„æ˜¯è¯»é”èƒ½å¤Ÿè¢«æ›´å¤šçš„çº¿ç¨‹è·å–ï¼Œå¯ä»¥æé«˜è¯»çº¿ç¨‹çš„å¹¶å‘æ€§ã€‚çº¿ç¨‹Aè·å–äº†è¯»é”ï¼Œçº¿ç¨‹Bæƒ³è·å–å†™é”ï¼Œæ­¤æ—¶ä¼šè¢«é˜»å¡ï¼Œçº¿ç¨‹cå¯ä»¥ç»§ç»­è·å–è¯»é”ï¼Œç›´åˆ°Aå’Œcé‡Šæ”¾é”ï¼Œçº¿ç¨‹Bæ‰å¯ä»¥è·å–å†™é”ã€‚å¦‚æœæœ‰å¾ˆå¤šçº¿ç¨‹è·å–è¯»é”ï¼Œä¸”åŠ é”çš„ä»£ç æ‰§è¡Œæ—¶é—´å¾ˆé•¿ï¼Œå°±åˆ°å¯¼è‡´çº¿ç¨‹Bæ°¸è¿œè·å–ä¸åˆ°å†™é”ã€‚å†™ä¼˜å…ˆé”å†™ä¼˜å…ˆé”å¸Œæœ›çš„æ˜¯å†™é”èƒ½å¤Ÿè¢«ä¼˜å…ˆè·å–ã€‚çº¿ç¨‹Aè·å–äº†è¯»é”ï¼Œçº¿ç¨‹Bæƒ³è·å–å†™é”ï¼Œæ­¤æ—¶ä¼šè¢«é˜»å¡ï¼Œåé¢è·å–è¯»é”éƒ½ä¼šå¤±è´¥ï¼Œçº¿ç¨‹Aé‡Šæ”¾é”ï¼Œçº¿ç¨‹Bå¯ä»¥è·å–å†™é”ï¼Œå…¶ä»–è·å–è¯»é”çš„çº¿ç¨‹é˜»å¡ã€‚å¦‚æœæœ‰å¾ˆå¤šå†™çº¿ç¨‹è·å–å†™é”ï¼Œä¸”åŠ é”çš„ä»£ç æ‰§è¡Œæ—¶é—´å¾ˆé•¿ï¼Œå°±åˆ°å¯¼è‡´è¯»çº¿ç¨‹æ°¸è¿œè·å–ä¸åˆ°è¯»é”ã€‚å…¬å¹³è¯»å†™é”ä¸Šé¢ä¸¤ç§é”éƒ½ä¼šé€ æˆã€é¥¥é¥¿ã€‘ç°è±¡ï¼Œä¸ºè§£å†³è¿™ç§é—®é¢˜ï¼Œå¯ä»¥å¢åŠ ä¸€ä¸ªé˜Ÿåˆ—ï¼ŒæŠŠè·å–é”çš„çº¿ç¨‹ï¼ˆä¸ç®¡æ˜¯å†™çº¿ç¨‹è¿˜æ˜¯è¯»çº¿ç¨‹ï¼‰æŒ‰ç…§å…ˆè¿›å…ˆå‡ºçš„æ–¹å¼æ’é˜Ÿï¼Œæ¯æ¬¡ä»é˜Ÿåˆ—ä¸­å–å‡ºä¸€ä¸ªçº¿ç¨‹è·å–é”ï¼Œè¿™ç§è·å–é”çš„æ–¹å¼æ˜¯å…¬å¹³çš„ã€‚ä¹è§‚é”å’Œæ‚²è§‚é”ä¹è§‚é”ä¹è§‚é”æ˜¯å…ˆä¿®æ”¹å…±äº«èµ„æºï¼Œå†ç”¨å†å²æ•°æ®å’Œå½“å‰æ•°æ®æ¯”å¯¹éªŒè¯è¿™æ®µæ—¶é—´å…±äº«æ•°æ®æœ‰æ²¡æœ‰è¢«ä¿®æ”¹ï¼Œå¦‚æœæ²¡æœ‰è¢«ä¿®æ”¹ï¼Œé‚£ä¹ˆæ›´æ–°æ•°æ®ï¼Œå¦‚æœæœ‰å…¶ä»–çº¿ç¨‹æ›´æ–°äº†å…±äº«èµ„æºï¼Œéœ€è¦é‡æ–°è·å–æ•°æ®ï¼Œå†æ›´æ–°ï¼ŒéªŒè¯ï¼Œå¾ªç¯å¾€å¤çš„é‡è¯•ï¼Œç›´åˆ°æ›´æ–°æˆåŠŸã€‚æ‰€ä»¥å½“æ•°æ®æ›´æ–°æ“ä½œæ¯”è¾ƒé¢‘ç¹ï¼Œæ•°æ®å†²çªçš„æ¦‚ç‡å°±ä¼šæ¯”è¾ƒå¤§ï¼Œé‡è¯•çš„æ¬¡æ•°å°±ä¼šå¤šï¼Œæµªè´¹CPUèµ„æºã€‚ä¹è§‚é”å…¶å®å…¨ç¨‹æ²¡æœ‰åŠ é”ï¼Œä¹Ÿå«æ— é”ç¼–ç¨‹ï¼Œæ‰€ä»¥é’ˆå¯¹è¯»å¤šå†™å°‘çš„åœºæ™¯ï¼Œå¹¶å‘æ€§èƒ½è¾ƒé«˜ï¼Œå…¸å‹çš„å®ç°MVCCï¼Œmysqlä¸­ä¼šä½¿ç”¨MVCCæ„å»ºä¸€è‡´æ€§è¯»æ¥ä¿è¯å¯é‡å¤è¯»ã€‚æ‚²è§‚é”æ‚²è§‚é”æ˜¯åœ¨è®¿é—®å…±äº«èµ„æºä¹‹å‰ç»Ÿç»ŸåŠ é”ã€‚å½“å¹¶å‘å†²çªæ¦‚ç‡è¾ƒé«˜æ—¶ï¼Œä¹è§‚é”ä¸å†é€‚ç”¨ï¼Œæ‚²è§‚é”å°±æ´¾ä¸Šç”¨åœºã€‚äº’æ–¥é”ã€è‡ªæ—‹é”éƒ½æ˜¯æ‚²è§‚é”çš„å®ç°ã€‚æƒŠç¾¤é—®é¢˜[æ¡†æ¶]é«˜å¹¶å‘ä¸­çš„æƒŠç¾¤æ•ˆåº”å½“ä½ å¾€ä¸€ç¾¤é¸½å­ä¸­é—´æ‰”ä¸€å—é£Ÿç‰©ï¼Œè™½ç„¶æœ€ç»ˆåªæœ‰ä¸€ä¸ªé¸½å­æŠ¢åˆ°é£Ÿç‰©ï¼Œä½†æ‰€æœ‰é¸½å­éƒ½ä¼šè¢«æƒŠåŠ¨æ¥äº‰å¤ºï¼Œæ²¡æœ‰æŠ¢åˆ°é£Ÿç‰©çš„é¸½å­åªå¥½å›å»ç»§ç»­ç¡è§‰ï¼Œ ç­‰å¾…ä¸‹ä¸€å—é£Ÿç‰©åˆ°æ¥ã€‚è¿™æ ·ï¼Œæ¯æ‰”ä¸€å—é£Ÿç‰©ï¼Œéƒ½ä¼šæƒŠåŠ¨æ‰€æœ‰çš„é¸½å­ï¼Œå³ä¸ºæƒŠç¾¤ã€‚ ç®€å•åœ°è¯´ï¼šå°±æ˜¯æ‰”ä¸€å—é£Ÿç‰©ï¼Œæ‰€æœ‰é¸½å­æ¥æŠ¢ï¼Œä½†æœ€ç»ˆåªä¸€ä¸ªé¸½å­æŠ¢åˆ°äº†é£Ÿç‰©ã€‚è¯­ä¹‰åˆ†æï¼šé£Ÿç‰©åªæœ‰ä¸€å—ï¼Œæœ€ç»ˆåªæœ‰ä¸€ä¸ªé¸½å­æŠ¢åˆ°ï¼Œä½†æ˜¯æƒŠåŠ¨äº†æ‰€æœ‰é¸½å­ï¼Œæ¯ä¸ªé¸½å­éƒ½è·‘è¿‡æ¥ï¼Œæ¶ˆè€—äº†æ¯ä¸ªé¸½å­çš„èƒ½é‡ã€‚ï¼ˆè¿™ä¸ªå¾ˆç¬¦åˆè¾¾å°”æ–‡çš„è¿›åŒ–è®ºï¼Œç‰©ç§ä¹‹é—´çš„ç«äº‰ï¼Œé€‚è€…ç”Ÿå­˜ã€‚ï¼‰æ“ä½œç³»ç»Ÿçš„æƒŠç¾¤åœ¨å¤šè¿›ç¨‹/å¤šçº¿ç¨‹ç­‰å¾…åŒä¸€èµ„æºæ—¶ï¼Œä¹Ÿä¼šå‡ºç°æƒŠç¾¤ã€‚å³å½“æŸä¸€èµ„æºå¯ç”¨æ—¶ï¼Œå¤šä¸ªè¿›ç¨‹/çº¿ç¨‹ä¼šæƒŠé†’ï¼Œç«äº‰èµ„æºã€‚è¿™å°±æ˜¯æ“ä½œç³»ç»Ÿä¸­çš„æƒŠç¾¤ã€‚æƒŠé†’æ‰€æœ‰è¿›ç¨‹/çº¿ç¨‹ï¼Œå¯¼è‡´n-1ä¸ªè¿›ç¨‹/çº¿ç¨‹åšäº†æ— æ•ˆçš„è°ƒåº¦ï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œcpuç¬æ—¶å¢é«˜å¤šä¸ªè¿›ç¨‹/çº¿ç¨‹äº‰æŠ¢èµ„æºï¼Œæ‰€ä»¥æ¶‰åŠåˆ°åŒæ­¥é—®é¢˜ï¼Œéœ€å¯¹èµ„æºè¿›è¡ŒåŠ é”ä¿æŠ¤ï¼ŒåŠ è§£é”åŠ å¤§ç³»ç»ŸCPUå¼€é”€æƒŠç¾¤çš„å‡ ç§æƒ…å†µåœ¨é«˜å¹¶å‘ï¼ˆå¤šçº¿ç¨‹/å¤šè¿›ç¨‹/å¤šè¿æ¥ï¼‰ä¸­ï¼Œä¼šäº§ç”ŸæƒŠç¾¤çš„æƒ…å†µæœ‰ï¼šacceptæƒŠç¾¤epollæƒŠç¾¤nginxæƒŠç¾¤çº¿ç¨‹æ± æƒŠç¾¤çº¿ç¨‹æ± æƒŠç¾¤åœ¨å¤šçº¿ç¨‹è®¾è®¡ä¸­ï¼Œç»å¸¸ä¼šç”¨åˆ°äº’æ–¥å’Œæ¡ä»¶å˜é‡çš„é—®é¢˜ã€‚å½“ä¸€ä¸ªçº¿ç¨‹è§£é”å¹¶é€šçŸ¥å…¶ä»–çº¿ç¨‹çš„æ—¶å€™ï¼Œå°±ä¼šå‡ºç°æƒŠç¾¤çš„ç°è±¡ã€‚pthread_mutex_lock/pthread_mutex_unlockï¼šçº¿ç¨‹äº’æ–¥é”çš„åŠ é”åŠè§£é”å‡½æ•°ã€‚pthread_cond_waitï¼šçº¿ç¨‹æ± ä¸­çš„æ¶ˆè´¹è€…çº¿ç¨‹ç­‰å¾…çº¿ç¨‹æ¡ä»¶å˜é‡è¢«é€šçŸ¥ï¼›pthread_cond_signal/pthread_cond_broadcastï¼šç”Ÿäº§è€…çº¿ç¨‹é€šçŸ¥çº¿ç¨‹æ± ä¸­çš„æŸä¸ªæˆ–ä¸€äº›æ¶ˆè´¹è€…çº¿ç¨‹æ± ï¼Œæ¥æ”¶å¤„ç†ä»»åŠ¡ï¼›è¿™é‡Œçš„æƒŠç¾¤ç°è±¡å‡ºç°åœ¨3é‡Œï¼Œpthread_cond_signalï¼Œè¯­ä¹‰ä¸Šçœ‹ï¼Œæ˜¯é€šçŸ¥ä¸€ä¸ªçº¿ç¨‹ã€‚è°ƒç”¨æ­¤å‡½æ•°åï¼Œç³»ç»Ÿä¼šå”¤é†’åœ¨ç›¸åŒæ¡ä»¶å˜é‡ä¸Šç­‰å¾…çš„ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ï¼ˆå¯å‚çœ‹æ‰‹å†Œï¼‰ã€‚å¦‚æœé€šçŸ¥äº†å¤šä¸ªçº¿ç¨‹ï¼Œåˆ™å‘ç”Ÿäº†æƒŠç¾¤ã€‚æ­£å¸¸çš„ç”¨æ³•ï¼šæ‰€æœ‰çº¿ç¨‹å…±ç”¨ä¸€ä¸ªé”ï¼Œå…±ç”¨ä¸€ä¸ªæ¡ä»¶å˜é‡å½“pthread_cond_signalé€šçŸ¥æ—¶ï¼Œå°±å¯èƒ½ä¼šå‡ºç°æƒŠç¾¤è§£å†³æƒŠç¾¤çš„æ–¹æ³•ï¼šæ‰€æœ‰çº¿ç¨‹å…±ç”¨ä¸€ä¸ªé”ï¼Œæ¯ä¸ªçº¿ç¨‹æœ‰è‡ªå·²çš„æ¡ä»¶å˜é‡pthread_cond_signalé€šçŸ¥æ—¶ï¼Œå®šå‘é€šçŸ¥æŸä¸ªçº¿ç¨‹çš„æ¡ä»¶å˜é‡ï¼Œä¸ä¼šå‡ºç°æƒŠç¾¤</content>
	</entry>
	<entry>
		<title>æšä¸¾ç±»Enum</title>
		<url>/article/4071.html</url>
		<content>æšä¸¾ç±»Enumæšä¸¾ç±»æœ‰å“ªäº›å¥½å¤„æšä¸¾ç±»å¯ä»¥æ–¹ä¾¿åœ°è¡¨ç¤ºæ˜ŸæœŸï¼Œæœˆä»½ç­‰å¸¸æ•°ç±»å‹ï¼Œå¦‚æœä½ ä¸ç”¨æšä¸¾ç±»ï¼Œé‚£ä¹ˆä½ åªèƒ½ç”¨æ•°å­—æˆ–è€…å­—ç¬¦ä¸²ã€‚å¦‚æœä½ ä½¿ç”¨æ•°å­—ï¼Œç”¨1-7æ¥è¡¨ç¤ºæ˜ŸæœŸæ•°ï¼Œä½†ä¸€ä¸ªæ•°å­—åœ¨ç¨‹åºä¸­ä¸ä»…å¯ä»¥è¡¨ç¤ºæ˜ŸæœŸæ•°ï¼Œå¯èƒ½è¿˜æœ‰å…¶ä»–è®¸å¤šå«ä¹‰ï¼Œè¿™æ ·ä½ åœ¨å†™ç¨‹åºæ—¶å°±å¿…é¡»æ—¶åˆ»è®°ä½è¿™äº›æ•°å­—çš„å«ä¹‰ï¼Œè¿™é™ä½äº†ç¨‹åºçš„å¯è¯»æ€§ï¼Œä¹Ÿå¯¼è‡´å®¹æ˜“å‡ºé”™ã€‚è€Œå½“ä½ ä½¿ç”¨å­—ç¬¦ä¸²æ—¶ï¼Œè™½ç„¶æ²¡æœ‰æ˜æ˜¾çš„ç¼ºç‚¹ï¼Œä½†åœ¨å†…å­˜ä¸­å­—ç¬¦ä¸²æ‰€å å†…å­˜è¦æ¯”æ•°å­—å¤šï¼Œè¿™å°±é™ä½äº†ç¨‹åºçš„æ•ˆç‡ã€‚æšä¸¾ç±»æ­£å¥½å¼¥è¡¥äº†è¿™ä¸¤æ–¹é¢çš„ç¼ºç‚¹ï¼Œä½ å¯ä»¥åœ¨ä»£ç ä¸­ä½¿ç”¨æšä¸¾ç±»ï¼Œä½†åœ¨å†…å­˜ä¸­å­˜æ”¾æ—¶ä½¿ç”¨çš„æ˜¯æ•°å­—ï¼Œæ—¢æé«˜äº†å¯è¯»æ€§ï¼Œåˆæé«˜äº†ç¨‹åºæ•ˆç‡ã€‚æ›´é‡è¦çš„æ˜¯ï¼ŒPythonä¸­çš„æšä¸¾ç±»å‹æ˜¯ä¸å¯å˜ç±»å‹ï¼Œåˆå¯ä»¥è¿›è¡Œè¿­ä»£ï¼Œè¿™å°±æ„å‘³ç€ä½ å¯ä»¥éšæ—¶ä½¿ç”¨æšä¸¾ç±»å‹è€Œä¸ç”¨æ‹…å¿ƒæ”¹å˜äº†æšä¸¾ç±»å‹çš„å€¼ã€‚ä¸¤ç§æšä¸¾ç±»å®šä¹‰æ–¹å¼ç¨‹åºæœ‰ä¸¤ç§æ–¹å¼æ¥å®šä¹‰æšä¸¾ç±»ï¼šç›´æ¥ä½¿ç”¨ Enum åˆ—å‡ºå¤šä¸ªæšä¸¾å€¼æ¥åˆ›å»ºæšä¸¾ç±»ã€‚é€šè¿‡ç»§æ‰¿ Enum åŸºç±»æ¥æ´¾ç”Ÿæšä¸¾ç±»ã€‚æ¡ˆä¾‹ç®€å•æšä¸¾ç±»å®šä¹‰12345678# ç”±äºæšä¸¾ç±»çš„â€œnewâ€æ–¹æ³•ï¼Œå°†ä¼šä¿è¯å†…å­˜ä¸­åªä¼šå­˜åœ¨ä¸€ä¸ªæšä¸¾ç±»çš„å®ä¾‹# -*- coding: utf-8 -*from enum import Enum# è¿™æ ·æˆ‘ä»¬å°±è·å¾—äº†Monthç±»å‹çš„æšä¸¾ç±»# valueå±æ€§åˆ™æ˜¯è‡ªåŠ¨èµ‹ç»™æˆå‘˜çš„intå¸¸é‡ï¼Œé»˜è®¤ä»1å¼€å§‹è®¡æ•°ã€‚seasonEnum = Enum('SeasonEnum', ('SPRING', 'SUMMER', 'FALL', 'WINTER'))print(f'seasonEnum: {seasonEnum}')é«˜çº§æšä¸¾ç±»å®šä¹‰ä»£ç 12345678910111213141516171819202122from enum import Enum, unique# @uniqueè£…é¥°å™¨å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ£€æŸ¥ä¿è¯æ²¡æœ‰é‡å¤å€¼ã€‚# å†¬å¤© = 3è¿™é‡Œå°±ä¼šæŠ¥é”™ï¼Œå¦åˆ™SeasonEnum.__members__.itemsï¼Œä¼šæŠŠ# WINTER =&gt; SeasonEnum.WINTER# å†¬å¤© =&gt; SeasonEnum.WINTER# è£…é¥°å™¨â€œ@uniqueâ€ï¼Œå®ƒä¼šéå†æšä¸¾æˆå‘˜ï¼Œå¦‚æœå‘ç°æœ‰é‡å¤å°±ä¼šç«‹å³æŠ›å‡ºâ€œValueErrorâ€@uniqueclass SeasonEnum(Enum):    # SPRING = auto() # ä¹Ÿå¯ä»¥å…¨éƒ¨ä½¿ç”¨è‡ªåŠ¨å€¼    SPRING = 0  # Sunçš„valueè¢«è®¾å®šä¸º0    SUMMER = 1    FALL = 2    WINTER = 3    # å†¬å¤© = 3# è®¿é—®è¿™äº›æšä¸¾ç±»å‹å¯ä»¥æœ‰è‹¥å¹²ç§æ–¹æ³•ï¼šseason_1 = SeasonEnum.SPRINGprint(f'season_1: {season_1}')print(f&quot;SeasonEnum['SPRING']: {SeasonEnum['SPRING']}&quot;)print(f'SeasonEnum.SPRING.value: {SeasonEnum.SPRING.value}')print(f'SeasonEnum(1): {SeasonEnum(1)}')print(f'season_1 == SeasonEnum(1): {season_1 == SeasonEnum(1)}')    è¾“å‡º123456seasonEnum: &lt;enum 'SeasonEnum'&gt;season_1: SeasonEnum.SPRINGSeasonEnum['SPRING']: SeasonEnum.SPRINGSeasonEnum.SPRING.value: 0SeasonEnum(1): SeasonEnum.SUMMERseason_1 == SeasonEnum(1): Falseæšä¸¾ç±»æ¯”è¾ƒä»£ç 1234567# æšä¸¾ç±»å‹ä¸èƒ½åšå¤§å°æ¯”è¾ƒï¼Œä½†æ˜¯å¯ä»¥åšèº«ä»½æ¯”è¾ƒå’Œç­‰å€¼æ¯”è¾ƒã€‚print(f'SeasonEnum.SPRING is SeasonEnum.SPRING: {SeasonEnum.SPRING is SeasonEnum.SPRING}')print(f'SeasonEnum.SPRING is SeasonEnum.WINTER: {SeasonEnum.SPRING is SeasonEnum.WINTER}')# è¿™æ˜¯èº«ä»½æ¯”è¾ƒï¼Œæ¯ä¸ªå¯¹è±¡éƒ½å¯ä»¥è¿›è¡Œèº«ä»½æ¯”è¾ƒï¼Œæšä¸¾ç±»ä¹Ÿä¸ä¾‹å¤–ã€‚print(f'SeasonEnum.SPRING == SeasonEnum.SPRING: {SeasonEnum.SPRING == SeasonEnum.SPRING}')print(f'SeasonEnum.SPRING != SeasonEnum.WINTER: {SeasonEnum.SPRING != SeasonEnum.WINTER}')è¾“å‡º1234SeasonEnum.SPRING is SeasonEnum.SPRING: TrueSeasonEnum.SPRING is SeasonEnum.WINTER: FalseSeasonEnum.SPRING == SeasonEnum.SPRING: TrueSeasonEnum.SPRING != SeasonEnum.WINTER: Trueéå†æšä¸¾ç±»ä»£ç 1234567# å¦‚æœå°è¯•éå†æšä¸¾ç±»å‹ï¼Œåˆ™åé¢é‡å¤çš„ä¸ä¼šè¢«æ‰“å°å‡ºæ¥ã€‚ä½†æ˜¯ï¼Œå¦‚æœæƒ³è¦è·å–åˆ«åï¼Œ# æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å±æ€§â€œmembersâ€ï¼Œå®ƒæ˜¯ä¸€ä¸ªOrderedDictï¼ŒåŒ…æ‹¬æ‰€æœ‰å®šä¹‰çš„æšä¸¾åç§°ï¼ŒåŒ…æ‹¬åˆ«åã€‚for name, member in SeasonEnum.__members__.items():    print(name, '=&gt;', member)for name, member in enumerate(SeasonEnum):    print(name, '=&gt;', member) è¾“å‡º12345678910SPRING =&gt; SeasonEnum.SPRINGSUMMER =&gt; SeasonEnum.SUMMERFALL =&gt; SeasonEnum.FALLWINTER =&gt; SeasonEnum.WINTER0 =&gt; SeasonEnum.SPRING1 =&gt; SeasonEnum.SUMMER2 =&gt; SeasonEnum.FALL3 =&gt; SeasonEnum.WINTER    </content>
	</entry>
	<entry>
		<title>pandaså°è®°</title>
		<url>/article/62278.html</url>
		<content>pandaså­¦ä¹ </content>
	</entry>
	<entry>
		<title>numpyå°è®°</title>
		<url>/article/30791.html</url>
		<content>numpyå°è®°70ä¸ªNumPyåˆ†çº§ç»ƒä¹ é¢˜ï¼šç”¨Pythonä¸€ä¸¾æå®šæœºå™¨å­¦ä¹ çŸ©é˜µè¿ç®—1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556import numpy as np# 1. æ›¿æ¢æ»¡è¶³æ¡ä»¶çš„å…ƒç´ è€Œä¸å½±å“åŸå§‹æ•°ç»„arr = np.arange(10)out = np.where(arr%2==1, -1, arr)arrOut[4]: array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])outOut[5]: array([ 0, -1,  2, -1,  4, -1,  6, -1,  8, -1])# 7. è·å–ä¸¤ä¸ªæ•°ç»„å…ƒç´ åŒ¹é…çš„ç´¢å¼•å·a = np.array([1,2,3,2,3,4,3,4,5,6])b = np.array([7,2,10,2,7,4,9,4,9,8])np.where(a==b)Out[33]: (array([1, 3, 5, 7], dtype=int64),) # 9. å°†å¤„ç†æ ‡é‡çš„pythonå‡½æ•°åœ¨numpyæ•°ç»„ä¸Šè¿è¡Œmaxx = lambda x,y: x if x&gt;=y else ypair_max = np.vectorize(maxx, otypes=[float])a = np.array([5,7,9,8,6,4,5]) b = np.array([6,3,4,8,9,7,1])pair_max(a,b)Out[45]: array([6., 7., 9., 8., 9., 7., 5.]) # 18. å¯¼å…¥å«æœ‰æ•°å­—å’Œæ–‡æœ¬çš„æ•°æ®é›†ï¼Œå¹¶ä¿æŒçš„æ–‡æœ¬å®Œæ•´æ€§ url = &quot;https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data&quot; irirs_ld = np.genfromtxt(url, delimiter=',', dtype=None)# 21. è®¡ç®—softmaxå€¼def softmax(x): ex = np.exp(x-np.max(x)) return ex/ex.sum(axis=0)     # 29. æ¦‚ç‡æŠ½æ ·# æš‚å®š # 33. ä¸¤ä¸ªæ•°ç»„ä¹‹é—´çš„æ¬§æ°è·ç¦» arr = np.arange(5) brr = np.arange(4,9)dist = np.linalg.norm(arr-brr)distOut[176]: 8.94427190999916# 38. ä¸è¿ç»­çš„æ—¥æœŸæ•°ç»„ã€‚é€šè¿‡å¡«è¡¥ç¼ºå¤±çš„æ—¥æœŸï¼Œä½¿å…¶æˆä¸ºè¿ç»­çš„æ—¥æœŸåºåˆ— # 39. ä¸€ç»´æ•°ç»„arrï¼Œä½¿ç”¨æ­¥é•¿ç”Ÿæˆä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œçª—å£é•¿åº¦ä¸º4ï¼Œæ­¥é•¿ä¸º2def gen_strides(arr, stride_len=5, windows_len=5):    n_strides = ((arr.size-windows_len)//stride_len)+1    return np.array([arr[s:(s+windows_len)] for s in np.arange(0, n_strides*stride_len,stride_len)]) gen_strides(np.arange(15), stride_len=2, windows_len=4)Out[207]: array([[ 0,  1,  2,  3],    [ 2,  3,  4,  5],     [ 4,  5,  6,  7],    [ 6,  7,  8,  9],    [ 8,  9, 10, 11],    [10, 11, 12, 13]])ç§»åŠ¨å¹³å‡å€¼cumsum ï¼šè®¡ç®—è½´å‘å…ƒç´ ç´¯åŠ å’Œï¼Œè¿”å›ç”±ä¸­é—´ç»“æœç»„æˆçš„æ•°ç»„cumprod ï¼šè®¡ç®—è½´å‘å…ƒç´ ç´¯ä¹˜ç§¯ï¼Œè¿”å›ç”±ä¸­é—´ç»“æœç»„æˆçš„æ•°ç»„12345678910data = np.array([1] * 10)acum = data.cumsum()cump = acum.cumprod()print(acum)[ 1  2  3  4  5  6  7  8  9 10]print(cump)array([      1,       2,       6,      24,     120,     720,    5040,         40320,  362880, 3628800])1234567891011# 37. çª—å£å¤§å°ä¸º3çš„ç§»åŠ¨å¹³å‡å€¼def moving_average(a, n=3):    ret = np.cumsum(a, dtype=float)    ret[n:] = ret[n:]-ret[:-n]    return ret[n-1:]/nnp.random.seed(100)Z = np.random.randint(10, size=10)ZOut[191]: array([8, 8, 3, 7, 7, 0, 4, 2, 5, 2])moving_average(Z, n=3).round(2)Out[192]: array([6.33, 6.  , 5.67, 4.67, 3.67, 2.  , 3.67, 3.  ])ç¬¬nä¸ªé‡å¤é¡¹çš„ç´¢å¼•12345678# 36. ç¬¬nä¸ªé‡å¤é¡¹çš„ç´¢å¼•# æ‰¾å‡ºxä¸­ç¬¬1ä¸ªé‡å¤næ¬¡çš„ç´¢å¼•arr = np.array([1,2,1,1,3,4,3,1,1,2,1,1,2])n = 5[ii for ii,kk in enumerate(arr) if kk==1][n-1]Out[186]: 8np.where(arr==1)[0][n-1]Out[187]: 8æŒ‰åˆ—æ’åºäºŒç»´æ•°ç»„123456789101112# 31. æŒ‰åˆ—æ’åºäºŒç»´æ•°ç»„arr = np.random.uniform(size=(3,4))arrOut[146]: array([[0.54040458, 0.29679375, 0.1107879 , 0.3126403 ], [0.45697913, 0.65894007, 0.25425752, 0.64110126], [0.20012361, 0.65762481, 0.77828922, 0.7795984 ]])arr[arr[:,1].argsort()]Out[147]: array([[0.54040458, 0.29679375, 0.1107879 , 0.3126403 ], [0.20012361, 0.65762481, 0.77828922, 0.7795984 ], [0.45697913, 0.65894007, 0.25425752, 0.64110126]])pearsonrç›¸å…³ç³»æ•°1234567891011# 25. è®¡ç®—æŸä¸¤åˆ—çš„pearsonrç›¸å…³ç³»æ•°arr = np.random.uniform(size=(3,4))arrOut[114]: array([[0.59884338, 0.60380454, 0.10514769, 0.38194344], [0.03647606, 0.89041156, 0.98092086, 0.05994199], [0.89054594, 0.5769015 , 0.74247969, 0.63018394]])from scipy.stats.stats import pearsonrcorr,p_value = pearsonr(arr[:,0], arr[:,2])corrOut[117]: -0.432641494562719å”¯ä¸€å€¼çš„æ•°é‡123456789101112131415161718192021# 27. æŸ¥æ‰¾numpyæ•°ç»„ä¸­çš„å”¯ä¸€å€¼çš„æ•°é‡arr = np.random.uniform(size=(3,4))np.unique(arr, return_counts=True)Out[121]: (array([0.04486228, 0.14260031, 0.17808099, 0.23769421, 0.34019022,  0.35479561, 0.37625245, 0.50543143, 0.5928054 , 0.62994188,  0.9338413 , 0.94637988]),array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], dtype=int64))# 28. å°†æ•°å€¼è½¬æ¢ä¸ºåˆ†ç±»ï¼ˆæ–‡æœ¬ï¼‰æ•°ç»„# å°†iris_2dçš„èŠ±ç“£é•¿åº¦ï¼ˆç¬¬3åˆ—ï¼‰ç»„æˆä¸€ä¸ªæ–‡æœ¬æ•°ç»„# &lt;3  -&gt; 'å°'# 3-5 -&gt; 'ä¸­'# &gt;=5 -&gt; 'å¤§from sklearn import datasetsiris = datasets.load_iris().datapetal_length_bin = np.digitize(iris[:,2].astype('float'), [0,3,5,10])label_map = {1:'small', 2:'medium', 3:'large', 4:np.nan}petal_length_cat = [label_map[x] for x in petal_length_bin]petal_length_cat[:4]Out[130]: ['small', 'small', 'small', 'small']å¤šä¸ªæ¡ä»¶è¿‡æ»¤numpyæ•°ç»„1234567891011# 24. æ ¹æ®ä¸¤ä¸ªæˆ–å¤šä¸ªæ¡ä»¶è¿‡æ»¤ä¸€ä¸ªnumpyæ•°ç»„# è¿‡æ»¤å…·æœ‰arrï¼ˆç¬¬3åˆ—ï¼‰&gt; 0.5å’Œarrï¼ˆç¬¬1åˆ—ï¼‰&lt;0.8çš„arrçš„è¡Œã€‚arr = np.random.uniform(size=(3,4))arrOut[110]: array([[0.81622475, 0.27407375, 0.43170418, 0.94002982], [0.81764938, 0.33611195, 0.17541045, 0.37283205], [0.00568851, 0.25242635, 0.79566251, 0.01525497]])condition = (arr[:,2]&gt;0.5) &amp; (arr[:,0]&lt;0.8)arr[condition]Out[112]: array([[0.00568851, 0.25242635, 0.79566251, 0.01525497]])å †å æ•°ç»„æ“ä½œ12345678910111213141516171819202122232425262728293031323334353637383940414243# 2. å‚ç›´å †å ä¸¤ä¸ªæ•°ç»„a = np.arange(10).reshape(2,-1)b = np.repeat(1,10).reshape(2,-1)aOut[10]: array([[0, 1, 2, 3, 4],[5, 6, 7, 8, 9]])bOut[11]: array([[1, 1, 1, 1, 1],[1, 1, 1, 1, 1]])np.concatenate([a,b], axis=0)Out[12]: array([[0, 1, 2, 3, 4],[5, 6, 7, 8, 9],[1, 1, 1, 1, 1],[1, 1, 1, 1, 1]])np.vstack([a,b])Out[13]: array([[0, 1, 2, 3, 4],[5, 6, 7, 8, 9],[1, 1, 1, 1, 1],[1, 1, 1, 1, 1]])np.r_[a,b]Out[14]: array([[0, 1, 2, 3, 4],[5, 6, 7, 8, 9],[1, 1, 1, 1, 1],[1, 1, 1, 1, 1]])# 3. æ°´å¹³å †å ä¸¤ä¸ªæ•°ç»„np.concatenate([a,b], axis=1)Out[15]: array([[0, 1, 2, 3, 4, 1, 1, 1, 1, 1],[5, 6, 7, 8, 9, 1, 1, 1, 1, 1]])np.hstack([a,b])Out[16]: array([[0, 1, 2, 3, 4, 1, 1, 1, 1, 1],[5, 6, 7, 8, 9, 1, 1, 1, 1, 1]])np.c_[a,b]Out[17]: array([[0, 1, 2, 3, 4, 1, 1, 1, 1, 1],[5, 6, 7, 8, 9, 1, 1, 1, 1, 1]])æå–èŒƒå›´å†…çš„æ‰€æœ‰æ•°å­—12345678# 8. æå–ç»™å®šèŒƒå›´å†…çš„æ‰€æœ‰æ•°å­—a = np.arange(15)index = np.where((a&gt;=5) &amp; (a&lt;=10))a[index]Out[36]: array([ 5,  6,  7,  8,  9, 10])index = np.where(np.logical_and(a&gt;=5, a&lt;=10))a[index]Out[38]: array([ 5,  6,  7,  8,  9, 10])äº¤æ¢æ•°ç»„è¡Œåˆ—12345678910111213# 10. äº¤æ¢2ç»´numpyæ•°ç»„ä¸­çš„ä¸¤ä¸ªåˆ—np.arange(9).reshape(3,3)[:,[1,0,2]]Out[46]: array([[1, 0, 2],[4, 3, 5],[7, 6, 8]])# 11. äº¤æ¢2ç»´numpyæ•°ç»„ä¸­çš„ä¸¤ä¸ªè¡Œnp.arange(9).reshape(3,3)[[1,0,2], :]Out[47]: array([[3, 4, 5],[0, 1, 2],[6, 7, 8]])åè½¬2ç»´æ•°ç»„è¡Œåˆ—12345678910111213# 12. åè½¬2ç»´æ•°ç»„çš„è¡Œnp.arange(9).reshape(3,3)[[1,0,2], :]Out[51]: array([[3, 4, 5],[0, 1, 2],[6, 7, 8]])# 13. åè½¬2ç»´æ•°ç»„çš„åˆ—np.arange(9).reshape(3,3)[:,::-1]Out[48]: array([[2, 1, 0],[5, 4, 3],[8, 7, 6]])æ•°ç»„æ‰“å°12345678910111213141516171819202122232425# 15. æ‰“å°ä¸‰ä½å°æ•°çš„numpyæ•°ç»„np.set_printoptions(3)np.random.uniform(5,10,(5,3))Out[59]: array([[5.427, 6.768, 6.71 ],[7.243, 6.434, 7.314],[6.692, 8.417, 7.965],[8.718, 5.061, 5.936],[5.918, 8.064, 7.431]])# 16. ä½¿ç”¨ç§‘å­¦è®°æ•°æ³•ï¼ˆå¦‚1e10ï¼‰æ¼‚äº®çš„æ‰“å°æ•°ç»„rand_arrnp.random.seed(100)np.set_printoptions(suppress=True)rand_arr = np.random.random([3,3])/1e3rand_arrOut[68]: array([[0.000543, 0.000278, 0.000425],[0.000845, 0.000005, 0.000122],[0.000671, 0.000826, 0.000137]])# 17. é™åˆ¶æ•°ç»„è¾“å‡ºä¸­æ‰“å°å…ƒç´ çš„æ•°é‡np.set_printoptions(threshold=6)arr = np.arange(15)arrOut[73]: array([ 0,  1,  2, ..., 12, 13, 14])æ ‡å‡†åŒ–ä¸€ä¸ªæ•°ç»„è‡³0åˆ°1ä¹‹é—´12345678910111213# 20. æ ‡å‡†åŒ–ä¸€ä¸ªæ•°ç»„è‡³0åˆ°1ä¹‹é—´arr = np.random.uniform(size=(3,4))arrOut[89]: array([[0.88959857, 0.64348368, 0.66692863, 0.41213651], [0.78437761, 0.75333385, 0.10293507, 0.7942196 ], [0.82432451, 0.11447181, 0.30328525, 0.41767367]])s_max,s_min = arr.max(axis=0),arr.min(axis=0)(arr-s_min)/(s_max-s_min)Out[91]: array([[1. , 0.82805338, 1.  , 0.   ],[0.  , 1.  , 0.  , 1.     ],[0.37964781, 0. , 0.35523487, 0.01449204]])ç¼ºå¤±å€¼ç›¸å…³12345678910111213141516171819202122# 26. æ‰¾å‡ºæ•°ç»„æ˜¯å¦æœ‰ç¼ºå¤±çš„å€¼arr = np.random.uniform(size=(3,4))np.isnan(arr).any()Out[119]: False      # 34. åˆ é™¤æ‰€æœ‰nanå€¼arr = np.array([1,2,3,np.nan,5,6,7,np.nan])arr[~np.isnan(arr)]Out[167]: array([1., 2., 3., 5., 6., 7.])    # 23. æ•°æ®é›†çš„5ä¸ªéšæœºä½æ’å…¥np.nanå€¼arr = np.random.uniform(size=(3,4))i,j = np.where(arr)np.random.seed(100)arr[np.random.choice((i),5), np.random.choice((j),5)] = np.nanarrOut[103]: array([[  nan, 0.57138137, 0.27694632, 0.06905881],[0.25886229, nan,  nan, 0.0125819 ],[ nan, 0.06872554,  nan, 0.28179248]])np.where(np.isnan(arr))Out[105]: (array([0, 1, 1, 2, 2], dtype=int64), array([0, 1, 2, 0, 2], dtype=int64)) æ•°ç»„äº¤å·®é›†1234567891011# 5. æ•°ç»„ä¹‹é—´çš„å…±åŒå…ƒç´ a = np.array([1,2,3,2,3,4,3,4,5,6])b = np.array([7,2,10,2,7,4,9,4,9,8])np.intersect1d(a,b)Out[27]: array([2, 4])# 6. åˆ é™¤å­˜åœ¨äºå¦ä¸€ä¸ªæ•°ç»„ä¸­çš„å…ƒç´ a = np.array([1,2,3,4,5])b = np.array([5,6,7,8,9])np.setdiff1d(a,b)Out[30]: array([1, 2, 3, 4])æ•°ç»„äº§ç”Ÿ123456789101112131415161718192021222324# 4. ç”Ÿæˆè‡ªå®šä¹‰åºåˆ—a = np.array([1,2,3])np.r_[np.repeat(a,3), np.tile(a,3)].reshape(2,-1)Out[24]: array([[1, 1, 1, 2, 2, 2, 3, 3, 3],[1, 2, 3, 1, 2, 3, 1, 2, 3]])# 14. äºŒç»´æ•°ç»„ï¼Œä»¥åŒ…å«5åˆ°10ä¹‹é—´çš„éšæœºæµ®ç‚¹æ•°rand_arr = np.random.randint(low=5, high=10, size=(5,3)) + np.random.random((5, 3))rand_arrOut[56]: array([[5.37441948, 8.61709329, 8.24544657],[6.79517054, 6.43953972, 5.01129723],[9.662239  , 6.24575781, 6.51341089],[8.01997704, 6.66118956, 8.18283188],[8.02228762, 6.9609364 , 7.4676691 ]])rand_arr = np.random.uniform(5,10, size=(5,3))rand_arrOut[58]: array([[7.13046251, 7.4977751 , 8.55210656],[7.9222628 , 5.7828763 , 9.57743131],[9.13648012, 5.71533963, 9.18622945],[5.94241285, 8.08918632, 9.32716147],[5.75027771, 8.83210586, 8.3991677 ]])å…ƒç´ æŸ¥æ‰¾123456789101112131415161718192021222324252627282930313233343536# 19. ä»ä¸€ç»´å…ƒç»„æ•°ç»„ä¸­æå–ç‰¹å®šçš„åˆ—iris_2d = np.array([row.tolist()[:4] for row in irirs_ld])iris_2d[:4]Out[78]: array([[5.1, 3.5, 1.4, 0.2], [4.9, 3. , 1.4, 0.2], [4.7, 3.2, 1.3, 0.2], [4.6, 3.1, 1.5, 0.2]])# 22. æ‰¾åˆ°æ•°ç»„çš„ç™¾åˆ†ä½çš„å€¼# ç¬¬5ä½å’Œç¬¬95ç™¾åˆ†ä½çš„å€¼arr = np.random.uniform(size=(3,4))np.percentile(arr, q=[5,95])Out[94]: array([0.31394255, 0.87443495])# 30. è·å¾—æ•°ç»„ä¸­ç¬¬äºŒå¤§çš„å…ƒç´ å€¼arr = np.random.uniform(size=(3,4))np.unique(np.sort(arr))[-2]Out[132]: 0.9570126003527981# 32. é¦–æ¬¡å‡ºç°çš„å€¼å¤§äºç»™å®šå€¼çš„ä½ç½®arr = np.random.uniform(size=(3,4))arrOut[150]: array([[0.61032815, 0.30900035, 0.69773491, 0.8596183 ], [0.62532376, 0.98240783, 0.97650013, 0.16669413], [0.02317814, 0.16074455, 0.92349683, 0.95354985]])np.argmax(arr[:,2].astype('float') &gt; 0.7)Out[151]: 1    # 35. ä¸€ç»´æ•°ç»„æ‰€æœ‰å±€éƒ¨æœ€å¤§å€¼ï¼ˆæˆ–å³°å€¼ï¼‰arr = np.array([1,3,7,1,2,6,0,1])doublediff = np.diff(np.sign(np.diff(arr)))peak_locations = np.where(doublediff==-2)[0]+1peak_locationsOut[180]: array([2, 5], dtype=int64)</content>
	</entry>
	<entry>
		<title>python_pipeåŒ…ç®¡é“åŒ…å­¦ä¹ </title>
		<url>/article/27292.html</url>
		<content>python pipeåŒ…ç®¡é“åŒ…å­¦ä¹ å‚è€ƒ: https://github.com/JulienPalard/Pipe1234567891011121314151617181920212223242526from pipe import *# æ­¤å¤„ä¸æ˜¯å¤ªç†è§£[1, 2, 3, 4, 5] | tee | as_list12345Out[32]: [1, 2, 3, 4, 5]# å°†ç”Ÿæˆå™¨è½¬æ¢æˆliståˆ—è¡¨[1, 2, 3, 4, 5, 6] | as_listOut[34]: [1, 2, 3, 4, 5, 6]    # Like Python's built-in &quot;reversed&quot; primitive.[1, 2, 3] | reverse | concatOut[52]: '3, 2, 1'    # Returns index of value in iterable æ£€ç´¢å€¼# è¾“å…¥value start stop[1,2,3,2,1] | index(value=2,start=2,stop=4)Out[53]: 3[1,2,3,2,1] | index(3)Out[54]: 2æ„é€ ä½ è‡ªå·±çš„pipeç®¡é“å‡½æ•°1234567# æ„é€ ä½ è‡ªå·±çš„pipeç®¡é“å‡½æ•°stdout = Pipe(lambda x: sys.stdout.write(str(x)))select = Pipe(lambda iterable, pred: (pred(x) for x in iterable))# æˆ–è€…@Pipedef stdout(x):    sys.stdout.write(str(x))åˆ é™¤é‡å¤å€¼1234567# dedup() Deduplicate valuesåˆ é™¤é‡å¤çš„å€¼[1,1,2,2,3,3,1,2,3] | dedup |as_listOut[50]: [1, 2, 3]# åˆ é™¤è¿ç»­çš„ä¸”é‡å¤çš„å€¼[1,1,2,2,3,3,1,2,3] | uniq | as_listOut[51]: [1, 2, 3, 1, 2, 3]groupby() å¯¹åˆ—è¡¨å®ç°åˆ†ç»„è®¡ç®—123456# groupby() å¯¹åˆ—è¡¨å®ç°åˆ†ç»„è®¡ç®—(1, 2, 3, 4, 5, 6, 7, 8, 9) | groupby(lambda x: x % 2 and &quot;Even&quot; or &quot;Odd&quot;) | select(lambda x: &quot;%s : %s&quot; % (x[0], (x[1] | concat(', ')))) | concat(' / ')Out[46]: 'Even : 1, 3, 5, 7, 9 / Odd : 2, 4, 6, 8'    [5, -4, 3, -2, 1] | sort(key=abs) | concatOut[49]: '1, -2, 3, -4, 5'æ±‚å’Œå’Œå¹³å‡æ•°1234567891011# åŠ æ³•[1,2,3] | addOut[17]: 6    # å¹³å‡æ•°ï¼Œä½¿ç”¨è‡ªå®šä¹‰å‡½æ•°ï¼Œå¿…é¡»åœ¨å‡½æ•°å‰é¢åŠ ä¸Š@pipeè£…é¥°[1, 2, 3] | select(lambda x: x * x) |averageOut[30]: 4.666666666666667    # å¹³å‡æ•°[1, 2, 3, 4, 5, 6] | averageOut[35]: 3.5selectå‡½æ•°ï¼Œç›¸å½“äºmapæ˜ å°„æ“ä½œ123# selectå‡½æ•°ï¼Œç›¸å½“äºmapæ˜ å°„æ“ä½œ[1,3,5] | select(lambda x:float(x +1)) |as_listOut[20]: [2.0, 4.0, 6.0]èšåˆå‡½æ•°123# èšåˆå‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨lambdaå‡½æ•°è‡ªå®šä¹‰(1, 2, 3, 4, 5, 6, 7, 8, 9) | aggregate(lambda x, y: x + y)Out[21]: 45ç­›é€‰å’Œè¿‡æ»¤1234567# ç­›é€‰å’Œè¿‡æ»¤[1, 2, 3] | where(lambda x: x % 2 == 0) | as_listOut[24]: [2][1, 2, 3, 4] | take_while(lambda x: x &lt; 3) | concatOut[25]: '1, 2'[1, 2, 3, 4] | where(lambda x: x &lt; 3) | concatOut[26]: '1, 2'takeå‰å‡ ä¸ªå…ƒç´ å’Œcountç”Ÿæˆå™¨çš„é•¿åº¦12345# takeå‰å‡ ä¸ªå…ƒç´ å’Œcountç”Ÿæˆå™¨çš„é•¿åº¦[1,2,3]|take(2) |as_list |where(lambda x : x ==2) |as_list |countOut[27]: 1[1,2,3]|countOut[28]: 3flatmapæ“ä½œ123# ç›¸å½“äºflatmap[[1, 2], [3, 4], [5]] | chain |as_listOut[31]: [1, 2, 3, 4, 5]ä¸¤ä¸ªåˆ—è¡¨å®ç°zipå‡½æ•°123# ä¸¤ä¸ªåˆ—è¡¨å®ç°zipå‡½æ•°(1, 2, 3, 4, 5, 6, 7, 8, 9) | izip([9, 8, 7, 6, 5, 4, 3, 2, 1]) | concatOut[38]: '(1, 9), (2, 8), (3, 7), (4, 6), (5, 5), (6, 4), (7, 3), (8, 2), (9, 1)'æŒ‡å®šå‡½æ•°æ’åºå¹¶é€‰å‡ºmax1234567# max()æŒ‰ç…§keyä¸­çš„æŒ‡å®šçš„å‡½æ•°æ¥æ’åºï¼Œç„¶åç­›é€‰å‡ºmaxçš„å‡½æ•°('aa', 'b', 'fosdfdfo', 'qwerty', 'bar', 'zoog') | max(key=len)Out[43]: 'fosdfdfo'('aa', 'b', 'foo', 'qwerty', 'bar', 'zoog') | max()Out[44]: 'zoog'('aa', 'b', 'foo', 'qwerty', 'bar', 'zoog') | maxOut[45]: 'zoog'ç´¢å¼•æˆªå–æ•°ç»„å…ƒç´ 12345# ä½¿ç”¨isliceæˆªå–ä»ä¸‹è¡¨2åˆ°7,æŒ‰ç…§ç´¢å¼•æˆªå–æ•°ç»„ä¸­çš„å…ƒç´ (1, 2, 3, 4, 5, 6, 7, 8, 9) | islice(2, 8) | concatOut[36]: '3, 4, 5, 6, 7, 8'(1, 2, 3, 4, 5, 6, 7, 8, 9) | islice(0,1) |as_listOut[37]: [1]any()å’Œall()å®ç°1234567891011# any()ï¼Œåªè¦å­˜åœ¨ä¸€ä¸ªå°±è¿”å›true(1, 3, 5, 6, 7) | any(lambda x: x &gt;= 7)Out[39]: True(1, 3, 5, 6, 7) | any(lambda x: x &gt; 7)Out[40]: False# all(),å¿…é¡»å…¨éƒ¨æ»¡è¶³æ‰ä¼šè¿”å›true(1, 3, 5, 6, 7) | all(lambda x: x &lt; 7)Out[41]: False(1, 3, 5, 6, 7) | all(lambda x: x &lt;= 7)Out[42]: True</content>
	</entry>
	<entry>
		<title>Pythonå¢å¼ºææ¡ˆPEP</title>
		<url>/article/65108.html</url>
		<content>Python å¢å¼ºææ¡ˆPEPPythonä¸­10ä¸ªå¿…è¯»çš„PEPææ¡ˆç†è§£Pythonæ•°æ®ç±»ï¼šDataclass çš„ç‰¹å¾æ¦‚è¿° ï¼ˆä¸Šï¼‰ç†è§£Pythonæ•°æ®ç±»ï¼šDataclass fields çš„æ¦‚è¿°ï¼ˆä¸‹ï¼‰Python3.7 dataclassä½¿ç”¨æŒ‡å—å°ç»“â€‹        PEP æ˜¯ Python å¢å¼ºææ¡ˆ(Python Enhancement Proposal)çš„ç¼©å†™ã€‚ç¤¾åŒºé€šè¿‡PEPæ¥ç»™ Python è¯­è¨€å»ºè¨€çŒ®ç­–ï¼Œæ¯ä¸ªç‰ˆæœ¬ä½ æ‰€çœ‹åˆ°çš„æ–°ç‰¹æ€§å’Œä¸€äº›å˜åŒ–éƒ½æ˜¯é€šè¿‡PEPææ¡ˆç»è¿‡ç¤¾åŒºå†³ç­–å±‚è®¨è®ºã€æŠ•ç¥¨å†³è®®çš„ã€‚PEP 557  æ•°æ®ç±»ï¼ˆdata classï¼‰dataclassçš„å®šä¹‰ä½äºPEP-557ï¼Œæ ¹æ®å®šä¹‰ä¸€ä¸ªdataclassæ˜¯æŒ‡â€œä¸€ä¸ªå¸¦æœ‰é»˜è®¤å€¼çš„å¯å˜çš„namedtupleâ€ï¼Œå¹¿ä¹‰çš„å®šä¹‰å°±æ˜¯æœ‰ä¸€ä¸ªç±»ï¼Œå®ƒçš„å±æ€§å‡å¯å…¬å¼€è®¿é—®ï¼Œå¯ä»¥å¸¦æœ‰é»˜è®¤å€¼å¹¶èƒ½è¢«ä¿®æ”¹ï¼Œè€Œä¸”ç±»ä¸­å«æœ‰ä¸è¿™äº›å±æ€§ç›¸å…³çš„ç±»æ–¹æ³•ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»å°±å¯ä»¥ç§°ä¸ºdataclassï¼Œå†é€šä¿—ç‚¹è®²ï¼Œdataclasså°±æ˜¯ä¸€ä¸ªå«æœ‰æ•°æ®åŠæ“ä½œæ•°æ®æ–¹æ³•çš„å®¹å™¨ã€‚Dataclasses æ˜¯ä¸€äº›é€‚åˆäºå­˜å‚¨æ•°æ®å¯¹è±¡(data object)çš„ Python ç±»ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå¹¶ä¸è¯¦å°½çš„ç”¨äºå®šä¹‰æ•°æ®å¯¹è±¡çš„ç‰¹å¾åˆ—è¡¨ï¼šâ€¢ ä»–ä»¬å­˜å‚¨å¹¶è¡¨ç¤ºç‰¹å®šçš„æ•°æ®ç±»å‹ã€‚ä¾‹å¦‚ï¼šä¸€ä¸ªæ•°å­—ã€‚å¯¹äºé‚£äº›ç†Ÿæ‚‰å¯¹è±¡å…³ç³»æ˜ å°„(Object Relational Mappingï¼Œç®€ç§° ORM)çš„äººæ¥è¯´ï¼Œä¸€ä¸ªæ¨¡å‹å®ä¾‹å°±æ˜¯ä¸€ä¸ªæ•°æ®å¯¹è±¡ã€‚å®ƒè¡¨ç¤ºäº†ä¸€ç§ç‰¹å®šç±»å‹çš„å®ä½“ã€‚å®ƒå­˜å‚¨äº†ç”¨äºå®šä¹‰æˆ–è¡¨ç¤ºé‚£ç§å®ä½“çš„å±æ€§ã€‚â€¢ ä»–ä»¬èƒ½å¤Ÿè¢«ç”¨äºå’ŒåŒç±»å‹çš„å…¶ä»–å¯¹è±¡è¿›è¡Œæ¯”è¾ƒã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæ•°å­—å¯èƒ½å¤§äºï¼Œå°äºæˆ–ç­‰äºå¦ä¸€ä¸ªæ•°å­—ã€‚â€¢ å½“ç„¶æ•°æ®å¯¹è±¡è¿˜æœ‰æ›´å¤šçš„ç‰¹å¾ï¼Œä½†ä¸Šè¿°å†…å®¹è¶³ä»¥å¸®åŠ©ä½ ç†è§£å…³é”®éƒ¨åˆ†ã€‚â€¢ ä¸ºäº†ç†è§£ Dataclasesï¼Œæˆ‘ä»¬å°†å®ç°ä¸€ä¸ªç®€å•çš„ç±»ã€‚å®ƒèƒ½å¤Ÿå­˜å‚¨ä¸€ä¸ªæ•°å­—ï¼Œå¹¶å…è®¸æˆ‘ä»¬æ‰§è¡Œä¸Šé¢æåˆ°çš„å„ç§è¿ç®—ã€‚123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960611.ç›¸æ¯”æ™®é€šclassï¼Œdataclassé€šå¸¸ä¸åŒ…å«ç§æœ‰å±æ€§ï¼Œæ•°æ®å¯ä»¥ç›´æ¥è®¿é—®2.dataclassçš„repræ–¹æ³•é€šå¸¸æœ‰å›ºå®šæ ¼å¼ï¼Œä¼šæ‰“å°å‡ºç±»å‹åä»¥åŠå±æ€§åå’Œå®ƒçš„å€¼3.dataclassæ‹¥æœ‰__eq__å’Œ__hash__é­”æ³•æ–¹æ³•4.dataclassæœ‰ç€æ¨¡å¼å•ä¸€å›ºå®šçš„æ„é€ æ–¹å¼ï¼Œæˆ–æ˜¯éœ€è¦é‡è½½è¿ç®—ç¬¦ï¼Œè€Œæ™®é€šclassé€šå¸¸æ— éœ€è¿™äº›å·¥ä½œ# -*- coding: utf-8 -*import randomfrom typing import Listfrom dataclasses import dataclassfrom dataclasses import field# dataclasses.field æ¥å—äº†ä¸€ä¸ªåä¸º default_factory çš„å‚æ•°ï¼Œå®ƒçš„ä½œç”¨æ˜¯ï¼šå¦‚æœåœ¨åˆ›å»ºå¯¹è±¡æ—¶æ²¡æœ‰èµ‹å€¼ï¼Œåˆ™ä½¿ç”¨è¯¥æ–¹æ³•åˆå§‹åŒ–è¯¥å­—æ®µã€‚# default_factory å¿…é¡»æ˜¯ä¸€ä¸ªå¯ä»¥è°ƒç”¨çš„æ— å‚æ•°æ–¹æ³•(é€šå¸¸ä¸ºä¸€ä¸ªå‡½æ•°)def get_random_marks():    return [random.randint(1, 10) for _ in range(5)]@dataclass(order=True)class Student:    marks: List[int] = field(default_factory=get_random_marks)    name: str = field(default='noname', compare=False)    age: int = field(default=18, repr=False)    # åœ¨è¿½è¸ªä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€ï¼Œå¹¶ä¸”å¸Œæœ›å®ƒåœ¨åˆå§‹åŒ–æ—¶ä¸€ç›´è¢«è®¾ä¸ºFalse    # æ›´ä¸€èˆ¬åœ°ï¼Œè¿™ä¸ªå€¼åœ¨åˆå§‹åŒ–æ—¶ä¸èƒ½å¤Ÿè¢«ä¼ é€’,initå†³å®šæ˜¯å¦ç”Ÿæˆinit    verified: bool = field(repr=False, init=False, default=False)    # ä¸å¥½çš„æ–¹å¼ï¼šè‡ªå®šä¹‰æ¯”è¾ƒæ–¹æ³•    # æ­£ç¡®æ–¹å¼ï¼š    # dataclassèƒ½å¤Ÿè‡ªåŠ¨ç”Ÿæˆ &lt;, =, &gt;, &lt;= å’Œ &gt;= è¿™äº›æ¯”è¾ƒæ–¹æ³•ã€‚ä½†æ˜¯è¿™äº›æ¯”è¾ƒæ–¹æ³•çš„ä¸€ä¸ªç¼ºé™·æ˜¯ï¼Œ    # å®ƒä»¬ä½¿ç”¨ç±»ä¸­çš„æ‰€æœ‰å­—æ®µè¿›è¡Œæ¯”è¾ƒ, å¹¶ä¸”æ˜¯æŒ‰å®šä¹‰é¡ºåº    # è¿™é‡Œä½¿ç”¨(order=True)ï¼ŒæŠŠä¸éœ€è¦çš„å­—æ®µå®šä¹‰ä¸º filed(compare=False)    # def __eq__(self, other):    #     return (self.marks, self.name) == (other.marks, other.name)    # ä¸å¥½çš„æ–¹æ³•ï¼šåˆå§‹åŒ–ä¸€ä¸ªå˜é‡ä¸ºåˆ—è¡¨, ä½¿ç”¨__post_init__æ–¹æ³•, æˆ–å‚æ•°ä¼ é€’    # æ­£ç¡®æ–¹å¼æ˜¯ä½¿ç”¨field    # def __post_init__(self):    #     self.marks = get_random_marks()    # ä¸è¦è‡ªå·±å®šä¹‰ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆçš„__repr__æ–¹æ³•ä½¿ç”¨æ‰€æœ‰çš„å­—æ®µç”¨äºè¡¨ç¤º    # ä¸éœ€è¦çš„å…ƒç´ ä½¿ç”¨field(repr=False)è¿‡æ»¤    # def __repr__(self):    #     return self.name+' '+' '.join(self.marks)student_1 = Student([random.randint(1, 10) for _ in range(5)], 'tom', 17)student_2 = Student(age=16, name='Rick')# è¿™é‡Œä¼šæŠ¥å¼‚å¸¸# student_3 = Student(verified=True)print(student_1)print(f'student_1 == student_2: {student_1 == student_2}')# ä½¿ç”¨dataclasses.asdictå’Œdataclasses.astupleæˆ‘ä»¬å¯ä»¥æŠŠæ•°æ®ç±»å®ä¾‹ä¸­çš„æ•°æ®è½¬æ¢æˆå­—å…¸æˆ–è€…å…ƒç»„ï¼šfrom dataclasses import asdict, astupleprint(asdict(student_2))# ä½¿ç”¨dataclasses.is_dataclasså¯ä»¥åˆ¤æ–­ä¸€ä¸ªç±»æˆ–å®ä¾‹å¯¹è±¡æ˜¯å¦æ˜¯æ•°æ®ç±»ï¼šprint(f'isinstance(student_1, Student): {isinstance(student_1, Student)}')&gt;&gt;&gt;    Student(marks=[7, 6, 7, 2, 3], name='tom')    student_1 == student_2: False    {'marks': [6, 4, 3, 5, 1], 'name': 'Rick', 'age': 16, 'verified': False}    isinstance(student_1, Student): True123è£…é¥°å™¨çš„åŸå‹å¦‚ä¸‹ï¼šdataclasses.dataclass(*, init=True, repr=True, eq=True, order=False, unsafe_hash=False, frozen=False)dataclassè£…é¥°å™¨å°†æ ¹æ®ç±»å±æ€§ç”Ÿæˆæ•°æ®ç±»å’Œæ•°æ®ç±»éœ€è¦çš„æ–¹æ³•keyå«ä¹‰initæ˜¯å¦è‡ªåŠ¨ç”Ÿæˆinitï¼Œå¦‚æœå·²ç»æœ‰å®šä¹‰åŒåæ–¹æ³•åˆ™å¿½ç•¥è¿™ä¸ªå€¼ï¼Œä¹Ÿå°±æ˜¯æŒ‡å®šä¸ºTrueä¹Ÿä¸ä¼šè‡ªåŠ¨ç”Ÿæˆrepræ˜¯å¦è‡ªåŠ¨ç”Ÿæˆreprï¼›è‡ªåŠ¨ç”Ÿæˆçš„æ‰“å°æ ¼å¼ä¸ºclass_name(arrt1:value1, attr2:value2, â€¦)eqæ˜¯å¦ç”Ÿæˆeqï¼›æŒ‰å±æ€§åœ¨ç±»å†…å®šä¹‰æ—¶çš„é¡ºåºé€ä¸ªæ¯”è¾ƒï¼Œå…¨éƒ¨çš„å€¼ç›¸åŒæ‰ä¼šè¿”å›Trueorderè‡ªåŠ¨ç”Ÿæˆltï¼Œleï¼Œgtï¼Œgeï¼Œæ¯”è¾ƒæ–¹å¼ä¸eqç›¸åŒï¼›å¦‚æœorderæŒ‡å®šä¸ºTrueè€ŒeqæŒ‡å®šä¸ºFalseï¼Œå°†å¼•å‘ValueErrorï¼›å¦‚æœå·²ç»å®šä¹‰åŒåå‡½æ•°ï¼Œå°†å¼•å‘TypeErrorunsafehashå¦‚æœæ˜¯Falseï¼Œå°†æ ¹æ®eqå’Œfrozenå‚æ•°æ¥ç”Ÿæˆhash:1. eqå’Œfrozenéƒ½ä¸ºTrueï¼Œhashå°†ä¼šç”Ÿæˆ2. eqä¸ºTrueè€Œfrozenä¸ºFalseï¼Œhashè¢«è®¾ä¸ºNone3. eqä¸ºFalseï¼Œfrozenä¸ºTrueï¼Œhashå°†ä½¿ç”¨è¶…ç±»ï¼ˆobjectï¼‰çš„åŒåå±æ€§ï¼ˆé€šå¸¸å°±æ˜¯åŸºäºå¯¹è±¡idçš„hashï¼‰å½“è®¾ç½®ä¸ºTrueæ—¶å°†ä¼šæ ¹æ®ç±»å±æ€§è‡ªåŠ¨ç”Ÿæˆhashï¼Œç„¶è€Œè¿™æ˜¯ä¸å®‰å…¨çš„ï¼Œå› ä¸ºè¿™äº›å±æ€§æ˜¯é»˜è®¤å¯å˜çš„ï¼Œè¿™ä¼šå¯¼è‡´hashçš„ä¸ä¸€è‡´ï¼Œæ‰€ä»¥é™¤éèƒ½ä¿è¯å¯¹è±¡å±æ€§ä¸å¯éšæ„æ”¹å˜ï¼Œå¦åˆ™åº”è¯¥è°¨æ…åœ°è®¾ç½®è¯¥å‚æ•°ä¸ºTruefrozenè®¾ä¸ºTrueæ—¶å¯¹fieldèµ‹å€¼å°†ä¼šå¼•å‘é”™è¯¯ï¼Œå¯¹è±¡å°†æ˜¯ä¸å¯å˜çš„ï¼Œå¦‚æœå·²ç»å®šä¹‰äº†setattrå’Œdelattrå°†ä¼šå¼•å‘TypeError1234567891011121314151617181920fieldçš„åŸå‹ï¼šdataclasses.field(*, default=MISSING, default_factory=MISSING, repr=True, hash=None, init=True, compare=True, metadata=None)é€šå¸¸æˆ‘ä»¬æ— éœ€ç›´æ¥ä½¿ç”¨ï¼Œè£…é¥°å™¨ä¼šæ ¹æ®æˆ‘ä»¬ç»™å‡ºçš„ç±»å‹æ³¨è§£è‡ªåŠ¨ç”Ÿæˆfieldï¼Œä½†æœ‰æ—¶å€™æˆ‘ä»¬ä¹Ÿéœ€è¦å®šåˆ¶è¿™ä¸€è¿‡ç¨‹ï¼Œè¿™æ—¶dataclasses.fieldå°±æ˜¾å¾—æ ¼å¤–æœ‰ç”¨äº†ã€‚defaultå’Œdefault_factoryå‚æ•°å°†ä¼šå½±å“é»˜è®¤å€¼çš„äº§ç”Ÿï¼Œå®ƒä»¬çš„é»˜è®¤å€¼éƒ½æ˜¯Noneï¼Œæ„æ€æ˜¯è°ƒç”¨æ—¶å¦‚æœä¸ºæŒ‡å®šåˆ™äº§ç”Ÿä¸€ä¸ªä¸ºNoneçš„å€¼ã€‚å…¶ä¸­defaultæ˜¯fieldçš„é»˜è®¤å€¼ï¼Œè€Œdefault_factoryæ§åˆ¶å¦‚ä½•äº§ç”Ÿå€¼ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªæ— å‚æ•°æˆ–è€…å…¨æ˜¯é»˜è®¤å‚æ•°çš„callableå¯¹è±¡ï¼Œç„¶åç”¨è°ƒç”¨è¿™ä¸ªå¯¹è±¡è·å¾—fieldçš„åˆå§‹å€¼ï¼Œä¹‹åå†å°†defaultï¼ˆå¦‚æœå€¼ä¸æ˜¯MISSINGï¼‰å¤åˆ¶ç»™callableè¿”å›çš„è¿™ä¸ªå¯¹è±¡ã€‚initå‚æ•°å¦‚æœè®¾ç½®ä¸ºFalseï¼Œè¡¨ç¤ºä¸ä¸ºè¿™ä¸ªfieldç”Ÿæˆåˆå§‹åŒ–æ“ä½œï¼Œdataclassæä¾›äº†hookâ€”â€” __post_init__ä¾›æˆ‘ä»¬åˆ©ç”¨è¿™ä¸€ç‰¹æ€§ï¼šreprå‚æ•°è¡¨ç¤ºè¯¥fieldæ˜¯å¦è¢«åŒ…å«è¿›reprçš„è¾“å‡ºï¼Œcompareå’Œhashå‚æ•°è¡¨ç¤ºfieldæ˜¯å¦å‚ä¸æ¯”è¾ƒå’Œè®¡ç®—hashå€¼ã€‚metadataä¸è¢«dataclassè‡ªèº«ä½¿ç”¨ï¼Œé€šå¸¸è®©ç¬¬ä¸‰æ–¹ç»„ä»¶ä»ä¸­è·å–æŸäº›å…ƒä¿¡æ¯æ—¶æ‰ä½¿ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦ä½¿ç”¨è¿™ä¸€å‚æ•°ã€‚å¦‚æœæŒ‡å®šä¸€ä¸ªfieldçš„ç±»å‹æ³¨è§£ä¸ºdataclasses.InitVarï¼Œé‚£ä¹ˆè¿™ä¸ªfieldå°†åªä¼šåœ¨åˆå§‹åŒ–è¿‡ç¨‹ä¸­ï¼ˆ__init__å’Œ__post_init__ï¼‰å¯ä»¥è¢«ä½¿ç”¨ï¼Œå½“åˆå§‹åŒ–å®Œæˆåè®¿é—®è¯¥fieldä¼šè¿”å›ä¸€ä¸ªdataclasses.Fieldå¯¹è±¡è€Œä¸æ˜¯fieldåŸæœ¬çš„å€¼ï¼Œä¹Ÿå°±æ˜¯è¯¥fieldä¸å†æ˜¯ä¸€ä¸ªå¯è®¿é—®çš„æ•°æ®å¯¹è±¡ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚ä¸€ä¸ªç”±æ•°æ®åº“å¯¹è±¡ï¼Œå®ƒåªéœ€è¦åœ¨åˆå§‹åŒ–çš„è¿‡ç¨‹ä¸­è¢«è®¿é—®ï¼š@dataclassclass C:  i: int  j: int = None  database: InitVar[DatabaseType] = None  def __post_init__(self, database):    if self.j is None and database is not None:      self.j = database.lookup('j')c = C(10, database=my_database)dataclassç»§æ‰¿python3.7å¼•å…¥dataclassçš„ä¸€å¤§åŸå› å°±åœ¨äºç›¸æ¯”namedtupleï¼Œdataclasså¯ä»¥äº«å—ç»§æ‰¿å¸¦æ¥çš„ä¾¿åˆ©ã€‚dataclassè£…é¥°å™¨ä¼šæ£€æŸ¥å½“å‰classçš„æ‰€æœ‰åŸºç±»ï¼Œå¦‚æœå‘ç°ä¸€ä¸ªdataclassï¼Œå°±ä¼šæŠŠå®ƒçš„å­—æ®µæŒ‰é¡ºåºæ·»åŠ è¿›å½“å‰çš„classï¼Œéšåå†å¤„ç†å½“å‰classçš„fieldã€‚æ‰€æœ‰ç”Ÿæˆçš„æ–¹æ³•ä¹Ÿå°†æŒ‰ç…§è¿™ä¸€è¿‡ç¨‹å¤„ç†ï¼Œå› æ­¤å¦‚æœå­ç±»ä¸­çš„fieldä¸åŸºç±»åŒåï¼Œé‚£ä¹ˆå­ç±»å°†ä¼šæ— æ¡ä»¶è¦†ç›–åŸºç±»ã€‚å­ç±»å°†ä¼šæ ¹æ®æ‰€æœ‰çš„fieldé‡æ–°ç”Ÿæˆä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå¹¶åœ¨å…¶ä¸­åˆå§‹åŒ–åŸºç±»ã€‚å‡ ç‚¹æ³¨æ„äº‹é¡¹ï¼šdataclassé€šå¸¸æƒ…å†µä¸‹æ˜¯unhashableçš„ï¼Œå› ä¸ºé»˜è®¤ç”Ÿæˆçš„hashæ˜¯Noneï¼Œæ‰€ä»¥ä¸èƒ½ç”¨æ¥åšå­—å…¸çš„keyï¼Œå¦‚æœæœ‰è¿™ç§éœ€æ±‚ï¼Œé‚£ä¹ˆåº”è¯¥æŒ‡å®šä½ çš„æ•°æ®ç±»ä¸ºfrozen dataclasså°å¿ƒå½“ä½ å®šä¹‰äº†å’Œdataclassç”Ÿæˆçš„åŒåæ–¹æ³•æ—¶ä¼šå¼•å‘çš„é—®é¢˜å½“ä½¿ç”¨å¯å˜ç±»å‹ï¼ˆå¦‚listï¼‰æ—¶ï¼Œåº”è¯¥è€ƒè™‘ä½¿ç”¨fieldçš„default_factoryæ•°æ®ç±»çš„å±æ€§éƒ½æ˜¯å…¬å¼€çš„ï¼Œå¦‚æœä½ æœ‰å±æ€§åªéœ€è¦åˆå§‹åŒ–æ—¶ä½¿ç”¨è€Œä¸éœ€è¦åœ¨å…¶ä»–æ—¶å€™è¢«è®¿é—®ï¼Œè¯·ä½¿ç”¨dataclasses.InitVar</content>
	</entry>
	<entry>
		<title>pythonå¤šçº¿ç¨‹</title>
		<url>/article/30423.html</url>
		<content>pythonå¤šçº¿ç¨‹Pythonå¤šçº¿ç¨‹å­¦ä¹ </content>
	</entry>
	<entry>
		<title>pythonè¿›é˜¶é—®é¢˜</title>
		<url>/article/4794.html</url>
		<content>é«˜çº§æ¦‚å¿µä¸åŒ…å‡½æ•°å¼ç¼–ç¨‹åŒ…operatorform operator import mulå¯ä»¥æ›¿ä»£1reduce(lambda a,b:a*b, range(1,1+n))ä¸º1reduce(mul, range(1,1+n))itemgetter(1) å¯ä»¥æ›¿ä»£ lambda fields: fields[1]ï¼šåˆ›å»ºä¸€ä¸ªæ¥å—é›†åˆçš„å‡½æ•°ï¼Œè¿”å›ç´¢å¼•ä½1ä¸Šçš„å…ƒç´ attrgetterä¸itemgetterç±»ä¼¼ï¼Œå®ƒåˆ›å»ºçš„å‡½æ•°æ ¹æ®åç§°æå–å¯¹è±¡çš„å±æ€§ã€‚å¦‚æœæŠŠå¤šä¸ªå±æ€§åä¼ ç»™attrgetterï¼Œå®ƒä¹Ÿä¼šè¿”å›æå–çš„å€¼æ„æˆçš„å…ƒç»„ã€‚methodcallerä¼šè‡ªè¡Œåˆ›å»ºå‡½æ•°ï¼Œåˆ›å»ºçš„å‡½æ•°ä¼šåœ¨å¯¹è±¡ä¸Šè°ƒç”¨å‚æ•°æŒ‡å®šçš„æ–¹æ³•ã€‚123456from operator import methodcallers = 'The time is come'upcase = methodcaller('upper')upcase(s)Out[11]: 'THE TIME IS COME'æ¨¡å—æŸ¥æ‰¾ç­–ç•¥ç›®æ ‡ï¼šè‡ªåŠ¨æŸ¥æ‰¾å…¶ä»–å¯ç”¨çš„*_promoå‡½æ•°æ–¹å¼ä¸€ï¼š1promos = [globals()[name] for name in globals() if name.endswith('_promo') and name != 'best_promo']æ–¹å¼äºŒï¼šå°†æ‰€æœ‰ä¿ƒé”€æ”¾åœ¨promotionsæ¨¡å—12import inspectpromos = [func for name,func in inspect.getmembers(promotions, inspect.isfunction)]inspect.getmembersç”¨äºæ•è·å¯¹è±¡(è¿™é‡Œæ˜¯promotionsæ¨¡å—)çš„å±æ€§ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å¯é€‰çš„åˆ¤æ–­æ¡ä»¶(ä¸€ä¸ªå¸ƒå°”å€¼å‡½æ•°)ï¼Œè¿™é‡Œåªæå–æ¨¡å—ä¸­çš„å‡½æ•°é—­åŒ…closureå’Œåå‡½æ•°Partialå†…å±‚å‡½æ•°+æ‰€å¼•ç”¨çš„å¤–å±‚å˜é‡ï¼Œç§°ä¸ºé—­åŒ…12345678910111213# é—­åŒ…å°±æ˜¯å‡½æ•°é‡Œé¢åµŒå¥—ä¸€ä¸ªå‡½æ•°# å› ä¸ºå‡½æ•°çš„å‡ºç°ï¼Œå¯¼è‡´å˜é‡å‡ºç°äº†åˆ†åŒ–ï¼šå…¨å±€å˜é‡ã€å±€éƒ¨å˜é‡# å…¨å±€å˜é‡ï¼šå½“å‰æ¨¡å—ä¸­ä»»æ„åœ°æ–¹éƒ½èƒ½è®¿é—®ï¼# å±€éƒ¨å˜é‡ï¼šå½“å‰å‡½æ•°ä¸­å¯ä»¥æ“ä½œ# å…¨å±€å˜é‡-å±€éƒ¨å˜é‡ï¼šå˜é‡-åœ¨å‡½æ•°å¤–éƒ¨è°ƒç”¨è®¿é—®ï¼šdef outer():    msg = &quot;è¿™æ˜¯ä¸€ä¸ªå±€éƒ¨å˜é‡&quot;    print(&quot;è¿™æ˜¯ä¸€ä¸ªå‡½æ•°&quot;, msg)    def inner():        print(&quot;å¯ä»¥è®¿é—®å¤–éƒ¨å˜é‡msg&quot;, msg)        return msg    return inneråœ¨å‡½æ•°åµŒå¥—çš„å‰æä¸‹å†…å±‚å‡½æ•°å¼•ç”¨äº†å¤–å±‚å‡½æ•°çš„å˜(åŒ…æ‹¬å‚æ•°)å¤–å±‚å‡½æ•°åˆæŠŠå†…å±‚å‡½æ•°å½“åšè¿”å›å€¼è¿›è¡Œè¿”å›é—­åŒ…ä¸­ï¼Œå¦‚æœè¦ä¿®æ”¹å¼•ç”¨çš„å¤–å±‚å˜é‡éœ€è¦ä½¿ç”¨ nonlocal å˜é‡å£°æ˜ï¼Œè¡¨ç¤ºéå±€éƒ¨çš„å¦åˆ™ä¼šè¢«å½“åšæ˜¯é—­åŒ…å†…ï¼Œæ–°å®šä¹‰çš„å˜é‡12345678910111213# PYTHONä¸­çš„åå‡½æ•°ï¼Œå°±æ˜¯ä¸€ä¸ªè¯­æ³•ç³–# ä¸ºåŸæ¥æ²¡æœ‰é»˜è®¤å€¼çš„å‡½æ•°ï¼Œåˆ›å»ºå¸¦å¸¸ç”¨å€¼çš„åå‡½æ•°from functools import partialdef show2(name, msg):    print(name, &quot;: &quot; , msg)s = partial(show2, msg=&quot;HI&quot;)s(&quot;tom&quot;)show2(&quot;jerry&quot;, &quot;hello&quot;)tom :  HIjerry :  hellopythonæ¨¡å—:profile,pstatsæ€ªå¼‚é—®é¢˜é¿å‘1234567891011121314151617181920212223class Teas:    def __init__(self, lst=[]):        self.lst = lst    def hyc_print(self):        logger.info(self.lst)    def __del__(self):        passif __name__ == '__main__':    # multiprocessing_queue_test()    te1 = Teas()    te1.lst.append(1)    te1.hyc_print()    te2 = Teas()    te2.lst.append(2)    te2.hyc_print()    te1.hyc_print()    logger.info(te1.lst is te2.lst)12342020-05-29 17:14:40 multiprocessing_queue_iterator INFO:  [1]2020-05-29 17:14:40 multiprocessing_queue_iterator INFO:  [1, 2]2020-05-29 17:14:40 multiprocessing_queue_iterator INFO:  [1, 2]2020-05-29 17:14:40 multiprocessing_queue_iterator INFO:  True123456789class Teas:    def __init__(self, lst=None):        self.lst = lst if lst is not None else []    def hyc_print(self):        logger.info(self.lst)    def __del__(self):        pass12342020-05-29 17:15:43 multiprocessing_queue_iterator INFO:  [1]2020-05-29 17:15:43 multiprocessing_queue_iterator INFO:  [2]2020-05-29 17:15:43 multiprocessing_queue_iterator INFO:  [1]2020-05-29 17:15:43 multiprocessing_queue_iterator INFO:  Falseæ‰©å±•é˜…è¯»æœºå™¨å­¦ä¹ 8å¤§ç®—æ³•æ¯”è¾ƒ1https://mp.weixin.qq.com/s/0dT4BN01g0anVwyfjS-RVAä»Šå¹´GitHubæ’åå‰20çš„Pythonæœºå™¨å­¦ä¹ å¼€æºé¡¹ç›®1https://mp.weixin.qq.com/s/-WJ_S6CV7Cc14f4YzthPAQPythonåŸºç¡€ç½‘ç«™åˆ—è¡¨(æœ‰ç©ºå†æ‘˜å½•)12345678910111213141516171819202122232425262728293031323334353637381. å…ƒç»„https://www.jianshu.com/p/b728648501a82. å­—å…¸https://www.jianshu.com/p/8b51c9bf6d123. é›†åˆhttps://www.jianshu.com/p/75eb228b638e4. åˆ—è¡¨https://www.jianshu.com/p/636314cf01266.ä½œç”¨åŸŸhttps://www.jianshu.com/p/d8271c03a0f38. å¯¹è±¡(å±æ€§é™åˆ¶-å…¬æœ‰ç§æœ‰)https://www.jianshu.com/p/c7f6ecf07fbc9. å¯¹è±¡(å±æ€§é™åˆ¶-åªè¯»)https://www.jianshu.com/p/dd0e1487a4d610. å¯¹è±¡(å±æ€§é™åˆ¶-åªè¯»ä¼˜åŒ–)https://www.jianshu.com/p/f54e0a5af63511. å¯¹è±¡(ç³»ç»Ÿå†…ç½®æ–¹æ³•-éå†æ“ä½œ)https://www.jianshu.com/p/bd87cca40d8b12. å†…å­˜ç®¡ç†æœºåˆ¶-å¼•ç”¨è®¡æ•°/åƒåœ¾å›æ”¶/å¾ªç¯å¼•ç”¨/å¼±å¼•ç”¨https://www.jianshu.com/p/ef8a218c6b8913. å¯¹è±¡æ€æƒ³https://www.jianshu.com/p/0347ba66766714. ç»¼åˆæ¡ˆä¾‹ï¼šå°è£…/ç»§æ‰¿/å¤šæ€https://www.jianshu.com/p/b35043c76f5015. å¼‚å¸¸å¤„ç†(é”™è¯¯å’Œå¼‚å¸¸)https://www.jianshu.com/p/507d677e74a416. åŒ…/æ¨¡å—(æ¦‚å¿µåŠå¯¼å…¥è¯­æ³•)https://www.jianshu.com/p/1d9100f8292a17. åŒ…/æ¨¡å—(å¯¼å…¥åŠå…¶åº•å±‚é€»è¾‘)https://www.jianshu.com/p/6a99e5e4c1b518. åŒ…/æ¨¡å—(ä¸‰æ–¹åŒ…å®‰è£…)https://www.jianshu.com/p/68477d5625fc19. åŒ…/æ¨¡å—(åˆ›å»ºå’Œå‘å¸ƒ)https://www.jianshu.com/p/ee48fde9afd620.å…¶ä»–â€‹    æ¯”å¦‚ï¼šä½ è¦å»åšä¸€ä¸ªç”µå•†åå°ï¼Œå­˜å‚¨ç€æ¯ä»¶äº§å“çš„ IDã€åç§°å’Œä»·æ ¼ã€‚ç°åœ¨éœ€è¦æ ¹æ®å•†å“ ID æ‰¾å‡ºä»·æ ¼ï¼Œå¦‚ä½•ä½¿ç”¨æœ€åˆé€‚çš„æ•°æ®ç»“æ„å‘¢ï¼Ÿåœ¨ Python ä¸­å­—å…¸ã€é›†åˆéƒ½æ˜¯ç»è¿‡é«˜åº¦æ€§èƒ½ä¼˜åŒ–çš„æ•°æ®ç»“æ„ï¼Œå¦‚æœé‡‡ç”¨åˆ—è¡¨æ¥å­˜å‚¨æ•°æ®å¹¶è¿›è¡ŒæŸ¥æ‰¾ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯å¤šå°‘ï¼Ÿæ¢æˆå­—å…¸å‘¢ï¼Ÿå“ªä¸ªæ›´é«˜æ•ˆï¼Ÿäº‹å®ä¸Šï¼Œé‡‡ç”¨ä¸åŒæ•°æ®ç»“æ„å­˜å‚¨åä¸‡æ•°æ®ï¼ŒæŸ¥æ‰¾é€Ÿåº¦å·®å¼‚å°±æœ‰å¯èƒ½å·®å‡ºå‡ åƒå€ã€‚å†æ¯”å¦‚ï¼šPython ä¸­çš„åç¨‹å’Œçº¿ç¨‹æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿç”Ÿæˆå™¨å¦‚ä½•è¿›åŒ–æˆåç¨‹ï¼Ÿå¹¶å‘ç¼–ç¨‹ä¸­çš„ future å’Œ asyncio æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿå¦‚ä½•å†™å‡ºçº¿ç¨‹å®‰å…¨çš„é«˜æ€§èƒ½ä»£ç å‘¢ï¼ŸPython åŸºç¡€å…¥é—¨å¿…å­¦çŸ¥è¯†ï¼šã€Python åŸºç¡€æ•°æ®ç»“æ„ã€‘ã€Python åŸºç¡€è¯­æ³•ã€‘ã€æ–‡ä»¶æ“ä½œã€‘ã€é”™è¯¯ä¸å¼‚å¸¸å¤„ç†ã€‘ã€Python é¢å‘å¯¹è±¡ã€‘ã€æ¨¡å—åŒ–ã€‘ç¬¬ä¸€æ­¥ï¼Œä½ éœ€è¦æŒæ¡ Python çš„æ ¸å¿ƒåŸºç¡€çŸ¥è¯†ã€‚å½“ç„¶ï¼Œä¸åŒäºå…¶ä»–åŸºç¡€æ•™æï¼Œæˆ‘ä¸ä»…ä»…åªè®²åŸºç¡€æ¦‚å¿µã€æ“ä½œï¼ŒåŒæ—¶ä¹Ÿä¸ºä½ æ•´ç†äº†å¾ˆå¤šè¿›é˜¶éš¾åº¦çš„çŸ¥è¯†ï¼Œæˆ–æ˜¯ä¸€äº›é‡éš¾ç‚¹ã€æ˜“é”™ç‚¹ç­‰éœ€è¦æ³¨æ„çš„åœ°æ–¹ã€‚ä¸ä»…å¯ä»¥è®©å…¥é—¨çº§çš„ç¨‹åºå‘˜æŸ¥æ¼è¡¥ç¼ºï¼Œæ‰“æåŸºç¡€ï¼Œä¹Ÿèƒ½è®©æœ‰ç»éªŒçš„ç¨‹åºå‘˜ï¼Œé‡æ–°ä»å·¥ç¨‹è§’åº¦è®¤è¯†åŸºç¡€ï¼Œå‡åç†è§£ã€‚Python è¿›é˜¶æ ¸å¿ƒçŸ¥è¯†å¿…å­¦çŸ¥è¯†ï¼šã€Python åè®®ã€‘ã€Python é«˜çº§è¯­æ³•ã€‘ã€Python æ­£åˆ™è¡¨è¾¾å¼ã€‘ã€Python å¹¶å‘ç¼–ç¨‹ã€‘ã€åƒåœ¾å›æ”¶æœºåˆ¶ã€‘ã€é¡¹ç›®å®æˆ˜ã€‘ç¬¬äºŒæ­¥ï¼Œè¿›é˜¶ Python æ ¸å¿ƒçŸ¥è¯†ç‚¹ï¼Œæ¯”å¦‚è£…é¥°å™¨ã€å¹¶å‘ç¼–ç¨‹ç­‰ç­‰ã€‚å¦‚æœä½ çš„å·¥ä½œåªæ˜¯å†™ 100 è¡Œä»¥ä¸‹çš„è„šæœ¬ç¨‹åºï¼Œå¯èƒ½ä¸æ€ä¹ˆä¼šç”¨å¾—åˆ°ã€‚ä½†å¦‚æœä½ åšçš„æ˜¯å¤§å‹ç¨‹åºçš„å¼€å‘ï¼Œåˆ™éå¸¸æœ‰å¿…è¦ã€‚è§„èŒƒï¼šç¼–å†™é«˜è´¨é‡çš„ Python ç¨‹åºè¿™éƒ¨åˆ†ç€é‡äºæ•™ä½ æŠŠç¨‹åºå†™å¾—æ›´åŠ è§„èŒƒã€æ›´åŠ ç¨³å®šã€‚æˆ‘åœ¨å®é™…å·¥ä½œä¸­è§è¿‡ä¸å°‘ç¨‹åºå‘˜ï¼Œä¼šå†™ç¨‹åºï¼Œä½†å†™å¾—å®åœ¨æœ‰ç‚¹â€œæƒ¨ä¸å¿ç¹â€ï¼Œå¯¼è‡´æœ€åè°ƒè¯•èµ·æ¥é”™è¯¯ä¸æ–­ï¼Œä¿®æ”¹éå¸¸è´¹åŠ²å„¿ã€‚å› æ­¤ï¼Œæˆ‘è§‰å¾—ç”¨å•ç‹¬ä¸€ä¸ªç‰ˆå—è®²è§£è¿™ä¸ªé—®é¢˜éå¸¸æœ‰å¿…è¦ã€‚å½“ç„¶ï¼Œæˆ‘ä¸ä¼šç”¨ä¸€äº›ä¼¼æ˜¯è€Œéçš„è§„èŒƒæ¥è¯´æ•™ï¼Œè€Œæ˜¯ä¼šç”¨å…·ä½“çš„ç¼–ç¨‹æ“ä½œå’ŒæŠ€å·§ï¼Œæ•™ä½ æé«˜ä»£ç è´¨é‡ã€‚æ¯”å¦‚ï¼Œå¦‚ä½•åˆç†åœ°åˆ†è§£ä»£ç ã€è¿ç”¨ assertï¼Œå¦‚ä½•å†™å•å…ƒæµ‹è¯•ç­‰ç­‰ã€‚Python å®æˆ˜ï¼Œä¸²è”æ•´ä¸ªçŸ¥è¯†ä½“ç³»ï¼šå¸¦ä½ æ­å»ºé‡åŒ–äº¤æ˜“ç³»ç»Ÿå¿…å­¦çŸ¥è¯†ç‚¹ï¼šã€RESTfulã€‘ã€Socketã€‘ã€Pandasã€‘ã€Numpyã€‘ã€Kafkaã€‘ã€RabbitMQã€‘ã€MySQLã€‘ã€Djangoã€‘</content>
	</entry>
	<entry>
		<title>pythonæ€§èƒ½ä¼˜åŒ–æ¨¡å—</title>
		<url>/article/26598.html</url>
		<content>ç³»ç»Ÿç›‘æ§æ¨¡å—psutilæ¨¡å—psutilæ¨¡å—æ–‡æ¡£psutilæ˜¯ä¸€ä¸ªè·¨å¹³å°åº“(http://pythonhosted.org/psutil/)èƒ½å¤Ÿè½»æ¾å®ç°è·å–ç³»ç»Ÿè¿è¡Œçš„è¿›ç¨‹å’Œç³»ç»Ÿåˆ©ç”¨ç‡ï¼ˆåŒ…æ‹¬CPUã€å†…å­˜ã€ç£ç›˜ã€ç½‘ç»œç­‰ï¼‰ä¿¡æ¯ã€‚å®ƒä¸»è¦ç”¨æ¥åšç³»ç»Ÿç›‘æ§ï¼Œæ€§èƒ½åˆ†æï¼Œè¿›ç¨‹ç®¡ç†ã€‚å®ƒå®ç°äº†åŒç­‰å‘½ä»¤è¡Œå·¥å…·æä¾›çš„åŠŸèƒ½ï¼Œå¦‚psã€topã€lsofã€netstatã€ifconfigã€whoã€dfã€killã€freeã€niceã€ioniceã€iostatã€iotopã€uptimeã€pidofã€ttyã€tasksetã€pmapç­‰ã€‚ä¸€ã€ å®‰è£…psutilã€€ã€€pip install psutil äºŒã€ ç›‘æ§cpuä¿¡æ¯import psutilpsutil.cpu_times()   #è·å–cpuï¼ˆé€»è¾‘cpuçš„å¹³å‡ï¼‰å ç”¨æ—¶é—´çš„è¯¦ç»†ä¿¡æ¯ psutil.cpu_times(percpu=True)   #è·å–æ¯ä¸ªcpuå ç”¨æ—¶é—´çš„è¯¦ç»†ä¿¡æ¯psutil.cpt_times().user   #è·å–ç”¨æˆ·è¿›ç¨‹å ç”¨cpuçš„æ—¶é—´ï¼ˆuser+sys+idle+wait=totalï¼‰ä¸‰ã€ ç›‘æ§å†…å­˜ä¿¡æ¯import psutilpsutil.virtual_memory()   #è·å–å†…å­˜ä¿¡æ¯psutil.virtual_memory().total   #è·å–å†…å­˜æ€»é‡psutil.swap_memory()   #è·å–swapä¿¡æ¯psutil.swqp_memory()   #è·å–swapæ€»é‡ å››ã€ ç›‘æ§ç£ç›˜ä¿¡æ¯import psutilpsutil.disk_partitions()   #è·å–å„åˆ†åŒºçš„ä¿¡æ¯psutil.disk_usage()   #è·å–å„åˆ†åŒºçš„ä½¿ç”¨æƒ…å†µpsutil.disk_io_counters(perdisk=True)   #è·å–å„ä¸ªåˆ†åŒºçš„ioæƒ…å†µpsutil.disk_io_counters(perdisk=True)[â€˜sda1â€™].read_count   #è·å–sda1çš„ioè¯»å–æƒ…å†µäº”ã€ ç›‘æ§ç½‘ç»œä¿¡æ¯import psutilpsutil.net_io_counters()   #è·å–æ‰€æœ‰ç½‘ç»œæ¥å£ioä¿¡æ¯psutil.net_io_counters(pernic=True)   #è·å–æ¯ä¸ªç½‘ç»œæ¥å£çš„ioä¿¡æ¯å…­ã€è¿›ç¨‹ä¿¡æ¯import psutilpsutil.Process(pid)   #æŸ¥çœ‹å¯¹åº”pidçš„è¿›ç¨‹ä¿¡æ¯psutil.Process(pid).username()   #æŸ¥çœ‹æ˜¯å“ªä¸ªç”¨æˆ·åˆ›å»ºçš„è¯¥è¿›ç¨‹psutil.Process(pid).cmdline()   #æŸ¥çœ‹è¿›ç¨‹æ‰€åœ¨çš„è·¯å¾„ä¸ƒã€ ç™»å½•ç”¨æˆ·ä¿¡æ¯import psutilpsutil.users()   #æŸ¥çœ‹ç›®å‰ç™»å½•ç”¨æˆ·ä¿¡æ¯ä¾‹å­12345678910111213141516171819202122232425262728293031323334353637383940414243import psutilimport timedef get_sys_rc():    # è·å¾—cpuä¿¡æ¯ï¼šæ ¸å¿ƒæ•°é‡ã€ä½¿ç”¨ç‡    cpu_count = psutil.cpu_count()    print(cpu_count)    cpu_usage = psutil.cpu_percent(1)  # é—´éš”1ç§’é’Ÿç»Ÿè®¡ä¸€æ¬¡ä½¿ç”¨ç‡    print(cpu_usage)    # è·å¾—å†…å­˜å¤§å°å’Œä½¿ç”¨ç‡    print(&quot;#&quot; * 50)    mem = psutil.virtual_memory()    mem_total = mem.total / 1024 / 1024    mem_usage = mem.percent    print(mem_total, mem_usage)    # è·å¾—ç£ç›˜ä¿¡æ¯å’Œåˆ†åŒºä¿¡æ¯    disk_info = psutil.disk_partitions()  # å¾—åˆ°æ‰€æœ‰çš„åˆ†åŒºä¿¡æ¯    print(disk_info)    for i in disk_info:  # éå†æ‰€æœ‰çš„åˆ†åŒºï¼Œå¾—åˆ°åˆ†åŒºçš„åå­—        print(i.device)  # è¾“å‡ºè®¾å¤‡åå­—        part_info = psutil.disk_usage(i.device)  # å¾—åˆ°æ¯ä¸ªåˆ†åŒºçš„ä½¿ç”¨ç‡        print(part_info)  # è¾“å‡ºä½¿ç”¨ç‡        # round() å››èˆäº”å…¥çš„æ–¹æ³•        print(f&quot;{i.device}æ€»å¤§å°ä¸º{round(part_info.total / 1024 / 1024 / 1024)}G,ä½¿ç”¨ç‡{part_info.percent}&quot;)    # è·å¾—ç½‘å¡ä¿¡æ¯    net_info = psutil.net_io_counters()    step1 = net_info.bytes_sent    time.sleep(3)    step2 = psutil.net_io_counters().bytes_sent    avg = (step2 - step1) / 3 / 1000    print(f&quot;å½“å‰å¹³å‡çš„ç½‘ç»œæµé‡æ˜¯{round(avg)}KB&quot;)    # è·å¾—æ‰€æœ‰ç½‘å¡çš„ipåœ°å€    # psutil.net_if_stats()    return {&quot;cpu_count&quot;: cpu_count, &quot;cpu_usage&quot;: cpu_usage}    # return  {&quot;cpu_count&quot;:cpu_count,&quot;cpu_usage&quot;:cpu_usage,mem_total,mem_usage,avg}if __name__ == &quot;__main__&quot;:    print(get_sys_rc())output12345678910111213141516171819202122232425262728842.8##################################################32685.93359375 23.9[sdiskpart(device='C:\\', mountpoint='C:\\', fstype='NTFS', opts='rw,fixed'), sdiskpart(device='D:\\', mountpoint='D:\\', fstype='NTFS', opts='rw,fixed'), sdiskpart(device='E:\\', mountpoint='E:\\', fstype='NTFS', opts='rw,fixed'), sdiskpart(device='H:\\', mountpoint='H:\\', fstype='NTFS', opts='rw,fixed'), sdiskpart(device='Q:\\', mountpoint='Q:\\', fstype='NTFS', opts='rw,fixed'), sdiskpart(device='S:\\', mountpoint='S:\\', fstype='NTFS', opts='rw,fixed'), sdiskpart(device='U:\\', mountpoint='U:\\', fstype='NTFS', opts='rw,fixed')]C:\sdiskusage(total=116955537408, used=76401147904, free=40554389504, percent=65.3)C:\æ€»å¤§å°ä¸º109G,ä½¿ç”¨ç‡65.3D:\sdiskusage(total=174902472704, used=128004796416, free=46897676288, percent=73.2)D:\æ€»å¤§å°ä¸º163G,ä½¿ç”¨ç‡73.2E:\sdiskusage(total=107373129728, used=24370171904, free=83002957824, percent=22.7)E:\æ€»å¤§å°ä¸º100G,ä½¿ç”¨ç‡22.7H:\sdiskusage(total=214747312128, used=140843151360, free=73904160768, percent=65.6)H:\æ€»å¤§å°ä¸º200G,ä½¿ç”¨ç‡65.6Q:\sdiskusage(total=214748360704, used=67760369664, free=146987991040, percent=31.6)Q:\æ€»å¤§å°ä¸º200G,ä½¿ç”¨ç‡31.6S:\sdiskusage(total=214748360704, used=79423479808, free=135324880896, percent=37.0)S:\æ€»å¤§å°ä¸º200G,ä½¿ç”¨ç‡37.0U:\sdiskusage(total=1073741819904, used=507053940736, free=566687879168, percent=47.2)U:\æ€»å¤§å°ä¸º1000G,ä½¿ç”¨ç‡47.2å½“å‰å¹³å‡çš„ç½‘ç»œæµé‡æ˜¯1KB{'cpu_count': 8, 'cpu_usage': 42.8}æ—¶é—´ç›‘æ§cProfileä»‹ç»cProfileå®˜æ–¹æ–‡æ¡£cProfileè‡ªpython2.5ä»¥æ¥å°±æ˜¯æ ‡å‡†ç‰ˆPythonè§£é‡Šå™¨é»˜è®¤çš„æ€§èƒ½åˆ†æå™¨ã€‚å…¶ä»–ç‰ˆæœ¬çš„pythonï¼Œæ¯”å¦‚PyPyé‡Œæ²¡æœ‰cProfileçš„ã€‚cProfileæ˜¯ä¸€ç§ç¡®å®šæ€§åˆ†æå™¨ï¼Œåªæµ‹é‡CPUæ—¶é—´ï¼Œå¹¶ä¸å…³å¿ƒå†…å­˜æ¶ˆè€—å’Œå…¶ä»–ä¸å†…å­˜ç›¸å…³è”çš„ä¿¡æ¯ã€‚cProfileæ¨¡å—æ—¶é—´ç›‘æ§è£…é¥°å™¨1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374#!/usr/bin/env Python# -- coding: utf-8 --&quot;&quot;&quot;@version: v1.0@author: huangyc@file: profiler_helper.py@Description: æ—¶é—´æ€§èƒ½ç›‘æ§ç±»ï¼Œä¸»è¦ç›‘æ§æ‰§è¡ŒçŠ¶æ€ã€é¢‘ç‡å’Œæ—¶é•¿@time: 2021/7/17 15:51&quot;&quot;&quot;from cProfile import Profilefrom functools import wrapsfrom pstats import Statsclass ProfilerHelper:    @staticmethod    def profiler_wrap(sort_by: str = 'cumulative', print_stats: bool = True, print_callers: bool = True):        &quot;&quot;&quot;        è¡ŒçŠ¶æ€ã€é¢‘ç‡å’Œæ—¶é•¿è£…é¥°å™¨        :param sort_by: æ’åºè§„åˆ™                        å¯é€‰å‚æ•°ï¼š                              å‡†åˆ™                       å«ä¹‰                       å‡åº/é™åºæ’åˆ—                              calls                    è°ƒç”¨æ¬¡æ•°                        é™åº                              cumulative               ç´¯è®¡æ—¶é—´                        é™åº                              cumtime                  ç´¯è®¡æ—¶é—´                        é™åº                              file                     æ–‡ä»¶                           å‡åº                              filename                 æ–‡ä»¶å                          å‡åº                              module                   æ¨¡å—å                          å‡åº                              ncalls                   è°ƒç”¨æ€»æ¬¡æ•°                       é™åº                              pcalls                   åŸå§‹è°ƒç”¨ä¹¦                       é™åº                              line                     è¡Œå·                            å‡åº                              name                     å‡½æ•°å                          å‡åº                              nfl                      å‡½æ•°å/æ–‡ä»¶å/è¡Œå·ç»„åˆ             é™åº                              stdname                  æ ‡å‡†åç§°                         å‡åº                              time                     å‡½æ•°å†…éƒ¨è¿è¡Œæ—¶é—´                   é™åº                              tottime                  å‡½æ•°å†…éƒ¨è¿è¡Œæ€»æ—¶é—´                 é™åº        :param print_stats: Create a Stats object based on the current profile and print the results to stdout.        :param print_callers: æ‰“å°å—æµ‹å‡½æ•°å’Œè°ƒç”¨å‡½æ•°çš„å…³ç³»        :return:        &quot;&quot;&quot;        def wrapper(func):            @wraps(func)            def inner_func(*args, **kwargs):                profiler = Profile()                res = profiler.runcall(func, *args, **kwargs)                stats = Stats(profiler)                # strip_dirs()ï¼šåˆ é™¤æŠ¥å‘Šä¸­æ‰€æœ‰å‡½æ•°æ–‡ä»¶åçš„è·¯å¾„ä¿¡æ¯ï¼Œè¿™ä¸ªæ–¹æ³•æ”¹å˜statså®ä¾‹å†…éƒ¨çš„é¡ºåºï¼Œä»»ä½•è¿è¡Œè¯¥æ–¹æ³•çš„å®ä¾‹éƒ½å°†éšæœºæ’åˆ—é¡¹ç›®çš„é¡ºåºã€‚                # å¦‚æœä¸¤ä¸ªé¡¹ç›®æ˜¯ç›¸åŒçš„ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªé¡¹ç›®å°±å¯ä»¥åˆå¹¶ã€‚                stats.strip_dirs()                # sort_stats(*keys)ï¼šé€šè¿‡ä¸€ç³»åˆ—æ¡ä»¶ä¾æ¬¡å¯¹æ‰€æœ‰é¡¹ç›®è¿›è¡Œæ’åºï¼Œä»è€Œè°ƒæ•´statså¯¹è±¡                stats.sort_stats(sort_by)                if print_stats:                    stats.print_stats()                if print_callers:                    stats.print_callers()                return res            return inner_func        return wrapper@ProfilerHelper.profiler_wrap()def fn(h, a=5, b=8):    import re    print(h, a, b)    return re.compile(&quot;aaa|bbb&quot;)if __name__ == '__main__':    print(fn(464646, 8, b=8))å†…å­˜ç›‘æ§tracemallocä»‹ç»tracemallocæ¨¡å—å®˜æ–¹æ–‡æ¡£tracemallocæ¨¡å—æ˜¯è·Ÿè¸ªpythonåˆ†é…çš„å†…å­˜å—çš„è°ƒè¯•å·¥å…·ã€‚å®ƒæä¾›ä»¥ä¸‹ä¿¡æ¯ï¼šå›æº¯å¯¹è±¡çš„åˆ†é…ä½ç½®æ¯ä¸ªæ–‡ä»¶åå’Œæ¯ä¸ªè¡Œå·çš„å·²åˆ†é…å†…å­˜å—çš„ç»Ÿè®¡ä¿¡æ¯ï¼šå·²åˆ†é…å†…å­˜å—çš„æ€»å¤§å°ã€æ•°é‡å’Œå¹³å‡å¤§å°è®¡ç®—ä¸¤ä¸ªå¿«ç…§ä¹‹é—´çš„å·®å¼‚ä»¥æ£€æµ‹å†…å­˜æ³„æ¼tracemallocæ¨¡å—å†…å­˜ç›‘æ§è£…é¥°å™¨12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667#!/usr/bin/env Python# -- coding: utf-8 --&quot;&quot;&quot;@version: v1.0@author: huangyc@file: tracemalloc_helper.py@Description: å†…å­˜ç›‘æ§ç±»@time: 2021/7/17 15:53&quot;&quot;&quot;import tracemallocfrom functools import wrapsclass TracemallocHelper:    @staticmethod    def tracemalloc_wrap(key_type: str = 'lineno', monitor_type: str = 'statistics', top_k: int = 10,                         filter_self: bool = True):        &quot;&quot;&quot;        å†…å­˜ç›‘æ§è£…é¥°å™¨        :param key_type: æ¯”è¾ƒçš„å­—æ®µï¼Œ'traceback', 'filename', 'lineno'        :param monitor_type: ç›‘æ§ç±»å‹ï¼Œ'statistics', 'change'        :param top_k: å…³æ³¨top_kçš„å†…å­˜å ç”¨,é»˜è®¤å…³æ³¨å‰10ä¸ª        :param filter_self: æ˜¯å¦è¿‡æ»¤æ‰ç›‘æ§ç¨‹åºæœ¬èº«çš„æ¶ˆè€—        :return:        &quot;&quot;&quot;        def wrapper(func):            @wraps(func)            def inner_func(*args, **kwargs):                tracemalloc.start()                # ... start your application ...                res = func(*args, **kwargs)                snapshot1 = tracemalloc.take_snapshot()                # ... call the function leaking memory ...                snapshot2 = tracemalloc.take_snapshot()                if monitor_type == 'change':                    top_stats = snapshot2.compare_to(snapshot1, key_type)                elif monitor_type == 'statistics':                    top_stats = snapshot2.statistics(key_type)                else:                    top_stats = snapshot2.statistics(key_type)                print(f&quot;[ Top {top_k} differences ]&quot;)                for idx, stat in enumerate(top_stats[:top_k]):                    if filter_self and 'tracemalloc.py' in str(stat):                        continue                    print('d' % idx, stat)                return res            return inner_func        return wrapper@TracemallocHelper.tracemalloc_wrap()def fn(h, a=5, b=8):    print(h, a, b)    d = [dict(zip('xy', (5, 6))) for i in range(100000)]    t = [tuple(zip('xy', (5, 6))) for i in range(100000)]    return d, tif __name__ == '__main__':    fn(68, 7, b=78)</content>
	</entry>
	<entry>
		<title>Anacondaå¼€å‘ç¯å¢ƒ</title>
		<url>/article/39324.html</url>
		<content>Anacondaä»‹ç»Anacondaï¼ˆå®˜æ–¹ç½‘ç«™ï¼‰å°±æ˜¯å¯ä»¥ä¾¿æ·è·å–åŒ…ä¸”å¯¹åŒ…èƒ½å¤Ÿè¿›è¡Œç®¡ç†ï¼ŒåŒæ—¶å¯¹ç¯å¢ƒå¯ä»¥ç»Ÿä¸€ç®¡ç†çš„å‘è¡Œç‰ˆæœ¬ã€‚AnacondaåŒ…å«äº†condaã€Pythonåœ¨å†…çš„è¶…è¿‡180ä¸ªç§‘å­¦åŒ…åŠå…¶ä¾èµ–é¡¹ã€‚å¥—ä»¶ç®¡ç†æ˜¾ç¤ºå·²å®‰è£…çš„å¥—ä»¶12conda listpip listå¥—ä»¶å®‰è£…1234conda install packages # pipå¯ä»¥å®‰è£…ä¸€äº›condaå®‰è£…ä¸äº†çš„åŒ…pip install packages [-i https://pypi.douban.com/simple] # -iéƒ¨åˆ†ä¸´æ—¶æŒ‡å®špipæºeasy_install å‚æ•° packagespython setup.py install # ä¸‹è½½æºç ï¼Œè¿›å…¥åˆ°æºç è·¯å¾„ä¸‹å›½å†…çš„pipæºé˜¿é‡Œäº‘ https://mirrors.aliyun.com/pypi/simple/ä¸­å›½ç§‘æŠ€å¤§å­¦ https://pypi.mirrors.ustc.edu.cn/simple/è±†ç“£(douban) https://pypi.douban.com/simple/æ¸…åå¤§å­¦ https://pypi.tuna.tsinghua.edu.cn/simple/1pip install xx -i http://pypi.douban.com/simple/ --trusted-host=pypi.douban.com/simpleä»Anaconda.orgå®‰è£…å¥—ä»¶123# å¦‚æœä¸€ä¸ªåŒ…ä¸èƒ½ä½¿ç”¨condaå®‰è£…ï¼Œå¯åœ¨Anaconda.orgæŸ¥æ‰¾# åœ¨å·¦ä¸Šè§’çš„å«â€œSearch Anaconda Cloudâ€æœç´¢æ¡†ä¸­è¾“å…¥â€œåŒ…åâ€å¹¶ç‚¹å‡»searchæŒ‰é’®conda install --channel https://conda.anaconda.ort/pandas bottleneck # å®‰è£…bottleneckåŒ…åˆ é™¤å¥—ä»¶12conda/pip uninstall packageseasy_install -m packagesæŸ¥æ‰¾å¥—ä»¶1conda search packagespipç®¡ç†å‡çº§12345# è¯•ç”¨linux, winä¸‹å¯èƒ½ä¼šå› ä¸ºæƒé™å‡çº§å¤±è´¥pip install --upgrade pip# winæˆ–linuxpython -m pip install --upgrade pipå¦‚æœä¸å°å¿ƒåˆ æ‰äº†pipï¼Œå¯ä»¥ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…1python -m ensurepip --default-pipå®‰è£…åŸºç¡€å‡†å¤‡(centos7ç¯å¢ƒ)å®‰è£…wgetå‘½ä»¤ï¼šyum -y install wgetå®‰è£…gitç›¸å…³1234567# å®‰è£…gityum install git -y# å®‰è£…git lfsï¼ˆå¤§æ–‡ä»¶ä¸‹è½½ï¼‰curl -s https://packagecloud.io/install/repositories/github/git-lfs/script.rpm.sh | sudo bashyum install git-lfsgit lfs installå®‰è£…OpenSSLå’Œlibssl-dev12yum install opensslyum install openssl-develå®‰è£…gccï¼šyum install gccå®‰è£…æ­¥éª¤1234567# å®‰è£…anacondaç¯å¢ƒwget https://repo.anaconda.com/archive/Anaconda3-2023.07-2-Linux-x86_64.shchmod +x Anaconda3-2023.07-2-Linux-x86_64.sh./Anaconda3-2023.07-2-Linux-x86_64.sh# åˆ›å»ºè‡ªå·±çš„pythonç¯å¢ƒconda create -n gpt310 python=3.10 anacondaè™šæ‹Ÿç¯å¢ƒç®¡ç†ä½¿ç”¨Anaconda Prompt ç®¡ç†è™šæ‹Ÿç¯å¢ƒæ–°å»ºè™šæ‹Ÿç¯å¢ƒæ·»åŠ åç¼€ â€œanacondaâ€æˆ–â€œbiopythonâ€å¯ä»¥åˆ›å»ºä¸€ä¸ªåŸºæœ¬ç§‘å­¦è®¡ç®—åŠŸèƒ½å®Œå¤‡çš„ç¯å¢ƒ1conda create -n ç¯å¢ƒå python=3.7 anacondaåˆ‡æ¢è™šæ‹Ÿç¯å¢ƒ12source activate snowflakes # Linuxï¼ŒOS Xactivate snowflakes # Windowså…³é—­è™šæ‹Ÿç¯å¢ƒ12source deactivate # Linuxï¼ŒOS Xdeactivate # WindowsæŸ¥çœ‹æ‰€æœ‰çš„è™šæ‹Ÿç¯å¢ƒåç§°12conda info -econda env listç§»é™¤è™šæ‹Ÿç¯å¢ƒ1conda remove -n è™šæ‹Ÿç¯å¢ƒåç§° --allå¤åˆ¶è™šæ‹Ÿç¯å¢ƒ1conda create -n è™šæ‹Ÿç¯å¢ƒåç§° --clone rootIPython äº¤è°ˆå¼å‘½ä»¤çª—å£cmdä¸­pythonæ¨¡å¼çš„åŠ å¼ºç‰ˆè§‚çœ‹å…ˆå‰è¾“å…¥çš„ç¨‹åºä»£ç  historyæŸ¥è¯¢ä½¿ç”¨è¯´æ˜ ?åŠ åœ¨å‘½ä»¤åé¢ç®€æ˜“æ™ºèƒ½è¾“å…¥æ‰§è¡Œpythonæ¡£æ¡ˆ %run æ¡£æ¡ˆè·¯å¾„æ›´æ–°condaæœ¬èº«1conda update condaæ›´æ–°anaconda åº”ç”¨1conda update anacondaæ›´æ–°pythonå‡è®¾å½“å‰pythonç¯å¢ƒæ˜¯3.6.1ï¼Œè€Œæœ€æ–°ç‰ˆæœ¬æ˜¯3.6.2ï¼Œé‚£ä¹ˆå°±ä¼šå‡çº§åˆ°3.6.21conda update pythoncondaæºç®¡ç†æŸ¥çœ‹å½“å‰æºä¿¡æ¯1conda infoå…³æ³¨ channel URLs å­—æ®µå†…å®¹æ·»åŠ ä¸€ä¸ªé•œåƒ12345# æ·»åŠ é•œåƒ(base) C:\Users\hyc&gt;conda config --add channels 'https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/'# è®¾ç½®æœç´¢æ—¶æ˜¾ç¤ºchannelåœ°å€(base) C:\Users\hyc&gt;conda config --set show_channel_urls yesåˆ é™¤ä¸€ä¸ªé•œåƒ12# æ³¨æ„é“¾æ¥è¦æœ‰å¼•å·ï¼Œè‹±æ–‡è¾“å…¥æ³•(base) C:\Users\hyc&gt;conda config --remove channels 'https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/'æŸ¥çœ‹condaçš„é•œåƒ12conda config --show-sourcesconda config --show channelsåˆ é™¤æ‰€æœ‰é•œåƒ1conda config --remove-key channelsä»¥ä¸Šæ“ä½œå¯ä»¥ç›´æ¥ç¼–è¾‘.condarcæ–‡ä»¶å®Œæˆ12345678ssl_verify: Falseproxy_servers:  http: http://192.168.4.80:3128  https: http://192.168.4.80:3128channels:  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/  - defaultsshow_channel_urls: Trueå…¶ä»–ç®¡ç†è¿è¡Œç¯å¢ƒåˆ†äº«æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å¯ä»¥å°†å½“å‰ç¯å¢ƒä¸‹çš„ package ä¿¡æ¯å­˜å…¥åä¸º environment çš„ YAML æ–‡ä»¶ä¸­1conda env export &gt; environment.yamlä½¿ç”¨yamlæ–‡ä»¶åˆ›å»ºç¯å¢ƒ1conda env create -f environment.yamlå›½å†…å¸¸è§æºanaconda conda åˆ‡æ¢ä¸ºå›½å†…æºAnaconda é•œåƒä½¿ç”¨å¸®åŠ©å›½å†…å¯ç”¨Anaconda æºçš„é•œåƒç«™åŠæ¢å›½å†…æºæ–¹æ³•linuxå¯è¡Œ12345conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/conda config --set show_channel_urls yes</content>
	</entry>
	<entry>
		<title>Jupyter_Notebookä»‹ç»ã€å®‰è£…åŠä½¿ç”¨æ•™ç¨‹</title>
		<url>/article/1290.html</url>
		<content>Jupyter Notebookä½¿ç”¨æ•™ç¨‹ç®€ä»‹Jupyter Notebookæ˜¯ä¸€ä¸ªå¼€æºçš„Webåº”ç”¨ç¨‹åºï¼Œå…è®¸ç”¨æˆ·åˆ›å»ºå’Œå…±äº«åŒ…å«ä»£ç ã€æ–¹ç¨‹å¼ã€å¯è§†åŒ–å’Œæ–‡æœ¬çš„æ–‡æ¡£ã€‚å®ƒçš„ç”¨é€”åŒ…æ‹¬ï¼šæ•°æ®æ¸…ç†å’Œè½¬æ¢ã€æ•°å€¼æ¨¡æ‹Ÿã€ç»Ÿè®¡å»ºæ¨¡ã€æ•°æ®å¯è§†åŒ–ã€æœºå™¨å­¦ä¹ ç­‰ç­‰ã€‚å®ƒå…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼šå¯é€‰æ‹©è¯­è¨€ï¼šæ”¯æŒè¶…è¿‡40ç§ç¼–ç¨‹è¯­è¨€ï¼ŒåŒ…æ‹¬Pythonã€Rã€Juliaã€Scalaç­‰ã€‚åˆ†äº«ç¬”è®°æœ¬ï¼šå¯ä»¥ä½¿ç”¨ç”µå­é‚®ä»¶ã€Dropboxã€GitHubå’ŒJupyter Notebook Viewerä¸ä»–äººå…±äº«ã€‚äº¤äº’å¼è¾“å‡ºï¼šä»£ç å¯ä»¥ç”Ÿæˆä¸°å¯Œçš„äº¤äº’å¼è¾“å‡ºï¼ŒåŒ…æ‹¬HTMLã€å›¾åƒã€è§†é¢‘ã€LaTeXç­‰ç­‰ã€‚å¤§æ•°æ®æ•´åˆï¼šé€šè¿‡Pythonã€Rã€Scalaç¼–ç¨‹è¯­è¨€ä½¿ç”¨Apache Sparkç­‰å¤§æ•°æ®æ¡†æ¶å·¥å…·ã€‚æ”¯æŒä½¿ç”¨pandasã€scikit-learnã€ggplot2ã€TensorFlowæ¥æ¢ç´¢åŒä¸€ä»½æ•°æ®ã€‚Jupyter Notebookæ˜¯åŸºäºç½‘é¡µçš„ç”¨äºäº¤äº’è®¡ç®—çš„åº”ç”¨ç¨‹åºã€‚å…¶å¯è¢«åº”ç”¨äºå…¨è¿‡ç¨‹è®¡ç®—ï¼šå¼€å‘ã€æ–‡æ¡£ç¼–å†™ã€è¿è¡Œä»£ç å’Œå±•ç¤ºç»“æœã€‚å®‰è£…ä¸è¿è¡Œ12conda install jupyter notebookpython -m pip install jupyterè¿è¡ŒJupyter Notebookï¼Œé¦–å…ˆcmdè¿›å…¥åˆ°è‡ªå·±çš„å·¥ä½œè·¯å¾„ä¸‹ï¼Œæ‰§è¡Œä»¥ä¸‹çš„å‘½ä»¤1jupyter notebook [--port &lt;port_number&gt;]é»˜è®¤ç«¯å£8888ç¼–è¾‘ç•Œé¢ä¸€ä¸ªnotebookçš„ç¼–è¾‘ç•Œé¢ä¸»è¦ç”±å››éƒ¨åˆ†ç»„æˆï¼šåç§°ã€èœå•æ ã€å·¥å…·æ¡ä»¥åŠå•å…ƒ(Cell)ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼šFileFileä¸­çš„æŒ‰é’®é€‰é¡¹ï¼Œå…·ä½“åŠŸèƒ½å¦‚ä¸‹è¡¨ï¼šEditEditä¸­çš„æŒ‰é’®é€‰é¡¹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šViewViewä¸­çš„æŒ‰é’®é€‰é¡¹å¦‚ä¸‹å›¾æ‰€ç¤ºViewä¸­çš„åŠŸèƒ½å¯ä»¥è®©ç”¨æˆ·æ›´å¥½çš„å±•ç¤ºè‡ªå·±çš„notebookï¼Œä½†å¯¹ç¼–å†™ä»£ç ã€å®ç°åŠŸèƒ½æ²¡æœ‰å½±å“ã€‚Insertåœ¨å½“å‰å•å…ƒä¸Šæ–¹/ä¸‹æ–¹æ’å…¥æ–°çš„å•å…ƒCellCellæŒ‰ESCè¿›å…¥æ— ç¼–è¾‘çŠ¶æ€ï¼ŒESC+Yå’ŒESC+Måˆ‡æ¢cell typeKernelKernelHelpHelpå¿«æ·é”®å‘½ä»¤æ¨¡å¼ä¸‹çš„å¿«æ·é”®ç¼–è¾‘æ¨¡å¼ä¸‹çš„å¿«æ·é”®ä½¿ç”¨æŠ€å·§é­”æ³•å‡½æ•°ä½¿ç”¨é­”æ³•å‡½æ•°å¯ä»¥ç®€å•çš„å®ç°ä¸€äº›å•çº¯pythonè¦å¾ˆéº»çƒ¦æ‰èƒ½å®ç°çš„åŠŸèƒ½ã€‚%ï¼šè¡Œé­”æ³•å‡½æ•°ï¼Œåªå¯¹æœ¬è¡Œä»£ç ç”Ÿæ•ˆã€‚%%ï¼šCellé­”æ³•å‡½æ•°ï¼Œåœ¨æ•´ä¸ªCellä¸­ç”Ÿæ•ˆï¼Œå¿…é¡»æ”¾äºCellé¦–è¡Œã€‚%lsmagicï¼šåˆ—å‡ºæ‰€æœ‰çš„é­”æ³•å‡½æ•°%magicæŸ¥çœ‹å„ä¸ªé­”æ³•å‡½æ•°çš„è¯´æ˜?åé¢åŠ ä¸Šé­”æ³•å‡½æ•°åç§°ï¼Œå¯ä»¥æŸ¥çœ‹è¯¥å‡½æ•°çš„è¯´æ˜ä¸€äº›å¸¸ç”¨é­”æ³•å‡½æ•°çš„ç¤ºä¾‹ï¼šæ³¨æ„è¿™äº›å‘½ä»¤æ˜¯åœ¨Python kernelä¸­é€‚ç”¨çš„ï¼Œå…¶ä»– kernel ä¸ä¸€å®šé€‚ç”¨ã€‚mdç”Ÿæˆç›®å½•ä¸åŒäºæœ‰é“äº‘ç¬”è®°çš„Markdownç¼–è¯‘å™¨ï¼ŒJupyter Notebookæ— æ³•ä¸ºMarkdownæ–‡æ¡£é€šè¿‡ç‰¹å®šè¯­æ³•æ·»åŠ ç›®å½•ï¼Œå› æ­¤éœ€è¦é€šè¿‡å®‰è£…æ‰©å±•æ¥å®ç°ç›®å½•çš„æ·»åŠ ã€‚1conda install -c conda-forge jupyter_contrib_nbextensionsæ‰§è¡Œä¸Šè¿°å‘½ä»¤åï¼Œå¯åŠ¨Jupyter Notebookï¼Œä½ ä¼šå‘ç°å¯¼èˆªæ å¤šäº†â€œNbextensionsâ€çš„ç±»ç›®ï¼Œç‚¹å‡»â€œNbextensionsâ€ï¼Œå‹¾é€‰â€œTable of Contentsâ€Nbextensionsé¡µé¢ä¹‹åå†åœ¨Jupyter Notebookä¸­ä½¿ç”¨Markdownï¼Œç‚¹å‡»ä¸‹å›¾çš„å›¾æ ‡å³å¯ä½¿ç”¨å•¦ã€‚mdé“¾æ¥å¹¶å®šä½è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š12[æ·»åŠ é“¾æ¥çš„æ­£æ–‡](#è‡ªå®šä¹‰ç´¢å¼•è¯)&lt;a id=è‡ªå®šä¹‰ç´¢å¼•è¯&gt;è·³è½¬æç¤º&lt;/a&gt;åŠ è½½æŒ‡å®šç½‘é¡µæºä»£ç 1%load URLåŠ è½½æœ¬åœ°Pythonæ–‡ä»¶1%load Pythonæ–‡ä»¶çš„ç»å¯¹è·¯å¾„è¿è¡Œæœ¬åœ°Pythonæ–‡ä»¶12%run Pythonæ–‡ä»¶çš„ç»å¯¹è·¯å¾„!python Pythonæ–‡ä»¶çš„ç»å¯¹è·¯å¾„è·å–å½“å‰ä½ç½®1%pwdä½¿ç”¨shellå‘½ä»¤1!shellå‘½ä»¤åœ¨Jupyter Notebookä¸­çš„ç¬”è®°æœ¬å•å…ƒæ ¼ä¸­ç”¨è‹±æ–‡æ„Ÿå¹å·â€œ!â€åæ¥shellå‘½ä»¤å³å¯æ‰§è¡Œshellå‘½ä»¤ã€‚ç”±äºç›®å‰æš‚æ—¶ç”¨ä¸åˆ°è¿‡å¤šçš„é­”æœ¯å‘½ä»¤ï¼Œå› æ­¤æš‚æ—¶å…ˆå‚è€ƒå®˜ç½‘çš„æ–‡æ¡£ã€‚å‚è€ƒJupyter Notebookä»‹ç»ã€å®‰è£…åŠä½¿ç”¨æ•™ç¨‹æœ€è¯¦å°½ä½¿ç”¨æŒ‡å—ï¼šè¶…å¿«ä¸Šæ‰‹Jupyter Notebook</content>
	</entry>
	<entry>
		<title>elementary_osè®°å½•</title>
		<url>/article/53484.html</url>
		<content>Elementary osä»‹ç»ç¡¬ç›˜æ ¼å¼è½¬æ¢åœ¨MBRç¡¬ç›˜ä¸­ï¼Œåˆ†åŒºä¿¡æ¯ç›´æ¥å­˜å‚¨äºä¸»å¼•å¯¼è®°å½•ï¼ˆMBRï¼‰ä¸­ï¼ˆä¸»å¼•å¯¼è®°å½•ä¸­è¿˜å­˜å‚¨ç€ç³»ç»Ÿçš„å¼•å¯¼ç¨‹åºï¼‰ã€‚ä½†åœ¨GPTç¡¬ç›˜ä¸­ï¼Œåˆ†åŒºè¡¨çš„ä½ç½®ä¿¡æ¯å‚¨å­˜åœ¨GPTå¤´ä¸­ã€‚ä½†å‡ºäºå…¼å®¹æ€§è€ƒè™‘ï¼Œç¡¬ç›˜çš„ç¬¬ä¸€ä¸ªæ‰‡åŒºä»ç„¶ç”¨ä½œMBRï¼Œä¹‹åæ‰æ˜¯GPTå¤´ã€‚è·Ÿç°ä»£çš„MBRä¸€æ ·ï¼ŒGPTä¹Ÿä½¿ç”¨é€»è¾‘åŒºå—åœ°å€ï¼ˆLBAï¼‰å–ä»£äº†æ—©æœŸçš„CHSå¯»å€æ–¹å¼ã€‚ä¼ ç»ŸMBRä¿¡æ¯å­˜å‚¨äºLBA 0ï¼ŒGPTå¤´å­˜å‚¨äºLBA 1ï¼Œæ¥ä¸‹æ¥æ‰æ˜¯åˆ†åŒºè¡¨æœ¬èº«ã€‚64ä½Windowsæ“ä½œç³»ç»Ÿä½¿ç”¨16,384å­—èŠ‚ï¼ˆæˆ–32æ‰‡åŒºï¼‰ä½œä¸ºGPTåˆ†åŒºè¡¨ï¼Œæ¥ä¸‹æ¥çš„LBA 34æ˜¯ç¡¬ç›˜ä¸Šç¬¬ä¸€ä¸ªåˆ†åŒºçš„å¼€å§‹ã€‚GPTæ˜¯ä¸ºäº†æ”¯æŒ2TBä»¥ä¸Šç¡¬ç›˜è€Œå‘å±•çš„ã€‚è€Œä¸”GPTçš„åˆ†åŒºä¿¡æ¯æ˜¯åœ¨åˆ†åŒºä¸­ï¼Œè€Œä¸è±¡MBRä¸€æ ·åœ¨ä¸»å¼•å¯¼æ‰‡åŒºï¼Œä¸ºä¿æŠ¤GPT ä¸å—MBRç±»ç£ç›˜ç®¡ç†è½¯ä»¶çš„å±å®³ï¼ŒGPTåœ¨ä¸»å¼•å¯¼æ‰‡åŒºå»ºç«‹äº†ä¸€ä¸ªä¿æŠ¤åˆ†åŒº (Protective MBR)çš„MBRåˆ†åŒºè¡¨ï¼Œè¿™ç§åˆ†åŒºçš„ç±»å‹æ ‡è¯†ä¸º0xEEï¼Œè¿™ä¸ªä¿æŠ¤åˆ†åŒºçš„å¤§å°åœ¨Windowsä¸‹ä¸º128MBï¼ŒMac OS Xä¸‹ä¸º200MBï¼Œåœ¨Windowç£ç›˜ç®¡ç†å™¨é‡Œåä¸ºGPTä¿æŠ¤åˆ†åŒºï¼Œå¯è®©MBRç±»ç£ç›˜ç®¡ç†è½¯ä»¶æŠŠGPTçœ‹æˆä¸€ä¸ªæœªçŸ¥æ ¼å¼çš„åˆ†åŒºï¼Œè€Œä¸æ˜¯é”™è¯¯åœ°å½“æˆä¸€ä¸ªæœªåˆ†åŒºçš„ç£ç›˜ã€‚è½¬æ¢ä½¿ç”¨Diskpartå‘½ä»¤å³å¯å®Œæˆï¼Œæ–¹æ³•å¦‚ä¸‹ï¼šæŒ‰Shift + F10æ‰“å¼€å‘½ä»¤æç¤ºç¬¦è¾“å…¥â€Diskpartâ€(ä¸ç”¨è¾“å…¥å¼•å·ï¼Œä¸‹åŒ)ï¼Œå¹¶æŒ‰å›è½¦ï¼Œè¿›å…¥æ“ä½œç•Œé¢è¾“å…¥ï¼šâ€list diskâ€ï¼ŒæŸ¥çœ‹ç£ç›˜ä¿¡æ¯ã€‚æ³¨æ„çœ‹ç£ç›˜å®¹é‡æ¥é€‰æ‹©è¾“å…¥ï¼šâ€select disk 0â€ï¼Œé€‰æ‹©disk 0ä¸ºå½“å‰æ“ä½œçš„ç£ç›˜ï¼Œè¿™é‡Œè§†ä½ éœ€è¦çš„è½¬æ¢ç›˜ç¬¦ï¼Œä¸€èˆ¬ä¸ºå®‰è£…ç³»ç»Ÿçš„é‚£å—ç‰©ç†ç¡¬ç›˜è¾“å…¥ï¼šâ€Cleanâ€ï¼Œæ¸…ç©ºå½“å‰ç£ç›˜åˆ†åŒºè¾“å…¥ï¼šâ€convert mbrâ€ï¼Œè½¬æ¢ä¸ºMBRåˆ†åŒºï¼Œè¿˜æœ‰gptæ ¼å¼æ“ä½œå®Œæˆï¼Œç”¨exitå‘½ä»¤å…³é—­æç¤ºç¬¦çª—å£ï¼Œç»§ç»­æŒ‰ç…§æ­£å¸¸çš„æ–¹æ³•å®‰è£…ç³»ç»Ÿå³å¯ åŒç³»ç»Ÿå®‰è£…åˆ¶ä½œå¯åŠ¨ç›˜ç©ºç™½åˆ†åŒºtfæŒ‰F2è¿›å…¥BIOSï¼Œè®¾ç½®Uç›˜å¯åŠ¨é‡å¯å®‰è£…ç±»åˆ«ï¼Œè¿™é‡Œé€‰something elseï¼Œè¡¨ç¤ºè‡ªå·±é€‰åˆ†åŒºï¼ˆå¦‚æœæ˜¯åˆšè£…å®Œwin10ï¼Œç«‹é©¬è£…linuxï¼Œå¯ä»¥é€‰ç¬¬ä¸€ä¸ªï¼‰è¿™é‡Œæ˜¯å› ä¸ºï¼ŒåŸå…ˆå°±æ˜¯win10+linuxï¼Œç°åœ¨æƒ³é‡è£…linuxé€‰æ‹©äº‹å…ˆåˆ†å¥½çš„åˆ†åŒºæ­£å¼å¼€å§‹å®‰è£…è½¯ä»¶å®‰è£…å®‰è£…typora12345678910# or run:# sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys BA300B7755AFCFAEwget -qO - https://typora.io/linux/public-key.asc | sudo apt-key add -# add Typora's repositorysudo add-apt-repository 'deb https://typora.io/linux ./'sudo apt-get update# install typorasudo apt-get install typoraæ˜¾å¡é©±åŠ¨Ubuntu 18.04 å®‰è£… NVIDIA æ˜¾å¡é©±åŠ¨æˆ‘ä»¬ä»Šå¤©çš„ç›®æ ‡æ˜¯åœ¨ Ubuntu 18.04 ä¸Šå®‰è£… NVIDIA æ˜¾å¡é©±åŠ¨ï¼Œè¯·æ³¨æ„ï¼Œä½ çš„æ˜¾å¡ä¸€å®šè¦æ˜¯ NVIDIA çš„æ˜¾å¡æ‰èƒ½æŒ‰ç…§è¿™ç¯‡æ–‡ç« çš„æ–¹æ³•å®‰è£…ã€‚æˆ‘å°†ç»™å¤§å®¶ä»‹ç»ä¸‰ç§å®‰è£…æ–¹æ³•ï¼Œå»ºè®®ä½¿ç”¨ç¬¬ä¸€ç§æ–¹æ³•å®‰è£…ã€‚å…ˆæ¥è¯´è¯´å¸¦æœ‰ NVIDIA ç‹¬ç«‹æ˜¾å¡çš„ç”µè„‘ä¸ºä»€ä¹ˆè¦å®‰è£… NVIDIA æ˜¾å¡é©±åŠ¨å§ã€‚ä¸‹é¢æ˜¯æˆ‘ä»ç»´åŸºç™¾ç§‘æ‘˜æŠ„çš„æ˜¾å¡å·¥ä½œåŸç†çš„ä»‹ç»ï¼šæ˜¾å¡æ˜¯æ’åœ¨ä¸»æ¿ä¸Šçš„æ‰©å±•æ§½é‡Œçš„ï¼ˆç°åœ¨ä¸€èˆ¬æ˜¯ PCI-E æ’æ§½ï¼Œæ­¤å‰è¿˜æœ‰ AGPã€PCIã€ISA ç­‰æ’æ§½ï¼‰ã€‚å®ƒä¸»è¦è´Ÿè´£æŠŠä¸»æœºå‘æ˜¾ç¤ºå™¨å‘å‡ºçš„æ˜¾ç¤ºä¿¡å·è½¬åŒ–ä¸ºä¸€èˆ¬ç”µå™¨ä¿¡å·ï¼Œä½¿å¾—æ˜¾ç¤ºå™¨èƒ½æ˜ç™½ä¸ªäººè®¡ç®—æœºåœ¨è®©å®ƒåšä»€ä¹ˆã€‚æ˜¾å¡çš„ä¸»è¦èŠ¯ç‰‡å«â€œæ˜¾ç¤ºèŠ¯ç‰‡â€ï¼ˆVideo chipsetï¼Œä¹Ÿå« GPU æˆ– VPUï¼Œå›¾å½¢å¤„ç†å™¨æˆ–è§†è§‰å¤„ç†å™¨ï¼‰ï¼Œæ˜¯æ˜¾å¡çš„ä¸»è¦å¤„ç†å•å…ƒã€‚æ˜¾å¡ä¸Šä¹Ÿæœ‰å’Œè®¡ç®—æœºå­˜å‚¨å™¨ç›¸ä¼¼çš„å­˜å‚¨å™¨ï¼Œç§°ä¸ºâ€œæ˜¾ç¤ºå­˜å‚¨å™¨â€ï¼Œç®€ç§°æ˜¾å­˜ã€‚æ—©æœŸçš„æ˜¾å¡åªæ˜¯å•çº¯æ„ä¹‰çš„æ˜¾å¡ï¼Œåªèµ·åˆ°ä¿¡å·è½¬æ¢çš„ä½œç”¨ï¼›å½“å‰æˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨çš„æ˜¾å¡éƒ½å¸¦æœ‰ 3D ç”»é¢è¿ç®—å’Œå›¾å½¢åŠ é€ŸåŠŸèƒ½ï¼Œæ‰€ä»¥ä¹Ÿå«åšâ€œå›¾å½¢åŠ é€Ÿå¡â€æˆ–â€œ3D åŠ é€Ÿå¡â€ã€‚PC ä¸Šæœ€æ—©çš„æ˜¾å¡æ˜¯ IBM åœ¨ 1981 å¹´æ¨å‡ºçš„ 5150 ä¸ªäººè®¡ç®—æœºä¸Šæ‰€æ­è½½çš„ MDA å’Œ CGA ä¸¤æ¬¾ 2D åŠ é€Ÿå¡ã€‚æ˜¾å¡é€šå¸¸ç”±æ€»çº¿æ¥å£ã€PCB æ¿ã€æ˜¾ç¤ºèŠ¯ç‰‡ã€æ˜¾å­˜ã€RAMDACã€VGA BIOSã€VGA åŠŸèƒ½æ’é’ˆã€D-sub æ’åº§åŠå…¶ä»–å¤–å›´ç»„ä»¶æ„æˆï¼Œç°åœ¨çš„æ˜¾å¡å¤§å¤šè¿˜å…·æœ‰ VGAã€DVI æ˜¾ç¤ºå™¨æ¥å£æˆ–è€… HDMI æ¥å£åŠ S-Video ç«¯å­å’Œ Display Port æ¥å£ã€‚ç”µè„‘ç¡¬ä»¶æœ‰ NVIDIA çš„æ˜¾å¡ï¼Œä½†æ˜¯æ²¡æœ‰é©±åŠ¨ï¼Œé‚£å®ƒæ˜¯ä¸èƒ½å·¥ä½œçš„ï¼Œæ‰€ä»¥ä¸ºäº†è®©æ˜¾å¡èƒ½å¤Ÿå·¥ä½œï¼Œå‘æŒ¥å®ƒçš„ä½œç”¨ï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…æ˜¾å¡é©±åŠ¨ã€‚å¥½çš„ï¼Œä¸‹é¢æ¥çœ‹çœ‹ä¸‰ç§ä¸åŒçš„å®‰è£…æ–¹æ³•å§ã€‚ç¨³å®šç‰ˆæœ¬å®‰è£…æ˜¾å¡å‹å·åœ¨ç»ˆç«¯è¾“å…¥ï¼šubuntu-drivers devicesï¼Œå¯ä»¥çœ‹åˆ°å¦‚ä¸‹ç•Œé¢ï¼šä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œæˆ‘çš„æ˜¾å¡æ˜¯ï¼šGM107M [GeForce GTX 860M]ï¼Œæ¨èå®‰è£…çš„ç‰ˆæœ¬å·æ˜¯ï¼šnvidia-driver-390 - distro non-free recommendedã€‚å¼€å§‹å®‰è£…å¦‚æœåŒæ„å®‰è£…æ¨èç‰ˆæœ¬ï¼Œé‚£æˆ‘ä»¬åªéœ€è¦ç»ˆç«¯è¾“å…¥ï¼šsudo ubuntu-drivers autoinstall å°±å¯ä»¥è‡ªåŠ¨å®‰è£…äº†ã€‚å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ apt å‘½ä»¤å®‰è£…è‡ªå·±æƒ³è¦å®‰è£…çš„ç‰ˆæœ¬ï¼Œæ¯”å¦‚æˆ‘æƒ³å®‰è£… 340 è¿™ä¸ªç‰ˆæœ¬å·çš„ç‰ˆæœ¬ï¼Œç»ˆç«¯è¾“å…¥ï¼šsudo apt install nvidia-340 å°±è‡ªåŠ¨å®‰è£…äº†ã€‚å®‰è£…è¿‡ç¨‹ä¸­æŒ‰ç…§æç¤ºæ“ä½œï¼Œé™¤éä½ çŸ¥é“æ¯ä¸ªæç¤ºçš„çœŸå®å«ä¹‰ï¼Œå¦åˆ™æ‰€æœ‰çš„æç¤ºéƒ½é€‰æ‹©é»˜è®¤å°±å¯ä»¥äº†ï¼Œå®‰è£…å®Œæˆåé‡å¯ç³»ç»Ÿï¼ŒNVIDIA æ˜¾å¡å°±å¯ä»¥æ­£å¸¸å·¥ä½œäº†ã€‚å®‰è£…å®Œæˆåä½ å¯ä»¥å‚ç…§ https://linuxconfig.org/benchmark-your-graphics-card-on-linux ä¸Šçš„ä»‹ç»æµ‹è¯•ä½ çš„æ˜¾å¡ã€‚ppaç¬¬ä¸‰æ–¹ä½¿ç”¨ PPA ç¬¬ä¸‰æ–¹è½¯ä»¶ä»“åº“å®‰è£…æœ€æ–°ç‰ˆæœ¬æ·»åŠ  PPA è½¯ä»¶ä»“åº“ï¼šsudo add-apt-repository ppa:graphics-drivers/ppaï¼Œéœ€è¦è¾“å…¥ç”¨æˆ·å¯†ç ï¼ŒæŒ‰ç…§æç¤ºè¿˜éœ€è¦æŒ‰ä¸‹ Enter é”®ã€‚æ›´æ–°è½¯ä»¶ç´¢å¼•ï¼šsudo apt updateæ¥ä¸‹æ¥çš„æ­¥éª¤åŒæ–¹æ³•ä¸€ï¼Œåªæ˜¯è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€‰æ‹©å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„é©±åŠ¨ç¨‹åºäº†ã€‚NVIDIAå®˜ç½‘å®‰è£…æ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥ï¼šlshw -numeric -C displayï¼Œç¡®è®¤è‡ªå·±ç”µè„‘æ˜¾å¡çš„å‹å·ï¼Œå¦‚ä¸‹å›¾ï¼šä»ä¸Šå›¾å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘çš„ç”µè„‘çš„æ˜¾å¡æ˜¯ product: GM107M [GeForce GTX 860M] [10DE:1392]ï¼Œç„¶åæˆ‘ä»¬åˆ° NVIDIA çš„å®˜ç½‘ä¸‹è½½ç›¸åº”å‹å·çš„é©±åŠ¨ï¼Œå®˜ç½‘åœ°å€æ˜¯ï¼šhttps://www.nvidia.com/Download/index.aspxï¼Œå¦‚ä¸‹å›¾ï¼Œæˆ‘é€‰æ‹© GTX 860 æ˜¾å¡çš„é©±åŠ¨ä¸‹è½½ã€‚æ³¨æ„æ¯ä¸ªé€‰é¡¹ï¼Œç‰¹åˆ«æ˜¯æ“ä½œç³»ç»Ÿé‚£é‡Œï¼Œä¸€å®šé€‰æ‹© Linux 64-bité€‰å¥½åç‚¹å‡» SEARCH æŒ‰é’®æœç´¢ç›¸åº”çš„é©±åŠ¨ï¼Œå¦‚ä¸‹å›¾ï¼šçœ‹åˆ°äº†å§ï¼Œå®˜æ–¹æœ€æ–°ç‰ˆæœ¬å·å·²ç»æ˜¯ 418.43 äº†ã€‚ç‚¹å‡» DOWNLOAD æŒ‰é’®ä¸‹è½½å§ã€‚æ¥ç€éœ€è¦å…ˆå®‰è£…ä¸€äº› NVIDIA æ˜¾å¡ä¾èµ–çš„è½¯ä»¶ï¼Œåœ¨ç»ˆç«¯ä¾æ¬¡æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼šsudo dpkg --add-architecture i386sudo apt updatesudo apt install build-essential libc6:i386Ubuntu ç³»ç»Ÿé»˜è®¤å®‰è£…å¥½æ˜¯ä½¿ç”¨çš„ä¸€ä¸ªå¼€æºçš„é©±åŠ¨ï¼šnouveauï¼Œæˆ‘ä»¬è¦å®‰è£…å®˜æ–¹çš„é©±åŠ¨éœ€è¦å…ˆç¦ç”¨è¿™ä¸ªå¼€æºé©±åŠ¨ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼Œä¾æ¬¡æ‰§è¡Œï¼šsudo bash -c &quot;echo blacklist nouveau &gt; /etc/modprobe.d/blacklist-nvidia-nouveau.conf&quot;sudo bash -c &quot;echo options nouveau modeset=0 &gt;&gt; /etc/modprobe.d/blacklist-nvidia-nouveau.conf&quot;æ‰§è¡Œå®Œä¸Šé¢ä¸¤æ¡æŒ‡ä»¤åï¼Œæˆ‘ä»¬ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤çœ‹çœ‹æ˜¯å¦æˆåŠŸç¦ç”¨äº†å¼€æºé©±åŠ¨ï¼šcat /etc/modprobe.d/blacklist-nvidia-nouveau.confã€‚å¦‚æœå’Œä¸‹é¢ä¸€æ ·ï¼Œè¡¨ç¤ºæˆåŠŸäº†ã€‚123$ cat /etc/modprobe.d/blacklist-nvidia-nouveau.confblacklist nouveauoptions nouveau modeset=0è¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦å…ˆé‡å¯ä¸€ä¸‹ç³»ç»Ÿï¼Œé‡å¯å§ã€‚é‡å¯æˆåŠŸåæ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼šsudo telinit 3ã€‚ç„¶åæŒ‰å¿«æ·é”®ï¼šCTRL+ALT+F1 è¿›å…¥å­—ç¬¦ç•Œé¢ï¼Œè¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼Œç„¶åç™»å½•ç³»ç»Ÿï¼Œè¿›å…¥æˆ‘ä»¬ä¿å­˜ä¸‹è½½ NVIDIA é©±åŠ¨çš„ç›®å½•ï¼Œé»˜è®¤æ˜¯ï¼šDownloads/ ç›®å½•ï¼Œcd Downloads/ï¼Œç„¶åæ‰§è¡Œï¼šbash NVIDIA-Linux-x86_64-418.43.binã€‚æ³¨æ„ï¼šNVIDIA-Linux-x86_64-418.43.bin è¦æ ¹æ®ä½ ä¸‹è½½çš„é©±åŠ¨æ–‡ä»¶çš„åå­—ç›¸åº”æ”¹åŠ¨ã€‚å®‰è£…è¿‡ç¨‹ä¸­éƒ½ç‚¹åŒæ„å³å¯ï¼Œå¦‚æœä½ é‡åˆ°ä¸‹é¢çš„æç¤ºï¼Œå®‰è£…ä¸‹é¢æˆ‘çš„è¾“å…¥è¾“å…¥åå›è½¦ç»§ç»­å®‰è£…ï¼šThe distribution-provided pre-install script failed!Are you sure you want to continue? -&gt; CONTINUE INSTALLATIONWould you like to run the nvidia-xconfig utility? -&gt; YESå®‰è£…å®Œæˆåé‡å¯ç³»ç»Ÿå°±å¯ä»¥ç‚¹å‡»è½¯ä»¶åˆ—è¡¨ä¸­çš„ NVIDIA çš„é…ç½®è½¯ä»¶é…ç½®æ˜¾å¡é©±åŠ¨äº†ï¼Œå¦‚æœä½ é‡åˆ°å¦‚ä¸‹æŠ¥é”™ï¼Œè¯·ä¾æ¬¡åœ¨ç»ˆç«¯è¾“å…¥å¦‚ä¸‹å‘½ä»¤è§£å†³ï¼šæŠ¥é”™ï¼šWARNING: Unable to find suitable destination to install 32-bit compatibility librariesè§£å†³åŠæ³•ï¼šsudo dpkg â€”add-architecture i386sudo apt updatesudo apt install libc6:i386å¥½äº†ï¼Œä»Šå¤©åˆ†äº«äº†å¦‚ä½•å®‰è£… NVIDIA æ˜¾å¡é©±åŠ¨ï¼Œå†æ¬¡æé†’ï¼Œå¦‚æœä½ çš„æ˜¾å¡ä¸æ˜¯ NVIDIA æ˜¾å¡ï¼Œåƒä¸‡ä¸è¦è¿™ä¹ˆå¹²ï¼Œä¹Ÿä¸è¦åœ¨è™šæ‹Ÿæœºä¸­è¿™ä¹ˆå¹²ã€‚elasticsearch6eså’Œkibanaç‰ˆæœ¬ElasticsearchKibanaX-PackBeats^*Logstash^*ES-Hadoop (jar)*APM ServerApp Search5.0.x5.0.x5.0.x1.3.x-5.6.x2.4.x-5.6.x5.0.x-5.6.x5.1.x5.1.x5.1.x1.3.x-5.6.x2.4.x-5.6.x5.0.x-5.6.x5.2.x5.2.x5.2.x1.3.x-5.6.x2.4.x-5.6.x5.0.x-5.6.x5.3.x5.3.x5.3.x1.3.x-5.6.x2.4.x-5.6.x5.0.x-5.6.x5.4.x5.4.x5.4.x1.3.x-5.6.x2.4.x-5.6.x5.0.x-5.6.x5.5.x5.5.x5.5.x1.3.x-5.6.x2.4.x-5.6.x5.0.x-5.6.x5.6.x5.6.x5.6.x1.3.x-6.0.x2.4.x-6.0.x5.0.x-6.0.x6.0.x6.0.x6.0.x5.6.x-6.8.x5.6.x-6.8.x6.0.x-6.8.x6.1.x6.1.x6.1.x5.6.x-6.8.x5.6.x-6.8.x6.0.x-6.8.x6.2.x6.2.x6.2.x5.6.x-6.8.x5.6.x-6.8.x6.0.x-6.8.x6.2.x-6.8.x6.3.x6.3.xN/A**5.6.x-6.8.x5.6.x-6.8.x6.0.x-6.8.x6.2.x-6.8.x6.4.x6.4.xN/A**5.6.x-6.8.x5.6.x-6.8.x6.0.x-6.8.x6.2.x-6.8.x6.5.x6.5.xN/A**5.6.x-6.8.x5.6.x-6.8.x6.0.x-6.8.x6.2.x-6.8.x6.6.x6.6.xN/A**5.6.x-6.8.x5.6.x-6.8.x6.0.x-6.8.x6.2.x-6.8.x6.7.x6.7.xN/A**5.6.x-6.8.x5.6.x-6.8.x6.0.x-6.8.x6.2.x-6.8.x6.8.x6.8.xN/A**5.6.x-6.8.x5.6.x-6.8.x6.0.x-6.8.x6.2.x-6.8.x7.0.x7.0.xN/A**6.8.x-7.4.x6.8.x-7.4.x6.8.x-7.4.x7.0.x-7.4.x*7.1.x7.1.xN/A**6.8.x-7.4.x6.8.x-7.4.x6.8.x-7.4.x7.0.x-7.4.x*7.2.x7.2.xN/A**6.8.x-7.4.x6.8.x-7.4.x6.8.x-7.4.x7.0.x-7.4.x*7.2.x7.3.x7.3.xN/A**6.8.x-7.4.x6.8.x-7.4.x6.8.x-7.4.x7.0.x-7.4.x*7.3.x7.4.x7.4.xN/A**6.8.x-7.4.x6.8.x-7.4.x6.8.x-7.4.x7.0.x-7.4.x*7.4.xkibanaå›½å†…ä¸‹è½½åœ°å€jdkç¯å¢ƒå®‰è£…åœ¨ /etc/profile æ–‡ä»¶ä¸‹æ·»åŠ ä»¥ä¸‹é…ç½®12345# jdk configJAVA_HOME=/usr/java/jdk1.8.0_241-amd64JRE_HOME=/usr/java/jdk1.8.0_241-amd64/jreexport CLASSPATH=.:$JAVA_HOME/lib:$JRE_HOME/lib:$CLASSPATH  export PATH=$JAVA_HOME/bin:$JRE_HOME/bin:$PATHæ–°å»ºç”¨æˆ·123456sudo mkdir /home/user_group/sudo groupadd user_groupsudo useradd elasticsearch -g user_group -p elasticsearchpasswd elasticsearchesesä¸èƒ½ä½¿ç”¨TABé”®ã€ä¸Šä¸‹é”®ï¼Œå‘½ä»¤è¡Œä¸æ˜¾ç¤ºå½“å‰è·¯å¾„çš„è§£å†³å› é»˜è®¤ubuntuåˆ›å»ºçš„æ™®é€šå¸å·ï¼Œé»˜è®¤shellä¸º/bin/shï¼Œè€Œè¿™ä¸æ”¯æŒtabç­‰é”®çš„ï¼Œæ‰€ä»¥å°†ã€ŒæŒ‡å®šç”¨æˆ·ã€å¸å·çš„shellæ”¹ä¸º/bin/bashå°±å¯ä»¥äº†ã€‚123&gt;&gt;&gt; echo $SHELL/bin/sh&gt;&gt;&gt; usermod -s /bin/bash ç”¨æˆ·åesé…ç½®è§£å‹åè¿›å…¥ç›®å½•ï¼Œé…ç½®elasticsearchå†…å¤–ç½‘å¯è®¿é—®ä»¥åŠç«¯å£ç»‘å®š12cd elasticsearch-6.8.7vi ./config/elasticsearch.ymlåœ¨æœ€åé¢åŠ ä¸Š12network.host: 0.0.0.0http.port: 9200ä¿å­˜é€€å‡ºï¼Œè¿™ä¸ªæ—¶å€™ç›´æ¥è¿è¡Œ ./bin/elasticsearchä¼šæŠ¥é”™1bound or publishing to a non-loopback address, enforcing bootstrap checksé‡æ–°åˆ‡å›rootç”¨æˆ·1su rootç¼–è¾‘ /etc/security/limits.confï¼Œè¿½åŠ ä»¥ä¸‹å†…å®¹12* soft nofile 65536* hard nofile 65536æ­¤æ–‡ä»¶ä¿®æ”¹åéœ€è¦é‡æ–°ç™»å½•ç”¨æˆ·ï¼Œæ‰ä¼šç”Ÿæ•ˆç¼–è¾‘ /etc/sysctl.confï¼Œè¿½åŠ ä»¥ä¸‹å†…å®¹ï¼š1vm.max_map_count=655360ä¿å­˜åï¼Œæ‰§è¡Œï¼š1sysctl -på¯åŠ¨åˆ‡å›æ–°å»ºçš„ç”¨æˆ·å›åˆ°elasticsearchç›®å½•ä¸‹12345678910111213141516elasticsearch@hyc:/media/hyc/linux/elementary os/software/elasticsearch-6.7.1$ source /etc/profileelasticsearch@hyc:/media/hyc/linux/elementary os/software/elasticsearch-6.7.1$ echo $JAVA_HOME/usr/java/jdk1.8.0_241-amd64elasticsearch@hyc:/media/hyc/linux/elementary os/software/elasticsearch-6.7.1$ ./bin/elasticsearchwarning: Falling back to java on path. This behavior is deprecated. Specify JAVA_HOME[2020-08-08T13:14:40,834][INFO ][o.e.e.NodeEnvironment    ] [EsTp_cx] using [1] data paths, mounts [[/media/hyc/linux (/dev/sdb6)]], net usable_space [545.8gb], net total_space [999.9gb], types [fuseblk][2020-08-08T13:14:40,836][INFO ][o.e.e.NodeEnvironment    ] [EsTp_cx] heap size [989.8mb], compressed ordinary object pointers [true][2020-08-08T13:14:40,839][INFO ][o.e.n.Node               ] [EsTp_cx] node name derived from node ID [EsTp_cxdSjehAblsJRe8tA]; set [node.name] to override[2020-08-08T13:14:40,840][INFO ][o.e.n.Node               ] [EsTp_cx] version[6.7.1], pid[934], build[default/tar/2f32220/2019-04-02T15:59:27.961366Z], OS[Linux/5.4.0-42-generic/amd64], JVM[Oracle Corporation/Java HotSpot(TM) 64-Bit Server VM/1.8.0_241/25.241-b07][2020-08-08T13:14:40,840][INFO ][o.e.n.Node               ] [EsTp_cx] JVM arguments [-Xms1g, -Xmx1g, -XX:+UseConcMarkSweepGC, -XX:CMSInitiatingOccupancyFraction=75, -XX:+UseCMSInitiatingOccupancyOnly, -Des.networkaddress.cache.ttl=60, -Des.networkaddress.cache.negative.ttl=10, -XX:+AlwaysPreTouch, -Xss1m, -Djava.awt.headless=true, -Dfile.encoding=UTF-8, -Djna.nosys=true, -XX:-OmitStackTraceInFastThrow, -Dio.netty.noUnsafe=true, -Dio.netty.noKeySetOptimization=true, -Dio.netty.recycler.maxCapacityPerThread=0, -Dlog4j.shutdownHookEnabled=false, -Dlog4j2.disable.jmx=true, -Djava.io.tmpdir=/tmp/elasticsearch-5133240268811839837, -XX:+HeapDumpOnOutOfMemoryError, -XX:HeapDumpPath=data, -XX:ErrorFile=logs/hs_err_pid%p.log, -XX:+PrintGCDetails, -XX:+PrintGCDateStamps, -XX:+PrintTenuringDistribution, -XX:+PrintGCApplicationStoppedTime, -Xloggc:logs/gc.log, -XX:+UseGCLogFileRotation, -XX:NumberOfGCLogFiles=32, -XX:GCLogFileSize=64m, -Des.path.home=/media/hyc/linux/elementary os/software/elasticsearch-6.7.1, -Des.path.conf=/media/hyc/linux/elementary os/software/elasticsearch-6.7.1/config, -Des.distribution.flavor=default, -Des.distribution.type=tar][2020-08-08T13:14:42,612][INFO ][o.e.p.PluginsService     ] [EsTp_cx] loaded module [aggs-matrix-stats][2020-08-08T13:14:42,613][INFO ][o.e.p.PluginsService     ] [EsTp_cx] loaded module [analysis-common]ï¼ï¼ï¼ï¼ï¼ï¼ï¼[2020-08-08T13:14:51,868][INFO ][o.e.c.m.MetaDataIndexTemplateService] [EsTp_cx] adding template [.monitoring-alerts] for index patterns [.monitoring-alerts-6][2020-08-08T13:14:51,942][INFO ][o.e.c.m.MetaDataIndexTemplateService] [EsTp_cx] adding template [.monitoring-kibana] for index patterns [.monitoring-kibana-6-*][2020-08-08T13:14:52,103][INFO ][o.e.l.LicenseService     ] [EsTp_cx] license [08975435-c155-421d-ae6f-290e44abae0b] mode [basic] - validåå°å¯åŠ¨1./bin/elasticsearch -dè®¿é—®http://192.168.0.102:9200/1234567891011121314151617{  &quot;name&quot; : &quot;EsTp_cx&quot;,  &quot;cluster_name&quot; : &quot;elasticsearch&quot;,  &quot;cluster_uuid&quot; : &quot;TKaUQKssQlODq4xfwdaQ1Q&quot;,  &quot;version&quot; : {    &quot;number&quot; : &quot;6.7.1&quot;,    &quot;build_flavor&quot; : &quot;default&quot;,    &quot;build_type&quot; : &quot;tar&quot;,    &quot;build_hash&quot; : &quot;2f32220&quot;,    &quot;build_date&quot; : &quot;2019-04-02T15:59:27.961366Z&quot;,    &quot;build_snapshot&quot; : false,    &quot;lucene_version&quot; : &quot;7.7.0&quot;,    &quot;minimum_wire_compatibility_version&quot; : &quot;5.6.0&quot;,    &quot;minimum_index_compatibility_version&quot; : &quot;5.0.0&quot;  },  &quot;tagline&quot; : &quot;You Know, for Search&quot;}kibanaå®‰è£…è®¾ç½®kibanaç¯å¢ƒå˜é‡12345sudo gedit /etc/profile æ·»åŠ KIBANA_HOME=/home/tq/kibana-5.6.5-linux-x86_64PATH=$KIBANA_HOME:$PATHexport KIBANA_HOMEè¿è¡Œkibana1./bin/kibanaè®¿é—®kibanahttp://127.0.0.1:5601å®‰è£…headä¿®æ”¹elasticsearch.ymlï¼Œå¢åŠ è·¨åŸŸçš„é…ç½®(éœ€è¦é‡å¯esæ‰èƒ½ç”Ÿæ•ˆ)12345vi /etc/elasticsearch/elasticsearch.yml# åŠ å…¥é…ç½®:http.cors.enabled: truehttp.cors.allow-origin: &quot;*&quot;ä¿®æ”¹Gruntfile.jsæ–‡ä»¶ï¼Œä¿®æ”¹æœåŠ¡ç›‘å¬åœ°å€ï¼ˆå¢åŠ hostnameå±æ€§ï¼Œå°†å…¶å€¼è®¾ç½®ä¸ºâ€™0.0.0.0â€™ï¼‰92è¡Œæ·»åŠ ï¼šhostname:â€™0.0.0.0â€™,12345678910111213141516171819202122232425watch: {&quot;scripts&quot;: {files: ['src/**/*', 'test/spec/*' ],tasks: ['default'],options: {spawn: false}},&quot;grunt&quot;: {files: [ 'Gruntfile.js' ]}},connect: {server: {options: {hostname:'0.0.0.0',port: 9100,base: '.',keepalive: true}}}});grunt.loadNpmTasks('grunt-contrib-clean');è¿œç¨‹æ¡Œé¢rdesktopé¦–å…ˆå®‰è£…rdesktopå·¥å…·1kevin@bobo:~$ sudo apt-get install rdesktopé»˜è®¤ç«¯å£æ˜¯3389æ³¨æ„ï¼šè¿œç¨‹windowsæœºå™¨çš„æœåŠ¡ä¸­çš„ Terminal Servies éœ€è¦å¼€å¯ã€‚å³ï¼šæˆ‘çš„ç”µè„‘-å³é”®-å±æ€§-è¿œç¨‹ä¸­ï¼Œå‹¾é€‰ å…è®¸è¿œç¨‹ç”¨æˆ·é“¾æ¥åˆ°æ­¤è®¡ç®—æœºã€‚é’ˆå¯¹rdesktopå‘½ä»¤çš„å‚æ•°è§£é‡Šï¼š12345678910-f      å…¨å±-a      16ä½è‰²,å¯é€‰ï¼Œä¸è¿‡æœ€é«˜å°±æ˜¯16ä½-u xxxxxx      ç™»å½•ç”¨æˆ·ï¼Œå¯é€‰-p xxxxxx      ç™»å½•å¯†ç ï¼Œå¯é€‰-r clipboard:PRIMARYCLIPBOARD     é‡è¦ï¼Œå‰ªè´´æ¿å¯ä»¥ä¸è¿œç¨‹æ¡Œé¢äº¤äº’-z      å‹ç¼©ï¼Œå¯é€‰-g 1024x768     åˆ†è¾¨ç‡ï¼Œå¯é€‰ï¼Œç¼ºçœæ˜¯ä¸€ç§æ¯”å½“å‰æœ¬åœ°æ¡Œé¢ä½çš„åˆ†è¾¨ç‡-P     ç¼“å†²ï¼Œå¯é€‰-r disk:wj=/home/magicgod      æ˜ å°„è™šæ‹Ÿç›˜ï¼Œå¯é€‰ï¼Œä¼šåœ¨è¿œç¨‹æœºå™¨çš„ç½‘ä¸Šé‚»å±…é‡Œè™šæ‹Ÿå‡ºä¸€ä¸ªæ˜ å°„ç›˜ï¼ŒåŠŸèƒ½å¾ˆå¼ºï¼Œç”šè‡³å¯ä»¥æ˜¯è½¯ç›˜æˆ–å…‰ç›˜-r sound:off     å…³é—­å£°éŸ³ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æŠŠè¿œç¨‹å‘çš„å£°éŸ³æ˜ å°„åˆ°æœ¬åœ°æ¥ã€‚ç‰¹åˆ«æ³¨æ„ï¼šrdesktopé€€å‡ºå…¨å±æ¨¡å¼ ï¼šä½¿ç”¨ç»„åˆé”®ctrl+alt+enterè¿›è¡Œåˆ‡æ¢ï¼›ä¸Šé¢è„šæœ¬æ‰§è¡Œåï¼Œå‘ç°å…¨å±ä¸äº†ï¼Œæ˜æ˜å·²ç»åŠ äº†-få‚æ•°ï¼Œè¿™æ˜¯å› ä¸ºåŠ äº†â€-g 1024x768â€çš„åˆ†è¾¨ç‡å‚æ•°ï¼Œå»æ‰è¿™ä¸ªåˆ†è¾¨ç‡å‚æ•°å°±å¯ä»¥å®ç°å…¨å±äº†ï¼æ­¤å¤–ï¼ŒUbuntué™¤äº†ä¸Šé¢çš„rdesktopå‘½ä»¤è¿›è¡Œè¿œç¨‹è¿æ¥æ“ä½œå¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨è‡ªå¸¦çš„Remminaè¿›è¡Œsshã€VNCã€RDP(è¿æ¥windowsæœºå™¨)è¿œç¨‹è¿æ¥ã€‚è¿…é›·123456éœ€è¦è½¯ä»¶ï¼šKtorent, Amuleå®‰è£…è½¯ä»¶ï¼šsudo apt-get install ktorrentsudo apt-get install amulechromeæ’ä»¶ç ´è§£VIPä¼šå‘˜è§†é¢‘é›†åˆTampermonkeygitzip for githuboctotreeCNKI PDF Downloadå…¶ä»–æŠ€å·§è‡ªåŠ¨æŒ‚è½½ç£ç›˜æŸ¥çœ‹ç£ç›˜å±æ€§12345678910111213hyc@hyc:~/Downloads$ blkid/dev/sda1: LABEL=&quot;M-fM-^AM-\&quot;M-eM-$M-^M&quot; UUID=&quot;C43C21073C20F5D8&quot; TYPE=&quot;ntfs&quot; PARTLABEL=&quot;Basic data partition&quot; PARTUUID=&quot;28719635-d995-4e4f-8842-d4dadf1de022&quot;/dev/sda2: UUID=&quot;D621-7B3A&quot; TYPE=&quot;vfat&quot; PARTLABEL=&quot;EFI system partition&quot; PARTUUID=&quot;2aa389ac-d040-4070-92bc-b6840310b686&quot;/dev/sda4: LABEL=&quot;local&quot; UUID=&quot;286C27576C271F56&quot; TYPE=&quot;ntfs&quot; PARTLABEL=&quot;Basic data partition&quot; PARTUUID=&quot;4ad76de5-bf50-4f27-8abf-8f880eb4b4c7&quot;/dev/sda5: UUID=&quot;A64A3E1F4A3DED25&quot; TYPE=&quot;ntfs&quot; PARTUUID=&quot;7e64d242-e149-4910-b732-ecb02266b48d&quot;/dev/sda6: UUID=&quot;2c1a9fc5-6017-4802-bb17-1b697eb4ba39&quot; TYPE=&quot;swap&quot; PARTUUID=&quot;a028e7db-32f0-4298-b259-cb0245a9151e&quot;/dev/sda7: UUID=&quot;03fe0c70-4d06-4023-94fb-d3af41cefee6&quot; TYPE=&quot;ext4&quot; PARTUUID=&quot;754efc8f-c0f9-40c6-8eae-bfe61b029ba6&quot;/dev/sdb2: LABEL=&quot;download&quot; UUID=&quot;5A26CFCB26CFA5FB&quot; TYPE=&quot;ntfs&quot; PARTLABEL=&quot;Basic data partition&quot; PARTUUID=&quot;ee7174a3-6cc8-407b-9a9f-ead9f3ce85f0&quot;/dev/sdb3: LABEL=&quot;software&quot; UUID=&quot;22BACF07BACED707&quot; TYPE=&quot;ntfs&quot; PARTLABEL=&quot;Basic data partition&quot; PARTUUID=&quot;8b742348-2ef4-429e-8a02-76a6e0f49f44&quot;/dev/sdb4: LABEL=&quot;qoding&quot; UUID=&quot;428AE1638AE153C7&quot; TYPE=&quot;ntfs&quot; PARTLABEL=&quot;Basic data partition&quot; PARTUUID=&quot;511c889e-d4ba-46b0-8df6-c9e360268abb&quot;/dev/sdb5: LABEL=&quot;student&quot; UUID=&quot;420EF5340EF52199&quot; TYPE=&quot;ntfs&quot; PARTLABEL=&quot;Basic data partition&quot; PARTUUID=&quot;3349a79c-d864-41ab-8bde-5f65172d9e5a&quot;/dev/sdb6: LABEL=&quot;linux&quot; UUID=&quot;702AA8C82AA88D22&quot; TYPE=&quot;ntfs&quot; PARTLABEL=&quot;Basic data partition&quot; PARTUUID=&quot;696e0d44-726d-455b-ae87-f55db96bd6d3&quot;/dev/sdb7: LABEL=&quot;entertainment&quot; UUID=&quot;009CAE0B9CADFB74&quot; TYPE=&quot;ntfs&quot; PARTLABEL=&quot;Basic data partition&quot; PARTUUID=&quot;78cf7f18-0257-45f8-8fb4-aa49567f54c1&quot;æ·»åŠ æŒ‚è½½é¡¹1234hyc@hyc:~/Downloads$ sudo gedit /etc/fstabåœ¨æœ«å°¾æ·»åŠ ï¼Œ/media/hycè·¯å¾„éœ€è¦æå‰åˆ›å»ºã€€qodingæ˜¯æŒ‚è½½åçš„åå­—ï¼Œè‡ªåŠ¨ä¼šåˆ›å»º/dev/sdb4 /media/hyc/qoding ntfs defaults 0 0/dev/sdb6 /media/hyc/linux ntfs defaults 0 0sshåˆ°æœåŠ¡å™¨1ssh root@http://112.126.102.142:22é€€å‡ºè¿œç¨‹ç”¨logout</content>
	</entry>
	<entry>
		<title>è¯­æ³•_åŸºç¡€</title>
		<url>/article/a3944886.html</url>
		<content>ä¸»è¦æ˜¯å¯¹è€ƒç ”åˆ˜æ™“è‰³è€å¸ˆçš„ä¹¦ç±ã€Šä¸å°±æ˜¯è¯­æ³•å’Œé•¿éš¾å¥å—ï¼Ÿã€‹ï¼Œè¿›è¡Œç¬”è®°æ•´ç†å’Œå­¦ä¹ è¯­æ³•åŸºç¡€è‹±æ±‰å¥æ³•ç»“æ„å·®å¼‚è‹±è¯­ï¼šè®²ç©¶ç»“æ„ç¾ï¼Œå¼ºè°ƒè¯­æ³•å’Œå¥æ³•çš„å®Œæ•´æ€§å’Œåˆç†æ€§æ±‰è¯­ï¼šè®²ç©¶æ„å¢ƒç¾ï¼Œæ— æ‹˜æ— æŸï¼ŒæŒ¥æ´’è‡ªå¦‚ä½•è°“ä¸»è°“å®¾ä¸»è¯­ï¼šåŠ¨ä½œçš„å‘å‡ºè€…è°“è¯­ï¼šåŠ¨è¯å®¾è¯­ï¼šåŠ¨ä½œçš„æ‰¿å—è€…ä¾‹å­æˆ‘ä»¬ æ€»æ˜¯ä¼š å¿½ç•¥ åŠªåŠ›çš„ é‡è¦æ€§ã€‚ä¸»è¯­   (çŠ¶è¯­)   è°“è¯­  (å®šè¯­)     å®¾è¯­è¯­æ³•æ€»è§ˆåè¯æ€§ä»å¥ï¼ŒæŒ‰ç…§ä»å¥çš„ç±»å‹ï¼Œå¯ä»¥åˆ†ä¸ºå››ç§ç±»å‹ä¸»è¯­ä»å¥å®¾è¯­ä»å¥è¡¨è¯­ä»å¥åŒä½è¯­ä»å¥å®šè¯­ä»å¥ï¼ŒæŒ‰ç…§å…ˆè¡Œè¯å¯ä»¥åˆ†ä¸ºä»¥ä¸‹äº”ç§ç±»å‹äººç‰©æ—¶é—´åœ°ç‚¹åŸå› çŠ¶è¯­ä»å¥ï¼Œæ ¹æ®å¼•å¯¼è¯æœ¬èº«çš„æ„æ€ï¼Œå¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¹ç§ç±»å‹æ—¶é—´çŠ¶è¯­åœ°ç‚¹çŠ¶è¯­å› æœç±»åŸå› çŠ¶è¯­ç›®çš„çŠ¶è¯­ç»“æœçŠ¶è¯­æ¡ä»¶çŠ¶è¯­æ–¹å¼çŠ¶è¯­æ¯”è¾ƒçŠ¶è¯­è®©æ­¥çŠ¶è¯­å…¶ä»–å¥å‹å¯ä»¥å½’çº³ä¸ºä»¥ä¸‹å››ç§å¼ºè°ƒå¥å€’è£…å¥è™šæ‹Ÿè¯­æ°”æ’å…¥è¯­è¯æ€§_å®è¯åè¯å«ä¹‰åè¯å°±æ˜¯äººæˆ–ç‰©çš„åç§°ï¼Œå¦‚ï¼šAlice, dog, book, the Changjiang Riveråˆ†ç±»åè¯å¯ä»¥åˆ†ä¸ºæ™®é€šåè¯å’Œä¸“æœ‰åè¯æ™®é€šåè¯å¯æ•°ä¸ªä½“åè¯: æŒ‡å•ä¸ªäººæˆ–ç‰©ï¼Œbook, doctor, dogé›†ä½“åè¯: æŒ‡æŸç±»äººæˆ–ç‰©çš„æ€»ç§°ï¼Œpeople, committee, police, groupä¸å¯æ•°ç‰©è´¨åè¯: æŒ‡ç‰©è´¨å’Œææ–™çš„åè¯ï¼Œair, fire, wateræŠ½è±¡åè¯: æŒ‡çœ‹ä¸è§æ‘¸ä¸ç€çš„åè¯ï¼Œconfidence, evolution, intelligence, associationä¸“æœ‰åè¯æŒ‡ä»£äººåã€å›½å®¶ã€åœ°åã€æœºæ„ã€ç»„ç»‡çš„åè¯ï¼Œé¦–å­—æ¯å¤§å†™ï¼ŒTony, China, the Changjiang River, WTOç”¨æ³•å¤æ•°å½¢å¼åè¯æ˜¯å¦è¦ä½¿ç”¨å¤æ•°ï¼Œæ˜¯æ ¹æ®å…·ä½“çš„æ„æ€æ¥ç¡®å®šçš„åªæœ‰å¯æ•°åè¯æœ¬èº«æ‰æœ‰å¤æ•°å½¢å¼ï¼Œè€Œä¸å¯æ•°åè¯æœ¬èº«æ²¡æœ‰å¤æ•°å½¢å¼ï¼Œéœ€è¦æ·»åŠ é‡è¯æ‰èƒ½å˜å¤æ•°å¯æ•°åè¯å¤æ•°çš„å˜åŒ–è§„å¾‹ è§„åˆ™å˜åŒ–1ç›´æ¥åœ¨è¯å°¾åŠ -slamp-lampsã€book-booksè§„åˆ™å˜åŒ–2ä»¥sã€xã€shã€chç»“å°¾ï¼Œè¯å°¾åŠ -es(å·§è®°ï¼šä¸Šå­¦åƒå°‘ä¼šé¥¿æ­»)bus-busesã€box-boxesã€brush-brushesã€watch-watchesç‰¹ä¾‹: stomach-stomachs ï¼ˆchå‘/k/çš„éŸ³ï¼‰ä»¥fæˆ–feç»“å°¾ï¼ŒæŠŠfæˆ–feå˜æˆ-vesleaf-leavesã€wife-wivesã€life-livesã€thief-thievesã€shelf-shelvesã€half-halvesã€knife-knivesã€wolf-wolvesã€scarf-scarvesç‰¹ä¾‹: roof-roofsã€belief-beliefsã€chief-chiefsã€cliff-cliffsã€gulf-gulfsä»¥è¾…éŸ³+yç»“å°¾ï¼Œ æŠŠyå˜æˆ-iesfactory-factoriesã€city-citesã€country-countriesç‰¹ä¾‹: ä»¥â€œå…ƒéŸ³+yâ€ç»“å°¾ï¼Œè¯å°¾åŠ -sä»¥oç»“å°¾ï¼š1.æœ‰ç”Ÿå‘½çš„åŠ -es 2.æ— ç”Ÿå‘½çš„åŠ -spotato-potatoesã€Negro-Negroesã€tomato-tomatoesã€hero-heroesã€mosquito-mosquitoesä¸è§„åˆ™å˜åŒ–æŠŠaå˜æˆemanâ€”menã€woman-womenç‰¹ä¾‹: 1.manå’Œwomanä¿®é¥°åè¯æ—¶ï¼Œä¸¤ä¸ªéƒ½å˜å¤æ•°ï¼šman teacherä¸€men teachersâ€‹         2.å…¶ä»–è¯ä¿®é¥°åè¯ï¼Œæœ€åä¸€ä¸ªå˜å¤æ•°ï¼šboy student-boy studentsè¯å°¾åŠ -enchild-childrenã€ox-oxenä»¥man/woman/childç»“å°¾çš„åè¯ï¼ŒæŠŠman/woman/childå˜å¤æ•°fireman-firemenã€chairwoman-chairwomenã€grandchild-grandchildrenå†…éƒ¨ooå˜eefoot-feetã€tooth-teethã€goose-geeseç‰¹ä¾‹: room-roomsã€boot-bootså•å¤æ•°åŒå½¢sheep, deer, means, Chinese, Japaneseå›½ç±çš„å¤æ•°å˜åŒ–ï¼šä¸­æ—¥ä¸å˜ï¼Œè‹±æ³•å˜(æŠŠaå˜e)ï¼Œå…¶ä»–å›½ç±æŒ‰è§„åˆ™åŠ -s/esChinese-Chineseã€Japanese-Japaneseã€Englishman-Englishmenã€Frenchman-Frenchmenã€American-Americansç‰¹ä¾‹: German-Germans(Germanä¸æ˜¯ç”±â€œGer+manâ€æ„æˆçš„åˆæˆè¯ï¼Œè€Œæ˜¯å®ƒä¸€å‡ºç”Ÿå°±é•¿è¿™æ ·)é›†ä½“åè¯çš„å¤æ•°(è°“è¯­ç”¨å¤æ•°)police, people, cattle, army, board, class, club, generation, crew, groupç‰¹ä¾‹: peopleç¿»è¯‘æˆâ€äººä»¬â€æ˜¯å•å¤æ•°åŒå½¢ï¼Œç¿»è¯‘æˆâ€œæ°‘æ—â€æœ‰å¤æ•°å½¢å¼ï¼Œå³peoplesåªä»¥å¤æ•°å½¢å¼å‡ºç°noodles, glasses, trousers, thanks, clothes, chopsticks, socks, shortsç‰¹ä¾‹: chopsticksã€shoesã€trousersï¼Œè¿™ç±»è¯ä¸èƒ½è¢«å…·ä½“æ•°å­—ä¿®é¥°ï¼Œä¸èƒ½è¯´two shoesï¼Œä½†å¯ä»¥ç”¨è¡¨ç¤ºå¤æ•°çš„å½¢å®¹è¯åŠé‡è¯ä¿®é¥°ï¼šmany shoes, two pairs of shoesä¸å¯æ•°åè¯åŠå…¶å¤æ•°ä¸å¯æ•°åè¯å°±æ˜¯æ— æ³•ç”¨æ•°é‡æ¥è®¡é‡çš„åè¯ï¼Œè¿™ä¸€ç±»åè¯æ˜¯ç‰©è´¨åè¯å’ŒæŠ½è±¡åè¯ç‰©è´¨åè¯æ¶²ä½“: orange, milk, water, wine, juice, tea, coffee, soupé£Ÿç‰©: bread, meat, grain, sugar, chocolate, wheatè‡ªç„¶: soil, sand, wood, weather, snow, windæŠ½è±¡åè¯æƒ…æ„Ÿ: joy, happiness, pleasantness, sadnesså­¦ç§‘: Chinese, Maths, Geography, Physics, Chemistry, Englishæ¦‚å¿µ: advice, information, news, time, money, knowledge, musicä¸å¯æ•°åè¯çš„å¤æ•°å½¢å¼ä¸å¯æ•°åè¯ä¸èƒ½åŠ -s/eså˜å¤æ•°ï¼Œå¦‚æœè¦è¡¨ç¤ºå¤æ•°å½¢å¼ï¼Œåªèƒ½å€ŸåŠ©é‡è¯æ¥è¡¨ç¤ºï¼Œé‡è¯å°±æ˜¯è¡¨ç¤ºä¸ªä½“æ•°é‡å•ä½çš„è¯ï¼Œé‡è¯çš„é€‰æ‹©æ˜¯æ ¹æ®è¯­æ„æ¥å†³å®šçš„ä¸å¯æ•°åè¯çš„å¤æ•°ç»“æ„æ˜¯ï¼šæ•°è¯+é‡è¯+of+ä¸å¯æ•°åè¯ä¸å¯æ•°åè¯åä¸èƒ½åŠ -s/eså¦‚æœè¦è¡¨ç¤ºå¤æ•°ï¼Œåªèƒ½åŠ é‡è¯ï¼ŒæŠŠé‡è¯å˜å¤æ•°(é‡è¦çš„äº‹æƒ…å†è¯´ä¸€éï¼šä¸å¯æ•°åè¯åä¸èƒ½åŠ -s/es)a piece of paper - two pieces of paperã€a piece of bread - two pieces of breadã€a cup of tea - two cups of teaã€a glass of water - two glasses of wateråŒºåˆ†å¯æ•°å’Œä¸å¯æ•°I need some paper to write the information down. (paperç¿»è¯‘æˆâ€œçº¸å¼ â€ï¼Œä¸å¯æ•°I have an academic paper to accomplish on this weekend. (paperç¿»è¯‘æˆâ€œè®ºæ–‡â€ï¼Œå¯æ•°)The paper said that the spaceship has been sent to the space. (paperç¿»è¯‘æˆâ€œæŠ¥çº¸â€ï¼Œå¯æ•°)Please notice the introduction of the food product on the box, because it will tell you how nutritious the foods are.ä»¥å‰åˆã€é«˜ä¸­è€å¸ˆç»å¸¸è¯´foodæ˜¯ä¸å¯æ•°åè¯ï¼Œåœ¨è¿™å¥è¯ä¸­ç¬¬ä¸€ä¸ªfoodï¼Œç¿»è¯‘æˆâ€é£Ÿå“â€ï¼Œæ˜¯ä¸€ä¸ªæ€»ç§°æ¦‚å¿µï¼Œå±äºä¸å¯æ•°åè¯ç¬¬äºŒä¸ªfoodsç¿»è¯‘æˆâ€å„ç§é£Ÿç‰©â€ï¼Œå·²ç»è¢«å…·ä½“åŒ–äº†ï¼ŒæŒ‡çš„æ˜¯â€ç›’å­é‡Œçš„é£Ÿç‰©â€ï¼Œæ‰€ä»¥å®ƒæ˜¯ä¸€ä¸ªå¯æ•°åè¯è¿™å¥è¯å°±ç¿»è¯‘æˆï¼šè¯·æ³¨æ„ç›’å­ä¸Šé£Ÿå“çš„ä»‹ç»ï¼Œå®ƒä¼šå‘Šè¯‰ä½ è¿™äº›é£Ÿç‰©æœ‰å¤šè¥å…»ã€‚ä¸€ä¸ªåè¯åˆ°åº•æ˜¯å¯æ•°è¿˜æ˜¯ä¸å¯æ•°ï¼Œä¸æ˜¯ç”±è¿™ä¸ªåè¯çš„å½¢å¼æˆ–è€…é€šè¿‡å…¶å­¤ç«‹çš„æ„æ€å†³å®šçš„ï¼Œè€Œæ˜¯æ ¹æ®è¿™ä¸ªåè¯åœ¨ä¸åŒè¯­å¢ƒä¸­çš„æ„ä¹‰å†³å®šçš„ç®€å•æ¥è¯´ï¼Œæ„ä¹‰å’Œè¯­å¢ƒçš„ä¸åŒï¼Œå°±ä¼šå¯¼è‡´åè¯çš„å¯æ•°å’Œä¸å¯æ•°We do not have much money in our purse. Weâ€™ve just got a few dollars.è¿™é‡Œçš„moneyæ˜¯ä¸€ä¸ªæ€»ç§°è¯ï¼Œå› ä¸ºä»–æ²¡æœ‰è¯´æ˜æ˜¯äººæ°‘å¸ï¼Œè¿˜æ˜¯ç¾å…ƒï¼Œè¿˜æ˜¯æ¬§å…ƒã€‚moneyæ˜¯ä¸å¯æ•°çš„ï¼Œæ‰€ä»¥è¦ç”¨muchæ¥ä¿®é¥°ã€‚è¦è¯´å…·ä½“æœ‰å¤šå°‘é’±ï¼Œåˆ™ç”¨ç›¸åº”çš„å¯æ•°åè¯æ¥è¡¨è¾¾ï¼Œæ­¤æ—¶ä¿®é¥°è¯ä¹Ÿéšä¹‹æ”¹å˜é‚£ä¹ˆç¿»è¯‘å°±æ˜¯ï¼šæˆ‘ä»¬æ²¡å‰©ä¸‹å¤šå°‘é’±äº†ï¼Œåªæœ‰å‡ ç¾å…ƒè¯å…¸ä¸­æ ‡æœ‰[C]çš„è¡¨ç¤ºå¯æ•°ï¼Œæ ‡æœ‰[U]çš„è¡¨ç¤ºä¸å¯æ•°äº‹å®ä¸Šï¼Œå¦‚æœä»…ä»…ä¸ºäº†åº”ä»˜è€ƒè¯•ï¼Œå³ä½¿åˆ†ä¸æ¸…å¯æ•°ä¸å¯æ•°ï¼Œä¹Ÿä¸ä¼šæœ‰å¤ªå¤§å½±å“ï¼Œå› ä¸ºå¯æ•°åè¯åŸå½¢ä¸èƒ½å•ç‹¬ä½¿ç”¨ï¼Œè¦ä¹ˆåè¯å‰åŠ å† è¯ï¼Œè¦ä¹ˆåè¯å˜å¤æ•°ã€‚å¦‚æœæ— æ³•ç¡®å®šåè¯å¯æ•°ä¸å¯æ•°ï¼Œåœ¨åè¯å‰åŠ å®šå† è¯â€theâ€ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„åè¯æ‰€æœ‰æ ¼ä»€ä¹ˆæ˜¯åè¯æ‰€æœ‰æ ¼ï¼Ÿå’±ä»¬è¿˜æ˜¯å…ˆçœ‹çœ‹è‡ªå·±ç†Ÿæ‚‰çš„æ±‰è¯­ï¼šæˆ‘å¦ˆå¦ˆçš„æˆ¿é—´å¦‚æœä½ æ²¡æœ‰å­¦è¿‡åè¯æ‰€æœ‰æ ¼ï¼Œä½ å¯èƒ½ä¼šç¿»è¯‘æˆï¼šmy mother roomï¼Œä¸å¥½æ„æ€ï¼Œä½ å†™é”™äº†ï¼Œè¿™å¥è¯ç¿»è¯‘å›å»æˆäº†ï¼šæˆ‘å¦ˆå¦ˆæˆ¿é—´ã€‚ç›¸æ¯”åŸæ–‡å°‘äº†ä¸€ä¸ªâ€çš„â€å­—ï¼Œå°±ä¸èƒ½å¤Ÿè¯´æ˜my motherå’Œroomçš„æ‰€å±å…³ç³»æ‰€ä»¥åè¯æ‰€æœ‰æ ¼å°±æ˜¯ç”¨æ¥è¡¨ç¤ºåè¯ä¹‹é—´çš„æ‰€å±å…³ç³»ï¼Œåœ¨æ±‰è¯­ä¸­æˆ‘ä»¬åœ¨åè¯ååŠ â€çš„â€æ¥è¡¨ç¤ºæ‰€å±å…³ç³»ï¼Œè‹±è¯­ä¸­æˆ‘ä»¬ç”¨â€™så’Œofæ¥è¡¨ç¤ºâ€˜sæ‰€æœ‰æ ¼åŸºæœ¬æ„æˆæ–¹å¼å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å››ç§ç›´æ¥åœ¨åè¯ååŠ â€™smy sonâ€™s watchä»¥sç»“å°¾ï¼Œç›´æ¥åœ¨åè¯ååŠ â€™Teachersâ€™ Day, parentsâ€™ meetingè¡¨ç¤ºå‡ äººå…±åŒæ‹¥æœ‰æŸç‰©ï¼Œåœ¨æœ€åçš„åè¯ååŠ â€™sï¼Œæ­¤æ—¶â€œæŸç‰©â€è¿™ä¸ªåè¯ç”¨å•æ•°Henry and Tonyâ€™s room äº¨åˆ©å’Œæ‰˜å°¼å…±æœ‰çš„æˆ¿é—´(æ­¤æ—¶roomç”¨å•æ•°)è¡¨ç¤ºå‡ äººå„è‡ªæ‹¥æœ‰æŸç‰©ï¼Œåˆ†åˆ«åœ¨åè¯ååŠ â€™sï¼Œæ­¤æ—¶â€æŸç‰©â€è¿™ä¸ªåè¯ç”¨å¤æ•°Henryâ€™s and Tonyâ€™s rooms äº¨åˆ©çš„æˆ¿é—´å’Œæ‰˜å°¼çš„æˆ¿é—´(æ­¤æ—¶roomç”¨å¤æ•°)åŸºæœ¬ç”¨æ³•å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å››ç§è¡¨ç¤ºæŸäººçš„æŸç‰©many studentsâ€™ eyesightè¡¨ç¤ºæ—¶é—´ã€è·ç¦»ã€å›½å®¶ã€åŸå¸‚ã€å›¢ä½“ã€æœºæ„ã€å­¦æ ¡ã€ç»„ç»‡ç­‰çš„æ‰€å±todayâ€™s news ä»Šå¤©çš„æ–°é—»the majorityâ€™s viewå¤šæ•°äººçš„æ„è§the travel agencyâ€™s visit æ—…è¡Œç¤¾çš„è®¿é—®three daysâ€™ walk ä¸‰å¤©çš„è·¯ç¨‹ç”¨äºæ„æˆå„ç§èŠ‚æ—¥Valentineâ€™s Day æƒ…äººèŠ‚Childrenâ€™s Day å„¿ç«¥èŠ‚Womenâ€™s Day å¦‡å¥³èŠ‚Motherâ€™s Day æ¯äº²èŠ‚ç›¸å½“äºåè¯æ€§ç‰©ä¸»ä»£è¯çš„ç”¨æ³•Her English is just as good as Lilyâ€™s.ofæ‰€æœ‰æ ¼æ±‰è¯­ï¼šæˆ‘å¦ˆå¦ˆçš„ç”Ÿæ—¥è‹±è¯­ï¼šthe birthday of my motheråŸºæœ¬ç»“æ„æ˜¯N1+of+N2ï¼Œä¸æ±‰è¯­çš„è¯­åºç›¸åæ•™å ‚çš„å±‹é¡¶ â€”&gt; the roof of the churchæ¢å¥è¯è¯´ï¼šæ±‰è¯­çš„è¯­åºæ˜¯N1+çš„+N2ï¼Œå†™æˆè‹±è¯­å°±æ˜¯N2+of+N1ä¸­å›½åœ°å›¾ the map of China.æ­Œæ›²çš„åå­— the name of the song.æ¯”èµ›çš„ç»“æœ the consequence of the contest.åŠ¨è¯å®ä¹‰åŠ¨è¯å®ä¹‰åŠ¨è¯æ˜¯è¡¨ç¤ºå…·ä½“åŠ¨ä½œçš„è¯å¯ä»¥åˆ†ä¸ºåŠç‰©åŠ¨è¯å’Œä¸åŠç‰©åŠ¨è¯åŠç‰©åŠ¨è¯ï¼šåé¢ç›´æ¥åŠ å®¾è¯­ï¼Œå¹¶ä¸”å¿…é¡»åŠ å®¾è¯­ã€‚æ¯”å¦‚ï¼šaccept the ideaï¼Œbuy a bookã€‚ä¸åŠç‰©åŠ¨è¯ï¼šåé¢ä¸èƒ½ç›´æ¥åŠ å®¾è¯­ï¼Œå¿…é¡»è¦åŠ äº†ä»‹è¯ä»¥åæ‰èƒ½åŠ å®¾è¯­ã€‚æ¯”å¦‚ï¼šI agree with you.é‚£å¦‚ä½•åŒºåˆ†åŠç‰©åŠ¨è¯å’Œä¸åŠç‰©åŠ¨è¯å‘¢æ ¹æ®æ„æ€ï¼šeatã€kissåŠ¨è¯+ä»‹è¯â€çš„åŠ¨è¯ä¸ºä¸åŠç‰©åŠ¨è¯ï¼šarrive inã€abound inçœ‹å•è¯è¡¨æ­»è®°ç¡¬èƒŒï¼šV.ï¼šæ—¢å¯ä»¥ä½œåŠç‰©åŠ¨è¯ï¼Œä¹Ÿå¯ä»¥ä½œä¸åŠç‰©åŠ¨è¯Vt.ï¼šåŠç‰©åŠ¨è¯Vi.ï¼šä¸åŠç‰©åŠ¨è¯è¿ç³»åŠ¨è¯çŠ¶æ€ï¼šbeåŠ¨è¯(è¿æ¥ä¸»è¯­å’Œè¡¨è¯­ï¼Œæ— æ„ä¹‰ï¼Œç”¨äºæ„æˆå¥å­)æ„Ÿå®˜ï¼šfeelï¼Œsoundï¼Œsmellï¼Œtasteï¼Œlookå˜åŒ–ï¼šget,becomeï¼Œturnï¼Œgrowï¼Œfallä¿æŒï¼škeepï¼Œstandï¼Œremainï¼Œstayè¡¨è±¡ï¼šseemï¼Œappearç»ˆæ­¢ï¼šproveæƒ…æ€åŠ¨è¯å«ä¹‰æƒ…æ€åŠ¨è¯æ˜¯æœ¬èº«æœ‰ä¸€å®šçš„è¯ä¹‰ã€è¡¨ç¤ºè¯´è¯äººä¸»è§‚æ€åº¦çš„è¯ç”¨æ³•æƒ…æ€åŠ¨è¯ä¸èƒ½å•ç‹¬å‡ºç°ï¼Œåé¢å¿…é¡»å’Œå®ä¹‰åŠ¨è¯/ç³»åŠ¨è¯ä¸€èµ·æ„æˆè°“è¯­åˆ†ç±»â€¦æƒ…æ€åŠ¨è¯çš„å®Œæˆæ—¶è¡¨ç¤ºæ¨æµ‹é€šè¿‡å¤§é›å¿˜å¸¦é’¥åŒ™çš„æ•…äº‹ï¼Œè®²å®Œä»¥ä¸‹å››ä¸ªè¡¨ç¤ºæ¨æµ‹çš„æƒ…æ€åŠ¨è¯å®Œæˆæ—¶must have doneï¼šä¸€å®šåšè¿‡æŸäº‹neednâ€™t have doneï¼šæœ¬æ²¡å¿…è¦åšæŸäº‹ï¼Œä½†æ˜¯åšäº†could have doneï¼šæœ¬èƒ½å¤ŸåšæŸäº‹ï¼Œä½†æ²¡æœ‰åšï¼Œè¡¨ç¤ºé—æ†¾should have doneï¼šæœ¬åº”è¯¥åšæŸäº‹ä¾‹å­ï¼šå¤§é›æŠŠå®¶é‡Œçš„é’¥åŒ™è½åœ¨æ•™å®¤äº†ã€‚å¥¹åˆ°å®¶é—¨å£åæ‰“ä¸å¼€é—¨ï¼Œæ‰€ä»¥åªèƒ½ä¸€ç›´è¹²åœ¨é—¨å£ï¼Œç­‰åˆ°æ™šä¸Š10ç‚¹å¤šï¼ŒåŠ ç­çš„çˆ¸çˆ¸å¦ˆå¦ˆå›æ¥ï¼Œå¥¹æ‰è¿›äº†å®¶é—¨ã€‚å¤§é›å‘ç°é’¥åŒ™è½åœ¨æ•™å®¤åï¼Œå¥¹å¾ˆæ‡Šæ‚”ã€‚æ­¤æ—¶å¥¹å¯èƒ½ä¼šæŠ±æ€¨è‡ªå·±ï¼šI should have brought the key with me. ï¼ˆæˆ‘æœ¬åº”è¯¥å¸¦é’¥åŒ™çš„ï¼‰é‚£æ—¶çš„å¤§é›é™¤äº†åœ¨é—¨å¤–ç­‰å¾…çˆ¸çˆ¸å¦ˆå¦ˆå›æ¥ï¼Œè¿˜æœ‰åˆ«çš„è§£å†³æ–¹æ¡ˆå´æ²¡åšï¼šHe could have come back to school to get the key but he didnâ€™t. (å…¶å®å¥¹æœ¬å¯ä»¥å›å­¦æ ¡æ‹¿é’¥åŒ™çš„ï¼Œå¯æ˜¯å¥¹æ²¡æœ‰è¿™æ ·åšï¼‰çˆ¸çˆ¸å¦ˆå¦ˆå½“æ™šå›æ¥å‘ç°å¤§é›åœ¨é—¨å¤–ï¼Œäº†è§£åŸå› åï¼Œçˆ¸çˆ¸å¦ˆå¦ˆé—®å¥¹ä¸ºä»€ä¹ˆå½“æ—¶ä¸è¿”å›å­¦æ ¡æ‹¿é’¥åŒ™ã€‚çˆ¸çˆ¸å¦ˆå¦ˆè®¤ä¸ºè‹¥å¤§é›å½“æ—¶è¿”å›å­¦æ ¡æ‹¿äº†é’¥åŒ™çš„è¯å¯èƒ½æ—©å°±è¿›å»äº†ã€‚çˆ¸çˆ¸å¦ˆå¦ˆå¯èƒ½ä¼šè¯´ï¼šYou neednâ€™t have stayed in front of the door for such a long time.   (å…¶å®ä½ æœ¬ä¸éœ€è¦åœ¨é—¨å£ç­‰é‚£ä¹ˆä¹…çš„)å…³äºä¸ºä»€ä¹ˆå½“æ—¶æ²¡æœ‰è¿”å›å­¦æ ¡æ‹¿é’¥åŒ™ï¼Œå¤§é›è§£é‡Šé“ï¼šI thought the gate must have already been closed by that time.  (æˆ‘æƒ³å­¦æ ¡é‚£æ—¶å€™ä¸€å®šå…³ä¸Šå¤§é—¨äº†)åŠ©åŠ¨è¯å«ä¹‰åŠ©åŠ¨è¯å°±æ˜¯å¸®åŠ©è°“è¯­åŠ¨è¯ä¸€èµ·æ„æˆå¦å®šã€ç–‘é—®ã€æ—¶æ€ã€è¯­æ€ç­‰çš„è¯åˆ†ç±»åŠç”¨æ³•beç”¨æ³•ï¼šå¸®åŠ©æ„æˆè¿›è¡Œæ—¶è¢«åŠ¨è¯­æ€ä¸¾ä¾‹ï¼šAs the cartoon describes,a hen is making a promise.The story is claimed to be very instructive.doã€didå’Œdoesç”¨æ³•ï¼šä¸€èˆ¬ç°åœ¨æ—¶ã€è¿‡å»æ—¶çš„å¦å®šå’Œç–‘é—®å¼ºè°ƒè°“è¯­åŠ¨è¯(å¼ºè°ƒè°“è¯­åªèƒ½ç”¨do/did/does)å€’è£…ä¸¾ä¾‹ï¼šThe picture did not show us profound meaning.The picture did show us profound meaning.Only yesterday did he find out that his watch was doeshaveå’Œhasç”¨æ³•ï¼š å¸®åŠ©æ„æˆå®Œæˆæ—¶ä¸¾ä¾‹ï¼šRepublicans left in the recent Euro-elections have  forced him to eat his words and stand down.willç”¨æ³•ï¼šå¸®åŠ©æ„æˆå°†æ¥æ—¶ä¸¾ä¾‹ï¼šImitation of behaviors will mislead behavioral studies.æ‰€æœ‰çš„åŠ©åŠ¨è¯å’Œæƒ…æ€åŠ¨è¯éƒ½èƒ½å¤Ÿå¸®åŠ©å¥å­æ„æˆå€’è£…ï¼Œå…·ä½“ä½¿ç”¨å“ªä¸ªåŠ©åŠ¨è¯æˆ–è€…æƒ…æ€åŠ¨è¯ï¼Œè¦æ ¹æ®å¥å­çš„æ—¶æ€å’Œæ„æ€æ¥å†³å®šUnder the table was lying a half-conscious young man.  æ¡Œå­åº•ä¸‹èººç€ä¸€ä¸ªç¥å¿—ä¸æ¸…çš„å¹´è½»äººã€‚Only after things disappear will we cherish them.  äººä»¬åªæœ‰åˆ°å¤±å»äº†æ‰æ‡‚å¾—çæƒœã€‚Nor did he let the disease stop him from living the kind of life he has always dreamt about.ç–¾ç—…æ²¡æœ‰ä½¿ä»–æ”¾å¼ƒè¿‡ä¸Šæ¢¦æƒ³ä¸­çš„ç”Ÿæ´»ã€‚Under no circumstances should you lend Paul any money.  åœ¨ä»»ä½•æƒ…å†µä¸‹ä½ éƒ½ä¸åº”è¯¥å€Ÿé’±ç»™ä¿ç½—ã€‚Only by studying hard can students pass the exams.  åªæœ‰åŠªåŠ›å­¦ä¹ ï¼Œå­¦ç”Ÿä»¬æ‰èƒ½é€šè¿‡è€ƒè¯•ã€‚ä»£è¯ä»£è¯å°±æ˜¯æ›¿ä»£åè¯è€Œå‡ºç°çš„è¯ä¾‹å¦‚ï¼šæˆ‘çˆ±è¿™å¤´ç†Šï¼Œæˆ‘çˆ±å®ƒã€‚å®ƒå°±æ˜¯è¿™å¤´ç†Šï¼Œè¿™å¤´ç†Šå°±æ˜¯å®ƒä»£è¯åˆåˆ†æˆäººç§°ä»£è¯ã€ç‰©ä¸»ä»£è¯ã€åèº«ä»£è¯ã€ä¸å®šä»£è¯å’ŒæŒ‡ç¤ºä»£è¯äººç§°ä»£è¯å«ä¹‰äººç§°ä»£è¯æŒ‡ä»£æ›¿äººå’Œäº‹ç‰©çš„åç§°ï¼Œåˆ†ä¸ºä¸»æ ¼å’Œå®¾æ ¼ä¸¤ç§å½¢å¼å•æ•°å•æ•°å•æ•°å¤æ•°å¤æ•°å¤æ•°äººç§°ä»£è¯ç¬¬ä¸€äººç§°ç¬¬äºŒäººç§°ç¬¬ä¸‰äººç§°ç¬¬ä¸€äººç§°ç¬¬äºŒäººç§°ç¬¬ä¸‰äººç§°ä¸»æ ¼Iyouhe / she / itweyoutheyå®¾æ ¼meyouhim / her / itusyouthemè¯ä¹‰æˆ‘ä½ ä»– / å¥¹ / å®ƒæˆ‘ä»¬ä½ ä»¬ä»–ä»¬ç”¨æ³•ä¸»æ ¼ç”¨æ¥ä½œå¥å­çš„ä¸»è¯­ã€è¡¨è¯­I often go shopping on Sundays.Are they from Japan?Itâ€™s he&lt;/u&gt;!å®¾æ ¼ç”¨æ¥ä½œåŠç‰©åŠ¨è¯æˆ–è€…ä»‹è¯çš„å®¾è¯­Who teaches you English this year?We often write letters to her.å½“å‡ ä¸ªäººç§°åˆåœ¨ä¸€èµ·ä½œä¸»è¯­æ—¶ï¼Œæ’åˆ—é¡ºåºå¦‚ä¸‹ï¼šå•æ•°ï¼šäºŒä¸‰ä¸€ï¼Œå¦‚ï¼šYou, he and I are working at that computer company.å¤æ•°ï¼šä¸€äºŒä¸‰ï¼Œå¦‚ï¼šWe, you and they are all from China.ç‰©ä¸»ä»£è¯å«ä¹‰ç‰©ä¸»ä»£è¯è¯´æ˜äººå’Œäº‹ç‰©çš„æ‰€å±å…³ç³»ï¼Œåˆ†ä¸ºå½¢å®¹è¯æ€§å’Œåè¯æ€§ä¸¤ç§å•æ•°å•æ•°å•æ•°å¤æ•°å¤æ•°å¤æ•°ç‰©ä¸»ä»£è¯ç¬¬ä¸€äººç§°ç¬¬äºŒäººç§°ç¬¬ä¸‰äººç§°ç¬¬ä¸€äººç§°ç¬¬äºŒäººç§°ç¬¬ä¸‰äººç§°å½¢å®¹è¯æ€§myyourhis / her / itsouryourtheiråè¯æ€§mineyourshis / hers / itsoursyourstheirsè¯ä¹‰æˆ‘çš„ä½ çš„ä»–çš„ / å¥¹çš„ / å®ƒçš„æˆ‘ä»¬çš„ä½ ä»¬çš„ä»–ä»¬çš„ç”¨æ³•å½¢å®¹è¯æ€§ç‰©ä¸»ä»£è¯åé¢è¦è·Ÿåè¯ï¼Œç›¸å½“äºå½¢å®¹è¯Is that your umbrella?I often go to see my aunt on Sundays.åè¯æ€§ç‰©ä¸»ä»£è¯ç›¸å½“äºåè¯ï¼Œæ—¢ä»£æ›¿äº‹ç‰©åˆè¡¨æ˜æ‰€å±å…³ç³»ã€‚åœ¨å¥å­ä¸­å¾€å¾€ç‹¬ç«‹ä½œä¸»è¯­ã€å®¾è¯­æˆ–è€…è¡¨è¯­ï¼Œåé¢åƒä¸‡ä¸å¯ä»¥è·Ÿåè¯This is your cup. Mine is on the desk.Your classroom is very big. What about theirs?åèº«ä»£è¯å«ä¹‰åèº«ä»£è¯è¡¨ç¤ºè°“è¯­çš„åŠ¨ä½œä¸ä¸»è¯­æœ‰å…³æˆ–è€…å®¾è¯­è¡¥è¶³è¯­çš„åŠ¨ä½œä¸å®¾è¯­æœ‰å…³å•æ•°å•æ•°å•æ•°å¤æ•°å¤æ•°å¤æ•°åèº«ä»£è¯ç¬¬ä¸€äººç§°ç¬¬äºŒäººç§°ç¬¬ä¸‰äººç§°ç¬¬ä¸€äººç§°ç¬¬äºŒäººç§°ç¬¬ä¸‰äººç§°è¯å½¢myselfyourselfhimself / herself / itselfourselvesyourselvesthemselvesè¯ä¹‰æˆ‘è‡ªå·±ä½ è‡ªå·±ä»–è‡ªå·± / å¥¹è‡ªå·± / å®ƒè‡ªå·±æˆ‘ä»¬è‡ªå·±ä½ ä»¬è‡ªå·±ä»–ä»¬è‡ªå·±ç”¨æ³•åèº«ä»£è¯åœ¨å¥å­ä¸­ä½œå®¾è¯­è¡¨ç¤ºåå°„(æŒ‡ä¸€ä¸ªåŠ¨ä½œå›åˆ°è¯¥åŠ¨ä½œæ‰§è¡Œè€…æœ¬èº«)Donâ€™t play with the knife, you might hurt yourself. ä¸è¦ç©åˆ€å­ï¼Œé‚£ä¼šå‰²ä¼¤ä½ çš„ã€‚åèº«ä»£è¯åœ¨å¥å­ä¸­ä½œåŒä½è¯­è¡¨ç¤ºå¼ºè°ƒ(å³ç”¨æ¥å¼ºè°ƒåè¯æˆ–ä»£è¯çš„è¯­æ°”)The story itself is good. Only he didnâ€™t tell it well. æ•…äº‹æœ¬èº«æ˜¯å¥½çš„ï¼Œåªæ˜¯ä»–æ²¡æœ‰è®²å¥½ã€‚ä¸å®šä»£è¯ä¸å®šä»£è¯æŒ‡ä»£ä¸æ˜ç¡®çš„äººæˆ–ç‰©something(æŸäº‹)ï¼Œsomeone(æŸäºº)ï¼Œsomebody(æŸäºº)anything(ä»»ä½•äº‹)ï¼Œanyone(ä»»ä½•äºº)ï¼Œanybody(ä»»ä½•äºº)nothing(æ²¡äº‹)ï¼Œnone(æ²¡æœ‰äºº)ï¼Œnobody(æ²¡æœ‰äºº)everything(ä¸€åˆ‡)ï¼Œeveryone(æ¯ä¸ªäºº)ï¼Œeverybody(æ¯ä¸ªäºº)æŒ‡ç¤ºä»£è¯æŒ‡ç¤ºä»£è¯è¿‘æŒ‡è¿œæŒ‡ç”¨æ³•å•æ•°thisthatè°“è¯­ç”¨å•æ•°å¤æ•°thesethoseè°“è¯­ç”¨å¤æ•°ä¸éœ€è¦æŸ¥æ‰¾ä»£è¯çš„æŒ‡ä»£çš„æƒ…å†µIt is conspicuous that he works so hard.It is accepted that ability is of great importance.It is important to learn English well.They found it very hard to learn English well.It was him that I met in the street.Because of more ways to keep fit, it points out,humanâ€™s life will be prolonged.åœ¨å¥â‘ ã€â‘¡ã€â‘¢ã€â‘£ä¸­ï¼Œitä½œå½¢å¼ä¸»è¯­å’Œå½¢å¼å®¾è¯­åœ¨å¥â‘¤ä¸­ï¼Œitå¼•å¯¼å¼ºè°ƒå¥å‹åœ¨å¥â‘¥ä¸­ï¼Œitåœ¨æ’å…¥è¯­ä¸­å½¢å®¹è¯å«ä¹‰å½¢å®¹è¯å°±æ˜¯ç”¨æ¥ä¿®é¥°åè¯çš„è¯ï¼Œç­‰äºç»™åè¯ç©¿äº†ä¸€ä»¶è¡£æœç”¨æ³•å½¢å®¹è¯ä½œå®šè¯­embarrassing scandals å°´å°¬çš„ä¸‘é—»regular exerciseæ—¥å¸¸é”»ç‚¼I have something urgent to tell you. (æ³¨æ„ï¼šå½¢å®¹è¯ä¿®é¥°ä¸å®šä»£è¯ï¼Œéœ€è¦æ”¾åˆ°å½¢å®¹è¯ä¹‹å)å½¢å®¹è¯ä½œè¡¨è¯­ï¼Œè¯´æ˜ä¸»è¯­çš„ç‰¹ç‚¹ã€çŠ¶æ€The fact is that most Chinese people are hospitable, courteous and helpful to the visitors.V.-ing å’ŒV.-edå½¢å®¹è¯å¦‚æœè¯´â€ä¹¦å¾ˆæœ‰è¶£â€ï¼Œæˆ‘ä»¬è¦ç”¨interesting: The book is interesting.è€Œå¦‚æœè¦è¯´â€ä»–æ„Ÿå…´è¶£â€ï¼Œæˆ‘ä»¬åˆ™è¦ç”¨interested: He is interested.æˆ–è€…ï¼Œæˆ‘ä»¬æŠŠäºŒè€…ä½œå®šè¯­ï¼Œæ¥ä¿®é¥°ä¸€ä¸ªåè¯the interesting bookthe interested personçŸ­è¯­â‘ ä¸­ï¼Œinterestingè¡¨ç¤ºâ€èƒ½å¤Ÿå¼•èµ·äººä»¬å…´è¶£çš„ä¹¦â€ï¼Œå³â€ä¸€æœ¬æœ‰è¶£çš„ä¹¦â€çŸ­è¯­â‘¡ä¸­ï¼Œinterestedè¡¨ç¤ºâ€è¿™ä¸ªäººå¯¹æŸä¸ªäº‹ç‰©æ„Ÿå…´è¶£â€ï¼Œå³â€ä¸€ä¸ªæ„Ÿå…´è¶£çš„äººâ€ä»ä»¥ä¸Šä¸¤ä¸ªç®€å•çš„ä¾‹å­æˆ‘ä»¬çœ‹åˆ°interestingå¾€å¾€æ˜¯ä¸äº‹ç‰©è”ç³»åœ¨ä¸€èµ·çš„ï¼Œè€Œinterestedå¾€å¾€æ˜¯ä¸äººè”ç³»åœ¨ä¸€èµ·çš„ç”±æ­¤æ¨è€Œå¹¿ä¹‹ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºä¸‹åˆ—ä¸€èˆ¬è§„å¾‹V-ingå½¢å®¹è¯ä¸»è¦æ˜¯â€æŸäº‹ç‰©ä»¤äººæ„Ÿåˆ°â€¦â€¦â€V.-edå½¢å®¹è¯ä¸»è¦æ˜¯â€äºº(ä¸»è§‚ä¸Š)æ„Ÿåˆ°â€¦â€¦â€è¯·æ¯”è¾ƒï¼šthe exciting newså’Œthe excited boyçŸ­è¯­â‘ ç¿»è¯‘æˆâ€ä»¤äººæ¿€åŠ¨çš„æ–°é—»â€ï¼ŒçŸ­è¯­â‘¡ç¿»è¯‘æˆâ€æ¿€åŠ¨çš„ç”·å­©â€æ¯”è¾ƒç­‰çº§æ¯”è¾ƒç­‰çº§å½¢å®¹è¯çš„ä¸‰ä¸ªçº§åˆ«ï¼šåŸçº§ã€æ¯”è¾ƒçº§ã€æœ€é«˜çº§åŸçº§ï¼šæ²¡æœ‰æ¯”è¾ƒï¼Œå³â€å’Œâ€¦â€¦ä¸€æ ·â€æ¯”è¾ƒçº§ï¼šä¸¤è€…ä¹‹é—´çš„æ¯”è¾ƒï¼Œâ€æ¯”â€¦â€¦.æ›´â€¦â€¦â€æœ€é«˜çº§ï¼šä¸‰è€…åŠä¸‰è€…ä»¥ä¸Šçš„æ¯”è¾ƒï¼Œâ€æœ€â€¦â€¦â€ç”¨æ³•åŸçº§ï¼šä¸â€¦â€¦ä¸€æ ·/ä¸ä¸€æ ·è‚¯å®šï¼šç”±â€as+å½¢å®¹è¯åŸçº§+asâ€æˆ–â€as+å½¢å®¹è¯+åè¯+asâ€æ„æˆMy mother is as energetic as a young man.å¦å®šï¼šç”±â€not as/so+å½¢å®¹è¯åŸçº§+asâ€æ„æˆLuckily, the weather is not so wet as it was yesterday.æ¯”è¾ƒçº§å’Œæœ€é«˜çº§è§„åˆ™å˜åŒ–å˜åŒ–è§„å¾‹åŸçº§æ¯”è¾ƒçº§æœ€é«˜çº§å˜åŒ–è§„å¾‹ä¸€èˆ¬åœ¨è¯å°¾åŠ -er/estyoungyoungeryoungestä»¥å­—æ¯eç»“å°¾çš„è¯ï¼ŒåŠ -r/stbravebraverbravestä»¥è¾…å…ƒè¾…ç»“å°¾ï¼ŒåŒå†™å°¾å­—æ¯ï¼ŒåŠ -er/esthothotterhottestä»¥â€è¾…éŸ³+yâ€ç»“å°¾ï¼ŒæŠŠyå˜æˆ-ier/iestshyshiershiestä»¥yç»“å°¾çš„åŒéŸ³èŠ‚è¯ï¼ŒæŠŠyå˜æˆ-ier/iesthappyhappierhappiestå…¶ä»–åŒéŸ³èŠ‚å’Œå¤šéŸ³èŠ‚è¯ï¼Œåœ¨è¯å‰åŠ more/mostcarefulmore carefulmost carefulä¸è§„åˆ™å˜åŒ–ï¼Œé¡»ç‰¹æ®Šè®°å¿†åŸçº§æ¯”è¾ƒçº§æœ€é«˜çº§good / wellbetterbestbad / badly / illworseworstfarfarther / furtherfarthest / furthestoldolder / elderoldest / eldestlittlelessleastmany / muchmoremoståŸºæœ¬ç”¨æ³• æ¯”è¾ƒçº§ï¼šI am more handsome than you.You are uglier than I.æœ€é«˜çº§ï¼šI am the tallest in our class.You are the oldest among these people.å½¢å®¹è¯çš„æ¯”è¾ƒçº§å‰å¯ä»¥ç”¨è¡¨ç¤ºç¨‹åº¦çš„è¯æˆ–çŸ­è¯­æ¥è¿›è¡Œä¿®é¥°ï¼ša bit, a little bit, a little, a lot, a great deal, any, even, far, by far(è¿˜å¯ç”¨åœ¨æœ€é«˜çº§çš„å‰é¢)ï¼Œmuch, very much, no, rather, stillå’Œslightlyç­‰å…·ä½“ç”¨å“ªä¸€ä¸ªæ ¹æ®æ±‰è¯­æ„æ€æ¥é€‰æ‹©ï¼Œè¯·çœ‹ä¾‹å¥ï¼šThings are no better than before. æƒ…å†µå¹¶æ²¡æœ‰æ¯”ä»¥å‰æœ‰æ‰€æ”¹å–„ã€‚He makes far fewer mistakes in spelling than before. ä»–çŠ¯çš„æ‹¼å†™é”™è¯¯æ¯”ä»¥å‰å°‘å¤šäº†ã€‚æ³¨æ„ï¼Œä¸‹é¢è¿™äº›è¯ä¸€èˆ¬ä¸ç”¨æ¥ä¿®é¥°æ¯”è¾ƒçº§ï¼švery, many, quiteå’Œfairlyç­‰æ¯”å¦‚ä¸è¯´: My girlfriend is very older than me.æ¯”è¾ƒçº§+and+æ¯”è¾ƒçº§ åŒé‡æ¯”è¾ƒç”¨æ¥è¡¨ç¤ºäº‹ç‰©æŒç»­ä¸æ–­çš„å˜åŒ–ï¼Œç›¸å½“äºæ±‰è¯­ä¸­çš„â€è¶Šæ¥è¶Šâ€The city is becoming more and more beautiful. è¿™åº§åŸå¸‚å˜å¾—è¶Šæ¥è¶Šç¾ä¸½äº†ã€‚The weather is becoming colder and colder. å¤©æ°”å˜å¾—è¶Šæ¥è¶Šå†·äº†ã€‚the+æ¯”è¾ƒçº§+ä¸»è°“ï¼Œthe+æ¯”è¾ƒçº§+ä¸»è°“The more difficult the question is, the more careful we should be.The harder the youngsters work, the more prosperous the country will be.å¸¸è€ƒçš„thançš„æ¯”è¾ƒç»“æ„a. more than  ä¸ä»…ä»…æ˜¯b. more..â€¦thanâ€¦  æ¯”â€¦â€¦å¤šï¼›ä¸å…¶â€¦â€¦ä¸å¦‚è¯´c. nothing more than  åªä¸è¿‡æ˜¯d. anything less than  æ¯«ä¸ï¼Œç»ä¸e. nothing less than  ç®€ç›´ï¼Œå°±æ˜¯f. better than  æ¯”.â€¦â€¦æ›´å¥½g. rather than  è€Œä¸æ˜¯h. other than  é™¤äº†i. less than  å°‘äºj. no less than  å¤šäºï¼Œä¸å°‘äºã€ç®€ç›´æ˜¯ã€ä¸â€¦ä¸€æ ·ï¼Œä¸æ¯”â€¦å·®è¯æ€§_è™šè¯å† è¯å«ä¹‰å† è¯æ˜¯é™å®šåè¯ï¼Œå¯¹åè¯èµ·åˆ°æ³›æŒ‡å’Œç‰¹æŒ‡ä½œç”¨çš„è¯This is one small step for man,one giant leap for mankind.è¯¥å¥è¯æ˜¯å½“å¹´é˜¿å§†æ–¯ç‰¹æœ—ç™»æœˆåè¯´çš„ï¼Œç¿»è¯‘æ˜¯ï¼šè¿™æ˜¯å¯¹äººç±»çš„ä¸€å°æ­¥ï¼Œæ˜¯äººç±»çš„ä¸€å¤§æ­¥å¾ˆæ˜æ˜¾è¯­ä¹‰ä¸é€šï¼Œçœ‹å‡ºå“ªé‡Œä¸å¯¹äº†å—ï¼Ÿé—®é¢˜åœ¨äºmanï¼Œå‰é¢ä¸åŠ å† è¯ç¿»è¯‘æˆâ€œäººç±»â€ï¼ŒåŠ å† è¯ç¿»è¯‘æˆâ€œç”·äººâ€æ‰€ä»¥è¿™å¥åè¨€å…¶å®å°‘äº†å† è¯ï¼Œæ­£ç¡®å†™æ³•åº”è¯¥æ˜¯ï¼šThis is one small step for a man,one giant leap for mankind.åˆ†ç±»å† è¯åˆ†ä¸ºä¸å®šå† è¯å’Œå®šå† è¯ä¸å®šå† è¯ï¼ša/anè¡¨ç¤ºæ³›æŒ‡ï¼Œå³ä¸ç¡®å®šçš„ä¸€ä¸ªå®šå† è¯ï¼štheè¡¨ç¤ºç‰¹æŒ‡ï¼Œå³ç‰¹å®šçš„ä¸€ä¸ªä¸å®šå† è¯a/ançš„åŒºåˆ«ä¸å®šå† è¯åœ¨å…ƒéŸ³éŸ³ç´ å‰ç”¨anï¼Œé€šå¸¸æ˜¯ä»¥aã€eã€iã€oã€uç­‰å…ƒéŸ³å­—æ¯å¼€å¤´çš„å•è¯ï¼Œå¦‚ï¼šan eggï¼Œan appleç‰¹ä¾‹ï¼šå…ƒéŸ³å­—æ¯å¼€å¤´ä¸å‘å…ƒéŸ³çš„æƒ…å†µ: a uniformã€a universityã€a useful book for Europeansã€a one-way streetè¾…éŸ³å­—æ¯å¼€å¤´å‘å…ƒéŸ³çš„æƒ…å†µ: an hourã€an honest boy(æ‹¼è¯»æ—¶hä¸å‘éŸ³ï¼Œoå‘å…ƒéŸ³)ç”¨æ³•ä¸å®šå† è¯a/ançš„ç”¨æ³•è¡¨ç¤ºâ€œä¸€ä¸ªâ€I have a cat.è¡¨ç¤ºâ€œæŸä¸€ä¸ªâ€A man is waiting for you.å®šå† è¯theçš„ç”¨æ³•è¡¨ç¤ºç‰¹æŒ‡The air in the room is stuffy. Please open the window. (ç‰¹æŒ‡â€œå±‹é‡Œçš„ç©ºæ°”â€)ç”¨äºä¸Šæ–‡ä¸­æåˆ°çš„äº‹ç‰©My father bought a dog just now,and the dog looks cute.ç”¨åœ¨ä¸–ç•Œä¸Šç‹¬ä¸€æ— äºŒçš„äº‹ç‰©æˆ–æ–¹ä½åè¯å‰é¢the universe å®‡å®™ï¼Œthe Eastä¸œæ–¹ç”¨åœ¨åºæ•°è¯ã€å½¢å®¹è¯æœ€é«˜çº§åŠonlyå‰é¢It is the second country they will visit in Asia. è¿™æ˜¯ä»–ä»¬åœ¨äºšæ´²ç¬¬äºŒä¸ªå‚è§‚çš„å›½å®¶ã€‚Autumn is the best season in Beijing. ç§‹å¤©æ˜¯åŒ—äº¬æœ€å¥½çš„å­£èŠ‚ã€‚He is the only student who didnâ€™t pass the exam.ä»–æ˜¯å”¯ä¸€ä¸€ä¸ªæ²¡æœ‰é€šè¿‡è€ƒè¯•çš„å­¦ç”Ÿã€‚ç”¨åœ¨æ±Ÿæ²³ã€æ¹–æµ·ã€å±±è„‰ã€å²›å±¿ç­‰åè¯å‰the River Seineå¡çº³æ²³ç”¨åœ¨ä¹å™¨åè¯å‰play the piano å¼¹é’¢ç´å’ŒæŸäº›å½¢å®¹è¯è¿ç”¨ï¼Œè¡¨ç¤ºä¸€ç±»äººæˆ–äº‹ç‰©ï¼Œæ˜¯å¤æ•°æ¦‚å¿µthe rich å¯Œäººï¼Œthe youngå¹´è½»äººä¸ç”¨å† è¯çš„æƒ…å†µè¡¨ç¤ºä¸‹æ£‹ã€æ‰“çƒã€è¯­è¨€ã€å­¦ç§‘ç­‰play chess, play basketball, speak Englishå‰é¢æœ‰ç‰©ä¸»ä»£è¯ã€æŒ‡ç¤ºä»£è¯ã€â€™sæ‰€æœ‰æ ¼ç­‰é™å®šè¯æ—¶my catï¼Œthese advantagesï¼ŒBillâ€™s cameraä¸“æœ‰åè¯é€šå¸¸ä½¿ç”¨é›¶å† è¯Lu Xi is a great Chinese writer.å­£èŠ‚ã€æœˆä»½ã€æ˜ŸæœŸä»¥åŠèŠ‚å‡æ—¥(ä¸­å›½ä¼ ç»ŸèŠ‚æ—¥é™¤å¤–)ç­‰åè¯å‰Summer begins in June in this part of the country. è¿™ä¸ªåœ°åŒºå¤å¤©ä»å…­æœˆä»½å¼€å§‹ã€‚ä¸‰é¤é¥­èœçš„åè¯å‰é¢have supper åƒæ™šé¥­åœ¨æœ‰å½¢å®¹è¯ä¿®é¥°çš„ç‰©è´¨åè¯ã€æŠ½è±¡åè¯å‰é¢This is the problem of great importance.ç‰¹æ®Šåè¯nature, society, space, man, historyå°ç»“ä¸€æœˆã€å­£ã€æ˜ŸæœŸã€èŠ‚å‡æ—¥ã€ä¸‰é¤ã€çƒç±»ã€å­¦ç§‘ã€æ£‹ç±»ç­‰åè¯å‰ä¸ç”¨å† è¯è¿™å¹…ç”»ç”ŸåŠ¨åœ°æè¿°äº†ä¸€åªæ¯é¸¡æ­£åœ¨åšå‡ºæ‰¿è¯ºã€‚(1998)his picture vividly depicts a hen making a promise.è¿™å¹…ç”»ç”ŸåŠ¨åœ°æè¿°äº†ä¸€ä¸ªç¾å›½å¥³å­©æ­£åœ¨ç©¿ç€ä¸­å›½çš„ä¼ ç»Ÿæœé¥°ï¼Œé¢å¸¦ç”œç¾çš„å¾®ç¬‘ã€‚(2002)This picture vividly depicts an American girl wearing traditional Chinese clothes with a sweet smile.è¿™å¹…ç”»æ­ç¤ºäº†äººç”Ÿå°±åƒæ…¢è·‘çš„è¿‡ç¨‹ï¼Œéœ€è¦æˆ‘ä»¬ä¸æ–­ä»˜å‡ºåŠªåŠ›ï¼Œæ°¸ä¸æ­¢æ­¥ã€‚(2004)This painting reveals that life is like the process of jogging, in which one should make constant efforts and never stop.éšç€å…¨çƒåŒ–è¿›å±•ï¼Œè¿½æ˜Ÿåœ¨é’å°‘å¹´ä¸­éå¸¸æµè¡Œã€‚(2006)With the development of globalization,star-pursuing is very popular among teenagers.è¿™å¹…æ¼«ç”»çš„ç›®çš„æ˜¯è¦å‘Šè¯‰æˆ‘ä»¬ï¼Œè¡ŒåŠ¨å¾ˆé‡è¦ã€‚(2017) The purpose of the cartoon is to tell us that action is important.å‰¯è¯åˆ†ç±»æ—¶é—´: just, recently, before, already, finally, todayåœ°ç‚¹: here, there, nearbyæ–¹å¼: fast, hard, carefully, slowlyç¨‹åº¦: much, little, very, enough, particularlyé¢‘ç‡: usually, often, sometimes, never, always, hardly, constantly, frequently, seldomç”¨æ³•æ—¶é—´ã€åœ°ç‚¹å‰¯è¯å¯ä»¥æ”¾å¥é¦–ï¼Œä¹Ÿå¯ä»¥æ”¾å¥æœ«ã€‚æ”¾å¥æœ«æ—¶ï¼Œå…ˆå†™åœ°ç‚¹ï¼Œå†å†™æ—¶é—´The boy read quietly over there all the afternoon.They encountered their teachers in the street yesterday.ä¿®é¥°å½¢å®¹è¯ï¼Œæ”¾åœ¨å½¢å®¹è¯å‰He is an extremely excellent teacher.ä¿®é¥°åŠ¨è¯ï¼Œå¯ä»¥æ”¾åŠ¨è¯å‰åï¼Œä¹Ÿå¯ä»¥æ”¾å¥æœ«He works very hard.He speaks English very well.æ–¹å¼å‰¯è¯ä¿®é¥°åŠ¨è¯ï¼Œæ”¾å¥æœ«Please read this book carefully.é¢‘ç‡å‰¯è¯æ”¾åœ¨å®ä¹‰åŠ¨è¯å‰ï¼ŒbeåŠ¨è¯åI sometimes have lunch at school.He is always nice to me.ä¿®é¥°æ•´ä¸ªå¥å­ï¼Œæ”¾å¥é¦–Luckily, he survived in the accident.Actually, he is just telling the truth.æ¯”è¾ƒç­‰çº§å‰¯è¯çš„æ¯”è¾ƒç­‰çº§å’Œå½¢å®¹è¯å®Œå…¨ä¸€æ ·ï¼Œåªæ˜¯å½¢å®¹è¯æ˜¯ä¿®é¥°åè¯ï¼Œå‰¯è¯çš„æ¯”è¾ƒç­‰çº§æ˜¯å€¾å‘åŠ¨ä½œçš„æ¯”è¾ƒä¸»è¯­+åŠ¨è¯+å‰¯è¯æ¯”è¾ƒçº§+than+æ¯”è¾ƒå¯¹è±¡He started two hours earlier than we did.He speaks English more fluently than he did before.asâ€¦asâ€¦å’Œnot so/as.as..He can work as well as me.the+æ¯”è¾ƒçº§ï¼Œthe+æ¯”è¾ƒçº§The more constantly we do exercise, the healthier we will be.ä»‹è¯å«ä¹‰ç”¨æ³•</content>
	</entry>
	<entry>
		<title>è¯­æ³•_å®šè¯­å’Œå®šè¯­ä»å¥</title>
		<url>/article/20c5ebba.html</url>
		<content>å®šè¯­ä»å¥å®šè¯­çš„æˆåˆ†å®šè¯­å°±æ˜¯ä¿®é¥°åè¯(çŸ­è¯­)çš„æˆåˆ†ï¼Œè¿™ä¸ä¸­æ–‡ä¸€è‡´ã€‚å¥¹æ˜¯ä¸€åªå–„è‰¯çš„å¤œèºã€‚ã€è§£æã€‘â€å–„è‰¯çš„â€ä¿®é¥°â€å¤œèºâ€ã€‚ä½åœ¨å¹´è½»äººéš”å£çš„é‚£ä¸ªå¥³å­©åº”è¯¥å¾ˆæ¼‚äº®ã€‚ã€è§£æã€‘â€ä½åœ¨å¹´è½»äººéš”å£çš„â€ä¿®é¥°â€é‚£ä¸ªå¥³å­©â€ã€‚å®¶å¢ƒè´«å›°çš„å¹´è½»äººçˆ±ä¸Šäº†æ•™æˆçš„å¥³å„¿ã€‚ã€è§£æã€‘â€å®¶å¢ƒè´«å›°çš„â€ä¿®é¥°â€å¹´è½»äººâ€ï¼›â€æ•™æˆçš„â€ä¿®é¥°â€å¥³å„¿â€ã€‚å…¶å®åªè¦åœ¨ä¸­æ–‡ä¸­å¬åˆ°â€â€¦çš„+åè¯(çŸ­è¯­)â€ï¼Œâ€â€¦çš„â€å°±æ˜¯ä¿®é¥°è¿™ä¸ªåè¯(çŸ­è¯­)çš„å®šè¯­æˆåˆ†èƒ½åšå®šè¯­çš„æˆåˆ†ä¸»è¦åŒ…æ‹¬äº†ä»¥ä¸‹å‡ ç§ï¼šå½¢å®¹è¯(çŸ­è¯­)ä½œå®šè¯­é‚£åªå–„è‰¯çš„å¤œèºæœ€åæ­»äº†ã€‚That kind nightingale died at last.è¿™æœµéå‡¡çš„ç«ç‘°èŠ±å˜æˆäº†æ·±çº¢è‰²ã€‚The extraordinary rose turns dark red.åè¯(çŸ­è¯­)ä½œå®šè¯­ï¼Œæ­¤æ—¶çš„åè¯(çŸ­è¯­)å·²ç»å½¢å®¹è¯åŒ–äº†å¤œèºçš„æ­Œå£°èƒ½ä½¿è¿™æœµç«ç‘°èŠ±å¼€æ”¾ã€‚The nightingaleâ€™s singing can make the rose bloom.æˆ– The singing of the nightingale can make the rose bloom.åˆ‡è®°å†™ä½œæ—¶å‡ ä¹æ¯ä¸ªåŒå­¦éƒ½ä¼šå¿½ç•¥çš„çŸ¥è¯†ç‚¹ï¼šå¯æ•°åè¯é€šå¸¸ä¸èƒ½å•ç‹¬ä½¿ç”¨ï¼Œå¿…é¡»æœ‰ä¿®é¥°æˆåˆ†ï¼›å¦‚æœå•ç‹¬ä½¿ç”¨ï¼Œéœ€è¦åœ¨åè¯å‰åŠ theæˆ–aï¼Œæˆ–è€…ç”¨å¤æ•°å½¢å¼ã€‚å­¦ç”Ÿçˆ±ä¸Šäº†æ•™æˆçš„å¥³å„¿ã€‚The student falls in love with the professorâ€™s daughter.æˆ– The student falls in love with the daughter of the professor.æ€»ç»“: è™½ç„¶åè¯(çŸ­è¯­)ä¿®é¥°åè¯(çŸ­è¯­)æœ‰ä¸¤ç§å†™æ³•ï¼Œä½†æ˜¯è‹±æ–‡è¿˜æ˜¯æ›´å€¾å‘äºå†™æˆofç»“æ„ã€‚ä»‹è¯çŸ­è¯­ä½œå®šè¯­çª—å¤–çš„å¤œèºå¬åˆ°äº†å¹´è½»äººçš„æ„Ÿå¹ã€‚The nightingale out of the window heard the sighs of the young man.æˆ‘åªæœ‰å’Œå¤§æµ·çš„æµªèŠ±æ²«ä¸€æ ·ç™½çš„ç«ç‘°èŠ±ã€‚I only have roses as white as the foam in the sea.åˆ†è¯ã€ä¸å®šå¼(éæƒ¯è¯­)ä½œå®šè¯­å”±æ­Œçš„å¤œèºæœ€ç»ˆå› çˆ±è€Œæ­»ã€‚In the end,the sing nightingale died because of love.è¿™å¥è¯è¡¨è¿°æ­£ç¡®å—ï¼Ÿæ˜¾ç„¶ï¼Œè¿™å¥è¯æœ‰ä¸¤ä¸ªåŠ¨è¯ï¼Œè®°å¾—ç®€å•å¥ä¸­é‡å¤è¿‡æ— æ•°éçš„ä¸œè¥¿å—?ä¸€å¥è¯åªèƒ½æœ‰ä¸€ä¸ªåŠ¨è¯ä½œè°“è¯­ï¼Œé‚£singæ€ä¹ˆå¤„ç†å‘¢ï¼Ÿéœ€è¦å°†å…¶å˜æˆä¸æ˜¯åŠ¨è¯çš„å½¢å¼ã€‚å› ä¸ºæ­¤å¤„åŠ¨ä½œè¡¨ç¤ºä¸»åŠ¨ï¼Œæ‰€ä»¥singååŠ -ingï¼šIn the end,the singing nightingale died because of love.å•çº¯çš„å¤œèºä¸€å®šæ˜¯çˆ±ä¸Šäº†é‚£ä¸ªè¢«å¥³å­©æ¬ºéª—çš„å­¦ç”Ÿã€‚The innocent nightingale must have loved the student deceived by the girl.å› ä¸ºè¡¨ç¤ºè¢«åŠ¨ï¼Œæ‰€ä»¥deceive ååŠ -edã€‚ä»å¥ä½œå®šè¯­å¤œèºç”¨ç”Ÿå‘½æ¢æ¥çš„ç«ç‘°èŠ±å¹¶æ²¡æœ‰å¸®åŠ©åˆ°é‚£ä¸ªå­¦ç”Ÿã€‚The rose which the nightingale exchanged with her life failed to help the student.å®šè¯­ä½ç½®æ¯«æ— ç–‘é—®ï¼Œä¸­æ–‡æ€»æ˜¯æŠŠå®šè¯­æ”¾åˆ°åè¯å‰ï¼Œä½†æ˜¯è‹±æ–‡ä¸æ˜¯è¿™æ ·ï¼Œé‚£è‹±æ–‡ä¸­å®šè¯­åˆ°åº•æ˜¯æ”¾åœ¨åè¯(çŸ­è¯­)å‰è¿˜æ˜¯åè¯(çŸ­è¯­)åå‘¢?è¯·å›çœ‹å‰é¢å®šè¯­çš„æˆåˆ†ï¼Œä½ ä¼šå‘ç°ä¸€ä¸ªè§„å¾‹ï¼Œé‚£å°±æ˜¯â€å‰å°åå¤§â€œï¼Œä¹Ÿå°±æ˜¯è¯´å®šè¯­çš„ä½ç½®å–å†³äºå®ƒçš„é•¿çŸ­å½“ä¸€ä¸ªå•è¯ä¿®é¥°åè¯(çŸ­è¯­)æ—¶é€šå¸¸æ”¾åœ¨åè¯(çŸ­è¯­)å‰é¢å½“ä¸¤ä¸ªä»¥ä¸Šçš„å•è¯ä¿®é¥°åè¯(çŸ­è¯­)æ—¶é€šå¸¸æ”¾åœ¨åè¯(çŸ­è¯­)åé¢ä½†æ˜¯ï¼Œæ³¨æ„è¿‡å»åˆ†è¯ä½œå®šè¯­ï¼Œå³ä½¿æ˜¯ä¸€ä¸ªå•è¯é€šå¸¸ä¹Ÿæ”¾åœ¨åè¯(çŸ­è¯­)åã€‚ä»–æ˜¯ä¸€ä¸ªè¢«æŠ›å¼ƒçš„ç”·äººã€‚ He is a man abandoned.æ„æˆä¸å¼•å¯¼è¯æ„æˆæˆåˆ†ï¼šå…ˆè¡Œè¯[åè¯(çŸ­è¯­)] + å¼•å¯¼è¯ + åˆ†å¥å®šè¯­ä»å¥çš„å¼•å¯¼è¯æŒ‰ç…§å…ˆè¡Œè¯çš„ç§ç±»ï¼Œä¸€å…±åˆ†æˆäº”ç±»ï¼šå½“å…ˆè¡Œè¯æ˜¯äººæ—¶ï¼Œå¼•å¯¼è¯æœ‰ï¼šwho, whom, whoseå½“å…ˆè¡Œè¯æ˜¯ç‰©æ—¶ï¼Œå¼•å¯¼è¯æœ‰ï¼šthat, which, whoseå½“å…ˆè¡Œè¯æ˜¯æ—¶é—´æ—¶ï¼Œå¼•å¯¼è¯æœ‰ï¼šthat, which, whenå½“å…ˆè¡Œè¯æ˜¯åœ°ç‚¹æ—¶ï¼Œå¼•å¯¼è¯æœ‰ï¼šthat, which, whereå½“å…ˆè¡Œè¯æ˜¯åŸå› æ—¶ï¼Œå¼•å¯¼è¯æœ‰ï¼šthat, which, whyåœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œthatéƒ½ç­‰åŒäºwhichï¼Œè¿™ç§åˆ†ç±»çš„æ–¹æ³•ç¼©å°äº†å¼•å¯¼è¯å¯é€‰çš„èŒƒå›´ï¼Œæ¯”å¦‚è¯´å½“å…ˆè¡Œè¯æ˜¯äººæ—¶ï¼Œå¯ä»¥é¦–å…ˆæ’é™¤whereä¾‹å­He is the man __ loves me.He is the man __ I love.He is the man __ father is wealthy.ä»¥ä¸Šä¸‰é“é¢˜å…ˆè¡Œè¯éƒ½ä¸€æ ·ï¼Œç›¸ä¿¡å¤§éƒ¨åˆ†åŒå­¦éƒ½èƒ½å¡«æ­£ç¡®ã€‚ä¸‰é“é¢˜çš„å¼•å¯¼è¯åˆ†åˆ«æ˜¯ï¼šwhoã€who/whomå’Œwhoseå¥1ä¸­å…ˆè¡Œè¯æ˜¯äººï¼Œåªèƒ½ä»ä¸‰ä¸ªå•è¯whoï¼Œwhomï¼Œwhoseä¸­é€‰æ‹©ï¼Œé‚£åˆ°åº•é€‰å“ªä¸ªå•è¯å‘¢?è®©æˆ‘ä»¬çœ‹çœ‹ä»å¥å§ï¼Œæ˜¾ç„¶ä»å¥ä¸­ç¼ºå°‘ä¸»è¯­ã€‚å†çœ‹ä»¥ä¸Šä¸‰ä¸ªå¼•å¯¼è¯who,whomï¼Œwhoseã€‚whoç”¨ä½œå…³ç³»ä»£è¯æ—¶ï¼Œæ„æ€æ˜¯â€¦çš„äººï¼Œé‚£ä¸ªâ€¦â€ä»–ï¼›å¥¹ï¼›ä»–ä»¬â€ï¼Œä¸€èˆ¬åªç”¨æ¥æŒ‡äººï¼Œåœ¨ä»å¥ä¸­å¯ä»¥å……å½“ä¸»è¯­æˆ–å®¾è¯­ï¼›whomç”¨ä½œå…³ç³»ä»£è¯æ—¶ä¸whoåŒä¹‰ï¼Œä¸€èˆ¬åªç”¨æ¥æŒ‡äººï¼Œåœ¨ä»å¥ä¸­åªèƒ½å……å½“å®¾è¯­whoseç”¨ä½œå…³ç³»ä»£è¯æ—¶ï¼Œæ„æ€æ˜¯â€œé‚£ä¸ªäººçš„ï¼Œé‚£äº›äººçš„ï¼›é‚£ä¸€ä¸ªçš„ï¼Œé‚£ä¸€äº›çš„â€ï¼Œæ—¢å¯æŒ‡äººï¼Œä¹Ÿå¯æŒ‡ç‰©ï¼Œä½†åªèƒ½åœ¨ä»å¥ä¸­å……å½“å®šè¯­å¥1ä¸­ä»å¥ç¼ºä¸»è¯­ï¼Œæ‰€ä»¥å¡«whoï¼›å¥2ä¸­ä»å¥ç¼ºå®¾è¯­ï¼Œæ‰€ä»¥å¡«whoå’Œwhomå‡å¯ï¼›å¥3ä¸­ä»å¥ä¸»ç³»è¡¨éƒ½ä¸ç¼ºï¼Œæ˜¾ç„¶ä¸å¯èƒ½å¡«whoå’Œwhomï¼Œé‚£whoseåˆšå¥½ä½œå®šè¯­ï¼Œä¿®é¥°fatherä¾‹å­I will never forget the day __ I met you.I will never forget the day __ we spent.å…ˆè¡Œè¯æ˜¯the dayï¼Œè¡¨ç¤ºæ—¶é—´ï¼Œæ‰€ä»¥å¼•å¯¼è¯å°±æ˜¯which/that/whenï¼Œä¸€èˆ¬æƒ…å†µä¸‹that=which,ä»¥å¥4ã€5å°±æœ‰ä¸¤ä¸ªå¼•å¯¼è¯å¯é€‰ï¼Œè¦ä¹ˆæ˜¯which/thatï¼Œè¦ä¹ˆæ˜¯whenthat/whichæ˜¾ç„¶æ˜¯ä»£è¯ï¼Œå¯ä»¥åœ¨ä»å¥ä¸­å……å½“ä¸»è¯­æˆ–å®¾è¯­ï¼Œwhenæ˜¯å‰¯è¯ï¼Œä¸èƒ½å……å½“ä¸»è°“å®¾å¥4ä¸­ä»å¥ä¸ç¼ºä¸»è°“å®¾ï¼Œä¸æ­£å¥½å¡« whenå—ï¼Œå¥5åˆ™ä¸åŒï¼Œä»å¥ç¼ºå®¾è¯­ï¼Œåªèƒ½å¡« which/thatä¾‹å­You had better have some reason __ you are late.You had better have some reason __ sounds perfect.åŒä¸Šï¼Œå¥6å¡«whyï¼Œå› ä¸ºwhyæ˜¯å‰¯è¯ï¼Œè€Œä»å¥ä¸­ä¸ç¼ºä¸»è°“å®¾ã€‚å¥7å¡«which/thatï¼Œå› ä¸ºä»å¥ä¸­ç¼ºä¸»è¯­çš„æˆåˆ†æ‰€ä»¥ï¼Œæ ¹æ®æˆ‘ä»¬å‰é¢çš„è®ºè¿°ï¼Œå®šè¯­ä»å¥çš„å¼•å¯¼è¯ä¹Ÿå¯ä»¥æŒ‰ç…§å¼•å¯¼è¯æœ¬èº«çš„è¯æ€§æˆ–è€…æŒ‰ç…§å¼•å¯¼è¯åœ¨ä»å¥ä¸­å……å½“çš„æˆåˆ†åˆ†ä¸ºä¸‰ç±»ï¼šä»£è¯(åœ¨ä»å¥ä¸­å……å½“ä¸»è¯­æˆ–å®¾è¯­çš„æˆåˆ†)ï¼šwho, whom(åœ¨ä»å¥ä¸­ä»…èƒ½å……å½“å®¾è¯­çš„æˆåˆ†)ï¼Œthatï¼Œwhichå‰¯è¯(åœ¨ä»å¥ä¸­ä¸èƒ½å……å½“ä¸»å¹²æˆåˆ†)ï¼šwhere, when, whyå½¢å®¹è¯[åœ¨ä»å¥ä¸­åªèƒ½å……å½“å®šè¯­æˆåˆ†ï¼Œä¿®é¥°åè¯(çŸ­è¯­)]ï¼šwhoseç‰¹æ®Šç”¨æ³•thatå¼•å¯¼çš„ä»å¥that å¼•å¯¼å®šè¯­ä»å¥æ—¶ï¼Œå¦‚æœåœ¨ä»å¥ä¸­å……å½“å®¾è¯­ï¼Œthat å¯ä»¥çœç•¥æ¯”å¦‚I enjoy the movie Zhao Wei directedï¼Œåœ¨åè¯movieå’ŒZhao Weiä¹‹é—´å°±çœç•¥äº†thatæ‰€ä»¥ï¼Œå½“åˆ†æé•¿éš¾å¥æ—¶å¦‚æœè§åˆ°ä¸¤ä¸ªåè¯(çŸ­è¯­)ç›´æ¥æ”¾åœ¨ä¸€èµ·ï¼Œå¾ˆå¯èƒ½æ˜¯çœç•¥äº†thatçš„å®šè¯­ä»å¥ä¾‹å­The potential evolution of todayâ€™s technology,and its social consequences,is dazzlingly complicated,and itâ€™s perhaps best left to science-fiction writers and futurologists to explore the many possibilities we can envisage.è¯¥å¥å­ç”±andè¿æ¥çš„ä¸¤ä¸ªå¹¶åˆ—åˆ†å¥æ„æˆã€‚ç¬¬äºŒä¸ªåˆ†å¥ä¸­åˆåŒ…å«ä¸€ä¸ªå®šè¯­ä»å¥we can envisageï¼Œçœç•¥äº†å¼•å¯¼è¯thatï¼Œç”¨æ¥ä¿®é¥° possibilitiesã€‚ã€å‚è€ƒç¿»è¯‘ã€‘ç°ä»£æŠ€æœ¯çš„æ½œåœ¨å‘å±•å’Œå®ƒäº§ç”Ÿçš„ç¤¾ä¼šå½±å“æ˜¯æå…¶å¤æ‚çš„ï¼Œæ‰€ä»¥æœ€å¥½æ˜¯æŠŠå®ƒ ä»¬ç•™ç»™ç§‘å¹»å°è¯´å®¶å’Œæœªæ¥å­¦å®¶å»å‘æ˜æˆ‘ä»¬æ‰€èƒ½æƒ³è±¡åˆ°çš„è®¸è®¸å¤šå¤šçš„å¯èƒ½æ€§ã€‚A young man can decide on a likely spouse on his own and then ask his parents to arrange the marriage negotiations,or the young manâ€™s parents may make the choice of a spouse,giving the child little to say in the selection,but a girl may veto the spouse her parents have chosen.è¯¥å¥å­ç”±orå’Œbutè¿æ¥çš„ä¸‰ä¸ªå¹¶åˆ—åˆ†å¥æ„æˆåœ¨ç¬¬ä¸€ä¸ªå¹¶åˆ—åˆ†å¥A young man can decide on a likely spouse on his own and then ask his parents to arrange the marriage negotiations ä¸­ï¼ŒåˆåŒ…å«ä¸¤ä¸ªå°çš„å¹¶åˆ—ç»“æ„ï¼Œç”±andè¿æ¥åœ¨ç¬¬äºŒä¸ªå¹¶åˆ—åˆ†å¥the young manâ€™s parents may make the choice of a spouse,giving the child little to say in the selection ä¸­,the young manâ€™s parents may make the choice of a spouse æ˜¯ä¸»å¹²ï¼Œgiving the child little to say in the selectionæ˜¯ç°åœ¨åˆ†è¯çŸ­è¯­ ä½œç»“æœçŠ¶è¯­ï¼Œä¿®é¥°ä¸»å¹²ç¬¬ä¸‰ä¸ªå¹¶åˆ—åˆ†å¥a girl may veto the spouse her parents have chosenåŒ…å«ä¸€ ä¸ªçœç•¥äº†å¼•å¯¼è¯that çš„å®šè¯­ä»å¥her parents have chosenï¼Œå¼•å¯¼è¯thatåœ¨ä»å¥ä¸­ä½œå®¾è¯­ï¼Œå› è€Œå¯ä»¥çœç•¥ï¼Œç”¨æ¥ä¿®é¥°spouseã€å‚è€ƒç¿»è¯‘ã€‘å¹´è½»ç”·å£«å¯ä»¥è‡ªå·±å†³å®šåˆé€‚çš„é…å¶ï¼Œç„¶åè¯·çˆ¶æ¯å®‰æ’å©šå§»åå•†äº‹å®œï¼›æˆ–è€…çˆ¶æ¯ä¹Ÿå¯èƒ½ä¸ºå„¿å­æ‹©å¥½é…å¶ï¼Œåœ¨é€‰æ‹©ä¸­ä¸ç»™å„¿å­ç•™æœ‰è¯´è¯çš„ä½™åœ°ï¼›ä½†æ˜¯å¥³æ–¹å´å¯ä»¥æ‹’ç»å¥¹çˆ¶æ¯æ‰€é€‰æ‹©çš„å¯¹è±¡ã€‚é™åˆ¶æ€§å’Œéé™åˆ¶æ€§æèµ·å®ƒä»¬çš„åŒºåˆ«ï¼Œå¤§å®¶èƒ½æƒ³åˆ°çš„å°±æ˜¯â€,â€ï¼›æˆ–è€…æ˜¯é™åˆ¶ç”¨thatï¼Œéé™åˆ¶ç”¨whichï¼Œå…¶å®å®ƒä»¬æœ€å¤§çš„åŒºåˆ«ä¸åœ¨äºæ­¤I love teacher Liu who is beautiful.I love teacher Liu, who is beautiful.å¥1ç¿»è¯‘æˆï¼šæˆ‘çˆ±æ¼‚äº®çš„åˆ˜è€å¸ˆã€‚å¥2ç¿»è¯‘æˆï¼šæˆ‘çˆ±åˆ˜è€å¸ˆï¼Œå¥¹æŒºæ¼‚äº®çš„ã€‚ã€è§£æã€‘èƒ½çœ‹å‡ºä»€ä¹ˆåŒºåˆ«ï¼Ÿå¥1æš—å«çš„æ„æ€ï¼šå¦‚æœæœ‰ä¸€å¤©æˆ‘è€äº†æˆ–è¢«æ¯å®¹äº†ï¼Œä½ å°±ä¸å†çˆ±æˆ‘äº†ã€‚å¥2åˆ™ä¸åŒï¼šå³ä½¿æˆ‘ä¸ç¾äº†ï¼Œä½ ä»ç„¶çˆ±ç€æˆ‘ï¼Œå› ä¸ºä½ çˆ±çš„ä¸æ˜¯æˆ‘çš„ç¾ï¼Œè€Œæ˜¯æˆ‘ã€‚å†æ¯”å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­A nurse is a person who looks after patients.Tomâ€™s father, who is over sixty, still works very hard.å¥1ç¿»è¯‘æˆï¼šæŠ¤å£«æ˜¯ç…§é¡¾ç—…äººçš„äººã€‚å¥2ç¿»è¯‘æˆï¼šæ±¤å§†çš„çˆ¶äº²ä¾ç„¶å¾ˆåŠªåŠ›å·¥ä½œï¼Œä»–å·²ç»å¹´è¿‡å…­æ—¬äº†ã€‚å¥1æ˜¯ä¸€ä¸ªé™åˆ¶æ€§å®šè¯­ä»å¥ï¼Œè¿™ä¸ªå®šè¯­ä»å¥å¦‚æœå»æ‰äº†å°±ç¿»è¯‘æˆï¼šæŠ¤å£«æ˜¯ä¸€ä¸ªäººï¼Œé‚£å¾ˆæ˜æ˜¾æ²¡æœ‰æ„ä¹‰å¥2æ˜¯ä¸€ä¸ªéé™åˆ¶æ€§å®šè¯­ä»å¥ï¼Œå®šè¯­ä»å¥å¯ä»¥å»æ‰ï¼Œå› ä¸ºå®ƒä»…ä»…èµ·åˆ°ä¸€ä¸ªè¡¥å……è¯´æ˜çš„ä½œç”¨ï¼Œç›¸å½“äºæ’å…¥è¯­ã€‚å»æ‰å®šè¯­ä»å¥åä¾ç„¶æœ‰æ„ä¹‰ï¼Œå¯ç¿»è¯‘æˆï¼šæ±¤å§†çš„çˆ¶äº²ä¾ç„¶å¾ˆåŠªåŠ›å·¥ä½œã€‚å°ç»“é™åˆ¶æ€§å®šè¯­ä»å¥å’Œéé™åˆ¶æ€§å®šè¯­ä»å¥çš„åŒºåˆ«é™åˆ¶æ€§å®šè¯­ä»å¥ï¼šå®šè¯­ä»å¥ç´§è·Ÿåœ¨å…ˆè¡Œè¯åï¼Œå¯¹å…ˆè¡Œè¯è¿›è¡Œä¿®é¥°ï¼Œä¸èƒ½çœç•¥ï¼Œçœç•¥åæ„æ€ä¸å®Œæ•´ã€‚éé™åˆ¶æ€§å®šè¯­ä»å¥ï¼šå¯¹å‰é¢çš„å…ˆè¡Œè¯æˆ–è€…æ•´ä¸ªå¥å­è¿›è¡Œè¡¥å……è¯´æ˜ï¼Œå³ä½¿çœç•¥ä¹Ÿä¸å½±å“æ€»ä½“æ„æ€ï¼Œæœ‰é€—å·éš”å¼€æ‰€ä»¥éé™åˆ¶æ€§å®šè¯­ä»å¥çš„ç‰¹ç‚¹æœ‰ä¸¤ä¸ªï¼šç¬¬ä¸€ï¼Œå¯ä»¥çœç•¥ï¼›ç¬¬äºŒï¼Œèµ·åˆ°è¡¥å……è¯´æ˜ä½œç”¨| ä»å¥åŠåŒºåˆ«ç‚¹               | é™åˆ¶æ€§å®šè¯­ä»å¥               | éé™åˆ¶æ€§å®šè¯­ä»å¥                                   || â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” | â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” | â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” || ä¸å…ˆè¡Œè¯çš„å…³ç³»             | å…³ç³»ç´§å¯†ï¼Œåˆ é™¤åå½±å“å¥å­æ„æ€ | å½±å“å…³ç³»ç–æ¾ï¼Œèµ·è¡¥å……è¯´æ˜ä½œç”¨ï¼Œåˆ é™¤åä¸å½±å“ä¸»å¥æ„æ€ || é€—å·çš„ä½œç”¨                 | ä¸ç”¨é€—å·                     | ç”¨é€—å·                                             || thatçš„ä½œç”¨                 | å¯ä»¥ç”¨that                   | ä¸å¯ç”¨that                                         || which/whomåœ¨ä»å¥ä¸­ä½œå¯çœç•¥ | å¯çœç•¥                       | ä¸å¯çœç•¥                                           || æ˜¯å¦å¯ä»¥ä¿®é¥°å¥å­           | ä¸å¯ä»¥                       | å¯ä»¥                                               || ç¿»è¯‘æ—¶çš„åŒºåˆ«               | å¸¸è¯‘ä¸ºå®šè¯­                   | å¸¸è¯‘ä¸ºä¸¤ä¸ªç‹¬ç«‹çš„å¥å­                               |éé™åˆ¶æ€§å®šè¯­ä»å¥çš„å¼•å¯¼è¯éé™åˆ¶æ€§å®šè¯­ä»å¥çš„å¼•å¯¼è¯ä¸èƒ½ç”¨thatï¼Œä½†é€‰æ‹©æ–¹æ³•å’Œé™åˆ¶æ€§å®šè¯­ä»å¥çš„å¼•å¯¼è¯æ˜¯ä¸€æ ·çš„ï¼Œå½“å…ˆè¡Œè¯æ˜¯äººæˆ–ç‰©çš„æ—¶å€™ï¼Œå¼•å¯¼è¯è¦ç”¨who/whichã€‚å¦‚ï¼šMr.Smith, whom I have learned a lot from, is a nice person.Mr.Smithæ˜¯äººï¼Œä¸”åœ¨ä»å¥ä¸­ä½œå®¾è¯­ï¼Œæ‰€ä»¥å¼•å¯¼è¯ç”¨whomã€‚å²å¯†æ–¯å…ˆç”Ÿæ˜¯ä¸€ä¸ªå¥½äººï¼Œåœ¨ä»–èº«ä¸Šæˆ‘å­¦åˆ°äº†å¾ˆå¤šã€‚He said he had climbed up the top of the Everest, which I suspect very much.æœ¬å¥ä¸­çš„éé™åˆ¶æ€§å®šè¯­ä»å¥æ˜¯å¯¹å‰é¢çš„å¥å­è¿›è¡Œè¡¥å……è¯´æ˜ï¼Œæ‰€ä»¥å¼•å¯¼è¯ç”¨whichã€‚ä»–è¯´ä»–çˆ¬ä¸Šäº†ç ç©†æœ—ç›å³°ä¹‹å·…ï¼Œæˆ‘å¯¹æ­¤è¡¨ç¤ºååˆ†æ€€ç–‘ã€‚My gardener, who is very pessimistic, says that there will be no apples this year.å…ˆè¡Œè¯æ˜¯äººï¼Œæœ¬è¯¥ç”¨who/hat,ä½†è¿™æ˜¯ä¸€ä¸ªéé™åˆ¶æ€§å®šè¯­ä»å¥ï¼Œåªèƒ½ç”¨who,è€Œä¸èƒ½ç”¨thatã€‚æˆ‘å®¶çš„å›­ä¸éå¸¸æ‚²è§‚ï¼Œä»–è¯´ä»Šå¹´å°†ä¸ç»“è‹¹æœã€‚éé™åˆ¶æ€§å®šè¯­ä»å¥çš„ç¿»è¯‘æ–¹æ³•å¦‚æœä¿®é¥°å‰é¢çš„åè¯ï¼Œå¸¸å¸¸ç¿»è¯‘æˆä¸¤ä¸ªç‹¬ç«‹çš„å¥å­ã€‚å¦‚ï¼šEdison,whose inventions have been over 2,000, is a famous scientist.çˆ±è¿ªç”Ÿæ˜¯ä¸€ä¸ªä¼Ÿå¤§çš„ç§‘å­¦å®¶ï¼Œä»–çš„å‘æ˜è¶…è¿‡äº†ä¸¤åƒé¡¹ã€‚Above the trees are the mountains, whose magnificence faithfully reflects on the surface ofthe river.æ ‘æ—çš„ä¸Šæ–¹æ˜¯å±±ï¼Œå…¶å£®ä¸½çš„æ™¯è‰²å®Œå…¨æ˜ ç…§åœ¨æ²³é¢ä¸Šã€‚These apple trees, which I planted three years ago, have not borne any fruit.è¿™äº›è‹¹æœæ ‘æ˜¯æˆ‘ä¸‰å¹´å‰æ ½çš„ï¼Œè¿˜æ²¡æœ‰ç»“è¿‡æœå®ã€‚France,which prides itself as the global innovator of fashion, has decided its fashion industryhas lost an absolute right to define physical beauty for women.æ³•å›½ä¸€ç›´ä»¥å…¨çƒæ—¶å°šé©æ–°è€…çš„èº«ä»½è‡ªå±…ï¼Œä½†ç°åœ¨å®ƒè®¤ä¸ºï¼Œå…¶æ—¶å°šè¡Œä¸šå·²å¤±å»å®šä¹‰å¥³å£«å½¢ä½“ç¾çš„ç»å¯¹æƒåŠ›ã€‚å¦‚æœå¼•å¯¼è¯æ˜¯å¯¹å‰é¢å¥å­è¿›è¡Œè¡¥å……è¯´æ˜å¹¶ä¸”å……å½“ä»å¥ä¸»è¯­æ—¶ï¼Œå¸¸å¸¸ç¿»è¯‘æˆâ€è¿™ï¼›å®ƒï¼›é‚£â€ï¼›å……å½“å…¶ä»–æˆåˆ†æ—¶ï¼Œåˆ™è¦æ ¹æ®æ±‰è¯­çš„è¯­è¨€ä¹ æƒ¯æ¥ç¿»è¯‘ã€‚The picture is fairly thought-provoking, which intends to convey to us this message.whichå¼•å¯¼çš„æ˜¯ä¸€ä¸ªéé™åˆ¶æ€§å®šè¯­ä»å¥ï¼Œwhichä»£æ›¿å‰é¢æ•´ä¸ªä¸»å¥çš„å†…å®¹ï¼Œå……å½“ä»å¥ä¸»è¯­ï¼Œèµ·åˆ°è¡¥å……è¯´æ˜çš„ä½œç”¨ï¼Œå› æ­¤åº”è¯¥æ ¹æ®æ±‰è¯­çš„è¯­è¨€ä¹ æƒ¯ï¼Œå°†whchç¿»è¯‘æˆï¼šå®ƒã€‚è¿™å¹…å›¾ç‰‡å¾ˆä»¤äººæ·±æ€ï¼Œå®ƒæƒ³å‘æˆ‘ä»¬ä¼ è¾¾è¿™ä¸ªä¿¡æ¯ã€‚The two policemen were completely trusted, which in fact they were.whichå¼•å¯¼çš„æ˜¯ä¸€ä¸ªéé™åˆ¶æ€§å®šè¯­ä»å¥ï¼Œwhichä»£æ›¿å‰é¢æ•´ä¸ªä¸»å¥çš„å†…å®¹ï¼Œèµ·åˆ°è¡¥å……è¯´æ˜çš„ä½œç”¨ï¼Œè¡¨ç¤ºè¿™ä»¶äº‹ç¡®å®å¦‚æ­¤ã€‚whichåœ¨ä»å¥ä¸­ä¸ä½œä¸»è¯­ï¼Œè€Œæ˜¯è¡¨è¯­ã€‚å› æ­¤è¿™ä¸ªæ—¶å€™å°±ä¸èƒ½ç¿»è¯‘æˆâ€è¿™ï¼›å®ƒï¼›é‚£â€ï¼Œåº”è¯¥æ ¹æ®æ±‰è¯­çš„è¯­è¨€ä¹ æƒ¯æ¥ç¿»è¯‘ï¼Œä½¿å¥å­é€šé¡ºã€‚é‚£ä¸¤ä¸ªè­¦å¯Ÿå®Œå…¨å—åˆ°ä¿¡ä»»ï¼Œäº‹å®ä¸Šä¹Ÿç¡®å®å¦‚æ­¤ã€‚He was little tense in the presence of so many people, which was understandable.whichå¼•å¯¼çš„æ˜¯ä¸€ä¸ªéé™åˆ¶æ€§å®šè¯­ä»å¥ï¼Œwhichä»£æ›¿å‰é¢æ•´ä¸ªä¸»å¥çš„å†…å®¹ï¼Œå……å½“ä»å¥ä¸»è¯­ï¼Œèµ·åˆ°è¡¥å……è¯´æ˜çš„ä½œç”¨ï¼Œå› æ­¤åº”è¯¥æ ¹æ®æ±‰è¯­çš„è¯­è¨€ä¹ æƒ¯ï¼Œå°†wichç¿»è¯‘æˆï¼šè¿™ã€‚ä»–åœ¨é‚£ä¹ˆå¤šäººé¢å‰æœ‰ç‚¹ç´§å¼ ï¼Œè¿™æ˜¯å¯ä»¥ç†è§£çš„ã€‚He helped popularize the idea that some diseases not previously thought to have a bacterial cause were actually infections, which aroused much controversy when it was first suggested.whichå¼•å¯¼çš„æ˜¯ä¸€ä¸ªéé™åˆ¶æ€§å®šè¯­ä»å¥ï¼Œwhichä»£æ›¿å‰é¢æ•´ä¸ªä¸»å¥çš„å†…å®¹ï¼Œå……å½“ä»å¥ä¸»è¯­ï¼Œèµ·åˆ°è¡¥å……è¯´æ˜çš„ä½œç”¨ã€‚å› æ­¤åº”è¯¥æ ¹æ®æ±‰è¯­çš„è¯­è¨€ä¹ æƒ¯ï¼Œå°†whichç¿»è¯‘æˆï¼šè¿™ä¸€è§‚ç‚¹ã€‚ä»–å¸®åŠ©æ™®åŠäº†ä¸€ç§è§‚ç‚¹ï¼Œå³æŸäº›ä»¥å‰è¢«è®¤ä¸ºä¸æ˜¯ç”±ç»†èŒå¯¼è‡´çš„ç–¾ç—…å®é™…ä¸Šä¹Ÿæ˜¯ä¼ æŸ“ç—…ï¼Œè¿™ä¸€è§‚ç‚¹åœ¨é¦–æ¬¡æå‡ºæ—¶å°±å¼•èµ·äº†å¾ˆå¤šäº‰è®®ã€‚  ä»‹è¯+å…³ç³»ä»£è¯å¼•å¯¼çš„å®šè¯­ä¸ºä»€ä¹ˆä¼šæœ‰â€ä»‹è¯+å…³ç³»ä»£è¯â€å¼•å¯¼å®šè¯­ä»å¥åœ¨ä»¥ä¸‹æƒ…å†µä¸‹çš„å®šè¯­ä»å¥ä¸ºäº†ä½¿å¾—å¥å¼ç»“æ„ä¼˜ç¾æ•´æ´ï¼Œå¯ä»¥å°†ä»‹è¯æå‰åˆ°å…ˆè¡Œè¯å‰ï¼Œæ„æˆäº†â€ä»‹è¯+å…³ç³»ä»£è¯â€å¼•å¯¼å®šè¯­ä»å¥ã€‚å…³ç³»å‰¯è¯åœ¨å®šè¯­ä»å¥ä¸­ä½œçŠ¶è¯­æ—¶ï¼Œå¯ä»¥ç”¨â€œä»‹è¯+å…³ç³»ä»£è¯â€ä»£æ›¿å…³ç³»å‰¯è¯ï¼Œä½†ä½œå®¾è¯­æ—¶ä¸å¯ä»¥æ›¿æ¢This is the city where I have lived for 20 years. = This is the city in which I have lived for 20 years.whenï¼šæ‰€æœ‰ä»‹è¯+å…³ç³»ä»£è¯whereï¼šæ‰€æœ‰ä»‹è¯+å…³ç³»ä»£è¯whyï¼šå½“å…ˆè¡Œè¯æ˜¯reasonæ—¶ï¼Œåªèƒ½ç”¨for whichä½“è¯´åˆ°ä»‹è¯æ ¹æ®å¥å­çš„æ„æ€æ¥é€‰æ‹©å®šè¯­ä»å¥çš„è°“è¯­æ˜¯å›ºå®šæ­é…çš„â€åŠ¨è¯+ä»‹è¯â€ï¼Œå¹¶ä¸”å…ˆè¡Œè¯åœ¨ä»å¥ä¸­ä½œå®¾è¯­ã€‚å¦‚ï¼šThis is a subject about which we might argue for a long while.æ³¨æ„å›ºå®šæ­é…argue aboutï¼Œç¿»è¯‘: è¿™æ˜¯ä¸€ä¸ªæˆ‘ä»¬å¯èƒ½è¦é•¿æ—¶é—´äº‰è®ºçš„é—®é¢˜ã€‚ç”¨äºè¡¨è¾¾ä¸ä¸Šæ–‡ä¸­çš„å…ˆè¡Œè¯æˆ–è€…å¥å­çš„å…³ç³»ï¼Œå¹¶é¿å…ä¸‹æ–‡ä¸ä¸Šæ–‡çš„é‡å¤ã€‚å¦‚ï¼šPlying basketball is a beneficial exercise from which we can obtain many advantages.whichæŒ‡ä»£å‰é¢çš„ç¯®çƒè¿åŠ¨ï¼Œå¦‚æœå†å†™ä¸€éè¿™é¡¹è¿åŠ¨ï¼Œå°±ä¼šé€ æˆé‡å¤ã€‚æ‰“ç¯®çƒæ˜¯ä¸€é¡¹æœ‰ç›Šçš„è¿åŠ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä¸­å¾—åˆ°è¯¸å¤šå¥½å¤„ã€‚ä»‹è¯+å…³ç³»ä»£è¯ä¸­ä»£è¯çš„é€‰æ‹©ä¿®é¥°äººæ—¶ï¼Œåªèƒ½ç”¨whomHe is the student with whom my teacher talked.ä¿®é¥°ç‰©æ—¶ï¼Œåªèƒ½ç”¨whichThis is the hotel at which Mr.Jason likes to stay.whoseç”¨å…³ç³»ä»£è¯æ›¿æ¢ï¼Œæ˜¯of which/whomMr.Liu criticized the students whose/of whom homework hasnâ€™t been handed in.We live in a house whose/of which windows open to the south.å¦‚ä½•é€‰æ‹©ä»‹è¯ (å…ˆè¡Œè¯ = å®šè¯­ä»å¥å¼•å¯¼è¯)æ ¹æ®ä»å¥ä¸­è°“è¯­åŠ¨è¯ä¸ä»‹è¯çš„æ­é…ï¼Œå¹¶ä¸”è¦åˆ¤æ–­â€åŠ¨è¯+ä»‹è¯â€ä¸å…ˆè¡Œè¯çš„é€»è¾‘å…³ç³»The girl for whom he had fought 2 years seems no longer important to him.ä»å¥çš„è°“è¯­åŠ¨è¯æ„æˆçš„æ­é…æ˜¯ight for sb.ï¼ˆä¸ºâ€¦è€Œæ–—äº‰)ï¼Œæ‰€ä»¥ç”¨for whom.ã€‚è¿™ä¸ªä»–å·²ç»ä¸ºä¹‹å¥‹æ–—äº†ä¸¤å¹´çš„å¥³å­©ï¼Œä¼¼ä¹å¯¹ä»–ä¸é‚£ä¹ˆé‡è¦äº†ã€‚I have bought many things on which I spent most of my money that I saved.ä»å¥çš„è°“è¯­åŠ¨è¯æ„æˆçš„æ­é…æ˜¯spend money/time/.energy on sth.ï¼ˆåœ¨â€¦ä¸ŠèŠ±è´¹é‡‘é’±/æ—¶é—´/ç²¾åŠ›)æˆ‘ç”¨èŠ‚çœä¸‹æ¥çš„å¤§éƒ¨åˆ†é’±å»ä¹°äº†å¾ˆå¤šä¸œè¥¿ã€‚æ ¹æ®ä»å¥ä¸­åŠ¨è¯ä¸å…ˆè¡Œè¯çš„é€»è¾‘å…³ç³»This is the farmyard on which my father has worked for 20 years.çœ‹åŠ¨è¯workå’Œå…ˆè¡Œè¯farmyardçš„é€»è¾‘å…³ç³»ï¼Œåº”è¯¥è¡¨ç¤ºåœ¨å†œåœºä¸Šé¢å·¥ä½œï¼Œè€Œä¸æ˜¯è¯´åœ¨å†œåœºé‡Œæˆ–è€…å†œåœºä¸‹é¢å·¥ä½œï¼Œæ‰€ä»¥é€‰æ‹©çš„ä»‹è¯æ˜¯onè¿™å°±æ˜¯æˆ‘çˆ¶äº²å·¥ä½œäº†äºŒåå¹´çš„å†œåœºã€‚This is the roof on which people often enjoy the moon.çœ‹åŠ¨è¯enjoyå’Œroofçš„é€»è¾‘å…³ç³»ï¼Œåº”è¯¥æ˜¯åœ¨å±‹é¡¶ä¸Šæ¬£èµï¼Œæ‰€ä»¥é€‰æ‹©çš„ä»‹è¯æ˜¯onè¿™å°±æ˜¯äººä»¬ç»å¸¸ç«™åœ¨ä¸Šé¢èµæœˆçš„é‚£ä¸ªå±‹é¡¶ã€‚æ ¹æ®â€å½¢å®¹è¯+ä»‹è¯â€ä¸å…ˆè¡Œè¯çš„é€»è¾‘å…³ç³»æ¥é€‰æ‹©English is the subject in our school in which every student is interested.æ³¨æ„æ­é…be interested in,å°†inæåˆ°å…³ç³»ä»£è¯å‰ã€‚è‹±è¯­æ˜¯æˆ‘ä»¬å­¦æ ¡æ¯ä¸ªå­¦ç”Ÿéƒ½å¾ˆæ„Ÿå…´è¶£çš„è¯¾ç¨‹ã€‚He referred me to some reference books with which I was not very familiar.æ³¨æ„æ­é…be familiar with,å°†withæåˆ°å…³ç³»ä»£è¯å‰ã€‚ä»–è¦æˆ‘å»æŸ¥çœ‹ä¸€äº›æˆ‘ä¸æ˜¯å¾ˆç†Ÿæ‚‰çš„å‚è€ƒä¹¦ã€‚æ ¹æ®å…ˆè¡Œè¯ä¸å¥å­çš„æ„æ€æ¥ç¡®å®šThe colorless gas without which we can not live is called oxygen.è¿™ä¸€æƒ…å†µæ¯”è¾ƒéš¾ï¼Œéœ€è¦æˆ‘ä»¬æœ‰è‰¯å¥½çš„è¯­è¨€åŸºç¡€å’Œé€»è¾‘åˆ†æèƒ½åŠ›ï¼Œé¦–å…ˆæˆ‘ä»¬çœ‹ä¸€ä¸‹ï¼Œå…ˆè¡Œè¯æ˜¯colourless gasæ— è‰²æ°”ä½“ï¼›å®šè¯­ä»å¥çš„æ„æ€æ˜¯ï¼šæˆ‘ä»¬ä¸èƒ½æ´»ä¸‹å»ã€‚é‚£ä¹ˆå®ƒä»¬çš„é€»è¾‘å…³ç³»åº”è¯¥æ˜¯ï¼šæ²¡æœ‰è¿™ç§æ°”ä½“ï¼Œæˆ‘ä»¬å°±ä¸èƒ½æ´»ä¸‹å»ã€‚æ‰€ä»¥é€‰æ‹©ä»‹è¯withoutè¿™ç§æ— è‰²æ°”ä½“ç§°ä¸ºæ°§æ°”ï¼Œæ²¡æœ‰å®ƒæˆ‘ä»¬å°±æ´»ä¸ä¸‹å»ã€‚This is the classroom in the front of which there is a desk.å…ˆè¡Œè¯æ˜¯classroomï¼Œå®šè¯­ä»å¥çš„æ„æ€æ˜¯ï¼šæœ‰ä¸€å¼ è®²å°ï¼Œé€»è¾‘å…³ç³»å¾ˆæ˜æ˜¾ï¼Œå³åœ¨æ•™å®¤å‰é¢æœ‰è®²å°ï¼Œè¿™æ˜¯ä¸€ç§å¸¸è¯†ï¼Œæ‰€ä»¥é€‰æ‹©ä»‹è¯çŸ­è¯­in the front ofåœ¨æ•™å®¤å‰é¢æœ‰ä¸€å¼ è®²å°ã€‚ä»‹è¯+å…³ç³»ä»£è¯çš„ç¿»è¯‘æ–¹æ³•æ‰¾å‡ºå…³ç³»ä»£è¯çš„æŒ‡ä»£å°†ä»‹è¯ä¸æŒ‡ä»£çš„å†…å®¹è¿˜åŸåˆ°å®šè¯­ä»å¥çš„è°“è¯­åå°†ä¸»å¥å’Œå®šè¯­ä»å¥æŒ‰å­—é¢æ„æ€ç¿»è¯‘è°ƒæ•´è¯­åºï¼Œä½¿ä¸»ä»å¥ç¬¦åˆæ±‰è¯­çš„è¡¨è¾¾ä¹ æƒ¯ï¼Œä¿æŒå¥å­é€šé¡ºAll of us work through problems in ways of which weâ€™re unaware.ç¬¬ä¸€æ­¥ï¼šæ‰¾åˆ°å…³ç³»ä»£è¯whichæŒ‡ä»£çš„æ˜¯waysç¬¬äºŒæ­¥ï¼šè¿˜åŸâ€ä»‹è¯+å…³ç³»ä»£è¯â€ä¸å®šè¯­ä»å¥ï¼šweâ€™re unaware of waysç¬¬ä¸‰æ­¥ï¼šå°†å®šè¯­ä»å¥æ”¾åˆ°å…ˆè¡Œè¯å‰ç¿»è¯‘ï¼Œå³ï¼šæˆ‘ä»¬ä¸çŸ¥é“çš„æ–¹æ³•ç¬¬å››æ­¥ï¼šè°ƒæ•´è¯­åºï¼Œä½¿å¥å­é€šé¡ºï¼šâ€æˆ‘ä»¬ä¸çŸ¥é“çš„æ–¹æ³•â€éå¸¸æ‹—å£ï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆç¿»è¯‘ï¼šæ— äººæ‰€çŸ¥çš„æ–¹æ³•æˆ‘ä»¬æ‰€æœ‰äººéƒ½é€šè¿‡è¿™ç§æ— äººæ‰€çŸ¥çš„æ–¹æ³•æ¥è§£å†³é—®é¢˜ã€‚å›ºå®šæ­é…å¼•å¯¼çš„ä»å¥the same â€¦ asæ‰€å¼•å¯¼çš„å®šè¯­ä»å¥çš„ä»å¥å†…å®¹ä¸å…ˆè¡Œè¯åŒç±»è€Œä¸åŒç‰©ï¼Œç¿»è¯‘æˆâ€œåƒâ€¦æ ·çš„â€the same â€¦ thatè¡¨ç¤ºæ‰€å¼•å¯¼çš„ä»å¥å†…å®¹ä¸å…ˆè¡Œè¯åŒç±»åŒç‰©ï¼Œå³åŒä¸€äº‹ç‰©ï¼Œç¿»è¯‘æˆâ€æ­£æ˜¯â€¦â€Mr.Darcy is the same man as I love.Mr.Darcy is the same man that I love.å¥1ç¿»è¯‘æˆï¼šæˆ‘å–œæ¬¢çš„æ˜¯åƒè¾¾è¥¿å…ˆç”Ÿä¸€æ ·çš„ç”·äººã€‚(è¡¨æ˜æˆ‘å–œæ¬¢çš„åªæ˜¯åƒè¾¾è¥¿å…ˆç”Ÿè¿™æ ·çš„ç”·äººè€Œå·²ï¼Œä½†ä¸æ˜¯å–œæ¬¢è¾¾è¥¿å…ˆç”Ÿï¼Œå…ˆè¡Œè¯ä¸å®šè¯­ä»å¥å†…å®¹éƒ½æ˜¯åŒç±»ï¼Œéƒ½è¡¨ç¤ºäººï¼Œä½†ä¸æ˜¯åŒä¸€ä¸ªäºº)å¥2ç¿»è¯‘æˆï¼šæˆ‘çˆ±çš„ç”·äººæ­£æ˜¯è¾¾è¥¿å…ˆç”Ÿã€‚(è¡¨æ˜æˆ‘çˆ±çš„ç”·äººæ­£æ˜¯è¾¾è¥¿å…ˆç”Ÿï¼Œå…ˆè¡Œè¯ä¸å®šè¯­ä»å¥å†…å®¹ä¸€è‡´ï¼ŒæŒ‡åŒä¸€ä¸ªäºº)He is using the same camera that I lost a few days ago.ä»–æ­£ç”¨ç€æˆ‘å‰å‡ å¤©ä¸¢çš„é‚£å°ç›¸æœºã€‚(æš—å«ï¼šä»–å·äº†æˆ‘çš„ç›¸æœº)He is using the same camera as I lost a few days ago.ä»–æ­£åœ¨ç”¨çš„ç›¸æœºå’Œæˆ‘å‰å‡ å¤©ä¸¢å¤±çš„é‚£å°å¾ˆåƒã€‚(æš—å«ï¼šä»–ç”¨çš„ç›¸æœºä¸æ˜¯æˆ‘ä¸¢çš„é‚£ä¸€å°ï¼Œåªæ˜¯é•¿å¾—åƒè€Œå·²)aså’Œwhichå¼•å¯¼çš„ä»å¥ç›¸åŒç‚¹ä¸¤è€…éƒ½å¯ä»¥å¼•å¯¼éé™åˆ¶æ€§å®šè¯­ä»å¥ä¸åŒç‚¹aså¼•å¯¼éé™åˆ¶æ€§å®šè¯­ä»å¥ï¼Œä½ç½®éšä¾¿æ”¾(aså¼•å¯¼çš„ä»å¥å¯ä½äºä¸»å¥å‰ã€ä¸­ã€å)ï¼Œç¿»è¯‘æˆâ€æ­£å¦‚â€ï¼›whichåªèƒ½æ”¾åœ¨æ‰€ä¿®é¥°çš„å¥å­çš„åé¢As we all know, Man struggles upwards, and water flows downwards.Man struggles upwards and water flows downwards, which is known to us all.â€‹    ä¼—æ‰€å‘¨çŸ¥ï¼Œäººå¾€é«˜å¤„èµ°ï¼Œæ°´å¾€ä½å¤„æµã€‚ç´§è·Ÿasåçš„åŠ¨è¯æ˜¯beåŠ¨è¯ï¼Œè€Œwhichåå¯ä»¥ç”¨ä»»ä½•ç±»å‹çš„åŠ¨è¯As is known to the United States, Mark Twain is a great writer.ç¾å›½äººéƒ½çŸ¥é“ï¼Œé©¬å…‹Â·åæ¸©æ˜¯ä¸€ä½ä¼Ÿå¤§çš„ä½œå®¶Immigrants are quickly fitting into this common culture, which may not be altogether elevating but is hardly poisonous.ç§»æ°‘ä»¬å¾ˆå¿«é€‚åº”äº†è¿™é‡Œçš„å¤§ä¼—æ–‡åŒ–ï¼Œå®ƒè™½ç„¶å¯èƒ½ä¸å®Œå…¨å¼•äººå‘ä¸Šï¼Œä½†è‡³å°‘ä¸ä¼šæ¯’å®³ç™¾å§“å¼•å¯¼è¯whichçŸ¥thatçš„åŒºåˆ«ä¸¤è€…éƒ½å¯æŒ‡ç‰©ï¼Œå¸¸å¯äº’æ¢ã€‚å…¶åŒºåˆ«ä¸»è¦åœ¨äºï¼šç”¨whichçš„æƒ…å†µå¼•å¯¼éé™åˆ¶æ€§å®šè¯­ä»å¥The current,.which is very rapid,makes the river dangerous.æ°´æµæ¹æ€¥ï¼Œä½¿è¿™æ¡æ²³å¾ˆå±é™©ã€‚The London team, which played so well last season, has done badly this season.ä¼¦æ•¦é˜Ÿä¸Šä¸€ä¸ª å­£åº¦æ‰“å¾—å¾ˆå¥½ï¼Œè¿™ä¸ªå­£åº¦å´æ‰“å¾—å¾ˆå·®ã€‚æ”¾åœ¨ä»‹è¯åä½œå®¾è¯­æ—¶ï¼Œé€šå¸¸è¦ç”¨whichThe documents for which they were searching have been recovered.ä»–ä»¬æ‰¾å¯»çš„æ–‡ä»¶å·²æ‰¾åˆ°äº†ã€‚He had only the long nights in which he could study.ä»–åªèƒ½åˆ©ç”¨æ¼«é•¿çš„å¤œæ™šæ¥å­¦ä¹ ã€‚ç”¨thatçš„æƒ…å†µå½“å…ˆè¡Œè¯æ˜¯ä¸å®šä»£è¯much, little, none, all, few, every(thing), any(thing), no(thing)ç­‰æ—¶I did nothing that might hurt you.æˆ‘æ²¡åšä»»ä½•å¯èƒ½ä¼¤å®³ä½ çš„äº‹ã€‚The sleeping manâ€™s subconscious mind retained everything that was said around him.é…£ç¡çš„äººçš„æ½œæ„è¯†èƒ½å¤Ÿè®°ä½å‘¨å›´çš„äººè¯´çš„ä¸€åˆ‡ã€‚å½“ä¸»å¥ä»¥here, thereå¼€å¤´æ—¶Here is the hotel that youâ€™ve been looking for.è¿™å°±æ˜¯ä½ ä¸€ç›´åœ¨æ‰¾çš„é‚£ä¸ªæ—…é¦†ã€‚There is a room in the building that is still free.å¤§æ¥¼é‡Œè¿˜æœ‰ä¸€ä¸ªæˆ¿é—´æ˜¯ç©ºçš„ã€‚å½“å…ˆè¡Œè¯è¢«the only, the same, the veryç­‰é™å®šè¯ä¿®é¥°æ—¶When people talk about Chongqing, the first that comes to mind is the Hotpot.äººä»¬ä¸€è¯´åˆ°é‡åº†ï¼Œ ç¬¬ä¸€ä¸ªæƒ³åˆ°çš„å°±æ˜¯ç«é”…ã€‚This is the first film that has been shown in our school this term.è¿™æ˜¯æˆ‘ä»¬å­¦æ ¡æœ¬å­¦æœŸæ”¾æ˜ çš„ ç¬¬ä¸€éƒ¨ç”µå½±ã€‚å½“å…ˆè¡Œè¯è¢«any, few, little, no, all, much, someç­‰è¯ä¿®é¥°æ—¶You can take any seat that is free.ä»»ä½•ç©ºç€çš„åº§ä½ä½ éƒ½å¯ä»¥åã€‚There is little work that fits for you.è¿™é‡Œå‡ ä¹æ²¡æœ‰é€‚åˆä½ çš„å·¥ä½œã€‚å½“å…ˆè¡Œè¯è¢«åºæ•°è¯æˆ–å½¢å®¹è¯æœ€é«˜çº§ä¿®é¥°æ—¶This is the most interesting story book that I have ever read.è¿™æ˜¯æˆ‘è¯»è¿‡çš„æœ€æœ‰è¶£çš„ä¸€æœ¬æ•…äº‹ä¹¦ã€‚I do remember the first time that I had ever heard the sweetest voice in the world.æˆ‘å¾ˆæ¸…æ¥šåœ°è®°å¾—æˆ‘ç¬¬ä¸€æ¬¡å¬åˆ°ä¸–ç•Œä¸Šæœ€ç¾çš„å£°éŸ³çš„é‚£ä¸€åˆ»ã€‚å½“å…ˆè¡Œè¯æ˜¯ç–‘é—®ä»£è¯who, which, whatæˆ–ä¸»å¥ä»¥è¿™äº›è¯å¼€å¤´æ—¶Who that has ever worked together with him doesnâ€™t admire him?æ›¾ç»å’Œä»–ä¸€èµ·å·¥ä½œè¿‡çš„äººè°ä¸é’¦ä½©ä»–ï¼ŸWhich is the star that is nearer to the earth?å“ªä¸ªæ˜¯ç¦»åœ°çƒæ¯”è¾ƒè¿‘çš„æ’æ˜Ÿï¼Ÿå½“å…ˆè¡Œè¯æ—¢æœ‰äººåˆæœ‰ç‰©çš„æ—¶å€™She likes taking pictures of those people and things that she is interested in.å¥¹å–œæ¬¢ç»™å¥¹æ‰€æ„Ÿå…´ è¶£çš„äººå’Œç‰©æ‹ç…§ã€‚They are talking of the heroines and their deeds that interest them.ä»–ä»¬æ­£åœ¨è°ˆè®ºä»–ä»¬æ„Ÿå…´è¶£ çš„å¥³è‹±é›„åŠå¥¹ä»¬çš„äº‹è¿¹ã€‚åŒºåˆ«å®šè¯­ä»å¥å’ŒåŒä½è¯­ä»å¥é€šè¿‡ä¸‹é¢çš„ä¾‹å­æ¥è®²è§£å®šè¯­ä»å¥å’ŒåŒä½è¯­ä»å¥çš„åŒºåˆ«ã€‚I had a dream that was definitely sweet.I had a dream that I would become a rich lady someday.å…ˆç¡®å®šï¼Œç¬¬ä¸€ä¸ªæ˜¯å®šè¯­ä»å¥ï¼Œç¬¬äºŒä¸ªæ˜¯åŒä½è¯­ä»å¥ï¼šç„¶åè®¨è®ºä¸¤ä¸ªä»å¥çš„ç›¸åŒç‚¹å’Œä¸åŒç‚¹ã€‚ç›¸åŒç‚¹ï¼šæ„æˆç›¸åŒï¼Œéƒ½æ˜¯â€â€å…ˆè¡Œè¯+å¼•å¯¼è¯+åˆ†å¥â€ã€‚ä¸åŒç‚¹ï¼šç¬¬ä¸€ï¼Œé¦–å…ˆçœ‹å¼•å¯¼è¯thatï¼Œå®šè¯­ä»å¥çš„å¼•å¯¼è¯thatåœ¨ä»å¥ä¸­è¦å……å½“ä¸»è¯­æˆ–å®¾è¯­ï¼Œè€ŒåŒä½è¯­ä»å¥çš„thatåœ¨ä»å¥ä¸­ä¸ä½œä»»ä½•æˆåˆ†ï¼Œä¹Ÿæ²¡æœ‰ä»»ä½•æ„æ€ã€‚ç¬¬äºŒï¼Œçœ‹ä»å¥æœ¬èº«çš„æ„æ€ã€‚å¥1çš„æ„æ€ï¼šæˆ‘åšäº†ä¸€ä¸ªå¾ˆç¾çš„æ¢¦ã€‚ä½ çŸ¥é“æˆ‘åšçš„æ˜¯ä»€ä¹ˆæ¢¦å—ï¼ŸåªçŸ¥é“æ˜¯ç¾æ¢¦ï¼Œç¾æ¢¦å¤ªå¤šäº†ï¼Œä½ å¹¶ä¸çŸ¥é“æˆ‘å…·ä½“åšäº†ä»€ä¹ˆæ¢¦ã€‚å¥2çš„æ„æ€ï¼šæˆ‘åšäº†ä¸€ä¸ªæœ‰ä¸€å¤©æˆ‘ä¼šå˜æˆæœ‰é’±äººçš„æ¢¦ã€‚ä½ çŸ¥é“æˆ‘çš„æ¢¦äº†å—ï¼Ÿæ˜¾ç„¶çŸ¥é“ï¼Œæ¢¦å°±æ˜¯ï¼šæˆ‘ä¼šå˜æˆæœ‰é’±äººã€‚â€‹    æ‰€ä»¥ï¼Œç¬¬äºŒä¸ªåŒºåˆ«æ˜¯å®šè¯­ä»å¥æ˜¯å¯¹å‰é¢åè¯çš„ä¿®é¥°ï¼Œè€ŒåŒä½è¯­ä»å¥æ˜¯å¯¹å‰é¢åè¯çš„è§£é‡Šã€‚ç¬¬ä¸‰ï¼Œçœ‹å…ˆè¡Œè¯ï¼Œå®šè¯­ä»å¥çš„å…ˆè¡Œè¯å¯ä»¥æ˜¯ä»»ä½•åè¯ï¼Œè€ŒåŒä½è¯­ä»å¥çš„å…ˆè¡Œè¯åªèƒ½æ˜¯å¯ä»¥è§£é‡Šçš„åè¯ä¸€æŠ½è±¡åè¯ã€‚ç¬¬å››ï¼Œæœ€åä¸€ä¸ªåŒºåˆ«ï¼Œè™½ç„¶ä¸å¤Ÿä¸¥è°¨ï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥ä½œä¸ºå‚è€ƒã€‚é‚£å°±æ˜¯å®šè¯­ä»å¥çš„å¼•å¯¼è¯æœ‰å¾ˆå¤šï¼Œè€ŒåŒä½è¯­ä»å¥çš„å¼•å¯¼è¯å¤§éƒ¨åˆ†éƒ½æ˜¯that(å› ä¸ºåŒä½è¯­ä»å¥å¤§éƒ¨åˆ†éƒ½æ˜¯é™ˆè¿°å¥)ã€‚</content>
	</entry>
	<entry>
		<title>è¯­æ³•_çŠ¶è¯­ä¸çŠ¶è¯­ä»å¥</title>
		<url>/article/1fb67a92.html</url>
		<content>å¼•è¯­å½¢å®¹è¯(çŸ­è¯­)æ”¾åœ¨ç³»åŠ¨è¯åé¢ä½œè¡¨è¯­ï¼Œä¾‹å¦‚ï¼šHe becomes tough these days.æ”¾åœ¨å®¾è¯­åé¢ä½œè¡¥è¯­(æ­¤ç”¨æ³•ä¸å¤ªå¸¸è§)ï¼Œä¾‹å¦‚ï¼šThe reality makes him tough these days.æ”¾åœ¨åè¯(çŸ­è¯­)å‰é¢ä½œå®šè¯­ï¼Œä¾‹å¦‚ï¼šHe has become a tough man these days.æ€»ç»“æˆ‘ä»¬å‘ç°äº†ä¸€ä¸ªè§„å¾‹ï¼Œä¸è®ºå½¢å®¹è¯(çŸ­è¯­)ä½œä»€ä¹ˆæˆåˆ†ï¼Œéƒ½æ˜¯å›´ç€åè¯(çŸ­è¯­)/ä»£è¯è½¬ï¼Œä¹Ÿå°±æ˜¯è¯´å½¢å®¹è¯(çŸ­è¯­)æ— è®ºä½œä»€ä¹ˆæˆåˆ†éƒ½æ˜¯ä¿®é¥°åè¯(çŸ­è¯­)/ä»£è¯çš„ã€‚Liu is honest. æ­¤æ—¶çš„honestä¿®é¥°ä¸»è¯­Liuã€‚Liu can make me happy. æ­¤æ—¶çš„happyä¿®é¥°å®¾è¯­meã€‚Liu is an honest woman. æ­¤æ—¶çš„honestä¿®é¥°womanã€‚å‰¯è¯(çŸ­è¯­)å‰¯è¯(çŸ­è¯­)åœ¨æœ¬æ–‡ä¸­è¿˜æ²¡æœ‰æåˆ°è¿‡ï¼Œæˆ–ä»æœªä¸“é—¨æåˆ°è¿‡ï¼Œè¿™é‡Œå°±æ¥æ­£å¼è¿›è¡Œè®²è§£ã€‚He smiles sweetly. å‰¯è¯sweetlyä¿®é¥°å®ä¹‰åŠ¨è¯smilesã€‚He looks pretty sweet. å‰¯è¯prettyä¿®é¥°å½¢å®¹è¯sweetã€‚He smiles especially sweetly. å‰¯è¯especiallyä¿®é¥°å‰¯è¯sweetlyã€‚Luckily,he passed the examination. å‰¯è¯Luckilyä¿®é¥°æ•´ä¸ªå¥å­ã€‚å‰¯è¯(çŸ­è¯­)å¯ä»¥ä¿®é¥°å®ä¹‰åŠ¨è¯(è¯ç»„)ã€å½¢å®¹è¯(çŸ­è¯­)å’Œæ•´ä¸ªå¥å­ï¼Œå‰¯è¯ç”šè‡³è¿˜å¯ä»¥ä¿®é¥°å‰¯è¯ã€‚å‰¯è¯åœ¨å¥ä¸­ä½œçŠ¶è¯­ï¼Œå¹¶ä¸”å‰¯è¯(çŸ­è¯­)åªèƒ½ä½œçŠ¶è¯­ã€‚çŠ¶è¯­å«ä¹‰åœ¨ä¸€ä¸ªå¥å­ä¸­ï¼Œç”¨æ¥ä¿®é¥°å®ä¹‰åŠ¨è¯(è¯ç»„)ã€å½¢å®¹è¯(çŸ­è¯­)ã€å‰¯è¯æˆ–æ•´ä¸ªå¥å­çš„æˆåˆ†ï¼Œå«ä½œçŠ¶è¯­ã€‚æˆåˆ†å‰¯è¯ï¼šShe smiles sweetly.å‰¯è¯çŸ­è¯­ï¼šI tried again and again.ä»‹è¯çŸ­è¯­ï¼šHe runs fast like a crazy dog.åˆ†è¯ã€ä¸å®šå¼ï¼šHe leaves, crying.ä»å¥ï¼šI will return the book as soon as I have read it.ä½ç½®ä½ç½®çŠ¶è¯­çš„ä½ç½®æå…¶çµæ´»ï¼Œå¯ä»¥éšæ„æ”¾ç½®åœ¨å¥ä¸­ï¼Œä½†æ˜¯æ”¾åœ¨å¥é¦–æˆ–å¥æœ«çš„æƒ…å†µå±…å¤šï¼Œå¦‚æœæ”¾åœ¨å¥é¦–çš„è¯ï¼Œé€šå¸¸ç”¨é€—å·éš”å¼€ã€‚æ¯”å¦‚ï¼šIn Chongqing, I am now working.I am now working in Chongqing.I am now in Chongqing working.çŠ¶è¯­ä»å¥å¼•å¯¼è¯çŠ¶è¯­ä»å¥å¯ä»¥æ”¾åœ¨ä¸»å¥ä¹‹å‰ï¼Œä¹Ÿå¯ä»¥æ”¾åœ¨ä¸»å¥ä¹‹åï¼Œæ‰€ä»¥çŠ¶è¯­ä»å¥çš„æ„æˆæ˜¯ï¼šå¼•å¯¼è¯+çŠ¶è¯­ä»å¥+â€,â€+ä¸»å¥(çŠ¶è¯­ä»å¥æ”¾å¥é¦–æ—¶ï¼Œå¿…é¡»åŠ é€—å·)æˆ–ä¸»å¥+å¼•å¯¼è¯+çŠ¶è¯­ä»å¥(çŠ¶è¯­ä»å¥æ”¾åœ¨ä¸»å¥åï¼Œå¯ä»¥åŠ é€—å·ï¼Œä¹Ÿå¯ä»¥ä¸åŠ é€—å·)åè¯æ€§ä»å¥æ˜¯æŒ‰ç…§ä»å¥æ‰€å……å½“çš„æˆåˆ†æ¥è¿›è¡Œåˆ†ç±»çš„ï¼Œå¯åˆ†ä¸ºå››ç±»ï¼›å®šè¯­ä»å¥çš„å¼•å¯¼è¯æ˜¯æŒ‰ç…§å…ˆè¡Œè¯çš„ç§ç±»æ¥è¿›è¡Œåˆ†ç±»çš„ï¼Œå¯åˆ†ä¸ºäº”ç±»ã€‚é‚£çŠ¶è¯­ä»å¥çš„å¼•å¯¼è¯åº”è¯¥æŒ‰ç…§ä»€ä¹ˆæ ‡å‡†æ¥åˆ†ç±»å‘¢ï¼ŸIfå¼•å¯¼ä»€ä¹ˆçŠ¶è¯­ä»å¥?â€”â€”æ¡ä»¶Whenå¼•å¯¼ä»€ä¹ˆçŠ¶è¯­ä»å¥ï¼Ÿâ€”â€”æ—¶é—´Becauseå¼•å¯¼ä»€ä¹ˆçŠ¶è¯­ä»å¥?â€”â€”åŸå› ç”±ä¸Šè¿°ç¤ºä¾‹ï¼ŒåŒå­¦ä»¬å¤§æ¦‚å·²ç»çŸ¥é“äº†çŠ¶è¯­ä»å¥å¼•å¯¼è¯çš„åˆ†ç±»æ ‡å‡†ï¼Œé‚£å°±æ˜¯ï¼šæŒ‰ç…§å¼•å¯¼è¯æœ¬èº«çš„æ„æ€è¿›è¡Œåˆ†ç±»ï¼Œä¸€å…±åˆ†ä¸ºä¹ç±»ï¼šæ—¶é—´çŠ¶è¯­ä»å¥ã€åœ°ç‚¹çŠ¶è¯­ä»å¥ã€åŸå› çŠ¶è¯­ä»å¥ã€ç›®çš„çŠ¶è¯­ä»å¥ã€ç»“æœçŠ¶è¯­ä»å¥ã€æ¡ä»¶çŠ¶è¯­ä»å¥ã€è®©æ­¥çŠ¶è¯­ä»å¥ã€æ–¹å¼çŠ¶è¯­ä»å¥å’Œæ¯”è¾ƒçŠ¶è¯­ä»å¥ã€‚å°±æ˜¯å› ä¸ºçŠ¶è¯­ä»å¥çš„å¼•å¯¼è¯æ˜¯æŒ‰ç…§å¼•å¯¼è¯æœ¬èº«çš„æ„æ€æ¥è¿›è¡Œåˆ†ç±»çš„ï¼Œæ‰€ä»¥çŠ¶è¯­ä»å¥å¯ä»¥è¯´æ˜¯æœ€ç®€å•çš„ä»å¥ï¼Œæ¯ä¸ªå¼•å¯¼è¯éƒ½æœ‰ç¡®å®šçš„æ„æ€ã€‚æ¯”å¦‚ç¿»è¯‘è¿™ä¸ªä¸­æ–‡å¥å­ï¼›å› ä¸ºæˆ‘çˆ±ä½ ï¼Œæˆ‘è¦ä¸€ç”Ÿéƒ½é™ªç€ä½ ã€‚â€å› ä¸ºâ€åªèƒ½ç¿»è¯‘æˆbecauseã€sinceç­‰è¡¨ç¤ºåŸå› çš„è¯ï¼Œè€Œä¸èƒ½ç¿»è¯‘æˆas if(å¥½åƒ)ç­‰å…¶ä»–ä¸è¡¨ç¤ºåŸå› çš„è¯ã€‚æ—¶æ€ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåœ¨çŠ¶è¯­ä»å¥ä¸­ï¼Œå½“ä¸»å¥è¡¨ç¤ºè¿‡å»çš„æ—¶å€™ï¼Œä¸»å¥ä¸ä»å¥éƒ½å¯ä»¥ä½¿ç”¨ç›¸åº”çš„è¿‡å»æ—¶æ€ã€‚å¦‚ï¼šBefore I went home,my mother had slept. åœ¨æˆ‘å›å®¶ä¹‹å‰ï¼Œæˆ‘çš„å¦ˆå¦ˆå·²ç»ç¡äº†ã€‚åœ¨è¿™ä¸ªå¥å­ä¸­ï¼Œä¸¤ä¸ªåŠ¨ä½œéƒ½æ˜¯å‘ç”Ÿåœ¨è¿‡å»ï¼Œç†åº”ä½¿ç”¨ç›¸åº”çš„è¿‡å»æ—¶ï¼Œä½†æ˜¯ä¸»å¥çš„åŠ¨ä½œå‘ç”Ÿåœ¨ä»å¥ä¹‹å‰ï¼Œå› æ­¤ä¸»å¥åº”ä½¿ç”¨è¿‡å»å®Œæˆæ—¶ã€‚å½“ä¸»å¥è¡¨ç¤ºå°†æ¥çš„æ—¶å€™ï¼Œä¸»å¥ä½¿ç”¨ä¸€èˆ¬å°†æ¥æ—¶ï¼Œä»å¥ä½¿ç”¨ä¸€èˆ¬ç°åœ¨æ—¶ï¼Œç”¨â€ç°åœ¨â€è¡¨ç¤ºâ€å°†æ¥â€ã€‚ä¾‹å¦‚ï¼šI will treat you if I manage to pass the examination of postgraduates.å¦‚æœæˆ‘è€ƒç ”æˆåŠŸï¼Œæˆ‘å°±è¯·ä½ åƒé¥­ã€‚è¿™æ˜¯ç”±ifå¼•å¯¼çš„æ¡ä»¶çŠ¶è¯­ä»å¥ï¼Œä¸»å¥è¡¨å°†æ¥ï¼Œä½†ä»å¥ä¸­çš„è°“è¯­åŠ¨è¯åº”è¯¥ç”¨ä¸€èˆ¬ç°åœ¨æ—¶ï¼Œç»ä¸å¯ç”¨will manageã€‚å½“ä¸»å¥è¡¨ç¤ºå°†æ¥å®Œæˆçš„æ—¶å€™ï¼Œä¸»å¥ä½¿ç”¨å°†æ¥å®Œæˆæ—¶ï¼Œä»å¥è¦ä½¿ç”¨ç°åœ¨å®Œæˆæ—¶ã€‚å¦‚ï¼šAs soon as I have finished this work,I will have gone home.å¦‚æœæˆ‘æ—©å®Œæˆå·¥ä½œçš„è¯ï¼Œæˆ‘ç°åœ¨å·²ç»åˆ°å®¶äº†ã€‚è¿™ç§ç”¨æ³•å¾ˆå°‘è§åˆ°ï¼ŒåŒå­¦ä»¬ä¸éœ€è¦è¿‡åˆ†åœ¨æ„ã€‚è¯¥ä»å¥ä¸­çš„è°“è¯­åŠ¨è¯ç”¨ç°åœ¨å®Œæˆæ—¶have finished æ¥è¡¨ç¤ºå°†æ¥å®Œæˆï¼Œç»ä¸å¯ç”¨will have finishedã€‚ä¹å¤§ä»å¥æ—¶é—´çŠ¶è¯­ä»å¥æ—¶é—´çŠ¶è¯­ä»å¥çš„å¼•å¯¼è¯ï¼šæ™®é€šå¼•å¯¼è¯ï¼šwhen(åœ¨â€¦æ—¶)ï¼Œas(æ­£å½“/éšç€)ï¼Œwhile(åœ¨â€¦æœŸé—´)ï¼Œonce(ä¸€æ—¦)ï¼Œas soon as(â€¦å°±â€¦)ï¼Œbefore(åœ¨â€¦ä¹‹å‰)ï¼Œafter(åœ¨â€¦ä¹‹å)ï¼Œsince(è‡ªä»â€¦ä»¥æ¥)ï¼Œnot â€¦ until(ç›´åˆ°â€¦æ‰)ï¼Œuntil/till(ç›´åˆ°â€¦æ—¶)åè¯çŸ­è¯­ï¼šthe moment(ä¸€â€¦å°±)ï¼Œevery time(æ¯å½“)ï¼Œthe day(é‚£ä¸€å¤©)ï¼Œthe instant(å½“â€¦çš„æ—¶å€™)å‰¯è¯ï¼šimmediately, directly, no sooner â€¦ than, hardly â€¦ when, scarcely â€¦ when(è¿™äº”ä¸ªæ„æ€ç›¸åŒï¼Œéƒ½è¯‘ä¸ºâ€ä¸€â€¦å°±â€)whenï¼Œwhileå’Œasçš„åŒºåˆ«whenå¼•å¯¼çš„ä»å¥çš„è°“è¯­åŠ¨è¯å¯ä»¥æ˜¯å»¶ç»­æ€§åŠ¨è¯ï¼Œä¹Ÿå¯ä»¥æ˜¯çŸ­æš‚æ€§åŠ¨è¯ï¼Œé€šå¸¸è¡¨ç¤ºâ€å½“â€¦æ—¶â€ã€‚ä¾‹å¦‚ï¼šWhen the teacher came in,we stop talking.å½“è€å¸ˆè¿›æ¥æ—¶ï¼Œæˆ‘ä»¬éƒ½ä¸è¯´è¯äº†ã€‚(çŸ­æš‚æ€§åŠ¨è¯)When I lived in the countryside, I used to live a tough life.å½“æˆ‘ä½åœ¨å†œæ‘æ—¶ï¼Œæˆ‘è¿‡ç€è‰°è‹¦çš„ç”Ÿæ´»ã€‚(å»¶ç»­æ€§åŠ¨è¯)whileå¼•å¯¼çš„ä»å¥çš„è°“è¯­åŠ¨è¯å¿…é¡»æ˜¯å»¶ç»­æ€§çš„åŠ¨è¯ï¼Œå¤šç”¨äºè¿›è¡Œæ—¶æ€ï¼Œè¡¨ç¤ºâ€åœ¨â€¦æ—¶â€ï¼Œå¼ºè°ƒæ—¶é—´æ®µçš„æŒç»­æ€§ï¼Œä¹Ÿå¯å¼ºè°ƒä¸»ä»å¥çš„å¯¹æ¯”ã€‚ä¾‹å¦‚ï¼šWhile my mother was reading the newspaper,I was watching TV.å½“æˆ‘å¦ˆå¦ˆåœ¨çœ‹æŠ¥çº¸æ—¶ï¼Œæˆ‘æ­£åœ¨çœ‹ç”µè§†ã€‚(was readingæ˜¯å»¶ç»­æ€§çš„åŠ¨è¯ï¼Œwas readingå’Œwas watchingåŒæ—¶å‘ç”Ÿã€‚)I like playing football while you like playing basketball.æˆ‘å–œæ¬¢è¸¢è¶³çƒï¼Œè€Œä½ å–œæ¬¢æ‰“ç¯®çƒã€‚(å¯¹æ¯”)aså¼•å¯¼ä»å¥çš„è°“è¯­åŠ¨è¯æ˜¯å»¶ç»­æ€§çš„åŠ¨è¯ï¼Œè¡¨ç¤ºâ€ä¸€è¾¹â€¦ä¸€è¾¹â€ï¼Œä¸€èˆ¬ç”¨äºä¸»å¥å’Œä»å¥åŠ¨ä½œåŒæ—¶å‘ç”Ÿï¼›asä¹Ÿå¯è¡¨ç¤ºâ€â€éšç€â€¦â€ã€‚ä¾‹å¦‚ï¼šWe always sing as we walk.æˆ‘ä»¬æ€»æ˜¯è¾¹èµ°è¾¹å”±ã€‚(asè¡¨ç¤ºâ€ä¸€è¾¹â€¦ä¸€è¾¹â€)As families moved away from their stable community,the informal flow of information is cut off.éšç€å®¶åº­ç¦»å¼€ä»–ä»¬ç¨³å®šçš„ç¤¾åŒºï¼Œè¿™ç§éæ­£å¼çš„ä¿¡æ¯æµå°±è¢«åˆ‡æ–­äº†ã€‚(asè¡¨ç¤ºâ€éšç€â€¦â€)no sooner â€¦ thanå’Œhardly â€¦ whenå¼•å¯¼çš„æ—¶é—´çŠ¶è¯­ä»å¥ï¼Œå«ä¹‰ï¼šè¡¨ç¤ºâ€ä¸€â€¦å°±â€¦â€æ—¶æ€ï¼šä¸»å¥ç”¨è¿‡å»å®Œæˆæ—¶ï¼Œä»å¥ç”¨ä¸€èˆ¬è¿‡å»æ—¶ã€‚å¦‚ï¼šI had no sooner begun to take a shower, the water was unavailable. æˆ‘ä¸€å¼€å§‹æ´—æ¾¡ï¼Œå°±åœæ°´äº†ã€‚They hardly had arrived at the bus stop when the bus started to leave. ä»–ä»¬ä¸€åˆ°è½¦ç«™ï¼Œè½¦å°±å¼€èµ°äº†ã€‚é«˜çº§ç”¨æ³•ï¼šno sooner â€¦ thanå’Œhardly â€¦ whenå¼•å¯¼æ—¶é—´çŠ¶è¯­ä»å¥æ—¶å¯ä»¥ä½¿ç”¨å€’è£…å¥å¼ï¼Œä¸Šè¿°å¥å­å¯æ”¹æˆï¼šNo sooner had I begun to take a shower, the water was unavailable.Hardly had they arrived at the bus stop when the bus started to leave.whenå¼•å¯¼æ—¶é—´çŠ¶è¯­ä»å¥çš„ç‰¹æ®Šç”¨æ³•ï¼šWhen I was a little girl, I loved Jeff so much.Whenå¼•å¯¼æ—¶é—´çŠ¶è¯­ä»å¥ï¼Œå¦‚æœä»å¥å’Œä¸»å¥ä¸»è¯­ä¸€è‡´ï¼Œå¹¶ä¸”ä»å¥çš„è°“è¯­ä¸­æœ‰beåŠ¨è¯ï¼Œæ­¤æ—¶ä»å¥çš„ä¸»è¯­å’ŒbeåŠ¨è¯å¯ä»¥ä¸€èµ·çœç•¥çœç•¥åæ˜¯ï¼šWhen a little girl, I loved Jeff so much.ä½†æ˜¯When I loved Jeff, I could sing all his songs. è¿™å¥è¯å°±ä¸èƒ½å†™æˆä¸Šé¢çš„å½¢å¼ï¼Œå› ä¸ºä»å¥çš„è°“è¯­ä¸­æ²¡æœ‰beåŒºåˆ†untilå’Œnot â€¦ untilI will wait here until you come.I will not leave until you come.å…¶å®not â€¦ untilå¹¶æ²¡æœ‰ç¿»è¯‘æˆå¦å®šçš„æ„æ€å®ƒä»¬çš„åŒºåˆ«åœ¨äºä¸»å¥çš„è°“è¯­åŠ¨è¯ï¼Œå¦‚æœä¸»å¥çš„è°“è¯­åŠ¨è¯æ˜¯çŸ­æš‚æ€§åŠ¨è¯ï¼Œå°±ç”¨not â€¦ untilï¼›å¦‚æœæ˜¯å»¶ç»­æ€§åŠ¨è¯ï¼Œå°±ç”¨untilä¾‹å­ï¼šç›´åˆ°æˆ‘æœ‰äº†è‡ªå·±çš„å¥³å„¿ï¼Œæˆ‘æ‰æ„è¯†åˆ°æ¯äº²çš„ä¼Ÿå¤§ã€‚I did not realize the greatness of mothers until I had my own daughter.realizeæ˜¯çŸ­æš‚æ€§åŠ¨è¯ï¼Œæ‰€ä»¥ç”¨not.â€¦untilåœ°ç‚¹çŠ¶è¯­ä»å¥å¸¸ç”¨å¼•å¯¼è¯ï¼šwhereä¸å¸¸ç”¨å¼•å¯¼è¯ï¼šwhereverï¼Œanywhereï¼Œeverywhereç­‰whereå¼•å¯¼çš„åœ°ç‚¹çŠ¶è¯­ä»å¥ä¸å®šè¯­ä»å¥çš„åŒºåˆ«å’Œè½¬æ¢ï¼šåŒºåˆ«åœ°ç‚¹çŠ¶è¯­ä»å¥å’Œå®šè¯­ä»å¥çš„å¼•å¯¼è¯éƒ½æœ‰whereï¼Œæ‰€ä»¥éå¸¸å®¹æ˜“æ··æ·†ã€‚ä¸¤ç§ä»å¥çš„ç¿»è¯‘æ–¹æ³•æ˜¯ä¸€æ ·çš„ï¼Œä½†ä¸¤è€…åœ¨è¯­æ³•æ„ä¹‰ä¸Šæ˜¯å¤©å·®åœ°åˆ«çš„åŒºåˆ†è¿™ä¸¤ç§å¥å­æœ€å…³é”®çš„å°±æ˜¯çœ‹whereæ˜¯å¦æŒ‡ä»£å‰é¢çš„å…ˆè¡Œè¯ï¼Œå¦‚æœæŒ‡ä»£å‰é¢çš„å…ˆè¡Œè¯å°±æ˜¯å®šè¯­ä»å¥ï¼Œå¦åˆ™æ˜¯åœ°ç‚¹çŠ¶è¯­ä»å¥å½“whereå¼•å¯¼åœ°ç‚¹çŠ¶è¯­ä»å¥æ—¶ï¼Œwhereæ˜¯ä»å±è¿è¯ï¼Œä»å¥ä¿®é¥°ä¸»å¥çš„è°“è¯­åŠ¨è¯ï¼Œwhereå‰è¾¹æ²¡æœ‰è¡¨ç¤ºåœ°ç‚¹çš„å…ˆè¡Œè¯ã€‚å¦‚ï¼šI find my phone where I had lost it. æˆ‘åœ¨ä¸¢æ‰‹æœºçš„åœ°æ–¹æ‰¾åˆ°äº†æˆ‘çš„æ‰‹æœºã€‚whereå¼•å¯¼çš„å¥å­ä¿®é¥°findè¿™ä¸ªåŠ¨è¯ï¼Œè¯´æ˜åœ¨å“ªé‡Œæ‰¾åˆ°çš„ï¼Œè™½ç„¶ä»å¥å‰æœ‰åè¯ï¼Œä½†ä¸æ˜¯è¡¨ç¤ºåœ°ç‚¹çš„ï¼Œåªæ˜¯è°“è¯­åŠ¨è¯çš„å®¾è¯­ã€‚å½“whereå¼•å¯¼å®šè¯­ä»å¥æ—¶ï¼Œä»å¥ä¿®é¥°å…ˆè¡Œè¯ï¼Œwhereæ˜¯å…³ç³»å‰¯è¯ï¼Œä»£æ›¿è¡¨åœ°ç‚¹çš„å…ˆè¡Œè¯åœ¨ä»å¥ä¸­ä½œåœ°ç‚¹çŠ¶è¯­ã€‚å¦‚ï¼šThis is the house where I lived two years ago. è¿™å°±æ˜¯æˆ‘ä½äº†ä¸¤å¹´çš„æˆ¿å­ã€‚whereå¼•å¯¼çš„ä»å¥ä¿®é¥°houseè¿™ä¸ªåè¯ï¼Œè¡¨ç¤ºæ˜¯ä¸ªä»€ä¹ˆæ ·çš„æˆ¿å­â€”æˆ‘å±…ä½äº†ä¸¤å¹´çš„æˆ¿å­ã€‚å†çœ‹åˆ»èˆŸæ±‚å‰‘çš„æ•…äº‹ï¼šThe man made a mark where he has left the swoop. (åœ°ç‚¹çŠ¶è¯­ä»å¥)The man made a mark at the place where he has left the swoop. (å®šè¯­ä»å¥)ä¸¤å¥è¯éƒ½ç¿»è¯‘æˆï¼šè¿™ä¸ªäººåœ¨ä¸¢å‰‘çš„åœ°æ–¹åšäº†æ ‡è®°ã€‚ä¸¤ä¸ªå¥å­çš„ä¸­æ–‡ç¿»è¯‘æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯è‹±æ–‡çš„è¯­æ³•ç»“æ„éå¸¸ä¸åŒè™½ç„¶ä¸¤ä¸ªå¥å­ä¸­whereå‰é¢éƒ½æœ‰åè¯ï¼Œä½†æ˜æ˜¾å¥2å®šè¯­ä»å¥ä¿®é¥°çš„æ˜¯è¡¨ç¤ºåœ°ç‚¹çš„å…ˆè¡Œè¯the placeï¼Œèµ·ä¿®é¥°é™å®šä½œç”¨ï¼Œè¡¨ç¤ºâ€åœ¨ä¸¢å‰‘çš„è¿™ä¸ªåœ°æ–¹â€åšæ ‡è®°å¥1ä¸­ï¼Œä¸»å¥çš„åŠ¨ä½œå‘ç”Ÿåœ¨â€ä¸¢å‰‘çš„åœ°æ–¹â€ï¼Œä¸â€æ ‡è®°â€æ²¡æœ‰å…³ç³»ï¼Œåè€Œæ˜¯â€åšæ ‡è®°â€ä¸ä»å¥æœ‰å…³ï¼Œå³åœ¨ä»€ä¹ˆä½ç½®åšæ ‡è®°å› æ­¤ï¼Œå¥1çš„ä»å¥æ˜¯ä¿®é¥°åŠ¨è¯è¯ç»„make a markçš„ã€‚è½¬æ¢ï¼šä¸€èˆ¬åœ¨çŠ¶è¯­ä»å¥å‰åŠ ä¸Šâ€in/at the+å…·ä½“åœ°ç‚¹â€ï¼Œå°±å˜æˆå®šè¯­ä»å¥ã€‚å¦‚ï¼šæˆ‘ä»¬å°†ä»ä¸Šæ¬¡åœä¸‹æ¥çš„åœ°æ–¹å¼€å§‹ã€‚çŠ¶è¯­ä»å¥ï¼šWe will start where we left off.æ”¹å†™ä¸ºå®šè¯­ä»å¥ï¼šWe will start at the point where we left off.Everywhere I see rural laborers in the city,it will remind me of my old father.æ¯å½“çœ‹åˆ°åŸå¸‚é‡Œçš„å†œæ°‘å·¥ï¼Œæˆ‘å°±ä¼šæƒ³èµ·æˆ‘çš„è€çˆ¶äº²ã€‚Wherever you go,whatever you do,I am just here waiting for you.æ— è®ºä½ å»å“ªé‡Œï¼Œæ— è®ºä½ åšä»€ä¹ˆï¼Œæˆ‘éƒ½åœ¨è¿™é‡Œç­‰ä½ ã€‚è¿™ç§èŠ±åœ¨æ½®æ¹¿çš„åœ°æ–¹ç”Ÿé•¿å¾—å¾ˆå¥½ã€‚The flower grows well where it is moist.å…¶å®å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬ä¸ä¼šæŠŠè¿™å¥è¯å†™æˆçŠ¶è¯­ä»å¥ï¼Œé€šå¸¸éƒ½æ˜¯å†™æˆä»‹è¯çŸ­è¯­ä½œçŠ¶è¯­ã€‚æ‰€ä»¥ï¼Œä¸Šé¢çš„å¥å­é€šå¸¸ä¼šå†™æˆï¼šThe flower grows well in moist places.åŸå› çŠ¶è¯­ä»å¥å¸¸ç”¨å¼•å¯¼è¯ï¼šbecause, since, as, forç­‰ã€‚ä¸å¸¸ç”¨å¼•å¯¼è¯ï¼šseeing that, now that, in that, considering that, given that, as much as, so muchasè™½ç„¶ä¸å¸¸ç”¨ï¼Œä½†æ˜¯å’Œå¸¸ç”¨çš„å¼•å¯¼è¯ç›¸æ¯”ï¼Œç”¨æ³•æ²¡æœ‰å¤ªå¤§åŒºåˆ«éœ€è¦æ³¨æ„çš„æ˜¯æœ‰ä¸€äº›ä»‹è¯çŸ­è¯­ï¼Œä¹Ÿç¿»è¯‘æˆâ€å› ä¸ºâ€ï¼Œä½†å®ƒä»¬åé¢åªèƒ½è·Ÿåè¯(çŸ­è¯­)ï¼Œä¸èƒ½è·Ÿä»å¥ï¼šbecause of, due to, owing to, thanks to, for the sake of, as a result ofä¾‹å­ï¼šå› ä¸ºä»–ç²—å¿ƒï¼Œä»–æ˜¨å¤©å‡ºäº†ä¸€åœºè½¦ç¥¸ã€‚Because he was careless, he had a car accident yesterday.æˆ–Because of his carelessness, he had a car accident yesterday.éœ€è¦æ³¨æ„çš„æ˜¯åœ¨è¿™æ‰¹è¡¨ç¤ºâ€å› ä¸ºâ€çš„ä»‹è¯çŸ­è¯­ä¸­ï¼Œdue toé€šå¸¸æ”¾åœ¨å¥æœ«ï¼Œä¸æ”¾åœ¨å¥é¦–ï¼›è€Œowing toé€šå¸¸æ”¾åœ¨å¥é¦–ï¼Œä¸æ”¾åœ¨å¥æœ«ï¼›å…¶ä»–çš„çŸ­è¯­åˆ™å¯å‰å¯åã€‚å¦‚ï¼šOwing to tolerance between the couple,the marriage can last long.The marriage can last long due to tolerance between the couple.ç›®çš„çŠ¶è¯­ä»å¥å¸¸ç”¨å¼•å¯¼è¯ï¼šsothatï¼Œin order thatå¸¸è§çš„åŠ¨è¯ä¸å®šå¼ä¹Ÿå¯ä»¥è¡¨ç¤ºç›®çš„ï¼štoï¼Œin order toï¼Œso as toç­‰ï¼Œåè·ŸåŠ¨è¯åŸå½¢ã€‚ä¸ºäº†èƒ½æœ‰ä¸€ä¸ªæ›´ç¾å¥½çš„æœªæ¥ï¼Œæˆ‘å†³å®šè€ƒç ”ã€‚I am determined to take part in the examination of postgraduates so that I could have a brighter future.æˆ– I am determined to take part in the examination of postgraduates in order to have a brighter.ä¸ºäº†ä¸è®©å„¿å¥³æ‹…å¿ƒï¼Œæ…¢æ…¢è€å»çš„çˆ¶æ¯æ€»å¯¹ä»–ä»¬è¯´ç€å„ç§å„æ ·çš„è°è¯ã€‚Parents getting old gradually are always telling a variety of lies in order that their daughters or sons will not worry about them.æˆ– In order not to let their children worry about them, parents geting old gradually are always telling a variety of lies.ç”¨in order toæ—¶ä¸€å®šè¦ä¿æŒå‰åä¸»è¯­ä¸€è‡´ï¼Œä¸»è¯­ä¸ä¸€è‡´æ—¶åªèƒ½ç”¨in order thatï¼Œæ¯”å¦‚ï¼šHe works hard in order that his family can live well. å°±ä¸èƒ½ç”¨in order toä½œç›®çš„çŠ¶è¯­ç»“æœçŠ¶è¯­ä»å¥å¸¸ç”¨å¼•å¯¼è¯ï¼šso that, so â€¦ that, such â€¦ thatä¸å¸¸ç”¨å¼•å¯¼è¯ï¼što the degree that, to the extent that, to such a degree thatso thatï¼Œso â€¦ thatå’Œsuch â€¦ thatçš„åŒºåˆ«so thatæ—¢å¯ä»¥å¼•å¯¼ç›®çš„çŠ¶è¯­ä»å¥ï¼Œä¹Ÿå¯ä»¥å¼•å¯¼ç»“æœçŠ¶è¯­ä»å¥ã€‚å¼•å¯¼ç›®çš„çŠ¶è¯­ä»å¥æ—¶ï¼Œ ä¼šå’Œæƒ…æ€åŠ¨è¯ä¸€èµ·è¿ç”¨ï¼›å¼•å¯¼ç»“æœçŠ¶è¯­ä»å¥æ—¶ï¼Œåˆ™ä¸å’Œæƒ…æ€åŠ¨è¯è¿ç”¨ç›®çš„çŠ¶è¯­ä»å¥ï¼šI hurried through my work so that I could be on time for the TV.æˆ‘åŒ†å¿™å®Œæˆå·¥ä½œä»¥ä¾¿å‡†æ—¶æ”¶çœ‹ç”µè§†èŠ‚ç›®ã€‚ç»“æœçŠ¶è¯­ä»å¥ï¼šWe moved to the country so that we were away from the noisy city.æˆ‘ä»¬æ¬å»éƒŠå¤–ï¼Œè¿™æ ·ä¾¿è¿œç¦»äº†å–§é—¹çš„åŸå¸‚ã€‚so â€¦ thatçš„ç”¨æ³•so+å½¢å®¹è¯/å‰¯è¯+thatThe movie was so boring that I gave up watching it halfway through.è¿™éƒ¨ç”µå½±å¤ªä¹å‘³äº†ï¼Œä»¥è‡³äºæˆ‘çœ‹åˆ°ä¸€åŠå°±ä¸æƒ³çœ‹äº†ã€‚so+many/much/few/little+åè¯+thatHe got so little money that his family had to live on welfare.ä»–æŒ£é’±å¾ˆå°‘ï¼Œä»¥è‡³äºä»–çš„å®¶äººä¸å¾—ä¸é æ•‘æµé‡‘ç”Ÿæ´»ã€‚so+å½¢å®¹è¯+a/an+å¯æ•°åè¯å•æ•°+thatLiu Xiaoyan is so nice a teacher that everyone loves and respects her.åˆ˜æ™“è‰³æ˜¯å¦‚æ­¤å¥½çš„ä¸€ä¸ªè€å¸ˆï¼Œä»¥è‡³äºæ¯ä¸ªäººéƒ½æ•¬çˆ±å¥¹ã€‚such â€¦ thatçš„ç”¨æ³•such+a/an+å½¢å®¹è¯+å¯æ•°åè¯å•æ•°+thatIt was such a terrible show that none of us would pay for watching it again.è¿™åœºæ¼”å‡ºå¤ªç³Ÿç³•äº†ï¼Œä»¥è‡³äºæˆ‘ä»¬éƒ½ä¸ä¼šå†èŠ±é’±å»çœ‹äº†ã€‚æ³¨æ„ï¼šs0.â€¦that å’Œsuch..thatä¸¤ä¸ªç»“æ„å¯ä»¥äº’æ¢ï¼Œä½†è¦è°ƒæ•´å† è¯çš„ä½ç½®ã€‚such+å½¢å®¹è¯+å¯æ•°åè¯å¤æ•°/ä¸å¯æ•°åè¯+thatThey are such adorable babies that we all love them.è¿™äº›å©´å„¿éƒ½å¾ˆå¯çˆ±ï¼Œæˆ‘ä»¬éƒ½å¾ˆå–œæ¬¢ä»–ä»¬ã€‚This was such wonderful music that it deserved replaying.è¿™ç§éŸ³ä¹å¾ˆå¥½å¬ï¼Œå€¼å¾—å•æ›²å¾ªç¯ã€‚æ¡ä»¶çŠ¶è¯­ä»å¥å¸¸ç”¨å¼•å¯¼è¯ï¼šifï¼Œunless(è¡¨ç¤ºif not)ç‰¹æ®Šå¼•å¯¼è¯ï¼šas/so long as(åªè¦), only if(åªè¦), providing/provided that(å‡å¦‚), supposing(that)(å‡å¦‚), in case that(ä»¥é˜²), on condition that(å¦‚æœ)åªè¦æœ‰ä¸€ä¸å¸Œæœ›ï¼Œæˆ‘å°±ä¸ä¼šæ”¾å¼ƒã€‚I will never give up so long as there is a ghost of hope.å¦‚æœçˆ±æ˜¯ä¸€æ¯æ¯’è¯ï¼Œæˆ‘ä¹Ÿæ„¿æ„ä¸€é¥®è€Œå°½ã€‚On condition that love is a cup of poison,I will drink it up without hesitating.äº‹å®ä¸Šï¼Œæ¡ä»¶çŠ¶è¯­ä»å¥ç»å¸¸ä¼šä¸è™šæ‹Ÿè¯­æ°”ç»“åˆä½¿ç”¨è®©æ­¥çŠ¶è¯­ä»å¥å¸¸ç”¨å¼•å¯¼è¯ï¼šthough, although, even if, even thoughç­‰ç‰¹æ®Šå¼•å¯¼è¯ï¼šas, while(ä½œâ€œè™½ç„¶â€ä¹‹æ„è®²ï¼Œç”¨åœ¨å¥é¦–), no matter â€¦ (æ— è®º), in spiteof the fact that(è™½ç„¶ï¼Œå°½ç®¡), whatever, whoever, wherever, whenever, however, whicheverç­‰è®©æ­¥çŠ¶è¯­ä»å¥ç»å¯¹æ˜¯ä½œæ–‡ä¸­çš„ç»å…¸è¡¨è¾¾ï¼Œå°±åƒæˆ‘ä»¬è™½ç„¶åªç©¿ä¸€ä»¶å¾ˆæ™®é€šçš„è¡£æœï¼Œä½†æ˜¯å¦‚æœä½©æˆ´äº†ä¸€æ¡å¾ˆåä¸½çš„ä¸å·¾ï¼Œç¬é—´å°±èƒ½è¡¬æ‰˜å‡ºæˆ‘ä»¬çš„æ°”è´¨å½“æˆ‘ä»¬çš„è¡¨è¾¾è¿‡äºç»å¯¹çš„æ—¶å€™ï¼Œç”¨ä¸Šè¡¨ç¤ºè®©æ­¥çš„å¼•å¯¼è¯ï¼Œå¦‚althoughï¼Œæ•ˆæœå°±ä¼šå˜å¾—å¾ˆå¥½ä»–è™½ç„¶ç»å†äº†å¤šæ¬¡å¤±è´¥ï¼Œä½†ä¾ç„¶åšæŒæ¢¦æƒ³ã€‚Although/Though he failed again and again, he still adheres to pursuing his dream.è™½ç„¶è‚ç‚æ‚£è€…ç—Šæ„ˆäº†ï¼Œä½†ä»é¡»å¯¹å…¶è¿›è¡Œå®šæœŸçš„å¥åº·æ£€æŸ¥ã€‚The periodical physical examination must be given to a patient whoever has recuperatedfrom hepatitis.è‡ªåŠ¨åŒ–æœºå™¨è™½ç„¶æœ‰å¾ˆå¤šä¼˜ç‚¹ï¼Œä½†å®ƒä»¬åªèƒ½å¹²äººä»¬å©å’å®ƒä»¬è¦å¹²çš„äº‹ã€‚As Automatic machines have many advantages, it can only do the jobs they have beentold to do.åˆ˜æ˜¯ä¸€ä¸ªç¾å¥³ã€‚è‹¥å†™æˆâ€Liu is a beauty.â€åˆ™æ˜¾å¾—å•è°ƒï¼Œå†ç¾çš„äººä¹Ÿä¼šæœ‰ç¼ºç‚¹Liu is a beauty although she has a pair of little eyes.ç›²ç›®è¿½æ˜Ÿä¼šæµªè´¹æˆ‘ä»¬å¾ˆå¤šæ—¶é—´å’Œç²¾åŠ›ã€‚æˆ‘ä»¬ä¸èƒ½ä¸€ä¸‹å­å…¨éƒ¨å¦å®šæ˜æ˜Ÿï¼Œä»–ä»¬ä¹Ÿä¸€å®šæœ‰ä¸å°‘ä¼˜ç‚¹ã€‚Pursuing stars blindly will waste a lot of time and energy although they may workhard or be quite handsome.æ±¡æŸ“å¾ˆä¸¥é‡ã€‚Pollution becomes increasingly serious although a sea of adults fail to realize it.æ€»ç»“äº‹å®ä¸Šï¼Œåœ¨ä½œæ–‡ä¸­ï¼Œå‡ ä¹æ¯å¥è¯çš„åé¢éƒ½å¯ä»¥åŠ ä¸€ä¸ªç”±althoughå¼•å¯¼çš„è®©æ­¥çŠ¶è¯­ä»å¥å¦‚æœåˆ†æåŸå› æ—¶ï¼Œå†™å‡ºæ¥çš„å¥å­æ¯”è¾ƒçŸ­ï¼Œå°±å¯ä»¥åœ¨åé¢åŠ ä¸€ä¸ªç”±althoughå¼•å¯¼çš„è®©æ­¥çŠ¶è¯­ä»å¥æ¥æ‹‰é•¿å¥å­å¦‚ï¼šå® ç‰©çš„ç¡®ç»™æˆ‘å¥¶å¥¶å¸¦æ¥äº†å¾ˆå¤šå¿«ä¹ï¼Œè™½ç„¶ç…§é¡¾å®ƒä»¬éœ€è¦æ—¶é—´å’Œç²¾åŠ›ã€‚Pets indeed bring much delight to my grandma although taking care of them needs time andenergy.æ–¹å¼çŠ¶è¯­ä»å¥å¸¸ç”¨å¼•å¯¼è¯ï¼šas, as if, asthough(å¥½åƒï¼Œä¼¼ä¹)ç‰¹æ®Šå¼•å¯¼è¯ï¼šthe way(æ–¹å¼)é™¤æ­¤ä»¥å¤–ï¼Œæœ‰äº›ä»‹è¯(çŸ­è¯­)ä¹Ÿè¡¨ç¤ºæ–¹å¼ï¼šby, through, in â€¦ way, in â€¦ manner(ä»¥â€¦çš„æ–¹å¼)å¥¹å’Œæˆ‘è¯´è¯çš„æ ·å­å¥½åƒå¥¹æ˜¯æˆ‘å¦ˆä¸€æ ·ã€‚Shetalks with me as she were my mother.é€šè¿‡ä¸€ç§å†·é™çš„ã€å®¢è§‚çš„æ–¹å¼ï¼Œä»–ç ´è§£äº†è¿™ä¸ªå¯†ç ã€‚Thepassword was decoded by him in a dispassionate and objective manner.è¿™ä¸€åˆ‡æˆ‘éƒ½è®°å¿†çŠ¹æ–°ï¼Œä»¿ä½›å°±æ˜¯æ˜¨å¤©å‘ç”Ÿçš„äº‹ä¸€æ ·ã€‚I can still remember the whole thing in great detail as though it were yesterday.ä»–ä»¬è°ˆè¯çš„é‚£è‚¡äº²çƒ­åŠ²å°±å¦‚åŒæ˜¯å¤šå¹´çš„è€æœ‹å‹ä¼¼çš„ã€‚They are talking as if they had been friends for yearsä½ å¸Œæœ›äººå®¶æ€æ ·å¾…ä½ ï¼Œä½ å°±è¦æ€æ ·å¾…äººã€‚Always do to the others as you would be done by.å½“å®‡å®™é£èˆ¹ä»¥æƒŠäººçš„é€Ÿåº¦ç¦»å¼€åœ°çƒæ—¶ï¼Œå®‡èˆªå‘˜ä»¬è§‰å¾—è‡ªå·±ä¼¼ä¹è¢«ç´§å‹åœ¨å®‡å®™é£èˆ¹çš„åº•å£ä¸Šã€‚When the spaceship leaves the earth at a tremendous speed, the astronauts feel as ifthey were being crushed against the spaceship floor.æ¯”è¾ƒçŠ¶è¯­ä»å¥å¸¸ç”¨å¼•å¯¼è¯ï¼šas, thanç‰¹æ®Šå¼•å¯¼è¯ï¼šthe more â€¦ the more â€¦ , more than, more â€¦ than â€¦ , not so much â€¦ as â€¦The youth of today are better off than we used to be.ä»Šå¤©çš„å¹´è½»äººçš„å¢ƒå†µæ¯”æˆ‘ä»¬è¿‡å»è¦å¥½ã€‚She is not so energetic as she used to be.å¥¹ä¸åƒè¿‡å»é‚£æ ·å……æ»¡æ´»åŠ›äº†ã€‚The result of this experiment is better than that of the last one.è¿™æ¬¡å®éªŒçš„ç»“æœè¦æ¯”ä¸Šæ¬¡å¥½ã€‚å·©ä¿éå¸¸ä¼˜é›…ã€‚Gong Li looks as graceful as a red rose, who can take many peopleâ€™s breath away.è‹±è¯­å¾ˆé‡è¦ã€‚English proves as essential as air and water, which plays a key role in our daily life.æ±¡æŸ“å¾ˆä¸¥é‡ã€‚Pollution becomes as serious as earthquakes, which has threatened our existence or even taken peopleâ€™s lives away.åˆ†è¯ä½œçŠ¶è¯­å…ˆå†™ä¸¤ä¸ªå¥å­æ¥å¼•å‡ºè¯¥è¯­æ³•ç‚¹å¦‚æœå†¬å¤©æ¥äº†ï¼Œæ˜¥å¤©å°±ä¸è¿œäº†If winter comes, spring will arrive soon.å½“æˆ‘è¿˜æ˜¯ä¸€ä¸ªå°å¥³å­©çš„æ—¶å€™ï¼Œæˆ‘ç‰¹åˆ«æ¸´æœ›é•¿å¤§When I was a little girl, I was especially eager to grow up.è™½ç„¶è¿™ä¸¤ä¸ªå¥å­æ²¡æœ‰è¯­æ³•é”™è¯¯ï¼Œä½†æ˜¯éƒ½æ²¡æœ‰è¾¾åˆ°å‡ºå¥‡åˆ¶èƒœçš„æ•ˆæœï¼ŒåŸå› å¾ˆå¯èƒ½åœ¨äºåŒå­¦ä»¬æ²¡æœ‰è®©åˆ†è¯ä½œçŠ¶è¯­ï¼Œè€Œæ˜¯è®©ä»å¥ä½œäº†çŠ¶è¯­æŠŠçŠ¶è¯­ä»å¥è½¬åŒ–æˆåˆ†è¯ä½œçŠ¶è¯­æŠŠçŠ¶è¯­ä»å¥æœ€æ˜æ˜¾çš„æ ‡å¿—â€”å¼•å¯¼è¯ifå»æ‰ï¼Œé‚£ä¹ˆå°±ä¼šå‡ºç°ä¸€ä¸ªè¯­æ³•é”™è¯¯çš„ç°è±¡â€”é€—å·åœ¨è¿æ¥ä¸¤ä¸ªå¥å­Winter comes, spring will arrive soon.æ—¢ç„¶é€—å·ä¸èƒ½è¿æ¥ä¸¤ä¸ªå¥å­ï¼Œé‚£æˆ‘ä»¬å¯ä»¥è€ƒè™‘æŠŠå‰é¢çš„å¥å­å˜æˆéå¥å­ç»“æ„ï¼Œé‚£æ€ä¹ˆæŠŠå¥å­å˜æˆä¸æ˜¯å¥å­(éå¥å­ç»“æ„)å‘¢ï¼Ÿåªéœ€è¦æŠŠåŠ¨è¯(è¯ç»„)å˜æˆä¸æ˜¯åŠ¨è¯(è¯ç»„)(éè°“è¯­ç»“æ„)å°±å¯ä»¥å®ç°è¿™ä¸€æ­¥é‚£å°±æ˜¯ï¼šWinter coming, spring will arrive soon.çœ‹éè°“è¯­éƒ¨åˆ†çš„ä¸»è¯­å’Œåé¢å¥å­çš„ä¸»è¯­æ˜¯å¦ä¸€è‡´ã€‚å¦‚æœä¸€è‡´ï¼Œåˆ†è¯çš„ä¸»è¯­çœç•¥ï¼›å¦‚æœä¸ä¸€è‡´ï¼Œåˆ†è¯çš„ä¸»è¯­ä¿ç•™å°±æœ¬å¥è¯è€Œè¨€ï¼Œæ˜¾ç„¶ä¸»è¯­ä¸ä¸€è‡´ï¼Œæ‰€ä»¥ä¿ç•™åŒæ ·ä¸‰æ­¥èµ°ï¼Œå¥2å¯ä»¥è½¬åŒ–ä¸ºï¼šBeing a little girl, I was especially eager to grow up.å°ç»“ï¼šåˆ†è¯çš„ä¸»è¯­å¦‚æœå’Œä¸»å¥çš„ä¸»è¯­ä¸ä¸€è‡´ï¼Œè¿™ç§è‹±è¯­è¯­æ³•ç°è±¡å°±å«ä½œç‹¬ç«‹ä¸»æ ¼ï¼›åˆ†è¯çš„ä¸»è¯­å¦‚æœå’Œä¸»å¥çš„ä¸»è¯­ä¸€è‡´ï¼Œå°±å«ä½œéè°“è¯­åŠ¨è¯ä½œçŠ¶è¯­ä¾‹å­ï¼šå·¥ä½œç»“æŸåï¼Œæˆ‘ä»¬éƒ½å„è‡ªå›å®¶äº†ã€‚      çŠ¶è¯­ä»å¥ï¼šAfterthe job was finished, we went home respectively.åˆ†è¯ä½œçŠ¶è¯­ï¼šThejob finished, we went home respectively.å› ä¸ºæˆ‘èƒ–ï¼Œæ‰€ä»¥æˆ‘å¿«ä¹ã€‚çŠ¶è¯­ä»å¥ï¼šBecauseI am fat, I feel delighted.åˆ†è¯ä½œçŠ¶è¯­ï¼šBeing fat, I feel delighted.æ˜¯ä¸æ˜¯éå¾—å‡ºç°çŠ¶è¯­ä»å¥æ‰èƒ½ä½¿ç”¨åˆ†è¯ä½œçŠ¶è¯­å‘¢å½“ç„¶ä¸æ˜¯ï¼Œåªè¦æ˜¯åœ¨èƒ½å¤Ÿç”¨é€—å·æ¥è¿æ¥ä¸¤ä¸ªå¥å­çš„æƒ…å†µä¸‹ï¼Œéƒ½å¯ä»¥æŠŠé‚£ä¸ªæ¬¡è¦çš„å¥å­å˜æˆåˆ†è¯ä½œçŠ¶è¯­é‚£ä¸ªè€å¦‡äººååœ¨è§’è½é‡Œï¼Œçœ¼é‡Œå……æ»¡äº†æ³ªæ°´ã€‚Theold lady sits in the corner, her eyes are filled with tears.è¯¥ç¿»è¯‘æ˜¾ç„¶æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºé€—å·ä¸èƒ½è¿æ¥ä¸¤ä¸ªå¥å­ã€‚æ‰€ä»¥è¦æŠŠç¬¬ä¸€ä¸ªå¥å­çš„è°“è¯­åŠ¨è¯å˜æˆéè°“è¯­åŠ¨è¯ï¼Œäºæ˜¯å†™æˆï¼šThe old lady sitting in the corner, her eyes are filled with tears.è‡ªä¿¡æ˜¯ä¸€ç§ç§¯æçš„å¿ƒæ€ï¼Œå®ƒèƒ½ä½¿å¾ˆå¤šå¥‡è¿¹é™ä¸´ã€‚    Self-confidence is an active mentality, it enables many miracles to happen.åŒç†ï¼Œé€—å·ä¸èƒ½è¿æ¥ä¸¤ä¸ªå¥å­ã€‚è¦æŠŠå‰é¢çš„å¥å­å˜æˆåˆ†è¯ä½œçŠ¶è¯­ï¼Œäºæ˜¯å†™æˆï¼šBeing an active mentality, self-confidence enables many miracles to happen.  â€‹    å®šè¯­å’ŒçŠ¶è¯­çš„åŒºåˆ«æˆ‘ä»¬å¯ä»¥å…ˆæ¥çœ‹å‡ ä¸ªä¾‹å¥ï¼šShe smiled when she saw me. whenåæ˜¯çŠ¶è¯­The woman who saw her son smiled immediately. who åæ˜¯å®šè¯­I loved the man when I met him. whenåæ˜¯çŠ¶è¯­å®šè¯­ä»å¥ä¸­ï¼Œå¦‚æœå…ˆè¡Œè¯æ˜¯äººï¼Œå¼•å¯¼è¯ä¸å¯èƒ½æ˜¯whenåŒºåˆ†æ—¢åƒå®šè¯­åˆåƒçŠ¶è¯­çš„æƒ…å†µæ¯”å¦‚ï¼šI love a boy in the kindergarten.å¦‚æœæ˜¯å®šè¯­å°±è¯‘ä¸ºï¼šæˆ‘çˆ±ä¸Šäº†ä¸€ä¸ªå¹¼å„¿å›­çš„å°ç”·ç”Ÿã€‚å¦‚æœæ˜¯çŠ¶è¯­å°±è¯‘ä¸ºï¼šåœ¨å¹¼å„¿å›­ï¼Œæˆ‘çˆ±ä¸Šäº†ä¸€ä¸ªå°ç”·ç”Ÿã€‚åˆ†æé•¿éš¾å¥æ—¶å¦‚æœé‡åˆ°è¿™ç§æƒ…å†µï¼Œä¸¤ç§è¯‘æ³•éƒ½æ²¡æœ‰é”™è¯¯(é™¤éæœ‰æ˜æ˜¾çš„è¯­å¢ƒæç¤º)ä½†æ˜¯ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå®šè¯­æ¯”çŠ¶è¯­å‡ºç°çš„æ¦‚ç‡å¤§ï¼Œæ‰€ä»¥å¦‚æœé‡åˆ°è¿™ç§æƒ…å†µï¼Œæœ¬ä¹¦æ¨èå®šè¯­ä¼˜å…ˆåŸåˆ™åŒºåˆ†whenå¼•å¯¼çš„æ˜¯å®šè¯­ä»å¥è¿˜æ˜¯çŠ¶è¯­ä»å¥I was singing when she came in.I still remember that day when you promised you would love me foreverä»¥ä¸Šä¸¤å¥è¯ï¼ŒåŒºåˆ†çš„å…³é”®åœ¨äºçœ‹whenä¹‹å‰æ˜¯ä¸æ˜¯è¡¨ç¤ºæ—¶é—´çš„è¯å¦‚æœæ˜¯è¡¨ç¤ºæ—¶é—´çš„è¯ï¼Œé‚£é€šå¸¸å°±æ˜¯å®šè¯­ä»å¥ï¼Œwhenç¿»è¯‘ä¸ºâ€å½“æ—¶ï¼Œè¿™æ—¶â€æˆ–â€å±Šæ—¶â€å¦‚æœwhenå‰é¢ä¸æ˜¯è¡¨ç¤ºæ—¶é—´çš„è¯ï¼Œé‚£é€šå¸¸æ˜¯çŠ¶è¯­ä»å¥ï¼Œwhenå‰ç½®ç¿»è¯‘æˆâ€å½“â€¦çš„æ—¶å€™â€äºæ˜¯ä¸Šé¢ä¸¤å¥è¯å°±ç¿»è¯‘æˆï¼šå½“å¥¹è¿›æ¥çš„æ—¶å€™ï¼Œæˆ‘æ­£åœ¨å”±æ­Œã€‚æˆ‘ä»ç„¶è®°å¾—é‚£å¤©ï¼Œå½“æ—¶ä½ æ‰¿è¯ºä¼šçˆ±æˆ‘ä¸€è¾ˆå­ã€‚asä¸“é¢˜as+åè¯(çŸ­è¯­)æ­¤æ—¶çš„asæ˜¯ä»‹è¯ï¼Œasåè·Ÿåè¯(çŸ­è¯­)æ—¶ï¼Œä¸€èˆ¬è¯‘ä¸ºâ€ä½œä¸ºâ€As a logical consequence of this development, separate journals have now appeared aimedmainly towards either professional or amateur readership.â€œas+åè¯çŸ­è¯­â€åœ¨æœ¬å¥ä¸­ä½œçŠ¶è¯­ï¼Œåé¢æ˜¯ä¸»å¥separateæŒ‡â€åˆ†å¼€çš„ï¼Œä¸åŒçš„â€ï¼›journalæŒ‡â€æ‚å¿—ï¼ŒæœŸåˆŠâ€ï¼Œjournalistç¿»è¯‘æˆâ€è®°è€…â€ï¼›aimä½œåŠ¨è¯ï¼ŒæŒ‡â€ä»¥â€¦ä¸ºç›®æ ‡â€ï¼›professionalor amateurç¿»è¯‘æˆâ€ä¸“ä¸šçš„æˆ–ä¸šä½™çš„â€ä½œä¸ºè¿™ç§å‘å±•çš„åˆç†ç»“æœï¼Œä¸åŒçš„æœŸåˆŠç°åœ¨éƒ½ä¸»è¦é’ˆå¯¹ä¸“ä¸šçš„æˆ–ä¸šä½™çš„è¯»è€…ã€‚As a result, the support for ambity to be and andin the mind of the young, is probably lower than it has ever been in the United States.â€œas+åè¯çŸ­è¯­â€æ”¾åœ¨ambitionçš„åé¢å……å½“å®šè¯­ã€‚ä¸»å¥è°“è¯­æ˜¯is,å¥å­çš„ä¸»å¹²å°±æ˜¯thesupport for ambition is probably lower than it has ever been; impulseåé¢æ˜¯impulseçš„åŒä½è¯­ï¼Œä¹Ÿå¯ä»¥è®¤ä¸ºæ˜¯æ’å…¥è¯­ï¼›inthe United Statesæ˜¯åœ°ç‚¹çŠ¶è¯­impulseä½œåè¯ï¼ŒæŒ‡â€å†²åŠ¨â€ï¼›qualityæŒ‡â€è´¨é‡ï¼Œå“è´¨â€ï¼Œæ­¤å¤„æŒ‡â€å“è´¨â€ç»“æœï¼Œåœ¨ç¾å›½(çŠ¶è¯­å‰ç½®)ï¼Œä½œä¸ºä¸€ç§å¥åº·çš„å†²åŠ¨ï¼Œä¸€ç§åº”è¯¥è¢«å¹´è½»äººå°Šé‡å¹¶ä¸”æ‰æ ¹äºä»–ä»¬æ€æƒ³çš„é«˜è´µå“è´¨ï¼Œé›„å¿ƒå£®å¿—æ‰€å¾—åˆ°çš„æ”¯æŒæˆ–è®¸æ¯”ä»¥å¾€ä»»ä½•æ—¶æœŸéƒ½ä½ã€‚åŠ¨è¯(è¯ç»„)+åè¯(çŸ­è¯­)+asæ­¤æ—¶çš„asä»ç„¶æ˜¯ä»‹è¯ï¼Œå®ƒçš„æ„æ€å–å†³äºå‰é¢åŠ¨è¯(è¯ç»„)çš„æ„æ€ã€‚ä¸€å®šæ³¨æ„åŠ¨è¯(è¯ç»„)å’Œasä¸­é—´åº”è¯¥æœ‰åè¯(çŸ­è¯­)ã€‚å½“å‘ç°æ²¡æœ‰åè¯(çŸ­è¯­)çš„æ—¶å€™ï¼Œå¯èƒ½æ˜¯åè¯(çŸ­è¯­)è¢«æ”¾åˆ°å…¶ä»–åœ°æ–¹å»äº†å¸¸è§çš„åŠ¨è¯è¯ç»„æœ‰ï¼šregard â€¦ as â€¦, view â€¦ as â€¦, define â€¦ as â€¦, classify â€¦ as â€¦shall define him as an individual who has elected as his pleasure in lifethe activity of thinking in Socratic(è‹æ ¼æ‹‰åº•çš„) way about moral problems.å¥å­ä¸»å¹²æ˜¯ï¼šIshall define him as an individualã€‚åœ¨whoæ‰€å¼•å¯¼çš„å®šè¯­ä»å¥ä¸­ï¼Œelectedå’Œasä¸­é—´æ²¡æœ‰åè¯(çŸ­è¯­)ï¼Œè¯´æ˜åè¯(çŸ­è¯­)çš„ä½ç½®è¢«åç§»äº†ã€‚ä»‹è¯çŸ­è¯­in Socratic wayæ˜¯çŠ¶è¯­ï¼Œé€šå¸¸åº”è¯¥æ”¾åœ¨å¥æœ«ï¼Œé‚£ä¹ˆthe activity of thinking about moral problemsä¾¿æ˜¯electedå’Œasä¸­é—´çš„å®¾è¯­defineæŒ‡â€ç»™ â€¦ ä¸‹å®šä¹‰â€ï¼ŒdefiniteæŒ‡â€æ˜ç¡®çš„â€ï¼ŒdefinitionæŒ‡â€å®šä¹‰â€ï¼›elect â€¦ as â€¦ æŒ‡â€é€‰æ‹©â€¦ä½œä¸ºâ€¦â€æˆ‘è¦æŠŠä»–å®šä¹‰æˆä¸€ä¸ªé€‰æ‹©ä»¥è‹æ ¼æ‹‰åº•çš„æ–¹å¼æ€è€ƒé“å¾·é—®é¢˜ä½œä¸ºå…¶ç”Ÿå‘½ä¸­ä¸»è¦èŒè´£å’Œä¹è¶£çš„äººã€‚Tylor defined culture as â€œ â€¦ that complex whole which includes belief, art, morals, lawcustom, and any other capabilities and habits acquired by man as a member of society.â€å¥å­çš„ä¸»å¹²ä¹Ÿå¾ˆæ¸…æ™°ï¼šTylor defined culture as â€œ â€¦ that complex wholeâ€ã€‚å…¶ä¸­whichå¼•å¯¼å®šè¯­ä»å¥ï¼Œacquired by man as a member of societyæ˜¯è¿‡å»åˆ†è¯çŸ­è¯­ä½œåç½®å®šè¯­ï¼Œä¿®é¥°å‰é¢çš„åè¯æœ¬å¥ä¸­çš„æ‰€æœ‰å•è¯éƒ½æ¯”è¾ƒåŸºç¡€ã€‚å¦‚æœä½ è¿˜æ˜¯è§‰å¾—è¿™äº›å•è¯å¾ˆéš¾ï¼Œé‚£å°±éœ€è¦åŠ å¿«èƒŒå•è¯çš„æ­¥ä¼ã€‚æ³°å‹’æŠŠæ–‡åŒ–å®šä¹‰æˆâ€â€¦ ä¸€ä¸ªå¤æ‚çš„æ•´ä½“ï¼Œå®ƒ(ä»£è¯æ›¿ä»£å…ˆè¡Œè¯ï¼Œå®šè¯­åç½®)åŒ…æ‹¬äº†ä½œä¸ºç¤¾ä¼šä¸€å‘˜çš„äººæ‰€è·å¾—çš„ä¿¡å¿µã€è‰ºæœ¯ã€é“å¾·ã€æ³•å¾‹ã€ä¼ ç»Ÿå’Œä»»ä½•å…¶ä»–çš„èƒ½åŠ›å’Œä¹ æƒ¯â€ã€‚aså¼•å¯¼å®šè¯­ä»å¥aså¯ä»¥å¼•å¯¼ä¿®é¥°æ•´ä¸ªå¥å­çš„å®šè¯­ä»å¥ï¼Œwhichä¹Ÿå¯ä»¥ï¼Œä½†whichåªèƒ½æ”¾åœ¨å¥æœ«ï¼Œasåˆ™å¯å‰å¯åAs is true of any developed society, in America a complex set of cultural signals, assumptions, and conventions underlies all social interrelationships .è¯¥å¥æ˜¯ä¸»è°“å®¾ç»“æ„ã€‚è°“è¯­æ˜¯underlies, acomplex set ofåè·Ÿäº†ä¸‰ä¸ªå¹¶åˆ—çš„æˆåˆ†ä¸€èµ·å……å½“ä¸»è¯­assumptionæŒ‡â€å‡å®šï¼Œè®¾æƒ³â€ï¼›interrelationshipæŒ‡â€ç›¸äº’å…³ç³»â€å°±å¦‚åŒåœ¨ä»»ä½•å‘è¾¾å›½å®¶ä¸€æ ·ï¼Œåœ¨ç¾å›½ï¼Œä¸€ç³»åˆ—å¤æ‚çš„æ–‡åŒ–ä¿¡å·ã€è®¾æƒ³å’Œä¼ ç»Ÿç»„æˆäº†æ‰€æœ‰ç¤¾ä¼šå…³ç³»çš„åŸºç¡€ã€‚aså¼•å¯¼çŠ¶è¯­ä»å¥asåº”è¯¥æ€ä¹ˆç¿»è¯‘ç”±å‰åå¥å­çš„æ„æ€å†³å®šShortlists for interviews, election ballon balliers, lists of confertion and attendees: all tend to be drawn up alphabetically, and their recipients lose interest as they ploughthrough them .è¯¥å¥æ˜¯ç”±å¥ä¸­ç¬¬äºŒä¸ªandè¿æ¥çš„å¹¶åˆ—å¥ï¼Œå†’å·å‰æ˜¯ä¸‰ä¸ªå¹¶åˆ—çš„åè¯çŸ­è¯­ï¼Œå†’å·åè¡¨ç¤ºæ€»ç»“ã€‚å¥ä¸­aså¼•å¯¼æ—¶é—´çŠ¶è¯­ä»å¥ã€‚shortlistæŒ‡â€æœ€ç»ˆå€™é€‰äººåå•â€ï¼›ballotpaperæŒ‡â€é€‰ç¥¨â€ï¼›listæŒ‡â€æ¸…å•â€ï¼›draw up æŒ‡â€èµ·è‰ï¼Œåˆ¶å®šâ€ï¼›alphabeticallyæŒ‡â€æŒ‰ç…§å­—æ¯é¡ºåºæ’åˆ—â€ï¼›recipientåŸæ„ä¸ºâ€æ¥å—è€…â€ï¼Œæ­¤å¤„ç¿»è¯‘æˆâ€çœ‹è¿™äº›åå•çš„äººâ€ï¼›ploughthroughæŒ‡â€è´¹åŠ›é˜…è¯»â€æ±‚èŒé¢è¯•åå•ã€æŠ•ç¥¨é€‰ä¸¾åå•ã€ä¼šè®®å‘è¨€äººåŠä¸ä¼šè€…åå•ï¼Œå¾€å¾€éƒ½æ˜¯æŒ‰ç…§å­—æ¯é¡ºåºæ’åˆ—çš„ï¼Œå½“äººä»¬è´¹åŠ²åœ°å¾€åç¿»çœ‹è¿™äº›åå•æ—¶ï¼Œå…´å‘³å°±ä¼šéšä¹‹ç´¢ç„¶ã€‚(asç¿»è¯‘æˆâ€å½“â€¦æ—¶â€)With other audiences you mustnâ€™t attempt to cut in with humor as they will resent an outsider making disparaging remarks about their canteen or their chairman.ä¸»å¥æ˜¯you mustnâ€™t attempt to cut in with humorã€‚å¥ä¸­aså¼•å¯¼åŸå› çŠ¶è¯­ä»å¥ï¼ŒresentæŒ‡â€åŒæ¶ï¼Œæ€¨æ¨â€ï¼›disparagingæŒ‡â€æ¯è°¤çš„ï¼Œè”‘è§†çš„â€å¯¹äºå…¶ä»–å¬ä¼—ï¼Œä½ åƒä¸‡ä¸è¦è¯•å›¾è´¸ç„¶å»ä½¿ç”¨è¿™ç§å¹½é»˜ï¼Œå› ä¸ºä»–ä»¬ä¼šåæ„Ÿä¸€ä¸ªå¤–äººå¯¹ä»–ä»¬çš„é¤å…æˆ–æ€»è£å‘è¡¨è”‘è§†æ€§çš„è¯„è®ºã€‚(asç¿»è¯‘æˆâ€å› ä¸ºâ€)New forms of thought as well as new subjects for thought must arise in the future as theyhave in the past, giving rise to new standards of elegance.å¥å­ä¸»å¹²æ˜¯ä¸»è°“ç»“æ„ï¼šNewforms of thought as well as new subjects for thoughtmust ariseã€‚ä¸»è¯­æ˜¯ç”±as well asè¿æ¥çš„ä¸¤ä¸ªåè¯çŸ­è¯­å…±åŒæ„æˆå¥ä¸­in the future, as they havein the past å’Œgiving rise to new standards of eleganceéƒ½æ˜¯çŠ¶è¯­ï¼Œå…¶ä¸­aså¼•å¯¼çš„æ˜¯æ–¹å¼çŠ¶è¯­ä»å¥ã€‚subjectä½œåè¯ï¼ŒæŒ‡â€å­¦ç§‘ï¼Œä¸»é¢˜ï¼Œä¸»è§‚â€ï¼Œä½œåŠ¨è¯æ„æˆæ­é…subject A to Bï¼ŒæŒ‡â€ä½¿Aæœä»äºBï¼Œä½¿Aé­å—Bâ€ï¼›give rise toæŒ‡â€äº§ç”Ÿï¼Œå¯¼è‡´â€ï¼›eleganceä½œåè¯ï¼ŒæŒ‡â€ä¼˜é›…â€å°±åƒè¿‡å»é‚£æ ·ï¼Œå°†æ¥æ–°çš„æ€ç»´æ–¹å¼å’Œæ–°çš„æ€ç»´ä¸»é¢˜ä¸€å®šä¼šå‡ºç°ï¼Œä»è€Œå‡ºç°å…³äºä¼˜é›…çš„æ–°çš„æ ‡å‡†ã€‚(asç¿»è¯‘æˆâ€åƒâ€¦ä¸€æ ·â€)</content>
	</entry>
	<entry>
		<title>JDBC_JDBCåŸºç¡€</title>
		<url>/article/d6fc26d1.html</url>
		<content>ã€é»‘é©¬ç¨‹åºå‘˜-Javaè¯­è¨€é«˜çº§éƒ¨åˆ†11ã€‘JDBCåŸºç¡€æ¦‚å¿µæ¦‚å¿µï¼šJava DataBase Connectivity  Java æ•°æ®åº“è¿æ¥ï¼Œ Javaè¯­è¨€æ“ä½œæ•°æ®åº“JDBCç¬”è®°JDBCæœ¬è´¨ï¼šå…¶å®æ˜¯å®˜æ–¹ï¼ˆsunå…¬å¸ï¼‰å®šä¹‰çš„ä¸€å¥—æ“ä½œæ‰€æœ‰å…³ç³»å‹æ•°æ®åº“çš„è§„åˆ™ï¼Œå³æ¥å£ã€‚å„ä¸ªæ•°æ®åº“å‚å•†å»å®ç°è¿™å¥—æ¥å£ï¼Œæä¾›æ•°æ®åº“é©±åŠ¨jaråŒ…ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™å¥—æ¥å£ï¼ˆJDBCï¼‰ç¼–ç¨‹ï¼ŒçœŸæ­£æ‰§è¡Œçš„ä»£ç æ˜¯é©±åŠ¨jaråŒ…ä¸­çš„å®ç°ç±»ã€‚å¿«é€Ÿå…¥é—¨æ­¥éª¤ï¼šå¯¼å…¥é©±åŠ¨jaråŒ… mysql-connector-java-5.1.37-bin.jarå¤åˆ¶mysql-connector-java-5.1.37-bin.jaråˆ°é¡¹ç›®çš„libsç›®å½•ä¸‹å³é”®â€”&gt;Add As Libraryæ³¨å†Œé©±åŠ¨è·å–æ•°æ®åº“è¿æ¥å¯¹è±¡ Connectionå®šä¹‰sqlè·å–æ‰§è¡Œsqlè¯­å¥çš„å¯¹è±¡ Statementæ‰§è¡Œsqlï¼Œæ¥å—è¿”å›ç»“æœå¤„ç†ç»“æœé‡Šæ”¾èµ„æºä»£ç å®ç°12345678910111213141516&gt;// 1. å¯¼å…¥é©±åŠ¨jaråŒ…&gt;// 2.æ³¨å†Œé©±åŠ¨&gt;Class.forName(&quot;com.mysql.jdbc.Driver&quot;);&gt;// 3.è·å–æ•°æ®åº“è¿æ¥å¯¹è±¡&gt;Connection conn = DriverManager.getConnection(&quot;jdbc:mysql://localhost:3306/db3&quot;, &quot;root&quot;, &quot;root&quot;);&gt;// 4.å®šä¹‰sqlè¯­å¥&gt;String sql = &quot;update account set balance = 500 where id = 1&quot;;&gt;// 5.è·å–æ‰§è¡Œsqlçš„å¯¹è±¡ Statement&gt;Statement stmt = conn.createStatement();&gt;// 6.æ‰§è¡Œsql&gt;int count = stmt.executeUpdate(sql);&gt;// 7.å¤„ç†ç»“æœ&gt;System.out.println(count);&gt;// 8.é‡Šæ”¾èµ„æº&gt;stmt.close();&gt;conn.close();å…³é”®å¯¹è±¡DriverManager(é©±åŠ¨ç®¡ç†å¯¹è±¡)åŠŸèƒ½ï¼š12345678910111213// 1. æ³¨å†Œé©±åŠ¨ï¼šå‘Šè¯‰ç¨‹åºè¯¥ä½¿ç”¨å“ªä¸€ä¸ªæ•°æ®åº“é©±åŠ¨jarstatic void registerDriver(Driver driver) :æ³¨å†Œä¸ç»™å®šçš„é©±åŠ¨ç¨‹åº DriverManager ã€‚ // å†™ä»£ç ä½¿ç”¨ï¼š  Class.forName(&quot;com.mysql.jdbc.Driver&quot;);// é€šè¿‡æŸ¥çœ‹æºç å‘ç°ï¼šåœ¨com.mysql.jdbc.Driverç±»ä¸­å­˜åœ¨é™æ€ä»£ç å—static {try {java.sql.DriverManager.registerDriver(new Driver());} catch (SQLException E) {throw new RuntimeException(&quot;Can't register driver!&quot;);}}// æ³¨æ„ï¼šmysql5ä¹‹åçš„é©±åŠ¨jaråŒ…å¯ä»¥çœç•¥æ³¨å†Œé©±åŠ¨çš„æ­¥éª¤ã€‚123// 2. è·å–æ•°æ®åº“è¿æ¥ï¼š// æ–¹æ³•ï¼šstatic Connection getConnection(String url, String user, String password) // ç»†èŠ‚ï¼šå¦‚æœè¿æ¥çš„æ˜¯æœ¬æœºmysqlæœåŠ¡å™¨ï¼Œå¹¶ä¸”mysqlæœåŠ¡é»˜è®¤ç«¯å£æ˜¯3306ï¼Œåˆ™urlå¯ä»¥ç®€å†™ä¸ºï¼šjdbc:mysql:///æ•°æ®åº“åç§°Connection(æ•°æ®åº“è¿æ¥å¯¹è±¡)è·å–æ‰§è¡Œsql çš„å¯¹è±¡ Statement createStatement() PreparedStatement prepareStatement(String sql)  ç®¡ç†äº‹åŠ¡   å¼€å¯äº‹åŠ¡ï¼šsetAutoCommit(boolean autoCommit) ï¼šè°ƒç”¨è¯¥æ–¹æ³•è®¾ç½®å‚æ•°ä¸ºfalseï¼Œå³å¼€å¯äº‹åŠ¡   æäº¤äº‹åŠ¡ï¼šcommit()    å›æ»šäº‹åŠ¡ï¼šrollback() Statement(æ‰§è¡Œsqlçš„å¯¹è±¡)boolean execute(String sql) ï¼šå¯ä»¥æ‰§è¡Œä»»æ„çš„sql äº†è§£ int executeUpdate(String sql) ï¼šæ‰§è¡ŒDMLï¼ˆinsertã€updateã€deleteï¼‰è¯­å¥ã€DDL(createï¼Œalterã€drop)è¯­å¥è¿”å›å€¼ï¼šå½±å“çš„è¡Œæ•°ï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªå½±å“çš„è¡Œæ•°åˆ¤æ–­DMLè¯­å¥æ˜¯å¦æ‰§è¡ŒæˆåŠŸ è¿”å›å€¼&gt;0çš„åˆ™æ‰§è¡ŒæˆåŠŸï¼Œåä¹‹ï¼Œåˆ™å¤±è´¥ã€‚ResultSet executeQuery(String sql): æ‰§è¡ŒDQL(select)è¯­å¥ç¤ºä¾‹:123456789101112131415161718192021222324252627282930313233343536373839404142&gt;Statement stmt = null;&gt;Connection conn = null;&gt;try {// 1. æ³¨å†Œé©±åŠ¨Class.forName(&quot;com.mysql.jdbc.Driver&quot;);// 2. å®šä¹‰sqlString sql = &quot;insert into account values(null,'ç‹äº”',3000)&quot;;// 3. è·å–Connectionå¯¹è±¡conn = DriverManager.getConnection(&quot;jdbc:mysql:///db3&quot;, &quot;root&quot;, &quot;root&quot;);// 4. è·å–æ‰§è¡Œsqlçš„å¯¹è±¡ Statementstmt = conn.createStatement();// 5. æ‰§è¡Œsqlint count = stmt.executeUpdate(sql);//å½±å“çš„è¡Œæ•°// 6. å¤„ç†ç»“æœSystem.out.println(count);if(count &gt; 0){System.out.println(&quot;æ·»åŠ æˆåŠŸï¼&quot;);}else{System.out.println(&quot;æ·»åŠ å¤±è´¥ï¼&quot;);}&gt;} catch (ClassNotFoundException e) {e.printStackTrace();&gt;} catch (SQLException e) {e.printStackTrace();&gt;}finally {// 7. é‡Šæ”¾èµ„æº// é¿å…ç©ºæŒ‡é’ˆå¼‚å¸¸if(stmt != null){       try {           stmt.close();} catch (SQLException e) {e.printStackTrace();}}if(conn != null){try {conn.close();} catch (SQLException e) {e.printStackTrace();}}&gt;}ResultSet(ç»“æœé›†å¯¹è±¡)boolean next(): æ¸¸æ ‡å‘ä¸‹ç§»åŠ¨ä¸€è¡Œï¼Œåˆ¤æ–­å½“å‰è¡Œæ˜¯å¦æ˜¯æœ€åä¸€è¡Œæœ«å°¾(æ˜¯å¦æœ‰æ•°æ®)ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å›falseï¼Œå¦‚æœä¸æ˜¯åˆ™è¿”å›truegetXxx(å‚æ•°): è·å–æ•°æ®Xxxï¼šä»£è¡¨æ•°æ®ç±»å‹   å¦‚ï¼š int getInt() ,    String getString()å‚æ•°ï¼šintï¼šä»£è¡¨åˆ—çš„ç¼–å·,ä»1å¼€å§‹   å¦‚ï¼š getString(1)Stringï¼šä»£è¡¨åˆ—åç§°ã€‚ å¦‚ï¼š getDouble(â€œbalanceâ€)123456789&gt;// å¾ªç¯åˆ¤æ–­æ¸¸æ ‡æ˜¯å¦æ˜¯æœ€åä¸€è¡Œæœ«å°¾ã€‚&gt;while(rs.next()){// è·å–æ•°æ®// 6.2 è·å–æ•°æ®int id = rs.getInt(1);String name = rs.getString(&quot;name&quot;);double balance = rs.getDouble(3);System.out.println(id + &quot;---&quot; + name + &quot;---&quot; + balance);&gt;}PreparedStatement(æ‰§è¡Œsqlçš„å¯¹è±¡)QLæ³¨å…¥é—®é¢˜ï¼šåœ¨æ‹¼æ¥sqlæ—¶ï¼Œæœ‰ä¸€äº›sqlçš„ç‰¹æ®Šå…³é”®å­—å‚ä¸å­—ç¬¦ä¸²çš„æ‹¼æ¥ã€‚ä¼šé€ æˆå®‰å…¨æ€§é—®é¢˜è¾“å…¥ç”¨æˆ·éšä¾¿ï¼Œè¾“å…¥å¯†ç ï¼šaâ€™ or â€˜aâ€™ = â€˜asqlï¼šselect * from user where username = â€˜fhdsjkfâ€™ and password = â€˜aâ€™ or â€˜aâ€™ = â€˜aâ€™ è§£å†³sqlæ³¨å…¥é—®é¢˜ï¼šä½¿ç”¨PreparedStatementå¯¹è±¡æ¥è§£å†³é¢„ç¼–è¯‘çš„SQLï¼šå‚æ•°ä½¿ç”¨?ä½œä¸ºå ä½ç¬¦é©±åŠ¨jaråŒ… mysql-connector-java-5.1.37-bin.jaræ³¨å†Œé©±åŠ¨è·å–æ•°æ®åº“è¿æ¥å¯¹è±¡ Connectionå®šä¹‰sql    sqlçš„å‚æ•°ä½¿ç”¨?ä½œä¸ºå ä½ç¬¦ã€‚ å¦‚ï¼šselect * from user where username=? and password = ?;è·å–æ‰§è¡Œsqlè¯­å¥çš„å¯¹è±¡ PreparedStatement  Connection.prepareStatement(String sql) ç»™ï¼Ÿèµ‹å€¼   setXxx(ä½ç½®ç¼–å·, å‚æ•°å€¼)æ‰§è¡Œsqlï¼Œæ¥å—è¿”å›ç»“æœï¼Œä¸éœ€è¦ä¼ é€’sqlè¯­å¥å¤„ç†ç»“æœé‡Šæ”¾èµ„æºä¼˜ç‚¹å¯ä»¥é˜²æ­¢SQLæ³¨å…¥æ•ˆç‡æ›´é«˜JDBCå·¥å…·ç±»ç›®çš„ï¼šç®€åŒ–ä¹¦å†™æŠ½å–ä¸€ä¸ªæ–¹æ³•è·å–è¿æ¥å¯¹è±¡éœ€æ±‚ï¼šä¸æƒ³ä¼ é€’å‚æ•°ï¼ˆéº»çƒ¦ï¼‰ï¼Œè¿˜å¾—ä¿è¯å·¥å…·ç±»çš„é€šç”¨æ€§è§£å†³ï¼šé…ç½®æ–‡ä»¶jdbc.properties1234url=jdbc:mysql:///db3user=rootpassword=rootdriver=com.mysql.jdbc.Driver123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106&gt;import java.io.FileReader;&gt;import java.io.IOException;&gt;import java.net.URL;&gt;import java.sql.*;&gt;import java.util.Properties;&gt;/*** JDBCå·¥å…·ç±»*/&gt;public class JDBCUtils {   private static String url;   private static String user;   private static String password;   private static String driver;   /**    * æ–‡ä»¶çš„è¯»å–ï¼Œåªéœ€è¦è¯»å–ä¸€æ¬¡å³å¯æ‹¿åˆ°è¿™äº›å€¼ã€‚ä½¿ç”¨é™æ€ä»£ç å—    */   static{       //è¯»å–èµ„æºæ–‡ä»¶ï¼Œè·å–å€¼       try {           //1. åˆ›å»ºPropertiesé›†åˆç±»ã€‚           Properties pro = new Properties();           //è·å–srcè·¯å¾„ä¸‹çš„æ–‡ä»¶çš„æ–¹å¼---&gt;ClassLoader ç±»åŠ è½½å™¨           ClassLoader classLoader = JDBCUtils.class.getClassLoader();           URL res  = classLoader.getResource(&quot;jdbc.properties&quot;);           String path = res.getPath();          //2. åŠ è½½æ–‡ä»¶           pro.load(new FileReader(path));           //3. è·å–æ•°æ®ï¼Œèµ‹å€¼           url = pro.getProperty(&quot;url&quot;);           user = pro.getProperty(&quot;user&quot;);           password = pro.getProperty(&quot;password&quot;);           driver = pro.getProperty(&quot;driver&quot;);           //4. æ³¨å†Œé©±åŠ¨           Class.forName(driver);       } catch (IOException e) {           e.printStackTrace();       } catch (ClassNotFoundException e) {           e.printStackTrace();       }   }   /**    * è·å–è¿æ¥    * @return è¿æ¥å¯¹è±¡    */   public static Connection getConnection() throws SQLException {       return DriverManager.getConnection(url, user, password);   }   /**    * é‡Šæ”¾èµ„æº    * @param stmt    * @param conn    */   public static void close(Statement stmt,Connection conn){       if( stmt != null){           try {               stmt.close();           } catch (SQLException e) {               e.printStackTrace();           }       }       if( conn != null){           try {               conn.close();           } catch (SQLException e) {               e.printStackTrace();           }       }   }   /**    * é‡Šæ”¾èµ„æº    * @param stmt    * @param conn    */   public static void close(ResultSet rs,Statement stmt, Connection conn){       if( rs != null){           try {               rs.close();           } catch (SQLException e) {               e.printStackTrace();           }       }       if( stmt != null){           try {               stmt.close();           } catch (SQLException e) {               e.printStackTrace();           }       }       if( conn != null){           try {               conn.close();           } catch (SQLException e) {               e.printStackTrace();           }       }   }&gt;}ä¿®æ”¹è®°å½•1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859package cn.itcast.jdbc;import java.sql.Connection;import java.sql.DriverManager;import java.sql.SQLException;import java.sql.Statement;/** * accountè¡¨ ä¿®æ”¹è®°å½• */public class JDBCDemo3 {    public static void main(String[] args) {        Connection conn = null;        Statement stmt = null;        try {            //1. æ³¨å†Œé©±åŠ¨            Class.forName(&quot;com.mysql.jdbc.Driver&quot;);            //2.è·å–è¿æ¥å¯¹è±¡            conn = DriverManager.getConnection(&quot;jdbc:mysql:///db3&quot;, &quot;root&quot;, &quot;root&quot;);            //3.å®šä¹‰sql            String sql  = &quot;update account set balance = 1500 where id = 3&quot;;            //4.è·å–æ‰§è¡Œsqlå¯¹è±¡            stmt = conn.createStatement();            //5.æ‰§è¡Œsql            int count = stmt.executeUpdate(sql);            //6.å¤„ç†ç»“æœ            System.out.println(count);            if(count &gt; 0){                System.out.println(&quot;ä¿®æ”¹æˆåŠŸï¼&quot;);            }else{                System.out.println(&quot;ä¿®æ”¹å¤±è´¥&quot;);            }        } catch (ClassNotFoundException e) {            e.printStackTrace();        } catch (SQLException e) {            e.printStackTrace();        } finally {            //7.é‡Šæ”¾èµ„æº            if(stmt != null){                try {                    stmt.close();                } catch (SQLException e) {                    e.printStackTrace();                }            }            if(conn != null){                try {                    conn.close();                } catch (SQLException e) {                    e.printStackTrace();                }            }        }    }}æ·»åŠ è®°å½•123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960package cn.itcast.jdbc;import java.sql.Connection;import java.sql.DriverManager;import java.sql.SQLException;import java.sql.Statement;/** * accountè¡¨ æ·»åŠ ä¸€æ¡è®°å½• insert è¯­å¥ */public class JDBCDemo2 {    public static void main(String[] args) {        Statement stmt = null;        Connection conn = null;        try {            //1. æ³¨å†Œé©±åŠ¨            Class.forName(&quot;com.mysql.jdbc.Driver&quot;);            //2. å®šä¹‰sql            String sql = &quot;insert into account values(null,'ç‹äº”',3000)&quot;;            //3.è·å–Connectionå¯¹è±¡            conn = DriverManager.getConnection(&quot;jdbc:mysql:///db3&quot;, &quot;root&quot;, &quot;root&quot;);            //4.è·å–æ‰§è¡Œsqlçš„å¯¹è±¡ Statement            stmt = conn.createStatement();            //5.æ‰§è¡Œsql            int count = stmt.executeUpdate(sql);//å½±å“çš„è¡Œæ•°            //6.å¤„ç†ç»“æœ            System.out.println(count);            if(count &gt; 0){                System.out.println(&quot;æ·»åŠ æˆåŠŸï¼&quot;);            }else{                System.out.println(&quot;æ·»åŠ å¤±è´¥ï¼&quot;);            }        } catch (ClassNotFoundException e) {            e.printStackTrace();        } catch (SQLException e) {            e.printStackTrace();        }finally {            //stmt.close();            //7. é‡Šæ”¾èµ„æº            //é¿å…ç©ºæŒ‡é’ˆå¼‚å¸¸            if(stmt != null){                try {                    stmt.close();                } catch (SQLException e) {                    e.printStackTrace();                }            }            if(conn != null){                try {                    conn.close();                } catch (SQLException e) {                    e.printStackTrace();                }            }        }    }}åˆ é™¤è®°å½•123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263package cn.itcast.jdbc;import cn.itcast.util.JDBCUtils;import java.sql.Connection;import java.sql.DriverManager;import java.sql.SQLException;import java.sql.Statement;/** * accountè¡¨ åˆ é™¤ä¸€æ¡è®°å½• */public class JDBCDemo4 {    public static void main(String[] args) {        Connection conn = null;        Statement stmt = null;        try {            //1. æ³¨å†Œé©±åŠ¨            Class.forName(&quot;com.mysql.jdbc.Driver&quot;);            //2.è·å–è¿æ¥å¯¹è±¡            conn = DriverManager.getConnection(&quot;jdbc:mysql:///db3&quot;, &quot;root&quot;, &quot;root&quot;);           //conn = JDBCUtils.getConnection(&quot;jdbc:mysql:///db3&quot;, &quot;root&quot;, &quot;root&quot;);            //3.å®šä¹‰sql            String sql  = &quot;delete from account where id = 3&quot;;            //4.è·å–æ‰§è¡Œsqlå¯¹è±¡            stmt = conn.createStatement();            //5.æ‰§è¡Œsql            int count = stmt.executeUpdate(sql);            //6.å¤„ç†ç»“æœ            System.out.println(count);            if(count &gt; 0){                System.out.println(&quot;åˆ é™¤æˆåŠŸï¼&quot;);            }else{                System.out.println(&quot;åˆ é™¤å¤±è´¥&quot;);            }        } catch (ClassNotFoundException e) {            e.printStackTrace();        } catch (SQLException e) {            e.printStackTrace();        } finally {            //7.é‡Šæ”¾èµ„æº            if(stmt != null){                try {                    stmt.close();                } catch (SQLException e) {                    e.printStackTrace();                }            }            if(conn != null){                try {                    conn.close();                } catch (SQLException e) {                    e.printStackTrace();                }            }        }    }}æ‰§è¡ŒDDLè¯­å¥1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465package cn.itcast.jdbc;import java.sql.*;/** * æ‰§è¡ŒDDLè¯­å¥ */public class JDBCDemo7 {    public static void main(String[] args) {        Connection conn = null;        Statement stmt = null;        ResultSet rs = null;        try {            //1. æ³¨å†Œé©±åŠ¨            Class.forName(&quot;com.mysql.jdbc.Driver&quot;);            //2.è·å–è¿æ¥å¯¹è±¡            conn = DriverManager.getConnection(&quot;jdbc:mysql:///db3&quot;, &quot;root&quot;, &quot;root&quot;);            //3.å®šä¹‰sql            String sql  = &quot;select * from account&quot;;            //4.è·å–æ‰§è¡Œsqlå¯¹è±¡            stmt = conn.createStatement();            //5.æ‰§è¡Œsql            rs = stmt.executeQuery(sql);            //6.å¤„ç†ç»“æœ            //å¾ªç¯åˆ¤æ–­æ¸¸æ ‡æ˜¯å¦æ˜¯æœ€åä¸€è¡Œæœ«å°¾ã€‚            while(rs.next()){                //è·å–æ•°æ®                //6.2 è·å–æ•°æ®                int id = rs.getInt(1);                String name = rs.getString(&quot;name&quot;);                double balance = rs.getDouble(3);                System.out.println(id + &quot;---&quot; + name + &quot;---&quot; + balance);            }        } catch (ClassNotFoundException e) {            e.printStackTrace();        } catch (SQLException e) {            e.printStackTrace();        } finally {            //7.é‡Šæ”¾èµ„æº            if(rs != null){                try {                    rs.close();                } catch (SQLException e) {                    e.printStackTrace();                }            }            if(stmt != null){                try {                    stmt.close();                } catch (SQLException e) {                    e.printStackTrace();                }            }            if(conn != null){                try {                    conn.close();                } catch (SQLException e) {                    e.printStackTrace();                }            }        }    }}æŸ¥è¯¢å¹¶å°è£…123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147import cn.itcast.domain.Emp;import cn.itcast.util.JDBCUtils;import java.sql.*;import java.util.ArrayList;import java.util.List;/** * * å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼ŒæŸ¥è¯¢empè¡¨çš„æ•°æ®å°†å…¶å°è£…ä¸ºå¯¹è±¡ï¼Œç„¶åè£…è½½é›†åˆï¼Œè¿”å›ã€‚ */public class JDBCDemo8 {    public static void main(String[] args) {        List&lt;Emp&gt; list = new JDBCDemo8().findAll2();        System.out.println(list);        System.out.println(list.size());    }    /**     * æŸ¥è¯¢æ‰€æœ‰empå¯¹è±¡     * @return     */    public List&lt;Emp&gt; findAll(){        Connection conn = null;        Statement stmt = null;        ResultSet rs = null;        List&lt;Emp&gt; list = null;        try {            //1.æ³¨å†Œé©±åŠ¨            Class.forName(&quot;com.mysql.jdbc.Driver&quot;);            //2.è·å–è¿æ¥            conn = DriverManager.getConnection(&quot;jdbc:mysql:///db3&quot;, &quot;root&quot;, &quot;root&quot;);            //3.å®šä¹‰sql            String sql = &quot;select * from emp&quot;;            //4.è·å–æ‰§è¡Œsqlçš„å¯¹è±¡            stmt = conn.createStatement();            //5.æ‰§è¡Œsql            rs = stmt.executeQuery(sql);            //6.éå†ç»“æœé›†ï¼Œå°è£…å¯¹è±¡ï¼Œè£…è½½é›†åˆ            Emp emp = null;            list = new ArrayList&lt;Emp&gt;();            while(rs.next()){                //è·å–æ•°æ®                int id = rs.getInt(&quot;id&quot;);                String ename = rs.getString(&quot;ename&quot;);                int job_id = rs.getInt(&quot;job_id&quot;);                int mgr = rs.getInt(&quot;mgr&quot;);                Date joindate = rs.getDate(&quot;joindate&quot;);                double salary = rs.getDouble(&quot;salary&quot;);                double bonus = rs.getDouble(&quot;bonus&quot;);                int dept_id = rs.getInt(&quot;dept_id&quot;);                // åˆ›å»ºempå¯¹è±¡,å¹¶èµ‹å€¼                emp = new Emp();                emp.setId(id);                emp.setEname(ename);                emp.setJob_id(job_id);                emp.setMgr(mgr);                emp.setJoindate(joindate);                emp.setSalary(salary);                emp.setBonus(bonus);                emp.setDept_id(dept_id);                //è£…è½½é›†åˆ                list.add(emp);            }        } catch (ClassNotFoundException e) {            e.printStackTrace();        } catch (SQLException e) {            e.printStackTrace();        }finally {            if(rs != null){                try {                    rs.close();                } catch (SQLException e) {                    e.printStackTrace();                }            }            if(stmt != null){                try {                    stmt.close();                } catch (SQLException e) {                    e.printStackTrace();                }            }            if(conn != null){                try {                    conn.close();                } catch (SQLException e) {                    e.printStackTrace();                }            }        }        return list;    }    /**     * æ¼”ç¤ºJDBCå·¥å…·ç±»     * @return     */    public List&lt;Emp&gt; findAll2(){        Connection conn = null;        Statement stmt = null;        ResultSet rs = null;        List&lt;Emp&gt; list = null;        try {           /* //1.æ³¨å†Œé©±åŠ¨            Class.forName(&quot;com.mysql.jdbc.Driver&quot;);            //2.è·å–è¿æ¥            conn = DriverManager.getConnection(&quot;jdbc:mysql:///db3&quot;, &quot;root&quot;, &quot;root&quot;);*/            conn = JDBCUtils.getConnection();            //3.å®šä¹‰sql            String sql = &quot;select * from emp&quot;;            //4.è·å–æ‰§è¡Œsqlçš„å¯¹è±¡            stmt = conn.createStatement();            //5.æ‰§è¡Œsql            rs = stmt.executeQuery(sql);            //6.éå†ç»“æœé›†ï¼Œå°è£…å¯¹è±¡ï¼Œè£…è½½é›†åˆ            Emp emp = null;            list = new ArrayList&lt;Emp&gt;();            while(rs.next()){                //è·å–æ•°æ®                int id = rs.getInt(&quot;id&quot;);                String ename = rs.getString(&quot;ename&quot;);                int job_id = rs.getInt(&quot;job_id&quot;);                int mgr = rs.getInt(&quot;mgr&quot;);                Date joindate = rs.getDate(&quot;joindate&quot;);                double salary = rs.getDouble(&quot;salary&quot;);                double bonus = rs.getDouble(&quot;bonus&quot;);                int dept_id = rs.getInt(&quot;dept_id&quot;);                // åˆ›å»ºempå¯¹è±¡,å¹¶èµ‹å€¼                emp = new Emp();                emp.setId(id);                emp.setEname(ename);                emp.setJob_id(job_id);                emp.setMgr(mgr);                emp.setJoindate(joindate);                emp.setSalary(salary);                emp.setBonus(bonus);                emp.setDept_id(dept_id);                //è£…è½½é›†åˆ                list.add(emp);            }        } catch (SQLException e) {            e.printStackTrace();        }finally {            JDBCUtils.close(rs,stmt,conn);        }        return list;    }}JDBCæ§åˆ¶äº‹åŠ¡äº‹åŠ¡ï¼šä¸€ä¸ªåŒ…å«å¤šä¸ªæ­¥éª¤çš„ä¸šåŠ¡æ“ä½œã€‚å¦‚æœè¿™ä¸ªä¸šåŠ¡æ“ä½œè¢«äº‹åŠ¡ç®¡ç†ï¼Œåˆ™è¿™å¤šä¸ªæ­¥éª¤åŒæ—¶æˆåŠŸæˆ–åŒæ—¶å¤±è´¥ã€‚æ“ä½œï¼šå¼€å¯äº‹åŠ¡æäº¤äº‹åŠ¡å›æ»šäº‹åŠ¡ä½¿ç”¨Connectionå¯¹è±¡æ¥ç®¡ç†äº‹åŠ¡å¼€å¯äº‹åŠ¡ï¼šsetAutoCommit(boolean autoCommit) ï¼šè°ƒç”¨è¯¥æ–¹æ³•è®¾ç½®å‚æ•°ä¸ºfalseï¼Œå³å¼€å¯äº‹åŠ¡åœ¨æ‰§è¡Œsqlä¹‹å‰å¼€å¯äº‹åŠ¡æäº¤äº‹åŠ¡ï¼šcommit() ï¼Œå½“æ‰€æœ‰sqléƒ½æ‰§è¡Œå®Œæäº¤äº‹åŠ¡å›æ»šäº‹åŠ¡ï¼šrollback() ï¼Œåœ¨catchä¸­å›æ»šäº‹åŠ¡123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657&gt;import cn.itcast.util.JDBCUtils;&gt;import java.sql.Connection;&gt;import java.sql.PreparedStatement;&gt;import java.sql.SQLException;&gt;/*** äº‹åŠ¡æ“ä½œ*/&gt;public class JDBCDemo10 {   public static void main(String[] args) {       Connection conn = null;       PreparedStatement pstmt1 = null;       PreparedStatement pstmt2 = null;       try {           //1.è·å–è¿æ¥           conn = JDBCUtils.getConnection();           //å¼€å¯äº‹åŠ¡           conn.setAutoCommit(false);           //2.å®šä¹‰sql           //2.1 å¼ ä¸‰ - 500           String sql1 = &quot;update account set balance = balance - ? where id = ?&quot;;           //2.2 æå›› + 500           String sql2 = &quot;update account set balance = balance + ? where id = ?&quot;;           //3.è·å–æ‰§è¡Œsqlå¯¹è±¡           pstmt1 = conn.prepareStatement(sql1);           pstmt2 = conn.prepareStatement(sql2);           //4. è®¾ç½®å‚æ•°           pstmt1.setDouble(1,500);           pstmt1.setInt(2,1);           pstmt2.setDouble(1,500);           pstmt2.setInt(2,2);           //5.æ‰§è¡Œsql           pstmt1.executeUpdate();           // æ‰‹åŠ¨åˆ¶é€ å¼‚å¸¸           int i = 3/0;           pstmt2.executeUpdate();           //æäº¤äº‹åŠ¡           conn.commit();       } catch (Exception e) {           //äº‹åŠ¡å›æ»š           try {               if(conn != null) {                   conn.rollback();               }           } catch (SQLException e1) {               e1.printStackTrace();           }           e.printStackTrace();       }finally {           JDBCUtils.close(pstmt1,conn);           JDBCUtils.close(pstmt2,null);       }   }&gt;}</content>
	</entry>
	<entry>
		<title>Javaè¿›é˜¶_åå°„</title>
		<url>/article/b885131b.html</url>
		<content>ã€é»‘é©¬ç¨‹åºå‘˜-Javaè¯­è¨€é«˜çº§éƒ¨åˆ†9.2ã€‘Java åå°„åå°„æœºåˆ¶ç¬”è®°ã€ç‹‚ç¥è¯´Javaã€‘æ³¨è§£å’Œåå°„JAVAæ³¨è§£ä¸åå°„å’Œç±»çš„åŠ è½½æœºåˆ¶ç¬¬åå…­ä¸ªä¸“é¢˜åå°„æ¦‚å¿µåŸºæœ¬æ¦‚å¿µæ¡†æ¶ï¼šåŠæˆå“è½¯ä»¶ï¼Œå¯ä»¥åœ¨æ¡†æ¶çš„åŸºç¡€ä¸Šè¿›è¡Œè½¯ä»¶å¼€å‘ï¼Œç®€åŒ–ç¼–ç ã€‚å­¦ä¹ æ¡†æ¶å¹¶ä¸éœ€è¦äº†è§£åå°„ï¼Œä½†æ˜¯è¦æ˜¯æƒ³è‡ªå·±å†™ä¸€ä¸ªæ¡†æ¶ï¼Œé‚£ä¹ˆå°±è¦å¯¹åå°„æœºåˆ¶æœ‰å¾ˆæ·±å…¥çš„äº†è§£ã€‚åå°„æœºåˆ¶ï¼šå°†ç±»çš„å„ä¸ªç»„æˆéƒ¨åˆ†å°è£…ä¸ºå…¶ä»–å¯¹è±¡ï¼Œè¿™å°±æ˜¯åå°„æœºåˆ¶ã€‚åå°„çš„å¥½å¤„ï¼šå¯ä»¥åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œæ“ä½œè¿™äº›å¯¹è±¡ã€‚å¯ä»¥è§£è€¦ï¼Œæé«˜ç¨‹åºçš„å¯æ‰©å±•æ€§ã€‚å‡è®¾æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯newè¿™ç§å½¢å¼è¿›è¡Œå¯¹è±¡çš„å®ä¾‹åŒ–ã€‚æ­¤æ—¶å¦‚æœåœ¨é¡¹ç›®çš„æŸä¸€ä¸ªå°æ¨¡å—ä¸­æˆ‘ä»¬çš„ä¸€ä¸ªå®ä¾‹ç±»ä¸¢å¤±äº†ï¼Œé‚£ä¹ˆåœ¨ç¼–è¯‘æœŸé—´å°±ä¼šæŠ¥é”™ï¼Œä»¥å¯¼è‡´æ•´ä¸ªé¡¹ç›®æ— æ³•å¯åŠ¨ã€‚å¯¹äºåå°„åˆ›å»ºå¯¹è±¡Class.forName(â€œå…¨ç±»åâ€);è¿™ç§å½¢å¼ï¼Œæˆ‘ä»¬åœ¨ç¼–è¯‘æœŸéœ€è¦çš„ä»…ä»…åªæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ˆå…¨ç±»åï¼‰ï¼Œåœ¨ç¼–è¯‘æœŸä¸ä¼šæŠ¥é”™ï¼Œè¿™æ ·å…¶ä»–çš„æ¨¡å—å°±å¯ä»¥æ­£å¸¸çš„è¿è¡Œï¼Œè€Œä¸ä¼šå› ä¸ºä¸€ä¸ªæ¨¡å—çš„é—®é¢˜å¯¼è‡´æ•´ä¸ªé¡¹ç›®å´©æºƒã€‚è¿™å°±æ˜¯Springæ¡†æ¶ä¸­IOCæ§åˆ¶åè½¬çš„æœ¬è´¨ã€‚Reflection(åå°„)æ˜¯Javaè¢«è§†ä¸ºåŠ¨æ€è¯­è¨€çš„å…³é”®ï¼Œåå°„æœºåˆ¶å…è®¸ç¨‹åºåœ¨æ‰§è¡ŒæœŸå€ŸåŠ©äºReflection APIå–å¾—ä»»ä½•ç±»çš„å†…éƒ¨ä¿¡æ¯ï¼Œå¹¶èƒ½ç›´æ¥æ“ä½œä»»æ„å¯¹è±¡çš„å†…éƒ¨å±æ€§åŠæ–¹æ³•ã€‚åŠ è½½å®Œç±»ä¹‹åï¼Œåœ¨å †å†…å­˜çš„æ–¹æ³•åŒºä¸­å°±äº§ç”Ÿäº†ä¸€ä¸ªClassç±»å‹çš„å¯¹è±¡ï¼ˆä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªClasså¯¹è±¡ï¼‰ï¼Œè¿™ä¸ªå¯¹è±¡å°±åŒ…å«äº†å®Œæ•´çš„ç±»çš„ç»“æ„ä¿¡æ¯ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªå¯¹è±¡çœ‹åˆ°ç±»çš„ç»“æ„ã€‚è¿™ä¸ªå¯¹è±¡å°±åƒä¸€é¢é•œå­ï¼Œé€è¿‡è¿™ä¸ªé•œå­çœ‹åˆ°ç±»çš„ç»“æ„ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å½¢è±¡çš„ç§°ä¹‹ä¸ºï¼šåå°„ä»£ç çš„ä¸‰ä¸ªé˜¶æ®µSourceæºä»£ç é˜¶æ®µï¼š*.javaè¢«ç¼–è¯‘æˆ*.classå­—èŠ‚ç æ–‡ä»¶ã€‚Classç±»å¯¹è±¡é˜¶æ®µï¼š*.classå­—èŠ‚ç æ–‡ä»¶è¢«ç±»åŠ è½½å™¨åŠ è½½è¿›å†…å­˜ï¼Œå¹¶å°†å…¶å°è£…æˆClasså¯¹è±¡ï¼ˆç”¨äºåœ¨å†…å­˜ä¸­æè¿°å­—èŠ‚ç æ–‡ä»¶ï¼‰ï¼ŒClasså¯¹è±¡å°†åŸå­—èŠ‚ç æ–‡ä»¶ä¸­çš„æˆå‘˜å˜é‡æŠ½å–å‡ºæ¥å°è£…æˆæ•°ç»„Field[]ï¼Œå°†åŸå­—èŠ‚ç æ–‡ä»¶ä¸­çš„æ„é€ å‡½æ•°æŠ½å–å‡ºæ¥å°è£…æˆæ•°ç»„Construction[]ï¼Œåœ¨å°†æˆå‘˜æ–¹æ³•å°è£…æˆMethod[]ã€‚RunTimeè¿è¡Œæ—¶é˜¶æ®µï¼šåˆ›å»ºå¯¹è±¡çš„è¿‡ç¨‹newã€‚Javaå†…å­˜å †: å­˜æ”¾newçš„å¯¹è±¡å’Œæ•°ç»„ï¼Œè¢«æ‰€æœ‰çš„çº¿ç¨‹å…±äº«ï¼Œä¸ä¼šå­˜æ”¾åˆ«çš„å¯¹è±¡å¼•ç”¨æ ˆ: å­˜æ”¾åŸºæœ¬å˜é‡ç±»å‹(ä¼šåŒ…å«è¿™ä¸ªåŸºæœ¬ç±»å‹çš„å…·ä½“æ•°å€¼)ï¼Œå¼•ç”¨å¯¹è±¡çš„å˜é‡(ä¼šå­˜æ”¾è¿™ä¸ªå¼•ç”¨åœ¨å †é‡Œé¢çš„å…·ä½“åœ°å€)æ–¹æ³•åŒº: å¯ä»¥è¢«æ‰€æœ‰çš„çº¿ç¨‹å…±äº«ï¼ŒåŒ…å«äº†æ‰€æœ‰çš„classå’Œstaticå˜é‡ç±»åŠ è½½è¿‡ç¨‹å½“ç¨‹åºä¸»åŠ¨ä½¿ç”¨æŸä¸ªç±»æ—¶ï¼Œå¦‚æœè¯¥ç±»è¿˜æœªè¢«åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œåˆ™ç³»ç»Ÿä¼šé€šè¿‡å¦‚ä¸‹ä¸‰ä¸ªæ­¥éª¤æ¥å¯¹è¯¥ç±»è¿›è¡Œåˆå§‹åŒ–ã€‚ç±»åŠ è½½ä¸ClassLoader åŠ è½½ï¼šå°†classæ–‡ä»¶å­—èŠ‚ç å†…å®¹åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå¹¶å°†è¿™äº›é™æ€æ•°æ®è½¬æ¢æˆæ–¹æ³•åŒºçš„è¿è¡Œæ—¶æ•°æ®ç»“æ„ï¼Œç„¶åç”Ÿæˆä¸€ä¸ªä»£è¡¨è¿™ä¸ªç±»çš„java.lang.Classå¯¹è±¡ã€‚ é“¾æ¥ï¼šå°†Javaç±»çš„äºŒè¿›åˆ¶ä»£ç åˆå¹¶åˆ°JVMçš„è¿è¡ŒçŠ¶æ€ä¹‹ä¸­çš„è¿‡ç¨‹ã€‚éªŒè¯ï¼šç¡®ä¿åŠ è½½çš„ç±»ä¿¡æ¯ç¬¦åˆJVMè§„èŒƒï¼Œæ²¡æœ‰å®‰å…¨æ–¹é¢çš„é—®é¢˜å‡†å¤‡ï¼šæ­£å¼ä¸ºç±»å˜é‡ï¼ˆstaticï¼‰åˆ†é…å†…å­˜å¹¶è®¾ç½®ç±»å˜é‡é»˜è®¤åˆå§‹å€¼çš„é˜¶æ®µï¼Œè¿™äº›å†…å­˜éƒ½å°†åœ¨æ–¹æ³•åŒºä¸­è¿›è¡Œåˆ†é…ã€‚è§£æï¼šè™šæ‹Ÿæœºå¸¸é‡æ± å†…çš„ç¬¦å·å¼•ç”¨ï¼ˆå¸¸é‡åï¼‰æ›¿æ¢ä¸ºç›´æ¥å¼•ç”¨ï¼ˆåœ°å€ï¼‰çš„è¿‡ç¨‹ã€‚åˆå§‹åŒ–ï¼šæ‰§è¡Œç±»æ„é€ å™¨()æ–¹æ³•çš„è¿‡ç¨‹ã€‚ç±»æ„é€ å™¨()æ–¹æ³•æ˜¯ç”±ç¼–è¯‘æœŸè‡ªåŠ¨æ”¶é›†ç±»ä¸­æ‰€æœ‰ç±»å˜é‡çš„èµ‹å€¼åŠ¨ä½œå’Œé™æ€ä»£ç å—ä¸­çš„è¯­å¥åˆå¹¶äº§ç”Ÿçš„ã€‚ç±»æ„é€ å™¨æ˜¯æ„é€ ç±»ä¿¡æ¯çš„ï¼Œä¸æ˜¯æ„é€ è¯¥ç±»å¯¹è±¡çš„æ„é€ å™¨ã€‚å½“åˆå§‹åŒ–ä¸€ä¸ªç±»çš„æ—¶å€™ï¼Œå¦‚æœå‘ç°å…¶çˆ¶ç±»è¿˜æ²¡æœ‰è¿›è¡Œåˆå§‹åŒ–ï¼Œåˆ™éœ€è¦å…ˆè§¦å‘å…¶çˆ¶ç±»çš„åˆå§‹åŒ–ã€‚è™šæ‹Ÿæœºä¼šä¿è¯ä¸€ä¸ªç±»çš„()æ–¹æ³•åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­è¢«æ­£ç¡®åŠ é”å’ŒåŒæ­¥ã€‚ç±»åˆå§‹åŒ–æ—¶æœºç±»ä¸»åŠ¨å¼•ç”¨ï¼ˆä¸€å®šä¼šå‘ç”Ÿç±»çš„åˆå§‹åŒ–ï¼‰å½“è™šæ‹Ÿæœºå¯åŠ¨ï¼Œå…ˆåˆå§‹åŒ–mainæ–¹æ³•æ‰€åœ¨çš„ç±»newä¸€ä¸ªç±»çš„å¯¹è±¡è°ƒç”¨ç±»çš„é™æ€æˆå‘˜ï¼ˆé™¤äº†finalå¸¸é‡ï¼‰å’Œé™æ€æ–¹æ³•ä½¿ç”¨java.lang.reflectåŒ…çš„æ–¹æ³•å¯¹ç±»è¿›è¡Œåå°„è°ƒç”¨å½“åˆå§‹åŒ–ä¸€ä¸ªç±»ï¼Œå¦‚æœå…¶çˆ¶ç±»æ²¡æœ‰è¢«åˆå§‹åŒ–ï¼Œåˆ™å…ˆä¼šåˆå§‹åŒ–å®ƒçš„çˆ¶ç±»ç±»è¢«åŠ¨å¼•ç”¨ï¼ˆä¸ä¼šå‘ç”Ÿç±»çš„åˆå§‹åŒ–ï¼‰å½“è®¿é—®ä¸€ä¸ªé™æ€åŸŸæ—¶ï¼Œåªæœ‰çœŸæ­£å£°æ˜è¿™ä¸ªåŸŸçš„ç±»æ‰ä¼šè¢«åˆå§‹åŒ–ã€‚å¦‚ï¼šå½“é€šè¿‡å­ç±»å¼•ç”¨çˆ¶ç±»çš„é™æ€å˜é‡ï¼Œä¸ä¼šå¯¼è‡´å­ç±»åˆå§‹åŒ–é€šè¿‡æ•°ç»„å®šä¹‰ç±»å¼•ç”¨ï¼Œä¸ä¼šè§¦å‘æ­¤ç±»çš„åˆå§‹åŒ–å¼•ç”¨å¸¸é‡ä¸ä¼šè§¦å‘æ­¤ç±»çš„åˆå§‹åŒ–ï¼ˆå¸¸é‡åœ¨é“¾æ¥é˜¶æ®µå°±å­˜å…¥è°ƒç”¨ç±»çš„å¸¸é‡æ± ä¸­äº†ï¼‰ç±»åŠ è½½å™¨çš„ä½œç”¨ ç±»åŠ è½½çš„ä½œç”¨ï¼šå°†classæ–‡ä»¶å­—èŠ‚ç å†…å®¹åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå¹¶å°†è¿™äº›é™æ€æ•°æ®è½¬æ¢æˆæ–¹æ³•åŒºçš„è¿è¡Œæ—¶   æ•°æ®ç»“æ„ï¼Œç„¶ååœ¨å †ä¸­ç”Ÿæˆä¸€ä¸ªä»£è¡¨è¿™ä¸ªç±»çš„java.lang.Classå¯¹è±¡ï¼Œä½œä¸ºæ–¹æ³•åŒºä¸­ç±»æ•°æ®çš„è®¿é—®å…¥å£ã€‚ ç±»ç¼“å­˜ï¼šæ ‡å‡†çš„JavaSEç±»åŠ è½½å™¨å¯ä»¥æŒ‰è¦æ±‚æŸ¥æ‰¾ç±»ï¼Œä½†ä¸€æ—¦æŸä¸ªç±»è¢«åŠ è½½åˆ°ç±»åŠ è½½å™¨ä¸­ï¼Œå®ƒå°†ç»´æŒåŠ è½½(ç¼“å­˜)ä¸€æ®µæ—¶é—´ã€‚ä¸è¿‡JVMåƒåœ¾å›æ”¶æœºåˆ¶å¯ä»¥å›æ”¶è¿™äº›Classå¯¹è±¡&gt; ç±»åŠ è½½å™¨ä½œç”¨æ˜¯ç”¨æ¥æŠŠç±»(class)è£…è½½è¿›å†…å­˜çš„ã€‚   JVMè§„èŒƒå®šä¹‰äº†å¦‚ä¸‹ç±»å‹çš„ç±»çš„åŠ è½½å™¨ã€‚&gt; 1234567891011121314151617public static void main(string[] args){// è·å–ç³»ç»Ÿç±»çš„åŠ è½½å™¨     ClassLoader systemClassloader = ClassLoader.getsystemclassloade();     System.out.println(systemclassLoader);     // è·å–ç³»ç»Ÿç±»åŠ è½½å™¨çš„çˆ¶ç±»åŠ è½½å™¨-ä¸€&gt;æ‰©å±•ç±»åŠ è½½å™¨     ClassLoader parent = systemclassLoader.getParent();     System.out.println(parent);     // è·å–æ‰©å±•ç±»åŠ è½½å™¨çš„çˆ¶ç±»åŠ è½½å™¨--&gt;æ ¹åŠ è½½å™¨ï¼ˆC/c++ï¼‰     ClassLoader parent1=parent.getParent();    System.out.println(parent1);// æµ‹è¯•å½“å‰ç±»æ˜¯å“ªä¸ªåŠ è½½å™¨åŠ è½½çš„     ClassLoader classLoader = Class.forName(&quot;com.reflection.Test&quot;).getClassLoader();     System.out.println(classLoader);     // æµ‹è¯•JDKå†…ç½®çš„ç±»æ˜¯è°åŠ è½½çš„    classLoader = Class.forName(&quot;java.lang.object&quot;).getclassLoader();     system.out.println(classloader);}&gt;è‡ªå®šä¹‰ç½‘ç»œç±»åŠ è½½1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859&gt;import java.io.ByteArrayOutputStream;&gt;import java.io.File;&gt;import java.io.FileInputStream;&gt;import java.io.IOException;&gt;/**&gt;* è‡ªå®šä¹‰ç½‘ç»œç±»åŠ è½½å™¨&gt;*/&gt;public class NetworkClassLoader extends ClassLoader {   private String filePath;   private String fileExtention = &quot;.class&quot;;   public NetworkClassLoader(String filePath) {       this.filePath = filePath;   }   public Class findClass(String name) {       System.out.println(&quot;findClass name=&quot; + name);       byte[] bArr = null;       try {      bArr = loadClassData(name);       } catch (IOException e) {        e.printStackTrace();       }       return defineClass(name, bArr, 0, bArr.length);   }   private byte[] loadClassData(String name) throws IOException {   // name = &quot;annotatonreflection.NetworkClassLoader&quot;;       name = name.replace(&quot;.&quot;, &quot;/&quot;);       name += fileExtention;       File file = new File(filePath, name);       FileInputStream fileInputStream = new FileInputStream(file);       ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();       int len = -1;       while ((len = fileInputStream.read()) != -1) {       byteArrayOutputStream.write(len);       }       return byteArrayOutputStream.toByteArray();   }      public static void main(String[] args) {       NetworkClassLoader classLoader = new NetworkClassLoader(&quot;CDesktop&quot;);       try {           Class clazz = classLoader.loadClass(&quot;annotatonreflection.Person&quot;);           Object obj = clazz.newInstance();           System.out.println(obj);           // System.out.println(clazz.getClassLoader());           ClassLoader classLoader2 = clazz.getClassLoader();           while (classLoader2 != null) {               System.out.println(classLoader2);               classLoader2 = classLoader2.getParent();           }           System.out.println(&quot;å¼•å¯¼ç±»åŠ è½½å™¨&quot;+classLoader2); //å¼•å¯¼ç±»åŠ è½½å™¨æ˜¯null       } catch (ClassNotFoundException e) {       e.printStackTrace();       } catch (InstantiationException e) {       e.printStackTrace();       } catch (IllegalAccessException e) {       e.printStackTrace();       }   }&gt;}Classå¯¹è±¡è·å–æ–¹å¼è·å–Classå¯¹è±¡çš„ä¸‰ç§æ–¹å¼å¯¹åº”ç€javaä»£ç åœ¨è®¡ç®—æœºä¸­çš„ä¸‰ä¸ªé˜¶æ®µSourceæºä»£ç é˜¶æ®µ: Class.forName(â€œå…¨ç±»åâ€)ï¼šå°†å­—èŠ‚ç æ–‡ä»¶åŠ è½½è¿›å†…å­˜ï¼Œè¿”å›Classå¯¹è±¡å¤šç”¨äºé…ç½®æ–‡ä»¶ï¼Œå°†ç±»åå®šä¹‰åœ¨é…ç½®æ–‡ä»¶ä¸­ã€‚è¯»å–æ–‡ä»¶ï¼ŒåŠ è½½ç±»ã€‚ Classç±»å¯¹è±¡é˜¶æ®µ: ç±»å.classï¼šé€šè¿‡ç±»åçš„å±æ€§classè·å–å¤šç”¨äºå‚æ•°çš„ä¼ é€’ Runtimeè¿è¡Œæ—¶é˜¶æ®µ: å¯¹è±¡.getClass()ï¼šgetClass()æ–¹æ³•æ˜¯å®šä¹‰åœ¨Objecç±»ä¸­çš„æ–¹æ³•å¤šç”¨äºå¯¹è±¡çš„è·å–å­—èŠ‚ç çš„æ–¹å¼  ç»“è®º: åŒä¸€ä¸ªå­—èŠ‚ç æ–‡ä»¶(*.class)åœ¨ä¸€æ¬¡ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œåªä¼šè¢«åŠ è½½ä¸€æ¬¡ï¼Œæ— è®ºé€šè¿‡å“ªä¸€ç§æ–¹å¼è·å–çš„Classå¯¹è±¡éƒ½æ˜¯åŒä¸€ä¸ªã€‚è‹¥å·²çŸ¥å…·ä½“çš„ç±»ï¼Œé€šè¿‡ç±»çš„classå±æ€§è·å–ï¼Œè¯¥æ–¹æ³•æœ€ä¸ºå®‰å…¨å¯é ï¼Œç¨‹åºæ€§èƒ½æœ€é«˜ã€‚Class clazz=Person.classï¼›å·²çŸ¥æŸä¸ªç±»çš„å®ä¾‹ï¼Œè°ƒç”¨è¯¥å®ä¾‹çš„getClassï¼ˆï¼‰æ–¹æ³•è·å–Classå¯¹è±¡Class clazz=person.getClass()ï¼›å·²çŸ¥ä¸€ä¸ªç±»çš„å…¨ç±»åï¼Œä¸”è¯¥ç±»åœ¨ç±»è·¯å¾„ä¸‹ï¼Œå¯é€šè¿‡Classç±»çš„é™æ€æ–¹æ³•forName()è·å–ï¼Œå¯èƒ½æŠ›å‡ºClassNotFoundExceptionClass clazz=Class.forName(â€œdemo01.Studentâ€);å†…ç½®åŸºæœ¬æ•°æ®ç±»å‹å¯ä»¥ç›´æ¥ç”¨ç±»å.Typeè¿˜å¯ä»¥åˆ©ç”¨ClassLoaderæˆ‘ä»¬ä¹‹åè®²è§£å“ªäº›ç±»å‹å¯ä»¥æœ‰Classå¯¹è±¡ï¼Ÿclass: å¤–éƒ¨ç±»ï¼Œæˆå‘˜(æˆå‘˜å†…éƒ¨ç±»ï¼Œé™æ€å†…éƒ¨ç±»)ï¼Œå±€éƒ¨å†…éƒ¨ç±»ï¼ŒåŒ¿åå†…éƒ¨ç±»ã€‚interface: æ¥å£[]: æ•°ç»„enum: æšä¸¾annotation: æ³¨è§£@interfaceprimitive type: åŸºæœ¬æ•°æ®ç±»å‹void1234567891011121314151617181920212223242526&gt;//æ‰€æœ‰å…³å‹Class &gt;public class Test{    public static void main(string[] args){        Class c1 = Object.class; // ç±»       Class c2 = Comparable.class; // æ¥å£       class c3 = String[].class; // ä¸€ç»´æ•°ç»„        Class c4 = int[][].class; // äºŒç»´æ•°ç»„        Class c5 = Override.class; // æ³¨è§£        Class c6 = ElementType.class; // æšä¸¾        Class c7 = Integer.class; // åŸºæœ¬æ•°æ®ç±»å‹       Class c8 = void.class; // void        Class c9 = Class.class; // class        System.out.println(c1);        System.out.println(c2);        System.out.println(c3);        System.out.println(c4);        System.out.println(c5);        System.out.println(c6);        System.out.println(c7);        System.out.println(c8);        System.out.println(c9);        int[] a = new int[10];        int[] b = new int[100];        system.out.println(a.getclass().hashcode(); }&gt;}1234567891011121314151617181920212223242526@Testpublic void reflect() throws ClassNotFoundException {     // æ–¹å¼ä¸€ï¼šClass.forName(&quot;å…¨ç±»å&quot;);     Class cls1 = Class.forName(&quot;com.test.domain.Person&quot;);   //P ersonè‡ªå®šä¹‰å®ä½“ç±»     System.out.println(&quot;cls1 = &quot; + cls1);     // æ–¹å¼äºŒï¼šç±»å.class     Class cls2 = Person.class;     System.out.println(&quot;cls2 = &quot; + cls2);     // æ–¹å¼ä¸‰ï¼šå¯¹è±¡.getClass();     Person person = new Person();             Class cls3 = person.getClass();     System.out.println(&quot;cls3 = &quot; + cls3);     // == æ¯”è¾ƒä¸‰ä¸ªå¯¹è±¡     System.out.println(&quot;cls1 == cls2 : &quot; + (cls1 == cls2));    //true     System.out.println(&quot;cls1 == cls3 : &quot; + (cls1 == cls3));    //true           // æ–¹å¼å››ï¼šåŸºæœ¬å†…ç½®ç±»å‹çš„åŒ…è£…ç±»éƒ½æœ‰ä¸€ä¸ªTypeå±æ€§         Class c4=Integer.TYPE;        System.out.printin(c4);         // è·å¾—çˆ¶ç±»ç±»å‹         Class c5=c1.getsuperclass();         System.out.printin(c5);}åæ“ä½œæ³›å‹Methodå’ŒFieldã€Constructorå¯¹è±¡éƒ½æœ‰setAccessibleï¼‰æ–¹æ³•ã€‚setAccessibleä½œç”¨æ˜¯å¯åŠ¨å’Œç¦ç”¨è®¿é—®å®‰å…¨æ£€æŸ¥çš„å¼€å…³ã€‚å‚æ•°å€¼ä¸ºtrueåˆ™æŒ‡ç¤ºåå°„çš„å¯¹è±¡åœ¨ä½¿ç”¨æ—¶åº”è¯¥å–æ¶ˆJavaè¯­è¨€è®¿é—®æ£€æŸ¥ã€‚æé«˜åå°„çš„æ•ˆç‡ã€‚å¦‚æœä»£ç ä¸­å¿…é¡»ç”¨åå°„ï¼Œè€Œè¯¥å¥ä»£ç éœ€è¦é¢‘ç¹çš„è¢«è°ƒç”¨ï¼Œé‚£ä¹ˆè¯·è®¾ç½®ä¸ºtrueã€‚ä½¿å¾—åŸæœ¬æ— æ³•è®¿é—®çš„ç§æœ‰æˆå‘˜ä¹Ÿå¯ä»¥è®¿é—®å‚æ•°å€¼ä¸ºfalseåˆ™æŒ‡ç¤ºåå°„çš„å¯¹è±¡åº”è¯¥å®æ–½Javaè¯­è¨€è®¿é—®æ£€æŸ¥ 1234567891011121314151617181920212223242526272829public class Test { public void testel(Map&lt;String,User&gt; map,List&lt;User&gt; list){     System.out.println(&quot;&quot;testo1&quot;); }public Map&lt;string,User&gt;testo2(){     System.out.println(&quot;testo2&quot;);     return null;     }public static void main(String[] args) throws NoSuchMethodException {         Method method=Test11.class.getMethod(&quot;teste1&quot;,Map.class,List.class);         Type[] genericParameterTypes=method.getGenericParameterTypes();        for(Type genericParameterType:genericParameterTypes){            System.out.println(&quot;#&quot;+genericParameterType);             if(genericParameterType instanceof ParameterizedType){                 Type[] actualTypeArguments=((ParameterizedType)genericParameterType).getActualTypeArguments();                 for (Type actualTypeArgument:actualTypeArguments){                     System.out.println(actualTypeArgument);                    method=Test11.class.getMethod(name:&quot;testo2&quot;,.â€¦parameterTypes:null);                     Type genericReturnType=method.getGenericReturnType();                     if(genericReturnType instanceof ParameterizedType){                         Type[]actualTypeArguments=((ParameterizedType) genericReturnType).getActualTypeArguments();                         for(Type actualTypeArgument:actualTypeArguments){                             System.out.println(actualTypeArgument);                                             }                    }                }            }        }    }}Classå¯¹è±¡åŠŸèƒ½è·å–åŠŸèƒ½1ï¼‰è·å–æˆå‘˜å˜é‡ä»¬12345&gt;Field[] getFields() ï¼šè·å–æ‰€æœ‰publicä¿®é¥°çš„æˆå‘˜å˜é‡&gt;Field getField(String name)   è·å–æŒ‡å®šåç§°çš„ publicä¿®é¥°çš„æˆå‘˜å˜é‡&gt;Field[] getDeclaredFields()  è·å–æ‰€æœ‰çš„æˆå‘˜å˜é‡ï¼Œä¸è€ƒè™‘ä¿®é¥°ç¬¦&gt;Field getDeclaredField(String name) 2ï¼‰è·å–æ„é€ æ–¹æ³•ä»¬12345&gt;Constructor&lt;?&gt;[] getConstructors()  &gt;Constructor&lt;T&gt; getConstructor(ç±»&lt;?&gt;... parameterTypes)  &gt;Constructor&lt;?&gt;[] getDeclaredConstructors()  &gt;Constructor&lt;T&gt; getDeclaredConstructor(ç±»&lt;?&gt;... parameterTypes)  3ï¼‰è·å–æˆå‘˜æ–¹æ³•ä»¬12345&gt;Method[] getMethods()  &gt;Method getMethod(String name, ç±»&lt;?&gt;... parameterTypes)  &gt;Method[] getDeclaredMethods()  &gt;Method getDeclaredMethod(String name, ç±»&lt;?&gt;... parameterTypes)4ï¼‰è·å–å…¨ç±»åå’Œç®€å•ç±»å1&gt;String getName() Fieldï¼šæˆå‘˜å˜é‡è®¾ç½®å€¼: void set(Object obj, Object value)è·å–å€¼: get(Object obj)å¿½ç•¥è®¿é—®æƒé™ä¿®é¥°ç¬¦çš„å®‰å…¨æ£€æŸ¥ setAccessible(true): æš´åŠ›åå°„12345678910111213&gt;import lombok.Getter;&gt;import lombok.Setter;&gt;import lombok.ToString;&gt;@Setter&gt;@Getter&gt;@ToString&gt;public class Person {   public String a;        //æœ€å¤§èŒƒå›´public       protected String b;     //å—ä¿æŠ¤ç±»å‹       String c;               //é»˜è®¤çš„è®¿é—®æƒé™       private String d;       //ç§æœ‰ç±»å‹   }1234567891011121314151617181920212223242526272829&gt;// æµ‹è¯•getFieldså’ŒgetField(String name)æ–¹æ³•&gt;**&gt;* è·å–æˆå‘˜å˜é‡&gt;*   Field[] getFields()*   Field getField(String name)*/@Testpublic void reflect() throws Exception {  // 0. è·å–Personçš„Classå¯¹è±¡  Class personClass = Person.class;   // 1. Field[] getFields()è·å–æ‰€æœ‰publicä¿®é¥°çš„æˆå‘˜å˜é‡  Field[] fields = personClass.getFields();   for(Field field : fields){       System.out.println(field);   }   System.out.println(&quot;=============================&quot;);   // 2. Field getField(String name)   Field a = personClass.getField(&quot;a&quot;);   // 3. è·å–æˆå‘˜å˜é‡a çš„å€¼ [ä¹Ÿåªèƒ½è·å–å…¬æœ‰çš„ï¼Œè·å–ç§æœ‰çš„æˆ–è€…ä¸å­˜åœ¨çš„å­—ç¬¦ä¼šæŠ›å‡ºå¼‚å¸¸]  Person p = new Person();   Object value = a.get(p);   System.out.println(&quot;value = &quot; + value);   // 4 è®¾ç½®å±æ€§açš„å€¼  a.set(p,&quot;å¼ ä¸‰&quot;);   System.out.println(p);}123456789101112131415161718192021222324252627&gt;// æµ‹è¯•getDeclaredFieldså’ŒgetDeclaredField(String name)æ–¹æ³•&gt;/***  Field[] getDeclaredFields()*  Field getDeclaredField(String name)*/@Test&gt;public void reflect3() throws Exception {  Class personClass = Person.class;   // Field[] getDeclaredFields()ï¼šè·å–æ‰€æœ‰çš„æˆå‘˜å˜é‡ï¼Œä¸è€ƒè™‘ä¿®é¥°ç¬¦  Field[] declaredFields = personClass.getDeclaredFields();   for(Field filed : declaredFields){       System.out.println(filed);   }   System.out.println(&quot;===================================&quot;);   // Field getDeclaredField(String name)   Field d = personClass.getDeclaredField(&quot;d&quot;);     //private String d;   Person p = new Person();   // Object value1 = d.get(p);    //ä¼šæŠ›å‡ºå¼‚å¸¸  // System.out.println(&quot;value1 = &quot; + value1);       //å¯¹äºç§æœ‰å˜é‡è™½ç„¶èƒ½ä¼šè·å–åˆ°ï¼Œä½†ä¸èƒ½ç›´æ¥setå’Œget  //å¿½ç•¥è®¿é—®æƒé™ä¿®é¥°ç¬¦çš„å®‰å…¨æ£€æŸ¥   d.setAccessible(true);//æš´åŠ›åå°„   Object value2 = d.get(p);   System.out.println(&quot;value2 = &quot; + value2);}&gt;æ²¡æœ‰å¿½ç•¥è®¿é—®ä¿®é¥°ç¬¦ç›´æ¥è®¿é—®æŠ›å‡ºçš„å¼‚å¸¸Constructor:æ„é€ æ–¹æ³•åˆ›å»ºå¯¹è±¡ï¼šT newInstance(Objectâ€¦ initargs)æ³¨æ„ï¼šå¦‚æœä½¿ç”¨ç©ºå‚æ•°æ„é€ æ–¹æ³•åˆ›å»ºå¯¹è±¡ï¼Œæ“ä½œå¯ä»¥ç®€åŒ–ï¼šClasså¯¹è±¡çš„newInstanceæ–¹æ³•12345678910111213141516171819&gt;import lombok.Getter;&gt;import lombok.Setter;&gt;import lombok.ToString;&gt;@Setter&gt;@Getter&gt;@ToString&gt;public class Person {       private String name;       private Integer age;   //æ— å‚æ„é€ å‡½æ•°       public Person() {}       //å•ä¸ªå‚æ•°çš„æ„é€ å‡½æ•°ï¼Œä¸”ä¸ºç§æœ‰æ„é€ æ–¹æ³•       private Person(String name){}       //æœ‰å‚æ„é€ å‡½æ•°       public Person(String name, Integer age) {          this.name = name;          this.age = age; }&gt;}12345678910111213141516171819202122232425262728293031323334353637383940414243444546    /**   * è·å–æ„é€ æ–¹æ³•ä»¬&gt;*   Constructor&lt;?&gt;[] getConstructors()&gt;*   Constructor&lt;T&gt; getConstructor(ç±»&lt;?&gt;... parameterTypes)&gt;*/&gt;@Test&gt;public void reflect4() throws Exception {   Class personClass = Person.class;   //Constructor&lt;?&gt;[] getConstructors()   Constructor[] constructors = personClass.getConstructors();  for(Constructor constructor : constructors){         // Constructor å¯¹è±¡reflectåŒ…ä¸‹çš„ import java.lang.reflect.Constructor;       System.out.println(constructor);  }   System.out.println(&quot;==========================================&quot;);   // è·å–æ— å‚æ„é€ å‡½æ•° æ³¨æ„ï¼šPersonç±»ä¸­å¿…é¡»è¦æœ‰æ— å‚çš„æ„é€ å‡½æ•°ï¼Œä¸ç„¶æŠ›å‡ºå¼‚å¸¸   Constructor constructor1 = personClass.getConstructor();   System.out.println(&quot;constructor1 = &quot; + constructor1);  // è·å–åˆ°æ„é€ å‡½æ•°åå¯ä»¥ç”¨äºåˆ›å»ºå¯¹è±¡   Object person1 = constructor1.newInstance();   // Constructorç±»å†…æä¾›äº†åˆå§‹åŒ–æ–¹æ³•newInstance();æ–¹æ³•   System.out.println(&quot;person1 = &quot; + person1);   System.out.println(&quot;==========================================&quot;);   // è·å–æœ‰å‚çš„æ„é€ å‡½æ•°     // public Person(String name, Integer age)    // å‚æ•°ç±»å‹é¡ºåºè¦ä¸æ„é€ å‡½æ•°å†…ä¸€è‡´ï¼Œä¸”å‚æ•°ç±»å‹ä¸ºå­—èŠ‚ç ç±»å‹  Constructor constructor2 = personClass.getConstructor(String.class,Integer.class);  System.out.println(&quot;constructor2 = &quot; + constructor2);      // åˆ›å»ºå¯¹è±¡   Object person2 = constructor2.newInstance(&quot;å¼ ä¸‰&quot;, 23);       // è·å–çš„æ˜¯æœ‰å‚çš„æ„é€ æ–¹æ³•ï¼Œå°±å¿…é¡»è¦ç»™å‚æ•°   System.out.println(person2);   System.out.println(&quot;=========================================&quot;);   // å¯¹äºä¸€èˆ¬çš„æ— å‚æ„é€ å‡½æ•°ï¼Œæˆ‘ä»¬éƒ½ä¸ä¼šå…ˆè·å–æ— å‚æ„é€ å™¨ä¹‹ååœ¨è¿›è¡Œåˆå§‹åŒ–ã€‚  // è€Œæ˜¯ç›´æ¥è°ƒç”¨Classç±»å†…çš„newInstance()æ–¹æ³•   Object person3 = personClass.newInstance();  System.out.println(&quot;person3 = &quot; + person3);   // æˆ‘ä»¬ä¹‹å‰ä½¿ç”¨çš„ Class.forName(&quot;&quot;).newInstance   // å…¶æœ¬è´¨ä¸Šå°±æ˜¯è°ƒç”¨äº†ç±»å†…çš„æ— å‚æ„é€ å‡½æ•°æ¥å®Œæˆå®ä¾‹åŒ–çš„   // ä»¥ååœ¨ä½¿ç”¨  Class.forName(&quot;&quot;).newInstance; åå°„åˆ›å»ºå¯¹è±¡æ—¶ï¼Œä¸€å®šè¦ä¿è¯ç±»å†…æœ‰æ— å‚æ„é€ å‡½æ•°}&gt;å¯¹äºgetDeclaredConstructoræ–¹æ³•å’ŒgetDeclaredConstructorsæ–¹æ³•getDeclaredConstructoræ–¹æ³•å¯ä»¥è·å–åˆ°ä»»ä½•è®¿é—®æƒé™çš„æ„é€ å™¨ï¼Œè€ŒgetConstructoræ–¹æ³•åªèƒ½è·å–publicä¿®é¥°çš„æ„é€ å™¨ã€‚æ­¤å¤–åœ¨æ„é€ å™¨çš„å¯¹è±¡å†…ä¹Ÿæœ‰setAccessible(true);æ–¹æ³•ï¼Œå¹¶è®¾ç½®æˆtrueå°±å¯ä»¥æ“ä½œäº†ã€‚â€‹    å…³äºä¸ºä»€ä¹ˆè¦ä½¿ç”¨privateè®¿é—®æƒé™çš„æ„é€ å™¨ï¼Œä½¿ç”¨è¿™ä¸ªæ„é€ å™¨ä¸å°±ä¸èƒ½å¤–éƒ¨è®¿é—®äº†å˜›ï¼Œä¸ä¹Ÿå°±æ— æ³•è¿›è¡Œå®ä¾‹åŒ–å¯¹è±¡äº†å—ï¼Ÿæ— æ³•åœ¨ç±»çš„å¤–éƒ¨å®ä¾‹åŒ–å¯¹è±¡æ­£æ˜¯ç§æœ‰æ„é€ å™¨çš„æ„ä¹‰æ‰€åœ¨ï¼Œåœ¨å•ä¾‹æ¨¡å¼ä¸‹ç»å¸¸ä½¿ç”¨ï¼Œæ•´ä¸ªé¡¹ç›®åªæœ‰ä¸€ä¸ªå¯¹è±¡ï¼Œå¤–éƒ¨æ— æ³•å®ä¾‹åŒ–å¯¹è±¡ï¼Œå¯ä»¥åœ¨ç±»å†…çš„è¿›è¡Œå®ä¾‹åŒ–å¹¶é€šè¿‡é™æ€æ–¹æ³•è¿”å›ï¼ˆç”±äºå®ä¾‹åŒ–çš„å¯¹è±¡æ˜¯é™æ€çš„ï¼Œæ•…åªæœ‰ä¸€ä¸ªå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯å•ä¾‹çš„ï¼‰ã€‚ç½‘ä¸Šè¯´è¿™å°±æ˜¯å•ä¾‹æ¨¡å¼ä¸­çš„é¥¿æ±‰æ¨¡å¼ï¼Œä¸ç®¡æ˜¯å¦è°ƒç”¨ï¼Œéƒ½åˆ›å»ºä¸€ä¸ªå¯¹è±¡ã€‚123456789101112131415161718192021&gt;class SingletonDemo{// ç§æœ‰åŒ–æ„é€ æ–¹æ³•private SingletonDemo(){   }   // åˆ›å»ºä¸€ä¸ªå¯¹è±¡  ç±»å†…å®ä¾‹åŒ–ï¼ˆé™æ€çš„å¯¹è±¡ï¼‰   private static SingletonDemo singleton = new SingletonDemo();   // æä¾›publicæ–¹æ³•ä¾›å¤–éƒ¨è®¿é—®ï¼Œè¿”å›è¿™ä¸ªåˆ›å»ºçš„å¯¹è±¡   public static SingletonDemo getInstance(){       return singleton;   }&gt;}&gt;public class Singleton {public static void main(String[] args) {SingletonDemo s1 = SingletonDemo.getInstance();//è¾“å‡ºå¯¹è±¡çš„åœ°å€ï¼Œå¦‚æœæœ‰åœ°å€å­˜åœ¨ï¼Œåˆ™è¯´æ˜å¯¹è±¡åˆ›å»ºæˆåŠŸå¹¶è·å–åˆ°System.out.println(s1);  SingletonDemo s2 = SingletonDemo.getInstance();//å¦‚æœç»“æœä¸ºtrueï¼Œåˆ™è¯´æ˜æ˜¯åŒä¸€ä¸ªå¯¹è±¡System.out.println(s1==s2);    //è¾“å‡ºç»“æœä¸ºtrue}&gt;}Methodï¼šæ–¹æ³•å¯¹è±¡æ‰§è¡Œæ–¹æ³•ï¼šObject invoke(Object obj, Objectâ€¦ args)è·å–æ–¹æ³•åç§°ï¼šString getName();12345678910111213141516171819202122232425&gt;import lombok.Getter;&gt;import lombok.Setter;&gt;import lombok.ToString;&gt;@Setter&gt;@Getter&gt;@ToString&gt;public class Person {   private String name;       private Integer age;       //æ— å‚æ„é€ å‡½æ•°   public Person() {}       //æœ‰å‚æ„é€ å‡½æ•°       public Person(String name, Integer age) {      this.name = name;          this.age = age;}   //æ— å‚æ–¹æ³•       public void eat(){          System.out.println(&quot;eat...&quot;);        }        //é‡è½½æœ‰å‚æ–¹æ³•       public void eat(String food){      System.out.println(&quot;eat...&quot;+food);       }   }invokeæ–¹æ³• 123456789101112131415161718192021222324252627282930313233    /**   * è·å–æˆå‘˜æ–¹æ³•ä»¬ï¼š&gt;*  Method[] getMethods()&gt;*  Method getMethod(String name, ç±»&lt;?&gt;... parameterTypes)&gt;*/&gt;@Test&gt;public void reflect5() throws Exception {  Class personClass = Person.class;   // è·å–æŒ‡å®šåç§°çš„æ–¹æ³•       Method eat_method1 = personClass.getMethod(&quot;eat&quot;);   // æ‰§è¡Œæ–¹æ³•   Person person = new Person();  Object rtValue = eat_method1.invoke(person);   //å¦‚æœæ–¹æ³•æœ‰è¿”å›å€¼ç±»å‹å¯ä»¥è·å–åˆ°ï¼Œæ²¡æœ‰å°±ä¸ºnull   // è¾“å‡ºè¿”å›å€¼ eatæ–¹æ³•æ²¡æœ‰è¿”å›å€¼ï¼Œæ•…è¾“å‡ºnull  System.out.println(&quot;rtValue = &quot; + rtValue);   System.out.println(&quot;--------------------------------------------&quot;);   // è·å–æœ‰å‚çš„æ„é€ å‡½æ•°  æœ‰ä¸¤ä¸ªå‚æ•° ç¬¬ä¸€ä¸ªæ–¹æ³•å ç¬¬äºŒä¸ªå‚æ•°åˆ—è¡¨ ï¼Œä¸åŒçš„å‚æ•°æ˜¯ä¸åŒçš„æ–¹æ³•ï¼ˆé‡è½½ï¼‰   Method eat_method2 = personClass.getMethod(&quot;eat&quot;, String.class);   //æ‰§è¡Œæ–¹æ³•   eat_method2.invoke(person,&quot;é¥­&quot;);   System.out.println(&quot;============================================&quot;);   //è·å–æ–¹æ³•åˆ—è¡¨  Method[] methods = personClass.getMethods();   for(Method method : methods){            //æ³¨æ„ï¼šè·å–åˆ°çš„æ–¹æ³•åç§°ä¸ä»…ä»…æ˜¯æˆ‘ä»¬åœ¨Personç±»å†…çœ‹åˆ°çš„æ–¹æ³•       System.out.println(method);          //ç»§æ‰¿ä¸‹æ¥çš„æ–¹æ³•ä¹Ÿä¼šè¢«è·å–åˆ°ï¼ˆå½“ç„¶å‰ææ˜¯publicä¿®é¥°çš„ï¼‰  }}&gt; getNameæ–¹æ³•getName()æ–¹æ³•è·å–çš„æ–¹æ³•åæ˜¯ä»…ä»…å°±æ˜¯æ–¹æ³•åï¼ˆä¸å¸¦å…¨ç±»åï¼‰ï¼Œä¸”ä¸å¸¦æœ‰å‚æ•°åˆ—è¡¨ã€‚1234567891011&gt;@Test&gt;public void reflect6() throws NoSuchMethodException {       Class personClass = Person.class;       Method[] methods = personClass.getMethods();       for(Method method : methods){           System.out.println(method);           // è·å–æ–¹æ³•å           String name = method.getName();             System.out.println(name);          }&gt;}è·å–ç±»ågetClass()æ–¹æ³•æ˜¯Objectç±»çš„æ–¹æ³•ï¼Œéœ€è¦æ³¨æ„ä¸€ç‚¹è·å–çš„ç±»åæ˜¯å…¨ç±»åï¼ˆå¸¦æœ‰è·¯å¾„ï¼‰123456@Testpublic void reflect7(){     Class personClass = Person.class;     String className = personClass.getName();     System.out.println(className);}å…³äºè·å–æˆå‘˜æ–¹æ³•ä»¬çš„å¦å¤–ä¸¤ä¸ªæ–¹æ³•åŒä¹‹å‰çš„å™è¿°ä¸€æ ·ï¼Œå¸¦æœ‰Declaredå…³é”®å­—çš„æ–¹æ³•è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œå¯ä»¥è·å–åˆ°ä»»æ„ä¿®é¥°ç¬¦çš„æ–¹æ³•ã€‚åŒæ ·çš„æä¾›äº†setAccessible(true);æ–¹æ³•è¿›è¡Œæš´åŠ›åå°„ã€‚   Methodå’ŒFieldã€Constructorå¯¹è±¡éƒ½æœ‰setAccessibleï¼‰æ–¹æ³•ã€‚setAccessibleä½œç”¨æ˜¯å¯åŠ¨å’Œç¦ç”¨è®¿é—®å®‰å…¨æ£€æŸ¥çš„å¼€å…³ã€‚å‚æ•°å€¼ä¸ºtrueåˆ™æŒ‡ç¤ºåå°„çš„å¯¹è±¡åœ¨ä½¿ç”¨æ—¶åº”è¯¥å–æ¶ˆJavaè¯­è¨€è®¿é—®æ£€æŸ¥ã€‚   æé«˜åå°„çš„æ•ˆç‡ã€‚å¦‚æœä»£ç ä¸­å¿…é¡»ç”¨åå°„ï¼Œè€Œè¯¥å¥ä»£ç éœ€è¦é¢‘ç¹çš„è¢«è°ƒç”¨ï¼Œé‚£ä¹ˆè¯·è®¾ç½®ä¸ºtrueã€‚ä½¿å¾—åŸæœ¬æ— æ³•è®¿é—®çš„ç§æœ‰æˆå‘˜ä¹Ÿå¯ä»¥è®¿é—®&gt;å‚æ•°å€¼ä¸ºfalseåˆ™æŒ‡ç¤ºåå°„çš„å¯¹è±¡åº”è¯¥å®æ–½Javaè¯­è¨€è®¿é—®æ£€æŸ¥ç»¼ä¸Šè¯´è¿°ï¼šå¯¹äºåå°„æœºåˆ¶æ¥è¯´ï¼Œåœ¨åå°„é¢å‰æ²¡æœ‰å…¬æœ‰ç§æœ‰ï¼Œéƒ½å¯ä»¥é€šè¿‡æš´åŠ›åå°„è§£å†³ã€‚123&gt;Method[] getDeclaredMethods()  &gt;Method getDeclaredMethod(String name, ç±»&lt;?&gt;... parameterTypes)&gt;method.setAccessible(true);   //æš´åŠ›åå°„</content>
	</entry>
	<entry>
		<title>Sparké›†ç¾¤æ­å»º</title>
		<url>/article/d192a1af.html</url>
		<content>sparkç¯å¢ƒæ­å»ºç‰ˆæœ¬æ€»è§ˆ12345678910111213141516171819(ray37) [root@Slave03 huangyc]# java -versionjava version &quot;1.8.0_281&quot;(ray37) [root@Slave03 huangyc]# hadoop versionHadoop 3.2.1Compiled with protoc 2.5.0(ray37) [root@Slave03 huangyc]# scala -versionScala code runner version 2.12.15 -- Copyright 2002-2021, LAMP/EPFL and Lightbend, Inc.(ray37) [root@Slave03 huangyc]# sh /usr/spark-3.0/bin/spark-shellSpark context Web UI available at http://Slave03:4040Welcome to      ____              __     / __/__  ___ _____/ /__    _\ \/ _ \/ _ `/ __/  '_/   /___/ .__/\_,_/_/ /_/\_\   version 3.0.3      /_/  Using Scala version 2.12.10 (Java HotSpot(TM) 64-Bit Server VM, Java 1.8.0_281)ç™¾åº¦ç½‘ç›˜ä¸‹è½½  æå–ç : 7g8vscalaä¸‹è½½å¹¶å®‰è£…scalaä¸‹è½½ scala-2.12å®‰è£…rpm -ivh scala-2.12.15.rpmæŸ¥çœ‹scalaç‰ˆæœ¬scala -versioné…ç½®ç¯å¢ƒæŸ¥è¯¢åŒ…ä¸­æ–‡ä»¶å®‰è£…ä½ç½® -lï¼šrpm -ql åŒ…åç¼–è¾‘/etc/profileï¼Œæ–‡ä»¶æœ«å°¾æ·»åŠ é…ç½®123# é…ç½®scalaç¯å¢ƒå˜é‡export SCALA_HOME=/usr/share/scala/binexport PATH=$PATH:$SCALA_HOMEæ‰§è¡Œsource /etc/profileä»¤å…¶ç”Ÿæ•ˆå…¶ä»–èŠ‚ç‚¹åŒæ ·é…ç½®å³å¯å…å¯†ç™»å½•ä¿®æ”¹ä¸»æœºå(éå¿…é¡»)æŸ¥çœ‹ä¸»æœºåç”¨hostnameä¿®æ”¹ä¸»æœºå/etc/hostnameä¿®æ”¹åé‡å¯æœåŠ¡å™¨rebooté…ç½®hostæ–‡ä»¶vi /etc/hosts123192.168.123.21  Slave00192.168.123.23  Slave02192.168.123.24  Slave03/etc/init.d/network restartç”Ÿæˆç§˜é’¥å¯¹ä½¿ç”¨ RSA ç±»å‹çš„åŠ å¯†ç±»å‹æ¥åˆ›å»ºå¯†é’¥å¯¹1234# ç”Ÿæˆç§˜é’¥(-fæ¢åå­—å¥½åƒä¸è¡Œ)ssh-keygen -t rsa# é…ç½®æœ¬æœºå…å¯†cat id_rsa.pub&gt;&gt;authorized_keys-f å‚æ•°è¡¨ç¤ºæŒ‡å®šå¯†é’¥å¯¹ç”Ÿæˆä½ç½®ä¸åç§° å¯†é’¥å¯¹é€šå¸¸æ”¾åœ¨ ~/.sshç›®å½•ä¸‹ å›è½¦å³å¯åˆ›å»ºå¯†é’¥å¯¹ï¼Œéœ€è¦è¾“å…¥å¯†ç å¦‚æœä¸éœ€è¦ä¸ºå¯†é’¥å¯¹è¿›è¡ŒåŠ å¯†ï¼Œé‚£ä¹ˆå¯ä»¥ä¸€è·¯å›è½¦æœ‰éœ€è¦æ¸…ç©ºæ–‡ä»¶çš„å¯ä»¥æ‰§è¡Œtruncate -s 0 authorized_keysåˆ›å»ºæˆåŠŸä¹‹åï¼Œå¯ä»¥çœ‹åˆ° .ssh ç›®å½•ä¸‹å¤šäº†ä¸¤ä¸ªæ–‡ä»¶ï¼Œåˆ†åˆ«æ˜¯ï¼šid_keyï¼šå¯†é’¥å¯¹çš„ç§é’¥ï¼Œé€šå¸¸æ”¾åœ¨å®¢æˆ·ç«¯id_rsa.pubï¼šå¯†é’¥å¯¹ä¸­çš„å…¬é’¥ï¼Œé€šå¸¸æ”¾åœ¨æœåŠ¡ç«¯ç§˜é’¥ä¸Šä¼ æœåŠ¡å™¨æ–‡ä»¶æƒé™12sudo chmod -R 700 ~/.sshsudo chmod -R 600 ~/.ssh/authorized_keyså°†your_key.pub å…¬é’¥æ–‡ä»¶ä¸Šä¼ è‡³éœ€è¦è¿æ¥çš„æœåŠ¡å™¨123456789# æ–¹å¼ä¸€ï¼šè¿½åŠ åœ¨å…¶ä»–æœåŠ¡å™¨æ–‡ä»¶æœ«å°¾(æœ¬æœºä¸éœ€è¦)cat ~/.ssh/id_rsa.pub | ssh root@192.168.123.21 &quot;cat - &gt;&gt; ~/.ssh/authorized_keys&quot;cat ~/.ssh/id_rsa.pub | ssh root@192.168.123.23 &quot;cat - &gt;&gt; ~/.ssh/authorized_keys&quot;cat ~/.ssh/id_rsa.pub | ssh root@192.168.123.24 &quot;cat - &gt;&gt; ~/.ssh/authorized_keys&quot;# æ–¹å¼äºŒssh-copy-id -i ~/.ssh/id_key.pub root@192.168.123.21ssh-copy-id -i ~/.ssh/id_key.pub root@192.168.123.23ssh-copy-id -i ~/.ssh/id_key.pub root@192.168.123.24-i å‚æ•°è¡¨ç¤ºä½¿ç”¨æŒ‡å®šçš„å¯†é’¥ï¼Œ-på‚æ•°è¡¨ç¤ºæŒ‡å®šç«¯å£ï¼Œssh çš„é»˜è®¤ç«¯å£æ˜¯ 22å…¬é’¥æŸ¥çœ‹æœ¬åœ°çš„å…¬é’¥æ–‡ä»¶ä¸Šä¼ åœ¨æœåŠ¡å™¨çš„.ssh/authorized_keys æ–‡ä»¶ä¸­1cat ~/.ssh/authorized_keyså…å¯†æ£€æµ‹123ssh Slaver00ssh Slaver02ssh Slaver03hadoopæ–°å»ºç”¨æˆ·(éå¿…é¡»)æ–°å»ºhadoopç”¨æˆ·1useradd -m hadoop -s /bin/bashä¿®æ”¹hadoopç”¨æˆ·å¯†ç 1passwd hadoopåˆ‡æ¢ç”¨æˆ·1su hadoopæ–°å»ºæ–‡ä»¶å¤¹12mkdir /home/hadoop/appsmkdir /home/hadoop/dataå…³é—­é˜²ç«å¢™12systemctl stop firewalldsystemctl disable firewalldå…³é—­selinux12vim /etc/sysconfig/selinuxä¿®æ”¹SELINUX=enforcingä¸ºSELINUX=disabledå®‰è£…ä¸‹è½½å¹¶è§£å‹hadoopåˆ°/usr/hadoop-3.2.0ä¸‹è½½ hadoop-3.2.0ï¼Œè§£å‹åˆ°/usr/hadoop-3.2.0é…ç½®ç¯å¢ƒå˜é‡12export HADOOP_HOME=/usr/hadoop-3.2.0export PATH=$PATH:$HADOOP_HOMEæ‰§è¡Œsource /etc/profileä»¤å…¶ç”Ÿæ•ˆæŸ¥çœ‹hadoopç‰ˆæœ¬ï¼Œhadoop versioné…ç½®æ–‡ä»¶Hadoopé…ç½®æ–‡ä»¶çš„é…ç½®ï¼Œéœ€è¦é…ç½®çš„æ–‡ä»¶æœ‰å‡ ä¸ªåˆ†åˆ«æ˜¯hadoop-env.shcore-site.xmlhdfs-site.xmlmapred-site.xmlyarn-site.xmlworkersæ–‡ä»¶è¿™äº›æ–‡ä»¶å‡å¯ä»¥åœ¨/usr/hadoop-3.2.0/etc/hadoopä¸‹æ‰¾åˆ°workersæ–‡ä»¶123Slave00Slave02Slave03  # ä¸»èŠ‚ç‚¹æ—§ç‰ˆæœ¬ä»¥åŠç½‘ä¸Šçš„æ•™ç¨‹æ˜¯ä¿®æ”¹etc/hadoop/slavesæ–‡ä»¶ï¼Œä½†æ˜¯æ–°ç‰ˆå·²ç»ç§»é™¤äº†è¿™ä¸€ä¸ªæ–‡ä»¶ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯workersæ–‡ä»¶ï¼Œä¸Šè¿°è®¾ç½®ä»£è¡¨æˆ‘çš„é›†ç¾¤æœ‰ä¸‰ä¸ªdatanodeç»“ç‚¹hadoop_env.shåœ¨hadoopæ ¹ç›®å½•ä¸‹æ‰§è¡Œmkdir pidsï¼Œç”¨äºå­˜æ”¾pidæ–‡ä»¶12345export JAVA_HOME=${JAVA_HOME}                    #è®¾ç½®JAVA_HOMEçš„è·¯å¾„ï¼Œéœ€è¦å†æ¬¡æŒ‡æ˜export HADOOP_HOME=${HADOOP_HOME}export HADOOP_PID_DIR=/usr/hadoop-3.2.0/pids     # pidæ–‡ä»¶æ ¹ç›®å½•ï¼Œä¸è®¾ç½®çš„é»˜è®¤å€¼ä¸º/tmpï¼Œä¸€æ®µæ—¶é—´å/tmpä¸‹çš„æ–‡ä»¶ä¼šè¢«æ¸…é™¤ï¼Œå¯¼è‡´æ— æ³•å…³é—­hadoopé›†ç¾¤# è§£å†³å¯åŠ¨æ—¶è­¦å‘Š WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicableexport JAVA_LIBRARY_PATH=$HADOOP_HOME/lib/nativeæ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä¹‹å‰æ²¡æœ‰è®¾ç½®JAVA_HOMEçš„ç¯å¢ƒå˜é‡ï¼Œæ­¤å¤„ç›´æ¥è¿™æ ·å¼•ç”¨ä¼šå‡ºç°é”™è¯¯ï¼Œæ”¹ç”¨ç»å¯¹è·¯å¾„å³å¯æ¶ˆé™¤é”™è¯¯ã€‚core-site.xml12345678910111213&lt;!-- Put site-specific property overrides in this file. --&gt;&lt;configuration&gt;    &lt;!-- è®¾ç½®äº†ä¸»èŠ‚ç‚¹çš„ip --&gt;    &lt;property&gt;      &lt;name&gt;fs.defaultFS&lt;/name&gt;      &lt;value&gt;hdfs://Slave03:9000&lt;/value&gt;    &lt;/property&gt;    &lt;!-- è®¾ç½®äº†ä¸´æ—¶ç›®å½•çš„åœ°å€ --&gt;    &lt;property&gt;        &lt;name&gt;hadoop.tmp.dir&lt;/name&gt;        &lt;value&gt;/home/huangyc/hadoop_data/data/tmp&lt;/value&gt;    &lt;/property&gt;&lt;/configuration&gt;hdfs-site.xml123456789101112131415161718192021222324&lt;!-- Put site-specific property overrides in this file. --&gt;&lt;configuration&gt;    &lt;property&gt;        &lt;name&gt;dfs.namenode.secondary.http-address&lt;/name&gt;        &lt;value&gt;Slave03:50090&lt;/value&gt;    &lt;/property&gt;    &lt;property&gt;        &lt;!-- é…ç½®ç½‘é¡µç«¯å£è®¿é—® ä¸é…ç½®çš„è¯ é»˜è®¤ç«¯å£ä¸º9870--&gt;        &lt;name&gt;dfs.namenode.http.address&lt;/name&gt;        &lt;value&gt;Slave03:50070&lt;/value&gt;    &lt;/property&gt;    &lt;property&gt;        &lt;name&gt;dfs.replication&lt;/name&gt;        &lt;value&gt;2&lt;/value&gt;    &lt;/property&gt;    &lt;property&gt;        &lt;name&gt;dfs.namenode.name.dir&lt;/name&gt;        &lt;value&gt;file:///data/hadoop/hdfs/nn&lt;/value&gt;    &lt;/property&gt;    &lt;property&gt;        &lt;name&gt;dfs.datanode.data.dir&lt;/name&gt;        &lt;value&gt;file:///data/hadoop/hdfs/dn&lt;/value&gt;    &lt;/property&gt;&lt;/configuration&gt;mapred-site.xml123456789101112131415&lt;!-- Put site-specific property overrides in this file. --&gt;&lt;configuration&gt;    &lt;property&gt;        &lt;name&gt;mapreduce.framework.name&lt;/name&gt;        &lt;value&gt;yarn&lt;/value&gt;    &lt;/property&gt;    &lt;property&gt;        &lt;name&gt;mapreduce.jobhistory.address&lt;/name&gt;        &lt;value&gt;Slave03:10020&lt;/value&gt;    &lt;/property&gt;    &lt;property&gt;        &lt;name&gt;mapreduce.jobhistory.webapp.address&lt;/name&gt;        &lt;value&gt;Slave03:19888&lt;/value&gt;    &lt;/property&gt;&lt;/configuration&gt;yarn-site.xml1234567891011121314151617&lt;configuration&gt;  &lt;!-- Site specific YARN configuration properties --&gt;  &lt;!-- æŒ‡å®šResourceManagerçš„åœ°å€--&gt;  &lt;property&gt;      &lt;name&gt;yarn.resourcemanager.hostname&lt;/name&gt;      &lt;value&gt;Slave03&lt;/value&gt;  &lt;/property&gt;  &lt;!-- æŒ‡å®šreducerè·å–æ•°æ®çš„æ–¹å¼--&gt;  &lt;property&gt;      &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;      &lt;value&gt;mapreduce_shuffle&lt;/value&gt;  &lt;/property&gt;  &lt;property&gt;      &lt;name&gt;yarn.nodemanager.local-dirs&lt;/name&gt;      &lt;value&gt;file:///data/hadoop/yarn/nm&lt;/value&gt;  &lt;/property&gt;&lt;/configuration&gt;ä»èŠ‚ç‚¹è®¾ç½®å°†hadoopç›®å½•æ‹·è´åˆ°ä»èŠ‚ç‚¹çš„å¯¹åº”ç›®å½•ä»¿ç…§ä¸»èŠ‚ç‚¹å¯¹åº”çš„æ•°æ®ç›®å½•è®¾ç½®ï¼Œè®¾ç½®å¯¹åº”çš„æ•°æ®ç›®å½•ï¼ˆå³/dataä¸€ç³»åˆ—ç›®å½•ï¼‰hadoopå¯åŠ¨å’Œæµ‹è¯•ç¬¬ä¸€æ¬¡å¼€å¯æ—¶é¦–å…ˆè¦åˆå§‹åŒ–hdfs12cd /usr/hadoop-3.2.0./bin/hdfs namenode -formatæ­¤å¤„éœ€è¦æ³¨æ„ä¸€ä¸ªé—®é¢˜ï¼Œç¬¬äºŒæ¬¡å¼€å¯ä¸éœ€è¦å†æ¬¡åˆå§‹åŒ–ï¼Œé‡åˆ°é—®é¢˜éœ€è¦å†æ¬¡åˆå§‹åŒ–ï¼Œå»ºè®®åˆ é™¤å­˜æ”¾æ–‡ä»¶ä¸Šè¿°é…ç½®æ–‡ä»¶ä¸­æŒ‡æ˜äº†å­˜æ”¾æ•°æ®çš„æ–‡ä»¶ä¸ºdfsï¼Œåˆ°æ—¶å€™åˆ é™¤å³å¯ä¸»èŠ‚ç‚¹å¯åŠ¨123cd /usr/hadoop-3.2.0/sbin# å¯åŠ¨å‰./start-all.shæŸ¥çœ‹è¿›ç¨‹123456789101112131415# ä¸»èŠ‚ç‚¹[root@Slave03 sbin]# jps28260 SecondaryNameNode28810 ResourceManager27706 DataNode30236 Jps29341 NodeManager27326 NameNode# ä»èŠ‚ç‚¹[root@Slave00 sbin]# jps3570 DataNode4115 NodeManager22413 Worker27503 JpsæŸ¥çœ‹å¯¹åº”çš„æ•°æ®ç»“ç‚¹æ˜¯å¦æ­£ç¡®12345678910111213141516[root@Slave03 sbin]# hdfs dfsadmin -reportConfigured Capacity: 160982630400 (149.93 GB)Present Capacity: 82032381952 (76.40 GB)DFS Remaining: 82032345088 (76.40 GB)DFS Used: 36864 (36 KB)DFS Used%: 0.00%Replicated Blocks:        Under replicated blocks: 0        Blocks with corrupt replicas: 0        Missing blocks: 0        Missing blocks (with replication factor 1): 0        Low redundancy blocks with highest priority to recover: 0        Pending deletion blocks: 0Erasure Coded Block Groups:         Low redundancy block groups: 0        Block groups with corrupt internal blocks: 0hdfsä¸»é¡µSlave03:50070ï¼Œå¦‚æœä¸è¡Œï¼Œè¯•è¯•é»˜è®¤ç«¯å£9870hadoopä¸»é¡µSlave03:8088ä¸»è¦å‘½ä»¤å¯åŠ¨é›†ç¾¤: ./sbin/start-all.shå…³é—­é›†ç¾¤: ./sbin/stop-all.shå¸¸è§é—®é¢˜stop-all.shçš„æ—¶å€™hadoopçš„ç›¸å…³è¿›ç¨‹éƒ½æ— æ³•åœæ­¢è§£å†³æ–¹æ¡ˆ: å‚è€ƒsparkçš„å¸¸è§é—®é¢˜ï¼ŒHadoopçš„pidå‘½åè§„åˆ™ï¼š1pid=$HADOOP_PID_DIR/hadoop-$HADOOP_IDENT_STRING-$command.pidå› æ­¤ï¼Œè¿™é‡Œçš„pidæ–‡ä»¶åä¸º:hadoop-root-datanode.pidhadoop-root-namenode.pidhadoop-root-nodemanager.pidhadoop-root-resourcemanager.pidhadoop-root-secondarynamenode.pidé€šè¿‡jpsæŸ¥çœ‹ç›¸å…³è¿›ç¨‹çš„pidï¼Œæ¢å¤è¿™äº›pidæ–‡ä»¶å³å¯ä½¿ç”¨stop-all.shåœæ­¢hadoopï¼Œæ ¹æ²»æ–¹æ¡ˆå‚è€ƒsparkå¸¸è§é—®é¢˜éƒ¨åˆ†sparkå®‰è£…å®‰è£…é…ç½®ä¸‹è½½è§£å‹ï¼Œå¤åˆ¶åˆ°/usr/spark-3.0é…ç½®ç¯å¢ƒå˜é‡vi /etc/profile123# é…ç½®sparkç¯å¢ƒexport SPARK_HOME=/usr/spark-3.0export PATH=$PATH:$SPARK_HOME/binæ‰§è¡Œsource /etc/profileä»¤å…¶ç”Ÿæ•ˆé…ç½®spark-env.shå°†confæ–‡ä»¶å¤¹ä¸‹çš„spark-env.sh.templateé‡å‘½åä¸ºspark-env.shï¼Œå¹¶æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼šåœ¨sparkæ ¹ç›®å½•ä¸‹æ‰§è¡Œmkdir pidsï¼Œç”¨äºå­˜æ”¾pidæ–‡ä»¶123456789101112# ç¯å¢ƒå˜é‡export JAVA_HOME=/usr/java/jdk1.8.0_281-amd64export SCALA_HOME=/usr/share/scalaexport HADOOP_HOME=/usr/hadoop-3.2.1# è¯¦ç»†é…ç½®export HADOOP_CONF_DIR=$HADOOP_HOME/etc/hadoopexport SPARK_MASTER_HOST=Slave03export SPARK_LOCAL_DIRS=/usr/spark-3.0export SPARK_DRIVER_MEMORY=16g           # å†…å­˜export SPARK_EXECUTOR_MEMORY=8g          # æ‰§è¡Œå†…å­˜export SPARK_WORKER_CORES=4              # cpuæ ¸å¿ƒæ•°export SPARK_PID_DIR=/usr/spark-3.0/pids # pidæ–‡ä»¶æ ¹ç›®å½•ï¼Œä¸è®¾ç½®çš„é»˜è®¤å€¼ä¸º/tmpï¼Œä¸€æ®µæ—¶é—´å/tmpä¸‹çš„æ–‡ä»¶ä¼šè¢«æ¸…é™¤ï¼Œå¯¼è‡´æ— æ³•å…³é—­sparké›†ç¾¤é…ç½®slaveså°†confæ–‡ä»¶å¤¹ä¸‹çš„slaves.templateé‡å‘½åä¸ºslavesï¼Œå¹¶æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š123Slave00Slave02Slave03  # ä¸»èŠ‚ç‚¹é…ç½®ä»èŠ‚ç‚¹(å°†sparkç›®å½•å¤åˆ¶åˆ°å…¶ä»–èŠ‚ç‚¹çš„åŒä¸€ä¸ªç›®å½•ä¸‹)1scp -r root@192.168.123.24:/usr/spark-3.0 /usr/åœ¨sbinç›®å½•ä¸‹ä½¿ç”¨start-all.shå¯åŠ¨é›†ç¾¤å¯åŠ¨æˆåŠŸåï¼Œæˆ‘ä»¬åœ¨æµè§ˆå™¨è¾“å…¥Slave03:8080çœ‹åˆ°æœ‰ä¸‰ä¸ªç»“ç‚¹ï¼Œå°±ä»£è¡¨æˆ‘ä»¬å®‰è£…æˆåŠŸäº†ã€‚å¦‚æœå‘ç°å¯åŠ¨é”™è¯¯ï¼Œè¯·æŸ¥çœ‹logsç›®å½•ä¸‹çš„æ—¥å¿—ï¼Œè‡ªè¡Œæ£€æŸ¥é…ç½®æ–‡ä»¶ï¼æ—¥å¿—é…ç½®é…ç½®sparkçš„æ‰§è¡Œæ—¥å¿—ç­‰çº§ï¼Œè¿›å…¥åˆ°sparkæ ¹ç›®å½•ä¸‹çš„confç›®å½•cp log4j.properties.template log4j.propertiesï¼Œä¿®æ”¹é…ç½®å¦‚ä¸‹1234567891011121314151617181920212223242526# Set everything to be logged to the consolelog4j.rootCategory=WARN, consolelog4j.appender.console=org.apache.log4j.ConsoleAppenderlog4j.appender.console.target=System.errlog4j.appender.console.layout=org.apache.log4j.PatternLayoutlog4j.appender.console.layout.ConversionPattern=%d{yy/MM/dd HH:mm:ss} %p %c{1}: %m%n# Set the default spark-shell log level to WARN. When running the spark-shell, the# log level for this class is used to overwrite the root logger's log level, so that# the user can have different defaults for the shell and regular Spark apps.log4j.logger.org.apache.spark.repl.Main=WARN# Settings to quiet third party logs that are too verboselog4j.logger.org.sparkproject.jetty=WARNlog4j.logger.org.sparkproject.jetty.util.component.AbstractLifeCycle=ERRORlog4j.logger.org.apache.spark.repl.SparkIMain$exprTyper=INFOlog4j.logger.org.apache.spark.repl.SparkILoop$SparkILoopInterpreter=INFOlog4j.logger.org.apache.parquet=ERRORlog4j.logger.parquet=ERROR# SPARK-9183: Settings to avoid annoying messages when looking up nonexistent UDFs in SparkSQL with Hive supportlog4j.logger.org.apache.hadoop.hive.metastore.RetryingHMSHandler=FATALlog4j.logger.org.apache.hadoop.hive.ql.exec.FunctionRegistry=ERROR# å…³é—­è­¦å‘Š# WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicablelog4j.logger.org.apache.hadoop.util.NativeCodeLoader=ERRORä¸»è¦å‘½ä»¤å¯åŠ¨é›†ç¾¤: ./sbin/start-all.shå…³é—­é›†ç¾¤: ./sbin/stop-all.shå¸¸è§é—®é¢˜stop-all.shçš„æ—¶å€™sparkçš„ç›¸å…³è¿›ç¨‹éƒ½æ— æ³•åœæ­¢$SPARK_PID_DIRä¸­å­˜æ”¾çš„æ˜¯pidæ–‡ä»¶ï¼Œå°±æ˜¯è¦åœæ­¢è¿›ç¨‹çš„pidã€‚å…¶ä¸­$SPARK_PID_DIRé»˜è®¤æ˜¯åœ¨ç³»ç»Ÿçš„/tmpç›®å½•ç³»ç»Ÿæ¯éš”ä¸€æ®µæ—¶é—´å°±ä¼šæ¸…é™¤/tmpç›®å½•ä¸‹çš„å†…å®¹ã€‚åˆ°/tmpä¸‹æŸ¥çœ‹ä¸€ä¸‹ï¼Œæœç„¶æ²¡æœ‰ç›¸å…³è¿›ç¨‹çš„pidæ–‡ä»¶äº†ã€‚è¿™æ‰å¯¼è‡´äº†stop-all.shæ— æ³•åœæ­¢é›†ç¾¤ã€‚è§£å†³æ–¹æ¡ˆ: $SPARK_PID_DIRä¸‹æ–°å»ºpidæ–‡ä»¶ï¼Œpidæ–‡ä»¶å‘½åè§„åˆ™å¦‚ä¸‹1$SPARK_PID_DIR/spark-$SPARK_IDENT_STRING-$command-$instance.pid$SPARK_PID_DIRé»˜è®¤æ˜¯/tmp$SPARK_IDENT_STRINGæ˜¯ç™»å½•ç”¨æˆ·$USERï¼Œæˆ‘çš„é›†ç¾¤ä¸­ç”¨æˆ·åæ˜¯root$commandæ˜¯è°ƒç”¨spark-daemon.shæ—¶çš„å‚æ•°ï¼Œæœ‰ä¸¤ä¸ªï¼šorg.apache.spark.deploy.master.Masterorg.apache.spark.deploy.worker.Worker$instanceä¹Ÿæ˜¯è°ƒç”¨spark-daemon.shæ—¶çš„å‚æ•°ï¼Œæˆ‘çš„é›†ç¾¤ä¸­æ˜¯1å› æ­¤pidæ–‡ä»¶åå¦‚ä¸‹(åå­—ä¸å¯¹çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥æ‰§è¡Œ./start-all.shï¼Œé‡æ–°å¯åŠ¨æŸ¥çœ‹åï¼Œå†æ‰§è¡Œ./stop-all.shè¿›è¡Œæœ¬æ¬¡é›†ç¾¤çš„å…³é—­ï¼Œæ³¨æ„è¿™é‡Œå…³é—­çš„æ˜¯æœ¬æ¬¡æ‰“å¼€çš„ï¼Œä¹‹å‰æ— æ³•å…³é—­çš„è¿›ç¨‹ä»ç„¶è¿˜åœ¨)ï¼šspark-root-org.apache.spark.deploy.master.Master-1.pidspark-root-org.apache.spark.deploy.worker.Worker-1.pidé€šè¿‡jpsæŸ¥çœ‹ç›¸å…³è¿›ç¨‹çš„pidï¼Œå°†pidä¿å­˜åˆ°å¯¹åº”çš„pidæ–‡ä»¶å³å¯ï¼Œä¹‹åè°ƒç”¨sparkçš„stop-all.shï¼Œå³å¯æ­£å¸¸åœæ­¢sparké›†ç¾¤è¦æ ¹æ²»è¿™ä¸ªé—®é¢˜ï¼Œåªéœ€è¦åœ¨é›†ç¾¤æ‰€æœ‰èŠ‚ç‚¹éƒ½è®¾ç½®$SPARK_PID_DIRï¼Œ$HADOOP_PID_DIRå’Œ$YARN_PID_DIRå³å¯123456# ä¿®æ”¹hadoop-env.shï¼Œå¢åŠ ï¼šexport HADOOP_PID_DIR=/home/ap/cdahdp/app/pids# ä¿®æ”¹yarn-env.shï¼Œå¢åŠ ï¼šexport YARN_PID_DIR=/home/ap/cdahdp/app/pids# ä¿®æ”¹spark-env.shï¼Œå¢åŠ ï¼šexport SPARK_PID_DIR=/home/ap/cdahdp/app/pidspysparkç¯å¢ƒé…ç½®åŸºç¡€ç¯å¢ƒsparké›†ç¾¤æœåŠ¡å™¨é…ç½®ç¯å¢ƒå˜é‡ï¼Œvi /etc/profile12export PYSPARK_PYTHON=/root/anaconda3/envs/ray37/bin/python3.7export PYSPARK_DRIVER_PYTHON=/root/anaconda3/envs/ray37/bin/python3.7æ‰§è¡Œsource /etc/profileä½¿å…¶ç”Ÿæ•ˆå®‰è£…pysparkåº“1234# è¿™é‡Œéœ€è¦æ³¨æ„ç‰ˆæœ¬éœ€è¦å’Œsparkçš„ç‰ˆæœ¬ä¸€è‡´pip install pyspark==3.0.3# åœ¨å®‰è£…pysparkæ—¶é»˜è®¤ä¼šè£…ä¸Šå¯¹åº”çš„py4jï¼Œå¦‚æœæ²¡æœ‰çš„è¯ï¼Œæ‰‹åŠ¨å®‰è£…ä¸‹pip install py4j==0.10.9å¯¹äºsparkæœåŠ¡å™¨å’Œworké—´ç¯å¢ƒä¸ä¸€è‡´çš„æƒ…å†µæ–¹å¼ä¸€: é‡æ–°å®‰è£…pythonè™šæ‹Ÿç¯å¢ƒï¼Œä½¿å¾—è·¯å¾„å®Œå…¨ä¸€è‡´æ–¹å¼äºŒ: é…ç½®è½¯é“¾æ¥123ln -s æºæ–‡ä»¶ ç›®æ ‡æ–‡ä»¶# éœ€è¦äº‹å…ˆå»ºå¥½è·¯å¾„ln -s /opt/anaconda/install/envs/ray37/bin/python3.7 /root/anaconda3/envs/ray37/bin/python3.7åœ¨æœåŠ¡å™¨ liunx ç¯å¢ƒä¸Šä¿®æ”¹æŸ¥çœ‹pythonçš„åŒ…è·¯å¾„site-package12from distutils.sysconfig import get_python_libprint(get_python_lib())graphxç¯å¢ƒå®‰è£…graphframes1pip install graphframes==0.6å»graphframeså®˜ç½‘ä¸‹è½½å¯¹åº”jaråŒ…ï¼Œè¿™é‡Œsparké›†ç¾¤æ˜¯3.0.3ï¼Œæ‰€ä»¥å¯ä»¥ä¸‹è½½Version: 0.8.2-spark3.0-s_2.12è¿™ä¸ªç‰ˆæœ¬çš„å¤åˆ¶åˆ°sparkæ ¹ç›®å½•ä¸‹çš„jarsç›®å½•ä¸­ï¼Œé›†ç¾¤ä¸­æ¯ä¸ªèŠ‚ç‚¹éƒ½éœ€è¦å¦‚æœè¿˜ä¼šå‡ºé”™ï¼Œå¯ä»¥æŠŠè¯¥jaråŒ…ä¹Ÿå¤åˆ¶ä¸€ä»½åˆ°pythonç¯å¢ƒä¸‹/opt/anaconda/install/envs/ray37/lib/python3.7/site-packages/pyspark/jarsé…ç½®è¿œç¨‹è§£é‡Šå™¨åœ¨PyCharmä¸­ï¼Œå¯ä»¥ä½¿ç”¨è¿œç¨‹é…ç½®è§£é‡Šå™¨å’Œé¡¹ç›®åŠŸèƒ½æ¥è¿›è¡Œè¿œç¨‹å¼€å‘ã€‚è¿™ä½¿æ‚¨å¯ä»¥åœ¨æœ¬åœ°ä½¿ç”¨PyCharmç¼–å†™ä»£ç ï¼Œå¹¶å°†ä»£ç éƒ¨ç½²å’Œè¿è¡Œåœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šã€‚ä¸‹é¢æ˜¯å¯¹è¿œç¨‹é…ç½®è§£é‡Šå™¨å’Œé¡¹ç›®çš„è§£é‡Šï¼šè¿œç¨‹é…ç½®è§£é‡Šå™¨ï¼šè¿œç¨‹é…ç½®è§£é‡Šå™¨æ˜¯æŒ‡åœ¨PyCharmä¸­è®¾ç½®å’Œä½¿ç”¨ä½äºè¿œç¨‹æœåŠ¡å™¨ä¸Šçš„è§£é‡Šå™¨ã€‚è¿™æ ·ï¼Œæ‚¨å¯ä»¥åœ¨æœ¬åœ°çš„PyCharmä¸­ç¼–å†™ä»£ç ï¼Œå¹¶ä½¿ç”¨è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„Pythonè§£é‡Šå™¨æ¥è¿è¡Œå’Œè°ƒè¯•ä»£ç ã€‚é€šè¿‡è¿œç¨‹é…ç½®è§£é‡Šå™¨ï¼Œæ‚¨å¯ä»¥åˆ©ç”¨æœåŠ¡å™¨ä¸Šçš„è®¡ç®—èµ„æºå’Œç¯å¢ƒæ¥å¼€å‘å’Œæµ‹è¯•ä»£ç è¿œç¨‹é…ç½®é¡¹ç›®ï¼šè¿œç¨‹é…ç½®é¡¹ç›®æ˜¯æŒ‡å°†æ•´ä¸ªé¡¹ç›®ä¸è¿œç¨‹æœåŠ¡å™¨ç›¸å…³è”ï¼Œä»¥ä¾¿åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šè¿è¡Œå’Œç®¡ç†é¡¹ç›®ã€‚é€šè¿‡è¿œç¨‹é…ç½®é¡¹ç›®ï¼Œæ‚¨å¯ä»¥åœ¨æœ¬åœ°çš„PyCharmä¸­ç¼–è¾‘ä»£ç ï¼Œå¹¶å°†æ›´æ”¹åŒæ­¥åˆ°è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„é¡¹ç›®ç›®å½•ã€‚æ‚¨å¯ä»¥ä½¿ç”¨è¿œç¨‹é…ç½®é¡¹ç›®æ¥è®¿é—®å’Œç®¡ç†è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ã€åº“å’Œå…¶ä»–èµ„æºé…ç½®è¿œç¨‹è¿æ¥é…ç½®è¿æ¥çš„è¿œç¨‹æœåŠ¡å™¨æœ¬åœ°å…ˆæ–°å»ºæ–‡ä»¶å¤¹ï¼Œç”¨äºå­˜æ”¾è¿œç¨‹é¡¹ç›®ï¼Œæ–°å»ºå®Œç”¨pycharmæ‰“å¼€é¡¹ç›®æ‰“å¼€Pycharm -&gt; Tools -&gt; Deployment -&gt; Configurationï¼Œç‚¹å‡»åŠ å·ï¼Œé€‰æ‹©SFTPï¼Œç»™æœåŠ¡å™¨å–ä¸€ä¸ªåå­—ç‚¹å‡»SSH configurationåé¢çš„çœç•¥å·è¾“å…¥æœåŠ¡å™¨IPåœ°å€å’Œè´¦å·å¯†ç ï¼Œç»“æŸåæµ‹è¯•ä¸€ä¸‹è¿æ¥æƒ…å†µConnection Parametersä¸‹çš„å¿ƒè·³å¯ä»¥è®¾ç½®10ç§’ç¡®è®¤åï¼Œä¿å­˜é€€å‡ºå½“å‰çª—å£Connectioné€‰é¡¹å¡ç‚¹å‡»è‡ªåŠ¨æ£€æµ‹ï¼Œè·å–è¿œç¨‹æœåŠ¡å™¨çš„å·¥ä½œè·¯å¾„Mappingsé€‰é¡¹å¡çš„Local pathé€‰æ‹©ä¸€å¼€å§‹æ–°å»ºçš„æ–‡ä»¶å¤¹ï¼ŒDeployment pathé€‰æ‹©è¿œç¨‹é¡¹ç›®çš„è·¯å¾„ï¼Œè¿™é‡Œä¸ºäº†é¿å…ä¸å¿…è¦çš„éº»çƒ¦ï¼Œè¿œç¨‹é¡¹ç›®æœ€å¥½èµ‹äºˆ777æƒé™ä¿å­˜ï¼Œé€€å‡ºå³é”®é¡¹ç›®åç§°ï¼Œé€‰æ‹©Deploymentä¸‹çš„Download from â€¦ï¼Œæ­¤æ—¶ä¼šå°†æœåŠ¡å™¨ä¸Šçš„é¡¹ç›®åŒæ­¥åˆ°æœ¬åœ°é…ç½®è§£é‡Šå™¨é€‰æ‹©è¿œç¨‹çš„è§£é‡Šå™¨ç‚¹å‡»moveå³å¯nexté…ç½®è·¯å¾„ï¼Œè¿œç¨‹çš„é€‰æ‹©è‡ªå·±ä¹‹å‰æ–°å»ºçš„/home/huangyc/hyc_testAutomatically upload ...è¡¨ç¤ºä¼šè‡ªåŠ¨ä¸Šä¼ é¡¹ç›®åˆ°æœåŠ¡å™¨ä¸­å…¶å®ƒåŠŸèƒ½åœ¨Pycharmä¸Šæ˜¾ç¤ºè¿œç¨‹ä»£ç ï¼šé€‰æ‹©Tools --&gt;Deployment--&gt;Browse Remote Hostæ›´æ–°ä»£ç ï¼šå°†æœ¬åœ°ä»£ç ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸ŠTools --&gt;Deployment--&gt;upload toæœåŠ¡å™¨ä¸Šä»£ç ä¸‹è½½åˆ°æœ¬åœ°ä»£ç ä¸ŠTools --&gt;Deployment--&gt;Download fromï¼Œå¦‚æœæ— æ•ˆï¼Œå°±å³å‡»é¡¹ç›®ä¸‹çš„Deploymentæµ‹è¯•ä¾‹å­ç®€å•è¯ç»Ÿè®¡ + pagerankä¾‹å­123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133#!/usr/bin/env Python# -- coding: utf-8 --&quot;&quot;&quot;@version: v1.0@author: huangyc@file: connenct_test.py@Description: @time: 2022/1/25 14:49&quot;&quot;&quot;import osimport platformimport tracebackfrom typing import Listfrom graphframes import *from pyspark import SparkConffrom pyspark.sql import SparkSessionfrom pyspark.sql import functions as Fpy_root = &quot;/root/anaconda3/envs/ray37/bin/python3.7&quot;os.environ[&quot;PYSPARK_PYTHON&quot;] = py_rootos.environ[&quot;PYSPARK_DRIVER_PYTHON&quot;] = py_rootis_local_py: bool = Trueif is_local_py and platform.system().lower() == 'windows':    os.environ['JAVA_HOME'] = 'G:\Java\jdk1.8.0_201'    os.environ[&quot;SPARK_HOME&quot;] = r&quot;E:\PycharmWS\remote_spark\spark-3.0&quot;class PySparkClient:    def __init__(self, appname: str, master: str):        conf = SparkConf().setAppName(appname).setMaster(master)  # sparkèµ„æºé…ç½®        conf.set(&quot;spark.driver.maxResultSize&quot;, &quot;4g&quot;)        conf.set(&quot;spark.executor.num&quot;, &quot;4&quot;)        conf.set(&quot;spark.executor.memory&quot;, &quot;2g&quot;)        conf.set(&quot;spark.executor.cores&quot;, &quot;4&quot;)        conf.set(&quot;spark.cores.max&quot;, &quot;16&quot;)        conf.set(&quot;spark.driver.memory&quot;, &quot;2g&quot;)        try:            self.spark = SparkSession.builder.config(conf=conf).getOrCreate()            self.sc = self.spark.sparkContext        except:            traceback.print_exc()  # è¿”å›å‡ºé”™ä¿¡æ¯    def word_count(self, log_file: str):        if not self.sc:            return        log_data = self.sc.textFile(log_file).cache()        words_rdd = log_data.flatMap(lambda sentence: sentence.split(&quot; &quot;))        res = words_rdd.countByValue()        res_rdd = words_rdd.filter(lambda k: len(k) &gt; 0).map(lambda word: (word, 1)).reduceByKey(lambda a, b: a + b)        # å°†rddè½¬ä¸ºcollectionå¹¶æ‰“å°        res_rdd_coll = res_rdd.takeOrdered(5, lambda x: -x[1])        for line in res_rdd_coll:            print(line)    def simple_test(self, words: List[str]):        if not self.sc:            return        counts = self.sc.parallelize(words).count()        print(&quot;Number of elements in RDD is %i&quot; % counts)        test = self.spark.createDataFrame(            [('001', '1', 100, 87, 67, 83, 98), ('002', '2', 87, 81, 90, 83, 83), ('003', '3', 86, 91, 83, 89, 63),             ('004', '2', 65, 87, 94, 73, 88), ('005', '1', 76, 62, 89, 81, 98), ('006', '3', 84, 82, 85, 73, 99),             ('007', '3', 56, 76, 63, 72, 87), ('008', '1', 55, 62, 46, 78, 71), ('009', '2', 63, 72, 87, 98, 64)],            ['number', 'class', 'language', 'math', 'english', 'physic', 'chemical'])        test.show()        test.printSchema()        test.select('number', 'class', 'language', 'math', 'english').describe().show()        print(&quot;============   simple_test over   ============&quot;)    def simple_graph(self):        # Create a Vertex DataFrame with unique ID column &quot;id&quot;        spk = self.spark        v = spk.createDataFrame([            (&quot;a&quot;, &quot;Alice&quot;, 34),            (&quot;b&quot;, &quot;Bob&quot;, 36),            (&quot;c&quot;, &quot;Charlie&quot;, 30),        ], [&quot;id&quot;, &quot;name&quot;, &quot;age&quot;])        # Create an Edge DataFrame with &quot;src&quot; and &quot;dst&quot; columns        e = spk.createDataFrame([            (&quot;a&quot;, &quot;b&quot;, &quot;friend&quot;),            (&quot;b&quot;, &quot;c&quot;, &quot;follow&quot;),            (&quot;c&quot;, &quot;b&quot;, &quot;follow&quot;),        ], [&quot;src&quot;, &quot;dst&quot;, &quot;relationship&quot;])        # Create a GraphFrame        g = GraphFrame(v, e)        # Query: Get in-degree of each vertex.        g.inDegrees.show()        # Query: Count the number of &quot;follow&quot; connections in the graph.        print(g.edges.filter(&quot;relationship = 'follow'&quot;).count())        # Run PageRank algorithm, and show results.        results = g.pageRank(resetProbability=0.1, maxIter=1)        res = results.vertices.select(&quot;id&quot;, F.bround(&quot;pagerank&quot;, scale=4).alias('pagerank'))        res.orderBy(res.pagerank.desc()).show(5)    def stop(self):        try:            self.sc.stop()        except:            passif __name__ == '__main__':    appname = &quot;test_hyc00&quot;  # ä»»åŠ¡åç§°    master = &quot;spark://192.168.xx.xx:7077&quot;  # å•æœºæ¨¡å¼è®¾ç½®    # master = &quot;local&quot;    py_spark_client = PySparkClient(appname=appname, master=master)    # ç®€å•åŠŸèƒ½æµ‹è¯•    all_words = [&quot;scala&quot;, &quot;java&quot;, &quot;hadoop&quot;, &quot;spark&quot;, &quot;akka&quot;, &quot;spark vs hadoop&quot;,                 &quot;akka&quot;, &quot;spark vs hadoop&quot;, &quot;pyspark&quot;, &quot;pyspark and spark&quot;]    py_spark_client.simple_test(words=all_words)    # æ–‡æ¡£è¯é¢‘ç»Ÿè®¡    logFile = r&quot;hdfs://192.168.xx.xx:9000/test_data/README.md&quot;    py_spark_client.word_count(log_file=logFile)    py_spark_client.simple_graph()    # å…³é—­å®¢æˆ·ç«¯è¿æ¥    py_spark_client.stop()æ‰§è¡Œæ–¹æ³•å¯ä»¥ç›´æ¥åœ¨pycharmä¸­æ‰§è¡Œï¼Œè¿™é‡Œpycharmä½¿ç”¨çš„æ˜¯è¿œç¨‹çš„pythonç¯å¢ƒï¼Œè¿™é‡Œæ‰§è¡Œæ—¶çš„å†…å­˜æ˜¯é»˜è®¤å€¼ 1024.0 MiBåœ¨pycharmä¸­æ‰§è¡Œå¯èƒ½éœ€è¦åŠ ä¸Šå˜é‡è®¾ç½®ï¼Œä½†ä½¿ç”¨spark-submitåˆ™å¯ä»¥ä¸éœ€è¦12os.environ[&quot;PYSPARK_PYTHON&quot;] = &quot;/root/anaconda3/envs/ray37/bin/python3.7&quot;os.environ[&quot;PYSPARK_DRIVER_PYTHON&quot;] = &quot;/root/anaconda3/envs/ray37/bin/python3.7&quot;æˆ–è€…æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ‰§è¡Œï¼Œè¿™é‡Œæ‰§è¡Œæ—¶çš„å†…å­˜æ˜¯sparkä¸­é…ç½®çš„ 8.0 GiB1./bin/spark-submit  --master spark://192.168.xx.xx:7077 /home/huangyc/hyc_test/tests/pyspark_test/connenct_test.pyæœ¬åœ°è¿æ¥é™¤äº†é…ç½®è¿œç¨‹æœåŠ¡å™¨çš„pyè§£é‡Šå™¨ï¼Œè¿˜å¯ä»¥é…ç½®æœ¬åœ°çš„æ¨¡å¼éœ€è¦åœ¨sparké›†ç¾¤ä¸­é…ç½®hostæ˜ å°„ï¼Œé€šè¿‡vi /etc/hostså‘½ä»¤æ‰“å¼€hostsæ–‡ä»¶ï¼Œæ·»åŠ æœ¬åœ°çš„ä¸»æœºåæ˜ å°„12# hyc10.10.0.xx DSE-20191111ZOUæœ€åæ‰§è¡Œ/etc/init.d/network restartåˆ·æ–°DNSå¦‚æœæ²¡æœ‰çš„è¯ï¼Œå¯èƒ½ä¼šæŠ¥é”™è¯¯Caused by: java.io.IOException: Failed to connect to DSE-20191111ZOU:65320Caused by: java.net.UnknownHostException: DSE-20191111ZOUpyä»£ç ä¸­éœ€è¦æ·»åŠ ä»¥ä¸‹çš„ç¯å¢ƒå‚æ•°æ‰èƒ½è¿æ¥ä¸Šsparké›†ç¾¤123456789101112131415161718192021222324252627import os# é…ç½®é›†ç¾¤çš„pythonç¯å¢ƒè·¯å¾„py_root = &quot;/root/anaconda3/envs/ray37/bin/python3.7&quot;os.environ[&quot;PYSPARK_PYTHON&quot;] = py_rootos.environ[&quot;PYSPARK_DRIVER_PYTHON&quot;] = py_root# é…ç½®æœ¬åœ°Jdkè·¯å¾„ï¼Œç‰ˆæœ¬å°½é‡å’Œsparké›†ç¾¤çš„ä¸€è‡´os.environ['JAVA_HOME'] = 'G:\Java\jdk1.8.0_201'# é…ç½®æœ¬åœ°çš„sparkè·¯å¾„ï¼Œè¿™é‡Œç›´æ¥ä»sparké›†ç¾¤copyä¸€ä»½ä¸‹è½½å³å¯os.environ[&quot;SPARK_HOME&quot;] = r&quot;E:\PycharmWS\remote_spark\spark-3.0&quot;class PySparkClient:    def __init__(self, appname: str, master: str):        conf = SparkConf().setAppName(appname).setMaster(master)  # sparkèµ„æºé…ç½®        # ä»¥ä¸‹çš„å‚æ•°ä¸ç”¨å…¨éƒ¨é…ç½®ï¼Œçœ‹è‡ªå·±çš„éœ€æ±‚        conf.set(&quot;spark.driver.maxResultSize&quot;, &quot;4g&quot;)        conf.set(&quot;spark.executor.num&quot;, &quot;4&quot;)        conf.set(&quot;spark.executor.memory&quot;, &quot;2g&quot;)        conf.set(&quot;spark.executor.cores&quot;, &quot;4&quot;)        conf.set(&quot;spark.cores.max&quot;, &quot;16&quot;)        conf.set(&quot;spark.driver.memory&quot;, &quot;2g&quot;)        try:            self.spark = SparkSession.builder.config(conf=conf).getOrCreate()            self.sc = self.spark.sparkContext        except:            traceback.print_exc()  # è¿”å›å‡ºé”™ä¿¡æ¯âš¡: æœ¬åœ°çš„pythonç‰ˆæœ¬å°½é‡å’Œsparké›†ç¾¤ä¸Šçš„ä¸€è‡´ï¼Œé¿å…ä¸å¿…è¦çš„é”™è¯¯å¸¸è§é—®é¢˜</content>
	</entry>
	<entry>
		<title>Springæ³¨è§£_ä»‹ç»</title>
		<url>/article/7819d42.html</url>
		<content>Javaä¸­çš„æ³¨è§£åˆ°åº•æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼ŸJavaä¸­çš„æ³¨è§£åˆ°åº•æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼ŸJava å¿…é¡»æŒæ¡çš„ 12 ç§ Spring å¸¸ç”¨æ³¨è§£ï¼javaä¸­çš„æ³¨è§£ï¼ŒçœŸçš„å¾ˆé‡è¦ï¼Œä½ ç†è§£äº†å˜›è‡ªJava5.0ç‰ˆæœ¬å¼•å…¥æ³¨è§£ä¹‹åï¼Œå®ƒå°±æˆä¸ºäº†Javaå¹³å°ä¸­éå¸¸é‡è¦çš„ä¸€éƒ¨åˆ†ã€‚å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿæ—¶å¸¸åœ¨åº”ç”¨ä»£ç ä¸­ä¼šçœ‹åˆ°è¯¸å¦‚@Overrideï¼Œ@Deprecatedè¿™æ ·çš„æ³¨è§£ã€‚è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†å‘å¤§å®¶è®²è¿°åˆ°åº•ä»€ä¹ˆæ˜¯æ³¨è§£ï¼Œä¸ºä»€ä¹ˆè¦å¼•å…¥æ³¨è§£ï¼Œæ³¨è§£æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œå¦‚ä½•ç¼–å†™è‡ªå®šä¹‰çš„æ³¨è§£(é€šè¿‡ä¾‹å­)ï¼Œä»€ä¹ˆæƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨æ³¨è§£ä»¥åŠæœ€æ–°æ³¨è§£å’ŒADF(åº”ç”¨å¼€å‘æ¡†æ¶)ã€‚è¿™ä¼šèŠ±ç‚¹å„¿æ—¶é—´ï¼Œæ‰€ä»¥ä¸ºè‡ªå·±å‡†å¤‡ä¸€æ¯å’–å•¡ï¼Œè®©æˆ‘ä»¬æ¥è¿›å…¥æ³¨è§£çš„ä¸–ç•Œå§ã€‚ https://www.zhihu.com/question/64671972 Springå’ŒSpringBootæ¯”è¾ƒï¼Œè§£æƒ‘åŒºåˆ«ç”¨Spring Booté¢ è¦†Javaåº”ç”¨å¼€å‘ä»€ä¹ˆæ˜¯æ³¨è§£ï¼Ÿç”¨ä¸€ä¸ªè¯å°±å¯ä»¥æè¿°æ³¨è§£ï¼Œé‚£å°±æ˜¯å…ƒæ•°æ®ï¼Œå³ä¸€ç§æè¿°æ•°æ®çš„æ•°æ®ã€‚æ‰€ä»¥ï¼Œå¯ä»¥è¯´æ³¨è§£å°±æ˜¯æºä»£ç çš„å…ƒæ•°æ®ã€‚æ¯”å¦‚ï¼Œä¸‹é¢è¿™æ®µä»£ç ï¼š1234@Overridepublic String toString() {    return &quot;This is String Representation of current object.&quot;;}ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘é‡å†™äº†toString()æ–¹æ³•å¹¶ä½¿ç”¨äº†@Overrideæ³¨è§£ã€‚ä½†æ˜¯ï¼Œå³ä½¿æˆ‘ä¸ä½¿ç”¨@Overrideæ³¨è§£æ ‡è®°ä»£ç ï¼Œç¨‹åºä¹Ÿèƒ½å¤Ÿæ­£å¸¸æ‰§è¡Œã€‚é‚£ä¹ˆï¼Œè¯¥æ³¨è§£è¡¨ç¤ºä»€ä¹ˆï¼Ÿè¿™ä¹ˆå†™æœ‰ä»€ä¹ˆå¥½å¤„å—ï¼Ÿäº‹å®ä¸Šï¼Œ@Overrideå‘Šè¯‰ç¼–è¯‘å™¨è¿™ä¸ªæ–¹æ³•æ˜¯ä¸€ä¸ªé‡å†™æ–¹æ³•(æè¿°æ–¹æ³•çš„å…ƒæ•°æ®)ï¼Œå¦‚æœçˆ¶ç±»ä¸­ä¸å­˜åœ¨è¯¥æ–¹æ³•ï¼Œç¼–è¯‘å™¨ä¾¿ä¼šæŠ¥é”™ï¼Œæç¤ºè¯¥æ–¹æ³•æ²¡æœ‰é‡å†™çˆ¶ç±»ä¸­çš„æ–¹æ³•ã€‚å¦‚æœæˆ‘ä¸å°å¿ƒæ‹¼å†™é”™è¯¯ï¼Œä¾‹å¦‚å°†toString()å†™æˆäº†toStrring(){double r}ï¼Œè€Œä¸”æˆ‘ä¹Ÿæ²¡æœ‰ä½¿ç”¨@Overrideæ³¨è§£ï¼Œé‚£ç¨‹åºä¾ç„¶èƒ½ç¼–è¯‘è¿è¡Œã€‚ä½†è¿è¡Œç»“æœä¼šå’Œæˆ‘æœŸæœ›çš„å¤§ä¸ç›¸åŒã€‚ç°åœ¨æˆ‘ä»¬äº†è§£äº†ä»€ä¹ˆæ˜¯æ³¨è§£ï¼Œå¹¶ä¸”ä½¿ç”¨æ³¨è§£æœ‰åŠ©äºé˜…è¯»ç¨‹åºã€‚æ¨èé˜…è¯»ï¼šSpring MVCå¸¸ç”¨æ³¨è§£ï¼Œä½ ä¼šå‡ ä¸ªï¼ŸAnnotationæ˜¯ä¸€ç§åº”ç”¨äºç±»ã€æ–¹æ³•ã€å‚æ•°ã€å˜é‡ã€æ„é€ å™¨åŠåŒ…å£°æ˜ä¸­çš„ç‰¹æ®Šä¿®é¥°ç¬¦ã€‚å®ƒæ˜¯ä¸€ç§ç”±JSR-175æ ‡å‡†é€‰æ‹©ç”¨æ¥æè¿°å…ƒæ•°æ®çš„ä¸€ç§å·¥å…·ã€‚ä¸ºä»€ä¹ˆè¦å¼•å…¥æ³¨è§£ï¼Ÿä½¿ç”¨Annotationä¹‹å‰(ç”šè‡³åœ¨ä½¿ç”¨ä¹‹å)ï¼ŒXMLè¢«å¹¿æ³›çš„åº”ç”¨äºæè¿°å…ƒæ•°æ®ã€‚ä¸çŸ¥ä½•æ—¶å¼€å§‹ä¸€äº›åº”ç”¨å¼€å‘äººå‘˜å’Œæ¶æ„å¸ˆå‘ç°XMLçš„ç»´æŠ¤è¶Šæ¥è¶Šç³Ÿç³•äº†ã€‚ä»–ä»¬å¸Œæœ›ä½¿ç”¨ä¸€äº›å’Œä»£ç ç´§è€¦åˆçš„ä¸œè¥¿ï¼Œè€Œä¸æ˜¯åƒXMLé‚£æ ·å’Œä»£ç æ˜¯æ¾è€¦åˆçš„(åœ¨æŸäº›æƒ…å†µä¸‹ç”šè‡³æ˜¯å®Œå…¨åˆ†ç¦»çš„)ä»£ç æè¿°ã€‚å¦‚æœä½ åœ¨Googleä¸­æœç´¢â€œXML vs. annotationsâ€ï¼Œä¼šçœ‹åˆ°è®¸å¤šå…³äºè¿™ä¸ªé—®é¢˜çš„è¾©è®ºã€‚æœ€æœ‰è¶£çš„æ˜¯XMLé…ç½®å…¶å®å°±æ˜¯ä¸ºäº†åˆ†ç¦»ä»£ç å’Œé…ç½®è€Œå¼•å…¥çš„ã€‚ä¸Šè¿°ä¸¤ç§è§‚ç‚¹å¯èƒ½ä¼šè®©ä½ å¾ˆç–‘æƒ‘ï¼Œä¸¤è€…è§‚ç‚¹ä¼¼ä¹æ„æˆäº†ä¸€ç§å¾ªç¯ï¼Œä½†å„æœ‰åˆ©å¼Šã€‚ä¸‹é¢æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥ç†è§£è¿™ä¸¤è€…çš„åŒºåˆ«ã€‚å‡å¦‚ä½ æƒ³ä¸ºåº”ç”¨è®¾ç½®å¾ˆå¤šçš„å¸¸é‡æˆ–å‚æ•°ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼ŒXMLæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ï¼Œå› ä¸ºå®ƒä¸ä¼šåŒç‰¹å®šçš„ä»£ç ç›¸è¿ã€‚å¦‚æœä½ æƒ³æŠŠæŸä¸ªæ–¹æ³•å£°æ˜ä¸ºæœåŠ¡ï¼Œé‚£ä¹ˆä½¿ç”¨Annotationä¼šæ›´å¥½ä¸€äº›ï¼Œå› ä¸ºè¿™ç§æƒ…å†µä¸‹éœ€è¦æ³¨è§£å’Œæ–¹æ³•ç´§å¯†è€¦åˆèµ·æ¥ï¼Œå¼€å‘äººå‘˜ä¹Ÿå¿…é¡»è®¤è¯†åˆ°è¿™ç‚¹ã€‚å¦ä¸€ä¸ªå¾ˆé‡è¦çš„å› ç´ æ˜¯Annotationå®šä¹‰äº†ä¸€ç§æ ‡å‡†çš„æè¿°å…ƒæ•°æ®çš„æ–¹å¼ã€‚åœ¨è¿™ä¹‹å‰ï¼Œå¼€å‘äººå‘˜é€šå¸¸ä½¿ç”¨ä»–ä»¬è‡ªå·±çš„æ–¹å¼å®šä¹‰å…ƒæ•°æ®ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨æ ‡è®°interfacesï¼Œæ³¨é‡Šï¼Œtransientå…³é”®å­—ç­‰ç­‰ã€‚æ¯ä¸ªç¨‹åºå‘˜æŒ‰ç…§è‡ªå·±çš„æ–¹å¼å®šä¹‰å…ƒæ•°æ®ï¼Œè€Œä¸åƒAnnotationè¿™ç§æ ‡å‡†çš„æ–¹å¼ã€‚ç›®å‰ï¼Œè®¸å¤šæ¡†æ¶å°†XMLå’ŒAnnotationä¸¤ç§æ–¹å¼ç»“åˆä½¿ç”¨ï¼Œå¹³è¡¡ä¸¤è€…ä¹‹é—´çš„åˆ©å¼Šã€‚ç¼–å†™è‡ªå®šä¹‰çš„Annotationåœ¨è®²è¿°è¿™éƒ¨åˆ†ä¹‹å‰ï¼Œå»ºè®®ä½ é¦–å…ˆä¸‹è½½Annotationçš„ç¤ºä¾‹ä»£ç AnnotationsSample.zip ã€‚ä¸‹è½½ä¹‹åæ”¾åœ¨ä½ ä¹ æƒ¯ä½¿ç”¨çš„IDEä¸­ï¼Œè¿™äº›ä»£ç ä¼šå¸®åŠ©ä½ æ›´å¥½çš„ç†è§£Annotationæœºåˆ¶ã€‚æ¨èé˜…è¯»ï¼šJava å¿…é¡»æŒæ¡çš„ 12 ç§ Spring å¸¸ç”¨æ³¨è§£ï¼ç¼–å†™Annotationéå¸¸ç®€å•ï¼Œå¯ä»¥å°†Annotationçš„å®šä¹‰åŒæ¥å£çš„å®šä¹‰è¿›è¡Œæ¯”è¾ƒã€‚æˆ‘ä»¬æ¥çœ‹ä¸¤ä¸ªä¾‹å­ï¼šä¸€ä¸ªæ˜¯æ ‡å‡†çš„æ³¨è§£@Overrideï¼Œå¦ä¸€ä¸ªæ˜¯ç”¨æˆ·è‡ªå®šä¹‰æ³¨è§£@Todoã€‚1234@Target(ElementType.METHOD)@Retention(RetentionPolicy.SOURCE)   public @interface Override {}å¯¹äº@Overrideæ³¨é‡Šä½ å¯èƒ½æœ‰äº›ç–‘é—®ï¼Œå®ƒä»€ä¹ˆéƒ½æ²¡åšï¼Œé‚£å®ƒæ˜¯å¦‚ä½•æ£€æŸ¥åœ¨çˆ¶ç±»ä¸­æœ‰ä¸€ä¸ªåŒåçš„å‡½æ•°å‘¢ã€‚å½“ç„¶ï¼Œä¸è¦æƒŠè®¶ï¼Œæˆ‘æ˜¯é€—ä½ ç©çš„ã€‚@Overrideæ³¨è§£çš„å®šä¹‰ä¸ä»…ä»…åªæœ‰è¿™ä¹ˆä¸€ç‚¹ä»£ç ã€‚è¿™éƒ¨åˆ†å†…å®¹å¾ˆé‡è¦ï¼Œæˆ‘ä¸å¾—ä¸å†æ¬¡é‡å¤ï¼šAnnotationsä»…ä»…æ˜¯å…ƒæ•°æ®ï¼Œå’Œä¸šåŠ¡é€»è¾‘æ— å…³ã€‚ç†è§£èµ·æ¥æœ‰ç‚¹å›°éš¾ï¼Œä½†å°±æ˜¯è¿™æ ·ã€‚å¦‚æœAnnotationsä¸åŒ…å«ä¸šåŠ¡é€»è¾‘ï¼Œé‚£ä¹ˆå¿…é¡»æœ‰äººæ¥å®ç°è¿™äº›é€»è¾‘ã€‚å…ƒæ•°æ®çš„ç”¨æˆ·æ¥åšè¿™ä¸ªäº‹æƒ…ã€‚Annotationsä»…ä»…æä¾›å®ƒå®šä¹‰çš„å±æ€§(ç±»/æ–¹æ³•/åŒ…/åŸŸ)çš„ä¿¡æ¯ã€‚Annotationsçš„ç”¨æˆ·(åŒæ ·æ˜¯ä¸€äº›ä»£ç )æ¥è¯»å–è¿™äº›ä¿¡æ¯å¹¶å®ç°å¿…è¦çš„é€»è¾‘ã€‚å½“æˆ‘ä»¬ä½¿ç”¨Javaçš„æ ‡æ³¨Annotations(ä¾‹å¦‚@Override)æ—¶ï¼ŒJVMå°±æ˜¯ä¸€ä¸ªç”¨æˆ·ï¼Œå®ƒåœ¨å­—èŠ‚ç å±‚é¢å·¥ä½œã€‚åˆ°è¿™é‡Œï¼Œåº”ç”¨å¼€å‘äººå‘˜è¿˜ä¸èƒ½æ§åˆ¶ä¹Ÿä¸èƒ½ä½¿ç”¨è‡ªå®šä¹‰çš„æ³¨è§£ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è®²è§£ä¸€ä¸‹å¦‚ä½•ç¼–å†™è‡ªå®šä¹‰çš„Annotationsã€‚æˆ‘ä»¬æ¥é€ä¸ªè®²è¿°ç¼–å†™è‡ªå®šä¹‰Annotationsçš„è¦ç‚¹ã€‚ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œä½ çœ‹åˆ°ä¸€äº›æ³¨è§£åº”ç”¨åœ¨æ³¨è§£ä¸Šã€‚J2SE5.0ç‰ˆæœ¬åœ¨ java.lang.annotationæä¾›äº†å››ç§å…ƒæ³¨è§£ï¼Œä¸“é—¨æ³¨è§£å…¶ä»–çš„æ³¨è§£ï¼š1234@Documented  â€“ æ³¨è§£æ˜¯å¦å°†åŒ…å«åœ¨JavaDocä¸­@Retention   â€“ ä»€ä¹ˆæ—¶å€™ä½¿ç”¨è¯¥æ³¨è§£@Target?     â€“ æ³¨è§£ç”¨äºä»€ä¹ˆåœ°æ–¹@Inherited   â€“ æ˜¯å¦å…è®¸å­ç±»ç»§æ‰¿è¯¥æ³¨è§£@Documentedâ€“ä¸€ä¸ªç®€å•çš„Annotationsæ ‡è®°æ³¨è§£ï¼Œè¡¨ç¤ºæ˜¯å¦å°†æ³¨è§£ä¿¡æ¯æ·»åŠ åœ¨javaæ–‡æ¡£ä¸­ã€‚@Retentionâ€“ å®šä¹‰è¯¥æ³¨è§£çš„ç”Ÿå‘½å‘¨æœŸã€‚123RetentionPolicy.SOURCE  â€“ åœ¨ç¼–è¯‘é˜¶æ®µä¸¢å¼ƒã€‚è¿™äº›æ³¨è§£åœ¨ç¼–è¯‘ç»“æŸä¹‹åå°±ä¸å†æœ‰ä»»ä½•æ„ä¹‰ï¼Œæ‰€ä»¥å®ƒä»¬ä¸ä¼šå†™å…¥å­—èŠ‚ç ã€‚@Override, @SuppressWarningséƒ½å±äºè¿™ç±»æ³¨è§£ã€‚RetentionPolicy.CLASS   â€“ åœ¨ç±»åŠ è½½çš„æ—¶å€™ä¸¢å¼ƒã€‚åœ¨å­—èŠ‚ç æ–‡ä»¶çš„å¤„ç†ä¸­æœ‰ç”¨ã€‚æ³¨è§£é»˜è®¤ä½¿ç”¨è¿™ç§æ–¹å¼ã€‚RetentionPolicy.RUNTIME â€“ å§‹ç»ˆä¸ä¼šä¸¢å¼ƒï¼Œè¿è¡ŒæœŸä¹Ÿä¿ç•™è¯¥æ³¨è§£ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨åå°„æœºåˆ¶è¯»å–è¯¥æ³¨è§£çš„ä¿¡æ¯ã€‚æˆ‘ä»¬è‡ªå®šä¹‰çš„æ³¨è§£é€šå¸¸ä½¿ç”¨è¿™ç§æ–¹å¼ã€‚@Target â€“ è¡¨ç¤ºè¯¥æ³¨è§£ç”¨äºä»€ä¹ˆåœ°æ–¹ã€‚å¦‚æœä¸æ˜ç¡®æŒ‡å‡ºï¼Œè¯¥æ³¨è§£å¯ä»¥æ”¾åœ¨ä»»ä½•åœ°æ–¹ã€‚éœ€è¦è¯´æ˜çš„æ˜¯ï¼šå±æ€§çš„æ³¨è§£æ˜¯å…¼å®¹çš„ï¼Œå¦‚æœä½ æƒ³ç»™7ä¸ªå±æ€§éƒ½æ·»åŠ æ³¨è§£ï¼Œä»…ä»…æ’é™¤ä¸€ä¸ªå±æ€§ï¼Œé‚£ä¹ˆä½ éœ€è¦åœ¨å®šä¹‰targetåŒ…å«æ‰€æœ‰çš„å±æ€§ã€‚12345678ElementType.TYPE:ç”¨äºæè¿°ç±»ã€æ¥å£æˆ–enumå£°æ˜ElementType.FIELD:ç”¨äºæè¿°å®ä¾‹å˜é‡ElementType.METHODElementType.PARAMETERElementType.CONSTRUCTORElementType.LOCAL_VARIABLEElementType.ANNOTATION_TYPE å¦ä¸€ä¸ªæ³¨é‡ŠElementType.PACKAGE ç”¨äºè®°å½•javaæ–‡ä»¶çš„packageä¿¡æ¯@Inherited â€“ å®šä¹‰è¯¥æ³¨é‡Šå’Œå­ç±»çš„å…³ç³»é‚£ä¹ˆï¼Œæ³¨è§£çš„å†…éƒ¨åˆ°åº•æ˜¯å¦‚ä½•å®šä¹‰çš„å‘¢ï¼ŸAnnotationsåªæ”¯æŒåŸºæœ¬ç±»å‹ã€StringåŠæšä¸¾ç±»å‹ã€‚æ³¨é‡Šä¸­æ‰€æœ‰çš„å±æ€§è¢«å®šä¹‰æˆæ–¹æ³•ï¼Œå¹¶å…è®¸æä¾›é»˜è®¤å€¼ã€‚æŒ‡å®šå­ç±»å¯ä»¥ç»§æ‰¿çˆ¶ç±»çš„æ³¨è§£ï¼Œåªèƒ½æ˜¯ç±»ä¸Šçš„æ³¨è§£ï¼Œæ–¹æ³•å’Œå­—æ®µçš„æ³¨è§£ä¸èƒ½ç»§æ‰¿ã€‚å³å¦‚æœçˆ¶ç±»ä¸Šçš„æ³¨è§£æ˜¯@Inheritedä¿®é¥°çš„å°±èƒ½è¢«å­ç±»ç»§æ‰¿ã€‚123456789@Target(ElementType.METHOD)@Retention(RetentionPolicy.RUNTIME)@interface Todo {    public enum Priority {LOW, MEDIUM, HIGH}    public enum Status {STARTED, NOT_STARTED}    String author() default &quot;Yash&quot;;    Priority priority() default Priority.LOW;    Status status() default Status.NOT_STARTED;}ä¸‹é¢çš„ä¾‹å­æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ä¸Šé¢çš„æ³¨è§£ã€‚12345@Todo(priority = Todo.Priority.MEDIUM, author = &quot;Yashwant&quot;, status = Todo.Status.STARTED)public void incompleteMethod1() {       //Some business logic is written       //But itâ€™s not complete yet}å¦‚æœæ³¨è§£ä¸­åªæœ‰ä¸€ä¸ªå±æ€§ï¼Œå¯ä»¥ç›´æ¥å‘½åä¸ºâ€œvalueâ€ï¼Œä½¿ç”¨æ—¶æ— éœ€å†æ ‡æ˜å±æ€§åã€‚123456@interface Author{   String value();}@Author(&quot;Yashwant&quot;)public void someMethod() {}ä½†ç›®å‰ä¸ºæ­¢ä¸€åˆ‡çœ‹èµ·æ¥éƒ½è¿˜ä¸é”™ã€‚æˆ‘ä»¬å®šä¹‰äº†è‡ªå·±çš„æ³¨è§£å¹¶å°†å…¶åº”ç”¨åœ¨ä¸šåŠ¡é€»è¾‘çš„æ–¹æ³•ä¸Šã€‚ç°åœ¨æˆ‘ä»¬éœ€è¦å†™ä¸€ä¸ªç”¨æˆ·ç¨‹åºè°ƒç”¨æˆ‘ä»¬çš„æ³¨è§£ã€‚è¿™é‡Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨åå°„æœºåˆ¶ã€‚å¦‚æœä½ ç†Ÿæ‚‰åå°„ä»£ç ï¼Œå°±ä¼šçŸ¥é“åå°„å¯ä»¥æä¾›ç±»åã€æ–¹æ³•å’Œå®ä¾‹å˜é‡å¯¹è±¡ã€‚æ‰€æœ‰è¿™äº›å¯¹è±¡éƒ½æœ‰getAnnotation()è¿™ä¸ªæ–¹æ³•ç”¨æ¥è¿”å›æ³¨è§£ä¿¡æ¯ã€‚æˆ‘ä»¬éœ€è¦æŠŠè¿™ä¸ªå¯¹è±¡è½¬æ¢ä¸ºæˆ‘ä»¬è‡ªå®šä¹‰çš„æ³¨é‡Š(ä½¿ç”¨ instanceOf()æ£€æŸ¥ä¹‹å)ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥è°ƒç”¨è‡ªå®šä¹‰æ³¨é‡Šé‡Œé¢çš„æ–¹æ³•ã€‚çœ‹çœ‹ä»¥ä¸‹çš„å®ä¾‹ä»£ç ï¼Œä½¿ç”¨äº†ä¸Šé¢çš„æ³¨è§£:12345678910Class businessLogicClass = BusinessLogic.class;for(Method method : businessLogicClass.getMethods()) {ã€€ã€€Todo todoAnnotation = (Todo)method.getAnnotation(Todo.class);ã€€ã€€if(todoAnnotation != null) {ã€€ã€€ã€€ã€€System.out.println(&quot; Method Name : &quot; + method.getName());ã€€ã€€ã€€ã€€System.out.println(&quot; Author : &quot; + todoAnnotation.author());ã€€ã€€ã€€ã€€System.out.println(&quot; Priority : &quot; + todoAnnotation.priority());ã€€ã€€ã€€ã€€System.out.println(&quot; Status : &quot; + todoAnnotation.status());ã€€ã€€}}jdk1.8åˆæä¾›äº†ä»¥ä¸‹ä¸¤ä¸ªå…ƒæ³¨è§£@NativeæŒ‡å®šå­—æ®µæ˜¯ä¸€ä¸ªå¸¸é‡ï¼Œå…¶å€¼å¼•ç”¨native codeã€‚@Repeatableæ³¨è§£ä¸Šå¯ä»¥ä½¿ç”¨é‡å¤æ³¨è§£ï¼Œå³å¯ä»¥åœ¨ä¸€ä¸ªåœ°æ–¹å¯ä»¥é‡å¤ä½¿ç”¨åŒä¸€ä¸ªæ³¨è§£ï¼Œåƒspringä¸­çš„åŒ…æ‰«ææ³¨è§£å°±ä½¿ç”¨äº†è¿™ä¸ªã€‚æ‰€æœ‰å…ƒæ³¨è§£å®šä¹‰åœ¨java.lang.annotationåŒ…ä¸‹é¢ï¼Œå…¶ä¸­Annotationæ˜¯æ³¨è§£çš„åŸºæœ¬æ¥å£ï¼Œæ‰€æœ‰çš„æ³¨è§£éƒ½ç»§æ‰¿è¿™ä¸ªæ¥å£è‡ªå®šä¹‰æ³¨è§£ï¼šã€€ã€€ä½¿ç”¨@interfaceè‡ªå®šä¹‰æ³¨è§£æ—¶ï¼Œè‡ªåŠ¨ç»§æ‰¿äº†java.lang.annotation.Annotationæ¥å£ï¼Œç”±ç¼–è¯‘ç¨‹åºè‡ªåŠ¨å®Œæˆå…¶ä»–ç»†èŠ‚ã€‚åœ¨å®šä¹‰æ³¨è§£æ—¶ï¼Œä¸èƒ½ç»§æ‰¿å…¶ä»–çš„æ³¨è§£æˆ–æ¥å£ã€‚@interfaceç”¨æ¥å£°æ˜ä¸€ä¸ªæ³¨è§£ï¼Œå…¶ä¸­çš„æ¯ä¸€ä¸ªæ–¹æ³•å®é™…ä¸Šæ˜¯å£°æ˜äº†ä¸€ä¸ªé…ç½®å‚æ•°ã€‚æ–¹æ³•çš„åç§°å°±æ˜¯å‚æ•°çš„åç§°ï¼Œè¿”å›å€¼ç±»å‹å°±æ˜¯å‚æ•°çš„ç±»å‹ï¼ˆè¿”å›å€¼ç±»å‹åªèƒ½æ˜¯åŸºæœ¬ç±»å‹ã€Classã€Stringã€enumï¼‰ã€‚å¯ä»¥é€šè¿‡defaultæ¥å£°æ˜å‚æ•°çš„é»˜è®¤å€¼ã€‚ã€€ã€€å®šä¹‰æ³¨è§£æ ¼å¼ï¼š1public @interface æ³¨è§£å {å®šä¹‰ä½“}ã€€ã€€æ³¨è§£å‚æ•°çš„å¯æ”¯æŒæ•°æ®ç±»å‹ï¼šæ‰€æœ‰åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆint,float,boolean,byte,double,char,long,short)Stringç±»å‹Classç±»å‹enumç±»å‹Annotationç±»å‹ä»¥ä¸Šæ‰€æœ‰ç±»å‹çš„æ•°ç»„ã€€ã€€Annotationç±»å‹é‡Œé¢çš„å‚æ•°è¯¥æ€ä¹ˆè®¾å®š: ç¬¬ä¸€, åªèƒ½ç”¨publicæˆ–é»˜è®¤(default)è¿™ä¸¤ä¸ªè®¿é—®æƒä¿®é¥°.ä¾‹å¦‚,String value();è¿™é‡ŒæŠŠæ–¹æ³•è®¾ä¸ºdefaulé»˜è®¤ç±»å‹ï¼›ã€€ ã€€ç¬¬äºŒ, å‚æ•°æˆå‘˜åªèƒ½ç”¨åŸºæœ¬ç±»å‹byte,short,char,int,long,float,double,booleanå…«ç§åŸºæœ¬æ•°æ®ç±»å‹å’Œ String,Enum,Class,annotationsç­‰æ•°æ®ç±»å‹,ä»¥åŠè¿™ä¸€äº›ç±»å‹çš„æ•°ç»„.ä¾‹å¦‚,String value();è¿™é‡Œçš„å‚æ•°æˆå‘˜å°±ä¸ºString;ã€€ã€€ç¬¬ä¸‰, å¦‚æœåªæœ‰ä¸€ä¸ªå‚æ•°æˆå‘˜,æœ€å¥½æŠŠå‚æ•°åç§°è®¾ä¸ºâ€valueâ€,ååŠ å°æ‹¬å·.ä¾‹:ä¸‹é¢çš„æ³¨è§£å°±åªæœ‰ä¸€ä¸ªå‚æ•°æˆå‘˜ï¼Œæ˜¯ä¸€ä¸ªStringæ•°ç»„ã€‚123456@Target(ElementType.METHOD)@Retention(RetentionPolicy.RUNTIME)public @interface Entrance{   String[] value() default {};}æ³¨è§£å…ƒç´ çš„é»˜è®¤å€¼ï¼šã€€ã€€æ³¨è§£å…ƒç´ å¿…é¡»æœ‰ç¡®å®šçš„å€¼ï¼Œè¦ä¹ˆåœ¨å®šä¹‰æ³¨è§£çš„é»˜è®¤å€¼ä¸­æŒ‡å®šï¼Œè¦ä¹ˆåœ¨ä½¿ç”¨æ³¨è§£æ—¶æŒ‡å®šï¼ŒéåŸºæœ¬ç±»å‹çš„æ³¨è§£å…ƒç´ çš„å€¼ä¸å¯ä¸ºnullã€‚å› æ­¤, ä½¿ç”¨ç©ºå­—ç¬¦ä¸²æˆ–0ä½œä¸ºé»˜è®¤å€¼æ˜¯ä¸€ç§å¸¸ç”¨çš„åšæ³•ã€‚è¿™ä¸ªçº¦æŸä½¿å¾—å¤„ç†å™¨å¾ˆéš¾è¡¨ç°ä¸€ä¸ªå…ƒç´ çš„å­˜åœ¨æˆ–ç¼ºå¤±çš„çŠ¶æ€ï¼Œå› ä¸ºæ¯ä¸ªæ³¨è§£çš„å£°æ˜ä¸­ï¼Œæ‰€æœ‰å…ƒç´ éƒ½å­˜åœ¨ï¼Œå¹¶ä¸”éƒ½å…·æœ‰ç›¸åº”çš„å€¼ï¼Œä¸ºäº†ç»•å¼€è¿™ä¸ªçº¦æŸï¼Œæˆ‘ä»¬åªèƒ½å®šä¹‰ä¸€äº›ç‰¹æ®Šçš„å€¼ï¼Œä¾‹å¦‚ç©ºå­—ç¬¦ä¸²æˆ–è€…è´Ÿæ•°ï¼Œä¸€æ¬¡è¡¨ç¤ºæŸä¸ªå…ƒç´ ä¸å­˜åœ¨ï¼Œåœ¨å®šä¹‰æ³¨è§£æ—¶ï¼Œè¿™å·²ç»æˆä¸ºä¸€ä¸ªä¹ æƒ¯ç”¨æ³•ã€‚123456@Target(ElementType.METHOD)@Retention(RetentionPolicy.RUNTIME)public @interface Entrance{public String name() default &quot;&quot;;}æ³¨è§£ç”¨ä¾‹æ³¨è§£çš„åŠŸèƒ½å¾ˆå¼ºå¤§ï¼ŒSpringå’ŒHebernateè¿™äº›æ¡†æ¶åœ¨æ—¥å¿—å’Œæœ‰æ•ˆæ€§ä¸­å¤§é‡ä½¿ç”¨äº†æ³¨è§£åŠŸèƒ½ã€‚æ³¨è§£å¯ä»¥åº”ç”¨åœ¨ä½¿ç”¨æ ‡è®°æ¥å£çš„åœ°æ–¹ã€‚ä¸åŒçš„æ˜¯æ ‡è®°æ¥å£ç”¨æ¥å®šä¹‰å®Œæ•´çš„ç±»ï¼Œä½†ä½ å¯ä»¥ä¸ºå•ä¸ªçš„æ–¹æ³•å®šä¹‰æ³¨é‡Šï¼Œä¾‹å¦‚æ˜¯å¦å°†ä¸€ä¸ªæ–¹æ³•æš´éœ²ä¸ºæœåŠ¡ã€‚æ¨èé˜…è¯»ï¼šSpring Boot æœ€æ ¸å¿ƒçš„ 25 ä¸ªæ³¨è§£ï¼Œéƒ½æ˜¯å¹²è´§ï¼åœ¨æœ€æ–°çš„servlet3.0ä¸­å¼•å…¥äº†å¾ˆå¤šæ–°çš„æ³¨è§£ï¼Œå°¤å…¶æ˜¯å’Œservletå®‰å…¨ç›¸å…³çš„æ³¨è§£ã€‚HandlesTypes â€“è¯¥æ³¨è§£ç”¨æ¥è¡¨ç¤ºä¸€ç»„ä¼ é€’ç»™ServletContainerInitializerçš„åº”ç”¨ç±»ã€‚HttpConstraint â€“ è¯¥æ³¨è§£ä»£è¡¨æ‰€æœ‰HTTPæ–¹æ³•çš„åº”ç”¨è¯·æ±‚çš„å®‰å…¨çº¦æŸï¼Œå’ŒServletSecurityæ³¨é‡Šä¸­å®šä¹‰çš„HttpMethodConstraintå®‰å…¨çº¦æŸä¸åŒã€‚HttpMethodConstraint â€“ æŒ‡æ˜ä¸åŒç±»å‹è¯·æ±‚çš„å®‰å…¨çº¦æŸï¼Œå’ŒServletSecurity æ³¨è§£ä¸­æè¿°HTTPåè®®æ–¹æ³•ç±»å‹çš„æ³¨é‡Šä¸åŒã€‚MultipartConfig â€“è¯¥æ³¨è§£æ ‡æ³¨åœ¨Servletä¸Šé¢ï¼Œè¡¨ç¤ºè¯¥Servletå¸Œæœ›å¤„ç†çš„è¯·æ±‚çš„ MIME ç±»å‹æ˜¯ multipart/form-dataã€‚ServletSecurity è¯¥æ³¨è§£æ ‡æ³¨åœ¨Servletç»§æ‰¿ç±»ä¸Šé¢ï¼Œå¼ºåˆ¶è¯¥HTTPåè®®è¯·æ±‚éµå¾ªå®‰å…¨çº¦æŸã€‚WebFilter â€“ è¯¥æ³¨è§£ç”¨æ¥å£°æ˜ä¸€ä¸ªServerè¿‡æ»¤å™¨ï¼›WebInitParam â€“ è¯¥æ³¨è§£ç”¨æ¥å£°æ˜Servletæˆ–æ˜¯è¿‡æ»¤å™¨çš„ä¸­çš„åˆå§‹åŒ–å‚æ•°ï¼Œé€šå¸¸é…åˆ @WebServlet æˆ–è€… @WebFilter ä½¿ç”¨ã€‚WebListener â€“è¯¥æ³¨è§£ä¸ºWebåº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ä¸­ä¸åŒç±»å‹çš„äº‹ä»¶å£°æ˜ç›‘å¬å™¨ã€‚WebServlet â€“è¯¥æ³¨è§£ç”¨æ¥å£°æ˜ä¸€ä¸ªServletçš„é…ç½®ã€‚ADF(åº”ç”¨ç¨‹åºæ¡†æ¶)å’Œæ³¨è§£ç°åœ¨æˆ‘ä»¬å¼€å§‹è®¨è®ºæ–‡ç« çš„æœ€åä¸€éƒ¨åˆ†äº†ã€‚åº”ç”¨ç¨‹åºæ¡†æ¶ï¼Œè¢«ç§°ä¸ºADFï¼Œç”±Oracleå¼€å‘ç”¨æ¥åˆ›å»ºOracleèåˆåº”ç”¨ã€‚æˆ‘ä»¬å·²ç»äº†è§£äº†æ³¨è§£çš„ä¼˜ç¼ºç‚¹ï¼Œä¹ŸçŸ¥é“å¦‚ä½•ç¼–å†™è‡ªå®šä¹‰çš„æ³¨è§£ï¼Œä½†æˆ‘ä»¬åº”è¯¥å°†æ³¨è§£åº”ç”¨åœ¨ADFçš„å“ªéƒ¨åˆ†å‘¢ï¼ŸADFæ˜¯å¦æä¾›äº†ä¸€äº›æœ´ç´ çš„æ³¨è§£ï¼Ÿå¾ˆå¥½çš„é—®é¢˜ï¼Œç¡®å®åœ¨ADFä¸­å¤§é‡ä½¿ç”¨æ³¨è§£æœ‰ä¸€äº›é™åˆ¶ã€‚ä¹‹å‰æåˆ°çš„åº”ç”¨æ¡†æ¶å¦‚Springå’ŒHibernateä½¿ç”¨AOP(é¢å‘ä¾§é¢çš„ç¨‹åºè®¾è®¡)ã€‚åœ¨AOPä¸­ï¼Œæ¡†æ¶æä¾›äº†ä¸€ç§æœºåˆ¶ï¼Œåœ¨äº‹ä»¶çš„é¢„å¤„ç†å’Œåç»­å¤„ç†ä¸­æ³¨å…¥ä»£ç ã€‚ä¾‹å¦‚ï¼šä½ æœ‰ä¸€ä¸ªé’©å­ç”¨æ¥åœ¨æ–¹æ³•æ‰§è¡Œä¹‹å‰å’Œä¹‹åæ·»åŠ ä»£ç ï¼Œæ‰€ä»¥ä½ å¯ä»¥åœ¨è¿™äº›åœ°æ–¹ç¼–å†™ä½ çš„ç”¨æˆ·ä»£ç ã€‚ADFä¸ä½¿ç”¨AOPã€‚å¦‚æœæˆ‘ä»¬æœ‰ä»»ä½•æ³¨è§£çš„ç”¨ä¾‹å¯ç”¨ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦é€šè¿‡ç»§æ‰¿çš„æ–¹å¼å®ç°ã€‚</content>
	</entry>
	<entry>
		<title>Springæ³¨è§£_å¸¸ç”¨æ³¨è§£</title>
		<url>/article/a0f3b9ff.html</url>
		<content>12ç§ Spring å¸¸ç”¨æ³¨è§£å£°æ˜beançš„æ³¨è§£@Component ç»„ä»¶ï¼Œæ²¡æœ‰æ˜ç¡®çš„è§’è‰²@Service åœ¨ä¸šåŠ¡é€»è¾‘å±‚ä½¿ç”¨ï¼ˆserviceå±‚ï¼‰@Repository åœ¨æ•°æ®è®¿é—®å±‚ä½¿ç”¨ï¼ˆdaoå±‚ï¼‰@Controller åœ¨å±•ç°å±‚ä½¿ç”¨ï¼Œæ§åˆ¶å™¨çš„å£°æ˜ï¼ˆControllerå±‚ï¼‰æ³¨å…¥beançš„æ³¨è§£ANNOTATIONPACKAGESOURCE@Resourcejavax.annotationJava JSR-250@Injectjavax.injectJava JSR-330@Autowiredorg.springframework.bean.factorySpring 2.5+JSRæ˜¯Java Specification Requestsçš„ç¼©å†™ï¼Œæ„æ€æ˜¯Java è§„èŒƒææ¡ˆã€‚æ˜¯æŒ‡å‘JCP(Java Community Process)æå‡ºæ–°å¢ä¸€ä¸ªæ ‡å‡†åŒ–æŠ€æœ¯è§„èŒƒçš„æ­£å¼è¯·æ±‚ã€‚ä»»ä½•äººéƒ½å¯ä»¥æäº¤JSRï¼Œä»¥å‘Javaå¹³å°å¢æ·»æ–°çš„APIå’ŒæœåŠ¡ã€‚JSRå·²æˆä¸ºJavaç•Œçš„ä¸€ä¸ªé‡è¦æ ‡å‡†ã€‚@Resource,@Autowired,@Inject3ç§æ³¨å…¥æ–¹å¼è¯¦è§£@Autowiredï¼šç”±Springæä¾›é»˜è®¤æŒ‰ç±»å‹è£…é…ï¼Œæ‰¾ä¸åˆ°æˆ–è€…æ‰¾åˆ°å¤šä¸ªåˆ™æŠ¥é”™ã€‚å¦‚æœè¦æŒ‰åç§°è£…é…ï¼Œéœ€è¦ç»“åˆSpringå¦å¤–ä¸€ä¸ªæ³¨è§£Qualifier(â€œnameâ€)ä½¿ç”¨ã€‚é»˜è®¤å¿…é¡»è£…é…requred=trueï¼Œå¦‚æœå¯ä»¥ä¸ºç©ºï¼Œå¯ä»¥è®¾ç½®ä¸ºfalseï¼Œåœ¨Spring4+ç»“åˆjdk8+çš„æƒ…å†µä¸‹è¿˜å¯ä»¥ä½¿ç”¨Optionalå’ŒfalseåŒç­‰çš„æ•ˆæœï¼Œå¦‚12@Autowiredprivate Optional&lt;UserService&gt; userService;@Injectï¼šç”±JSR-330æä¾›å’Œ@Autowiredç±»ä¼¼ï¼Œå¯ä»¥å®Œå…¨ä»£æ›¿@Autowiredï¼Œä½†è¿™ä¸ªæ²¡æœ‰requiredå±æ€§ï¼Œè¦æ±‚beanå¿…é¡»å­˜åœ¨ã€‚å¦‚æœè¦æŒ‰åç§°è£…é…ï¼Œéœ€è¦ç»“åˆjavaxå¦å¤–ä¸€ä¸ªæ³¨è§£N(â€œnameâ€)ä½¿ç”¨ã€‚@Resourceï¼šç”±JSR-250æä¾›å®ƒæœ‰ä¸¤ä¸ªå…³é”®çš„å±æ€§ï¼šnameï¼åç§°ï¼Œtypeï¼ç±»å‹1ã€å¦‚æœæŒ‡å®šäº†name,typeï¼Œåˆ™ä»Springå®¹å™¨ä¸­æ‰¾ä¸€ä¸ªåç§°å’Œç±»å‹ç›¸å½“åº”çš„ä¸€ä¸ªbeanï¼Œæ‰¾ä¸åˆ°åˆ™æŠ¥é”™ã€‚2ã€å¦‚æœåªæŒ‡å®šäº†nameï¼Œåˆ™ä»Springå®¹å™¨ä¸­æ‰¾ä¸€ä¸ªåç§°å’Œnameä¸€æ ·çš„beanï¼Œæ‰¾ä¸åˆ°åˆ™æŠ¥é”™ã€‚3ã€å¦‚æœåªæŒ‡å®šäº†typeï¼Œåˆ™ä»Springå®¹å™¨ä¸­æ‰¾ä¸€ä¸ªç±»å‹å’Œtypeä¸€æ ·çš„beanï¼Œæ‰¾ä¸åˆ°æˆ–è€…æ‰¾åˆ°å¤šä¸ªåˆ™æŠ¥é”™ã€‚4ã€å¦‚æœæ²¡æœ‰æŒ‡å®šå‚æ•°ï¼Œåˆ™é»˜è®¤æ‰¾å­—æ®µåç§°è£…é…ï¼Œæ‰¾ä¸åˆ°åˆ™æŒ‰ç±»å‹è£…é…ï¼Œæ‰¾ä¸åˆ°åˆ™æŠ¥é”™ã€‚éƒ½å¯ä»¥æ³¨è§£åœ¨setæ–¹æ³•å’Œå±æ€§ä¸Šï¼Œæ¨èæ³¨è§£åœ¨å±æ€§ä¸Šï¼ˆä¸€ç›®äº†ç„¶ï¼Œå°‘å†™ä»£ç ï¼‰ã€‚Springå¸¸ç”¨çš„ä¸‰ç§æ³¨å…¥æ–¹å¼Springé€šè¿‡DIï¼ˆä¾èµ–æ³¨å…¥ï¼‰å®ç°IOCï¼ˆæ§åˆ¶åè½¬ï¼‰ï¼Œå¸¸ç”¨çš„æ³¨å…¥æ–¹å¼ä¸»è¦æœ‰ä¸‰ç§ï¼šæ„é€ æ–¹æ³•æ³¨å…¥ï¼Œsetteræ³¨å…¥ï¼ŒåŸºäºæ³¨è§£çš„æ³¨å…¥ã€‚1. æ„é€ æ–¹æ³•æ³¨å…¥åœ¨springçš„é…ç½®æ–‡ä»¶ä¸­æ³¨å†ŒUserServiceï¼Œå°†UserDaoJdbcé€šè¿‡constructor-argæ ‡ç­¾æ³¨å…¥åˆ°UserServiceçš„æŸä¸ªæœ‰å‚æ•°çš„æ„é€ æ–¹æ³•123456&lt;!-- æ³¨å†ŒuserService --&gt;&lt;bean id=&quot;userService&quot; class=&quot;com.lyu.spring.service.impl.UserService&quot;&gt;   &lt;constructor-arg ref=&quot;userDaoJdbc&quot;&gt;&lt;/constructor-arg&gt;&lt;/bean&gt;&lt;!-- æ³¨å†Œjdbcå®ç°çš„dao --&gt;&lt;bean id=&quot;userDaoJdbc&quot; class=&quot;com.lyu.spring.dao.impl.UserDaoJdbc&quot;&gt;&lt;/bean&gt;å¦‚æœåªæœ‰ä¸€ä¸ªæœ‰å‚æ•°çš„æ„é€ æ–¹æ³•å¹¶ä¸”å‚æ•°ç±»å‹ä¸æ³¨å…¥çš„beançš„ç±»å‹åŒ¹é…ï¼Œé‚£å°±ä¼šæ³¨å…¥åˆ°è¯¥æ„é€ æ–¹æ³•ä¸­ã€‚123456789public class UserService implements IUserService {       private IUserDao userDao;       public UserService(IUserDao userDao) {           this.userDao = userDao;       }       public void loginUser() {           userDao.loginUser();       }}é—®é¢˜ä¸€ï¼šå¦‚æœæœ‰å¤šä¸ªæœ‰å‚æ•°çš„æ„é€ æ–¹æ³•å¹¶ä¸”æ¯ä¸ªæ„é€ æ–¹æ³•çš„å‚æ•°åˆ—è¡¨é‡Œé¢éƒ½æœ‰è¦æ³¨å…¥çš„å±æ€§ï¼Œé‚£userDaoJdbcä¼šæ³¨å…¥åˆ°å“ªé‡Œå‘¢ï¼Ÿ12345678910111213141516public class UserService implements IUserService {       private IUserDao userDao;       private User user;       public UserService(IUserDao userDao) {           System.out.println(&quot;è¿™æ˜¯æœ‰ä¸€ä¸ªå‚æ•°çš„æ„é€ æ–¹æ³•&quot;);           this.userDao = userDao;       }       public UserService(IUserDao userDao, User user) {           System.out.println(&quot;è¿™æ˜¯æœ‰ä¸¤ä¸ªå‚æ•°çš„æ„é€ æ–¹æ³•&quot;);           this.userDao = userDao;           this.user = user;       }       public void loginUser() {           userDao.loginUser();       }}ç»“æœï¼šä¼šæ³¨å…¥åˆ°åªæœ‰ä¸€ä¸ªå‚æ•°çš„æ„é€ æ–¹æ³•ä¸­ï¼Œå¹¶ä¸”ç»è¿‡æµ‹è¯•æ³¨å…¥å“ªä¸€ä¸ªæ„é€ æ–¹æ³•ä¸æ„é€ æ–¹æ³•çš„é¡ºåºæ— å…³é—®é¢˜äºŒï¼šå¦‚æœåªæœ‰ä¸€ä¸ªæ„é€ æ–¹æ³•ï¼Œä½†æ˜¯æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯å¾…æ³¨å…¥çš„å‚æ•°ï¼Œå¦ä¸€ä¸ªæ˜¯å…¶ä»–ç±»å‹çš„å‚æ•°ï¼Œé‚£ä¹ˆè¿™æ¬¡æ³¨å…¥å¯ä»¥æˆåŠŸå—ï¼Ÿ1234567891011public class UserService implements IUserService {       private IUserDao userDao;       private User user;       public UserService(IUserDao userDao, User user) {           this.userDao = userDao;           this.user = user;       }       public void loginUser() {           userDao.loginUser();       }}ç»“æœï¼šå¤±è´¥äº†ï¼Œå³ä½¿åœ¨costract-argæ ‡ç­¾é‡Œé¢é€šè¿‡nameå±æ€§æŒ‡å®šè¦æ³¨å…¥çš„å‚æ•°åuserDaoä¹Ÿä¼šå¤±è´¥.é—®é¢˜ä¸‰ï¼šå¦‚æœæˆ‘ä»¬æƒ³å‘æœ‰å¤šä¸ªå‚æ•°çš„æ„é€ æ–¹æ³•ä¸­æ³¨å…¥å€¼è¯¥åœ¨é…ç½®æ–‡ä»¶ä¸­æ€ä¹ˆå†™å‘¢ï¼Ÿ1234567891011public class UserService implements IUserService {       private IUserDao userDao;       private User user;       public UserService(IUserDao userDao, User user) {           this.userDao = userDao;           this.user = user;       }       public void loginUser() {           userDao.loginUser();       }}å‚è€ƒå†™æ³•ï¼šé€šè¿‡nameå±æ€§æŒ‡å®šè¦æ³¨å…¥çš„å€¼ï¼Œä¸æ„é€ æ–¹æ³•å‚æ•°åˆ—è¡¨å‚æ•°çš„é¡ºåºæ— å…³12345678910&lt;!-- æ³¨å†ŒuserService --&gt;&lt;bean id=&quot;userService&quot; class=&quot;com.lyu.spring.service.impl.UserService&quot;&gt;       &lt;constructor-arg name=&quot;userDao&quot; ref=&quot;userDaoJdbc&quot;&gt;&lt;/constructor-arg&gt;       &lt;constructor-arg name=&quot;user&quot; ref=&quot;user&quot;&gt;&lt;/constructor-arg&gt;&lt;/bean&gt;&lt;!-- æ³¨å†Œå®ä½“Userç±»ï¼Œç”¨äºæµ‹è¯• --&gt;&lt;bean id=&quot;user&quot; class=&quot;com.lyu.spring.entity.User&quot;&gt;&lt;/bean&gt;&lt;!-- æ³¨å†Œjdbcå®ç°çš„dao --&gt;&lt;bean id=&quot;userDaoJdbc&quot; class=&quot;com.lyu.spring.dao.impl.UserDaoJdbc&quot;&gt;&lt;/bean&gt;é—®é¢˜å››ï¼šå¦‚æœæœ‰å¤šä¸ªæ„é€ æ–¹æ³•ï¼Œæ¯ä¸ªæ„é€ æ–¹æ³•åªæœ‰å‚æ•°çš„é¡ºåºä¸åŒï¼Œé‚£é€šè¿‡æ„é€ æ–¹æ³•æ³¨å…¥å¤šä¸ªå‚æ•°ä¼šæ³¨å…¥åˆ°å“ªä¸€ä¸ªå‘¢ï¼Ÿ1234567891011121314151617public class UserService implements IUserService {       private IUserDao userDao;       private User user;       public UserService(IUserDao userDao, User user) {           System.out.println(&quot;è¿™æ˜¯ç¬¬äºŒä¸ªæ„é€ æ–¹æ³•&quot;);           this.userDao = userDao;           this.user = user;       }       public UserService(User user, IUserDao userDao) {           System.out.println(&quot;è¿™æ˜¯ç¬¬ä¸€ä¸ªæ„é€ æ–¹æ³•&quot;);           this.userDao = userDao;           this.user = user;       }       public void loginUser() {           userDao.loginUser();       }}ç»“æœï¼šå“ªä¸ªæ„é€ æ–¹æ³•åœ¨å‰å°±æ³¨å…¥å“ªä¸€ä¸ªï¼Œè¿™ç§æƒ…å†µä¸‹å°±ä¸æ„é€ æ–¹æ³•é¡ºåºæœ‰å…³ã€‚2. setteræ–¹æ³•æ³¨å…¥é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š12345678910&gt;&lt;!-- æ³¨å†ŒuserService --&gt;&gt;&lt;bean id=&quot;userService&quot; class=&quot;com.lyu.spring.service.impl.UserService&quot;&gt;    &lt;!-- å†™æ³•ä¸€ --&gt;    &lt;!-- &lt;property name=&quot;UserDao&quot; ref=&quot;userDaoMyBatis&quot;&gt;&lt;/property&gt; --&gt;    &lt;!-- å†™æ³•äºŒ --&gt;    &lt;property name=&quot;userDao&quot; ref=&quot;userDaoMyBatis&quot;&gt;&lt;/property&gt;&gt;&lt;/bean&gt;&gt;&lt;!-- æ³¨å†Œmybatiså®ç°çš„dao --&gt;&gt;&lt;bean id=&quot;userDaoMyBatis&quot; class=&quot;com.lyu.spring.dao.impl.UserDaoMyBatis&quot;&gt;&lt;/bean&gt;æ³¨ï¼šä¸Šé¢è¿™ä¸¤ç§å†™æ³•éƒ½å¯ä»¥,springä¼šå°†nameå€¼çš„æ¯ä¸ªå•è¯é¦–å­—æ¯è½¬æ¢æˆå¤§å†™ï¼Œç„¶åå†åœ¨å‰é¢æ‹¼æ¥ä¸Šâ€setâ€æ„æˆä¸€ä¸ªæ–¹æ³•å,ç„¶åå»å¯¹åº”çš„ç±»ä¸­æŸ¥æ‰¾è¯¥æ–¹æ³•,é€šè¿‡åå°„è°ƒç”¨,å®ç°æ³¨å…¥ã€‚åˆ‡è®°ï¼šnameå±æ€§å€¼ä¸ç±»ä¸­çš„æˆå‘˜å˜é‡åä»¥åŠsetæ–¹æ³•çš„å‚æ•°åéƒ½æ— å…³ï¼Œåªä¸å¯¹åº”çš„setæ–¹æ³•åæœ‰å…³ï¼Œä¸‹é¢çš„è¿™ç§å†™æ³•æ˜¯å¯ä»¥è¿è¡ŒæˆåŠŸçš„123456789&gt;public class UserService implements IUserService {       private IUserDao userDao1;       public void setUserDao(IUserDao userDao1) {            this.userDao1 = userDao1;       }       public void loginUser() {            userDao1.loginUser();       }&gt;}è¿˜æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼šå¦‚æœé€šè¿‡setæ–¹æ³•æ³¨å…¥å±æ€§ï¼Œé‚£ä¹ˆspringä¼šé€šè¿‡é»˜è®¤çš„ç©ºå‚æ„é€ æ–¹æ³•æ¥å®ä¾‹åŒ–å¯¹è±¡ï¼Œæ‰€ä»¥å¦‚æœåœ¨ç±»ä¸­å†™äº†ä¸€ä¸ªå¸¦æœ‰å‚æ•°çš„æ„é€ æ–¹æ³•ï¼Œä¸€å®šè¦æŠŠç©ºå‚æ•°çš„æ„é€ æ–¹æ³•å†™ä¸Šï¼Œå¦åˆ™springæ²¡æœ‰åŠæ³•å®ä¾‹åŒ–å¯¹è±¡ï¼Œå¯¼è‡´æŠ¥é”™ã€‚3. åŸºäºæ³¨è§£çš„æ³¨å…¥@Resourceï¼šjavaçš„æ³¨è§£ï¼Œé»˜è®¤ä»¥byNameçš„æ–¹å¼å»åŒ¹é…ä¸å±æ€§åç›¸åŒçš„beançš„idï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°å°±ä¼šä»¥byTypeçš„æ–¹å¼æŸ¥æ‰¾ï¼Œå¦‚æœbyTypeæŸ¥æ‰¾åˆ°å¤šä¸ªçš„è¯ï¼Œä½¿ç”¨@Qualifieræ³¨è§£ï¼ˆspringæ³¨è§£ï¼‰æŒ‡å®šæŸä¸ªå…·ä½“åç§°çš„beanã€‚1234&gt;@Resource&gt;@Qualifier(&quot;userDaoMyBatis&quot;)&gt;private IUserDao userDao;&gt;public UserService(){}@Resourceè£…é…é¡ºåºå¦‚æœåŒæ—¶æŒ‡å®šäº†nameå’Œtypeï¼Œåˆ™ä»Springä¸Šä¸‹æ–‡ä¸­æ‰¾åˆ°å”¯ä¸€åŒ¹é…çš„beanè¿›è¡Œè£…é…ï¼Œæ‰¾ä¸åˆ°åˆ™æŠ›å‡ºå¼‚å¸¸å¦‚æœæŒ‡å®šäº†nameï¼Œåˆ™ä»ä¸Šä¸‹æ–‡ä¸­æŸ¥æ‰¾åç§°ï¼ˆidï¼‰åŒ¹é…çš„beanè¿›è¡Œè£…é…ï¼Œæ‰¾ä¸åˆ°åˆ™æŠ›å‡ºå¼‚å¸¸å¦‚æœæŒ‡å®šäº†typeï¼Œåˆ™ä»ä¸Šä¸‹æ–‡ä¸­æ‰¾åˆ°ç±»å‹åŒ¹é…çš„å”¯ä¸€beanè¿›è¡Œè£…é…ï¼Œæ‰¾ä¸åˆ°æˆ–è€…æ‰¾åˆ°å¤šä¸ªï¼Œéƒ½ä¼šæŠ›å‡ºå¼‚å¸¸å¦‚æœæ—¢æ²¡æœ‰æŒ‡å®šnameï¼Œåˆæ²¡æœ‰æŒ‡å®štypeï¼Œåˆ™è‡ªåŠ¨æŒ‰ç…§byNameæ–¹å¼è¿›è¡Œè£…é…ï¼›å¦‚æœæ²¡æœ‰åŒ¹é…ï¼Œåˆ™å›é€€ä¸ºä¸€ä¸ªåŸå§‹ç±»å‹è¿›è¡ŒåŒ¹é…ï¼Œå¦‚æœåŒ¹é…åˆ™è‡ªåŠ¨è£…é…@Autowiredï¼šspringæ³¨è§£ï¼Œé»˜è®¤æ˜¯ä»¥byTypeçš„æ–¹å¼å»åŒ¹é…ä¸å±æ€§åç›¸åŒçš„beançš„idï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œå°±é€šè¿‡byNameçš„æ–¹å¼å»æŸ¥æ‰¾ã€‚123&gt;@Autowired&gt;@Qualifier(&quot;userDaoJdbc&quot;)&gt;private IUserDao userDao;javaé…ç½®ç±»ç›¸å…³æ³¨è§£@Configuration å£°æ˜å½“å‰ç±»ä¸ºé…ç½®ç±»ï¼Œç›¸å½“äºxmlå½¢å¼çš„Springé…ç½®ï¼ˆç±»ä¸Šï¼‰@Bean æ³¨è§£åœ¨æ–¹æ³•ä¸Šï¼Œå£°æ˜å½“å‰æ–¹æ³•çš„è¿”å›å€¼ä¸ºä¸€ä¸ªbeanï¼Œæ›¿ä»£xmlä¸­çš„æ–¹å¼ï¼ˆæ–¹æ³•ä¸Šï¼‰@Configuration å£°æ˜å½“å‰ç±»ä¸ºé…ç½®ç±»ï¼Œå…¶ä¸­å†…éƒ¨ç»„åˆäº†@Componentæ³¨è§£ï¼Œè¡¨æ˜è¿™ä¸ªç±»æ˜¯ä¸€ä¸ªbeanï¼ˆç±»ä¸Šï¼‰@ComponentScan ç”¨äºå¯¹Componentè¿›è¡Œæ‰«æï¼Œç›¸å½“äºxmlä¸­çš„ï¼ˆç±»ä¸Šï¼‰@WishlyConfiguration ä¸º@Configurationä¸@ComponentScançš„ç»„åˆæ³¨è§£ï¼Œå¯ä»¥æ›¿ä»£è¿™ä¸¤ä¸ªæ³¨è§£åˆ‡é¢(AOP)ç›¸å…³æ³¨è§£Springæ”¯æŒAspectJçš„æ³¨è§£å¼åˆ‡é¢ç¼–ç¨‹ã€‚@Aspect å£°æ˜ä¸€ä¸ªåˆ‡é¢ï¼ˆç±»ä¸Šï¼‰ä½¿ç”¨@Afterã€@Beforeã€@Aroundå®šä¹‰å»ºè¨€ï¼ˆadviceï¼‰ï¼Œå¯ç›´æ¥å°†æ‹¦æˆªè§„åˆ™ï¼ˆåˆ‡ç‚¹ï¼‰ä½œä¸ºå‚æ•°ã€‚@After åœ¨æ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡Œï¼ˆæ–¹æ³•ä¸Šï¼‰@Before åœ¨æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œï¼ˆæ–¹æ³•ä¸Šï¼‰@Around åœ¨æ–¹æ³•æ‰§è¡Œä¹‹å‰ä¸ä¹‹åæ‰§è¡Œï¼ˆæ–¹æ³•ä¸Šï¼‰@PointCut å£°æ˜åˆ‡ç‚¹åœ¨javaé…ç½®ç±»ä¸­ä½¿ç”¨@EnableAspectJAutoProxyæ³¨è§£å¼€å¯Springå¯¹AspectJä»£ç†çš„æ”¯æŒï¼ˆç±»ä¸Šï¼‰@Beançš„å±æ€§æ”¯æŒ@Scope è®¾ç½®Springå®¹å™¨å¦‚ä½•æ–°å»ºBeanå®ä¾‹ï¼ˆæ–¹æ³•ä¸Šï¼Œå¾—æœ‰@Beanï¼‰å…¶è®¾ç½®ç±»å‹åŒ…æ‹¬ï¼šSingleton ï¼ˆå•ä¾‹,ä¸€ä¸ªSpringå®¹å™¨ä¸­åªæœ‰ä¸€ä¸ªbeanå®ä¾‹ï¼Œé»˜è®¤æ¨¡å¼ï¼‰,Protetype ï¼ˆæ¯æ¬¡è°ƒç”¨æ–°å»ºä¸€ä¸ªbeanï¼‰,Request ï¼ˆwebé¡¹ç›®ä¸­ï¼Œç»™æ¯ä¸ªhttp requestæ–°å»ºä¸€ä¸ªbeanï¼‰,Session ï¼ˆwebé¡¹ç›®ä¸­ï¼Œç»™æ¯ä¸ªhttp sessionæ–°å»ºä¸€ä¸ªbeanï¼‰,GlobalSessionï¼ˆç»™æ¯ä¸€ä¸ª global http sessionæ–°å»ºä¸€ä¸ªBeanå®ä¾‹ï¼‰@StepScope åœ¨Spring Batchä¸­è¿˜æœ‰æ¶‰åŠ@PostConstruct ç”±JSR-250æä¾›ï¼Œåœ¨æ„é€ å‡½æ•°æ‰§è¡Œå®Œä¹‹åæ‰§è¡Œï¼Œç­‰ä»·äºxmlé…ç½®æ–‡ä»¶ä¸­beançš„initMethod@PreDestory ç”±JSR-250æä¾›ï¼Œåœ¨Beané”€æ¯ä¹‹å‰æ‰§è¡Œï¼Œç­‰ä»·äºxmlé…ç½®æ–‡ä»¶ä¸­beançš„destroyMethod@Valueæ³¨è§£@Value ä¸ºå±æ€§æ³¨å…¥å€¼ï¼ˆå±æ€§ä¸Šï¼‰æ”¯æŒå¦‚ä¸‹æ–¹å¼çš„æ³¨å…¥ï¼šã€‹æ³¨å…¥æ™®é€šå­—ç¬¦@Value(â€œMichael Jacksonâ€)String name;ã€‹æ³¨å…¥æ“ä½œç³»ç»Ÿå±æ€§@Value(â€œ#{systemProperties[â€˜os.nameâ€™]}â€)String osName;ã€‹æ³¨å…¥è¡¨è¾¾å¼ç»“æœ@Value(â€œ#{ T(java.lang.Math).random() * 100 }â€) String randomNumber;ã€‹æ³¨å…¥å…¶å®ƒbeanå±æ€§@Value(â€œ#{domeClass.name}â€)String name;ã€‹æ³¨å…¥æ–‡ä»¶èµ„æº@Value(â€œclasspath:com/hgs/hello/test.txtâ€)String Resource file;ã€‹æ³¨å…¥ç½‘ç«™èµ„æº@Value(â€œhttp://www.javastack.cn&quot;)Resource url;ã€‹æ³¨å…¥é…ç½®æ–‡ä»¶Value(â€œ${book.name}â€)String bookName;æ³¨å…¥é…ç½®ä½¿ç”¨æ–¹æ³•ï¼š â‘  ç¼–å†™é…ç½®æ–‡ä»¶ï¼ˆtest.propertiesï¼‰book.name=ã€Šä¸‰ä½“ã€‹â‘¡ @PropertySource åŠ è½½é…ç½®æ–‡ä»¶(ç±»ä¸Š)@PropertySource(â€œclasspath:com/hgs/hello/test/test.propertieâ€)â‘¢ è¿˜éœ€é…ç½®ä¸€ä¸ªPropertySourcesPlaceholderConfigurerçš„beanã€‚ç¯å¢ƒåˆ‡æ¢@Profile é€šè¿‡è®¾å®šEnvironmentçš„ActiveProfilesæ¥è®¾å®šå½“å‰contextéœ€è¦ä½¿ç”¨çš„é…ç½®ç¯å¢ƒã€‚ï¼ˆç±»æˆ–æ–¹æ³•ä¸Šï¼‰@Conditional Spring4ä¸­å¯ä»¥ä½¿ç”¨æ­¤æ³¨è§£å®šä¹‰æ¡ä»¶è¯çš„beanï¼Œé€šè¿‡å®ç°Conditionæ¥å£ï¼Œå¹¶é‡å†™matchesæ–¹æ³•ï¼Œä»è€Œå†³å®šè¯¥beanæ˜¯å¦è¢«å®ä¾‹åŒ–ã€‚ï¼ˆæ–¹æ³•ä¸Šï¼‰å¼‚æ­¥ç›¸å…³@EnableAsync é…ç½®ç±»ä¸­ï¼Œé€šè¿‡æ­¤æ³¨è§£å¼€å¯å¯¹å¼‚æ­¥ä»»åŠ¡çš„æ”¯æŒï¼Œå™äº‹æ€§AsyncConfigureræ¥å£ï¼ˆç±»ä¸Šï¼‰ï¼Œç‚¹å‡»è¿™é‡Œäº†è§£ä½¿ç”¨è¯¦æƒ…ã€‚@Async åœ¨å®é™…æ‰§è¡Œçš„beanæ–¹æ³•ä½¿ç”¨è¯¥æ³¨è§£æ¥ç”³æ˜å…¶æ˜¯ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡ï¼ˆæ–¹æ³•ä¸Šæˆ–ç±»ä¸Šæ‰€æœ‰çš„æ–¹æ³•éƒ½å°†å¼‚æ­¥ï¼Œéœ€è¦@EnableAsyncå¼€å¯å¼‚æ­¥ä»»åŠ¡ï¼‰å®šæ—¶ä»»åŠ¡ç›¸å…³@EnableScheduling åœ¨é…ç½®ç±»ä¸Šä½¿ç”¨ï¼Œå¼€å¯è®¡åˆ’ä»»åŠ¡çš„æ”¯æŒï¼ˆç±»ä¸Šï¼‰@Scheduled æ¥ç”³æ˜è¿™æ˜¯ä¸€ä¸ªä»»åŠ¡ï¼ŒåŒ…æ‹¬cron,fixDelay,fixRateç­‰ç±»å‹ï¼ˆæ–¹æ³•ä¸Šï¼Œéœ€å…ˆå¼€å¯è®¡åˆ’ä»»åŠ¡çš„æ”¯æŒï¼‰@Enable*æ³¨è§£è¯´æ˜è¿™äº›æ³¨è§£ä¸»è¦ç”¨æ¥å¼€å¯å¯¹xxxçš„æ”¯æŒã€‚@EnableAspectJAutoProxy å¼€å¯å¯¹AspectJè‡ªåŠ¨ä»£ç†çš„æ”¯æŒ@EnableAsync å¼€å¯å¼‚æ­¥æ–¹æ³•çš„æ”¯æŒ@EnableScheduling å¼€å¯è®¡åˆ’ä»»åŠ¡çš„æ”¯æŒ@EnableWebMvc å¼€å¯Web MVCçš„é…ç½®æ”¯æŒ@EnableConfigurationProperties å¼€å¯å¯¹@ConfigurationPropertiesæ³¨è§£é…ç½®Beançš„æ”¯æŒ@EnableJpaRepositories å¼€å¯å¯¹SpringData JPA Repositoryçš„æ”¯æŒ@EnableTransactionManagement å¼€å¯æ³¨è§£å¼äº‹åŠ¡çš„æ”¯æŒ@EnableTransactionManagement å¼€å¯æ³¨è§£å¼äº‹åŠ¡çš„æ”¯æŒ@EnableCaching å¼€å¯æ³¨è§£å¼çš„ç¼“å­˜æ”¯æŒæµ‹è¯•ç›¸å…³æ³¨è§£@RunWith è¿è¡Œå™¨ï¼ŒSpringä¸­é€šå¸¸ç”¨äºå¯¹JUnitçš„æ”¯æŒ@RunWith(SpringJUnit4ClassRunner.class)@ContextConfiguration ç”¨æ¥åŠ è½½é…ç½®ApplicationContextï¼Œå…¶ä¸­classeså±æ€§ç”¨æ¥åŠ è½½é…ç½®ç±»@ContextConfiguration(classes={TestConfig.class})SpringMVCç›¸å…³æ³¨è§£@EnableWebMvc åœ¨é…ç½®ç±»ä¸­å¼€å¯Web MVCçš„é…ç½®æ”¯æŒï¼Œå¦‚ä¸€äº›ViewResolveræˆ–è€…MessageConverterç­‰ï¼Œè‹¥æ— æ­¤å¥ï¼Œé‡å†™WebMvcConfigurerAdapteræ–¹æ³•ï¼ˆç”¨äºå¯¹SpringMVCçš„é…ç½®ï¼‰ã€‚@Controller å£°æ˜è¯¥ç±»ä¸ºSpringMVCä¸­çš„Controller@RequestMapping ç”¨äºæ˜ å°„Webè¯·æ±‚ï¼ŒåŒ…æ‹¬è®¿é—®è·¯å¾„å’Œå‚æ•°ï¼ˆç±»æˆ–æ–¹æ³•ä¸Šï¼‰@ResponseBody æ”¯æŒå°†è¿”å›å€¼æ”¾åœ¨responseå†…ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªé¡µé¢ï¼Œé€šå¸¸ç”¨æˆ·è¿”å›jsonæ•°æ®ï¼ˆè¿”å›å€¼æ—æˆ–æ–¹æ³•ä¸Šï¼‰@RequestBody å…è®¸requestçš„å‚æ•°åœ¨requestä½“ä¸­ï¼Œè€Œä¸æ˜¯åœ¨ç›´æ¥è¿æ¥åœ¨åœ°å€åé¢ã€‚ï¼ˆæ”¾åœ¨å‚æ•°å‰ï¼‰@PathVariable ç”¨äºæ¥æ”¶è·¯å¾„å‚æ•°ï¼Œæ¯”å¦‚@RequestMapping(â€œ/hello/{name}â€)ç”³æ˜çš„è·¯å¾„ï¼Œå°†æ³¨è§£æ”¾åœ¨å‚æ•°ä¸­å‰ï¼Œå³å¯è·å–è¯¥å€¼ï¼Œé€šå¸¸ä½œä¸ºRestfulçš„æ¥å£å®ç°æ–¹æ³•ã€‚@RestController è¯¥æ³¨è§£ä¸ºä¸€ä¸ªç»„åˆæ³¨è§£ï¼Œç›¸å½“äº@Controllerå’Œ@ResponseBodyçš„ç»„åˆï¼Œæ³¨è§£åœ¨ç±»ä¸Šï¼Œæ„å‘³ç€ï¼Œè¯¥Controllerçš„æ‰€æœ‰æ–¹æ³•éƒ½é»˜è®¤åŠ ä¸Šäº†@ResponseBodyã€‚@ControllerAdvice é€šè¿‡è¯¥æ³¨è§£ï¼Œæˆ‘ä»¬å¯ä»¥å°†å¯¹äºæ§åˆ¶å™¨çš„å…¨å±€é…ç½®æ”¾ç½®åœ¨åŒä¸€ä¸ªä½ç½®ï¼Œæ³¨è§£äº†@Controllerçš„ç±»çš„æ–¹æ³•å¯ä½¿ç”¨@ExceptionHandlerã€@InitBinderã€@ModelAttributeæ³¨è§£åˆ°æ–¹æ³•ä¸Šï¼Œè¿™å¯¹æ‰€æœ‰æ³¨è§£äº† @RequestMappingçš„æ§åˆ¶å™¨å†…çš„æ–¹æ³•æœ‰æ•ˆã€‚@ExceptionHandler ç”¨äºå…¨å±€å¤„ç†æ§åˆ¶å™¨é‡Œçš„å¼‚å¸¸@InitBinder ç”¨æ¥è®¾ç½®WebDataBinderï¼ŒWebDataBinderç”¨æ¥è‡ªåŠ¨ç»‘å®šå‰å°è¯·æ±‚å‚æ•°åˆ°Modelä¸­ã€‚@ModelAttribute æœ¬æ¥çš„ä½œç”¨æ˜¯ç»‘å®šé”®å€¼å¯¹åˆ°Modelé‡Œï¼Œåœ¨@ControllerAdviceä¸­æ˜¯è®©å…¨å±€çš„@RequestMappingéƒ½èƒ½è·å¾—åœ¨æ­¤å¤„è®¾ç½®çš„é”®å€¼å¯¹ã€‚spring ä¸‰ç§è£…é…æœºåˆ¶éšå¼çš„è‡ªåŠ¨è£…é…beanåœ¨ã€ŠSpringå®æˆ˜ã€‹è¿™æœ¬ä¹¦ä¸­å°†è‡ªåŠ¨è£…é…åˆ†ä¸ºäº†ä¸¤ä¸ªéƒ¨åˆ†ï¼ˆç»„ä»¶æ‰«æå’Œè‡ªåŠ¨è£…é…ï¼‰ï¼šç»„ä»¶æ‰«æï¼šSpringä¼šè‡ªåŠ¨å‘ç°åº”ç”¨ä¸Šä¸‹æ–‡ï¼ˆSpringå®¹å™¨ï¼‰ä¸­æ‰€åˆ›å»ºçš„beanï¼›è‡ªåŠ¨è£…é…ï¼šSpringè‡ªåŠ¨æ»¡è¶³beanä¹‹é—´çš„ä¾èµ–1ã€åˆ›å»ºå¯è¢«å‘ç°çš„bean1234&gt;package soundsystem;&gt;public interface CompactDisc{   void play();&gt;}åˆ›å»ºå¸¦æœ‰@Componentæ³¨è§£çš„CompactDiscæ¥å£çš„ä¸€ä¸ªå®ç°ç±»ï¼Œè¿™ä¸ªç±»ä¼šè¢«Springæ‰«æåˆ°å¹¶è‡ªåŠ¨åˆ›å»ºbean1234567891011&gt;package soundsystem;&gt;import ...&gt;@Component&gt;public class SgtPeppers implements CompactDisc{       private String title = &quot;Sgt, Pepper's Lonely Hearts Club Band&quot;;       private String artist = &quot;The Beatles&quot;;       public void play(){            System.out.println(&quot;Playing &quot; + title + &quot; By &quot; + artist);       }&gt;}ä½¿ç”¨@ComponentScanæ³¨è§£å¯åŠ¨ç»„ä»¶æ‰«æï¼Œ@ComponentScan é»˜è®¤ä¼šæ‰«æä¸é…ç½®ç±»ç›¸åŒçš„åŒ…ä»¥åŠå…¶ä¸‹æ‰€æœ‰çš„å­åŒ…ï¼Œè¿™æ ·ï¼Œè¢«@Componentæ³¨è§£ä¿®é¥°çš„ç±»å°±ä¼šè¢«å‘ç°123456&gt;package soundsystem;&gt;import ...&gt;@Configuration&gt;@ComponentScan&gt;public class CDPlayerConfig{}ä¹Ÿå¯ä»¥ä½¿ç”¨XMLé…ç½®çš„æ–¹å¼æ¥å¯åŠ¨ç»„ä»¶æ‰«æ12345&gt;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&gt;&lt;beans&gt;       &lt;context:component-scan base-package=&quot;soundsystem&quot;/&gt;&gt;&lt;/beans&gt;2ã€ä¸ºç»„ä»¶æ‰«æçš„ bean å‘½åè‹¥ç›´æ¥ä½¿ç”¨ @Component æ³¨è§£æ¥å£°æ˜ä¸€ä¸ª beanï¼Œbean çš„åå­—é»˜è®¤ä¸ºç±»åé¦–å­—æ¯å°å†™ã€‚ä¾‹å¦‚ï¼Œå¦‚ä¸‹ SgtPeppers ç±»çš„é»˜è®¤ bean åç§°ä¸º sgtPeppers1234&gt;@Component()&gt;public class SgtPeppers implements CompactDisc{   ...&gt;}å¯ä»¥åœ¨ @Component æ³¨è§£ä¸­è¯´æ˜æ­¤ bean çš„åç§°ï¼š1234&gt;@Component(&quot;lonelyHeartClub&quot;)&gt;public class SgtPeppers implements CompactDisc{   ...&gt;}æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å¦å¤–ä¸€ç§ä¸º bean å‘½åçš„æ–¹å¼ï¼š1234567&gt;package soundsystem;&gt;import javax.inject.Named;&gt;@Named(&quot;lonelyHeartClub&quot;)&gt;public class SgtPeppers implements CompactDisc{   ...&gt;}Spring æ”¯æŒå°† @Named ä½œä¸º @Component æ³¨è§£çš„æ›¿ä»£æ–¹æ¡ˆï¼Œä¸¤è€…ä¹‹é—´æœ‰ä¸€äº›ç»†å¾®çš„å·®å¼‚ï¼Œä½†åœ¨å¤§å¤šæ•°åœºæ™¯ä¸‹ï¼Œå®ƒä»¬æ˜¯å¯ä»¥ç›¸äº’æ›¿æ¢çš„ã€‚æ¨èä½¿ç”¨ @Component æ³¨è§£ï¼Œå› ä¸º @Named æ³¨è§£å¹¶ä¸èƒ½æ¸…æ¥šçš„è¡¨æ˜å®ƒæ˜¯åšä»€ä¹ˆçš„3ã€è®¾ç½®ç»„ä»¶æ‰«æçš„åŸºç¡€åŒ…åœ¨ä¹‹å‰çš„æ¡ˆåˆ—ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰ä¸º @ComponentScan æ³¨è§£è®¾ç½®ä»»ä½•å±æ€§ï¼Œè¿™æ„å‘³ç€ï¼ŒæŒ‰ç…§é»˜è®¤è§„åˆ™ï¼Œå®ƒä¼šä»¥é…ç½®ç±»æ‰€åœ¨åŒ…ä½œä¸ºåŸºç¡€åŒ…ï¼ˆ base  package ï¼‰æ¥æ‰«æç»„ä»¶.åœ¨ä¹‹å‰çš„æ¡ˆåˆ—ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰ä¸º @ComponentScan æ³¨è§£è®¾ç½®ä»»ä½•å±æ€§ï¼Œè¿™æ„å‘³ç€ï¼ŒæŒ‰ç…§é»˜è®¤è§„åˆ™ï¼Œå®ƒä¼šä»¥é…ç½®ç±»æ‰€åœ¨åŒ…ä½œä¸ºåŸºç¡€åŒ…ï¼ˆ base package ï¼‰æ¥æ‰«æç»„ä»¶.æœ‰ä¸€ä¸ªåŸå› ä¼šä¿ƒä½¿æˆ‘ä»¬è¦æ˜ç¡®çš„è®¾ç½®åŸºç¡€åŒ…ï¼Œé‚£å°±æ˜¯æˆ‘ä»¬æƒ³è¦å°†é…ç½®ç±»æ”¾åœ¨å•ç‹¬çš„åŒ…ä¸­ï¼Œä½¿å…¶ä¸å…¶ä»–çš„åº”ç”¨ä»£ç åŒºåˆ†å¼€æ¥ã€‚ä¸ºäº†æŒ‡å®šä¸åŒçš„åŒ…ï¼Œåªéœ€è¦åœ¨ @ComponentScan çš„ value å±æ€§ä¸­æŒ‡æ˜åŒ…çš„åç§°ï¼š123&gt;@Configuration&gt;@ComponentScan(&quot;soundsystem&quot;)&gt;public class CDPlayerConfig{}æˆ–è€…ï¼Œå¦‚æœä½ æƒ³æ›´åŠ æ˜ç¡®çš„è¡¨åä½ æ‰€è®¾ç½®çš„æ˜¯åŸºç¡€åŒ…ï¼Œé‚£ä¹ˆä½ å¯ä»¥é€šè¿‡ basePackages å±æ€§è¿›è¡Œé…ç½®ï¼š123&gt;@Configuration&gt;@ComponentScan(basePackages=&quot;soundsystem&quot;)&gt;public class CDPlayerConfig{}å¦‚æœä½ æƒ³æ‰«æå¤šä¸ªåŒ…ï¼Œåªéœ€è¦å°† basePackages å±æ€§çš„å€¼è®¾ç½®ä¸ºè¦æ‰«æåŒ…çš„ä¸€ä¸ªæ•°ç»„å³å¯ï¼š123&gt;@Configuration&gt;@ComponentScan(basePackages={&quot;soundsystem&quot;,&quot;video&quot;})&gt;public class CDPlayerConfig{}æ³¨æ„åˆ°ï¼ŒbasePackages å±æ€§çš„å€¼æ˜¯ä¸€ä¸ª String ç±»å‹çš„æ•°ç»„ï¼Œè¿™æ ·é…ç½®æ²¡æœ‰é—®é¢˜ï¼Œä½†å´æ˜¯ä¸å®‰å…¨çš„ï¼Œå¦‚æœè¦é‡æ„ä»£ç çš„è¯ï¼Œè¿™äº›åŒ…çš„åå­—å¯èƒ½ä¼šè¢«ä¿®æ”¹ï¼Œä»è€Œå¯¼è‡´åŒ…æ‰«æå‡ºç°é”™è¯¯ï¼Œé™¤äº†å°†åŒ…è®¾ç½®ä¸ºç®€å•çš„ String ç±»å‹ä¹‹å¤–ï¼Œ@ComponentScan è¿˜æä¾›äº†å¦ä¸€ç§æ–¹æ³•ï¼Œé‚£å°±æ˜¯å°†å…¶æŒ‡å®šä¸ºè¦æ‰«æåŒ…ä¸­æ‰€å«çš„ç±»æˆ–æ¥å£ã€‚123&gt;@Configuration&gt;@ComponentScan(basePackageClasses={CDPlayer.class, DVDPlayer.class})&gt;public class CDPlayerConfig{}ä½ å¯ä»¥åœ¨åŒ…ä¸­è®¾ç½®ä¸€ä¸ªä¸“é—¨ç”¨æ¥è¿›è¡ŒåŒ…æ‰«æçš„ç©ºæ ‡è®°æ¥å£ï¼Œè¿™æ ·ï¼Œå¯ä»¥é¿å…å¯¹ä»»ä½•å®é™…åº”ç”¨çš„ä»£ç è¿›è¡Œé‡æ„åï¼ŒåŒ…æ‰«æå‡ºç°é”™è¯¯ã€‚4ã€é€šè¿‡ä¸º bean æ·»åŠ æ³¨è§£å®ç°è‡ªåŠ¨è£…é…å¦‚æœæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºæ‰€æœ‰å¯¹è±¡éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œ å½¼æ­¤ä¹‹é—´æ²¡æœ‰ä»»ä½•ä¾èµ–ï¼Œé‚£ä¹ˆä»…ä»…ä½¿ç”¨Springçš„æ‰«æåŠŸèƒ½å°±ç®—å®Œäº‹äº†,å®ƒä¼šè‡ªåŠ¨çš„å¸®æˆ‘ä»¬æŠŠJavaå¯¹è±¡åˆ›å»º.ä½†æ˜¯å¦‚æœå¯¹è±¡ä¸å¯¹è±¡ä¹‹é—´å¦‚æœå­˜åœ¨ç›¸äº’ä¾èµ–çš„è”ç³»æ—¶,æˆ‘ä»¬å°±éœ€è¦ç”¨çš„Springç»™æˆ‘ä»¬æä¾›çš„è‡ªåŠ¨è£…é…äº†.1234567891011&gt;@Component&gt;public class CDPlayer implements MediaPlayer{       private CompactDisc cd;       @Autowired       public CDPlayer(CompacrDisc cd){            this.cd = cd;       }       public void play(){            cd.play();       }&gt;}ä»¥ä¸Šç¤ºä¾‹çš„æ„é€ å™¨ä¸Šæ·»åŠ äº† @Autowired æ³¨è§£ï¼Œè¿™è¡¨æ˜å½“ Spring åˆ›å»º CDPlayer bean çš„æ—¶å€™ï¼Œä¼šé€šè¿‡è¿™ä¸ªæ„é€ å™¨è¿›è¡Œå®ä¾‹åŒ–å¹¶ä¼ å…¥ä¸€ä¸ª CompactDisc ç±»å‹çš„ beanã€‚@Autowired æ³¨è§£ä¸ä»…èƒ½å¤Ÿç”¨åœ¨æ„é€ å™¨ä¸Šï¼Œè¿˜å¯ä»¥ç”¨åœ¨å±æ€§è®¾ç½®çš„ Setter æ–¹æ³•ä¸Šã€‚å®é™…ä¸Šï¼ŒSetter æ–¹æ³•å¹¶æ²¡æœ‰ä»€ä¹ˆç‰¹æ®Šä¹‹å¤„ï¼Œ@Autowired æ³¨è§£å¯ä»¥ç”¨åœ¨ç±»çš„ä»»ä½•æ–¹æ³•ä¸Šï¼šå¦‚ä¸‹ï¼Œ@Autowired æ³¨è§£å®Œå…¨èƒ½å¤Ÿå‘æŒ¥ä½œç”¨1234&gt;@Autowired&gt;public void insertDisc(CompactDisc cd){       this.cd = cd;&gt;}ä¸ç®¡æ˜¯æ„é€ å™¨ã€Setter æ–¹æ³•è¿˜æ˜¯å…¶ä»–æ–¹æ³•ï¼ŒSpring éƒ½ä¼šå°è¯•æ»¡è¶³æ–¹æ³•å‚æ•°ä¸Šæ‰€å£°æ˜çš„ä¾èµ–ï¼Œå‡å¦‚æœ‰ä¸”ä»…æœ‰ä¸€ä¸ª bean ä¾èµ–éœ€æ±‚çš„è¯ï¼Œé‚£ä¹ˆè¿™ä¸ª bean å°±ä¼šè¢«è£…å¡«è¿›æ¥ã€‚å¦‚æœæ²¡æœ‰åŒ¹é…çš„ beanï¼Œé‚£ä¹ˆåœ¨åº”ç”¨ä¸Šä¸‹æ–‡åˆ›å»ºçš„æ—¶å€™ï¼ŒSpring ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚ä¸ºäº†é¿å…å¼‚å¸¸çš„å‡ºç°ï¼Œä½ å¯ä»¥å°† @Autowired çš„ required å±æ€§è®¾ç½®ä¸º falseï¼š1234&gt;@Autowired(required=false)&gt;public CDPlayer(CompactDisc cd){       this.cd = cd;&gt;}å¦‚æœæœ‰å¤šä¸ª bean éƒ½èƒ½æ»¡è¶³ä¾èµ–å…³ç³»çš„è¯ï¼ŒSpring ä¹Ÿå°†ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œè¡¨æ˜æ²¡æœ‰æ˜ç¡®æŒ‡å®šè¦é€‰æ‹©é‚£ä¸ª bean è¿›è¡Œè£…é…ã€‚æ€»ç»“ä¸€ä¸‹ï¼Œè‡ªåŠ¨è£…é…beançš„è¿‡ç¨‹ï¼šä¸€ã€æŠŠéœ€è¦è¢«æ‰«æçš„ç±»ï¼Œæ·»åŠ  @Componentæ³¨è§£ï¼Œä½¿å®ƒèƒ½å¤Ÿè¢«Springè‡ªåŠ¨å‘ç°ã€‚äºŒã€é€šè¿‡æ˜¾ç¤ºçš„è®¾ç½®Javaä»£ç  @ComponentScanæ³¨è§£æˆ–XMLé…ç½®ï¼Œè®©Springå¼€å¯ç»„ä»¶æ‰«æï¼Œå¹¶å°†æ‰«æçš„ç»“æœç±»åˆ›å»ºbeanã€‚ä¸‰ã€@Autowriedæ³¨è§£èƒ½å¶å®ç°beançš„è‡ªåŠ¨è£…é…ï¼Œå®ç°ä¾èµ–æ³¨å…¥ã€‚å¤„ç†è‡ªåŠ¨è£…é…çš„æ­§ä¹‰æ€§é—®é¢˜ï¼ŒSpring. å¤„ç†è‡ªåŠ¨è£…é…çš„æ­§ä¹‰æ€§é€šè¿‡javaä»£ç è£…é…beané€šXMLä¸­è£…é…bean</content>
	</entry>
	<entry>
		<title>å¤šçº¿ç¨‹_JUCçº¿ç¨‹æ± </title>
		<url>/article/5912654c.html</url>
		<content>JUCçº¿ç¨‹æ± 1234567891011121314151617181920212223242526271. Executorå®ƒæ˜¯&quot;æ‰§è¡Œè€…&quot;æ¥å£ï¼Œå®ƒæ˜¯æ¥æ‰§è¡Œä»»åŠ¡çš„ã€‚å‡†ç¡®çš„è¯´ï¼ŒExecutoræä¾›äº†execute()æ¥å£æ¥æ‰§è¡Œå·²æäº¤çš„ Runnable ä»»åŠ¡çš„å¯¹è±¡ã€‚Executorå­˜åœ¨çš„ç›®çš„æ˜¯æä¾›ä¸€ç§å°†&quot;ä»»åŠ¡æäº¤&quot;ä¸&quot;ä»»åŠ¡å¦‚ä½•è¿è¡Œ&quot;åˆ†ç¦»å¼€æ¥çš„æœºåˆ¶ã€‚å®ƒåªåŒ…å«ä¸€ä¸ªå‡½æ•°æ¥å£ï¼švoid execute(Runnable command)2. ExecutorServiceExecutorServiceç»§æ‰¿äºExecutorã€‚å®ƒæ˜¯&quot;æ‰§è¡Œè€…æœåŠ¡&quot;æ¥å£ï¼Œå®ƒæ˜¯ä¸º&quot;æ‰§è¡Œè€…æ¥å£Executor&quot;æœåŠ¡è€Œå­˜åœ¨çš„ï¼›å‡†ç¡®çš„è¯ï¼ŒExecutorServiceæä¾›äº†&quot;å°†ä»»åŠ¡æäº¤ç»™æ‰§è¡Œè€…çš„æ¥å£(submitæ–¹æ³•)&quot;ï¼Œ&quot;è®©æ‰§è¡Œè€…æ‰§è¡Œä»»åŠ¡(invokeAll, invokeAnyæ–¹æ³•)&quot;çš„æ¥å£ç­‰ç­‰ã€‚3. AbstractExecutorServiceAbstractExecutorServiceæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ƒå®ç°äº†ExecutorServiceæ¥å£ã€‚AbstractExecutorServiceå­˜åœ¨çš„ç›®çš„æ˜¯ä¸ºExecutorServiceä¸­çš„å‡½æ•°æ¥å£æä¾›äº†é»˜è®¤å®ç°ã€‚AbstractExecutorServiceå‡½æ•°åˆ—è¡¨ç”±äºå®ƒçš„å‡½æ•°åˆ—è¡¨å’ŒExecutorServiceä¸€æ ·ï¼Œè¿™é‡Œå°±ä¸å†é‡å¤åˆ—ä¸¾äº†ã€‚4. ThreadPoolExecutorThreadPoolExecutorå°±æ˜¯å¤§åé¼é¼çš„&quot;çº¿ç¨‹æ± &quot;ã€‚å®ƒç»§æ‰¿äºAbstractExecutorServiceæŠ½è±¡ç±»ã€‚5. ScheduledExecutorServiceScheduledExecutorServiceæ˜¯ä¸€ä¸ªæ¥å£ï¼Œå®ƒç»§æ‰¿äºäºExecutorServiceã€‚å®ƒç›¸å½“äºæä¾›äº†&quot;å»¶æ—¶&quot;å’Œ&quot;å‘¨æœŸæ‰§è¡Œ&quot;åŠŸèƒ½çš„ExecutorServiceã€‚ScheduledExecutorServiceæä¾›äº†ç›¸åº”çš„å‡½æ•°æ¥å£ï¼Œå¯ä»¥å®‰æ’ä»»åŠ¡åœ¨ç»™å®šçš„å»¶è¿Ÿåæ‰§è¡Œï¼Œä¹Ÿå¯ä»¥è®©ä»»åŠ¡å‘¨æœŸçš„æ‰§è¡Œã€‚6. ScheduledThreadPoolExecutorScheduledThreadPoolExecutorç»§æ‰¿äºThreadPoolExecutorï¼Œå¹¶ä¸”å®ç°äº†ScheduledExecutorServiceæ¥å£ã€‚å®ƒç›¸å½“äºæä¾›äº†&quot;å»¶æ—¶&quot;å’Œ&quot;å‘¨æœŸæ‰§è¡Œ&quot;åŠŸèƒ½çš„ScheduledExecutorServiceã€‚ScheduledThreadPoolExecutorç±»ä¼¼äºTimerï¼Œä½†æ˜¯åœ¨é«˜å¹¶å‘ç¨‹åºä¸­ï¼ŒScheduledThreadPoolExecutorçš„æ€§èƒ½è¦ä¼˜äºTimerã€‚7. ExecutorsExecutorsæ˜¯ä¸ªé™æ€å·¥å‚ç±»ã€‚å®ƒé€šè¿‡é™æ€å·¥å‚æ–¹æ³•è¿”å›ExecutorServiceã€ScheduledExecutorServiceã€ThreadFactory å’Œ Callable ç­‰ç±»çš„å¯¹è±¡ã€‚çº¿ç¨‹æ± ç¤ºä¾‹12345678910111213141516171819202122232425262728293031323334353637383940import java.util.concurrent.Executors;import java.util.concurrent.ExecutorService;public class ThreadPoolDemo1 {    public static void main(String[] args) {        // åˆ›å»ºä¸€ä¸ªå¯é‡ç”¨å›ºå®šçº¿ç¨‹æ•°çš„çº¿ç¨‹æ±         ExecutorService pool = Executors.newFixedThreadPool(2);        // åˆ›å»ºå®ç°äº†Runnableæ¥å£å¯¹è±¡ï¼ŒThreadå¯¹è±¡å½“ç„¶ä¹Ÿå®ç°äº†Runnableæ¥å£        Thread ta = new MyThread();        Thread tb = new MyThread();        Thread tc = new MyThread();        Thread td = new MyThread();        Thread te = new MyThread();        // å°†çº¿ç¨‹æ”¾å…¥æ± ä¸­è¿›è¡Œæ‰§è¡Œ        pool.execute(ta);        pool.execute(tb);        pool.execute(tc);        pool.execute(td);        pool.execute(te);        // å…³é—­çº¿ç¨‹æ±         pool.shutdown();    }}class MyThread extends Thread {    @Override    public void run() {        System.out.println(Thread.currentThread().getName()+ &quot; is running.&quot;);    }}è¿è¡Œç»“æœï¼špool-1-thread-1 is running.pool-1-thread-2 is running.pool-1-thread-1 is running.pool-1-thread-2 is running.pool-1-thread-1 is running.ç»“æœè¯´æ˜ï¼šä¸»çº¿ç¨‹ä¸­åˆ›å»ºäº†çº¿ç¨‹æ± poolï¼Œçº¿ç¨‹æ± çš„å®¹é‡æ˜¯2ã€‚å³ï¼Œçº¿ç¨‹æ± ä¸­æœ€å¤šèƒ½åŒæ—¶è¿è¡Œ2ä¸ªçº¿ç¨‹ã€‚ç´§æ¥ç€ï¼Œå°†ta,tb,tc,td,teè¿™3ä¸ªçº¿ç¨‹æ·»åŠ åˆ°çº¿ç¨‹æ± ä¸­è¿è¡Œã€‚æœ€åï¼Œé€šè¿‡shutdown()å…³é—­çº¿ç¨‹æ± ã€‚çº¿ç¨‹æ± åŸç†(ä¸Š)ThreadPoolExecutorç®€ä»‹ThreadPoolExecutoræ˜¯çº¿ç¨‹æ± ç±»ã€‚å¯¹äºçº¿ç¨‹æ± ï¼Œå¯ä»¥é€šä¿—çš„å°†å®ƒç†è§£ä¸ºâ€å­˜æ”¾ä¸€å®šæ•°é‡çº¿ç¨‹çš„ä¸€ä¸ªçº¿ç¨‹é›†åˆã€‚çº¿ç¨‹æ± å…è®¸è‹¥ä¸ªçº¿ç¨‹åŒæ—¶å…è®¸ï¼Œå…è®¸åŒæ—¶è¿è¡Œçš„çº¿ç¨‹æ•°é‡å°±æ˜¯çº¿ç¨‹æ± çš„å®¹é‡ï¼›å½“æ·»åŠ çš„åˆ°çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹è¶…è¿‡å®ƒçš„å®¹é‡æ—¶ï¼Œä¼šæœ‰ä¸€éƒ¨åˆ†çº¿ç¨‹é˜»å¡ç­‰å¾…ã€‚çº¿ç¨‹æ± ä¼šé€šè¿‡ç›¸åº”çš„è°ƒåº¦ç­–ç•¥å’Œæ‹’ç»ç­–ç•¥ï¼Œå¯¹æ·»åŠ åˆ°çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹è¿›è¡Œç®¡ç†ã€‚â€1234567891011121314151617181920212223// é˜»å¡é˜Ÿåˆ—ã€‚private final BlockingQueue&lt;Runnable&gt; workQueue;// äº’æ–¥é”private final ReentrantLock mainLock = new ReentrantLock();// çº¿ç¨‹é›†åˆã€‚ä¸€ä¸ªWorkerå¯¹åº”ä¸€ä¸ªçº¿ç¨‹ã€‚private final HashSet&lt;Worker&gt; workers = new HashSet&lt;Worker&gt;();// â€œç»ˆæ­¢æ¡ä»¶â€ï¼Œä¸â€œmainLockâ€ç»‘å®šã€‚private final Condition termination = mainLock.newCondition();// çº¿ç¨‹æ± ä¸­çº¿ç¨‹æ•°é‡æ›¾ç»è¾¾åˆ°è¿‡çš„æœ€å¤§å€¼ã€‚private int largestPoolSize;// å·²å®Œæˆä»»åŠ¡æ•°é‡private long completedTaskCount;// ThreadFactoryå¯¹è±¡ï¼Œç”¨äºåˆ›å»ºçº¿ç¨‹ã€‚private volatile ThreadFactory threadFactory;// æ‹’ç»ç­–ç•¥çš„å¤„ç†å¥æŸ„ã€‚private volatile RejectedExecutionHandler handler;// ä¿æŒçº¿ç¨‹å­˜æ´»æ—¶é—´ã€‚private volatile long keepAliveTime;private volatile boolean allowCoreThreadTimeOut;// æ ¸å¿ƒæ± å¤§å°private volatile int corePoolSize;// æœ€å¤§æ± å¤§å°private volatile int maximumPoolSize;workers    workersæ˜¯HashSetç±»å‹ï¼Œå³å®ƒæ˜¯ä¸€ä¸ªWorkeré›†åˆã€‚è€Œä¸€ä¸ªWorkerå¯¹åº”ä¸€ä¸ªçº¿ç¨‹ï¼Œä¹Ÿå°±æ˜¯è¯´çº¿ç¨‹æ± é€šè¿‡workersåŒ…å«äº†â€ä¸€ä¸ªçº¿ç¨‹é›†åˆâ€ã€‚å½“Workerå¯¹åº”çš„çº¿ç¨‹æ± å¯åŠ¨æ—¶ï¼Œå®ƒä¼šæ‰§è¡Œçº¿ç¨‹æ± ä¸­çš„ä»»åŠ¡ï¼›å½“æ‰§è¡Œå®Œä¸€ä¸ªä»»åŠ¡åï¼Œå®ƒä¼šä»çº¿ç¨‹æ± çš„é˜»å¡é˜Ÿåˆ—ä¸­å–å‡ºä¸€ä¸ªé˜»å¡çš„ä»»åŠ¡æ¥ç»§ç»­è¿è¡Œã€‚    wokersçš„ä½œç”¨æ˜¯ï¼Œçº¿ç¨‹æ± é€šè¿‡å®ƒå®ç°äº†â€å…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è¿è¡Œâ€ã€‚workQueue    workQueueæ˜¯BlockingQueueç±»å‹ï¼Œå³å®ƒæ˜¯ä¸€ä¸ªé˜»å¡é˜Ÿåˆ—ã€‚å½“çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°è¶…è¿‡å®ƒçš„å®¹é‡çš„æ—¶å€™ï¼Œçº¿ç¨‹ä¼šè¿›å…¥é˜»å¡é˜Ÿåˆ—è¿›è¡Œé˜»å¡ç­‰å¾…ã€‚    é€šè¿‡workQueueï¼Œçº¿ç¨‹æ± å®ç°äº†é˜»å¡åŠŸèƒ½ã€‚mainLock    mainLockæ˜¯äº’æ–¥é”ï¼Œé€šè¿‡mainLockå®ç°äº†å¯¹çº¿ç¨‹æ± çš„äº’æ–¥è®¿é—®ã€‚corePoolSizeå’ŒmaximumPoolSize    corePoolSizeæ˜¯â€æ ¸å¿ƒæ± å¤§å°â€ï¼ŒmaximumPoolSizeæ˜¯â€æœ€å¤§æ± å¤§å°â€ã€‚å®ƒä»¬çš„ä½œç”¨æ˜¯è°ƒæ•´â€çº¿ç¨‹æ± ä¸­å®é™…è¿è¡Œçš„çº¿ç¨‹çš„æ•°é‡â€ã€‚    ä¾‹å¦‚ï¼Œå½“æ–°ä»»åŠ¡æäº¤ç»™çº¿ç¨‹æ± æ—¶(é€šè¿‡executeæ–¹æ³•)ã€‚          â€” å¦‚æœæ­¤æ—¶ï¼Œçº¿ç¨‹æ± ä¸­è¿è¡Œçš„çº¿ç¨‹æ•°é‡&lt; corePoolSizeï¼Œåˆ™åˆ›å»ºæ–°çº¿ç¨‹æ¥å¤„ç†è¯·æ±‚ã€‚          â€” å¦‚æœæ­¤æ—¶ï¼Œçº¿ç¨‹æ± ä¸­è¿è¡Œçš„çº¿ç¨‹æ•°é‡&gt; corePoolSizeï¼Œä½†æ˜¯å´&lt; maximumPoolSizeï¼›åˆ™ä»…å½“é˜»å¡é˜Ÿåˆ—æ»¡æ—¶æ‰åˆ›å»ºæ–°çº¿ç¨‹ã€‚          å¦‚æœè®¾ç½®çš„ corePoolSize å’Œ maximumPoolSize ç›¸åŒï¼Œåˆ™åˆ›å»ºäº†å›ºå®šå¤§å°çš„çº¿ç¨‹æ± ã€‚å¦‚æœå°† maximumPoolSize è®¾ç½®ä¸ºåŸºæœ¬çš„æ— ç•Œå€¼ï¼ˆå¦‚ Integer.MAX_VALUEï¼‰ï¼Œåˆ™å…è®¸æ± é€‚åº”ä»»æ„æ•°é‡çš„å¹¶å‘ä»»åŠ¡ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ ¸å¿ƒæ± å¤§å°å’Œæœ€å¤§æ± å¤§å°çš„å€¼æ˜¯åœ¨åˆ›å»ºçº¿ç¨‹æ± è®¾ç½®çš„ï¼›ä½†æ˜¯ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ setCorePoolSize(int) å’Œ setMaximumPoolSize(int) è¿›è¡ŒåŠ¨æ€æ›´æ”¹ã€‚poolSize    poolSizeæ˜¯å½“å‰çº¿ç¨‹æ± çš„å®é™…å¤§å°ï¼Œå³çº¿ç¨‹æ± ä¸­ä»»åŠ¡çš„æ•°é‡ã€‚allowCoreThreadTimeOutå’ŒkeepAliveTime    allowCoreThreadTimeOutè¡¨ç¤ºæ˜¯å¦å…è®¸â€çº¿ç¨‹åœ¨ç©ºé—²çŠ¶æ€æ—¶ï¼Œä»ç„¶èƒ½å¤Ÿå­˜æ´»â€ï¼›è€ŒkeepAliveTimeæ˜¯å½“çº¿ç¨‹æ± å¤„äºç©ºé—²çŠ¶æ€çš„æ—¶å€™ï¼Œè¶…è¿‡keepAliveTimeæ—¶é—´ä¹‹åï¼Œç©ºé—²çš„çº¿ç¨‹ä¼šè¢«ç»ˆæ­¢ã€‚threadFactory    threadFactoryæ˜¯ThreadFactoryå¯¹è±¡ã€‚å®ƒæ˜¯ä¸€ä¸ªçº¿ç¨‹å·¥å‚ç±»ï¼Œâ€çº¿ç¨‹æ± é€šè¿‡ThreadFactoryåˆ›å»ºçº¿ç¨‹â€ã€‚handler    handleræ˜¯RejectedExecutionHandlerç±»å‹ã€‚å®ƒæ˜¯â€çº¿ç¨‹æ± æ‹’ç»ç­–ç•¥â€çš„å¥æŸ„ï¼Œä¹Ÿå°±æ˜¯è¯´â€å½“æŸä»»åŠ¡æ·»åŠ åˆ°çº¿ç¨‹æ± ä¸­ï¼Œè€Œçº¿ç¨‹æ± æ‹’ç»è¯¥ä»»åŠ¡æ—¶ï¼Œçº¿ç¨‹æ± ä¼šé€šè¿‡handlerè¿›è¡Œç›¸åº”çš„å¤„ç†â€ã€‚ç»¼ä¸Šæ‰€è¯´ï¼Œçº¿ç¨‹æ± é€šè¿‡workersæ¥ç®¡ç†â€çº¿ç¨‹é›†åˆâ€ï¼Œæ¯ä¸ªçº¿ç¨‹åœ¨å¯åŠ¨åï¼Œä¼šæ‰§è¡Œçº¿ç¨‹æ± ä¸­çš„ä»»åŠ¡ï¼›å½“ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œåï¼Œå®ƒä¼šä»çº¿ç¨‹æ± çš„é˜»å¡é˜Ÿåˆ—ä¸­å–å‡ºä»»åŠ¡æ¥ç»§ç»­è¿è¡Œã€‚é˜»å¡é˜Ÿåˆ—æ˜¯ç®¡ç†çº¿ç¨‹æ± ä»»åŠ¡çš„é˜Ÿåˆ—ï¼Œå½“æ·»åŠ åˆ°çº¿ç¨‹æ± ä¸­çš„ä»»åŠ¡è¶…è¿‡çº¿ç¨‹æ± çš„å®¹é‡æ—¶ï¼Œè¯¥ä»»åŠ¡å°±ä¼šè¿›å…¥é˜»å¡é˜Ÿåˆ—è¿›è¡Œç­‰å¾…ã€‚çº¿ç¨‹æ± è°ƒåº¦è¯´æ˜ï¼š    åœ¨â€å›¾-01â€ä¸­ï¼Œçº¿ç¨‹æ± ä¸­æœ‰Nä¸ªä»»åŠ¡ã€‚â€ä»»åŠ¡1â€, â€œä»»åŠ¡2â€, â€œä»»åŠ¡3â€è¿™3ä¸ªä»»åŠ¡åœ¨æ‰§è¡Œï¼Œè€Œâ€ä»»åŠ¡3â€åˆ°â€ä»»åŠ¡Nâ€åœ¨é˜»å¡é˜Ÿåˆ—ä¸­ç­‰å¾…ã€‚æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡ï¼Œåœ¨workersé›†åˆä¸­ï¼Œworkersé›†åˆåŒ…å«3ä¸ªWorkerï¼Œæ¯ä¸€ä¸ªWorkerå¯¹åº”ä¸€ä¸ªThreadçº¿ç¨‹ï¼ŒThreadçº¿ç¨‹æ¯æ¬¡å¤„ç†ä¸€ä¸ªä»»åŠ¡ã€‚    å½“workersé›†åˆä¸­å¤„ç†å®ŒæŸä¸€ä¸ªä»»åŠ¡ä¹‹åï¼Œä¼šä»é˜»å¡é˜Ÿåˆ—ä¸­å–å‡ºä¸€ä¸ªä»»åŠ¡æ¥ç»§ç»­æ‰§è¡Œï¼Œå¦‚å›¾-02æ‰€ç¤ºã€‚å›¾-02è¡¨ç¤ºâ€ä»»åŠ¡1â€å¤„ç†å®Œæ¯•ä¹‹åï¼Œçº¿ç¨‹æ± å°†â€ä»»åŠ¡4â€ä»é˜»å¡é˜Ÿåˆ—ä¸­å–å‡ºï¼Œæ”¾åˆ°workersä¸­è¿›è¡Œå¤„ç†ã€‚çº¿ç¨‹æ± ç¤ºä¾‹1234567891011121314151617181920212223242526272829303132333435363738import java.util.concurrent.Executors;import java.util.concurrent.ExecutorService;public class ThreadPoolDemo1 {    public static void main(String[] args) {        // åˆ›å»ºä¸€ä¸ªå¯é‡ç”¨å›ºå®šçº¿ç¨‹æ•°çš„çº¿ç¨‹æ±         ExecutorService pool = Executors.newFixedThreadPool(2);        // åˆ›å»ºå®ç°äº†Runnableæ¥å£å¯¹è±¡ï¼ŒThreadå¯¹è±¡å½“ç„¶ä¹Ÿå®ç°äº†Runnableæ¥å£        Thread ta = new MyThread();        Thread tb = new MyThread();        Thread tc = new MyThread();        Thread td = new MyThread();        Thread te = new MyThread();        // å°†çº¿ç¨‹æ”¾å…¥æ± ä¸­è¿›è¡Œæ‰§è¡Œ        pool.execute(ta);        pool.execute(tb);        pool.execute(tc);        pool.execute(td);        pool.execute(te);        // å…³é—­çº¿ç¨‹æ±         pool.shutdown();    }}class MyThread extends Thread {    @Override    public void run() {        System.out.println(Thread.currentThread().getName()+ &quot; is running.&quot;);    }}è¿è¡Œç»“æœï¼špool-1-thread-1 is running.pool-1-thread-2 is running.pool-1-thread-1 is running.pool-1-thread-2 is running.pool-1-thread-1 is running.ç¤ºä¾‹ä¸­ï¼ŒåŒ…æ‹¬äº†çº¿ç¨‹æ± çš„åˆ›å»ºï¼Œå°†ä»»åŠ¡æ·»åŠ åˆ°çº¿ç¨‹æ± ä¸­ï¼Œå…³é—­çº¿ç¨‹æ± è¿™3ä¸ªä¸»è¦çš„æ­¥éª¤ã€‚åˆ›å»ºçº¿ç¨‹æ± 123456789101112131415161718192021222324252627282930313233343536371. newFixedThreadPool()newFixedThreadPool()åœ¨Executors.javaä¸­å®šä¹‰ï¼Œæºç å¦‚ä¸‹ï¼špublic static ExecutorService newFixedThreadPool(int nThreads) {    return new ThreadPoolExecutor(nThreads, nThreads,                                  0L, TimeUnit.MILLISECONDS,                                  new LinkedBlockingQueue&lt;Runnable&gt;());}è¯´æ˜ï¼šnewFixedThreadPool(int nThreads)çš„ä½œç”¨æ˜¯åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ± ï¼Œçº¿ç¨‹æ± çš„å®¹é‡æ˜¯nThreadsã€‚newFixedThreadPool()åœ¨è°ƒç”¨ThreadPoolExecutor()æ—¶ï¼Œä¼šä¼ é€’ä¸€ä¸ªLinkedBlockingQueue()å¯¹è±¡ï¼Œè€ŒLinkedBlockingQueueæ˜¯å•å‘é“¾è¡¨å®ç°çš„é˜»å¡é˜Ÿåˆ—ã€‚åœ¨çº¿ç¨‹æ± ä¸­ï¼Œå°±æ˜¯é€šè¿‡è¯¥é˜»å¡é˜Ÿåˆ—æ¥å®ç°&quot;å½“çº¿ç¨‹æ± ä¸­ä»»åŠ¡æ•°é‡è¶…è¿‡å…è®¸çš„ä»»åŠ¡æ•°é‡æ—¶ï¼Œéƒ¨åˆ†ä»»åŠ¡ä¼šé˜»å¡ç­‰å¾…&quot;ã€‚2. ThreadPoolExecutor()ThreadPoolExecutor()åœ¨ThreadPoolExecutor.javaä¸­å®šä¹‰ï¼Œæºç å¦‚ä¸‹ï¼špublic ThreadPoolExecutor(int corePoolSize,                          int maximumPoolSize,                          long keepAliveTime,                          TimeUnit unit,                          BlockingQueue&lt;Runnable&gt; workQueue) {    this(corePoolSize, maximumPoolSize, keepAliveTime, unit, workQueue,         Executors.defaultThreadFactory(), defaultHandler);}è¯´æ˜ï¼šè¯¥å‡½æ•°å®é™…ä¸Šæ˜¯è°ƒç”¨ThreadPoolExecutorçš„å¦å¤–ä¸€ä¸ªæ„é€ å‡½æ•°ã€‚è¯´æ˜ï¼šåœ¨ThreadPoolExecutor()çš„æ„é€ å‡½æ•°ä¸­ï¼Œè¿›è¡Œçš„æ˜¯åˆå§‹åŒ–å·¥ä½œã€‚corePoolSize, maximumPoolSize, unit, keepAliveTimeå’ŒworkQueueè¿™äº›å˜é‡çš„å€¼æ˜¯å·²çŸ¥çš„ï¼Œå®ƒä»¬éƒ½æ˜¯é€šè¿‡newFixedThreadPool()ä¼ é€’è€Œæ¥ã€‚ä¸‹é¢çœ‹çœ‹threadFactoryå’Œhandlerå¯¹è±¡ã€‚2.1 ThreadFactoryçº¿ç¨‹æ± ä¸­çš„ThreadFactoryæ˜¯ä¸€ä¸ªçº¿ç¨‹å·¥å‚ï¼Œçº¿ç¨‹æ± åˆ›å»ºçº¿ç¨‹éƒ½æ˜¯é€šè¿‡çº¿ç¨‹å·¥å‚å¯¹è±¡(threadFactory)æ¥å®Œæˆçš„ã€‚ä¸Šé¢æ‰€è¯´çš„threadFactoryå¯¹è±¡ï¼Œæ˜¯é€šè¿‡ Executors.defaultThreadFactory()è¿”å›çš„ã€‚public static ThreadFactory defaultThreadFactory() {    return new DefaultThreadFactory();}defaultThreadFactory()è¿”å›DefaultThreadFactoryå¯¹è±¡ã€‚è¯´æ˜ï¼šThreadFactoryçš„ä½œç”¨å°±æ˜¯æä¾›åˆ›å»ºçº¿ç¨‹çš„åŠŸèƒ½çš„çº¿ç¨‹å·¥å‚ã€‚å®ƒæ˜¯é€šè¿‡newThread()æä¾›åˆ›å»ºçº¿ç¨‹åŠŸèƒ½çš„ï¼Œä¸‹é¢ç®€å•è¯´è¯´newThread()ã€‚newThread()åˆ›å»ºçš„çº¿ç¨‹å¯¹åº”çš„ä»»åŠ¡æ˜¯Runnableå¯¹è±¡ï¼Œå®ƒåˆ›å»ºçš„çº¿ç¨‹éƒ½æ˜¯â€œéå®ˆæŠ¤çº¿ç¨‹â€è€Œä¸”â€œçº¿ç¨‹ä¼˜å…ˆçº§éƒ½æ˜¯Thread.NORM_PRIORITYâ€ã€‚2.2 RejectedExecutionHandlerhandleræ˜¯ThreadPoolExecutorä¸­æ‹’ç»ç­–ç•¥çš„å¤„ç†å¥æŸ„ã€‚æ‰€è°“æ‹’ç»ç­–ç•¥ï¼Œæ˜¯æŒ‡å°†ä»»åŠ¡æ·»åŠ åˆ°çº¿ç¨‹æ± ä¸­æ—¶ï¼Œçº¿ç¨‹æ± æ‹’ç»è¯¥ä»»åŠ¡æ‰€é‡‡å–çš„ç›¸åº”ç­–ç•¥ã€‚çº¿ç¨‹æ± é»˜è®¤ä¼šé‡‡ç”¨çš„æ˜¯defaultHandlerç­–ç•¥ï¼Œå³AbortPolicyç­–ç•¥ã€‚åœ¨AbortPolicyç­–ç•¥ä¸­ï¼Œçº¿ç¨‹æ± æ‹’ç»ä»»åŠ¡æ—¶ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚æ·»åŠ ä»»åŠ¡åˆ°çº¿ç¨‹æ± 1234567891011121314151. execute()è¯´æ˜ï¼šexecute()çš„ä½œç”¨æ˜¯å°†ä»»åŠ¡æ·»åŠ åˆ°çº¿ç¨‹æ± ä¸­æ‰§è¡Œã€‚å®ƒä¼šåˆ†ä¸º3ç§æƒ…å†µè¿›è¡Œå¤„ç†ï¼šæƒ…å†µ1 -- å¦‚æœ&quot;çº¿ç¨‹æ± ä¸­ä»»åŠ¡æ•°é‡&quot; &lt; &quot;æ ¸å¿ƒæ± å¤§å°&quot;æ—¶ï¼Œå³çº¿ç¨‹æ± ä¸­å°‘äºcorePoolSizeä¸ªä»»åŠ¡ï¼›æ­¤æ—¶å°±æ–°å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œå¹¶å°†è¯¥ä»»åŠ¡æ·»åŠ åˆ°çº¿ç¨‹ä¸­è¿›è¡Œæ‰§è¡Œã€‚æƒ…å†µ2 -- å¦‚æœ&quot;çº¿ç¨‹æ± ä¸­ä»»åŠ¡æ•°é‡&quot; &gt;= &quot;æ ¸å¿ƒæ± å¤§å°&quot;ï¼Œå¹¶ä¸”&quot;çº¿ç¨‹æ± æ˜¯å…è®¸çŠ¶æ€&quot;ï¼›æ­¤æ—¶ï¼Œåˆ™å°†ä»»åŠ¡æ·»åŠ åˆ°é˜»å¡é˜Ÿåˆ—ä¸­é˜»å¡ç­‰å¾…ã€‚åœ¨è¯¥æƒ…å†µä¸‹ï¼Œä¼šå†æ¬¡ç¡®è®¤&quot;çº¿ç¨‹æ± çš„çŠ¶æ€&quot;ï¼Œå¦‚æœ&quot;ç¬¬2æ¬¡è¯»åˆ°çš„çº¿ç¨‹æ± çŠ¶æ€&quot;å’Œ&quot;ç¬¬1æ¬¡è¯»åˆ°çš„çº¿ç¨‹æ± çŠ¶æ€&quot;ä¸åŒï¼Œåˆ™ä»é˜»å¡é˜Ÿåˆ—ä¸­åˆ é™¤è¯¥ä»»åŠ¡ã€‚æƒ…å†µ3 -- éä»¥ä¸Šä¸¤ç§æƒ…å†µã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå°è¯•æ–°å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œå¹¶å°†è¯¥ä»»åŠ¡æ·»åŠ åˆ°çº¿ç¨‹ä¸­è¿›è¡Œæ‰§è¡Œã€‚å¦‚æœæ‰§è¡Œå¤±è´¥ï¼Œåˆ™é€šè¿‡reject()æ‹’ç»è¯¥ä»»åŠ¡ã€‚2. addWorker()è¯´æ˜ï¼šaddWorker(Runnable firstTask, boolean core) çš„ä½œç”¨æ˜¯å°†ä»»åŠ¡(firstTask)æ·»åŠ åˆ°çº¿ç¨‹æ± ä¸­ï¼Œå¹¶å¯åŠ¨è¯¥ä»»åŠ¡ã€‚    coreä¸ºtrueçš„è¯ï¼Œåˆ™ä»¥corePoolSizeä¸ºç•Œé™ï¼Œè‹¥&quot;çº¿ç¨‹æ± ä¸­å·²æœ‰ä»»åŠ¡æ•°é‡&gt;=corePoolSize&quot;ï¼Œåˆ™è¿”å›falseï¼›coreä¸ºfalseçš„è¯ï¼Œåˆ™ä»¥maximumPoolSizeä¸ºç•Œé™ï¼Œè‹¥&quot;çº¿ç¨‹æ± ä¸­å·²æœ‰ä»»åŠ¡æ•°é‡&gt;=maximumPoolSize&quot;ï¼Œåˆ™è¿”å›falseã€‚    addWorker()ä¼šå…ˆé€šè¿‡forå¾ªç¯ä¸æ–­å°è¯•æ›´æ–°ctlçŠ¶æ€ï¼Œctlè®°å½•äº†&quot;çº¿ç¨‹æ± ä¸­ä»»åŠ¡æ•°é‡å’Œçº¿ç¨‹æ± çŠ¶æ€&quot;ã€‚    æ›´æ–°æˆåŠŸä¹‹åï¼Œå†é€šè¿‡tryæ¨¡å—æ¥å°†ä»»åŠ¡æ·»åŠ åˆ°çº¿ç¨‹æ± ä¸­ï¼Œå¹¶å¯åŠ¨ä»»åŠ¡æ‰€åœ¨çš„çº¿ç¨‹ã€‚    ä»addWorker()ä¸­ï¼Œæˆ‘ä»¬èƒ½æ¸…æ™°çš„å‘ç°ï¼šçº¿ç¨‹æ± åœ¨æ·»åŠ ä»»åŠ¡æ—¶ï¼Œä¼šåˆ›å»ºä»»åŠ¡å¯¹åº”çš„Workerå¯¹è±¡ï¼›è€Œä¸€ä¸ªWorkderå¯¹è±¡åŒ…å«ä¸€ä¸ªThreadå¯¹è±¡ã€‚(01) é€šè¿‡å°†Workerå¯¹è±¡æ·»åŠ åˆ°&quot;çº¿ç¨‹çš„workersé›†åˆ&quot;ä¸­ï¼Œä»è€Œå®ç°å°†ä»»åŠ¡æ·»åŠ åˆ°çº¿ç¨‹æ± ä¸­ã€‚ (02) é€šè¿‡å¯åŠ¨Workerå¯¹åº”çš„Threadçº¿ç¨‹ï¼Œåˆ™æ‰§è¡Œè¯¥ä»»åŠ¡ã€‚3. submit()è¡¥å……è¯´æ˜ä¸€ç‚¹ï¼Œsubmit()å®é™…ä¸Šä¹Ÿæ˜¯é€šè¿‡è°ƒç”¨execute()å®ç°çš„å…³é—­çº¿ç¨‹æ± 1è¯´æ˜ï¼šshutdown()çš„ä½œç”¨æ˜¯å…³é—­çº¿ç¨‹æ± ã€‚çº¿ç¨‹æ± åŸç†(ä¸‹)1çº¿ç¨‹æœ‰5ç§çŠ¶æ€ï¼šæ–°å»ºçŠ¶æ€ï¼Œå°±ç»ªçŠ¶æ€ï¼Œè¿è¡ŒçŠ¶æ€ï¼Œé˜»å¡çŠ¶æ€ï¼Œæ­»äº¡çŠ¶æ€ã€‚çº¿ç¨‹æ± ä¹Ÿæœ‰5ç§çŠ¶æ€ï¼›ç„¶è€Œï¼Œçº¿ç¨‹æ± ä¸åŒäºçº¿ç¨‹ï¼Œçº¿ç¨‹æ± çš„5ç§çŠ¶æ€æ˜¯ï¼šRunning, SHUTDOWN, STOP, TIDYING, TERMINATEDã€‚12345678910111213141516171819çº¿ç¨‹æ± çŠ¶æ€å®šä¹‰ä»£ç å¦‚ä¸‹ï¼šprivate final AtomicInteger ctl = new AtomicInteger(ctlOf(RUNNING, 0));private static final int COUNT_BITS = Integer.SIZE - 3;private static final int CAPACITY = (1 &lt;&lt; COUNT_BITS) - 1;private static final int RUNNING = -1 &lt;&lt; COUNT_BITS;private static final int SHUTDOWN = 0 &lt;&lt; COUNT_BITS;private static final int STOP = 1 &lt;&lt; COUNT_BITS;private static final int TIDYING = 2 &lt;&lt; COUNT_BITS;private static final int TERMINATED = 3 &lt;&lt; COUNT_BITS;private static int ctlOf(int rs, int wc) { return rs | wc; }è¯´æ˜ï¼šctlæ˜¯ä¸€ä¸ªAtomicIntegerç±»å‹çš„åŸå­å¯¹è±¡ã€‚ctlè®°å½•äº†&quot;çº¿ç¨‹æ± ä¸­çš„ä»»åŠ¡æ•°é‡&quot;å’Œ&quot;çº¿ç¨‹æ± çŠ¶æ€&quot;2ä¸ªä¿¡æ¯ã€‚ctlå…±åŒ…æ‹¬32ä½ã€‚å…¶ä¸­ï¼Œé«˜3ä½è¡¨ç¤º&quot;çº¿ç¨‹æ± çŠ¶æ€&quot;ï¼Œä½29ä½è¡¨ç¤º&quot;çº¿ç¨‹æ± ä¸­çš„ä»»åŠ¡æ•°é‡&quot;ã€‚RUNNING    -- å¯¹åº”çš„é«˜3ä½å€¼æ˜¯111ã€‚SHUTDOWN   -- å¯¹åº”çš„é«˜3ä½å€¼æ˜¯000ã€‚STOP       -- å¯¹åº”çš„é«˜3ä½å€¼æ˜¯001ã€‚TIDYING    -- å¯¹åº”çš„é«˜3ä½å€¼æ˜¯010ã€‚TERMINATED -- å¯¹åº”çš„é«˜3ä½å€¼æ˜¯011ã€‚çº¿ç¨‹çŠ¶æ€åˆ‡æ¢RUNNING(01) çŠ¶æ€è¯´æ˜ï¼šçº¿ç¨‹æ± å¤„åœ¨RUNNINGçŠ¶æ€æ—¶ï¼Œèƒ½å¤Ÿæ¥æ”¶æ–°ä»»åŠ¡ï¼Œä»¥åŠå¯¹å·²æ·»åŠ çš„ä»»åŠ¡è¿›è¡Œå¤„ç†ã€‚(02) çŠ¶æ€åˆ‡æ¢ï¼šçº¿ç¨‹æ± çš„åˆå§‹åŒ–çŠ¶æ€æ˜¯RUNNINGã€‚æ¢å¥è¯è¯´ï¼Œçº¿ç¨‹æ± è¢«ä¸€æ—¦è¢«åˆ›å»ºï¼Œå°±å¤„äºRUNNINGçŠ¶æ€ï¼é“ç†å¾ˆç®€å•ï¼Œåœ¨ctlçš„åˆå§‹åŒ–ä»£ç ä¸­(å¦‚ä¸‹)ï¼Œå°±å°†å®ƒåˆå§‹åŒ–ä¸ºRUNNINGçŠ¶æ€ï¼Œå¹¶ä¸”â€ä»»åŠ¡æ•°é‡â€åˆå§‹åŒ–ä¸º0ã€‚1private final AtomicInteger ctl = new AtomicInteger(ctlOf(RUNNING, 0))SHUTDOWN(01) çŠ¶æ€è¯´æ˜ï¼šçº¿ç¨‹æ± å¤„åœ¨SHUTDOWNçŠ¶æ€æ—¶ï¼Œä¸æ¥æ”¶æ–°ä»»åŠ¡ï¼Œä½†èƒ½å¤„ç†å·²æ·»åŠ çš„ä»»åŠ¡ã€‚(02) çŠ¶æ€åˆ‡æ¢ï¼šè°ƒç”¨çº¿ç¨‹æ± çš„shutdown()æ¥å£æ—¶ï¼Œçº¿ç¨‹æ± ç”±RUNNING -&gt; SHUTDOWNã€‚STOP(01) çŠ¶æ€è¯´æ˜ï¼šçº¿ç¨‹æ± å¤„åœ¨STOPçŠ¶æ€æ—¶ï¼Œä¸æ¥æ”¶æ–°ä»»åŠ¡ï¼Œä¸å¤„ç†å·²æ·»åŠ çš„ä»»åŠ¡ï¼Œå¹¶ä¸”ä¼šä¸­æ–­æ­£åœ¨å¤„ç†çš„ä»»åŠ¡ã€‚(02) çŠ¶æ€åˆ‡æ¢ï¼šè°ƒç”¨çº¿ç¨‹æ± çš„shutdownNow()æ¥å£æ—¶ï¼Œçº¿ç¨‹æ± ç”±(RUNNING or SHUTDOWN ) -&gt; STOPã€‚TIDYING(01) çŠ¶æ€è¯´æ˜ï¼šå½“æ‰€æœ‰çš„ä»»åŠ¡å·²ç»ˆæ­¢ï¼Œctlè®°å½•çš„â€ä»»åŠ¡æ•°é‡â€ä¸º0ï¼Œçº¿ç¨‹æ± ä¼šå˜ä¸ºTIDYINGçŠ¶æ€ã€‚å½“çº¿ç¨‹æ± å˜ä¸ºTIDYINGçŠ¶æ€æ—¶ï¼Œä¼šæ‰§è¡Œé’©å­å‡½æ•°terminated()ã€‚terminated()åœ¨ThreadPoolExecutorç±»ä¸­æ˜¯ç©ºçš„ï¼Œè‹¥ç”¨æˆ·æƒ³åœ¨çº¿ç¨‹æ± å˜ä¸ºTIDYINGæ—¶ï¼Œè¿›è¡Œç›¸åº”çš„å¤„ç†ï¼›å¯ä»¥é€šè¿‡é‡è½½terminated()å‡½æ•°æ¥å®ç°ã€‚(02) çŠ¶æ€åˆ‡æ¢ï¼šå½“çº¿ç¨‹æ± åœ¨SHUTDOWNçŠ¶æ€ä¸‹ï¼Œé˜»å¡é˜Ÿåˆ—ä¸ºç©ºå¹¶ä¸”çº¿ç¨‹æ± ä¸­æ‰§è¡Œçš„ä»»åŠ¡ä¹Ÿä¸ºç©ºæ—¶ï¼Œå°±ä¼šç”± SHUTDOWN -&gt; TIDYINGã€‚    å½“çº¿ç¨‹æ± åœ¨STOPçŠ¶æ€ä¸‹ï¼Œçº¿ç¨‹æ± ä¸­æ‰§è¡Œçš„ä»»åŠ¡ä¸ºç©ºæ—¶ï¼Œå°±ä¼šç”±STOP -&gt; TIDYINGã€‚TEMINATED(01) çŠ¶æ€è¯´æ˜ï¼šçº¿ç¨‹æ± å½»åº•ç»ˆæ­¢ï¼Œå°±å˜æˆTERMINATEDçŠ¶æ€ã€‚(02) çŠ¶æ€åˆ‡æ¢ï¼šçº¿ç¨‹æ± å¤„åœ¨TIDYINGçŠ¶æ€æ—¶ï¼Œæ‰§è¡Œå®Œterminated()ä¹‹åï¼Œå°±ä¼šç”± TIDYING -&gt; TERMINATEDã€‚æ‹’ç»ç­–ç•¥çº¿ç¨‹æ± çš„æ‹’ç»ç­–ç•¥ï¼Œæ˜¯æŒ‡å½“ä»»åŠ¡æ·»åŠ åˆ°çº¿ç¨‹æ± ä¸­è¢«æ‹’ç»ï¼Œè€Œé‡‡å–çš„å¤„ç†æªæ–½ã€‚å½“ä»»åŠ¡æ·»åŠ åˆ°çº¿ç¨‹æ± ä¸­ä¹‹æ‰€ä»¥è¢«æ‹’ç»ï¼Œå¯èƒ½æ˜¯ç”±äºï¼šç¬¬ä¸€ï¼Œçº¿ç¨‹æ± å¼‚å¸¸å…³é—­ã€‚ç¬¬äºŒï¼Œä»»åŠ¡æ•°é‡è¶…è¿‡çº¿ç¨‹æ± çš„æœ€å¤§é™åˆ¶ã€‚çº¿ç¨‹æ± å…±åŒ…æ‹¬4ç§æ‹’ç»ç­–ç•¥ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ï¼šAbortPolicy, CallerRunsPolicy, DiscardOldestPolicyå’ŒDiscardPolicyã€‚1234AbortPolicy         -- å½“ä»»åŠ¡æ·»åŠ åˆ°çº¿ç¨‹æ± ä¸­è¢«æ‹’ç»æ—¶ï¼Œå®ƒå°†æŠ›å‡º RejectedExecutionException å¼‚å¸¸ã€‚CallerRunsPolicy    -- å½“ä»»åŠ¡æ·»åŠ åˆ°çº¿ç¨‹æ± ä¸­è¢«æ‹’ç»æ—¶ï¼Œä¼šåœ¨çº¿ç¨‹æ± å½“å‰æ­£åœ¨è¿è¡Œçš„Threadçº¿ç¨‹æ± ä¸­å¤„ç†è¢«æ‹’ç»çš„ä»»åŠ¡ã€‚DiscardOldestPolicy -- å½“ä»»åŠ¡æ·»åŠ åˆ°çº¿ç¨‹æ± ä¸­è¢«æ‹’ç»æ—¶ï¼Œçº¿ç¨‹æ± ä¼šæ”¾å¼ƒç­‰å¾…é˜Ÿåˆ—ä¸­æœ€æ—§çš„æœªå¤„ç†ä»»åŠ¡ï¼Œç„¶åå°†è¢«æ‹’ç»çš„ä»»åŠ¡æ·»åŠ åˆ°ç­‰å¾…é˜Ÿåˆ—ä¸­ã€‚DiscardPolicy       -- å½“ä»»åŠ¡æ·»åŠ åˆ°çº¿ç¨‹æ± ä¸­è¢«æ‹’ç»æ—¶ï¼Œçº¿ç¨‹æ± å°†ä¸¢å¼ƒè¢«æ‹’ç»çš„ä»»åŠ¡ã€‚çº¿ç¨‹æ± é»˜è®¤çš„å¤„ç†ç­–ç•¥æ˜¯AbortPolicyï¼DiscardPolicy ç¤ºä¾‹12345678910111213141516171819202122232425262728293031323334353637383940414243444546import java.lang.reflect.Field;import java.util.concurrent.ArrayBlockingQueue;import java.util.concurrent.ThreadPoolExecutor;import java.util.concurrent.TimeUnit;import java.util.concurrent.ThreadPoolExecutor.DiscardPolicy;public class DiscardPolicyDemo {    private static final int THREADS_SIZE = 1;    private static final int CAPACITY = 1;    public static void main(String[] args) throws Exception {        // åˆ›å»ºçº¿ç¨‹æ± ã€‚çº¿ç¨‹æ± çš„&quot;æœ€å¤§æ± å¤§å°&quot;å’Œ&quot;æ ¸å¿ƒæ± å¤§å°&quot;éƒ½ä¸º1(THREADS_SIZE)ï¼Œ&quot;çº¿ç¨‹æ± &quot;çš„é˜»å¡é˜Ÿåˆ—å®¹é‡ä¸º1(CAPACITY)ã€‚        ThreadPoolExecutor pool = new ThreadPoolExecutor(THREADS_SIZE, THREADS_SIZE, 0, TimeUnit.SECONDS,                new ArrayBlockingQueue&lt;Runnable&gt;(CAPACITY));        // è®¾ç½®çº¿ç¨‹æ± çš„æ‹’ç»ç­–ç•¥ä¸º&quot;ä¸¢å¼ƒ&quot;        pool.setRejectedExecutionHandler(new ThreadPoolExecutor.DiscardPolicy());        // æ–°å»º10ä¸ªä»»åŠ¡ï¼Œå¹¶å°†å®ƒä»¬æ·»åŠ åˆ°çº¿ç¨‹æ± ä¸­ã€‚        for (int i = 0; i &lt; 10; i++) {            Runnable myrun = new MyRunnable(&quot;task-&quot;+i);            pool.execute(myrun);        }        // å…³é—­çº¿ç¨‹æ±         pool.shutdown();    }}class MyRunnable implements Runnable {    private String name;    public MyRunnable(String name) {        this.name = name;    }    @Override    public void run() {        try {            System.out.println(this.name + &quot; is running.&quot;);            Thread.sleep(100);        } catch (Exception e) {            e.printStackTrace();        }    }}è¿è¡Œç»“æœï¼štask-0 is running.task-1 is running.ç»“æœè¯´æ˜ï¼šçº¿ç¨‹æ± poolçš„&quot;æœ€å¤§æ± å¤§å°&quot;å’Œ&quot;æ ¸å¿ƒæ± å¤§å°&quot;éƒ½ä¸º1(THREADS_SIZE)ï¼Œè¿™æ„å‘³ç€&quot;çº¿ç¨‹æ± èƒ½åŒæ—¶è¿è¡Œçš„ä»»åŠ¡æ•°é‡æœ€å¤§åªèƒ½æ˜¯1&quot;ã€‚çº¿ç¨‹æ± poolçš„é˜»å¡é˜Ÿåˆ—æ˜¯ArrayBlockingQueueï¼ŒArrayBlockingQueueæ˜¯ä¸€ä¸ªæœ‰ç•Œçš„é˜»å¡é˜Ÿåˆ—ï¼ŒArrayBlockingQueueçš„å®¹é‡ä¸º1ã€‚è¿™ä¹Ÿæ„å‘³ç€çº¿ç¨‹æ± çš„é˜»å¡é˜Ÿåˆ—åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹æ± é˜»å¡ç­‰å¾…ã€‚æ ¹æ®&quot;&quot;ä¸­åˆ†æçš„execute()ä»£ç å¯çŸ¥ï¼šçº¿ç¨‹æ± ä¸­å…±è¿è¡Œäº†2ä¸ªä»»åŠ¡ã€‚ç¬¬1ä¸ªä»»åŠ¡ç›´æ¥æ”¾åˆ°Workerä¸­ï¼Œé€šè¿‡çº¿ç¨‹å»æ‰§è¡Œï¼›ç¬¬2ä¸ªä»»åŠ¡æ”¾åˆ°é˜»å¡é˜Ÿåˆ—ä¸­ç­‰å¾…ã€‚å…¶ä»–çš„ä»»åŠ¡éƒ½è¢«ä¸¢å¼ƒäº†ï¼DiscardOldestPolicy ç¤ºä¾‹123456789101112131415161718192021222324252627282930313233343536373839404142434445import java.lang.reflect.Field;import java.util.concurrent.ArrayBlockingQueue;import java.util.concurrent.ThreadPoolExecutor;import java.util.concurrent.TimeUnit;import java.util.concurrent.ThreadPoolExecutor.DiscardOldestPolicy;public class DiscardOldestPolicyDemo {    private static final int THREADS_SIZE = 1;    private static final int CAPACITY = 1;    public static void main(String[] args) throws Exception {        // åˆ›å»ºçº¿ç¨‹æ± ã€‚çº¿ç¨‹æ± çš„&quot;æœ€å¤§æ± å¤§å°&quot;å’Œ&quot;æ ¸å¿ƒæ± å¤§å°&quot;éƒ½ä¸º1(THREADS_SIZE)ï¼Œ&quot;çº¿ç¨‹æ± &quot;çš„é˜»å¡é˜Ÿåˆ—å®¹é‡ä¸º1(CAPACITY)ã€‚        ThreadPoolExecutor pool = new ThreadPoolExecutor(THREADS_SIZE, THREADS_SIZE, 0, TimeUnit.SECONDS,                new ArrayBlockingQueue&lt;Runnable&gt;(CAPACITY));        // è®¾ç½®çº¿ç¨‹æ± çš„æ‹’ç»ç­–ç•¥ä¸º&quot;DiscardOldestPolicy&quot;        pool.setRejectedExecutionHandler(new ThreadPoolExecutor.DiscardOldestPolicy());        // æ–°å»º10ä¸ªä»»åŠ¡ï¼Œå¹¶å°†å®ƒä»¬æ·»åŠ åˆ°çº¿ç¨‹æ± ä¸­ã€‚        for (int i = 0; i &lt; 10; i++) {            Runnable myrun = new MyRunnable(&quot;task-&quot;+i);            pool.execute(myrun);        }        // å…³é—­çº¿ç¨‹æ±         pool.shutdown();    }}class MyRunnable implements Runnable {    private String name;    public MyRunnable(String name) {        this.name = name;    }    @Override    public void run() {        try {            System.out.println(this.name + &quot; is running.&quot;);            Thread.sleep(200);        } catch (Exception e) {            e.printStackTrace();        }    }}è¿è¡Œç»“æœï¼štask-0 is running.task-9 is running.ç»“æœè¯´æ˜ï¼šå°†&quot;çº¿ç¨‹æ± çš„æ‹’ç»ç­–ç•¥&quot;ç”±DiscardPolicyä¿®æ”¹ä¸ºDiscardOldestPolicyä¹‹åï¼Œå½“æœ‰ä»»åŠ¡æ·»åŠ åˆ°çº¿ç¨‹æ± è¢«æ‹’ç»æ—¶ï¼Œçº¿ç¨‹æ± ä¼šä¸¢å¼ƒé˜»å¡é˜Ÿåˆ—ä¸­æœ«å°¾çš„ä»»åŠ¡ï¼Œç„¶åå°†è¢«æ‹’ç»çš„ä»»åŠ¡æ·»åŠ åˆ°æœ«å°¾ã€‚AbortPolicy ç¤ºä¾‹12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061import java.lang.reflect.Field;import java.util.concurrent.ArrayBlockingQueue;import java.util.concurrent.ThreadPoolExecutor;import java.util.concurrent.TimeUnit;import java.util.concurrent.ThreadPoolExecutor.AbortPolicy;import java.util.concurrent.RejectedExecutionException;public class AbortPolicyDemo {    private static final int THREADS_SIZE = 1;    private static final int CAPACITY = 1;    public static void main(String[] args) throws Exception {        // åˆ›å»ºçº¿ç¨‹æ± ã€‚çº¿ç¨‹æ± çš„&quot;æœ€å¤§æ± å¤§å°&quot;å’Œ&quot;æ ¸å¿ƒæ± å¤§å°&quot;éƒ½ä¸º1(THREADS_SIZE)ï¼Œ&quot;çº¿ç¨‹æ± &quot;çš„é˜»å¡é˜Ÿåˆ—å®¹é‡ä¸º1(CAPACITY)ã€‚        ThreadPoolExecutor pool = new ThreadPoolExecutor(THREADS_SIZE, THREADS_SIZE, 0, TimeUnit.SECONDS,                new ArrayBlockingQueue&lt;Runnable&gt;(CAPACITY));        // è®¾ç½®çº¿ç¨‹æ± çš„æ‹’ç»ç­–ç•¥ä¸º&quot;æŠ›å‡ºå¼‚å¸¸&quot;        pool.setRejectedExecutionHandler(new ThreadPoolExecutor.AbortPolicy());        try {            // æ–°å»º10ä¸ªä»»åŠ¡ï¼Œå¹¶å°†å®ƒä»¬æ·»åŠ åˆ°çº¿ç¨‹æ± ä¸­ã€‚            for (int i = 0; i &lt; 10; i++) {                Runnable myrun = new MyRunnable(&quot;task-&quot;+i);                pool.execute(myrun);            }        } catch (RejectedExecutionException e) {            e.printStackTrace();            // å…³é—­çº¿ç¨‹æ±             pool.shutdown();        }    }}class MyRunnable implements Runnable {    private String name;    public MyRunnable(String name) {        this.name = name;    }    @Override    public void run() {        try {            System.out.println(this.name + &quot; is running.&quot;);            Thread.sleep(200);        } catch (Exception e) {            e.printStackTrace();        }    }}(æŸä¸€æ¬¡)è¿è¡Œç»“æœï¼šjava.util.concurrent.RejectedExecutionException    at java.util.concurrent.ThreadPoolExecutor$AbortPolicy.rejectedExecution(ThreadPoolExecutor.java:1774)    at java.util.concurrent.ThreadPoolExecutor.reject(ThreadPoolExecutor.java:768)    at java.util.concurrent.ThreadPoolExecutor.execute(ThreadPoolExecutor.java:656)    at AbortPolicyDemo.main(AbortPolicyDemo.java:27)task-0 is running.task-1 is running.ç»“æœè¯´æ˜ï¼šå°†&quot;çº¿ç¨‹æ± çš„æ‹’ç»ç­–ç•¥&quot;ç”±DiscardPolicyä¿®æ”¹ä¸ºAbortPolicyä¹‹åï¼Œå½“æœ‰ä»»åŠ¡æ·»åŠ åˆ°çº¿ç¨‹æ± è¢«æ‹’ç»æ—¶ï¼Œä¼šæŠ›å‡ºRejectedExecutionExceptionã€‚CallerRunsPolicy ç¤ºä¾‹12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152import java.lang.reflect.Field;import java.util.concurrent.ArrayBlockingQueue;import java.util.concurrent.ThreadPoolExecutor;import java.util.concurrent.TimeUnit;import java.util.concurrent.ThreadPoolExecutor.CallerRunsPolicy;public class CallerRunsPolicyDemo {    private static final int THREADS_SIZE = 1;    private static final int CAPACITY = 1;    public static void main(String[] args) throws Exception {        // åˆ›å»ºçº¿ç¨‹æ± ã€‚çº¿ç¨‹æ± çš„&quot;æœ€å¤§æ± å¤§å°&quot;å’Œ&quot;æ ¸å¿ƒæ± å¤§å°&quot;éƒ½ä¸º1(THREADS_SIZE)ï¼Œ&quot;çº¿ç¨‹æ± &quot;çš„é˜»å¡é˜Ÿåˆ—å®¹é‡ä¸º1(CAPACITY)ã€‚        ThreadPoolExecutor pool = new ThreadPoolExecutor(THREADS_SIZE, THREADS_SIZE, 0, TimeUnit.SECONDS,                new ArrayBlockingQueue&lt;Runnable&gt;(CAPACITY));        // è®¾ç½®çº¿ç¨‹æ± çš„æ‹’ç»ç­–ç•¥ä¸º&quot;CallerRunsPolicy&quot;        pool.setRejectedExecutionHandler(new ThreadPoolExecutor.CallerRunsPolicy());        // æ–°å»º10ä¸ªä»»åŠ¡ï¼Œå¹¶å°†å®ƒä»¬æ·»åŠ åˆ°çº¿ç¨‹æ± ä¸­ã€‚        for (int i = 0; i &lt; 10; i++) {            Runnable myrun = new MyRunnable(&quot;task-&quot;+i);            pool.execute(myrun);        }        // å…³é—­çº¿ç¨‹æ±         pool.shutdown();    }}class MyRunnable implements Runnable {    private String name;    public MyRunnable(String name) {        this.name = name;    }    @Override    public void run() {        try {            System.out.println(this.name + &quot; is running.&quot;);            Thread.sleep(100);        } catch (Exception e) {            e.printStackTrace();        }    }}(æŸä¸€æ¬¡)è¿è¡Œç»“æœï¼štask-2 is running.task-3 is running.task-4 is running.task-5 is running.task-6 is running.task-7 is running.task-8 is running.task-9 is running.task-0 is running.task-1 is running.ç»“æœè¯´æ˜ï¼šå°†&quot;çº¿ç¨‹æ± çš„æ‹’ç»ç­–ç•¥&quot;ç”±DiscardPolicyä¿®æ”¹ä¸ºCallerRunsPolicyä¹‹åï¼Œå½“æœ‰ä»»åŠ¡æ·»åŠ åˆ°çº¿ç¨‹æ± è¢«æ‹’ç»æ—¶ï¼Œçº¿ç¨‹æ± ä¼šå°†è¢«æ‹’ç»çš„ä»»åŠ¡æ·»åŠ åˆ°&quot;çº¿ç¨‹æ± æ­£åœ¨è¿è¡Œçš„çº¿ç¨‹&quot;ä¸­å–è¿è¡Œã€‚Callableå’ŒFutureCallable å’Œ Future æ˜¯æ¯”è¾ƒæœ‰è¶£çš„ä¸€å¯¹ç»„åˆã€‚å½“æˆ‘ä»¬éœ€è¦è·å–çº¿ç¨‹çš„æ‰§è¡Œç»“æœæ—¶ï¼Œå°±éœ€è¦ç”¨åˆ°å®ƒä»¬ã€‚Callableç”¨äºäº§ç”Ÿç»“æœï¼ŒFutureç”¨äºè·å–ç»“æœã€‚1234567891011121. CallableCallable æ˜¯ä¸€ä¸ªæ¥å£ï¼Œå®ƒåªåŒ…å«ä¸€ä¸ªcall()æ–¹æ³•ã€‚Callableæ˜¯ä¸€ä¸ªè¿”å›ç»“æœå¹¶ä¸”å¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„ä»»åŠ¡ã€‚ä¸ºäº†ä¾¿äºç†è§£ï¼Œæˆ‘ä»¬å¯ä»¥å°†Callableæ¯”ä½œä¸€ä¸ªRunnableæ¥å£ï¼Œè€ŒCallableçš„call()æ–¹æ³•åˆ™ç±»ä¼¼äºRunnableçš„run()æ–¹æ³•ã€‚Callableçš„æºç å¦‚ä¸‹ï¼špublic interface Callable&lt;V&gt; {    V call() throws Exception;}è¯´æ˜ï¼šä»ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºCallableæ”¯æŒæ³›å‹ã€‚2. FuturejavaFuture æ˜¯ä¸€ä¸ªæ¥å£ã€‚å®ƒç”¨äºè¡¨ç¤ºå¼‚æ­¥è®¡ç®—çš„ç»“æœã€‚æä¾›äº†æ£€æŸ¥è®¡ç®—æ˜¯å¦å®Œæˆçš„æ–¹æ³•ï¼Œä»¥ç­‰å¾…è®¡ç®—çš„å®Œæˆï¼Œå¹¶è·å–è®¡ç®—çš„ç»“æœã€‚è¯´æ˜ï¼šFutureç”¨äºè¡¨ç¤ºå¼‚æ­¥è®¡ç®—çš„ç»“æœã€‚å®ƒçš„å®ç°ç±»æ˜¯FutureTaskï¼Œåœ¨è®²è§£FutureTaskä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆçœ‹çœ‹Callable, Future, FutureTaskå®ƒä»¬ä¹‹é—´çš„å…³ç³»å›¾ï¼Œå¦‚ä¸‹ï¼š123456è¯´æ˜ï¼š(01) RunnableFutureæ˜¯ä¸€ä¸ªæ¥å£ï¼Œå®ƒç»§æ‰¿äº†Runnableå’ŒFutureè¿™ä¸¤ä¸ªæ¥å£ã€‚RunnableFutureçš„æºç å¦‚ä¸‹ï¼špublic interface RunnableFuture&lt;V&gt; extends Runnable, Future&lt;V&gt; {    void run();}(02) FutureTaskå®ç°äº†RunnableFutureæ¥å£ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬ä¹Ÿè¯´å®ƒå®ç°äº†Futureæ¥å£ã€‚Callableå’ŒFutureçš„åŸºæœ¬ç”¨æ³•123456789101112131415161718192021222324252627282930313233343536import java.util.concurrent.Callable;import java.util.concurrent.Future;import java.util.concurrent.Executors;import java.util.concurrent.ExecutorService;import java.util.concurrent.ExecutionException;class MyCallable implements Callable {    @Override     public Integer call() throws Exception {        int sum    = 0;        // æ‰§è¡Œä»»åŠ¡        for (int i=0; i&lt;100; i++)            sum += i;        //return sum;         return Integer.valueOf(sum);    } }public class CallableTest1 {    public static void main(String[] args)         throws ExecutionException, InterruptedException{        //åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ±         ExecutorService pool = Executors.newSingleThreadExecutor();        //åˆ›å»ºæœ‰è¿”å›å€¼çš„ä»»åŠ¡        Callable c1 = new MyCallable();        //æ‰§è¡Œä»»åŠ¡å¹¶è·å–Futureå¯¹è±¡         Future f1 = pool.submit(c1);        // è¾“å‡ºç»“æœ        System.out.println(f1.get());         //å…³é—­çº¿ç¨‹æ±          pool.shutdown();     }}è¿è¡Œç»“æœï¼š4950ç»“æœè¯´æ˜ï¼šã€€ã€€åœ¨ä¸»çº¿ç¨‹mainä¸­ï¼Œé€šè¿‡newSingleThreadExecutor()æ–°å»ºä¸€ä¸ªçº¿ç¨‹æ± ã€‚æ¥ç€åˆ›å»ºCallableå¯¹è±¡c1ï¼Œç„¶åå†é€šè¿‡pool.submit(c1)å°†c1æäº¤åˆ°çº¿ç¨‹æ± ä¸­è¿›è¡Œå¤„ç†ï¼Œå¹¶ä¸”å°†è¿”å›çš„ç»“æœä¿å­˜åˆ°Futureå¯¹è±¡f1ä¸­ã€‚ç„¶åï¼Œæˆ‘ä»¬é€šè¿‡f1.get()è·å–Callableä¸­ä¿å­˜çš„ç»“æœï¼›æœ€åé€šè¿‡pool.shutdown()å…³é—­çº¿ç¨‹æ± ã€‚1234567891011121314151617181920211. submit()submit()åœ¨java/util/concurrent/AbstractExecutorService.javaä¸­å®ç°è¯´æ˜ï¼šsubmit()é€šè¿‡newTaskFor(task)åˆ›å»ºäº†RunnableFutureå¯¹è±¡ftaskã€‚å®ƒçš„æºç å¦‚ä¸‹ï¼šprotected &lt;T&gt; RunnableFuture&lt;T&gt; newTaskFor(Callable&lt;T&gt; callable) {    return new FutureTask&lt;T&gt;(callable);}2. FutureTaskçš„æ„é€ å‡½æ•°public FutureTask(Callable&lt;V&gt; callable) {    if (callable == null)        throw new NullPointerException();    // callableæ˜¯ä¸€ä¸ªCallableå¯¹è±¡    this.callable = callable;    // stateè®°å½•FutureTaskçš„çŠ¶æ€    this.state = NEW;       // ensure visibility of callable}3. FutureTaskçš„run()æ–¹æ³•æˆ‘ä»¬ç»§ç»­å›åˆ°submit()çš„æºç ä¸­ã€‚åœ¨newTaskFor()æ–°å»ºä¸€ä¸ªftaskå¯¹è±¡ä¹‹åï¼Œä¼šé€šè¿‡execute(ftask)æ‰§è¡Œè¯¥ä»»åŠ¡ã€‚æ­¤æ—¶ftaskè¢«å½“ä½œä¸€ä¸ªRunnableå¯¹è±¡è¿›è¡Œæ‰§è¡Œï¼Œæœ€ç»ˆä¼šè°ƒç”¨åˆ°å®ƒçš„run()æ–¹æ³•ï¼›ftaskçš„run()æ–¹æ³•åœ¨java/util/concurrent/FutureTask.javaä¸­å®ç°ï¼Œè¯´æ˜ï¼šrun()ä¸­ä¼šæ‰§è¡ŒCallableå¯¹è±¡çš„call()æ–¹æ³•ï¼Œå¹¶ä¸”æœ€ç»ˆå°†ç»“æœä¿å­˜åˆ°resultä¸­ï¼Œå¹¶é€šè¿‡set(result)å°†resultä¿å­˜ã€‚ä¹‹åè°ƒç”¨FutureTaskçš„get()æ–¹æ³•ï¼Œè¿”å›çš„å°±æ˜¯é€šè¿‡set(result)ä¿å­˜çš„å€¼ã€‚</content>
	</entry>
	<entry>
		<title>å¤šçº¿ç¨‹_JUCé›†åˆ</title>
		<url>/article/81c2c0c1.html</url>
		<content>JUCé›†åˆListçš„å®ç°ç±»ä¸»è¦æœ‰: LinkedList, ArrayList, Vector, Stackã€‚(01) LinkedListæ˜¯åŒå‘é“¾è¡¨å®ç°çš„åŒç«¯é˜Ÿåˆ—ï¼›å®ƒä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œåªé€‚ç”¨äºå•çº¿ç¨‹ã€‚(02) ArrayListæ˜¯æ•°ç»„å®ç°çš„é˜Ÿåˆ—ï¼Œå®ƒæ˜¯ä¸€ä¸ªåŠ¨æ€æ•°ç»„ï¼›å®ƒä¹Ÿä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œåªé€‚ç”¨äºå•çº¿ç¨‹ã€‚(03) Vectoræ˜¯æ•°ç»„å®ç°çš„çŸ¢é‡é˜Ÿåˆ—ï¼Œå®ƒä¹Ÿä¸€ä¸ªåŠ¨æ€æ•°ç»„ï¼›ä¸è¿‡å’ŒArrayListä¸åŒçš„æ˜¯ï¼ŒVectoræ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå®ƒæ”¯æŒå¹¶å‘ã€‚(04) Stackæ˜¯Vectorå®ç°çš„æ ˆï¼›å’ŒVectorä¸€æ ·ï¼Œå®ƒä¹Ÿæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ Setçš„å®ç°ç±»ä¸»è¦æœ‰: HastSetå’ŒTreeSetã€‚(01) HashSetæ˜¯ä¸€ä¸ªæ²¡æœ‰é‡å¤å…ƒç´ çš„é›†åˆï¼Œå®ƒé€šè¿‡HashMapå®ç°çš„ï¼›HashSetä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œåªé€‚ç”¨äºå•çº¿ç¨‹ã€‚(02) TreeSetä¹Ÿæ˜¯ä¸€ä¸ªæ²¡æœ‰é‡å¤å…ƒç´ çš„é›†åˆï¼Œä¸è¿‡å’ŒHashSetä¸åŒçš„æ˜¯ï¼ŒTreeSetä¸­çš„å…ƒç´ æ˜¯æœ‰åºçš„ï¼›å®ƒæ˜¯é€šè¿‡TreeMapå®ç°çš„ï¼›TreeSetä¹Ÿä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œåªé€‚ç”¨äºå•çº¿ç¨‹ã€‚ Mapçš„å®ç°ç±»ä¸»è¦æœ‰: HashMapï¼ŒWeakHashMap, Hashtableå’ŒTreeMapã€‚(01) HashMapæ˜¯å­˜å‚¨â€œé”®-å€¼å¯¹â€çš„å“ˆå¸Œè¡¨ï¼›å®ƒä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œåªé€‚ç”¨äºå•çº¿ç¨‹ã€‚(02) WeakHashMapæ˜¯ä¹Ÿæ˜¯å“ˆå¸Œè¡¨ï¼›å’ŒHashMapä¸åŒçš„æ˜¯ï¼ŒHashMapçš„â€œé”®â€æ˜¯å¼ºå¼•ç”¨ç±»å‹ï¼Œè€ŒWeakHashMapçš„â€œé”®â€æ˜¯å¼±å¼•ç”¨ç±»å‹ï¼Œä¹Ÿå°±æ˜¯è¯´å½“WeakHashMap ä¸­çš„æŸä¸ªé”®ä¸å†æ­£å¸¸ä½¿ç”¨æ—¶ï¼Œä¼šè¢«ä»WeakHashMapä¸­è¢«è‡ªåŠ¨ç§»é™¤ã€‚WeakHashMapä¹Ÿä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œåªé€‚ç”¨äºå•çº¿ç¨‹ã€‚(03) Hashtableä¹Ÿæ˜¯å“ˆå¸Œè¡¨ï¼›å’ŒHashMapä¸åŒçš„æ˜¯ï¼ŒHashtableæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæ”¯æŒå¹¶å‘ã€‚(04) TreeMapä¹Ÿæ˜¯å“ˆå¸Œè¡¨ï¼Œä¸è¿‡TreeMapä¸­çš„â€œé”®-å€¼å¯¹â€æ˜¯æœ‰åºçš„ï¼Œå®ƒæ˜¯é€šè¿‡R-B Tree(çº¢é»‘æ ‘)å®ç°çš„ï¼›TreeMapä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œåªé€‚ç”¨äºå•çº¿ç¨‹ã€‚æ›´å¤šå…³äºè¿™äº›é›†åˆç±»çš„ä»‹ç»ï¼Œå¯ä»¥å‚è€ƒâ€œJava é›†åˆç³»åˆ—ç›®å½•(Category)â€ã€‚123ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬å°†å‰é¢ä»‹ç»é›†åˆç±»ç»Ÿç§°ä¸ºâ€javaé›†åˆåŒ…â€œã€‚javaé›†åˆåŒ…å¤§å¤šæ˜¯â€œéçº¿ç¨‹å®‰å…¨çš„â€ï¼Œè™½ç„¶å¯ä»¥é€šè¿‡Collectionså·¥å…·ç±»ä¸­çš„æ–¹æ³•è·å–javaé›†åˆåŒ…å¯¹åº”çš„åŒæ­¥ç±»ï¼Œä½†æ˜¯è¿™äº›åŒæ­¥ç±»çš„å¹¶å‘æ•ˆç‡å¹¶ä¸æ˜¯å¾ˆé«˜ã€‚ä¸ºäº†æ›´å¥½çš„æ”¯æŒé«˜å¹¶å‘ä»»åŠ¡ï¼Œå¹¶å‘å¤§å¸ˆDoug Leaåœ¨JUC(java.util.concurrent)åŒ…ä¸­æ·»åŠ äº†javaé›†åˆåŒ…ä¸­å•çº¿ç¨‹ç±»çš„å¯¹åº”çš„æ”¯æŒé«˜å¹¶å‘çš„ç±»ã€‚ä¾‹å¦‚ï¼ŒArrayListå¯¹åº”çš„é«˜å¹¶å‘ç±»æ˜¯CopyOnWriteArrayListï¼ŒHashMapå¯¹åº”çš„é«˜å¹¶å‘ç±»æ˜¯ConcurrentHashMapï¼Œç­‰ç­‰ã€‚JUCåŒ…åœ¨æ·»åŠ â€javaé›†åˆåŒ…â€œå¯¹åº”çš„é«˜å¹¶å‘ç±»æ—¶ï¼Œä¸ºäº†ä¿æŒAPIæ¥å£çš„ä¸€è‡´æ€§ï¼Œä½¿ç”¨äº†â€Javaé›†åˆåŒ…â€œä¸­çš„æ¡†æ¶ã€‚ä¾‹å¦‚ï¼ŒCopyOnWriteArrayListå®ç°äº†â€œJavaé›†åˆåŒ…â€ä¸­çš„Listæ¥å£ï¼ŒHashMapç»§æ‰¿äº†â€œjavaé›†åˆåŒ…â€ä¸­çš„AbstractMapç±»ï¼Œç­‰ç­‰ã€‚å¾—ç›Šäºâ€œJUCåŒ…ä½¿ç”¨äº†Javaé›†åˆåŒ…ä¸­çš„ç±»â€ï¼Œå¦‚æœæˆ‘ä»¬äº†è§£äº†Javaé›†åˆåŒ…ä¸­çš„ç±»çš„æ€æƒ³ä¹‹åï¼Œç†è§£JUCåŒ…ä¸­çš„ç±»ä¹Ÿç›¸å¯¹å®¹æ˜“ï¼›ç†è§£æ—¶ï¼Œæœ€å¤§çš„éš¾ç‚¹æ˜¯ï¼Œå¯¹JUCåŒ…æ˜¯å¦‚ä½•æ·»åŠ å¯¹â€œé«˜å¹¶å‘â€çš„æ”¯æŒçš„ï¼1234567891011121314151617181. Listå’ŒSetJUCé›†åˆåŒ…ä¸­çš„Listå’ŒSetå®ç°ç±»åŒ…æ‹¬: CopyOnWriteArrayList, CopyOnWriteArraySetå’ŒConcurrentSkipListSetã€‚(01) CopyOnWriteArrayListç›¸å½“äºçº¿ç¨‹å®‰å…¨çš„ArrayListï¼Œå®ƒå®ç°äº†Listæ¥å£ã€‚CopyOnWriteArrayListæ˜¯æ”¯æŒé«˜å¹¶å‘çš„ã€‚(02) CopyOnWriteArraySetç›¸å½“äºçº¿ç¨‹å®‰å…¨çš„HashSetï¼Œå®ƒç»§æ‰¿äºAbstractSetç±»ã€‚CopyOnWriteArraySetå†…éƒ¨åŒ…å«ä¸€ä¸ªCopyOnWriteArrayListå¯¹è±¡ï¼Œå®ƒæ˜¯é€šè¿‡CopyOnWriteArrayListå®ç°çš„ã€‚2. MapJUCé›†åˆåŒ…ä¸­Mapçš„å®ç°ç±»åŒ…æ‹¬: ConcurrentHashMapå’ŒConcurrentSkipListMapã€‚(01) ConcurrentHashMapæ˜¯çº¿ç¨‹å®‰å…¨çš„å“ˆå¸Œè¡¨(ç›¸å½“äºçº¿ç¨‹å®‰å…¨çš„HashMap)ï¼›å®ƒç»§æ‰¿äºAbstractMapç±»ï¼Œå¹¶ä¸”å®ç°ConcurrentMapæ¥å£ã€‚ConcurrentHashMapæ˜¯é€šè¿‡â€œé”åˆ†æ®µâ€æ¥å®ç°çš„ï¼Œå®ƒæ”¯æŒå¹¶å‘ã€‚(02) ConcurrentSkipListMapæ˜¯çº¿ç¨‹å®‰å…¨çš„æœ‰åºçš„å“ˆå¸Œè¡¨(ç›¸å½“äºçº¿ç¨‹å®‰å…¨çš„TreeMap); å®ƒç»§æ‰¿äºAbstractMapç±»ï¼Œå¹¶ä¸”å®ç°ConcurrentNavigableMapæ¥å£ã€‚ConcurrentSkipListMapæ˜¯é€šè¿‡â€œè·³è¡¨â€æ¥å®ç°çš„ï¼Œå®ƒæ”¯æŒå¹¶å‘ã€‚(03) ConcurrentSkipListSetæ˜¯çº¿ç¨‹å®‰å…¨çš„æœ‰åºçš„é›†åˆ(ç›¸å½“äºçº¿ç¨‹å®‰å…¨çš„TreeSet)ï¼›å®ƒç»§æ‰¿äºAbstractSetï¼Œå¹¶å®ç°äº†NavigableSetæ¥å£ã€‚ConcurrentSkipListSetæ˜¯é€šè¿‡ConcurrentSkipListMapå®ç°çš„ï¼Œå®ƒä¹Ÿæ”¯æŒå¹¶å‘ã€‚3. QueueJUCé›†åˆåŒ…ä¸­Queueçš„å®ç°ç±»åŒ…æ‹¬: ArrayBlockingQueue, LinkedBlockingQueue, LinkedBlockingDeque, ConcurrentLinkedQueueå’ŒConcurrentLinkedDequeã€‚(01) ArrayBlockingQueueæ˜¯æ•°ç»„å®ç°çš„çº¿ç¨‹å®‰å…¨çš„æœ‰ç•Œçš„é˜»å¡é˜Ÿåˆ—ã€‚(02) LinkedBlockingQueueæ˜¯å•å‘é“¾è¡¨å®ç°çš„(æŒ‡å®šå¤§å°)é˜»å¡é˜Ÿåˆ—ï¼Œè¯¥é˜Ÿåˆ—æŒ‰ FIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰æ’åºå…ƒç´ ã€‚(03) LinkedBlockingDequeæ˜¯åŒå‘é“¾è¡¨å®ç°çš„(æŒ‡å®šå¤§å°)åŒå‘å¹¶å‘é˜»å¡é˜Ÿåˆ—ï¼Œè¯¥é˜»å¡é˜Ÿåˆ—åŒæ—¶æ”¯æŒFIFOå’ŒFILOä¸¤ç§æ“ä½œæ–¹å¼ã€‚(04) ConcurrentLinkedQueueæ˜¯å•å‘é“¾è¡¨å®ç°çš„æ— ç•Œé˜Ÿåˆ—ï¼Œè¯¥é˜Ÿåˆ—æŒ‰ FIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰æ’åºå…ƒç´ ã€‚(05) ConcurrentLinkedDequeæ˜¯åŒå‘é“¾è¡¨å®ç°çš„æ— ç•Œé˜Ÿåˆ—ï¼Œè¯¥é˜Ÿåˆ—åŒæ—¶æ”¯æŒFIFOå’ŒFILOä¸¤ç§æ“ä½œæ–¹å¼ã€‚CopyOnWriteArrayList123456å®ƒç›¸å½“äºçº¿ç¨‹å®‰å…¨çš„ArrayListã€‚å’ŒArrayListä¸€æ ·ï¼Œå®ƒæ˜¯ä¸ªå¯å˜æ•°ç»„ï¼›ä½†æ˜¯å’ŒArrayListä¸åŒçš„æ—¶ï¼Œå®ƒå…·æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼š1. å®ƒæœ€é€‚åˆäºå…·æœ‰ä»¥ä¸‹ç‰¹å¾çš„åº”ç”¨ç¨‹åºï¼šList å¤§å°é€šå¸¸ä¿æŒå¾ˆå°ï¼Œåªè¯»æ“ä½œè¿œå¤šäºå¯å˜æ“ä½œï¼Œéœ€è¦åœ¨éå†æœŸé—´é˜²æ­¢çº¿ç¨‹é—´çš„å†²çªã€‚2. å®ƒæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚3. å› ä¸ºé€šå¸¸éœ€è¦å¤åˆ¶æ•´ä¸ªåŸºç¡€æ•°ç»„ï¼Œæ‰€ä»¥å¯å˜æ“ä½œï¼ˆadd()ã€set() å’Œ remove() ç­‰ç­‰ï¼‰çš„å¼€é”€å¾ˆå¤§ã€‚4. è¿­ä»£å™¨æ”¯æŒhasNext(), next()ç­‰ä¸å¯å˜æ“ä½œï¼Œä½†ä¸æ”¯æŒå¯å˜ remove()ç­‰æ“ä½œã€‚5. ä½¿ç”¨è¿­ä»£å™¨è¿›è¡Œéå†çš„é€Ÿåº¦å¾ˆå¿«ï¼Œå¹¶ä¸”ä¸ä¼šä¸å…¶ä»–çº¿ç¨‹å‘ç”Ÿå†²çªã€‚åœ¨æ„é€ è¿­ä»£å™¨æ—¶ï¼Œè¿­ä»£å™¨ä¾èµ–äºä¸å˜çš„æ•°ç»„å¿«ç…§ã€‚1234567891011è¯´æ˜ï¼š1. CopyOnWriteArrayListå®ç°äº†Listæ¥å£ï¼Œå› æ­¤å®ƒæ˜¯ä¸€ä¸ªé˜Ÿåˆ—ã€‚2. CopyOnWriteArrayListåŒ…å«äº†æˆå‘˜lockã€‚æ¯ä¸€ä¸ªCopyOnWriteArrayListéƒ½å’Œä¸€ä¸ªäº’æ–¥é”lockç»‘å®šï¼Œé€šè¿‡lockï¼Œå®ç°äº†å¯¹CopyOnWriteArrayListçš„äº’æ–¥è®¿é—®ã€‚3. CopyOnWriteArrayListåŒ…å«äº†æˆå‘˜arrayæ•°ç»„ï¼Œè¿™è¯´æ˜CopyOnWriteArrayListæœ¬è´¨ä¸Šé€šè¿‡æ•°ç»„å®ç°çš„ã€‚ä¸‹é¢ä»â€œåŠ¨æ€æ•°ç»„â€å’Œâ€œçº¿ç¨‹å®‰å…¨â€ä¸¤ä¸ªæ–¹é¢è¿›ä¸€æ­¥å¯¹CopyOnWriteArrayListçš„åŸç†è¿›è¡Œè¯´æ˜ã€‚1. CopyOnWriteArrayListçš„â€œåŠ¨æ€æ•°ç»„â€æœºåˆ¶ -- å®ƒå†…éƒ¨æœ‰ä¸ªâ€œvolatileæ•°ç»„â€(array)æ¥ä¿æŒæ•°æ®ã€‚åœ¨â€œæ·»åŠ /ä¿®æ”¹/åˆ é™¤â€æ•°æ®æ—¶ï¼Œéƒ½ä¼šæ–°å»ºä¸€ä¸ªæ•°ç»„ï¼Œå¹¶å°†æ›´æ–°åçš„æ•°æ®æ‹·è´åˆ°æ–°å»ºçš„æ•°ç»„ä¸­ï¼Œæœ€åå†å°†è¯¥æ•°ç»„èµ‹å€¼ç»™â€œvolatileæ•°ç»„â€ã€‚è¿™å°±æ˜¯å®ƒå«åšCopyOnWriteArrayListçš„åŸå› ï¼CopyOnWriteArrayListå°±æ˜¯é€šè¿‡è¿™ç§æ–¹å¼å®ç°çš„åŠ¨æ€æ•°ç»„ï¼›ä¸è¿‡æ­£ç”±äºå®ƒåœ¨â€œæ·»åŠ /ä¿®æ”¹/åˆ é™¤â€æ•°æ®æ—¶ï¼Œéƒ½ä¼šæ–°å»ºæ•°ç»„ï¼Œæ‰€ä»¥æ¶‰åŠåˆ°ä¿®æ”¹æ•°æ®çš„æ“ä½œï¼ŒCopyOnWriteArrayListæ•ˆç‡å¾ˆä½ï¼›ä½†æ˜¯å•å•åªæ˜¯è¿›è¡Œéå†æŸ¥æ‰¾çš„è¯ï¼Œæ•ˆç‡æ¯”è¾ƒé«˜ã€‚2. CopyOnWriteArrayListçš„â€œçº¿ç¨‹å®‰å…¨â€æœºåˆ¶ -- æ˜¯é€šè¿‡volatileå’Œäº’æ–¥é”æ¥å®ç°çš„ã€‚(01) CopyOnWriteArrayListæ˜¯é€šè¿‡â€œvolatileæ•°ç»„â€æ¥ä¿å­˜æ•°æ®çš„ã€‚ä¸€ä¸ªçº¿ç¨‹è¯»å–volatileæ•°ç»„æ—¶ï¼Œæ€»èƒ½çœ‹åˆ°å…¶å®ƒçº¿ç¨‹å¯¹è¯¥volatileå˜é‡æœ€åçš„å†™å…¥ï¼›å°±è¿™æ ·ï¼Œé€šè¿‡volatileæä¾›äº†â€œè¯»å–åˆ°çš„æ•°æ®æ€»æ˜¯æœ€æ–°çš„â€è¿™ä¸ªæœºåˆ¶çš„ä¿è¯ã€‚(02) CopyOnWriteArrayListé€šè¿‡äº’æ–¥é”æ¥ä¿æŠ¤æ•°æ®ã€‚åœ¨â€œæ·»åŠ /ä¿®æ”¹/åˆ é™¤â€æ•°æ®æ—¶ï¼Œä¼šå…ˆâ€œè·å–äº’æ–¥é”â€ï¼Œå†ä¿®æ”¹å®Œæ¯•ä¹‹åï¼Œå…ˆå°†æ•°æ®æ›´æ–°åˆ°â€œvolatileæ•°ç»„â€ä¸­ï¼Œç„¶åå†â€œé‡Šæ”¾äº’æ–¥é”â€ï¼›è¿™æ ·ï¼Œå°±è¾¾åˆ°äº†ä¿æŠ¤æ•°æ®çš„ç›®çš„ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768// CopyOnWriteArrayListå‡½æ•°åˆ—è¡¨// åˆ›å»ºä¸€ä¸ªç©ºåˆ—è¡¨ã€‚CopyOnWriteArrayList()// åˆ›å»ºä¸€ä¸ªæŒ‰ collection çš„è¿­ä»£å™¨è¿”å›å…ƒç´ çš„é¡ºåºåŒ…å«æŒ‡å®š collection å…ƒç´ çš„åˆ—è¡¨ã€‚CopyOnWriteArrayList(Collection&lt;? extends E&gt; c)// CopyOnWriteArrayList(E[] toCopyIn)// åˆ›å»ºä¸€ä¸ªä¿å­˜ç»™å®šæ•°ç»„çš„å‰¯æœ¬çš„åˆ—è¡¨ã€‚// å°†æŒ‡å®šå…ƒç´ æ·»åŠ åˆ°æ­¤åˆ—è¡¨çš„å°¾éƒ¨ã€‚boolean add(E e)// åœ¨æ­¤åˆ—è¡¨çš„æŒ‡å®šä½ç½®ä¸Šæ’å…¥æŒ‡å®šå…ƒç´ ã€‚void add(int index, E element)// æŒ‰ç…§æŒ‡å®š collection çš„è¿­ä»£å™¨è¿”å›å…ƒç´ çš„é¡ºåºï¼Œå°†æŒ‡å®š collection ä¸­çš„æ‰€æœ‰å…ƒç´ æ·»åŠ æ­¤åˆ—è¡¨çš„å°¾éƒ¨ã€‚boolean addAll(Collection&lt;? extends E&gt; c)// ä»æŒ‡å®šä½ç½®å¼€å§‹ï¼Œå°†æŒ‡å®š collection çš„æ‰€æœ‰å…ƒç´ æ’å…¥æ­¤åˆ—è¡¨ã€‚boolean addAll(int index, Collection&lt;? extends E&gt; c)// æŒ‰ç…§æŒ‡å®š collection çš„è¿­ä»£å™¨è¿”å›å…ƒç´ çš„é¡ºåºï¼Œå°†æŒ‡å®š collection ä¸­å°šæœªåŒ…å«åœ¨æ­¤åˆ—è¡¨ä¸­çš„æ‰€æœ‰å…ƒç´ æ·»åŠ åˆ—è¡¨çš„å°¾éƒ¨ã€‚int addAllAbsent(Collection&lt;? extends E&gt; c)// æ·»åŠ å…ƒç´ ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰ã€‚boolean addIfAbsent(E e)// ä»æ­¤åˆ—è¡¨ç§»é™¤æ‰€æœ‰å…ƒç´ ã€‚void clear()// è¿”å›æ­¤åˆ—è¡¨çš„æµ…è¡¨å‰¯æœ¬ã€‚Object clone()// å¦‚æœæ­¤åˆ—è¡¨åŒ…å«æŒ‡å®šçš„å…ƒç´ ï¼Œåˆ™è¿”å› trueã€‚boolean contains(Object o)// å¦‚æœæ­¤åˆ—è¡¨åŒ…å«æŒ‡å®š collection çš„æ‰€æœ‰å…ƒç´ ï¼Œåˆ™è¿”å› trueã€‚boolean containsAll(Collection&lt;?&gt; c)// æ¯”è¾ƒæŒ‡å®šå¯¹è±¡ä¸æ­¤åˆ—è¡¨çš„ç›¸ç­‰æ€§ã€‚boolean equals(Object o)// è¿”å›åˆ—è¡¨ä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ ã€‚E get(int index)// è¿”å›æ­¤åˆ—è¡¨çš„å“ˆå¸Œç å€¼ã€‚int hashCode()// è¿”å›ç¬¬ä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ åœ¨æ­¤åˆ—è¡¨ä¸­çš„ç´¢å¼•ï¼Œä» index å¼€å§‹å‘å‰æœç´¢ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°è¯¥å…ƒç´ ï¼Œåˆ™è¿”å› -1ã€‚int indexOf(E e, int index)// è¿”å›æ­¤åˆ—è¡¨ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ çš„ç´¢å¼•ï¼›å¦‚æœæ­¤åˆ—è¡¨ä¸åŒ…å«è¯¥å…ƒç´ ï¼Œåˆ™è¿”å› -1ã€‚int indexOf(Object o)// å¦‚æœæ­¤åˆ—è¡¨ä¸åŒ…å«ä»»ä½•å…ƒç´ ï¼Œåˆ™è¿”å› trueã€‚boolean isEmpty()// è¿”å›ä»¥æ°å½“é¡ºåºåœ¨æ­¤åˆ—è¡¨å…ƒç´ ä¸Šè¿›è¡Œè¿­ä»£çš„è¿­ä»£å™¨ã€‚Iterator&lt;E&gt; iterator()// è¿”å›æœ€åä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ åœ¨æ­¤åˆ—è¡¨ä¸­çš„ç´¢å¼•ï¼Œä» index å¼€å§‹å‘åæœç´¢ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°è¯¥å…ƒç´ ï¼Œåˆ™è¿”å› -1ã€‚int lastIndexOf(E e, int index)// è¿”å›æ­¤åˆ—è¡¨ä¸­æœ€åå‡ºç°çš„æŒ‡å®šå…ƒç´ çš„ç´¢å¼•ï¼›å¦‚æœåˆ—è¡¨ä¸åŒ…å«æ­¤å…ƒç´ ï¼Œåˆ™è¿”å› -1ã€‚int lastIndexOf(Object o)// è¿”å›æ­¤åˆ—è¡¨å…ƒç´ çš„åˆ—è¡¨è¿­ä»£å™¨ï¼ˆæŒ‰é€‚å½“é¡ºåºï¼‰ã€‚ListIterator&lt;E&gt; listIterator()// è¿”å›åˆ—è¡¨ä¸­å…ƒç´ çš„åˆ—è¡¨è¿­ä»£å™¨ï¼ˆæŒ‰é€‚å½“é¡ºåºï¼‰ï¼Œä»åˆ—è¡¨çš„æŒ‡å®šä½ç½®å¼€å§‹ã€‚ListIterator&lt;E&gt; listIterator(int index)// ç§»é™¤æ­¤åˆ—è¡¨æŒ‡å®šä½ç½®ä¸Šçš„å…ƒç´ ã€‚E remove(int index)// ä»æ­¤åˆ—è¡¨ç§»é™¤ç¬¬ä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ã€‚boolean remove(Object o)// ä»æ­¤åˆ—è¡¨ç§»é™¤æ‰€æœ‰åŒ…å«åœ¨æŒ‡å®š collection ä¸­çš„å…ƒç´ ã€‚boolean removeAll(Collection&lt;?&gt; c)// åªä¿ç•™æ­¤åˆ—è¡¨ä¸­åŒ…å«åœ¨æŒ‡å®š collection ä¸­çš„å…ƒç´ ã€‚boolean retainAll(Collection&lt;?&gt; c)// ç”¨æŒ‡å®šçš„å…ƒç´ æ›¿ä»£æ­¤åˆ—è¡¨æŒ‡å®šä½ç½®ä¸Šçš„å…ƒç´ ã€‚E set(int index, E element)// è¿”å›æ­¤åˆ—è¡¨ä¸­çš„å…ƒç´ æ•°ã€‚int size()// è¿”å›æ­¤åˆ—è¡¨ä¸­ fromIndexï¼ˆåŒ…æ‹¬ï¼‰å’Œ toIndexï¼ˆä¸åŒ…æ‹¬ï¼‰ä¹‹é—´éƒ¨åˆ†çš„è§†å›¾ã€‚List&lt;E&gt; subList(int fromIndex, int toIndex)// è¿”å›ä¸€ä¸ªæŒ‰æ°å½“é¡ºåºï¼ˆä»ç¬¬ä¸€ä¸ªå…ƒç´ åˆ°æœ€åä¸€ä¸ªå…ƒç´ ï¼‰åŒ…å«æ­¤åˆ—è¡¨ä¸­æ‰€æœ‰å…ƒç´ çš„æ•°ç»„ã€‚Object[] toArray()// è¿”å›ä»¥æ°å½“é¡ºåºï¼ˆä»ç¬¬ä¸€ä¸ªå…ƒç´ åˆ°æœ€åä¸€ä¸ªå…ƒç´ ï¼‰åŒ…å«åˆ—è¡¨æ‰€æœ‰å…ƒç´ çš„æ•°ç»„ï¼›è¿”å›æ•°ç»„çš„è¿è¡Œæ—¶ç±»å‹æ˜¯æŒ‡å®šæ•°ç»„çš„è¿è¡Œæ—¶ç±»å‹ã€‚&lt;T&gt; T[] toArray(T[] a)// è¿”å›æ­¤åˆ—è¡¨çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ã€‚1234567891011121314151617181920212223242526271. åˆ›å»ºCopyOnWriteArrayListå…±3ä¸ªæ„é€ å‡½æ•°ã€‚è¯´æ˜ï¼šè¿™3ä¸ªæ„é€ å‡½æ•°éƒ½è°ƒç”¨äº†setArray()ï¼Œè¯´æ˜ï¼šsetArray()çš„ä½œç”¨æ˜¯ç»™arrayèµ‹å€¼ï¼›å…¶ä¸­ï¼Œarrayæ˜¯volatile transient Object[]ç±»å‹ï¼Œå³arrayæ˜¯â€œvolatileæ•°ç»„â€ã€‚å…³äºvolatileå…³é”®å­—ï¼Œæˆ‘ä»¬çŸ¥é“â€œvolatileèƒ½è®©å˜é‡å˜å¾—å¯è§â€ï¼Œå³å¯¹ä¸€ä¸ªvolatileå˜é‡çš„è¯»ï¼Œæ€»æ˜¯èƒ½çœ‹åˆ°ï¼ˆä»»æ„çº¿ç¨‹ï¼‰å¯¹è¿™ä¸ªvolatileå˜é‡æœ€åçš„å†™å…¥ã€‚æ­£åœ¨ç”±äºè¿™ç§ç‰¹æ€§ï¼Œæ¯æ¬¡æ›´æ–°äº†â€œvolatileæ•°ç»„â€ä¹‹åï¼Œå…¶å®ƒçº¿ç¨‹éƒ½èƒ½çœ‹åˆ°å¯¹å®ƒæ‰€åšçš„æ›´æ–°ã€‚å…³äºtransientå…³é”®å­—ï¼Œå®ƒæ˜¯åœ¨åºåˆ—åŒ–ä¸­æ‰èµ·ä½œç”¨ï¼Œtransientå˜é‡ä¸ä¼šè¢«è‡ªåŠ¨åºåˆ—åŒ–ã€‚transientä¸æ˜¯æœ¬æ–‡å…³æ³¨çš„é‡ç‚¹ï¼Œäº†è§£å³å¯ã€‚å…³äºtransientçš„æ›´å¤šå†…å®¹ï¼Œè¯·å‚è€ƒï¼šhttp://www.cnblogs.com/skywang12345/p/io_06.html2. æ·»åŠ ä»¥add(E e)ä¸ºä¾‹ï¼Œæ¥å¯¹â€œCopyOnWriteArrayListçš„æ·»åŠ æ“ä½œâ€è¿›è¡Œè¯´æ˜è¯´æ˜ï¼šadd(E e)çš„ä½œç”¨å°±æ˜¯å°†æ•°æ®eæ·»åŠ åˆ°â€volatileæ•°ç»„â€œä¸­ã€‚å®ƒçš„å®ç°æ–¹å¼æ˜¯ï¼Œæ–°å»ºä¸€ä¸ªæ•°ç»„ï¼Œæ¥ç€å°†åŸå§‹çš„â€volatileæ•°ç»„â€œçš„æ•°æ®æ‹·è´åˆ°æ–°æ•°ç»„ä¸­ï¼Œç„¶åå°†æ–°å¢æ•°æ®ä¹Ÿæ·»åŠ åˆ°æ–°æ•°ç»„ä¸­ï¼›æœ€åï¼Œå°†æ–°æ•°ç»„èµ‹å€¼ç»™â€volatileæ•°ç»„â€œã€‚åœ¨add(E e)ä¸­æœ‰ä¸¤ç‚¹éœ€è¦å…³æ³¨ã€‚ç¬¬ä¸€ï¼Œåœ¨â€æ·»åŠ æ“ä½œâ€œå¼€å§‹å‰ï¼Œè·å–ç‹¬å é”(lock)ï¼Œè‹¥æ­¤æ—¶æœ‰éœ€è¦çº¿ç¨‹è¦è·å–é”ï¼Œåˆ™å¿…é¡»ç­‰å¾…ï¼›åœ¨æ“ä½œå®Œæ¯•åï¼Œé‡Šæ”¾ç‹¬å é”(lock)ï¼Œæ­¤æ—¶å…¶å®ƒçº¿ç¨‹æ‰èƒ½è·å–é”ã€‚é€šè¿‡ç‹¬å é”ï¼Œæ¥é˜²æ­¢å¤šçº¿ç¨‹åŒæ—¶ä¿®æ”¹æ•°æ®ï¼3. è·å–è¯´æ˜ï¼šget(int index)çš„å®ç°å¾ˆç®€å•ï¼Œå°±æ˜¯è¿”å›â€volatileæ•°ç»„â€œä¸­çš„ç¬¬indexä¸ªå…ƒç´ ã€‚4. åˆ é™¤ä»¥remove(int index)ä¸ºä¾‹ï¼Œæ¥å¯¹â€œCopyOnWriteArrayListçš„åˆ é™¤æ“ä½œâ€è¿›è¡Œè¯´æ˜ã€‚è¯´æ˜ï¼šremove(int index)çš„ä½œç”¨å°±æ˜¯å°†â€volatileæ•°ç»„â€œä¸­ç¬¬indexä¸ªå…ƒç´ åˆ é™¤ã€‚å®ƒçš„å®ç°æ–¹å¼æ˜¯ï¼Œå¦‚æœè¢«åˆ é™¤çš„æ˜¯æœ€åä¸€ä¸ªå…ƒç´ ï¼Œåˆ™ç›´æ¥é€šè¿‡Arrays.copyOf()è¿›è¡Œå¤„ç†ï¼Œè€Œä¸éœ€è¦æ–°å»ºæ•°ç»„ã€‚å¦åˆ™ï¼Œæ–°å»ºæ•°ç»„ï¼Œç„¶åå°†â€volatileæ•°ç»„ä¸­è¢«åˆ é™¤å…ƒç´ ä¹‹å¤–çš„å…¶å®ƒå…ƒç´ â€œæ‹·è´åˆ°æ–°æ•°ç»„ä¸­ï¼›æœ€åï¼Œå°†æ–°æ•°ç»„èµ‹å€¼ç»™â€volatileæ•°ç»„â€œã€‚å’Œadd(E e)ä¸€æ ·ï¼Œremove(int index)ä¹Ÿæ˜¯â€åœ¨æ“ä½œä¹‹å‰ï¼Œè·å–ç‹¬å é”ï¼›æ“ä½œå®Œæˆä¹‹åï¼Œé‡Šæ”¾ç‹¬å æ˜¯â€œï¼›å¹¶ä¸”â€åœ¨æ“ä½œå®Œæˆæ—¶ï¼Œä¼šé€šè¿‡å°†æ•°æ®æ›´æ–°åˆ°volatileæ•°ç»„ä¸­â€œã€‚5. éå†ä»¥iterator()ä¸ºä¾‹ï¼Œæ¥å¯¹â€œCopyOnWriteArrayListçš„éå†æ“ä½œâ€è¿›è¡Œè¯´æ˜ã€‚è¯´æ˜ï¼šiterator()ä¼šè¿”å›COWIteratorå¯¹è±¡ã€‚COWIteratorå®ç°é¢ListIteratoræ¥å£ï¼Œè¯´æ˜ï¼šCOWIteratorä¸æ”¯æŒä¿®æ”¹å…ƒç´ çš„æ“ä½œã€‚ä¾‹å¦‚ï¼Œå¯¹äºremove(),set(),add()ç­‰æ“ä½œï¼ŒCOWIteratoréƒ½ä¼šæŠ›å‡ºå¼‚å¸¸ï¼å¦å¤–ï¼Œéœ€è¦æåˆ°çš„ä¸€ç‚¹æ˜¯ï¼ŒCopyOnWriteArrayListè¿”å›è¿­ä»£å™¨ä¸ä¼šæŠ›å‡ºConcurrentModificationExceptionå¼‚å¸¸ï¼Œå³å®ƒä¸æ˜¯fail-fastæœºåˆ¶çš„ï¼CopyOnWriteArrayListç¤ºä¾‹12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061import java.util.*;import java.util.concurrent.*;/* *   CopyOnWriteArrayListæ˜¯â€œçº¿ç¨‹å®‰å…¨â€çš„åŠ¨æ€æ•°ç»„ï¼Œè€ŒArrayListæ˜¯éçº¿ç¨‹å®‰å…¨çš„ã€‚ * *   ä¸‹é¢æ˜¯â€œå¤šä¸ªçº¿ç¨‹åŒæ—¶æ“ä½œå¹¶ä¸”éå†listâ€çš„ç¤ºä¾‹ *   (01) å½“listæ˜¯CopyOnWriteArrayListå¯¹è±¡æ—¶ï¼Œç¨‹åºèƒ½æ­£å¸¸è¿è¡Œã€‚ *   (02) å½“listæ˜¯ArrayListå¯¹è±¡æ—¶ï¼Œç¨‹åºä¼šäº§ç”ŸConcurrentModificationExceptionå¼‚å¸¸ã€‚ * * @author skywang */public class CopyOnWriteArrayListTest1 {    // TODO: listæ˜¯ArrayListå¯¹è±¡æ—¶ï¼Œç¨‹åºä¼šå‡ºé”™ã€‚    //private static List&lt;String&gt; list = new ArrayList&lt;String&gt;();    private static List&lt;String&gt; list = new CopyOnWriteArrayList&lt;String&gt;();    public static void main(String[] args) {        // åŒæ—¶å¯åŠ¨ä¸¤ä¸ªçº¿ç¨‹å¯¹listè¿›è¡Œæ“ä½œï¼        new MyThread(&quot;ta&quot;).start();        new MyThread(&quot;tb&quot;).start();    }    private static void printAll() {        String value = null;        Iterator iter = list.iterator();        while(iter.hasNext()) {            value = (String)iter.next();            System.out.print(value+&quot;, &quot;);        }        System.out.println();    }    private static class MyThread extends Thread {        MyThread(String name) {            super(name);        }        @Override        public void run() {                int i = 0;            while (i++ &lt; 6) {                // â€œçº¿ç¨‹åâ€ + &quot;-&quot; + &quot;åºå·&quot;                String val = Thread.currentThread().getName()+&quot;-&quot;+i;                list.add(val);                // é€šè¿‡â€œIteratorâ€éå†Listã€‚                printAll();            }        }    }}ta-1, tb-1, ta-1, tb-1, ta-1, ta-1, tb-1, tb-1, tb-2, tb-2, ta-1, ta-2, tb-1, ta-1, tb-2, tb-1, ta-2, tb-2, tb-3, ta-2, ta-1, tb-3, tb-1, ta-3, tb-2, ta-1, ta-2, tb-1, tb-3, tb-2, ta-3, ta-2, tb-4, tb-3, ta-1, ta-3, tb-1, tb-4, tb-2, ta-4, ta-2, ta-1, tb-3, tb-1, ta-3, tb-2, tb-4, ta-2, ta-4, tb-3, tb-5, ta-3, ta-1, tb-4, tb-1, ta-4, tb-2, tb-5, ta-2, ta-5, tb-3, ta-1, ta-3, tb-1, tb-4, tb-2, ta-4, ta-2, tb-5, tb-3, ta-5, ta-3, tb-6, tb-4, ta-4, tb-5, ta-5, tb-6, ta-6,ç»“æœè¯´æ˜ï¼šå¦‚æœå°†æºç ä¸­çš„listæ”¹æˆArrayListå¯¹è±¡æ—¶ï¼Œç¨‹åºä¼šäº§ç”ŸConcurrentModificationExceptionå¼‚å¸¸ã€‚ConcurrentSkipListMap123ConcurrentSkipListMapæ˜¯çº¿ç¨‹å®‰å…¨çš„æœ‰åºçš„å“ˆå¸Œè¡¨ï¼Œé€‚ç”¨äºé«˜å¹¶å‘çš„åœºæ™¯ã€‚ConcurrentSkipListMapå’ŒTreeMapï¼Œå®ƒä»¬è™½ç„¶éƒ½æ˜¯æœ‰åºçš„å“ˆå¸Œè¡¨ã€‚ä½†æ˜¯ï¼Œç¬¬ä¸€ï¼Œå®ƒä»¬çš„çº¿ç¨‹å®‰å…¨æœºåˆ¶ä¸åŒï¼ŒTreeMapæ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼Œè€ŒConcurrentSkipListMapæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ç¬¬äºŒï¼ŒConcurrentSkipListMapæ˜¯é€šè¿‡è·³è¡¨å®ç°çš„ï¼Œè€ŒTreeMapæ˜¯é€šè¿‡çº¢é»‘æ ‘å®ç°çš„ã€‚å…³äºè·³è¡¨(Skip List)ï¼Œå®ƒæ˜¯å¹³è¡¡æ ‘çš„ä¸€ç§æ›¿ä»£çš„æ•°æ®ç»“æ„ï¼Œä½†æ˜¯å’Œçº¢é»‘æ ‘ä¸ç›¸åŒçš„æ˜¯ï¼Œè·³è¡¨å¯¹äºæ ‘çš„å¹³è¡¡çš„å®ç°æ˜¯åŸºäºä¸€ç§éšæœºåŒ–çš„ç®—æ³•çš„ï¼Œè¿™æ ·ä¹Ÿå°±æ˜¯è¯´è·³è¡¨çš„æ’å…¥å’Œåˆ é™¤çš„å·¥ä½œæ˜¯æ¯”è¾ƒç®€å•çš„ã€‚è¯´æ˜ï¼šå…ˆä»¥æ•°æ®â€œ7,14,21,32,37,71,85â€åºåˆ—ä¸ºä¾‹ï¼Œæ¥å¯¹è·³è¡¨è¿›è¡Œç®€å•è¯´æ˜ã€‚è·³è¡¨åˆ†ä¸ºè®¸å¤šå±‚(level)ï¼Œæ¯ä¸€å±‚éƒ½å¯ä»¥çœ‹ä½œæ˜¯æ•°æ®çš„ç´¢å¼•ï¼Œè¿™äº›ç´¢å¼•çš„æ„ä¹‰å°±æ˜¯åŠ å¿«è·³è¡¨æŸ¥æ‰¾æ•°æ®é€Ÿåº¦ã€‚æ¯ä¸€å±‚çš„æ•°æ®éƒ½æ˜¯æœ‰åºçš„ï¼Œä¸Šä¸€å±‚æ•°æ®æ˜¯ä¸‹ä¸€å±‚æ•°æ®çš„å­é›†ï¼Œå¹¶ä¸”ç¬¬ä¸€å±‚(level 1)åŒ…å«äº†å…¨éƒ¨çš„æ•°æ®ï¼›å±‚æ¬¡è¶Šé«˜ï¼Œè·³è·ƒæ€§è¶Šå¤§ï¼ŒåŒ…å«çš„æ•°æ®è¶Šå°‘ã€‚è·³è¡¨åŒ…å«ä¸€ä¸ªè¡¨å¤´ï¼Œå®ƒæŸ¥æ‰¾æ•°æ®æ—¶ï¼Œæ˜¯ä»ä¸Šå¾€ä¸‹ï¼Œä»å·¦å¾€å³è¿›è¡ŒæŸ¥æ‰¾ã€‚ç°åœ¨â€œéœ€è¦æ‰¾å‡ºå€¼ä¸º32çš„èŠ‚ç‚¹â€ä¸ºä¾‹ï¼Œæ¥å¯¹æ¯”è¯´æ˜è·³è¡¨å’Œæ™®éçš„é“¾è¡¨ã€‚æƒ…å†µ1ï¼šé“¾è¡¨ä¸­æŸ¥æ‰¾â€œ32â€èŠ‚ç‚¹æƒ…å†µ2ï¼šè·³è¡¨ä¸­æŸ¥æ‰¾â€œ32â€èŠ‚ç‚¹å¿½ç•¥ç´¢å¼•å‚ç›´çº¿è·¯ä¸Šè·¯å¾„çš„æƒ…å†µä¸‹ï¼Œåªéœ€è¦2æ­¥(çº¢è‰²éƒ¨åˆ†è¡¨ç¤ºè·¯å¾„)ã€‚1234ä¸‹é¢è¯´è¯´Javaä¸­ConcurrentSkipListMapçš„æ•°æ®ç»“æ„ã€‚(01) ConcurrentSkipListMapç»§æ‰¿äºAbstractMapç±»ï¼Œä¹Ÿå°±æ„å‘³ç€å®ƒæ˜¯ä¸€ä¸ªå“ˆå¸Œè¡¨ã€‚(02) Indexæ˜¯ConcurrentSkipListMapçš„å†…éƒ¨ç±»ï¼Œå®ƒä¸â€œè·³è¡¨ä¸­çš„ç´¢å¼•ç›¸å¯¹åº”â€ã€‚HeadIndexç»§æ‰¿äºIndexï¼ŒConcurrentSkipListMapä¸­å«æœ‰ä¸€ä¸ªHeadIndexçš„å¯¹è±¡headï¼Œheadæ˜¯â€œè·³è¡¨çš„è¡¨å¤´â€ã€‚(03) Indexæ˜¯è·³è¡¨ä¸­çš„ç´¢å¼•ï¼Œå®ƒåŒ…å«â€œå³ç´¢å¼•çš„æŒ‡é’ˆ(right)â€ï¼Œâ€œä¸‹ç´¢å¼•çš„æŒ‡é’ˆ(down)â€å’Œâ€œå“ˆå¸Œè¡¨èŠ‚ç‚¹nodeâ€ã€‚nodeæ˜¯Nodeçš„å¯¹è±¡ï¼ŒNodeä¹Ÿæ˜¯ConcurrentSkipListMapä¸­çš„å†…éƒ¨ç±»ã€‚12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091// ConcurrentSkipListMapå‡½æ•°åˆ—è¡¨// æ„é€ ä¸€ä¸ªæ–°çš„ç©ºæ˜ å°„ï¼Œè¯¥æ˜ å°„æŒ‰ç…§é”®çš„è‡ªç„¶é¡ºåºè¿›è¡Œæ’åºã€‚ConcurrentSkipListMap()// æ„é€ ä¸€ä¸ªæ–°çš„ç©ºæ˜ å°„ï¼Œè¯¥æ˜ å°„æŒ‰ç…§æŒ‡å®šçš„æ¯”è¾ƒå™¨è¿›è¡Œæ’åºã€‚ConcurrentSkipListMap(Comparator&lt;? super K&gt; comparator)// æ„é€ ä¸€ä¸ªæ–°æ˜ å°„ï¼Œè¯¥æ˜ å°„æ‰€åŒ…å«çš„æ˜ å°„å…³ç³»ä¸ç»™å®šæ˜ å°„åŒ…å«çš„æ˜ å°„å…³ç³»ç›¸åŒï¼Œå¹¶æŒ‰ç…§é”®çš„è‡ªç„¶é¡ºåºè¿›è¡Œæ’åºã€‚ConcurrentSkipListMap(Map&lt;? extends K,? extends V&gt; m)// æ„é€ ä¸€ä¸ªæ–°æ˜ å°„ï¼Œè¯¥æ˜ å°„æ‰€åŒ…å«çš„æ˜ å°„å…³ç³»ä¸æŒ‡å®šçš„æœ‰åºæ˜ å°„åŒ…å«çš„æ˜ å°„å…³ç³»ç›¸åŒï¼Œä½¿ç”¨çš„é¡ºåºä¹Ÿç›¸åŒã€‚ConcurrentSkipListMap(SortedMap&lt;K,? extends V&gt; m)// è¿”å›ä¸å¤§äºç­‰äºç»™å®šé”®çš„æœ€å°é”®å…³è”çš„é”®-å€¼æ˜ å°„å…³ç³»ï¼›å¦‚æœä¸å­˜åœ¨è¿™æ ·çš„æ¡ç›®ï¼Œåˆ™è¿”å› nullã€‚Map.Entry&lt;K,V&gt; ceilingEntry(K key)// è¿”å›å¤§äºç­‰äºç»™å®šé”®çš„æœ€å°é”®ï¼›å¦‚æœä¸å­˜åœ¨è¿™æ ·çš„é”®ï¼Œåˆ™è¿”å› nullã€‚K ceilingKey(K key)// ä»æ­¤æ˜ å°„ä¸­ç§»é™¤æ‰€æœ‰æ˜ å°„å…³ç³»ã€‚void clear()// è¿”å›æ­¤ ConcurrentSkipListMap å®ä¾‹çš„æµ…è¡¨å‰¯æœ¬ã€‚ConcurrentSkipListMap&lt;K,V&gt; clone()// è¿”å›å¯¹æ­¤æ˜ å°„ä¸­çš„é”®è¿›è¡Œæ’åºçš„æ¯”è¾ƒå™¨ï¼›å¦‚æœæ­¤æ˜ å°„ä½¿ç”¨é”®çš„è‡ªç„¶é¡ºåºï¼Œåˆ™è¿”å› nullã€‚Comparator&lt;? super K&gt; comparator()// å¦‚æœæ­¤æ˜ å°„åŒ…å«æŒ‡å®šé”®çš„æ˜ å°„å…³ç³»ï¼Œåˆ™è¿”å› trueã€‚boolean containsKey(Object key)// å¦‚æœæ­¤æ˜ å°„ä¸ºæŒ‡å®šå€¼æ˜ å°„ä¸€ä¸ªæˆ–å¤šä¸ªé”®ï¼Œåˆ™è¿”å› trueã€‚boolean containsValue(Object value)// è¿”å›æ­¤æ˜ å°„ä¸­æ‰€åŒ…å«é”®çš„é€†åº NavigableSet è§†å›¾ã€‚NavigableSet&lt;K&gt; descendingKeySet()// è¿”å›æ­¤æ˜ å°„ä¸­æ‰€åŒ…å«æ˜ å°„å…³ç³»çš„é€†åºè§†å›¾ã€‚ConcurrentNavigableMap&lt;K,V&gt; descendingMap()// è¿”å›æ­¤æ˜ å°„ä¸­æ‰€åŒ…å«çš„æ˜ å°„å…³ç³»çš„ Set è§†å›¾ã€‚Set&lt;Map.Entry&lt;K,V&gt;&gt; entrySet()// æ¯”è¾ƒæŒ‡å®šå¯¹è±¡ä¸æ­¤æ˜ å°„çš„ç›¸ç­‰æ€§ã€‚boolean equals(Object o)// è¿”å›ä¸æ­¤æ˜ å°„ä¸­çš„æœ€å°é”®å…³è”çš„é”®-å€¼æ˜ å°„å…³ç³»ï¼›å¦‚æœè¯¥æ˜ å°„ä¸ºç©ºï¼Œåˆ™è¿”å› nullã€‚Map.Entry&lt;K,V&gt; firstEntry()// è¿”å›æ­¤æ˜ å°„ä¸­å½“å‰ç¬¬ä¸€ä¸ªï¼ˆæœ€ä½ï¼‰é”®ã€‚K firstKey()// è¿”å›ä¸å°äºç­‰äºç»™å®šé”®çš„æœ€å¤§é”®å…³è”çš„é”®-å€¼æ˜ å°„å…³ç³»ï¼›å¦‚æœä¸å­˜åœ¨è¿™æ ·çš„é”®ï¼Œåˆ™è¿”å› nullã€‚Map.Entry&lt;K,V&gt; floorEntry(K key)// è¿”å›å°äºç­‰äºç»™å®šé”®çš„æœ€å¤§é”®ï¼›å¦‚æœä¸å­˜åœ¨è¿™æ ·çš„é”®ï¼Œåˆ™è¿”å› nullã€‚K floorKey(K key)// è¿”å›æŒ‡å®šé”®æ‰€æ˜ å°„åˆ°çš„å€¼ï¼›å¦‚æœæ­¤æ˜ å°„ä¸åŒ…å«è¯¥é”®çš„æ˜ å°„å…³ç³»ï¼Œåˆ™è¿”å› nullã€‚V get(Object key)// è¿”å›æ­¤æ˜ å°„çš„éƒ¨åˆ†è§†å›¾ï¼Œå…¶é”®å€¼ä¸¥æ ¼å°äº toKeyã€‚ConcurrentNavigableMap&lt;K,V&gt; headMap(K toKey)// è¿”å›æ­¤æ˜ å°„çš„éƒ¨åˆ†è§†å›¾ï¼Œå…¶é”®å°äºï¼ˆæˆ–ç­‰äºï¼Œå¦‚æœ inclusive ä¸º trueï¼‰toKeyã€‚ConcurrentNavigableMap&lt;K,V&gt; headMap(K toKey, boolean inclusive)// è¿”å›ä¸ä¸¥æ ¼å¤§äºç»™å®šé”®çš„æœ€å°é”®å…³è”çš„é”®-å€¼æ˜ å°„å…³ç³»ï¼›å¦‚æœä¸å­˜åœ¨è¿™æ ·çš„é”®ï¼Œåˆ™è¿”å› nullã€‚Map.Entry&lt;K,V&gt; higherEntry(K key)// è¿”å›ä¸¥æ ¼å¤§äºç»™å®šé”®çš„æœ€å°é”®ï¼›å¦‚æœä¸å­˜åœ¨è¿™æ ·çš„é”®ï¼Œåˆ™è¿”å› nullã€‚K higherKey(K key)// å¦‚æœæ­¤æ˜ å°„æœªåŒ…å«é”®-å€¼æ˜ å°„å…³ç³»ï¼Œåˆ™è¿”å› trueã€‚boolean isEmpty()// è¿”å›æ­¤æ˜ å°„ä¸­æ‰€åŒ…å«é”®çš„ NavigableSet è§†å›¾ã€‚NavigableSet&lt;K&gt; keySet()// è¿”å›ä¸æ­¤æ˜ å°„ä¸­çš„æœ€å¤§é”®å…³è”çš„é”®-å€¼æ˜ å°„å…³ç³»ï¼›å¦‚æœè¯¥æ˜ å°„ä¸ºç©ºï¼Œåˆ™è¿”å› nullã€‚Map.Entry&lt;K,V&gt; lastEntry()// è¿”å›æ˜ å°„ä¸­å½“å‰æœ€åä¸€ä¸ªï¼ˆæœ€é«˜ï¼‰é”®ã€‚K lastKey()// è¿”å›ä¸ä¸¥æ ¼å°äºç»™å®šé”®çš„æœ€å¤§é”®å…³è”çš„é”®-å€¼æ˜ å°„å…³ç³»ï¼›å¦‚æœä¸å­˜åœ¨è¿™æ ·çš„é”®ï¼Œåˆ™è¿”å› nullã€‚Map.Entry&lt;K,V&gt; lowerEntry(K key)// è¿”å›ä¸¥æ ¼å°äºç»™å®šé”®çš„æœ€å¤§é”®ï¼›å¦‚æœä¸å­˜åœ¨è¿™æ ·çš„é”®ï¼Œåˆ™è¿”å› nullã€‚K lowerKey(K key)// è¿”å›æ­¤æ˜ å°„ä¸­æ‰€åŒ…å«é”®çš„ NavigableSet è§†å›¾ã€‚NavigableSet&lt;K&gt; navigableKeySet()// ç§»é™¤å¹¶è¿”å›ä¸æ­¤æ˜ å°„ä¸­çš„æœ€å°é”®å…³è”çš„é”®-å€¼æ˜ å°„å…³ç³»ï¼›å¦‚æœè¯¥æ˜ å°„ä¸ºç©ºï¼Œåˆ™è¿”å› nullã€‚Map.Entry&lt;K,V&gt; pollFirstEntry()// ç§»é™¤å¹¶è¿”å›ä¸æ­¤æ˜ å°„ä¸­çš„æœ€å¤§é”®å…³è”çš„é”®-å€¼æ˜ å°„å…³ç³»ï¼›å¦‚æœè¯¥æ˜ å°„ä¸ºç©ºï¼Œåˆ™è¿”å› nullã€‚Map.Entry&lt;K,V&gt; pollLastEntry()// å°†æŒ‡å®šå€¼ä¸æ­¤æ˜ å°„ä¸­çš„æŒ‡å®šé”®å…³è”ã€‚V put(K key, V value)// å¦‚æœæŒ‡å®šé”®å·²ç»ä¸å†ä¸æŸä¸ªå€¼ç›¸å…³è”ï¼Œåˆ™å°†å®ƒä¸ç»™å®šå€¼å…³è”ã€‚V putIfAbsent(K key, V value)// ä»æ­¤æ˜ å°„ä¸­ç§»é™¤æŒ‡å®šé”®çš„æ˜ å°„å…³ç³»ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ã€‚V remove(Object key)// åªæœ‰ç›®å‰å°†é”®çš„æ¡ç›®æ˜ å°„åˆ°ç»™å®šå€¼æ—¶ï¼Œæ‰ç§»é™¤è¯¥é”®çš„æ¡ç›®ã€‚boolean remove(Object key, Object value)// åªæœ‰ç›®å‰å°†é”®çš„æ¡ç›®æ˜ å°„åˆ°æŸä¸€å€¼æ—¶ï¼Œæ‰æ›¿æ¢è¯¥é”®çš„æ¡ç›®ã€‚V replace(K key, V value)// åªæœ‰ç›®å‰å°†é”®çš„æ¡ç›®æ˜ å°„åˆ°ç»™å®šå€¼æ—¶ï¼Œæ‰æ›¿æ¢è¯¥é”®çš„æ¡ç›®ã€‚boolean replace(K key, V oldValue, V newValue)// è¿”å›æ­¤æ˜ å°„ä¸­çš„é”®-å€¼æ˜ å°„å…³ç³»æ•°ã€‚int size()// è¿”å›æ­¤æ˜ å°„çš„éƒ¨åˆ†è§†å›¾ï¼Œå…¶é”®çš„èŒƒå›´ä» fromKey åˆ° toKeyã€‚ConcurrentNavigableMap&lt;K,V&gt; subMap(K fromKey, boolean fromInclusive, K toKey, boolean toInclusive)// è¿”å›æ­¤æ˜ å°„çš„éƒ¨åˆ†è§†å›¾ï¼Œå…¶é”®å€¼çš„èŒƒå›´ä» fromKeyï¼ˆåŒ…æ‹¬ï¼‰åˆ° toKeyï¼ˆä¸åŒ…æ‹¬ï¼‰ã€‚ConcurrentNavigableMap&lt;K,V&gt; subMap(K fromKey, K toKey)// è¿”å›æ­¤æ˜ å°„çš„éƒ¨åˆ†è§†å›¾ï¼Œå…¶é”®å¤§äºç­‰äº fromKeyã€‚ConcurrentNavigableMap&lt;K,V&gt; tailMap(K fromKey)// è¿”å›æ­¤æ˜ å°„çš„éƒ¨åˆ†è§†å›¾ï¼Œå…¶é”®å¤§äºï¼ˆæˆ–ç­‰äºï¼Œå¦‚æœ inclusive ä¸º trueï¼‰fromKeyã€‚ConcurrentNavigableMap&lt;K,V&gt; tailMap(K fromKey, boolean inclusive)// è¿”å›æ­¤æ˜ å°„ä¸­æ‰€åŒ…å«å€¼çš„ Collection è§†å›¾ã€‚Collection&lt;V&gt; values()1234567891011121314151617181920212223242526272829303132331. æ·»åŠ ä¸‹é¢ä»¥put(K key, V value)ä¸ºä¾‹ï¼Œå¯¹ConcurrentSkipListMapçš„æ·»åŠ æ–¹æ³•è¿›è¡Œè¯´æ˜ã€‚å®é™…ä¸Šï¼Œput()æ˜¯é€šè¿‡doPut()å°†key-valueé”®å€¼å¯¹æ·»åŠ åˆ°ConcurrentSkipListMapä¸­çš„ã€‚è¯´æ˜ï¼šdoPut() çš„ä½œç”¨å°±æ˜¯å°†é”®å€¼å¯¹æ·»åŠ åˆ°â€œè·³è¡¨â€ä¸­ã€‚è¦æƒ³ææ¸…doPut()ï¼Œé¦–å…ˆè¦å¼„æ¸…æ¥šå®ƒçš„ä¸»å¹²éƒ¨åˆ† â€”â€” æˆ‘ä»¬å…ˆå•çº¯çš„åªè€ƒè™‘â€œå•çº¿ç¨‹çš„æƒ…å†µä¸‹ï¼Œå°†key-valueæ·»åŠ åˆ°è·³è¡¨ä¸­â€ï¼Œå³å¿½ç•¥â€œå¤šçº¿ç¨‹ç›¸å…³çš„å†…å®¹â€ã€‚å®ƒçš„æµç¨‹å¦‚ä¸‹ï¼šç¬¬1æ­¥ï¼šæ‰¾åˆ°â€œæ’å…¥ä½ç½®â€ã€‚å³ï¼Œæ‰¾åˆ°â€œkeyçš„å‰ç»§èŠ‚ç‚¹(b)â€å’Œâ€œkeyçš„åç»§èŠ‚ç‚¹(n)â€ï¼›keyæ˜¯è¦æ’å…¥èŠ‚ç‚¹çš„é”®ã€‚ç¬¬2æ­¥ï¼šæ–°å»ºå¹¶æ’å…¥èŠ‚ç‚¹ã€‚å³ï¼Œæ–°å»ºèŠ‚ç‚¹z(keyå¯¹åº”çš„èŠ‚ç‚¹)ï¼Œå¹¶å°†æ–°èŠ‚ç‚¹zæ’å…¥åˆ°â€œè·³è¡¨â€ä¸­(è®¾ç½®â€œbçš„åç»§èŠ‚ç‚¹ä¸ºzâ€ï¼Œâ€œzçš„åç»§èŠ‚ç‚¹ä¸ºnâ€)ã€‚ç¬¬3æ­¥ï¼šæ›´æ–°è·³è¡¨ã€‚å³ï¼Œéšæœºè·å–ä¸€ä¸ªlevelï¼Œç„¶ååœ¨â€œè·³è¡¨â€çš„ç¬¬1å±‚ï½ç¬¬levelå±‚ä¹‹é—´ï¼Œæ¯ä¸€å±‚éƒ½æ’å…¥èŠ‚ç‚¹zï¼›åœ¨ç¬¬levelå±‚ä¹‹ä¸Šå°±ä¸å†æ’å…¥èŠ‚ç‚¹äº†ã€‚è‹¥levelæ•°å€¼å¤§äºâ€œè·³è¡¨çš„å±‚æ¬¡â€ï¼Œåˆ™æ–°å»ºä¸€å±‚ã€‚2. åˆ é™¤ä¸‹é¢ä»¥remove(Object key)ä¸ºä¾‹ï¼Œå¯¹ConcurrentSkipListMapçš„åˆ é™¤æ–¹æ³•è¿›è¡Œè¯´æ˜ã€‚å®é™…ä¸Šï¼Œremove()æ˜¯é€šè¿‡doRemove()å°†ConcurrentSkipListMapä¸­çš„keyå¯¹åº”çš„é”®å€¼å¯¹åˆ é™¤çš„ã€‚è¯´æ˜ï¼šdoRemove()çš„ä½œç”¨æ˜¯åˆ é™¤è·³è¡¨ä¸­çš„èŠ‚ç‚¹ã€‚å’ŒdoPut()ä¸€æ ·ï¼Œæˆ‘ä»¬é‡ç‚¹çœ‹doRemove()çš„ä¸»å¹²éƒ¨åˆ†ï¼Œäº†è§£ä¸»å¹²éƒ¨åˆ†ä¹‹åï¼Œå…¶ä½™éƒ¨åˆ†å°±éå¸¸å®¹æ˜“ç†è§£äº†ã€‚ä¸‹é¢æ˜¯â€œå•çº¿ç¨‹çš„æƒ…å†µä¸‹ï¼Œåˆ é™¤è·³è¡¨ä¸­é”®å€¼å¯¹çš„æ­¥éª¤â€ï¼šç¬¬1æ­¥ï¼šæ‰¾åˆ°â€œè¢«åˆ é™¤èŠ‚ç‚¹çš„ä½ç½®â€ã€‚ å³ï¼Œæ‰¾åˆ°â€œkeyçš„å‰ç»§èŠ‚ç‚¹(b)â€ï¼Œâ€œkeyæ‰€å¯¹åº”çš„èŠ‚ç‚¹(n)â€ï¼Œâ€œnçš„åç»§èŠ‚ç‚¹fâ€ï¼›keyæ˜¯è¦åˆ é™¤èŠ‚ç‚¹çš„é”®ã€‚ç¬¬2æ­¥ï¼šåˆ é™¤èŠ‚ç‚¹ã€‚ å³ï¼Œå°†â€œkeyæ‰€å¯¹åº”çš„èŠ‚ç‚¹nâ€ä»è·³è¡¨ä¸­ç§»é™¤ -- å°†â€œbçš„åç»§èŠ‚ç‚¹â€è®¾ä¸ºâ€œfâ€ï¼ç¬¬3æ­¥ï¼šæ›´æ–°è·³è¡¨ã€‚ å³ï¼Œéå†è·³è¡¨ï¼Œåˆ é™¤æ¯ä¸€å±‚çš„â€œkeyèŠ‚ç‚¹â€(å¦‚æœå­˜åœ¨çš„è¯)ã€‚å¦‚æœåˆ é™¤â€œkeyèŠ‚ç‚¹â€ä¹‹åï¼Œè·³è¡¨çš„å±‚æ¬¡éœ€è¦-1ï¼›åˆ™æ‰§è¡Œç›¸åº”çš„æ“ä½œï¼ 3. è·å–ä¸‹é¢ä»¥get(Object key)ä¸ºä¾‹ï¼Œå¯¹ConcurrentSkipListMapçš„è·å–æ–¹æ³•è¿›è¡Œè¯´æ˜ã€‚è¯´æ˜ï¼šdoGet()æ˜¯é€šè¿‡findNode()æ‰¾åˆ°å¹¶è¿”å›èŠ‚ç‚¹çš„ã€‚è¯´æ˜ï¼šfindNode(key)çš„ä½œç”¨æ˜¯åœ¨è¿”å›è·³è¡¨ä¸­keyå¯¹åº”çš„èŠ‚ç‚¹ï¼›å­˜åœ¨åˆ™è¿”å›èŠ‚ç‚¹ï¼Œä¸å­˜åœ¨åˆ™è¿”å›nullã€‚å…ˆå¼„æ¸…å‡½æ•°çš„ä¸»å¹²éƒ¨åˆ†ï¼Œå³æŠ›å¼€â€œå¤šçº¿ç¨‹ç›¸å…³å†…å®¹â€ï¼Œå•çº¯çš„è€ƒè™‘å•çº¿ç¨‹æƒ…å†µä¸‹ï¼Œä»è·³è¡¨è·å–èŠ‚ç‚¹çš„ç®—æ³•ã€‚ç¬¬1æ­¥ï¼šæ‰¾åˆ°â€œè¢«åˆ é™¤èŠ‚ç‚¹çš„ä½ç½®â€ã€‚æ ¹æ®findPredecessor()å®šä½keyæ‰€åœ¨çš„å±‚æ¬¡ä»¥åŠæ‰¾åˆ°keyçš„å‰ç»§èŠ‚ç‚¹(b)ï¼Œç„¶åæ‰¾åˆ°bçš„åç»§èŠ‚ç‚¹nã€‚ç¬¬2æ­¥ï¼šæ ¹æ®â€œkeyçš„å‰ç»§èŠ‚ç‚¹(b)â€å’Œâ€œkeyçš„å‰ç»§èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹(n)â€æ¥å®šä½â€œkeyå¯¹åº”çš„èŠ‚ç‚¹â€ã€‚å…·ä½“æ˜¯é€šè¿‡æ¯”è¾ƒâ€œnçš„é”®å€¼â€å’Œâ€œkeyâ€çš„å¤§å°ã€‚å¦‚æœç›¸ç­‰ï¼Œåˆ™nå°±æ˜¯æ‰€è¦æŸ¥æ‰¾çš„é”®ã€‚ConcurrentSkipListMapç¤ºä¾‹1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768import java.util.*;import java.util.concurrent.*;/* *   ConcurrentSkipListMapæ˜¯â€œçº¿ç¨‹å®‰å…¨â€çš„å“ˆå¸Œè¡¨ï¼Œè€ŒTreeMapæ˜¯éçº¿ç¨‹å®‰å…¨çš„ã€‚ * *   ä¸‹é¢æ˜¯â€œå¤šä¸ªçº¿ç¨‹åŒæ—¶æ“ä½œå¹¶ä¸”éå†mapâ€çš„ç¤ºä¾‹ *   (01) å½“mapæ˜¯ConcurrentSkipListMapå¯¹è±¡æ—¶ï¼Œç¨‹åºèƒ½æ­£å¸¸è¿è¡Œã€‚ *   (02) å½“mapæ˜¯TreeMapå¯¹è±¡æ—¶ï¼Œç¨‹åºä¼šäº§ç”ŸConcurrentModificationExceptionå¼‚å¸¸ã€‚ * * @author skywang */public class ConcurrentSkipListMapDemo1 {    // TODO: mapæ˜¯TreeMapå¯¹è±¡æ—¶ï¼Œç¨‹åºä¼šå‡ºé”™ã€‚    //private static Map&lt;String, String&gt; map = new TreeMap&lt;String, String&gt;();    private static Map&lt;String, String&gt; map = new ConcurrentSkipListMap&lt;String, String&gt;();    public static void main(String[] args) {            // åŒæ—¶å¯åŠ¨ä¸¤ä¸ªçº¿ç¨‹å¯¹mapè¿›è¡Œæ“ä½œï¼        new MyThread(&quot;a&quot;).start();        new MyThread(&quot;b&quot;).start();    }    private static void printAll() {        String key, value;        Iterator iter = map.entrySet().iterator();        while(iter.hasNext()) {            Map.Entry entry = (Map.Entry)iter.next();            key = (String)entry.getKey();            value = (String)entry.getValue();            System.out.print(&quot;(&quot;+key+&quot;, &quot;+value+&quot;), &quot;);        }        System.out.println();    }    private static class MyThread extends Thread {        MyThread(String name) {            super(name);        }        @Override        public void run() {                int i = 0;            while (i++ &lt; 6) {                // â€œçº¿ç¨‹åâ€ + &quot;åºå·&quot;                String val = Thread.currentThread().getName()+i;                map.put(val, &quot;0&quot;);                // é€šè¿‡â€œIteratorâ€éå†mapã€‚                printAll();            }        }    }}(a1, 0), (a1, 0), (b1, 0), (b1, 0),(a1, 0), (b1, 0), (b2, 0), (a1, 0), (a1, 0), (a2, 0), (a2, 0), (b1, 0), (b1, 0), (b2, 0), (b2, 0), (b3, 0), (b3, 0), (a1, 0), (a2, 0), (a3, 0), (a1, 0), (b1, 0), (a2, 0), (b2, 0), (a3, 0), (b3, 0), (b1, 0), (b4, 0), (b2, 0), (a1, 0), (b3, 0), (a2, 0), (b4, 0), (a3, 0), (a1, 0), (a4, 0), (a2, 0), (b1, 0), (a3, 0), (b2, 0), (a4, 0), (b3, 0), (b1, 0), (b4, 0), (b2, 0), (b5, 0), (b3, 0), (a1, 0), (b4, 0), (a2, 0), (b5, 0), (a3, 0), (a1, 0), (a4, 0), (a2, 0), (a5, 0), (a3, 0), (b1, 0), (a4, 0), (b2, 0), (a5, 0), (b3, 0), (b1, 0), (b4, 0), (b2, 0), (b5, 0), (b3, 0), (b6, 0), (b4, 0), (a1, 0), (b5, 0), (a2, 0), (b6, 0), (a3, 0), (a4, 0), (a5, 0), (a6, 0), (b1, 0), (b2, 0), (b3, 0), (b4, 0), (b5, 0), (b6, 0), ç»“æœè¯´æ˜ï¼šç¤ºä¾‹ç¨‹åºä¸­ï¼Œå¯åŠ¨ä¸¤ä¸ªçº¿ç¨‹(çº¿ç¨‹aå’Œçº¿ç¨‹b)åˆ†åˆ«å¯¹ConcurrentSkipListMapè¿›è¡Œæ“ä½œã€‚ä»¥çº¿ç¨‹aè€Œè¨€ï¼Œå®ƒä¼šå…ˆè·å–â€œçº¿ç¨‹åâ€+â€œåºå·â€ï¼Œç„¶åå°†è¯¥å­—ç¬¦ä¸²ä½œä¸ºkeyï¼Œå°†â€œ0â€ä½œä¸ºvalueï¼Œæ’å…¥åˆ°ConcurrentSkipListMapä¸­ï¼›æ¥ç€ï¼Œéå†å¹¶è¾“å‡ºConcurrentSkipListMapä¸­çš„å…¨éƒ¨å…ƒç´ ã€‚ çº¿ç¨‹bçš„æ“ä½œå’Œçº¿ç¨‹aä¸€æ ·ï¼Œåªä¸è¿‡çº¿ç¨‹bçš„åå­—å’Œçº¿ç¨‹açš„åå­—ä¸åŒã€‚å½“mapæ˜¯ConcurrentSkipListMapå¯¹è±¡æ—¶ï¼Œç¨‹åºèƒ½æ­£å¸¸è¿è¡Œã€‚å¦‚æœå°†mapæ”¹ä¸ºTreeMapæ—¶ï¼Œç¨‹åºä¼šäº§ç”ŸConcurrentModificationExceptionå¼‚å¸¸ã€‚</content>
	</entry>
	<entry>
		<title>å¤šçº¿ç¨‹_ç”Ÿäº§è€…æ¶ˆè´¹è€…</title>
		<url>/article/75fde354.html</url>
		<content>ç”Ÿäº§è€…æ¶ˆè´¹è€…121. Javaç”Ÿäº§è€…æ¶ˆè´¹è€…çš„ä¸‰ç§å®ç°https://blog.csdn.net/xindoo/article/details/80004003 1234567Javaç”Ÿäº§è€…æ¶ˆè´¹è€…æ˜¯æœ€åŸºç¡€çš„çº¿ç¨‹åŒæ­¥é—®é¢˜ï¼Œjavaå²—é¢è¯•ä¸­è¿˜æ˜¯å¾ˆå®¹æ˜“é‡åˆ°çš„ï¼Œä¹‹å‰æ²¡å†™è¿‡å¤šçº¿ç¨‹çš„ä»£ç ï¼Œé¢è¯•ä¸­è¢«é—®åˆ°å¾ˆå°¬å•Šï¼Œé¢å®Œå›æ¥æ¶è¡¥ä¸‹ã€‚åœ¨ç½‘ä¸ŠæŸ¥åˆ°å¤§æ¦‚æœ‰5ç§ç”Ÿäº§è€…æ¶ˆè´¹è€…çš„å†™æ³•ï¼Œåˆ†åˆ«å¦‚ä¸‹ã€‚ç”¨synchronizedå¯¹å­˜å‚¨åŠ é”ï¼Œç„¶åç”¨objectåŸç”Ÿçš„wait() å’Œ notify()åšåŒæ­¥ã€‚ç”¨concurrent.locks.Lockï¼Œç„¶åç”¨conditionçš„await() å’Œsignal()åšåŒæ­¥ã€‚ç›´æ¥ä½¿ç”¨concurrent.BlockingQueueã€‚ä½¿ç”¨PipedInputStream/PipedOutputStreamã€‚ä½¿ç”¨ä¿¡å·é‡semaphoreã€‚synchronizedç‰ˆæœ¬123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172import java.util.LinkedList;import java.util.Queue;public class ProducerAndConsumer {    private final int MAX_LEN = 10;    private Queue&lt;Integer&gt; queue = new LinkedList&lt;Integer&gt;();    class Producer extends Thread {        @Override        public void run() {            producer();        }        private void producer() {            while(true) {                synchronized (queue) {                    while (queue.size() == MAX_LEN) {                        queue.notify();                        System.out.println(&quot;å½“å‰é˜Ÿåˆ—æ»¡&quot;);                        try {                            queue.wait();                        } catch (InterruptedException e) {                            e.printStackTrace();                        }                    }                    queue.add(1);                    queue.notify();                    System.out.println(&quot;ç”Ÿäº§è€…ç”Ÿäº§ä¸€æ¡ä»»åŠ¡ï¼Œå½“å‰é˜Ÿåˆ—é•¿åº¦ä¸º&quot; + queue.size());                    try {                        Thread.sleep(500);                    } catch (InterruptedException e) {                        e.printStackTrace();                    }                }            }        }    }    class Consumer extends Thread {        @Override        public void run() {            consumer();        }        private void consumer() {            while (true) {                synchronized (queue) {                    while (queue.size() == 0) {                        queue.notify();                        System.out.println(&quot;å½“å‰é˜Ÿåˆ—ä¸ºç©º&quot;);                        try {                            queue.wait();                        } catch (InterruptedException e) {                            e.printStackTrace();                        }                    }                    queue.poll();                    queue.notify();                    System.out.println(&quot;æ¶ˆè´¹è€…æ¶ˆè´¹ä¸€æ¡ä»»åŠ¡ï¼Œå½“å‰é˜Ÿåˆ—é•¿åº¦ä¸º&quot; + queue.size());                    try {                        Thread.sleep(500);                    } catch (InterruptedException e) {                        e.printStackTrace();                    }                }            }        }    }    public static void main(String[] args) {        ProducerAndConsumer pc = new ProducerAndConsumer();        Producer producer = pc.new Producer();        Consumer consumer = pc.new Consumer();        producer.start();        consumer.start();    }}lock+conditionçš„åŒæ­¥123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384import java.util.LinkedList;import java.util.Queue;import java.util.concurrent.locks.Condition;import java.util.concurrent.locks.Lock;import java.util.concurrent.locks.ReentrantLock;/** * version 1 doesn't use synchronized to improve performance */public class ProducerAndConsumer1 {    private final int MAX_LEN = 10;    private Queue&lt;Integer&gt; queue = new LinkedList&lt;Integer&gt;();    private final Lock lock = new ReentrantLock();    private final Condition condition = lock.newCondition();    class Producer extends Thread {        @Override        public void run() {            producer();        }        private void producer() {            while(true) {                lock.lock();                try {                    while (queue.size() == MAX_LEN) {                        System.out.println(&quot;å½“å‰é˜Ÿåˆ—æ»¡&quot;);                        try {                            condition.await();                        } catch (InterruptedException e) {                            e.printStackTrace();                        }                    }                    queue.add(1);                    condition.signal();                    System.out.println(&quot;ç”Ÿäº§è€…ç”Ÿäº§ä¸€æ¡ä»»åŠ¡ï¼Œå½“å‰é˜Ÿåˆ—é•¿åº¦ä¸º&quot; + queue.size());                    try {                        Thread.sleep(500);                    } catch (InterruptedException e) {                        e.printStackTrace();                    }                } finally {                    lock.unlock();                }            }        }    }    class Consumer extends Thread {        @Override        public void run() {            consumer();        }        private void consumer() {            while (true) {                lock.lock();                try {                    while (queue.size() == 0) {                        System.out.println(&quot;å½“å‰é˜Ÿåˆ—ä¸ºç©º&quot;);                        try {                            condition.await();                        } catch (InterruptedException e) {                            e.printStackTrace();                        }                    }                    queue.poll();                    condition.signal();                    System.out.println(&quot;æ¶ˆè´¹è€…æ¶ˆè´¹ä¸€æ¡ä»»åŠ¡ï¼Œå½“å‰é˜Ÿåˆ—é•¿åº¦ä¸º&quot; + queue.size());                    try {                        Thread.sleep(500);                    } catch (InterruptedException e) {                        e.printStackTrace();                    }                } finally {                    lock.unlock();                }            }        }    }    public static void main(String[] args) {        ProducerAndConsumer pc = new ProducerAndConsumer();        Producer producer = pc.new Producer();        Consumer consumer = pc.new Consumer();        producer.start();        consumer.start();    }}BlockingQueueç‰ˆå®ç°123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657import java.util.Random;import java.util.concurrent.BlockingQueue;import java.util.concurrent.LinkedBlockingQueue;public class ProducerAndConsumer {    private BlockingQueue&lt;Integer&gt; queue = new LinkedBlockingQueue&lt;Integer&gt;(10);    class Producer extends Thread {        @Override        public void run() {            producer();        }        private void producer() {            while(true) {                try {                    queue.put(1);                } catch (InterruptedException e) {                    e.printStackTrace();                }                System.out.println(&quot;ç”Ÿäº§è€…ç”Ÿäº§ä¸€æ¡ä»»åŠ¡ï¼Œå½“å‰é˜Ÿåˆ—é•¿åº¦ä¸º&quot; + queue.size());                try {                    Thread.sleep(new Random().nextInt(1000)+500);                } catch (InterruptedException e) {                    e.printStackTrace();                }            }        }    }    class Consumer extends Thread {        @Override        public void run() {            consumer();        }        private void consumer() {            while (true) {                try {                    queue.take();                } catch (InterruptedException e) {                    e.printStackTrace();                }                System.out.println(&quot;æ¶ˆè´¹è€…æ¶ˆè´¹ä¸€æ¡ä»»åŠ¡ï¼Œå½“å‰é˜Ÿåˆ—é•¿åº¦ä¸º&quot; + queue.size());                try {                    Thread.sleep(new Random().nextInt(1000)+500);                } catch (InterruptedException e) {                    e.printStackTrace();                }            }        }    }    public static void main(String[] args) {        ProducerAndConsumer pc = new ProducerAndConsumer();        Producer producer = pc.new Producer();        Consumer consumer = pc.new Consumer();        producer.start();        consumer.start();    }}Disruptoræ–¹å¼123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107// æ‘˜è‡ªã€ŠJavaé«˜å¹¶å‘ç¨‹åºè®¾è®¡ã€‹// https://blog.csdn.net/sunhaoning/article/details/64131362// BlockigQueueç”¨äºå®ç°ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚å®ƒå¯ä»¥å¾ˆè‡ªç„¶åœ°å®ç°ä½œä¸ºç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„å†…å­˜ç¼“å†²åŒºã€‚ä½†æ˜¯BlockigQueueå¹¶ä¸æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„å®ç°ï¼Œå®ƒå®Œå…¨ä½¿ç”¨é”å’Œé˜»å¡ç­‰å¾…æ¥å®ç°çº¿ç¨‹é—´çš„åŒæ­¥ã€‚åœ¨é«˜å¹¶å‘åœºåˆï¼Œå®ƒçš„æ€§èƒ½å¹¶ä¸æ˜¯ç‰¹åˆ«çš„ä¼˜è¶Šã€‚å°±åƒä¹‹å‰æˆ‘å·²ç»æè¿‡çš„ï¼šConcurrentLinkedQueueæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„é˜Ÿåˆ—ï¼Œä½†æ˜¯BlockingQueueåªæ˜¯ä¸ºäº†æ–¹ä¾¿æ•°æ®å…±äº«ã€‚// è€ŒConcurrentLinkedQueueçš„ç§˜è¯€å°±åœ¨äºå¤§é‡ä½¿ç”¨äº†æ— é”çš„CASæ“ä½œã€‚åŒç†ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨CASæ¥å®ç°ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡å¼ï¼Œä¹ŸåŒæ ·å¯ä»¥è·å¾—å¯è§‚çš„æ€§èƒ½æå‡ã€‚ä¸è¿‡æ­£å¦‚å¤§å®¶æ‰€è§ï¼Œä½¿ç”¨CASè¿›è¡Œç¼–ç¨‹æ˜¯éå¸¸å›°éš¾çš„ï¼Œä½†æœ‰ä¸€ä¸ªå¥½æ¶ˆæ¯æ˜¯ï¼Œç›®å‰æœ‰ä¸€ä¸ªç°æˆçš„Disruptoræ¡†æ¶ï¼Œå®ƒå·²ç»å¸®åŠ©æˆ‘ä»¬å®ç°äº†è¿™ä¸€ä¸ªåŠŸèƒ½ã€‚// Disruptoræ¡†æ¶æ˜¯ç”±LMAXå…¬å¸å¼€å‘çš„ä¸€æ¬¾é«˜æ•ˆçš„æ— é”å†…å­˜é˜Ÿåˆ—ã€‚å®ƒä½¿ç”¨æ— é”çš„æ–¹å¼å®ç°äº†ä¸€ä¸ªç¯å½¢é˜Ÿåˆ—ï¼Œéå¸¸é€‚åˆäºå®ç°ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…æ¨¡å¼ï¼Œæ¯”å¦‚äº‹ä»¶å’Œæ¶ˆæ¯çš„å‘å¸ƒã€‚åœ¨Disruptorä¸­ï¼Œåˆ«å‡ºå¿ƒè£åœ°ä½¿ç”¨äº†ç¯å½¢é˜Ÿåˆ—ï¼ˆRingBufferï¼‰æ¥ä»£æ›¿æ™®é€šçº¿æ€§é˜Ÿåˆ—ï¼Œè¿™ä¸ªç¯å½¢é˜Ÿåˆ—å†…éƒ¨å®ç°ä¸ºä¸€ä¸ªæ™®é€šçš„æ•°ç»„ã€‚å¯¹äºä¸€èˆ¬çš„é˜Ÿåˆ—ï¼ŒåŠ¿å¿…è¦æä¾›é˜Ÿåˆ—åŒæ­¥headå’Œå°¾éƒ¨tailä¸¤ä¸ªæŒ‡é’ˆï¼Œç”¨äºå‡ºé˜Ÿå’Œå…¥é˜Ÿï¼Œè¿™æ ·æ— ç–‘å°±å¢åŠ äº†çº¿ç¨‹åä½œçš„å¤æ‚åº¦ã€‚ä½†å¦‚æœé˜Ÿåˆ—æ˜¯ç¯å½¢çš„ï¼Œåˆ™åªéœ€è¦å¯¹å¤–æä¾›ä¸€ä¸ªå½“å‰ä½ç½®cursorï¼Œåˆ©ç”¨è¿™ä¸ªæŒ‡é’ˆæ—¢å¯ä»¥è¿›å…¥å…¥é˜Ÿä¹Ÿå¯ä»¥è¿›è¡Œå‡ºé˜Ÿæ“ä½œã€‚ç”±äºç¯å½¢é˜Ÿåˆ—çš„ç¼˜æ•…ï¼Œé˜Ÿåˆ—çš„æ€»å¤§å°å¿…é¡»äº‹å…ˆæŒ‡å®šï¼Œä¸èƒ½åŠ¨æ€æ‰©å±•ã€‚ä¸ºäº†èƒ½å¤Ÿå¿«é€Ÿä»ä¸€ä¸ªåºåˆ—ï¼ˆsequenceï¼‰å¯¹åº”åˆ°æ•°ç»„çš„å®é™…ä½ç½®ï¼ˆæ¯æ¬¡æœ‰å…ƒç´ å…¥é˜Ÿï¼Œåºåˆ—å°±åŠ 1ï¼‰ï¼ŒDisruptorè¦æ±‚æˆ‘ä»¬å¿…é¡»å°†æ•°ç»„çš„å¤§å°è®¾ç½®ä¸º2çš„æ•´æ•°æ¬¡æ–¹ã€‚è¿™æ ·é€šè¿‡sequence &amp;(queueSize-1)å°±èƒ½ç«‹å³å®šä½åˆ°å®é™…çš„å…ƒç´ ä½ç½®indexã€‚è¿™ä¸ªè¦æ¯”å–ä½™ï¼ˆ%ï¼‰æ“ä½œå¿«å¾—å¤šã€‚// é¦–å…ˆï¼Œæˆ‘ä»¬è¿˜æ˜¯éœ€è¦ä¸€ä¸ªä»£è¡¨æ•°æ®çš„PCDataï¼špublic class PCData{    private long value;    public void set(long value)    {        this.value = value;    }    public long get(){        return value;    }}// æ¶ˆè´¹è€…å®ç°ä¸ºWorkHandleræ¥å£ï¼Œå®ƒæ¥è‡ªDisruptoræ¡†æ¶public class Consumer implements WorkHandlerï¼œPCDataï¼ {    @Override    public void onEvent(PCData event) throws Exception {        System.out.println(Thread.currentThread().getId() + &quot;:Event: --&quot;                + event.get() * event.get() + &quot;--&quot;);    }}// è¿˜éœ€è¦ä¸€ä¸ªäº§ç”ŸPCDataçš„å·¥å‚ç±»ã€‚å®ƒä¼šåœ¨Disruptorç³»ç»Ÿåˆå§‹åŒ–æ—¶ï¼Œæ„é€ æ‰€æœ‰çš„ç¼“å†²åŒºä¸­çš„å¯¹è±¡å®ä¾‹public class PCDataFactory implements EventFactoryï¼œPCDataï¼{    public PCData newInstance()    {        return new PCData();    }}// ç”Ÿäº§è€…public class Producer{     private final RingBufferï¼œPCDataï¼ ringBuffer;     public Producer(RingBufferï¼œPCDataï¼ ringBuffer)     {         this.ringBuffer = ringBuffer;     }     public void pushData(ByteBuffer bb)     {         long sequence = ringBuffer.next();  // Grab the next sequence         try         {             PCData event = ringBuffer.get(sequence); // Get the entry in the Disruptor                                                         // for the sequence             event.set(bb.getLong(0));  // Fill with data         }         finally         {             ringBuffer.publish(sequence);         }     }}// ä¸»å‡½æ•°public static void main(String[] args) throws Exception {     Executor executor = Executors.newCachedThreadPool();     PCDataFactory factory = new PCDataFactory();     // Specify the size of the ring buffer, must be power of 2.     int bufferSize = ;     Disruptorï¼œPCDataï¼ disruptor = new Disruptorï¼œPCDataï¼(factory,             bufferSize,             executor,             ProducerType.MULTI,             new BlockingWaitStrategy()             );     disruptor.handleEventsWithWorkerPool(             new Consumer(),             new Consumer(),             new Consumer(),             new Consumer());     disruptor.start();     RingBufferï¼œPCDataï¼ ringBuffer = disruptor.getRingBuffer();     Producer producer = new Producer(ringBuffer);     ByteBuffer bb = ByteBuffer.allocate(8);     for (long l = 0; true; l++)     {         bb.putLong(0, l);         producer.pushData(bb);         Thread.sleep(0);         System.out.println(&quot;add data &quot;+l);     } } 8:Event: --0--add data 011:Event: --1--add data 110:Event: --4--add data 29:Event: --9--add data 3    æ ¹æ®Disruptorçš„å®˜æ–¹æŠ¥å‘Šï¼ŒDisruptorçš„æ€§èƒ½è¦æ¯”BlockingQueueè‡³å°‘é«˜ä¸€ä¸ªæ•°é‡çº§ä»¥ä¸Šã€‚æé«˜æ¶ˆè´¹è€…çš„å“åº”æ—¶é—´ï¼šé€‰æ‹©åˆé€‚çš„ç­–ç•¥å½“æœ‰æ–°æ•°æ®åœ¨Disruptorçš„ç¯å½¢ç¼“å†²åŒºä¸­äº§ç”Ÿæ—¶ï¼Œæ¶ˆè´¹è€…å¦‚ä½•çŸ¥é“è¿™äº›æ–°äº§ç”Ÿçš„æ•°æ®å‘¢ï¼Ÿæˆ–è€…è¯´ï¼Œæ¶ˆè´¹è€…å¦‚ä½•ç›‘æ§ç¼“å†²åŒºä¸­çš„ä¿¡æ¯å‘¢ï¼Ÿä¸ºæ­¤ï¼ŒDisruptoræä¾›äº†å‡ ç§ç­–ç•¥ï¼Œè¿™äº›ç­–ç•¥ç”±WaitStrategyæ¥å£è¿›è¡Œå°è£…ï¼Œä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§å®ç°ã€‚BlockingWaitStrategyï¼šè¿™æ˜¯é»˜è®¤çš„ç­–ç•¥ã€‚ä½¿ç”¨BlockingWaitStrategyå’Œä½¿ç”¨BlockingQueueæ˜¯éå¸¸ç±»ä¼¼çš„ï¼Œå®ƒä»¬éƒ½ä½¿ç”¨é”å’Œæ¡ä»¶ï¼ˆConditionï¼‰è¿›è¡Œæ•°æ®çš„ç›‘æ§å’Œçº¿ç¨‹çš„å”¤é†’ã€‚å› ä¸ºæ¶‰åŠåˆ°çº¿ç¨‹çš„åˆ‡æ¢ï¼ŒBlockingWaitStrategyç­–ç•¥æ˜¯æœ€èŠ‚çœCPUï¼Œä½†æ˜¯åœ¨é«˜å¹¶å‘ä¸‹æ€§èƒ½è¡¨ç°æœ€ç³Ÿç³•çš„ä¸€ç§ç­‰å¾…ç­–ç•¥ã€‚SleepingWaitStrategyï¼šè¿™ä¸ªç­–ç•¥ä¹Ÿæ˜¯å¯¹CPUä½¿ç”¨ç‡éå¸¸ä¿å®ˆçš„ã€‚å®ƒä¼šåœ¨å¾ªç¯ä¸­ä¸æ–­ç­‰å¾…æ•°æ®ã€‚å®ƒä¼šå…ˆè¿›è¡Œè‡ªæ—‹ç­‰å¾…ï¼Œå¦‚æœä¸æˆåŠŸï¼Œåˆ™ä½¿ç”¨Thread.yield()è®©å‡ºCPUï¼Œå¹¶æœ€ç»ˆä½¿ç”¨LockSupport.parkNanos(1)è¿›è¡Œçº¿ç¨‹ä¼‘çœ ï¼Œä»¥ç¡®ä¿ä¸å ç”¨å¤ªå¤šçš„CPUæ•°æ®ã€‚å› æ­¤ï¼Œè¿™ä¸ªç­–ç•¥å¯¹äºæ•°æ®å¤„ç†å¯èƒ½äº§ç”Ÿæ¯”è¾ƒé«˜çš„å¹³å‡å»¶æ—¶ã€‚å®ƒæ¯”è¾ƒé€‚åˆäºå¯¹å»¶æ—¶è¦æ±‚ä¸æ˜¯ç‰¹åˆ«é«˜çš„åœºåˆï¼Œå¥½å¤„æ˜¯å®ƒå¯¹ç”Ÿäº§è€…çº¿ç¨‹çš„å½±å“æœ€å°ã€‚å…¸å‹çš„åº”ç”¨åœºæ™¯æ˜¯å¼‚æ­¥æ—¥å¿—ã€‚YieldingWaitStrategyï¼šè¿™ä¸ªç­–ç•¥ç”¨äºä½å»¶æ—¶çš„åœºåˆã€‚æ¶ˆè´¹è€…çº¿ç¨‹ä¼šä¸æ–­å¾ªç¯ç›‘æ§ç¼“å†²åŒºå˜åŒ–ï¼Œåœ¨å¾ªç¯å†…éƒ¨ï¼Œå®ƒä¼šä½¿ç”¨Thread.yield()è®©å‡ºCPUç»™åˆ«çš„çº¿ç¨‹æ‰§è¡Œæ—¶é—´ã€‚å¦‚æœä½ éœ€è¦ä¸€ä¸ªé«˜æ€§èƒ½çš„ç³»ç»Ÿï¼Œå¹¶ä¸”å¯¹å»¶æ—¶æœ‰è¾ƒä¸ºä¸¥æ ¼çš„è¦æ±‚ï¼Œåˆ™å¯ä»¥è€ƒè™‘è¿™ç§ç­–ç•¥ã€‚ä½¿ç”¨è¿™ç§ç­–ç•¥æ—¶ï¼Œç›¸å½“äºä½ çš„æ¶ˆè´¹è€…çº¿ç¨‹å˜èº«æˆä¸ºäº†ä¸€ä¸ªå†…éƒ¨æ‰§è¡Œäº†Thread.yield()çš„æ­»å¾ªç¯ã€‚å› æ­¤ï¼Œä½ æœ€å¥½æœ‰å¤šäºæ¶ˆè´¹è€…çº¿ç¨‹æ•°é‡çš„é€»è¾‘CPUæ•°é‡ï¼ˆè¿™é‡Œçš„é€»è¾‘CPUï¼Œæˆ‘æŒ‡çš„æ˜¯â€œåŒæ ¸å››çº¿ç¨‹â€ä¸­çš„é‚£ä¸ªå››çº¿ç¨‹ï¼Œå¦åˆ™ï¼Œæ•´ä¸ªåº”ç”¨ç¨‹åºææ€•éƒ½ä¼šå—åˆ°å½±å“ã€‚BusySpinWaitStrategyï¼šè¿™ä¸ªæ˜¯æœ€ç–¯ç‹‚çš„ç­‰å¾…ç­–ç•¥äº†ã€‚å®ƒå°±æ˜¯ä¸€ä¸ªæ­»å¾ªç¯ï¼æ¶ˆè´¹è€…çº¿ç¨‹ä¼šå°½æœ€å¤§åŠªåŠ›ç–¯ç‹‚ç›‘æ§ç¼“å†²åŒºçš„å˜åŒ–ã€‚å› æ­¤ï¼Œå®ƒä¼šåƒæ‰æ‰€æœ‰çš„CPUèµ„æºã€‚ä½ åªæœ‰åœ¨å¯¹å»¶è¿Ÿéå¸¸è‹›åˆ»çš„åœºåˆå¯ä»¥è€ƒè™‘ä½¿ç”¨å®ƒï¼ˆæˆ–è€…è¯´ï¼Œä½ çš„ç³»ç»ŸçœŸçš„éå¸¸ç¹å¿™ï¼‰ã€‚å› ä¸ºåœ¨è¿™é‡Œä½ ç­‰åŒå¼€å¯äº†ä¸€ä¸ªæ­»å¾ªç¯ç›‘æ§ï¼Œæ‰€ä»¥ï¼Œä½ çš„ç‰©ç†CPUæ•°é‡å¿…é¡»è¦å¤§äºæ¶ˆè´¹è€…çº¿ç¨‹æ•°ã€‚æ³¨æ„ï¼Œæˆ‘è¿™é‡Œè¯´çš„æ˜¯ç‰©ç†CPUï¼Œå¦‚æœä½ åœ¨ä¸€ä¸ªç‰©ç†æ ¸ä¸Šä½¿ç”¨è¶…çº¿ç¨‹æŠ€æœ¯æ¨¡æ‹Ÿä¸¤ä¸ªé€»è¾‘æ ¸ï¼Œå¦å¤–ä¸€ä¸ªé€»è¾‘æ ¸æ˜¾ç„¶ä¼šå—åˆ°è¿™ç§è¶…å¯†é›†è®¡ç®—çš„å½±å“è€Œä¸èƒ½æ­£å¸¸å·¥ä½œã€‚CPU Cacheçš„ä¼˜åŒ–ï¼šè§£å†³ä¼ªå…±äº«é—®é¢˜â€‹        ä»€ä¹ˆæ˜¯ä¼ªå…±äº«é—®é¢˜å‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“ï¼Œä¸ºäº†æé«˜CPUçš„é€Ÿåº¦ï¼ŒCPUæœ‰ä¸€ä¸ªé«˜é€Ÿç¼“å­˜Cacheã€‚åœ¨é«˜é€Ÿç¼“å­˜ä¸­ï¼Œè¯»å†™æ•°æ®çš„æœ€å°å•ä½ä¸ºç¼“å­˜è¡Œï¼ˆCache Lineï¼‰ï¼Œå®ƒæ˜¯ä»ä¸»å­˜ï¼ˆmemoryï¼‰å¤åˆ¶åˆ°ç¼“å­˜ï¼ˆCacheï¼‰çš„æœ€å°å•ä½ï¼Œä¸€èˆ¬ä¸º32å­—èŠ‚åˆ°128å­—èŠ‚ã€‚â€‹        å¦‚æœä¸¤ä¸ªå˜é‡å­˜æ”¾åœ¨ä¸€ä¸ªç¼“å­˜è¡Œä¸­æ—¶ï¼Œåœ¨å¤šçº¿ç¨‹è®¿é—®ä¸­ï¼Œå¯èƒ½ä¼šç›¸äº’å½±å“å½¼æ­¤çš„æ€§èƒ½ã€‚å¦‚å›¾5.4æ‰€ç¤ºï¼Œå‡è®¾Xå’ŒYåœ¨åŒä¸€ä¸ªç¼“å­˜è¡Œã€‚è¿è¡Œåœ¨CPU1ä¸Šçš„çº¿ç¨‹æ›´æ–°äº†Xï¼Œé‚£ä¹ˆCPU2ä¸Šçš„ç¼“å­˜è¡Œå°±ä¼šå¤±æ•ˆï¼ŒåŒä¸€è¡Œçš„Yå³ä½¿æ²¡æœ‰ä¿®æ”¹ä¹Ÿä¼šå˜æˆæ— æ•ˆï¼Œå¯¼è‡´Cacheæ— æ³•å‘½ä¸­ã€‚æ¥ç€ï¼Œå¦‚æœåœ¨CPU2ä¸Šçš„çº¿ç¨‹æ›´æ–°äº†Yï¼Œåˆ™å¯¼è‡´CPU1ä¸Šçš„ç¼“å­˜è¡Œåˆå¤±æ•ˆï¼ˆæ­¤æ—¶ï¼ŒåŒä¸€è¡Œçš„Xåˆå˜å¾—æ— æ³•è®¿é—®ï¼‰ã€‚è¿™ç§æƒ…å†µååå¤å¤å‘ç”Ÿï¼Œæ— ç–‘æ˜¯ä¸€ä¸ªæ½œåœ¨çš„æ€§èƒ½æ€æ‰‹ã€‚å¦‚æœCPUç»å¸¸ä¸èƒ½å‘½ä¸­ç¼“å­˜ï¼Œé‚£ä¹ˆç³»ç»Ÿçš„ååé‡å°±ä¼šæ€¥å‰§ä¸‹é™ã€‚å¹¶è¡Œæµæ°´çº¿121. å€Ÿé‰´ã€ŠJavaé«˜å¹¶å‘ç¨‹åºè®¾è®¡ã€‹ç¬¬5.6èŠ‚2. 123456789101112131415è®¡ç®—(B+C)*B/2ï¼Œé‚£ä¹ˆè¿™ä¸ªè¿è¡Œè¿‡ç¨‹å°±æ˜¯æ— æ³•å¹¶è¡Œçš„ã€‚åŸå› æ˜¯ï¼Œå¦‚æœB+Cæ²¡æœ‰æ‰§è¡Œå®Œæˆï¼Œåˆ™æ°¸è¿œç®—ä¸å‡º(B+C)*Bï¼Œè¿™å°±æ˜¯æ•°æ®ç›¸å…³æ€§ã€‚å¦‚æœçº¿ç¨‹æ‰§è¡Œæ—¶ï¼Œæ‰€éœ€çš„æ•°æ®å­˜åœ¨è¿™ç§ä¾èµ–å…³ç³»ï¼Œé‚£ä¹ˆï¼Œå°±æ²¡æœ‰åŠæ³•å°†å®ƒä»¬å®Œç¾çš„å¹¶è¡ŒåŒ–ã€‚é‚£é‡åˆ°è¿™ç§æƒ…å†µæ—¶ï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆè¡¥æ•‘æªæ–½å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œé‚£å°±æ˜¯å€Ÿé‰´æ—¥å¸¸ç”Ÿäº§ä¸­çš„æµæ°´çº¿æ€æƒ³ã€‚æ¯”å¦‚ï¼Œç°åœ¨è¦ç”Ÿäº§ä¸€æ‰¹å°ç©å¶ã€‚å°ç©å¶çš„åˆ¶ä½œåˆ†ä¸ºå››ä¸ªæ­¥éª¤ï¼Œç¬¬ä¸€è¦ç»„è£…èº«ä½“ï¼Œç¬¬äºŒè¦åœ¨èº«ä½“ä¸Šå®‰è£…å››è‚¢å’Œå¤´éƒ¨ï¼Œç¬¬ä¸‰ï¼Œç»™ç»„è£…å®Œæˆçš„ç©å¶ç©¿ä¸Šä¸€ä»¶æ¼‚äº®çš„è¡£æœï¼Œç¬¬å››ï¼Œå°±å¯ä»¥åŒ…è£…å‡ºè´§äº†ã€‚ä¸ºäº†åŠ å¿«åˆ¶ä½œç©å…·çš„è¿›åº¦ï¼Œæˆ‘ä»¬ä¸å¯èƒ½å«å››ä¸ªäººåŒæ—¶åŠ å·¥ä¸€ä¸ªç©å…·ï¼Œå› ä¸ºè¿™å››ä¸ªæ­¥éª¤æœ‰ç€ä¸¥é‡çš„ä¾èµ–å…³ç³»ã€‚å¦‚æœæ²¡æœ‰èº«ä½“ï¼Œå°±æ²¡æœ‰åœ°æ–¹å®‰è£…å››è‚¢ï¼Œå¦‚æœæ²¡æœ‰ç»„è£…å®Œæˆï¼Œå°±ä¸èƒ½ç©¿è¡£æœï¼Œå¦‚æœæ²¡æœ‰ç©¿ä¸Šè¡£æœï¼Œå°±ä¸èƒ½åŒ…è£…å‘è´§ã€‚å› æ­¤ï¼Œæ‰¾å››ä¸ªäººæ¥åšä¸€ä¸ªç©å¶æ˜¯æ¯«æ— æ„ä¹‰çš„ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ ç°åœ¨è¦åˆ¶ä½œçš„ä¸æ˜¯1åªç©å¶ï¼Œè€Œæ˜¯1ä¸‡åªç©å¶ï¼Œé‚£æƒ…å†µå°±ä¸åŒäº†ã€‚ä½ å¯ä»¥æ‰¾å››ä¸ªäººï¼Œç¬¬ä¸€ä¸ªäººåªè´Ÿè´£ç»„è£…èº«ä½“ï¼Œå®Œæˆåäº¤ç»™ç¬¬äºŒä¸ªäººï¼›ç¬¬äºŒä¸ªäººåªè´Ÿè´£å®‰è£…å¤´éƒ¨å’Œå››è‚¢ï¼Œäº¤ä»˜ç¬¬ä¸‰äººï¼›ç¬¬ä¸‰äººåªè´Ÿè´£ç©¿è¡£æœï¼Œå¹¶äº¤ä»˜ç¬¬å››äººï¼›ç¬¬å››äººåªè´Ÿè´£åŒ…è£…å‘è´§ã€‚è¿™æ ·æ‰€æœ‰äººéƒ½å¯ä»¥ä¸€èµ·å·¥ä½œï¼Œå…±åŒå®Œæˆä»»åŠ¡ï¼Œè€Œæ•´ä¸ªæ—¶é—´å‘¨æœŸä¹Ÿèƒ½ç¼©çŸ­åˆ°åŸæ¥çš„1/4å·¦å³ï¼Œè¿™å°±æ˜¯æµæ°´çº¿çš„æ€æƒ³ã€‚ä¸€æ—¦æµæ°´çº¿æ»¡è½½ï¼Œæ¯æ¬¡åªéœ€è¦ä¸€æ­¥ï¼ˆå‡è®¾ä¸€ä¸ªç©å¶éœ€è¦å››æ­¥ï¼‰å°±å¯ä»¥äº§ç”Ÿä¸€ä¸ªç©å¶ç±»ä¼¼çš„æ€æƒ³å¯ä»¥å€Ÿé‰´åˆ°ç¨‹åºå¼€å‘ä¸­ã€‚å³ä½¿(B+C)*B/2æ— æ³•å¹¶è¡Œï¼Œä½†æ˜¯å¦‚æœä½ éœ€è¦è®¡ç®—ä¸€å¤§å †Bå’ŒCçš„å€¼ï¼Œä½ ä¾ç„¶å¯ä»¥å°†å®ƒæµæ°´åŒ–ã€‚é¦–å…ˆå°†è®¡ç®—è¿‡ç¨‹æ‹†åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼šP1:Aï¼B+CP2:Dï¼AÃ—BP3:D=D/2ä¸Šè¿°æ­¥éª¤ä¸­P1ã€P2å’ŒP3å‡åœ¨å•ç‹¬çš„çº¿ç¨‹ä¸­è®¡ç®—ï¼Œå¹¶ä¸”æ¯ä¸ªçº¿ç¨‹åªè´Ÿè´£è‡ªå·±çš„å·¥ä½œã€‚æ­¤æ—¶ï¼ŒP3çš„è®¡ç®—ç»“æœå°±æ˜¯æœ€ç»ˆéœ€è¦çš„ç­”æ¡ˆã€‚P1æ¥æ”¶Bå’ŒCçš„å€¼ï¼Œå¹¶æ±‚å’Œï¼Œå°†ç»“æœè¾“å…¥ç»™P2ã€‚P2æ±‚ä¹˜ç§¯åè¾“å…¥ç»™P3ã€‚P3å°†Dé™¤ä»¥2å¾—åˆ°æœ€ç»ˆå€¼ã€‚ä¸€æ—¦è¿™æ¡æµæ°´çº¿å»ºç«‹ï¼Œåªéœ€è¦ä¸€ä¸ªè®¡ç®—æ­¥éª¤å°±å¯ä»¥å¾—åˆ°(B+C)*B/2çš„ç»“æœã€‚123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778// ä¸ºäº†å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ä¸ªåœ¨çº¿ç¨‹é—´æºå¸¦ç»“æœè¿›è¡Œä¿¡æ¯äº¤æ¢çš„è½½ä½“ï¼špublic class Msg {    public double i;    public double j;    public String orgStr=null;}// P1è®¡ç®—çš„æ˜¯åŠ æ³•ï¼š public class Plus implements Runnable {     public static BlockingQueueï¼œMsgï¼ bq=new LinkedBlockingQueueï¼œMsgï¼();     @Override     public void run() {         while(true){             try {                 Msg msg=bq.take();                 msg.j=msg.i+msg.j;                 Multiply.bq.add(msg);             } catch (InterruptedException e) {             }         }     } }// ä¸Šè¿°ä»£ç ä¸­ï¼ŒP1å–å¾—å°è£…äº†ä¸¤ä¸ªæ“ä½œæ•°çš„Msgï¼Œå¹¶è¿›è¡Œæ±‚å’Œï¼Œå°†ç»“æœä¼ é€’ç»™ä¹˜æ³•çº¿ç¨‹P2ï¼ˆç¬¬9è¡Œï¼‰ã€‚å½“æ²¡æœ‰æ•°æ®éœ€è¦å¤„ç†æ—¶ï¼ŒP1è¿›è¡Œç­‰å¾…ã€‚// P2è®¡ç®—ä¹˜æ³•ï¼š public class Multiply implements Runnable {     public static BlockingQueueï¼œMsgï¼ bq = new LinkedBlockingQueueï¼œMsgï¼();     @Override     public void run() {         while (true) {             try {                 Msg msg = bq.take();                 msg.i = msg.i * msg.j;                 Div.bq.add(msg);             } catch (InterruptedException e) {             }         }     } }//å’ŒP1éå¸¸ç±»ä¼¼ï¼ŒP2è®¡ç®—ç›¸ä¹˜ç»“æœåï¼Œå°†ä¸­é—´ç»“æœä¼ é€’ç»™é™¤æ³•çº¿ç¨‹P3ã€‚//P3è®¡ç®—é™¤æ³•ï¼š public class Div implements Runnable {     public static BlockingQueueï¼œMsgï¼ bq = new LinkedBlockingQueueï¼œMsgï¼();     @Override     public void run() {         while (true) {             try {                 Msg msg = bq.take();                 msg.i = msg.i / 2;                 System.out.println(msg.orgStr + &quot;=&quot; + msg.i);             } catch (InterruptedException e) {             }         }     } }// P3å°†ç»“æœé™¤ä»¥2åè¾“å‡ºæœ€ç»ˆçš„ç»“æœã€‚// æœ€åæ˜¯æäº¤ä»»åŠ¡çš„ä¸»çº¿ç¨‹ï¼Œè¿™é‡Œï¼Œæˆ‘ä»¬æäº¤0ä¸‡ä¸ªè¯·æ±‚ï¼Œè®©çº¿ç¨‹ç»„è¿›è¡Œè®¡ç®—ï¼š public class PStreamMain {     public static void main(String[] args) {         new Thread(new Plus()).start();         new Thread(new Multiply()).start();         new Thread(new Div()).start();         for (int i = 1; i ï¼œ= ; i++) {             for (int j = 1; j ï¼œ= ; j++) {                 Msg msg = new Msg();                 msg.i = i;                 msg.j = j;                 msg.orgStr = &quot;((&quot; + i + &quot;+&quot; + j + &quot;)*&quot; + i + &quot;)/2&quot;;                 Plus.bq.add(msg);             }         }     } }ä¸Šè¿°ä»£ç ç¬¬è¡Œï¼Œå°†æ•°æ®æäº¤ç»™P1åŠ æ³•çº¿ç¨‹ï¼Œå¼€å¯æµæ°´çº¿çš„è®¡ç®—ã€‚åœ¨å¤šæ ¸æˆ–è€…åˆ†å¸ƒå¼åœºæ™¯ä¸­ï¼Œè¿™ç§è®¾è®¡æ€è·¯å¯ä»¥æœ‰æ•ˆåœ°å°†æœ‰ä¾èµ–å…³ç³»çš„æ“ä½œåˆ†é…åœ¨ä¸åŒçš„çº¿ç¨‹ä¸­è¿›è¡Œè®¡ç®—ï¼Œå°½å¯èƒ½åˆ©ç”¨å¤šæ ¸ä¼˜åŠ¿ã€‚</content>
	</entry>
	<entry>
		<title>pythonå¤šè¿›ç¨‹</title>
		<url>/article/30993.html</url>
		<content>pythonå¤šè¿›ç¨‹åŸºæœ¬æ¦‚å¿µPythonä¸­çš„å¤šè¿›ç¨‹æ˜¯é€šè¿‡multiprocessingåŒ…æ¥å®ç°çš„ï¼Œå’Œå¤šçº¿ç¨‹çš„threading.Threadå·®ä¸å¤šï¼Œå®ƒå¯ä»¥åˆ©ç”¨multiprocessing.Processå¯¹è±¡æ¥åˆ›å»ºä¸€ä¸ªè¿›ç¨‹å¯¹è±¡è¿™ä¸ªè¿›ç¨‹å¯¹è±¡çš„æ–¹æ³•å’Œçº¿ç¨‹å¯¹è±¡çš„æ–¹æ³•å·®ä¸å¤šä¹Ÿæœ‰start()ï¼Œrun()ï¼Œjoin()ç­‰æ–¹æ³•ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªæ–¹æ³•ä¸åŒThreadçº¿ç¨‹å¯¹è±¡ä¸­çš„å®ˆæŠ¤çº¿ç¨‹æ–¹æ³•æ˜¯setDeamonï¼Œè€ŒProcessè¿›ç¨‹å¯¹è±¡çš„å®ˆæŠ¤è¿›ç¨‹æ˜¯é€šè¿‡è®¾ç½®daemonå±æ€§æ¥å®Œæˆçš„ä¸å¤šçº¿ç¨‹çš„å…±äº«å¼å†…å­˜ä¸åŒï¼Œç”±äºå„ä¸ªè¿›ç¨‹éƒ½æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œå› æ­¤è¿›ç¨‹é—´é€šä¿¡å†å¤šè¿›ç¨‹ä¸­æ‰®æ¼”è¿™éå¸¸é‡è¦çš„è§’è‰²ï¼ŒPythonä¸­æˆ‘ä»¬å¯ä»¥ä½¿ç”¨multiprocessingæ¨¡å—ä¸­çš„pipeã€queueã€Arrayã€Valueç­‰ç­‰å·¥å…·æ¥å®ç°è¿›ç¨‹é—´é€šè®¯å’Œæ•°æ®å…±äº«ï¼Œä½†æ˜¯åœ¨ç¼–å†™èµ·æ¥ä»ç„¶å…·æœ‰å¾ˆå¤§çš„ä¸çµæ´»æ€§ä»»åŠ¡ç±»å‹åŒæ­¥ä¸å¼‚æ­¥åŒæ­¥å°±æ˜¯æŒ‡ä¸€ä¸ªè¿›ç¨‹åœ¨æ‰§è¡ŒæŸä¸ªè¯·æ±‚çš„æ—¶å€™ï¼Œè‹¥è¯¥è¯·æ±‚éœ€è¦ä¸€æ®µæ—¶é—´æ‰èƒ½è¿”å›ä¿¡æ¯é‚£ä¹ˆè¿™ä¸ªè¿›ç¨‹å°†ä¼šä¸€ç›´ç­‰å¾…ä¸‹å»ï¼Œç›´åˆ°æ”¶åˆ°è¿”å›ä¿¡æ¯æ‰ç»§ç»­æ‰§è¡Œä¸‹å»å¼‚æ­¥æ˜¯æŒ‡è¿›ç¨‹ä¸éœ€è¦ä¸€ç›´ç­‰ä¸‹å»ï¼Œè€Œæ˜¯ç»§ç»­æ‰§è¡Œä¸‹é¢çš„æ“ä½œï¼Œä¸ç®¡å…¶ä»–è¿›ç¨‹çš„çŠ¶æ€å½“æœ‰æ¶ˆæ¯è¿”å›æ—¶ç³»ç»Ÿä¼šé€šçŸ¥è¿›ç¨‹è¿›è¡Œå¤„ç†ï¼Œè¿™æ ·å¯ä»¥æé«˜æ‰§è¡Œçš„æ•ˆç‡IOå¯†é›†å’Œè®¡ç®—å¯†é›†å¯¹äºIOå¯†é›†å‹ä»»åŠ¡: pythonçš„å¤šçº¿ç¨‹èƒ½å¤ŸèŠ‚çœæ—¶é—´å¯¹äºè®¡ç®—(CPU)å¯†é›†å‹ä»»åŠ¡: Pythonçš„å¤šçº¿ç¨‹å¹¶æ²¡æœ‰ç”¨å¤„ï¼Œå»ºè®®ä½¿ç”¨å¤šè¿›ç¨‹å…¶ä»–ç»„åˆæ­é…pythonä½¿ç”¨å¤šæ ¸ï¼Œå³å¼€å¤šä¸ªè¿›ç¨‹æ–¹æ³•ä¸€: åç¨‹+å¤šè¿›ç¨‹ï¼Œä½¿ç”¨æ–¹æ³•ç®€å•ï¼Œæ•ˆç‡è¿˜å¯ä»¥ï¼Œä¸€èˆ¬ä½¿ç”¨è¯¥æ–¹æ³•åç¨‹yieldæ˜¯ä½ è‡ªå·±å†™çš„ï¼Œæ˜¯è‡ªå·±å®šä¹‰ä»€ä¹ˆæ—¶å€™åˆ‡æ¢è¿›ç¨‹æ–¹æ³•äºŒï¼šIOå¤šè·¯å¤ç”¨ï¼Œä½¿ç”¨å¤æ‚ï¼Œä½†æ•ˆç‡å¾ˆé«˜ï¼Œä¸å¸¸ç”¨å¤šè¿›ç¨‹ç›¸å…³æ¨¡å—1234567891011121314# åˆ›å»ºç®¡ç†è¿›ç¨‹æ¨¡å—ï¼šProcess(ç”¨äºåˆ›å»ºè¿›ç¨‹):é€šè¿‡åˆ›å»ºä¸€ä¸ªProcesså¯¹è±¡ç„¶åè°ƒç”¨å®ƒçš„start()æ–¹æ³•æ¥ç”Ÿæˆè¿›ç¨‹ã€‚Processéµå¾ªthreading.Threadçš„APIã€‚Pool(ç”¨äºåˆ›å»ºè¿›ç¨‹ç®¡ç†æ± )ï¼šå¯ä»¥åˆ›å»ºä¸€ä¸ªè¿›ç¨‹æ± ï¼Œè¯¥è¿›ç¨‹å°†æ‰§è¡Œä¸Poolè¯¥ç±»ä¸€èµ·æäº¤ç»™å®ƒçš„ä»»åŠ¡ï¼Œå½“å­è¿›ç¨‹è¾ƒå¤šéœ€è¦ç®¡ç†æ—¶ä½¿ç”¨ã€‚Queueï¼ˆç”¨äºè¿›ç¨‹é€šä¿¡ï¼Œèµ„æºå…±äº«ï¼‰ï¼šè¿›ç¨‹é—´é€šä¿¡ï¼Œä¿è¯è¿›ç¨‹å®‰å…¨ã€‚Valueï¼ŒArrayï¼ˆç”¨äºè¿›ç¨‹é€šä¿¡ï¼Œèµ„æºå…±äº«ï¼‰ï¼šPipeï¼ˆç”¨äºç®¡é“é€šä¿¡ï¼‰ï¼šç®¡é“æ“ä½œã€‚Managerï¼ˆç”¨äºèµ„æºå…±äº«ï¼‰ï¼šåˆ›å»ºè¿›ç¨‹é—´å…±äº«çš„æ•°æ®ï¼ŒåŒ…æ‹¬åœ¨ä¸åŒæœºå™¨ä¸Šè¿è¡Œçš„è¿›ç¨‹ä¹‹é—´çš„ç½‘ç»œå…±äº«ã€‚# åŒæ­¥å­è¿›ç¨‹æ¨¡å—ï¼šConditionEventï¼šç”¨æ¥å®ç°è¿›ç¨‹é—´åŒæ­¥é€šä¿¡ã€‚Lockï¼šå½“å¤šä¸ªè¿›ç¨‹éœ€è¦è®¿é—®å…±äº«èµ„æºçš„æ—¶å€™ï¼ŒLockå¯ä»¥ç”¨æ¥é¿å…è®¿é—®çš„å†²çªã€‚RLockSemaphoreï¼šç”¨æ¥æ§åˆ¶å¯¹å…±äº«èµ„æºçš„è®¿é—®æ•°é‡ï¼Œä¾‹å¦‚æ± çš„æœ€å¤§è¿æ¥æ•°ã€‚pythonå¤šçº¿ç¨‹ä½æ•ˆåŸå› GILçš„å…¨ç§°æ˜¯ Global Interpreter Lock(å…¨å±€è§£é‡Šå™¨é”)ï¼Œæ¥æºæ˜¯ Python è®¾è®¡ä¹‹åˆçš„è€ƒè™‘ï¼Œä¸ºäº†æ•°æ®å®‰å…¨æ‰€åšçš„å†³å®šæŸä¸ªçº¿ç¨‹æƒ³è¦æ‰§è¡Œï¼Œå¿…é¡»å…ˆæ‹¿åˆ° GILï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ GIL çœ‹ä½œæ˜¯â€œé€šè¡Œè¯â€ï¼Œå¹¶ä¸”åœ¨ä¸€ä¸ª Python è¿›ç¨‹ä¸­ï¼ŒGIL åªæœ‰ä¸€ä¸ªæ‹¿ä¸åˆ°é€šè¡Œè¯çš„çº¿ç¨‹ï¼Œå°±ä¸å…è®¸è¿›å…¥ CPU æ‰§è¡Œç›®å‰ Python çš„è§£é‡Šå™¨æœ‰å¤šç§ï¼Œä¾‹å¦‚ï¼šCPythonï¼šCPython æ˜¯ç”¨Cè¯­è¨€å®ç°çš„ Python è§£é‡Šå™¨ï¼Œä½œä¸ºå®˜æ–¹å®ç°ï¼Œå®ƒæ˜¯æœ€å¹¿æ³›ä½¿ç”¨çš„ Python è§£é‡Šå™¨PyPyï¼šPyPy æ˜¯ç”¨RPythonå®ç°çš„è§£é‡Šå™¨ã€‚RPython æ˜¯ Python çš„å­é›†ï¼Œ å…·æœ‰é™æ€ç±»å‹ã€‚è¿™ä¸ªè§£é‡Šå™¨çš„ç‰¹ç‚¹æ˜¯å³æ—¶ç¼–è¯‘ï¼Œæ”¯æŒå¤šé‡åç«¯(C, CLI, JVM)ã€‚PyPy æ—¨åœ¨æé«˜æ€§èƒ½ï¼ŒåŒæ—¶ä¿æŒæœ€å¤§å…¼å®¹æ€§(å‚è€ƒ CPython çš„å®ç°)Jythonï¼šJython æ˜¯ä¸€ä¸ªå°† Python ä»£ç ç¼–è¯‘æˆ Java å­—èŠ‚ç çš„å®ç°ï¼Œè¿è¡Œåœ¨JVM(Java Virtual Machine)ä¸Šã€‚å¦å¤–ï¼Œå®ƒå¯ä»¥åƒæ˜¯ç”¨ Python æ¨¡å—ä¸€æ ·ï¼Œå¯¼å…¥ å¹¶ä½¿ç”¨ä»»ä½•Javaç±»IronPythonï¼šIronPython æ˜¯ä¸€ä¸ªé’ˆå¯¹ .NET æ¡†æ¶çš„ Python å®ç°ã€‚å®ƒ å¯ä»¥ç”¨ Python å’Œ .NET framewor kçš„åº“ï¼Œä¹Ÿèƒ½å°† Python ä»£ç æš´éœ²ç»™ .NET æ¡†æ¶ä¸­çš„å…¶ä»–è¯­è¨€GIL åªåœ¨ CPython ä¸­æ‰æœ‰ï¼Œè€Œåœ¨ PyPy å’Œ Jython ä¸­æ˜¯æ²¡æœ‰ GIL çš„æ³¨æ„: æ¯æ¬¡é‡Šæ”¾GILé”ï¼Œçº¿ç¨‹è¿›è¡Œé”ç«äº‰ã€åˆ‡æ¢çº¿ç¨‹ï¼Œä¼šæ¶ˆè€—èµ„æºè¿™å°±å¯¼è‡´æ‰“å°çº¿ç¨‹æ‰§è¡Œæ—¶é•¿ï¼Œä¼šå‘ç°è€—æ—¶æ›´é•¿çš„åŸå› å¹¶ä¸”ç”±äº GIL é”å­˜åœ¨ï¼ŒPython é‡Œä¸€ä¸ªè¿›ç¨‹æ°¸è¿œåªèƒ½åŒæ—¶æ‰§è¡Œä¸€ä¸ªçº¿ç¨‹(æ‹¿åˆ° GIL çš„çº¿ç¨‹æ‰èƒ½æ‰§è¡Œ)ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨å¤šæ ¸CPUä¸Šï¼ŒPython çš„å¤šçº¿ç¨‹æ•ˆç‡å¹¶ä¸é«˜çš„æ ¹æœ¬åŸå› å¤šè¿›ç¨‹å®ç°æ–¹å¼Processæ™®é€šProcess12345678910111213141516from multiprocessing import  Processdef func(name):    print('æµ‹è¯•%så¤šè¿›ç¨‹' %name)if __name__ == '__main__':    process_list = []    for i in range(5):  #å¼€å¯5ä¸ªå­è¿›ç¨‹æ‰§è¡Œfun1å‡½æ•°        p = Process(target=func, args=('Python',)) #å®ä¾‹åŒ–è¿›ç¨‹å¯¹è±¡        p.start()        process_list.append(p)    for i in process_list:        p.join()    print('ç»“æŸæµ‹è¯•')12345678æµ‹è¯•Pythonå¤šè¿›ç¨‹æµ‹è¯•Pythonå¤šè¿›ç¨‹æµ‹è¯•Pythonå¤šè¿›ç¨‹æµ‹è¯•Pythonå¤šè¿›ç¨‹æµ‹è¯•Pythonå¤šè¿›ç¨‹ç»“æŸæµ‹è¯•Process finished with exit code 0ä¸Šé¢çš„ä»£ç å¼€å¯äº†5ä¸ªå­è¿›ç¨‹å»æ‰§è¡Œå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥è§‚å¯Ÿç»“æœï¼Œæ˜¯åŒæ—¶æ‰“å°çš„ï¼Œè¿™é‡Œå®ç°äº†çœŸæ­£çš„å¹¶è¡Œæ“ä½œï¼Œå°±æ˜¯å¤šä¸ªCPUåŒæ—¶æ‰§è¡Œä»»åŠ¡ã€‚æˆ‘ä»¬çŸ¥é“è¿›ç¨‹æ˜¯pythonä¸­æœ€å°çš„èµ„æºåˆ†é…å•å…ƒï¼Œä¹Ÿå°±æ˜¯è¿›ç¨‹ä¸­é—´çš„æ•°æ®ï¼Œå†…å­˜æ˜¯ä¸å…±äº«çš„ï¼Œæ¯å¯åŠ¨ä¸€ä¸ªè¿›ç¨‹ï¼Œéƒ½è¦ç‹¬ç«‹åˆ†é…èµ„æºå’Œæ‹·è´è®¿é—®çš„æ•°æ®ï¼Œæ‰€ä»¥è¿›ç¨‹çš„å¯åŠ¨å’Œé”€æ¯çš„ä»£ä»·æ˜¯æ¯”è¾ƒå¤§äº†ï¼Œæ‰€ä»¥åœ¨å®é™…ä¸­ä½¿ç”¨å¤šè¿›ç¨‹ï¼Œè¦æ ¹æ®æœåŠ¡å™¨çš„é…ç½®æ¥è®¾å®šã€‚ç»§æ‰¿Process12345678910111213141516171819202122from multiprocessing import  Processclass MyProcess(Process): #ç»§æ‰¿Processç±»    def __init__(self,name):        super(MyProcess,self).__init__()        self.name = name    def run(self):        print('æµ‹è¯•%så¤šè¿›ç¨‹' % self.name)if __name__ == '__main__':    process_list = []    for i in range(5):  #å¼€å¯5ä¸ªå­è¿›ç¨‹æ‰§è¡Œfun1å‡½æ•°        p = MyProcess('Python') #å®ä¾‹åŒ–è¿›ç¨‹å¯¹è±¡        p.start()        process_list.append(p)    for i in process_list:        p.join()    print('ç»“æŸæµ‹è¯•')12345678æµ‹è¯•Pythonå¤šè¿›ç¨‹æµ‹è¯•Pythonå¤šè¿›ç¨‹æµ‹è¯•Pythonå¤šè¿›ç¨‹æµ‹è¯•Pythonå¤šè¿›ç¨‹æµ‹è¯•Pythonå¤šè¿›ç¨‹ç»“æŸæµ‹è¯•Process finished with exit code 0é€šè¿‡ç±»ç»§æ‰¿çš„æ–¹æ³•æ¥å®ç°çš„ï¼Œpythonå¤šè¿›ç¨‹çš„ç¬¬äºŒç§å®ç°æ–¹å¼ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œæ•ˆæœå’Œç¬¬ä¸€ç§æ–¹å¼ä¸€æ ·Processç±»çš„å…¶ä»–æ–¹æ³•12345678910111213141516171819æ„é€ æ–¹æ³•ï¼šProcess([group [, target [, name [, args [, kwargs]]]]])ã€€ã€€group: çº¿ç¨‹ç»„ ã€€ã€€target: è¦æ‰§è¡Œçš„æ–¹æ³•ã€€ã€€name: è¿›ç¨‹åã€€ã€€args/kwargs: è¦ä¼ å…¥æ–¹æ³•çš„å‚æ•°å®ä¾‹æ–¹æ³•ï¼šã€€ã€€is_alive()ï¼šè¿”å›è¿›ç¨‹æ˜¯å¦åœ¨è¿è¡Œ,boolç±»å‹ã€‚ã€€ã€€join([timeout])ï¼šé˜»å¡å½“å‰ä¸Šä¸‹æ–‡ç¯å¢ƒçš„è¿›ç¨‹ç¨‹ï¼Œç›´åˆ°è°ƒç”¨æ­¤æ–¹æ³•çš„è¿›ç¨‹ç»ˆæ­¢æˆ–åˆ°è¾¾æŒ‡å®šçš„timeoutï¼ˆå¯é€‰å‚æ•°ï¼‰ã€‚ã€€ã€€start()ï¼šè¿›ç¨‹å‡†å¤‡å°±ç»ªï¼Œç­‰å¾…CPUè°ƒåº¦ã€€ã€€run()ï¼šstrat()è°ƒç”¨runæ–¹æ³•ï¼Œå¦‚æœå®ä¾‹è¿›ç¨‹æ—¶æœªåˆ¶å®šä¼ å…¥targetï¼Œè¿™staræ‰§è¡Œté»˜è®¤run()æ–¹æ³•ã€‚ã€€ã€€terminate()ï¼šä¸ç®¡ä»»åŠ¡æ˜¯å¦å®Œæˆï¼Œç«‹å³åœæ­¢å·¥ä½œè¿›ç¨‹å±æ€§ï¼šã€€ã€€daemonï¼šå’Œçº¿ç¨‹çš„setDeamonåŠŸèƒ½ä¸€æ ·ã€€ã€€nameï¼šè¿›ç¨‹åå­—ã€€ã€€pidï¼šè¿›ç¨‹å·è¿›ç¨‹æ± 123456789101112131415161718192021222324252627# apply_asyncï¼šå¼‚æ­¥from  multiprocessing import Pool,cpu_countimport os, time, randomdef fun1(name):    print('Run task %s (%s)...' % (name, os.getpid()))    start = time.time()    time.sleep(random.random() * 3)    end = time.time()    print('Task %s runs %0.2f seconds.' % (name, (end - start)))    return f'{name}: {os.getpid()}'if __name__=='__main__':    results = []    pool = Pool(cpu_count()-1)    for i in range(4):        results.append(pool.apply_async(func=fun1, args=(i,)))    pool.close()    pool.join()    print()    for result in results:        print(result.get())    print('All Done!!!')    print('ç»“æŸæµ‹è¯•')1234567891011121314151617Run task 0 (30716)...Run task 1 (15020)...Run task 2 (23200)...Run task 3 (5884)...Task 0 runs 1.34 seconds.Task 2 runs 1.53 seconds.Task 1 runs 1.88 seconds.Task 3 runs 2.48 seconds.0: 307161: 150202: 232003: 5884All Done!!!ç»“æŸæµ‹è¯•Process finished with exit code 0å¯¹Poolå¯¹è±¡è°ƒç”¨join()æ–¹æ³•ä¼šç­‰å¾…æ‰€æœ‰å­è¿›ç¨‹æ‰§è¡Œå®Œæ¯•ï¼Œè°ƒç”¨join()ä¹‹å‰å¿…é¡»å…ˆè°ƒç”¨close()ï¼Œè°ƒç”¨close()ä¹‹åå°±ä¸èƒ½ç»§ç»­æ·»åŠ æ–°çš„Processäº†123456789101112131415161718192021222324252627282930# map_asyncï¼šå¼‚æ­¥from multiprocessing import Pool, cpu_count, Managerfrom functools import partialdef job(data, mgrDicTask, lock):    res = f'a+b = {data[0] + data[1]}'    lock.acquire()    # Managerå¯¹è±¡æ— æ³•ç›‘æµ‹åˆ°å®ƒå¼•ç”¨çš„å¯å˜å¯¹è±¡å€¼çš„ä¿®æ”¹ï¼Œéœ€è¦é€šè¿‡è§¦å‘__setitem__æ–¹æ³•æ¥è®©å®ƒè·å¾—é€šçŸ¥    tempDic = list(mgrDicTask['result'])    tempDic.append(res)    mgrDicTask['result'] = tempDic    lock.release()    return resif __name__ == &quot;__main__&quot;:    data = [[2, 3], [3, 4], [2, 5]]    pool = Pool(processes=cpu_count() - 1)    mgr = Manager()    lock = mgr.Lock()    mgrDicTask = mgr.dict()    mgrDicTask['result'] = []    fun = partial(job, mgrDicTask=mgrDicTask, lock=lock)    pool.map_async(fun, data)    pool.close()    pool.join()    print(mgrDicTask['result'])    print('All Done!!!')1234['a+b = 7', 'a+b = 7', 'a+b = 5']All Done!!!Process finished with exit code 0å…¶ä»–è¿›ç¨‹æ± 1234567891011121314151617181920212223242526272829303132# è¿›ç¨‹æ± çš„å¦å¤–ä¸€ç§åˆ›å»ºæ–¹å¼ï¼Œè·Ÿçº¿ç¨‹æ± çš„åˆ›å»ºæ–¹å¼ä¸€æ ·ã€‚å…¶æ–¹æ³•ç­‰ä¹Ÿç›¸åŒã€‚def process_pool_test(url_list):    book_list = []    # åˆ›å»ºè¿›ç¨‹æ±     pool = ProcessPoolExecutor(max_workers=20)    start = time.time()    for url in url_list:        time.sleep(0.5)        result = pool.submit(get_book_info, url)        book_list.append(result)    pool.shutdown()    print('time: ', time.time() - start)    book_name_list = []    author_list = []    author_info_list = []    print('book_list: ', len(book_list))    for future in book_list:        book_name_list.extend(future.result()['name'])        author_list.extend(future.result()['author'])        author_info_list.extend(future.result()['info'])    ExcelUtils.write_data_to_excel('bookInfo', book_name_list, author_list, author_info_list)if __name__ == '__main__':    sys.setrecursionlimit(10000)    url_list = ['https://www.edge.org/library']    for i in range(1, 52):        url_list.append('https://www.edge.org/library?page=%s' % i)    thread_pool_test(url_list)å¤šè¿›ç¨‹é€šä¿¡å†…å®¹æå–ç¥å™¨ beautiful Soup çš„ç”¨æ³•è¿›ç¨‹æ˜¯ç³»ç»Ÿç‹¬ç«‹è°ƒåº¦æ ¸åˆ†é…ç³»ç»Ÿèµ„æº(CPUã€å†…å­˜)çš„åŸºæœ¬å•ä½ï¼Œè¿›ç¨‹ä¹‹é—´æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œæ¯å¯åŠ¨ä¸€ä¸ªæ–°çš„è¿›ç¨‹ç›¸å½“äºæŠŠæ•°æ®è¿›è¡Œäº†ä¸€æ¬¡å…‹éš†ï¼Œå­è¿›ç¨‹é‡Œçš„æ•°æ®ä¿®æ”¹æ— æ³•å½±å“åˆ°ä¸»è¿›ç¨‹ä¸­çš„æ•°æ®ï¼Œä¸åŒå­è¿›ç¨‹ä¹‹é—´çš„æ•°æ®ä¹Ÿä¸èƒ½å…±äº«ï¼Œè¿™æ˜¯å¤šè¿›ç¨‹åœ¨ä½¿ç”¨ä¸­ä¸å¤šçº¿ç¨‹æœ€æ˜æ˜¾çš„åŒºåˆ«ä½†æ˜¯éš¾é“Pythonå¤šè¿›ç¨‹ä¸­é—´éš¾é“å°±æ˜¯å­¤ç«‹çš„å—ï¼Ÿå½“ç„¶ä¸æ˜¯ï¼Œpythonä¹Ÿæä¾›äº†å¤šç§æ–¹æ³•å®ç°äº†å¤šè¿›ç¨‹ä¸­é—´çš„é€šä¿¡å’Œæ•°æ®å…±äº«(å¯ä»¥ä¿®æ”¹ä¸€ä»½æ•°æ®)è¿›ç¨‹é˜Ÿåˆ—Queue123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102#!/usr/bin/env Python# -- coding: utf-8 --&quot;&quot;&quot;@version: v1.0@author: narutohyc@file: multiprocessing_queue.py@Description: å¤šè¿›ç¨‹é˜Ÿåˆ—ä½¿ç”¨ç¤ºä¾‹@time: 2020/5/14 15:53&quot;&quot;&quot;from multiprocessing import Process, Queue, Managerfrom multiprocessing import cpu_countimport osimport timeclass Task:    def __init__(self, task_name: str, data: list, **kwargs):        self.task_name = task_name        self.data = data    def __repr__(self):        return f'task_name:{self.task_name} data:{self.data}'class MultiProcessingQueue:    def __init__(self):        # è¿›ç¨‹æ•°        self.num_of_worker = cpu_count()        # è¿›ç¨‹é˜Ÿåˆ—å¤§å°ï¼Œæ ¹æ®ä¸åŒçš„ä»»åŠ¡éœ€æ±‚        self.size_of_queue = 10    def start_work(self):        print(&quot;start_work å¼€å§‹&quot;)        # è¿›ç¨‹é˜Ÿåˆ—        process_list = []        # æ–°å»ºä¸€ä¸ªå¤§å°ä¸º10çš„é˜Ÿåˆ—        work_queue = Queue(self.size_of_queue)        # è¿›ç¨‹é—´å…±äº«åˆ—è¡¨, å…¶ä»–çš„è¿˜æœ‰å…±äº«å­—å…¸ç­‰ï¼Œéƒ½æ˜¯è¿›ç¨‹å®‰å…¨çš„        dealed_sample_lst = Manager().list()        # ä¸€ä¸ªç”Ÿäº§è€…        sent = Process(target=self.productor, args=(work_queue, dealed_sample_lst,))        sent.start()        process_list.append(sent)        # å¤šä¸ªæ¶ˆè´¹è€…        for _ in range(self.num_of_worker - 1):            process = Process(target=self.consumer, args=(work_queue, dealed_sample_lst,))            process.start()            process_list.append(process)        [process.join() for process in process_list]        print(&quot;start_work ç»“æŸ&quot;)        return dealed_sample_lst    def productor(self, work_queue: Queue, dealed_sample_lst):        print(&quot;ç”Ÿäº§è€…å¼€å§‹å·¥ä½œ&quot;)        for ii in range(100):            work_queue.put(Task(task_name=f'{str(os.getpid())}-{str(ii)}', data=[ii for _ in range(2)]))            if ii % 30 == 0:                time.sleep(1)                print(&quot;ç”Ÿäº§è€…ä¼‘æ¯ing&quot;)        '''        JoinableQueue æ¯”Queueå¤šäº†task_done() ä¸join()ä¸¤ä¸ªå‡½æ•°ï¼Œå¤šç”¨äºç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜ã€‚        task_done()æ˜¯ç”¨åœ¨get()åï¼Œå‘é€é€šçŸ¥è¯´æˆ‘getå®Œäº†        join()æ˜¯è¯´Queueé‡Œæ‰€æœ‰çš„taskéƒ½å·²å¤„ç†ã€‚        '''        # è¿™é‡Œéœ€è¦åŠ å…¥ç»“æŸæ ‡è¯†ï¼Œè¿˜æœ‰å°±æ˜¯JoinableQueueçš„æ–¹å¼        for _ in range(self.num_of_worker - 1):            work_queue.put(None)        print(&quot;ç”Ÿäº§è€…å·¥ä½œç»“æŸ&quot;)    def consumer(self, work_queue: Queue, dealed_sample_lst):        while True:            task: Task = work_queue.get()            if task is None:                break            # å¤„ç†æ•°æ®            task.data = [ii * 2 for ii in task.data]            dealed_sample_lst.append(task)            print(task)        print(f'è¿›ç¨‹{os.getpid()} å¤„ç†ç»“æŸ')def multiprocessing_queue_test():    multiprocessing_queue = MultiProcessingQueue()    dealed_sample_lst = multiprocessing_queue.start_work()    # for sample in dealed_sample_lst:    #     print(sample)    print(&quot;æµ‹è¯•ç»“æŸ&quot;)if __name__ == '__main__':    multiprocessing_queue_test()123456789101112131415161718192021222324252627282930313233start_work å¼€å§‹ç”Ÿäº§è€…å¼€å§‹å·¥ä½œtask_name:28868-0 data:[0, 0]ç”Ÿäº§è€…ä¼‘æ¯ingtask_name:28868-1 data:[2, 2]...task_name:28868-6 data:[12, 12]ç”Ÿäº§è€…ä¼‘æ¯ingtask_name:28868-31 data:[62, 62]...task_name:28868-58 data:[116, 116]ç”Ÿäº§è€…ä¼‘æ¯ingtask_name:28868-61 data:[122, 122]...task_name:28868-64 data:[128, 128]...ç”Ÿäº§è€…ä¼‘æ¯ingtask_name:28868-91 data:[182, 182]...task_name:28868-96 data:[192, 192]ç”Ÿäº§è€…å·¥ä½œç»“æŸè¿›ç¨‹29208 å¤„ç†ç»“æŸtask_name:28868-97 data:[194, 194]è¿›ç¨‹20632 å¤„ç†ç»“æŸè¿›ç¨‹28496 å¤„ç†ç»“æŸtask_name:28868-98 data:[196, 196]è¿›ç¨‹30200 å¤„ç†ç»“æŸè¿›ç¨‹26512 å¤„ç†ç»“æŸè¿›ç¨‹29776 å¤„ç†ç»“æŸtask_name:28868-99 data:[198, 198]è¿›ç¨‹30072 å¤„ç†ç»“æŸstart_work ç»“æŸæµ‹è¯•ç»“æŸä¸Šé¢çš„ä»£ç ç»“æœå¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä¸»è¿›ç¨‹ä¸­å¯ä»¥é€šè¿‡Queueè·å–å­è¿›ç¨‹ä¸­putçš„æ•°æ®ï¼Œå®ç°è¿›ç¨‹é—´çš„é€šä¿¡JoinableQueueé˜Ÿåˆ—JoinableQueue([maxsize])ï¼šè¿™å°±åƒæ˜¯ä¸€ä¸ªQueueå¯¹è±¡ï¼Œä½†é˜Ÿåˆ—å…è®¸é¡¹ç›®çš„ä½¿ç”¨è€…é€šçŸ¥ç”Ÿæˆè€…é¡¹ç›®å·²ç»è¢«æˆåŠŸå¤„ç†é€šçŸ¥è¿›ç¨‹æ˜¯ä½¿ç”¨å…±äº«çš„ä¿¡å·å’Œæ¡ä»¶å˜é‡æ¥å®ç°çš„å‚æ•°ä»‹ç»ï¼šmaxsize: æ˜¯é˜Ÿåˆ—ä¸­å…è®¸æœ€å¤§é¡¹æ•°ï¼Œçœç•¥åˆ™æ— å¤§å°é™åˆ¶æ–¹æ³•ä»‹ç»ï¼šq.task_done()ï¼šä½¿ç”¨è€…ä½¿ç”¨æ­¤æ–¹æ³•å‘å‡ºä¿¡å·ï¼Œè¡¨ç¤ºq.get()çš„è¿”å›é¡¹ç›®å·²ç»è¢«å¤„ç†å¦‚æœè°ƒç”¨æ­¤æ–¹æ³•çš„æ¬¡æ•°å¤§äºä»é˜Ÿåˆ—ä¸­åˆ é™¤é¡¹ç›®çš„æ•°é‡å°†å¼•å‘ValueErrorå¼‚å¸¸q.join():ç”Ÿäº§è€…è°ƒç”¨æ­¤æ–¹æ³•è¿›è¡Œé˜»å¡ï¼Œç›´åˆ°é˜Ÿåˆ—ä¸­æ‰€æœ‰çš„é¡¹ç›®å‡è¢«å¤„ç†é˜»å¡å°†æŒç»­åˆ°é˜Ÿåˆ—ä¸­çš„æ¯ä¸ªé¡¹ç›®å‡è°ƒç”¨q.task_done()æ–¹æ³•ä¸ºæ­¢ç¤ºä¾‹ä»£ç 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697#!/usr/bin/env Python# -- coding: utf-8 --&quot;&quot;&quot;@version: v1.0@author: narutohyc@file: multiprocessing_queue.py@Description: å¤šè¿›ç¨‹é˜Ÿåˆ—ä½¿ç”¨ç¤ºä¾‹@time: 2020/5/14 15:53&quot;&quot;&quot;from multiprocessing import Process, Queue, JoinableQueue, Managerfrom multiprocessing import cpu_countimport os, timeclass Task:    def __init__(self, task_name: str, data: list, **kwargs):        self.task_name = task_name        self.data = data    def __repr__(self):        return f'task_name:{self.task_name} data:{self.data}'class MultiProcessingJoinableQueue:    def __init__(self):        # è¿›ç¨‹æ•°        self.num_of_worker = cpu_count()        # è¿›ç¨‹é˜Ÿåˆ—å¤§å°ï¼Œæ ¹æ®ä¸åŒçš„ä»»åŠ¡éœ€æ±‚        self.size_of_queue = 10    def start_work(self):        print(&quot;start_work å¼€å§‹&quot;)        # è¿›ç¨‹é˜Ÿåˆ—        process_list = []        # æ–°å»ºä¸€ä¸ªå¤§å°ä¸º10çš„é˜Ÿåˆ—        work_queue = JoinableQueue(self.size_of_queue)        # è¿›ç¨‹é—´å…±äº«åˆ—è¡¨, å…¶ä»–çš„è¿˜æœ‰å…±äº«å­—å…¸ç­‰ï¼Œéƒ½æ˜¯è¿›ç¨‹å®‰å…¨çš„        dealed_sample_lst = Manager().list()        # ä¸€ä¸ªç”Ÿäº§è€…        sent = Process(target=self.productor, args=(work_queue, dealed_sample_lst,))        process_list.append(sent)        # å¤šä¸ªæ¶ˆè´¹è€…        for _ in range(self.num_of_worker - 1):            process = Process(target=self.consumer, args=(work_queue, dealed_sample_lst,))            process.daemon = True            process_list.append(process)        [process.start() for process in process_list]        # è¿™é‡Œéœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œè¿™é‡Œjoinåªéœ€è¦è°ƒç”¨ç”Ÿäº§è€…(åˆ«è°ƒæ¶ˆè´¹è€…çš„joinï¼Œå¦åˆ™æ— æ³•æ­£å¸¸é€€å‡º)        # æ¶ˆè´¹è€…ä¸éœ€è¦ï¼Œä¸ªäººæ„Ÿè§‰åº”è¯¥æ˜¯ç”Ÿäº§è€…é‚£è¾¹å·²ç»è°ƒç”¨äº†work_queue.join()çš„æ–¹æ³•        # æ¶ˆè´¹è€…ç»“æŸåï¼Œæ•´ä¸ªç¨‹åºé€€å‡º        [process.join() for process in process_list[:1]]        print(&quot;start_work ç»“æŸ&quot;)        return dealed_sample_lst    def productor(self, work_queue: Queue, dealed_sample_lst):        print(&quot;ç”Ÿäº§è€…å¼€å§‹å·¥ä½œ&quot;)        for ii in range(100):            work_queue.put(Task(task_name=f'{str(os.getpid())}-{str(ii)}', data=[ii for _ in range(2)]))            if ii % 30 == 0:                time.sleep(1)                print(&quot;ç”Ÿäº§è€…ä¼‘æ¯ing&quot;)        print(&quot;ç”Ÿäº§è€…å·¥ä½œç»“æŸ&quot;)        work_queue.join()    def consumer(self, work_queue: Queue, dealed_sample_lst):        while True:            task: Task = work_queue.get()            if task is None:                break            # å¤„ç†æ•°æ®            task.data = [ii * 2 for ii in task.data]            dealed_sample_lst.append(task)            print(task)            work_queue.task_done()        print(f'è¿›ç¨‹{os.getpid()} å¤„ç†ç»“æŸ')def multiprocessing_joinablequeue_test():    multiprocessing_joinablequeue = MultiProcessingJoinableQueue()    dealed_sample_lst = multiprocessing_joinablequeue.start_work()    # for sample in dealed_sample_lst:    #     print(sample)    print(&quot;æµ‹è¯•ç»“æŸ&quot;)if __name__ == '__main__':    multiprocessing_joinablequeue_test()ç»“æœè¾“å‡º12345678910111213141516171819202122start_work å¼€å§‹ç”Ÿäº§è€…å¼€å§‹å·¥ä½œtask_name:14608-0 data:[0, 0]ç”Ÿäº§è€…ä¼‘æ¯ingtask_name:14608-1 data:[2, 2]...task_name:14608-7 data:[14, 14]ç”Ÿäº§è€…ä¼‘æ¯ingtask_name:14608-31 data:[62, 62]...task_name:14608-60 data:[120, 120]ç”Ÿäº§è€…ä¼‘æ¯ingtask_name:14608-61 data:[122, 122...task_name:14608-90 data:[180, 180]ç”Ÿäº§è€…ä¼‘æ¯ingç”Ÿäº§è€…å·¥ä½œç»“æŸtask_name:14608-91 data:[182, 182]...task_name:14608-93 data:[186, 186]start_work ç»“æŸæµ‹è¯•ç»“æŸç®¡é“PipePipeçš„æœ¬è´¨æ˜¯è¿›ç¨‹ä¹‹é—´çš„ç”¨ç®¡é“æ•°æ®ä¼ é€’ï¼Œè€Œä¸æ˜¯æ•°æ®å…±äº«ï¼Œè¿™å’Œsocketæœ‰ç‚¹åƒpipe()è¿”å›ä¸¤ä¸ªè¿æ¥å¯¹è±¡åˆ†åˆ«è¡¨ç¤ºç®¡é“çš„ä¸¤ç«¯ï¼Œæ¯ç«¯éƒ½æœ‰send()å’Œrecv()å‡½æ•°å¦‚æœä¸¤ä¸ªè¿›ç¨‹è¯•å›¾åœ¨åŒä¸€æ—¶é—´çš„åŒä¸€ç«¯è¿›è¡Œè¯»å–å’Œå†™å…¥é‚£ä¹ˆï¼Œè¿™å¯èƒ½ä¼šæŸåç®¡é“ä¸­çš„æ•°æ®ç®¡é“æ˜¯æ•°æ®ä¸å®‰å…¨çš„ï¼Œå¤šä¸ªè¿›ç¨‹åŒæ—¶æ”¶å‘æ•°æ®å¯é“å¼•èµ·æ•°æ®å¼‚å¸¸ï¼Œè¿™æ—¶å€™å°±åº”è¯¥é…åˆé”ä½¿ç”¨12345678910111213141516171819from multiprocessing import Process, Pipedef fun1(conn):    print('å­è¿›ç¨‹å‘é€æ¶ˆæ¯ï¼š')    conn.send('ä½ å¥½ä¸»è¿›ç¨‹')    print('å­è¿›ç¨‹æ¥å—æ¶ˆæ¯ï¼š')    print(conn.recv())    conn.close()if __name__ == '__main__':    conn1, conn2 = Pipe() #å…³é”®ç‚¹ï¼Œpipeå®ä¾‹åŒ–ç”Ÿæˆä¸€ä¸ªåŒå‘ç®¡    p = Process(target=fun1, args=(conn2,)) #conn2ä¼ ç»™å­è¿›ç¨‹    p.start()    print('ä¸»è¿›ç¨‹æ¥å—æ¶ˆæ¯ï¼š')    print(conn1.recv())    print('ä¸»è¿›ç¨‹å‘é€æ¶ˆæ¯ï¼š')    conn1.send(&quot;ä½ å¥½å­è¿›ç¨‹&quot;)    p.join()    print('ç»“æŸæµ‹è¯•')123456789ä¸»è¿›ç¨‹æ¥å—æ¶ˆæ¯ï¼šå­è¿›ç¨‹å‘é€æ¶ˆæ¯ï¼šå­è¿›ç¨‹æ¥å—æ¶ˆæ¯ï¼šä½ å¥½ä¸»è¿›ç¨‹ä¸»è¿›ç¨‹å‘é€æ¶ˆæ¯ï¼šä½ å¥½å­è¿›ç¨‹ç»“æŸæµ‹è¯•Process finished with exit code 0ä¸Šé¢å¯ä»¥çœ‹åˆ°ä¸»è¿›ç¨‹å’Œå­è¿›ç¨‹å¯ä»¥ç›¸äº’å‘é€æ¶ˆæ¯ManagersQueueå’ŒPipeåªæ˜¯å®ç°äº†æ•°æ®äº¤äº’ï¼Œå¹¶æ²¡å®ç°æ•°æ®å…±äº«ï¼Œå³ä¸€ä¸ªè¿›ç¨‹å»æ›´æ”¹å¦ä¸€ä¸ªè¿›ç¨‹çš„æ•°æ®ï¼Œé‚£ä¹ˆå°±è¦ç”¨åˆ°Managers1234567891011121314151617181920212223from multiprocessing import Process, Managerdef fun1(dic,lis,index):    dic[index] = 'a'    dic['2'] = 'b'        lis.append(index)    #[0,1,2,3,4,0,1,2,3,4,5,6,7,8,9]    #print(l)if __name__ == '__main__':    with Manager() as manager:        dic = manager.dict()#æ³¨æ„å­—å…¸çš„å£°æ˜æ–¹å¼ï¼Œä¸èƒ½ç›´æ¥é€šè¿‡{}æ¥å®šä¹‰        l = manager.list(range(5))#[0,1,2,3,4]        process_list = []        for i in range(10):            p = Process(target=fun1, args=(dic,l,i))            p.start()            process_list.append(p)        for res in process_list:            res.join()        print(dic)        print(l)12{0: 'a', '2': 'b', 3: 'a', 1: 'a', 2: 'a', 4: 'a', 5: 'a', 7: 'a', 6: 'a', 8: 'a', 9: 'a'}[0, 1, 2, 3, 4, 0, 3, 1, 2, 4, 5, 7, 6, 8, 9]å¯ä»¥çœ‹åˆ°ä¸»è¿›ç¨‹å®šä¹‰äº†ä¸€ä¸ªå­—å…¸å’Œä¸€ä¸ªåˆ—è¡¨ï¼Œåœ¨å­è¿›ç¨‹ä¸­ï¼Œå¯ä»¥æ·»åŠ å’Œä¿®æ”¹å­—å…¸çš„å†…å®¹åœ¨åˆ—è¡¨ä¸­æ’å…¥æ–°çš„æ•°æ®ï¼Œå®ç°è¿›ç¨‹é—´çš„æ•°æ®å…±äº«ï¼Œå³å¯ä»¥å…±åŒä¿®æ”¹åŒä¸€ä»½æ•°æ®æ³¨æ„äº‹é¡¹æ— æ³•è°ƒç”¨å¤šå±‚ç”Ÿæˆå™¨(å¾…éªŒè¯)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129#!/usr/bin/env Python# -- coding: utf-8 --&quot;&quot;&quot;@version: v0.1@author: narutohyc@file: text.py@Description: @time: 2020/5/29 19:51&quot;&quot;&quot;from multiprocessing import Process, Queue, JoinableQueue, Managerfrom multiprocessing import cpu_countimport os, timefrom abc import (ABC,                 abstractmethod,                 ABCMeta)from comm.logger.logger_config import loggerclass SampleIterator(ABC, metaclass=ABCMeta):    def __init__(self):        pass    @abstractmethod    def __iter__(self):        '''        æ ·æœ¬å¤„ç†å¹¶è¿”å›        '''        passclass DataSource1(SampleIterator):    def __init__(self):        super(DataSource1, self).__init__()    def __iter__(self):        for ii in range(10):            yield iiclass DataSource2(SampleIterator):    def __init__(self, data_source):        super(DataSource2, self).__init__()        self.data_source = data_source    def __iter__(self):        for ii in self.data_source:            yield iiclass DataSource3(SampleIterator):    def __init__(self, data_source):        super(DataSource3, self).__init__()        self.data_source = data_source    def __iter__(self):        for ii in self.data_source:            yield iiclass DataSource4(SampleIterator):    def __init__(self, data_source):        super(DataSource4, self).__init__()        self.data_source = data_source    def __iter__(self):        for ii in self.data_source:            yield iiclass HUCY():    def __init__(self, data_source=None):        self.num_of_worker = cpu_count()        self.size_of_queue = 2        self.data_source = data_source    def start_work(self):        # è¿›ç¨‹é˜Ÿåˆ—        process_list = []        # æ–°å»ºä¸€ä¸ªå¤§å°ä¸º10çš„é˜Ÿåˆ—        work_queue = Queue(self.size_of_queue)        # ä¸€ä¸ªç”Ÿäº§è€…        produce_num = 1        for _ in range(produce_num):            sent = Process(target=self.productor, args=(work_queue,))            sent.start()            process_list.append(sent)        # å¤šä¸ªæ¶ˆè´¹è€…        for _ in range(self.num_of_worker - produce_num):            process = Process(target=self.consumer, args=(work_queue,))            process.start()            process_list.append(process)        # è¿™é‡Œéœ€è¦åŠ å…¥ç»“æŸæ ‡è¯†ï¼Œè¿˜æœ‰å°±æ˜¯JoinableQueueçš„æ–¹å¼        [process.join() for process in process_list[:produce_num]]        for _ in range(self.num_of_worker - produce_num):            work_queue.put(None)        [process.join() for process in process_list[produce_num:]]        print(&quot;start_work ç»“æŸ&quot;)    def productor(self, work_queue):        [work_queue.put(ii) for ii in self.data_source]        logger.info(&quot;ç”Ÿäº§è€…ç»“æŸ&quot;)    def consumer(self, work_queue):        while True:            data = work_queue.get()            if data is None:                break            logger.info(f&quot;æ•°æ®: {data}&quot;)        logger.info(&quot;æ¶ˆè´¹è€…ç»“æŸ&quot;)def hyc_test():    da1=DataSource2(DataSource3(DataSource4(DataSource1())))    da2 = DataSource2(DataSource3(DataSource4(da1)))    da3 = DataSource2(DataSource3(DataSource4(da2)))    da4 = DataSource2(DataSource3(DataSource4(da3)))    da5 = DataSource2(DataSource3(DataSource4(da4)))    da6 = DataSource2(DataSource3(DataSource4(DataSource2(da5))))    hucy = HUCY(da6)    hucy.start_work()if __name__ == '__main__':    hyc_test()å‡ ä¸ªé—®é¢˜:ä»¥ä¸Šä»£ç  è‹¥æœ‰å¤šä¸ªç”Ÿäº§è€…  å°±ä¼šå„è‡ªæ‹¥æœ‰è‡ªå·±çš„æ•°æ®ç”Ÿæˆå™¨ï¼Œå¯¼è‡´æ•°æ®é‡å¤æœ‰äº›å®šä¹‰çš„æ–¹æ³•  å¥½åƒä¼šä½¿ç¨‹åºå¡ä½</content>
	</entry>
	<entry>
		<title>æ–‡ä»¶å’Œç›®å½•è®¿é—®</title>
		<url>/article/53591.html</url>
		<content>æ–‡ä»¶æ–‡ä»¶æ˜¯æ•°æ®çš„æŠ½è±¡å’Œé›†åˆæ–‡ä»¶æ˜¯å­˜å‚¨åœ¨è¾…åŠ©å­˜å‚¨å™¨ä¸Šçš„æ•°æ®åºåˆ—æ–‡ä»¶æ˜¯æ•°æ®å­˜å‚¨çš„ä¸€ç§å½¢å¼æ–‡ä»¶å±•ç°å½¢æ€ï¼šæ–‡æœ¬æ–‡ä»¶å’ŒäºŒè¿›åˆ¶æ–‡ä»¶æ–‡æœ¬æ–‡ä»¶ vs. äºŒè¿›åˆ¶æ–‡ä»¶æ–‡ä»¶æ–‡ä»¶å’ŒäºŒè¿›åˆ¶æ–‡ä»¶åªæ˜¯æ–‡ä»¶çš„å±•ç¤ºæ–¹å¼æœ¬è´¨ä¸Šï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½æ˜¯äºŒè¿›åˆ¶å½¢å¼å­˜å‚¨å½¢å¼ä¸Šï¼Œæ‰€æœ‰æ–‡ä»¶é‡‡ç”¨ä¸¤ç§æ–¹å¼å±•ç¤ºæ–‡æœ¬æ–‡ä»¶ç”±å•ä¸€ç‰¹å®šç¼–ç ç»„æˆçš„æ–‡ä»¶ï¼Œå¦‚UTF-8ç¼–ç ç”±äºå­˜åœ¨ç¼–ç ï¼Œä¹Ÿè¢«çœ‹æˆæ˜¯å­˜å‚¨ç€çš„é•¿å­—ç¬¦ä¸²é€‚ç”¨äºä¾‹å¦‚ï¼š.txtæ–‡ä»¶ã€.pyæ–‡ä»¶ç­‰äºŒè¿›åˆ¶æ–‡ä»¶ç›´æ¥ç”±æ¯”ç‰¹0å’Œ1ç»„æˆï¼Œæ²¡æœ‰ç»Ÿä¸€å­—ç¬¦ç¼–ç ä¸€èˆ¬å­˜åœ¨äºŒè¿›åˆ¶0å’Œ1çš„ç»„ç»‡ç»“æ„ï¼Œå³æ–‡ä»¶æ ¼å¼é€‚ç”¨äºä¾‹å¦‚ï¼š.pngæ–‡ä»¶ã€.aviæ–‡ä»¶ç­‰åŸºæœ¬ä½¿ç”¨æ–‡ä»¶æ‰“å¼€å’Œå…³é—­åŸºæœ¬ä½¿ç”¨123&lt;å˜é‡å&gt; = open(&lt;æ–‡ä»¶å&gt;, &lt;æ‰“å¼€æ¨¡å¼&gt;, encoding='utf-8')æ–‡ä»¶å¥æŸ„ æ–‡ä»¶è·¯å¾„å’Œåç§° æ–‡æœ¬ or äºŒè¿›åˆ¶&lt;å˜é‡å&gt;.close()æ‰“å¼€æ¨¡å¼æ–‡ä»¶çš„æ‰“å¼€æ¨¡å¼æè¿°â€˜râ€™åªè¯»æ¨¡å¼ï¼Œé»˜è®¤å€¼ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œè¿”å›FileNotFoundErrorâ€˜wâ€™è¦†ç›–å†™æ¨¡å¼ï¼Œæ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºï¼Œå­˜åœ¨åˆ™å®Œå…¨è¦†ç›–â€˜xâ€™åˆ›å»ºå†™æ¨¡å¼ï¼Œæ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºï¼Œå­˜åœ¨åˆ™è¿”å›FileExistsErrorâ€˜aâ€™è¿½åŠ å†™æ¨¡å¼ï¼Œæ–‡ä»¶ä¸å­˜åœ¨åˆ™åˆ›å»ºï¼Œå­˜åœ¨åˆ™åœ¨æ–‡ä»¶æœ€åè¿½åŠ å†…å®¹â€˜bâ€™äºŒè¿›åˆ¶æ–‡ä»¶æ¨¡å¼â€˜tâ€™æ–‡æœ¬æ–‡ä»¶æ¨¡å¼ï¼Œé»˜è®¤å€¼â€˜+â€™ä¸r/w/x/aä¸€åŒä½¿ç”¨ï¼Œåœ¨åŸåŠŸèƒ½åŸºç¡€ä¸Šå¢åŠ åŒæ—¶è¯»å†™åŠŸèƒ½ç¤ºä¾‹12345678910111213141516a = open(&quot;f.txt&quot;, &quot;rt&quot;)a.read(size)                  # - ä¸€æ¬¡è¯»å…¥ï¼Œç»Ÿä¸€å¤„ç†a.readline(size)              # - æŒ‰æ•°é‡è¯»å…¥ï¼Œé€æ­¥å¤„ç†a.readlines(hint)             # - ä¸€æ¬¡è¯»å…¥ï¼Œåˆ†è¡Œå¤„ç†a.write(s)a.writelines(lines)a.seek(offset)f = open(&quot;f.txt&quot;)             # - æ–‡æœ¬å½¢å¼ã€åªè¯»æ¨¡å¼ã€é»˜è®¤å€¼f = open(&quot;f.txt&quot;, &quot;rt&quot;)       # - æ–‡æœ¬å½¢å¼ã€åªè¯»æ¨¡å¼ã€åŒé»˜è®¤å€¼f = open(&quot;f.txt&quot;, &quot;w&quot;)        # - æ–‡æœ¬å½¢å¼ã€è¦†ç›–å†™æ¨¡å¼f = open(&quot;f.txt&quot;, &quot;a+&quot;)       # - æ–‡æœ¬å½¢å¼ã€è¿½åŠ å†™æ¨¡å¼+ è¯»æ–‡ä»¶f = open(&quot;f.txt&quot;, &quot;x&quot;)        # - æ–‡æœ¬å½¢å¼ã€åˆ›å»ºå†™æ¨¡å¼f = open(&quot;f.txt&quot;, &quot;b&quot;)        # - äºŒè¿›åˆ¶å½¢å¼ã€åªè¯»æ¨¡å¼f = open(&quot;f.txt&quot;, &quot;wb&quot;)       # - äºŒè¿›åˆ¶å½¢å¼ã€è¦†ç›–å†™æ¨¡å¼æ–‡ä»¶å†…å®¹çš„è¯»å–1234567891011121314151617181920# è¯»å…¥å…¨éƒ¨å†…å®¹ï¼Œå¦‚æœç»™å‡ºå‚æ•°ï¼Œè¯»å…¥å‰sizeé•¿åº¦# &lt;f&gt;.read(size=-1)&gt;&gt;&gt;s = f.read(2)ä¸­å›½# è¯»å…¥ä¸€è¡Œå†…å®¹ï¼Œå¦‚æœç»™å‡ºå‚æ•°ï¼Œè¯»å…¥è¯¥è¡Œå‰sizeé•¿åº¦# &lt;f&gt;.readline(size=-1)&gt;&gt;&gt;s = f.readline()ä¸­å›½æ˜¯ä¸€ä¸ªä¼Ÿå¤§çš„å›½å®¶ï¼# è¯»å…¥æ–‡ä»¶æ‰€æœ‰è¡Œï¼Œä»¥æ¯è¡Œä¸ºå…ƒç´ å½¢æˆåˆ—è¡¨# å¦‚æœç»™å‡ºå‚æ•°ï¼Œè¯»å…¥å‰hintè¡Œ# &lt;f&gt;.readlines(hint=-1)while True:lines = f.readlines(100000)if not lines:breakfor line in lines:pass # do somethingæ•°æ®çš„æ–‡ä»¶å†™å…¥1234567891011121314151617181920212223242526272829# 1ï¼‰å°†åµŒå¥—åˆ—è¡¨æˆ–å­—å…¸è½¬ä¸ºjsonæ ¼å¼æ•°æ®import jsonf=open('a1.txt','w',encoding='utf-8')dic={1:'å¼ ä¸‰',2:'æå››'}dic2={11:'å¼ ä¸‰ä¸‰',2:'ææ€æ€'}a=json.dumps(dic)f.write(a+'\n')b=json.dumps(dic2)f.write(b+'\n')f.close()# 2)å°†æ–‡ä»¶ä¸­çš„åˆ—è¡¨æˆ–å­—å…¸jsonå­—ç¬¦ä¸²è¯»å–å‡ºæ¥import jsonf=open('a1.txt','r',encoding='utf-8')for i in f:    print(json.loads(i))f.close()# æ”¹å˜å½“å‰æ–‡ä»¶æ“ä½œæŒ‡é’ˆçš„ä½ç½®ï¼Œoffsetå«ä¹‰å¦‚ä¸‹ï¼š# 0 â€“ æ–‡ä»¶å¼€å¤´ï¼› 1 â€“ å½“å‰ä½ç½®ï¼› 2 â€“ æ–‡ä»¶ç»“å°¾# seekï¼ˆoffset [,from]ï¼‰æ–¹æ³•æ”¹å˜å½“å‰æ–‡ä»¶çš„ä½ç½®ã€‚Offsetå˜é‡è¡¨ç¤ºè¦ç§»åŠ¨çš„å­—èŠ‚æ•°ã€‚Fromå˜é‡æŒ‡å®šå¼€å§‹ç§»åŠ¨å­—èŠ‚çš„å‚è€ƒä½ç½®ã€‚# å¦‚æœfromè¢«è®¾ä¸º0ï¼Œè¿™æ„å‘³ç€å°†æ–‡ä»¶çš„å¼€å¤´ä½œä¸ºç§»åŠ¨å­—èŠ‚çš„å‚è€ƒä½ç½®ã€‚å¦‚æœè®¾ä¸º1ï¼Œåˆ™ä½¿ç”¨å½“å‰çš„ä½ç½®ä½œä¸ºå‚è€ƒä½ç½®ã€‚å¦‚æœå®ƒè¢«è®¾ä¸º2ï¼Œé‚£ä¹ˆè¯¥æ–‡ä»¶çš„æœ«å°¾å°†ä½œä¸ºå‚è€ƒä½ç½®ã€‚&gt;&gt;&gt;f.seek(0) #å›åˆ°æ–‡ä»¶å¼€å¤´# æŸ¥çœ‹æŒ‡é’ˆä½ç½®f.tell()ls = [&quot;ä¸­å›½&quot;, &quot;æ³•å›½&quot;, &quot;ç¾å›½&quot;]sfo.writelines(ls)Fileå¯¹è±¡çš„å±æ€§å±æ€§æè¿°file.closedè¿”å›trueå¦‚æœæ–‡ä»¶å·²è¢«å…³é—­ï¼Œå¦åˆ™è¿”å›falseã€‚file.modeè¿”å›è¢«æ‰“å¼€æ–‡ä»¶çš„è®¿é—®æ¨¡å¼ã€‚file.nameè¿”å›æ–‡ä»¶çš„åç§°ã€‚file.softspaceå¦‚æœç”¨printè¾“å‡ºåï¼Œå¿…é¡»è·Ÿä¸€ä¸ªç©ºæ ¼ç¬¦ï¼Œåˆ™è¿”å›falseã€‚å¦åˆ™è¿”å›trueã€‚é«˜é˜¶ä½¿ç”¨ä¸´æ—¶æ–‡ä»¶å’Œç›®å½•ä¸€æ—¥ä¸€æŠ€ï¼šåœ¨Pythonä¸­åˆ›å»ºä¸´æ—¶æ–‡ä»¶ç”¨äºè®°å½•ä¸´æ—¶æ•°æ®tempfile â€”- ç”Ÿæˆä¸´æ—¶æ–‡ä»¶å’Œç›®å½•å½“æˆ‘ä»¬åœ¨åšæ•°æ®åˆ†æçš„æ—¶å€™ï¼Œå¯èƒ½ä¼šç”±äºæ•°æ®é‡è¿‡å¤§å¯¼è‡´å†…å­˜ä¸è¶³ã€‚å¦‚æœæˆ‘ä»¬æ²¡æœ‰æ¡ä»¶ä½¿ç”¨æ›´é«˜é…ç½®çš„ç”µè„‘ï¼Œä¹Ÿæ²¡æœ‰åŠæ³•ä¼˜åŒ–æ•°æ®ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å…ˆæŠŠè®¡ç®—çš„ä¸­é—´å€¼å­˜æ”¾åœ¨ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ä¸­ã€‚ è¿™ç§æ–¹æ¡ˆè™½ç„¶æœ‰æ•ˆï¼Œä½†æ˜¯ä¸­é—´æ•°æ®å†™æˆçš„ä¸´æ—¶æ–‡ä»¶å¦‚æœä¸æ¸…ç†ï¼Œæ—¶é—´ä¸€é•¿å°±ä¼šå ç”¨å¤§é‡ç¡¬ç›˜ç©ºé—´ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥æ¯ä¸€æ¬¡éƒ½è¦†ç›–ä¸´æ—¶æ–‡ä»¶ï¼Œè¿™æ ·å®ƒè™½ç„¶ä¸ä¼šå †ç§¯ï¼Œä½†å½“ä½ çš„åˆ†æç¨‹åºå·²ç»åœæ­¢çš„æ—¶å€™ï¼Œä¸´æ—¶æ–‡ä»¶è¿˜åœ¨ç¡¬ç›˜ä¸Šå ç”¨ç©ºé—´ã€‚ tempfile æ¨¡å—ä¸“é—¨ç”¨äºåˆ›å»ºä¸´æ—¶æ–‡ä»¶å’Œä¸´æ—¶ç›®å½•æ—¢å¯ä»¥åœ¨ UNIX å¹³å°ä¸Šè¿è¡Œè‰¯å¥½ï¼Œä¹Ÿå¯ä»¥åœ¨ Windows å¹³å°ä¸Šè¿è¡Œè‰¯å¥½å…¥é—¨ç¤ºä¾‹123456789101112from tempfile import TemporaryFilewith TemporaryFile('w+t', encoding='utf-8') as f:           # ç”Ÿæˆä¸­é—´æ•°æ®           f.write('ä¸­é—´æ•°æ®')           f.write('å¦ä¸€éƒ¨åˆ†ä¸­é—´æ•°æ®')          # å…¶ä»–è®¡ç®—è¿‡ç¨‹          # ä¸‹é¢å¼€å§‹è¯»å–ä¸´æ—¶æ–‡ä»¶           f.seek(0)           f.read()       # é€€å‡ºwithä¸Šä¸‹æ–‡ï¼Œä¸´æ—¶æ–‡ä»¶è‡ªåŠ¨è¢«åˆ é™¤ ç”±äºä¸´æ—¶æ–‡ä»¶è¢«å…³é—­å°±ä¼šè¢«åˆ é™¤ï¼Œæ‰€ä»¥éœ€è¦å®ç°åŒæ—¶è¯»å†™æ–‡ä»¶ï¼Œå› æ­¤æ–‡ä»¶æ¨¡å¼ä¸º w+tä½¿ç”¨ TemporaryFileï¼Œä½ æ²¡æ³•çŸ¥é“è¿™ä¸ªä¸´æ—¶æ–‡ä»¶å«åšä»€ä¹ˆåå­—ã€‚å¦‚æœä½ æƒ³çŸ¥é“æ–‡ä»¶åï¼Œç”šè‡³æƒ³è®©å¦ä¸€ä¸ªç¨‹åºæ‰“å¼€è¿™ä¸ªä¸´æ—¶æ–‡ä»¶ï¼Œé‚£ä¹ˆä½ å¯ä»¥ä½¿ç”¨ NamedTemporaryFileï¼š 1234567import redisfrom tempfile import NamedTemporaryFilewith NamedTemporaryFile('w+t') as f:           # æŠŠæ–‡ä»¶åé€šè¿‡æŸç§æ–¹å¼ä¼ ç»™å…¶ä»–ç¨‹åº           client = redis.Redis()           client.set('temp_file', f.name)           # åç»­æ“ä½œ åªè¦è¿™ä¸ªä¸´æ—¶æ–‡ä»¶è¿˜æ²¡æœ‰è¢«å…³é—­ï¼Œé‚£ä¹ˆå¦ä¸€ä¸ªç¨‹åºå°±å¯ä»¥è¯»å–è¿™ä¸ªä¸´æ—¶æ–‡ä»¶123&gt;# é€šè¿‡withè¯­å¥åˆ›å»ºä¸´æ—¶ç›®å½•with tempfile.TemporaryDirectory() as tmpdirname:print('åˆ›å»ºä¸´æ—¶ç›®å½•', tmpdirname)å¸¸ç”¨çš„å‡½æ•°tempfile æ¨¡å—å‡½æ•°åŠŸèƒ½æè¿°tempfile.TemporaryFile(mode=â€™w+bâ€™, buffering=None, encoding=None, newline=None, suffix=None, prefix=None, dir=None)åˆ›å»ºä¸´æ—¶æ–‡ä»¶ã€‚è¿”å›ä¸€ä¸ªç±»æ–‡ä»¶å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯æ”¯æŒæ–‡ä»¶ I/Otempfile.NamedTemporaryFile(mode=â€™w+bâ€™, buffering=None, encoding=None, newline=None, suffix=None, prefix=None, dir=None, delete=True)åˆ›å»ºä¸´æ—¶æ–‡ä»¶ã€‚åŠŸèƒ½ä¸ä¸Šä¸€ä¸ªå‡½æ•°çš„åŠŸèƒ½å¤§è‡´ç›¸åŒï¼Œåªæ˜¯å®ƒç”Ÿæˆçš„ä¸´æ—¶æ–‡ä»¶åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­æœ‰æ–‡ä»¶åtempfile.SpooledTemporaryFile(max_size=0, mode=â€™w+bâ€™, buffering=None, encoding=None, newline=None, suffix=None, prefix=None, dir=None)åˆ›å»ºä¸´æ—¶æ–‡ä»¶ã€‚ä¸ TemporaryFile å‡½æ•°ç›¸æ¯”ï¼Œå½“ç¨‹åºå‘è¯¥ä¸´æ—¶æ–‡ä»¶è¾“å‡ºæ•°æ®æ—¶ï¼Œä¼šå…ˆè¾“å‡ºåˆ°å†…å­˜ä¸­ï¼Œç›´åˆ°è¶…è¿‡ max_size æ‰ä¼šçœŸæ­£è¾“å‡ºåˆ°ç‰©ç†ç£ç›˜ä¸­ã€‚tempfile.TemporaryDirectory(suffix=None, prefix=None, dir=None)ç”Ÿæˆä¸´æ—¶ç›®å½•tempfile.gettempdir()è·å–ç³»ç»Ÿçš„ä¸´æ—¶ç›®å½•tempfile.gettempdirb()ä¸ gettempdir() ç›¸åŒï¼Œåªæ˜¯è¯¥å‡½æ•°è¿”å›å­—èŠ‚ä¸²tempfile.gettempprefix()è¿”å›ç”¨äºç”Ÿæˆä¸´æ—¶æ–‡ä»¶çš„å‰ç¼€åtempfile.gettempprefixb()ä¸ gettempprefix() ç›¸åŒï¼Œåªæ˜¯è¯¥å‡½æ•°è¿”å›å­—èŠ‚ä¸²æç¤ºï¼šè¡¨ä¸­æœ‰äº›å‡½æ•°åŒ…å«å¾ˆå¤šå‚æ•°ï¼Œä½†è¿™äº›å‚æ•°éƒ½å…·æœ‰è‡ªå·±çš„é»˜è®¤å€¼å› æ­¤å¦‚æœæ²¡æœ‰ç‰¹æ®Šè¦æ±‚ï¼Œå¯ä»¥ä¸å¯¹å…¶ä¼ å‚tempfile æ¨¡å—è¿˜æä¾›äº† tempfile.mkstemp() å’Œ tempfile.mkdtemp() ä¸¤ä¸ªä½çº§åˆ«çš„å‡½æ•°ä¸Šé¢ä»‹ç»çš„ 4 ä¸ªç”¨äºåˆ›å»ºä¸´æ—¶æ–‡ä»¶å’Œä¸´æ—¶ç›®å½•çš„å‡½æ•°éƒ½æ˜¯é«˜çº§åˆ«çš„å‡½æ•°ï¼Œé«˜çº§åˆ«çš„å‡½æ•°æ”¯æŒè‡ªåŠ¨æ¸…ç†ï¼Œè€Œä¸”å¯ä»¥ä¸ with è¯­å¥ä¸€èµ·ä½¿ç”¨è€Œè¿™ä¸¤ä¸ªä½çº§åˆ«çš„å‡½æ•°åˆ™ä¸æ”¯æŒï¼Œå› æ­¤ä¸€èˆ¬æ¨èä½¿ç”¨é«˜çº§åˆ«çš„å‡½æ•°æ¥åˆ›å»ºä¸´æ—¶æ–‡ä»¶å’Œä¸´æ—¶ç›®å½•æ­¤å¤–ï¼Œtempfile æ¨¡å—è¿˜æä¾›äº† tempfile.tempdir å±æ€§ï¼Œé€šè¿‡å¯¹è¯¥å±æ€§èµ‹å€¼å¯ä»¥æ”¹å˜ç³»ç»Ÿçš„ä¸´æ—¶ç›®å½•æ•°æ®è§£å‹ç¼©gzip æ ¼å¼è¯»å–å‹ç¼©æ–‡ä»¶ç¤ºä¾‹ï¼š123import gzipwith gzip.open('/home/joe/file.txt.gz', 'rb') as f:    file_content = f.read()åˆ›å»ºGZIP æ–‡ä»¶ç¤ºä¾‹ï¼š1234import gzipcontent = b&quot;Lots of content here&quot;with gzip.open('/home/joe/file.txt.gz', 'wb') as f:    f.write(content)ä½¿ç”¨ GZIP å‹ç¼©å·²æœ‰çš„æ–‡ä»¶ç¤ºä¾‹ï¼š12345import gzipimport shutilwith open('/home/joe/file.txt', 'rb') as f_in:    with gzip.open('/home/joe/file.txt.gz', 'wb') as f_out:        shutil.copyfileobj(f_in, f_out)ä½¿ç”¨ GZIP å‹ç¼©äºŒè¿›åˆ¶å­—ç¬¦ä¸²ç¤ºä¾‹ï¼š123import gzips_in = b&quot;Lots of content here&quot;s_out = gzip.compress(s_in)ZIPæ ¼å¼taræ ¼å¼å¦‚ä½•å°†æ•´ä¸ª tar å½’æ¡£æå–åˆ°å½“å‰å·¥ä½œç›®å½•:1234import tarfiletar = tarfile.open(&quot;sample.tar.gz&quot;)tar.extractall()tar.close()å¦‚ä½•é€šè¿‡ TarFile.extractall() ä½¿ç”¨ç”Ÿæˆå™¨å‡½æ•°è€Œéåˆ—è¡¨æ¥æå–ä¸€ä¸ª tar å½’æ¡£çš„å­é›†:1234567891011import osimport tarfiledef py_files(members):    for tarinfo in members:        if os.path.splitext(tarinfo.name)[1] == &quot;.py&quot;:            yield tarinfotar = tarfile.open(&quot;sample.tar.gz&quot;)tar.extractall(members=py_files(tar))tar.close()å¦‚ä½•åŸºäºä¸€ä¸ªæ–‡ä»¶ååˆ—è¡¨åˆ›å»ºæœªå‹ç¼©çš„ tar å½’æ¡£:12345import tarfiletar = tarfile.open(&quot;sample.tar&quot;, &quot;w&quot;)for name in [&quot;foo&quot;, &quot;bar&quot;, &quot;quux&quot;]:    tar.add(name)tar.close()ä½¿ç”¨ with è¯­å¥çš„åŒä¸€ä¸ªç¤ºä¾‹:1234import tarfilewith tarfile.open(&quot;sample.tar&quot;, &quot;w&quot;) as tar:    for name in [&quot;foo&quot;, &quot;bar&quot;, &quot;quux&quot;]:        tar.add(name)å¦‚ä½•è¯»å–ä¸€ä¸ª gzip å‹ç¼©çš„ tar å½’æ¡£å¹¶æ˜¾ç¤ºä¸€äº›æˆå‘˜ä¿¡æ¯:1234567891011import tarfiletar = tarfile.open(&quot;sample.tar.gz&quot;, &quot;r:gz&quot;)for tarinfo in tar:    print(tarinfo.name, &quot;is&quot;, tarinfo.size, &quot;bytes in size and is &quot;, end=&quot;&quot;)    if tarinfo.isreg():        print(&quot;a regular file.&quot;)    elif tarinfo.isdir():        print(&quot;a directory.&quot;)    else:        print(&quot;something else.&quot;)tar.close()å¦‚ä½•åˆ›å»ºä¸€ä¸ªå½’æ¡£å¹¶ä½¿ç”¨ TarFile.add() ä¸­çš„ filter å½¢å‚æ¥é‡ç½®ç”¨æˆ·ä¿¡æ¯:12345678import tarfiledef reset(tarinfo):    tarinfo.uid = tarinfo.gid = 0    tarinfo.uname = tarinfo.gname = &quot;root&quot;    return tarinfotar = tarfile.open(&quot;sample.tar.gz&quot;, &quot;w:gz&quot;)tar.add(&quot;foo&quot;, filter=reset)tar.close()osåº“åŸºæœ¬æ¦‚å¿µosåº“æä¾›é€šç”¨çš„ã€åŸºæœ¬çš„æ“ä½œç³»ç»Ÿäº¤äº’åŠŸèƒ½ï¼Œæ˜¯Pythonæ ‡å‡†åº“åŒ…å«å‡ ç™¾ä¸ªå‡½æ•°ï¼Œå¸¸ç”¨è·¯å¾„æ“ä½œã€è¿›ç¨‹ç®¡ç†ã€ç¯å¢ƒå‚æ•°ç­‰å‡ ç±»è·¯å¾„æ“ä½œï¼šos.pathå­åº“ï¼Œå¤„ç†æ–‡ä»¶è·¯å¾„åŠä¿¡æ¯è¿›ç¨‹ç®¡ç†ï¼šå¯åŠ¨ç³»ç»Ÿä¸­å…¶ä»–ç¨‹åºç¯å¢ƒå‚æ•°ï¼šè·å¾—ç³»ç»Ÿè½¯ç¡¬ä»¶ä¿¡æ¯ç­‰ç¯å¢ƒå‚æ•°pathå­åº“å¯¼å…¥123from os.path import joinfrom IPython.core.interactiveshell import InteractiveShell # InteractiveShell.ast_node_interactivity = &quot;all&quot; # å¯åŒæ—¶è¾“å‡ºå¤šä¸ªç»“æœæ–‡ä»¶æ“ä½œåˆ¤æ–­æ˜¯å¦æ˜¯æ–‡ä»¶  filepathæœ€åæ²¡æœ‰/ é»˜è®¤å–//123456filepath = '../res/file_op/folder/''is file' if os.path.isfile(filepath) else 'is folder''is dir' if os.path.isdir(filepath) else 'not dir''is folder''is diråˆ¤æ–­ä¸¤ä¸ªè·¯å¾„éƒ½æŒ‡å‘ç›¸åŒçš„æ–‡ä»¶æˆ–ç›®å½•12# å¦‚æœä¸¤ä¸ªè·¯å¾„éƒ½æŒ‡å‘ç›¸åŒçš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œåˆ™è¿”å› Trueos.path.samefile(path1, path2)å¢åˆ æ–‡ä»¶[å¤¹]åˆ›å»ºæ–‡ä»¶å¤¹1234# 2. åˆ›å»ºã€åˆ é™¤æ–‡ä»¶ä¸æ–‡ä»¶å¤¹newfolder = '../res/file_op/mkfolder/'os.mkdir(newfolder) # åˆ›å»ºæ–‡ä»¶å¤¹,ä¸ä¼šé€’å½’åˆ›å»ºä¸å­˜åœ¨çš„çˆ¶ç›®å½•os.makedirs(newfolder) # çˆ¶ç›®å½•ä¸å­˜åœ¨ï¼Œåˆ™é€’å½’åˆ›å»ºçˆ¶ç›®å½•åˆ é™¤æ–‡ä»¶å¤¹123os.rmdir(newfolder) # å¦‚æœè¦åˆ é™¤ç›®å½•ï¼Œè¯·ä½¿ç”¨rmdir().import shutilshutil.rmtree(path)    # é€’å½’åˆ é™¤æ–‡ä»¶å¤¹åˆ é™¤æ–‡ä»¶1234if os.path.exists(join(filepath,'file_0.txt')):    os.remove(join(filepath,'file_0.txt')) # åˆ é™¤æ–‡ä»¶    # join('savepath', 'png/demo')   #æ­£ç¡®    # join('savepath', '/png/demo')  #é”™è¯¯ç›®å½•éå†pythonä¸­os.walkçš„ç”¨æ³•è¯¦è§£åˆ—å‡ºç›®å½•ä¸‹çš„æ‰€æœ‰å­ç›®å½•12345path = '../res/file_op'for dirpath, dirnames, filenames in os.walk(path):    for dirname in dirnames:        print(os.path.join(dirpath, dirname))../res/file_op\folderåˆ—å‡ºç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶1234567891011for dirpath, dirnames, filenames in os.walk(path):    for filename in filenames:        print(os.path.join(dirpath, filename))../res/file_op\file_ico.png../res/file_op\folder\file_1.txt  filepath = '../res/file_op'fileList = os.listdir(filepath) # åˆ—å‡ºæ‰€æœ‰æ–‡ä»¶for fl in fileList:    print(fl)file_1.txtåˆ†å‰²æ–‡ä»¶ç›®å½•/æ–‡ä»¶åå’Œåç¼€123456file_path = &quot;D:/test/test.py&quot;(filepath, tempfilename) = os.path.split(file_path)# ç­‰ä»·äº (filepath, tempfilename) = os.path.dirname(path),os.path.basename(path)==&gt; D:/test test.py(filename, extension) = os.path.splitext(tempfilename)==&gt; test .pyç›®å½•æ“ä½œä¿®æ”¹ç›®å½•åç§°1234os.rename('d0/d10/d100', 'D100')    # ä¼šå¯¼è‡´ç›®å½•ç§»åŠ¨ï¼os.path.abspath(path)                   # è·å–ä¸€ä¸ªè·¯å¾„çš„å®Œå…¨è·¯å¾„os.path.splitext(path)                  # åˆ†ç¦»æ–‡ä»¶åå’Œæ‰©å±•åos.path.normpath( &quot;D://PYE//file.txt&quot; ) # å½’ä¸€åŒ–pathçš„è¡¨ç¤ºå½¢å¼ï¼Œç»Ÿä¸€ç”¨\\åˆ†éš”è·¯å¾„è¿”å›å½“å‰ç¨‹åºä¸æ–‡ä»¶ä¹‹é—´çš„ç›¸å¯¹è·¯å¾„ (relative path)1234path = 'E:\\PycharmWS\\sj\\text-mining-framework'os.getcwd() # 'E:\\PycharmWS\\sj\\text-mining-framework\\tests\\others'In [3]: os.path.relpath(path)Out[3]: '..\\..'è¿”å› path çš„å¤§å°ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½ï¼Œè¯¥æ–‡ä»¶ä¸å­˜åœ¨æˆ–ä¸å¯è®¿é—®æ—¶ï¼ŒæŠ›å‡º OSError å¼‚å¸¸1os.path.getsize( &quot;D:/PYE/file.txt&quot; )    # è¿”å›pathå¯¹åº”æ–‡ä»¶çš„å¤§å°ï¼Œä»¥å­—èŠ‚ä¸ºå•ä½è¿”å›åºåˆ— paths ä¸­æ¯ä¸ªè·¯å¾„åç§°çš„æœ€é•¿å…±åŒæœ‰æ•ˆå­è·¯å¾„12# å¦‚æœ paths åŒæ—¶åŒ…å«ç»å¯¹å’Œç›¸å¯¹è·¯å¾„åç§°æˆ–è€…å¦‚æœ paths ä¸ºç©ºåˆ™ä¼šå¼•å‘ ValueErroros.path.commonpath(paths)é«˜é˜¶æ–‡ä»¶æ“ä½œå¤åˆ¶å’Œåˆ é™¤å¤åˆ¶æ–‡ä»¶[å¤¹]1234567import shutil# shutil.copy(srcfile, dstfile) : å¤åˆ¶srcfileæ–‡ä»¶ï¼Œå¹¶å‘½åä¸ºdstfileshutil.copy('d0/file1.txt', 'd0/file2.txt')# shutil.copy(srcfile, path) : å¤åˆ¶srcfileæ–‡ä»¶åˆ°pathè·¯å¾„ä¸‹shutil.copy('d0/file1.txt', '..')     # shutil.copytree(srcDir, dstDir) : é€’å½’åœ°å¤åˆ¶srcDirç›®å½•ï¼Œå¹¶å‘½åä¸ºdstDirï¼›dstDirä¸èƒ½æ˜¯å·²ç»å­˜åœ¨çš„ï¼shutil.copytree('d0/', 'D0')ç§»åŠ¨æ–‡ä»¶[å¤¹]123456# shutil.move(srcfile, dstfile) : ç§»åŠ¨srcfileæ–‡ä»¶å¹¶å‘½åä¸ºdstfileï¼Œç›¸å½“äºæ–‡ä»¶é‡å‘½åshutil.move('d0/file1.txt', 'd0/FILE1.txt')# shutil.move(srcfile, path) ï¼š ç§»åŠ¨srcfileæ–‡ä»¶åˆ°pathè·¯å¾„ä¸‹shutil.move('d0/file2.txt', '.')# shutil.move(srcDir, dstDir) ï¼š ç§»åŠ¨srcDirç›®å½•(åŒ…æ‹¬å…¶å­ç›®å½•å’Œæ–‡ä»¶)åˆ°dstDirç›®å½•ä¸‹shutil.move('d0', 'D0')è¿”å›è·¯å¾„å’Œæœ€åä¸€ä¸ªæ–‡ä»¶åç»„æˆçš„å…ƒç»„1234# è¿”å›è·¯å¾„å’Œæœ€åä¸€ä¸ªæ–‡ä»¶åç»„æˆçš„å…ƒç»„_, filename = os.path.split(os.getcwd())print(filename)Out[7]: 'python'ç£ç›˜ä½¿ç”¨ç»Ÿè®¡ç£ç›˜ä½¿ç”¨ç»Ÿè®¡æ•°æ®ï¼Œå½¢å¼ä¸ºä¸€ä¸ª named tupleï¼Œå…¶ä¸­åŒ…å« total, used å’Œ free å±æ€§åˆ†åˆ«è¡¨ç¤ºæ€»è®¡ã€å·²ä½¿ç”¨å’Œæœªä½¿ç”¨ç©ºé—´çš„å­—èŠ‚æ•°ã€‚åœ¨ Windows ä¸Šï¼Œpath å¿…é¡»æ˜¯ä¸€ä¸ªç›®å½•ï¼›åœ¨ Unix ä¸Šï¼Œå®ƒå¯ä»¥æ˜¯ä¸€ä¸ªæ–‡ä»¶æˆ–ä¸€ä¸ªç›®å½•123import shutilshutil.disk_usage(path)Out[19]: usage(total=223217709056, used=82961846272, free=140255862784)osåº“ä¹‹ç¯å¢ƒå‚æ•°è·å–æˆ–æ”¹å˜ç³»ç»Ÿç¯å¢ƒä¿¡æ¯123456# ä¿®æ”¹å½“å‰ç¨‹åºæ“ä½œçš„è·¯å¾„&gt;&gt;&gt;os.chdir(&quot;D:&quot;)# è¿”å›ç¨‹åºçš„å½“å‰è·¯å¾„&gt;&gt;&gt;os.getcwd()'D:\\'è·å–æ“ä½œç³»ç»Ÿç¯å¢ƒä¿¡æ¯1234567# è·å¾—å½“å‰ç³»ç»Ÿç™»å½•ç”¨æˆ·åç§°&gt;&gt;&gt;os.getlogin()'hyc'# è·å¾—å½“å‰ç³»ç»Ÿçš„CPUæ•°é‡&gt;&gt;&gt;os.cpu_count()8è·å–æ“ä½œç³»ç»Ÿç¯å¢ƒä¿¡æ¯123# è·å¾—nä¸ªå­—èŠ‚é•¿åº¦çš„éšæœºå­—ç¬¦ä¸²ï¼Œé€šå¸¸ç”¨äºåŠ è§£å¯†è¿ç®—&gt;&gt;&gt;os.urandom(10)b'7\xbe\xf2!\xc1=\x01gL\xb3'å…¶ä»–ä½¿ç”¨osåº“ä¹‹è¿›ç¨‹ç®¡ç†12345# æ‰§è¡Œç¨‹åºæˆ–å‘½ä»¤command# åœ¨Windowsç³»ç»Ÿä¸­ï¼Œè¿”å›å€¼ä¸ºcmdçš„è°ƒç”¨è¿”å›ä¿¡æ¯import osos.system(&quot;C:\\Windows\\System32\\calc.exe&quot;)os.system(&quot;C:\\Windows\\System32\\mspaint.exe D:\\PYECourse\\grwordcloud.png&quot;)æŸ¥çœ‹å‰©ä½™ç©ºé—´å¤§å°(ubuntu)1234567def checkDis(path):    import os    hd = {}    disk = os.statvfs(path)    percent = (disk.f_blocks - disk.f_bfree) * 100 / \                (disk.f_blocks - disk.f_bfree + disk.f_bavail) + 1    return 100 - percent</content>
	</entry>
	<entry>
		<title>Pythonicçš„å‡ ä¸ªåŠæ³•</title>
		<url>/article/31834.html</url>
		<content>Pythonicçš„å‡ ä¸ªåŠæ³•Pythonéš¾ç‚¹è§£æâ€”-é«˜çº§ç¯‡2.PythonicPython å®ç”¨å†·é—¨çŸ¥è¯†æ•´ç†è¿™äº›å¹´æ¥ï¼ŒPython å¼€å‘è€…ç”¨Pythonicè¿™ä¸ªå½¢å®¹è¯æ¥æè¿°é‚£ç§ç¬¦åˆç‰¹å®šé£æ ¼çš„ä»£ç ã€‚è¿™ç§Pythoniceé£æ ¼ï¼Œæ—¢ä¸æ˜¯éå¸¸ä¸¥å¯†çš„è§„èŒƒï¼Œä¹Ÿä¸æ˜¯ç”±ç¼–è¯‘å™¨å¼ºåŠ ç»™å¼€å‘è€…çš„è§„åˆ™ï¼Œè€Œæ˜¯å¤§å®¶åœ¨ä½¿ç”¨Pythonè¯­è¨€ååŒå·¥ä½œçš„è¿‡ç¨‹ä¸­é€æ¸å½¢æˆçš„ä¹ æƒ¯ã€‚ç¡®è®¤pythonç‰ˆæœ¬1python --version12345import sysprint(sys.version)3.7.6 (default, Jan  8 2020, 20:23:39) [MSC v.1916 64 bit (AMD64)]print(sys.version_info)sys.version_info(major=3, minor=7, micro=6, releaselevel='final', serial=0)æœ‰å¾ˆå¤šç§æµè¡Œçš„Pythonè¿è¡Œæ—¶ç¯å¢ƒï¼Œä¾‹å¦‚ï¼ŒCPythonã€ Jythonã€ IronPython ä»¥åŠPyPyç­‰ã€‚enumerateè¿­ä»£enumerateå¯ä»¥æŠŠå„ç§è¿­ä»£å™¨åŒ…è£…ä¸ºç”Ÿæˆå™¨ï¼Œä»¥ä¾¿ç¨åäº§ç”Ÿè¾“å‡ºå€¼ã€‚å¯ä»¥ç»™enumerateæä¾›ç¬¬äºŒä¸ªå‚æ•°ï¼Œä»¥æŒ‡å®šå¼€å§‹è®¡æ•°æ—¶æ‰€ç”¨çš„å€¼(é»˜è®¤ä¸º0)ã€‚1234567891011121314151617181920212223&gt;&gt;&gt; numbers = [45, 22, 14, 65, 97, 72]&gt;&gt;&gt; for i, num in enumerate(numbers):...     if num % 3 == 0 and num % 5 == 0:...         numbers[i] = 'fizzbuzz'...     elif num % 3 == 0:...         numbers[i] = 'fizz'...     elif num % 5 == 0:...         numbers[i] = 'buzz'...&gt;&gt;&gt; numbers['fizzbuzz', 22, 14, 'buzz', 97, 'fizz']# å¯¹äºæ¯ä¸ªå…ƒç´ ï¼Œenumerate()è¿”å›ä¸€ä¸ªè®¡æ•°å™¨å’Œå…ƒç´ å€¼ã€‚è®¡æ•°å™¨é»˜è®¤ä¸º0ï¼Œä¹Ÿæ˜¯å…ƒç´ çš„ç´¢å¼•ã€‚ä¸æƒ³åœ¨0å¼€å§‹ä½ çš„è®¡æ•°ï¼Ÿåªéœ€ä½¿ç”¨å¯é€‰çš„startå‚æ•°æ¥è®¾ç½®åç§»é‡&gt;&gt;&gt; numbers = [45, 22, 14, 65, 97, 72]&gt;&gt;&gt; for i, num in enumerate(numbers, start=52):...     print(i, num)...52 4553 2254 1455 6556 9757 72åˆ—è¡¨é€’æ¨å¼åˆ—è¡¨æ¨å¯¼æ˜¯æ„å»ºåˆ—è¡¨ï¼ˆlistï¼‰çš„å¿«æ·æ–¹å¼ï¼Œè€Œç”Ÿæˆå™¨è¡¨è¾¾å¼åˆ™å¯ä»¥ç”¨æ¥åˆ›å»ºå…¶ä»–ä»»ä½•ç±»å‹çš„åºåˆ—ã€‚é€šå¸¸çš„åŸåˆ™æ˜¯ï¼Œåªç”¨åˆ—è¡¨æ¨å¯¼æ¥åˆ›å»ºæ–°çš„åˆ—è¡¨ï¼Œå¹¶ä¸”å°½é‡ä¿æŒç®€çŸ­ã€‚å¦‚æœåˆ—è¡¨æ¨å¯¼çš„ä»£ç è¶…è¿‡äº†ä¸¤è¡Œï¼Œä½ å¯èƒ½å°±è¦è€ƒè™‘æ˜¯ä¸æ˜¯å¾—ç”¨ for å¾ªç¯é‡å†™äº†ã€‚åœ¨ Python 3 ä¸­éƒ½æœ‰äº†è‡ªå·±çš„å±€éƒ¨ä½œç”¨åŸŸï¼Œå°±åƒå‡½æ•°ä¼¼çš„ã€‚è¡¨è¾¾å¼å†…éƒ¨çš„å˜é‡å’Œèµ‹å€¼åªåœ¨å±€éƒ¨èµ·ä½œç”¨ï¼Œè¡¨è¾¾å¼çš„ä¸Šä¸‹æ–‡é‡Œçš„åŒåå˜é‡è¿˜å¯ä»¥è¢«æ­£å¸¸å¼•ç”¨ï¼Œå±€éƒ¨å˜é‡å¹¶ä¸ä¼šå½±å“åˆ°å®ƒä»¬ã€‚åˆ—è¡¨æ¨å¯¼å¯ä»¥å¸®åŠ©æˆ‘ä»¬æŠŠä¸€ä¸ªåºåˆ—æˆ–æ˜¯å…¶ä»–å¯è¿­ä»£ç±»å‹ä¸­çš„å…ƒç´ è¿‡æ»¤æˆ–æ˜¯åŠ å·¥ï¼Œç„¶åå†æ–°å»ºä¸€ä¸ªåˆ—è¡¨ã€‚åˆ—è¡¨æ¨å¯¼çš„ä½œç”¨åªæœ‰ä¸€ä¸ªï¼šç”Ÿæˆåˆ—è¡¨ã€‚å¦‚æœæƒ³ç”Ÿæˆå…¶ä»–ç±»å‹çš„åºåˆ—ï¼Œç”Ÿæˆå™¨è¡¨è¾¾å¼å°±æ´¾ä¸Šäº†ç”¨åœºã€‚1234567891011121314151617181920&gt;&gt;&gt; numbers = [4, 2, 1, 6, 9, 7]&gt;&gt;&gt; def square(x):...     return x*x...&gt;&gt;&gt; list(map(square, numbers))[16, 4, 1, 36, 81, 49]&gt;&gt;&gt; [square(x) for x in numbers][16, 4, 1, 36, 81, 49]# ä½¿ç”¨map()å’Œåˆ—è¡¨æ¨å¯¼çš„ä¸¤ç§æ–¹æ³•éƒ½è¿”å›ç›¸åŒçš„å€¼ï¼Œä½†åˆ—è¡¨æ¨å¯¼æ›´å®¹æ˜“é˜…è¯»å’Œç†è§£ã€‚&gt;&gt;&gt; def is_odd(x):...    return bool(x % 2)...&gt;&gt;&gt; list(filter(is_odd, numbers))[1, 9, 7]&gt;&gt;&gt; [x for x in numbers if is_odd(x)][1, 9, 7]# ï¼Œfilterå’Œåˆ—è¡¨æ¨å¯¼æ–¹æ³•è¿”å›ç›¸åŒçš„å€¼ï¼Œä½†åˆ—è¡¨æ¨å¯¼æ›´å®¹æ˜“ç†è§£ã€‚12345# åˆ—è¡¨æ¨å¯¼ä¹Ÿæ”¯æŒå¤šä¸ªifæ¡ä»¶ã€‚å¤„åœ¨åŒ-å¾ªç¯çº§åˆ«ä¸­çš„å¤šé¡¹æ¡ä»¶ï¼Œå½¼æ­¤ä¹‹é—´é»˜è®¤å½¢æˆandè¡¨è¾¾å¼ã€‚# ä¾‹å¦‚ï¼Œè¦ä»æ•°å­—åˆ—è¡¨ä¸­é€‰å‡ºå¤§äº4çš„å¶æ•°ï¼Œé‚£ä¹ˆä¸‹é¢è¿™ä¸¤ç§åˆ—è¡¨æ¨å¯¼æ–¹å¼æ˜¯ç­‰æ•ˆçš„ã€‚a = [i for i in range(10)]b = [x for x in a if x&gt;4 if x%2==0]c = [x for x in a if x&gt;4 and x%2==0]ç”Ÿæˆå™¨è¡¨è¾¾å¼ç”Ÿæˆå™¨è¡¨è¾¾å¼èƒŒåéµå®ˆäº†è¿­ä»£å™¨åè®®ï¼Œå¯ä»¥é€ä¸ªåœ°äº§å‡ºå…ƒç´ ï¼Œè€Œä¸æ˜¯å…ˆå»ºç«‹ä¸€ä¸ªå®Œæ•´çš„åˆ—è¡¨ï¼Œç„¶åå†æŠŠè¿™ä¸ªåˆ—è¡¨ä¼ é€’åˆ°æŸä¸ªæ„é€ å‡½æ•°é‡Œã€‚ç”Ÿæˆå™¨è¡¨è¾¾å¼çš„è¯­æ³•è·Ÿåˆ—è¡¨æ¨å¯¼å·®ä¸å¤šï¼Œåªä¸è¿‡æŠŠæ–¹æ‹¬å·æ¢æˆåœ†æ‹¬å·è€Œå·²ã€‚å¦‚æœç”Ÿæˆå™¨è¡¨è¾¾å¼æ˜¯ä¸€ä¸ªå‡½æ•°è°ƒç”¨è¿‡ç¨‹ä¸­çš„å”¯ä¸€å‚æ•°ï¼Œé‚£ä¹ˆä¸éœ€è¦é¢å¤–å†ç”¨æ‹¬å·æŠŠå®ƒå›´èµ·æ¥ã€‚ç”Ÿæˆå™¨è¡¨è¾¾å¼å°±å¯ä»¥å¸®å¿™çœæ‰è¿è¡Œ for å¾ªç¯çš„å¼€é”€123456789101112# å‰é¢æåˆ°ï¼Œåˆ—è¡¨æ¨å¯¼æ˜¯æ–¹ä¾¿çš„å·¥å…·ï¼Œä½†æœ‰æ—¶ä¼šå¯¼è‡´ä¸å¿…è¦çš„å†…å­˜ä½¿ç”¨ã€‚# é”™è¯¯æ–¹å¼&gt;&gt;&gt; sum([i * i for i in range(1, 1001)])333833500# æ­£ç¡®æ–¹å¼&gt;&gt;&gt; sum((i * i for i in range(1, 1001)))333833500# æ¢å‡ºæ‹¬å·ä¼šå°†åˆ—è¡¨æ¨å¯¼æ›´æ”¹ä¸ºç”Ÿæˆå™¨è¡¨è¾¾å¼ã€‚å½“ä½ çŸ¥é“è¦ä»åºåˆ—ä¸­æ£€ç´¢æ•°æ®ï¼Œä½†ä¸éœ€è¦åŒæ—¶è®¿é—®æ‰€æœ‰æ•°æ®çš„æ—¶å€™ï¼Œç”Ÿæˆå™¨è¡¨è¾¾å¼éå¸¸é€‚åˆã€‚ # ç”Ÿæˆå™¨è¡¨è¾¾å¼è¿”å›ç”Ÿæˆå™¨å¯¹è±¡ï¼Œè€Œä¸æ˜¯åˆ›å»ºåˆ—è¡¨ã€‚è¯¥å¯¹è±¡çŸ¥é“å®ƒåœ¨å½“å‰çŠ¶æ€ä¸­çš„ä½ç½®ï¼ˆä¾‹å¦‚ï¼Œi = 49ï¼‰å¹¶ä¸”ä»…åœ¨è¢«è¦æ±‚æ—¶è®¡ç®—ä¸‹ä¸€ä¸ªå€¼ã€‚ # å› æ­¤ï¼Œå½“sumé€šè¿‡é‡å¤è°ƒç”¨.__ next __()æ¥è¿­ä»£ç”Ÿæˆå™¨å¯¹è±¡æ—¶ï¼Œç”Ÿæˆå™¨æ£€æŸ¥iç­‰äºå¤šå°‘ï¼Œè®¡ç®—i * iï¼Œåœ¨å†…éƒ¨é€’å¢iï¼Œå¹¶å°†æ­£ç¡®çš„å€¼è¿”å›åˆ°sumã€‚è¯¥è®¾è®¡å…è®¸ç”Ÿæˆå™¨ç”¨äºå¤§é‡æ•°æ®åºåˆ—ï¼Œå› ä¸ºä¸€æ¬¡åªæœ‰ä¸€ä¸ªå…ƒç´ å­˜åœ¨äºå†…å­˜ä¸­ã€‚åˆ—è¡¨å±•å¹³ä¸€æ—¥ä¸€æŠ€ï¼šå¦‚ä½•æŠŠå¤šå±‚åµŒå¥—çš„åˆ—è¡¨å±•å¹³1234567891011def flat(deep_list, result):    for element in deep_list:        if isinstance(element, list):            flat(element, result)        else:            result.append(element)a = [1, 2, [3, 4, [5, 6, 7], 8], 9, [10, 11]]result = []flat(a, result)print(result)12345678910111213141516def list_flat(deep_list, ignore_types=(str, bytes)) -&gt; List:    &quot;&quot;&quot;    åˆ—è¡¨åµŒå¥—å±•å¹³ä¸ºä¸€ç»´åˆ—è¡¨    @param deep_list: åµŒå¥—åˆ—è¡¨    @param ignore_types: ä¸åšå±•å¹³çš„ç±»å‹    @rtype: ä¸€ç»´åˆ—è¡¨    &quot;&quot;&quot;    for element in deep_list:        if isinstance(element, list) and not isinstance(element, ignore_types):            yield from list_flat(element, ignore_types=ignore_types)        else:            yield elementa = [1, 2, [3, 4, [5, 6, 7], 8], 9, [10, 11]]result = [x for x in list_flat(a)]print(result)æ‰€ä»¥ï¼Œå½“ä»£ç è¿è¡Œåˆ°1[x for x in flat(a)]çš„æ—¶å€™ï¼Œæ¯ä¸€æ¬¡å¾ªç¯éƒ½ä¼šè¿›å…¥åˆ° flatç”Ÿæˆå™¨é‡Œé¢ã€‚åœ¨ flaté‡Œé¢ï¼Œå¯¹ä¼ å…¥çš„å‚æ•°ä½¿ç”¨forå¾ªç¯è¿›è¡Œè¿­ä»£ï¼Œå¦‚æœæ‹¿åˆ°çš„å…ƒç´ ä¸æ˜¯åˆ—è¡¨ï¼Œé‚£ä¹ˆå°±ç›´æ¥æŠ›å‡ºï¼Œé€åˆ°ä¸Šä¸€å±‚ã€‚å¦‚æœå½“å‰å·²ç»æ˜¯æœ€ä¸Šå±‚äº†ï¼Œé‚£ä¹ˆå°±å†ä¸€æ¬¡æŠ›å‡ºç»™å¤–é¢çš„åˆ—è¡¨æ¨å¯¼å¼ã€‚å¦‚æœå½“å‰å…ƒç´ æ˜¯åˆ—è¡¨ï¼Œé‚£ä¹ˆç»§ç»­ç”Ÿæˆä¸€ä¸ªç”Ÿæˆå™¨ï¼Œå¹¶å¯¹è¿™ä¸ªæ–°çš„ç”Ÿæˆå™¨è¿›è¡Œè¿­ä»£ï¼Œå¹¶æŠŠæ¯ä¸€ä¸ªç»“æœç»§ç»­å¾€ä¸Šå±‚æŠ›å‡ºã€‚æœ€ç»ˆï¼Œæ¯ä¸€ä¸ªæ•°å­—éƒ½ä¼šè¢«ä¸€å±‚ä¸€å±‚å¾€ä¸ŠæŠ›å‡ºç»™åˆ—è¡¨æ¨å¯¼å¼ï¼Œä»è€Œè·å¾—éœ€è¦çš„ç»“æœã€‚å­—å…¸å±•å¹³1234567891011nest_dict = {    'a': 1,    'b': {        'c': 2,        'd': 3,        'e': {'f': 4}    },    'g': {'h': 5},    'i': 6,    'j': {'k': {'l': {'m': 8}}}}ä½¿ç”¨yieldå…³é”®å­—æ¥å®ç°è¿™ä¸ªéœ€æ±‚ï¼Œåœ¨ä¸ç‚«æŠ€çš„æƒ…å†µä¸‹ï¼Œåªéœ€è¦8è¡Œä»£ç ã€‚åœ¨ç‚«æŠ€çš„æƒ…å†µä¸‹ï¼Œåªéœ€è¦3è¡Œä»£ç ã€‚è¦å¿«é€Ÿåœ°æŠŠè¿™ä¸ªåµŒå¥—å­—å…¸å‹æ‰ï¼Œæˆ‘ä»¬éœ€è¦ä»ä¸‹å‘ä¸Šæ¥å¤„ç†å­—æ®µã€‚ä¾‹å¦‚å¯¹äºb-&gt;e-&gt;f-&gt;4è¿™æ¡è·¯å¾„ï¼Œæˆ‘ä»¬é¦–å…ˆæŠŠæœ€é‡Œé¢çš„{'f': 4}è½¬æ¢ä¸ºä¸€ä¸ªå…ƒç»„('f', 4)ã€‚ç„¶åï¼ŒæŠŠè¿™ä¸ªå…ƒç»„å‘ä¸ŠæŠ›å‡ºï¼Œäºæ˜¯å¾—åˆ°äº†å…ƒç»„('e', ('f', 4))ã€‚æˆ‘ä»¬æŠŠ eæ‹¼æ¥åˆ°fçš„å‰é¢ï¼Œå˜ä¸ºï¼š('e_f', 4)ï¼Œç»§ç»­å¾€ä¸ŠæŠ›å‡ºï¼Œå¾—åˆ°('b', ('e_f', 4))ã€‚å†æŠŠbæ‹¼æ¥åˆ°e_fä¸Šé¢ï¼Œå¾—åˆ°('b_e_f', 4)ã€‚å®Œæˆä¸€æ¡çº¿è·¯çš„ç»„è£…ã€‚è¿™ä¸ªé€»è¾‘å¦‚æœä½¿ç”¨yieldå…³é”®å­—æ¥å®ç°ï¼Œå°±æ˜¯ï¼š12345678910111213def map_flat(deep_map, full_key: bool = True) -&gt; Dict:    &quot;&quot;&quot;    å­—å…¸åµŒå¥—å±•å¹³ä¸ºä¸€ç»´å­—å…¸    @param deep_map: åµŒå¥—å­—å…¸    @param full_key: æ˜¯å¦ä½¿ç”¨å®Œæ•´çš„key    @rtype: ä¸€ç»´å­—å…¸    &quot;&quot;&quot;    for key, value in deep_map.items():        if isinstance(value, dict):            for k, v in map_flat(value, full_key):                yield (f'{key}_{k}', v) if full_key else (k, v)        else:            yield key, value12345678910{k:v for k,v in map_flat(nest_dict)}{    'a': 1,    'b_c': 2,    'b_d': 3,    'b_e_f': 4,    'g_h': 5,    'i': 6,    'j_k_l_m': 8}é€šè¿‡ä½¿ç”¨ yieldå…³é”®å­—ï¼Œå­—å…¸çš„keyä¼šåƒæ˜¯åœ¨æµæ°´çº¿ä¸Šä¸€æ ·ï¼Œä¸€å±‚ä¸€å±‚ä»å†…å‘å¤–è¿›è¡Œç»„è£…ï¼Œä»è€Œå½¢æˆå®Œæ•´çš„è·¯å¾„ã€‚æ‰¾listçš„æœ€å€¼ç´¢å¼•12345def max_idx(lst):    return max(range(len(lst)), key=lst.__getitem__)max_idx([1,5,7,2,3])Out[62]: 2listå»é‡å¹¶ä¿ç•™é¡ºåº123456789from collections import OrderedDicta = ['heelo','world','world','a','hello']list(OrderedDict.fromkeys(a).keys())Out[65]: ['heelo', 'world', 'a', 'hello']a = ['hello','world','world','a','hello']list(OrderedDict.fromkeys(a).keys())Out[67]: ['hello', 'world', 'a']ä»£ç é‡Œé¢è°ƒç”¨ pipè¯´åˆ°å®‰è£… Python çš„ç¬¬ä¸‰æ–¹åº“ï¼Œä¼š Python çš„åŒå­¦éƒ½çŸ¥é“ï¼Œåœ¨ç»ˆç«¯ä½¿ç”¨pip install xxxå³å¯ã€‚é‚£ä¹ˆå¦‚æœæˆ‘æƒ³åœ¨ä»£ç é‡Œé¢å®‰è£…ç¬¬ä¸‰æ–¹åº“æ€ä¹ˆåŠå‘¢ï¼Ÿå¯èƒ½æœ‰äººæƒ³åˆ°ä½¿ç”¨ os æ¨¡å—ï¼š123import ospackage_name = 'requests'os.system(f'pip install {package_name}')è¿™ç§æ–¹æ³•ç¡®å®å¯è¡Œï¼Œå¹¶ä¸”å³ä½¿ä½ åœ¨è™šæ‹Ÿç¯å¢ƒä¸­ä½¿ç”¨è¿™ç§æ–¹å¼å®‰è£…ï¼Œä¹Ÿç¡®å®ä¸ä¼šå®‰è£…åˆ°ç³»ç»Ÿçš„ Python ç¯å¢ƒä¸­ã€‚ä½†æ˜¯è¿™ç§æ–¹å¼æ€»æ„Ÿè§‰æœ‰ç‚¹å¥‡æ€ªã€‚è€Œä¸”å¦‚æœè¿™ä¸ªpackage_nameå­—ç¬¦ä¸²ç»è¿‡ç²¾å¿ƒæ„é€ ï¼Œå¯ä»¥æ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ï¼Œä¾‹å¦‚ï¼š123import ospackage_name = 'requests &amp;&amp; rm -rf *'os.system(f'pip install {package_name}')ä¸ºäº†é˜²æ­¢è¿™ç§æƒ…å†µå‘ç”Ÿï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è°ƒç”¨pipè¿™ä¸ª Python åŒ…ï¼š12from pip._internal import mainmain.main(['install', 'ç¬¬ä¸‰æ–¹åº“å'])å‘½ä»¤è¡Œä¸‹é¢çš„å‚æ•°éƒ½å¯ä»¥é€šè¿‡è½¬æ¢ä¸ºåˆ—è¡¨çš„å½¢å¼æ‰§è¡Œï¼Œä¾‹å¦‚ï¼š123from pip._internal import mainmain.main(['install', '-r', 'requirements.txt'])ä½¿ç”¨f-Stringsæ ¼å¼åŒ–å­—ç¬¦ä¸²123456# f-stringsæ”¯æŒä½¿ç”¨å­—ç¬¦ä¸²æ ¼å¼åŒ–è¿·ä½ è¯­è¨€ï¼Œä»¥åŠå¼ºå¤§çš„å­—ç¬¦ä¸²æ’å€¼ã€‚è¿™äº›åŠŸèƒ½å…è®¸ä½ æ·»åŠ å˜é‡ç”šè‡³æœ‰æ•ˆçš„Pythonè¡¨è¾¾å¼ï¼Œå¹¶åœ¨æ·»åŠ åˆ°å­—ç¬¦ä¸²ä¹‹å‰åœ¨è¿è¡Œæ—¶å¯¹å®ƒä»¬è¿›è¡Œè¯„ä¼°ï¼š&gt;&gt;&gt; def get_name_and_decades(name, age):...     return f&quot;My name is {name} and I'm {age / 10:.5f} decades old.&quot;...&gt;&gt;&gt; get_name_and_decades(&quot;Maria&quot;, 31)My name is Maria and I'm 3.10000 decades old.é›†åˆè®ºé›†åˆçš„æœ¬è´¨æ˜¯è®¸å¤šå”¯ä¸€å¯¹è±¡çš„èšé›†ã€‚å› æ­¤ï¼Œé›†åˆå¯ä»¥ç”¨äºå»é‡é›†åˆä¸­çš„å…ƒç´ å¿…é¡»æ˜¯å¯æ•£åˆ—çš„ï¼Œset ç±»å‹æœ¬èº«æ˜¯ä¸å¯æ•£åˆ—çš„ï¼Œä½†æ˜¯ frozenset å¯ä»¥ã€‚å› æ­¤å¯ä»¥åˆ›å»ºä¸€ä¸ªåŒ…å«ä¸åŒ frozenset çš„ setã€‚ç»™å®šä¸¤ä¸ªé›†åˆ a å’Œ bï¼Œa | b è¿”å›çš„æ˜¯å®ƒä»¬çš„åˆé›†ï¼Œa &amp; b å¾—åˆ°çš„æ˜¯äº¤é›†ï¼Œè€Œ a - b å¾—åˆ°çš„æ˜¯å·®é›†ã€‚é™¤ç©ºé›†ä¹‹å¤–ï¼Œé›†åˆçš„å­—é¢é‡â€”â€”{1}ã€{1, 2}ï¼Œç­‰ç­‰â€”â€”çœ‹èµ·æ¥è·Ÿå®ƒçš„æ•°å­¦å½¢å¼ä¸€æ¨¡ä¸€æ ·ã€‚å¦‚æœæ˜¯ç©ºé›†ï¼Œé‚£ä¹ˆå¿…é¡»å†™æˆ set() çš„å½¢å¼ã€‚åœ¨ Python 3 é‡Œé¢ï¼Œé™¤äº†ç©ºé›†ï¼Œé›†åˆçš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼æ€»æ˜¯ä»¥ {...} çš„å½¢å¼å‡ºç°ã€‚åƒ {1, 2, 3} è¿™ç§å­—é¢é‡å¥æ³•ç›¸æ¯”äºæ„é€ æ–¹æ³•ï¼ˆset([1, 2, 3])ï¼‰è¦æ›´å¿«ä¸”æ›´æ˜“è¯»ã€‚åè€…çš„é€Ÿåº¦è¦æ…¢ä¸€äº›ï¼Œå› ä¸º Python å¿…é¡»å…ˆä» set è¿™ä¸ªåå­—æ¥æŸ¥è¯¢æ„é€ æ–¹æ³•ï¼Œç„¶åæ–°å»ºä¸€ä¸ªåˆ—è¡¨ï¼Œæœ€åå†æŠŠè¿™ä¸ªåˆ—è¡¨ä¼ å…¥åˆ°æ„é€ æ–¹æ³•é‡Œã€‚ä½†æ˜¯å¦‚æœæ˜¯åƒ {1, 2, 3} è¿™æ ·çš„å­—é¢é‡ï¼ŒPython ä¼šåˆ©ç”¨ä¸€ä¸ªä¸“é—¨çš„å«ä½œ BUILD_SET çš„å­—èŠ‚ç æ¥åˆ›å»ºé›†åˆã€‚æ•°å­¦ç¬¦å·pythonè¿ç®—ç¬¦æ–¹æ³•æè¿°setçš„å®ç°ä»¥åŠå¯¼è‡´çš„ç»“æœset å’Œ frozenset çš„å®ç°ä¹Ÿä¾èµ–æ•£åˆ—è¡¨ï¼Œä½†åœ¨å®ƒä»¬çš„æ•£åˆ—è¡¨é‡Œå­˜æ”¾çš„åªæœ‰å…ƒç´ çš„å¼•ç”¨ï¼ˆå°±åƒåœ¨å­—å…¸é‡Œåªå­˜æ”¾é”®è€Œæ²¡æœ‰ç›¸åº”çš„å€¼ï¼‰ã€‚åœ¨ set åŠ å…¥åˆ° Python ä¹‹å‰ï¼Œæˆ‘ä»¬éƒ½æ˜¯æŠŠå­—å…¸åŠ ä¸Šæ— æ„ä¹‰çš„å€¼å½“ä½œé›†åˆæ¥ç”¨çš„ã€‚è¿™äº›ç‰¹ç‚¹æ€»ç»“å¦‚ä¸‹ã€‚é›†åˆé‡Œçš„å…ƒç´ å¿…é¡»æ˜¯å¯æ•£åˆ—çš„ã€‚é›†åˆå¾ˆæ¶ˆè€—å†…å­˜ã€‚å¯ä»¥å¾ˆé«˜æ•ˆåœ°åˆ¤æ–­å…ƒç´ æ˜¯å¦å­˜åœ¨äºæŸä¸ªé›†åˆã€‚å…ƒç´ çš„æ¬¡åºå–å†³äºè¢«æ·»åŠ åˆ°é›†åˆé‡Œçš„æ¬¡åºã€‚å¾€é›†åˆé‡Œæ·»åŠ å…ƒç´ ï¼Œå¯èƒ½ä¼šæ”¹å˜é›†åˆé‡Œå·²æœ‰å…ƒç´ çš„æ¬¡åºã€‚1234567891011&gt;&gt;&gt; import random&gt;&gt;&gt; all_words = &quot;all the words in the world&quot;.split()&gt;&gt;&gt; def get_random_word():...    return random.choice(all_words)&gt;&gt;&gt; def get_unique_words():...     words = set()...     for _ in range(1000):...         words.add(get_random_word())...     return words&gt;&gt;&gt; get_unique_words(){'world', 'all', 'the', 'words'}ä½¿ç”¨å­—ç¬¦ä¸²å¸¸é‡è®¿é—®å…¬å…±å­—ç¬¦ä¸²ç»„12345678910111213141516171819202122232425# å¯ä»¥ä½¿ç”¨is_upper()ï¼Œå®ƒè¿”å›å­—ç¬¦ä¸²ä¸­çš„æ‰€æœ‰å­—ç¬¦æ˜¯å¦éƒ½æ˜¯å¤§å†™å­—æ¯ï¼š&gt;&gt;&gt; import string&gt;&gt;&gt; def is_upper(word):...     for letter in word:...         if letter not in string.ascii_uppercase:...             return False...     return True...&gt;&gt;&gt; is_upper('Thanks Geir')False&gt;&gt;&gt; is_upper('LOL')True# is_upper()è¿­ä»£wordä¸­çš„å­—æ¯ï¼Œå¹¶æ£€æŸ¥å­—æ¯æ˜¯å¦ä¸ºstring.ascii_å¤§å†™å­—æ¯çš„ä¸€éƒ¨åˆ†ã€‚å¦‚æœä½ æ‰“å°å‡ºstring.ascii_å¤§å†™ï¼Œä½ ä¼šå‘ç°å®ƒåªæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¯¥å€¼è®¾ç½®ä¸ºæ–‡æœ¬â€œABCDEFGHIJKLMNOPQRSTUVWXYZâ€ã€‚æ‰€æœ‰å­—ç¬¦ä¸²å¸¸é‡éƒ½åªæ˜¯ç»å¸¸å¼•ç”¨çš„å­—ç¬¦ä¸²å€¼çš„å­—ç¬¦ä¸²ã€‚å…¶ä¸­åŒ…æ‹¬ä»¥ä¸‹å†…å®¹ï¼šstring.ascii_lettersstring.ascii_uppercasestring.ascii_lowercasestring.digitsstring.hexdigitsstring.octdigitsstring.punctuationstring.printablestring.whitespaceä½¿ç”¨Itertoolsç”Ÿæˆæ’åˆ—å’Œç»„åˆ12345678910111213# itertools.permutations()æ„å»ºæ‰€æœ‰æ’åˆ—çš„åˆ—è¡¨ï¼Œè¿™æ„å‘³ç€å®ƒæ˜¯è¾“å…¥å€¼çš„æ¯ä¸ªå¯èƒ½åˆ†ç»„çš„åˆ—è¡¨ï¼Œå…¶é•¿åº¦ä¸countå‚æ•°åŒ¹é…ã€‚rå…³é”®å­—å‚æ•°å…è®¸æˆ‘ä»¬æŒ‡å®šæ¯ä¸ªåˆ†ç»„ä¸­æœ‰å¤šå°‘å€¼ï¼š&gt;&gt;&gt; import itertools&gt;&gt;&gt; friends = ['Monique', 'Ashish', 'Devon', 'Bernie']&gt;&gt;&gt; list(itertools.permutations(friends, r=2))[('Monique', 'Ashish'), ('Monique', 'Devon'), ('Monique', 'Bernie'),('Ashish', 'Monique'), ('Ashish', 'Devon'), ('Ashish', 'Bernie'),('Devon', 'Monique'), ('Devon', 'Ashish'), ('Devon', 'Bernie'),('Bernie', 'Monique'), ('Bernie', 'Ashish'), ('Bernie', 'Devon')]# itertools.combinations()ç”Ÿæˆç»„åˆã€‚è¿™äº›ä¹Ÿæ˜¯è¾“å…¥å€¼çš„å¯èƒ½åˆ†ç»„ï¼Œä½†ç°åœ¨å€¼çš„é¡ºåºæ— å…³ç´§è¦ã€‚&gt;&gt;&gt; list(itertools.combinations(friends, r=2))[('Monique', 'Ashish'), ('Monique', 'Devon'), ('Monique', 'Bernie'),('Ashish', 'Devon'), ('Ashish', 'Bernie'), ('Devon', 'Bernie')]æ¼‚äº®çš„æ‰“å°å‡ºJSON123456789101112131415161718192021&gt;&gt;&gt; import json&gt;&gt;&gt; print(json.dumps(data))  # No indention{&quot;status&quot;: &quot;OK&quot;, &quot;count&quot;: 2, &quot;results&quot;: [{&quot;age&quot;: 27, &quot;name&quot;: &quot;Oz&quot;, &quot;lactose_intolerant&quot;: true}, {&quot;age&quot;: 29, &quot;name&quot;: &quot;Joe&quot;, &quot;lactose_intolerant&quot;: false}]}&gt;&gt;&gt; print(json.dumps(data, indent=2))  # With indention{  &quot;status&quot;: &quot;OK&quot;,  &quot;count&quot;: 2,  &quot;results&quot;: [    {      &quot;age&quot;: 27,      &quot;name&quot;: &quot;Oz&quot;,      &quot;lactose_intolerant&quot;: true    },    {      &quot;age&quot;: 29,      &quot;name&quot;: &quot;Joe&quot;,      &quot;lactose_intolerant&quot;: false    }  ]}withä¸Šä¸‹æ–‡ç®¡ç†withæ¨¡å—with è¯­å¥ä¼šè®¾ç½®ä¸€ä¸ªä¸´æ—¶çš„ä¸Šä¸‹æ–‡ï¼Œäº¤ç»™ä¸Šä¸‹æ–‡ç®¡ç†å™¨å¯¹è±¡æ§åˆ¶ï¼Œå¹¶ä¸”è´Ÿè´£æ¸…ç†ä¸Šä¸‹æ–‡ã€‚è¿™ä¹ˆåšèƒ½é¿å…é”™è¯¯å¹¶å‡å°‘æ ·æ¿ä»£ç ï¼Œå› æ­¤ API æ›´å®‰å…¨ï¼Œè€Œä¸”æ›´æ˜“äºä½¿ç”¨ã€‚ä¸Šä¸‹æ–‡ç®¡ç†å™¨å¯¹è±¡å­˜åœ¨çš„ç›®çš„æ˜¯ç®¡ç† with è¯­å¥ï¼Œå°±åƒè¿­ä»£å™¨çš„å­˜åœ¨æ˜¯ä¸ºäº†ç®¡ç† for è¯­å¥ä¸€æ ·ã€‚with è¯­å¥çš„ç›®çš„æ˜¯ç®€åŒ– try/finally æ¨¡å¼ã€‚finally å­å¥ä¸­çš„ä»£ç é€šå¸¸ç”¨äºé‡Šæ”¾é‡è¦çš„èµ„æºï¼Œæˆ–è€…è¿˜åŸä¸´æ—¶å˜æ›´çš„çŠ¶æ€ã€‚ä¸Šä¸‹æ–‡ç®¡ç†å™¨åè®®åŒ…å« __enter__ å’Œ __exit__ ä¸¤ä¸ªæ–¹æ³•ã€‚with è¯­å¥å¼€å§‹è¿è¡Œæ—¶ï¼Œä¼šåœ¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨å¯¹è±¡ä¸Šè°ƒç”¨__enter__ æ–¹æ³•ã€‚with è¯­å¥è¿è¡Œç»“æŸåï¼Œä¼šåœ¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨å¯¹è±¡ä¸Šè°ƒç”¨__exit__æ–¹æ³•ï¼Œä»¥æ­¤æ‰®æ¼” finally å­å¥çš„è§’è‰²ã€‚withçš„è¡Œä¸ºæ‰§è¡Œ with åé¢çš„è¡¨è¾¾å¼å¾—åˆ°çš„ç»“æœæ˜¯ä¸Šä¸‹æ–‡ç®¡ç†å™¨å¯¹è±¡ï¼Œä¸è¿‡ï¼ŒæŠŠå€¼ç»‘å®šåˆ°ç›®æ ‡å˜é‡ä¸Šï¼ˆas å­å¥ï¼‰æ˜¯åœ¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨å¯¹è±¡ä¸Šè°ƒç”¨ __enter__ æ–¹æ³•çš„ç»“æœã€‚__enter__ æ–¹æ³•é™¤äº†è¿”å›ä¸Šä¸‹æ–‡ç®¡ç†å™¨ä¹‹å¤–ï¼Œè¿˜å¯èƒ½è¿”å›å…¶ä»–å¯¹è±¡ã€‚ä¸ç®¡æ§åˆ¶æµç¨‹ä»¥å“ªç§æ–¹å¼é€€å‡º with å—ï¼Œéƒ½ä¼šåœ¨ä¸Šä¸‹æ–‡ç®¡ç†å™¨å¯¹è±¡ä¸Šè°ƒç”¨ __exit__ æ–¹æ³•ï¼Œè€Œä¸æ˜¯åœ¨ __enter__ æ–¹æ³•è¿”å›çš„å¯¹è±¡ä¸Šè°ƒç”¨ã€‚with è¯­å¥çš„ as å­å¥æ˜¯å¯é€‰çš„ã€‚å¯¹ open å‡½æ•°æ¥è¯´ï¼Œå¿…é¡»åŠ ä¸Š as å­å¥ï¼Œä»¥ä¾¿è·å–æ–‡ä»¶çš„å¼•ç”¨ã€‚å¦‚æœ `__exit__` æ–¹æ³•è¿”å› `None`ï¼Œæˆ–è€… `True` ä¹‹å¤–çš„å€¼ï¼Œ`with` å—ä¸­çš„ä»»ä½•å¼‚å¸¸éƒ½ä¼šå‘ä¸Šå†’æ³¡ã€‚è§£é‡Šå™¨è°ƒç”¨ __enter__ æ–¹æ³•æ—¶ï¼Œé™¤äº†éšå¼çš„ self ä¹‹å¤–ï¼Œä¸ä¼šä¼ å…¥ä»»ä½•å‚æ•°ã€‚ä¼ ç»™ __exit__ æ–¹æ³•çš„ä¸‰ä¸ªå‚æ•°åˆ—ä¸¾å¦‚ä¸‹ã€‚1exc_typeã€€ã€€å¼‚å¸¸ç±»ï¼ˆä¾‹å¦‚ ZeroDivisionErrorï¼‰ã€‚1exc_valueã€€ã€€å¼‚å¸¸å®ä¾‹ã€‚æœ‰æ—¶ä¼šæœ‰å‚æ•°ä¼ ç»™å¼‚å¸¸æ„é€ æ–¹æ³•ï¼Œä¾‹å¦‚é”™è¯¯æ¶ˆæ¯ï¼Œè¿™äº›å‚æ•°å¯ä»¥ä½¿ç”¨ exc_value.args è·å–ã€‚1tracebackã€€ã€€traceback å¯¹è±¡ã€‚å¯ä»¥æ‰‹åŠ¨è°ƒç”¨ `__enter__` å’Œ `__exit__` æ–¹æ³•ã€‚with ä¸ä»…èƒ½ç®¡ç†èµ„æºï¼Œè¿˜èƒ½ç”¨äºå»æ‰å¸¸è§„çš„è®¾ç½®å’Œæ¸…ç†ä»£ç ï¼Œæˆ–è€…åœ¨å¦ä¸€ä¸ªè¿‡ç¨‹å‰åæ‰§è¡Œçš„æ“ä½œ123456with allocate_resource() as resource:    resource.use()# æ‰“å¼€/å…³é—­æ–‡ä»¶with open('data.txt') as f:    data = f.read()ä¸Šä¸‹æ–‡è£…é¥°å™¨contextlib æ¨¡å—ä¸­çš„å®ç”¨å·¥å…·closing: å¦‚æœå¯¹è±¡æä¾›äº† close() æ–¹æ³•ï¼Œä½†æ²¡æœ‰å®ç° __enter__/__exit__ åè®®ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨è¿™ä¸ªå‡½æ•°æ„å»ºä¸Šä¸‹æ–‡ç®¡ç†å™¨ã€‚suppress: æ„å»ºä¸´æ—¶å¿½ç•¥æŒ‡å®šå¼‚å¸¸çš„ä¸Šä¸‹æ–‡ç®¡ç†å™¨ã€‚@contextmanager: è¿™ä¸ªè£…é¥°å™¨æŠŠç®€å•çš„ç”Ÿæˆå™¨å‡½æ•°å˜æˆä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼Œè¿™æ ·å°±ä¸ç”¨åˆ›å»ºç±»å»å®ç°ç®¡ç†å™¨åè®®äº†ã€‚ContextDecorator: è¿™æ˜¯ä¸ªåŸºç±»ï¼Œç”¨äºå®šä¹‰åŸºäºç±»çš„ä¸Šä¸‹æ–‡ç®¡ç†å™¨ã€‚è¿™ç§ä¸Šä¸‹æ–‡ç®¡ç†å™¨ä¹Ÿèƒ½ç”¨äºè£…é¥°å‡½æ•°ï¼Œåœ¨å—ç®¡ç†çš„ä¸Šä¸‹æ–‡ä¸­è¿è¡Œæ•´ä¸ªå‡½æ•°ã€‚ExitStack: è¿™ä¸ªä¸Šä¸‹æ–‡ç®¡ç†å™¨èƒ½è¿›å…¥å¤šä¸ªä¸Šä¸‹æ–‡ç®¡ç†å™¨ã€‚with å—ç»“æŸæ—¶ï¼ŒExitStack æŒ‰ç…§åè¿›å…ˆå‡ºçš„é¡ºåºè°ƒç”¨æ ˆä¸­å„ä¸ªä¸Šä¸‹æ–‡ç®¡ç†å™¨çš„ __exit__ æ–¹æ³•ã€‚å¦‚æœäº‹å…ˆä¸çŸ¥é“ with å—è¦è¿›å…¥å¤šå°‘ä¸ªä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªç±»ã€‚ä¾‹å¦‚ï¼ŒåŒæ—¶æ‰“å¼€ä»»æ„ä¸€ä¸ªæ–‡ä»¶åˆ—è¡¨ä¸­çš„æ‰€æœ‰æ–‡ä»¶ã€‚æ˜¾ç„¶ï¼Œåœ¨è¿™äº›å®ç”¨å·¥å…·ä¸­ï¼Œä½¿ç”¨æœ€å¹¿æ³›çš„æ˜¯ @contextmanager è£…é¥°å™¨ï¼Œå› æ­¤è¦æ ¼å¤–ç•™å¿ƒã€‚è¿™ä¸ªè£…é¥°å™¨ä¹Ÿæœ‰è¿·æƒ‘äººçš„ä¸€é¢ï¼Œå› ä¸ºå®ƒä¸è¿­ä»£æ— å…³ï¼Œå´è¦ä½¿ç”¨ yield è¯­å¥ã€‚é‡ç‚¹ä»‹ç»ä¸‹**@contextmanager**@contextmanager è£…é¥°å™¨èƒ½å‡å°‘åˆ›å»ºä¸Šä¸‹æ–‡ç®¡ç†å™¨çš„æ ·æ¿ä»£ç é‡ï¼Œå› ä¸ºä¸ç”¨ç¼–å†™ä¸€ä¸ªå®Œæ•´çš„ç±»ï¼Œå®šä¹‰ __enter__ å’Œ __exit__ æ–¹æ³•ï¼Œè€Œåªéœ€å®ç°æœ‰ä¸€ä¸ª yield è¯­å¥çš„ç”Ÿæˆå™¨ï¼Œç”Ÿæˆæƒ³è®© __enter__ æ–¹æ³•è¿”å›çš„å€¼ã€‚åœ¨ä½¿ç”¨ @contextmanager è£…é¥°çš„ç”Ÿæˆå™¨ä¸­ï¼Œyield è¯­å¥çš„ä½œç”¨æ˜¯æŠŠå‡½æ•°çš„å®šä¹‰ä½“åˆ†æˆä¸¤éƒ¨åˆ†ï¼šyield è¯­å¥å‰é¢çš„æ‰€æœ‰ä»£ç åœ¨ with å—å¼€å§‹æ—¶ï¼ˆå³è§£é‡Šå™¨è°ƒç”¨ __enter__ æ–¹æ³•æ—¶ï¼‰æ‰§è¡Œï¼Œ yield è¯­å¥åé¢çš„ä»£ç åœ¨ with å—ç»“æŸæ—¶ï¼ˆå³è°ƒç”¨ __exit__ æ–¹æ³•æ—¶ï¼‰æ‰§è¡Œã€‚123456789101112import contextlib@contextlib.contextmanager  âŠdef looking_glass():    import sys    original_write = sys.stdout.write  â‹    def reverse_write(text):  âŒ        original_write(text[::-1])    sys.stdout.write = reverse_write  â    yield 'JABBERWOCKY'  â    sys.stdout.write = original_write  â # è¿™é‡Œç›¸å½“äº__exit__è¿™ä¸ªç±»çš„ __enter__ æ–¹æ³•æœ‰å¦‚ä¸‹ä½œç”¨ã€‚(1) è°ƒç”¨ç”Ÿæˆå™¨å‡½æ•°ï¼Œä¿å­˜ç”Ÿæˆå™¨å¯¹è±¡ï¼ˆè¿™é‡ŒæŠŠå®ƒç§°ä¸º genï¼‰ã€‚(2) è°ƒç”¨ next(gen)ï¼Œæ‰§è¡Œåˆ° yield å…³é”®å­—æ‰€åœ¨çš„ä½ç½®ã€‚(3) è¿”å› next(gen) äº§å‡ºçš„å€¼ï¼Œä»¥ä¾¿æŠŠäº§å‡ºçš„å€¼ç»‘å®šåˆ° with/as è¯­å¥ä¸­çš„ç›®æ ‡å˜é‡ä¸Šã€‚with å—ç»ˆæ­¢æ—¶ï¼Œ`__exit__` æ–¹æ³•ä¼šåšä»¥ä¸‹å‡ ä»¶äº‹ï¼šæ£€æŸ¥æœ‰æ²¡æœ‰æŠŠå¼‚å¸¸ä¼ ç»™ exc_typeï¼›å¦‚æœæœ‰ï¼Œè°ƒç”¨ gen.throw(exception)ï¼Œåœ¨ç”Ÿæˆå™¨å‡½æ•°å®šä¹‰ä½“ä¸­åŒ…å« yield å…³é”®å­—çš„é‚£ä¸€è¡ŒæŠ›å‡ºå¼‚å¸¸ã€‚å¦åˆ™ï¼Œè°ƒç”¨ next(gen)ï¼Œç»§ç»­æ‰§è¡Œç”Ÿæˆå™¨å‡½æ•°å®šä¹‰ä½“ä¸­ yield è¯­å¥ä¹‹åçš„ä»£ç ã€‚ä¸Šæ–‡ç¤ºä¾‹æœ‰ä¸€ä¸ªä¸¥é‡çš„é”™è¯¯ï¼šå¦‚æœåœ¨ with å—ä¸­æŠ›å‡ºäº†å¼‚å¸¸ï¼ŒPython è§£é‡Šå™¨ä¼šå°†å…¶æ•è·ï¼Œç„¶ååœ¨ looking_glass å‡½æ•°çš„ yield è¡¨è¾¾å¼é‡Œå†æ¬¡æŠ›å‡ºã€‚ä½†æ˜¯ï¼Œé‚£é‡Œæ²¡æœ‰å¤„ç†é”™è¯¯çš„ä»£ç ï¼Œå› æ­¤ looking_glass å‡½æ•°ä¼šä¸­æ­¢ï¼Œæ°¸è¿œæ— æ³•æ¢å¤æˆåŸæ¥çš„ sys.stdout.write æ–¹æ³•ï¼Œå¯¼è‡´ç³»ç»Ÿå¤„äºæ— æ•ˆçŠ¶æ€ã€‚ä»¥ä¸‹ä»£ç æ˜¯åŸºäºç”Ÿæˆå™¨çš„ä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼Œè€Œä¸”å®ç°äº†å¼‚å¸¸å¤„ç†â€”â€”ä»å¤–éƒ¨çœ‹ï¼Œè¡Œä¸ºä¸å‰æ–‡ä¸€æ ·1234567891011121314151617181920import contextlib@contextlib.contextmanagerdef looking_glass():    import sys    original_write = sys.stdout.write    def reverse_write(text):        original_write(text[::-1])    sys.stdout.write = reverse_write    msg = ''  âŠ    try:        yield 'JABBERWOCKY'    except ZeroDivisionError:  â‹        msg = 'Please DO NOT divide by zero!'    finally:        sys.stdout.write = original_write  âŒ        if msg:            print(msg)  âå‰é¢è¯´è¿‡ï¼Œä¸ºäº†å‘Šè¯‰è§£é‡Šå™¨å¼‚å¸¸å·²ç»å¤„ç†äº†ï¼Œ__exit__ æ–¹æ³•ä¼šè¿”å› Trueï¼Œæ­¤æ—¶è§£é‡Šå™¨ä¼šå‹åˆ¶å¼‚å¸¸ã€‚å¦‚æœ __exit__ æ–¹æ³•æ²¡æœ‰æ˜¾å¼è¿”å›ä¸€ä¸ªå€¼ï¼Œé‚£ä¹ˆè§£é‡Šå™¨å¾—åˆ°çš„æ˜¯ Noneï¼Œç„¶åå‘ä¸Šå†’æ³¡å¼‚å¸¸ã€‚ä½¿ç”¨ @contextmanager è£…é¥°å™¨æ—¶ï¼Œé»˜è®¤çš„è¡Œä¸ºæ˜¯ç›¸åçš„ï¼šè£…é¥°å™¨æä¾›çš„__exit__ æ–¹æ³•å‡å®šå‘ç»™ç”Ÿæˆå™¨çš„æ‰€æœ‰å¼‚å¸¸éƒ½å¾—åˆ°å¤„ç†äº†ï¼Œå› æ­¤åº”è¯¥å‹åˆ¶å¼‚å¸¸ã€‚6 å¦‚æœä¸æƒ³è®© @contextmanager å‹åˆ¶å¼‚å¸¸ï¼Œå¿…é¡»åœ¨è¢«è£…é¥°çš„å‡½æ•°ä¸­æ˜¾å¼é‡æ–°æŠ›å‡ºå¼‚å¸¸ã€‚åœ¨ @contextmanager è£…é¥°å™¨è£…é¥°çš„ç”Ÿæˆå™¨ä¸­ï¼Œyield ä¸è¿­ä»£æ²¡æœ‰ä»»ä½•å…³ç³»ã€‚@contextmanager è£…é¥°å™¨èƒ½æŠŠåŒ…å«ä¸€ä¸ª yield è¯­å¥çš„ç®€å•ç”Ÿæˆå™¨å˜æˆä¸Šä¸‹æ–‡ç®¡ç†å™¨â€”â€”è¿™æ¯”å®šä¹‰ä¸€ä¸ªè‡³å°‘åŒ…å«ä¸¤ä¸ªæ–¹æ³•çš„ç±»è¦æ›´ç®€æ´ã€‚for/elseå—`else` å­å¥ä¸ä»…èƒ½åœ¨ if è¯­å¥ä¸­ä½¿ç”¨ï¼Œè¿˜èƒ½åœ¨ forã€while å’Œ try è¯­å¥ä¸­ä½¿ç”¨ã€‚`for/else`ã€`while/else` å’Œ `try/else` çš„è¯­ä¹‰å…³ç³»ç´§å¯†ï¼Œä¸è¿‡ä¸ `if/else` å·®åˆ«å¾ˆå¤§ã€‚åœ¨å¾ªç¯ä¸­ï¼Œelse çš„è¯­ä¹‰æ°å¥½ç›¸åï¼šâ€œè¿è¡Œè¿™ä¸ªå¾ªç¯ï¼Œç„¶ååšé‚£ä»¶äº‹ã€‚â€else å­å¥çš„è¡Œä¸ºå¦‚ä¸‹ã€‚for: ä»…å½“ for å¾ªç¯è¿è¡Œå®Œæ¯•æ—¶ï¼ˆå³ for å¾ªç¯æ²¡æœ‰è¢« break è¯­å¥ä¸­æ­¢ï¼‰æ‰è¿è¡Œ else å—ã€‚while: ä»…å½“ while å¾ªç¯å› ä¸ºæ¡ä»¶ä¸ºå‡å€¼è€Œé€€å‡ºæ—¶ï¼ˆå³ while å¾ªç¯æ²¡æœ‰è¢« break è¯­å¥ä¸­æ­¢ï¼‰æ‰è¿è¡Œ else å—ã€‚try: ä»…å½“ try å—ä¸­æ²¡æœ‰å¼‚å¸¸æŠ›å‡ºæ—¶æ‰è¿è¡Œ else å—ã€‚å®˜æ–¹æ–‡æ¡£è¿˜æŒ‡å‡ºï¼šâ€œelse å­å¥æŠ›å‡ºçš„å¼‚å¸¸ä¸ä¼šç”±å‰é¢çš„ except å­å¥å¤„ç†ã€‚â€åœ¨æ‰€æœ‰æƒ…å†µä¸‹ï¼Œå¦‚æœå¼‚å¸¸æˆ–è€… returnã€break æˆ– continue è¯­å¥å¯¼è‡´æ§åˆ¶æƒè·³åˆ°äº†å¤åˆè¯­å¥çš„ä¸»å—ä¹‹å¤–ï¼Œelse å­å¥ä¹Ÿä¼šè¢«è·³è¿‡ã€‚åœ¨è¿™äº›è¯­å¥ä¸­ä½¿ç”¨ else å­å¥é€šå¸¸èƒ½è®©ä»£ç æ›´æ˜“äºé˜…è¯»ï¼Œè€Œä¸”èƒ½çœå»ä¸€äº›éº»çƒ¦ï¼Œä¸ç”¨è®¾ç½®æ§åˆ¶æ ‡å¿—æˆ–è€…æ·»åŠ é¢å¤–çš„ if è¯­å¥ã€‚12345678# for else æ˜¯ Python ä¸­ç‰¹æœ‰çš„è¯­æ³•æ ¼å¼ï¼Œelse ä¸­çš„ä»£ç åœ¨ for å¾ªç¯éå†å®Œæ‰€æœ‰å…ƒç´ ä¹‹åæ‰§è¡Œ# å¦‚æœforå¾ªç¯æ­£å¸¸ç»“æŸï¼Œelseä¸­è¯­å¥æ‰§è¡Œã€‚å¦‚æœæ˜¯breakçš„ï¼Œåˆ™ä¸æ‰§è¡Œã€‚for i in mylist:    if i == theflag:break    process(i)else:    raise ValueError(&quot;List argument missing terminal flag.&quot;)12345678# æ–¹å¼ä¸€flag = Falsefor x in xx:if some condition:flag = Truebreakif flag:print 'no break'123456# æ–¹å¼äºŒfor x in xx:if some condition:breakelse:print 'no break'1234567891011121314151617181920212223242526# åˆ¤æ–­è´¨æ•°/ç´ æ•°â€”â€”æˆ‘çŸ¥é“çš„æœ€å¿«çš„æ–¹æ³•# https://blog.csdn.net/songyunli1111/article/details/78690447# Exampledef is_prime(n = 20):    is_p = False    for ii in range(2 if n&gt;=2 else 1, int(math.sqrt(n))+1):        if n%ii == 0:            break    else:        is_p = True    return is_p# æˆ–è€…ç›´æ¥å†™æˆdef is_prime(n = 20):    for ii in range(2 if n&gt;=2 else 1, int(math.sqrt(n))+1):        if n%ii == 0:            return False    else:        return True# è·å–n=50ä»¥å†…çš„ç´ æ•°åˆ—è¡¨import mathn = 50data = [ii for ii in range(n)]res = itertools.compress(data,[is_prime(da) for da in data])print([r for r in res])Out[30]: [0, 2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47]åˆç†ä½¿ç”¨åˆ—è¡¨123456from collections import dequenames = deque(['raymond', 'rachel', 'matthew', 'roger',               'betty', 'melissa', 'judith', 'charlie'])names.popleft()               Out[10]: 'raymond'åˆ—è¡¨å¯¹è±¡ï¼ˆlistï¼‰æ˜¯ä¸€ä¸ªæŸ¥è¯¢æ•ˆç‡é«˜äºæ›´æ–°æ“ä½œçš„æ•°æ®ç»“æ„ï¼Œåˆ é™¤å’Œæ’å…¥éœ€è¦å¯¹å‰©ä¸‹çš„å…ƒç´ åšç§»åŠ¨æ“ä½œdeque æ˜¯ä¸€ä¸ªåŒå‘é˜Ÿåˆ—çš„æ•°æ®ç»“æ„ï¼Œåˆ é™¤å…ƒç´ å’Œæ’å…¥å…ƒç´ ä¼šå¾ˆå¿«åºåˆ—è§£åŒ…å…ƒç»„æ‹†åŒ…å¯ä»¥åº”ç”¨åˆ°ä»»ä½•å¯è¿­ä»£å¯¹è±¡ä¸Šï¼Œå”¯ä¸€çš„ç¡¬æ€§è¦æ±‚æ˜¯ï¼Œè¢«å¯è¿­ä»£å¯¹è±¡ä¸­çš„å…ƒç´ æ•°é‡å¿…é¡»è¦è·Ÿæ¥å—è¿™äº›å…ƒç´ çš„å…ƒç»„çš„ç©ºæ¡£æ•°ä¸€è‡´ã€‚é™¤éæˆ‘ä»¬ç”¨ * æ¥è¡¨ç¤ºå¿½ç•¥å¤šä½™çš„å…ƒç´ ã€‚os.path.split() å‡½æ•°å°±ä¼šè¿”å›ä»¥è·¯å¾„å’Œæœ€åä¸€ä¸ªæ–‡ä»¶åç»„æˆçš„å…ƒç»„ (path, last_part)åœ¨å¹³è¡Œèµ‹å€¼ä¸­ï¼Œ* å‰ç¼€åªèƒ½ç”¨åœ¨ä¸€ä¸ªå˜é‡åå‰é¢ï¼Œä½†æ˜¯è¿™ä¸ªå˜é‡å¯ä»¥å‡ºç°åœ¨èµ‹å€¼è¡¨è¾¾å¼çš„ä»»æ„ä½ç½®123456789101112p = 'vttalk', 'female', 30, 'python@qq.com'name, gender, age, email = pname, gender, age, emailOut[13]: ('vttalk', 'female', 30, 'python@qq.com')    num_list = [100, 19, 20, 98]first, *left_num_list, last = num_listprint(first, left_num_list, last)Out[14]: 100 [19, 20] 98    string = 'xuexiao 4 fuzhou daxue'tag,start_index,value = string.split(' ',2)é“¾å¼æ¯”è¾ƒæ“ä½œ12if 18 &lt; age &lt; 60:    print(&quot;yong man&quot;)assertç”¨æ³•1234&gt;&gt;&gt; assert mul(2, 3) == 7, 'This statement is wrong!!!!!!'Traceback (most recent call last):  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;AssertionError: This statement is wrong!!!!!!slotsä¼˜åŒ–å†…å­˜ä½¿ç”¨slotsä½¿ç”¨äº†100Må†…å­˜ï¼Œæ¯”ä½¿ç”¨dictå­˜å‚¨å±æ€§å€¼èŠ‚çœäº†2å€ã€‚å…¶å®ä½¿ç”¨collectionæ¨¡å—çš„namedtupleä¹Ÿå¯ä»¥å®ç°slotsç›¸åŒçš„åŠŸèƒ½ã€‚namedtupleå…¶å®å°±æ˜¯ç»§æ‰¿è‡ªtupleï¼ŒåŒæ—¶ä¹Ÿå› ä¸ºslotsçš„å€¼è¢«è®¾ç½®æˆäº†ä¸€ä¸ªç©ºtupleä»¥é¿å…åˆ›å»ºdictcollection å’Œæ™®é€šåˆ›å»ºç±»æ–¹å¼ç›¸æ¯”ï¼Œä¹ŸèŠ‚çœäº†ä¸å°‘çš„å†…å­˜ã€‚æ‰€åœ¨åœ¨ç¡®å®šç±»çš„å±æ€§å€¼å›ºå®šçš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨slotsæ–¹å¼å¯¹å†…å­˜è¿›è¡Œä¼˜åŒ–ã€‚ä½†æ˜¯è¿™é¡¹æŠ€æœ¯ä¸åº”è¯¥è¢«æ»¥ç”¨äºé™æ€ç±»æˆ–è€…å…¶ä»–ç±»ä¼¼åœºåˆï¼Œé‚£ä¸æ˜¯pythonç¨‹åºçš„ç²¾ç¥æ‰€åœ¨ã€‚12345678910111213141516171819# æœªä½¿ç”¨__slots__# -*- coding: utf-8 -*from memory_profiler import profileclass Foobar(object):    # __slots__ = ('x')    def __init__(self, x):        self.x = x@profiledef main():    f = [Foobar(42) for i in range(1000000)]if __name__ == &quot;__main__&quot;:    main()    Line #    Mem usage    Increment   Line Contents================================================   137     45.7 MiB     45.7 MiB   @profile   138                             def main():   139    215.9 MiB      0.9 MiB       f = [Foobar(42) for i in range(1000000)]12345678910111213141516171819# ä½¿ç”¨__slots__# -*- coding: utf-8 -*from memory_profiler import profileclass Foobar(object):    __slots__ = ('x')    def __init__(self, x):        self.x = x@profiledef main():    f = [Foobar(42) for i in range(1000000)]if __name__ == &quot;__main__&quot;:    main()Line #    Mem usage    Increment   Line Contents================================================   132     45.7 MiB     45.7 MiB   @profile   133                             def main():   134     99.8 MiB      0.4 MiB       f = [Foobar(42) for i in range(1000000)]12# ä½¿ç”¨__slots__è¦æ³¨æ„ï¼Œ__slots__å®šä¹‰çš„å±æ€§ä»…å¯¹å½“å‰ç±»èµ·ä½œç”¨ï¼Œå¯¹ç»§æ‰¿çš„å­ç±»æ˜¯ä¸èµ·ä½œç”¨çš„# é™¤éåœ¨å­ç±»ä¸­ä¹Ÿå®šä¹‰__slots__ï¼Œè¿™æ ·ï¼Œå­ç±»å…è®¸å®šä¹‰çš„å±æ€§å°±æ˜¯è‡ªèº«çš„__slots__åŠ ä¸Šçˆ¶ç±»çš„__slots__ã€‚æš‚ç•™</content>
	</entry>
	<entry>
		<title>pythonç½‘ç»œç¼–ç¨‹</title>
		<url>/article/55054.html</url>
		<content>ç½‘ç»œç¼–ç¨‹socketå’Œurllibçš„å…³ç³»æä¾›å¯¹å¤šç§ä¸åŒç±»å‹å¥—æ¥å­—çš„ä½çº§è®¿é—®ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨è¿™äº›å¥—æ¥å­—é€šè¿‡ä»»ä½•ç«¯å£å’Œåè®®è¿›è¡Œé€šä¿¡ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥å°†å…¶ç”¨äºç”µå­é‚®ä»¶ã€SSHã€è¿œç¨‹æ¡Œé¢ç­‰ï¼Œä¹Ÿå¯ä»¥ç”¨äºä¾¦å¬ç«¯å£ï¼ˆå¯¹äºæœåŠ¡å™¨ï¼‰ã€‚å‡ ä¹æ‰€æœ‰Pythonç½‘ç»œåº“ï¼ŒåŒ…æ‹¬urllibï¼Œéƒ½ä»¥æŸç§æ–¹å¼ä½¿ç”¨socketã€‚åœ¨urllibä¸“é—¨ç”¨äºå¥—æ¥å­—çš„ç‰¹å®šç”¨é€”ï¼Œå³HTTPï¼ˆå’Œå¯é€‰çš„TLSï¼‰å’ŒFTPåè®®çš„å®¢æˆ·ç«¯ï¼Œé€šå¸¸ï¼ˆä½†ä¸æ€»æ˜¯ï¼‰ä½¿ç”¨ç«¯å£80ã€443æˆ–21ã€‚Python urllibã€urllib2ã€urllib3ç”¨æ³•åŠåŒºåˆ«urllibã€urllib2æ˜¯è€ç‰ˆæœ¬ï¼Œurllib3æ˜¯æ–°ç‰ˆæœ¬ï¼Œrequestsæ˜¯åŸºäºurllib3å†™çš„ã€‚å…¶ä¸­urllibå’Œurllib2æ˜¯å†…ç½®åº“æ¨¡å—urllibå’Œurllib2çš„åŠŸèƒ½å·®ä¸å¤šï¼Œç®€å•æ¥è¯´urllib2æ˜¯urllibçš„å¢å¼ºâ€”â€”urllib2æ›´å¥½ä¸€äº›ï¼Œä½†æ˜¯urllibä¸­æœ‰urllib2ä¸­æ‰€æ²¡æœ‰çš„å‡½æ•°ã€‚å¯¹äºç®€å•çš„ä¸‹è½½ï¼Œ urllibç»°ç»°æœ‰ä½™ã€‚å¦‚æœéœ€è¦å®ç°HTTPèº«ä»½éªŒè¯æˆ–Cookieäº¦æˆ–ç¼–å†™æ‰©å±•æ¥å¤„ç†è‡ªå·±çš„åè®®ï¼Œurllib2å¯èƒ½æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚åœ¨Python2.xä¸­ä¸»è¦ä¸ºurllibå’Œurllib2ï¼Œè¿™ä¸¤ä¸ªæ ‡å‡†åº“æ˜¯ä¸å¯ç›¸äº’æ›¿ä»£çš„ã€‚ä½†æ˜¯åœ¨Python3.xä¸­å°†urllib2åˆå¹¶åˆ°äº†urllibï¼Œè¿™ä¸€ç‚¹å€¼å¾—æ³¨æ„ã€‚urllibæ”¯æŒè®¾ç½®ç¼–ç çš„å‡½æ•°urllib.urlencodeï¼Œåœ¨æ¨¡æ‹Ÿç™»é™†çš„æ—¶å€™ç»å¸¸éœ€è¦ä¼ é€’ç»è¿‡postç¼–ç ä¹‹åçš„å‚æ•°ï¼Œå¦‚æœä¸æƒ³ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“å®Œæˆæ¨¡æ‹Ÿç™»å½•ï¼Œå°±å¿…é¡»ä½¿ç”¨åˆ°æ ‡å‡†åº“ä¸­çš„urllibã€‚urllibæä¾›ä¸€äº›æ¯”è¾ƒåŸå§‹åŸºç¡€çš„æ–¹æ³•è€Œurllib2å¹¶æ²¡æœ‰ï¼Œæ¯”å¦‚urllibä¸­çš„urlencodeæ–¹æ³•ç”¨æ¥GETæŸ¥è¯¢å­—ç¬¦ä¸²çš„äº§ç”Ÿã€‚urllib2æ¯”è¾ƒæœ‰ä¼˜åŠ¿çš„åœ°æ–¹åœ¨äºurllib2.openurlä¸­å¯ä»¥æ¥å—ä¸€ä¸ªRequestç±»çš„å®ä¾‹æ¥è®¾ç½®Requestå‚æ•°ï¼Œæ¥ä¿®æ”¹/è®¾ç½®Headerå¤´ä»è€Œè¾¾åˆ°æ§åˆ¶HTTP Requestçš„headeréƒ¨åˆ†çš„ç›®çš„ï¼Œä¹Ÿå¯ä»¥ä¿®æ”¹ç”¨æˆ·ä»£ç†,è®¾ç½®cookieç­‰ï¼Œä½†urllibä»…å¯ä»¥æ¥å—URLã€‚å¦‚æœä½ è®¿é—®ä¸€ä¸ªç½‘ç«™æƒ³æ›´æ”¹User Agent(å¯ä»¥ä¼ªè£…ä½ çš„æµè§ˆå™¨)ï¼Œä½ å°±éœ€è¦ä½¿ç”¨urllib2ã€‚urllib2æ¨¡å—æ²¡æœ‰åŠ å…¥urllib.urlretrieveå‡½æ•°ä»¥åŠurllib.quoteç­‰ä¸€ç³»åˆ—quoteå’ŒunquoteåŠŸèƒ½ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦urllibçš„è¾…åŠ©ã€‚socketç½‘ç»œ7å±‚åè®®ï¼Œ4å±‚ï¼Œ5å±‚ï¼Ÿç†æ¸…å®¹æ˜“æ··æ·†çš„å‡ ä¸ªæ¦‚å¿µçˆ¬è™«é‡åˆ° Socketï¼Œè«æ…Œï¼Œè‚å°±å®Œäº†ï¼Python3ä¸­çš„SocketServersocketæ˜¯åº”ç”¨å±‚ä¸TCP/IPåè®®æ—é€šä¿¡çš„ä¸­é—´è½¯ä»¶æŠ½è±¡å±‚ï¼Œå®ƒæ˜¯ä¸€ç»„æ¥å£ã€‚åœ¨è®¾è®¡æ¨¡å¼ä¸­ï¼ŒSocketå…¶å®å°±æ˜¯ä¸€ä¸ªé—¨é¢æ¨¡å¼ï¼Œå®ƒæŠŠå¤æ‚çš„TCP/IPåè®®æ—éšè—åœ¨Socketæ¥å£åé¢ï¼Œå¯¹ç”¨æˆ·æ¥è¯´ï¼Œä¸€ç»„ç®€å•çš„æ¥å£å°±æ˜¯å…¨éƒ¨ï¼Œè®©Socketå»ç»„ç»‡æ•°æ®ï¼Œä»¥ç¬¦åˆæŒ‡å®šçš„åè®®ã€‚Socket è¢«ç§°ä¸ºå¥—æ¥å­—ï¼Œæ˜¯å¯¹ TCP/IP åè®®çš„å°è£…ï¼Œå®ƒæ˜¯ä¼ è¾“å±‚å’Œåº”ç”¨å±‚é—´çš„æŠ½è±¡å±‚ç›¸æ¯” HTTP çš„çŸ­è¿æ¥é€šä¿¡æ–¹å¼ï¼ŒSocket å¯å®ç°å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çš„é•¿è¿æ¥é€šä¿¡Fiddlerã€Charles åªèƒ½æŠ“å–åº”ç”¨å±‚çš„æ•°æ®ï¼Œå¦‚æœä½ æƒ³æŠ“å…¶ä»–å±‚ï¼Œæ¯”å¦‚ï¼šç½‘ç»œå±‚ã€ä¼ è¾“å±‚ã€æ•°æ®é“¾è·¯å±‚çš„æ•°æ®ï¼Œå¼ºçƒˆå»ºè®®ä½¿ç”¨ï¼šWiresharkåœ¨æ ‡å‡†çš„OISæ¨¡å‹ä¸­å¹¶æ²¡æœ‰è§„å®šè¯´å¿…é¡»æœ‰socketå±‚ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸ä½¿ç”¨socketä¹Ÿèƒ½å®Œæˆé€šè®¯ï¼Œæ˜¯çš„ï¼Œçš„ç¡®å¦‚æ­¤é‚£ä¸ºä»€ä¹ˆéœ€è¦socketå‘¢ï¼Ÿä¸€ä¸ªå­—æ‡’ï¼Œç¨‹åºå‘˜éƒ½æ˜¯æ‡’çš„æˆ‘ä»¬å‘ç°è¿˜æ²¡æœ‰å¼€å§‹å®ç°åº”ç”¨ç¨‹åºé€»è¾‘ï¼Œå°±éœ€è¦èŠ±å¤§æŠŠæ—¶é—´æ¥å®ç°å„ç§åè®®ï¼Œå¤ªè´¹äº‹äº†ï¼Œå°±æœ‰äººä¸“é—¨æŠŠåè®®ä¸­ä¸€å †å¤æ‚çš„äº‹æƒ…è¿›è¡Œäº†å°è£…ï¼Œäºæ˜¯socketå°±è¯ç”Ÿäº†æœ‰äº†socketä»¥åï¼Œæ— éœ€è‡ªå·±ç¼–å†™ä»£ç å®ç°ä¸‰æ¬¡æ¡æ‰‹ï¼Œå››æ¬¡æŒ¥æ‰‹ï¼ŒARPè¯·æ±‚ï¼Œæ‰“åŒ…æ•°æ®ç­‰ç­‰ï¼Œsocketå·²ç»å°è£…å¥½äº†ï¼Œåªéœ€è¦éµå¾ªsocketçš„è§„å®šå»ç¼–ç¨‹ï¼Œå†™å‡ºçš„ç¨‹åºè‡ªç„¶å°±æ˜¯éµå¾ªtcp/udpæ ‡å‡†çš„socketçš„å‘å±•å¥—æ¥å­—èµ·æºäº20ä¸–çºª70å¹´ä»£åŠ åˆ©ç¦å°¼äºšå¤§å­¦ä¼¯å…‹åˆ©åˆ†æ ¡ç‰ˆæœ¬çš„ Unixï¼Œå³äººä»¬æ‰€è¯´çš„ BSD Unixå› æ­¤ï¼Œæœ‰æ—¶äººä»¬ä¹ŸæŠŠå¥—æ¥å­—ç§°ä¸ºâ€œä¼¯å…‹åˆ©å¥—æ¥å­—â€æˆ–â€œBSD å¥—æ¥å­—â€ä¸€å¼€å§‹,å¥—æ¥å­—è¢«è®¾è®¡ç”¨åœ¨åŒ ä¸€å°ä¸»æœºä¸Šå¤šä¸ªåº”ç”¨ç¨‹åºä¹‹é—´çš„é€šè®¯ï¼Œè¿™ä¹Ÿè¢«ç§°è¿›ç¨‹é—´é€šè®¯æˆ– IPCå¥—æ¥å­—æœ‰ä¸¤ç§(æˆ–è€…ç§°ä¸ºæœ‰ä¸¤ä¸ªç§æ—)ï¼Œåˆ†åˆ«æ˜¯åŸºäºæ–‡ä»¶å‹çš„å’ŒåŸºäºç½‘ç»œå‹çš„åŸºäºæ–‡ä»¶ç±»å‹çš„å¥—æ¥å­—å®¶æ—ï¼šAF_UNIXunixä¸€åˆ‡çš†æ–‡ä»¶ï¼ŒåŸºäºæ–‡ä»¶çš„å¥—æ¥å­—è°ƒç”¨çš„å°±æ˜¯åº•å±‚çš„æ–‡ä»¶ç³»ç»Ÿæ¥å–æ•°æ®ï¼Œä¸¤ä¸ªå¥—æ¥å­—è¿›ç¨‹è¿è¡Œåœ¨åŒä¸€æœºå™¨ï¼Œå¯ä»¥é€šè¿‡è®¿é—®åŒä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿé—´æ¥å®Œæˆé€šä¿¡åŸºäºç½‘ç»œç±»å‹çš„å¥—æ¥å­—å®¶æ—ï¼šAF_INETè¿˜æœ‰AF_INET6è¢«ç”¨äºipv6ï¼Œè¿˜æœ‰ä¸€äº›å…¶ä»–çš„åœ°å€å®¶æ—ï¼Œä¸è¿‡ï¼Œä»–ä»¬è¦ä¹ˆæ˜¯åªç”¨äºæŸä¸ªå¹³å°ï¼Œè¦ä¹ˆå°±æ˜¯å·²ç»è¢«åºŸå¼ƒï¼Œæˆ–è€…æ˜¯å¾ˆå°‘è¢«ä½¿ç”¨ï¼Œæˆ–è€…æ˜¯æ ¹æœ¬æ²¡æœ‰å®ç°ï¼Œæ‰€æœ‰åœ°å€å®¶æ—ä¸­ï¼ŒAF_INETæ˜¯ä½¿ç”¨æœ€å¹¿æ³›çš„ä¸€ä¸ªï¼Œpythonæ”¯æŒå¾ˆå¤šç§åœ°å€å®¶æ—ï¼Œä½†æ˜¯ç”±äºå¤§éƒ¨é€šè®¯éƒ½æ˜¯ç½‘ç»œé€šè®¯ï¼Œæ‰€ä»¥å¤§éƒ¨åˆ†æ—¶å€™ä½¿ç”¨AF_INETsocketç¤ºä¾‹123456789101112131415# 1.å¯¼å…¥socketæ¨¡å—import socket# 2.åˆ›å»ºsocketå¯¹è±¡ å‡½æ•°å®šä¹‰å¦‚ä¸‹socket.socket(socket_family,socket_type,protocal=0)#socket_family å¯ä»¥æ˜¯ AF_UNIX æˆ– AF_INETã€‚#socket_type å¯ä»¥æ˜¯ SOCK_STREAMè¡¨ç¤ºTCPåè®® æˆ– SOCK_DGRAMè¡¨ç¤ºUDPåè®®ã€‚#protocol ä¸€èˆ¬ä¸å¡«,é»˜è®¤å€¼ä¸º 0ã€‚   # 2.1è·å–TCP å¥—æ¥å­—tcpSock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)# æˆ–è€… åé¢çš„å‚æ•°éƒ½æœ‰é»˜è®¤å€¼,å¯ä»¥ä¸å†™,é»˜è®¤åˆ›å»ºçš„æ˜¯TCPåè®®sockettcpSock = socket.socket()# 2.2è·å–udp/ipå¥—æ¥å­—udpSock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)æœåŠ¡ç«¯å¥—æ¥å­—å‡½æ•°æœåŠ¡ç«¯å¥—æ¥å­—å‡½æ•°å«ä¹‰s.bind()ç»‘å®š(ä¸»æœº,ç«¯å£å·)åˆ°å¥—æ¥å­—s.listen()å¼€å§‹TCPç›‘å¬s.accept()è¢«åŠ¨æ¥å—TCPå®¢æˆ·çš„è¿æ¥,(é˜»å¡å¼)ç­‰å¾…è¿æ¥çš„åˆ°æ¥å®¢æˆ·ç«¯å¥—æ¥å­—å‡½æ•°å®¢æˆ·ç«¯å¥—æ¥å­—å‡½æ•°å«ä¹‰s.connect()ä¸»åŠ¨åˆå§‹åŒ–TCPæœåŠ¡å™¨è¿æ¥s.connect_ex()connect()å‡½æ•°çš„æ‰©å±•ç‰ˆæœ¬,å‡ºé”™æ—¶è¿”å›å‡ºé”™ç ,è€Œä¸æ˜¯æŠ›å‡ºå¼‚å¸¸å…¬å…±ç”¨é€”çš„å¥—æ¥å­—å‡½æ•°å…¬å…±ç”¨é€”çš„å¥—æ¥å­—å‡½æ•°å«ä¹‰s.recv()æ¥æ”¶TCPæ•°æ®s.send()å‘é€TCPæ•°æ®(sendåœ¨å¾…å‘é€æ•°æ®é‡å¤§äºå·±ç«¯ç¼“å­˜åŒºå‰©ä½™ç©ºé—´æ—¶,æ•°æ®ä¸¢å¤±,ä¸ä¼šå‘å®Œ)s.sendall()å‘é€å®Œæ•´çš„TCPæ•°æ®(æœ¬è´¨å°±æ˜¯å¾ªç¯è°ƒç”¨sendsendallåœ¨å¾…å‘é€æ•°æ®é‡å¤§äºå·±ç«¯ç¼“å­˜åŒºå‰©ä½™ç©ºé—´æ—¶ï¼Œæ•°æ®ä¸ä¸¢å¤±ï¼Œå¾ªç¯è°ƒç”¨sendç›´åˆ°å‘å®Œ)s.recvfrom()æ¥æ”¶UDPæ•°æ®s.sendto()å‘é€UDPæ•°æ®s.getpeername()è¿æ¥åˆ°å½“å‰å¥—æ¥å­—çš„è¿œç«¯çš„åœ°å€s.getsockname()å½“å‰å¥—æ¥å­—çš„åœ°å€s.getsockopt()è¿”å›æŒ‡å®šå¥—æ¥å­—çš„å‚æ•°s.setsockopt()è®¾ç½®æŒ‡å®šå¥—æ¥å­—çš„å‚æ•°s.close()å…³é—­å¥—æ¥å­—é¢å‘é”çš„å¥—æ¥å­—æ–¹æ³•é¢å‘é”çš„å¥—æ¥å­—æ–¹æ³•å«ä¹‰s.setblocking()è®¾ç½®å¥—æ¥å­—çš„é˜»å¡ä¸éé˜»å¡æ¨¡å¼s.settimeout()è®¾ç½®é˜»å¡å¥—æ¥å­—æ“ä½œçš„è¶…æ—¶æ—¶é—´s.gettimeout()å¾—åˆ°é˜»å¡å¥—æ¥å­—æ“ä½œçš„è¶…æ—¶æ—¶é—´TCPé€šè®¯æµç¨‹TCPçš„é€šè®¯æµç¨‹ä¸æ‰“ç”µè¯çš„è¿‡ç¨‹éå¸¸ç›¸ä¼¼ä¹°æ‰‹æœº == socket()è£…è¿›æ‰‹æœºå¡ == bind()å¾…æœº == listen()ç”µè¯æ¥äº†ã€æ¥å—é€šè¯ == accept()å¬ == read()è¯´ == write()æŒ‚ç”µè¯ ==  close()TCPæœåŠ¡ç«¯1234567891011121314import socketip_port = ('127.0.0.1', 9000)  # ç”µè¯å¡BUFSIZE = 1024  # æ”¶å‘æ¶ˆæ¯çš„å°ºå¯¸s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)  # ä¹°æ‰‹æœºs.bind(ip_port)  # æ‰‹æœºæ’å¡s.listen(5)  # æ‰‹æœºå¾…æœºconn, addr = s.accept()  # æ‰‹æœºæ¥ç”µè¯print('æ¥åˆ°æ¥è‡ª%sçš„ç”µè¯' % addr[0])msg = conn.recv(BUFSIZE)  # å¬æ¶ˆæ¯,å¬è¯print(msg, type(msg))conn.send(msg.upper())  # å‘æ¶ˆæ¯,è¯´è¯conn.close()  # æŒ‚ç”µè¯s.close()  # æ‰‹æœºå…³æœºTCPå®¢æˆ·ç«¯12345678910import socketip_port = ('127.0.0.1', 9000)BUFSIZE = 1024s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)s.connect_ex(ip_port)  # æ‹¨ç”µè¯s.send('linhaifeng nb'.encode('utf-8'))  # å‘æ¶ˆæ¯,è¯´è¯(åªèƒ½å‘é€å­—èŠ‚ç±»å‹)feedback = s.recv(BUFSIZE)  # æ”¶æ¶ˆæ¯,å¬è¯print(feedback.decode('utf-8'))s.close()  # æŒ‚ç”µè¯æ³¨æ„TCPä¸­å¿…é¡»å…ˆå¯åŠ¨æœåŠ¡å™¨å†å¯åŠ¨å®¢æˆ·ç«¯,å¦åˆ™å®¢æˆ·ç«¯ç”±äºæ— æ³•é“¾æ¥æœåŠ¡å™¨,ç›´æ¥æŠ¥é”™!å¦‚ä¸Šå°±å®Œæˆäº†ä¸€ä¸ªæœ€åŸºæœ¬çš„TCPé€šè®¯ï¼Œä½†æ˜¯å»ºç«‹æ˜¯ä¸ºäº†ä¼ è¾“æ•°æ®ï¼ŒäºŒä¼ è¾“æ•°æ®å¾ˆå¤šæ—¶å€™å¹¶ä¸æ˜¯ä¸€æ¬¡æ€§å°±ä¼ è¾“å®Œæˆäº†ï¼Œéœ€è¦å¤šæ¬¡æ”¶å‘è¿‡ç¨‹ï¼Œæ‰€ä»¥éœ€è¦ç»™ä»£ç åŠ ä¸Šå¾ªç¯æ”¹è¿›ç‰ˆæœåŠ¡å™¨ç«¯1234567891011121314151617import socketip_port=('127.0.0.1',8081)#ç”µè¯å¡BUFSIZE=1024s=socket.socket(socket.AF_INET,socket.SOCK_STREAM) #ä¹°æ‰‹æœºs.bind(ip_port) #æ‰‹æœºæ’å¡s.listen(5)     #æ‰‹æœºå¾…æœºwhile True:                         #æ–°å¢æ¥æ”¶é“¾æ¥å¾ªç¯,å¯ä»¥ä¸åœçš„æ¥ç”µè¯    conn,addr=s.accept()            #æ‰‹æœºæ¥ç”µè¯    # print(conn)    # print(addr)    print('æ¥åˆ°æ¥è‡ª%sçš„ç”µè¯' ï¿½dr[0])    while True:                         #æ–°å¢é€šä¿¡å¾ªç¯,å¯ä»¥ä¸æ–­çš„é€šä¿¡,æ”¶å‘æ¶ˆæ¯        msg=conn.recv(BUFSIZE)             #å¬æ¶ˆæ¯,å¬è¯        print(msg,type(msg))        conn.send(msg.upper())          #å‘æ¶ˆæ¯,è¯´è¯    conn.close()                    #æŒ‚ç”µè¯s.close()                       #æ‰‹æœºå…³æœºæ”¹è¿›ç‰ˆå®¢æˆ·ç«¯12345678910111213import socketip_port=('127.0.0.1',8081)BUFSIZE=1024s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)s.connect_ex(ip_port)           #æ‹¨ç”µè¯while True:                             #æ–°å¢é€šä¿¡å¾ªç¯,å®¢æˆ·ç«¯å¯ä»¥ä¸æ–­å‘æ”¶æ¶ˆæ¯    msg=input('&gt;&gt;: ').strip()    if len(msg) == 0:continue    s.send(msg.encode('utf-8'))         #å‘æ¶ˆæ¯,è¯´è¯(åªèƒ½å‘é€å­—èŠ‚ç±»å‹)       feedback=s.recv(BUFSIZE)                           #æ”¶æ¶ˆæ¯,å¬è¯    print(feedback.decode('utf-8'))s.close()                                       #æŒ‚ç”µè¯åŸºäºUDPçš„socketUDPé€šè®¯æµç¨‹ä¸å¯¹è®²æœºéå¸¸ç±»ä¼¼(ç”±äºä¸éœ€è¦å»ºç«‹è¿æ¥æ‰€ä»¥çœå»TCPçš„listen()å’Œaccept()è¿™ä¸¤æ­¥)ä¹°ä¼ å‘¼æœº ==  socket()å›ºå®šå¯¹è®²é¢‘é“ == bind()æ”¶ä¿¡å· == recvfrom()å‘ä¿¡å· == sendto()UDPæœåŠ¡å™¨ç«¯1234567891011import socketip_port=('127.0.0.1',9000) # å›ºå®šé€šè®¯é¢‘é“BUFSIZE=1024#åœ¨TCPä¸­socketçš„åˆå§‹åŒ–å‚æ•°å¯ä»¥çœç•¥, å› ä¸ºé»˜è®¤åˆ›å»ºçš„å°±æ˜¯TCPåè®®çš„socket#è€ŒUDPåˆ™å¿…é¡»æ‰‹åŠ¨æŒ‡å®šç›¸å…³å‚æ•°udp_server_client=socket.socket(socket.AF_INET,socket.SOCK_DGRAM) # ä¹°å¯¹è®²æœºudp_server_client.bind(ip_port)while True:    msg,addr=udp_server_client.recvfrom(BUFSIZE) #æ”¶ä¿¡æ¯    print(msg,addr)    udp_server_client.sendto(msg.upper(),addr) # å‘ä¿¡æ¯UDPå®¢æˆ·ç«¯123456789import socketip_port=('127.0.0.1',9000) #ç¡®å®šé€šè®¯é¢‘é“BUFSIZE=1024udp_server_client=socket.socket(socket.AF_INET,socket.SOCK_DGRAM) # ä¹°å¯¹è®²æœºwhile True:    msg=input('&gt;&gt;: ').strip()    if not msg:continue    udp_server_client.sendto(msg.encode('utf-8'),ip_port) # å‘æ¶ˆæ¯    back_msg,addr=udp_server_client.recvfrom(BUFSIZE) #æ”¶æ¶ˆæ¯udpæ˜¯æ— é“¾æ¥çš„ï¼Œå…ˆå¯åŠ¨å“ªä¸€ç«¯éƒ½ä¸ä¼šæŠ¥é”™ï¼Œå³ä½¿å¯¹æ–¹åœ°å€æ ¹æœ¬ä¸å­˜åœ¨ä¹Ÿä¸ä¼šæŠ¥é”™ï¼Œå¼ºåˆ¶å…³é—­ä»»ä½•ä¸€æ–¹ä¹Ÿæ²¡æœ‰ä»»ä½•é—®å¦å¤–ï¼Œç”±äºæ— è¿æ¥çš„ç‰¹ç‚¹ï¼ŒæœåŠ¡å™¨ä¸éœ€è¦é’ˆå¯¹æ‘¸ä¸ªå®¢æˆ·ç«¯è¿›è¡Œå¾ªç¯ï¼Œåªè¦å¾ªç¯çš„æ¥æ”¶å³å¯ï¼Œè°å‘æ¥çš„æ¶ˆæ¯éƒ½å¯ä»¥è¢«å¤„ç†ï¼ŒåŸºäºè¿™ä¸ªç‰¹ç‚¹æˆ‘ä»¬å¯ä»¥ç¼–å†™ä¸€ä¸ªUDPç¨‹åºï¼Œå®ç°å¤šä¸ªå®¢æˆ·ç«¯åŒæ—¶ä¸æœåŠ¡å™¨é€šè®¯UDPèŠå¤©æœåŠ¡å™¨123456789import socketip_port=('127.0.0.1',8081)udp_server_sock=socket.socket(socket.AF_INET,socket.SOCK_DGRAM) #ä¹°æ‰‹æœºudp_server_sock.bind(ip_port)while True:    qq_msg,addr=udp_server_sock.recvfrom(1024)    print('æ¥è‡ª[%s:%s]çš„ä¸€æ¡æ¶ˆæ¯:\033[1;44m%s\033[0m' %(addr[0],addr[1],qq_msg.decode('utf-8')))    back_msg=input('å›å¤æ¶ˆæ¯: ').strip()    udp_server_sock.sendto(back_msg.encode('utf-8'),addr)UDPèŠå¤©å®¢æˆ·ç«¯1234567891011121314151617181920import socketBUFSIZE = 1024udp_client_socket = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)qq_name_dic = {    'ç‹—å“¥': ('127.0.0.1', 8081),    'å¤©çº¿å®å®': ('127.0.0.1', 8081),    'å·´æ‹‰å·´æ‹‰å°é­”å¥³': ('127.0.0.1', 8081),    'ç‹å°¼ç›': ('127.0.0.1', 8081),}while True:    qq_name = input('è¯·é€‰æ‹©èŠå¤©å¯¹è±¡: ').strip()    while True:        msg = input('è¯·è¾“å…¥æ¶ˆæ¯,å›è½¦å‘é€: ').strip()        if msg == 'quit': break        if not msg or not qq_name or qq_name not in qq_name_dic: continue        udp_client_socket.sendto(msg.encode('utf-8'), qq_name_dic[qq_name])        back_msg, addr = udp_client_socket.recvfrom(BUFSIZE)        print('æ¥è‡ª[%s:%s]çš„ä¸€æ¡æ¶ˆæ¯:\033[1;44m%s\033[0m' % (addr[0], addr[1], back_msg.decode('utf-8')))udp_client_socket.close()ç²˜åŒ…é—®é¢˜ç²˜åŒ…æŒ‡çš„æ˜¯æ•°æ®ä¸æ•°æ®ä¹‹é—´æ²¡æœ‰æ˜ç¡®çš„åˆ†ç•Œçº¿ï¼Œå¯¼è‡´ä¸èƒ½æ­£ç¡®è¯»å–æ•°æ®ï¼è¦ç†è§£ç²˜åŒ…é—®é¢˜ï¼Œéœ€è¦å…ˆäº†è§£TCPåè®®ä¼ è¾“æ•°æ®æ—¶çš„å…·ä½“æµç¨‹ï¼ŒTCPåè®®ä¹Ÿç§°ä¹‹ä¸ºæµå¼åè®®(UDPç§°ä¸ºæ•°æ®æŠ¥åè®®)åº”ç”¨ç¨‹åºæ— æ³•ç›´æ¥æ“ä½œç¡¬ä»¶ï¼Œåº”ç”¨ç¨‹åºæƒ³è¦å‘é€æ•°æ®åˆ™å¿…é¡»å°†æ•°æ®äº¤ç»™æ“ä½œç³»ç»Ÿï¼Œè€Œæ“ä½œç³»ç»Ÿéœ€è¦éœ€è¦åŒæ—¶ä¸ºæ‰€æœ‰åº”ç”¨ç¨‹åºæä¾›æ•°æ®ä¼ è¾“æœåŠ¡ï¼Œä¹Ÿå°±æ„å‘³ç€ï¼Œæ“ä½œç³»ç»Ÿä¸å¯èƒ½ç«‹é©¬å°±èƒ½å°†åº”ç”¨ç¨‹åºçš„æ•°æ®å‘é€å‡ºå»ï¼Œå°±éœ€è¦ä¸ºåº”ç”¨ç¨‹åºæä¾›ä¸€ä¸ªç¼“å†²åŒºï¼Œç”¨äºä¸´æ—¶å­˜æ”¾æ•°æ®ï¼Œå…·ä½“æµç¨‹å¦‚ä¸‹ï¼šå‘é€æ–¹ï¼šå½“åº”ç”¨ç¨‹åºè°ƒç”¨sendå‡½æ•°æ—¶ï¼Œåº”ç”¨ç¨‹åºä¼šå°†æ•°æ®ä»åº”ç”¨ç¨‹åºæ‹·è´åˆ°æ“ä½œç³»ç»Ÿç¼“å­˜ï¼Œå†ç”±æ“ä½œç³»ç»Ÿä»ç¼“å†²åŒºè¯»å–æ•°æ®å¹¶å‘é€å‡ºå»æ¥æ”¶æ–¹ï¼šå¯¹æ–¹è®¡ç®—æœºæ”¶åˆ°æ•°æ®ä¹Ÿæ˜¯æ“ä½œç³»ç»Ÿå…ˆæ”¶åˆ°ï¼Œè‡³äºåº”ç”¨ç¨‹åºä½•æ—¶å¤„ç†è¿™äº›æ•°æ®ï¼Œæ“ä½œç³»ç»Ÿå¹¶ä¸æ¸…æ¥šï¼Œæ‰€ä»¥åŒæ ·éœ€è¦å°†æ•°æ®å…ˆå­˜å‚¨åˆ°æ“ä½œç³»ç»Ÿçš„ç¼“å†²åŒºä¸­ï¼Œå½“åº”ç”¨ç¨‹åºè°ƒç”¨recvæ—¶ï¼Œå®é™…ä¸Šæ˜¯ä»æ“ä½œç³»ç»Ÿç¼“å†²åŒºä¸­å°†æ•°æ®æ‹·è´åˆ°åº”ç”¨ç¨‹åºçš„è¿‡ç¨‹ä¸Šè¿°è¿‡ç¨‹å¯¹äºTCPä¸UDPéƒ½æ˜¯ç›¸åŒçš„ä¸åŒä¹‹å¤„åœ¨äºï¼šUDP: UDPåœ¨æ”¶å‘æ•°æ®æ—¶æ˜¯åŸºäºæ•°æ®åŒ…çš„ï¼Œå³ä¸€ä¸ªåŒ…ä¸€ä¸ªåŒ…çš„å‘é€ï¼ŒåŒ…ä¸åŒ…ä¹‹é—´æœ‰ç€æ˜ç¡®çš„åˆ†ç•Œï¼Œåˆ°è¾¾å¯¹æ–¹æ“ä½œç³»ç»Ÿç¼“å†²åŒºåä¹Ÿæ˜¯ä¸€ä¸ªä¸€ä¸ªç‹¬ç«‹çš„æ•°æ®åŒ…ï¼Œæ¥æ”¶æ–¹ä»æ“ä½œç³»ç»Ÿç¼“å†²åŒºä¸­å°†æ•°æ®åŒ…æ‹·è´åˆ°åº”ç”¨ç¨‹åºè¿™ç§æ–¹å¼å­˜åœ¨çš„é—®é¢˜ï¼šå‘é€æ–¹å‘é€çš„æ•°æ®é•¿åº¦æ¯ä¸ªæ“ä½œç³»ç»Ÿä¼šæœ‰ä¸åŒçš„é™åˆ¶ï¼Œæ•°æ®è¶…è¿‡é™åˆ¶åˆ™æ— æ³•å‘é€æ¥æ”¶æ–¹æ¥æ”¶æ•°æ®æ—¶å¦‚æœåº”ç”¨ç¨‹åºçš„æä¾›çš„ç¼“å­˜å®¹é‡å°äºæ•°æ®åŒ…çš„é•¿åº¦å°†é€ æˆæ•°æ®ä¸¢å¤±ï¼Œè€Œç¼“å†²åŒºå¤§å°ä¸å¯èƒ½æ— é™å¤§TCP: å½“æˆ‘ä»¬éœ€è¦ä¼ è¾“è¾ƒå¤§çš„æ•°æ®ï¼Œæˆ–éœ€è¦ä¿è¯æ•°æ®å®Œæ•´æ€§æ—¶ï¼Œæœ€ç®€å•çš„æ–¹å¼å°±æ˜¯ä½¿ç”¨TCPåè®®äº†ä¸UDPä¸åŒçš„æ˜¯ï¼ŒTCPå¢åŠ äº†ä¸€å¥—æ ¡éªŒè§„åˆ™æ¥ä¿è¯æ•°æ®çš„å®Œæ•´æ€§ï¼Œä¼šå°†è¶…è¿‡TCPåŒ…æœ€å¤§é•¿åº¦çš„æ•°æ®æ‹†åˆ†ä¸ºå¤šä¸ªTCPåŒ… å¹¶åœ¨ä¼ è¾“æ•°æ®æ—¶ä¸ºæ¯ä¸€ä¸ªTCPæ•°æ®åŒ…æŒ‡å®šä¸€ä¸ªé¡ºåºå·ï¼Œæ¥æ”¶æ–¹åœ¨æ”¶åˆ°TCPæ•°æ®åŒ…åæŒ‰ç…§é¡ºåºå°†æ•°æ®åŒ…è¿›è¡Œé‡ç»„ï¼Œé‡ç»„åçš„æ•°æ®å…¨éƒ½æ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼Œä¸”æ¯æ¬¡æ”¶åˆ°çš„äºŒè¿›åˆ¶æ•°æ®ä¹‹é—´æ²¡æœ‰æ˜æ˜¾çš„åˆ†ç•ŒåŸºäºè¿™ç§å·¥ä½œæœºåˆ¶TCPåœ¨ä¸‰ç§æƒ…å†µä¸‹ä¼šå‘é€ç²˜åŒ…é—®é¢˜å½“å•ä¸ªæ•°æ®åŒ…è¾ƒå°æ—¶æ¥æ”¶æ–¹å¯èƒ½ä¸€æ¬¡æ€§è¯»å–äº†å¤šä¸ªåŒ…çš„æ•°æ®å½“æ•´ä½“æ•°æ®è¾ƒå¤§æ—¶æ¥æ”¶æ–¹å¯èƒ½ä¸€æ¬¡ä»…è¯»å–äº†ä¸€ä¸ªåŒ…çš„ä¸€éƒ¨åˆ†å†…å®¹å¦å¤–TCPåè®®ä¸ºäº†æé«˜æ•ˆç‡ï¼Œå¢åŠ äº†ä¸€ç§ä¼˜åŒ–æœºåˆ¶ï¼Œä¼šå°†æ•°æ®è¾ƒå°ä¸”å‘é€é—´éš”è¾ƒçŸ­çš„æ•°æ®åˆå¹¶å‘é€ï¼Œè¯¥æœºåˆ¶ä¹Ÿä¼šå¯¼è‡´å‘é€æ–¹å°†ä¸¤ä¸ªæ•°æ®åŒ…ç²˜åœ¨ä¸€èµ·å‘é€ç²˜åŒ…çš„è§£å†³æ–¹æ¡ˆè§£å†³æ–¹æ¡ˆï¼šåœ¨å‘é€æ•°æ®å‰å…ˆå‘é€æ•°æ®é•¿åº¦ä¸Šè¿°æ–¹æ¡ˆçœ‹èµ·æ¥è§£å†³äº†ç²˜åŒ…é—®é¢˜ï¼Œä½†æ˜¯ç”±äºnegleä¼˜åŒ–æœºåˆ¶çš„å­˜åœ¨ï¼Œé•¿åº¦ä¿¡æ¯å’Œæ•°æ®è¿˜æ˜¯æœ‰å¯èƒ½ä¼šç²˜åŒ…ï¼Œè€Œæ¥å—æ–¹å¹¶ä¸çŸ¥é“é•¿åº¦ä¿¡æ¯å…·ä½“å‡ ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥ç°åœ¨çš„é—®é¢˜æ˜¯å¦‚ä½•èƒ½å¤Ÿé•¿åº¦ä¿¡æ¯åšæˆä¸€ä¸ªå›ºå®šé•¿åº¦çš„bytesæ•°æ®æˆ‘ä»¬å¯ä»¥å°†å­—ç¬¦ä¸²æ‹¼æ¥ä¸ºä¸€ä¸ªå›ºå®šé•¿åº¦çš„å­—ç¬¦ ä½†æ˜¯è¿™æ ·å¤ªéº»çƒ¦ï¼Œstructæ¨¡å—ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªåŠŸèƒ½ï¼Œå¯ä»¥å°†æ•´æ•°ç±»å‹è½¬æ¢ä¸ºå›ºå®šé•¿åº¦çš„bytesï¼Œæ­¤æ—¶å°±æ´¾ä¸Šç”¨åœºäº†è‡ªå®šä¹‰æŠ¥å¤´è§£å†³ç²˜åŒ…ä¸Šè¿°æ–¹æ¡ˆå·²ç»å®Œç¾è§£å†³äº†ç²˜åŒ…é—®é¢˜ï¼Œä½†æ˜¯æ‰©å±•æ€§ä¸é«˜ï¼Œä¾‹å¦‚æˆ‘ä»¬è¦å®ç°æ–‡ä»¶ä¸Šä¼ ä¸‹è½½ï¼Œä¸å…‰è¦ä¼ è¾“æ–‡ä»¶æ•°æ®ï¼Œè¿˜éœ€è¦ä¼ è¾“æ–‡ä»¶åå­—ï¼Œmd5å€¼ç­‰ç­‰ï¼Œå¦‚ä½•èƒ½å®ç°å‘¢ï¼Œå…·ä½“æ€è·¯ï¼šå‘é€ç«¯ï¼šå…ˆå°†æ‰€æœ‰çš„é¢å¤–ä¿¡æ¯æ‰“åŒ…åˆ°ä¸€ä¸ªå¤´ä¸­ç„¶åå…ˆå‘é€å¤´éƒ¨æ•°æ®æœ€åå‘é€çœŸå®æ•°æ®æ¥æ”¶ç«¯ï¼šæ¥æ”¶å›ºå®šé•¿åº¦çš„å¤´éƒ¨é•¿åº¦æ•°æ®æ ¹æ®é•¿åº¦æ•°æ®è·å–å¤´éƒ¨æ•°æ®æ ¹æ®å¤´éƒ¨æ•°æ®è·å–çœŸå®æ•°æ®å®¢æˆ·ç«¯ï¼š12345678910111213141516171819202122232425import socketimport structimport jsonc = socket.socket()c.connect((&quot;127.0.0.1&quot;,8888))while True:    cmd = input(&quot;&gt;&gt;&gt;:&quot;).strip()    c.send(cmd.encode(&quot;utf-8&quot;))     # å¤´éƒ¨æ•°æ®    data = c.recv(4)    head_length = struct.unpack(&quot;i&quot;,data)[0]    head_data = c.recv(head_length).decode(&quot;utf-8&quot;)    head = json.loads(head_data)    print(head)    # çœŸå®æ•°æ®é•¿åº¦    data_length = head[&quot;data_size&quot;]    #æ¥æ”¶çœŸå®æ•°æ®    size = 0    res = b&quot;&quot;    while size &lt; data_length:        temp = c.recv(1024)        size += len(temp)        res += temp    print(res.decode(&quot;gbk&quot;))æœåŠ¡å™¨ï¼š12345678910111213141516171819202122232425import socketimport subprocessimport structimport jsonserver = socket.socket()server.bind((&quot;127.0.0.1&quot;,8888))server.listen()while True:    client, addr = server.accept()    while True:        cmd = client.recv(1024).decode(&quot;utf-8&quot;)        p = subprocess.Popen(cmd,shell=True,stdout=-1,stderr=-1)          # çœŸå®æ•°æ®        data = p.stdout.read() + p.stderr.read()               # å¤´éƒ¨æ•°æ®        head = {&quot;data_size&quot;:len(data),&quot;é¢å¤–ä¿¡æ¯&quot;:&quot;é¢å¤–çš„å€¼&quot;}        head_data = json.dumps(head).encode(&quot;utf-8&quot;)        #å¤´éƒ¨é•¿åº¦        head_len = struct.pack(&quot;i&quot;,len(head_data))        #é€ä¸ªå‘é€        client.send(head_len)        client.send(head_data)        client.send(data)urlliburllibâ€”URL handling modulespythonçˆ¬è™«ä»å…¥é—¨åˆ°æ”¾å¼ƒï¼ˆä¸‰ï¼‰ä¹‹ Urllibåº“çš„åŸºæœ¬ä½¿ç”¨åŸºæœ¬æ¦‚è¿°urllibæ˜¯pythonå†…ç½®çš„HTTPè¯·æ±‚åº“ï¼ŒåŒ…æ‹¬ä»¥ä¸‹æ¨¡å—urllib.request: æœ€åŸºæœ¬çš„HTTPè¯·æ±‚æ¨¡å—ï¼Œç”¨æ¥å‘èµ·è¯·æ±‚ï¼Œå°±å’Œäººä»¬åœ¨æµè§ˆå™¨ä¸Šè¾“å…¥ç½‘å€æ¥è®¿é—®ç½‘é¡µä¸€æ ·urllib.error: å¼‚å¸¸å¤„ç†æ¨¡å—ï¼Œå¦‚æœåœ¨è¯·æ±‚æ—¶å‡ºç°é”™è¯¯ï¼Œç”¨è¿™ä¸ªæ¨¡å—æ¥æŠ“ä½å¼‚å¸¸ï¼Œä¿è¯ç¨‹åºä¸ä¼šå› ä¸ºæŠ›å‡ºå¼‚å¸¸è€ŒæŒ‚æ‰urllib.parse url: å·¥å…·æ¨¡å—ï¼Œæä¾›äº†è®¸å¤šURLå¤„ç†æ–¹æ³•ï¼Œæ¯”å¦‚URLçš„æ‹†åˆ†ã€åˆå¹¶ç­‰ç­‰urllib.robotparser: ç”¨æ¥è¯†åˆ«ç›®æ ‡ç½‘ç«™çš„robot.txtæ–‡ä»¶(åŸºæœ¬ç”¨ä¸ä¸Š)é‡è¦æ¨¡å—urlopenå…³äºurllib.request.urlopenå‚æ•°çš„ä»‹ç»ï¼š1urllib.request.urlopen(url, data=None, [timeout, ]*, cafile=None, capath=None, cadefault=False, context=None)è¯·æ±‚urlopenä¸€èˆ¬å¸¸ç”¨çš„æœ‰ä¸‰ä¸ªå‚æ•°ï¼Œå®ƒçš„å‚æ•°å¦‚ä¸‹ï¼šurllib.requeset.urlopen(url,data,timeout)1234567891011121314151617181920import urllib.request# Getè¯·æ±‚response = urllib.request.urlopen('http://www.baidu.com')# response.read()å¯ä»¥è·å–åˆ°ç½‘é¡µçš„å†…å®¹print(response.read().decode('utf-8'))# Postè¯·æ±‚import urllib.parseimport urllib.request# é€šè¿‡bytes(urllib.parse.urlencode())å¯ä»¥å°†postæ•°æ®è¿›è¡Œè½¬æ¢æ”¾åˆ°urllib.request.urlopençš„dataå‚æ•°ä¸­ã€‚è¿™æ ·å°±å®Œæˆäº†ä¸€æ¬¡postè¯·æ±‚data = bytes(urllib.parse.urlencode({'word': 'hello'}), encoding='utf8')print(data)response = urllib.request.urlopen('http://httpbin.org/post', data=data)print(response.read())# Timeoutå‚æ•°# åœ¨æŸäº›ç½‘ç»œæƒ…å†µä¸å¥½æˆ–è€…æœåŠ¡å™¨ç«¯å¼‚å¸¸çš„æƒ…å†µä¼šå‡ºç°è¯·æ±‚æ…¢çš„æƒ…å†µï¼Œæˆ–è€…è¯·æ±‚å¼‚å¸¸# æ‰€ä»¥è¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦ç»™è¯·æ±‚è®¾ç½®ä¸€ä¸ªè¶…æ—¶æ—¶é—´ï¼Œè€Œä¸æ˜¯è®©ç¨‹åºä¸€ç›´åœ¨ç­‰å¾…ç»“æœresponse = urllib.request.urlopen('http://httpbin.org/get', timeout=1)print(response.read())å¦‚æœæˆ‘ä»¬æ·»åŠ dataå‚æ•°çš„æ—¶å€™å°±æ˜¯ä»¥postè¯·æ±‚æ–¹å¼è¯·æ±‚ï¼Œå¦‚æœæ²¡æœ‰dataå‚æ•°å°±æ˜¯getè¯·æ±‚æ–¹å¼å“åº”é€šè¿‡response.statusã€response.getheaders().response.getheader(â€œserverâ€)ï¼Œè·å–çŠ¶æ€ç ä»¥åŠå¤´éƒ¨ä¿¡æ¯response.read()è·å¾—çš„æ˜¯å“åº”ä½“çš„å†…å®¹12345678print(response.status)200print(response.getheaders())[('Connection', 'close'), ('Content-Length', '49589'), ('Server', 'nginx'), ('Content-Type', 'text/html; charset=utf-8'), ('X-Frame-Options', 'DENY'), ('Via', '1.1 vegur, 1.1 varnish, 1.1 varnish'), ('Accept-Ranges', 'bytes'), ('Date', 'Wed, 18 Aug 2021 07:37:14 GMT'), ('Age', '1496'), ('X-Served-By', 'cache-bwi5120-BWI, cache-nrt18321-NRT'), ('X-Cache', 'HIT, HIT'), ('X-Cache-Hits', '2, 1285'), ('X-Timer', 'S1629272234.003034,VS0,VE0'), ('Vary', 'Cookie'), ('Strict-Transport-Security', 'max-age=63072000; includeSubDomains')]print(response.getheader(&quot;server&quot;))nginxprint(response.read())å“åº”ä½“çš„å†…å®¹requestä¸Šè¿°çš„urlopenåªèƒ½ç”¨äºä¸€äº›ç®€å•çš„è¯·æ±‚ï¼Œå› ä¸ºå®ƒæ— æ³•æ·»åŠ ä¸€äº›headerä¿¡æ¯ï¼Œå¦‚æœåé¢å†™çˆ¬è™«æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå¾ˆå¤šæƒ…å†µä¸‹æˆ‘ä»¬æ˜¯éœ€è¦æ·»åŠ å¤´éƒ¨ä¿¡æ¯å»è®¿é—®ç›®æ ‡ç«™çš„ï¼Œè¿™ä¸ªæ—¶å€™å°±ç”¨åˆ°äº†urllib.requesturllibä¸­ï¼Œrequestè¿™ä¸ªæ¨¡å—ä¸»è¦è´Ÿè´£æ„é€ å’Œå‘èµ·ç½‘ç»œè¯·æ±‚ï¼Œå¹¶åœ¨å…¶ä¸­åŠ å…¥Headersã€Proxyç­‰ã€‚åˆ©ç”¨å®ƒå¯ä»¥æ¨¡æ‹Ÿæµè§ˆå™¨çš„ä¸€ä¸ªè¯·æ±‚å‘èµ·è¿‡ç¨‹è®¾ç½®Headersæœ‰å¾ˆå¤šç½‘ç«™ä¸ºäº†é˜²æ­¢ç¨‹åºçˆ¬è™«çˆ¬ç½‘ç«™é€ æˆç½‘ç«™ç˜«ç—ªï¼Œä¼šéœ€è¦æºå¸¦ä¸€äº›headerså¤´éƒ¨ä¿¡æ¯æ‰èƒ½è®¿é—®æœ€é•¿è§çš„æœ‰user-agentå‚æ•°12345678910111213141516171819from urllib import request, parse# æ–¹å¼ä¸€url = 'http://httpbin.org/post'headers = {    'User-Agent': 'Mozilla/4.0 (compatible; MSIE 5.5; Windows NT)',    'Host': 'httpbin.org'}dict = {'name': 'hyc'}data = bytes(parse.urlencode(dict), encoding='utf8')req = request.Request(url=url, data=data, headers=headers, method='POST')response = request.urlopen(req)# æ–¹å¼äºŒdata = bytes(parse.urlencode(dict), encoding='utf8')req = request.Request(url=url, data=data, method='POST')# å¥½å¤„æ˜¯è‡ªå·±å¯ä»¥å®šä¹‰ä¸€ä¸ªè¯·æ±‚å¤´å­—å…¸ï¼Œç„¶åå¾ªç¯è¿›è¡Œæ·»åŠ req.add_header('User-Agent', 'Mozilla/4.0 (compatible; MSIE 5.5; Windows NT)')response = request.urlopen(req)urlretrieveä¸‹è½½æ–‡ä»¶urlretrieve()æ–¹æ³•ç›´æ¥å°†è¿œç¨‹æ•°æ®ä¸‹è½½åˆ°æœ¬åœ°ã€‚1urlretrieve(url, filename=None, reporthook=None, data=None)urlï¼šä¸‹è½½é“¾æ¥åœ°å€filenameï¼šæŒ‡å®šäº†ä¿å­˜æœ¬åœ°è·¯å¾„(å¦‚æœå‚æ•°æœªæŒ‡å®šï¼Œurllibä¼šç”Ÿæˆä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ä¿å­˜æ•°æ®)reporthookï¼šæ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå½“è¿æ¥ä¸ŠæœåŠ¡å™¨ã€ä»¥åŠç›¸åº”çš„æ•°æ®å—ä¼ è¾“å®Œæ¯•æ—¶ä¼šè§¦å‘è¯¥å›è°ƒï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªå›è°ƒå‡½æ•°æ¥æ˜¾ç¤ºå½“å‰çš„ä¸‹è½½è¿›åº¦dataï¼šæŒ‡postå¯¼æœåŠ¡å™¨çš„æ•°æ®ï¼Œè¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªåŒ…å«ä¸¤ä¸ªå…ƒç´ çš„(filename, headers) å…ƒç»„ï¼Œfilename è¡¨ç¤ºä¿å­˜åˆ°æœ¬åœ°çš„è·¯å¾„ï¼Œheaderè¡¨ç¤ºæœåŠ¡å™¨çš„å“åº”å¤´123456789101112131415161718import osfrom six.moves import urllibimport sysDATA_URL = 'http://www.python.org/ftp/python/2.7.5/Python-2.7.5.tar.bz2'filename = DATA_URL.split('/')[-1]def _progress(block_num, block_size, total_size):    '''å›è°ƒå‡½æ•°       @block_num: å·²ç»ä¸‹è½½çš„æ•°æ®å—       @block_size: æ•°æ®å—çš„å¤§å°       @total_size: è¿œç¨‹æ–‡ä»¶çš„å¤§å°    '''    sys.stdout.write('\r&gt;&gt; Downloading %s %.1f%%' % (filename,                     float(block_num * block_size) / float(total_size) * 100.0))    sys.stdout.flush()filepath, _ = urllib.request.urlretrieve(DATA_URL, filename, _progress)handlerProxyHandleré€šè¿‡rulllib.request.ProxyHandler()å¯ä»¥è®¾ç½®ä»£ç†,ç½‘ç«™å®ƒä¼šæ£€æµ‹æŸä¸€æ®µæ—¶é—´æŸä¸ªIP çš„è®¿é—®æ¬¡æ•°ï¼Œå¦‚æœè®¿é—®æ¬¡æ•°è¿‡å¤šï¼Œå®ƒä¼šç¦æ­¢ä½ çš„è®¿é—®,æ‰€ä»¥è¿™ä¸ªæ—¶å€™éœ€è¦é€šè¿‡è®¾ç½®ä»£ç†æ¥çˆ¬å–æ•°æ®123456789import urllib.requestproxy_handler = urllib.request.ProxyHandler({    'http': 'http://127.0.0.1:9743',    'https': 'https://127.0.0.1:9743'})opener = urllib.request.build_opener(proxy_handler)response = opener.open('http://httpbin.org/get')print(response.read())HTTPCookiProcessorcookieä¸­ä¿å­˜ä¸­æˆ‘ä»¬å¸¸è§çš„ç™»å½•ä¿¡æ¯ï¼Œæœ‰æ—¶å€™çˆ¬å–ç½‘ç«™éœ€è¦æºå¸¦cookieä¿¡æ¯è®¿é—®,è¿™é‡Œç”¨åˆ°äº†http.cookijarï¼Œç”¨äºè·å–cookieä»¥åŠå­˜å‚¨cookie1234567891011121314151617181920212223242526272829303132333435import http.cookiejar, urllib.request# æ–¹å¼ä¸€ï¼šç›´æ¥æ‰“å°cookie = http.cookiejar.CookieJar()handler = urllib.request.HTTPCookieProcessor(cookie)opener = urllib.request.build_opener(handler)response = opener.open('http://www.baidu.com')for item in cookie:    print(item.name+&quot;=&quot;+item.value)    # æ–¹å¼äºŒï¼šMozillaCookieJar()æ–¹å¼import http.cookiejar, urllib.requestfilename = &quot;cookie.txt&quot;cookie = http.cookiejar.MozillaCookieJar(filename)handler = urllib.request.HTTPCookieProcessor(cookie)opener = urllib.request.build_opener(handler)response = opener.open('http://www.baidu.com')cookie.save(ignore_discard=True, ignore_expires=True)# æ–¹å¼ä¸‰ï¼šLWPCookieJar()æ–¹å¼import http.cookiejar, urllib.requestfilename = 'cookie.txt'cookie = http.cookiejar.LWPCookieJar(filename)handler = urllib.request.HTTPCookieProcessor(cookie)opener = urllib.request.build_opener(handler)response = opener.open('http://www.baidu.com')cookie.save(ignore_discard=True, ignore_expires=True)# è¯»å–cookieimport http.cookiejar, urllib.requestcookie = http.cookiejar.LWPCookieJar()cookie.load('cookie.txt', ignore_discard=True, ignore_expires=True)handler = urllib.request.HTTPCookieProcessor(cookie)opener = urllib.request.build_opener(handler)response = opener.open('http://www.baidu.com')print(response.read().decode('utf-8'))excepturllibåº“å®ç°äº†ä¸‰ä¸ªå¼‚å¸¸ç±»ï¼šURLErroré‡Œåªæœ‰ä¸€ä¸ªå±æ€§ï¼šreason,å³æŠ“å¼‚å¸¸çš„æ—¶å€™åªèƒ½æ‰“å°é”™è¯¯ä¿¡æ¯HTTPErroré‡Œæœ‰ä¸‰ä¸ªå±æ€§ï¼šcode,reason,headersContentTooShortErroré‡Œæœ‰ä¸‰ä¸ªå±æ€§ï¼šreason,content123456789101112131415from urllib import request,errortry:    response = request.urlopen(&quot;http://pythonsite.com/1111.html&quot;)except error.HTTPError as e:    print(e.reason)    print(e.code)    print(e.headers)except error.URLError as e:    print(e.reason)    # e.reasonå…¶å®ä¹Ÿå¯ä»¥åœ¨åšæ·±å…¥çš„åˆ¤æ–­    if isinstance(e.reason,socket.timeout):        print(&quot;time out&quot;)else:    print(&quot;reqeust successfully&quot;)url parseç›¸å…³urlparse123456# urllib.parse.urlparse(urlstring, scheme='', allow_fragments=True)from urllib.parse import urlparseresult = urlparse(&quot;http://www.baidu.com/index.html;user?id=5#comment&quot;)print(result)urlunparsåŠŸèƒ½å’Œurlparseçš„åŠŸèƒ½ç›¸åï¼Œå®ƒæ˜¯ç”¨äºæ‹¼æ¥1234from urllib.parse import urlunparsedata = ['http','www.baidu.com','index.html','user','a=123','commit']print(urlunparse(data))urljoinè¿™ä¸ªçš„åŠŸèƒ½å…¶å®æ˜¯åšæ‹¼æ¥çš„1234567891011121314151617181920from urllib.parse import urljoinprint(urljoin('http://www.baidu.com', 'FAQ.html'))print(urljoin('http://www.baidu.com', 'https://pythonsite.com/FAQ.html'))print(urljoin('http://www.baidu.com/about.html', 'https://pythonsite.com/FAQ.html'))print(urljoin('http://www.baidu.com/about.html', 'https://pythonsite.com/FAQ.html?question=2'))print(urljoin('http://www.baidu.com?wd=abc', 'https://pythonsite.com/index.php'))print(urljoin('http://www.baidu.com', '?category=2#comment'))print(urljoin('www.baidu.com', '?category=2#comment'))print(urljoin('www.baidu.com#comment', '?category=2'))# ä»æ‹¼æ¥çš„ç»“æœæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œæ‹¼æ¥çš„æ—¶å€™åé¢çš„ä¼˜å…ˆçº§é«˜äºå‰é¢çš„urlhttp://www.baidu.com/FAQ.htmlhttps://pythonsite.com/FAQ.htmlhttps://pythonsite.com/FAQ.htmlhttps://pythonsite.com/FAQ.html?question=2https://pythonsite.com/index.phphttp://www.baidu.com?category=2#commentwww.baidu.com?category=2#commentwww.baidu.com?category=2urlencodeè¿™ä¸ªæ–¹æ³•å¯ä»¥å°†å­—å…¸è½¬æ¢ä¸ºurlå‚æ•°123456from urllib.parse import urlencodeparams = {&quot;name&quot;:&quot;hyc&quot;, &quot;age&quot;:28}base_url = &quot;http://www.baidu.com?&quot;url = base_url+urlencode(params)print(url)cookieç™»å½•åï¼Œå¾—åˆ°cookieï¼Œå¸¦ç€è¿™ä¸ªcookieå¯ä»¥è®¿é—®ç™»å½•åçš„å†…å®¹123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960#!/usr/bin/env Python# -- coding: utf-8 --&quot;&quot;&quot;@version: v1.0@author: huangyc@file: cookie_test.py@Description: @time: 2022/11/3 11:34&quot;&quot;&quot;import urllib.parseimport urllib.parseimport urllib.requestimport urllib.requestfrom http import cookiejardef cookie_test():    # å®šä¹‰è¯·æ±‚å¤´    headers = {&quot;content-type&quot;: &quot;application/x-www-form-urlencoded&quot;,               &quot;Users-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/79.0.3945.130 Safari/537.36&quot;}    # ç™»å½•çš„ç½‘å€    login_url = &quot;https://xx.hycbook.com/xx.php&quot;    # ç™»å½•çš„å‚æ•°    login_form_data = {&quot;fm_usr&quot;: &quot;xxx&quot;, &quot;fm_pwd&quot;: &quot;xxx&quot;}    # ä½¿ç”¨urllib.requestæ—¶  postæ–¹æ³•æ‰€æºå¸¦çš„å‚æ•°ä¸èƒ½æ˜¯å­—å…¸å½¢å¼    login_form_data_final = urllib.parse.urlencode(login_form_data)    # å‘é€ç™»å½•è¯·æ±‚POST, è‡ªåŠ¨ä¿å­˜cookie    cook_jar = cookiejar.MozillaCookieJar()    # å®šä¹‰æœ‰æ·»åŠ  cookieåŠŸèƒ½çš„å¤„ç†å™¨    cook_handler = urllib.request.HTTPCookieProcessor(cook_jar)    # æ ¹æ®å¤„ç†å™¨ç”Ÿæˆopener    opener = urllib.request.build_opener(cook_handler)    # æ­¤æ—¶headersé‡Œé¢è¿˜æ²¡æœ‰cookie, è¿˜æ²¡æœ‰ç™»å½•    login_request = urllib.request.Request(login_url, headers=headers, data=login_form_data_final.encode(&quot;utf-8&quot;))    # å¦‚æœç™»å½•æˆåŠŸ. cookjarè‡ªåŠ¨ä¿å­˜cookie, openeré‡Œé¢æœ‰cookjar, æ‰€ä»¥openeré‡Œæœ‰cookie    resp = opener.open(login_request)    res_text = resp.read().decode('utf-8')    cook_jar.save(&quot;cookie.txt&quot;)    # åˆ›å»ºç®¡ç†å™¨    cookie_handler = urllib.request.HTTPCookieProcessor(cook_jar)    http_handler = urllib.request.HTTPHandler()    https_handler = urllib.request.HTTPSHandler()    # åˆ›å»ºè¯·æ±‚æ±‚ç®¡ç†å™¨, æ­¤å¤„å°†ç™»å½•è¿‡çš„cookieå¸¦è¿›å»    opener = urllib.request.build_opener(cookie_handler, http_handler, https_handler)    look_url = f&quot;https://xx.hycbook.com&quot;    req = urllib.request.Request(look_url)    # å‘èµ·è¯·æ±‚    response = opener.open(req)    print(&quot;ç»“æŸ&quot;)urllib3requests</content>
	</entry>
	<entry>
		<title>collectionæ¨¡å—</title>
		<url>/article/54754.html</url>
		<content>Pythonçš„collectionsæ¨¡å—collections â€”- å®¹å™¨æ•°æ®ç±»å‹Python3 collectionsæ¨¡å—ä½¿ç”¨è¯¦è§£collections â€” Container datatypes  namedtuple(): ç”Ÿæˆå¯ä»¥ä½¿ç”¨åå­—æ¥è®¿é—®å…ƒç´ å†…å®¹çš„tupleå­ç±» deque: åŒç«¯é˜Ÿåˆ—ï¼Œå¯ä»¥å¿«é€Ÿçš„ä»å¦å¤–ä¸€ä¾§è¿½åŠ å’Œæ¨å‡ºå¯¹è±¡ Counter: è®¡æ•°å™¨ï¼Œä¸»è¦ç”¨æ¥è®¡æ•° OrderedDict: æœ‰åºå­—å…¸ defaultdict: å¸¦æœ‰é»˜è®¤å€¼çš„å­—å…¸       ChainMap    ç±»ä¼¼å­—å…¸(dict)çš„å®¹å™¨ç±»ï¼Œå°†å¤šä¸ªæ˜ å°„é›†åˆåˆ°ä¸€ä¸ªè§†å›¾é‡Œé¢       UserDict    å°è£…äº†å­—å…¸å¯¹è±¡ï¼Œç®€åŒ–äº†å­—å…¸å­ç±»åŒ–       UserList    å°è£…äº†åˆ—è¡¨å¯¹è±¡ï¼Œç®€åŒ–äº†åˆ—è¡¨å­ç±»åŒ–       UserString    å°è£…äº†åˆ—è¡¨å¯¹è±¡ï¼Œç®€åŒ–äº†å­—ç¬¦ä¸²å­ç±»åŒ– collections.abc  æŠ½è±¡åŸºç±»tupleçš„å‡ ä¸ªç‰¹æ€§ï¼šä¸å¯å˜ï¼Œiterableæ‹†åŒ…tupleä¸å¯å˜ä¸æ˜¯ç»å¯¹çš„tupleæ¯”listå¥½çš„åœ°æ–¹ 4.1 immutableçš„é‡è¦æ€§ï¼šæ€§èƒ½ä¼˜åŒ–(å…ƒç´ å…¨ä¸ºimmutableçš„ä¼šä½œä¸ºå¸¸é‡åœ¨ç¼–è¯‘æ—¶ç¡®å®š)ã€çº¿ç¨‹å®‰å…¨ã€å¯ä»¥ä½œä¸ºdictçš„keyï¼Œæ‹†åŒ…ç‰¹æ€§ 4.2 tupleç±»ä¼¼structï¼Œlistç±»ä¼¼arrayå®¹å™¨åºåˆ—ã€€ã€€listã€tuple å’Œ collections.deque è¿™äº›åºåˆ—èƒ½å­˜æ”¾ä¸åŒç±»å‹çš„æ•°æ®ã€‚æ‰å¹³åºåˆ—ã€€ã€€strã€bytesã€bytearrayã€memoryview å’Œ array.arrayï¼Œè¿™ç±»åºåˆ—åªèƒ½å®¹çº³ä¸€ç§ç±»å‹ã€‚å®¹å™¨åºåˆ—å­˜æ”¾çš„æ˜¯å®ƒä»¬æ‰€åŒ…å«çš„ä»»æ„ç±»å‹çš„å¯¹è±¡çš„å¼•ç”¨ï¼Œè€Œæ‰å¹³åºåˆ—é‡Œå­˜æ”¾çš„æ˜¯å€¼è€Œä¸æ˜¯å¼•ç”¨ã€‚æ¢å¥è¯è¯´ï¼Œæ‰å¹³åºåˆ—å…¶å®æ˜¯ä¸€æ®µè¿ç»­çš„å†…å­˜ç©ºé—´ã€‚ç”±æ­¤å¯è§æ‰å¹³åºåˆ—å…¶å®æ›´åŠ ç´§å‡‘ï¼Œä½†æ˜¯å®ƒé‡Œé¢åªèƒ½å­˜æ”¾è¯¸å¦‚å­—ç¬¦ã€å­—èŠ‚å’Œæ•°å€¼è¿™ç§åŸºç¡€ç±»å‹ã€‚åºåˆ—ç±»å‹è¿˜èƒ½æŒ‰ç…§èƒ½å¦è¢«ä¿®æ”¹æ¥åˆ†ç±»ã€‚å¯å˜åºåˆ—ã€€ã€€listã€bytearrayã€array.arrayã€collections.deque å’Œ memoryviewã€‚ä¸å¯å˜åºåˆ—ã€€ã€€tupleã€str å’Œ bytesã€‚å…·åå…ƒç»„namedtupleæ¦‚å¿µå‘½åçš„å…ƒç»„ï¼Œæ„å‘³ç»™å…ƒç»„ä¸­çš„æ¯ä¸ªä½ç½®èµ‹äºˆå«ä¹‰ï¼Œæ„å‘³ç€ä»£ç å¯è¯»æ€§æ›´å¼ºï¼Œnamedtupleå¯ä»¥åœ¨ä»»ä½•å¸¸è§„å…ƒç´ ä½¿ç”¨çš„åœ°æ–¹ä½¿ç”¨ï¼Œè€Œä¸”å®ƒå¯ä»¥é€šè¿‡åç§°æ¥è·å–å­—æ®µä¿¡æ¯è€Œä¸ä»…ä»…æ˜¯é€šè¿‡ä½ç½®ç´¢å¼•ã€‚ç”¨ä»¥æ„å»ºåªæœ‰å°‘æ•°å±æ€§ä½†æ˜¯æ²¡æœ‰æ–¹æ³•çš„å¯¹è±¡ï¼Œæ¯”å¦‚æ•°æ®åº“æ¡ç›®ã€‚collections.namedtuple æ˜¯ä¸€ä¸ªå·¥å‚å‡½æ•°ï¼Œå®ƒå¯ä»¥ç”¨æ¥æ„å»ºä¸€ä¸ªå¸¦å­—æ®µåçš„å…ƒç»„å’Œä¸€ä¸ªæœ‰åå­—çš„ç”¨ namedtuple æ„å»ºçš„ç±»çš„å®ä¾‹æ‰€æ¶ˆè€—çš„å†…å­˜è·Ÿå…ƒç»„æ˜¯ä¸€æ ·çš„ï¼Œå› ä¸ºå­—æ®µåéƒ½è¢«å­˜åœ¨å¯¹åº”çš„ç±»é‡Œé¢åˆ›å»ºä¸€ä¸ªå…·åå…ƒç»„éœ€è¦ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯ç±»åï¼Œå¦ä¸€ä¸ªæ˜¯ç±»çš„å„ä¸ªå­—æ®µçš„åå­—ã€‚å‡ ä¸ªæœ€æœ‰ç”¨çš„ï¼š_fields ç±»å±æ€§ã€ç±»æ–¹æ³• _make(iterable) å’Œå®ä¾‹æ–¹æ³• _asdict()ã€‚â¶ _fields å±æ€§æ˜¯ä¸€ä¸ªåŒ…å«è¿™ä¸ªç±»æ‰€æœ‰å­—æ®µåç§°çš„å…ƒç»„ã€‚â· ç”¨ _make() é€šè¿‡æ¥å—ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡æ¥ç”Ÿæˆè¿™ä¸ªç±»çš„ä¸€ä¸ªå®ä¾‹ï¼Œå®ƒçš„ä½œç”¨è·Ÿ City(*delhi_data) æ˜¯ä¸€æ ·çš„ã€‚â¸ _asdict() æŠŠå…·åå…ƒç»„ä»¥ collections.OrderedDict çš„å½¢å¼è¿”å›ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å®ƒæ¥æŠŠå…ƒç»„é‡Œçš„ä¿¡æ¯å‹å¥½åœ°å‘ˆç°å‡ºæ¥ã€‚12345678from collections import namedtupleUser = namedtuple(&quot;USER&quot;, [&quot;name&quot;, &quot;age&quot;, &quot;city&quot;, &quot;height&quot;])user_1 = User(name=&quot;é›·é¸£&quot;, age=21, city=&quot;åŒ—äº¬&quot;, height=&quot;175&quot;)print(&quot;user_1&quot;, user_1.name, user_1.age, user_1.city, user_1.height)user_1 é›·é¸£ 21 åŒ—äº¬ 175user_1._fieldsOut[4]: ('name', 'age', 'city', 'height')ä½¿ç”¨å®šä¹‰ä»£ç 12345678910111213141516171819202122232425262728293031323334# namedtupleï¼š ç”Ÿæˆå¯ä»¥ä½¿ç”¨åå­—æ¥è®¿é—®å…ƒç´ å†…å®¹çš„tupleå­ç±»# -*- coding: utf-8 -*from collections import namedtupleUser = namedtuple(&quot;USER&quot;, [&quot;name&quot;, &quot;age&quot;, &quot;city&quot;, &quot;height&quot;])user_1 = User(name=&quot;é›·é¸£&quot;, age=21, city=&quot;åŒ—äº¬&quot;, height=&quot;175&quot;)print(&quot;user_1&quot;, user_1.name, user_1.age, user_1.city, user_1.height)user_tuple = (&quot;é›·å§†&quot;, 17, 'å¼‚ä¸–ç•Œ')user_2 = User(*user_tuple, &quot;172&quot;)print(&quot;user_2&quot;, user_2.name, user_2.age, user_2.city, user_2.height)user_dict = {    &quot;name&quot;: &quot;é›·ç–&quot;,    &quot;age&quot;: &quot;17&quot;,    &quot;city&quot;: &quot;å¼‚ä¸–ç•Œ&quot;,}user_3 = User(**user_dict, height=&quot;172&quot;)print(&quot;user_3&quot;, user_3.name, user_3.age, user_3.city, user_3.height)user_tuple_2 = (&quot;é›·å§†&quot;, 17, 'å¼‚ä¸–ç•Œ', &quot;172&quot;)user_list_2 = [&quot;é›·å§†&quot;, 17, 'å¼‚ä¸–ç•Œ', &quot;172&quot;]user_dict_2 = {    &quot;name&quot;: &quot;é›·ç–&quot;,    &quot;age&quot;: &quot;17&quot;,    &quot;city&quot;: &quot;å¼‚ä¸–ç•Œ&quot;,    &quot;height&quot;: &quot;172&quot;}user_4 = User._make(user_dict_2.values())print(&quot;user_4&quot;, user_4.name, user_4.age, user_4.city, user_4.height)user_5 = User._make(user_tuple_2)print(&quot;user_5&quot;, user_5.name, user_5.age, user_5.city, user_5.height)user_6 = User._make(user_list_2)print(&quot;user_6&quot;, user_6.name, user_6.age, user_6.city, user_6.height)è¾“å‡º123456user_1 é›·é¸£ 21 åŒ—äº¬ 175user_2 é›·å§† 17 å¼‚ä¸–ç•Œ 172user_3 é›·ç– 17 å¼‚ä¸–ç•Œ 172user_4 é›·ç– 17 å¼‚ä¸–ç•Œ 172user_5 é›·å§† 17 å¼‚ä¸–ç•Œ 172user_6 é›·å§† 17 å¼‚ä¸–ç•Œ 172è®¿é—®ä»£ç 123456789from collections import namedtupleUser = namedtuple(&quot;USER&quot;, [&quot;name&quot;, &quot;age&quot;, &quot;city&quot;, &quot;height&quot;])user_tuple = (&quot;é›·å§†&quot;, 17, 'å¼‚ä¸–ç•Œ')user_2 = User(*user_tuple, &quot;172&quot;)print(user_2._asdict())item = ('a', 'b', 'a', 'a', 5)for it in set(item):    print(f'{it} å‡ºç°äº†{item.count(it)}æ¬¡')è¾“å‡º1234OrderedDict([('name', 'é›·å§†'), ('age', 17), ('city', 'å¼‚ä¸–ç•Œ'), ('height', '172')])a å‡ºç°äº†3æ¬¡5 å‡ºç°äº†1æ¬¡b å‡ºç°äº†1æ¬¡å­—å…¸ä»‹ç»dict ç±»å‹ä¸ä½†åœ¨å„ç§ç¨‹åºé‡Œå¹¿æ³›ä½¿ç”¨ï¼Œå®ƒä¹Ÿæ˜¯ Python è¯­è¨€çš„åŸºçŸ³ã€‚è·Ÿå®ƒæœ‰å…³çš„å†…ç½®å‡½æ•°éƒ½åœ¨ __builtins__.__dict__æ¨¡å—ä¸­ã€‚æ­£æ˜¯å› ä¸ºå­—å…¸è‡³å…³é‡è¦ï¼ŒPython å¯¹å®ƒçš„å®ç°åšäº†é«˜åº¦ä¼˜åŒ–ï¼Œè€Œæ•£åˆ—è¡¨åˆ™æ˜¯å­—å…¸ç±»å‹æ€§èƒ½å‡ºä¼—çš„æ ¹æœ¬åŸå› ã€‚collections.abc æ¨¡å—ä¸­æœ‰ Mapping å’Œ MutableMapping è¿™ä¸¤ä¸ªæŠ½è±¡åŸºç±»ç„¶è€Œï¼ŒéæŠ½è±¡æ˜ å°„ç±»å‹ä¸€èˆ¬ä¸ä¼šç›´æ¥ç»§æ‰¿è¿™äº›æŠ½è±¡åŸºç±»ï¼Œå®ƒä»¬ä¼šç›´æ¥å¯¹ dict æˆ–æ˜¯ collections.UserDict è¿›è¡Œæ‰©å±•ã€‚æ ‡å‡†åº“é‡Œçš„æ‰€æœ‰æ˜ å°„ç±»å‹éƒ½æ˜¯åˆ©ç”¨ dict æ¥å®ç°çš„ï¼Œå› æ­¤å®ƒä»¬æœ‰ä¸ªå…±åŒçš„é™åˆ¶ï¼Œå³åªæœ‰å¯æ•£åˆ—çš„æ•°æ®ç±»å‹æ‰èƒ½ç”¨ä½œè¿™äº›æ˜ å°„é‡Œçš„é”®å…³äºå¯æ•£åˆ—ç±»å‹çš„å®šä¹‰æœ‰è¿™æ ·ä¸€æ®µè¯ï¼šå¦‚æœä¸€ä¸ªå¯¹è±¡æ˜¯å¯æ•£åˆ—çš„ï¼Œé‚£ä¹ˆåœ¨è¿™ä¸ªå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸä¸­ï¼Œå®ƒçš„æ•£åˆ—å€¼æ˜¯ä¸å˜çš„ï¼Œè€Œä¸”è¿™ä¸ªå¯¹è±¡éœ€è¦å®ç° __hash__() æ–¹æ³•ã€‚å¦å¤–å¯æ•£åˆ—å¯¹è±¡è¿˜è¦æœ‰ __qe__() æ–¹æ³•ï¼Œè¿™æ ·æ‰èƒ½è·Ÿå…¶ä»–é”®åšæ¯”è¾ƒã€‚å¦‚æœä¸¤ä¸ªå¯æ•£åˆ—å¯¹è±¡æ˜¯ç›¸ç­‰çš„ï¼Œé‚£ä¹ˆå®ƒä»¬çš„æ•£åˆ—å€¼ä¸€å®šæ˜¯ä¸€æ ·çš„ä¸€èˆ¬æ¥è®²ç”¨æˆ·è‡ªå®šä¹‰çš„ç±»å‹çš„å¯¹è±¡éƒ½æ˜¯å¯æ•£åˆ—çš„ï¼Œæ•£åˆ—å€¼å°±æ˜¯å®ƒä»¬çš„ id() å‡½æ•°çš„è¿”å›å€¼ï¼Œæ‰€ä»¥æ‰€æœ‰è¿™äº›å¯¹è±¡åœ¨æ¯”è¾ƒçš„æ—¶å€™éƒ½æ˜¯ä¸ç›¸ç­‰çš„åˆ›å»ºå­—å…¸çš„ä¸åŒæ–¹å¼ï¼š1234567&gt;&gt;&gt; a = dict(one=1, two=2, three=3)&gt;&gt;&gt; b = {'one': 1, 'two': 2, 'three': 3}&gt;&gt;&gt; c = dict(zip(['one', 'two', 'three'], [1, 2, 3]))&gt;&gt;&gt; d = dict([('two', 2), ('one', 1), ('three', 3)])&gt;&gt;&gt; e = dict({'three': 3, 'one': 1, 'two': 2})&gt;&gt;&gt; a == b == c == d == eTrueé™¤äº†è¿™äº›å­—é¢å¥æ³•å’Œçµæ´»çš„æ„é€ æ–¹æ³•ä¹‹å¤–ï¼Œå­—å…¸æ¨å¯¼ï¼ˆdict comprehensionï¼‰ä¹Ÿå¯ä»¥ç”¨æ¥å»ºé€ æ–° dictå­—å…¸æ¨å¯¼ï¼ˆdictcompï¼‰å¯ä»¥ä»ä»»ä½•ä»¥é”®å€¼å¯¹ä½œä¸ºå…ƒç´ çš„å¯è¿­ä»£å¯¹è±¡ä¸­æ„å»ºå‡ºå­—å…¸ã€‚æ˜ å°„ç±»å‹çš„æ–¹æ³•å…¶å®å¾ˆä¸°å¯Œã€‚è¡¨ 3-1 ä¸ºæˆ‘ä»¬å±•ç¤ºäº† dictã€defaultdict å’Œ OrderedDict çš„å¸¸è§æ–¹æ³•ï¼Œåé¢ä¸¤ä¸ªæ•°æ®ç±»å‹æ˜¯ dict çš„å˜ç§ï¼Œä½äº collections æ¨¡å—å†…ã€‚å­—å…¸çš„å˜ç§ï¼šcollections.OrderedDictï¼š è¿™ä¸ªç±»å‹åœ¨æ·»åŠ é”®çš„æ—¶å€™ä¼šä¿æŒé¡ºåºï¼Œå› æ­¤é”®çš„è¿­ä»£æ¬¡åºæ€»æ˜¯ä¸€è‡´çš„ã€‚OrderedDictçš„ popitem æ–¹æ³•é»˜è®¤åˆ é™¤å¹¶è¿”å›çš„æ˜¯å­—å…¸é‡Œçš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œä½†æ˜¯å¦‚æœåƒ my_odict.popitem(last=False) è¿™æ ·è°ƒç”¨å®ƒï¼Œé‚£ä¹ˆå®ƒåˆ é™¤å¹¶è¿”å›ç¬¬ä¸€ä¸ªè¢«æ·»åŠ è¿›å»çš„å…ƒç´ ã€‚collections.ChainMapï¼š è¯¥ç±»å‹å¯ä»¥å®¹çº³æ•°ä¸ªä¸åŒçš„æ˜ å°„å¯¹è±¡ï¼Œç„¶ååœ¨è¿›è¡Œé”®æŸ¥æ‰¾æ“ä½œçš„æ—¶å€™ï¼Œè¿™äº›å¯¹è±¡ä¼šè¢«å½“ä½œä¸€ä¸ªæ•´ä½“è¢«é€ä¸ªæŸ¥æ‰¾ï¼Œç›´åˆ°é”®è¢«æ‰¾åˆ°ä¸ºæ­¢ã€‚collections.Counterï¼š è¿™ä¸ªæ˜ å°„ç±»å‹ä¼šç»™é”®å‡†å¤‡ä¸€ä¸ªæ•´æ•°è®¡æ•°å™¨ã€‚æ¯æ¬¡æ›´æ–°ä¸€ä¸ªé”®çš„æ—¶å€™éƒ½ä¼šå¢åŠ è¿™ä¸ªè®¡æ•°å™¨ã€‚æ‰€ä»¥è¿™ä¸ªç±»å‹å¯ä»¥ç”¨æ¥ç»™å¯æ•£åˆ—è¡¨å¯¹è±¡è®¡æ•°ï¼Œæˆ–è€…æ˜¯å½“æˆå¤šé‡é›†æ¥ç”¨â€”â€”å¤šé‡é›†åˆå°±æ˜¯é›†åˆé‡Œçš„å…ƒç´ å¯ä»¥å‡ºç°ä¸æ­¢ä¸€æ¬¡ã€‚è·Ÿ OrderedDictã€ChainMap å’Œ Counter è¿™äº›å¼€ç®±å³ç”¨çš„ç±»å‹ä¸åŒï¼ŒUserDict æ˜¯è®©ç”¨æˆ·ç»§æ‰¿å†™å­ç±»çš„ã€‚dictçš„å®ç°åŠå…¶å¯¼è‡´çš„ç»“æœé”®å¿…é¡»æ˜¯å¯æ•£åˆ—çš„ä¸€ä¸ªå¯æ•£åˆ—çš„å¯¹è±¡å¿…é¡»æ»¡è¶³ä»¥ä¸‹è¦æ±‚ã€‚(1) æ”¯æŒ hash() å‡½æ•°ï¼Œå¹¶ä¸”é€šè¿‡ __hash__() æ–¹æ³•æ‰€å¾—åˆ°çš„æ•£åˆ—å€¼æ˜¯ä¸å˜çš„ã€‚(2) æ”¯æŒé€šè¿‡ __eq__() æ–¹æ³•æ¥æ£€æµ‹ç›¸ç­‰æ€§ã€‚(3) è‹¥ a == b ä¸ºçœŸï¼Œåˆ™ hash(a) == hash(b) ä¹Ÿä¸ºçœŸã€‚æ‰€æœ‰ç”±ç”¨æˆ·è‡ªå®šä¹‰çš„å¯¹è±¡é»˜è®¤éƒ½æ˜¯å¯æ•£åˆ—çš„ï¼Œå› ä¸ºå®ƒä»¬çš„æ•£åˆ—å€¼ç”± id() æ¥è·å–ï¼Œè€Œä¸”å®ƒä»¬éƒ½æ˜¯ä¸ç›¸ç­‰çš„ã€‚å­—å…¸åœ¨å†…å­˜ä¸Šçš„å¼€é”€å·¨å¤§ç”±äºå­—å…¸ä½¿ç”¨äº†æ•£åˆ—è¡¨ï¼Œè€Œæ•£åˆ—è¡¨åˆå¿…é¡»æ˜¯ç¨€ç–çš„ï¼Œè¿™å¯¼è‡´å®ƒåœ¨ç©ºé—´ä¸Šçš„æ•ˆç‡ä½ä¸‹ã€‚åœ¨ç”¨æˆ·è‡ªå®šä¹‰çš„ç±»å‹ä¸­ï¼Œ__slots__ å±æ€§å¯ä»¥æ”¹å˜å®ä¾‹å±æ€§çš„å­˜å‚¨æ–¹å¼ï¼Œç”± dictå˜æˆ tupleé”®æŸ¥è¯¢å¾ˆå¿«dict çš„å®ç°æ˜¯å…¸å‹çš„ç©ºé—´æ¢æ—¶é—´ï¼šå­—å…¸ç±»å‹æœ‰ç€å·¨å¤§çš„å†…å­˜å¼€é”€ï¼Œä½†å®ƒä»¬æä¾›äº†æ— è§†æ•°æ®é‡å¤§å°çš„å¿«é€Ÿè®¿é—®â€”â€”åªè¦å­—å…¸èƒ½è¢«è£…åœ¨å†…å­˜é‡Œé”®çš„æ¬¡åºå–å†³äºæ·»åŠ é¡ºåºå½“å¾€ dict é‡Œæ·»åŠ æ–°é”®è€Œåˆå‘ç”Ÿæ•£åˆ—å†²çªçš„æ—¶å€™ï¼Œæ–°é”®å¯èƒ½ä¼šè¢«å®‰æ’å­˜æ”¾åˆ°å¦ä¸€ä¸ªä½ç½®ã€‚å¾€å­—å…¸é‡Œæ·»åŠ æ–°é”®å¯èƒ½ä¼šæ”¹å˜å·²æœ‰é”®çš„é¡ºåºæ— è®ºä½•æ—¶å¾€å­—å…¸é‡Œæ·»åŠ æ–°çš„é”®ï¼ŒPython è§£é‡Šå™¨éƒ½å¯èƒ½åšå‡ºä¸ºå­—å…¸æ‰©å®¹çš„å†³å®šã€‚æ‰©å®¹å¯¼è‡´çš„ç»“æœå°±æ˜¯è¦æ–°å»ºä¸€ä¸ªæ›´å¤§çš„æ•£åˆ—è¡¨ï¼Œå¹¶æŠŠå­—å…¸é‡Œå·²æœ‰çš„å…ƒç´ æ·»åŠ åˆ°æ–°è¡¨é‡Œã€‚defaultdicté»˜è®¤å€¼è¯å…¸é”™è¯¯æ–¹å¼ä»£ç 12345678910111213141516# é”™è¯¯æ–¹å¼ä¸€student_grades = {}grades = [('elliot', 91), ('neelam', 98),          ('bianca', 81), ('elliot', 88)]for name, grade in grades:if name not in student_grades:    student_grades[name] = []    student_grades[name].append(grade)print(student_grades)# é”™è¯¯æ–¹å¼äºŒstudent_grades = {}for name, grade in grades:student_grades.setdefault(name, [])    student_grades[name].append(grade)print(student_grades)è¾“å‡º12{'elliot': [91, 88], 'neelam': [98], 'bianca': [81]}{'elliot': [91, 88], 'neelam': [98], 'bianca': [81]}æ­£ç¡®æ–¹å¼åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å°†åˆ›å»ºä¸€ä¸ªdefaultdictï¼Œå®ƒä½¿ç”¨ä¸å¸¦å‚æ•°çš„listæ„é€ å‡½æ•°ä½œä¸ºé»˜è®¤æ–¹æ³•ã€‚æ²¡æœ‰å‚æ•°çš„listè¿”å›ä¸€ä¸ªç©ºåˆ—è¡¨ï¼Œå› æ­¤å¦‚æœåç§°ä¸å­˜åœ¨åˆ™defaultdictè°ƒç”¨list()ï¼Œç„¶åå†æŠŠå­¦ç”Ÿæˆç»©æ·»åŠ ä¸Šã€‚å¦‚æœä½ æƒ³æ›´ç‚«ä¸€ç‚¹ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨lambdaå‡½æ•°ä½œä¸ºå€¼æ¥è¿”å›ä»»æ„å¸¸é‡ã€‚åœ¨ç”¨æˆ·åˆ›å»º defaultdict å¯¹è±¡çš„æ—¶å€™ï¼Œå°±éœ€è¦ç»™å®ƒé…ç½®ä¸€ä¸ªä¸ºæ‰¾ä¸åˆ°çš„é”®åˆ›é€ é»˜è®¤å€¼çš„æ–¹æ³•ã€‚å®ä¾‹åŒ–ä¸€ä¸ª defaultdict çš„æ—¶å€™ï¼Œéœ€è¦ç»™æ„é€ æ–¹æ³•æä¾›ä¸€ä¸ªå¯è°ƒç”¨å¯¹è±¡æŠŠ list æ„é€ æ–¹æ³•ä½œä¸º default_factory æ¥åˆ›å»ºä¸€ä¸ª defaultdictã€‚defaultdict é‡Œçš„ default_factory åªä¼šåœ¨ __getitem__ é‡Œè¢«è°ƒç”¨ï¼Œåœ¨å…¶ä»–çš„æ–¹æ³•é‡Œå®Œå…¨ä¸ä¼šå‘æŒ¥ä½œç”¨ã€‚æ¯”å¦‚ï¼Œdd æ˜¯ä¸ª defaultdictï¼Œk æ˜¯ä¸ªæ‰¾ä¸åˆ°çš„é”®ï¼Œ dd[k] è¿™ä¸ªè¡¨è¾¾å¼ä¼šè°ƒç”¨ default_factory åˆ›é€ æŸä¸ªé»˜è®¤å€¼ï¼Œè€Œ dd.get(k) åˆ™ä¼šè¿”å› Noneã€‚æ‰€æœ‰çš„æ˜ å°„ç±»å‹åœ¨å¤„ç†æ‰¾ä¸åˆ°çš„é”®çš„æ—¶å€™ï¼Œéƒ½ä¼šç‰µæ‰¯åˆ° __missing__ æ–¹æ³•ã€‚è¿™ä¹Ÿæ˜¯è¿™ä¸ªæ–¹æ³•ç§°ä½œâ€œmissingâ€çš„åŸå› å¦‚æœæœ‰ä¸€ä¸ªç±»ç»§æ‰¿äº† dictï¼Œç„¶åè¿™ä¸ªç»§æ‰¿ç±»æä¾›äº† __missing__ æ–¹æ³•ï¼Œé‚£ä¹ˆåœ¨ __getitem__ ç¢°åˆ°æ‰¾ä¸åˆ°çš„é”®çš„æ—¶å€™ï¼ŒPython å°±ä¼šè‡ªåŠ¨è°ƒç”¨å®ƒ__missing__ æ–¹æ³•åªä¼šè¢« __getitem__ è°ƒç”¨åƒ k in my_dict.keys() è¿™ç§æ“ä½œåœ¨ Python 3 ä¸­æ˜¯å¾ˆå¿«çš„ï¼Œè€Œä¸”å³ä¾¿æ˜ å°„ç±»å‹å¯¹è±¡å¾ˆåºå¤§ä¹Ÿæ²¡å…³ç³»ã€‚è¿™æ˜¯å› ä¸º dict.keys() çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªâ€œè§†å›¾â€ã€‚è§†å›¾å°±åƒä¸€ä¸ªé›†åˆï¼Œè€Œä¸”è·Ÿå­—å…¸ç±»ä¼¼çš„æ˜¯ï¼Œåœ¨è§†å›¾é‡ŒæŸ¥æ‰¾ä¸€ä¸ªå…ƒç´ çš„é€Ÿåº¦å¾ˆå¿«ã€‚ä»£ç 12345# æ­£ç¡®æ–¹å¼from collections import defaultdictstudent_grades = defaultdict(list)[student_grades[name].append(grade) for name, grade in grades]print(student_grades)è¾“å‡º1defaultdict(&lt;class 'list'&gt;, {'elliot': [91, 88], 'neelam': [98], 'bianca': [81]})ç»Ÿè®¡ç¼ºå¤±å¤šå°‘é”®1234567891011121314151617class CountMissing:   ...:     def __init__(self):   ...:         self.added = 0   ...:     def missing(self):   ...:         self.added += 1    ...:         return 0   ...:     current = {'green':12, 'blue':3}increments = [('red',5),('blue',17),('orange',9)]counter = CountMissing()from collections import defaultdictresult = defaultdict(counter.missing, current)for key,amount in increments:   ...:     result[key] += amount   ...:     print(counter.added)2å…¶å®ƒé»˜è®¤å€¼ä»£ç 1234567891011121314151617181920212223242526# é”™è¯¯æ–¹å¼cowboy = {'age': 32, 'horse': 'mustang', 'hat_size': 'large'}if 'name' in cowboy:name = cowboy['name']else:name = 'The Man with No Name'print(name)# å¦‚æœä½ æƒ³åœ¨ä»ç„¶è®¿é—®nameçš„keyæ—¶ä½¿ç”¨é»˜è®¤å€¼æ›´æ–°å­—å…¸# é”™è¯¯æ–¹å¼if 'name' not in cowboy:cowboy['name'] = 'The Man with No Name'name = cowboy['name']print(name)# æ­£ç¡®æ–¹å¼# get()æ‰§è¡Œä¸ç¬¬ä¸€ç§æ–¹æ³•ç›¸åŒçš„æ“ä½œï¼Œä½†ç°åœ¨å®ƒä»¬ä¼šè‡ªåŠ¨å¤„ç†ã€‚å¦‚æœkeyå­˜åœ¨ï¼Œåˆ™è¿”å›é€‚å½“çš„å€¼ã€‚å¦åˆ™ï¼Œå°†è¿”å›é»˜è®¤å€¼name = cowboy.get('name', 'The Man with No Name')print(name)# æ­£ç¡®æ–¹å¼name = cowboy.setdefault('name', 'The Man with No Name')print(name)from collections import defaultdictdic = defaultdict(lambda :'0a')dic['a']Out[41]: '0a'è¾“å‡º1234The Man with No NameThe Man with No NameThe Man with No NameThe Man with No Nameæœ‰åºè¯å…¸OrderedDictæ¦‚å¿µOrderedDictç±»ä¼¼äºæ­£å¸¸çš„è¯å…¸ï¼Œåªæ˜¯å®ƒè®°ä½äº†å…ƒç´ æ’å…¥çš„é¡ºåºï¼Œå½“åœ¨æœ‰åºçš„è¯å…¸ä¸Šè¿­ä»£æ—¶ï¼Œè¿”å›çš„å…ƒç´ å°±æ˜¯å®ƒä»¬ç¬¬ä¸€æ¬¡æ·»åŠ çš„é¡ºåºã€‚class collections.OrderedDictï¼Œè¿”å›å·²ç»™dictçš„å­ç±»ï¼Œæ”¯æŒå¸¸è§„çš„dictçš„æ–¹æ³•ï¼ŒOrderedDictæ˜¯ä¸€ä¸ªè®°ä½å…ƒç´ é¦–æ¬¡æ’å…¥é¡ºåºçš„è¯å…¸ï¼Œå¦‚æœä¸€ä¸ªå…ƒç´ é‡å†™å·²ç»å­˜åœ¨çš„å…ƒç´ ï¼Œé‚£ä¹ˆåŸå§‹çš„æ’å…¥ä½ç½®ä¿æŒä¸å˜ï¼Œå¦‚æœåˆ é™¤ä¸€ä¸ªå…ƒç´ å†é‡æ–°æ’å…¥ï¼Œé‚£ä¹ˆå®ƒå°±åœ¨æœ«å°¾ã€‚ä½¿ç”¨ä½¿ç”¨dictæ—¶ï¼ŒKeyæ˜¯æ— åºçš„ã€‚åœ¨å¯¹dictåšè¿­ä»£æ—¶ï¼Œæˆ‘ä»¬æ— æ³•ç¡®å®šKeyçš„é¡ºåºã€‚å¦‚æœè¦ä¿æŒKeyçš„é¡ºåºï¼Œå¯ä»¥ç”¨OrderedDictï¼ŒOrderedDictçš„Keyä¼šæŒ‰ç…§æ’å…¥çš„é¡ºåºæ’åˆ—ï¼Œä¸æ˜¯Keyæœ¬èº«æ’åºä¾‹å­1ä»£ç 123456789101112131415161718# ä¾‹å­1from collections import OrderedDictodd0 = {'banana': 3, 'apple': 4}od1 = OrderedDict({'banana': 3, 'apple': 4})od2 = OrderedDict({'apple': 4, 'banana': 3})print(od1 == od2)print(od1 == odd0)# ä¾‹å­2from collections import OrderedDictod1 = OrderedDict({'banana': 3, 'apple': 4})# OrderedDict.popitem(last=True)ï¼Œpopitemæ–¹æ³•è¿”å›å’Œåˆ é™¤ä¸€ä¸ª(key,value)å¯¹ï¼Œå¦‚æœlast=Trueï¼Œå°±ä»¥LIFOæ–¹å¼æ‰§è¡Œï¼Œå¦åˆ™ä»¥FIFOæ–¹å¼æ‰§è¡Œã€‚od1.popitem(False)print(od1)od1.pop('apple')  # è¿™é‡Œå¿…é¡»æä¾›keyprint(od1)è¾“å‡º1234FalseTrueOrderedDict([('apple', 4)])OrderedDict()ä¾‹å­212345678910111213141516171819202122232425# ä¾‹å­3from collections import OrderedDictod1 = OrderedDict({'banana': 3, 'apple': 4})od1.move_to_end('banana')print(od1)# ä¾‹å­4# OrderedDictå¯ä»¥å®ç°ä¸€ä¸ªFIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰çš„dictï¼Œå½“å®¹é‡è¶…å‡ºé™åˆ¶æ—¶ï¼Œå…ˆåˆ é™¤æœ€æ—©æ·»åŠ çš„Keyfrom collections import OrderedDictclass LastUpdatedOrderedDict(OrderedDict):    def __init__(self, capacity):        super(LastUpdatedOrderedDict, self).__init__()        self._capacity = capacity    def __setitem__(self, key, value):        containsKey = 1 if key in self else 0        if len(self) - containsKey &gt;= self._capacity:            last = self.popitem(last=False)            print('remove:', last)        if containsKey:            del self[key]            print('set:', (key, value))        else:            print('add:', (key, value))        OrderedDict.__setitem__(self, key, value)1OrderedDict([('apple', 4), ('banana', 3)])ChainMapåŸå§‹çš„æ˜ å°„å¯¹è±¡è¢«å­˜æ”¾åœ¨ä¸€ä¸ªåˆ—è¡¨ä¸­æ„æˆä¸€ä¸ªå­—å…¸åºåˆ—self.mapsåœ¨ ChainMap ä¸­æŸ¥è¯¢æŸä¸ªé”®æ—¶ï¼Œä¼šå¯¹åŸå§‹çš„æ˜ å°„å¯¹è±¡ä¾æ¬¡æŸ¥è¯¢ï¼Œç›´è‡³æ‰¾åˆ°è¿™ä¸ªé”®ï¼Œè‹¥æœªæ‰¾åˆ°ï¼Œåˆ™é»˜è®¤å¼•å‘ KeyError å¼‚å¸¸ã€‚åœ¨ ChainMap ä¸­è¿›è¡Œæ’å…¥ã€æ›´æ–°ã€åˆ é™¤æ—¶ï¼Œåªä¼šå¯¹åŸå§‹æ˜ å°„ä¸­çš„ç¬¬ä¸€ä¸ªæ˜ å°„è¿›è¡Œæ“ä½œChainMap å¯¹è±¡é™¤äº† maps å±æ€§å¤–ï¼Œè¿˜å…·æœ‰ä¸€ä¸ª parents å±æ€§å’Œ new_child(m=None) æ–¹æ³•ã€‚parents å±æ€§è¿”å›äº†ä¸€ä¸ªä¸åŒ…å«åŸå§‹æ˜ å°„ä¸­çš„ç¬¬ä¸€ä¸ªæ˜ å°„çš„ ChainMap å¯¹è±¡ï¼Œå¯¹åº”æºç ä¸­ self.class(self.maps[1:]) ï¼Œå…¶æ•ˆæœå’Œ ChainMap(d.maps[1:]) ç›¸åŒnew_child(m=None) æ–¹æ³•è¿”å›ä¸€ä¸ªåŒ…å«æŒ‡å®šæ˜ å°„ mï¼ˆæœªæŒ‡å®šæ—¶ï¼Œä¸ºç©ºå­—å…¸ï¼‰åŠå…¶ä»–åŸæœ‰æ˜ å°„çš„ ChainMap å¯¹è±¡ï¼Œå…¶ä¸­æŒ‡å®šæ˜ å°„ä½äºåº•å±‚ maps åˆ—è¡¨é¦–ä½ï¼Œåœ¨å…¶ä»–åŸæœ‰æ˜ å°„ä¹‹å‰ã€‚1234567891011121314151617181920212223242526272829303132# ChainMap ç±»æ˜¯ä¸ºäº†å°†å¤šä¸ªæ˜ å°„å¿«é€Ÿçš„é“¾æ¥åˆ°ä¸€èµ·ï¼Œè¿™æ ·å®ƒä»¬å°±å¯ä»¥ä½œä¸ºä¸€ä¸ªå•å…ƒå¤„ç†ã€‚å®ƒé€šå¸¸æ¯”åˆ›å»ºä¸€ä¸ªæ–°å­—å…¸å’Œå¤šæ¬¡è°ƒç”¨ update() è¦å¿«å¾ˆå¤šfrom collections import ChainMapa = {'a': 1, 'b': 2}b = {'c': 3}c = ChainMap(a, b) # å¦‚æœæœ‰é‡å¤çš„keyï¼Œä»¥ç¬¬ä¸€æ¬¡ä¸ºå‡†print(c)# å°†æ•°æ®ä»¥åˆ—è¡¨å½¢å¼å±•ç°ï¼Œå®é™…ä¸Šæ˜¯å°†é“¾æ¥æŒ‡å‘åŸæ¥çš„å®ç°print(c.maps)print(c.maps[0]['b'])ChainMap({'a': 1, 'b': 2}, {'c': 3})[{'a': 1, 'b': 2}, {'c': 3}]2# ç®€å•åº”ç”¨ä¸€ä¸ªPythonå‘½ä»¤ä¸­ï¼Œå¦‚æœåœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥å‚æ•°åˆ™ä½¿ç”¨è¯¥å‚æ•°ï¼Œæ²¡æœ‰åˆ™ä»OSç¯å¢ƒå˜é‡ä¸­è·å–ï¼Œå¦‚æœè¿˜æ²¡æœ‰å†å–è‡ªå®šä¹‰é»˜è®¤å€¼import osimport argparsefrom collections import ChainMapdefaults = {'color': 'red', 'user': 'guest'}parser = argparse.ArgumentParser()parser.add_argument('-u', '--user')parser.add_argument('-c', '--color')namespace = parser.parse_args()command_line_args = {k: v for k, v in vars(namespace).items() if v}combined = ChainMap(command_line_args, os.environ, defaults)print(combined['color'])print(combined['user'])redguestä½¿ç”¨ ChainMap å¯¹è±¡ä½œä¸ºåµŒå¥—ä¸Šä¸‹æ–‡æˆ‘ä»¬åœ¨ä¸Šé¢æåˆ°äº† new_child(m=None) å¯ç”¨äºåˆ›å»ºå­ä¸Šä¸‹æ–‡ï¼Œè¿™ä¸ªæ˜¯ä¸€ä¸ªéå¸¸ä¾¿æ·çš„æ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªç©ºå­—å…¸æˆ–å…¶ä»–æŒ‡å®šçš„æ˜ å°„æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ ChainMap å¯¹è±¡ã€‚é’ˆå¯¹è¿™ä¸ªæ–°å¯¹è±¡çš„ä¿®æ”¹ä¸ä¼šå¯¹åŸæœ‰çš„ ChainMap å¯¹è±¡ï¼ˆå¯ä»¥å°†å…¶ç†è§£ä¸ºåº•å±‚çš„æ•°æ®ç»“æ„æˆ–è€…åŸºç¡€ä¸Šä¸‹æ–‡ï¼‰äº§ç”Ÿå½±å“ã€‚12345678910111213&gt;&gt;&gt; d_1 = {'name': 'bob', 'age': 25}&gt;&gt;&gt; d_2 = {'height': '175', 'weight': 120}&gt;&gt;&gt; c = ChainMap(d_1, d_2)  # åˆ›å»ºä¸€ä¸ªåŸºç¡€ä¸Šä¸‹æ–‡&gt;&gt;&gt; c_nc = c.new_child()  # åˆ›å»ºä¸€ä¸ªåµŒå¥—çš„å­ä¸Šä¸‹æ–‡&gt;&gt;&gt; c_nc['skill'] = 'Python'  # åœ¨å­ä¸Šä¸‹æ–‡ç¯å¢ƒä¸­è¿›è¡Œèµ‹å€¼&gt;&gt;&gt; cChainMap({'name': 'bob', 'age': 25}, {'height': '175', 'weight': 120})&gt;&gt;&gt; c_ncChainMap({'skill': 'Python'}, {'name': 'bob', 'age': 25}, {'height': '175', 'weight': 120})&gt;&gt;&gt; list(c_nc)['height', 'weight', 'name', 'age', 'skill']&gt;&gt;&gt; dict(c_nc){'height': '175', 'weight': 120, 'name': 'bob', 'age': 25, 'skill': 'Python'}è®¡æ•°å™¨CounterPs: Counterä»…æ”¯æŒHashableå¯¹è±¡è¿›è¡Œç»Ÿè®¡å®šä¹‰å‡å¦‚ä½ æœ‰ä¸€é•¿ä¸²æ²¡æœ‰æ ‡ç‚¹ç¬¦å·æˆ–å¤§å†™å­—æ¯çš„å•è¯ï¼Œä½ æƒ³è¦è®¡ç®—æ¯ä¸ªå•è¯å‡ºç°çš„æ¬¡æ•°ã€‚ä½ å¯ä»¥ä½¿ç”¨å­—å…¸æˆ–defaultdictå¢åŠ è®¡æ•°ï¼Œä½†collections.Counteræä¾›äº†ä¸€ç§æ›´æ¸…æ™°ï¼Œæ›´æ–¹ä¾¿çš„æ–¹æ³•ã€‚ Counteræ˜¯dictçš„å­ç±»ï¼Œå®ƒä½¿ç”¨0ä½œä¸ºä»»ä½•ç¼ºå¤±å…ƒç´ çš„é»˜è®¤å€¼ï¼Œå¹¶ä¸”æ›´å®¹æ˜“è®¡ç®—å¯¹è±¡çš„å‡ºç°æ¬¡æ•°ï¼š1234567from collections import Counterwords = &quot;if there was there was but if there was not there was not&quot;.split()# æˆ–è€…  counts = Counter(if=2,there=4,was=4,not=2,but=1) # ä¼ è¿›å…ƒç»„counts = Counter(words)print(counts)&gt;&gt;&gt; Counter({'there': 4, 'was': 4, 'if': 2, 'not': 2, 'but': 1})éå†å…ƒç´ éå†æ‰€æœ‰å…ƒç´ 12345678910# å½“ä½ å°†å•è¯åˆ—è¡¨ä¼ é€’ç»™Counteræ—¶ï¼Œå®ƒä¼šå­˜å‚¨æ¯ä¸ªå•è¯ä»¥åŠè¯¥å•è¯åœ¨åˆ—è¡¨ä¸­å‡ºç°çš„æ¬¡æ•°ã€‚# å¦‚æœä½ å¥½å¥‡ä¸¤ä¸ªæœ€å¸¸è§çš„è¯æ˜¯ä»€ä¹ˆï¼Ÿåªéœ€ä½¿ç”¨.most_commonï¼ˆï¼‰ï¼šprint(counts.most_common(2))# éå†æ‰€æœ‰å…ƒç´ for k, v in counts.items():print(k, v)# éå†æ‰“å°æ‰€æœ‰å…ƒç´ print(sorted(counts.elements()))123456789[('there', 4), ('was', 4)]if 2there 4was 4but 1not 2['but', 'if', 'if', 'not', 'not', 'there', 'there', 'there', 'there', 'was', 'was', 'was', 'was']æ›´æ–°å…ƒç´ 123456789101112# update(å¢åŠ å…ƒç´ )counts.update(&quot;if you are here&quot;.split())print(counts)# subtract(åŸæ¥çš„å…ƒç´ å‡å»æ–°ä¼ å…¥çš„å…ƒç´ )counts.subtract(['if'])  # ifçš„æ¬¡æ•°å‡ä¸€print(counts)# åˆ é™¤å…ƒç´ counts['but'] = 0del counts['but']print(counts)123Counter({'there': 4, 'was': 4, 'if': 3, 'not': 2, 'but': 1, 'you': 1, 'are': 1, 'here': 1})Counter({'there': 4, 'was': 4, 'if': 2, 'not': 2, 'but': 1, 'you': 1, 'are': 1, 'here': 1})Counter({'there': 4, 'was': 4, 'if': 2, 'not': 2, 'you': 1, 'are': 1, 'here': 1})ç±»é›†åˆæ“ä½œ123456c = Counter(a=3, b=1)d = Counter(a=1, b=2)print(c + d)  # ç›¸åŠ print(c - d)  # ç›¸å‡ï¼Œå¦‚æœå°äºç­‰äº0ï¼Œåˆ å»print(c &amp; d)  # æ±‚æœ€å°print(c | d)  # æ±‚æœ€å¤§1234Counter({'a': 4, 'b': 3})Counter({'a': 2})Counter({'a': 1, 'b': 1})Counter({'a': 3, 'b': 2})å­ç±»åŒ–UserDictå°±åˆ›é€ è‡ªå®šä¹‰æ˜ å°„ç±»å‹æ¥è¯´ï¼Œä»¥ UserDict ä¸ºåŸºç±»ï¼Œæ€»æ¯”ä»¥æ™®é€šçš„ dict ä¸ºåŸºç±»è¦æ¥å¾—æ–¹ä¾¿ã€‚è€Œæ›´å€¾å‘äºä» UserDict è€Œä¸æ˜¯ä» dict ç»§æ‰¿çš„ä¸»è¦åŸå› æ˜¯ï¼Œåè€…æœ‰æ—¶ä¼šåœ¨æŸäº›æ–¹æ³•çš„å®ç°ä¸Šèµ°ä¸€äº›æ·å¾„ï¼Œå¯¼è‡´æˆ‘ä»¬ä¸å¾—ä¸åœ¨å®ƒçš„å­ç±»ä¸­é‡å†™è¿™äº›æ–¹æ³•ï¼Œä½†æ˜¯ UserDict å°±ä¸ä¼šå¸¦æ¥è¿™äº›é—®é¢˜ã€‚å€¼å¾—æ³¨æ„çš„åœ°æ–¹æ˜¯ï¼ŒUserDict å¹¶ä¸æ˜¯ dict çš„å­ç±»ï¼Œä½†æ˜¯ UserDict æœ‰ä¸€ä¸ªå«ä½œ data çš„å±æ€§ï¼Œæ˜¯ dict çš„å®ä¾‹ï¼Œè¿™ä¸ªå±æ€§å®é™…ä¸Šæ˜¯ UserDict æœ€ç»ˆå­˜å‚¨æ•°æ®çš„åœ°æ–¹ã€‚åŒå‘é˜Ÿåˆ—dequeå®šä¹‰dequeæ˜¯æ ˆå’Œé˜Ÿåˆ—çš„ä¸€ç§å¹¿ä¹‰å®ç°ï¼Œdequeæ˜¯â€double-end queueâ€çš„ç®€ç§°ï¼›dequeæ”¯æŒçº¿ç¨‹å®‰å…¨ã€æœ‰æ•ˆå†…å­˜åœ°ä»¥è¿‘ä¼¼O(1)çš„æ€§èƒ½åœ¨dequeçš„ä¸¤ç«¯æ’å…¥å’Œåˆ é™¤å…ƒç´ ï¼Œå°½ç®¡listä¹Ÿæ”¯æŒç›¸ä¼¼çš„æ“ä½œï¼Œä½†æ˜¯å®ƒä¸»è¦åœ¨å›ºå®šé•¿åº¦æ“ä½œä¸Šçš„ä¼˜åŒ–ï¼Œä»è€Œåœ¨pop(0)å’Œinsert(0,v)ï¼ˆä¼šæ”¹å˜æ•°æ®çš„ä½ç½®å’Œå¤§å°ï¼‰ä¸Šæœ‰O(n)çš„æ—¶é—´å¤æ‚åº¦ã€‚å¸¸ç”¨æ–¹æ³•dequeæ”¯æŒå¦‚ä¸‹æ–¹æ³•ï¼Œappend(x)ï¼Œ å°†xæ·»åŠ åˆ°dequeçš„å³ä¾§ï¼›appendleft(x)ï¼Œ å°†xæ·»åŠ åˆ°dequeçš„å·¦ä¾§ï¼›clear()ï¼Œ å°†dequeä¸­çš„å…ƒç´ å…¨éƒ¨åˆ é™¤ï¼Œæœ€åé•¿åº¦ä¸º0ï¼›count(x)ï¼Œ è¿”å›dequeä¸­å…ƒç´ ç­‰äºxçš„ä¸ªæ•°ï¼›extend(iterable)ï¼Œ å°†å¯è¿­ä»£å˜é‡iterableä¸­çš„å…ƒç´ æ·»åŠ è‡³dequeçš„å³ä¾§ï¼›extendleft(iterable)ï¼Œ å°†å˜é‡iterableä¸­çš„å…ƒç´ æ·»åŠ è‡³dequeçš„å·¦ä¾§ï¼Œå¾€å·¦ä¾§æ·»åŠ åºåˆ—çš„é¡ºåºä¸å¯è¿­ä»£å˜é‡iterableä¸­çš„å…ƒç´ ç›¸åï¼›pop()ï¼Œ ç§»é™¤å’Œè¿”å›dequeä¸­æœ€å³ä¾§çš„å…ƒç´ ï¼Œå¦‚æœæ²¡æœ‰å…ƒç´ ï¼Œå°†ä¼šæŠ¥å‡ºIndexErrorï¼›popleft()ï¼Œ ç§»é™¤å’Œè¿”å›dequeä¸­æœ€å·¦ä¾§çš„å…ƒç´ ï¼Œå¦‚æœæ²¡æœ‰å…ƒç´ ï¼Œå°†ä¼šæŠ¥å‡ºIndexErrorï¼›remove(value)ï¼Œ ç§»é™¤ç¬¬ä¸€æ¬¡å‡ºç°çš„valueï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼ŒæŠ¥å‡ºValueErrorï¼›reverse()ï¼Œ åè½¬dequeä¸­çš„å…ƒç´ ï¼Œå¹¶è¿”å›Noneï¼›rotate(n)ï¼Œ ä»å³ä¾§åè½¬næ­¥ï¼Œå¦‚æœnä¸ºè´Ÿæ•°ï¼Œåˆ™ä»å·¦ä¾§åè½¬ï¼Œd.rotate(1)ç­‰äºd.appendleft(d.pop())ï¼›maxlenï¼Œ åªè¯»çš„å±æ€§ï¼Œdequeçš„æœ€å¤§é•¿åº¦ï¼Œå¦‚æœæ— è§£ï¼Œå°±è¿”å›Noneï¼›é™¤äº†ä»¥ä¸Šçš„æ–¹æ³•ä¹‹å¤–ï¼Œdequeè¿˜æ”¯æŒè¿­ä»£ã€åºåˆ—åŒ–ã€len(d)ã€reversed(d)ã€copy.copy(d)ã€copy.deepcopy(d)ï¼Œé€šè¿‡inæ“ä½œç¬¦è¿›è¡Œæˆå‘˜æµ‹è¯•å’Œä¸‹æ ‡ç´¢å¼•ï¼Œç´¢å¼•çš„æ—¶é—´å¤æ‚åº¦æ˜¯åœ¨ä¸¤ç«¯æ˜¯O(1)ï¼Œåœ¨ä¸­é—´æ˜¯O(n)ï¼Œä¸ºäº†å¿«é€Ÿè·å–ï¼Œå¯ä»¥ä½¿ç”¨listä»£æ›¿ã€‚â€‹    indexï¼ˆæŸ¥æ‰¾æŸä¸ªå…ƒç´ çš„ç´¢å¼•ä½ç½®ï¼‰insertï¼ˆåœ¨æŒ‡å®šä½ç½®æ’å…¥å…ƒç´ ï¼‰12345678910111213141516171819202122232425262728293031323334353637383940414243444546&gt;&gt;&gt; from collections import deque&gt;&gt;&gt; d = deque('ghi')# æ–°å»ºä¸€ä¸ªdequeï¼Œæœ‰ä¸‰ä¸ªå…ƒç´ &gt;&gt;&gt; for ele in d:# éå†deque...     print ele.upper()...     ... GHI&gt;&gt;&gt; d.append('j')# dequeå³ä¾§æ·»åŠ ä¸€ä¸ªå…ƒç´ &gt;&gt;&gt; d.appendleft('f')# dequeå·¦ä¾§æ·»åŠ ä¸€ä¸ªå…ƒç´ &gt;&gt;&gt; d# æ‰“å°dequedeque(['f', 'g', 'h', 'i', 'j'])&gt;&gt;&gt; d.pop()# è¿”å›å’Œç§»é™¤æœ€å³ä¾§å…ƒç´ 'j'&gt;&gt;&gt; d.popleft()# è¿”å›å’Œç§»é™¤æœ€å·¦ä¾§å…ƒç´ 'f'&gt;&gt;&gt; list(d)# ä»¥åˆ—è¡¨å½¢å¼å±•ç¤ºå‡ºdequeçš„å†…å®¹['g', 'h', 'i']&gt;&gt;&gt; d[0]# è·å–æœ€å·¦ä¾§çš„å…ƒç´ 'g'&gt;&gt;&gt; d[-1]# è·å–æœ€å³ä¾§çš„å…ƒç´ 'i'&gt;&gt;&gt; list(reversed(d))# ä»¥åˆ—è¡¨å½¢å¼å±•ç¤ºå‡ºå€’åºçš„dequeçš„å†…å®¹['i', 'h', 'g']&gt;&gt;&gt; 'h' in d# åœ¨dequeä¸­æœç´¢True&gt;&gt;&gt; d.extend('jkl')# ä¸€æ¬¡æ·»åŠ å¤šä¸ªå…ƒç´ &gt;&gt;&gt; ddeque(['g', 'h', 'i', 'j', 'k', 'l'])&gt;&gt;&gt; d.rotate(1)# å¾€å³ä¾§ç¿»è½¬&gt;&gt;&gt; ddeque(['l', 'g', 'h', 'i', 'j', 'k'])&gt;&gt;&gt; d.rotate(-1)# å¾€å·¦ä¾§ç¿»è½¬&gt;&gt;&gt; ddeque(['g', 'h', 'i', 'j', 'k', 'l'])&gt;&gt;&gt; deque(reversed(d))# ä»¥é€†åºæ–°å»ºä¸€ä¸ªdequedeque(['l', 'k', 'j', 'i', 'h', 'g'])&gt;&gt;&gt; d.clear()# æ¸…ç©ºdeque&gt;&gt;&gt; d.pop()# ä¸èƒ½åœ¨ç©ºçš„dequeä¸ŠpopTraceback (most recent call last):  File &quot;&lt;input&gt;&quot;, line 1, in &lt;module&gt;IndexError: pop from an empty deque&gt;&gt;&gt; d.extendleft('abc')# ä»¥è¾“å…¥çš„é€†åºå‘å·¦æ‰©å±•&gt;&gt;&gt; ddeque(['c', 'b', 'a'])12345678910111213# dequeæ˜¯ä¸ºäº†é«˜æ•ˆå®ç°æ’å…¥å’Œåˆ é™¤æ“ä½œçš„åŒå‘åˆ—è¡¨ï¼Œé€‚åˆç”¨äºé˜Ÿåˆ—å’Œæ ˆï¼š# ä½¿ç”¨listå­˜å‚¨æ•°æ®æ—¶ï¼ŒæŒ‰ç´¢å¼•è®¿é—®å…ƒç´ å¾ˆå¿«ï¼Œä½†æ˜¯æ’å…¥å’Œåˆ é™¤å…ƒç´ å°±å¾ˆæ…¢äº†ï¼Œå› ä¸ºlistæ˜¯çº¿æ€§å­˜å‚¨ï¼Œæ•°æ®é‡å¤§çš„æ—¶å€™ï¼Œæ’å…¥å’Œåˆ é™¤æ•ˆç‡å¾ˆä½ã€‚&gt;&gt;&gt; from collections import deque&gt;&gt;&gt; q = deque(['a', 'b', 'c'])&gt;&gt;&gt; q.append('x')&gt;&gt;&gt; q.appendleft('y')&gt;&gt;&gt; qdeque(['y', 'a', 'b', 'c', 'x'])# dequeé™¤äº†å®ç°listçš„append()å’Œpop()å¤–ï¼Œè¿˜æ”¯æŒappendleft()å’Œpopleft()ï¼Œè¿™æ ·å°±å¯ä»¥éå¸¸é«˜æ•ˆåœ°å¾€å¤´éƒ¨æ·»åŠ æˆ–åˆ é™¤å…ƒç´ # dequeæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæœ‰GILä¿æŠ¤# appendå’Œpopleftéƒ½æ˜¯åŸå­æ“ä½œmultiprocessingï¼šè¿™ä¸ªåŒ…å®ç°äº†è‡ªå·±çš„Queueï¼Œå®ƒå’Œqueue.Queueç±»ä¼¼ï¼Œæ˜¯è®¾è®¡ç»™è¿›ç¨‹é—´é€šä¿¡ä½¿ç”¨çš„ã€‚åŒæ—¶è¿˜æœ‰ä¸ªmultiprocessing.JoinableQueueç±»å‹ï¼Œå¯ä»¥è®©ä»»åŠ¡ç®¡ç†å˜å¾—æ›´æ–¹ä¾¿ã€‚asyncioï¼špython3.4æ–°æä¾›çš„åŒ…ï¼Œé‡Œé¢æœ‰Queueã€LifoQueueã€PriorityQueueå’ŒJoinableQueueï¼Œè¿™äº›ç±»å—åˆ°queueå’Œmulitiprocessingæ¨¡å—çš„å½±å“ï¼Œä½†æ˜¯ä¸ºå¼‚æ­¥ç¼–ç¨‹é‡Œçš„ä»»åŠ¡ç®¡ç†æä¾›äº†ä¾¿åˆ©ã€‚å­ç±»åŒ–UserDictUserDictå°è£…äº†å­—å…¸å¯¹è±¡ï¼Œç®€åŒ–äº†å­—å…¸å­ç±»åŒ–UserListå°è£…äº†åˆ—è¡¨å¯¹è±¡ï¼Œç®€åŒ–äº†åˆ—è¡¨å­ç±»åŒ–UserStringå°è£…äº†åˆ—è¡¨å¯¹è±¡ï¼Œç®€åŒ–äº†å­—ç¬¦ä¸²å­ç±»åŒ–</content>
	</entry>
	<entry>
		<title>loggingæ¨¡å—</title>
		<url>/article/12909.html</url>
		<content>pythonçš„æ—¥å¿—æ¨¡å—loggingPython Logging æŒ‡å—Pythonæ—¥å¿—åº“loggingæ€»ç»“-å¯èƒ½æ˜¯ç›®å‰ä¸ºæ­¢å°†loggingåº“æ€»ç»“çš„æœ€å¥½çš„ä¸€ç¯‡æ–‡ç« python loggingæ—¥å¿—æ¨¡å—ä»¥åŠå¤šè¿›ç¨‹æ—¥å¿—Pythoné…ç½®æ—¥å¿—çš„å‡ ç§æ–¹å¼logging æ¨¡å—åœ¨éƒ¨ç½²é¡¹ç›®æ—¶ï¼Œä¸å¯èƒ½ç›´æ¥å°†æ‰€æœ‰çš„ä¿¡æ¯éƒ½è¾“å‡ºåˆ°æ§åˆ¶å°ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™äº›ä¿¡æ¯è®°å½•åˆ°æ—¥å¿—æ–‡ä»¶ä¸­è¿™æ ·ä¸ä»…æ–¹ä¾¿æˆ‘ä»¬æŸ¥çœ‹ç¨‹åºè¿è¡Œæ—¶çš„æƒ…å†µï¼Œä¹Ÿå¯ä»¥åœ¨é¡¹ç›®å‡ºç°æ•…éšœæ—¶æ ¹æ®è¿è¡Œæ—¶äº§ç”Ÿçš„æ—¥å¿—å¿«é€Ÿå®šä½é—®é¢˜å‡ºç°çš„ä½ç½®loggingæ¡†æ¶ç»„æˆï¼šLoggers: æ—¥å¿—ï¼Œæš´éœ²å‡½æ•°ç»™åº”ç”¨ç¨‹åºï¼ŒåŸºäºæ—¥å¿—è®°å½•å™¨å’Œè¿‡æ»¤å™¨çº§åˆ«å†³å®šå“ªäº›æ—¥å¿—æœ‰æ•ˆã€‚LogRecord ï¼šæ—¥å¿—è®°å½•å™¨ï¼Œå°†æ—¥å¿—ä¼ åˆ°ç›¸åº”çš„å¤„ç†å™¨å¤„ç†ã€‚Handlers: å¤„ç†å™¨, å°†(æ—¥å¿—è®°å½•å™¨äº§ç”Ÿçš„)æ—¥å¿—è®°å½•å‘é€è‡³åˆé€‚çš„ç›®çš„åœ°ã€‚å¸¸ç”¨ç±»å‹æœ‰StreamHandlerã€FileHandlerã€NullHandlerFilters: è¿‡æ»¤å™¨, æä¾›äº†æ›´å¥½çš„ç²’åº¦æ§åˆ¶,å®ƒå¯ä»¥å†³å®šè¾“å‡ºå“ªäº›æ—¥å¿—è®°å½•ã€‚Formatters: æ ¼å¼åŒ–å™¨, æŒ‡æ˜äº†æœ€ç»ˆè¾“å‡ºä¸­æ—¥å¿—è®°å½•çš„å¸ƒå±€ã€‚loggingæ—¥å¿—çº§åˆ«ï¼šæ¯ä¸ªloggeréƒ½æœ‰ä¸€ä¸ªæ—¥å¿—çš„çº§åˆ«ã€‚loggingä¸­å®šä¹‰äº†å¦‚ä¸‹çº§åˆ«LevelNumeric valueè§£é‡ŠNOTSET0æ„æŒ‡ä¸è®¾ç½® æ‰€ä»¥æŒ‰ç…§çˆ¶loggerçº§åˆ«æ¥è¿‡æ»¤æ—¥å¿—DEBUG10è¯¦ç»†ä¿¡æ¯ï¼Œé€šå¸¸ä»…åœ¨è¯Šæ–­é—®é¢˜æ—¶æ‰æœ‰æ„ä¹‰INFO20ç¡®è®¤äº‹æƒ…æŒ‰é¢„æœŸå·¥ä½œWARNING30è¡¨æ˜å‘ç”Ÿäº†æ„å¤–æƒ…å†µï¼Œæˆ–è¡¨æ˜åœ¨ä¸ä¹…çš„å°†æ¥å‡ºç°äº†ä¸€äº›é—®é¢˜ï¼ˆä¾‹å¦‚ â€œç£ç›˜ç©ºé—´ä¸è¶³â€ï¼‰ã€‚ä½†æ˜¯è¯¥è½¯ä»¶ä»åœ¨æŒ‰é¢„æœŸå·¥ä½œERROR40ç”±äºæ›´ä¸¥é‡çš„é—®é¢˜ï¼Œè¯¥è½¯ä»¶æ— æ³•æ‰§è¡ŒæŸäº›åŠŸèƒ½CRITICAL50ä¸¥é‡é”™è¯¯ï¼Œè¡¨æ˜ç¨‹åºæœ¬èº«å¯èƒ½æ— æ³•ç»§ç»­è¿è¡Œæ³¨æ„äº‹é¡¹ï¼šä½†æ˜¯å½“å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œç›´æ¥ä½¿ç”¨æ— å‚æ•°çš„ debug()ã€info()ã€warning()ã€error()ã€critical() æ–¹æ³•å¹¶ä¸èƒ½è®°å½•å¼‚å¸¸ä¿¡æ¯éœ€è¦è®¾ç½® exc_info å‚æ•°ä¸º True æ‰å¯ä»¥ï¼Œæˆ–è€…ä½¿ç”¨ exception() æ–¹æ³•ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ log() æ–¹æ³•ï¼Œä½†è¿˜è¦è®¾ç½®æ—¥å¿—çº§åˆ«å’Œ exc_info å‚æ•°12345678910111213import logginglogging.basicConfig(filename=&quot;test.log&quot;, filemode=&quot;w&quot;, format=&quot;%(asctime)s %(name)s:%(levelname)s:%(message)s&quot;,                    datefmt=&quot;%d-%M-%Y %H:%M:%S&quot;, level=logging.DEBUG)a = 5b = 0try:    c = a / bexcept Exception as e:    # ä¸‹é¢ä¸‰ç§æ–¹å¼ä¸‰é€‰ä¸€ï¼Œæ¨èä½¿ç”¨ç¬¬ä¸€ç§    logging.exception(&quot;Exception occurred&quot;)    logging.error(&quot;Exception occurred&quot;, exc_info=True)    logging.log(level=logging.DEBUG, msg=&quot;Exception occurred&quot;, exc_info=True)logging æµç¨‹åˆ¤æ–­ Logger å¯¹è±¡å¯¹äºè®¾ç½®çš„çº§åˆ«æ˜¯å¦å¯ç”¨ï¼Œå¦‚æœå¯ç”¨ï¼Œåˆ™å¾€ä¸‹æ‰§è¡Œï¼Œå¦åˆ™ï¼Œæµç¨‹ç»“æŸã€‚åˆ›å»º LogRecord å¯¹è±¡ï¼Œå¦‚æœæ³¨å†Œåˆ° Logger å¯¹è±¡ä¸­çš„ Filter å¯¹è±¡è¿‡æ»¤åè¿”å› Falseï¼Œåˆ™ä¸è®°å½•æ—¥å¿—ï¼Œæµç¨‹ç»“æŸï¼Œå¦åˆ™ï¼Œåˆ™å‘ä¸‹æ‰§è¡Œã€‚LogRecord å¯¹è±¡å°† Handler å¯¹è±¡ä¼ å…¥å½“å‰çš„ Logger å¯¹è±¡ï¼Œï¼ˆå›¾ä¸­çš„å­æµç¨‹ï¼‰å¦‚æœ Handler å¯¹è±¡çš„æ—¥å¿—çº§åˆ«å¤§äºè®¾ç½®çš„æ—¥å¿—çº§åˆ«ï¼Œå†åˆ¤æ–­æ³¨å†Œåˆ° Handler å¯¹è±¡ä¸­çš„ Filter å¯¹è±¡è¿‡æ»¤åæ˜¯å¦è¿”å› True è€Œæ”¾è¡Œè¾“å‡ºæ—¥å¿—ä¿¡æ¯ï¼Œå¦åˆ™ä¸æ”¾è¡Œï¼Œæµç¨‹ç»“æŸã€‚å¦‚æœä¼ å…¥çš„ Handler å¤§äº Logger ä¸­è®¾ç½®çš„çº§åˆ«ï¼Œä¹Ÿå³ Handler æœ‰æ•ˆï¼Œåˆ™å¾€ä¸‹æ‰§è¡Œï¼Œå¦åˆ™ï¼Œæµç¨‹ç»“æŸã€‚åˆ¤æ–­è¿™ä¸ª Logger å¯¹è±¡æ˜¯å¦è¿˜æœ‰çˆ¶ Logger å¯¹è±¡ï¼Œå¦‚æœæ²¡æœ‰ï¼ˆä»£è¡¨å½“å‰ Logger å¯¹è±¡æ˜¯æœ€é¡¶å±‚çš„ Logger å¯¹è±¡ root Loggerï¼‰ï¼Œæµç¨‹ç»“æŸã€‚å¦åˆ™å°† Logger å¯¹è±¡è®¾ç½®ä¸ºå®ƒçš„çˆ¶ Logger å¯¹è±¡ï¼Œé‡å¤ä¸Šé¢çš„ 3ã€4 ä¸¤æ­¥ï¼Œè¾“å‡ºçˆ¶ç±» Logger å¯¹è±¡ä¸­çš„æ—¥å¿—è¾“å‡ºï¼Œç›´åˆ°æ˜¯ root Logger ä¸ºæ­¢ã€‚Logger ä½¿ç”¨logging é…ç½®pythonä»£ç ä½¿ç”¨Pythonä»£ç æ˜¾å¼çš„åˆ›å»ºloggersï¼Œhandlerså’Œformatterså¹¶åˆ†åˆ«è°ƒç”¨å®ƒä»¬çš„é…ç½®å‡½æ•°é€šè¿‡ç®€å•æ–¹å¼è¿›è¡Œé…ç½®ï¼Œä½¿ç”¨ basicConfig() å‡½æ•°ç›´æ¥è¿›è¡Œé…ç½®ï¼›ä»£ç Logger å¯¹è±¡å’Œ Handler å¯¹è±¡éƒ½å¯ä»¥è®¾ç½®çº§åˆ«ï¼Œè€Œé»˜è®¤ Logger å¯¹è±¡çº§åˆ«ä¸º 30 ï¼Œä¹Ÿå³ WARNINGï¼Œé»˜è®¤ Handler å¯¹è±¡çº§åˆ«ä¸º 0ï¼Œä¹Ÿå³ NOTSETã€‚logging æ¨¡å—è¿™æ ·è®¾è®¡æ˜¯ä¸ºäº†æ›´å¥½çš„çµæ´»æ€§ï¼Œæ¯”å¦‚æœ‰æ—¶å€™æˆ‘ä»¬æ—¢æƒ³åœ¨æ§åˆ¶å°ä¸­è¾“å‡ºDEBUG çº§åˆ«çš„æ—¥å¿—ï¼Œåˆæƒ³åœ¨æ–‡ä»¶ä¸­è¾“å‡ºWARNINGçº§åˆ«çš„æ—¥å¿—ã€‚å¯ä»¥åªè®¾ç½®ä¸€ä¸ªæœ€ä½çº§åˆ«çš„ Logger å¯¹è±¡ï¼Œä¸¤ä¸ªä¸åŒçº§åˆ«çš„ Handler å¯¹è±¡ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š123456789101112131415161718192021222324252627282930import loggingimport logging.handlerslogger = logging.getLogger(&quot;logger&quot;)handler1 = logging.StreamHandler()handler2 = logging.FileHandler(filename=&quot;test.log&quot;, encoding=&quot;utf-8&quot;)logger.setLevel(logging.DEBUG)handler1.setLevel(logging.WARNING)handler2.setLevel(logging.DEBUG)formatter = logging.Formatter(&quot;%(asctime)s %(name)s %(levelname)s %(message)s&quot;)handler1.setFormatter(formatter)handler2.setFormatter(formatter)logger.addHandler(handler1)logger.addHandler(handler2)# åˆ†åˆ«ä¸º 10ã€30ã€30# print(handler1.level)# print(handler2.level)# print(logger.level)logger.debug('This is a customer debug message')logger.info('This is an customer info message')logger.warning('This is a customer warning message')logger.error('This is an customer error message')logger.critical('This is a customer critical message')æˆ–è€…123456789logging.basicConfig(filename=&quot;config.log&quot;,                    filemode=&quot;w&quot;,                    format=&quot;%(asctime)s-%(name)s-%(levelname)s-%(message)s&quot;,                    level=logging.INFO)logging.basicConfig(level=log_level,                    format='%(asctime)s %(filename)s[line:%(lineno)d] %(levelname)s %(message)s',                    datefmt='%a, %d %b %Y %H:%M:%S',                    filename='parser_result.log',                    filemode='w')å‚æ•°è¯´æ˜å‚æ•°åç§°å‚æ•°æè¿°filenameæ—¥å¿—è¾“å‡ºåˆ°æ–‡ä»¶çš„æ–‡ä»¶åfilemodeæ–‡ä»¶æ¨¡å¼ï¼Œr[+]ã€w[+]ã€a[+]formatæ—¥å¿—è¾“å‡ºçš„æ ¼å¼datefatæ—¥å¿—é™„å¸¦æ—¥æœŸæ—¶é—´çš„æ ¼å¼styleæ ¼å¼å ä½ç¬¦ï¼Œé»˜è®¤ä¸º â€œ%â€ å’Œ â€œ{}â€levelè®¾ç½®æ—¥å¿—è¾“å‡ºçº§åˆ«streamå®šä¹‰è¾“å‡ºæµï¼Œç”¨æ¥åˆå§‹åŒ– StreamHandler å¯¹è±¡ä¸èƒ½ filename å‚æ•°ä¸€èµ·ä½¿ç”¨ï¼Œå¦åˆ™ä¼šValueError å¼‚å¸¸handleså®šä¹‰å¤„ç†å™¨ï¼Œç”¨æ¥åˆ›å»º Handler å¯¹è±¡ï¼Œä¸èƒ½å’Œ filename ã€stream å‚æ•°ä¸€èµ·ä½¿ç”¨ï¼Œå¦åˆ™ä¹Ÿä¼šæŠ›å‡º ValueError å¼‚å¸¸è¾“å‡º123452018-05-06 11:05:34,486 - simple_logger - DEBUG - debug message.2018-05-06 11:05:34,487 - simple_logger - INFO - info message.2018-05-06 11:05:34,487 - simple_logger - WARNING - warning message.2018-05-06 11:05:34,487 - simple_logger - ERROR - error message.2018-05-06 11:05:34,487 - simple_logger - CRITICAL - critical message.é…ç½®æ–‡ä»¶åˆ›å»ºä¸€ä¸ªæ—¥å¿—é…ç½®æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨fileConfig()å‡½æ•°æ¥è¯»å–è¯¥æ–‡ä»¶çš„å†…å®¹ç›¸å¯¹äºç¬¬ä¸€ç§é…ç½®æ–¹å¼çš„ä¼˜ç‚¹åœ¨äºï¼Œå®ƒå°†é…ç½®ä¿¡æ¯å’Œä»£ç åˆ†ç¦»äº†ï¼Œè¿™ä¸€æ–¹é¢é™ä½äº†æ—¥å¿—çš„ç»´æŠ¤æˆæœ¬ï¼ŒåŒæ—¶è¿˜ä½¿å¾—éå¼€æ”¾äººå‘˜ä¹Ÿèƒ½å¤Ÿå¾ˆå®¹æ˜“çš„ä¿®æ”¹æ—¥å¿—é…ç½®é€šè¿‡é…ç½®æ–‡ä»¶è¿›è¡Œé…ç½®ï¼Œä½¿ç”¨fileConfig()å‡½æ•°è¯»å–é…ç½®æ–‡ä»¶å¸¸è§çš„é…ç½®æ–‡ä»¶æœ‰ ini æ ¼å¼ã€yaml æ ¼å¼ã€JSON æ ¼å¼ï¼Œæˆ–è€…ä»ç½‘ç»œä¸­è·å–éƒ½æ˜¯å¯ä»¥çš„é…ç½®æ–‡ä»¶logging.confé…ç½®æ–‡ä»¶ä¸­ä¸€å®šè¦åŒ…å«loggersã€handlersã€formattersè¿™äº›sectionï¼Œå®ƒä»¬é€šè¿‡keysè¿™ä¸ªoptionæ¥æŒ‡å®šè¯¥é…ç½®æ–‡ä»¶ä¸­å·²ç»å®šä¹‰å¥½çš„loggersã€handlerså’Œformattersï¼Œå¤šä¸ªå€¼ä¹‹é—´ç”¨é€—å·åˆ†éš”ï¼›å¦å¤–loggersè¿™ä¸ªsectionä¸­çš„keysä¸€å®šè¦åŒ…å«rootè¿™ä¸ªå€¼ï¼›loggersã€handlersã€formattersä¸­æ‰€æ‰€æŒ‡å®šçš„æ—¥å¿—å™¨ã€å¤„ç†å™¨å’Œæ ¼å¼å™¨éƒ½éœ€è¦åœ¨ä¸‹é¢å•ç‹¬çš„sectionä¸­è¿›è¡Œå®šä¹‰ã€‚sectionçš„å‘½åè§„åˆ™ä¸º[logger_loggerName]ã€[handler_handlerName]ã€[formatter_formatterName]ï¼›å®šä¹‰loggerçš„sectionå¿…é¡»æŒ‡å®šlevelå’Œhandlersè¿™ä¸¤ä¸ªoptionï¼Œlevelçš„å¯å–å€¼ä¸ºDEBUGã€INFOã€WARNINGã€ERRORã€CRITICALã€NOTSETï¼Œå…¶ä¸­NOTSETè¡¨ç¤ºæ‰€æœ‰çº§åˆ«çš„æ—¥å¿—æ¶ˆæ¯éƒ½è¦è®°å½•ï¼ŒåŒ…æ‹¬ç”¨æˆ·å®šä¹‰çº§åˆ«ï¼›handlersçš„å€¼æ˜¯ä»¥é€—å·åˆ†éš”çš„handleråå­—åˆ—è¡¨ï¼Œè¿™é‡Œå‡ºç°çš„handlerå¿…é¡»å‡ºç°åœ¨[handlers]è¿™ä¸ªsectionä¸­ï¼Œå¹¶ä¸”ç›¸åº”çš„handlerå¿…é¡»åœ¨é…ç½®æ–‡ä»¶ä¸­æœ‰å¯¹åº”çš„sectionå®šä¹‰ï¼›å¯¹äºéroot loggeræ¥è¯´ï¼Œé™¤äº†levelå’Œhandlersè¿™ä¸¤ä¸ªoptionä¹‹å¤–ï¼Œè¿˜éœ€è¦ä¸€äº›é¢å¤–çš„optionï¼Œå…¶ä¸­qualnameæ˜¯å¿…é¡»æä¾›çš„optionï¼Œå®ƒè¡¨ç¤ºåœ¨loggerå±‚çº§ä¸­çš„åå­—ï¼Œåœ¨åº”ç”¨ä»£ç ä¸­é€šè¿‡è¿™ä¸ªåå­—å¾—åˆ°loggerï¼›propagateæ˜¯å¯é€‰çš„ï¼Œå…¶é»˜è®¤å€¼ä¸º1ï¼Œè¡¨ç¤ºæ¶ˆæ¯å°†ä¼šä¼ é€’ç»™é«˜å±‚æ¬¡loggerçš„handlerï¼Œé€šå¸¸æˆ‘ä»¬éœ€è¦æŒ‡å®šå…¶å€¼ä¸º0ï¼Œè¿™ä¸ªå¯ä»¥çœ‹ä¸‹é¢çš„ä¾‹å­ï¼›å¦å¤–ï¼Œå¯¹äºéroot loggerçš„levelå¦‚æœè®¾ç½®ä¸ºNOTSETï¼Œç³»ç»Ÿå°†ä¼šæŸ¥æ‰¾é«˜å±‚æ¬¡çš„loggeræ¥å†³å®šæ­¤loggerçš„æœ‰æ•ˆlevelï¼›å®šä¹‰handlerçš„sectionä¸­å¿…é¡»æŒ‡å®šclasså’Œargsè¿™ä¸¤ä¸ªoptionï¼Œlevelå’Œformatterä¸ºå¯é€‰optionï¼›classè¡¨ç¤ºç”¨äºåˆ›å»ºhandlerçš„ç±»åï¼Œargsè¡¨ç¤ºä¼ é€’ç»™classæ‰€æŒ‡å®šçš„handlerç±»åˆå§‹åŒ–æ–¹æ³•å‚æ•°ï¼Œå®ƒå¿…é¡»æ˜¯ä¸€ä¸ªå…ƒç»„(tuple)çš„å½¢å¼ï¼Œå³ä¾¿åªæœ‰ä¸€ä¸ªå‚æ•°å€¼ä¹Ÿéœ€è¦æ˜¯ä¸€ä¸ªå…ƒç»„çš„å½¢å¼ï¼›levelä¸loggerä¸­çš„levelä¸€æ ·ï¼Œè€ŒformatteræŒ‡å®šçš„æ˜¯è¯¥å¤„ç†å™¨æ‰€ä½¿ç”¨çš„æ ¼å¼å™¨ï¼Œè¿™é‡ŒæŒ‡å®šçš„æ ¼å¼å™¨åç§°å¿…é¡»å‡ºç°åœ¨formattersè¿™ä¸ªsectionæ€»ï¼Œä¸”åœ¨é…ç½®æ–‡ä»¶ä¸­å¿…é¡»è¦æœ‰è¿™ä¸ªformatterçš„sectionå®šä¹‰ï¼›å¦‚æœä¸æŒ‡å®šformatteråˆ™è¯¥handlerå°†ä¼šä»¥æ¶ˆæ¯æœ¬èº«ä½œä¸ºæ—¥å¿—æ¶ˆæ¯è¿›è¡Œè®°å½•ï¼Œè€Œä¸æ·»åŠ é¢å¤–çš„æ—¶é—´ã€æ—¥å¿—å™¨åç§°ç­‰ä¿¡æ¯ï¼›å®šä¹‰formatterçš„sectionä¸­çš„optionéƒ½æ˜¯å¯é€‰çš„ï¼Œå…¶ä¸­åŒ…æ‹¬formatç”¨äºæŒ‡å®šæ ¼å¼å­—ç¬¦ä¸²ï¼Œé»˜è®¤ä¸ºæ¶ˆæ¯å­—ç¬¦ä¸²æœ¬èº«ï¼›datefmtç”¨äºæŒ‡å®šasctimeçš„æ—¶é—´æ ¼å¼ï¼Œé»˜è®¤ä¸ºâ€%Y-%m-%d %H:%M:%Sâ€ï¼›classç”¨äºæŒ‡å®šæ ¼å¼å™¨ç±»åï¼Œé»˜è®¤ä¸ºlogging.Formatterï¼›æ¯ä¸€ä¸ªloggeræˆ–è€…handleræˆ–è€…formatteréƒ½æœ‰ä¸€ä¸ªkeyåå­—ï¼Œä»¥loggerä¸ºä¾‹ï¼Œé¦–å…ˆéœ€è¦åœ¨[loggers]é…ç½®ä¸­åŠ ä¸Škeyåå­—ä»£è¡¨äº†è¿™ä¸ªloggerç„¶åç”¨[loggers_xxxx]å…¶ä¸­xxxxä¸ºkeyåæ¥å…·ä½“é…ç½®è¿™ä¸ªloggerï¼Œåœ¨log02ä¸­æˆ‘é…ç½®äº†levelå’Œä¸€ä¸ªhandleråï¼Œå½“ç„¶ä½ å¯ä»¥é…ç½®å¤šä¸ªhanderæ ¹æ®è¿™ä¸ªhandleråå†å» [handlers]é‡Œé¢å»æ‰¾å…·ä½“handlerçš„é…ç½®ï¼Œä»¥æ­¤ç±»æ¨1234567891011121314151617181920212223242526272829303132333435363738##############################################[loggers]keys=root, log02[logger_root]level=INFOhandlers=handler01[logger_log02]level=DEBUGhandler=handler02qualname=log02##############################################[handlers]keys=handler01,handler02[handler_handler01]class=FileHandlerlevel=INFOformatter=form01args=('../log/cv_parser_gm_server.log',&quot;a&quot;)[handler_handler02]class=StreamHandlerlevel=NOTSETformatter=form01args=(sys.stdout,)##############################################[formatters]keys=form01,form02[formatter_form01]format=%(asctime)s %(filename)s[line:%(lineno)d] %(levelname)s %(process)d %(message)sdatefmt=[%Y-%m-%d %H:%M:%S][formatter_form02]format=(message)s##############################################ä»£ç è¯¥å‡½æ•°å®é™…ä¸Šæ˜¯å¯¹configparseræ¨¡å—çš„å°è£…ï¼Œå‡½æ•°å®šä¹‰ï¼šè¯¥å‡½æ•°å®šä¹‰åœ¨logging.configæ¨¡å—ä¸‹1logging.config.fileConfig(fname, defaults=None, disable_existing_loggers=True)å‚æ•°è¯´æ˜ï¼šfnameï¼šè¡¨ç¤ºé…ç½®æ–‡ä»¶çš„æ–‡ä»¶åæˆ–æ–‡ä»¶å¯¹è±¡ï¼›defaultsï¼šæŒ‡å®šä¼ ç»™ConfigParserçš„é»˜è®¤å€¼ï¼›disable_existing_loggersï¼šè¿™æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œé»˜è®¤å€¼ä¸ºTrue(ä¸ºäº†å‘åå…¼å®¹)è¡¨ç¤ºç¦ç”¨å·²ç»å­˜åœ¨çš„loggerï¼Œé™¤éå®ƒä»¬æˆ–å®ƒä»¬çš„ç¥–å…ˆæ˜ç¡®çš„å‡ºç°åœ¨æ—¥å¿—é…ç½®ä¸­ï¼›å¦‚æœè¯¥å€¼ä¸ºFalseï¼Œåˆ™å¯¹å·²å­˜åœ¨çš„loggersä¿æŒå¯åŠ¨çŠ¶æ€1234567891011121314import logging.config# è¯»å–æ—¥å¿—é…ç½®æ–‡ä»¶å†…å®¹logging.config.fileConfig(&quot;logging.conf&quot;)# åˆ›å»ºä¸€ä¸ªæ—¥å¿—å™¨loggerlogger = logging.getLogger(&quot;simpleExample&quot;)# æ—¥å¿—è¾“å‡ºlogger.debug(&quot;debug message.&quot;)logger.info(&quot;info message.&quot;)logger.warning(&quot;warning message.&quot;)logger.error(&quot;error message.&quot;)logger.critical(&quot;critical message.&quot;)è¾“å‡º123452018-05-06 12:29:24,849 - simpleExample - DEBUG - debug message.2018-05-06 12:29:24,849 - simpleExample - INFO - info message.2018-05-06 12:29:24,849 - simpleExample - WARNING - warning message.2018-05-06 12:29:24,849 - simpleExample - ERROR - error message.2018-05-06 12:29:24,849 - simpleExample - CRITICAL - critical message.é…ç½®æ–‡ä»¶test.yaml123456789101112131415161718version: 1formatters:  simple:    format: '%(asctime)s - %(name)s - %(levelname)s - %(message)s'handlers:  console:    class: logging.StreamHandler    level: DEBUG    formatter: simple  loggers:  simpleExample:    level: DEBUG    handlers: [console]    propagate: noroot:  level: DEBUG  handlers: [console]ä»£ç 123456789import logging.config# éœ€è¦å®‰è£… pyymal åº“import yamlwith open('test.yaml', 'r') as f:    config = yaml.safe_load(f.read())    logging.config.dictConfig(config)logger = logging.getLogger(&quot;sampleLogger&quot;)å­—å…¸é…ç½®(æ¨è)åˆ›å»ºä¸€ä¸ªåŒ…å«é…ç½®ä¿¡æ¯çš„dictï¼Œç„¶åæŠŠå®ƒä¼ é€’ç»™dictConfig()å‡½æ•°é€šè¿‡é…ç½®å­—å…¸è¿›è¡Œé…ç½®ï¼Œä½¿ç”¨ dictConfig() å‡½æ•°è¯»å–é…ç½®ä¿¡æ¯logging.FileHandler: æ–‡ä»¶handle, å¤šçº¿ç¨‹ä¸‹å®‰å…¨logging.handlers.RotatingFileHandler: è½®å¾ªæ–‡ä»¶handle, å¤šçº¿ç¨‹ä¸‹å®‰å…¨, å¯ä»¥é™åˆ¶æ–‡ä»¶å¤§å°, è®¾ç½®å†å²æ—¥å¿—æ•°é‡concurrent_log_handler.ConcurrentRotatingFileHandler: å¤šè¿›ç¨‹å¤šçº¿ç¨‹ä¸‹å®‰å…¨, å¯ä»¥é™åˆ¶æ–‡ä»¶å¤§å°, è®¾ç½®å†å²æ—¥å¿—æ•°é‡12pip install redis==4.2.2pip install concurrent-log-handler==0.9.20logging_config.py123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293#!/usr/bin/env Python# -- coding: utf-8 --&quot;&quot;&quot;@version: v0.1@author: narutohyc@file: logger_config.py@Description: æ—¥å¿—é…ç½®å­—å…¸ + å®šä¹‰loggerå¥æŸ„ä¾›é¡¹ç›®ä½¿ç”¨              Pythonæ—¥å¿—åº“loggingæ€»ç»“-å¯èƒ½æ˜¯ç›®å‰ä¸ºæ­¢å°†loggingåº“æ€»ç»“çš„æœ€å¥½çš„ä¸€ç¯‡æ–‡ç« :                  https://www.jianshu.com/p/7b5e4752932e@time: 2020/5/23 21:34&quot;&quot;&quot;import loggingimport osfrom enum import Enum, uniquefrom logging import config as logging_configfrom os.path import join# è·å–æ—¥å¿—ç›®å½•from basic_support.data_access.config.project_config import project_configbase_path = project_config.PROJECT_PATHbase_log_path = join(base_path, 'logs')# æ–‡ä»¶ç›®å½•ä¸å­˜åœ¨æ—¶, åˆ›å»ºè¯¥ç›®å½•if not os.path.exists(base_log_path):    os.makedirs(base_log_path)@uniqueclass LogLevel(Enum):    &quot;&quot;&quot; æ—¥å¿—ç­‰çº§æšä¸¾ç±» &quot;&quot;&quot;    CRITICAL = 'è‡´å‘½'  # ä¸¥é‡é”™è¯¯,è¡¨æ˜ç¨‹åºæœ¬èº«å¯èƒ½æ— æ³•ç»§ç»­è¿è¡Œ    ERROR = 'é”™è¯¯'  # ç”±äºæ›´ä¸¥é‡çš„é—®é¢˜,è¯¥è½¯ä»¶æ— æ³•æ‰§è¡ŒæŸäº›åŠŸèƒ½    WARNING = 'è­¦å‘Š'  # è¡¨æ˜å‘ç”Ÿäº†æ„å¤–æƒ…å†µ,æˆ–è¡¨æ˜åœ¨ä¸ä¹…çš„å°†æ¥å‡ºç°äº†ä¸€äº›é—®é¢˜ (ä¾‹å¦‚ 'ç£ç›˜ç©ºé—´ä¸è¶³')ã€‚ä½†æ˜¯è¯¥è½¯ä»¶ä»åœ¨æŒ‰é¢„æœŸå·¥ä½œ    INFO = 'æ™®é€š'  # ç¡®è®¤äº‹æƒ…æŒ‰é¢„æœŸå·¥ä½œ    DEBUG = 'è¯¦ç»†'  # è¯¦ç»†ä¿¡æ¯,é€šå¸¸ä»…åœ¨è¯Šæ–­é—®é¢˜æ—¶æ‰æœ‰æ„ä¹‰    NOTSET = 'ä¸è®¾ç½®'  # æ„æŒ‡ä¸è®¾ç½®,æ‰€ä»¥æŒ‰ç…§çˆ¶loggerçº§åˆ«æ¥è¿‡æ»¤æ—¥å¿—# æ—¥å¿—ç›¸å…³é…ç½®LOGGING_CONFIG = {    'version': 1,    'loggers': {  # æ—¥å¿—ï¼Œæš´éœ²å‡½æ•°ç»™åº”ç”¨ç¨‹åºï¼ŒåŸºäºæ—¥å¿—è®°å½•å™¨å’Œè¿‡æ»¤å™¨çº§åˆ«å†³å®šå“ªäº›æ—¥å¿—æœ‰æ•ˆ        '': {  # root logger            'level': LogLevel.INFO.name,  # æ—¥å¿—ç­‰çº§            'handlers': ['console_handler', 'info_file_handler', 'error_file_handler'],        }    },    'handlers': {  # å¤„ç†å™¨, å°†(æ—¥å¿—è®°å½•å™¨äº§ç”Ÿçš„)æ—¥å¿—è®°å½•å‘é€è‡³åˆé€‚çš„ç›®çš„åœ°        'console_handler': {            'level': LogLevel.INFO.name,  # æ§åˆ¶å°æ—¥å¿—ç­‰çº§ å’Œ æœ€ç»ˆç­‰çº§=max(å½“å‰ç­‰çº§,loggers)            'formatter': 'info',            'class': 'logging.StreamHandler',  # æ—¥å¿—ç±»            'stream': 'ext://sys.stdout',  # æ—¥å¿—æµ        },        'info_file_handler': {            'level': LogLevel.INFO.name,  # ä¿¡æ¯æ—¥å¿—ç­‰çº§            'formatter': 'info',            'class': &quot;concurrent_log_handler.ConcurrentRotatingFileHandler&quot;,  # å¤šè¿›ç¨‹ä¸‹å¤šçº¿ç¨‹å®‰å…¨            'filename': os.path.join(base_log_path, 'info.log'),  # ä¿¡æ¯æ—¥å¿—æ–‡ä»¶è¾“å‡ºç›®å½•            'mode': 'a+',  # æ—¥å¿—æ–‡ä»¶æ¨¡å‹ aè¡¨ç¤ºè¿½åŠ   wæ˜¯è¦†ç›–å†™            'encoding': 'utf-8',            'backupCount': 4,  # 4 = è‡ªå·±+å†å²çš„3ä¸ª            'maxBytes': 1024 * 1024 * 50,  # å•ä¸ªæ—¥å¿—æ–‡ä»¶å¤§å°é™åˆ¶åœ¨ 50MBå†…            'use_gzip': False,        },        'error_file_handler': {            'level': LogLevel.WARNING.name,  # é”™è¯¯æ—¥å¿—ç­‰çº§            'formatter': 'error',            'class': 'logging.FileHandler',            # 'class': 'logging.handlers.RotatingFileHandler',            'filename': os.path.join(base_log_path, 'error.log'),  # é”™è¯¯æ—¥å¿—æ–‡ä»¶è¾“å‡ºç›®å½•            'mode': 'a+',            'encoding': 'utf-8'        }    },    'formatters': {  # æ ¼å¼åŒ–å™¨, æŒ‡æ˜äº†æœ€ç»ˆè¾“å‡ºä¸­æ—¥å¿—è®°å½•çš„å¸ƒå±€        'info': {            'format': '%(asctime)s %(module)s:%(lineno)d %(levelname)s: %(message)s',  # æ—¥å¿—è¾“å‡ºæ ¼å¼åŒ–            'datefmt': '%Y-%m-%d %H:%M:%S'  # æ—¥æœŸæ ¼å¼åŒ–        },        'error': {            # 'format': '%(asctime)s-%(levelname)s-%(name)s-%(process)d::%(module)s|%(lineno)s:: %(message)s',            'format': '%(asctime)s %(module)s|%(lineno)s %(levelname)s|%(process)d:  %(message)s',            'datefmt': '%Y-%m-%d %H:%M:%S'        },    },}# è·å–æ—¥å¿—å®ä¾‹logging_config.dictConfig(LOGGING_CONFIG)logger = logging.getLogger(__name__)ä½¿ç”¨12345678from comm.config.logger_config import logger# æ—¥å¿—è¾“å‡ºlogger.debug(&quot;debug message.&quot;)logger.info(&quot;info message.&quot;)logger.warning(&quot;warning message.&quot;)logger.error(&quot;error message.&quot;)logger.critical(&quot;critical message.&quot;)è¾“å‡º123452020-05-24 10:29:30 text_augmentation_script DEBUG:  debug message.2020-05-24 10:29:30 text_augmentation_script INFO:  info message.2020-05-24 10:29:30 text_augmentation_script WARNING:  warning message.2020-05-24 10:29:30 text_augmentation_script ERROR:  error message.2020-05-24 10:29:30 text_augmentation_script CRITICAL:  critical message.Handler å­ç±»StreamHandler å®ä¾‹å°†æ¶ˆæ¯å‘é€åˆ°æµï¼ˆç±»æ–‡ä»¶å¯¹è±¡ï¼‰ã€‚FileHandler å®ä¾‹å°†æ¶ˆæ¯å‘é€åˆ°ç£ç›˜æ–‡ä»¶ã€‚BaseRotatingHandler æ˜¯åœ¨æŸä¸ªç‚¹åˆ‡å‰²æ—¥å¿—æ–‡ä»¶çš„å¤„ç†å™¨çš„åŸºç±»ã€‚å®ƒå¹¶ä¸æ„å‘³ç€ç›´æ¥å®ä¾‹åŒ–ã€‚è€Œæ˜¯ä½¿ç”¨ RotatingFileHandler æˆ– TimedRotatingFileHandlerã€‚RotatingFileHandler å®ä¾‹å°†æ¶ˆæ¯å‘é€åˆ°ç£ç›˜æ–‡ä»¶ï¼Œæ”¯æŒæœ€å¤§æ—¥å¿—æ–‡ä»¶å¤§å°å’Œæ—¥å¿—æ–‡ä»¶åˆ‡å‰²ã€‚TimedRotatingFileHandler å®ä¾‹å°†æ¶ˆæ¯å‘é€åˆ°ç£ç›˜æ–‡ä»¶ï¼Œä»¥ç‰¹å®šçš„æ—¶é—´é—´éš”åˆ‡å‰²æ—¥å¿—æ–‡ä»¶ã€‚SocketHandler å®ä¾‹å°†æ¶ˆæ¯å‘é€åˆ° TCP/IP å¥—æ¥å­—ã€‚ä» 3.4 å¼€å§‹ï¼Œä¹Ÿæ”¯æŒ Unix åŸŸå¥—æ¥å­—ã€‚DatagramHandler å®ä¾‹å°†æ¶ˆæ¯å‘é€åˆ° UDP å¥—æ¥å­—ã€‚ä» 3.4 å¼€å§‹ï¼Œä¹Ÿæ”¯æŒ Unix åŸŸå¥—æ¥å­—ã€‚SMTPHandler å®ä¾‹å°†æ¶ˆæ¯å‘é€åˆ°æŒ‡å®šçš„ç”µå­é‚®ä»¶åœ°å€ã€‚SysLogHandler å®ä¾‹å°†æ¶ˆæ¯å‘é€åˆ° Unix syslog å®ˆæŠ¤ç¨‹åºï¼Œå¯ä»¥æ˜¯åœ¨è¿œç¨‹è®¡ç®—æœºä¸Šã€‚NTEventLogHandler å®ä¾‹å°†æ¶ˆæ¯å‘é€åˆ° Windows NT/2000/XP äº‹ä»¶æ—¥å¿—ã€‚MemoryHandler å®ä¾‹å°†æ¶ˆæ¯å‘é€åˆ°å†…å­˜ä¸­çš„ç¼“å†²åŒºï¼Œåªè¦æ»¡è¶³ç‰¹å®šæ¡ä»¶ï¼Œå°±ä¼šåˆ·æ–°å†…å­˜ä¸­çš„ç¼“å†²åŒºã€‚HTTPHandler å®ä¾‹ä½¿ç”¨ GET æˆ– POST è¯­ä¹‰å°†æ¶ˆæ¯å‘é€åˆ° HTTP æœåŠ¡å™¨ã€‚WatchedFileHandler å®ä¾‹ç›‘è§†ä»–ä»¬è¦è®°å½•çš„æ–‡ä»¶ã€‚å¦‚æœæ–‡ä»¶å‘ç”Ÿæ›´æ”¹ï¼Œåˆ™ä¼šå…³é—­è¯¥æ–‡ä»¶å¹¶ä½¿ç”¨æ–‡ä»¶åé‡æ–°æ‰“å¼€ã€‚æ­¤å¤„ç†ç¨‹åºä»…åœ¨ç±» Unix ç³»ç»Ÿä¸Šæœ‰ç”¨; Windows ä¸æ”¯æŒä½¿ç”¨çš„åŸºç¡€æœºåˆ¶ã€‚QueueHandler å®ä¾‹å°†æ¶ˆæ¯å‘é€åˆ°é˜Ÿåˆ—ï¼Œä¾‹å¦‚é˜Ÿåˆ—æˆ–å¤šå¤„ç†æ¨¡å—ä¸­å®ç°çš„é˜Ÿåˆ—ã€‚NullHandler å®ä¾‹ä¸ä¼šå¯¹é”™è¯¯æ¶ˆæ¯æ‰§è¡Œä»»ä½•æ“ä½œã€‚NullHandler ï¼ŒStreamHandler å’Œ FileHandler ç±»åœ¨æ ¸å¿ƒæ—¥å¿—åŒ…ä¸­å®šä¹‰ã€‚å…¶ä»–å¤„ç†ç¨‹åºåœ¨å­æ¨¡å— logging.handlers ä¸­å®šä¹‰ã€‚ï¼ˆè¿˜æœ‰å¦ä¸€ä¸ªå­æ¨¡å— logging.configï¼Œç”¨äºé…ç½®åŠŸèƒ½ã€‚ï¼‰æ—¥å¿—æ–‡ä»¶æŒ‰ç…§æ—¶é—´åˆ’åˆ†æˆ–è€…æŒ‰ç…§å¤§å°åˆ’åˆ†å¦‚æœå°†æ—¥å¿—ä¿å­˜åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œé‚£ä¹ˆæ—¶é—´ä¸€é•¿ï¼Œæˆ–è€…æ—¥å¿—ä¸€å¤šï¼Œå•ä¸ªæ—¥å¿—æ–‡ä»¶å°±ä¼šå¾ˆå¤§ï¼Œæ—¢ä¸åˆ©äºå¤‡ä»½ï¼Œä¹Ÿä¸åˆ©äºæŸ¥çœ‹ã€‚æˆ‘ä»¬ä¼šæƒ³åˆ°èƒ½ä¸èƒ½æŒ‰ç…§æ—¶é—´æˆ–è€…å¤§å°å¯¹æ—¥å¿—æ–‡ä»¶è¿›è¡Œåˆ’åˆ†å‘¢ï¼Ÿç­”æ¡ˆè‚¯å®šæ˜¯å¯ä»¥çš„ï¼Œå¹¶ä¸”è¿˜å¾ˆç®€å•ï¼Œlogging è€ƒè™‘åˆ°äº†æˆ‘ä»¬è¿™ä¸ªéœ€æ±‚ã€‚logging.handlers æ–‡ä»¶ä¸­æä¾›äº† TimedRotatingFileHandler å’Œ RotatingFileHandler ç±»åˆ†åˆ«å¯ä»¥å®ç°æŒ‰æ—¶é—´å’Œå¤§å°åˆ’åˆ†ã€‚æ‰“å¼€è¿™ä¸ª handles æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°è¿˜æœ‰å…¶ä»–åŠŸèƒ½çš„ Handler ç±»ï¼Œå®ƒä»¬éƒ½ç»§æ‰¿è‡ªåŸºç±» BaseRotatingHandlerã€‚è‡ªå®šä¹‰ Loggerå¯èƒ½çš„é—®é¢˜ logging åº“æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä½†åœ¨å¤šè¿›ç¨‹ã€å¤šçº¿ç¨‹ã€å¤šè¿›ç¨‹å¤šçº¿ç¨‹ç¯å¢ƒä¸­ä»ç„¶è¿˜æœ‰å€¼å¾—è€ƒè™‘çš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼Œå¦‚ä½•å°†æ—¥å¿—æŒ‰ç…§è¿›ç¨‹ï¼ˆæˆ–çº¿ç¨‹ï¼‰åˆ’åˆ†ä¸ºä¸åŒçš„æ—¥å¿—æ–‡ä»¶ï¼Œä¹Ÿå³ä¸€ä¸ªè¿›ç¨‹ï¼ˆæˆ–çº¿ç¨‹ï¼‰å¯¹åº”ä¸€ä¸ªæ–‡ä»¶ã€‚å¯ä»¥ä½¿ç”¨å¤šè¿›ç¨‹å®‰å…¨çš„æ—¥å¿—ç±»concurrent-log-handler</content>
	</entry>
	<entry>
		<title>Springæ³¨è§£_Springå…¥é—¨ç¯‡</title>
		<url>/article/1ddf4748.html</url>
		<content>Springå…¥é—¨ç¯‡é‚£äº›å¹´ï¼Œè®©æˆ‘ä»¬ä¸€èµ·ç€è¿·çš„Springhttp://spring.iohttps://spring.io/projects/spring-frameworkæ¦‚è¿°springæ˜¯ä¸€ä¸ªå¼€æºæ¡†æ¶ï¼Œæ˜¯ä¸€ä¸ªè½»é‡çº§çš„æ§åˆ¶åè½¬(IOC)å’Œé¢å‘åˆ‡é¢ï¼ˆAOP)çš„å®¹å™¨æ¡†æ¶ -ä»å¤§å°ä¸å¼€é”€ä¸¤æ–¹é¢è€Œè¨€Springéƒ½æ˜¯è½»é‡çš„ -é€šè¿‡æ§åˆ¶åè½¬ï¼ˆIoCï¼‰çš„æŠ€æœ¯è¾¾åˆ°æ¾è€¦åˆçš„ç›®çš„ -æä¾›äº†é¢å‘åˆ‡é¢ç¼–ç¨‹çš„ä¸°å¯Œæ”¯æŒï¼Œå…è®¸é€šè¿‡åˆ†ç¦»åº”ç”¨çš„ä¸šåŠ¡é€»è¾‘ä¸ç³»ç»Ÿçº§æœåŠ¡è¿›è¡Œå†…èšæ€§çš„å¼€å‘ -åŒ…å«å¹¶ç®¡ç†åº”ç”¨å¯¹è±¡çš„é…ç½®å’Œç”Ÿå‘½å‘¨æœŸï¼Œè¿™ä¸ªæ„ä¹‰ä¸Šæ˜¯ä¸€ç§å®¹å™¨ -å°†ç®€å•çš„ç»„ä»¶é…ç½®ã€ç»„åˆæˆä¸ºå¤æ‚çš„åº”ç”¨ï¼Œè¿™ä¸ªæ„ä¹‰ä¸Šæ˜¯æ¡†æ¶ &gt;Java ç¨‹åºå‘˜å¿…é¡»æŒæ¡çš„ 5 ä¸ªæ³¨è§£ï¼Springä½œç”¨å®¹å™¨ Â·æä¾›äº†å¯¹å¤šç§æŠ€æœ¯çš„æ”¯æŒ -JMS -MQæ”¯æŒ -UnitTest AOPï¼ˆäº‹åŠ¡ç®¡ç†ã€æ—¥å¿—ç­‰ï¼‰ Â·æä¾›äº†ä¼—å¤šæ–¹ä¾¿åº”ç”¨çš„è¾…åŠ©ç±»ï¼ˆJDBC Templateç­‰ï¼‰ Â·å¯¹ä¸»æµåº”ç”¨æ¡†æ¶ï¼ˆHibernateç­‰ï¼‰æä¾›äº†è‰¯å¥½çš„æ”¯æŒé€‚ç”¨èŒƒå›´æ„å»ºä¼ä¸šåº”ç”¨ï¼ˆSpringMVC+Spring+Hibernate/ibatis) å•ç‹¬ä½¿ç”¨Beanå®¹å™¨ï¼ˆBeanç®¡ç†ï¼‰ å•ç‹¬ä½¿ç”¨AOPè¿›è¡Œåˆ‡é¢å¤„ç† å…¶ä»–çš„SpringåŠŸèƒ½ï¼Œå¦‚ï¼šå¯¹æ¶ˆæ¯çš„æ”¯æŒç­‰ åœ¨äº’è”ç½‘ä¸­çš„åº”ç”¨ä»€ä¹ˆæ˜¯æ¡†æ¶Â·æ¡†æ¶çš„ç‰¹ç‚¹ -åŠæˆå“ -å°è£…äº†ç‰¹å®šçš„å¤„ç†æµç¨‹å’Œæ§åˆ¶é€»è¾‘ -æˆç†Ÿçš„ã€ä¸æ–­å‡çº§æ”¹è¿›çš„è½¯ä»¶ Â·æ¡†æ¶ä¸ç±»åº“çš„åŒºåˆ« -æ¡†æ¶ä¸€èˆ¬æ˜¯å°è£…äº†é€»è¾‘ã€é«˜å†…èšçš„ï¼Œç±»åº“åˆ™æ˜¯æ¾æ•£çš„å·¥å…·ç»„åˆ -æ¡†æ¶ä¸“æ³¨äºæŸä¸€é¢†åŸŸï¼Œç±»åº“åˆ™æ˜¯æ›´é€šç”¨çš„ ä¸ºä»€ä¹ˆä½¿ç”¨æ¡†æ¶Â·è½¯ä»¶ç³»ç»Ÿæ—¥è¶‹å¤æ‚ Â·é‡ç”¨åº¦é«˜ï¼Œå¼€å‘æ•ˆç‡å’Œè´¨é‡æé«˜ Â·è½¯ä»¶è®¾è®¡äººå‘˜è¦ä¸“æ³¨äºå¯¹é¢†åŸŸçš„äº†è§£ï¼Œä½¿éœ€æ±‚åˆ†ææ›´å……åˆ† Â·æ˜“äºä¸Šæ‰‹ã€å¿«é€Ÿè§£å†³é—®é¢˜ Spring IOCå®¹å™¨æ¥å£åŠé¢å‘æ¥å£ç¼–ç¨‹æ¥å£Â·ç”¨äºæ²Ÿé€šçš„ä¸­ä»‹ç‰©çš„æŠ½è±¡åŒ– Â·å®ä½“æŠŠè‡ªå·±æä¾›ç»™å¤–ç•Œçš„ä¸€ç§æŠ½è±¡åŒ–è¯´æ˜ï¼Œç”¨ä»¥ç”±å†…éƒ¨æ“ä½œåˆ† ç¦»å‡ºå¤–éƒ¨æ²Ÿé€šæ–¹æ³•ï¼Œä½¿å…¶èƒ½è¢«ä¿®æ”¹å†…éƒ¨è€Œä¸å½±å“å¤–ç•Œå…¶ä»–å®ä½“ ä¸å…¶äº¤äº’çš„æ–¹å¼ Â·å¯¹åº”Javaæ¥å£å³å£°æ˜ï¼Œå£°æ˜äº†å“ªäº›æ–¹æ³•æ˜¯å¯¹å¤–å…¬å¼€æä¾›çš„ Â·åœ¨Java8ä¸­ï¼Œæ¥å£å¯ä»¥æ‹¥æœ‰æ–¹æ³•ä½“ é¢å‘æ¥å£ç¼–ç¨‹ç»“æ„è®¾è®¡ä¸­ï¼Œåˆ†æ¸…å±‚æ¬¡åŠè°ƒç”¨å…³ç³»ï¼Œæ¯å±‚åªå‘å¤–ï¼ˆä¸Šå±‚ï¼‰æä¾› ä¸€ç»„åŠŸèƒ½æ¥å£ï¼Œå„å±‚é—´ä»…ä¾èµ–æ¥å£è€Œéå®ç°ç±» æ¥å£å®ç°çš„å˜åŠ¨ä¸å½±å“å„å±‚é—´çš„è°ƒç”¨ï¼Œè¿™ä¸€ç‚¹åœ¨å…¬å…±æœåŠ¡ä¸­å°¤ä¸ºé‡è¦ â€œé¢å‘æ¥å£ç¼–ç¨‹â€ä¸­çš„â€œæ¥å£â€æ˜¯ç”¨äºéšè—å…·ä½“å®ç°å’Œå®ç°å¤šæ€æ€§çš„ç»„ä»¶ä»€ä¹ˆæ˜¯IOCIOC:æ§åˆ¶åè½¬ï¼Œæ§åˆ¶æƒçš„è½¬ç§»ï¼Œåº”ç”¨ç¨‹åºæœ¬èº«ä¸è´Ÿè´£ä¾èµ–å¯¹è±¡çš„åˆ›å»ºå’Œç»´æŠ¤ï¼Œè€Œæ˜¯ç”±å¤–éƒ¨å®¹å™¨è´Ÿè´£åˆ›å»ºå’Œç»´æŠ¤ DIï¼ˆä¾èµ–æ³¨å…¥ï¼‰æ˜¯å…¶ä¸€ç§å®ç°æ–¹å¼ ç›®çš„ï¼šåˆ›å»ºå¯¹è±¡å¹¶ä¸”ç»„è£…å¯¹è±¡ä¹‹é—´çš„å…³ç³» &gt;æ‰©å±•ç†è§£2004å¹´ï¼ŒMartin Fowleræ¢è®¨äº†åŒä¸€ä¸ªé—®é¢˜ï¼Œæ—¢ç„¶IOCæ˜¯æ§åˆ¶ åè½¬ï¼Œé‚£ä¹ˆåˆ°åº•æ˜¯â€œå“ªäº›æ–¹é¢çš„æ§åˆ¶è¢«åè½¬äº†å‘¢ï¼Ÿâ€ï¼Œç»è¿‡è¯¦ ç»†åœ°åˆ†æå’Œè®ºè¯åï¼Œä»–å¾—å‡ºäº†ç­”æ¡ˆï¼šâ€œè·å¾—ä¾èµ–å¯¹è±¡çš„è¿‡ç¨‹è¢« åè½¬äº†â€ã€‚æ§åˆ¶è¢«åè½¬ä¹‹åï¼Œè·å¾—ä¾èµ–å¯¹è±¡çš„è¿‡ç¨‹ç”±è‡ªèº«ç®¡ç† å˜ä¸ºäº†ç”±IOCå®¹å™¨ä¸»åŠ¨æ³¨å…¥ã€‚äºæ˜¯ï¼Œä»–ç»™â€œæ§åˆ¶åè½¬â€å–äº†ä¸€ ä¸ªæ›´åˆé€‚çš„åå­—å«åšâ€œä¾èµ–æ³¨å…¥ï¼ˆDependency Injection) â€œã€‚ä»–çš„è¿™ä¸ªç­”æ¡ˆï¼Œå®é™…ä¸Šç»™å‡ºäº†å®ç°IOCçš„æ–¹æ³•ï¼šæ³¨å…¥ã€‚æ‰€ è°“ä¾èµ–æ³¨å…¥ï¼Œå°±æ˜¯ç”±IOCå®¹å™¨åœ¨è¿è¡ŒæœŸé—´ï¼ŒåŠ¨æ€åœ°å°†æŸç§ä¾èµ– å…³ç³»æ³¨å…¥åˆ°å¯¹è±¡ä¹‹ä¸­ã€‚å•å…ƒæµ‹è¯•ä¸‹è½½junit-*.jarå¹¶å¼•å…¥å·¥ç¨‹ åˆ›å»ºUnitTestBaseç±»ï¼Œå®Œæˆå¯¹Springé…ç½®æ–‡ä»¶çš„åŠ è½½ã€é”€æ¯ æ‰€æœ‰çš„å•å…ƒæµ‹è¯•ç±»éƒ½ç»§æ‰¿è‡ªUnitTestBaseï¼Œé€šè¿‡å®ƒçš„ getBeanæ–¹æ³•è·å–æƒ³è¦å¾—åˆ°çš„å¯¹è±¡ å­ç±»ï¼ˆå…·ä½“æ‰§è¡Œå•å…ƒæµ‹è¯•çš„ç±»ï¼‰åŠ æ³¨è§£ï¼š @RunWith(BlockJUnit4ClassRunner.class) å•å…ƒæµ‹è¯•æ–¹æ³•åŠ æ³¨è§£ï¼š@Test å³é”®é€‰æ‹©è¦æ‰§è¡Œçš„å•å…ƒæµ‹è¯•æ–¹æ³•æ‰§è¡Œæˆ–è€…æ‰§è¡Œä¸€ä¸ªç±»çš„å…¨éƒ¨å• å…ƒæµ‹è¯•æ–¹æ³• Beanå®¹å™¨åˆå§‹åŒ–åŸºç¡€ï¼šä¸¤ä¸ªåŒ… -org.springframework.beans -org.springframework.context -BeanFactoryæä¾›é…ç½®ç»“æ„å’ŒåŸºæœ¬åŠŸèƒ½ï¼ŒåŠ è½½å¹¶åˆå§‹åŒ–Bean -ApplicationContextä¿å­˜äº†Beanå¯¹è±¡å¹¶åœ¨Springä¸­è¢«å¹¿æ³›ä½¿ç”¨ æ–¹å¼ï¼ŒApplicationContext -æœ¬åœ°æ–‡ä»¶ -Classpath -Webåº”ç”¨ä¸­ä¾èµ–servletæˆ–Listener Beanå®¹å™¨åˆå§‹åŒ–Â·æ–‡ä»¶ 1FileSystemXmlApplicationContext context= new FileSystemXmlApplicationContext(&quot;F:/workspace/appcontext.xml&quot;); Â·Classpath 1caspatxnlApplicstionc ontext context= new ClaspathxmlAplicationcontextrclasspathispring-contextxml);.Webåº”ç”¨ 123456789101112&lt;listener&gt; &lt;listener-class&gt;        org.springframework.web.context.ContextLoaderListener    &lt;/listener-class&gt; &lt;/listener&gt; &lt;servlet&gt;     &lt;servlet-name&gt;context&lt;/servlet-name&gt;     &lt;servlet-class&gt;        org.springframework.web.context.ContextLoaderServlet    &lt;/servlet-class&gt;     &lt;load-on-startup&gt;1&lt;/load-on-startup&gt; &lt;/servlet&gt; Springçš„å¸¸ç”¨æ³¨å…¥æ–¹å¼Springæ³¨å…¥Springæ³¨å…¥æ˜¯æŒ‡åœ¨å¯åŠ¨Springå®¹å™¨åŠ è½½beané…ç½®çš„æ—¶å€™ï¼Œå®Œæˆå¯¹å˜é‡çš„èµ‹å€¼è¡Œä¸º å¸¸ç”¨çš„ä¸¤ç§æ³¨å…¥æ–¹å¼ -è®¾å€¼æ³¨å…¥ 1234567891011 &lt;?xml version=&quot;1.0&quot;encoding=&quot;UTF-8?&gt;  &lt;beans xmlns=&quot;http:/www.springframework.org/schema/beans&quot;  xmlns:xsi=&quot;htto://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http:/www.springframework.org/schema/beans  http:/www.springframeworkorg/schema/beans/spring-beans.xsd&quot;&gt;     &lt;bean id=&quot;injectionService&quot;class='com.imooc.ioc.injection.service.InjiectionServicelmp/&gt;    &lt;property name=&quot;injection0AO&quot;ref=tipjection0Ag'1p&lt;/property&gt;     &lt;/bean&gt;     &lt;bean id=ipjection0AO&quot;class=&quot;com.imooc.iodinjiection.dao.lpjection0AOlmp/&gt;&lt;/bean&gt; &lt;/beans&gt;12345678910111213141516import com.imooc.ioc.injection.dao.InjectionDAO; public class InjectionServicelmpl implements InjectionService{     private InjectionDAO injectionDAO;     //è®¾å€¼æ³¨å…¥     public void setlnjectionDAO(InjectionDAO injectionDAO)    {         this.injectionDAO=injectionDAO;     }     public void save(String arg)    {         //æ¨¡æ‹Ÿä¸šåŠ¡æ“ä½œ         System.outprintin(CServiceæ¥æ”¶å‚æ•°ï¼š+arg);         arg=arg +&quot;:&quot;+this.hashCode0;         injectionDAO.save(arg);    }}â€‹    -æ„é€ æ³¨å…¥ 1234567891011 &lt;?xml version=&quot;1.0&quot;encoding=&quot;UTF-8?&gt;  &lt;beans xmlns=&quot;http:/www.springframework.org/schema/beans&quot;  xmlns:xsi=&quot;htto://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http:/www.springframework.org/schema/beans  http:/www.springframeworkorg/schema/beans/spring-beans.xsd&quot;&gt;     &lt;bean id=&quot;injectionService&quot;class='com.imooc.ioc.injection.service.InjiectionServicelmp/&gt;    &lt;constructor-arg name=&quot;injection0AO&quot;ref=iniection0AQ&gt;I&lt;/constructor-arg&gt;      &lt;/bean&gt;     &lt;bean id=ipjection0AO&quot;class=&quot;com.imooc.iodinjiection.dao.lpjection0AOlmp/&gt;&lt;/bean&gt; &lt;/beans&gt;1234567891011121314151617import com.imooc.ioc.injection.dao.InjectionDAO; public class InjectionServicelmpl implements InjectionService{     private InjectionDAO injectionDAO;     //æ„é€ å™¨æ³¨å…¥     public InjectionServicelmpl(InjectionDAO injectionDAO)    {         this.injectionDAO=injectionDAO;    }    public void save(String arg)    {         //æ¨¡æ‹Ÿä¸šåŠ¡æ“ä½œ         System.outprintin(CServiceæ¥æ”¶å‚æ•°ï¼š+arg);         arg=arg +&quot;:&quot;+this.hashCode0;         injectionDAO.save(arg);    }}Spring Beanè£…é…Beanè£…é…ï¼Œä»Springåˆ°Spring BootBeané…ç½®é¡¹Class Scope Constructor arguments Properties Autowiring mode lazy-initialization mode Initialization/destruction method Beançš„ä½œç”¨åŸŸsingleton:å•ä¾‹ï¼ŒæŒ‡ä¸€ä¸ªBeanå®¹å™¨ä¸­åªå­˜åœ¨ä¸€ä»½ prototypeï¼šæ¯æ¬¡è¯·æ±‚ï¼ˆæ¯æ¬¡ä½¿ç”¨ï¼‰åˆ›å»ºæ–°çš„å®ä¾‹ï¼Œdestroy æ–¹å¼ä¸ç”Ÿæ•ˆ request:æ¯æ¬¡httpè¯·æ±‚åˆ›å»ºä¸€ä¸ªå®ä¾‹ä¸”ä»…åœ¨å½“å‰requestå†… æœ‰æ•ˆ session:åŒä¸Šï¼Œæ¯æ¬¡httpè¯·æ±‚åˆ›å»ºï¼Œå½“å‰sessionå†…æœ‰æ•ˆ global session:åŸºäºportletçš„webä¸­æœ‰æ•ˆï¼ˆportletå®šä¹‰äº† global session),å¦‚æœæ˜¯åœ¨webä¸­ï¼ŒåŒsession 1&lt;bean id=&quot;beanScope&quot;class=&quot;com.imooc.bean.BeanScope&quot; scope=singletor'&quot;&gt;&lt;/bean&gt; Beançš„ç”Ÿå‘½å‘¨æœŸç”Ÿå‘½å‘¨æœŸ-å®šä¹‰ -åˆå§‹åŒ–-å®ç°org.springframework.beans.factory.InitializingBeanæ¥å£ ï¼Œè¦†ç›–afterPropertiesSetæ–¹æ³• 123456public class ExamplelnitializingBean implements InitializingBean{     @Override     public void afterPropertiesSet0 throws Exception{         //do something    }}-é…ç½®init-method1&lt;bean id=&quot;exampleInitBean&quot; class=&quot;examples.ExampleBean&quot; init-method=&quot;init&quot;/ã€‰  12345public class ExampleBean {     public void init(){         //do some initialization work     }}-ä½¿ç”¨ -é”€æ¯ -å®ç°org.springframework.beans.factory.DisposableBeanæ¥å£ ï¼Œè¦†ç›–destroyæ–¹æ³• 123456public class ExampleDisposableBean implements DisposableBean{     @Override     public void destroy0 throws Exception{         //do something    }}é…ç½®destroy-method 1&lt;bean id=&quot;exampleInitRean&quot; class=&quot;examples.ExampleBean&quot;destroy-method=&quot;cleanup&quot;/&gt; 12345public class ExampleBean {     public void cleanup(){         //do some destruction work (like releasing pooled connections)     }}é…ç½®å…¨å±€é»˜è®¤åˆå§‹åŒ–ã€é”€æ¯æ–¹æ³• 1234567&lt;?xml version=1.0&quot;encoding='UTF-8?&gt;&lt;beans xmlns=&quot;http:/www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XML Schema-instance&quot; xsi:schemaLocation=&quot;http://www.springframeworkorg/schema/beans http:/www.springframework.org/schema/beans/spring-beans.xsd&quot;default-init-method=&quot;init&quot;default-destroy-method=&quot;destroys&quot;&gt;&lt;/beans&gt;ä¼˜å…ˆé¡ºåº  InitializingBeanå’ŒDisposableBean(å®šä¹‰å®Œéœ€å®ç°)é…ç½®init-methodå’Œdestroy-method(å®šä¹‰å®Œéœ€å®ç°)é»˜è®¤(å¯é€‰)Awareæ¥å£Springä¸­æä¾›äº†ä¸€äº›ä»¥Awareç»“å°¾çš„æ¥å£ï¼Œå®ç°äº†Awareæ¥ å£çš„beanåœ¨è¢«åˆå§‹åŒ–ä¹‹åï¼Œå¯ä»¥è·å–ç›¸åº”èµ„æº é€šè¿‡Awareæ¥å£ï¼Œå¯ä»¥å¯¹Springç›¸åº”èµ„æºè¿›è¡Œæ“ä½œï¼ˆä¸€å®šè¦æ… é‡ï¼‰ ä¸ºå¯¹Springè¿›è¡Œç®€å•çš„æ‰©å±•æä¾›äº†æ–¹ä¾¿çš„å…¥å£ Springä¸­çš„awareæ¥å£1234567891011121314151617181920&gt;import org.springframework.beans.BeansException;&gt;import org.springframework.beans.factory.BeanNameAware;&gt;import org.springframework.context.ApplicationContext;&gt;import org.springframework.context.ApplicationContextAware;&gt;public class MoocBeanName implements BeanNameAware, ApplicationContextAware {private String beanName;@Overridepublic void setBeanName(String name) {this.beanName = name;System.out.println(&quot;MoocBeanName : &quot; + name);}@Overridepublic void setApplicationContext(ApplicationContext applicationContext)throws BeansException {System.out.println(&quot;setApplicationContext : &quot; + applicationContext.getBean(this.beanName).hashCode());}&gt;}Beançš„è‡ªåŠ¨è£…é…Beançš„è‡ªåŠ¨è£…é…ï¼ˆAutowiring) No:ä¸åšä»»ä½•æ“ä½œ byName:æ ¹æ®å±æ€§åè‡ªåŠ¨è£…é…ã€‚æ­¤é€‰é¡¹å°†æ£€æŸ¥å®¹å™¨å¹¶æ ¹æ®åå­— æŸ¥æ‰¾ä¸å±æ€§å®Œå…¨ä¸€è‡´çš„beanï¼Œå¹¶å°†å…¶ä¸å±æ€§è‡ªåŠ¨è£…é… 123456789&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;    xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans    http://www.springframework.org/schema/beans/spring-beans.xsd&quot;     default-autowire=&quot;byName&quot;&gt;    &lt;bean id=&quot;autoWiringService&quot; class=&quot;com.imooc.autowiring.AutoWiringService&quot; &gt;&lt;/bean&gt;    &lt;bean id=&quot;autoWiringDAO&quot; class=&quot;com.imooc.autowiring.AutoWiringDAO&quot; &gt;&lt;/bean&gt;&lt;/beans&gt;12345public class AutoWiringDAO {public void say(String word) {System.out.println(&quot;AutoWiringDAO : &quot; + word);}}12345678910public class AutoWiringService {    private AutoWiringDAO autoWiringDAO;    public void setAutoWiringDAO(AutoWiringDAO autoWiringDAO) {        System.out.println(&quot;setAutoWiringDAO&quot;);        this.autoWiringDAO = autoWiringDAO;    }    public void say(String word) {        this.autoWiringDAO.say(word);    }}byType:å¦‚æœå®¹å™¨ä¸­å­˜åœ¨ä¸€ä¸ªä¸æŒ‡å®šå±æ€§ç±»å‹ç›¸åŒçš„beanï¼Œé‚£ ä¹ˆå°†ä¸è¯¥å±æ€§è‡ªåŠ¨è£…é…ï¼›å¦‚æœå­˜åœ¨å¤šä¸ªè¯¥ç±»å‹beanï¼Œé‚£ä¹ˆæŠ›å‡º å¼‚å¸¸ï¼Œå¹¶æŒ‡å‡ºä¸èƒ½ä½¿ç”¨byTypeæ–¹å¼è¿›è¡Œè‡ªåŠ¨è£…é…ï¼›å¦‚æœæ²¡æœ‰æ‰¾ åˆ°ç›¸åŒ¹é…çš„beanï¼Œåˆ™ä»€ä¹ˆäº‹éƒ½ä¸å‘ç”Ÿ 12345678910&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;    xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans    http://www.springframework.org/schema/beans/spring-beans.xsd&quot;     default-autowire=&quot;byType&quot;&gt;    &lt;bean id=&quot;autoWiringService&quot; class=&quot;com.imooc.autowiring.AutoWiringService&quot; &gt;&lt;/bean&gt;    &lt;bean id=&quot;autoWiringDAO&quot; class=&quot;com.imooc.autowiring.AutoWiringDAO&quot; &gt;&lt;/bean&gt;&lt;/beans&gt;&lt;!--autoWiringDAO  ä¹Ÿå¯ä»¥æ˜¯å…¶å®ƒåå­—ä¸å½±å“ï¼Œ ç”šè‡³åˆ é™¤ä¹Ÿå¯ä»¥--&gt;Constructor:ä¸byTypeæ–¹å¼ç±»ä¼¼ï¼Œä¸åŒä¹‹å¤„åœ¨äºå®ƒåº”ç”¨äºæ„é€ å™¨å‚æ•°ã€‚å¦‚æœå®¹å™¨ä¸­æ²¡æœ‰æ‰¾åˆ°ä¸æ„é€ å™¨å‚æ•°ç±»å‹ä¸€è‡´çš„beanï¼Œé‚£ä¹ˆæŠ›å‡ºå¼‚å¸¸ 123456789&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;    xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans    http://www.springframework.org/schema/beans/spring-beans.xsd&quot;     default-autowire=&quot;constructor&quot;&gt;    &lt;bean id=&quot;autoWiringService&quot; class=&quot;com.imooc.autowiring.AutoWiringService&quot; &gt;&lt;/bean&gt;    &lt;bean class=&quot;com.imooc.autowiring.AutoWiringDAO&quot; &gt;&lt;/bean&gt;&lt;/beans&gt;12345678910public class AutoWiringService {    private AutoWiringDAO autoWiringDAO;    public AutoWiringService(AutoWiringDAO autoWiringDAO) {        System.out.println(&quot;AutoWiringService&quot;);        this.autoWiringDAO = autoWiringDAO;    }    public void say(String word) {        this.autoWiringDAO.say(word);    }}Beançš„Resourcesé’ˆå¯¹äºèµ„æºæ–‡ä»¶çš„ç»Ÿä¸€æ¥å£Resources-UrlResourceï¼šURLå¯¹åº”çš„èµ„æºï¼Œæ ¹æ®ä¸€ä¸ªURLåœ°å€å³å¯æ„å»º -ClassPathResourceï¼šè·å–ç±»è·¯å¾„ä¸‹çš„èµ„æºæ–‡ä»¶ -FileSystemResource:è·å–æ–‡ä»¶ç³»ç»Ÿé‡Œé¢çš„èµ„æº -ServletContextResource:ServletContextå°è£…çš„èµ„æºï¼Œç”¨äºè®¿é—®ServletContextç¯å¢ƒä¸‹çš„èµ„æº -InputStreamResource:é’ˆå¯¹äºè¾“å…¥æµå°è£…çš„èµ„æº -ByteArrayResource:é’ˆå¯¹äºå­—èŠ‚æ•°ç»„å°è£…çš„èµ„æº ResourceLoader æ‰€æœ‰çš„application contextséƒ½å®ç°äº†ResourceLoaderæ¥å£ï¼Œå› æ­¤åœ¨Resourceå®ä¾‹ä¸­éƒ½å¯ä»¥ä½¿ç”¨application contextsã€‚123456public interface ResourceLoader{    Resource getResource(String location);}Resource template=ctx.getResource(&quot;some/resource/path/myTemplate.txt&quot;);Resource template=ctx.getResource(&quot;classpath:some/resource/path/myTemplate.txt&quot;);Resource template=ctx.getResource(&quot;file:/some/resource/path/myTemplate.txt&quot;);12345678910111213141516171819import java.io.IOException;import org.springframework.beans.BeansException;import org.springframework.context.ApplicationContext;import org.springframework.context.ApplicationContextAware;import org.springframework.core.io.Resource;public class MoocResource implements ApplicationContextAware  {private ApplicationContext applicationContext;@Overridepublic void setApplicationContext(ApplicationContext applicationContext)throws BeansException {this.applicationContext = applicationContext;}public void resource() throws IOException {Resource resource = applicationContext.getResource(&quot;config.txt&quot;);System.out.println(resource.getFilename());System.out.println(resource.contentLength());}}Beançš„å®šä¹‰åŠä½œç”¨åŸŸClasspathæ‰«æä¸ç»„ä»¶ç®¡ç†ä»Spring3.0å¼€å§‹ï¼ŒSpring JavaConfigé¡¹ç›®æä¾›äº†å¾ˆå¤šç‰¹æ€§ ï¼ŒåŒ…æ‹¬ä½¿ç”¨javaè€Œä¸æ˜¯XMLå®šä¹‰beanï¼Œæ¯”å¦‚@Configuration,@Bean,@Import,@DependsOn @Componentæ˜¯ä¸€ä¸ªé€šç”¨æ³¨è§£ï¼Œå¯ç”¨äºä»»ä½•bean @Repository,@Service,@Controlleræ˜¯æ›´æœ‰é’ˆå¯¹æ€§çš„æ³¨è§£ -@Repositoryé€šå¸¸ç”¨äºæ³¨è§£DAOç±»ï¼Œå³æŒä¹…å±‚ -@Serviceé€šå¸¸ç”¨äºæ³¨è§£Serviceç±»ï¼Œå³æœåŠ¡å±‚ -@Controlleré€šå¸¸ç”¨äºControllerç±»ï¼Œå³æ§åˆ¶å±‚ï¼ˆMVCï¼‰ç±»çš„è‡ªåŠ¨æ£€æµ‹åŠBeançš„æ³¨å†ŒÂ·Springå¯ä»¥è‡ªåŠ¨æ£€æµ‹ç±»å¹¶æ³¨å†ŒBeanåˆ°ApplicationContextä¸­123456789101112@Service bublic class SimpleMovielister{ private MovieFinder movieFinder; @Autovired public SimpleMovieLister(MovieFinder movieFinder){     this.movieFinder=movieFinder;}}@Repository public class JpaMovieFinder implements MovieFinder{ //implementation elided for clarity}context:annotation-config é€šè¿‡åœ¨åŸºäºXMLçš„Springé…ç½®å¦‚ä¸‹æ ‡ç­¾ï¼ˆè¯·æ³¨æ„åŒ…å«ä¸Šä¸‹æ–‡ å‘½åç©ºé—´ï¼‰ \ä»…ä¼šæŸ¥æ‰¾åœ¨åŒä¸€ä¸ªapplicatcontextä¸­çš„Beanæ³¨è§£12345678910&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;    xmlns:context=&quot;http://www.springframework.org/schema/context&quot;    xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans        http://www.springframework.org/schema/beans/spring-beans.xsd        http://www.springframework.org/schema/context        http://www.springframework.org/schema/context/spring-context.xsd&quot; &gt;    &lt;context:annotation-config/&gt;&lt;/beans&gt;ç±»çš„è‡ªåŠ¨æ£€æµ‹åŠBeançš„æ³¨å†Œä¸ºäº†èƒ½å¤Ÿæ£€æµ‹è¿™äº›ç±»å¹¶æ³¨å†Œç›¸åº”çš„Beanï¼Œéœ€è¦ä¸‹é¢å†…å®¹123&lt;beans&gt;   &lt;context:component-scan base-package=&quot;org.example&quot;/&gt;&lt;/beans&gt;\åŒ…å«ï¼Œé€šå¸¸åœ¨ä½¿ç”¨å‰è€…åï¼Œä¸ç”¨å†ä½¿ç”¨åè€…ï¼Œå‰è€…åŒ…å«åè€…å…¨éƒ¨åŠŸèƒ½AutowiredAnnotationBeanPostProcessorå’Œ CommonAnnotationBeanPostProcessorä¹Ÿä¼šè¢«åŒ…å«è¿›æ¥ä½¿ç”¨è¿‡æ»¤å™¨è¿›è¡Œè‡ªå®šä¹‰æ‰«æé»˜è®¤æƒ…å†µä¸‹ï¼Œç±»è¢«è‡ªåŠ¨å‘ç°å¹¶æ³¨å†Œbeançš„æ¡ä»¶æ˜¯ï¼šä½¿ç”¨ @Component,@Repository,@Service,@Controlleræ³¨è§£æˆ–è€…ä½¿ç”¨@Componentçš„è‡ªå®šä¹‰æ³¨è§£ å¯ä»¥é€šè¿‡è¿‡æ»¤å™¨ä¿®æ”¹ä¸Šé¢çš„è¡Œä¸ºï¼Œå¦‚:ä¸‹é¢ä¾‹å­çš„XMLé…ç½®å¿½ç•¥æ‰€æœ‰çš„@Repositoryæ³¨è§£å¹¶ç”¨â€œStubâ€ä»£æ›¿12345&lt;beans&gt;    &lt;context:component-scan base-package=&quot;org.example&quot;&gt;    &lt;context:include-filter type=&quot;regex&quot; expression=&quot;.*Stub.*Repository&quot;/&gt;    &lt;context:exclude-filter type=&quot;annotation&quot; expression=&quot;org.springframework.stereotype.Repository&quot;/&gt; &lt;/context:component-scan&gt; &lt;/beans&gt;è¿˜å¯ä½¿ç”¨use-default-filters=â€falseâ€ç¦ç”¨è‡ªåŠ¨å‘ç°ä¸æ³¨å†Œå®šä¹‰Beanæ‰«æè¿‡ç¨‹ä¸­ç»„ä»¶è¢«è‡ªåŠ¨æ£€æµ‹ï¼Œé‚£ä¹ˆBeanåç§°æ˜¯ç”± BeanNameGeneratorç”Ÿæˆçš„ï¼ˆ@Component, @Repository,@Service,@Controlleréƒ½ä¼šæœ‰ä¸ªnameå±æ€§ç”¨ äºæ˜¾å¼è®¾ç½®Bean Name) 1234@Service(&quot;myMovieLister&quot;)Repository public class SimpleMovieLister {}@Repositorypublic class MovieFinderImpl implements MovieFinder{}å¯è‡ªå®šä¹‰beanå‘½åç­–ç•¥ï¼Œå®ç°BeanNameGeneratoræ¥å£ï¼Œ å¹¶ä¸€å®šè¦åŒ…å«ä¸€ä¸ªæ— å‚æ•°æ„é€ å‡½å™¨123&lt;beans&gt;    &lt;context:component-scan base-package=&quot;org.example&quot; name-generator=&quot;org.example.MyNameGenerator&quot;/&gt;&lt;/beans&gt;ä½œç”¨åŸŸï¼ˆScope)é€šå¸¸æƒ…å†µä¸‹è‡ªåŠ¨æŸ¥æ‰¾çš„Springç»„ä»¶ï¼Œå…¶scopeæ˜¯singletonï¼ŒSpring2.5æä¾›äº†ä¸€ä¸ªæ ‡è¯†scopeçš„æ³¨è§£@Scope123@Scope(&quot;prototype&quot;) @Repository public class MovieFinderImpl implements MovieFinder{}ä¹Ÿå¯ä»¥è‡ªå®šä¹‰scopeç­–ç•¥ï¼Œå®ç°ScopeMetadataResolveræ¥ å£å¹¶æä¾›ä¸€ä¸ªæ— å‚æ„é€ å™¨ï¼Œæ¯”å¦‚åœ¨å¤šçº¿ç¨‹ä¸­123&lt;beans&gt; &lt;context:component-scan base-package=&quot;org.exampleâ€ scope-resolver=&quot;org.example.MyScopeResolver&quot;/&gt; &lt;/beans&gt; proxyModeå±æ€§12@Scope(&quot;prototype&quot; proxyMode=ScopedProxyMode.TARGET_CLASS )public class MovieFinderImpl implements MovieFinder{}Autowiredæ³¨è§£è¯´æ˜@Required@Requiredæ³¨è§£é€‚ç”¨äºbeanå±æ€§çš„setteræ–¹æ³• è¿™ä¸ªæ³¨è§£ä»…ä»…è¡¨ç¤ºï¼Œå—å½±å“çš„beanå±æ€§å¿…é¡»åœ¨é…ç½®æ—¶è¢«å¡«å……ï¼Œ é€šè¿‡åœ¨beanå®šä¹‰æˆ–é€šè¿‡è‡ªåŠ¨è£…é…ä¸€ä¸ªæ˜ç¡®çš„å±æ€§å€¼ 1234567public class SimpleMovieLister {private MovieFinder movieFinder;     @Required     public void setMovieFinder(MovieFinder movieFinder){         this.movieFinder=movieFinder;     }}@Autowiredå¯ä»¥å°†@Autowiredæ³¨è§£ä¸ºâ€œä¼ ç»Ÿâ€çš„setteræ–¹æ³• 1234567private MovieFinder movieFinder;     @Autovired     public void setMovieFinder(MovieFinder movieFinder)    {     this.moviesinder=movieFinder;     }}å¯ç”¨äºæ„é€ å™¨æˆ–æˆå‘˜å˜é‡ 1234567@Autovired private MovieCatalog movieCatalog; private CustomerPreferenceDao customerPreferenceDao; @Autovired public MovieRecommender(CustomerPreferenceDao customerPreferenceDao){     this.customerPreferenceDao=customerPreferenceDao;}é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœå› æ‰¾ä¸åˆ°åˆé€‚çš„beanå°†ä¼šå¯¼è‡´autowiring å¤±è´¥æŠ›å‡ºå¼‚å¸¸ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹å¼é¿å…1234567public class simpleMovieLister{     private MovieFinder movieFinder;     @Autovired(required=false)     public void setMovieFinder(MovieFinder movieFinder){         this.movieFinder=movieFinder;    }}æ¯ä¸ªç±»åªèƒ½æœ‰ä¸€ä¸ªæ„é€ å™¨è¢«æ ‡è®°ä¸ºrequired=true @Autowiredçš„å¿…è¦å±æ€§ï¼Œå»ºè®®ä½¿ç”¨@Requiredæ³¨è§£ 1234567891011&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;    xmlns:context=&quot;http://www.springframework.org/schema/context&quot;    xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans        http://www.springframework.org/schema/beans/spring-beans.xsd        http://www.springframework.org/schema/context        http://www.springframework.org/schema/context/spring-context.xsd&quot; &gt;&lt;context:component-scan base-package=&quot;com.imooc.beanannotation&quot;&gt;    &lt;/context:component-scan&gt; &lt;/beans&gt;12345678910111213141516171819202122232425262728import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Service;import com.imooc.beanannotation.injection.dao.InjectionDAO;    @Servicepublic class InjectionServiceImpl implements InjectionService {    // æ–¹å¼ä¸€// @Autowiredprivate InjectionDAO injectionDAO;        // æ–¹å¼äºŒ@Autowiredpublic InjectionServiceImpl(InjectionDAO injectionDAO) {this.injectionDAO = injectionDAO;}        // æ–¹å¼ä¸‰// @Autowiredpublic void setInjectionDAO(InjectionDAO injectionDAO) {this.injectionDAO = injectionDAO;}        @Overridepublic void save(String arg) {System.out.println(&quot;Serviceæ¥æ”¶å‚æ•°ï¼š&quot; + arg);injectionDAO.save(arg + &quot;:&quot; + this.hashCode());}}å¯ä»¥ä½¿ç”¨@Autowiredæ³¨è§£é‚£äº›ä¼—æ‰€å‘¨çŸ¥çš„è§£æä¾èµ–æ€§æ¥å£ï¼Œ æ¯”å¦‚ï¼šBeanFactoryï¼ŒApplicationContext,Environment, ResourceLoader,ApplicationEventPublisher,and MessageSource 1234public class MovieRecommender { @Autovired private ApplicationContext context;     public MovieRecommender(){}} å¯ä»¥é€šè¿‡æ·»åŠ æ³¨è§£ç»™éœ€è¦è¯¥ç±»å‹çš„æ•°ç»„çš„å­—æ®µæˆ–æ–¹æ³•ï¼Œä»¥æä¾›ApplicationContextä¸­çš„æ‰€æœ‰ç‰¹å®šç±»å‹çš„bean12345private Set&lt;Moviecatalog&gt; movieCatalogs; @Autovired public void seMovieCatalogs(Set&lt;MovieCatalog&gt; movieCatalogs){( this.movieCatalogs=movieCatalogs;}å¯ä»¥ç”¨å¹²è£…é…kewä¸ºstringçš„Map12345private Map&lt;String,Movlecatalog&gt; moviecatalogs; @Aucovired pablic void setMovieCatalogs(Map&lt;String,MovieCatalog &gt; movieCatalogs){this.movieCatalogs=movieCatalogs;}å¦‚æœå¸Œæœ›æ•°ç»„æœ‰åºï¼Œå¯ä»¥è®©beanå®ç° org.springframework.core.Orderedæ¥å£æˆ–ä½¿ç”¨çš„@Orderæ³¨è§£ï¼Œå¹¶ä¸”åªé’ˆå¯¹æ•°ç»„æœ‰æ•ˆ@Autowiredæ˜¯ç”±Spring BeanPostProcessorå¤„ç†çš„ï¼Œæ‰€ä»¥ä¸èƒ½åœ¨è‡ªå·±çš„BeanPostProcessoræˆ– BeanFactoryPostProcessorç±»å‹åº”ç”¨è¿™äº›æ³¨è§£ï¼Œè¿™äº›ç±»å‹å¿…é¡»é€šè¿‡XMLæˆ–è€…Springçš„@Beanæ³¨è§£åŠ è½½123456789101112public interface BeanInterface {}import org.springframework.core.annotation.Order;import org.springframework.stereotype.Component;@Order(2)@Componentpublic class BeanImplOne implements BeanInterface {}@Order(1)@Componentpublic class BeanImplTwo implements BeanInterface {}1234567891011121314151617181920212223242526import java.util.List;import java.util.Map;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.beans.factory.annotation.Qualifier;import org.springframework.stereotype.Component;@Componentpublic class BeanInvoker {@Autowiredprivate List&lt;BeanInterface&gt; list;public void say() {if (null != list &amp;&amp; 0 != list.size()) {System.out.println(&quot;list...&quot;);for (BeanInterface bean : list) {System.out.println(bean.getClass().getName());}} else {System.out.println(&quot;List&lt;BeanInterface&gt; list is null&quot;);}}}list...com.imooc.beanannotation.multibean.BeanImplTwocom.imooc.beanannotation.multibean.BeanImplOne1234567891011121314151617181920212223242526import java.util.List;import java.util.Map;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.beans.factory.annotation.Qualifier;import org.springframework.stereotype.Component;@Componentpublic class BeanInvoker {@Autowiredprivate Map&lt;String, BeanInterface&gt; map;public void say() {if (null != map &amp;&amp; 0 != map.size()) {System.out.println(&quot;map...&quot;);for (Map.Entry&lt;String, BeanInterface&gt; entry : map.entrySet()) {System.out.println(entry.getKey() + &quot;      &quot; + entry.getValue().getClass().getName());}} else {System.out.println(&quot;Map&lt;String, BeanInterface&gt; map is null&quot;);}}}map...beanImplTwo  com.imooc.beanannotation.multibean.BeanImplTwobeanImplOne  com.imooc.beanannotation.multibean.BeanImplOne@Qualifieræ³¨è§£æŒ‰ç±»å‹è‡ªåŠ¨è£…é…å¯èƒ½å¤šä¸ªbeanå®ä¾‹çš„æƒ…å†µï¼Œå¯ä»¥ä½¿ç”¨Springçš„@Qualifieræ³¨è§£ç¼©å°èŒƒå›´(æˆ–æŒ‡å®šå”¯ä¸€)ï¼Œä¹Ÿå¯ä»¥ç”¨äºæŒ‡å®šå•ç‹¬çš„æ„é€ å™¨å‚æ•°æˆ–æ–¹æ³•å‚æ•° å¯ç”¨äºæ³¨è§£é›†åˆç±»å‹å˜é‡ä¸»è¦ç”±xmlå®šä¹‰å’Œjavaæ³¨è§£å®ç°è¿™ä¸¤ç§æ–¹å¼123456&lt;bean class=&quot;example.SimpleMovieCatalog&quot;&gt; &gt;&lt;qualifier value=&quot;main&quot;/&gt; &lt;/bean&gt; &gt;&lt;bean class=&quot;example.SimpleMovieCatalog&quot;&gt; &lt;qualifier value=&quot;action&quot;/&gt;&lt;/bean&gt; å¦‚æœé€šè¿‡åå­—è¿›è¡Œæ³¨è§£æ³¨å…¥ï¼Œä¸»è¦ä½¿ç”¨çš„ä¸æ˜¯@Autowired( å³ä½¿åœ¨æŠ€æœ¯ä¸Šèƒ½å¤Ÿé€šè¿‡@Qualifierå®šbeançš„åå­—ï¼‰ï¼Œæ›¿ä»£æ–¹å¼æ˜¯ä½¿ç”¨JSR-250@Resourceæ³¨è§£ï¼Œå®ƒæ˜¯é€šè¿‡å…¶ç‹¬ç‰¹çš„åç§° æ¥å®šä¹‰æ¥è¯†åˆ«ç‰¹å®šçš„ç›®æ ‡ï¼ˆè¿™æ˜¯ä¸€ä¸ªä¸æ‰€å£°æ˜çš„ç±»å‹æ˜¯æ— å…³çš„ åŒ¹é…è¿‡ç¨‹ï¼‰å› è¯­ä¹‰å·®å¼‚ï¼Œé›†åˆæˆ–Mapç±»å‹çš„beanæ— æ³•é€šè¿‡@Autowired æ¥æ³¨å…¥ï¼Œå› ä¸ºæ²¡æœ‰ç±»å‹åŒ¹é…åˆ°è¿™æ ·çš„beanï¼Œä¸ºè¿™äº›beanä½¿ç”¨ @Resourceæ³¨è§£ï¼Œé€šè¿‡å”¯ä¸€åç§°å¼•ç”¨é›†åˆæˆ–Mapçš„bean @Autowiredé€‚ç”¨äºfields,constructors,multi-argument methodsè¿™äº›å…è®¸åœ¨å‚æ•°çº§åˆ«ä½¿ç”¨@Qualifieræ³¨è§£ç¼©å°èŒƒå›´çš„æƒ…å†µ @Resourceé€‚ç”¨äºæˆå‘˜å˜é‡ã€åªæœ‰ä¸€ä¸ªå‚æ•°çš„setteræ–¹æ³•ï¼Œæ‰€ä»¥åœ¨ç›®æ ‡æ˜¯æ„é€ å™¨æˆ–ä¸€ä¸ªå¤šå‚æ•°æ–¹æ³•æ—¶ï¼Œæœ€å¥½çš„æ–¹å¼æ˜¯ä½¿ç”¨qualifierså¯ä»¥å®šä¹‰è‡ªå·±çš„Qualifier123456789101112131415161718192021222324252627@Componentpublic class BeanImplOne implements BeanInterface {}@Componentpublic class BeanImplTwo implements BeanInterface {}import org.springframework.beans.factory.annotation.Autowired;&gt;import org.springframework.beans.factory.annotation.Qualifier;import org.springframework.stereotype.Component;@Componentpublic class BeanInvoker {@Autowired@Qualifier(&quot;beanImplTwo&quot;)private BeanInterface beanInterface;public void say() {if (null != beanInterface) {System.out.println(beanInterface.getClass().getName());} else {System.out.println(&quot;beanInterface is null...&quot;);}}}com.imooc.beanannotation.multibean.BeanImplTwoåŸºäºJavaçš„å®¹å™¨æ³¨è§£@Beanæ ‡è¯†ä¸€ä¸ªç”¨äºé…ç½®å’Œåˆå§‹åŒ–ä¸€ä¸ªç”±SpringloCå®¹å™¨ç®¡ç†çš„æ–°å¯¹è±¡çš„æ–¹æ³•ï¼Œç±»ä¼¼äºXMLé…ç½®æ–‡ä»¶çš„ å¯ä»¥åœ¨Springçš„@Componentæ³¨è§£çš„ç±»ä¸­ä½¿ç”¨@Beanæ³¨è§£ ä»»ä½•æ–¹æ³•ï¼ˆä»…ä»…æ˜¯å¯ä»¥ï¼‰ä¸Šä¸€ç‚¹ä¸­ï¼Œé€šå¸¸ä½¿ç”¨çš„æ˜¯@Configuration 1&lt;beans&gt; &lt;bean id=&quot;myService&quot; class=&quot;com.acme.services.MyServiceImp1&quot;/&gt; &lt;/beans&gt;ç­‰ä»·äº123456789101112import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;    @Configurationpublic class StoreConfig {    // è‹¥æ²¡æœ‰æŒ‡æ˜nameï¼Œåˆ™é»˜è®¤ä¸ºæ–¹æ³•å    // @Bean@Bean(name=&quot;stringStore&quot; initMethod=&quot;init&quot; destoryMethod=&quot;cleanup&quot;)public StringStore stringStore() {return new StringStore();}}ä½¿ç”¨@ImportResourceå’Œ@Value æ³¨è§£è¿›è¡Œèµ„æºæ–‡ä»¶è¯»å–12345678910&lt;beans&gt;    &lt;context:annotation-config/&gt;     &lt;context:property-placeholder location=&quot;classpath:/com/acme/jdbc.properties&quot;/&gt;     &lt;bean class=&quot;com.acme.AppConfig&quot;/&gt;     &lt;bean class=lWorg.springframework.jdbc.datasource.DriverManagerDataSource&quot;&gt;         &lt;property name=&quot;url&quot; value=&quot;${jdbc.url}&quot;/&gt;         &lt;property name=&quot;username&quot; value=&quot;${jdbc.username}&quot;/&gt;         &lt;property name=&quot;password&quot; value=&quot;S{jdbc.password)&quot;/&gt; &lt;/bean&gt; &lt;/beans&gt; ç­‰ä»·äº123456789101112131415@Configuration ImportResource(&quot;classpath:/com/acme/properties-config.xm1&quot;) public class AppConfig{    @Value(&quot;$(jdbc.url)&quot;)     private String url;     @Value(&quot;$(jdbc.username)&quot;)     private String username;     @Value(&quot;jdbc.password)&quot;)     private String password;         @Bean     public DataSource dataSource(){         return new DriverManagerDataSource(url,username,password);     }}12345# properties-config.xm1jdbc.username=rootpassword=rooturl=127.00.1åŸºäºæ³›å‹çš„è£…é…&gt;&gt;123456789101112131415161718192021222324252627282930313233&gt;public interface Store&lt;T&gt; {}&gt;public class StringStore implements Store&lt;String&gt; {}&gt;public class IntegerStore implements Store&lt;Integer&gt; {}&gt;import org.springframework.beans.factory.annotation.Autowired;&gt;import org.springframework.context.annotation.Bean;&gt;import org.springframework.context.annotation.Configuration;&gt;import org.springframework.context.annotation.ImportResource;&gt;@Configuration&gt;@ImportResource(&quot;classpath:config.xml&quot;)&gt;public class StoreConfig {@Autowiredprivate Store&lt;String&gt; s1;@Autowiredprivate Store&lt;Integer&gt; s2;@Beanpublic StringStore stringStore() {return new StringStore();}@Beanpublic IntegerStore integerStore() {return new IntegerStore();}   @Bean(name = &quot;stringStoreTest&quot;)public Store stringStoreTest() {System.out.println(&quot;s1 : &quot; + s1.getClass().getName());System.out.println(&quot;s2 : &quot; + s2.getClass().getName());return new StringStore();}&gt;}CustomAutowireConfigurerCustomAutowireConfigureræ˜¯ BeanFactoryPostProcessorçš„å­ç±»ï¼Œé€šè¿‡å®ƒå¯ä»¥æ³¨å†Œè‡ªå·±çš„ qualifieræ³¨è§£ç±»å‹ï¼ˆå³ä½¿æ²¡æœ‰ä½¿ç”¨Springçš„@Qualifier æ³¨è§£ï¼‰1234567&lt;bean id=&quot;customAutowireConfigurer&quot; class=&quot;org.springframework.beans.factory.annotation.CustomAutowireConfigurer&quot;&gt;     &lt;property name=&quot;customQualifierTypes&quot;&gt;         &lt;set&gt;             &lt;value&gt;example.CustomQualifier&lt;/value&gt;         &lt;/set&gt;     &lt;/property&gt; &lt;/bean&gt;è¯¥AutowireCandidateResolverå†³å®šè‡ªåŠ¨è£…é…çš„å€™é€‰è€…-æ¯ä¸ªbeanå®šä¹‰çš„autowire-candidateå€¼ -ä»»ä½•ä¸­çš„default-autowire-candidates -@Qualifieræ³¨è§£åŠä½¿ç”¨CustomAutowireConfigurerçš„è‡ªå®šä¹‰ç±»å‹JSRæ”¯æŒè¯´æ˜Spring AOPåŸºæœ¬æ¦‚å¿µSpring AOPæ˜¯ä»€ä¹ˆ?ä½ éƒ½æ‹¿å®ƒåšä»€ä¹ˆ?AOPåŸºæœ¬æ¦‚å¿µå’Œç‰¹ç‚¹ä»€ä¹ˆæ˜¯AOPAOPï¼šAspect Oriented Programmingçš„ç¼©å†™ï¼Œæ„ä¸ºï¼šé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œé€šè¿‡é¢„ç¼–è¯‘æ–¹å¼å’Œè¿è¡ŒæœŸåŠ¨æ€ä»£ç†å®ç°ç¨‹åºåŠŸèƒ½ çš„ç»Ÿä¸€ç»´æŠ¤çš„ä¸€ç§æŠ€æœ¯ ä¸»è¦çš„åŠŸèƒ½æ˜¯ï¼šæ—¥å¿—è®°å½•ï¼Œæ€§èƒ½ç»Ÿè®¡ï¼Œå®‰å…¨æ§åˆ¶ï¼Œäº‹åŠ¡å¤„ç†ï¼Œ å¼‚å¸¸å¤„ç†ç­‰ç­‰ &gt;AOPå®ç°æ–¹å¼é¢„ç¼–è¯‘ -AspectJ è¿è¡ŒæœŸåŠ¨æ€ä»£ç†ï¼ˆJDKåŠ¨æ€ä»£ç†ã€CGLibåŠ¨æ€ä»£ç†ï¼‰ -SpringAOPJbossAOP AOPå‡ ä¸ªç›¸å…³æ¦‚å¿µ åç§°è¯´æ˜åˆ‡é¢(Aspect)ä¸€ä¸ªå…³æ³¨ç‚¹çš„æ¨¡å—åŒ–ï¼Œè¿™ä¸ªå…³æ³¨ç‚¹å¯èƒ½ä¼šæ¨ªåˆ‡å¤šä¸ªå¯¹è±¡è¿æ¥ç‚¹(Joinpoint)ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­çš„æŸä¸ªç‰¹å®šçš„ç‚¹é€šçŸ¥(Advice)åœ¨åˆ‡é¢çš„æŸä¸ªç‰¹å®šçš„è¿æ¥ç‚¹ä¸Šæ‰§è¡Œçš„åŠ¨ä½œåˆ‡å…¥ç‚¹(Pointcut)åŒ¹é…è¿æ¥ç‚¹çš„æ–­è¨€ï¼Œåœ¨AOPä¸­é€šçŸ¥å’Œä¸€ä¸ªåˆ‡å…¥ç‚¹è¡¨è¾¾å¼å…³è”å¼•å…¥(Introduction)åœ¨ä¸ä¿®æ”¹ç±»ä»£ç çš„å‰æä¸‹ï¼Œä¸ºç±»æ·»åŠ æ–°çš„æ–¹æ³•å’Œå±æ€§ç›®æ ‡å¯¹è±¡(Target Object)è¢«ä¸€ä¸ªæˆ–è€…å¤šä¸ªåˆ‡é¢æ‰€é€šçŸ¥çš„å¯¹è±¡AOPä»£ç†(AOP Proxy)AOPæ¡†æ¶åˆ›å»ºçš„å¯¹è±¡ï¼Œç”¨æ¥å®ç°åˆ‡é¢å¥‘çº¦(aspect contract)(åŒ…æ‹¬é€šçŸ¥æ–¹æ³•æ‰§è¡Œç­‰åŠŸèƒ½ï¼‰ç»‡å…¥(Weaving)æŠŠåˆ‡é¢è¿æ¥åˆ°å…¶å®ƒçš„åº”ç”¨ç¨‹åºç±»å‹æˆ–è€…å¯¹è±¡ä¸Šï¼Œå¹¶åˆ›å»ºä¸€ä¸ªè¢«é€šçŸ¥çš„å¯¹è±¡ï¼Œåˆ†ä¸ºï¼šç¼–è¯‘æ—¶ç»‡å…¥ã€ç±»åŠ è½½æ—¶ç»‡å…¥ã€æ‰§è¡Œæ—¶ç»‡å…¥Adviceçš„ç±»å‹åç§°è¯´æ˜å‰ç½®é€šçŸ¥(Before advice)åœ¨æŸè¿æ¥ç‚¹(join point)ä¹‹å‰æ‰§è¡Œçš„é€š çŸ¥ï¼Œä½†ä¸èƒ½é˜»æ­¢è¿æ¥ç‚¹å‰çš„æ‰§è¡Œ(é™¤éå®ƒæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼‰è¿”å›åé€šçŸ¥(After returning advice)(After returning advice)åœ¨æŸè¿æ¥ç‚¹(join point)æ­£å¸¸å®Œæˆåæ‰§è¡Œçš„é€šçŸ¥æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥(After throwing advice)åœ¨æ–¹æ³•æŠ›å‡ºå¼‚å¸¸é€€å‡ºæ—¶æ‰§è¡Œçš„é€šçŸ¥åé€šçŸ¥(After((finally) advice)å½“æŸè¿æ¥ç‚¹é€€å‡ºçš„æ—¶å€™æ‰§è¡Œçš„é€šçŸ¥(ä¸è®ºæ˜¯æ­£å¸¸è¿”å›è¿˜æ˜¯å¼‚å¸¸é€€å‡ºï¼‰ç¯ç»•é€šçŸ¥(Around Advice)åŒ…å›´ä¸€ä¸ªè¿æ¥ç‚¹(join point)çš„é€šçŸ¥Springæ¡†æ¶ä¸­AOPçš„ç”¨é€”æä¾›äº†å£°æ˜å¼çš„ä¼ä¸šæœåŠ¡ï¼Œç‰¹åˆ«æ˜¯EJBçš„æ›¿ä»£æœåŠ¡çš„å£°æ˜ å…è®¸ç”¨æˆ·å®šåˆ¶è‡ªå·±çš„æ–¹é¢ï¼Œä»¥å®ŒæˆOOPä¸AOPçš„äº’è¡¥ä½¿ç”¨ Springçš„AOPå®ç°çº¯javaå®ç°ï¼Œæ— éœ€ç‰¹æ®Šçš„ç¼–è¯‘è¿‡ç¨‹ï¼Œä¸éœ€è¦æ§åˆ¶ç±»åŠ è½½å™¨å±‚æ¬¡ ç›®å‰åªæ”¯æŒæ–¹æ³•æ‰§è¡Œè¿æ¥ç‚¹(é€šçŸ¥Spring Beançš„æ–¹æ³•æ‰§è¡Œ) ä¸æ˜¯ä¸ºäº†æä¾›æœ€å®Œæ•´çš„AOPå®ç°(å°½ç®¡å®ƒéå¸¸å¼ºå¤§)ï¼›è€Œæ˜¯ä¾§é‡äºæä¾›ä¸€ç§AOPå®ç°å’ŒSpring IoCå®¹å™¨ä¹‹é—´çš„æ•´åˆï¼Œç”¨äºå¸®åŠ©è§£å†³ä¼ä¸šåº”ç”¨ä¸­çš„å¸¸è§é—®é¢˜ Spring AOPä¸ä¼šä¸AspectUç«äº‰ï¼Œä»è€Œæä¾›ç»¼åˆå…¨é¢çš„AOPè§£å†³æ–¹æ¡ˆ æœ‰æ¥å£å’Œæ— æ¥å£çš„Spring AOPå®ç°åŒºåˆ«Spring AOPé»˜è®¤ä½¿ç”¨æ ‡å‡†çš„JavaSEåŠ¨æ€ä»£ç†ä½œä¸ºAOPä»£ç†ï¼Œ è¿™ä½¿å¾—ä»»ä½•æ¥å£(æˆ–è€…æ¥å£é›†)éƒ½å¯ä»¥è¢«ä»£ç† Spring AOPä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨CGLIBä»£ç†(å¦‚æœä¸€ä¸ªä¸šåŠ¡å¯¹è±¡å¹¶æ²¡æœ‰å®ç°ä¸€ä¸ªæ¥å£)é…ç½®åˆ‡é¢å’Œåˆ‡å…¥ç‚¹Schema-based AOPSpringæ‰€æœ‰çš„åˆ‡é¢å’Œé€šçŸ¥å™¨éƒ½å¿…é¡»æ”¾åœ¨ä¸€ä¸ªå†… ï¼ˆå¯ä»¥é…ç½®åŒ…å«å¤šä¸ªå…ƒç´ ï¼‰ï¼Œæ¯ä¸€ä¸ª \å¯ä»¥åŒ…å«pointcutï¼Œadvisorå’Œaspectå…ƒç´  ï¼ˆå®ƒä»¬å¿…é¡»æŒ‰ç…§è¿™ä¸ªé¡ºåºè¿›è¡Œå£°æ˜ )\é£æ ¼çš„é…ç½®å¤§é‡ä½¿ç”¨äº†Springçš„è‡ªåŠ¨ä»£ç†æœºåˆ¶123456&lt;bean id=&quot;moocAspect&quot; class=&quot;com.imooc.aop.schema.advice.MoocAspect&quot;&gt;&lt;/bean&gt; &lt;bean id=&quot;aspectBiz&quot; class=&quot;com.imooc.aop.schema.advice.biz.AspectBiz&quot;&gt;&lt;/bean&gt; &lt;aop:config&gt;     &lt;aop:aspect id=&quot;moocAspect4op&quot; ref=&quot;moocAspect&quot;&gt;        &lt;aop:pointcut expression=&quot;execution(* com.imooc.aop.schema.advice.biz.*Biz(..))&quot; id=&quot;moocPiontcut&quot;/&gt;    &lt;/aop:aspect&gt;&lt;/aop:config&gt; | è¡¨è¾¾å¼                                                       | å«ä¹‰                                                         || â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” | â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” || execution(public*(..))                                      | åˆ‡å…¥ç‚¹ä¸ºæ‰§è¡Œæ‰€æœ‰publicæ–¹æ³•æ—¶                                 || execution( set(..))                                        | åˆ‡å…¥ç‚¹ä¸ºæ‰§è¡Œæ‰€æœ‰setå¼€å§‹çš„æ–¹æ³•æ—¶                              || execution( com.service.Service.(..))                       | åˆ‡å…¥ç‚¹ä¸ºæ‰§è¡ŒAccountServiceç±»ä¸­çš„æ‰€æœ‰æ–¹æ³•æ—¶                   || execution( com.xyz.service..(.))                            | åˆ‡å…¥ç‚¹ä¸ºæ‰§è¡Œcom.xyz.serviceåŒ…ä¸‹çš„æ‰€æœ‰æ–¹æ³•æ—¶                  || execution( com.xyz.serviceâ€¦(..))                          | åˆ‡å…¥ç‚¹ä¸ºæ‰§è¡Œcom.xyz.serviceåŒ…åŠå…¶å­åŒ…ä¸‹çš„æ‰€æœ‰æ–¹æ³•æ—¶          || within(com.xyz.service.)                                    | (only in Spring AOP)                                         || within(com.xyz.service..*)                                   | (only in Spring AOP) withinç”¨äºåŒ¹é…æŒ‡å®šç±»å‹å†…çš„æ–¹æ³•æ‰§è¡Œ || this(com.xyz.service.AccountService)                         | (only in Spring AOP)thisç”¨äºåŒ¹é…å½“å‰AOPä»£ç†å¯¹è±¡ç±»å‹çš„æ‰§è¡Œæ–¹æ³• || target(com.xyz.service.AccountService)                       | (only in Spring AOP)target ç”¨äºåŒ¹é…å½“å‰ç›®æ ‡å¯¹è±¡ç±»å‹çš„æ‰§è¡Œæ–¹æ³• || @annotation(org.springframework.transaction.annota tion.Transactional) | (only in Spring AOP)args ç”¨äºåŒ¹é…å½“å‰æ‰§è¡Œçš„æ–¹æ³•ä¼ å…¥çš„å‚æ•°ä¸ºæŒ‡å®šç±»å‹çš„æ‰§è¡Œæ–¹æ³• |Adviceåº”ç”¨123456&gt;public class AspectBiz {public void biz() {System.out.println(&quot;AspectBiz biz.&quot;);&gt;//throw new RuntimeException();}&gt;}1234567891011121314151617&gt;import org.aspectj.lang.ProceedingJoinPoint;&gt;public class MoocAspect {public void before() {System.out.println(&quot;MoocAspect before.&quot;);}public void afterReturning() {System.out.println(&quot;MoocAspect afterReturning.&quot;);}public void afterThrowing() {System.out.println(&quot;MoocAspect afterThrowing.&quot;);}public void after() {System.out.println(&quot;MoocAspect after.&quot;);}&gt;}12345678910&gt;&lt;bean id=&quot;moocAspect&quot; class=&quot;com.imooc.aop.schema.advice.MoocAspect&quot;&gt;&lt;/bean&gt; &gt;&lt;bean id=&quot;aspectBiz&quot; class=&quot;com.imooc.aop.schema.advice.biz.AspectBiz&quot;&gt;&lt;/bean&gt; &lt;aop:config&gt;    &lt;aop:aspect id=&quot;moocAspect4op&quot; ref=&quot;moocAspect&quot;&gt;       &lt;aop:pointcut expression=&quot;execution(* com.imooc.aop.schema.advice.biz.*Biz(..))&quot; id=&quot;moocPiontcut&quot;/&gt;       &lt;aop:before method=&quot;before&quot; pointcut-ref=&quot;moocPiontcut&quot;/&gt; &lt;aop:after-returning method=&quot;afterReturning&quot; pointcut-ref=&quot;moocPiontcut&quot;/&gt; &lt;aop:after-throwing method=&quot;afterThrowing&quot; pointcut-ref=&quot;moocPiontcut&quot;/&gt; &lt;aop:after method=&quot;after&quot; pointcut-ref=&quot;moocPiontcut&quot;/&gt;    &lt;/aop:aspect&gt;&gt;&lt;/aop:config&gt; 12345&gt;// è¾“å‡º&gt;MoocAspect before.&gt;AspectBiz biz.&gt;MoocAspect afterReturning.&gt;MoocAspect afterAround adviceé€šçŸ¥æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯ProceedingJoinPointç±»å‹ 1&lt;aop:around method=&quot;around&quot; pointcut-ref=&quot;moocPiontcut&quot;/&gt;1234567891011public Object around(ProceedingJoinPoint pjp) {Object obj = null;try {System.out.println(&quot;MoocAspect around 1.&quot;);obj = pjp.proceed();System.out.println(&quot;MoocAspect around 2.&quot;);} catch (Throwable e) {e.printStackTrace();}return obj;}Advice parameters12&gt;&lt;aop:around method=&quot;aroundInit&quot;            pointcut=&quot;execution(* com.imooc.aop.schema.advice.biz.AspectBiz.init(String, int)) and args(bizName, times)&quot;/&gt; 12345678&gt;public class AspectBiz {public void biz() {System.out.println(&quot;AspectBiz biz.&quot;);}public void init(String bizName, int times) {System.out.println(&quot;AspectBiz init : &quot; + bizName + &quot;   &quot; + times);}&gt;}123456789101112131415&gt;import org.aspectj.lang.ProceedingJoinPoint;&gt;public class MoocAspect {public Object aroundInit(ProceedingJoinPoint pjp, String bizName, int times) {System.out.println(bizName + &quot;   &quot; + times);Object obj = null;try {System.out.println(&quot;MoocAspect aroundInit 1.&quot;);obj = pjp.proceed();System.out.println(&quot;MoocAspect aroundInit 2.&quot;);} catch (Throwable e) {e.printStackTrace();}return obj;}&gt;}Introductionåº”ç”¨å…è®¸ä¸€ä¸ªåˆ‡é¢å£°æ˜ä¸€ä¸ªå®ç°æŒ‡å®šæ¥å£çš„é€šçŸ¥å¯¹è±¡ï¼Œå¹¶ä¸”æä¾›äº†ä¸€ä¸ªæ¥å£å®ç°ç±»æ¥ä»£è¡¨è¿™äº›å¯¹è±¡ ç”±\ä¸­çš„\å…ƒç´ å£°æ˜è¯¥å…ƒç´ ç”¨äºå£°æ˜æ‰€åŒ¹é…çš„ç±»å‹æ‹¥æœ‰ä¸€ä¸ªæ–°çš„parentï¼ˆå› æ­¤å¾—åï¼‰schema-defined aspectsåªæ”¯æŒsingleton model 12345678&lt;aop:config&gt;    &lt;aop:aspect id=&quot;moocAspectAOP&quot; ref=&quot;moocAspect&quot;&gt;        &lt;aop:declare-parents         types-matching=&quot;com.imooc.aop.schema.advice.biz.*(+)&quot;            implement-interface=&quot;com.imooc.aop.schema.advice.Fit&quot;            default-impl=&quot;com.imooc.aop.schema.advice.FitImpl&quot;/&gt;    &lt;/aop:aspect&gt;&lt;/aop:config&gt;12345678910111213141516171819public interface Fit {void filter();}public class FitImpl implements Fit {@Overridepublic void filter() {System.out.println(&quot;FitImpl filter.&quot;);}}@Test public void testFit0{     Fit fit=(Fit)super.getBean(&quot;aspectBiz&quot;);     fit.filter0; }// è¾“å‡ºFitImpl filter.Advisorsadvisorå°±åƒä¸€ä¸ªå°çš„è‡ªåŒ…å«çš„æ–¹é¢ï¼Œåªæœ‰ä¸€ä¸ªadvice åˆ‡é¢è‡ªèº«é€šè¿‡ä¸€ä¸ªbeanè¡¨ç¤ºï¼Œå¹¶ä¸”å¿…é¡»å®ç°æŸä¸ªadvice æ¥å£ï¼ŒåŒæ—¶ï¼Œadvisorä¹Ÿå¯ä»¥å¾ˆå¥½çš„åˆ©ç”¨AspectJçš„åˆ‡å…¥ ç‚¹è¡¨è¾¾å¼ Springé€šè¿‡é…ç½®æ–‡ä»¶ä¸­\å…ƒç´ æ”¯æŒadvisor å®é™…ä½¿ç”¨ä¸­ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹å®ƒä¼šå’Œtransactional advice é…åˆä½¿ç”¨ ä¸ºäº†å®šä¹‰ä¸€ä¸ªadvisorçš„ä¼˜å…ˆçº§ä»¥ä¾¿è®©adviceå¯ä»¥æœ‰åºï¼Œ å¯ä»¥ä½¿ç”¨orderå±æ€§æ¥å®šä¹‰advisorçš„é¡ºåº 123456789101112131415161718192021222324252627282930&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;    xmlns:context=&quot;http://www.springframework.org/schema/context&quot;    xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot;    xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans         http://www.springframework.org/schema/beans/spring-beans.xsd          http://www.springframework.org/schema/context        http://www.springframework.org/schema/context/spring-context.xsd        http://www.springframework.org/schema/aop         http://www.springframework.org/schema/aop/spring-aop.xsd&quot;&gt;&lt;context:component-scan base-package=&quot;com.imooc.aop.schema&quot;&gt;    &lt;/context:component-scan&gt;&lt;aop:config&gt;&lt;aop:aspect id=&quot;concurrentOperationRetry&quot;                     ref=&quot;concurrentOperationExecutor&quot;&gt;&lt;aop:pointcut id=&quot;idempotentOperation&quot;            expression=&quot;execution(* com.imooc.aop.schema.advisors.service.*.*(..)) &quot; /&gt;&lt;aop:around pointcut-ref=&quot;idempotentOperation&quot;                         method=&quot;doConcurrentOperation&quot; /&gt;&lt;/aop:aspect&gt;&lt;/aop:config&gt;&lt;bean id=&quot;concurrentOperationExecutor&quot;           class=&quot;com.imooc.aop.schema.advisors.ConcurrentOperationExecutor&quot;&gt;&lt;property name=&quot;maxRetries&quot; value=&quot;3&quot; /&gt;&lt;property name=&quot;order&quot; value=&quot;100&quot; /&gt;&lt;/bean&gt; &lt;/beans&gt;1234567891011121314151617181920212223242526272829303132333435import org.aspectj.lang.ProceedingJoinPoint;import org.springframework.core.Ordered;import org.springframework.dao.PessimisticLockingFailureException;public class ConcurrentOperationExecutor implements Ordered {private static final int DEFAULT_MAX_RETRIES = 2;private int maxRetries = DEFAULT_MAX_RETRIES;private int order = 1;public void setMaxRetries(int maxRetries) {this.maxRetries = maxRetries;}public int getOrder() {return this.order;}public void setOrder(int order) {this.order = order;}public Object doConcurrentOperation(ProceedingJoinPoint pjp) throws Throwable {int numAttempts = 0;PessimisticLockingFailureException lockFailureException;do {numAttempts++;System.out.println(&quot;Try times : &quot; + numAttempts);try {return pjp.proceed();} catch (PessimisticLockingFailureException ex) {lockFailureException = ex;}} while (numAttempts &lt;= this.maxRetries);System.out.println(&quot;Try error : &quot; + numAttempts);throw lockFailureException;}}123456789101112import org.springframework.dao.PessimisticLockingFailureException;import org.springframework.stereotype.Service;@Servicepublic class InvokeService {public void invoke() {System.out.println(&quot;InvokeService ......&quot;);}public void invokeException() {throw new PessimisticLockingFailureException(&quot;&quot;);}}1234567@Test public void testSave0{     InvokeService service=super.getBeaninvokeService&quot;);     service.invoke0;     System.out printin0.    service.invokeException0;}123456789// è¾“å‡ºTry times:1 InvokeService...     Try times:1 Try times:2 Try times:3 Try times:4 Try error:4 </content>
	</entry>
	<entry>
		<title>æ•°æ®åº“ç›¸å…³æ“ä½œ</title>
		<url>/article/59006.html</url>
		<content>Elasticsearchæ•°æ®åº“ç¯å¢ƒé…ç½®å®‰è£…ç¯å¢ƒpip install elasticsearch==7.6.0EsDaoåŒ…è£…ç±»123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186# -- coding: utf-8 --&quot;&quot;&quot;@version: v1.0@author: huangyc@file: EsDao.py@Description: Esç»Ÿä¸€æ“ä½œç±»@time: 2020/4/27 10:22&quot;&quot;&quot;from elasticsearch.helpers import bulkfrom elasticsearch import Elasticsearchimport pandas as pdclass EsDao(object):    &quot;&quot;&quot;    ElasticSearchçš„æ•°æ®æ“ä½œç±»    &quot;&quot;&quot;    # æŸ¥è¯¢æ‰¹æ¬¡å¤§å°    DEFAULT_BATCH_SIZE = 1000    # å†™å…¥æ‰¹æ¬¡å¤§å°    BULK_BATCH_SIZE = 10000    def __init__(self, hosts, timeout=3600*24):        self.hosts = hosts        self.timeout = timeout        self.es = Elasticsearch(hosts, timeout=self.timeout)    def save_data_list(self, index_name, data_list):        &quot;&quot;&quot;        ä¿å­˜æ•°æ®åˆ—è¡¨åˆ°esçš„æŒ‡å®šç´¢å¼•ä¸­        :param index_name: ç´¢å¼•åç§°        :param data_list: æ•°æ®åˆ—è¡¨ï¼Œåˆ—è¡¨å…ƒç´ ä»£è¡¨ä¸€è¡Œæ•°æ®ï¼Œå…ƒç´ ç±»å‹ä¸ºdict        :return:        &quot;&quot;&quot;        bulk_data_lst = [            data_list[i:i + self.BULK_BATCH_SIZE]            for i in range(0, len(data_list), self.BULK_BATCH_SIZE)        ]        if len(data_list) &gt; 0 and '_id' in data_list[0]:            for bulk_data in bulk_data_lst:                actions = [{                    &quot;_index&quot;: index_name,                    &quot;_type&quot;: index_name,                    &quot;_id&quot;: data.pop(&quot;_id&quot;),                    &quot;_source&quot;: data                }                    for data in bulk_data                ]                bulk(self.es, actions, index=index_name, raise_on_error=True)        else:            for bulk_data in bulk_data_lst:                actions = [{                    &quot;_index&quot;: index_name,                    &quot;_type&quot;: index_name,                    &quot;_source&quot;: data                }                    for data in bulk_data                ]                bulk(self.es, actions, index=index_name, raise_on_error=True)    def is_index_exists(self, index_name):        &quot;&quot;&quot;        åˆ¤æ–­æŒ‡å®šç´¢å¼•æ˜¯å¦å­˜åœ¨        :param index_name: ç´¢å¼•åç§°        :return:        &quot;&quot;&quot;        return self.es.indices.exists(index=index_name)    def delete_by_query(self, index_name, query_body):        &quot;&quot;&quot;        æŒ‰æŸ¥è¯¢ç»“æœåˆ é™¤æ•°æ®        :param index_name:        :param query_body:        :return:        &quot;&quot;&quot;        return self.es.delete_by_query(index_name, query_body)    def clear_index_data(self, index_name):        &quot;&quot;&quot;        æ¸…ç©ºæŒ‡å®šç´¢å¼•çš„æ•°æ®        :param index_name:        :return:        &quot;&quot;&quot;        return self.delete_by_query(            index_name=index_name,            query_body={                &quot;query&quot;: {                    &quot;match_all&quot;: {}                }            }        )    def save_df_data(self, index_name, df):        &quot;&quot;&quot;        ä¿å­˜pandasçš„DataFrameåˆ°esçš„æŒ‡å®šç´¢å¼•ä¸­        :param index_name: ç´¢å¼•åç§°        :param df: è¦ä¿å­˜çš„dataframe        :return:        &quot;&quot;&quot;        col_lst = df.columns.tolist()        dic_lst = [dict([(c, v) for c, v in zip(col_lst, r)]) for r in df.values.tolist()]        self.save_data_list(index_name=index_name, data_list=dic_lst)    def create_index(self, index_name, mapping_properties):        &quot;&quot;&quot;        åˆ›å»ºç´¢å¼•        :param index_name: ç´¢å¼•åç§°        :param mapping_properties: ç´¢å¼•mappingä¸­çš„å±æ€§åˆ—è¡¨        :return:        &quot;&quot;&quot;        if not self.es.indices.exists(index=index_name):            mapping = {                &quot;mappings&quot;: {                    index_name: {                        &quot;properties&quot;: mapping_properties                    }                }            }            res = self.es.indices.create(index=index_name, body=mapping)            if res is not None and 'acknowledged' in res:                return res.get('acknowledged')        return False    def _search_with_scroll(self, index_name, query_body):        if &quot;size&quot; not in query_body:            query_body[&quot;size&quot;] = self.DEFAULT_BATCH_SIZE        response = self.es.search(            index=index_name,            body=query_body,            search_type=&quot;dfs_query_then_fetch&quot;,            scroll=&quot;120m&quot;,            timeout=&quot;60m&quot;        )        scroll_id = response[&quot;_scroll_id&quot;]        while True:            sources = [doc[&quot;_source&quot;] for doc in response[&quot;hits&quot;][&quot;hits&quot;]]            if len(sources) == 0:                break            yield sources            response = self.es.scroll(scroll_id=scroll_id, scroll=&quot;60m&quot;)    def query_for_df(self, index_name, query_body):        &quot;&quot;&quot;        æ‰§è¡ŒæŸ¥è¯¢å¹¶è·å–pandas.DataFrameæ ¼å¼çš„è¿”å›å€¼        :param index_name: ç´¢å¼•åç§°        :param query_body: æŸ¥è¯¢æ¡ä»¶        :return:        &quot;&quot;&quot;        sources = []        for sub_source in self._search_with_scroll(index_name=index_name, query_body=query_body):            sources.extend(sub_source)        return pd.DataFrame(sources)    def query_for_df_with_batch(self, index_name, query_body, batch_size=DEFAULT_BATCH_SIZE):        &quot;&quot;&quot;        æŒ‰æ‰¹æ¬¡å¤§å°æŸ¥è¯¢å¹¶è¿”å›pandas.DataFrameçš„generatoræ ¼å¼çš„è¿”å›å€¼        :param index_name: ç´¢å¼•åç§°        :param query_body: æŸ¥è¯¢æ¡ä»¶        :param batch_size: æ‰¹æ¬¡å¤§å°        :return:        &quot;&quot;&quot;        if &quot;size&quot; not in query_body:            query_body[&quot;size&quot;] = batch_size        for sub_source in self._search_with_scroll(index_name=index_name, query_body=query_body):            yield pd.DataFrame(sub_source)    def get_first_row_with_df(self, index_name):        &quot;&quot;&quot;        è·å–æŒ‡å®šç´¢å¼•çš„é¦–è¡Œæ•°æ®ï¼Œæ ¼å¼ä¸ºpandas.DataFrame        å¯ç”¨äºè·å–ç´¢å¼•çš„å…ƒä¿¡æ¯        :param index_name: ç´¢å¼•åç§°        :return:        &quot;&quot;&quot;        query_body = {            &quot;size&quot;: 1,            &quot;query&quot;: {                &quot;match_all&quot;: {}            }        }        for sub_source in self._search_with_scroll(index_name=index_name, query_body=query_body):            return pd.DataFrame(sub_source)ä½¿ç”¨æ¡ˆä¾‹123456789101112131415161718192021222324class TaskMeta:    '''    æ•°æ®å…ƒç±»    '''    def __init__(self, text, doc_id, sentence_id, reg_lst, flag, has_reg, text_source=&quot;primitive&quot;):        self.text = text        self.doc_id = doc_id        self.sentence_id = sentence_id        self.reg_lst = reg_lst        self.flag = flag        self.has_reg = has_reg        self.text_source = text_source    def __repr__(self):        return f'{self.text} {self.doc_id} {self.sentence_id} {self.reg_lst} {self.flag} {self.has_reg} {self.text_source}'    def to_dict(self):        return {&quot;text&quot;: self.text,                &quot;doc_id&quot;: self.doc_id,                &quot;sentence_id&quot;: self.sentence_id,                &quot;reg_lst&quot;: self.reg_lst,                &quot;flag&quot;: self.flag,                &quot;has_reg&quot;: self.has_reg,                &quot;text_source&quot;: self.text_source}1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556def create_index(target_es_dao, index_name, mapping):    '''    åˆ›å»ºesç´¢å¼•    :return: æ˜¯å¦åˆ›å»ºæˆåŠŸ    '''    if not target_es_dao.is_index_exists(index_name):        target_es_dao.create_index(index_name, mapping)    else:        target_es_dao.clear_index_data(index_name)        print(f&quot;ç´¢å¼•{index_name}å·²å­˜åœ¨, å·²æ¸…é™¤æ•°æ®&quot;)def writer_fun(target_es_dao, target_index, sample_lst):    '''    å†™æ•°æ®åˆ°esåº“    '''    df_sample_lst = []    [df_sample_lst.append(sample.to_dict()) for sample in sample_lst]    df_sample_lst = pd.DataFrame(df_sample_lst)    target_es_dao.save_df_data(target_index, df_sample_lst)    print(f'å†™å…¥æ•°æ®{len(sample_lst)}æ¡')def es_cal_test():    # è·å–è¿æ¥    source_es_dao = EsDao(f&quot;http://{aug_config.SOURCE_IP}:{aug_config.SOURCE_PORT}/&quot;)    query_condition = {        &quot;query_string&quot;: {            &quot;default_field&quot;: &quot;has_reg&quot;,            &quot;query&quot;: &quot;true&quot;        }    }    query_body = {        &quot;query&quot;: query_condition    }    # æŸ¥è¯¢æ•°æ®    datas = source_es_dao.query_for_df(index_name=aug_config.SOURCE_INDEX, query_body=query_body)    records = datas.to_dict(orient='record')    sample_lst = []    for record in records:        sample_lst.append(            TaskMeta(                text=record[&quot;text&quot;],                doc_id=record[&quot;doc_id&quot;],                sentence_id=record[&quot;sentence_id&quot;],                reg_lst=record[&quot;reg_lst&quot;],                flag=record[&quot;flag&quot;],                has_reg=record[&quot;has_reg&quot;]            )        )    # åˆ›å»ºç´¢å¼•    create_index(target_es_dao, aug_config.TARGET_INDEX, aug_config.MAPPING)    # å†™å…¥æ•°æ®    writer_fun(target_es_dao, aug_config.TARGET_INDEX, sample_lst=sample_lst)if __name__ == '__main__':    es_cal_test()Oracleæ•°æ®åº“Pythonæ“ä½œOracleæ•°æ®åº“ï¼šcx_Oracleç¯å¢ƒé…ç½®ç¬¬ä¸€æ­¥ï¼šå®‰è£…åº“pip install cx-Oracleç¬¬äºŒæ­¥ï¼šæ–‡ä»¶æ‹·è´éœ€è¦å°†oci.dllã€oraocci11.dllã€oraociei11.dllå¤åˆ¶åˆ°sitepackagesè·¯å¾„ä¸‹sqlåŸºç¡€å»ºè¡¨123456789--blobå­—æ®µæ’å…¥å®ä¾‹create table blob_table_tmp(  id number primary key,  blob_cl blob not null,clob_cl clob not null);insert into blob_table_tmp values(1,rawtohex('11111000011111'),'å¢åŠ ä¸€æ¡è®°å½•æ—¶ï¼Œç¢°åˆ°æ’å…¥blobç±»å‹æ•°æ®å‡ºé”™');insert into blob_table_tmp values(3,rawtohex('4561888'),'å¢åŠ ä¸€æ¡è®°å½•æ—¶ï¼Œç¢°åˆ°æ’å…¥blobç±»å‹æ•°æ®å‡ºé”™');insert into blob_table_tmp values(4,rawtohex('å¢åŠ ä¸€æ¡è®°å½•æ—¶333'),'å¢åŠ ä¸€æ¡è®°å½•æ—¶ï¼Œç¢°åˆ°æ’å…¥blobç±»å‹æ•°æ®å‡ºé”™');æŸ¥è¯¢è·å–è¿æ¥123456789101112131415FINANCE_DB_HOST = &quot;192.168.x.x&quot;FINANCE_DB_PORT = 1521FINANCE_DB_USER = &quot;hyc&quot;FINANCE_DB_PASSWORD = &quot;123456&quot;FINANCE_DB_DB = &quot;ORCL&quot;class OracleConn():    config_path = ''    @staticmethod    def get_conn(conn_name, encoding=&quot;UTF-8&quot;):        conn_str = str(eval(&quot;%s_DB_USER&quot; % (OracleConn.config_path, conn_name))) + &quot;/&quot; + str(eval(&quot;%s.%s_DB_PASSWORD&quot; % (OracleConn.config_path, conn_name)))        conn_str += &quot;@&quot; + str(eval(&quot;%s_DB_HOST&quot; % (OracleConn.config_path, conn_name)))        conn_str += &quot;:&quot; + str(eval(&quot;%s_DB_PORT&quot; % (OracleConn.config_path, conn_name)))        conn_str += &quot;/&quot; + str(eval(&quot;%s_DB_DB&quot; % (OracleConn.config_path, conn_name)))        return ora.connect(conn_str, encoding=encoding, nencoding=encoding)è¯»å†™æ•°æ®åº“1234567891011121314151617181920212223242526def oracle_test():    # è·å–æ•°æ®åº“è¿æ¥    conn = OracleConn.get_conn(&quot;FINANCE&quot;)    cur = conn.cursor()    # æŸ¥è¯¢æ•°æ®    sql = &quot;select id,blob_cl,clob_cl from FINANCE.blob_table_tmp&quot;    datas = []    r = cur.execute(sql)    # å‡è®¾nameæ˜¯clobå­—æ®µç±»å‹    [datas.append((gg[0], gg[1].read().decode('utf-8'), gg[2].read())) for gg in r]    # å†™å…¥æ•°æ®    insert_sql = &quot;INSERT INTO new_table(id,new_name) VALUES (:ID,:NEW_NAME)&quot;    res = []    [res.append((data[0], data[1])) for data in datas]    cur.executemany(insert_sql, res)    cur.execute('commit')    cur.close()    conn.close()    print(&quot;å†™å…¥ç»“æŸ&quot;)if __name__ == '__main__':    oracle_test()ç›¸å…³æ“ä½œå…³äºæ•°æ®åº“çš„è¿æ¥ï¼ŒæŸ¥è¯¢å’Œå†™å…¥1234567891011121314151617181920212223242526272829303132333435import cx_Oracleclass Setting:    DB_USER = 'narutohyc'    DB_PASSWORD = 'hyc'    DB_IP = '192.168.0.1'    DB_PORT = ''    DB_SERVICE = 'dataBaseName'setting = Setting()def oracle_test():    # è·å–æ•°æ®åº“è¿æ¥    conn = cx_Oracle.connect('%s/%s@%s/%s' % (setting.DB_USER, setting.DB_PASSWORD, setting.DB_IP, setting.DB_SERVICE), encoding='utf-8')    cur = conn.cursor()    # æŸ¥è¯¢æ•°æ®    sql = &quot;select ID, name from hyc_database&quot;    datas = []    r = cur.execute(sql)    # å‡è®¾nameæ˜¯clobå­—æ®µç±»å‹    [datas.append((gg[0], gg[1].read())) for gg in r]    # å†™å…¥æ•°æ®    insert_sql = &quot;INSERT INTO new_table(id,new_name) VALUES (:ID,:NEW_NAME)&quot;    res = []    [res.append((data[0], data[1])) for data in datas]    cur.executemany(insert_sql, res)    cur.execute('commit')    cur.close()    conn.close()    print(&quot;å†™å…¥ç»“æŸ&quot;)if __name__ == '__main__':    oracle_test()Postgresqlæ•°æ®åº“æˆ‘ç»ˆäºå­¦ä¼šäº†ä½¿ç”¨pythonæ“ä½œpostgresqlä¿å§†çº§ CentOS 7ç¦»çº¿å®‰è£…PostgreSQL 14æ•™ç¨‹æ˜“ç™¾_PostgreSQLæ•™ç¨‹ç¦»çº¿å®‰è£…æ•°æ®åº“å…ˆä»centos7-pg_14.2ä¸‹è½½ä¸‹è½½rpmåŒ…(å¾®äº‘ä¸‹è½½centos7.6_PostgreSQL14.2)ï¼Œæˆ–è€…ç›´æ¥å®˜æ–¹ä¸‹è½½å®‰è£…æ•™ç¨‹å®‰è£…ï¼Œå¦‚æœç¦»çº¿å®‰è£…å°±ä¸‹è½½rpmåŒ…12345# ç¦»çº¿å®‰è£…æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…rpm -ivh postgresql14-libs-14.2-1PGDG.rhel7.x86_64.rpmrpm -ivh postgresql14-14.2-1PGDG.rhel7.x86_64.rpmrpm -ivh postgresql14-server-14.2-1PGDG.rhel7.x86_64.rpmrpm -ivh postgresql14-contrib-14.2-1PGDG.rhel7.x86_64.rpmå‡ºç°OSError: Python library not found: libpython3.6mu.so.1.0, libpython3.6m.so.1.0, libpython3.6.so.1.0, libpython3.6m.soçš„è§£å†³åŠæ³•1yum install python3-develåˆ›å»ºæ•°æ®åº“dataå’Œlogæ–‡ä»¶å¤¹123456# åˆ›å»ºæ•°æ®åº“dataå’Œlogæ–‡ä»¶å¤¹mkdir -p /home/postgres/pgsql_datamkdir -p /home/postgres/pgsql_log# åˆ›å»ºæ—¥å¿—æ–‡ä»¶touch /home/postgres/pgsql_log/pgsql.logæˆæƒç»™å®‰è£…æ•°æ®æ—¶è‡ªåŠ¨åˆ›å»ºçš„postgresç”¨æˆ·12chown -R postgres:postgres /home/postgres/pgsql_datachown -R postgres:postgres /home/postgres/pgsql_logåˆ‡æ¢åˆ°å®‰è£…æ•°æ®æ—¶è‡ªåŠ¨åˆ›å»ºçš„postgresç”¨æˆ·1su - postgresåˆå§‹åŒ–æ•°æ®åº“åˆ°æ–°å»ºæ•°æ®ç›®å½•1/usr/pgsql-14/bin/initdb -D /home/postgres/pgsql_dataå¯åŠ¨æœåŠ¡å™¨(åˆå§‹åŒ–æ•°æ®åº“æ—¥å¿—æ–‡ä»¶)123/usr/pgsql-14/bin/pg_ctl -D  /home/postgres/pgsql_data/ -l /home/postgres/pgsql_log/pgsql.log start# æŸ¥çœ‹çŠ¶æ€/usr/pgsql-14/bin/pg_ctl -D /home/postgres/pgsql_data/ -l /home/postgres/pgsql_log/pgsql.log statusåˆ‡æ¢åˆ°ç®¡ç†å‘˜å¼€å¯ç«¯å£å¹¶é‡å¯é˜²ç«å¢™123su rootfirewall-cmd --zone=public --add-port=5432/tcp --permanentfirewall-cmd --reloadä¿®æ”¹é…ç½®æ–‡ä»¶å®ç°è¿œç¨‹è®¿é—®vi /home/postgres/pgsql_data/postgresql.conf123456# ä¿®æ”¹ç›‘å¬åœ°å€listen_addresses = '*'# ä¿®æ”¹æœ€å¤§è¿æ¥æ•°ï¼ˆæŒ‰éœ€ï¼‰max_connections = 1000# ä¿®æ”¹å¯†ç è®¤è¯password_encryption = md5ä¿®æ”¹å¯è®¿é—®çš„ç”¨æˆ·IPæ®µ123vi /home/pgsql_data/pg_hba.confï¼ˆaè¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼Œescé€€å‡ºç¼–è¾‘æ¨¡å¼ï¼Œ:wqå¹¶æŒ‰å›è½¦ä¿å­˜ï¼‰IPV4ä¸‹ä¿®æ”¹ä¸ºæˆ–æ–°å¢host    all             all             0.0.0.0/0               trustpostgresç”¨æˆ·é‡å¯æ•°æ®åº“æœåŠ¡12su - postgres/usr/pgsql-14/bin/pg_ctl -D  /home/postgres/pgsql_data/ -l /home/postgres/pgsql_log/pgsql.log restartæ•°æ®åº“å®‰è£…ç»“æŸï¼Œç®¡ç†å‘˜postgresï¼Œé»˜è®¤å¯†ç 123456ä½¿ç”¨navicatè¿æ¥pgåº“åæ–°å»ºæ•°æ®åº“ç¯å¢ƒé…ç½®pip install psycopg2sqlè¯­æ³•æ•°æ®åº“è¿æ¥12345678-- è·å–æ•°æ®åº“å®ä¾‹è¿æ¥æ•°select count(*) from pg_stat_activity;-- è·å–æ•°æ®åº“æœ€å¤§è¿æ¥æ•°show max_connections;-- æŸ¥è¯¢å½“å‰è¿æ¥æ•°è¯¦ç»†ä¿¡æ¯select * from pg_stat_activity;-- æŸ¥è¯¢æ•°æ®åº“ä¸­å„ä¸ªç”¨æˆ·åå¯¹åº”çš„æ•°æ®åº“è¿æ¥æ•°select usename, count(*) from pg_stat_activity group by usename;æ•°æ®åº“ä¿¡æ¯1234567891011121314151617181920212223242526-- æŸ¥è¯¢æ•°æ®åº“å¤§å°select pg_size_pretty (pg_database_size('pg_fac_stk'));-- æŸ¥è¯¢å„è¡¨ç£ç›˜å ç”¨SELECT    table_schema || '.' || table_name AS table_full_name,    pg_size_pretty(pg_total_relation_size('&quot;' || table_schema || '&quot;.&quot;' || table_name || '&quot;')) AS sizeFROM information_schema.tables where table_name like 'finance_%'ORDER BY    pg_total_relation_size('&quot;' || table_schema || '&quot;.&quot;' || table_name || '&quot;') DESC;    -- è·å–å„ä¸ªè¡¨ä¸­çš„æ•°æ®è®°å½•æ•°select relname as TABLE_NAME, reltuples as rowCounts from pg_class where relkind = 'r' order by rowCounts desc;-- æŸ¥çœ‹æ•°æ®åº“è¡¨å¯¹åº”çš„æ•°æ®æ–‡ä»¶select pg_relation_filepath('product');-- æŸ¥çœ‹æ•°æ®åº“å®ä¾‹çš„ç‰ˆæœ¬select version();-- åˆ†æè¯„ä¼°SQLæ‰§è¡Œæƒ…å†µEXPLAIN ANALYZE SELECT * FROM t_cfg_opinfo;-- è·å–æ•°æ®åº“å½“å‰çš„å›æ»šäº‹åŠ¡æ•°ä»¥åŠæ­»é”æ•°select datname,xact_rollback,deadlocks from pg_stat_database;æ•°æ®å¤‡ä»½ä¸æ¢å¤ä½¿ç”¨pgdumpå¤‡ä»½æ•°æ®åº“pgdumpæ˜¯PostgreSQLå®˜æ–¹æä¾›çš„å¤‡ä»½å·¥å…·ï¼Œå¯ä»¥å°†æ•°æ®åº“çš„æ•°æ®å’Œæ¶æ„ä¿å­˜åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œä½¿ç”¨pgdumpå¤‡ä»½çš„ä¼˜ç‚¹åŒ…æ‹¬ï¼šå¤‡ä»½æ•°æ®å¯ä»¥ä¿æŒåŸæœ‰çš„ç»“æ„å’Œç‰¹æ€§ï¼Œè¿˜åŸæ—¶å¯ä»¥ä¿è¯æ•°æ®å‡†ç¡®æ€§å¤‡ä»½æ–‡ä»¶å¯ä»¥è·¨å¹³å°ä¼ è¾“ï¼Œæ–¹ä¾¿è¿›è¡Œè¿œç¨‹å¤‡ä»½å¤‡ä»½æ–‡ä»¶å¯ä»¥è¿›è¡Œå‹ç¼©ï¼Œå‡å°æ–‡ä»¶å¤§å°ï¼Œæ–¹ä¾¿ä¼ è¾“å’Œå­˜å‚¨å¯ä»¥æ–°å»ºæ•°æ®åº“ï¼Œå»ºå‡ å¼ è¡¨åšæµ‹è¯•1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162# å­¦ç”Ÿè¡¨CREATE TABLE students (    id SERIAL PRIMARY KEY,    name VARCHAR(100) NOT NULL,    gender VARCHAR(10) NOT NULL,    age INTEGER NOT NULL,    class VARCHAR(20) NOT NULL);# å­¦ç§‘è¡¨CREATE TABLE subjects (    id SERIAL PRIMARY KEY,    name VARCHAR(100) NOT NULL);# æˆç»©è¡¨CREATE TABLE scores (    id SERIAL PRIMARY KEY,    student_id INTEGER NOT NULL,    subject_id INTEGER NOT NULL,    score INTEGER NOT NULL,    FOREIGN KEY (student_id) REFERENCES students (id),    FOREIGN KEY (subject_id) REFERENCES subjects (id));# æ’å…¥ä¸€äº›æµ‹è¯•æ•°æ®INSERT INTO students (name, gender, age, class)VALUES    ('Alice', 'Female', 18, 'Class A'),    ('Bob', 'Male', 17, 'Class B'),    ('Charlie', 'Male', 19, 'Class A'),    ('Diana', 'Female', 18, 'Class B');# æ’å…¥å­¦ç§‘è¡¨æ•°æ®INSERT INTO subjects (name)VALUES    ('Mathematics'),    ('English'),    ('Science');-- Alice çš„æˆç»©INSERT INTO scores (student_id, subject_id, score)VALUES    (1, 1, 90),    (1, 2, 85),    (1, 3, 92);-- Bob çš„æˆç»©INSERT INTO scores (student_id, subject_id, score)VALUES    (2, 1, 78),    (2, 2, 80),    (2, 3, 75);-- Charlie çš„æˆç»©INSERT INTO scores (student_id, subject_id, score)VALUES    (3, 1, 88),    (3, 2, 92),    (3, 3, 90);-- Diana çš„æˆç»©INSERT INTO scores (student_id, subject_id, score)VALUES    (4, 1, 95),    (4, 2, 88),    (4, 3, 92);å¤‡ä»½ä½¿ç”¨pgdumpå¤‡ä»½æ•°æ®åº“éå¸¸ç®€å•ï¼Œåªéœ€è¦åœ¨ç»ˆç«¯ä¸­è¾“å…¥ç›¸åº”çš„å‘½ä»¤å³å¯å¤‡ä»½æ•´ä¸ªæ•°æ®åº“1234pg_dump -h &lt;æ•°æ®åº“åœ°å€&gt; -p &lt;æ•°æ®åº“ç«¯å£&gt; -U &lt;æ•°æ®åº“ç”¨æˆ·å&gt; -F c -b -v -f &lt;å¤‡ä»½æ–‡ä»¶è·¯å¾„&gt; &lt;æ•°æ®åº“åç§°&gt;# ç¤ºä¾‹/usr/pgsql-14/bin/pg_dump -h 127.0.0.1 -U postgres -p 5432 -F t -b -v -f build_hyc_test.sql.tar hyc_testå¤‡ä»½æŒ‡å®šè¡¨æˆ–æ•°æ®1234567pg_dump -h &lt;æ•°æ®åº“åœ°å€&gt; -p &lt;æ•°æ®åº“ç«¯å£&gt; -U &lt;æ•°æ®åº“ç”¨æˆ·å&gt; -F c -b -v -t &lt;è¡¨å1&gt; -t &lt;è¡¨å2&gt; -f &lt;å¤‡ä»½æ–‡ä»¶è·¯å¾„&gt; &lt;æ•°æ®åº“åç§°&gt;# ç¤ºä¾‹-- å¤‡ä»½æŒ‡å®šè¡¨åˆ°sqlæ–‡ä»¶-- '-c --if-exists' ä¼šç”Ÿæˆ 'drop table if exist' å‘½ä»¤-- '--no-owner' æ˜¯ä¸€ä¸ªé€‰é¡¹ï¼Œç”¨äºæŒ‡å®šåœ¨å¯¼å‡ºæ•°æ®åº“æ—¶ä¸åŒ…æ‹¬æ‹¥æœ‰è€…ä¿¡æ¯pg_dump --verbose --host=192.168.xx.xx --port=5432 --username=postgres --file /home/huangyc/pg_bak_test/bak_hyc.sql --encoding=UTF-8 -t &quot;public.tushare_wz_index&quot; -t &quot;public.tushare_us_basic&quot; -t &quot;public.dim_fund&quot; -t &quot;public.dim_index&quot; -c --if-exists --no-owner pg_fac_stkå…·ä½“å‚æ•°çš„å«ä¹‰å¦‚ä¸‹ï¼š-hï¼šæ•°æ®åº“æœåŠ¡æ‰€åœ¨ä¸»æœºåœ°å€ï¼Œå¯ä»¥æ˜¯æœ¬åœ°åœ°å€localhostæˆ–è€…IPåœ°å€-pï¼šæ•°æ®åº“æœåŠ¡çš„ç›‘å¬ç«¯å£ï¼Œä¸€èˆ¬ä¸ºé»˜è®¤ç«¯å£5432-Uï¼šè¿æ¥æ•°æ®åº“çš„ç”¨æˆ·å-Fï¼šå¤‡ä»½æ–‡ä»¶çš„æ ¼å¼ï¼ŒåŒ…æ‹¬è‡ªå®šä¹‰æ ¼å¼cï¼Œçº¯æ–‡æœ¬æ ¼å¼på’Œå½’æ¡£æ ¼å¼t-bï¼šåœ¨å¤‡ä»½æ–‡ä»¶ä¸­åŒ…å«å¤‡ä»½çš„æ•°æ®åº“çš„æ¨¡å¼ä¿¡æ¯-vï¼šå¤‡ä»½è¿‡ç¨‹ä¸­è¾“å‡ºè¯¦ç»†çš„ä¿¡æ¯-fï¼šå¤‡ä»½æ–‡ä»¶çš„ä¿å­˜è·¯å¾„å’Œæ–‡ä»¶å-tï¼šåªå¤‡ä»½æŒ‡å®šçš„è¡¨å’Œæ•°æ®12345-- å¤‡ä»½postgresåº“å¹¶taræ‰“åŒ…pg_dump -h 127.0.0.1 -p 5432 -U postgres -f postgres.sql.tar -Ft;-- å¤‡ä»½postgresåº“ï¼Œè½¬å‚¨æ•°æ®ä¸ºå¸¦åˆ—åçš„INSERTå‘½ä»¤pg_dumpall -d postgres -U postgres -f postgres.sql --column-inserts;è¿˜åŸä½¿ç”¨å¤‡ä»½æ–‡ä»¶è¿›è¡Œæ¢å¤ä¹Ÿéå¸¸ç®€å•ï¼Œåªéœ€è¦åœ¨ç»ˆç«¯ä¸­è¾“å…¥ç›¸åº”çš„å‘½ä»¤å³å¯æ¢å¤æ•´ä¸ªåº“1234pg_restore -h &lt;æ•°æ®åº“åœ°å€&gt; -p &lt;æ•°æ®åº“ç«¯å£&gt; -U &lt;æ•°æ®åº“ç”¨æˆ·å&gt; -d &lt;æ•°æ®åº“åç§°&gt; &lt;å¤‡ä»½æ–‡ä»¶è·¯å¾„&gt;# ç¤ºä¾‹/usr/pgsql-14/bin/pg_restore -h 127.0.0.1 -U postgres -p 5432 -d hyc_test_bak build_hyc_test.sql.taræ¢å¤æŒ‡å®šæ•°æ®123456pg_restore -h &lt;æ•°æ®åº“åœ°å€&gt; -p &lt;æ•°æ®åº“ç«¯å£&gt; -U &lt;æ•°æ®åº“ç”¨æˆ·å&gt; -t &lt;è¡¨å1&gt; -t &lt;è¡¨å2&gt; -d &lt;æ•°æ®åº“åç§°&gt; &lt;å¤‡ä»½æ–‡ä»¶è·¯å¾„&gt;# ç¤ºä¾‹-- å¯¹äºpg_dumpå¤‡ä»½å‡ºæ¥çš„sqlæ–‡ä»¶ï¼Œç›´æ¥æ‰§è¡Œsqlæ–‡ä»¶å³å¯æ¢å¤-- è¿˜åŸæŒ‡å®šsqlæ–‡ä»¶åˆ°bak_teståº“(éœ€è¦è‡ªå·±å»ºåº“)psql --host=192.168.xx.xx --port=5432 --username=postgres -d bak_test --file /home/huangyc/pg_bak_test/bak_hyc.sql.tarå…·ä½“å‚æ•°çš„å«ä¹‰å¦‚ä¸‹ï¼š-hï¼šæ•°æ®åº“æœåŠ¡æ‰€åœ¨ä¸»æœºåœ°å€ï¼Œå¯ä»¥æ˜¯æœ¬åœ°åœ°å€localhostæˆ–è€…IPåœ°å€-pï¼šæ•°æ®åº“æœåŠ¡çš„ç›‘å¬ç«¯å£ï¼Œä¸€èˆ¬ä¸ºé»˜è®¤ç«¯å£5432-Uï¼šè¿æ¥æ•°æ®åº“çš„ç”¨æˆ·å-dï¼šæ¢å¤æ•°æ®çš„ç›®æ ‡æ•°æ®åº“åç§°-tï¼šåªæ¢å¤æŒ‡å®šçš„è¡¨å’Œæ•°æ®å‘½ä»¤è¯¦è§£1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465[postgres@pg01 ~]$ pg_dump --helpç”¨æ³•:  pg_dump [é€‰é¡¹]... [æ•°æ®åº“åå­—]**ä¸€èˆ¬é€‰é¡¹**:  -f, --file=FILENAME          è¾“å‡ºæ–‡ä»¶æˆ–ç›®å½•å  -F, --format=c|d|t|p         è¾“å‡ºæ–‡ä»¶æ ¼å¼ (c=custom, d=directory, t=tar,p=plain,plainå°±æ˜¯sqlçº¯æ–‡æœ¬ (é»˜è®¤å€¼))  -j, --jobs=NUM               æ‰§è¡Œå¤šä¸ªå¹¶è¡Œä»»åŠ¡è¿›è¡Œå¤‡ä»½è½¬å‚¨å·¥ä½œ  -v, --verbose                è¯¦ç»†æ¨¡å¼  -V, --version                è¾“å‡ºç‰ˆæœ¬ä¿¡æ¯ï¼Œç„¶åé€€å‡º  -Z, --compress=0-9           è¢«å‹ç¼©æ ¼å¼çš„å‹ç¼©çº§åˆ«ï¼Œ0è¡¨ç¤ºä¸å‹ç¼©  --lock-wait-timeout=TIMEOUT  åœ¨ç­‰å¾…è¡¨é”è¶…æ—¶åæ“ä½œå¤±è´¥  --no-sync                    ä¸ç”¨ç­‰å¾…å˜åŒ–å®‰å…¨å†™å…¥ç£ç›˜  -?, --help                   æ˜¾ç¤ºæ­¤å¸®åŠ©, ç„¶åé€€å‡º**æ§åˆ¶è¾“å‡ºå†…å®¹é€‰é¡¹(å¸¸ç”¨)**:  -a, --data-only              åªè½¬å‚¨æ•°æ®,ä¸åŒ…æ‹¬æ¨¡å¼,åªå¯¹çº¯æ–‡æœ¬è¾“å‡ºæœ‰æ„ä¹‰  -s, --schema-only            åªè½¬å‚¨æ¨¡å¼, ä¸åŒ…æ‹¬æ•°æ®  -c, --clean                  åœ¨é‡æ–°åˆ›å»ºä¹‹å‰ï¼Œå…ˆæ¸…é™¤ï¼ˆåˆ é™¤ï¼‰æ•°æ®åº“å¯¹è±¡ï¼Œå¦‚drop tableã€‚åªå¯¹çº¯æ–‡æœ¬è¾“å‡ºæœ‰æ„ä¹‰  -C, --create                 æŒ‡å®šè¾“å‡ºæ–‡ä»¶ä¸­æ˜¯å¦ç”Ÿæˆcreate databaseè¯­å¥,åªå¯¹çº¯æ–‡æœ¬è¾“å‡ºæœ‰æ„ä¹‰  -n, --schema=PATTERN         æŒ‡å®šè¦å¯¼å‡ºçš„schemaï¼Œä¸æŒ‡å®šåˆ™å¯¼å‡ºæ‰€æœ‰çš„éç³»ç»Ÿschema  -N, --exclude-schema=PATTERN æ’é™¤å¯¼å‡ºå“ªäº›schema  -O, --no-owner               åœ¨æ˜æ–‡æ ¼å¼ä¸­, å¿½ç•¥æ¢å¤å¯¹è±¡æ‰€å±è€…  -t, --table=PATTERN          æŒ‡å®šå¯¼å‡ºçš„è¡¨ã€è§†å›¾ã€åºåˆ—ï¼Œå¯ä»¥ä½¿ç”¨å¤šä¸ª-tåŒ¹é…å¤šä¸ªè¡¨ï¼Œä½¿ç”¨-tä¹‹åï¼Œ-nå’Œ-Nå°±å¤±æ•ˆäº†  -T, --exclude-table=PATTERN  æ’é™¤è¡¨  -x, --no-privileges          ä¸è¦è½¬å‚¨æƒé™ (grant/revoke)  --disable-triggers           åœ¨åªæ¢å¤æ•°æ®çš„è¿‡ç¨‹ä¸­ç¦ç”¨è§¦å‘å™¨  --exclude-table-data=PATTERN do NOT dump data for the specified table(s)  --if-exists                  å½“åˆ é™¤å¯¹è±¡æ—¶ä½¿ç”¨IF EXISTS  --inserts                    ä»¥INSERTå‘½ä»¤ï¼Œè€Œä¸æ˜¯COPYå‘½ä»¤çš„å½¢å¼è½¬å‚¨æ•°æ®ï¼Œä½¿ç”¨è¯¥é€‰é¡¹å¯ä»¥æŠŠæ•°æ®åŠ è½½åˆ°épgæ•°æ®åº“ï¼Œä¼šä½¿æ¢å¤éå¸¸æ…¢                               è¯¥é€‰é¡¹ä¸ºæ¯è¡Œç”Ÿæˆ1ä¸ªå•ç‹¬çš„insertå‘½ä»¤ï¼Œ?åœ¨æ¢å¤è¿‡ç¨‹ä¸­é‡åˆ°é”™è¯¯ï¼Œå°†ä¼šä¸¢å¤±1è¡Œè€Œä¸æ˜¯å…¨éƒ¨è¡¨æ•°æ®  --column-inserts             ä»¥å¸¦æœ‰åˆ—åçš„INSERTå‘½ä»¤å½¢å¼è½¬å‚¨æ•°æ®ï¼Œä¾‹å¦‚insert into table_name(column,...) values(value1,...)  --load-via-partition-root    é€šè¿‡æ ¹è¡¨åŠ è½½åˆ†åŒº  --no-comments                ä¸è½¬å‚¨æ³¨é‡Š  --no-tablespaces             ä¸è½¬å‚¨è¡¨ç©ºé—´åˆ†é…ä¿¡æ¯  --no-unlogged-table-data     ä¸è½¬å‚¨æ²¡æœ‰æ—¥å¿—çš„è¡¨æ•°æ®  --on-conflict-do-nothing     å°†ON CONFLICT DO NOTHINGæ·»åŠ åˆ°INSERTå‘½ä»¤**æ§åˆ¶è¾“å‡ºå†…å®¹é€‰é¡¹(ä¸å¸¸ç”¨)**:  -S, --superuser=NAME         æŒ‡å®šå…³é—­è§¦å‘å™¨æ—¶éœ€è¦ç”¨åˆ°çš„è¶…çº§ç”¨æˆ·åã€‚ å®ƒåªæœ‰åœ¨ä½¿ç”¨äº†--disable-triggersæ—¶æ‰æœ‰å½±å“ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæœ€å¥½ä¸è¦è¾“å…¥è¯¥å‚æ•°ï¼Œè€Œæ˜¯ç”¨ è¶…çº§ç”¨æˆ·å¯åŠ¨ç”Ÿæˆçš„è„šæœ¬ã€‚  -b, --blobs                  åœ¨è½¬å‚¨ä¸­åŒ…æ‹¬å¤§å¯¹è±¡  -B, --no-blobs               æ’é™¤è½¬å‚¨ä¸­çš„å¤§å‹å¯¹è±¡  -E, --encoding=ENCODING      è½¬å‚¨ä»¥ENCODINGå½¢å¼ç¼–ç çš„æ•°æ®  --binary-upgrade             åªèƒ½ç”±å‡çº§å·¥å…·ä½¿ç”¨  --enable-row-security        å¯ç”¨è¡Œå®‰å…¨æ€§ï¼ˆåªè½¬å‚¨ç”¨æˆ·èƒ½å¤Ÿè®¿é—®çš„å†…å®¹ï¼‰  --extra-float-digits=NUM     è¦†ç›–extra_float_digitsçš„é»˜è®¤è®¾ç½®  --disable-dollar-quoting     å–æ¶ˆç¾å…ƒ (ç¬¦å·) å¼•å·, ä½¿ç”¨ SQL æ ‡å‡†å¼•å·  --no-publications            ä¸è½¬å‚¨å‘å¸ƒ  --no-security-labels         ä¸è½¬å‚¨å®‰å…¨æ ‡ç­¾çš„åˆ†é…  --no-subscriptions           ä¸è½¬å‚¨è®¢é˜…  --no-synchronized-snapshots  åœ¨å¹¶è¡Œå·¥ä½œé›†ä¸­ä¸ä½¿ç”¨åŒæ­¥å¿«ç…§  --quote-all-identifiers      æ‰€æœ‰æ ‡è¯†ç¬¦åŠ å¼•å·ï¼Œå³ä½¿ä¸æ˜¯å…³é”®å­—  --rows-per-insert=NROWS      æ¯ä¸ªæ’å…¥çš„è¡Œæ•°ï¼›æ„å‘³ç€--inserts  --section=SECTION            å¤‡ä»½å‘½åçš„èŠ‚ (æ•°æ®å‰, æ•°æ®, åŠ æ•°æ®å)  --serializable-deferrable    ç­‰åˆ°å¤‡ä»½å¯ä»¥æ— å¼‚å¸¸è¿è¡Œ  --snapshot=SNAPSHOT          ä¸ºè½¬å‚¨ä½¿ç”¨ç»™å®šçš„å¿«ç…§  --strict-names               è¦æ±‚æ¯ä¸ªè¡¨å’Œ(æˆ–)schemaåŒ…æ‹¬æ¨¡å¼ä»¥åŒ¹é…è‡³å°‘ä¸€ä¸ªå®ä½“  --use-set-session-authorization                               ä½¿ç”¨ SESSION AUTHORIZATION å‘½ä»¤ä»£æ›¿                               ALTER OWNER å‘½ä»¤æ¥è®¾ç½®æ‰€æœ‰æƒ**è”æ¥é€‰é¡¹**:  -d, --dbname=DBNAME      å¯¹æ•°æ®åº“ DBNAMEå¤‡ä»½  -h, --host=ä¸»æœºå        æ•°æ®åº“æœåŠ¡å™¨çš„ä¸»æœºåæˆ–å¥—æ¥å­—ç›®å½•  -p, --port=ç«¯å£å·        æ•°æ®åº“æœåŠ¡å™¨çš„ç«¯å£å·  -U, --username=åå­—      ä»¥æŒ‡å®šçš„æ•°æ®åº“ç”¨æˆ·è”æ¥  -w, --no-password        æ°¸è¿œä¸æç¤ºè¾“å…¥å£ä»¤  -W, --password           å¼ºåˆ¶å£ä»¤æç¤º (è‡ªåŠ¨)  --role=ROLENAME          åœ¨è½¬å‚¨å‰è¿è¡ŒSET ROLEå¯¹äºpg_dumpçš„è‡ªå®šä¹‰å¤‡ä»½customå’Œtarç±»å‹çš„å¤‡ä»½ï¼Œéœ€è¦ä½¿ç”¨pg_restoreè¿›è¡Œæ¢å¤ï¼Œpg_restoreè¯­æ³•å¦‚ä¸‹1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556[postgres@pg01 pg_backup]$ pg_restore --helppg_restore ä»ä¸€ä¸ªå½’æ¡£ä¸­æ¢å¤ä¸€ä¸ªç”± pg_dump åˆ›å»ºçš„ PostgreSQL æ•°æ®åº“.ç”¨æ³•:  pg_restore [é€‰é¡¹]... [æ–‡ä»¶å]ä¸€èˆ¬é€‰é¡¹:  -d, --dbname=åå­—        è¿æ¥æ•°æ®åº“åå­—  -f, --file=æ–‡ä»¶å       è¾“å‡ºæ–‡ä»¶å(- å¯¹äºstdout)  -F, --format=c|d|t       å¤‡ä»½æ–‡ä»¶æ ¼å¼(åº”è¯¥è‡ªåŠ¨è¿›è¡Œ)  -l, --list               æ‰“å°å½’æ¡£æ–‡ä»¶çš„ TOC æ¦‚è¿°  -v, --verbose            è¯¦ç»†æ¨¡å¼  -V, --version            è¾“å‡ºç‰ˆæœ¬ä¿¡æ¯, ç„¶åé€€å‡º  -?, --help               æ˜¾ç¤ºæ­¤å¸®åŠ©, ç„¶åé€€å‡ºæ¢å¤æ§åˆ¶é€‰é¡¹:  -a, --data-only              åªæ¢å¤æ•°æ®, ä¸åŒ…æ‹¬æ¨¡å¼  -c, --clean                  åœ¨é‡æ–°åˆ›å»ºä¹‹å‰ï¼Œå…ˆæ¸…é™¤ï¼ˆåˆ é™¤ï¼‰æ•°æ®åº“å¯¹è±¡  -C, --create                 åˆ›å»ºç›®æ ‡æ•°æ®åº“  -e, --exit-on-error          å‘ç”Ÿé”™è¯¯é€€å‡º, é»˜è®¤ä¸ºç»§ç»­  -I, --index=NAME             æ¢å¤æŒ‡å®šåç§°çš„ç´¢å¼•  -j, --jobs=NUM               æ‰§è¡Œå¤šä¸ªå¹¶è¡Œä»»åŠ¡è¿›è¡Œæ¢å¤å·¥ä½œ  -L, --use-list=FILENAME      ä»è¿™ä¸ªæ–‡ä»¶ä¸­ä½¿ç”¨æŒ‡å®šçš„å†…å®¹è¡¨æ’åº                               è¾“å‡º  -n, --schema=NAME            åœ¨è¿™ä¸ªæ¨¡å¼ä¸­åªæ¢å¤å¯¹è±¡  -N, --exclude-schema=NAME    ä¸æ¢å¤æ­¤æ¨¡å¼ä¸­çš„å¯¹è±¡  -O, --no-owner               ä¸æ¢å¤å¯¹è±¡æ‰€å±è€…  -P, --function=NAME(args)    æ¢å¤æŒ‡å®šåå­—çš„å‡½æ•°  -s, --schema-only            åªæ¢å¤æ¨¡å¼, ä¸åŒ…æ‹¬æ•°æ®  -S, --superuser=NAME         ä½¿ç”¨æŒ‡å®šçš„è¶…çº§ç”¨æˆ·æ¥ç¦ç”¨è§¦å‘å™¨  -t, --table=NAME             æ¢å¤å‘½åå…³ç³»ï¼ˆè¡¨ã€è§†å›¾ç­‰ï¼‰  -T, --trigger=NAME           æ¢å¤æŒ‡å®šåå­—çš„è§¦å‘å™¨  -x, --no-privileges          è·³è¿‡å¤„ç†æƒé™çš„æ¢å¤ (grant/revoke)  -1, --single-transaction     ä½œä¸ºå•ä¸ªäº‹åŠ¡æ¢å¤  --disable-triggers           åœ¨åªæ¢å¤æ•°æ®çš„è¿‡ç¨‹ä¸­ç¦ç”¨è§¦å‘å™¨  --enable-row-security        å¯ç”¨è¡Œå®‰å…¨æ€§  --if-exists                  å½“åˆ é™¤å¯¹è±¡æ—¶ä½¿ç”¨IF EXISTS  --no-comments                ä¸æ¢å¤æ³¨é‡Š  --no-data-for-failed-tables  å¯¹é‚£äº›æ— æ³•åˆ›å»ºçš„è¡¨ä¸è¿›è¡Œ                               æ•°æ®æ¢å¤  --no-publications            ä¸æ¢å¤å‘è¡Œ  --no-security-labels         ä¸æ¢å¤å®‰å…¨æ ‡ç­¾ä¿¡æ¯  --no-subscriptions           ä¸æ¢å¤è®¢é˜…  --no-tablespaces             ä¸æ¢å¤è¡¨ç©ºé—´çš„åˆ†é…ä¿¡æ¯  --section=SECTION            æ¢å¤å‘½åèŠ‚ (æ•°æ®å‰ã€æ•°æ®åŠæ•°æ®å)  --strict-names               è¦æ±‚æ¯ä¸ªè¡¨å’Œ(æˆ–)schemaåŒ…æ‹¬æ¨¡å¼ä»¥åŒ¹é…è‡³å°‘ä¸€ä¸ªå®ä½“  --use-set-session-authorization                               ä½¿ç”¨ SESSION AUTHORIZATION å‘½ä»¤ä»£æ›¿                               ALTER OWNER å‘½ä»¤æ¥è®¾ç½®æ‰€æœ‰æƒè”æ¥é€‰é¡¹:  -h, --host=ä¸»æœºå        æ•°æ®åº“æœåŠ¡å™¨çš„ä¸»æœºåæˆ–å¥—æ¥å­—ç›®å½•  -p, --port=ç«¯å£å·        æ•°æ®åº“æœåŠ¡å™¨çš„ç«¯å£å·  -U, --username=åå­—      ä»¥æŒ‡å®šçš„æ•°æ®åº“ç”¨æˆ·è”æ¥  -w, --no-password        æ°¸è¿œä¸æç¤ºè¾“å…¥å£ä»¤  -W, --password           å¼ºåˆ¶å£ä»¤æç¤º (è‡ªåŠ¨)  --role=ROLENAME          åœ¨æ¢å¤å‰æ‰§è¡ŒSET ROLEæ“ä½œé€‰é¡¹ -I, -n, -N, -P, -t, -T, ä»¥åŠ --section å¯ä»¥ç»„åˆä½¿ç”¨å’ŒæŒ‡å®šå¤šæ¬¡ç”¨äºé€‰æ‹©å¤šä¸ªå¯¹è±¡.å¦‚æœæ²¡æœ‰æä¾›è¾“å…¥æ–‡ä»¶å, åˆ™ä½¿ç”¨æ ‡å‡†è¾“å…¥.è¡¨ç©ºé—´æ–°å»ºè¡¨ç©ºé—´1234# æ–°å»ºè¡¨ç©ºé—´ç›®å½• t_fac_tsmkdir /home/huangyc/t_fac_ts# ä¿®æ”¹è¡¨ç©ºé—´çš„ç”¨æˆ·æƒé™chown postgres /home/huangyc/t_fac_tspgåº“æ–°å»ºè¡¨ç©ºé—´1create tablespace t_fac_ts owner postgres location '/home/huangyc/t_fac_ts';è¡¨ç©ºé—´æœ‰å…³çš„ä¸€äº›è¯­æ³•123456# åˆ é™¤è¡¨ç©ºé—´ (éœ€è¦å…ˆdropè¡¨ç©ºé—´æ‰€æœ‰çš„è¡¨, æˆ–è€…å°†è¯¥ç©ºé—´ä¸‹æ‰€æœ‰çš„è¡¨ç§»é™¤æ‰èƒ½dropè¡¨ç©ºé—´)DROP TABLESPACE t_fac_ts;# ä¿®æ”¹å…·ä½“çš„è¡¨åˆ°æŒ‡å®šè¡¨ç©ºé—´ä¸‹ALTER TABLE t_fac_tushare_stock_basic SET TABLESPACE t_fac_ts;# ä¿®æ”¹æŒ‡å®šåº“åˆ°æŒ‡å®šè¡¨ç©ºé—´ä¸‹ALTER DATABASE name SET TABLESPACE new_tablespace;é”è¡¨å¤„ç†pgé”è¡¨è§£é”æŸ¥çœ‹è¢«é”çš„è¡¨123select a.locktype,a.database,a.pid,a.mode,a.relation,b.relnamefrom pg_locks ajoin pg_class b on a.relation = b.oid where relname='t_opt_strhdk_blsj';æ€æ­»è¢«é”çš„pid1select pg_terminate_backend(pid);è¡¨ç»“æ„ä¿®æ”¹12345678910-- ä¿®æ”¹è¡¨åalter table &quot;user&quot; rename to &quot;ts_user&quot;;-- æ·»åŠ æ–°å­—æ®µalter table table_name add column col_name varchar(50);-- ä¸¢å¼ƒæŸåˆ—alter table table_name drop column col_name;-- æ·»åŠ ä¸»é”®alter table table_name add primary key(&quot;col_name&quot;);-- ä¿®æ”¹å­—æ®µåalter table table_name rename column old_col_name to new_col_name;æ•°æ®æ›´æ–°å’ŒæŸ¥è¯¢è®¾ç½®æŸå­—æ®µçš„å€¼12-- è®¾ç½®æŸå­—æ®µçš„å€¼update table_name set col_name=new_value;åˆ é™¤è¡¨ä¸­é‡å¤æ•°æ®12345678910-- æŸ¥è¯¢[æ—§è¡¨]æ•°æ®çš„é‡å¤æƒ…å†µselect col1,col2,count(*) from old_table group by col1,col2;-- æ‰€æœ‰å­—æ®µéƒ½ä¸€æ ·çš„æƒ…å†µcreate table bak_table as select distinct * from table_name;-- æŸ¥è¯¢[æ–°è¡¨]æ•°æ®çš„é‡å¤æƒ…å†µselect col1,col2,count(*) from bak_table group by col1,col2;truncate table old_table;insert into old_table (col1,col2) select col1,col2 from bak_table;ä¸å­˜åœ¨æ’å…¥ï¼Œå­˜åœ¨æ›´æ–°1insert into ... on conflict(column_name) do update set ...conflict(column_name): column_nameå­—æ®µæ˜¯åˆ¤æ–­è¦æŸ¥æ‰¾çš„æ•°æ®æ˜¯å¦å­˜åœ¨ï¼Œä½œä¸ºåˆ¤æ–­æ¡ä»¶column_nameå¿…é¡»æ˜¯ä¸»é”®æˆ–è€…å…¶ä»–å…·æœ‰å”¯ä¸€æ€§çš„å­—æ®µ(å¦‚å”¯ä¸€é”®æˆ–æ’ä»–é”®)1234insert into user(id,username,address,create_date,create_by) values('1','åˆ˜å¾·å','é¦™æ¸¯',now(),'system') on conflict(id) do update set address='ä¸­å›½',update_date=now(),update_by='system';12# æ‰¹é‡çš„æ–¹å¼insert into testunnest(id, age, name) values (unnest(array[1,3]), unnest(array[18,10]), unnest(array['valupdated', 'val3'])) on conflict (id) do update set age = excluded.age, name = excluded.name;æ•°æ®å’Œç»“æ„å¤åˆ¶1234-- [å¤åˆ¶è¡¨å’Œæ•°æ®] å¤åˆ¶è¡¨ç»“æ„å’Œæ•°æ® è‡ªåŠ¨å»ºè¡¨ï¼Œä¸ä¼šå¤åˆ¶ä¸»é”®ä»€ä¹ˆçš„create table new_table as select * from old_table;-- [å¤åˆ¶æ•°æ®] å¤åˆ¶æ•°æ®åˆ° æ–°è¡¨ è¡¨éœ€è¦æå‰å»ºï¼Œå¹¶ä¸”è¡¨å­—æ®µè¦ä¸€è‡´ï¼Œä¸ä¼šå¤åˆ¶ä¸»é”®ä»€ä¹ˆçš„insert into new_table (col_0, col_1) select col_0, col_1 from old_table;åˆ†é¡µæŸ¥è¯¢1select * from table_name limit 10000 offset 20000;åˆ é™¤é‡å¤è®°å½•postgresql å¸¸ç”¨çš„åˆ é™¤é‡å¤æ•°æ®æ–¹æ³•12345678910111213141516-- åˆå§‹åŒ–æ•°æ®create table hyc_tmp_del_test(id int, name varchar(255));create table hyc_tmp_del_test_bk (like hyc_tmp_del_test);insert into hyc_tmp_del_test select generate_series(1, 10000), 'huangyc';insert into hyc_tmp_del_test select generate_series(1, 10000), 'huangyc';insert into hyc_tmp_del_test_bk select * from hyc_tmp_del_test;-- æœ€å®¹æ˜“æƒ³åˆ°çš„æ–¹æ³•å°±æ˜¯åˆ¤æ–­æ•°æ®æ˜¯å¦é‡å¤ï¼Œå¯¹äºé‡å¤çš„æ•°æ®åªä¿ç•™ctidæœ€å°ï¼ˆæˆ–æœ€å¤§ï¼‰çš„æ•°æ®ï¼Œåˆ é™¤å…¶ä»–çš„-- idç›¸åŒçš„æ•°æ®ï¼Œä¿ç•™ctidæœ€å°çš„ï¼Œå…¶ä»–çš„åˆ é™¤explain analyse delete from hyc_tmp_del_test_bk a where a.ctid &lt;&gt; (select min(t.ctid) from hyc_tmp_del_test_bk t where a.id=t.id); -- 17.112s-- group byæ–¹æ³•é€šè¿‡åˆ†ç»„æ‰¾åˆ°ctidæœ€å°çš„æ•°æ®ï¼Œç„¶ååˆ é™¤å…¶ä»–æ•°æ®explain analyse delete from hyc_tmp_del_test_bk a where a.ctid not in (select min(ctid) from hyc_tmp_del_test_bk group by id); -- 0.052s-- é«˜æ•ˆåˆ é™¤æ–¹æ³•explain analyze delete from hyc_tmp_del_test_bk a where a.ctid = any(array (select ctid from (select row_number() over (partition by id), ctid from hyc_tmp_del_test_bk) t where t.row_number &gt; 1)); -- 0.055sç¬¬äºŒç§å’Œç¬¬ä¸‰ç§æ„Ÿè§‰å·®ä¸å¤šï¼ŒåŸæ–‡è¯´æ˜¯ç¬¬ä¸‰ç§å¿«ä¸å°‘ï¼Œè¿™é‡Œpgåº“æ˜¯14.xç‰ˆæœ¬å…³é”®pgä¸­æ¯ä¸ªè¡¨éƒ½æœ‰å‡ ä¸ªç³»ç»Ÿéšè—åˆ—ï¼štableoidï¼Œ xminï¼Œ xmaxï¼Œcminï¼Œcmaxï¼Œctidå…¶ä¸­tableoidè¡¨ç¤ºè¡¨çš„oidï¼Œcminã€cmaxã€xminå’Œxmaxæ˜¯mvccçš„å®ç°æœ‰å…³ctidè¡¨ç¤ºè¡Œç‰ˆæœ¬åœ¨è¡¨ä¸­çš„ç‰©ç†ä½ç½®: å®ƒå±äºå¯¹è±¡æ ‡è¯†ç¬¦ç±»å‹(oidï¼ŒObject Identifier Types)ï¼Œæ˜¯ä¸€ç§è¡Œæ ‡è¯†ç¬¦ï¼Œå®ƒçš„æ•°æ®ä½¿ç”¨çš„å…ƒç»„æ ‡è¯†ç¬¦(tidï¼Œtuple identifier)ã€‚å…ƒç»„IDæ˜¯ä¸€å¯¹(å—å·ï¼Œå—å†…çš„å…ƒç»„ç´¢å¼•)ï¼Œç”¨äºæ ‡è¯†å½“å‰è¡Œçš„ç‰©ç†ä½ç½®ã€‚ç´¢å¼•12345678-- è·å–æ•°æ®åº“è¡¨ä¸­çš„ç´¢å¼•select * from pg_indexes where tablename = 't_cfg_opinfo'; -- åˆ›å»ºç´¢å¼•create index index_name on table_name (col_0, col_1);-- æŸ¥è¯¢ç´¢å¼•select * from pg_indexes where tablename='table_name';-- åˆ é™¤ç´¢å¼•drop index index_name;ä»€ä¹ˆæƒ…å†µä¸‹è¦é¿å…ä½¿ç”¨ç´¢å¼•ï¼Ÿè™½ç„¶ç´¢å¼•çš„ç›®çš„åœ¨äºæé«˜æ•°æ®åº“çš„æ€§èƒ½ï¼Œä½†è¿™é‡Œæœ‰å‡ ä¸ªæƒ…å†µéœ€è¦é¿å…ä½¿ç”¨ç´¢å¼•ä½¿ç”¨ç´¢å¼•æ—¶ï¼Œéœ€è¦è€ƒè™‘ä¸‹åˆ—å‡†åˆ™ï¼šç´¢å¼•ä¸åº”è¯¥ä½¿ç”¨åœ¨è¾ƒå°çš„è¡¨ä¸Šç´¢å¼•ä¸åº”è¯¥ä½¿ç”¨åœ¨æœ‰é¢‘ç¹çš„å¤§æ‰¹é‡çš„æ›´æ–°æˆ–æ’å…¥æ“ä½œçš„è¡¨ä¸Šç´¢å¼•ä¸åº”è¯¥ä½¿ç”¨åœ¨å«æœ‰å¤§é‡çš„ NULL å€¼çš„åˆ—ä¸Šç´¢å¼•ä¸åº”è¯¥ä½¿ç”¨åœ¨é¢‘ç¹æ“ä½œçš„åˆ—ä¸Šå…¶ä»–è¯­æ³•ç­›é€‰æŸåˆ—ï¼Œé€—å·æ‹¼æ¥123select string_agg(bs_org_id,',') as bs_org_ids   from bs_org   where par_org_id ='100'æ—¥æœŸè½¬æ¢12select to_char(col_name,'yyyyMMDD')-interval '2 day' from table_name-- -interval '2 day' è¡¨ç¤ºå¾€å‰2å¤©è½¬æ—¶é—´æˆ³12select '2011-01-06 09:57:59'::timestamp;TO_TIMESTAMP('2011-01-06 09:57:59', 'YYYY-MM-DD HH24:MI:S')postgresql è·å–åˆ†ç»„ç¬¬ä¸€æ¡æ•°æ® çª—å£å‡½æ•°ç»™æ•°æ®åˆ†ç»„å¹¶æ’åï¼Œä½¿ç”¨ row_number() over (partition by åˆ†ç»„çš„å­—æ®µå order by æ’åºè§„åˆ™) as æ’åä»ä¸Šè¿°ç¬¬ä¸€æ­¥ä¸­å–å‡ºï¼Œæ’åä¸ºç¬¬ä¸€çš„æ•°æ®ï¼Œå³ä¸ºç¬¬ä¸€æ¡æ•°æ® select * from ä¸Šè¿°ç¬¬ä¸€æ­¥ where æ’å=1è·å–å‰Nåçš„æ•°æ®ï¼Œå°†ä¸€ä¸­ç¬¬äºŒæ­¥çš„æ¡ä»¶æ¢æˆwhere æ’å &lt; N+1 distributed key12alter table table_name set distributed by (id);alter table table_name add primary key (id);ORMæ¡†æ¶ORMæ¡†æ¶æ¯”è¾ƒä¸€æ–‡äº†è§£ Python çš„ä¸‰ç§æ•°æ®æºæ¶æ„æ¨¡å¼SQLAlchemy å’Œå…¶ä»–çš„ ORM æ¡†æ¶SQLObjectä¼˜ç‚¹ï¼šé‡‡ç”¨äº†æ˜“æ‡‚çš„ActiveRecord æ¨¡å¼ä¸€ä¸ªç›¸å¯¹è¾ƒå°çš„ä»£ç åº“ç¼ºç‚¹ï¼šæ–¹æ³•å’Œç±»çš„å‘½åéµå¾ªäº†Java çš„å°é©¼å³°é£æ ¼ä¸æ”¯æŒæ•°æ®åº“sessionéš”ç¦»å·¥ä½œå•å…ƒStormä¼˜ç‚¹ï¼šæ¸…çˆ½è½»é‡çš„APIï¼ŒçŸ­å­¦ä¹ æ›²çº¿å’Œé•¿æœŸå¯ç»´æŠ¤æ€§ä¸éœ€è¦ç‰¹æ®Šçš„ç±»æ„é€ å‡½æ•°ï¼Œä¹Ÿæ²¡æœ‰å¿…è¦çš„åŸºç±»ç¼ºç‚¹ï¼šè¿«ä½¿ç¨‹åºå‘˜æ‰‹å·¥å†™è¡¨æ ¼åˆ›å»ºçš„DDLè¯­å¥ï¼Œè€Œä¸æ˜¯ä»æ¨¡å‹ç±»è‡ªåŠ¨æ´¾ç”ŸStormçš„è´¡çŒ®è€…å¿…é¡»æŠŠä»–ä»¬çš„è´¡çŒ®çš„ç‰ˆæƒç»™Canonicalå…¬å¸Djangoâ€™s ORMä¼˜ç‚¹ï¼šæ˜“ç”¨ï¼Œå­¦ä¹ æ›²çº¿çŸ­å’ŒDjangoç´§å¯†é›†åˆï¼Œç”¨Djangoæ—¶ä½¿ç”¨çº¦å®šä¿—æˆçš„æ–¹æ³•å»æ“ä½œæ•°æ®åº“ç¼ºç‚¹ï¼šä¸å¥½å¤„ç†å¤æ‚çš„æŸ¥è¯¢ï¼Œå¼ºåˆ¶å¼€å‘è€…å›åˆ°åŸç”ŸSQLç´§å¯†å’ŒDjangoé›†æˆï¼Œä½¿å¾—åœ¨Djangoç¯å¢ƒå¤–å¾ˆéš¾ä½¿ç”¨peeweeä¼˜ç‚¹ï¼šDjangoå¼çš„APIï¼Œä½¿å…¶æ˜“ç”¨è½»é‡å®ç°ï¼Œå¾ˆå®¹æ˜“å’Œä»»æ„webæ¡†æ¶é›†æˆç¼ºç‚¹ï¼šä¸æ”¯æŒè‡ªåŠ¨åŒ– schema è¿ç§»å¤šå¯¹å¤šæŸ¥è¯¢å†™èµ·æ¥ä¸ç›´è§‚SQLAlchemyä¼˜ç‚¹ï¼šä¼ä¸šçº§APIï¼Œä½¿å¾—ä»£ç æœ‰å¥å£®æ€§å’Œé€‚åº”æ€§çµæ´»çš„è®¾è®¡ï¼Œä½¿å¾—èƒ½è½»æ¾å†™å¤æ‚æŸ¥è¯¢ç¼ºç‚¹ï¼šå·¥ä½œå•å…ƒæ¦‚å¿µä¸å¸¸è§é‡é‡çº§APIï¼Œå¯¼è‡´é•¿å­¦ä¹ æ›²çº¿ç›¸æ¯”å…¶ä»–çš„ORMï¼Œ SQLAlchemy æ„å‘³ç€ï¼Œæ— è®ºä½ ä½•æ—¶å†™SQLAlchemyä»£ç ï¼Œ éƒ½ä¸“æ³¨äºå·¥ä½œå•å…ƒçš„å‰æ²¿æ¦‚å¿µ ã€‚DB Session çš„æ¦‚å¿µå¯èƒ½æœ€åˆå¾ˆéš¾ç†è§£å’Œæ­£ç¡®ä½¿ç”¨ï¼Œä½†æ˜¯åæ¥ä½ ä¼šæ¬£èµè¿™é¢å¤–çš„å¤æ‚æ€§ï¼Œè¿™è®©æ„å¤–çš„æ—¶åºæäº¤ç›¸å…³çš„æ•°æ®åº“bugå‡å°‘åˆ°0ã€‚åœ¨SQLAlchemyä¸­å¤„ç†å¤šæ•°æ®åº“æ˜¯æ£˜æ‰‹çš„ï¼Œ å› ä¸ºæ¯ä¸ªDB session éƒ½é™å®šäº†ä¸€ä¸ªæ•°æ®åº“è¿æ¥ã€‚ä½†æ˜¯ï¼Œè¿™ç§ç±»å‹çš„é™åˆ¶å®é™…ä¸Šæ˜¯å¥½äº‹ï¼Œ å› ä¸ºè¿™æ ·å¼ºåˆ¶ä½ ç»å°½è„‘æ±å»æƒ³åœ¨å¤šä¸ªæ•°æ®åº“ä¹‹é—´çš„äº¤äº’ï¼Œ ä»è€Œä½¿å¾—æ•°æ®åº“äº¤äº’ä»£ç å¾ˆå®¹æ˜“è°ƒè¯•ã€‚SQLAlchemySQLAlchemy 1.4 Documentationsqlalchemyæ“ä½œæ•°æ®åº“sqlalchemyå¤–é”®å’ŒrelationshipæŸ¥è¯¢SQLALlchemyæ•°æ®æŸ¥è¯¢å°é›†åˆSQLAlchemy çš„è¿æ¥æ± æœºåˆ¶SQLAlchemy ä¸­çš„ Sessionã€sessionmakerã€scoped_sessionContextual/Thread-local SessionsSQLAlchemy(å¸¸ç”¨çš„SQLAlchemyåˆ—é€‰é¡¹)æŸ¥è¯¢å®˜ç½‘ä¾‹å­Object Relational Tutorial (1.x API)sqlalchemyå¤–é”®å’ŒrelationshipæŸ¥è¯¢sessionå’Œscoped_sessionsessionç”¨äºåˆ›å»ºç¨‹åºå’Œæ•°æ®åº“ä¹‹é—´çš„ä¼šè¯ï¼Œæ‰€æœ‰å¯¹è±¡çš„è½½å…¥å’Œä¿å­˜éƒ½éœ€é€šè¿‡sessionå¯¹è±¡ ã€‚é€šè¿‡sessionmakerè°ƒç”¨åˆ›å»ºä¸€ä¸ªå·¥å‚ï¼Œå¹¶å…³è”Engineä»¥ç¡®ä¿æ¯ä¸ªsessionéƒ½å¯ä»¥ä½¿ç”¨è¯¥Engineè¿æ¥èµ„æºscoped_session å®ç°äº†ä¸€ä¸ªçº¿ç¨‹çš„éš”ç¦»ï¼Œä¿è¯ä¸åŒçš„çº¿ç¨‹æ‹¿åˆ°ä¸åŒçš„session, åŒä¸€ä¸ªçº¿ç¨‹æ‹¿åˆ°çš„session æ˜¯åŒä¸€ä¸ªå€¼1234567s1 = Session()s2 = Session()s1.add(person)s1.commit()# å¿…é¡»å…ˆcloseï¼Œs2æ‰èƒ½ç»§ç»­æ“ä½œpersons1.close()s2.add(person)session å’Œscoped_sessionæœ¬è´¨ä¸Šéƒ½æ˜¯ç”¨æ¥æ“ä½œæ•°æ®åº“çš„ï¼Œåªæ˜¯session åªé€‚åˆåœ¨å•çº¿ç¨‹ä¸‹é¢ä½¿ç”¨å®˜æ–¹æ–‡æ¡£æåˆ°äº†scoped_sessionçš„æ­£ç¡®ä½¿ç”¨æ–¹æ³•ã€‚requestç»“æŸåè¦è°ƒç”¨scoped_session.remove()Engine Configurationä½¿ç”¨ create_engineåˆ›å»ºæˆ‘ä»¬éœ€è¦çš„DB starting point1234from sqlalchemy import create_enginescheme = 'mysql+pymysql://root:123456@localhost:3306/dev_shopping?charset=utf8'engine = create_engine(scheme, pool_size=10 , max_overflow=-1, pool_recycle=1200)create_engine å‡½æ•°å¸¸ç”¨å‚æ•°ï¼špool_size=10 # è¿æ¥æ± çš„å¤§å°ï¼Œ0è¡¨ç¤ºè¿æ¥æ•°æ— é™åˆ¶pool_recycle=-1 # è¿æ¥æ± å›æ”¶è¿æ¥çš„æ—¶é—´ï¼Œå¦‚æœè®¾ç½®ä¸º-1ï¼Œè¡¨ç¤ºæ²¡æœ‰no timeout, æ³¨æ„ï¼Œmysqlä¼šè‡ªåŠ¨æ–­å¼€è¶…è¿‡8å°æ—¶çš„è¿æ¥ï¼Œæ‰€ä»¥sqlalchemyæ²¿ç”¨è¢«mysqlæ–­å¼€çš„è¿æ¥ä¼šæŠ›å‡ºMySQL has gone awaymax_overflow=-1 # è¿æ¥æ± ä¸­å…è®¸â€˜æº¢å‡ºâ€™çš„è¿æ¥ä¸ªæ•°ï¼Œå¦‚æœè®¾ç½®ä¸º-1ï¼Œè¡¨ç¤ºè¿æ¥æ± ä¸­å¯ä»¥åˆ›å»ºä»»æ„æ•°é‡çš„è¿æ¥pool_timeout=30 # åœ¨è¿æ¥æ± è·å–ä¸€ä¸ªç©ºé—²è¿æ¥ç­‰å¾…çš„æ—¶é—´echo=False # å¦‚æœè®¾ç½®True, Engineå°†ä¼šè®°å½•æ‰€æœ‰çš„æ—¥å¿—ï¼Œæ—¥å¿—é»˜è®¤ä¼šè¾“å‡ºåˆ°sys.stdoutåˆ›å»ºEngineä¹‹åï¼Œæ¥ä¸‹æ¥çš„é—®é¢˜ï¼Œå°±æ˜¯å¦‚ä½•ä½¿ç”¨Engineåœ¨å•è¿›ç¨‹ä¸­ï¼Œå»ºè®®åœ¨åœ¨åˆå§‹åŒ–çš„æ¨¡å—çš„æ—¶å€™åˆ›å»ºEngine, ä½¿Engineæˆä¸ºå…¨å±€å˜é‡ï¼Œ è€Œä¸æ˜¯ä¸ºæ¯ä¸ªè°ƒç”¨Engineçš„å¯¹è±¡æˆ–è€…å‡½æ•°ä¸­åˆ›å»º, Engineä¸åŒäºconnect, connectå‡½æ•°ä¼šåˆ›å»ºæ•°æ®åº“è¿æ¥çš„èµ„æºï¼ŒEngineæ˜¯ç®¡ç†connectåˆ›å»ºçš„è¿æ¥èµ„æºåœ¨å¤šè¿›ç¨‹ä¸­ï¼Œä¸ºæ¯ä¸ªå­è¿›ç¨‹éƒ½åˆ›å»ºå„è‡ªçš„Engine, å› ä¸ºè¿›ç¨‹ä¹‹é—´æ˜¯ä¸èƒ½å…±äº«Engineå‡ ç§æ“ä½œæ–¹å¼Working with Engines and ConnectionsSqlAlchemyçš„Engineï¼ŒConnectionå’ŒSession åŒºåˆ«ï¼Ÿé€‚åˆä»€ä¹ˆæ—¶å€™ç”¨ï¼ŸEngineæ–¹å¼Engineæ˜¯SQLAlchemyä¸­è¿æ¥æ•°æ®åº“æœ€åº•å±‚çº§åˆ«çš„å¯¹è±¡ï¼Œå®ƒç»´æŠ¤äº†ä¸€ä¸ªè¿æ¥æ± ï¼Œå¯ä»¥åœ¨åº”ç”¨ç¨‹åºéœ€è¦å’Œæ•°æ®åº“å¯¹è¯æ—¶ä½¿ç”¨ã€‚åœ¨Engine.execute(close_with_result=True) close_with_result=True è¡¨ç¤ºè¿æ¥è‡ªåŠ¨å…³é—­ï¼›123456result = engine.execute('SELECT * FROM tablename;') conn = engine.connect(close_with_result=True)result = conn.execute('SELECT * FROM tablename;')for row in result:    print(result['columnname']result.close()Connectionæ–¹å¼Connectionï¼Œå®é™…ä¸Šæ˜¯æ‰§è¡ŒSQLæŸ¥è¯¢çš„å·¥ä½œï¼Œæ¯å½“ä½ æƒ³æ›´å¥½çš„æ§åˆ¶è¿æ¥çš„å±æ€§ï¼Œå¦‚ä½•æ—¶å…³é—­ç­‰éƒ½å»ºè®®ä½¿ç”¨è¿™ä¸ªæ“ä½œï¼›æ¯”å¦‚åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œè¦æ§åˆ¶å®ƒæäº¤commitçš„æ—¶é—´ï¼Œåœ¨connectionæ§åˆ¶ä¸­å°±å¯ä»¥è¿è¡Œå¤šä¸ªä¸åŒçš„SQLè¯­å¥ï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ªå‡ºç°é—®é¢˜ï¼Œåˆ™å…¶ä»–æ‰€æœ‰çš„è¯­å¥éƒ½ä¼šæ’¤é”€æ›´æ”¹ï¼›123456789connection = engine.connect()trans = connection.begin()try:    connection.execute(&quot;INSERT INTO films VALUES ('Comedy', '82 minutes');&quot;)    connection.execute(&quot;INSERT INTO datalog VALUES ('added a comedy');&quot;)    trans.commit()except:    trans.rollback()    raiseSessionæ–¹å¼Sessionï¼Œä¸€èˆ¬éƒ½æ˜¯ç”¨äºORMä¸­ï¼Œå› ä¸ºåœ¨ORMä¸­ï¼Œä¼šè‡ªåŠ¨ç”ŸæˆSQLè¯­å¥ä»¥åŠè‡ªåŠ¨è¿æ¥æ•°æ®åº“ï¼ˆè‡ªå·±é…ç½®ï¼‰ï¼Œä½¿ç”¨session.executeï¼ˆï¼‰ä¹Ÿæ˜¯ä¸ªç¼–è¾‘çš„æ–¹æ³•ï¼Œå¯ä»¥å°†ä¼šè¯ç»‘å®šåˆ°ä»»ä½•å¯¹è±¡ï¼›å¦‚æœä½ ç¡®å®šä½¿ç”¨ORMï¼Œå°±å»ºè®®ä½¿ç”¨sessionæ¥å¤„ç†execute(),å¦åˆ™è¿˜æ˜¯ä½¿ç”¨connectionæ›´å¥½æ–¹ä¾¿ï¼›æ€»ç»“: ä»åº”ç”¨è§’åº¦æ¥çœ‹ï¼Œå¯ä»¥æŠŠè¿™ä¸‰ç±»åˆ†ä¸ºä¸¤ç§ï¼šç›´æ¥ä½¿ç”¨Engine.execute() æˆ–Connection.execute()ï¼Œæ›´åŠ çµæ´»ï¼Œå¯ä»¥ä½¿ç”¨åŸç”ŸSQLè¯­å¥ä½¿ç”¨Sessionå¤„ç†äº¤æ˜“ç±»å‹çš„æ•°æ®ï¼Œå› ä¸ºæ–¹ä¾¿ä½¿ç”¨session.add(), session.rollback(), session.commit(), session.close()ç­‰ï¼Œå®ƒæ˜¯ä½¿ç”¨ORMæ—¶æ¨èçš„ä¸€ç§å’Œæ•°æ®åº“äº¤äº’çš„æ–¹å¼</content>
	</entry>
	<entry>
		<title>æ­£åˆ™è¡¨è¾¾å¼å­¦ä¹ </title>
		<url>/article/13105.html</url>
		<content>æ­£åˆ™è¡¨è¾¾å¼æ¦‚å¿µpythonæ­£åˆ™è¡¨è¾¾å¼æ·±å…¥ç†è§£æ­£åˆ™è¡¨è¾¾å¼ç¯è§†çš„æ¦‚å¿µä¸ç”¨æ³•èµ„æº | æ­£åˆ™è¡¨è¾¾å¼çš„åŠŸæ³•å¤§å…¨åœ¨çº¿æ­£åˆ™è¡¨è¾¾å¼éªŒè¯ç½‘ç«™æ¦‚å¿µå®šä¹‰ä½¿ç”¨å•ä¸ªå­—ç¬¦ä¸²æ¥æè¿°åŒ¹é…æŸä¸ªå¥æ³•è§„åˆ™çš„å­—ç¬¦ä¸²ï¼Œæ˜¯å¯¹å­—ç¬¦ä¸²æ“ä½œçš„ä¸€ç§é€»è¾‘å…¬å¼åº”ç”¨åœºæ™¯å¤„ç†æ–‡æœ¬å’Œæ•°æ®ï¼Œæé«˜å¤æ‚æ–‡æœ¬åˆ†æçš„æ•ˆç‡æ­£åˆ™è¡¨è¾¾å¼è¿‡ç¨‹ä¾æ¬¡æ‹¿å‡ºè¡¨è¾¾å¼å’Œæ–‡æœ¬ä¸­çš„å­—ç¬¦æ¯”è¾ƒï¼Œå¦‚æœæ¯ä¸€ä¸ªå­—ç¬¦éƒ½èƒ½åŒ¹é…ï¼Œåˆ™åŒ¹é…æˆåŠŸï¼›å¦åˆ™åŒ¹é…å¤±è´¥123456789101112# -*- coding: utf-8 -*import refrom IPython.core.interactiveshell import InteractiveShellInteractiveShell.ast_node_interactivity = &quot;all&quot;  # å¯åŒæ—¶è¾“å‡ºå¤šä¸ªç»“æœpattern_s = r'imooc'  # å®šä¹‰æ­£åˆ™è¡¨è¾¾å¼pattern_r = re.compile(pattern_s)  # ç¼–è¯‘æ­£åˆ™è¡¨è¾¾å¼str1 = 'imooc book'  # éœ€è¦æŸ¥æ‰¾çš„åŸå§‹å­—ç¬¦ä¸²match_r = pattern_r.match(str1)print(f'match_r.group(): {match_r.group()}')match_r.group(): imoocæ­£åˆ™å…ƒå­—ç¬¦å†…å®¹åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼ä»£è¡¨çš„åŒ¹é…å­—ç¬¦.åŒ¹é…ä»»æ„å­—ç¬¦ï¼ˆä¸åŒ…æ‹¬æ¢è¡Œç¬¦ï¼‰[0-9]0-9çš„æ•°å­—[a-z]å°å†™å­—æ¯[A-Z]å¤§å†™å­—æ¯\dåŒ¹é…æ•°å­—ï¼Œç­‰åŒäº[0-9]\DåŒ¹é…éæ•°å­—ï¼Œç­‰åŒäº[\^0-9]\wåŒ¹é…å¤§å°å†™å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿ï¼Œç­‰åŒäº[a-z0-9A-Z_]\WåŒ¹é…éå¤§å°å†™å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿ï¼Œç­‰åŒäº[\^a-z0-9A-Z_]\såŒ¹é…ç©ºç™½\SåŒ¹é…éç©ºç™½\u4e00-\u9fffåŒ¹é…ä¸­æ–‡å­—ç¬¦ä¸ªæ•°åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼ä»£è¡¨çš„åŒ¹é…å­—ç¬¦*åŒ¹é…å‰é¢çš„å­—ç¬¦æˆ–è€…å­è¡¨è¾¾å¼0æ¬¡æˆ–å¤šæ¬¡+åŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦æˆ–å­è¡¨è¾¾å¼ä¸€æ¬¡æˆ–å¤šæ¬¡?åŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦æˆ–å­è¡¨è¾¾å¼0æ¬¡æˆ–1æ¬¡é‡å¤{n}åŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦æˆ–å­è¡¨è¾¾å¼næ¬¡{m,n}åŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦æˆ–å­è¡¨è¾¾å¼mè‡³næ¬¡{n,}åŒ¹é…å‰ä¸€ä¸ªå­—ç¬¦æˆ–è€…å­è¡¨è¾¾å¼è‡³å°‘næ¬¡*? / +? / ??æƒ°æ€§åŒ¹é…ä¸Šä¸€ä¸ªä½ç½®åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼ä»£è¡¨çš„åŒ¹é…å­—ç¬¦^åŒ¹é…å­—ç¬¦ä¸²å¼€å¤´, å¤šè¡Œæ¨¡å¼ä¸‹åŒ¹é…æ¯ä¸€è¡Œçš„å¼€å§‹$åŒ¹é…å­—ç¬¦ä¸²ç»“å°¾, å¤šè¡Œæ¨¡å¼ä¸‹åŒ¹é…æ¯ä¸€è¡Œçš„ç»“æŸ\A / \ZæŒ‡å®šå­—ç¬¦ä¸²å¿…é¡»å‡ºç°åœ¨å¼€å¤´/ç»“å°¾\båŒ¹é…ä½äºå•è¯å¼€å§‹æˆ–ç»“æŸä½ç½®çš„ç©ºå­—ç¬¦ä¸²\BåŒ¹é…ä¸ä½äºå•è¯å¼€å§‹æˆ–ç»“æŸä½ç½®çš„ç©ºå­—ç¬¦ä¸²åˆ†ç»„åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼ä»£è¡¨çš„åŒ¹é…å­—ç¬¦|åŒ¹é…å·¦å³ä»»æ„ä¸€ä¸ªè¡¨è¾¾å¼(ab)æ‹¬å·é‡Œçš„è¡¨è¾¾å¼ä½œä¸ºä¸€ä¸ªåˆ†ç»„\&lt;number&gt;å¼•ç”¨ç¼–å·ä¸ºnumçš„åˆ†ç»„åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²(?P&lt;name&gt;)åˆ†ç»„èµ·åˆ«å(?P=name)å¼•ç”¨åˆ«åä¸ºnameçš„åˆ†ç»„åŒ¹é…å­—ç¬¦ä¸²[ ]å¯åŒ¹é…å…¶ä¸­ä»»æ„ä¸€ä¸ªå­—ç¬¦è½¬ä¹‰åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼ä»£è¡¨çš„åŒ¹é…å­—ç¬¦\è½¬ä¹‰å­—ç¬¦ï¼Œå¦‚\.åªèƒ½åŒ¹é….ï¼Œä¸èƒ½å†åŒ¹é…ä»»æ„å­—ç¬¦åŸºæœ¬ä½¿ç”¨é¢„ç¼–è¯‘compile å‡½æ•°ç”¨äºç¼–è¯‘æ­£åˆ™è¡¨è¾¾å¼ï¼Œç”Ÿæˆä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼(Pattern)å¯¹è±¡ï¼Œä¾› match() å’Œ search() è¿™ä¸¤ä¸ªå‡½æ•°ä½¿ç”¨å¦‚æœé‡å¤å¤šæ¬¡åœ°ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼Œæœ€å¥½æ˜¯ä½¿ç”¨compileå‡½æ•°æŠŠæ­£åˆ™è¡¨è¾¾å¼ç¼–è¯‘æˆå¯¹è±¡re.Patternï¼Œè¿™æ ·ä¼šå¤§å¤§åœ°æé«˜æœç´¢çš„æ•ˆç‡re.compile(pattern, flags=0)å±æ€§è¯´æ˜flagsï¼šç¼–è¯‘æ—¶æŒ‡å®šçš„æ¨¡å¼groupindexï¼šä»¥æ­£åˆ™è¡¨è¾¾å¼ä¸­æœ‰åˆ«åçš„ç»„çš„åˆ«åä¸ºé”®ã€ä»¥è¯¥ç»„å¯¹åº”çš„ç¼–å·ä¸ºå€¼çš„å­—å…¸ï¼Œæ²¡æœ‰åˆ«åçš„ç»„ä¸åŒ…å«åœ¨å†…ã€‚groupsï¼šæ­£åˆ™è¡¨è¾¾å¼ä¸­åˆ†ç»„çš„æ•°é‡patternï¼šç¼–è¯‘æ—¶ç”¨çš„æ­£åˆ™è¡¨è¾¾å¼æ–¹æ³•è¯´æ˜findallã€finditerã€matchã€searchã€splitã€subã€subn ç­‰å‡½æ•°ä¾‹å­123456789101112131415161718192021222324252627# -*- coding: utf-8 -*import res = 'Hello, Mr.Gumby : 2016/10/26'pat = '''(?:        # æ„é€ ä¸€ä¸ªä¸æ•è·åˆ†ç»„ ç”¨äºä½¿ç”¨ |              (?P&lt;name&gt;\w+\.\w+)    # åŒ¹é… Mr.Gumby              |     # æˆ–              (?P&lt;no&gt;\s+\.\w+) # ä¸€ä¸ªåŒ¹é…ä¸åˆ°çš„å‘½ååˆ†ç»„              )              .*? # åŒ¹é…  :               (\d+) # åŒ¹é… 2016              '''p = re.compile(pat, re.X)print(f'p.flags: {p.flags}')print(f'p.groupindex: {p.groupindex}')print(f'p.groups: {p.groups}')print(f'p.pattern: {p.pattern}')p.flags: 96p.groupindex: {'name': 1, 'no': 2}p.groups: 3p.pattern: (?:        # æ„é€ ä¸€ä¸ªä¸æ•è·åˆ†ç»„ ç”¨äºä½¿ç”¨ |              (?P&lt;name&gt;\w+\.\w+)    # åŒ¹é… Mr.Gumby              |     # æˆ–              (?P&lt;no&gt;\s+\.\w+) # ä¸€ä¸ªåŒ¹é…ä¸åˆ°çš„å‘½ååˆ†ç»„              )              .*? # åŒ¹é…  :               (\d+) # åŒ¹é… 2016åŒ¹é…æ¨¡å¼Pythonæ­£åˆ™è¡¨è¾¾å¼ï¼Œè¯·ä¸è¦å†ç”¨re.compileäº†åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œé‡‡ç”¨é¢„ç¼–è¯‘çš„ä¼˜åŠ¿å°±æ˜¯å¯ä»¥èŠ‚çº¦æ—¶é—´ï¼Œæé«˜æ•ˆç‡re.compile(pattern, flags=0)ç»™å®šä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ patternæŒ‡å®šä½¿ç”¨çš„æ¨¡å¼ flags é»˜è®¤ä¸º0 å³ä¸ä½¿ç”¨ä»»ä½•æ¨¡å¼ï¼Œç„¶åä¼šè¿”å›ä¸€ä¸ª SRE_Patternå¯¹è±¡å‚æ•°è¯´æ˜pattern: ä¸€ä¸ªå­—ç¬¦ä¸²å½¢å¼çš„æ­£åˆ™è¡¨è¾¾å¼flags: å¯é€‰ï¼Œè¡¨ç¤ºåŒ¹é…æ¨¡å¼ï¼Œæ¯”å¦‚å¿½ç•¥å¤§å°å†™ï¼Œå¤šè¡Œæ¨¡å¼ç­‰ï¼Œä½¿ç”¨æŒ‰ä½æˆ–è¿ç®—ç¬¦ | åŒæ—¶æ·»åŠ å¤šä¸ªæ¨¡å¼,å…·ä½“å‚æ•°ä¸ºï¼šre.Iï¼šæ•°å€¼2ï¼Œå¿½ç•¥å¤§å°å†™re.Lï¼šæ•°å€¼4ï¼Œè¡¨ç¤ºç‰¹æ®Šå­—ç¬¦é›† \w, \W, \b, \B, \s, \S ä¾èµ–äºå½“å‰ç¯å¢ƒre.Mï¼šæ•°å€¼8ï¼Œå¤šè¡Œæ¨¡å¼re.Sï¼šæ•°å€¼16ï¼Œå³ä¸º . å¹¶ä¸”åŒ…æ‹¬æ¢è¡Œç¬¦åœ¨å†…çš„ä»»æ„å­—ç¬¦ï¼ˆ. ä¸åŒ…æ‹¬æ¢è¡Œç¬¦ï¼‰re.Uï¼šæ•°å€¼32ï¼Œè¡¨ç¤ºç‰¹æ®Šå­—ç¬¦é›† \w, \W, \b, \B, \d, \D, \s, \S ä¾èµ–äº Unicode å­—ç¬¦å±æ€§æ•°æ®åº“re.Xï¼šæ•°å€¼64ï¼Œä¸ºäº†å¢åŠ å¯è¯»æ€§ï¼Œå¿½ç•¥ç©ºæ ¼å’Œ # åé¢çš„æ³¨é‡Šå¿½ç•¥å¤§å°å†™re.I123456789101112131415# I: IGNORECASEï¼Œ å¿½ç•¥å¤§å°å†™çš„åŒ¹é…æ¨¡å¼# -*- coding: utf-8 -*import restr1 = 'hello World!'pattern_s = &quot;hello world!&quot;pattern_r = re.compile(pattern_s, re.I)print(f'pattern_r.match(str1).group(): {pattern_r.match(str1).group()}')# æˆ–åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­æŒ‡å®šæ¨¡å¼ä»¥åŠæ³¨é‡Špattern_s = &quot;(?#æ³¨é‡Š)(?i)hello world!&quot;pattern_r = re.compile(pattern_s)print(f'pattern_r.match(str1).group(): {pattern_r.match(str1).group()}')pattern_r.match(str1).group(): hello World!pattern_r.match(str1).group(): hello World!å­—ç¬¦é›†æœ¬åœ°åŒ–re.L12# L: LOCALEï¼Œ å­—ç¬¦é›†æœ¬åœ°åŒ–ã€‚è¿™ä¸ªåŠŸèƒ½æ˜¯ä¸ºäº†æ”¯æŒå¤šè¯­è¨€ç‰ˆæœ¬çš„å­—ç¬¦é›†ä½¿ç”¨ç¯å¢ƒçš„ï¼Œæ¯”å¦‚åœ¨è½¬ä¹‰ç¬¦\wï¼Œåœ¨è‹±æ–‡ç¯å¢ƒä¸‹ï¼Œå®ƒä»£è¡¨[a-zA-Z0-9_]ï¼Œå³æ‰€ä»¥è‹±æ–‡å­—ç¬¦å’Œæ•°å­—ã€‚# å¦‚æœåœ¨ä¸€ä¸ªæ³•è¯­ç¯å¢ƒä¸‹ä½¿ç”¨ï¼Œç¼ºçœè®¾ç½®ä¸‹ï¼Œä¸èƒ½åŒ¹é…&quot;Ã©&quot; æˆ–&quot;Ã§&quot;ã€‚åŠ ä¸Šè¿™Lé€‰é¡¹å’Œå°±å¯ä»¥åŒ¹é…äº†ã€‚ä¸è¿‡è¿™ä¸ªå¯¹äºä¸­æ–‡ç¯å¢ƒä¼¼ä¹æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œå®ƒä»ç„¶ä¸èƒ½åŒ¹é…ä¸­æ–‡å­—ç¬¦ã€‚å¤šè¡Œæ¨¡å¼re.M1234567891011121314151617181920212223# M: MULTILINEï¼Œå¤šè¡Œæ¨¡å¼, æ”¹å˜ ^ å’Œ $ çš„è¡Œä¸º# -*- coding: utf-8 -*import restr1 = '''first line1second line2third line3'''# ^regex_start = re.compile(&quot;^\w+&quot;)print(f'regex_start.findall(str1): {regex_start.findall(str1)}')regex_start_m = re.compile(&quot;^\w+&quot;, re.M)print(f'regex_start_m.findall(str1): {regex_start_m.findall(str1)}')# $regex_end = re.compile(&quot;\w+$&quot;)print(f'regex_end.findall(str1): {regex_end.findall(str1)}')regex_end_m = re.compile(&quot;\w+$&quot;, re.M)print(f'regex_end_m.findall(str1): {regex_end_m.findall(str1)}')regex_start.findall(str1): ['first']regex_start_m.findall(str1): ['first', 'second', 'third']regex_end.findall(str1): ['line3']regex_end_m.findall(str1): ['line1', 'line2', 'line3']æ‰€æœ‰å­—ç¬¦re.S123456789101112131415# S: DOTALLï¼Œæ­¤æ¨¡å¼ä¸‹ '.' çš„åŒ¹é…ä¸å—é™åˆ¶ï¼Œå¯åŒ¹é…ä»»ä½•å­—ç¬¦ï¼ŒåŒ…æ‹¬æ¢è¡Œç¬¦# -*- coding: utf-8 -*import restr2 = '''first line1second line2third line3'''# æ­¤æ—¶.æ— æ³•åŒ¹é…æ¢è¡Œç¬¦regex = re.compile(&quot;.+&quot;)print(f'regex.findall(str2): {regex.findall(str2)}')# æ­¤æ—¶.åŒ¹é…æ¢è¡Œç¬¦regex_dotall = re.compile(&quot;.+&quot;, re.S)print(f'regex_dotall.findall(str2): {regex_dotall.findall(str2)}')regex.findall(str2): ['first line1', 'second line2', 'third line3']regex_dotall.findall(str2): ['first line1\nsecond line2\nthird line3']å†—ä½™æ¨¡å¼re.X12345678910# X: VERBOSEï¼Œå†—ä½™æ¨¡å¼ï¼Œ å¿½ç•¥æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„ç©ºç™½å’Œ#å·æ³¨é‡Šï¼Œå¦‚å†™ä¸€ä¸ªåŒ¹é…é‚®ç®±çš„æ­£åˆ™è¡¨è¾¾å¼# -*- coding: utf-8 -*import reemail_regex = re.compile(&quot;[\w+\.]+@[a-zA-Z\d]+\.(com|cn)&quot;)email_regex = re.compile(&quot;&quot;&quot;[\w+\.]+  # åŒ¹é…@ç¬¦å‰çš„éƒ¨åˆ†                            @  # @ç¬¦                            [a-zA-Z\d]+  # é‚®ç®±ç±»åˆ«                            \.(com|cn)   # é‚®ç®±åç¼€  &quot;&quot;&quot;, re.X)UNICODEè§£ære.U1# U: UNICODEï¼Œä½¿ç”¨ \w, \W, \b, \B è¿™äº›å…ƒå­—ç¬¦æ—¶å°†æŒ‰ç…§ UNICODE å®šä¹‰çš„å±æ€§.re.Matchç±»è‹¥åŒ¹é…æˆåŠŸï¼Œmatch/searchè¿”å›çš„æ˜¯Matchå¯¹è±¡ï¼Œfinditerè¿”å›çš„ä¹Ÿæ˜¯Matchå¯¹è±¡çš„è¿­ä»£å™¨è·å–åŒ¹é…ç»“æœéœ€è¦è°ƒç”¨Matchå¯¹è±¡çš„group()ã€groupsæˆ–group(index)æ–¹æ³•å±æ€§è¯´æ˜endpos: æœ¬æ¬¡æœç´¢ç»“æŸä½ç½®ç´¢å¼•lastgroup: æœ¬æ¬¡æœç´¢åŒ¹é…åˆ°çš„æœ€åä¸€ä¸ªåˆ†ç»„çš„åˆ«ålastindex: æœ¬æ¬¡æœç´¢åŒ¹é…åˆ°çš„æœ€åä¸€ä¸ªåˆ†ç»„çš„ç´¢å¼•pos: æœ¬æ¬¡æœç´¢å¼€å§‹ä½ç½®ç´¢å¼•re: æœ¬æ¬¡æœç´¢ä½¿ç”¨çš„ SRE_Pattern å¯¹è±¡regs: åˆ—è¡¨ï¼Œå…ƒç´ ä¸ºå…ƒç»„ï¼ŒåŒ…å«æœ¬æ¬¡æœç´¢åŒ¹é…åˆ°çš„æ‰€æœ‰åˆ†ç»„çš„èµ·æ­¢ä½ç½®æ–¹æ³•è¯´æ˜end([group=0])ï¼šè¿”å›æŒ‡å®šåˆ†ç»„çš„ç»“æŸä½ç½®ï¼Œé»˜è®¤è¿”å›æ­£åˆ™è¡¨è¾¾å¼æ‰€åŒ¹é…åˆ°çš„æœ€åä¸€ä¸ªå­—ç¬¦çš„ç´¢å¼•expand(template)ï¼šæ ¹æ®æ¨¡ç‰ˆè¿”å›ç›¸åº”çš„å­—ç¬¦ä¸²ï¼Œç±»ä¼¼ä¸ sub å‡½æ•°é‡Œé¢çš„ replï¼Œ å¯ä½¿ç”¨ \1 æˆ–è€… \g æ¥é€‰æ‹©åˆ†ç»„group([group1, â€¦])ï¼šæ ¹æ®æä¾›çš„ç´¢å¼•æˆ–åå­—è¿”å›å“åº”åˆ†ç»„çš„å†…å®¹é»˜è®¤è¿”å› start() åˆ° end() ä¹‹é—´çš„å­—ç¬¦ä¸²ï¼Œ æä¾›å¤šä¸ªå‚æ•°å°†è¿”å›ä¸€ä¸ªå…ƒç»„groupdict([default=None])ï¼šè¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰åŒ¹é…åˆ°çš„å‘½ååˆ†ç»„çš„å­—å…¸ï¼Œæ²¡æœ‰å‘½åçš„åˆ†ç»„ä¸åŒ…å«åœ¨å†…key ä¸ºç»„åï¼Œ value ä¸ºåŒ¹é…åˆ°çš„å†…å®¹ï¼Œå‚æ•° default ä¸ºæ²¡æœ‰å‚ä¸æœ¬æ¬¡åŒ¹é…çš„å‘½ååˆ†ç»„æä¾›é»˜è®¤å€¼groups([default=None])ï¼šä»¥å…ƒç»„å½¢å¼è¿”å›æ¯ä¸€ä¸ªåˆ†ç»„åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²ï¼ŒåŒ…æ‹¬æ²¡æœ‰å‚ä¸åŒ¹é…çš„åˆ†ç»„ï¼Œå…¶å€¼ä¸º defaultspan([group])ï¼šè¿”å›æŒ‡å®šåˆ†ç»„çš„èµ·æ­¢ä½ç½®ç»„æˆçš„å…ƒç»„ï¼Œé»˜è®¤è¿”å›ç”± start() å’Œ end() ç»„æˆçš„å…ƒç»„start([group])ï¼šè¿”å›æŒ‡å®šåˆ†ç»„çš„å¼€å§‹ä½ç½®ï¼Œé»˜è®¤è¿”å›æ­£åˆ™è¡¨è¾¾å¼æ‰€åŒ¹é…åˆ°çš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ç´¢å¼•123456789101112131415161718192021222324252627# -*- coding: utf-8 -*import res = 'Hello, Mr.Gumby : 2016/10/26'm = re.search(', (?P&lt;name&gt;\w+\.\w+).*?(\d+)', s)# æœ¬æ¬¡æœç´¢çš„ç»“æŸä½ç½®ç´¢å¼•print(f'm.endpos: {m.endpos}')# æœ¬æ¬¡æœç´¢åŒ¹é…åˆ°çš„æœ€åä¸€ä¸ªåˆ†ç»„çš„åˆ«å# æœ¬æ¬¡åŒ¹é…æœ€åä¸€ä¸ªåˆ†ç»„æ²¡æœ‰åˆ«åprint(f'm.lastgroup: {m.lastgroup}')# æœ¬æ¬¡æœç´¢åŒ¹é…åˆ°çš„æœ€åä¸€ä¸ªåˆ†ç»„çš„ç´¢å¼•print(f'm.lastindex: {m.lastindex}')# æœ¬æ¬¡æœç´¢å¼€å§‹ä½ç½®ç´¢å¼•print(f'm.pos: {m.pos}')# æœ¬æ¬¡æœç´¢ä½¿ç”¨çš„ SRE_Pattern å¯¹è±¡print(f'm.re: {m.re}')# åˆ—è¡¨ï¼Œå…ƒç´ ä¸ºå…ƒç»„ï¼ŒåŒ…å«æœ¬æ¬¡æœç´¢åŒ¹é…åˆ°çš„æ‰€æœ‰åˆ†ç»„çš„èµ·æ­¢ä½ç½® ç¬¬ä¸€ä¸ªå…ƒç»„ä¸ºæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…èŒƒå›´print(f'm.regs: {m.regs}')# æœ¬æ¬¡æœç´¢æ“ä½œçš„å­—ç¬¦ä¸²print(f'm.string: {m.string}')m.endpos: 28m.lastgroup: Nonem.lastindex: 2m.pos: 0m.re: re.compile(', (?P&lt;name&gt;\\w+\\.\\w+).*?(\\d+)')m.regs: ((5, 22), (7, 15), (18, 22))m.string: Hello, Mr.Gumby : 2016/10/26123456789101112131415161718192021222324252627282930313233343536373839# -*- coding: utf-8 -*import res = 'Hello, Mr.Gumby : 2016/10/26'm = re.search('''(?:        # æ„é€ ä¸€ä¸ªä¸æ•è·åˆ†ç»„ ç”¨äºä½¿ç”¨ |              (?P&lt;name&gt;\w+\.\w+)    # åŒ¹é… Mr.Gumby              |     # æˆ–              (?P&lt;no&gt;\s+\.\w+) # ä¸€ä¸ªåŒ¹é…ä¸åˆ°çš„å‘½ååˆ†ç»„              )              .*? # åŒ¹é…  :               (\d+) # åŒ¹é… 2016              ''',              s, re.X)# è¿”å›æŒ‡å®šåˆ†ç»„çš„ç»“æŸä½ç½®ï¼Œé»˜è®¤è¿”å›æ­£åˆ™è¡¨è¾¾å¼æ‰€åŒ¹é…åˆ°çš„æœ€åä¸€ä¸ªå­—ç¬¦çš„ç´¢å¼•print(f'm.end(): {m.end()}')# æ ¹æ®æ¨¡ç‰ˆè¿”å›ç›¸åº”çš„å­—ç¬¦ä¸²ï¼Œç±»ä¼¼sub()çš„ repl,å¯ä½¿ç”¨ \1 æˆ–è€… \g&lt;name&gt; æ¥é€‰æ‹©åˆ†ç»„mExpend = m.expand('my name is \\1')print(f&quot;m.expand('my name is \\1'): {mExpend}&quot;)# æ ¹æ®æä¾›çš„ç´¢å¼•æˆ–åå­—è¿”å›å“åº”åˆ†ç»„çš„å†…å®¹ï¼Œé»˜è®¤è¿”å› start() åˆ° end() ä¹‹é—´çš„å­—ç¬¦ä¸²ï¼Œ# æä¾›å¤šä¸ªå‚æ•°å°†è¿”å›ä¸€ä¸ªå…ƒç»„print(f'm.group(): {m.group()}')print(f'm.group(1, 2): {m.group(1, 2)}')# è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰åŒ¹é…åˆ°çš„å‘½ååˆ†ç»„çš„å­—å…¸ï¼Œæ²¡æœ‰å‘½åçš„åˆ†ç»„ä¸åŒ…å«åœ¨å†…ï¼Œkey ä¸ºç»„åï¼Œ# value ä¸ºåŒ¹é…åˆ°çš„å†…å®¹ï¼Œå‚æ•° default ä¸ºæ²¡æœ‰å‚ä¸æœ¬æ¬¡åŒ¹é…çš„å‘½ååˆ†ç»„æä¾›é»˜è®¤å€¼m.groupdict('default_string')# ä»¥å…ƒç»„å½¢å¼è¿”å›æ¯ä¸€ä¸ªåˆ†ç»„åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²ï¼ŒåŒ…æ‹¬æ²¡æœ‰å‚ä¸åŒ¹é…çš„åˆ†ç»„ï¼Œå…¶å€¼ä¸º defaultprint(f&quot;m.groups('default_string'): {m.groups('default_string')}&quot;)# è¿”å›æŒ‡å®šåˆ†ç»„çš„èµ·æ­¢æœªçŸ¥ç»„æˆçš„å…ƒç»„ï¼Œé»˜è®¤è¿”å›ç”± start() å’Œ end() ç»„æˆçš„å…ƒç»„print(f'm.span(3): {m.span(3)}')# è¿”å›æŒ‡å®šåˆ†ç»„çš„å¼€å§‹ä½ç½®ï¼Œé»˜è®¤è¿”å›æ­£åˆ™è¡¨è¾¾å¼æ‰€åŒ¹é…åˆ°çš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ç´¢å¼•print(f'm.start(3): {m.start(3)}')m.end(): 22m.expand('my name is \1'): my name is Mr.Gumbym.group(): Mr.Gumby : 2016m.group(1, 2): ('Mr.Gumby', None)m.groups('default_string'): ('Mr.Gumby', 'default_string', '2016')m.span(3): (18, 22)m.start(3): 18åŒ¹é…matchre.match(pattern, string[, flags])ä»é¦–å­—æ¯å¼€å§‹åŒ¹é…ï¼Œstringå¦‚æœåŒ…å«patternå­ä¸²ï¼Œåˆ™åŒ¹é…æˆåŠŸï¼Œè¿”å›Matchå¯¹è±¡ï¼Œå¤±è´¥åˆ™è¿”å›Noneï¼Œè‹¥è¦å®Œå…¨åŒ¹é…ï¼Œpatternè¦ä»¥$ç»“å°¾å‚æ•°è¯´æ˜patternï¼šåŒ¹é…çš„æ­£åˆ™è¡¨è¾¾å¼stringï¼šè¦åŒ¹é…çš„å­—ç¬¦ä¸²ã€‚flagsï¼šæ ‡å¿—ä½ï¼Œç”¨äºæ§åˆ¶æ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…æ–¹å¼ï¼Œå¦‚ï¼šæ˜¯å¦åŒºåˆ†å¤§å°å†™ï¼Œå¤šè¡ŒåŒ¹é…ç­‰ç­‰ã€‚å‚è§ï¼šæ­£åˆ™è¡¨è¾¾å¼ä¿®é¥°ç¬¦ - å¯é€‰æ ‡å¿—matchå‡½æ•°åœ¨stringçš„å¼€å§‹ä½ç½®åŒ¹é…ï¼Œå¦‚æœåŒ¹é…åˆ™è¿”å›å¯¹è±¡ï¼Œå¦åˆ™è¿”å›None12345678910111213141516#! /usr/bin/env python# -*- coding=utf-8 -*-   import re   text = 'python world'm = re.match(r&quot;\w+&quot;, text)print(m.group(0)) if m else print('not match')text = '#python world'm = re.match(r&quot;\w+&quot;, text)print(m.group(0)) if m else print('not match')    output: pythonoutput: not match12345678# re.match()å‡½æ•°# -*- coding: utf-8 -*import restr1 = '333STR1666STR299'pattern_s = r'([A-Z]+(\d))'print(f're.match(pattern_s, str1): {re.match(pattern_s, str1)}')  # str1çš„å¼€å¤´ä¸ç¬¦åˆæ­£åˆ™ï¼Œæ‰€ä»¥ç»“æœä¸ºNonere.match(pattern_s, str1): Nonesearchre.search(pattern, string[, flags])è‹¥stringä¸­åŒ…å«patternå­ä¸²ï¼Œåˆ™è¿”å›Matchå¯¹è±¡ï¼Œå¦åˆ™è¿”å›Noneï¼Œæ³¨æ„ï¼Œå¦‚æœstringä¸­å­˜åœ¨å¤šä¸ªpatternå­ä¸²ï¼Œåªè¿”å›ç¬¬ä¸€ä¸ªå‚æ•°è¯´æ˜patternï¼šåŒ¹é…çš„æ­£åˆ™è¡¨è¾¾å¼stringï¼šè¦åŒ¹é…çš„å­—ç¬¦ä¸²flagsï¼šæ ‡å¿—ä½ï¼Œç”¨äºæ§åˆ¶æ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…æ–¹å¼ï¼Œå¦‚ï¼šæ˜¯å¦åŒºåˆ†å¤§å°å†™ï¼Œå¤šè¡ŒåŒ¹é…ç­‰ç­‰searchä¼šæ‰«ææ•´ä¸ªstringæŸ¥æ‰¾åŒ¹é…ï¼Œå¦‚æœæ‰¾åˆ°åˆ™è¿”å›ä¸€ä¸ªç›¸åº”çš„åŒ¹é…å¯¹è±¡ï¼Œå¦åˆ™è¿”å›None12345678910111213141516#! /usr/bin/env python# -*- coding=utf-8 -*-import retext = 'python world'm = re.search(r&quot;\w+&quot;, text)print(m.group(0)) if m else print('not match')text = '#python world'm = re.search(r&quot;\w+&quot;, text)print(m.group(0)) if m else print('not match')output: pythonoutput: python1234567891011121314151617181920# re.search()å‡½æ•°# -*- coding: utf-8 -*import restr1 = '333STR1666STR299'pattern_s = r'([A-Z]+(\d))'match_r = re.search(pattern_s, str1)# match_r[0]æ˜¯regexæ‰€ä»£è¡¨çš„æ•´ä¸ªå­—ç¬¦ä¸²print(f'match_r.group(0): {match_r.group(0)}')  # match_r.group()# match_r[1]æ˜¯ç¬¬ä¸€ä¸ª()ä¸­çš„å†…å®¹print(f'match_r.group(1): {match_r.group(1)}')# match_r[2]æ˜¯ç¬¬äºŒå¯¹()ä¸­çš„å†…å®¹print(f'match_r.group(2): {match_r.group(2)}')# æ‰€æœ‰groupç»„æˆçš„ä¸€ä¸ªå…ƒç»„print(f'match_r.groups(): {match_r.groups()}')match_r.group(0): STR1match_r.group(1): STR1match_r.group(2): 1match_r.groups(): ('STR1', '1')æ£€ç´¢findallre.findall(pattern, string[, flags])è¿”å›stringä¸­æ‰€æœ‰ä¸patternç›¸åŒ¹é…çš„å…¨éƒ¨å­—ä¸²ï¼Œè¿”å›å½¢å¼ä¸ºæ•°ç»„å‚æ•°è¯´æ˜string: å¾…åŒ¹é…çš„å­—ç¬¦ä¸²pos: å¯é€‰å‚æ•°ï¼ŒæŒ‡å®šå­—ç¬¦ä¸²çš„èµ·å§‹ä½ç½®ï¼Œé»˜è®¤ä¸º 0endpos: å¯é€‰å‚æ•°ï¼ŒæŒ‡å®šå­—ç¬¦ä¸²çš„ç»“æŸä½ç½®ï¼Œé»˜è®¤ä¸ºå­—ç¬¦ä¸²çš„é•¿åº¦findallè¿”å›æ‰€æœ‰åŒ¹é…çš„æŒ‡å®šæ¨¡å¼çš„æ–‡æœ¬å­ä¸²åˆ°åˆ—è¡¨ä¸­ï¼Œä¸€ä¸ªå…ƒç´ ä¸€ä¸ªåŒ¹é…ä¸²123456789101112# re.findall()å‡½æ•°# -*- coding: utf-8 -*import restr1 = '333STR1666STR299'pattern_s = r'([A-Z]+(\d))'match_r = re.findall(pattern_s, str1)for m in match_r:    print(f'm[0], m[1]: {m[0], m[1]}')    m[0], m[1]: ('STR1', '1')m[0], m[1]: ('STR2', '2')finditerre.finditer(pattern, string[, flags])è¿”å›stringä¸­æ‰€æœ‰ä¸patternç›¸åŒ¹é…çš„å…¨éƒ¨å­—ä¸²ï¼Œè¿”å›å½¢å¼ä¸ºè¿­ä»£å™¨å‚æ•°è¯´æ˜patternï¼šåŒ¹é…çš„æ­£åˆ™è¡¨è¾¾å¼stringï¼šè¦åŒ¹é…çš„å­—ç¬¦ä¸²ã€‚flagsï¼šæ ‡å¿—ä½ï¼Œç”¨äºæ§åˆ¶æ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…æ–¹å¼ï¼Œå¦‚ï¼šæ˜¯å¦åŒºåˆ†å¤§å°å†™ï¼Œå¤šè¡ŒåŒ¹é…ç­‰ç­‰ã€‚å‚è§ï¼šæ­£åˆ™è¡¨è¾¾å¼ä¿®é¥°ç¬¦ - å¯é€‰æ ‡å¿—finditerå‡½æ•°è·Ÿfindallå‡½æ•°ç±»ä¼¼ï¼Œä½†è¿”å›çš„æ˜¯ä¸€ä¸ªè¿­ä»£å™¨123456789101112# re.finditer()å‡½æ•°# -*- coding: utf-8 -*import restr1 = '333STR1666STR299'pattern_s = r'([A-Z]+(\d))'match_r = re.finditer(pattern_s, str1)for m in match_r:    print(f'm.group(0), m.group(1), m.group(2): {m.group(0), m.group(1), m.group(2)}')  # å­—ç¬¦ä¸²    m.group(0), m.group(1), m.group(2): ('STR1', 'STR1', '1')m.group(0), m.group(1), m.group(2): ('STR2', 'STR2', '2')æ›¿æ¢å’Œåˆ†å‰²subæ›¿æ¢re.sub(pattern, repl, string, count=0, flags=0)å°†å­—ç¬¦ä¸²ä¸­åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼çš„éƒ¨åˆ†æ›¿æ¢ä¸ºå…¶ä»–å€¼Return the string obtained by replacing the leftmost non-overlapping occurrences of the pattern in string by the replacement repl.repl can be either a string or a callable; if a string, backslash escapes in it are processed. If it is a callable, itâ€™s passed the Match object and must return a replacement string to be used.å‚æ•°è¯´æ˜pattern: æ­£åˆ™ä¸­çš„æ¨¡å¼å­—ç¬¦ä¸²ã€‚repl: æ›¿æ¢çš„å­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä¸ºä¸€ä¸ªå‡½æ•°ã€‚string: è¦è¢«æŸ¥æ‰¾æ›¿æ¢çš„åŸå§‹å­—ç¬¦ä¸²ã€‚count: æ¨¡å¼åŒ¹é…åæ›¿æ¢çš„æœ€å¤§æ¬¡æ•°ï¼Œé»˜è®¤ 0 è¡¨ç¤ºæ›¿æ¢æ‰€æœ‰çš„åŒ¹é…ã€‚ä»£ç 12345678910111213141516# -*- coding: utf-8 -*import redef add_one(match):    val = match.group()    num = int(val) + 1    return str(num)str2 = 'imooc videonum=200'reSub_1 = re.sub(r'\d+', add_one, str2)print(f&quot;re.sub(r'\d+', add_one, str2): {reSub_1}&quot;)reSub_2 = re.sub(r'\d+', '203', str2)print(f&quot;re.sub(r'\d+', '203', str2): {reSub_2}&quot;)sample_text = '2020-05-20 10:59:23 hello world 2020-05-21 10:59:24 hello kitty'sample_pattern = r'(?P&lt;year&gt;\d{4})-(?P&lt;month&gt;\d{2})-(?P&lt;day&gt;\d{2})'sample_repl = r'\g&lt;month&gt;/\g&lt;day&gt;/\g&lt;year&gt;'print(re.sub(sample_pattern, sample_repl, sample_text))è¾“å‡º123re.sub(r'\d+', add_one, str2): imooc videonum=201re.sub(r'\d+', '203', str2): imooc videonum=20305/20/2020 10:59:23 hello world 05/21/2020 10:59:24 hello kittyé«˜çº§ç”¨æ³•ä¸€æ—¥ä¸€æŠ€ï¼šå¦‚ä½•æ­£ç¡®ä½¿ç”¨ re.sub çš„ç¬¬äºŒä¸ªå‚æ•°re.subç¬¬äºŒä¸ªå‚æ•°å¯ä»¥æ˜¯å‡½æ•°è®¾æƒ³æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²abc18123456794xyz123ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²ä¸­æœ‰ä¸¤æ®µæ•°å­—ï¼Œå¹¶ä¸”é•¿çŸ­æ˜¯ä¸ä¸€æ ·çš„ç¬¬ä¸€ä¸ªæ•°å­—æ˜¯11ä½çš„æ‰‹æœºå·ã€‚æˆ‘æƒ³æŠŠå­—ç¬¦ä¸²æ›¿æ¢ä¸ºï¼š`abc[éšè—æ‰‹æœºå·]xyz*ä¸æ˜¯æ‰‹æœºå·çš„æ•°å­—ï¼Œæ¯ä¸€ä½æ•°å­—é€ä½æ›¿æ¢ä¸ºæ˜Ÿå·1234567891011import redef test(repl): if len(repl.group(0)) == 11:     return '[éšè—æ‰‹æœºå·]' else:     return '*' * len(repl.group(0))a = 'abc18123456794xyz123'b = re.sub('\d+', test, a)print(b)subnæ›¿æ¢subn(pattern, repl, string, count=0, flags=0)ä½œç”¨ä¸å‡½æ•° sub ä¸€æ ·ï¼Œ å”¯ä¸€ä¸åŒä¹‹å¤„åœ¨äºè¿”å›å€¼ä¸ºä¸€ä¸ªå…ƒç»„ï¼Œç¬¬ä¸€ä¸ªå€¼ä¸ºæ›¿æ¢åçš„å­—ç¬¦ä¸²ï¼Œç¬¬äºŒä¸ªå€¼ä¸ºå‘ç”Ÿæ›¿æ¢çš„æ¬¡æ•°splitåˆ†å‰²re.split(pattern, string, maxsplit=0, flags=0)æ ¹æ®åŒ¹é…åˆ†å‰²å­—ç¬¦ä¸²ï¼Œè¿”å›åˆ†å‰²å­—ç¬¦ä¸²ç»„æˆçš„åˆ—è¡¨Split the source string by the occurrences of the pattern, returning a list containing the resulting substrings.If capturing parentheses are used in pattern, then the text of all groups in the pattern are also returned as part of the resulting list. If maxsplit is nonzero, at most maxsplit splits occur, and the remainder of the string is returned as the final element of the list.å‚æ•°è¯´æ˜patternï¼šåŒ¹é…çš„æ­£åˆ™è¡¨è¾¾å¼stringï¼šè¦åŒ¹é…çš„å­—ç¬¦ä¸²ã€‚maxsplitï¼šåˆ†éš”æ¬¡æ•°ï¼Œmaxsplit=1 åˆ†éš”ä¸€æ¬¡ï¼Œé»˜è®¤ä¸º 0ï¼Œä¸é™åˆ¶æ¬¡æ•°ã€‚flagsï¼šæ ‡å¿—ä½ï¼Œç”¨äºæ§åˆ¶æ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…æ–¹å¼ï¼Œå¦‚ï¼šæ˜¯å¦åŒºåˆ†å¤§å°å†™ï¼Œå¤šè¡ŒåŒ¹é…ç­‰ç­‰ã€‚å‚è§ï¼šæ­£åˆ™è¡¨è¾¾å¼ä¿®é¥°ç¬¦ - å¯é€‰æ ‡å¿—ä»£ç 12345# -*- coding: utf-8 -*import restr3 = 'imooc:C C++ Java Python,c#'resub_3 = re.split(r':| |,',str3)print(f&quot;re.split(r':| |,',str3):{resub_3}&quot;)è¾“å‡º1re.split(r':| |,',str3):['imooc', 'C', 'C++', 'Java', 'Python', 'c#']æ­£åˆ™ç¼“å­˜å½“ä½ åœ¨ç¨‹åºä¸­ä½¿ç”¨ re æ¨¡å—ï¼Œæ— è®ºæ˜¯å…ˆä½¿ç”¨ compile è¿˜æ˜¯ç›´æ¥ä½¿ç”¨æ¯”å¦‚ findall æ¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ“ä½œæ–‡æœ¬re æ¨¡å—éƒ½ä¼šå°†æ­£åˆ™è¡¨è¾¾å¼å…ˆç¼–è¯‘ä¸€ä¸‹ï¼Œ å¹¶ä¸”ä¼šå°†ç¼–è¯‘è¿‡åçš„æ­£åˆ™è¡¨è¾¾å¼æ”¾åˆ°ç¼“å­˜ä¸­è¿™æ ·ä¸‹æ¬¡ä½¿ç”¨åŒæ ·çš„æ­£åˆ™è¡¨è¾¾å¼çš„æ—¶å€™å°±ä¸éœ€è¦å†æ¬¡ç¼–è¯‘ï¼Œ å› ä¸ºç¼–è¯‘å…¶å®æ˜¯å¾ˆè´¹æ—¶çš„ï¼Œè¿™æ ·å¯ä»¥æå‡æ•ˆç‡è€Œé»˜è®¤ç¼“å­˜çš„æ­£åˆ™è¡¨è¾¾å¼çš„ä¸ªæ•°æ˜¯ 100ï¼Œå½“ä½ éœ€è¦é¢‘ç¹ä½¿ç”¨å°‘é‡æ­£åˆ™è¡¨è¾¾å¼çš„æ—¶å€™ï¼Œç¼“å­˜å¯ä»¥æå‡æ•ˆç‡è€Œä½¿ç”¨çš„æ­£åˆ™è¡¨è¾¾å¼è¿‡å¤šæ—¶ï¼Œç¼“å­˜å¸¦æ¥çš„ä¼˜åŠ¿å°±ä¸æ˜æ˜¾äº†è¿™ä¸ªre.purge()å‡½æ•°çš„ä½œç”¨æ˜¯æ¸…é™¤ç¼“å­˜ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¯èƒ½åœ¨ä½ éœ€è¦ä¼˜åŒ–å ç”¨å†…å­˜çš„æ—¶å€™ä¼šç”¨åˆ°çˆ¬è™«ä¾‹å­ä»£ç 123456789101112131415161718192021# -*- coding: utf-8 -*import urllib.requestimport reimport osurl = r'https://www.imooc.com/course/list?c=ai'res = urllib.request.urlopen(url)html = res.read().decode('utf-8')listurl = re.findall(r'src=&quot;//img\d.+?jpg&quot;', html)lurl = ['http:%s' % x[5:-1] for x in listurl]print(lurl)basepath = './res'if not os.path.exists(basepath):    os.makedirs(basepath)imgspath = os.path.join(basepath, 're_op')if not os.path.exists(imgspath):    os.mkdir(imgspath)for ii, uu in enumerate(lurl):    savepath = os.path.join(imgspath, '%d.jpg' % (ii))    res = urllib.request.urlretrieve(uu, savepath)è¾“å‡º1['http://img4.mukewang.com/5bd8157a0001a7a506000336-240-135.jpg', 'http://img3.mukewang.com/5bc6e6b80001434f06000338-240-135.jpg', 'http://img2.mukewang.com/5ba2386600013d3705980337-240-135.jpg', 'http://img3.mukewang.com/5b9105800001288905400300-240-135.jpg', 'http://img4.mukewang.com/5b7f737a0001cfb706000336-240-135.jpg', 'http://img4.mukewang.com/5abc6159000142f706000338-240-135.jpg', 'http://img1.mukewang.com/5a40c6370001d13c06000338-240-135.jpg']è¿›é˜¶ç”¨æ³•éè´ªå©ªåŒ¹é…åŒ¹é…æ¨¡å¼è´ªå©ªåŒ¹é…ï¼šè´ªå©ªåŒ¹é…åœ¨åŒ¹é…å­—ç¬¦ä¸²æ—¶æ€»æ˜¯å°è¯•åŒ¹é…å°½å¯èƒ½å¤šçš„å­—ç¬¦éè´ªå©ªåŒ¹é…ï¼šä¸è´ªå©ªåŒ¹é…ç›¸åï¼Œéè´ªå©ªåŒ¹é…åœ¨åŒ¹é…å­—ç¬¦ä¸²æ—¶æ€»æ˜¯å°è¯•åŒ¹é…å°½å¯èƒ½å°‘çš„å­—ç¬¦Pythoné‡Œæ•°é‡è¯é»˜è®¤æ˜¯è´ªå©ªæ¨¡å¼çš„ï¼Œä½¿ç”¨*? / +? / ??å¯ä½¿è´ªå©ªæ¨¡å¼å˜æˆéè´ªå©ªæ¨¡å¼1234567891011121314151617181920212223242526272829303132333435363738# -*- coding: utf-8 -*import restr1 = '9abc'  # éœ€è¦æŸ¥æ‰¾çš„åŸå§‹å­—ç¬¦ä¸²pattern_s = r'[0-9][a-z]*?'  # å®šä¹‰æ­£åˆ™è¡¨è¾¾å¼pattern_r = re.compile(pattern_s)  # ç¼–è¯‘æ­£åˆ™è¡¨è¾¾å¼match_r = pattern_r.match(str1)print(f'match_r.group(): {match_r.group()}')pattern_s = r'[0-9][a-z]*'  # å®šä¹‰æ­£åˆ™è¡¨è¾¾å¼pattern_r = re.compile(pattern_s)  # ç¼–è¯‘æ­£åˆ™è¡¨è¾¾å¼match_r = pattern_r.match(str1)print(f'match_r.group(): {match_r.group()}')pattern_s = r'[0-9][a-z]+?'  # å®šä¹‰æ­£åˆ™è¡¨è¾¾å¼pattern_r = re.compile(pattern_s)  # ç¼–è¯‘æ­£åˆ™è¡¨è¾¾å¼match_r = pattern_r.match(str1)print(f'match_r.group(): {match_r.group()}')pattern_s = r'[0-9][a-z]+'  # å®šä¹‰æ­£åˆ™è¡¨è¾¾å¼pattern_r = re.compile(pattern_s)  # ç¼–è¯‘æ­£åˆ™è¡¨è¾¾å¼match_r = pattern_r.match(str1)print(f'match_r.group(): {match_r.group()}')pattern_s = r'[0-9][a-z]??'  # å®šä¹‰æ­£åˆ™è¡¨è¾¾å¼pattern_r = re.compile(pattern_s)  # ç¼–è¯‘æ­£åˆ™è¡¨è¾¾å¼match_r = pattern_r.match(str1)print(f'match_r.group(): {match_r.group()}')pattern_s = r'[0-9][a-z]?'  # å®šä¹‰æ­£åˆ™è¡¨è¾¾å¼pattern_r = re.compile(pattern_s)  # ç¼–è¯‘æ­£åˆ™è¡¨è¾¾å¼match_r = pattern_r.match(str1)print(f'match_r.group(): {match_r.group()}')match_r.group(): 9match_r.group(): 9abcmatch_r.group(): 9amatch_r.group(): 9abcmatch_r.group(): 9match_r.group(): 9aåˆ†ç»„åŒ¹é…(æ•è·ç»„)12345678import regex as repat = re.compile(r&quot;æœ‰(?P&lt;zj&gt;(è®¸å¯è¯[ä»¶]?|æ‰§ç…§))çš„?(?P&lt;xf_type&gt;(æš‚æ‰£|åŠé”€).{0,4}(?P=zj))&quot;)doc = &quot;æœ‰è®¸å¯è¯çš„åŠé”€è®¸å¯è¯ï¼Œå¹¶ç»™äºˆä¸¥å‰æƒ©ç½š&quot;res = list(re.finditer(pat, doc))res[0].groupdict()Out[16]: {'zj': 'è®¸å¯è¯', 'xf_type': 'åŠé”€è®¸å¯è¯'}123456789# åˆ†ç»„åŒ¹é…ä¹‹ \&lt;number&gt;# -*- coding: utf-8 -*import restr1 = '&lt;book&gt;python&lt;/book&gt;'pattern_s = r'&lt;([\w]+&gt;)[\w]+&lt;/\1'print(re.match(pattern_s, str1).group())&lt;book&gt;python&lt;/book&gt;1234567891011# åˆ†ç»„åŒ¹é…ä¹‹ åˆ«å (?P&lt;name&gt;) å’Œ (?P=name)# -*- coding: utf-8 -*import restr1 = '&lt;book&gt;python&lt;/book&gt;'pattern_s = r'&lt;(?P&lt;mark1&gt;[\w]+&gt;)[\w]+&lt;/(?P=mark1)'print(re.match(pattern_s, str1).group())Out[12]: &lt;book&gt;python&lt;/book&gt;re.match(pattern_s, str1).groupdict()Out[13]: {'mark1': 'book&gt;'}12345678910111213141516# åˆ†ç»„åŒ¹é…ä¹‹group()å’Œgroups()group() / group(0): æ¯ä¸²ä¸­ä¸æ¨¡å¼patternåŒ¹é…çš„å­ä¸²group(index): ç¬¬indexä¸ªgroupåŒ¹é…æˆåŠŸçš„å­ä¸²groups(): æ‰€æœ‰groupç»„æˆçš„ä¸€ä¸ªå…ƒç»„ï¼Œä¸patternä¸­çš„()æœ‰å…³# -*- coding: utf-8 -*import rep = re.compile('\d-\d-\d')m = p.match('2-3-1')print(f'm.group(): {m.group()}')print(f'm.group(0): {m.group(0)}')print(f'm.groups(): {m.groups()}')m.group(): 2-3-1m.group(0): 2-3-1m.groups(): ()1234567891011# -*- coding: utf-8 -*import rep = re.compile('(\d)-(\d)-(\d)')m = p.match('2-3-1d5-4-3')print(f'm.group(): {m.group()}')print(f'm.group(0): {m.group(0)}')print(f'm.groups(): {m.groups()}')m.group(): 2-3-1m.group(0): 2-3-1m.groups(): ('2', '3', '1')1234567891011# -*- coding: utf-8 -*import rep = re.compile('(\d)-(\d)-(\d)')m = re.match(p,'2-3-1d5-4-3')print(f'm.group(): {m.group()}')print(f'm.group(0): {m.group(0)}')print(f'm.groups(): {m.groups()}')m.group(): 2-3-1m.group(0): 2-3-1m.groups(): ('2', '3', '1')è½¬ä¹‰åŒ¹é…æ›¿ä»£å‡½æ•°ä½¿ç”¨pythonçš„è¿‡ç¨‹ä¸­ï¼Œä½ è‚¯å®šå¯¹è½¬ä¹‰å­—ç¬¦çš„ä½¿ç”¨è‹¦æ¼è¿‡ï¼Œå› ä¸ºæœ‰çš„æ—¶å€™æˆ‘ä»¬éœ€è¦ä½¿ç”¨ä¸€äº›ç‰¹æ®Šç¬¦å·å¦‚â€$ * . ^â€ç­‰çš„åŸæ„æœ‰æ—¶å€™éœ€è¦è¢«è½¬ä¹‰åçš„åŠŸèƒ½ï¼Œå¹¶ä¸”è½¬ä¹‰å­—ç¬¦åœ°ä½¿ç”¨å¾ˆç¹çï¼Œå®¹æ˜“å‡ºé”™re.escape(pattern)è½¬ä¹‰: å¦‚æœä½ éœ€è¦æ“ä½œçš„æ–‡æœ¬ä¸­å«æœ‰æ­£åˆ™çš„å…ƒå­—ç¬¦ï¼Œä½ åœ¨å†™æ­£åˆ™çš„æ—¶å€™éœ€è¦å°†å…ƒå­—ç¬¦åŠ ä¸Šåæ–œæ‰› \ å»åŒ¹é…è‡ªèº«è€Œå½“è¿™æ ·çš„å­—ç¬¦å¾ˆå¤šæ—¶ï¼Œå†™å‡ºæ¥çš„æ­£åˆ™è¡¨è¾¾å¼å°±çœ‹èµ·æ¥å¾ˆä¹±è€Œä¸”å†™èµ·æ¥ä¹ŸæŒºéº»çƒ¦çš„ï¼Œè¿™ä¸ªæ—¶å€™ä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªå‡½æ•°å¯ä»¥å¯¹å­—ç¬¦ä¸²ä¸­æ‰€æœ‰å¯èƒ½è¢«è§£é‡Šä¸ºæ­£åˆ™è¿ç®—ç¬¦çš„å­—ç¬¦è¿›è¡Œè½¬ä¹‰çš„åº”ç”¨å‡½æ•°123456789101112# -*- coding: utf-8 -*import restr2 = &quot;.+\d123&quot;regex_str = re.escape(&quot;.+\d123&quot;)# æŸ¥çœ‹è½¬ä¹‰åçš„å­—ç¬¦print(f'regex_str: {regex_str}')# æŸ¥çœ‹åŒ¹é…åˆ°çš„ç»“æœfor g in re.findall(regex_str, str2):    print(g)    regex_str: \.\+\\d123.+\d123reå¢å¼ºçš„åŒ…è£…ä¸»è¦ç›®çš„æ˜¯ï¼Œå¢å¼ºreçš„åŒ¹é…èƒ½åŠ›ï¼Œä¸ºmatchå¯¹è±¡æ·»åŠ äº†start: int=0å‚æ•°ï¼ŒstartæŒ‡å®šäº†å½“å‰å­—ç¬¦ä¸²çš„èµ·å§‹ä½ç½®ï¼Œé»˜è®¤çš„èµ·å§‹ä½ç½®æ˜¯0å¯¼å…¥åº“ï¼Œregexæ˜¯reçš„å¢å¼ºç‰ˆï¼Œéœ€è¦pipå®‰è£…ï¼Œå®ƒæ”¯æŒæ›´å¼ºçš„æ­£åˆ™ï¼Œæ¯”å¦‚ä¸€ä¸ªè¡¨è¾¾å¼ä¸­å¯ä»¥å‡ºç°ä¸¤ä¸ªä¸€æ ·çš„æ•è·ç»„åå­—12from typing import Iterable, Listimport regex as reåŒ…è£…matchå¯¹è±¡ä¸ºReMatchç±»1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495class ReMatch:    def __init__(self, match, start: int = 0):        &quot;&quot;&quot;        æŒ‡å®šèµ·å§‹ä½ç½®çš„Matchç±»        :param match: re.Matchå¯¹è±¡        :param start:        &quot;&quot;&quot;        self.match = match        self.start_idx = start    @property    def endpos(self):        &quot;&quot;&quot; æœ¬æ¬¡æœç´¢ç»“æŸä½ç½®ç´¢å¼• &quot;&quot;&quot;        return self.match.endpos + self.start_idx    @property    def lastgroup(self):        &quot;&quot;&quot; æœ¬æ¬¡æœç´¢åŒ¹é…åˆ°çš„æœ€åä¸€ä¸ªåˆ†ç»„çš„åˆ«å &quot;&quot;&quot;        return self.match.lastgroup    @property    def lastindex(self):        &quot;&quot;&quot; æœ¬æ¬¡æœç´¢åŒ¹é…åˆ°çš„æœ€åä¸€ä¸ªåˆ†ç»„çš„ç´¢å¼• &quot;&quot;&quot;        return self.match.lastindex + self.start_idx if type(self.match.lastindex) == int else self.match.lastindex    @property    def pos(self):        &quot;&quot;&quot; æœ¬æ¬¡æœç´¢å¼€å§‹ä½ç½®ç´¢å¼• &quot;&quot;&quot;        return self.match.pos + self.start_idx    @property    def re(self):        &quot;&quot;&quot; æœ¬æ¬¡æœç´¢ä½¿ç”¨çš„SRE_Patternå¯¹è±¡ &quot;&quot;&quot;        return self.match.re    @property    def regs(self):        &quot;&quot;&quot; åˆ—è¡¨ï¼Œå…ƒç´ ä¸ºå…ƒç»„ï¼ŒåŒ…å«æœ¬æ¬¡æœç´¢åŒ¹é…åˆ°çš„æ‰€æœ‰åˆ†ç»„çš„èµ·æ­¢ä½ç½® &quot;&quot;&quot;        return tuple([(s + self.start_idx, e + self.start_idx) for s, e in self.match.regs])    def end(self, *args, **kwargs):        &quot;&quot;&quot; è¿”å›æŒ‡å®šåˆ†ç»„çš„ç»“æŸä½ç½®ï¼Œé»˜è®¤è¿”å›æ­£åˆ™è¡¨è¾¾å¼æ‰€åŒ¹é…åˆ°çš„æœ€åä¸€ä¸ªå­—ç¬¦çš„ç´¢å¼• &quot;&quot;&quot;        return self.match.end(*args, **kwargs) + self.start_idx    def expand(self, *args, **kwargs):        &quot;&quot;&quot; æ ¹æ®æ¨¡ç‰ˆè¿”å›ç›¸åº”çš„å­—ç¬¦ä¸²ï¼Œç±»ä¼¼ä¸ sub å‡½æ•°é‡Œé¢çš„ replï¼Œ å¯ä½¿ç”¨ \1 æˆ–è€… \g æ¥é€‰æ‹©åˆ†ç»„ &quot;&quot;&quot;        return self.match.expand(*args, **kwargs)    def group(self, *args, **kwargs):        &quot;&quot;&quot; æ ¹æ®æä¾›çš„ç´¢å¼•æˆ–åå­—è¿”å›å“åº”åˆ†ç»„çš„å†…å®¹ï¼Œé»˜è®¤è¿”å› start() åˆ° end() ä¹‹é—´çš„å­—ç¬¦ä¸²ï¼Œ æä¾›å¤šä¸ªå‚æ•°å°†è¿”å›ä¸€ä¸ªå…ƒç»„ &quot;&quot;&quot;        return self.match.group(*args, **kwargs)    def groupdict(self, *args, **kwargs):        &quot;&quot;&quot; è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰åŒ¹é…åˆ°çš„å‘½ååˆ†ç»„çš„å­—å…¸ï¼Œæ²¡æœ‰å‘½åçš„åˆ†ç»„ä¸åŒ…å«åœ¨å†…ï¼Œkey ä¸ºç»„åï¼Œ value ä¸ºåŒ¹é…åˆ°çš„å†…å®¹ï¼Œå‚æ•° default ä¸ºæ²¡æœ‰å‚ä¸æœ¬æ¬¡åŒ¹é…çš„å‘½ååˆ†ç»„æä¾›é»˜è®¤å€¼ &quot;&quot;&quot;        return self.match.groupdict(*args, **kwargs)    def _build_key_2_index(self):        groups = self.match.groups()        group_2_index = []        for idx, group in enumerate(groups, start=1):            group_2_index.append((group, self.match.start(idx)+self.start_idx, self.match.end(idx)+self.start_idx))        return group_2_index    def groupdict_with_index(self, *args, **kwargs):        &quot;&quot;&quot; åŒgroupdict, ä½†åŒ¹é…ç»“æœåŒ…è£…ä¸ºå¸¦ç´¢å¼•çš„ContentWithIndexå¯¹è±¡ &quot;&quot;&quot;        value = self.match.groupdict(*args, **kwargs)        new_group_dict = dict()        for k, v in value.items():            for group, s, e in self._build_key_2_index():                if v == group:                    new_group_dict[k] = ContentWithIndex(content=v, start=s, end=e)        assert len(new_group_dict) == len(value)        return new_group_dict    def groups(self, *args, **kwargs):        &quot;&quot;&quot; ä»¥å…ƒç»„å½¢å¼è¿”å›æ¯ä¸€ä¸ªåˆ†ç»„åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²ï¼ŒåŒ…æ‹¬æ²¡æœ‰å‚ä¸åŒ¹é…çš„åˆ†ç»„ï¼Œå…¶å€¼ä¸º default &quot;&quot;&quot;        return self.match.groups(*args, **kwargs)    def span(self, *args, **kwargs):        &quot;&quot;&quot; è¿”å›æŒ‡å®šåˆ†ç»„çš„èµ·æ­¢ä½ç½®ç»„æˆçš„å…ƒç»„ï¼Œé»˜è®¤è¿”å›ç”± start() å’Œ end() ç»„æˆçš„å…ƒç»„ &quot;&quot;&quot;        return tuple([(s + self.start_idx, e + self.start_idx) for s, e in self.match.span(*args, **kwargs)])    def start(self, *args, **kwargs):        &quot;&quot;&quot; è¿”å›æŒ‡å®šåˆ†ç»„çš„å¼€å§‹ä½ç½®ï¼Œé»˜è®¤è¿”å›æ­£åˆ™è¡¨è¾¾å¼æ‰€åŒ¹é…åˆ°çš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ç´¢å¼• &quot;&quot;&quot;        return self.match.start(*args, **kwargs) + self.start_idx    def start_and_end(self):        return self.start(), self.end()    def __str__(self):        return self.__repr__()    def __repr__(self):        return f&quot;&lt;regex.Match object; span=({self.start()}, {self.end()}), match='{self.match.group()}'&gt;&quot;åŒ¹é…ç»“æœç±»ContentWithIndexï¼šä¸»è¦æ˜¯ç»Ÿä¸€åƒsplitè¿™æ ·çš„æ–¹æ³•è¿”å›çš„ç»“æœ12345678910111213141516171819202122232425262728class ContentWithIndex:    def __init__(self, content: str, start: int, end: int):        &quot;&quot;&quot;        å¸¦ç´¢å¼•çš„åˆ‡åˆ†ç»“æœ        :param content: åˆ‡åˆ†ç»“æœ        :param start: èµ·å§‹ä½ç½®        :param end: ç»“æŸä½ç½®        &quot;&quot;&quot;        self.content = content        self.start = start        self.end = end    @property    def pos(self):        return self.start    @property    def posend(self):        return self.end    def start_and_end(self):        return self.start, self.end    def __str__(self):        return self.__repr__()    def __repr__(self):        return f&quot;{self.content} ({self.start}, {self.end})&quot;reåŒ…è£…çš„å·¥å…·ç±»ReUtils123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778class ReUtils:    def __init__(self):        &quot;&quot;&quot; æ­£åˆ™åŒ¹é…çš„å·¥å…·ç±» &quot;&quot;&quot;        pass    @staticmethod    def match(pattern, string, flags=0, start: int = 0):        match = re.match(pattern=pattern, string=string, flags=flags)        return ReMatch(match=match, start=start)    @staticmethod    def fullmatch(pattern, string, flags=0, start: int = 0):        match = re.fullmatch(pattern=pattern, string=string, flags=flags)        return ReMatch(match=match, start=start)    @staticmethod    def search(pattern, string, flags=0, start: int = 0):        match = re.search(pattern=pattern, string=string, flags=flags)        return ReMatch(match=match, start=start)    @staticmethod    def sub(pattern, repl, string, count=0, flags=0):        return re.sub(pattern=pattern, repl=repl, string=string, count=count, flags=flags)    @staticmethod    def subn(pattern, repl, string, count=0, flags=0):        return re.subn(pattern=pattern, repl=repl, string=string, count=count, flags=flags)    @staticmethod    def split(pattern, string, maxsplit=0, flags=0):        return re.split(pattern=pattern, string=string, maxsplit=maxsplit, flags=flags)    @staticmethod    def split_with_index(pattern, string, maxsplit: int = 0, flags=0, start: int = 0) -&gt; List[ContentWithIndex]:        &quot;&quot;&quot;        splitå¸¦å†…å®¹ç´¢å¼•        :param pattern:        :param string:        :param maxsplit:        :param flags:        :param start:        :return:        &quot;&quot;&quot;        matches = ReUtils.finditer(pattern, string, flags, start=start)  # ä½¿ç”¨re.finditer()è·å–åŒ¹é…çš„ä½ç½®å’Œå†…å®¹        content_with_indexs = []        start_idx = start        for match in matches:            end_idx = match.start()  # å½“å‰åˆ†éš”ç¬¦çš„èµ·å§‹ä½ç½®            content_with_index = ContentWithIndex(content=string[start_idx - start:end_idx - start], start=start_idx,                                                  end=end_idx)            content_with_indexs.append(content_with_index)  # æ·»åŠ åˆ†éš”ç¬¦ä¹‹å‰çš„æ–‡æœ¬åŠå…¶ä½ç½®ä¿¡æ¯            start_idx = match.end()  # æ›´æ–°ä¸‹ä¸€ä¸ªåˆ†éš”ç¬¦çš„èµ·å§‹ä½ç½®            if maxsplit and len(content_with_indexs) &gt;= maxsplit:                content_with_index = ContentWithIndex(content=string[start_idx - start:], start=start_idx,                                                      end=len(string))                content_with_indexs.append(content_with_index)  # æ·»åŠ åˆ†éš”ç¬¦ä¹‹å‰çš„æ–‡æœ¬åŠå…¶ä½ç½®ä¿¡æ¯                break        else:            # æ·»åŠ æœ€åä¸€ä¸ªåˆ†éš”ç¬¦ä¹‹åçš„æ–‡æœ¬            content_with_index = ContentWithIndex(content=string[start_idx - start:], start=start_idx,                                                  end=len(string) + start)            content_with_indexs.append(content_with_index)        # if maxsplit and len(content_with_indexs) &lt; maxsplit + 1 and start_idx &lt; len(string):        #     # æ·»åŠ æœ€åä¸€ä¸ªåˆ†éš”ç¬¦ä¹‹åçš„æ–‡æœ¬        #     content_with_index = ContentWithIndex(content=string[start_idx-start:], start=start_idx, end=len(string))        #     content_with_indexs.append(content_with_index)        return content_with_indexs    @staticmethod    def findall(pattern, string, flags=0):        return re.findall(pattern=pattern, string=string, flags=flags)    @staticmethod    def finditer(pattern, string, flags=0, start: int = 0) -&gt; Iterable[ReMatch]:        for match in re.finditer(pattern=pattern, string=string, flags=flags):            yield ReMatch(match=match, start=start)</content>
	</entry>
	<entry>
		<title>pythonè£…é¥°å™¨</title>
		<url>/article/45122.html</url>
		<content>å‡½æ•°åŸºç¡€å‡½æ•°å®šä¹‰åœ¨ Python ä¸­ï¼Œå‡½æ•°æ˜¯ä¸€ç­‰å¯¹è±¡ï¼Œç¼–ç¨‹è¯­è¨€ç†è®ºå®¶æŠŠâ€œä¸€ç­‰å¯¹è±¡â€å®šä¹‰ä¸ºæ»¡è¶³ä¸‹è¿°æ¡ä»¶çš„ç¨‹åºå®ä½“ï¼šåœ¨è¿è¡Œæ—¶åˆ›å»ºèƒ½èµ‹å€¼ç»™å˜é‡æˆ–æ•°æ®ç»“æ„ä¸­çš„å…ƒç´ èƒ½ä½œä¸ºå‚æ•°ä¼ ç»™å‡½æ•°èƒ½ä½œä¸ºå‡½æ•°çš„è¿”å›ç»“æœæœ‰äº†ä¸€ç­‰å‡½æ•°ï¼Œå°±å¯ä»¥ä½¿ç”¨å‡½æ•°å¼é£æ ¼ç¼–ç¨‹ã€‚å‡½æ•°å¼ç¼–ç¨‹çš„ç‰¹ç‚¹ä¹‹ä¸€æ˜¯ä½¿ç”¨é«˜é˜¶å‡½æ•°â€”â€”æ¥å—å‡½æ•°ä¸ºå‚æ•°ï¼Œæˆ–è€…æŠŠå‡½æ•°ä½œä¸ºç»“æœè¿”å›çš„å‡½æ•°æ˜¯é«˜é˜¶å‡½æ•°ï¼ˆhigher-order functionï¼‰ã€‚åœ¨å‡½æ•°å¼ç¼–ç¨‹èŒƒå¼ä¸­ï¼Œæœ€ä¸ºäººç†ŸçŸ¥çš„é«˜é˜¶å‡½æ•°æœ‰ mapã€filterã€reduce å’Œ applyã€‚åœ¨ Python 3 ä¸­ï¼Œmap å’Œ filter è¿˜æ˜¯å†…ç½®å‡½æ•°ï¼Œä½†æ˜¯ç”±äºå¼•å…¥äº†åˆ—è¡¨æ¨å¯¼å’Œç”Ÿæˆå™¨è¡¨è¾¾å¼ï¼Œå®ƒä»¬å˜å¾—æ²¡é‚£ä¹ˆé‡è¦äº†ã€‚sum å’Œ reduce çš„é€šç”¨æ€æƒ³æ˜¯æŠŠæŸä¸ªæ“ä½œè¿ç»­åº”ç”¨åˆ°åºåˆ—çš„å…ƒç´ ä¸Šï¼Œç´¯è®¡ä¹‹å‰çš„ç»“æœï¼ŒæŠŠä¸€ç³»åˆ—å€¼å½’çº¦æˆä¸€ä¸ªå€¼ã€‚all å’Œ any ä¹Ÿæ˜¯å†…ç½®çš„å½’çº¦å‡½æ•°ã€‚all(iterable): å¦‚æœ iterable çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯çœŸå€¼ï¼Œè¿”å› Trueï¼›all([]) è¿”å› Trueã€‚any(iterable): åªè¦ iterable ä¸­æœ‰å…ƒç´ æ˜¯çœŸå€¼ï¼Œå°±è¿”å› Trueï¼›any([]) è¿”å› Falseã€‚lambda å…³é”®å­—åœ¨ Python è¡¨è¾¾å¼å†…åˆ›å»ºåŒ¿åå‡½æ•°ã€‚lambda å‡½æ•°çš„å®šä¹‰ä½“ä¸­ä¸èƒ½èµ‹å€¼ï¼Œä¹Ÿä¸èƒ½ä½¿ç”¨ while å’Œ try ç­‰ Python è¯­å¥ã€‚lambda å¥æ³•åªæ˜¯è¯­æ³•ç³–ï¼šä¸ def è¯­å¥ä¸€æ ·ï¼Œlambda è¡¨è¾¾å¼ä¼šåˆ›å»ºå‡½æ•°å¯¹è±¡ã€‚å‡½æ•°å’Œæ–¹æ³•ä»å‡ ä¸ªç»´åº¦æ¥ä»‹ç»ä¸‹pythonä¸­å‡½æ•°å’Œæ–¹æ³•çš„åŒºåˆ«ï¼šåˆ†ç±»è§’åº¦åˆ†æ(1) å‡½æ•°çš„åˆ†ç±»ï¼šå†…ç½®å‡½æ•°ï¼špythonå†…åµŒçš„ä¸€äº›å‡½æ•°ã€‚åŒ¿åå‡½æ•°ï¼šä¸€è¡Œä»£ç å®ç°ä¸€ä¸ªå‡½æ•°åŠŸèƒ½ã€‚é€’å½’å‡½æ•°è‡ªå®šä¹‰å‡½æ•°ï¼šæ ¹æ®è‡ªå·±çš„éœ€æ±‚ï¼Œæ¥è¿›è¡Œå®šä¹‰å‡½æ•°ã€‚(2) æ–¹æ³•çš„åˆ†ç±»ï¼šæ™®é€šæ–¹æ³•ï¼šç›´æ¥ç”¨selfè°ƒç”¨çš„æ–¹æ³•ã€‚ç§æœ‰æ–¹æ³•ï¼š__å‡½æ•°åï¼Œåªèƒ½åœ¨ç±»ä¸­è¢«è°ƒç”¨çš„æ–¹æ³•ã€‚å±æ€§æ–¹æ³•ï¼š@propertyï¼Œå°†æ–¹æ³•ä¼ªè£…æˆä¸ºå±æ€§ï¼Œè®©ä»£ç çœ‹èµ·æ¥æ›´åˆç†ã€‚ç‰¹æ®Šæ–¹æ³•(åŒä¸‹åˆ’çº¿æ–¹æ³•)ï¼šä»¥__init__ä¸ºä¾‹ï¼Œæ˜¯ç”¨æ¥å°è£…å®ä¾‹åŒ–å¯¹è±¡çš„å±æ€§ï¼Œåªè¦æ˜¯å®ä¾‹åŒ–å¯¹è±¡å°±ä¸€å®šä¼šæ‰§è¡Œ__init__æ–¹æ³•ï¼Œå¦‚æœå¯¹è±¡å­ç±»ä¸­æ²¡æœ‰åˆ™ä¼šå¯»æ‰¾çˆ¶ç±»ï¼ˆè¶…ç±»ï¼‰ï¼Œå¦‚æœçˆ¶ç±»ï¼ˆè¶…ç±»ï¼‰ä¹Ÿæ²¡æœ‰ï¼Œåˆ™ç›´æ¥ç»§æ‰¿object(python 3.x)ç±»ï¼Œæ‰§è¡Œç±»ä¸­çš„__init__æ–¹æ³•ã€‚ç±»æ–¹æ³•ï¼šé€šè¿‡ç±»åçš„è°ƒç”¨å»æ“ä½œå…¬å…±æ¨¡æ¿ä¸­çš„å±æ€§å’Œæ–¹æ³•ã€‚é™æ€æ–¹æ³•ï¼šä¸ç”¨ä¼ å…¥ç±»ç©ºé—´ã€å¯¹è±¡çš„æ–¹æ³•ï¼Œ ä½œç”¨æ˜¯ä¿è¯ä»£ç çš„ä¸€è‡´æ€§ï¼Œè§„èŒƒæ€§ï¼Œå¯ä»¥å®Œå…¨ç‹¬ç«‹ç±»å¤–çš„ä¸€ä¸ªæ–¹æ³•ï¼Œä½†æ˜¯ä¸ºäº†ä»£ç çš„ä¸€è‡´æ€§ç»Ÿä¸€çš„æ”¾åˆ°æŸä¸ªæ¨¡å—(pyæ–‡ä»¶)ä¸­ã€‚ä½œç”¨åŸŸè§’åº¦åˆ†æ(1) å‡½æ•°ä½œç”¨åŸŸï¼šä»å‡½æ•°è°ƒç”¨å¼€å§‹è‡³å‡½æ•°æ‰§è¡Œå®Œæˆï¼Œè¿”å›ç»™è°ƒç”¨è€…åï¼Œåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å¼€è¾Ÿçš„ç©ºé—´ä¼šè‡ªåŠ¨é‡Šæ”¾ï¼Œä¹Ÿå°±æ˜¯è¯´å‡½æ•°æ‰§è¡Œå®Œæˆåï¼Œå‡½æ•°ä½“å†…éƒ¨é€šè¿‡èµ‹å€¼ç­‰æ–¹å¼ä¿®æ”¹å˜é‡çš„å€¼ä¸ä¼šä¿ç•™ï¼Œä¼šéšç€è¿”å›ç»™è°ƒç”¨è€…åï¼Œå¼€è¾Ÿçš„ç©ºé—´ä¼šè‡ªåŠ¨é‡Šæ”¾ã€‚(2) æ–¹æ³•ä½œç”¨åŸŸï¼šé€šè¿‡å®ä¾‹åŒ–çš„å¯¹è±¡è¿›è¡Œæ–¹æ³•çš„è°ƒç”¨ï¼Œè°ƒç”¨åå¼€è¾Ÿçš„ç©ºé—´ä¸ä¼šé‡Šæ”¾ï¼Œä¹Ÿå°±æ˜¯è¯´è°ƒç”¨æ–¹æ³•ä¸­å¯¹å˜é‡çš„ä¿®æ”¹å€¼ä¼šä¸€ç›´ä¿ç•™ã€‚è°ƒç”¨æ–¹å¼åˆ†æ(1) å‡½æ•°ï¼šé€šè¿‡å‡½æ•°å()çš„æ–¹å¼è¿›è¡Œè°ƒç”¨ã€‚(2) æ–¹æ³•ï¼šé€šè¿‡å¯¹è±¡.æ–¹æ³•å()çš„æ–¹å¼è¿›è¡Œè°ƒç”¨ã€‚123456789101112class Foo(object):    def func(self):        pass#å®ä¾‹åŒ–obj = Foo()# æ‰§è¡Œæ–¹å¼ä¸€:è°ƒç”¨çš„funcæ˜¯æ–¹æ³•obj.func() #func æ–¹æ³•# æ‰§è¡Œæ–¹å¼äºŒï¼šè°ƒç”¨çš„funcæ˜¯å‡½æ•°Foo.func(123) # å‡½æ•°å¯è°ƒç”¨å¯¹è±¡é™¤äº†ç”¨æˆ·å®šä¹‰çš„å‡½æ•°ï¼Œè°ƒç”¨è¿ç®—ç¬¦ï¼ˆå³ ()ï¼‰è¿˜å¯ä»¥åº”ç”¨åˆ°å…¶ä»–å¯¹è±¡ä¸Šã€‚å¦‚æœæƒ³åˆ¤æ–­å¯¹è±¡èƒ½å¦è°ƒç”¨ï¼Œå¯ä»¥ä½¿ç”¨å†…ç½®çš„ callable() å‡½æ•°ã€‚å¦‚æœç±»å®šä¹‰äº† __call__ æ–¹æ³•ï¼Œé‚£ä¹ˆå®ƒçš„å®ä¾‹å¯ä»¥ä½œä¸ºå‡½æ•°è°ƒç”¨ã€‚åˆ¤æ–­å¯¹è±¡èƒ½å¦è°ƒç”¨ï¼Œæœ€å®‰å…¨çš„æ–¹æ³•æ˜¯ä½¿ç”¨å†…ç½®çš„ callable() å‡½æ•°ä»»ä½• Python å¯¹è±¡éƒ½å¯ä»¥è¡¨ç°å¾—åƒå‡½æ•°ã€‚ä¸ºæ­¤ï¼Œåªéœ€å®ç°å®ä¾‹æ–¹æ³• __call__ã€‚å‡½æ•°å†…çœé™¤äº† __doc__ï¼Œå‡½æ•°å¯¹è±¡è¿˜æœ‰å¾ˆå¤šå±æ€§ã€‚ä½¿ç”¨ dir å‡½æ•°å¯ä»¥æ¢çŸ¥ factorial å…·æœ‰ä¸‹è¿°å±æ€§ï¼š123456789&gt;&gt;&gt; dir(factorial)['__annotations__', '__call__', '__class__', '__closure__', '__code__','__defaults__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__','__format__', '__ge__', '__get__', '__getattribute__', '__globals__','__gt__', '__hash__', '__init__', '__kwdefaults__', '__le__', '__lt__','__module__', '__name__', '__ne__', '__new__', '__qualname__', '__reduce__','__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__','__subclasshook__']&gt;&gt;&gt;ç”¨æˆ·å®šä¹‰çš„å‡½æ•°çš„å±æ€§åç§°ç±»å‹è¯´æ˜__annotations__dictå‚æ•°å’Œè¿”å›å€¼çš„æ³¨è§£__call__method-wrapperå®ç° () è¿ç®—ç¬¦ï¼›å³å¯è°ƒç”¨å¯¹è±¡åè®®__closure__tupleå‡½æ•°é—­åŒ…ï¼Œå³è‡ªç”±å˜é‡çš„ç»‘å®šï¼ˆé€šå¸¸æ˜¯ Noneï¼‰__code__codeç¼–è¯‘æˆå­—èŠ‚ç çš„å‡½æ•°å…ƒæ•°æ®å’Œå‡½æ•°å®šä¹‰ä½“__defaults__tupleå½¢å¼å‚æ•°çš„é»˜è®¤å€¼__get__method-wrapperå®ç°åªè¯»æè¿°ç¬¦åè®®ï¼ˆå‚è§ç¬¬ 20 ç« ï¼‰__globals__dictå‡½æ•°æ‰€åœ¨æ¨¡å—ä¸­çš„å…¨å±€å˜é‡__kwdefaults__dictä»…é™å…³é”®å­—å½¢å¼å‚æ•°çš„é»˜è®¤å€¼__name__strå‡½æ•°åç§°__qualname__strå‡½æ•°çš„é™å®šåç§°ï¼Œå¦‚ Random.choiceï¼ˆ å‚é˜…PEP 3155ï¼‰ __defaults__ã€__code__ å’Œ __annotations__ å±æ€§ï¼ŒIDE å’Œæ¡†æ¶ä½¿ç”¨å®ƒä»¬æå–å…³äºå‡½æ•°ç­¾åçš„ä¿¡æ¯ã€‚å‚æ•°ä¼ é€’argsã€*kwargsç”¨æ³•1234567891011121314# *argsæ˜¯ç”¨æ¥å‘é€ä¸€ä¸ªéé”®å€¼å¯¹çš„å¯å˜æ•°é‡çš„å‚æ•°åˆ—è¡¨ç»™ä¸€ä¸ªå‡½æ•°def test_var_args(f_arg, *argv):    print(&quot;first normal arg:&quot;, f_arg)    for arg in argv:        print(&quot;another arg through *argv:&quot;, arg)test_var_args('yasoob', 'python', 'eggs', 'test')first normal arg: yasoobanother arg through *argv: pythonanother arg through *argv: eggsanother arg through *argv: test12345678910# ** kwargså…è®¸æ‚¨å°†keywordedå¯å˜é•¿åº¦çš„å‚æ•°ä¼ é€’ç»™å‡½æ•°ã€‚å¦‚æœè¦åœ¨å‡½æ•°ä¸­å¤„ç†å‘½åå‚æ•°ï¼Œåˆ™åº”ä½¿ç”¨** kwargs def greet_me(**kwargs):    for key, value in kwargs.items():        print(&quot;{0} = {1}&quot;.format(key, value))# å¿…é¡»å«æœ‰keygreet_me(name=&quot;yasoob&quot;,age=&quot;19&quot;,sex=&quot;girl&quot;)name = yasoobage = 19sex = girlargsã€*kwargsç”¨æ³•1234567891011121314151617181920212223def foo(*args, **kwargs):    print('args = ', args)    print('kwargs = ', kwargs)    print('---------------------------------------')if __name__ == '__main__':    foo(1,2,3,4)    foo(a=1,b=2,c=3)    foo(1,2,3,4, a=1,b=2,c=3)    foo('a', 1, None, a=1, b='2', c=3)    args =  (1, 2, 3, 4)kwargs =  {}---------------------------------------args =  ()kwargs =  {'a': 1, 'b': 2, 'c': 3}---------------------------------------args =  (1, 2, 3, 4)kwargs =  {'a': 1, 'b': 2, 'c': 3}---------------------------------------args =  ('a', 1, None)kwargs =  {'a': 1, 'b': '2', 'c': 3}---------------------------------------*args`è¡¨ç¤ºä»»ä½•å¤šä¸ªæ— åå‚æ•°ï¼Œå®ƒæ˜¯ä¸€ä¸ªtuple**kwargsè¡¨ç¤ºå…³é”®å­—å‚æ•°ï¼Œå®ƒæ˜¯ä¸€ä¸ªdictåŒæ—¶ä½¿ç”¨*argså’Œ**kwargsæ—¶ï¼Œå¿…é¡»*argså‚æ•°åˆ—è¦åœ¨**kwargså‰æœ‰é™ä¸ªå‚æ•°12345678910111213141516# -*- coding: UTF-8 -*- def log(func):    def wrapper(a,b):        print(&quot;call test(%dï¼Œ%d)&quot; %(a,b))        return func(a,b)    return wrapper@logdef test(a,b):    print(&quot;sum = %d&quot; % (a+b))    test(2,4)call test(2ï¼Œ4)sum = 6å¯å˜å‚æ•°12345678910111213141516# å½“è£…é¥°å™¨ä¸çŸ¥é“ä¸šåŠ¡å‡½æ•°åˆ°åº•æœ‰å¤šå°‘ä¸ªå‚æ•°æ—¶ï¼Œç”¨*args æ¥ä»£æ›¿def log(func):    def wrapper(*args):        print(&quot;call test()&quot; )        return func(*args)    return wrapper@logdef test(a,b,c):    print(&quot;sum = %d&quot; % (a+b+c))test(2,4,5)call test()sum = 11å‡½æ•°æ³¨è§£å‡½æ•°å£°æ˜ä¸­çš„å„ä¸ªå‚æ•°å¯ä»¥åœ¨ : ä¹‹åå¢åŠ æ³¨è§£è¡¨è¾¾å¼ã€‚å¦‚æœå‚æ•°æœ‰é»˜è®¤å€¼ï¼Œæ³¨è§£æ”¾åœ¨å‚æ•°åå’Œ = å·ä¹‹é—´ã€‚å¦‚æœæƒ³æ³¨è§£è¿”å›å€¼ï¼Œåœ¨ ) å’Œå‡½æ•°å£°æ˜æœ«å°¾çš„ : ä¹‹é—´æ·»åŠ  -&gt; å’Œä¸€ä¸ªè¡¨è¾¾å¼ã€‚1234567&gt;from typing import List&gt;def func(num: int = 0, type: str = 'default') -&gt; List[int]:return [num, num]&gt;func(num=2)&gt;Out[3]: [2, 2]æ³¨è§£ä¸ä¼šåšä»»ä½•å¤„ç†ï¼Œåªæ˜¯å­˜å‚¨åœ¨å‡½æ•°çš„ __annotations__ å±æ€§ï¼ˆä¸€ä¸ªå­—å…¸ï¼‰Python å¯¹æ³¨è§£æ‰€åšçš„å”¯ä¸€çš„äº‹æƒ…æ˜¯ï¼ŒæŠŠå®ƒä»¬å­˜å‚¨åœ¨å‡½æ•°çš„ __annotations__ å±æ€§é‡Œã€‚ä»…æ­¤è€Œå·²ï¼ŒPython ä¸åšæ£€æŸ¥ã€ä¸åšå¼ºåˆ¶ã€ä¸åšéªŒè¯ï¼Œä»€ä¹ˆæ“ä½œéƒ½ä¸åšã€‚æ¢å¥è¯è¯´ï¼Œæ³¨è§£å¯¹ Python è§£é‡Šå™¨æ²¡æœ‰ä»»ä½•æ„ä¹‰ã€‚æ³¨è§£åªæ˜¯å…ƒæ•°æ®ï¼Œå¯ä»¥ä¾› IDEã€æ¡†æ¶å’Œè£…é¥°å™¨ç­‰å·¥å…·ä½¿ç”¨ã€‚æ ‡å‡†åº“ä¸­è¿˜æ²¡æœ‰ä»€ä¹ˆä¼šç”¨åˆ°è¿™äº›å…ƒæ•°æ®ï¼Œå”¯æœ‰ inspect.signature() å‡½æ•°çŸ¥é“æ€ä¹ˆæå–æ³¨è§£signature å‡½æ•°è¿”å›ä¸€ä¸ª Signature å¯¹è±¡ï¼Œå®ƒæœ‰ä¸€ä¸ª return_annotation å±æ€§å’Œä¸€ä¸ª parameters å±æ€§ï¼Œåè€…æ˜¯ä¸€ä¸ªå­—å…¸ï¼ŒæŠŠå‚æ•°åæ˜ å°„åˆ° Parameter å¯¹è±¡ä¸Šã€‚æ¯ä¸ª Parameter å¯¹è±¡è‡ªå·±ä¹Ÿæœ‰ annotation å±æ€§inspect.signature å‡½æ•°è¿”å›ä¸€ä¸ª inspect.Signature å¯¹è±¡ï¼Œå®ƒæœ‰ä¸€ä¸ª parameters å±æ€§ï¼Œè¿™æ˜¯ä¸€ä¸ªæœ‰åºæ˜ å°„ï¼ŒæŠŠå‚æ•°åå’Œ inspect.Parameter å¯¹è±¡å¯¹åº”èµ·æ¥ã€‚å„ä¸ª Parameter å±æ€§ä¹Ÿæœ‰è‡ªå·±çš„å±æ€§ï¼Œä¾‹å¦‚ name ã€ default å’Œ kind ã€‚ç‰¹æ®Šçš„ inspect._empty å€¼è¡¨ç¤ºæ²¡æœ‰é»˜è®¤å€¼ï¼Œè€ƒè™‘åˆ° None æ˜¯æœ‰æ•ˆçš„é»˜è®¤å€¼ï¼ˆä¹Ÿç»å¸¸è¿™ä¹ˆåšï¼‰ï¼Œè€Œä¸”è¿™ä¹ˆåšæ˜¯åˆç†çš„ã€‚kind å±æ€§çš„å€¼æ˜¯ _ParameterKind ç±»ä¸­çš„ 5 ä¸ªå€¼ä¹‹ä¸€ï¼Œåˆ—ä¸¾å¦‚ä¸‹ã€‚12345678910POSITIONAL_OR_KEYWORDå¯ä»¥é€šè¿‡å®šä½å‚æ•°å’Œå…³é”®å­—å‚æ•°ä¼ å…¥çš„å½¢å‚ï¼ˆå¤šæ•° Python å‡½æ•°çš„å‚æ•°å±äºæ­¤ç±»ï¼‰ã€‚VAR_POSITIONALå®šä½å‚æ•°å…ƒç»„ã€‚VAR_KEYWORDå…³é”®å­—å‚æ•°å­—å…¸ã€‚KEYWORD_ONLYä»…é™å…³é”®å­—å‚æ•°ï¼ˆPython 3 æ–°å¢ï¼‰ã€‚POSITIONAL_ONLYä»…é™å®šä½å‚æ•°ï¼›ç›®å‰ï¼ŒPython å£°æ˜å‡½æ•°çš„å¥æ³•ä¸æ”¯æŒï¼Œä½†æ˜¯æœ‰äº›ä½¿ç”¨ C è¯­è¨€å®ç°ä¸”ä¸æ¥å—å…³é”®å­—å‚æ•°çš„å‡½æ•°ï¼ˆå¦‚ divmod ï¼‰æ”¯æŒã€‚é™¤äº† name ã€ default å’Œ kind ï¼Œ inspect.Parameter å¯¹è±¡è¿˜æœ‰ä¸€ä¸ª annotation ï¼ˆæ³¨è§£ï¼‰å±æ€§ï¼Œå®ƒçš„å€¼é€šå¸¸æ˜¯ inspect._emptyinspect.Signature å¯¹è±¡æœ‰ä¸ª bind æ–¹æ³•ï¼Œå®ƒå¯ä»¥æŠŠä»»æ„ä¸ªå‚æ•°ç»‘å®šåˆ°ç­¾åä¸­çš„å½¢å‚ä¸Šï¼Œæ‰€ç”¨çš„è§„åˆ™ä¸å®å‚åˆ°å½¢å‚çš„åŒ¹é…æ–¹å¼ä¸€æ ·ã€‚å‡½æ•°å¼ç¼–ç¨‹åŒ…operatoræ¨¡å—Python çš„ç›®æ ‡ä¸æ˜¯å˜æˆå‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ï¼Œä½†æ˜¯å¾—ç›Šäº operator å’Œ functools ç­‰åŒ…çš„æ”¯æŒï¼Œå‡½æ•°å¼ç¼–ç¨‹é£æ ¼ä¹Ÿå¯ä»¥ä¿¡æ‰‹æ‹ˆæ¥ã€‚reduceåœ¨å‡½æ•°å¼ç¼–ç¨‹ä¸­ï¼Œç»å¸¸éœ€è¦æŠŠç®—æœ¯è¿ç®—ç¬¦å½“ä½œå‡½æ•°ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼Œä¸ä½¿ç”¨é€’å½’è®¡ç®—é˜¶ä¹˜ã€‚æ±‚å’Œå¯ä»¥ä½¿ç”¨ sum å‡½æ•°ï¼Œä½†æ˜¯æ±‚ç§¯åˆ™æ²¡æœ‰è¿™æ ·çš„å‡½æ•°ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ reduceoperator æ¨¡å—ä¸ºå¤šä¸ªç®—æœ¯è¿ç®—ç¬¦æä¾›äº†å¯¹åº”çš„å‡½æ•°ï¼Œä»è€Œé¿å…ç¼–å†™ lambda a, b: a*b è¿™ç§å¹³å‡¡çš„åŒ¿åå‡½æ•°12345&gt;from functools import reduce&gt;from operator import mul&gt;def fact(n):       return reduce(mul, range(1, n+1))operator æ¨¡å—ä¸­è¿˜æœ‰ä¸€ç±»å‡½æ•°ï¼Œèƒ½æ›¿ä»£ä»åºåˆ—ä¸­å–å‡ºå…ƒç´ æˆ–è¯»å–å¯¹è±¡å±æ€§çš„ lambda è¡¨è¾¾å¼ï¼šå› æ­¤ï¼Œitemgetter å’Œ attrgetter å…¶å®ä¼šè‡ªè¡Œæ„å»ºå‡½æ•°ã€‚itemgetteritemgetter çš„å¸¸è§ç”¨é€”ï¼šæ ¹æ®å…ƒç»„çš„æŸä¸ªå­—æ®µç»™å…ƒç»„åˆ—è¡¨æ’åºã€‚itemgetter(1) çš„ä½œç”¨ä¸ lambda fields: fields[1] ä¸€æ ·ï¼šåˆ›å»ºä¸€ä¸ªæ¥å—é›†åˆçš„å‡½æ•°ï¼Œè¿”å›ç´¢å¼•ä½ 1 ä¸Šçš„å…ƒç´ ã€‚123456789101112131415161718192021&gt;&gt;&gt;&gt; metro_data = [&gt;...     ('Tokyo', 'JP', 36.933, (35.689722, 139.691667)),&gt;...     ('Delhi NCR', 'IN', 21.935, (28.613889, 77.208889)),&gt;...     ('Mexico City', 'MX', 20.142, (19.433333, -99.133333)),&gt;...     ('New York-Newark', 'US', 20.104, (40.808611, -74.020386)),&gt;...     ('Sao Paulo', 'BR', 19.649, (-23.547778, -46.635833)),&gt;... ]&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; from operator import itemgetter&gt;&gt;&gt;&gt; for city in sorted(metro_data, key=itemgetter(1)):&gt;...     print(city)&gt;...&gt;('Sao Paulo', 'BR', 19.649, (-23.547778, -46.635833))&gt;('Delhi NCR', 'IN', 21.935, (28.613889, 77.208889))&gt;('Tokyo', 'JP', 36.933, (35.689722, 139.691667))&gt;('Mexico City', 'MX', 20.142, (19.433333, -99.133333))&gt;('New York-Newark', 'US', 20.104, (40.808611, -74.020386))&gt;d = {&quot;a&quot;:1,&quot;b&quot;:2,&quot;c&quot;:3}&gt;itemgetter(&quot;a&quot;,'b')(d)&gt;Out[67]: (1, 2)attrgetterattrgetter ä¸ itemgetter ä½œç”¨ç±»ä¼¼ï¼Œå®ƒåˆ›å»ºçš„å‡½æ•°æ ¹æ®åç§°æå–å¯¹è±¡çš„å±æ€§ã€‚å¦‚æœæŠŠå¤šä¸ªå±æ€§åä¼ ç»™ attrgetterï¼Œå®ƒä¹Ÿä¼šè¿”å›æå–çš„å€¼æ„æˆçš„å…ƒç»„ã€‚12&gt;&gt;&gt;&gt; for city in sorted(metro_areas, key=attrgetter('coord.lat')):&gt;...     print(name_lat(city))methodcallermethodcallerã€‚å®ƒçš„ä½œç”¨ä¸ attrgetter å’Œ itemgetter ç±»ä¼¼ï¼Œå®ƒä¼šè‡ªè¡Œåˆ›å»ºå‡½æ•°ã€‚methodcaller åˆ›å»ºçš„å‡½æ•°ä¼šåœ¨å¯¹è±¡ä¸Šè°ƒç”¨å‚æ•°æŒ‡å®šçš„æ–¹æ³•12345678&gt;&gt;&gt;&gt; from operator import methodcaller&gt;&gt;&gt;&gt; s = 'The time has come'&gt;&gt;&gt;&gt; upcase = methodcaller('upper')&gt;&gt;&gt;&gt; upcase(s)&gt;'THE TIME HAS COME'&gt;&gt;&gt;&gt; hiphenate = methodcaller('replace', ' ', '-')&gt;&gt;&gt;&gt; hiphenate(s)&gt;'The-time-has-come'å…¶ä»–æ¨¡å—ä¸‹é¢æ˜¯ operator æ¨¡å—ä¸­å®šä¹‰çš„éƒ¨åˆ†å‡½æ•°ï¼ˆçœç•¥äº†ä»¥ _ å¼€å¤´çš„åç§°ï¼Œå› ä¸ºå®ƒä»¬åŸºæœ¬ä¸Šæ˜¯å®ç°ç»†èŠ‚ï¼‰ï¼šPython 3.5 ä¸­å¢åŠ äº† imatmul å’Œ matmulã€‚123456789&gt;&gt;&gt;&gt; [name for name in dir(operator) if not name.startswith('_')]&gt;['abs', 'add', 'and_', 'attrgetter', 'concat', 'contains',&gt;'countOf', 'delitem', 'eq', 'floordiv', 'ge', 'getitem', 'gt',&gt;'iadd', 'iand', 'iconcat', 'ifloordiv', 'ilshift', 'imod', 'imul',&gt;'index', 'indexOf', 'inv', 'invert', 'ior', 'ipow', 'irshift',&gt;'is_', 'is_not', 'isub', 'itemgetter', 'itruediv', 'ixor', 'le',&gt;'length_hint', 'lshift', 'lt', 'methodcaller', 'mod', 'mul', 'ne',&gt;'neg', 'not_', 'or_', 'pos', 'pow', 'rshift', 'setitem', 'sub',&gt;'truediv', 'truth', 'xor']è¿™ 52 ä¸ªåç§°ä¸­å¤§éƒ¨åˆ†çš„ä½œç”¨ä¸è¨€è€Œå–»ã€‚ä»¥ i å¼€å¤´ã€åé¢æ˜¯å¦ä¸€ä¸ªè¿ç®—ç¬¦çš„é‚£äº›åç§°ï¼ˆå¦‚ iaddã€iand ç­‰ï¼‰ï¼Œå¯¹åº”çš„æ˜¯å¢é‡èµ‹å€¼è¿ç®—ç¬¦ï¼ˆå¦‚ +=ã€&amp;= ç­‰ï¼‰ã€‚å¦‚æœç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¯å˜çš„ï¼Œé‚£ä¹ˆè¿™äº›è¿ç®—ç¬¦å‡½æ•°ä¼šå°±åœ°ä¿®æ”¹å®ƒï¼›å¦åˆ™ï¼Œä½œç”¨ä¸ä¸å¸¦ i çš„å‡½æ•°ä¸€æ ·ï¼Œç›´æ¥è¿”å›è¿ç®—ç»“æœä»¥ä¸‹è¡¨æ ¼æ˜¾ç¤ºäº†æŠ½è±¡è¿ç®—æ˜¯å¦‚ä½•å¯¹åº”äº Python è¯­æ³•ä¸­çš„è¿ç®—ç¬¦å’Œ operator æ¨¡å—ä¸­çš„å‡½æ•°çš„ã€‚è¿ç®—è¯­æ³•å‡½æ•°åŠ æ³•a + badd(a, b)å­—ç¬¦ä¸²æ‹¼æ¥seq1 + seq2concat(seq1, seq2)åŒ…å«æµ‹è¯•obj in seqcontains(seq, obj)é™¤æ³•a / btruediv(a, b)æ•´é™¤æ³•a // bfloordiv(a, b)æŒ‰ä½ä¸a &amp; band_(a, b)æŒ‰ä½å¼‚æˆ–a ^ bxor(a, b)æŒ‰ä½å–å~ ainvert(a)æŒ‰ä½æˆ–a  |  bor_(a, b)å–å¹‚a ** bpow(a, b)ä¸€è‡´æ ‡è¯†a is bis_(a, b)ä¸€è‡´æ ‡è¯†a is not bis_not(a, b)ç´¢å¼•èµ‹å€¼obj[k] = vsetitem(obj, k, v)ç´¢å¼•åˆ é™¤del obj[k]delitem(obj, k)ç´¢å¼•å–å€¼obj[k]getitem(obj, k)å·¦ç§»a &lt;&lt; blshift(a, b)å–æ¨¡a % bmod(a, b)ä¹˜æ³•a * bmul(a, b)çŸ©é˜µä¹˜æ³•a @ bmatmul(a, b)å–åï¼ˆç®—æœ¯ï¼‰- aneg(a)å–åï¼ˆé€»è¾‘ï¼‰not anot_(a)æ­£æ•°+ apos(a)å³ç§»a &gt;&gt; brshift(a, b)åˆ‡ç‰‡èµ‹å€¼seq[i:j] = valuessetitem(seq, slice(i, j), values)åˆ‡ç‰‡åˆ é™¤del seq[i:j]delitem(seq, slice(i, j))åˆ‡ç‰‡å–å€¼seq[i:j]getitem(seq, slice(i, j))å­—ç¬¦ä¸²æ ¼å¼åŒ–s % objmod(s, obj)å‡æ³•a - bsub(a, b)çœŸå€¼æµ‹è¯•objtruth(obj)æ¯”è¾ƒa &lt; blt(a, b)æ¯”è¾ƒa &lt;= ble(a, b)ç›¸ç­‰a == beq(a, b)ä¸ç­‰a != bne(a, b)æ¯”è¾ƒa &gt;= bge(a, b)æ¯”è¾ƒa &gt; bgt(a, b)functoolsæ¨¡å—æ¯å‘¨ä¸€ä¸ª Python æ¨¡å— | functoolsPython functools æ¨¡å—è¯´åˆ°é«˜é˜¶å‡½æ•°ï¼Œè¿™æ˜¯å‡½æ•°å¼ç¼–ç¨‹èŒƒå¼ä¸­å¾ˆé‡è¦çš„ä¸€ä¸ªæ¦‚å¿µï¼Œç®€å•åœ°è¯´ï¼Œ å°±æ˜¯ä¸€ä¸ªå¯ä»¥æ¥å—å‡½æ•°ä½œä¸ºå‚æ•°æˆ–è€…ä»¥å‡½æ•°ä½œä¸ºè¿”å›å€¼çš„å‡½æ•°ï¼Œå› ä¸º Python ä¸­å‡½æ•°æ˜¯ä¸€ç±»å¯¹è±¡ï¼Œ å› æ­¤å¾ˆå®¹æ˜“æ”¯æŒè¿™æ ·çš„å‡½æ•°å¼ç‰¹æ€§ã€‚functools æ¨¡å—ä¸­å‡½æ•°åªæœ‰ cmp_to_keyã€partialã€reduceã€total_orderingã€update_wrapperã€wrapsã€lru_cache è¿™å‡ ä¸ªï¼špartialç”¨äºåˆ›å»ºä¸€ä¸ªåå‡½æ•°ï¼Œå®ƒç”¨ä¸€äº›é»˜è®¤å‚æ•°åŒ…è£…ä¸€ä¸ªå¯è°ƒç”¨å¯¹è±¡ï¼Œè¿”å›ç»“æœæ˜¯å¯è°ƒç”¨å¯¹è±¡ï¼Œå¹¶ä¸”å¯ä»¥åƒåŸå§‹å¯¹è±¡ä¸€æ ·å¯¹å¾…ï¼Œè¿™æ ·å¯ä»¥ç®€åŒ–å‡½æ•°è°ƒç”¨ã€‚12345from functools import partialdef add(x, y):    return x + yadd_y = partial(add, 3)  # add_y æ˜¯ä¸€ä¸ªå‡½æ•°add_y(4)                 # ç»“æœæ˜¯ 7partialmethodpartialmethodæ˜¯ Python 3.4 ä¸­æ–°å¼•å…¥çš„è£…é¥°å™¨ï¼Œä½œç”¨åŸºæœ¬ç±»ä¼¼äº partialï¼Œ ä¸è¿‡ä»…ä½œç”¨äºæ–¹æ³•(å‡½æ•°å’Œæ–¹æ³•çš„å¼‚åŒè§ä¸Šæ–¹)ã€‚123456789101112131415class Cell(object):    def __init__(self):        self._alive = False    @property    def alive(self):        return self._alive    def set_state(self, state):        self._alive = bool(state)    set_alive = partialmethod(set_state, True)    set_dead = partialmethod(set_state, False)c = Cell()c.alive         # Falsec.set_alive()c.alive         # Truetotal_orderingtotal_ordering åŒæ ·æ˜¯ Python 2.7 ä¸­æ–°å¢å‡½æ•°ï¼Œç”¨äºç®€åŒ–æ¯”è¾ƒå‡½æ•°çš„å†™æ³•ã€‚å¦‚æœä½ å·²ç»å®šä¹‰äº† __eq__ æ–¹æ³•ï¼Œä»¥åŠ __lt__ã€__le__ã€__gt__ æˆ–è€… __ge__() å…¶ä¸­ä¹‹ä¸€ï¼Œ å³å¯è‡ªåŠ¨ç”Ÿæˆå…¶å®ƒæ¯”è¾ƒæ–¹æ³•ã€‚å®˜æ–¹ç¤ºä¾‹ï¼š12345678910@total_orderingclass Student:    def __eq__(self, other):        return ((self.lastname.lower(), self.firstname.lower()) ==                (other.lastname.lower(), other.firstname.lower()))    def __lt__(self, other):        return ((self.lastname.lower(), self.firstname.lower()) &lt;                (other.lastname.lower(), other.firstname.lower()))dir(Student)    # ['__doc__', '__eq__', '__ge__', '__gt__', '__le__', '__lt__', '__module__']cmp_to_keycmp_to_key æ˜¯ Python 2.7 ä¸­æ–°å¢çš„å‡½æ•°ï¼Œç”¨äºå°†æ¯”è¾ƒå‡½æ•°è½¬æ¢ä¸º key å‡½æ•°ï¼Œ è¿™æ ·å°±å¯ä»¥åº”ç”¨åœ¨æ¥å— key å‡½æ•°ä¸ºå‚æ•°çš„å‡½æ•°ä¸­ã€‚æ¯”å¦‚ sorted()ã€min()ã€ max()ã€ heapq.nlargest()ã€ itertools.groupby() ç­‰ã€‚1sorted(range(5), key=cmp_to_key(lambda x, y: y-x))      # [4, 3, 2, 1, 0]lru_cacheä¸€ä¸ªè£…é¥°å™¨æ˜¯åœ¨ Python3 ä¸­æ–°åŠ çš„ï¼Œåœ¨ Python2 ä¸­å¦‚æœæƒ³è¦ä½¿ç”¨å¯ä»¥å®‰è£…ç¬¬ä¸‰æ–¹åº“ functools32ã€‚è¯¥è£…é¥°å™¨ç”¨äºç¼“å­˜å‡½æ•°çš„è°ƒç”¨ç»“æœï¼Œå¯¹äºéœ€è¦å¤šæ¬¡è°ƒç”¨çš„å‡½æ•°ï¼Œè€Œä¸”æ¯æ¬¡è°ƒç”¨å‚æ•°éƒ½ç›¸åŒï¼Œåˆ™å¯ä»¥ç”¨è¯¥è£…é¥°å™¨ç¼“å­˜è°ƒç”¨ç»“æœï¼Œä»è€ŒåŠ å¿«ç¨‹åºè¿è¡Œã€‚12345678910111213141516from functools import lru_cache@lru_cache(None)def add(x, y):    print(&quot;calculating: %s + %s&quot; % (x, y))    return x + yprint(add(1, 2))print(add(1, 2))  # ç›´æ¥è¿”å›ç¼“å­˜ä¿¡æ¯print(add(2, 3))calculating: 1 + 233calculating: 2 + 35ç”±äºè¯¥è£…é¥°å™¨ä¼šå°†ä¸åŒçš„è°ƒç”¨ç»“æœç¼“å­˜åœ¨å†…å­˜ä¸­ï¼Œå› æ­¤éœ€è¦æ³¨æ„å†…å­˜å ç”¨é—®é¢˜ï¼Œé¿å…å ç”¨è¿‡å¤šå†…å­˜ï¼Œä»è€Œå½±å“ç³»ç»Ÿæ€§èƒ½ã€‚lru_cache å¯ä»¥ä½¿ç”¨ä¸¤ä¸ªå¯é€‰çš„å‚æ•°æ¥é…ç½®maxsize å‚æ•°æŒ‡å®šå­˜å‚¨å¤šå°‘ä¸ªè°ƒç”¨çš„ç»“æœã€‚ç¼“å­˜æ»¡äº†ä¹‹åï¼Œæ—§çš„ç»“æœä¼šè¢«æ‰”æ‰ï¼Œè…¾å‡ºç©ºé—´ã€‚ä¸ºäº†å¾—åˆ°æœ€ä½³æ€§èƒ½ï¼Œmaxsize åº”è¯¥è®¾ä¸º 2 çš„å¹‚ã€‚typed å‚æ•°å¦‚æœè®¾ä¸º Trueï¼ŒæŠŠä¸åŒå‚æ•°ç±»å‹å¾—åˆ°çš„ç»“æœåˆ†å¼€ä¿å­˜ï¼Œå³æŠŠé€šå¸¸è®¤ä¸ºç›¸ç­‰çš„æµ®ç‚¹æ•°å’Œæ•´æ•°å‚æ•°ï¼ˆå¦‚ 1 å’Œ 1.0ï¼‰åŒºåˆ†å¼€ã€‚é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œå› ä¸º lru_cache ä½¿ç”¨å­—å…¸å­˜å‚¨ç»“æœï¼Œè€Œä¸”é”®æ ¹æ®è°ƒç”¨æ—¶ä¼ å…¥çš„å®šä½å‚æ•°å’Œå…³é”®å­—å‚æ•°åˆ›å»ºï¼Œæ‰€ä»¥è¢« lru_cache è£…é¥°çš„å‡½æ•°ï¼Œå®ƒçš„æ‰€æœ‰å‚æ•°éƒ½å¿…é¡»æ˜¯å¯æ•£åˆ—çš„ã€‚singledispatchè§æœ¬é¡µ-å•åˆ†æ´¾æ³›å‡½æ•°singledispatchwrapsä½¿ç”¨è£…é¥°å™¨æå¤§åœ°å¤ç”¨äº†ä»£ç ï¼Œä½†æ˜¯ä»–æœ‰ä¸€ä¸ªç¼ºç‚¹å°±æ˜¯åŸå‡½æ•°çš„å…ƒä¿¡æ¯ä¸è§äº†ï¼Œæ¯”å¦‚å‡½æ•°çš„docstringã€nameã€å‚æ•°åˆ—è¡¨functools.wrapsï¼Œwrapsæœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªè£…é¥°å™¨ï¼Œå®ƒèƒ½æŠŠåŸå‡½æ•°çš„å…ƒä¿¡æ¯æ‹·è´åˆ°è£…é¥°å™¨é‡Œé¢çš„ func å‡½æ•°ä¸­ï¼Œè¿™ä½¿å¾—è£…é¥°å™¨é‡Œé¢çš„logå‡½æ•°ä¹Ÿæœ‰å’ŒåŸå‡½æ•°testä¸€æ ·çš„å…ƒä¿¡æ¯äº†è¯´åˆ°â€œæ¥å—å‡½æ•°ä¸ºå‚æ•°ï¼Œä»¥å‡½æ•°ä¸ºè¿”å›å€¼â€ï¼Œåœ¨ Python ä¸­æœ€å¸¸ç”¨çš„å½“å±è£…é¥°å™¨äº†ã€‚ functools åº“ä¸­è£…é¥°å™¨ç›¸å…³çš„å‡½æ•°æ˜¯ update_wrapperã€wrapsï¼Œè¿˜æ­é… WRAPPER_ASSIGNMENTS å’Œ WRAPPER_UPDATES ä¸¤ä¸ªå¸¸é‡ä½¿ç”¨ï¼Œä½œç”¨å°±æ˜¯æ¶ˆé™¤ Python è£…é¥°å™¨çš„ä¸€äº›è´Ÿé¢ä½œç”¨ã€‚12345678910111213141516def log(func):    def wrapper():        print(&quot;call test()&quot;)        return func()    return wrapper@logdef test():    print(&quot;this is what I want&quot;)test()print(test.__name__)call test()this is what I wantwrapper1234567891011121314151617181920import functoolsdef log(func):    @functools.wraps(func)    def wrapper():        print(&quot;call test()&quot;)        return func()    return wrapper@logdef test():    print(&quot;this is what I want&quot;)test()print(test.__name__)call test()this is what I wanttestupdate_wrapperupdate_wrapper çš„ä½œç”¨ä¸ wraps ç±»ä¼¼ï¼Œä¸è¿‡åŠŸèƒ½æ›´åŠ å¼ºå¤§ï¼Œæ¢å¥è¯è¯´ï¼Œwraps å…¶å®æ˜¯ update_wrapper çš„ç‰¹æ®ŠåŒ–ï¼Œå®é™…ä¸Š wraps(wrapped) ç›¸å½“äº partial(update_wrapper, wrapped=wrapped, **kwargs)ã€‚1234def decorator(func):    def wrapper(*args, **kwargs):        return func(*args, **kwargs)    return update_wrapper(wrapper, func)è£…é¥°å™¨(Dercrator)å¿…é¡»ä¼š Python è£…é¥°å™¨çš„äº”ä¸ªç†ç”±Pythonè£…é¥°å™¨ç”¨äºæœ‰åˆ‡é¢éœ€æ±‚çš„åœºæ™¯ï¼Œæ¯”å¦‚ï¼šæ’å…¥æ—¥å¿—ã€æ€§èƒ½æµ‹è¯•ã€äº‹åŠ¡å¤„ç†ã€ç¼“å­˜ã€æƒé™æ ¡éªŒç­‰åœºæ™¯ç”¨è£…é¥°å™¨æŠ½ç¦»å‡ºå¤§é‡ä¸å‡½æ•°åŠŸèƒ½æœ¬èº«æ— å…³çš„é›·åŒä»£ç åˆ°è£…é¥°å™¨ä¸­å¹¶ç»§ç»­é‡ç”¨ä¸¥æ ¼æ¥è¯´ï¼Œè£…é¥°å™¨åªæ˜¯è¯­æ³•ç³–ï¼Œè£…é¥°å™¨çš„ä¸¤å¤§ç‰¹æ€§æ˜¯ï¼šèƒ½æŠŠè¢«è£…é¥°çš„å‡½æ•°æ›¿æ¢æˆå…¶ä»–å‡½æ•°å‡½æ•°è£…é¥°å™¨åœ¨åŠ è½½æ¨¡å—æ—¶ç«‹å³æ‰§è¡Œ(Python åŠ è½½æ¨¡å—æ—¶)ï¼Œè¢«è£…é¥°çš„å‡½æ•°åªæœ‰åœ¨æ˜ç¡®è°ƒç”¨æ—¶è¿è¡Œï¼Œè¿™çªå‡ºäº†å¯¼å…¥æ—¶å’Œè¿è¡Œæ—¶çš„åŒºåˆ«ã€‚è£…é¥°å™¨çš„4ç§ç±»å‹ï¼šå‡½æ•°è£…é¥°å‡½æ•°ã€å‡½æ•°è£…é¥°ç±»ã€ç±»è£…é¥°å‡½æ•°ã€ç±»è£…é¥°ç±»globalså…³é”®å­—è¿”å›ä¸€ä¸ªå­—å…¸ï¼Œè¡¨ç¤ºå½“å‰çš„å…¨å±€ç¬¦å·è¡¨ã€‚è¿™ä¸ªç¬¦å·è¡¨å§‹ç»ˆé’ˆå¯¹å½“å‰æ¨¡å—ï¼ˆå¯¹å‡½æ•°æˆ–æ–¹æ³•æ¥è¯´ï¼Œæ˜¯æŒ‡å®šä¹‰å®ƒä»¬çš„æ¨¡å—ï¼Œè€Œä¸æ˜¯è°ƒç”¨å®ƒä»¬çš„æ¨¡å—ï¼‰ã€‚æ–¹å¼ä¸€ globals å‡½æ•°å¸®åŠ© best_promo è‡ªåŠ¨æ‰¾åˆ°å…¶ä»–å¯ç”¨çš„ *_promo å‡½æ•°123promos = [globals()[name] for name in globals()  âŠ            if name.endswith('_promo')  â‹            and name != 'best_promo']   âŒæ–¹å¼äºŒæ”¶é›†æ‰€æœ‰å¯ç”¨ä¿ƒé”€çš„å¦ä¸€ç§æ–¹æ³•æ˜¯ï¼Œåœ¨ä¸€ä¸ªå•ç‹¬çš„æ¨¡å—ä¸­ä¿å­˜æ‰€æœ‰ç­–ç•¥å‡½æ•°ï¼ŒæŠŠ best_promo æ’é™¤åœ¨å¤–ã€‚æœ€å¤§çš„å˜åŒ–æ˜¯å†…çœåä¸º promotions çš„ç‹¬ç«‹æ¨¡å—ï¼Œæ„å»ºç­–ç•¥å‡½æ•°åˆ—è¡¨ã€‚12promos = [func for name, func in                inspect.getmembers(promotions, inspect.isfunction)]é—­åŒ…åˆ›å»ºä¿æœ‰å†…éƒ¨çŠ¶æ€çš„å‡½æ•°ï¼Œè¿˜æœ‰ä¸€ç§æˆªç„¶ä¸åŒçš„æ–¹å¼â€”â€”ä½¿ç”¨é—­åŒ…ã€‚åœ¨è¡¨è¾¾å¼ä¸­å¼•ç”¨å˜é‡æ—¶ï¼ŒPythonè§£é‡Šå™¨å°†æŒ‰å¦‚ä¸‹é¡ºåºéå†å„ä½œç”¨åŸŸï¼Œä»¥è§£æè¯¥å¼•ç”¨:å½“å‰å‡½æ•°çš„ä½œç”¨åŸŸä»»ä½•å¤–å›´ä½œç”¨åŸŸ(ä¾‹å¦‚ï¼ŒåŒ…å«å½“å‰å‡½æ•°çš„å…¶ä»–å‡½æ•°)åŒ…å«å½“å‰ä»£ç çš„é‚£ä¸ªæ¨¡å—çš„ä½œç”¨åŸŸ(ä¹Ÿå«å…¨å±€ä½œç”¨åŸŸï¼Œglobal scope)å†…ç½®ä½œç”¨åŸŸ(ä¹Ÿå°±æ˜¯åŒ…å«lenåŠstrç­‰å‡½æ•°çš„é‚£ä¸ªä½œç”¨åŸŸ)å¦‚æœä¸Šé¢è¿™äº›åœ°æ–¹éƒ½æ²¡æœ‰å®šä¹‰è¿‡åç§°ç›¸ç¬¦çš„å˜é‡ï¼Œé‚£å°±æŠ›å‡ºNameErrorå¼‚å¸¸ã€‚nonlocalè¯­å¥æ¸…æ¥šåœ°è¡¨æ˜: å¦‚æœåœ¨é—­åŒ…å†…ç»™è¯¥å˜é‡èµ‹å€¼ï¼Œé‚£ä¹ˆä¿®æ”¹çš„å…¶å®æ˜¯é—­åŒ…å¤–é‚£ä¸ªä½œç”¨åŸŸä¸­çš„å˜é‡ã€‚è¿™ä¸globalè¯­å¥äº’ä¸ºè¡¥å……ï¼Œglobal ç”¨æ¥è¡¨ç¤ºå¯¹è¯¥å˜é‡çš„èµ‹å€¼æ“ä½œï¼Œå°†ä¼šç›´æ¥ä¿®æ”¹æ¨¡å—ä½œç”¨åŸŸé‡Œçš„é‚£ä¸ªå˜é‡ã€‚psï¼šæŒ‰ç…§æˆ‘ä»¬æ­£å¸¸çš„è®¤çŸ¥ï¼Œä¸€ä¸ªå‡½æ•°ç»“æŸçš„æ—¶å€™ï¼Œä¼šæŠŠè‡ªå·±çš„ä¸´æ—¶å˜é‡éƒ½é‡Šæ”¾è¿˜ç»™å†…å­˜ï¼Œä¹‹åå˜é‡éƒ½ä¸å­˜åœ¨äº†ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç¡®å®æ˜¯è¿™æ ·çš„ã€‚ä½†æ˜¯é—­åŒ…æ˜¯ä¸€ä¸ªç‰¹åˆ«çš„æƒ…å†µï¼Œå¤–éƒ¨å‡½æ•°å‘ç°ï¼Œè‡ªå·±çš„ä¸´æ—¶å˜é‡ä¼šåœ¨å°†æ¥çš„å†…éƒ¨å‡½æ•°ä¸­ç”¨åˆ°ï¼Œè‡ªå·±åœ¨ç»“æŸçš„æ—¶å€™ï¼Œè¿”å›å†…å‡½æ•°çš„åŒæ—¶ï¼Œä¼šæŠŠå¤–å‡½æ•°çš„ä¸´æ—¶å˜é‡é€ç»™å†…å‡½æ•°ç»‘å®šåœ¨ä¸€èµ·ã€‚æ‰€ä»¥å¤–å‡½æ•°å·²ç»ç»“æŸäº†ï¼Œè°ƒç”¨å†…å‡½æ•°çš„æ—¶å€™ä»ç„¶èƒ½å¤Ÿä½¿ç”¨å¤–å‡½æ•°çš„ä¸´æ—¶å˜é‡ã€‚ globalå…³é”®å­—å¦‚æœåœ¨å‡½æ•°ä¸­èµ‹å€¼æ—¶æƒ³è®©è§£é‡Šå™¨æŠŠ b å½“æˆå…¨å±€å˜é‡ï¼Œè¦ä½¿ç”¨ global å£°æ˜ï¼š123456b = 6def func(a):   global b   print(a)   print(b)   b = 9è‡ªç”±å˜é‡é—­åŒ…ï¼šåªæœ‰æ¶‰åŠåµŒå¥—å‡½æ•°æ—¶æ‰æœ‰é—­åŒ…é—®é¢˜é—­åŒ…æŒ‡å»¶ä¼¸äº†ä½œç”¨åŸŸçš„å‡½æ•°ï¼Œå…¶ä¸­åŒ…å«å‡½æ•°å®šä¹‰ä½“ä¸­å¼•ç”¨ã€ä½†æ˜¯ä¸åœ¨å®šä¹‰ä½“ä¸­å®šä¹‰çš„éå…¨å±€å˜é‡ã€‚å‡½æ•°æ˜¯ä¸æ˜¯åŒ¿åçš„æ²¡æœ‰å…³ç³»ï¼Œå…³é”®æ˜¯å®ƒèƒ½è®¿é—®å®šä¹‰ä½“ä¹‹å¤–å®šä¹‰çš„éå…¨å±€å˜é‡ã€‚åœ¨ averager å‡½æ•°ä¸­ï¼Œseries æ˜¯è‡ªç”±å˜é‡ï¼ˆfree variableï¼‰ï¼ŒæŒ‡æœªåœ¨æœ¬åœ°ä½œç”¨åŸŸä¸­ç»‘å®šçš„å˜é‡averager çš„é—­åŒ…å»¶ä¼¸åˆ°é‚£ä¸ªå‡½æ•°çš„ä½œç”¨åŸŸä¹‹å¤–ï¼ŒåŒ…å«è‡ªç”±å˜é‡ series çš„ç»‘å®šåªæœ‰åµŒå¥—åœ¨å…¶ä»–å‡½æ•°ä¸­çš„å‡½æ•°æ‰å¯èƒ½éœ€è¦å¤„ç†ä¸åœ¨å…¨å±€ä½œç”¨åŸŸä¸­çš„å¤–éƒ¨å˜é‡nonlocalå£°æ˜ä½†æ˜¯å¯¹æ•°å­—ã€å­—ç¬¦ä¸²ã€å…ƒç»„ç­‰ä¸å¯å˜ç±»å‹æ¥è¯´ï¼Œåªèƒ½è¯»å–ï¼Œä¸èƒ½æ›´æ–°ã€‚å¦‚æœå°è¯•é‡æ–°ç»‘å®šï¼Œä¾‹å¦‚ count = count + 1ï¼Œå…¶å®ä¼šéšå¼åˆ›å»ºå±€éƒ¨å˜é‡ countã€‚è¿™æ ·ï¼Œcount å°±ä¸æ˜¯è‡ªç”±å˜é‡äº†ï¼Œå› æ­¤ä¸ä¼šä¿å­˜åœ¨é—­åŒ…ä¸­ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒPython 3 å¼•å…¥äº† nonlocal å£°æ˜ã€‚å®ƒçš„ä½œç”¨æ˜¯æŠŠå˜é‡æ ‡è®°ä¸ºè‡ªç”±å˜é‡ï¼Œå³ä½¿åœ¨å‡½æ•°ä¸­ä¸ºå˜é‡èµ‹äºˆæ–°å€¼äº†ï¼Œä¹Ÿä¼šå˜æˆè‡ªç”±å˜é‡ã€‚å¦‚æœä¸º nonlocal å£°æ˜çš„å˜é‡èµ‹äºˆæ–°å€¼ï¼Œé—­åŒ…ä¸­ä¿å­˜çš„ç»‘å®šä¼šæ›´æ–°ã€‚12345678910def make_averager():    count, total = 0, 0    def averager(new_value):        nonlocal count, total        count += 1        total += new_value        return total / count    return averagerå°ç»“ï¼šå¤–å‡½æ•°å†…éƒ¨å®šä¹‰å¯å˜ç±»å‹çš„å˜é‡å¯ä»¥åœ¨å†…å‡½æ•°ä½¿ç”¨ï¼Œå¯¹æ•°å­—ã€å­—ç¬¦ä¸²ã€å…ƒç»„ç­‰ä¸å¯å˜ç±»å‹æ¥è¯´ï¼Œéœ€è¦ä½¿ç”¨ nonlocal å£°æ˜å˜é‡ä¸ºè‡ªç”±å˜é‡ï¼Œå†…å‡½æ•°æ‰å¯ä»¥è®¿é—®åˆ°ã€‚å‡½æ•°è£…é¥°å‡½æ•°è£…é¥°å™¨çš„å…¸å‹è¡Œä¸ºï¼šæŠŠè¢«è£…é¥°çš„å‡½æ•°æ›¿æ¢æˆæ–°å‡½æ•°ï¼ŒäºŒè€…æ¥å—ç›¸åŒçš„å‚æ•°ï¼Œè€Œä¸”ï¼ˆé€šå¸¸ï¼‰è¿”å›è¢«è£…é¥°çš„å‡½æ•°æœ¬è¯¥è¿”å›çš„å€¼ï¼ŒåŒæ—¶è¿˜ä¼šåšäº›é¢å¤–æ“ä½œã€‚1234567891011121314151617181920212223def decorator(func):    def inner(*args, **kwargs):        print('before...........')        res = func(*args, **kwargs)        print('after............')        return res    return inner@decoratordef run():    print('run...............')    return 0if __name__ == &quot;__main__&quot;:    run()    run.__name__    # æ­¤æ—¶decoratorå«åšè£…é¥°å™¨------------------------------------------before...........run...............after............inner--------------------- functools.wrapè£…é¥°å™¨innerçš„è¿”å›å€¼è¦ä¸funcçš„ä¸€è‡´ï¼Œå¹¶ä¸”innerä¸funcå‚æ•°ç›¸åŒä¸ºäº†ä¸æ”¹å˜è¢«è£…é¥°å‡½æ•°æˆ–ç±»çš„æ€§è´¨ï¼Œæ·»åŠ functools.wrapè£…é¥°å™¨12345678910111213141516171819202122232425from functools import wrapsdef decorator(func):    @wraps(func)    def inner():        print('before...........')        res = func()        print('after............')        return res    return inner@decoratordef run():    print('run...............')    return 0if __name__ == &quot;__main__&quot;:    run()    print(run.__name__)------------------------------------------before...........run...............after............run--------------------- å¸¦å‚æ•°çš„è£…é¥°å™¨(3å±‚)1234567891011121314151617181920212223242526272829303132333435from functools import wrapsfrom datetime import datetimedef start():    return datetime.now()def end():    return datetime.now()def Filter(start_time, end_time):    def decorator(func):        @wraps(func)        def inner(*args, **kwargs):            s = start_time()            res = func(*args,**kwargs)            e = end_time()            print(&quot;è€—æ—¶ {} s&quot;.format((e-s).total_seconds()))            return res        return inner    return decorator@Filter(start, end)def run():    for i in range(2):        for j in range(3):            print(j)    return 0if __name__ == &quot;__main__&quot;:    run()    012012è€—æ—¶ 0.003987 s   å¸¦æœ‰ä¸å®šå‚æ•°çš„è£…é¥°å™¨123456789101112131415161718192021222324252627282930313233343536# å¸¦æœ‰ä¸å®šå‚æ•°çš„è£…é¥°å™¨# æ‹“å±•çš„å‡½æ•°å¥½å¤šå¯æ˜¯æœ‰å‚æ•°ï¼Œæœ‰çš„å‚æ•°è¿˜æ˜¯ä¸ªæ•°ä¸å®šçš„é‚£ç§import timedef deco(func):    def wrapper(*args, **kwargs):        startTime = time.time()        func(*args, **kwargs)        endTime = time.time()        msecs = (endTime - startTime) * 1000        print(&quot;time is %d ms&quot; % msecs)    return wrapper@decodef func(a, b):    print(&quot;hello,here is a func for add:&quot;)    time.sleep(1)    print(&quot;result is %d&quot; % (a + b))@decodef func2(a, b, c):    print(&quot;hello,here is a func for add:&quot;)    time.sleep(1)    print(&quot;result is %d&quot; % (a + b + c))if __name__ == '__main__':    f = func    func2(3, 4, 5)    f(3, 4)    hello,here is a func for add:result is 12time is 1000 mshello,here is a func for add:result is 7time is 1000 mså¤šä¸ªè£…é¥°å™¨1234567891011121314151617181920212223242526272829303132333435363738394041# ä¸€ä¸ªå‡½æ•°éœ€è¦åŠ å…¥å¾ˆå¤šåŠŸèƒ½ï¼Œä¸€ä¸ªè£…é¥°å™¨æ€•æ˜¯æä¸å®šï¼Œè£…é¥°å™¨èƒ½æ”¯æŒå¤šä¸ªå˜›# å¤šä¸ªè£…é¥°å™¨æ‰§è¡Œçš„é¡ºåºå°±æ˜¯ä»æœ€åä¸€ä¸ªè£…é¥°å™¨å¼€å§‹ï¼Œæ‰§è¡Œåˆ°ç¬¬ä¸€ä¸ªè£…é¥°å™¨ï¼Œå†æ‰§è¡Œå‡½æ•°æœ¬èº«ã€‚# å¤šä¸ªè£…é¥°å™¨import timedef deco01(func):    def urapper(*args, **kwargs):        print(&quot;this is decoe1&quot;)        startTime = time.time()        func(*args, **kwargs)        endTime = time.time()        msecs = (endTime - startTime) * 1000        print(&quot;time is %d ms&quot; % msecs)        print(&quot;decoe1 end here&quot;)    return urapperdef deco02(func):    def wrapper(*args, **kwargs):        print(&quot;this is decoe2&quot;)        func(*args, **kwargs)        print(&quot;decoe2 end here&quot;)    return wrapper@deco01@deco02def func(a, b):    print(&quot;hello,here is a func for add:&quot;)    time.sleep(1)    print(&quot;result is %d&quot; % (a + b))if __name__ == '__main__':    f = func    f(3, 4)    this is decoe1this is decoe2hello,here is a func for add:result is 7decoe2 end heretime is 1003 msdecoe1 end hereå‡½æ•°è£…é¥°ç±»12345678910111213141516171819def wrapClass(cls):    def inner(a):        print('class name:', cls.__name__)        return cls(a)    return inner@wrapClassclass Foo():    def __init__(self, a):        self.a = a    def fun(self):        print('self.a =', self.a)m = Foo('xiemanR')m.fun()class name: Fooself.a = xiemanRå®šä¹‰è£…é¥°å™¨ä¸ä»…å¯ä»¥æ˜¯å‡½æ•°ï¼Œè¿˜å¯ä»¥æ˜¯ç±» ç›¸æ¯”å‡½æ•°è£…é¥°å™¨ï¼Œç±»è£…é¥°å™¨å…·æœ‰çµæ´»åº¦å¤§ã€é«˜å†…èšã€å°è£…æ€§ç­‰ä¼˜ç‚¹åƒ__call__è¿™æ ·å‰åéƒ½å¸¦ä¸‹åˆ’çº¿çš„æ–¹æ³•åœ¨Pythonä¸­è¢«ç§°ä¸ºå†…ç½®(é­”æ³•)æ–¹æ³•ã€‚é‡è½½è¿™äº›é­”æ³•æ–¹æ³•ä¸€èˆ¬ä¼šæ”¹å˜å¯¹è±¡çš„å†…éƒ¨è¡Œä¸ºç”¨æ³•è®©ç±»çš„æ„é€ å‡½æ•°__init__()æ¥å—ä¸€ä¸ªå‡½æ•°é‡è½½call()å¹¶ è¿”å›ä¸€ä¸ªå‡½æ•°ä½¿ç”¨@ç±»å½¢å¼å°†è£…é¥°å™¨é™„åŠ åˆ°ä¸šåŠ¡å‡½æ•°ä¸Šç±»è£…é¥°å‡½æ•°1234567891011121314class ShowFunName():    def __init__(self, func):        self._func = func    def __call__(self, a):        print('function name:', self._func.__name__)        return self._func(a)@ShowFunNamedef Bar(a):    return aprint(Bar('xiemanR'))function name: BarxiemanRç±»è£…é¥°ç±»1234567891011121314151617class ShowClassName(object):    def __init__(self, cls):        self._cls = cls    def __call__(self, a):        print('class name:', self._cls.__name__)        return self._cls(a)@ShowClassNameclass Foobar(object):    def __init__(self, a):        self.value = a    def fun(self):        print(self.value)a = Foobar('xiemanR')a.fun()class name: FoobarxiemanRå†…ç½®è£…é¥°å™¨å‘½ä»¤è¡Œç¥å™¨Clickå‘½ä»¤è¡Œç¥å™¨ Clickæ•™ç¨‹Aç¯‡12345678910111213141516# -*- coding: utf-8 -*import click@click.command()@click.option('--count', default=1, help='Number of greetings.')@click.option('--name', prompt='Your name', help='The person to greet.')def hello(count, name):    &quot;&quot;&quot;Simple program that greets NAME for a total of COUNT times.&quot;&quot;&quot;    for x in range(count):        click.echo('Hello %s!' % name)if __name__ == '__main__':    hello()Q:\pyCharmWS&gt;python ./tempTest.py --count=3 --name=EthanHello Ethan!Hello Ethan!Hello Ethan!@propertyå’Œ@classmethodpythonä¸­å¸¸ç”¨çš„å†…ç½®è£…é¥°å™¨123456789101112131415161718192021222324252627# @property# ä½¿è°ƒç”¨ç±»ä¸­çš„æ–¹æ³•åƒå¼•ç”¨ç±»ä¸­çš„å­—æ®µå±æ€§ä¸€æ ·ã€‚è¢«ä¿®é¥°çš„ç‰¹æ€§æ–¹æ³•ï¼Œå†…éƒ¨å¯ä»¥å®ç°å¤„ç†é€»è¾‘ï¼Œä½†å¯¹å¤–æä¾›ç»Ÿä¸€çš„è°ƒç”¨æ–¹å¼ã€‚éµå¾ªäº†ç»Ÿä¸€è®¿é—®çš„åŸåˆ™ã€‚# @classmethod# ç±»æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç±»ï¼Œå°†ç±»æœ¬èº«ä½œä¸ºæ“ä½œçš„æ–¹æ³•ã€‚ç±»æ–¹æ³•è¢«å“ªä¸ªç±»è°ƒç”¨ï¼Œå°±ä¼ å…¥å“ªä¸ªç±»ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°è¿›è¡Œæ“ä½œã€‚# æ³¨æ„ï¼Œé™æ€æ–¹æ³•å’Œç±»æ–¹æ³•æ˜¯ä¸ºç±»æ“ä½œå‡†å¤‡çš„ã€‚è™½ç„¶é€šè¿‡å®ä¾‹ä¹Ÿèƒ½è°ƒç”¨ï¼Œä½†æ˜¯ä¸å»ºè®®# -*- coding: utf-8 -*-# coding: utf-8class TestClass:    name = &quot;test&quot;    def __init__(self, name):        self.name = name    @property    def sayHello(self):        print(&quot;hello&quot;, self.name)    @staticmethod    def fun(self, x, y):        return x + ycls = TestClass(&quot;felix&quot;)print(f&quot;é€šè¿‡å®ä¾‹å¼•ç”¨å±æ€§: {cls.name}&quot;)print(f&quot;åƒå¼•ç”¨å±æ€§ä¸€æ ·è°ƒç”¨@propertyä¿®é¥°çš„æ–¹æ³•: {cls.sayHello}&quot;)print(f&quot;ç±»åç›´æ¥å¼•ç”¨é™æ€æ–¹æ³•: {TestClass.fun(None, 2, 3)}&quot;)é€šè¿‡å®ä¾‹å¼•ç”¨å±æ€§: felixhello felixåƒå¼•ç”¨å±æ€§ä¸€æ ·è°ƒç”¨@propertyä¿®é¥°çš„æ–¹æ³•: Noneç±»åç›´æ¥å¼•ç”¨é™æ€æ–¹æ³•: 5functoolsæ¨¡å—çš„å†…ç½®è£…é¥°å™¨æ›´è¯¦ç»†çš„è§ä¸Šæ–¹çš„functoolsæ¨¡å—lru_cacheåšå¤‡å¿˜functools.lru_cache æ˜¯éå¸¸å®ç”¨çš„è£…é¥°å™¨ï¼Œå®ƒå®ç°äº†å¤‡å¿˜ï¼ˆmemoizationï¼‰åŠŸèƒ½ã€‚è¿™æ˜¯ä¸€é¡¹ä¼˜åŒ–æŠ€æœ¯ï¼Œå®ƒæŠŠè€—æ—¶çš„å‡½æ•°çš„ç»“æœä¿å­˜èµ·æ¥ï¼Œé¿å…ä¼ å…¥ç›¸åŒçš„å‚æ•°æ—¶é‡å¤è®¡ç®—ã€‚LRU ä¸‰ä¸ªå­—æ¯æ˜¯â€œLeast Recently Usedâ€çš„ç¼©å†™ï¼Œè¡¨æ˜ç¼“å­˜ä¸ä¼šæ— é™åˆ¶å¢é•¿ï¼Œä¸€æ®µæ—¶é—´ä¸ç”¨çš„ç¼“å­˜ä¼šè¢«æ‰”æ‰ã€‚ç”Ÿæˆç¬¬ n ä¸ªæ–æ³¢çº³å¥‘æ•°è¿™ç§æ…¢é€Ÿé€’å½’å‡½æ•°é€‚åˆä½¿ç”¨ lru_cache123456789101112131415161718192021import functoolsfrom clockdeco import clock@functools.lru_cache() # âŠ@clock  # â‹def fibonacci(n):    if n &lt; 2:        return n    return fibonacci(n-2) + fibonacci(n-1)if __name__=='__main__':    print(fibonacci(6))    # è¿™æ ·ä¸€æ¥ï¼Œæ‰§è¡Œæ—¶é—´å‡åŠäº†ï¼Œè€Œä¸” n çš„æ¯ä¸ªå€¼åªè°ƒç”¨ä¸€æ¬¡å‡½æ•°[0.00000119s] fibonacci(0) -&gt; 0[0.00000119s] fibonacci(1) -&gt; 1[0.00010800s] fibonacci(2) -&gt; 1[0.00000787s] fibonacci(3) -&gt; 2[0.00016093s] fibonacci(4) -&gt; 3[0.00001216s] fibonacci(5) -&gt; 5[0.00025296s] fibonacci(6) -&gt; 8é™¤äº†ä¼˜åŒ–é€’å½’ç®—æ³•ä¹‹å¤–ï¼Œlru_cache åœ¨ä» Web ä¸­è·å–ä¿¡æ¯çš„åº”ç”¨ä¸­ä¹Ÿèƒ½å‘æŒ¥å·¨å¤§ä½œç”¨ã€‚ç‰¹åˆ«è¦æ³¨æ„ï¼Œlru_cache å¯ä»¥ä½¿ç”¨ä¸¤ä¸ªå¯é€‰çš„å‚æ•°æ¥é…ç½®ã€‚å®ƒçš„ç­¾åæ˜¯ï¼š1functools.lru_cache(maxsize=128, typed=False)maxsize å‚æ•°æŒ‡å®šå­˜å‚¨å¤šå°‘ä¸ªè°ƒç”¨çš„ç»“æœã€‚ç¼“å­˜æ»¡äº†ä¹‹åï¼Œæ—§çš„ç»“æœä¼šè¢«æ‰”æ‰ï¼Œè…¾å‡ºç©ºé—´ã€‚ä¸ºäº†å¾—åˆ°æœ€ä½³æ€§èƒ½ï¼Œmaxsize åº”è¯¥è®¾ä¸º 2 çš„å¹‚ã€‚typed å‚æ•°å¦‚æœè®¾ä¸º Trueï¼ŒæŠŠä¸åŒå‚æ•°ç±»å‹å¾—åˆ°çš„ç»“æœåˆ†å¼€ä¿å­˜ï¼Œå³æŠŠé€šå¸¸è®¤ä¸ºç›¸ç­‰çš„æµ®ç‚¹æ•°å’Œæ•´æ•°å‚æ•°ï¼ˆå¦‚ 1 å’Œ 1.0ï¼‰åŒºåˆ†å¼€ã€‚é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œå› ä¸º lru_cache ä½¿ç”¨å­—å…¸å­˜å‚¨ç»“æœï¼Œè€Œä¸”é”®æ ¹æ®è°ƒç”¨æ—¶ä¼ å…¥çš„å®šä½å‚æ•°å’Œå…³é”®å­—å‚æ•°åˆ›å»ºï¼Œæ‰€ä»¥è¢« lru_cache è£…é¥°çš„å‡½æ•°ï¼Œå®ƒçš„æ‰€æœ‰å‚æ•°éƒ½å¿…é¡»æ˜¯å¯æ•£åˆ—çš„ã€‚å•åˆ†æ´¾æ³›å‡½æ•°singledispatchPEP 443 â€” Single-dispatch generic functionsfunctools.singledispatch æ˜¯ Python 3.4 å¢åŠ çš„ï¼ŒPyPI ä¸­çš„ singledispatchåŒ…å¯ä»¥å‘åå…¼å®¹ Python 2.6 åˆ° Python 3.3ã€‚å‡è®¾æˆ‘ä»¬åœ¨å¼€å‘ä¸€ä¸ªè°ƒè¯• Web åº”ç”¨çš„å·¥å…·ï¼Œæˆ‘ä»¬æƒ³ç”Ÿæˆ HTMLï¼Œæ˜¾ç¤ºä¸åŒç±»å‹çš„ Python å¯¹è±¡ã€‚æˆ‘ä»¬å¯èƒ½ä¼šç¼–å†™è¿™æ ·çš„å‡½æ•°ï¼š12345import htmldef htmlize(obj):    content = html.escape(repr(obj))    return '&lt;pre&gt;{}&lt;/pre&gt;'.format(content)è¿™ä¸ªå‡½æ•°é€‚ç”¨äºä»»ä½• Python ç±»å‹ï¼Œä½†æ˜¯ç°åœ¨æˆ‘ä»¬æƒ³åšä¸ªæ‰©å±•ï¼Œè®©å®ƒä½¿ç”¨ç‰¹åˆ«çš„æ–¹å¼æ˜¾ç¤ºæŸäº›ç±»å‹ã€‚strï¼šæŠŠå†…éƒ¨çš„æ¢è¡Œç¬¦æ›¿æ¢ä¸º ' \n'ï¼›ä¸ä½¿ç”¨ ï¼Œè€Œæ˜¯ä½¿ç”¨intï¼šä»¥åè¿›åˆ¶å’Œåå…­è¿›åˆ¶æ˜¾ç¤ºæ•°å­—listï¼šè¾“å‡ºä¸€ä¸ª HTML åˆ—è¡¨ï¼Œæ ¹æ®å„ä¸ªå…ƒç´ çš„ç±»å‹è¿›è¡Œæ ¼å¼åŒ–å› ä¸º Python ä¸æ”¯æŒé‡è½½æ–¹æ³•æˆ–å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨ä¸åŒçš„ç­¾åå®šä¹‰ htmlize çš„å˜ä½“ï¼Œä¹Ÿæ— æ³•ä½¿ç”¨ä¸åŒçš„æ–¹å¼å¤„ç†ä¸åŒçš„æ•°æ®ç±»å‹ã€‚åœ¨ Python ä¸­ï¼Œä¸€ç§å¸¸è§çš„åšæ³•æ˜¯æŠŠ htmlize å˜æˆä¸€ä¸ªåˆ†æ´¾å‡½æ•°ï¼Œä½¿ç”¨ä¸€ä¸² if/elif/elifï¼Œè°ƒç”¨ä¸“é—¨çš„å‡½æ•°ï¼Œå¦‚ htmlize_strã€htmlize_intï¼Œç­‰ç­‰ã€‚è¿™æ ·ä¸ä¾¿äºæ¨¡å—çš„ç”¨æˆ·æ‰©å±•ï¼Œè¿˜æ˜¾å¾—ç¬¨æ‹™ï¼šæ—¶é—´ä¸€é•¿ï¼Œåˆ†æ´¾å‡½æ•° htmlize ä¼šå˜å¾—å¾ˆå¤§ï¼Œè€Œä¸”å®ƒä¸å„ä¸ªä¸“é—¨å‡½æ•°ä¹‹é—´çš„è€¦åˆä¹Ÿå¾ˆç´§å¯†ã€‚Python 3.4 æ–°å¢çš„ functools.singledispatch è£…é¥°å™¨å¯ä»¥æŠŠæ•´ä½“æ–¹æ¡ˆæ‹†åˆ†æˆå¤šä¸ªæ¨¡å—ï¼Œç”šè‡³å¯ä»¥ä¸ºä½ æ— æ³•ä¿®æ”¹çš„ç±»æä¾›ä¸“é—¨çš„å‡½æ•°ã€‚ä½¿ç”¨ @singledispatch è£…é¥°çš„æ™®é€šå‡½æ•°ä¼šå˜æˆæ³›å‡½æ•°ï¼ˆgeneric functionï¼‰ï¼šæ ¹æ®ç¬¬ä¸€ä¸ªå‚æ•°çš„ç±»å‹ï¼Œä»¥ä¸åŒæ–¹å¼æ‰§è¡Œç›¸åŒæ“ä½œçš„ä¸€ç»„å‡½æ•°å¦‚æœæ ¹æ®å¤šä¸ªå‚æ•°é€‰æ‹©ä¸“é—¨çš„å‡½æ•°ï¼Œé‚£å°±æ˜¯å¤šåˆ†æ´¾äº†ã€‚singledispatch åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„ htmlize.register è£…é¥°å™¨ï¼ŒæŠŠå¤šä¸ªå‡½æ•°ç»‘åœ¨ä¸€èµ·ç»„æˆä¸€ä¸ªæ³›å‡½æ•°123456789101112131415161718192021222324from functools import singledispatchfrom collections import abcimport numbersimport html@singledispatch  âŠdef htmlize(obj):    content = html.escape(repr(obj))    return '&lt;pre&gt;{}&lt;/pre&gt;'.format(content)@htmlize.register(str)  â‹def _(text):            âŒ    content = html.escape(text).replace('\n', '&lt;br&gt;\n')    return '&lt;p&gt;{0}&lt;/p&gt;'.format(content)@htmlize.register(numbers.Integral)  âdef _(n):    return '&lt;pre&gt;{0} (0x{0:x})&lt;/pre&gt;'.format(n)@htmlize.register(tuple)  â@htmlize.register(abc.MutableSequence)def _(seq):    inner = '&lt;/li&gt;\n&lt;li&gt;'.join(htmlize(item) for item in seq)    return '&lt;ul&gt;\n&lt;li&gt;' + inner + '&lt;/li&gt;\n&lt;/ul&gt;'â¶ @singledispatch æ ‡è®°å¤„ç† object ç±»å‹çš„åŸºå‡½æ•°ã€‚â· å„ä¸ªä¸“é—¨å‡½æ•°ä½¿ç”¨ @Â«base_functionÂ».register(Â«typeÂ») è£…é¥°ã€‚â¸ ä¸“é—¨å‡½æ•°çš„åç§°æ— å…³ç´§è¦ï¼›_ æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œç®€å•æ˜äº†ã€‚â¹ ä¸ºæ¯ä¸ªéœ€è¦ç‰¹æ®Šå¤„ç†çš„ç±»å‹æ³¨å†Œä¸€ä¸ªå‡½æ•°ã€‚numbers.Integral æ˜¯ int çš„è™šæ‹Ÿè¶…ç±»ã€‚âº å¯ä»¥å æ”¾å¤šä¸ª register è£…é¥°å™¨ï¼Œè®©åŒä¸€ä¸ªå‡½æ•°æ”¯æŒä¸åŒç±»å‹ã€‚åªè¦å¯èƒ½ï¼Œæ³¨å†Œçš„ä¸“é—¨å‡½æ•°åº”è¯¥å¤„ç†æŠ½è±¡åŸºç±»ï¼ˆå¦‚ numbers.Integral å’Œ abc.MutableSequenceï¼‰ï¼Œä¸è¦å¤„ç†å…·ä½“å®ç°ï¼ˆå¦‚ int å’Œ listï¼‰ã€‚è¿™æ ·ï¼Œä»£ç æ”¯æŒçš„å…¼å®¹ç±»å‹æ›´å¹¿æ³›ã€‚ä¾‹å¦‚ï¼ŒPython æ‰©å±•å¯ä»¥å­ç±»åŒ– numbers.Integralï¼Œä½¿ç”¨å›ºå®šçš„ä½æ•°å®ç° int ç±»å‹ã€‚singledispatch æœºåˆ¶çš„ä¸€ä¸ªæ˜¾è‘—ç‰¹å¾æ˜¯ï¼Œä½ å¯ä»¥åœ¨ç³»ç»Ÿçš„ä»»ä½•åœ°æ–¹å’Œä»»ä½•æ¨¡å—ä¸­æ³¨å†Œä¸“é—¨å‡½æ•°ã€‚å¦‚æœåæ¥åœ¨æ–°çš„æ¨¡å—ä¸­å®šä¹‰äº†æ–°çš„ç±»å‹ï¼Œå¯ä»¥è½»æ¾åœ°æ·»åŠ ä¸€ä¸ªæ–°çš„ä¸“é—¨å‡½æ•°æ¥å¤„ç†é‚£ä¸ªç±»å‹ã€‚æ­¤å¤–ï¼Œä½ è¿˜å¯ä»¥ä¸ºä¸æ˜¯è‡ªå·±ç¼–å†™çš„æˆ–è€…ä¸èƒ½ä¿®æ”¹çš„ç±»æ·»åŠ è‡ªå®šä¹‰å‡½æ•°ã€‚@singledispatch ä¸æ˜¯ä¸ºäº†æŠŠ Java çš„é‚£ç§æ–¹æ³•é‡è½½å¸¦å…¥ Pythonã€‚åœ¨ä¸€ä¸ªç±»ä¸­ä¸ºåŒä¸€ä¸ªæ–¹æ³•å®šä¹‰å¤šä¸ªé‡è½½å˜ä½“ï¼Œæ¯”åœ¨ä¸€ä¸ªå‡½æ•°ä¸­ä½¿ç”¨ä¸€é•¿ä¸² if/elif/elif/elif å—è¦æ›´å¥½ã€‚ä½†æ˜¯è¿™ä¸¤ç§æ–¹æ¡ˆéƒ½æœ‰ç¼ºé™·ï¼Œå› ä¸ºå®ƒä»¬è®©ä»£ç å•å…ƒï¼ˆç±»æˆ–å‡½æ•°ï¼‰æ‰¿æ‹…çš„èŒè´£å¤ªå¤šã€‚@singledispath çš„ä¼˜ç‚¹æ˜¯æ”¯æŒæ¨¡å—åŒ–æ‰©å±•ï¼šå„ä¸ªæ¨¡å—å¯ä»¥ä¸ºå®ƒæ”¯æŒçš„å„ä¸ªç±»å‹æ³¨å†Œä¸€ä¸ªä¸“é—¨å‡½æ•°ã€‚æŸ¯é‡ŒåŒ–æŸ¯é‡ŒåŒ–ï¼ˆCurryingï¼‰å°†åŸæ¥æ¥å—ä¸¤ä¸ªå‚æ•°çš„å‡½æ•°å˜æˆæ–°çš„æ¥å—ä¸€ä¸ªå‚æ•°çš„å‡½æ•°çš„è¿‡ç¨‹ã€‚æ–°çš„å‡½æ•°è¿”å›ä¸€ä¸ªä»¥åŸæœ‰ç¬¬äºŒä¸ªå‚æ•°ä¸ºå‚æ•°çš„å‡½æ•°ã€‚123456789&gt;# pip install simplecurry -i https://pypi.tuna.tsinghua.edu.cn/simple&gt;from simplecurry import curried&gt;@curried&gt;def add2(a,b,c):return c * a + b&gt;add2(2)(5)(8)   &gt;&gt;&gt;&gt; 21curryåŒ–æœ€å¤§çš„æ„ä¹‰åœ¨äºæŠŠå¤šä¸ªå‚æ•°çš„functionç­‰ä»·è½¬åŒ–æˆå¤šä¸ªå•å‚æ•°functionçš„çº§è”ï¼Œè¿™æ ·æ‰€æœ‰çš„å‡½æ•°å°±éƒ½ç»Ÿä¸€äº†ï¼Œæ–¹ä¾¿åšlambdaæ¼”ç®—ã€‚ åœ¨scalaé‡Œï¼ŒcurryåŒ–å¯¹ç±»å‹æ¨æ¼”ä¹Ÿæœ‰å¸®åŠ©ï¼Œscalaçš„ç±»å‹æ¨æ¼”æ˜¯å±€éƒ¨çš„ï¼Œåœ¨åŒä¸€ä¸ªå‚æ•°åˆ—è¡¨ä¸­åé¢çš„å‚æ•°ä¸èƒ½å€ŸåŠ©å‰é¢çš„å‚æ•°ç±»å‹è¿›è¡Œæ¨æ¼”ï¼ŒcurryåŒ–ä»¥åï¼Œæ”¾åœ¨ä¸¤ä¸ªå‚æ•°åˆ—è¡¨é‡Œï¼Œåé¢ä¸€ä¸ªå‚æ•°åˆ—è¡¨é‡Œçš„å‚æ•°å¯ä»¥å€ŸåŠ©å‰é¢ä¸€ä¸ªå‚æ•°åˆ—è¡¨é‡Œçš„å‚æ•°ç±»å‹è¿›è¡Œæ¨æ¼”ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ foldLeftè¿™ç§å‡½æ•°çš„å®šä¹‰éƒ½æ˜¯curryçš„å½¢å¼ã€‚æ¡ˆä¾‹æ—¶é—´è£…é¥°å™¨è®¡ç®—å‡½æ•°è¿è¡Œæ—¶é—´123456789101112from functools import wraps# ä½œä¸ºè£…é¥°å™¨ä½¿ç”¨ï¼Œè¿”å›å‡½æ•°æ‰§è¡Œéœ€è¦èŠ±è´¹çš„æ—¶é—´def time_this_function(func):    @wraps(func)    def wrapper(*args, **kwargs):        start = time.time()        result = func(*args, **kwargs)        end = time.time()        print(f'{func.__name__}, è€—æ—¶{round(end - start, 4)}s')        return result    return wrapper</content>
	</entry>
	<entry>
		<title>pythoné­”æ³•å‡½æ•°</title>
		<url>/article/42715.html</url>
		<content>(è¯‘)Pythoné­”æ³•æ–¹æ³•æŒ‡å—åŸæ–‡Pythonè¿›é˜¶ï¼šå®ä¾‹è®²è§£Pythonä¸­çš„é­”æ³•å‡½æ•°ï¼ˆMagic Methodsï¼‰é­”æ³•å‡½æ•°æ‰€è°“é­”æ³•å‡½æ•°ï¼ˆMagic Methodsï¼‰ï¼Œæ˜¯Pythonçš„ä¸€ç§é«˜çº§è¯­æ³•ï¼Œå…è®¸ä½ åœ¨ç±»ä¸­è‡ªå®šä¹‰å‡½æ•°ï¼ˆå‡½æ•°åæ ¼å¼ä¸€èˆ¬ä¸º__xx__ï¼‰ï¼Œå¹¶ç»‘å®šåˆ°ç±»çš„ç‰¹æ®Šæ–¹æ³•ä¸­ã€‚æ¯”å¦‚åœ¨ç±»Aä¸­è‡ªå®šä¹‰__str__()å‡½æ•°ï¼Œåˆ™åœ¨è°ƒç”¨str(A())æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨__str__()å‡½æ•°ï¼Œå¹¶è¿”å›ç›¸åº”çš„ç»“æœã€‚åœ¨æˆ‘ä»¬å¹³æ—¶çš„ä½¿ç”¨ä¸­ï¼Œå¯èƒ½ç»å¸¸ä½¿ç”¨__init__å‡½æ•°å’Œ__del\å‡½æ•°ï¼Œå…¶å®è¿™ä¹Ÿæ˜¯é­”æ³•å‡½æ•°çš„ä¸€ç§ã€‚é­”æœ¯æ–¹æ³•ï¼ˆmagic methodï¼‰æ˜¯ç‰¹æ®Šæ–¹æ³•çš„æ˜µç§°ã€‚ç‰¹æ®Šæ–¹æ³•ä¹Ÿå«åŒä¸‹æ–¹æ³•é€šè¿‡å®ç°ç‰¹æ®Šæ–¹æ³•æ¥åˆ©ç”¨ Python æ•°æ®æ¨¡å‹çš„ä¸¤ä¸ªå¥½å¤„ã€‚ä½œä¸ºä½ çš„ç±»çš„ç”¨æˆ·ï¼Œä»–ä»¬ä¸å¿…å»è®°ä½æ ‡å‡†æ“ä½œçš„å„å¼åç§°ï¼ˆâ€œæ€ä¹ˆå¾—åˆ°å…ƒç´ çš„æ€»æ•°ï¼Ÿæ˜¯ .size() è¿˜æ˜¯ .length() è¿˜æ˜¯åˆ«çš„ä»€ä¹ˆï¼Ÿâ€ï¼‰ã€‚å¯ä»¥æ›´åŠ æ–¹ä¾¿åœ°åˆ©ç”¨ Python çš„æ ‡å‡†åº“ï¼Œæ¯”å¦‚ random.choice å‡½æ•°ï¼Œä»è€Œä¸ç”¨é‡æ–°å‘æ˜è½®å­ã€‚ç‰¹æ®Šæ–¹æ³•çš„å­˜åœ¨æ˜¯ä¸ºäº†è¢« Python è§£é‡Šå™¨è°ƒç”¨çš„ï¼Œä½ è‡ªå·±å¹¶ä¸éœ€è¦è°ƒç”¨å®ƒä»¬ã€‚é™¤éæœ‰å¤§é‡çš„å…ƒç¼–ç¨‹å­˜åœ¨ï¼Œç›´æ¥è°ƒç”¨ç‰¹æ®Šæ–¹æ³•çš„é¢‘ç‡åº”è¯¥è¿œè¿œä½äºä½ å»å®ç°å®ƒä»¬çš„æ¬¡æ•°ã€‚å”¯ä¸€çš„ä¾‹å¤–å¯èƒ½æ˜¯ __init__ æ–¹æ³•Python ä¹‹ç¦…â€ä¸­çš„å¦å¤–ä¸€å¥è¯ï¼šâ€œä¸èƒ½è®©ç‰¹ä¾‹ç‰¹æ®Šåˆ°å¼€å§‹ç ´åæ—¢å®šè§„åˆ™ã€‚â€pythonçš„é­”æ³•å‡½æ•°æ€»è¢«åŒä¸‹åˆ’çº¿åŒ…å›´ï¼Œå®ƒä»¬å¯ä»¥ç»™ä½ çš„ç±»å¢åŠ ç‰¹æ®Šçš„æ–¹æ³•ã€‚å¦‚æœä½ çš„å¯¹è±¡å®ç°äº†è¿™äº›æ–¹æ³•ä¸­çš„ä¸€ä¸ªï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•å°±ä¼šåœ¨ç‰¹æ®Šæƒ…å†µä¸‹è¢«è°ƒç”¨ï¼Œä½ å¯ä»¥å®šä¹‰æƒ³è¦çš„è¡Œä¸ºï¼Œè€Œè¿™ä¸€åˆ‡éƒ½æ˜¯è‡ªåŠ¨å‘ç”Ÿçš„ã€‚ä»€ä¹ˆæ˜¯é­”æ³•å‡½æ•°ï¼Ÿ åŸºæœ¬åˆ†ç±»æ„é€ æ–¹æ³•æœ€ä¸ºç†ŸçŸ¥çš„åŸºæœ¬çš„é­”æ³•æ–¹æ³•å°±æ˜¯__init__ ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥æŒ‡æ˜ä¸€ä¸ªå¯¹è±¡åˆå§‹åŒ–çš„è¡Œä¸ºã€‚ç„¶è€Œï¼Œå½“æˆ‘ä»¬è°ƒç”¨ x = SomeClass() çš„æ—¶å€™ï¼Œ __init__ å¹¶ä¸æ˜¯ç¬¬ä¸€ä¸ªè¢«è°ƒç”¨çš„æ–¹æ³•ã€‚äº‹å®ä¸Šï¼Œç¬¬ä¸€ä¸ªè¢«è°ƒç”¨çš„æ˜¯ __new__ ï¼Œè¿™ä¸ªæ–¹æ³•æ‰çœŸæ­£åœ°åˆ›å»ºäº†å®ä¾‹ã€‚å½“è¿™ä¸ªå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸç»“æŸçš„æ—¶å€™ï¼Œ__del__ ä¼šè¢«è°ƒç”¨ã€‚__new__(cls,[â€¦])__new__ æ˜¯å¯¹è±¡å®ä¾‹åŒ–æ—¶ç¬¬ä¸€ä¸ªè°ƒç”¨çš„æ–¹æ³•ï¼Œå®ƒåªå–ä¸‹ cls å‚æ•°ï¼Œå¹¶æŠŠå…¶ä»–å‚æ•°ä¼ ç»™ __init__ ã€‚ __new__ å¾ˆå°‘ä½¿ç”¨ï¼Œä½†æ˜¯ä¹Ÿæœ‰å®ƒé€‚åˆçš„åœºæ™¯ï¼Œå°¤å…¶æ˜¯å½“ç±»ç»§æ‰¿è‡ªä¸€ä¸ªåƒå…ƒç»„æˆ–è€…å­—ç¬¦ä¸²è¿™æ ·ä¸ç»å¸¸æ”¹å˜çš„ç±»å‹çš„æ—¶å€™ã€‚__init__(self,[â€¦])ç±»çš„åˆå§‹åŒ–æ–¹æ³•ã€‚å®ƒè·å–ä»»ä½•ä¼ ç»™æ„é€ å™¨çš„å‚æ•°ï¼ˆæ¯”å¦‚æˆ‘ä»¬è°ƒç”¨ x = SomeClass(10, â€˜fooâ€™) ï¼Œ __init__ å°±ä¼šæ¥åˆ°å‚æ•° 10 å’Œ â€˜fooâ€™ ã€‚ __del__(self)__new__ å’Œ __init__ æ˜¯å¯¹è±¡çš„æ„é€ å™¨ï¼Œ __del__ æ˜¯å¯¹è±¡çš„é”€æ¯å™¨ã€‚å®ƒå¹¶éå®ç°äº†è¯­å¥ del x (å› æ­¤è¯¥è¯­å¥ä¸ç­‰åŒäº x.__del__())ã€‚è€Œæ˜¯å®šä¹‰äº†å½“å¯¹è±¡è¢«åƒåœ¾å›æ”¶æ—¶çš„è¡Œä¸ºã€‚ å½“å¯¹è±¡éœ€è¦åœ¨é”€æ¯æ—¶åšä¸€äº›å¤„ç†çš„æ—¶å€™è¿™ä¸ªæ–¹æ³•å¾ˆæœ‰ç”¨ï¼Œæ¯”å¦‚ socket å¯¹è±¡ã€æ–‡ä»¶å¯¹è±¡ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“Pythonè§£é‡Šå™¨é€€å‡ºä½†å¯¹è±¡ä»ç„¶å­˜æ´»çš„æ—¶å€™ï¼Œ __del__ å¹¶ä¸ä¼š æ‰§è¡Œã€‚ æ‰€ä»¥å…»æˆä¸€ä¸ªæ‰‹å·¥æ¸…ç†çš„å¥½ä¹ æƒ¯æ˜¯å¾ˆé‡è¦çš„ï¼Œæ¯”å¦‚åŠæ—¶å…³é—­è¿æ¥ã€‚æ“ä½œç¬¦ä½¿ç”¨Pythoné­”æ³•æ–¹æ³•çš„ä¸€ä¸ªå·¨å¤§ä¼˜åŠ¿å°±æ˜¯å¯ä»¥æ„å»ºä¸€ä¸ªæ‹¥æœ‰Pythonå†…ç½®ç±»å‹è¡Œä¸ºçš„å¯¹è±¡ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥é¿å…ä½¿ç”¨éæ ‡å‡†çš„ã€ä¸‘é™‹çš„æ–¹å¼æ¥è¡¨è¾¾ç®€å•çš„æ“ä½œã€‚ åœ¨ä¸€äº›è¯­è¨€ä¸­ï¼Œè¿™æ ·åšå¾ˆå¸¸è§:12if instance.equals(other_instance):    # do somethingè¿ç”¨é­”æ³•æ–¹æ³•çš„é­”åŠ›ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰æ–¹æ³• eq12if instance == other_instance:    # do somethingè¿™æ˜¯é­”æ³•åŠ›é‡çš„ä¸€éƒ¨åˆ†ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥åˆ›å»ºä¸€ä¸ªåƒå†…å»ºç±»å‹é‚£æ ·çš„å¯¹è±¡äº†ï¼æ¯”è¾ƒæ“ä½œç¬¦PythonåŒ…å«äº†ä¸€ç³»åˆ—çš„é­”æ³•æ–¹æ³•ï¼Œç”¨äºå®ç°å¯¹è±¡ä¹‹é—´ç›´æ¥æ¯”è¾ƒï¼Œè€Œä¸éœ€è¦é‡‡ç”¨æ–¹æ³•è°ƒç”¨ã€‚åŒæ ·ä¹Ÿå¯ä»¥é‡è½½Pythoné»˜è®¤çš„æ¯”è¾ƒæ–¹æ³•ï¼Œæ”¹å˜å®ƒä»¬çš„è¡Œä¸ºã€‚__cmp__(self, other)__cmp__ æ˜¯æ‰€æœ‰æ¯”è¾ƒé­”æ³•æ–¹æ³•ä¸­æœ€åŸºç¡€çš„ä¸€ä¸ªï¼Œå®ƒå®é™…ä¸Šå®šä¹‰äº†æ‰€æœ‰æ¯”è¾ƒæ“ä½œç¬¦çš„è¡Œä¸ºï¼ˆ&lt;,==,!=,ç­‰ç­‰ï¼‰ï¼Œä½†æ˜¯å®ƒå¯èƒ½ä¸èƒ½æŒ‰ç…§ä½ éœ€è¦çš„æ–¹å¼å·¥ä½œï¼ˆä¾‹å¦‚ï¼Œåˆ¤æ–­ä¸€ä¸ªå®ä¾‹å’Œå¦ä¸€ä¸ªå®ä¾‹æ˜¯å¦ç›¸ç­‰é‡‡ç”¨ä¸€å¥—æ ‡å‡†ï¼Œè€Œä¸åˆ¤æ–­ä¸€ä¸ªå®ä¾‹æ˜¯å¦å¤§äºå¦ä¸€å®ä¾‹é‡‡ç”¨å¦ä¸€å¥—ï¼‰ã€‚ __cmp__ åº”è¯¥åœ¨ self &lt; other æ—¶è¿”å›ä¸€ä¸ªè´Ÿæ•´æ•°ï¼Œåœ¨ self == other æ—¶è¿”å›0ï¼Œåœ¨ self &gt; other æ—¶è¿”å›æ­£æ•´æ•°ã€‚æœ€å¥½åªå®šä¹‰ä½ æ‰€éœ€è¦çš„æ¯”è¾ƒå½¢å¼ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡å®šä¹‰å…¨éƒ¨ã€‚ å¦‚æœä½ éœ€è¦å®ç°æ‰€æœ‰çš„æ¯”è¾ƒå½¢å¼ï¼Œè€Œä¸”å®ƒä»¬çš„åˆ¤æ–­æ ‡å‡†ç±»ä¼¼ï¼Œé‚£ä¹ˆ __cmp__ æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æ–¹æ³•ï¼Œå¯ä»¥å‡å°‘ä»£ç é‡å¤ï¼Œè®©ä»£ç æ›´ç®€æ´ã€‚3.xç‰ˆæœ¬è¢«ç§»é™¤ã€‚__eq__(self, other)å®šä¹‰ç­‰äºæ“ä½œç¬¦(==)çš„è¡Œä¸ºã€‚__ne__(self, other)å®šä¹‰ä¸ç­‰äºæ“ä½œç¬¦(!=)çš„è¡Œä¸ºã€‚__lt__(self, other)å®šä¹‰å°äºæ“ä½œç¬¦(&lt;)çš„è¡Œä¸ºã€‚__gt__(self, other)å®šä¹‰å¤§äºæ“ä½œç¬¦(&gt;)çš„è¡Œä¸ºã€‚__le__(self, other)å®šä¹‰å°äºç­‰äºæ“ä½œç¬¦(&lt;)çš„è¡Œä¸ºã€‚__ge__(self, other)å®šä¹‰å¤§äºç­‰äºæ“ä½œç¬¦(&gt;)çš„è¡Œä¸ºã€‚æ•°å€¼æ“ä½œç¬¦äº”ç±»ï¼šä¸€å…ƒæ“ä½œç¬¦ï¼Œå¸¸è§ç®—æ•°æ“ä½œç¬¦ï¼Œåå°„ç®—æ•°æ“ä½œç¬¦ï¼Œå¢å¼ºèµ‹å€¼æ“ä½œç¬¦ï¼Œå’Œç±»å‹è½¬æ¢æ“ä½œç¬¦ã€‚ä¸€å…ƒæ“ä½œç¬¦ä¸€å…ƒæ“ä½œç¬¦åªæœ‰ä¸€ä¸ªæ“ä½œç¬¦ã€‚__pos__(self)å®ç°å–æ­£æ“ä½œï¼Œä¾‹å¦‚ +some_objectã€‚__neg__(self)å®ç°å–è´Ÿæ“ä½œï¼Œä¾‹å¦‚ -some_objectã€‚__abs__(self)å®ç°å†…å»ºç»å¯¹å€¼å‡½æ•° abs() æ“ä½œã€‚__invert__(self)å®ç°å–åæ“ä½œç¬¦ ~ã€‚__round__(selfï¼Œ n)å®ç°å†…å»ºå‡½æ•° round() ï¼Œn æ˜¯è¿‘ä¼¼å°æ•°ç‚¹çš„ä½æ•°ã€‚__floor__(self)å®ç° math.floor() å‡½æ•°ï¼Œå³å‘ä¸‹å–æ•´ã€‚__ceil__(self)å®ç° math.ceil() å‡½æ•°ï¼Œå³å‘ä¸Šå–æ•´ã€‚__trunc__(self)å®ç° math.trunc() å‡½æ•°ï¼Œå³è·ç¦»é›¶æœ€è¿‘çš„æ•´æ•°ã€‚å¸¸è§ç®—æ•°æ“ä½œç¬¦__add__(self, other)å®ç°åŠ æ³•æ“ä½œã€‚__sub__(self, other)å®ç°å‡æ³•æ“ä½œã€‚__mul__(self, other)å®ç°ä¹˜æ³•æ“ä½œã€‚__floordiv__(self, other)å®ç°ä½¿ç”¨ // æ“ä½œç¬¦çš„æ•´æ•°é™¤æ³•ã€‚__div__(self, other)å®ç°ä½¿ç”¨ / æ“ä½œç¬¦çš„é™¤æ³•ã€‚__truediv__(self, other)å®ç° true é™¤æ³•ï¼Œè¿™ä¸ªå‡½æ•°åªæœ‰ä½¿ç”¨ from __future__ import division æ—¶æ‰æœ‰ä½œç”¨ã€‚__mod__(self, other)å®ç° % å–ä½™æ“ä½œã€‚__divmod__(self, other)å®ç° divmod å†…å»ºå‡½æ•°ã€‚__pow__(self, other[, modulo])å®ç° ** æ“ä½œç¬¦ã€‚__lshift__(self, other)å®ç°å·¦ç§»ä½è¿ç®—ç¬¦ &lt;&lt; ã€‚__rshift__(self, other)å®ç°å³ç§»ä½è¿ç®—ç¬¦ &gt;&gt; ã€‚__and__(self, other)å®ç°æŒ‰ä½ä¸è¿ç®—ç¬¦ &amp; ã€‚__or__(self, other)å®ç°æŒ‰ä½æˆ–è¿ç®—ç¬¦ | ã€‚__xor__(self, other)å®ç°æŒ‰ä½å¼‚æˆ–è¿ç®—ç¬¦ ^ ã€‚åå°„ç®—æ•°è¿ç®—ç¬¦åå°„åªä¸è¿‡æ˜¯è¿ç®—ç¬¦äº¤æ¢äº†ä¸€ä¸‹ä½ç½®ï¼š1some_object + other -&gt; other + some_objectæ‰€æœ‰åå°„è¿ç®—ç¬¦é­”æ³•æ–¹æ³•å’Œå®ƒä»¬çš„å¸¸è§ç‰ˆæœ¬åšçš„å·¥ä½œç›¸åŒï¼Œåªä¸è¿‡æ˜¯å¤„ç†äº¤æ¢è¿ä¸ªæ“ä½œæ•°ä¹‹åçš„æƒ…å†µã€‚ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œåå°„è¿ç®—å’Œæ­£å¸¸é¡ºåºäº§ç”Ÿçš„ç»“æœæ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥å¾ˆå¯èƒ½ä½ å®šä¹‰ __radd__ æ—¶åªæ˜¯è°ƒç”¨ä¸€ä¸‹ __add__ã€‚æ³¨æ„ä¸€ç‚¹ï¼Œæ“ä½œç¬¦å·¦ä¾§çš„å¯¹è±¡ï¼ˆä¹Ÿå°±æ˜¯ä¸Šé¢çš„ other ï¼‰ä¸€å®šä¸è¦å®šä¹‰ï¼ˆæˆ–è€…äº§ç”Ÿ NotImplemented å¼‚å¸¸ï¼‰ æ“ä½œç¬¦çš„éåå°„ç‰ˆæœ¬ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œåªæœ‰å½“ other æ²¡æœ‰å®šä¹‰ __add__ æ—¶ someobject.\_radd__ æ‰ä¼šè¢«è°ƒç”¨ã€‚__radd__(self, other)å®ç°åå°„åŠ æ³•æ“ä½œã€‚__rsub__(self, other)å®ç°åå°„å‡æ³•æ“ä½œã€‚__rmul__(self, other)å®ç°åå°„ä¹˜æ³•æ“ä½œã€‚__rfloordiv__(self, other)å®ç°ä½¿ç”¨ // æ“ä½œç¬¦çš„æ•´æ•°åå°„é™¤æ³•ã€‚__rdiv__(self, other)å®ç°ä½¿ç”¨ / æ“ä½œç¬¦çš„åå°„é™¤æ³•ã€‚__rtruediv__(self, other)å®ç° true åå°„é™¤æ³•ï¼Œè¿™ä¸ªå‡½æ•°åªæœ‰ä½¿ç”¨ from __future__ import division æ—¶æ‰æœ‰ä½œç”¨ã€‚__rmod__(self, other)å®ç° % åå°„å–ä½™æ“ä½œç¬¦ã€‚__rdivmod__(self, other)å®ç°è°ƒç”¨ divmod(other, self) æ—¶ divmod å†…å»ºå‡½æ•°çš„æ“ä½œã€‚__rpow__(self, other[, modulo])å®ç° ** åå°„æ“ä½œç¬¦ã€‚__rlshift__(self, other)å®ç°åå°„å·¦ç§»ä½è¿ç®—ç¬¦ &lt;&lt; çš„ä½œç”¨ã€‚__rshift__(self, other)å®ç°åå°„å³ç§»ä½è¿ç®—ç¬¦ &gt;&gt; çš„ä½œç”¨ã€‚__rand__(self, other)å®ç°åå°„æŒ‰ä½ä¸è¿ç®—ç¬¦ &amp; ã€‚__ror__(self, other)å®ç°åå°„æŒ‰ä½æˆ–è¿ç®—ç¬¦ | ã€‚__rxor__(self, other)å®ç°åå°„æŒ‰ä½å¼‚æˆ–è¿ç®—ç¬¦ ^ ã€‚å¢å¼ºèµ‹å€¼è¿ç®—ç¬¦PythonåŒæ ·æä¾›äº†å¤§é‡çš„é­”æ³•æ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥è‡ªå®šä¹‰å¢å¼ºèµ‹å€¼æ“ä½œçš„è¡Œä¸ºã€‚å¢å¼ºèµ‹å€¼èåˆäº†â€œå¸¸è§â€çš„æ“ä½œç¬¦å’Œèµ‹å€¼æ“ä½œï¼Œçœ‹ä¸‹é¢çš„ä¾‹å­:12x = 5x += 1 # ä¹Ÿå°±æ˜¯ x = x + 1è¿™äº›æ–¹æ³•éƒ½åº”è¯¥è¿”å›å·¦ä¾§æ“ä½œæ•°åº”è¯¥è¢«èµ‹äºˆçš„å€¼ã€‚__iadd__(self, other)å®ç°åŠ æ³•èµ‹å€¼æ“ä½œã€‚__isub__(self, other)å®ç°å‡æ³•èµ‹å€¼æ“ä½œã€‚__imul__(self, other)å®ç°ä¹˜æ³•èµ‹å€¼æ“ä½œã€‚__ifloordiv__(self, other)å®ç°ä½¿ç”¨ //= æ“ä½œç¬¦çš„æ•´æ•°é™¤æ³•èµ‹å€¼æ“ä½œã€‚__idiv__(self, other)å®ç°ä½¿ç”¨ /= æ“ä½œç¬¦çš„é™¤æ³•èµ‹å€¼æ“ä½œã€‚__itruediv__(self, other)å®ç° true é™¤æ³•èµ‹å€¼æ“ä½œï¼Œè¿™ä¸ªå‡½æ•°åªæœ‰ä½¿ç”¨ from __future__ import division æ—¶æ‰æœ‰ä½œç”¨ã€‚__imod__(self, other)å®ç° %= å–ä½™èµ‹å€¼æ“ä½œã€‚__ipow__å®ç° **= æ“ä½œã€‚__ilshift__(self, other)å®ç°å·¦ç§»ä½èµ‹å€¼è¿ç®—ç¬¦ &lt;&lt;= ã€‚__irshift__(self, other)å®ç°å³ç§»ä½èµ‹å€¼è¿ç®—ç¬¦ &gt;&gt;= ã€‚__iand__(self, other)å®ç°æŒ‰ä½ä¸è¿ç®—ç¬¦ &amp;= ã€‚__ior__(self, other)å®ç°æŒ‰ä½æˆ–èµ‹å€¼è¿ç®—ç¬¦ |= ã€‚__ixor__(self, other)å®ç°æŒ‰ä½å¼‚æˆ–èµ‹å€¼è¿ç®—ç¬¦ ^= ã€‚ç±»å‹è½¬æ¢æ“ä½œç¬¦__int__(self)å®ç°åˆ°intçš„ç±»å‹è½¬æ¢ã€‚__long__(self)å®ç°åˆ°longçš„ç±»å‹è½¬æ¢ã€‚__float__(self)å®ç°åˆ°floatçš„ç±»å‹è½¬æ¢ã€‚__complex__(self)å®ç°åˆ°complexçš„ç±»å‹è½¬æ¢ã€‚__oct__(self)å®ç°åˆ°å…«è¿›åˆ¶æ•°çš„ç±»å‹è½¬æ¢ã€‚__hex__(self)å®ç°åˆ°åå…­è¿›åˆ¶æ•°çš„ç±»å‹è½¬æ¢ã€‚__index__(self)å®ç°å½“å¯¹è±¡ç”¨äºåˆ‡ç‰‡è¡¨è¾¾å¼æ—¶åˆ°ä¸€ä¸ªæ•´æ•°çš„ç±»å‹è½¬æ¢ã€‚å¦‚æœä½ å®šä¹‰äº†ä¸€ä¸ªå¯èƒ½ä¼šç”¨äºåˆ‡ç‰‡æ“ä½œçš„æ•°å€¼ç±»å‹ï¼Œä½ åº”è¯¥å®šä¹‰ __index__ã€‚__trunc__(self)å½“è°ƒç”¨ math.trunc(self) æ—¶è°ƒç”¨è¯¥æ–¹æ³•ï¼Œ __trunc__ åº”è¯¥è¿”å› self æˆªå–åˆ°ä¸€ä¸ªæ•´æ•°ç±»å‹ï¼ˆé€šå¸¸æ˜¯longç±»å‹ï¼‰çš„å€¼ã€‚__coerce__(self)è¯¥æ–¹æ³•ç”¨äºå®ç°æ··åˆæ¨¡å¼ç®—æ•°è¿ç®—ï¼Œå¦‚æœä¸èƒ½è¿›è¡Œç±»å‹è½¬æ¢ï¼Œ __coerce__ åº”è¯¥è¿”å› None ã€‚åä¹‹ï¼Œå®ƒåº”è¯¥è¿”å›ä¸€ä¸ªäºŒå…ƒç»„ self å’Œ other ï¼Œè¿™ä¸¤è€…å‡å·²è¢«è½¬æ¢æˆç›¸åŒçš„ç±»å‹ã€‚å› ä¸ºå’Œå…¶ä»–é­”æ³•æ–¹æ³•æœ‰åŠŸèƒ½ä¸Šçš„é‡å¤ï¼Œä»¥åŠæœ¬èº«è¡Œä¸ºä»¤äººè¿·æƒ‘ã€‚åœ¨python3.xç‰ˆæœ¬å·²è¢«ç§»é™¤ã€‚ç±»çš„è¡¨ç¤ºä½¿ç”¨å­—ç¬¦ä¸²æ¥è¡¨ç¤ºç±»æ˜¯ä¸€ä¸ªç›¸å½“æœ‰ç”¨çš„ç‰¹æ€§ã€‚åœ¨Pythonä¸­æœ‰ä¸€äº›å†…å»ºæ–¹æ³•å¯ä»¥è¿”å›ç±»çš„è¡¨ç¤ºï¼Œç›¸å¯¹åº”çš„ï¼Œä¹Ÿæœ‰ä¸€ç³»åˆ—é­”æ³•æ–¹æ³•å¯ä»¥ç”¨æ¥è‡ªå®šä¹‰åœ¨ä½¿ç”¨è¿™äº›å†…å»ºå‡½æ•°æ—¶ç±»çš„è¡Œä¸ºã€‚__str__(self)å®šä¹‰å¯¹ç±»çš„å®ä¾‹è°ƒç”¨ str() æ—¶çš„è¡Œä¸ºã€‚__repr__(self)å®šä¹‰å¯¹ç±»çš„å®ä¾‹è°ƒç”¨ repr() æ—¶çš„è¡Œä¸ºã€‚ str() å’Œ repr() æœ€ä¸»è¦çš„å·®åˆ«åœ¨äºâ€œç›®æ ‡ç”¨æˆ·â€ã€‚ repr() çš„ä½œç”¨æ˜¯äº§ç”Ÿæœºå™¨å¯è¯»çš„è¾“å‡ºï¼ˆå¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œå…¶è¾“å‡ºå¯ä»¥ä½œä¸ºæœ‰æ•ˆçš„Pythonä»£ç ï¼‰ï¼Œè€Œ str() åˆ™äº§ç”Ÿäººç±»å¯è¯»çš„è¾“å‡ºã€‚__repr__ æ‰€è¿”å›çš„å­—ç¬¦ä¸²åº”è¯¥å‡†ç¡®ã€æ— æ­§ä¹‰ï¼Œå¹¶ä¸”å°½å¯èƒ½è¡¨è¾¾å‡ºå¦‚ä½•ç”¨ä»£ç åˆ›å»ºå‡ºè¿™ä¸ªè¢«æ‰“å°çš„å¯¹è±¡ã€‚__repr__ å’Œ __str__ çš„åŒºåˆ«åœ¨äºï¼Œåè€…æ˜¯åœ¨ str() å‡½æ•°è¢«ä½¿ç”¨ï¼Œæˆ–æ˜¯åœ¨ç”¨ print å‡½æ•°æ‰“å°ä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™æ‰è¢«è°ƒç”¨çš„ï¼Œå¹¶ä¸”å®ƒè¿”å›çš„å­—ç¬¦ä¸²å¯¹ç»ˆç«¯ç”¨æˆ·æ›´å‹å¥½ã€‚å¦‚æœä½ åªæƒ³å®ç°è¿™ä¸¤ä¸ªç‰¹æ®Šæ–¹æ³•ä¸­çš„ä¸€ä¸ªï¼Œ__repr__ æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Œå› ä¸ºå¦‚æœä¸€ä¸ªå¯¹è±¡æ²¡æœ‰ __str__ å‡½æ•°ï¼Œè€Œ Python åˆéœ€è¦è°ƒç”¨å®ƒçš„æ—¶å€™ï¼Œè§£é‡Šå™¨ä¼šç”¨ __repr__ä½œä¸ºæ›¿ä»£ã€‚è‡ªåŠ¨åŒ–__repr__å®ç°é¦–å…ˆå®šä¹‰ä¸€ä¸ªå…ƒç±»æ¥è·å– __init_\_()å‡½æ•°çš„å‚æ•°åˆ—è¡¨12345678910111213141516171819202122232425262728#!/usr/bin/env Python# -- coding: utf-8 --&quot;&quot;&quot;@version: v0.1@author: narutohyc@file: meta_interface.py@Description: @time: 2020/6/15 20:29&quot;&quot;&quot;import collectionsfrom abc import (ABC,                 abstractmethod,                 ABCMeta)import inspectclass DicMetaClass(ABCMeta):    def __new__(cls, name, bases, attrs, **kwargs):        if name == 'DicMeta':            return super().__new__(cls, name, bases, attrs, **kwargs)        # è·å–__init__å‡½æ•°çš„ é»˜è®¤å€¼        argspec = inspect.getfullargspec(attrs[&quot;__init__&quot;])        init_defaults = dict(zip(argspec.args[-len(argspec.defaults):], argspec.defaults))        cls.__init_defaults = init_defaults        attrs['__init_defaults__'] = init_defaults        attrs['__init_args__'] = argspec.args[1:]        return super().__new__(cls, name, bases, attrs, **kwargs)è¿™é‡Œå®šä¹‰ä¸€ä¸ªæŠ½è±¡ç±»æ¥å®ç°__repr__æ–¹æ³•12345678910111213141516171819202122232425262728293031class DicMeta(ABC, metaclass=DicMetaClass):    def __init__(self):        super(DicMeta, self).__init__()    @abstractmethod    def to_dict(self):        '''        è¿”å›å­—å…¸        '''        pass    def __repr__(self):        '''        __repr__() ç”Ÿæˆçš„æ–‡æœ¬å­—ç¬¦ä¸²æ ‡å‡†åšæ³•æ˜¯éœ€è¦è®© eval(repr(x)) == x ä¸ºçœŸã€‚        å¦‚æœå®åœ¨ä¸èƒ½è¿™æ ·å­åšï¼Œåº”è¯¥åˆ›å»ºä¸€ä¸ªæœ‰ç”¨çš„æ–‡æœ¬è¡¨ç¤ºï¼Œå¹¶ä½¿ç”¨ &lt; å’Œ &gt; æ‹¬èµ·æ¥ã€‚        '''        return f&quot;{self.__class__.__name__}({', '.join(['%s=%r' % (k, type(self.__dict__[k])(self.__dict__[k])) for k in self.__init_args__ if k in self.__dict__.keys()])})&quot;    def __str__(self):        self.__repr__()    @classmethod    def load_from_mapping(cls, mapping_datas):        '''        ç”¨å­—å…¸æ¥æ„å»ºå®ä¾‹å¯¹è±¡        '''        assert isinstance(mapping_datas, collections.abc.Mapping)        obj = cls.__new__(cls)        [setattr(obj, k, v) for k, v in mapping_datas.items()]        return objè¿™æ ·çš„è¯ï¼Œç»§æ‰¿è‡ªDicMetaçš„å­ç±»éƒ½æœ‰äº†__repr__æ–¹æ³•çš„é»˜è®¤å®ç°äº†ï¼Œæ‰§è¡Œeval(repr(sample))ï¼Œå°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªsampleäº†ã€‚__unicode__(self)å®šä¹‰å¯¹ç±»çš„å®ä¾‹è°ƒç”¨ unicode() æ—¶çš„è¡Œä¸ºã€‚ unicode() å’Œ str() å¾ˆåƒï¼Œåªæ˜¯å®ƒè¿”å›unicodeå­—ç¬¦ä¸²ã€‚æ³¨æ„ï¼Œå¦‚æœè°ƒç”¨è€…è¯•å›¾è°ƒç”¨ str() è€Œä½ çš„ç±»åªå®ç°äº† __unicode__() ï¼Œé‚£ä¹ˆç±»å°†ä¸èƒ½æ­£å¸¸å·¥ä½œã€‚æ‰€æœ‰ä½ åº”è¯¥æ€»æ˜¯å®šä¹‰ __str__() ï¼Œä»¥é˜²æœ‰äº›äººæ²¡æœ‰é—²æƒ…é›…è‡´æ¥ä½¿ç”¨unicodeã€‚Python 3ä¸­stringå’Œunicodeçš„åŒºåˆ«ä¸å¤å­˜åœ¨ï¼Œå› æ­¤ __unicode__ è¢«å–æ¶ˆäº†ï¼Œ __bytes__ åŠ å…¥è¿›æ¥ï¼ˆä¸Python 2.7 ä¸­çš„ __str__ å’Œ __unicode__ è¡Œä¸ºç±»ä¼¼ï¼‰ï¼Œç”¨äºæ–°çš„åˆ›å»ºå­—èŠ‚æ•°ç»„çš„å†…å»ºæ–¹æ³•ã€‚__format__(self)å®šä¹‰å½“ç±»çš„å®ä¾‹ç”¨äºæ–°å¼å­—ç¬¦ä¸²æ ¼å¼åŒ–æ—¶çš„è¡Œä¸ºï¼Œä¾‹å¦‚ï¼Œ â€œHello, 0:abc!â€.format(a) ä¼šå¯¼è‡´è°ƒç”¨ a.__format__(â€œabcâ€) ã€‚å½“å®šä¹‰ä½ è‡ªå·±çš„æ•°å€¼ç±»å‹æˆ–å­—ç¬¦ä¸²ç±»å‹æ—¶ï¼Œä½ å¯èƒ½æƒ³æä¾›æŸäº›ç‰¹æ®Šçš„æ ¼å¼åŒ–é€‰é¡¹ï¼Œè¿™ç§æƒ…å†µä¸‹è¿™ä¸ªé­”æ³•æ–¹æ³•ä¼šéå¸¸æœ‰ç”¨ã€‚__hash__(self)å®šä¹‰å¯¹ç±»çš„å®ä¾‹è°ƒç”¨ hash() æ—¶çš„è¡Œä¸ºã€‚å®ƒå¿…é¡»è¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œå…¶ç»“æœä¼šè¢«ç”¨äºå­—å…¸ä¸­é”®çš„å¿«é€Ÿæ¯”è¾ƒã€‚åŒæ—¶æ³¨æ„ä¸€ç‚¹ï¼Œå®ç°è¿™ä¸ªé­”æ³•æ–¹æ³•é€šå¸¸ä¹Ÿéœ€è¦å®ç° __eq__ ï¼Œå¹¶ä¸”éµå®ˆå¦‚ä¸‹çš„è§„åˆ™ï¼š a == b æ„å‘³ç€ hash(a) == hash(b)ã€‚__nonzero__(self)å®šä¹‰å¯¹ç±»çš„å®ä¾‹è°ƒç”¨ bool() æ—¶çš„è¡Œä¸ºï¼Œæ ¹æ®ä½ è‡ªå·±å¯¹ç±»çš„è®¾è®¡ï¼Œé’ˆå¯¹ä¸åŒçš„å®ä¾‹ï¼Œè¿™ä¸ªé­”æ³•æ–¹æ³•åº”è¯¥ç›¸åº”åœ°è¿”å›Trueæˆ–Falseã€‚3.xä¸­è¢«é‡å‘½åæˆ __bool__ ã€‚bool(x) çš„èƒŒåæ˜¯è°ƒç”¨ x.__bool__() çš„ç»“æœï¼›å¦‚æœä¸å­˜åœ¨ __bool__ æ–¹æ³•ï¼Œé‚£ä¹ˆ bool(x) ä¼šå°è¯•è°ƒç”¨ x.__len__()ã€‚è‹¥è¿”å› 0ï¼Œåˆ™ bool ä¼šè¿”å› Falseï¼›å¦åˆ™è¿”å› Trueã€‚__dir__(self)å®šä¹‰å¯¹ç±»çš„å®ä¾‹è°ƒç”¨ dir() æ—¶çš„è¡Œä¸ºï¼Œè¿™ä¸ªæ–¹æ³•åº”è¯¥å‘è°ƒç”¨è€…è¿”å›ä¸€ä¸ªå±æ€§åˆ—è¡¨ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæ²¡å¿…è¦è‡ªå·±å®ç° __dir__ ã€‚ä½†æ˜¯å¦‚æœä½ é‡å®šä¹‰äº† __getattr__ æˆ–è€… __getattribute__ ï¼ˆä¸‹ä¸ªéƒ¨åˆ†ä¼šä»‹ç»ï¼‰ï¼Œä¹ƒè‡³ä½¿ç”¨åŠ¨æ€ç”Ÿæˆçš„å±æ€§ï¼Œä»¥å®ç°ç±»çš„äº¤äº’å¼ä½¿ç”¨ï¼Œé‚£ä¹ˆè¿™ä¸ªé­”æ³•æ–¹æ³•æ˜¯å¿…ä¸å¯å°‘çš„ã€‚è®¿é—®æ§åˆ¶å¾ˆå¤šä»å…¶ä»–è¯­è¨€è½¬å‘Pythonçš„äººéƒ½æŠ±æ€¨Pythonçš„ç±»ç¼ºå°‘çœŸæ­£æ„ä¹‰ä¸Šçš„å°è£…ï¼ˆå³æ²¡åŠæ³•å®šä¹‰ç§æœ‰å±æ€§ç„¶åä½¿ç”¨å…¬æœ‰çš„getterå’Œsetterï¼‰ã€‚ç„¶è€Œäº‹å®å¹¶éå¦‚æ­¤ã€‚å®é™…ä¸ŠPythonä¸æ˜¯é€šè¿‡æ˜¾å¼å®šä¹‰çš„å­—æ®µå’Œæ–¹æ³•ä¿®æ”¹å™¨ï¼Œè€Œæ˜¯é€šè¿‡é­”æ³•æ–¹æ³•å®ç°äº†ä¸€ç³»åˆ—çš„å°è£…ã€‚__getattr__(self, name)å½“ç”¨æˆ·è¯•å›¾è®¿é—®ä¸€ä¸ªæ ¹æœ¬ä¸å­˜åœ¨ï¼ˆæˆ–è€…æš‚æ—¶ä¸å­˜åœ¨ï¼‰çš„å±æ€§æ—¶ï¼Œä½ å¯ä»¥é€šè¿‡è¿™ä¸ªé­”æ³•æ–¹æ³•æ¥å®šä¹‰ç±»çš„è¡Œä¸ºã€‚è¿™ä¸ªå¯ä»¥ç”¨äºæ•æ‰é”™è¯¯çš„æ‹¼å†™å¹¶ä¸”ç»™å‡ºæŒ‡å¼•ï¼Œä½¿ç”¨åºŸå¼ƒå±æ€§æ—¶ç»™å‡ºè­¦å‘Šï¼ˆå¦‚æœä½ æ„¿æ„ï¼Œä»ç„¶å¯ä»¥è®¡ç®—å¹¶ä¸”è¿”å›è¯¥å±æ€§ï¼‰ï¼Œä»¥åŠçµæ´»åœ°å¤„ç†AttributeErrorã€‚åªæœ‰å½“è¯•å›¾è®¿é—®ä¸å­˜åœ¨çš„å±æ€§æ—¶å®ƒæ‰ä¼šè¢«è°ƒç”¨ï¼Œæ‰€ä»¥è¿™ä¸èƒ½ç®—æ˜¯ä¸€ä¸ªçœŸæ­£çš„å°è£…çš„åŠæ³•ã€‚__setattr__(self, name, value)å’Œ __getattr__ ä¸åŒï¼Œ __setattr__ å¯ä»¥ç”¨äºçœŸæ­£æ„ä¹‰ä¸Šçš„å°è£…ã€‚å®ƒå…è®¸ä½ è‡ªå®šä¹‰æŸä¸ªå±æ€§çš„èµ‹å€¼è¡Œä¸ºï¼Œä¸ç®¡è¿™ä¸ªå±æ€§å­˜åœ¨ä¸å¦ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ å¯ä»¥å¯¹ä»»æ„å±æ€§çš„ä»»ä½•å˜åŒ–éƒ½å®šä¹‰è‡ªå·±çš„è§„åˆ™ã€‚ç„¶åï¼Œä¸€å®šè¦å°å¿ƒä½¿ç”¨ __setattr__ ï¼Œè¿™ä¸ªåˆ—è¡¨æœ€åçš„ä¾‹å­ä¸­ä¼šæœ‰æ‰€å±•ç¤ºã€‚__delattr__(self, name)è¿™ä¸ªé­”æ³•æ–¹æ³•å’Œ __setattr__ å‡ ä¹ç›¸åŒï¼Œåªä¸è¿‡å®ƒæ˜¯ç”¨äºå¤„ç†åˆ é™¤å±æ€§æ—¶çš„è¡Œä¸ºã€‚å’Œ setattr\_ ä¸€æ ·ï¼Œä½¿ç”¨å®ƒæ—¶ä¹Ÿéœ€è¦å¤šåŠ å°å¿ƒï¼Œé˜²æ­¢äº§ç”Ÿæ— é™é€’å½’ï¼ˆåœ¨ __delattr__ çš„å®ç°ä¸­è°ƒç”¨ del self.name ä¼šå¯¼è‡´æ— é™é€’å½’ï¼‰ã€‚__getattribute__(self, name)__getattribute__ çœ‹èµ·æ¥å’Œä¸Šé¢é‚£äº›æ–¹æ³•å¾ˆåˆå¾—æ¥ï¼Œä½†æ˜¯æœ€å¥½ä¸è¦ä½¿ç”¨å®ƒã€‚ __getattribute__ åªèƒ½ç”¨äºæ–°å¼ç±»ã€‚åœ¨æœ€æ–°ç‰ˆçš„Pythonä¸­æ‰€æœ‰çš„ç±»éƒ½æ˜¯æ–°å¼ç±»ï¼Œåœ¨è€ç‰ˆPythonä¸­ä½ å¯ä»¥é€šè¿‡ç»§æ‰¿ object æ¥åˆ›å»ºæ–°å¼ç±»ã€‚ __getattribute__ å…è®¸ä½ è‡ªå®šä¹‰å±æ€§è¢«è®¿é—®æ—¶çš„è¡Œä¸ºï¼Œå®ƒä¹ŸåŒæ ·å¯èƒ½é‡åˆ°æ— é™é€’å½’é—®é¢˜ï¼ˆé€šè¿‡è°ƒç”¨åŸºç±»çš„ __getattribute__ æ¥é¿å…ï¼‰ã€‚ __getattribute__ åŸºæœ¬ä¸Šå¯ä»¥æ›¿ä»£ __getattr__ ã€‚åªæœ‰å½“å®ƒè¢«å®ç°ï¼Œå¹¶ä¸”æ˜¾å¼åœ°è¢«è°ƒç”¨ï¼Œæˆ–è€…äº§ç”Ÿ AttributeError æ—¶å®ƒæ‰è¢«ä½¿ç”¨ã€‚ è¿™ä¸ªé­”æ³•æ–¹æ³•å¯ä»¥è¢«ä½¿ç”¨ï¼ˆæ¯•ç«Ÿï¼Œé€‰æ‹©æƒåœ¨ä½ è‡ªå·±ï¼‰ï¼Œæˆ‘ä¸æ¨èä½ ä½¿ç”¨å®ƒï¼Œå› ä¸ºå®ƒçš„ä½¿ç”¨èŒƒå›´ç›¸å¯¹æœ‰é™ï¼ˆé€šå¸¸æˆ‘ä»¬æƒ³è¦åœ¨èµ‹å€¼æ—¶è¿›è¡Œç‰¹æ®Šæ“ä½œï¼Œè€Œä¸æ˜¯å–å€¼æ—¶ï¼‰ï¼Œè€Œä¸”å®ç°è¿™ä¸ªæ–¹æ³•å¾ˆå®¹æ˜“å‡ºç°Bugã€‚è‡ªå®šä¹‰è¿™äº›æ§åˆ¶å±æ€§è®¿é—®çš„é­”æ³•æ–¹æ³•å¾ˆå®¹æ˜“å¯¼è‡´é—®é¢˜ï¼Œè€ƒè™‘ä¸‹é¢è¿™ä¸ªä¾‹å­:1234567def __setattr__(self, name. value):    self.name = value# å› ä¸ºæ¯æ¬¡å±æ€§å¹…å€¼éƒ½è¦è°ƒç”¨ __setattr__()ï¼Œæ‰€ä»¥è¿™é‡Œçš„å®ç°ä¼šå¯¼è‡´é€’å½’def __setattr__(self, name, value):    self.__dict__[name] = value # ä½¿ç”¨ __dict__ è¿›è¡Œèµ‹å€¼    # å®šä¹‰è‡ªå®šä¹‰è¡Œä¸ºå†æ¬¡é‡ç”³ï¼ŒPythonçš„é­”æ³•æ–¹æ³•ååˆ†å¼ºå¤§ï¼Œèƒ½åŠ›è¶Šå¼ºè´£ä»»è¶Šå¤§ï¼Œäº†è§£å¦‚ä½•æ­£ç¡®çš„ä½¿ç”¨é­”æ³•æ–¹æ³•æ›´åŠ é‡è¦ã€‚åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å¯¹Pythonä¸­è‡ªå®šä¹‰å±æ€§å­˜å–æ§åˆ¶æœ‰äº†ä»€ä¹ˆæ ·çš„å°è±¡ï¼Ÿå®ƒå¹¶ä¸é€‚åˆè½»åº¦çš„ä½¿ç”¨ã€‚å®é™…ä¸Šï¼Œå®ƒæœ‰äº›è¿‡åˆ†å¼ºå¤§ï¼Œè€Œä¸”è¿åç›´è§‰ã€‚ç„¶è€Œå®ƒä¹‹æ‰€ä»¥å­˜åœ¨ï¼Œæ˜¯å› ä¸ºä¸€ä¸ªæ›´å¤§çš„åŸåˆ™ï¼šPythonä¸æŒ‡æœ›è®©æœç»åäº‹å‘ç”Ÿï¼Œè€Œæ˜¯æƒ³åŠæ³•è®©åšåäº‹å˜å¾—å›°éš¾ã€‚è‡ªç”±æ˜¯è‡³é«˜æ— ä¸Šçš„æƒåˆ©ï¼Œä½ çœŸçš„å¯ä»¥éšå¿ƒæ‰€æ¬²ã€‚ä¸‹é¢çš„ä¾‹å­å±•ç¤ºäº†å®é™…åº”ç”¨ä¸­æŸäº›ç‰¹æ®Šçš„å±æ€§è®¿é—®æ–¹æ³•ï¼ˆæ³¨æ„æˆ‘ä»¬ä¹‹æ‰€ä»¥ä½¿ç”¨ super æ˜¯å› ä¸ºä¸æ˜¯æ‰€æœ‰çš„ç±»éƒ½æœ‰ __dict__ å±æ€§ï¼‰:è‡ªå®šä¹‰åºåˆ—æœ‰è®¸å¤šåŠæ³•å¯ä»¥è®©ä½ çš„Pythonç±»è¡¨ç°å¾—åƒæ˜¯å†…å»ºåºåˆ—ç±»å‹ï¼ˆå­—å…¸ï¼Œå…ƒç»„ï¼Œåˆ—è¡¨ï¼Œå­—ç¬¦ä¸²ç­‰ï¼‰ã€‚è¿™äº›é­”æ³•æ–¹å¼æ˜¯ç›®å‰ä¸ºæ­¢æˆ‘æœ€å–œæ¬¢çš„ã€‚å®ƒä»¬ç»™äº†ä½ éš¾ä»¥ç½®ä¿¡çš„æ§åˆ¶èƒ½åŠ›ï¼Œå¯ä»¥è®©ä½ çš„ç±»ä¸ä¸€ç³»åˆ—çš„å…¨å±€å‡½æ•°å®Œç¾ç»“åˆã€‚åœ¨Pythonä¸­ï¼Œåè®®å®Œå…¨æ˜¯éæ­£å¼çš„ï¼Œä¹Ÿä¸éœ€è¦æ˜¾å¼çš„å£°æ˜ï¼Œäº‹å®ä¸Šï¼Œå®ƒä»¬æ›´åƒæ˜¯ä¸€ç§å‚è€ƒæ ‡å‡†ã€‚ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦è®²åè®®ï¼Ÿå› ä¸ºåœ¨Pythonä¸­å®ç°è‡ªå®šä¹‰å®¹å™¨ç±»å‹éœ€è¦ç”¨åˆ°ä¸€äº›åè®®ã€‚é¦–å…ˆï¼Œä¸å¯å˜å®¹å™¨ç±»å‹æœ‰å¦‚ä¸‹åè®®ï¼šæƒ³å®ç°ä¸€ä¸ªä¸å¯å˜å®¹å™¨ï¼Œä½ éœ€è¦å®šä¹‰ __len__ å’Œ __getitem__ (åé¢ä¼šå…·ä½“è¯´æ˜ï¼‰ã€‚å¯å˜å®¹å™¨çš„åè®®é™¤äº†ä¸Šé¢æåˆ°çš„ä¸¤ä¸ªæ–¹æ³•ä¹‹å¤–ï¼Œè¿˜éœ€è¦å®šä¹‰ __setitem__ å’Œ __delitem__ ã€‚æœ€åï¼Œå¦‚æœä½ æƒ³è®©ä½ çš„å¯¹è±¡å¯ä»¥è¿­ä»£ï¼Œä½ éœ€è¦å®šä¹‰ __iter__ ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªè¿­ä»£å™¨ã€‚è¿­ä»£å™¨å¿…é¡»éµå®ˆè¿­ä»£å™¨åè®®ï¼Œéœ€è¦å®šä¹‰ __iter__ ï¼ˆè¿”å›å®ƒè‡ªå·±ï¼‰å’Œ next æ–¹æ³•ã€‚å®¹å™¨ç›¸å…³__len__(self)è¿”å›å®¹å™¨çš„é•¿åº¦ï¼Œå¯å˜å’Œä¸å¯å˜ç±»å‹éƒ½éœ€è¦å®ç°ã€‚__getitem__(self, key)å®šä¹‰å¯¹å®¹å™¨ä¸­æŸä¸€é¡¹ä½¿ç”¨ self[key] çš„æ–¹å¼è¿›è¡Œè¯»å–æ“ä½œæ—¶çš„è¡Œä¸ºã€‚è¿™ä¹Ÿæ˜¯å¯å˜å’Œä¸å¯å˜å®¹å™¨ç±»å‹éƒ½éœ€è¦å®ç°çš„ä¸€ä¸ªæ–¹æ³•ã€‚å®ƒåº”è¯¥åœ¨é”®çš„ç±»å‹é”™è¯¯å¼äº§ç”Ÿ TypeError å¼‚å¸¸ï¼ŒåŒæ—¶åœ¨æ²¡æœ‰ä¸é”®å€¼ç›¸åŒ¹é…çš„å†…å®¹æ—¶äº§ç”Ÿ KeyError å¼‚å¸¸ã€‚__setitem__(self, key)å®šä¹‰å¯¹å®¹å™¨ä¸­æŸä¸€é¡¹ä½¿ç”¨ self[key] çš„æ–¹å¼è¿›è¡Œèµ‹å€¼æ“ä½œæ—¶çš„è¡Œä¸ºã€‚å®ƒæ˜¯å¯å˜å®¹å™¨ç±»å‹å¿…é¡»å®ç°çš„ä¸€ä¸ªæ–¹æ³•ï¼ŒåŒæ ·åº”è¯¥åœ¨åˆé€‚çš„æ—¶å€™äº§ç”Ÿ KeyError å’Œ TypeError å¼‚å¸¸ã€‚__iter__(self, key)å®ƒåº”è¯¥è¿”å›å½“å‰å®¹å™¨çš„ä¸€ä¸ªè¿­ä»£å™¨ã€‚è¿­ä»£å™¨ä»¥ä¸€è¿ä¸²å†…å®¹çš„å½¢å¼è¿”å›ï¼Œæœ€å¸¸è§çš„æ˜¯ä½¿ç”¨ iter() å‡½æ•°è°ƒç”¨ï¼Œä»¥åŠåœ¨ç±»ä¼¼ for x in container: çš„å¾ªç¯ä¸­è¢«è°ƒç”¨ã€‚è¿­ä»£å™¨æ˜¯ä»–ä»¬è‡ªå·±çš„å¯¹è±¡ï¼Œéœ€è¦å®šä¹‰ __iter__ æ–¹æ³•å¹¶åœ¨å…¶ä¸­è¿”å›è‡ªå·±ã€‚ç‰¹æ®Šæ–¹æ³•çš„è°ƒç”¨æ˜¯éšå¼çš„ï¼Œæ¯”å¦‚ for i in x: è¿™ä¸ªè¯­å¥ï¼ŒèƒŒåå…¶å®ç”¨çš„æ˜¯ iter(x)ï¼Œè€Œè¿™ä¸ªå‡½æ•°çš„èƒŒååˆ™æ˜¯ x.__iter__() æ–¹æ³•ã€‚å½“ç„¶å‰ææ˜¯è¿™ä¸ªæ–¹æ³•åœ¨ x ä¸­è¢«å®ç°äº†ã€‚__reversed__(self)å®šä¹‰äº†å¯¹å®¹å™¨ä½¿ç”¨ reversed() å†…å»ºå‡½æ•°æ—¶çš„è¡Œä¸ºã€‚å®ƒåº”è¯¥è¿”å›ä¸€ä¸ªåè½¬ä¹‹åçš„åºåˆ—ã€‚å½“ä½ çš„åºåˆ—ç±»æ˜¯æœ‰åºæ—¶ï¼Œç±»ä¼¼åˆ—è¡¨å’Œå…ƒç»„ï¼Œå†å®ç°è¿™ä¸ªæ–¹æ³•ï¼Œ__contains__(self, item)__contains__ å®šä¹‰äº†ä½¿ç”¨ in å’Œ not in è¿›è¡Œæˆå‘˜æµ‹è¯•æ—¶ç±»çš„è¡Œä¸ºã€‚ä½ å¯èƒ½å¥½å¥‡ä¸ºä»€ä¹ˆè¿™ä¸ªæ–¹æ³•ä¸æ˜¯åºåˆ—åè®®çš„ä¸€éƒ¨åˆ†ï¼ŒåŸå› æ˜¯ï¼Œå¦‚æœ __contains__ æ²¡æœ‰å®šä¹‰ï¼ŒPythonå°±ä¼šè¿­ä»£æ•´ä¸ªåºåˆ—ï¼Œå¦‚æœæ‰¾åˆ°äº†éœ€è¦çš„ä¸€é¡¹å°±è¿”å› True ã€‚è¿­ä»£é€šå¸¸æ˜¯éšå¼çš„ï¼Œè­¬å¦‚è¯´ä¸€ä¸ªé›†åˆç±»å‹æ²¡æœ‰å®ç° __contains__ æ–¹æ³•ï¼Œé‚£ä¹ˆ inè¿ç®—ç¬¦å°±ä¼šæŒ‰é¡ºåºåšä¸€æ¬¡è¿­ä»£æœç´¢ã€‚__missing__(self ,key)__missing__ åœ¨å­—å…¸çš„å­ç±»ä¸­ä½¿ç”¨ï¼Œå®ƒå®šä¹‰äº†å½“è¯•å›¾è®¿é—®ä¸€ä¸ªå­—å…¸ä¸­ä¸å­˜åœ¨çš„é”®æ—¶çš„è¡Œä¸ºï¼ˆç›®å‰ä¸ºæ­¢æ˜¯æŒ‡å­—å…¸çš„å®ä¾‹ï¼Œä¾‹å¦‚æˆ‘æœ‰ä¸€ä¸ªå­—å…¸ d ï¼Œ â€œgeorgeâ€ ä¸æ˜¯å­—å…¸ä¸­çš„ä¸€ä¸ªé”®ï¼Œå½“è¯•å›¾è®¿é—® d[â€œgeorgeâ€™] æ—¶å°±ä¼šè°ƒç”¨ d.__missing__(â€œgeorgeâ€) ï¼‰ã€‚ä¸‹é¢æ˜¯å®ç°äº†ä¸€äº›å‡½æ•°å¼ç»“æ„çš„åˆ—è¡¨ï¼Œå±•ç¤ºäº†å¦‚ä½•å®ç°è‡ªå·±çš„åºåˆ—ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455class FunctionalList:    '''ä¸€ä¸ªåˆ—è¡¨çš„å°è£…ç±»ï¼Œå®ç°äº†ä¸€äº›é¢å¤–çš„å‡½æ•°å¼    æ–¹æ³•ï¼Œä¾‹å¦‚head, tail, init, last, dropå’Œtakeã€‚'''    def __init__(self, values=None):        if values is None:            self.values = []        else:            self.values = values    def __len__(self):        return len(self.values)    def __getitem__(self, key):        # å¦‚æœé”®çš„ç±»å‹æˆ–å€¼ä¸åˆæ³•ï¼Œåˆ—è¡¨ä¼šè¿”å›å¼‚å¸¸        return self.values[key]    def __setitem__(self, key, value):        self.values[key] = value    def __delitem__(self, key):        del self.values[key]    def __iter__(self):        return iter(self.values)    def __reversed__(self):        return reversed(self.values)    def append(self, value):        self.values.append(value)    def head(self):        # å–å¾—ç¬¬ä¸€ä¸ªå…ƒç´         return self.values[0]    def tail(self):        # å–å¾—é™¤ç¬¬ä¸€ä¸ªå…ƒç´ å¤–çš„æ‰€æœ‰å…ƒç´         return self.valuse[1:]    def init(self):        # å–å¾—é™¤æœ€åä¸€ä¸ªå…ƒç´ å¤–çš„æ‰€æœ‰å…ƒç´         return self.values[:-1]    def last(self):        # å–å¾—æœ€åä¸€ä¸ªå…ƒç´         return self.values[-1]    def drop(self, n):        # å–å¾—é™¤å‰nä¸ªå…ƒç´ å¤–çš„æ‰€æœ‰å…ƒç´         return self.values[n:]    def take(self, n):        # å–å¾—å‰nä¸ªå…ƒç´         return self.values[:n]åå°„ä½ å¯ä»¥é€šè¿‡å®šä¹‰é­”æ³•æ–¹æ³•æ¥æ§åˆ¶ç”¨äºåå°„çš„å†…å»ºå‡½æ•° isinstance å’Œ issubclass çš„è¡Œä¸ºã€‚ä¸‹é¢æ˜¯å¯¹åº”çš„é­”æ³•æ–¹æ³•ï¼š__instancecheck__(self, instance)æ£€æŸ¥ä¸€ä¸ªå®ä¾‹æ˜¯å¦æ˜¯ä½ å®šä¹‰çš„ç±»çš„ä¸€ä¸ªå®ä¾‹ï¼ˆä¾‹å¦‚ isinstance(instance, class) ï¼‰ã€‚__subclasscheck__(self, subclass)æ£€æŸ¥ä¸€ä¸ªç±»æ˜¯å¦æ˜¯ä½ å®šä¹‰çš„ç±»çš„å­ç±»ï¼ˆä¾‹å¦‚ issubclass(subclass, class) ï¼‰ã€‚è¿™å‡ ä¸ªé­”æ³•æ–¹æ³•çš„é€‚ç”¨èŒƒå›´çœ‹èµ·æ¥æœ‰äº›çª„ï¼Œäº‹å®ä¹Ÿæ­£æ˜¯å¦‚æ­¤ã€‚buâ€™yongåœ¨åå°„é­”æ³•æ–¹æ³•ä¸ŠèŠ±è´¹å¤ªå¤šæ—¶é—´ï¼Œå› ä¸ºç›¸æ¯”å…¶ä»–é­”æ³•æ–¹æ³•å®ƒä»¬æ˜¾å¾—ä¸æ˜¯å¾ˆé‡è¦ã€‚ä½†æ˜¯å®ƒä»¬å±•ç¤ºäº†åœ¨Pythonä¸­è¿›è¡Œé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆæˆ–è€…æ€»ä½“ä¸Šä½¿ç”¨Pythonè¿›è¡Œç¼–ç¨‹ï¼‰æ—¶å¾ˆé‡è¦çš„ä¸€ç‚¹ï¼šä¸ç®¡åšä»€ä¹ˆäº‹æƒ…ï¼Œéƒ½ä¼šæœ‰ä¸€ä¸ªç®€å•æ–¹æ³•ï¼Œä¸ç®¡å®ƒå¸¸ç”¨ä¸å¸¸ç”¨ã€‚æŠ½è±¡åŸºç±»ABCpythonæŠ½è±¡åŸºç±»abcpythonä¸­å¹¶æ²¡æœ‰æä¾›æŠ½è±¡ç±»ä¸æŠ½è±¡æ–¹æ³•ï¼Œä½†æ˜¯æä¾›äº†å†…ç½®æ¨¡å—abc(abstract base class)æ¥æ¨¡æ‹Ÿå®ç°æŠ½è±¡ç±»ã€‚ æŠ½è±¡åŸºç±»çš„ä½¿ç”¨ï¼šç›´æ¥ç»§æ‰¿ç›´æ¥ç»§æ‰¿æŠ½è±¡åŸºç±»çš„å­ç±»å°±æ²¡æœ‰è¿™ä¹ˆçµæ´»ï¼ŒæŠ½è±¡åŸºç±»ä¸­å¯ä»¥å£°æ˜â€æŠ½è±¡æ–¹æ³•â€œå’Œâ€œæŠ½è±¡å±æ€§â€ï¼Œåªæœ‰å®Œå…¨è¦†å†™ï¼ˆå®ç°ï¼‰äº†æŠ½è±¡åŸºç±»ä¸­çš„â€œæŠ½è±¡â€å†…å®¹åï¼Œæ‰èƒ½è¢«å®ä¾‹åŒ–ï¼Œè€Œè™šæ‹Ÿå­ç±»åˆ™ä¸å—æ­¤å½±å“ã€‚è™šæ‹Ÿå­ç±»å°†å…¶ä»–çš„ç±»â€æ³¨å†Œâ€œåˆ°æŠ½è±¡åŸºç±»ä¸‹å½“è™šæ‹Ÿå­ç±»ï¼ˆè°ƒç”¨registeræ–¹æ³•ï¼‰ï¼Œè™šæ‹Ÿå­ç±»çš„å¥½å¤„æ˜¯ä½ å®ç°çš„ç¬¬ä¸‰æ–¹å­ç±»ä¸éœ€è¦ç›´æ¥ç»§æ‰¿è‡ªåŸºç±»ï¼Œå¯ä»¥å®ç°æŠ½è±¡åŸºç±»ä¸­çš„éƒ¨åˆ†APIæ¥å£ï¼Œä¹Ÿå¯ä»¥æ ¹æœ¬ä¸å®ç°ï¼Œä½†æ˜¯issubclass(), issubinstance()è¿›è¡Œåˆ¤æ–­æ—¶ä»ç„¶è¿”å›çœŸå€¼ã€‚å®šä¹‰æŠ½è±¡ç±»é¦–å…ˆåœ¨abc_base.pyä¸­å®šä¹‰ä¸€ä¸ªæŠ½è±¡åŸºç±»PluginBaseï¼Œè¿™ä¸ªåŸºç±»ç”¨äºä¿å­˜å’ŒåŠ è½½æ•°æ®ã€‚1234567891011121314import abcclass PluginBase(object):    __metaclass__ = abc.ABCMeta        @abc.abstractmethod    def load(self, input):        &quot;&quot;&quot;Retrieve data from the input source and return an object.&quot;&quot;&quot;        return        @abc.abstractmethod    def save(self, output, data):        &quot;&quot;&quot;Save the data object to the output.&quot;&quot;&quot;        returné€šè¿‡@abc.abstractmethodå°†æ–¹æ³•å£°æ˜ä¸ºæŠ½è±¡æ–¹æ³•ã€‚æ³¨å†Œå…·ä½“ç±»ç„¶ååœ¨abc_register.pyä¸­å®šä¹‰ä¸€ä¸ªå…·ä½“çš„ç±»ï¼š123456789101112131415import abcfrom abc_base import PluginBaseclass RegisteredImplementation(object):    def load(self, input):        return input.read()        def save(self, output, data):        return output.write(data)PluginBase.register(RegisteredImplementation)if __name__ == '__main__':    print 'Subclass:', issubclass(RegisteredImplementation, PluginBase)    print 'Instance:', isinstance(RegisteredImplementation(), PluginBase)åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒRegisteredImplementationå¹¶æ²¡æœ‰ç»§æ‰¿è‡ªPluginBaseï¼Œè€Œæ˜¯å°†å…¶æ³¨å†Œä¸ºPluginBaseçš„ä¸€ä¸ªå®ç°ã€‚ è¿è¡Œç»“æœå¦‚ä¸‹ï¼š12Subclass: TrueInstance: Trueé€šè¿‡æ´¾ç”Ÿå®ç°ä¹Ÿå¯ä»¥åœ¨abc_subclass.pyä¸­ç›´æ¥ç»§æ‰¿æŠ½è±¡ç±»ï¼š12345678910111213import abcfrom abc_base import PluginBaseclass SubclassImplementation(PluginBase):    def load(self, input):        return input.read()        def save(self, output, data):        return output.write(data)if __name__ == '__main__':    print 'Subclass:', issubclass(SubclassImplementation, PluginBase)    print 'Instance:', isinstance(SubclassImplementation(), PluginBase)è¿™æ ·åšæœ‰ä¸€ä¸ªå‰¯ä½œç”¨ï¼Œå½“æŸ¥è¯¢åŸºç±»çš„å­ç±»æ—¶ï¼Œä¼šè¾“å‡ºæ‰€æœ‰ç»§æ‰¿è‡ªæ”¹ç±»çš„å­ç±»ã€‚1234567import abcfrom abc_base import PluginBaseimport abc_subclassimport abc_registerfor sc in PluginBase.__subclasses__():    print sc.__name__è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š1SubclassImplementationç›´æ¥ä»æŠ½è±¡åŸºç±»æ´¾ç”Ÿå­ç±»æœ‰ä¸€ä¸ªå¥½å¤„ï¼Œé™¤éå­ç±»å®Œå…¨æŠ½è±¡åŸºç±»çš„æŠ½è±¡æ–¹æ³•ï¼Œå¦åˆ™å­ç±»ä¸èƒ½å®ä¾‹åŒ–ã€‚12345678910import abcfrom abc_base import PluginBaseclass IncompleteImplementation(PluginBase):    def save(self, output, data):        return output.write(data)if __name__ == '__main__':    print 'Subclass:', issubclass(IncompleteImplementation, PluginBase)    print 'Instance:', isinstance(IncompleteImplementation(), PluginBase)ABCä¸­çš„å…·ä½“æ–¹æ³•å°½ç®¡å…·ä½“å­ç±»å¿…é¡»å®ç°æŠ½è±¡ç±»ä¸­çš„æ‰€æœ‰æŠ½è±¡æ–¹æ³•ï¼Œä½†æ˜¯ï¼ŒæŠ½è±¡ç±»ä¸­ä¹Ÿå¯ä»¥åŒ…å«å…·ä½“æ–¹æ³•ã€‚åœ¨å­ç±»ä¸­å¯ä»¥é€šè¿‡super()æ¥è°ƒç”¨ã€‚12345678910111213141516171819202122232425import abcfrom cStringIO import StringIOclass ABCWithConcreteImplementation(object):    __metaclass__ = abc.ABCMeta    @abc.abstractmethod    def retrieve_values(self, input):        print 'base class reading data'        return input.read()class ConcreteOverride(ABCWithConcreteImplementation):    def retrieve_values(self, input):        base_data = super(ConcreteOverride, self).retrieve_values(input)        print 'subclass sorting data'        response = sorted(base_data.splitlines())        return responseinput = StringIO(&quot;&quot;&quot;line oneline twoline three&quot;&quot;&quot;)reader = ConcreteOverride()print reader.retrieve_values(input)printè¾“å‡ºç»“æœå¦‚ä¸‹ï¼š123base class reading datasubclass sorting data['line one', 'line three', 'line two']æŠ½è±¡å±æ€§å¯ä»¥é€šè¿‡@abstractpropertyå®šä¹‰æŠ½è±¡å±æ€§ï¼š123456789101112131415161718192021import abcclass Base(object):    __metaclass__ = abc.ABCMeta    @abc.abstractproperty    def value(self):        return 'Should never get here'class Implementation(Base):    @property    def value(self):        return 'concrete property'try:    b = Base()    print 'Base.value:', b.valueexcept Exception, err:    print 'ERROR:', str(err)i = Implementation()print 'Implementation.value:', i.valueè¾“å‡ºç»“æœå¦‚ä¸‹ï¼š12ERROR: Can't instantiate abstract class Base with abstract methods valueImplementation.value: concrete propertymetaclass&gt;å¯è°ƒç”¨çš„å¯¹è±¡Pythonä¸­ä¸€ä¸ªç‰¹æ®Šçš„é­”æ³•æ–¹æ³•å…è®¸ä½ è‡ªå·±ç±»çš„å¯¹è±¡è¡¨ç°å¾—åƒæ˜¯å‡½æ•°ï¼Œç„¶åä½ å°±å¯ä»¥â€œè°ƒç”¨â€å®ƒä»¬ï¼ŒæŠŠå®ƒä»¬ä¼ é€’åˆ°ä½¿ç”¨å‡½æ•°åšå‚æ•°çš„å‡½æ•°ä¸­ï¼Œ__call__(self, [argsâ€¦])å…è®¸ç±»çš„ä¸€ä¸ªå®ä¾‹åƒå‡½æ•°é‚£æ ·è¢«è°ƒç”¨ã€‚æœ¬è´¨ä¸Šè¿™ä»£è¡¨äº† x() å’Œ x.__call__() æ˜¯ç›¸åŒçš„ã€‚æ³¨æ„ __call__ å¯ä»¥æœ‰å¤šä¸ªå‚æ•°ï¼Œè¿™ä»£è¡¨ä½ å¯ä»¥åƒå®šä¹‰å…¶ä»–ä»»ä½•å‡½æ•°ä¸€æ ·ï¼Œå®šä¹‰ __call__ ï¼Œå–œæ¬¢ç”¨å¤šå°‘å‚æ•°å°±ç”¨å¤šå°‘ã€‚__call__ åœ¨æŸäº›éœ€è¦ç»å¸¸æ”¹å˜çŠ¶æ€çš„ç±»çš„å®ä¾‹ä¸­æ˜¾å¾—ç‰¹åˆ«æœ‰ç”¨ã€‚â€œè°ƒç”¨â€è¿™ä¸ªå®ä¾‹æ¥æ”¹å˜å®ƒçš„çŠ¶æ€ï¼Œæ˜¯ä¸€ç§æ›´åŠ ç¬¦åˆç›´è§‰ï¼Œä¹Ÿæ›´åŠ ä¼˜é›…çš„æ–¹æ³•ã€‚ä¸€ä¸ªè¡¨ç¤ºå¹³é¢ä¸Šå®ä½“çš„ç±»æ˜¯ä¸€ä¸ªä¸é”™çš„ä¾‹å­:1234567891011class Entity:        '''è¡¨ç¤ºä¸€ä¸ªå®ä½“çš„ç±»ï¼Œè°ƒç”¨å®ƒçš„å®ä¾‹        å¯ä»¥æ›´æ–°å®ä½“çš„ä½ç½®'''        def __init__(self, size, x, y):                self.x, self.y = x, y                self.size = size        def __call__(self, x, y):                '''æ”¹å˜å®ä½“çš„ä½ç½®'''                self.x, self.y = x, yä¸Šä¸‹æ–‡ç®¡ç†å™¨åœ¨Python 2.5ä¸­å¼•å…¥äº†ä¸€ä¸ªå…¨æ–°çš„å…³é”®è¯ï¼Œéšä¹‹è€Œæ¥çš„æ˜¯ä¸€ç§æ–°çš„ä»£ç å¤ç”¨æ–¹æ³•â€”â€” with å£°æ˜ã€‚ä¸Šä¸‹æ–‡ç®¡ç†çš„æ¦‚å¿µåœ¨Pythonä¸­å¹¶ä¸æ˜¯å…¨æ–°å¼•å…¥çš„ï¼ˆä¹‹å‰å®ƒä½œä¸ºæ ‡å‡†åº“çš„ä¸€éƒ¨åˆ†å®ç°ï¼‰ï¼Œç›´åˆ°PEP 343è¢«æ¥å—ï¼Œå®ƒæ‰æˆä¸ºä¸€ç§ä¸€çº§çš„è¯­è¨€ç»“æ„ã€‚å½“å¯¹è±¡ä½¿ç”¨ with å£°æ˜åˆ›å»ºæ—¶ï¼Œä¸Šä¸‹æ–‡ç®¡ç†å™¨å…è®¸ç±»åšä¸€äº›è®¾ç½®å’Œæ¸…ç†å·¥ä½œã€‚ä¸Šä¸‹æ–‡ç®¡ç†å™¨çš„è¡Œä¸ºç”±ä¸‹é¢ä¸¤ä¸ªé­”æ³•æ–¹æ³•æ‰€å®šä¹‰ï¼š__enter__(self)å®šä¹‰ä½¿ç”¨ with å£°æ˜åˆ›å»ºçš„è¯­å¥å—æœ€å¼€å§‹ä¸Šä¸‹æ–‡ç®¡ç†å™¨åº”è¯¥åšäº›ä»€ä¹ˆã€‚æ³¨æ„ __enter__ çš„è¿”å›å€¼ä¼šèµ‹ç»™ with å£°æ˜çš„ç›®æ ‡ï¼Œä¹Ÿå°±æ˜¯ as ä¹‹åçš„ä¸œè¥¿ã€‚__exit__(self, exception_type, exception_value, traceback)å®šä¹‰å½“ with å£°æ˜è¯­å¥å—æ‰§è¡Œå®Œæ¯•ï¼ˆæˆ–ç»ˆæ­¢ï¼‰æ—¶ä¸Šä¸‹æ–‡ç®¡ç†å™¨çš„è¡Œä¸ºã€‚å®ƒå¯ä»¥ç”¨æ¥å¤„ç†å¼‚å¸¸ï¼Œè¿›è¡Œæ¸…ç†ï¼Œæˆ–è€…åšå…¶ä»–åº”è¯¥åœ¨è¯­å¥å—ç»“æŸä¹‹åç«‹åˆ»æ‰§è¡Œçš„å·¥ä½œã€‚å¦‚æœè¯­å¥å—é¡ºåˆ©æ‰§è¡Œï¼Œ exceptiontype , exception_value å’Œ traceback ä¼šæ˜¯ None ã€‚å¦åˆ™ï¼Œä½ å¯ä»¥é€‰æ‹©å¤„ç†è¿™ä¸ªå¼‚å¸¸æˆ–è€…è®©ç”¨æˆ·æ¥å¤„ç†ã€‚å¦‚æœä½ æƒ³å¤„ç†å¼‚å¸¸ï¼Œç¡®ä¿ \_exit__ åœ¨å®Œæˆå·¥ä½œä¹‹åè¿”å› True ã€‚å¦‚æœä½ ä¸æƒ³å¤„ç†å¼‚å¸¸ï¼Œé‚£å°±è®©å®ƒå‘ç”Ÿå§ã€‚å¯¹ä¸€äº›å…·æœ‰è‰¯å¥½å®šä¹‰çš„ä¸”é€šç”¨çš„è®¾ç½®å’Œæ¸…ç†è¡Œä¸ºçš„ç±»ï¼Œ__enter__ å’Œ __exit__ ä¼šæ˜¾å¾—ç‰¹åˆ«æœ‰ç”¨ã€‚ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨è¿™å‡ ä¸ªæ–¹æ³•æ¥åˆ›å»ºé€šç”¨çš„ä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼Œç”¨æ¥åŒ…è£…å…¶ä»–å¯¹è±¡ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­:123456789101112131415161718class Closer:    '''    ä¸€ä¸ªä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼Œå¯ä»¥åœ¨withè¯­å¥ä¸­    ä½¿ç”¨close()è‡ªåŠ¨å…³é—­å¯¹è±¡    '''    def __init__(self, obj):    self.obj = obj    def __enter__(self, obj):    return self.obj # ç»‘å®šåˆ°ç›®æ ‡    def __exit__(self, exception_type, exception_value, traceback):        try:        self.obj.close()        except AttributeError: # objä¸æ˜¯å¯å…³é—­çš„        print 'Not closable.'        return True # æˆåŠŸåœ°å¤„ç†äº†å¼‚å¸¸è¿™æ˜¯ä¸€ä¸ª Closer åœ¨å®é™…ä½¿ç”¨ä¸­çš„ä¾‹å­ï¼Œä½¿ç”¨ä¸€ä¸ªFTPè¿æ¥æ¥æ¼”ç¤ºï¼ˆä¸€ä¸ªå¯å…³é—­çš„socket):1234567891011121314&gt;&gt;&gt; from magicmethods import Closer&gt;&gt;&gt; from ftplib import FTP&gt;&gt;&gt; with Closer(FTP('ftp.somesite.com')) as conn:...         conn.dir()...# ä¸ºäº†ç®€å•ï¼Œçœç•¥äº†æŸäº›è¾“å‡º&gt;&gt;&gt; conn.dir()# å¾ˆé•¿çš„ AttributeError ä¿¡æ¯ï¼Œä¸èƒ½ä½¿ç”¨ä¸€ä¸ªå·²å…³é—­çš„è¿æ¥&gt;&gt;&gt; with Closer(int(5)) as i:...         i += 1...Not closable.&gt;&gt;&gt; i6è¿™å°±æ˜¯ä¸Šä¸‹æ–‡ç®¡ç†å™¨å’Œé­”æ³•æ–¹æ³•çš„åŠ›é‡ã€‚Pythonæ ‡å‡†åº“åŒ…å«ä¸€ä¸ª contextlib æ¨¡å—ï¼Œé‡Œé¢æœ‰ä¸€ä¸ªä¸Šä¸‹æ–‡ç®¡ç†å™¨ contextlib.closing() åŸºæœ¬ä¸Šå’Œæˆ‘ä»¬çš„åŒ…è£…å™¨å®Œæˆçš„æ˜¯åŒæ ·çš„äº‹æƒ…ï¼ˆä½†æ˜¯æ²¡æœ‰åŒ…å«ä»»ä½•å½“å¯¹è±¡æ²¡æœ‰close()æ–¹æ³•æ—¶çš„å¤„ç†ï¼‰ã€‚åˆ›å»ºæè¿°ç¬¦å¯¹è±¡æè¿°ç¬¦æ˜¯ä¸€ä¸ªç±»ï¼Œå½“ä½¿ç”¨å–å€¼ï¼Œèµ‹å€¼å’Œåˆ é™¤ æ—¶å®ƒå¯ä»¥æ”¹å˜å…¶ä»–å¯¹è±¡ã€‚æè¿°ç¬¦ä¸æ˜¯ç”¨æ¥å•ç‹¬ä½¿ç”¨çš„ï¼Œå®ƒä»¬éœ€è¦è¢«ä¸€ä¸ªæ‹¥æœ‰è€…ç±»æ‰€åŒ…å«ã€‚æè¿°ç¬¦å¯ä»¥ç”¨æ¥åˆ›å»ºé¢å‘å¯¹è±¡æ•°æ®åº“ï¼Œä»¥åŠåˆ›å»ºæŸäº›å±æ€§ä¹‹é—´äº’ç›¸ä¾èµ–çš„ç±»ã€‚æè¿°ç¬¦åœ¨è¡¨ç°å…·æœ‰ä¸åŒå•ä½çš„å±æ€§ï¼Œæˆ–è€…éœ€è¦è®¡ç®—çš„å±æ€§æ—¶æ˜¾å¾—ç‰¹åˆ«æœ‰ç”¨ï¼ˆä¾‹å¦‚è¡¨ç°ä¸€ä¸ªåæ ‡ç³»ä¸­çš„ç‚¹çš„ç±»ï¼Œå…¶ä¸­çš„è·ç¦»åŸç‚¹çš„è·ç¦»è¿™ç§å±æ€§ï¼‰ã€‚è¦æƒ³æˆä¸ºä¸€ä¸ªæè¿°ç¬¦ï¼Œä¸€ä¸ªç±»å¿…é¡»å…·æœ‰å®ç° __get__ , __set__ å’Œ __delete__ ä¸‰ä¸ªæ–¹æ³•ä¸­è‡³å°‘ä¸€ä¸ªã€‚è®©æˆ‘ä»¬ä¸€èµ·æ¥çœ‹ä¸€çœ‹è¿™äº›é­”æ³•æ–¹æ³•ï¼š__get__(self, instance, owner)å®šä¹‰å½“è¯•å›¾å–å‡ºæè¿°ç¬¦çš„å€¼æ—¶çš„è¡Œä¸ºã€‚ instance æ˜¯æ‹¥æœ‰è€…ç±»çš„å®ä¾‹ï¼Œ owner æ˜¯æ‹¥æœ‰è€…ç±»æœ¬èº«ã€‚__set__(self, instance, owner)å®šä¹‰å½“æè¿°ç¬¦çš„å€¼æ”¹å˜æ—¶çš„è¡Œä¸ºã€‚ instance æ˜¯æ‹¥æœ‰è€…ç±»çš„å®ä¾‹ï¼Œ value æ˜¯è¦èµ‹ç»™æè¿°ç¬¦çš„å€¼ã€‚__delete__(self, instance, owner)å®šä¹‰å½“æè¿°ç¬¦çš„å€¼è¢«åˆ é™¤æ—¶çš„è¡Œä¸ºã€‚ instance æ˜¯æ‹¥æœ‰è€…ç±»çš„å®ä¾‹ç°åœ¨ï¼Œæ¥çœ‹ä¸€ä¸ªæè¿°ç¬¦çš„æœ‰æ•ˆåº”ç”¨ï¼šå•ä½è½¬æ¢:1234567891011121314151617181920class Meter(object):    '''ç±³çš„æè¿°ç¬¦ã€‚'''    def __init__(self, value=0.0):        self.value = float(value)    def __get__(self, instance, owner):        return self.value    def __set__(self, instance, owner):            self.value = float(value)class Foot(object):    '''è‹±å°ºçš„æè¿°ç¬¦ã€‚'''    def __get(self, instance, owner):            return instance.meter * 3.2808    def __set(self, instance, value):            instance.meter = float(value) / 3.2808class Distance(object):    '''ç”¨äºæè¿°è·ç¦»çš„ç±»ï¼ŒåŒ…å«è‹±å°ºå’Œç±³ä¸¤ä¸ªæè¿°ç¬¦ã€‚'''    meter = Meter()    foot = Foot()æ‹·è´æœ‰äº›æ—¶å€™ï¼Œç‰¹åˆ«æ˜¯å¤„ç†å¯å˜å¯¹è±¡æ—¶ï¼Œä½ å¯èƒ½æƒ³æ‹·è´ä¸€ä¸ªå¯¹è±¡ï¼Œæ”¹å˜è¿™ä¸ªå¯¹è±¡è€Œä¸å½±å“åŸæœ‰çš„å¯¹è±¡ã€‚è¿™æ—¶å°±éœ€è¦ç”¨åˆ°Pythonçš„ copy æ¨¡å—äº†ã€‚ç„¶è€Œï¼ˆå¹¸è¿çš„æ˜¯ï¼‰ï¼ŒPythonæ¨¡å—å¹¶ä¸å…·æœ‰æ„ŸçŸ¥èƒ½åŠ›ï¼Œ å› æ­¤æˆ‘ä»¬ä¸ç”¨æ‹…å¿ƒæŸå¤©åŸºäºLinuxçš„æœºå™¨äººå´›èµ·ã€‚ä½†æ˜¯æˆ‘ä»¬çš„ç¡®éœ€è¦å‘Šè¯‰Pythonå¦‚ä½•æœ‰æ•ˆç‡åœ°æ‹·è´å¯¹è±¡ã€‚__copy__(self)å®šä¹‰å¯¹ç±»çš„å®ä¾‹ä½¿ç”¨ copy.copy() æ—¶çš„è¡Œä¸ºã€‚ copy.copy() è¿”å›ä¸€ä¸ªå¯¹è±¡çš„æµ…æ‹·è´ï¼Œè¿™æ„å‘³ç€æ‹·è´å‡ºçš„å®ä¾‹æ˜¯å…¨æ–°çš„ï¼Œç„¶è€Œé‡Œé¢çš„æ•°æ®å…¨éƒ½æ˜¯å¼•ç”¨çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹è±¡æœ¬èº«æ˜¯æ‹·è´çš„ï¼Œä½†æ˜¯å®ƒçš„æ•°æ®è¿˜æ˜¯å¼•ç”¨çš„ï¼ˆæ‰€ä»¥æµ…æ‹·è´ä¸­çš„æ•°æ®æ›´æ”¹ä¼šå½±å“åŸå¯¹è±¡ï¼‰ã€‚__deepcopy__(self, memodict=)å®šä¹‰å¯¹ç±»çš„å®ä¾‹ä½¿ç”¨ copy.deepcopy() æ—¶çš„è¡Œä¸ºã€‚ copy.deepcopy() è¿”å›ä¸€ä¸ªå¯¹è±¡çš„æ·±æ‹·è´ï¼Œè¿™ä¸ªå¯¹è±¡å’Œå®ƒçš„æ•°æ®å…¨éƒ½è¢«æ‹·è´äº†ä¸€ä»½ã€‚ memodict æ˜¯ä¸€ä¸ªå…ˆå‰æ‹·è´å¯¹è±¡çš„ç¼“å­˜ï¼Œå®ƒä¼˜åŒ–äº†æ‹·è´è¿‡ç¨‹ï¼Œè€Œä¸”å¯ä»¥é˜²æ­¢æ‹·è´é€’å½’æ•°æ®ç»“æ„æ—¶äº§ç”Ÿæ— é™é€’å½’ã€‚å½“ä½ æƒ³æ·±æ‹·è´ä¸€ä¸ªå•ç‹¬çš„å±æ€§æ—¶ï¼Œåœ¨é‚£ä¸ªå±æ€§ä¸Šè°ƒç”¨ copy.deepcopy() ï¼Œä½¿ç”¨ memodict ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ã€‚è¿™äº›é­”æ³•æ–¹æ³•æœ‰ä»€ä¹ˆç”¨æ­¦ä¹‹åœ°å‘¢ï¼Ÿåƒå¾€å¸¸ä¸€æ ·ï¼Œå½“ä½ éœ€è¦æ¯”é»˜è®¤è¡Œä¸ºæ›´åŠ ç²¾ç¡®çš„æ§åˆ¶æ—¶ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³æ‹·è´ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶ä¸­å­˜å‚¨äº†ä¸€ä¸ªå­—å…¸ä½œä¸ºç¼“å­˜ï¼ˆå¯èƒ½ä¼šå¾ˆå¤§ï¼‰ï¼Œæ‹·è´ç¼“å­˜å¯èƒ½æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚å¦‚æœè¿™ä¸ªç¼“å­˜å¯ä»¥åœ¨å†…å­˜ä¸­è¢«ä¸åŒå®ä¾‹å…±äº«ï¼Œé‚£ä¹ˆå®ƒå°±åº”è¯¥è¢«å…±äº«ã€‚Picklingå¦‚æœä½ å’Œå…¶ä»–çš„Pythonçˆ±å¥½è€…å…±äº‹è¿‡ï¼Œå¾ˆå¯èƒ½ä½ å·²ç»å¬è¯´è¿‡Picklingäº†ã€‚Picklingæ˜¯Pythonæ•°æ®ç»“æ„çš„åºåˆ—åŒ–è¿‡ç¨‹ï¼Œå½“ä½ æƒ³å­˜å‚¨ä¸€ä¸ªå¯¹è±¡ç¨åå†å–å‡ºè¯»å–æ—¶ï¼ŒPicklingä¼šæ˜¾å¾—ååˆ†æœ‰ç”¨ã€‚Picklingæ˜¯å¦‚æ­¤çš„é‡è¦ï¼Œä»¥è‡³äºå®ƒä¸ä»…ä»…æœ‰è‡ªå·±çš„æ¨¡å—ï¼ˆ pickle ï¼‰ï¼Œè¿˜æœ‰è‡ªå·±çš„åè®®å’Œé­”æ³•æ–¹æ³•ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆæ¥ç®€è¦çš„ä»‹ç»ä¸€ä¸‹å¦‚ä½•pickleå·²å­˜åœ¨çš„å¯¹è±¡ç±»å‹ã€‚Pickling : å°è¯•ç‰›åˆ€æˆ‘ä»¬ä¸€èµ·æ¥pickleå§ã€‚å‡è®¾ä½ æœ‰ä¸€ä¸ªå­—å…¸ï¼Œä½ æƒ³å­˜å‚¨å®ƒï¼Œç¨åå†å–å‡ºæ¥ã€‚ä½ å¯ä»¥æŠŠå®ƒçš„å†…å®¹å†™å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œå°å¿ƒç¿¼ç¿¼åœ°ç¡®ä¿ä½¿ç”¨äº†æ­£ç¡®åœ°æ ¼å¼ï¼Œè¦æŠŠå®ƒè¯»å–å‡ºæ¥ï¼Œä½ å¯ä»¥ä½¿ç”¨ exec() æˆ–å¤„ç†æ–‡ä»¶è¾“å…¥ã€‚ä½†æ˜¯è¿™ç§æ–¹æ³•å¹¶ä¸å¯é ï¼šå¦‚æœä½ ä½¿ç”¨çº¯æ–‡æœ¬æ¥å­˜å‚¨é‡è¦æ•°æ®ï¼Œæ•°æ®å¾ˆå®¹æ˜“ä»¥å¤šç§æ–¹å¼è¢«ç ´åæˆ–è€…ä¿®æ”¹ï¼Œå¯¼è‡´ä½ çš„ç¨‹åºå´©æºƒï¼Œæ›´ç³Ÿç³•çš„æƒ…å†µä¸‹ï¼Œè¿˜å¯èƒ½åœ¨ä½ çš„è®¡ç®—æœºä¸Šè¿è¡Œæ¶æ„ä»£ç ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è¦pickleå®ƒ:12345678import pickledata = {'foo': [1,2,3],                'bar': ('Hello', 'world!'),                'baz': True}jar = open('data.pkl', 'wb')pickle.dump(data, jar) # å°†pickleåçš„æ•°æ®å†™å…¥jaræ–‡ä»¶jar.close()è¿‡äº†å‡ ä¸ªå°æ—¶ï¼Œæˆ‘ä»¬æƒ³æŠŠå®ƒå–å‡ºæ¥ï¼Œæˆ‘ä»¬åªéœ€è¦åpickleå®ƒ:123456import picklepkl_file = open('data.pkl', 'rb') # ä¸pickleåçš„æ•°æ®è¿æ¥data = pickle.load(pkl_file) # æŠŠå®ƒåŠ è½½è¿›ä¸€ä¸ªå˜é‡print datapkl_file.close()å°†ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿæ­£å¦‚ä½ æœŸå¾…çš„ï¼Œå®ƒå°±æ˜¯æˆ‘ä»¬ä¹‹å‰çš„ data ã€‚ç°åœ¨ï¼Œè¿˜éœ€è¦è°¨æ…åœ°è¯´ä¸€å¥ï¼š pickleå¹¶ä¸å®Œç¾ã€‚Pickleæ–‡ä»¶å¾ˆå®¹æ˜“å› ä¸ºäº‹æ•…æˆ–è¢«æ•…æ„çš„ç ´åæ‰ã€‚Picklingæˆ–è®¸æ¯”çº¯æ–‡æœ¬æ–‡ä»¶å®‰å…¨ä¸€äº›ï¼Œä½†æ˜¯ä¾ç„¶æœ‰å¯èƒ½è¢«ç”¨æ¥è¿è¡Œæ¶æ„ä»£ç ã€‚è€Œä¸”å®ƒè¿˜ä¸æ”¯æŒè·¨Pythonç‰ˆæœ¬ï¼Œæ‰€ä»¥ä¸è¦æŒ‡æœ›åˆ†å‘pickleå¯¹è±¡ä¹‹åæ‰€æœ‰äººéƒ½èƒ½æ­£ç¡®åœ°è¯»å–ã€‚ç„¶è€Œä¸ç®¡æ€ä¹ˆæ ·ï¼Œå®ƒä¾ç„¶æ˜¯ä¸€ä¸ªå¼ºæœ‰åŠ›çš„å·¥å…·ï¼Œå¯ä»¥ç”¨äºç¼“å­˜å’Œå…¶ä»–ç±»å‹çš„æŒä¹…åŒ–å·¥ä½œã€‚Pickleä½ çš„å¯¹è±¡Pickleä¸ä»…ä»…å¯ä»¥ç”¨äºå†…å»ºç±»å‹ï¼Œä»»ä½•éµå®ˆpickleåè®®çš„ç±»éƒ½å¯ä»¥è¢«pickleã€‚Pickleåè®®æœ‰å››ä¸ªå¯é€‰æ–¹æ³•ï¼Œå¯ä»¥è®©ç±»è‡ªå®šä¹‰å®ƒä»¬çš„è¡Œä¸ºï¼ˆè¿™å’ŒCè¯­è¨€æ‰©å±•ç•¥æœ‰ä¸åŒï¼Œé‚£ä¸åœ¨æˆ‘ä»¬çš„è®¨è®ºèŒƒå›´ä¹‹å†…ï¼‰ã€‚__getinitargs__(self)å¦‚æœä½ æƒ³è®©ä½ çš„ç±»åœ¨åpickleæ—¶è°ƒç”¨ __init__ ï¼Œä½ å¯ä»¥å®šä¹‰ __getinitargs__(self) ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªå‚æ•°å…ƒç»„ï¼Œè¿™ä¸ªå…ƒç»„ä¼šä¼ é€’ç»™ __init__ ã€‚æ³¨æ„ï¼Œè¿™ä¸ªæ–¹æ³•åªèƒ½ç”¨äºæ—§å¼ç±»ã€‚__getnewargs__(self)å¯¹æ–°å¼ç±»æ¥è¯´ï¼Œä½ å¯ä»¥é€šè¿‡è¿™ä¸ªæ–¹æ³•æ”¹å˜ç±»åœ¨åpickleæ—¶ä¼ é€’ç»™ __new__ çš„å‚æ•°ã€‚è¿™ä¸ªæ–¹æ³•åº”è¯¥è¿”å›ä¸€ä¸ªå‚æ•°å…ƒç»„ã€‚__getstate__(self)ä½ å¯ä»¥è‡ªå®šä¹‰å¯¹è±¡è¢«pickleæ—¶è¢«å­˜å‚¨çš„çŠ¶æ€ï¼Œè€Œä¸ä½¿ç”¨å¯¹è±¡çš„ __dict__ å±æ€§ã€‚ è¿™ä¸ªçŠ¶æ€åœ¨å¯¹è±¡è¢«åpickleæ—¶ä¼šè¢« __setstate__ ä½¿ç”¨ã€‚__setstate__(self)å½“ä¸€ä¸ªå¯¹è±¡è¢«åpickleæ—¶ï¼Œå¦‚æœå®šä¹‰äº† __setstate__ ï¼Œå¯¹è±¡çš„çŠ¶æ€ä¼šä¼ é€’ç»™è¿™ä¸ªé­”æ³•æ–¹æ³•ï¼Œè€Œä¸æ˜¯ç›´æ¥åº”ç”¨åˆ°å¯¹è±¡çš„ __dict__ å±æ€§ã€‚è¿™ä¸ªé­”æ³•æ–¹æ³•å’Œ __getstate__ ç›¸äº’ä¾å­˜ï¼šå½“è¿™ä¸¤ä¸ªæ–¹æ³•éƒ½è¢«å®šä¹‰æ—¶ï¼Œä½ å¯ä»¥åœ¨Pickleæ—¶ä½¿ç”¨ä»»ä½•æ–¹æ³•ä¿å­˜å¯¹è±¡çš„ä»»ä½•çŠ¶æ€ã€‚__reduce__(self)å½“å®šä¹‰æ‰©å±•ç±»å‹æ—¶ï¼ˆä¹Ÿå°±æ˜¯ä½¿ç”¨Pythonçš„Cè¯­è¨€APIå®ç°çš„ç±»å‹ï¼‰ï¼Œå¦‚æœä½ æƒ³pickleå®ƒä»¬ï¼Œä½ å¿…é¡»å‘Šè¯‰Pythonå¦‚ä½•pickleå®ƒä»¬ã€‚ __reduce__ è¢«å®šä¹‰ä¹‹åï¼Œå½“å¯¹è±¡è¢«Pickleæ—¶å°±ä¼šè¢«è°ƒç”¨ã€‚å®ƒè¦ä¹ˆè¿”å›ä¸€ä¸ªä»£è¡¨å…¨å±€åç§°çš„å­—ç¬¦ä¸²ï¼ŒPyhtonä¼šæŸ¥æ‰¾å®ƒå¹¶pickleï¼Œè¦ä¹ˆè¿”å›ä¸€ä¸ªå…ƒç»„ã€‚è¿™ä¸ªå…ƒç»„åŒ…å«2åˆ°5ä¸ªå…ƒç´ ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼šä¸€ä¸ªå¯è°ƒç”¨çš„å¯¹è±¡ï¼Œç”¨äºé‡å»ºå¯¹è±¡æ—¶è°ƒç”¨ï¼›ä¸€ä¸ªå‚æ•°å…ƒç´ ï¼Œä¾›é‚£ä¸ªå¯è°ƒç”¨å¯¹è±¡ä½¿ç”¨ï¼›è¢«ä¼ é€’ç»™ __setstate__ çš„çŠ¶æ€ï¼ˆå¯é€‰ï¼‰ï¼›ä¸€ä¸ªäº§ç”Ÿè¢«pickleçš„åˆ—è¡¨å…ƒç´ çš„è¿­ä»£å™¨ï¼ˆå¯é€‰ï¼‰ï¼›ä¸€ä¸ªäº§ç”Ÿè¢«pickleçš„å­—å…¸å…ƒç´ çš„è¿­ä»£å™¨ï¼ˆå¯é€‰ï¼‰ï¼›__reduceex\_(self)__reduceex\_ çš„å­˜åœ¨æ˜¯ä¸ºäº†å…¼å®¹æ€§ã€‚å¦‚æœå®ƒè¢«å®šä¹‰ï¼Œåœ¨pickleæ—¶ __reduceex\_ ä¼šä»£æ›¿ __reduce__ è¢«è°ƒç”¨ã€‚ __reduce__ ä¹Ÿå¯ä»¥è¢«å®šä¹‰ï¼Œç”¨äºä¸æ”¯æŒ __reduceex\_ çš„æ—§ç‰ˆpickleçš„APIè°ƒç”¨ã€‚ä¸€ä¸ªä¾‹å­Slate å®ƒä¼šè®°ä½å®ƒçš„å€¼æ›¾ç»æ˜¯ä»€ä¹ˆï¼Œä»¥åŠé‚£äº›å€¼æ˜¯ä»€ä¹ˆæ—¶å€™èµ‹ç»™å®ƒçš„ã€‚ç„¶è€Œ æ¯æ¬¡è¢«pickleæ—¶å®ƒéƒ½ä¼šå˜æˆç©ºç™½ï¼Œå› ä¸ºå½“å‰çš„å€¼ä¸ä¼šè¢«å­˜å‚¨:1234567891011121314151617181920212223242526272829303132import timeclass Slate:        '''å­˜å‚¨ä¸€ä¸ªå­—ç¬¦ä¸²å’Œä¸€ä¸ªå˜æ›´æ—¥å¿—çš„ç±»        æ¯æ¬¡è¢«pickleéƒ½ä¼šå¿˜è®°å®ƒå½“å‰çš„å€¼'''        def __init__(self, value):                self.value = value                self.last_change = time.asctime()                self.history = {}        def change(self, new_value):                # æ”¹å˜å½“å‰å€¼ï¼Œå°†ä¸Šä¸€ä¸ªå€¼è®°å½•åˆ°å†å²                self.history[self.last_change] = self.value                self.value = new_value)                self.last_change = time.asctime()        def print_change(self):                print 'Changelog for Slate object:'                for k,v in self.history.items():                        print '%s\t %s' % (k,v)        def __getstate__(self):                # æ•…æ„ä¸è¿”å›self.valueæˆ–self.last_change                # æˆ‘ä»¬æƒ³åœ¨åpickleæ—¶å¾—åˆ°ä¸€ä¸ªç©ºç™½çš„slate                return self.history        def __setstate__(self):                # ä½¿self.history = slateï¼Œlast_change                # å’Œvalueä¸ºæœªå®šä¹‰                self.history = state                self.value, self.last_change = None, Noneå¦‚ä½•è°ƒç”¨é­”æ³•æ–¹æ³•ä¸€äº›é­”æ³•æ–¹æ³•ç›´æ¥å’Œå†…å»ºå‡½æ•°å¯¹åº”ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚ä½•è°ƒç”¨å®ƒä»¬æ˜¯æ˜¾è€Œæ˜“è§çš„ã€‚ç„¶è€Œï¼Œå¦å¤–çš„æƒ…å†µä¸‹ï¼Œè°ƒç”¨é­”æ³•æ–¹æ³•çš„é€”å¾„å¹¶ä¸æ˜¯é‚£ä¹ˆæ˜æ˜¾ã€‚è¿™ä¸ªé™„å½•æ—¨åœ¨å±•ç¤ºé‚£äº›ä¸é‚£ä¹ˆæ˜æ˜¾çš„è°ƒç”¨é­”æ³•æ–¹æ³•çš„è¯­æ³•ã€‚é­”æ³•æ–¹æ³•ä»€ä¹ˆæ—¶å€™è¢«è°ƒç”¨è§£é‡Š__new__(cls [,â€¦])instance = MyClass(arg1, arg2)__new__åœ¨å®ä¾‹åˆ›å»ºæ—¶è°ƒç”¨__init__(self [,â€¦])instance = MyClass(arg1,arg2)__init__åœ¨å®ä¾‹åˆ›å»ºæ—¶è°ƒç”¨__cmp__(self)self == other, self &gt; other ç­‰è¿›è¡Œæ¯”è¾ƒæ—¶è°ƒç”¨ï¼Œ3.xç§»é™¤__pos__(self)+selfä¸€å…ƒåŠ æ³•ç¬¦å·__neg__(self)-selfä¸€å…ƒå‡æ³•ç¬¦å·__invert__(self)~selfæŒ‰ä½å–å__index__(self)x[self]å½“å¯¹è±¡ç”¨äºç´¢å¼•æ—¶__nonzero__(self)bool(self)å¯¹è±¡çš„å¸ƒå°”å€¼__getattr__(self, name)self.name #nameä¸å­˜åœ¨è®¿é—®ä¸å­˜åœ¨çš„å±æ€§__setattr__(self, name)self.name = valç»™å±æ€§èµ‹å€¼__delattr__(self, name)del self.nameåˆ é™¤å±æ€§__getattribute__(self,name)self.nameè®¿é—®ä»»æ„å±æ€§__getitem__(self, key)self[key]ä½¿ç”¨ç´¢å¼•è®¿é—®æŸä¸ªå…ƒç´ __setitem__(self, key)self[key] = valä½¿ç”¨ç´¢å¼•ç»™æŸä¸ªå…ƒç´ èµ‹å€¼__delitem__(self, key)del self[key]ä½¿ç”¨ç´¢å¼•åˆ é™¤æŸä¸ªå¯¹è±¡__iter__(self)for x in selfè¿­ä»£__contains__(self, value)value in self, value not in selfä½¿ç”¨inè¿›è¡Œæˆå‘˜æµ‹è¯•__call__(self [,â€¦])self(args)â€œè°ƒç”¨â€ä¸€ä¸ªå®ä¾‹__enter__(self)with self as x:withå£°æ˜çš„ä¸Šä¸‹æ–‡ç®¡ç†å™¨__exit__(self, exc, val, trace)with self as x:withå£°æ˜çš„ä¸Šä¸‹æ–‡ç®¡ç†å™¨__getstate__(self)pickle.dump(pkl_file, self)Pickling__setstate__(self)data = pickle.load(pkl_file)Pickling</content>
	</entry>
	<entry>
		<title>pythonåŸºç¡€çŸ¥è¯†</title>
		<url>/article/8258.html</url>
		<content>pythonåŸºç¡€çŸ¥è¯†pythonè§£é‡Šå™¨CPythonè¿™ä¸ªè§£é‡Šå™¨æ˜¯ç”¨Cè¯­è¨€å¼€å‘çš„ï¼Œæ‰€ä»¥å« CPythonï¼Œåœ¨å‘½åè¡Œä¸‹è¿è¡Œpythonï¼Œå°±æ˜¯å¯åŠ¨CPythonè§£é‡Šå™¨CPythonæ˜¯ä½¿ç”¨æœ€å¹¿çš„Pythonè§£é‡Šå™¨IPythonIPythonæ˜¯åŸºäºCPythonä¹‹ä¸Šçš„ä¸€ä¸ªäº¤äº’å¼è§£é‡Šå™¨ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒIPythonåªæ˜¯åœ¨äº¤äº’æ–¹å¼ä¸Šæœ‰æ‰€å¢å¼ºPyPyPyPyæ˜¯å¦ä¸€ä¸ªPythonè§£é‡Šå™¨ï¼Œå®ƒçš„ç›®æ ‡æ˜¯æ‰§è¡Œé€Ÿåº¦PyPyé‡‡ç”¨JITæŠ€æœ¯ï¼Œå¯¹Pythonä»£è¿›è¡ŒåŠ¨æ€ç¼–è¯‘ï¼Œæ‰€ä»¥å¯ä»¥æ˜¾è‘—æé«˜Pythonä»£ç çš„æ‰§è¡Œé€Ÿåº¦JythonJythonæ˜¯è¿è¡Œåœ¨Javaå¹³å°ä¸Šçš„Pythonè§£é‡Šå™¨ï¼Œå¯ä»¥ç›´æ¥æŠŠPythonä»£ç ç¼–è¯‘æˆJavaå­—èŠ‚ç æ‰§è¡ŒIronPythonIronPythonå’ŒJythonç±»ä¼¼ï¼Œåªä¸è¿‡IronPythonæ˜¯è¿è¡Œåœ¨å¾®è½¯.Netå¹³å°ä¸Šçš„Pythonè§£é‡Šå™¨å¯ä»¥ç›´æ¥æŠŠPythonä»£ç ç¼–è¯‘æˆ.Netçš„å­—èŠ‚ç ã€‚å­—ç¬¦é›†å’Œå­—ç¬¦ç¼–ç ååˆ†é’Ÿææ¸…å­—ç¬¦é›†å’Œå­—ç¬¦ç¼–ç ç¨‹åºå‘˜å¿…å¤‡ï¼šå½»åº•å¼„æ‡‚å¸¸è§çš„7ç§ä¸­æ–‡å­—ç¬¦ç¼–ç è®¡ç®—æœºå±å¹•ä¸Šçœ‹åˆ°å®ä½“åŒ–çš„æ–‡å­—ï¼Œåœ¨è®¡ç®—æœºå­˜å‚¨ä»‹è´¨ä¸­å­˜æ”¾çš„å®é™…æ˜¯äºŒè¿›åˆ¶çš„æ¯”ç‰¹æµä¸¤è€…ä¹‹é—´çš„è½¬æ¢è§„åˆ™å°±éœ€è¦ä¸€ä¸ªç»Ÿä¸€çš„æ ‡å‡†å­—ç¬¦é›†å­—ç¬¦é›†ï¼šä¸ºæ¯ä¸€ä¸ªã€Œå­—ç¬¦ã€åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„ IDï¼ˆå­¦åä¸ºç ä½ / ç ç‚¹ / Code Pointï¼‰ ä¸ºä»€ä¹ˆé‚£ä¹ˆå¤šå­—ç¬¦é›†é—®é¢˜å®é™…éå¸¸å®¹æ˜“å›ç­”ã€‚é—®é—®è‡ªå·±ä¸ºä»€ä¹ˆæˆ‘ä»¬çš„æ’å¤´æ‹¿åˆ°è‹±å›½å°±ä¸èƒ½ç”¨äº†å‘¢ï¼Ÿä¸ºä»€ä¹ˆæ˜¾ç¤ºå™¨åŒæ—¶æœ‰DVIï¼ŒVGAï¼ŒHDMIï¼ŒDPè¿™ä¹ˆå¤šæ¥å£å‘¢ï¼Ÿå¾ˆå¤šè§„èŒƒå’Œæ ‡å‡†åœ¨æœ€åˆåˆ¶å®šæ—¶å¹¶ä¸ä¼šæ„è¯†åˆ°è¿™å°†ä¼šæ˜¯ä»¥åå…¨çƒæ™®é€‚çš„å‡†åˆ™ï¼Œæˆ–è€…å¤„äºç»„ç»‡æœ¬èº«åˆ©ç›Šå°±æƒ³ä»æœ¬è´¨ä¸ŠåŒºåˆ«äºç°æœ‰æ ‡å‡†ã€‚äºæ˜¯ï¼Œå°±äº§ç”Ÿäº†é‚£ä¹ˆå¤šå…·æœ‰ç›¸åŒæ•ˆæœä½†åˆä¸ç›¸äº’å…¼å®¹çš„æ ‡å‡†äº†ã€‚è¯´äº†é‚£ä¹ˆå¤šæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå®é™…ä¾‹å­ï¼Œä¸‹é¢å°±æ˜¯å±Œè¿™ä¸ªå­—åœ¨å„ç§ç¼–ç ä¸‹çš„åå…­è¿›åˆ¶å’ŒäºŒè¿›åˆ¶ç¼–ç ç»“æœï¼Œæ€ä¹ˆæ ·æœ‰æ²¡æœ‰ä¸€ç§å¾ˆå±Œçš„æ„Ÿè§‰ï¼Ÿå­—ç¬¦é›†16è¿›åˆ¶ç¼–ç å¯¹åº”çš„äºŒè¿›åˆ¶æ•°æ®UTF-80xE5B18C111001011011000110001100UTF-160x5C4C101110001001100GBK0x8CC51000110011000101å¸¸è§å­—ç¬¦é›†ASCII å­—ç¬¦é›†ï¼šASCIIç¼–ç æ¯ä¸ªå­—æ¯æˆ–ç¬¦å·å 1byte(8bits)ï¼Œå¹¶ä¸”8bitsçš„æœ€é«˜ä½æ˜¯0ï¼Œå› æ­¤ASCIIèƒ½ç¼–ç çš„å­—æ¯å’Œç¬¦å·åªæœ‰128ä¸ªã€‚æœ‰ä¸€äº›ç¼–ç æŠŠ8bitsæœ€é«˜ä½ä¸º1çš„å128ä¸ªå€¼ä¹Ÿç¼–ç ä¸Šï¼Œä½¿å¾—1byteå¯ä»¥è¡¨ç¤º256ä¸ªå€¼ï¼Œä½†æ˜¯è¿™å±äºæ‰©å±•çš„ASCIIï¼Œå¹¶éæ ‡å‡†ASCIIã€‚é€šå¸¸æ‰€è¯´çš„æ ‡å‡†ASCIIåªæœ‰å‰128ä¸ªå€¼ï¼ASCIIç¼–ç å‡ ä¹è¢«ä¸–ç•Œä¸Šæ‰€æœ‰ç¼–ç æ‰€å…¼å®¹ï¼ˆUTF16å’ŒUTF32æ˜¯ä¸ªä¾‹å¤–ï¼‰ï¼Œå› æ­¤å¦‚æœä¸€ä¸ªæ–‡æœ¬æ–‡æ¡£é‡Œé¢çš„å†…å®¹å…¨éƒ½ç”±ASCIIé‡Œé¢çš„å­—æ¯æˆ–ç¬¦å·æ„æˆï¼Œé‚£ä¹ˆä¸ç®¡ä½ å¦‚ä½•å±•ç¤ºè¯¥æ–‡æ¡£çš„å†…å®¹ï¼Œéƒ½ä¸å¯èƒ½å‡ºç°ä¹±ç çš„æƒ…å†µã€‚ GB2312 å­—ç¬¦é›†ï¼šæœ€æ—©ä¸€ç‰ˆçš„ä¸­æ–‡ç¼–ç ï¼Œæ¯ä¸ªå­—å æ®2bytesã€‚ç”±äºè¦å’ŒASCIIå…¼å®¹ï¼Œé‚£è¿™2bytesæœ€é«˜ä½ä¸å¯ä»¥ä¸º0äº†ï¼ˆå¦åˆ™å’ŒASCIIä¼šæœ‰å†²çªï¼‰ã€‚åœ¨GB2312ä¸­æ”¶å½•äº†6763ä¸ªæ±‰å­—ä»¥åŠ682ä¸ªç‰¹æ®Šç¬¦å·ï¼Œå·²ç»å›Šæ‹¬äº†ç”Ÿæ´»ä¸­æœ€å¸¸ç”¨çš„æ‰€æœ‰æ±‰å­—ã€‚ GBK å­—ç¬¦é›†ï¼šç”±äºGB2312åªæœ‰6763ä¸ªæ±‰å­—ï¼Œæˆ‘æ±‰è¯­åšå¤§ç²¾æ·±ï¼Œåªæœ‰6763ä¸ªå­—æ€ä¹ˆå¤Ÿï¼Ÿäºæ˜¯GBKä¸­åœ¨ä¿è¯ä¸å’ŒGB2312ã€ASCIIå†²çªï¼ˆå³å…¼å®¹GB2312å’ŒASCIIï¼‰çš„å‰æä¸‹ï¼Œä¹Ÿç”¨æ¯ä¸ªå­—å æ®2bytesçš„æ–¹å¼åˆç¼–ç äº†è®¸å¤šæ±‰å­—ã€‚ç»è¿‡GBKç¼–ç åï¼Œå¯ä»¥è¡¨ç¤ºçš„æ±‰å­—è¾¾åˆ°äº†20902ä¸ªï¼Œå¦æœ‰984ä¸ªæ±‰è¯­æ ‡ç‚¹ç¬¦å·ã€éƒ¨é¦–ç­‰ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯è¿™20902ä¸ªæ±‰å­—è¿˜åŒ…å«äº†ç¹ä½“å­—ï¼Œä½†æ˜¯è¯¥ç¹ä½“å­—ä¸å°æ¹¾Big5ç¼–ç ä¸å…¼å®¹ï¼Œå› ä¸ºåŒä¸€ä¸ªç¹ä½“å­—å¾ˆå¯èƒ½åœ¨GBKå’ŒBig5ä¸­æ•°å­—ç¼–ç æ˜¯ä¸ä¸€æ ·çš„ã€‚ Unicode å­—ç¬¦é›†ï¼šUnicodeï¼ˆä¸­æ–‡ï¼šä¸‡å›½ç ã€å›½é™…ç ã€ç»Ÿä¸€ç ã€å•ä¸€ç ï¼‰æ˜¯è®¡ç®—æœºç§‘å­¦é¢†åŸŸé‡Œçš„ä¸€é¡¹ä¸šç•Œæ ‡å‡†ASCIIç¼–ç æ˜¯1ä¸ªå­—èŠ‚ï¼Œè€ŒUnicodeç¼–ç é€šå¸¸æ˜¯2ä¸ªå­—èŠ‚ å®ƒå¯¹ä¸–ç•Œä¸Šå¤§éƒ¨åˆ†çš„æ–‡å­—ç³»ç»Ÿè¿›è¡Œäº†æ•´ç†ã€ç¼–ç ï¼Œä½¿å¾—ç”µè„‘å¯ä»¥ç”¨æ›´ä¸ºç®€å•çš„æ–¹å¼æ¥å‘ˆç°å’Œå¤„ç†æ–‡å­—å­—ç¬¦ç¼–ç ç¼–ç è§„åˆ™ï¼šå°†ã€Œç ä½ã€è½¬æ¢ä¸ºå­—èŠ‚åºåˆ—çš„è§„åˆ™ï¼ˆç¼–ç /è§£ç  å¯ä»¥ç†è§£ä¸º åŠ å¯†/è§£å¯† çš„è¿‡ç¨‹ï¼‰å¸¸è§ç¼–ç æ–¹å¼ï¼šASCII ç¼–ç ï¼šå°†ASCIIå­—ç¬¦é›†è½¬æ¢ä¸ºè®¡ç®—æœºå¯ä»¥æ¥å—çš„æ•°å­—ç³»ç»Ÿçš„æ•°çš„è§„åˆ™ã€‚ä½¿ç”¨7ä½ï¼ˆbitsï¼‰è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œå…±128å­—ç¬¦ï¼›ä½†æ˜¯7ä½ç¼–ç çš„å­—ç¬¦é›†åªèƒ½æ”¯æŒ128ä¸ªå­—ç¬¦ï¼Œä¸ºäº†è¡¨ç¤ºæ›´å¤šçš„æ¬§æ´²å¸¸ç”¨å­—ç¬¦å¯¹ASCIIè¿›è¡Œäº†æ‰©å±•ï¼ŒASCIIæ‰©å±•å­—ç¬¦é›†ä½¿ç”¨8ä½ï¼ˆbitsï¼‰è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œå…±256å­—ç¬¦ã€‚ UTF-8 ç¼–ç ï¼šUTF-8ï¼ˆ8-bit Unicode Transformation Formatï¼‰æ˜¯ä¸€ç§é’ˆå¯¹Unicodeçš„å¯å˜é•¿åº¦å­—ç¬¦ç¼–ç ï¼Œä¹Ÿæ˜¯ä¸€ç§å‰ç¼€ç ã€‚å…¶ç¼–ç ä¸­çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ä»ä¸ASCIIå…¼å®¹ï¼Œè¿™ä½¿å¾—åŸæ¥å¤„ç†ASCIIå­—ç¬¦çš„è½¯ä»¶æ— é¡»æˆ–åªé¡»åšå°‘éƒ¨åˆ†ä¿®æ”¹ï¼Œå³å¯ç»§ç»­ä½¿ç”¨ã€‚ ç”Ÿæˆå™¨ã€è¿­ä»£å™¨å’Œå¯è¿­ä»£å¯¹è±¡è¿­ä»£å™¨å’Œå¯è¿­ä»£å¯¹è±¡å¯è¿­ä»£å¯¹è±¡åŒ…å«è¿­ä»£å™¨å¦‚æœä¸€ä¸ªå¯¹è±¡æ‹¥æœ‰iteræ–¹æ³•ï¼Œå…¶æ˜¯å¯è¿­ä»£å¯¹è±¡ï¼›å¦‚æœä¸€ä¸ªå¯¹è±¡æ‹¥æœ‰nextæ–¹æ³•ï¼Œå…¶æ˜¯è¿­ä»£å™¨å®šä¹‰å¯è¿­ä»£å¯¹è±¡ï¼Œå¿…é¡»å®ç°iteræ–¹æ³•ï¼›å®šä¹‰è¿­ä»£å™¨ï¼Œå¿…é¡»å®ç°iterå’Œnextæ–¹æ³•ç”Ÿæˆå™¨æ˜¯ä¸€ç§ç‰¹æ®Šçš„è¿­ä»£å™¨åœ¨ä½¿ç”¨ç”Ÿæˆå™¨æ—¶ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼›åœ¨ä½¿ç”¨è¿­ä»£å™¨æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨å†…ç½®å‡½æ•°iter()å’Œnext()åœ¨ç”Ÿæˆå™¨ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨å…³é”®å­—â€˜yieldâ€™æ¥æ¯æ¬¡ç”Ÿæˆ/è¿”å›ä¸€ä¸ªå¯¹è±¡ç”Ÿæˆå™¨ä¸­æœ‰å¤šå°‘â€˜yieldâ€™è¯­å¥ï¼Œä½ å¯ä»¥è‡ªå®šä¹‰æ¯æ¬¡â€˜yieldâ€™æš‚åœå¾ªç¯æ—¶ï¼Œç”Ÿæˆå™¨ä¼šä¿å­˜æœ¬åœ°å˜é‡çš„çŠ¶æ€è¿­ä»£å™¨å¹¶ä¸ä¼šä½¿ç”¨å±€éƒ¨å˜é‡ï¼Œå®ƒåªéœ€è¦ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡è¿›è¡Œè¿­ä»£ä½¿ç”¨ç±»å¯ä»¥å®ç°ä½ è‡ªå·±çš„è¿­ä»£å™¨ï¼Œä½†æ— æ³•å®ç°ç”Ÿæˆå™¨ç”Ÿæˆå™¨è¿è¡Œé€Ÿåº¦å¿«ï¼Œè¯­æ³•ç®€æ´ï¼Œæ›´ç®€å•è¿­ä»£å™¨æ›´èƒ½èŠ‚çº¦å†…å­˜å¯è¿­ä»£å¯¹è±¡ï¼Œè¿­ä»£å™¨å’Œç”Ÿæˆå™¨ä¹‹é—´çš„å…³ç³»å¦‚ä¸‹Pipenvä¾èµ–ç®¡ç†å·¥å…·Pipenvï¼šæ–°ä¸€ä»£Pythoné¡¹ç›®ç¯å¢ƒä¸ä¾èµ–ç®¡ç†å·¥å…·pipenvä½¿ç”¨æŒ‡å—ä½¿ç”¨ pipdeptree å·¥å…·æ¥ç®¡ç†ä¾èµ–æ ‘1234567891011121314$ pip install pipdeptree...$ pipdeptreecertifi==2020.6.20Flask==1.1.2  - click [required: &gt;=5.1, installed: 7.1.2]  - itsdangerous [required: &gt;=0.24, installed: 1.1.0]  - Jinja2 [required: &gt;=2.10.1, installed: 2.11.3]    - MarkupSafe [required: &gt;=0.23, installed: 1.1.1]  - Werkzeug [required: &gt;=0.15, installed: 1.0.1]pipdeptree==2.0.0  - pip [required: &gt;=6.0.0, installed: 19.3.1]setuptools==44.0.0.post20200106wheel==0.36.2pip-autoremoveå¯ä»¥åˆ é™¤ä¾èµ–åŒ…12345678910$ pip install flask$ pip install pip-autoremove$ pip-autoremove flask -y$ pipdeptreecertifi==2020.6.20pip-autoremove==0.9.1pipdeptree==2.0.0  - pip [required: &gt;=6.0.0, installed: 19.3.1]setuptools==44.0.0.post20200106wheel==0.36.2ç§æœ‰ä»“åº“Python ç¬”è®° | å»ºç«‹pythonç§æœ‰ä»“åº“å®‰è£…pypiserver1pip install pypiserverå®‰è£…htpasswdçš„ç›¸å…³ä¾èµ–123yum install apache2pip install passlibyum -y install httpd-toolshtpasswdç”Ÿæˆä¸Šä¼ å¯†ç 1htpasswd -sc ~/pypipasswd.txt user_nameåˆ›å»ºpythonåŒ…å­˜æ”¾çš„ç›®å½•ï¼Œå¯ä»¥æ”¾ä¸ªwhlåŒ…è¿›å»1mkdir ~/packageså¼€å¯æœåŠ¡1pypi-server -p 8080 -P ~/pypipasswd.txt ~/packages pipå®‰è£…1pip install --extra-index-url http://120.120.120.120:8080/simple/ --trusted-host 120.120.120.120 workbench_toutiaoæŸ¥çœ‹åº“ä¸­å¸¸ç”¨æ¨¡å—1234import mathdir(math)['__doc__', '__loader__', '__name__', '__package__', '__spec__',  'acos', 'acosh', 'asin', 'asinh', 'atan', 'atan2', ...]linuxåå°æ‰§è¡Œpyè„šæœ¬ç¨‹åºåå°è¿è¡Œ1nohup python test.py &gt; tt.log&gt;&amp;1 &amp;nohup.outä¸­æ˜¾ç¤ºä¸å‡ºæ¥pythonç¨‹åºä¸­printçš„ä¸œè¥¿ï¼Œè¿™æ˜¯å› ä¸ºpythonçš„è¾“å‡ºæœ‰ç¼“å†²ï¼Œå¯¼è‡´nohup.outå¹¶ä¸èƒ½å¤Ÿé©¬ä¸Šçœ‹åˆ°è¾“å‡ºpython æœ‰ä¸ª-uå‚æ•°ï¼Œä½¿å¾—pythonä¸å¯ç”¨ç¼“å†²1nohup python -u test.py&gt;tt.log&gt;&amp;1 &amp;è¿˜æœ‰ä¸€ç§æ–¹å¼(æœªå°è¯•è¿‡)12import syssys.stdout = Unbuffered(sys.stdout)ä»£ç è°ƒè¯•æŠ€å·§Python ä»£ç è°ƒè¯•æŠ€å·§Python 3.7ï¼Œåˆ™æ— éœ€å¯¼å…¥ä»»ä½•å†…å®¹ï¼Œåªéœ€åœ¨ä»£ç ä¸­è¦æ”¾å…¥è°ƒè¯•å™¨çš„ä½ç½®è°ƒç”¨breakpoint()12Some complicated code with bugsbreakpoint()Python 3.6åŠæ›´æ—©ç‰ˆæœ¬ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡æ˜¾å¼å¯¼å…¥pdbæ¥æ‰§è¡Œç›¸åŒçš„æ“ä½œï¼Œåƒbreakpoint()ä¸€æ ·ï¼Œpdb.set_trace()ä¼šå°†ä½ å¸¦å…¥pdbè°ƒè¯•å™¨12import pdb; pdb.set_trace()åº“å’Œå¸¸ç”¨æ–¹æ³•å˜é‡å­˜å‚¨å·¥å…·æ–¹æ³•ä»€ä¹ˆæ˜¯é…¸æ´—å’Œå»é™¤ï¼ŸPickleæ¨¡å—æ¥å—ä»»ä½•Pythonå¯¹è±¡å¹¶å°†å…¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ï¼Œå¹¶ä½¿ç”¨dumpå‡½æ•°å°†å…¶è½¬å‚¨åˆ°æ–‡ä»¶ä¸­ï¼Œæ­¤è¿‡ç¨‹ç§°ä¸ºpicklingä»å­˜å‚¨çš„å­—ç¬¦ä¸²è¡¨ç¤ºä¸­æ£€ç´¢åŸå§‹Pythonå¯¹è±¡çš„è¿‡ç¨‹ç§°ä¸ºunpickling123456789101112import dillimport pickle as pkdef dump_obj(obj, file_name):    with open(file_name, 'wb') as f:        dill.dump(obj, f)def load_obj(file_name):    with open(file_name, &quot;rb&quot;) as f:        try:            return dill.load(f)        except Exception:            return pk.load(f)åºåˆ—æ’åºPythonä¸­æ‹¥æœ‰å†…ç½®å‡½æ•°å®ç°æ’åºï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨å®ƒä»¬å®ç°æ’åºåŠŸèƒ½list.sort(): ç›´æ¥ä¿®æ”¹åˆ—è¡¨sorted(): ä»ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡æ„å»ºä¸€ä¸ªæ–°çš„æ’åºåˆ—è¡¨ä¸ç®¡æ˜¯ list.sort æ–¹æ³•è¿˜æ˜¯ sorted å‡½æ•°ï¼Œéƒ½æœ‰ä¸¤ä¸ªå¯é€‰çš„å…³é”®å­—å‚æ•°list.sort(cmp=None, key=None, reverse=False)cmp â€” å¯é€‰å‚æ•°, å¦‚æœæŒ‡å®šäº†è¯¥å‚æ•°ä¼šä½¿ç”¨è¯¥å‚æ•°çš„æ–¹æ³•è¿›è¡Œæ’åºkey â€” ä¸»è¦æ˜¯ç”¨æ¥è¿›è¡Œæ¯”è¾ƒçš„å…ƒç´ ï¼Œåªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œå‡½æ•°çš„å‚æ•°å°±æ˜¯å–è‡ªäºå¯è¿­ä»£å¯¹è±¡ä¸­ï¼ŒæŒ‡å®šå¯è¿­ä»£å¯¹è±¡ä¸­çš„ä¸€ä¸ªå…ƒç´ æ¥è¿›è¡Œæ’åºreverse â€” æ’åºè§„åˆ™ï¼Œreverse = True é™åºï¼Œ reverse = False å‡åº(é»˜è®¤)sorted(iterable, cmp=None, key=None, reverse=False)erable â€” å¯è¿­ä»£å¯¹è±¡cmp â€” æ¯”è¾ƒçš„å‡½æ•°ï¼Œè¿™ä¸ªå…·æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œå‚æ•°çš„å€¼éƒ½æ˜¯ä»å¯è¿­ä»£å¯¹è±¡ä¸­å–å‡ºæ­¤å‡½æ•°å¿…é¡»éµå®ˆçš„è§„åˆ™ä¸ºï¼Œå¤§äºåˆ™è¿”å›1ï¼Œå°äºåˆ™è¿”å›-1ï¼Œç­‰äºåˆ™è¿”å›0ã€‚key â€” ä¸»è¦æ˜¯ç”¨æ¥è¿›è¡Œæ¯”è¾ƒçš„å…ƒç´ ï¼Œåªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œå‡½æ•°çš„å‚æ•°å°±æ˜¯å–è‡ªäºå¯è¿­ä»£å¯¹è±¡ä¸­ï¼ŒæŒ‡å®šå¯è¿­ä»£å¯¹è±¡ä¸­çš„ä¸€ä¸ªå…ƒç´ æ¥è¿›è¡Œæ’åºreverse â€” æ’åºè§„åˆ™ï¼Œreverse = True é™åº ï¼Œreverse = False å‡åº(é»˜è®¤)sort ()ä¸sorted()åŒºåˆ«sort() æ˜¯åº”ç”¨åœ¨ list ä¸Šçš„æ–¹æ³•ï¼Œsorted() å¯ä»¥å¯¹æ‰€æœ‰å¯è¿­ä»£çš„å¯¹è±¡è¿›è¡Œæ’åºæ“ä½œlist çš„ sort() æ–¹æ³•è¿”å›çš„æ˜¯å¯¹å·²ç»å­˜åœ¨çš„åˆ—è¡¨è¿›è¡Œæ“ä½œï¼Œæ— è¿”å›å€¼è€Œå†…å»ºå‡½æ•° sorted() æ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ªæ–°çš„ listï¼Œè€Œä¸æ˜¯åœ¨åŸæ¥çš„åŸºç¡€ä¸Šè¿›è¡Œçš„æ“ä½œå•å…³é”®å­—æ’åº12345678910111213141516# é»˜è®¤æƒ…å†µä¸‹ï¼Œsorted()å·²æŒ‰å‡åºå¯¹è¾“å…¥è¿›è¡Œæ’åºï¼Œè€Œreverseå…³é”®å­—å‚æ•°åˆ™æŒ‰é™åºæ’åºã€‚&gt;&gt;&gt; sorted(['cat', 'dog', 'cheetah', 'rhino', 'bear'], reverse=True)['rhino', 'dog', 'cheetah', 'cat', 'bear]&gt;&gt;&gt; animals = [...     {'type': 'penguin', 'name': 'Stephanie', 'age': 8},...     {'type': 'elephant', 'name': 'Devon', 'age': 3},...     {'type': 'puma', 'name': 'Moe', 'age': 5},... ]&gt;&gt;&gt; sorted(animals, key=lambda animal: animal['age'])[    {'type': 'elephant', 'name': 'Devon', 'age': 3},    {'type': 'puma', 'name': 'Moe', 'age': 5},    {'type': 'penguin', 'name': 'Stephanie, 'age': 8},]# é€šè¿‡ä¼ å…¥ä¸€ä¸ªè¿”å›æ¯ä¸ªå…ƒç´ å¹´é¾„çš„lambdaå‡½æ•°ï¼Œå¯ä»¥è½»æ¾åœ°æŒ‰æ¯ä¸ªå­—å…¸çš„å•ä¸ªå€¼å¯¹å­—å…¸åˆ—è¡¨è¿›è¡Œæ’åºã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå­—å…¸ç°åœ¨æŒ‰å¹´é¾„æŒ‰å‡åºæ’åºã€‚å¤šå…³é”®å­—æ’åº1234# itemgetter() å‡½æ•°ä¹Ÿæ”¯æŒå¤šä¸ª keysrows_by_lfname = sorted(rows, key=itemgetter('lname','fname'))# itemgetter() æœ‰æ—¶å€™ä¹Ÿå¯ä»¥ç”¨ lambda è¡¨è¾¾å¼ä»£æ›¿rows_by_lfname = sorted(rows, key=lambda r: (r['lname'],r['fname']))ä½¿ç”¨ itemgetter() æ–¹å¼ä¼šè¿è¡Œçš„ç¨å¾®å¿«ç‚¹ï¼Œå¦‚æœä½ å¯¹æ€§èƒ½è¦æ±‚æ¯”è¾ƒé«˜çš„è¯å°±ä½¿ç”¨ itemgetter() æ–¹å¼importè·¯å¾„é—®é¢˜12import syssys.path.append(&quot;..&quot;)åˆ¤æ–­æ˜¯å¦æœ‰ä¸­æ–‡1234def is_chinese(uchar):    if u'\u4e00' &lt;= uchar &lt;= u'\u9fff':        return True    return Falseåˆ†å‰²å­—ç¬¦ä¸²å¹¶è½¬æ¢ç±»å‹123456import numpy as npline = '12,26,31,17,90,28,88,40,77'npyArray = np.fromstring(line, dtype=int, sep=',')print(npyArray)array([12, 26, 31, 17, 90, 28, 88, 40, 77])æ£€æŸ¥å¯¹è±¡æ˜¯å¦å¯è°ƒç”¨12345def fuunction(param):    print(param)print(callable(fuunction))Trueéšæœºæ‰“ä¹±å¤šä¸ªæ•°ç»„123456789import numpy as npdef shuffledata(*arrs):# èª¿ç”¨æ¡ˆä¾‹ x,y = shuffledata(X,Y)arrs = list(arrs)for i, arr in enumerate(arrs):   assert len(arrs[0]) == len(arrs[i])   arrs[i] = np.array(arr)p = np.random.permutation(len(arrs[0]))return tuple(arr[p] for arr in arrs)pandasè¯»å†™csv12345678910111213141516171819202122232425262728293031#!/usr/bin/env Python# -- coding: utf-8 --&quot;&quot;&quot;@version: v0.1@author: narutohyc@file: hyc_test.py@Description: @time: 2020/5/28 20:08&quot;&quot;&quot;import pandas as pddef csv_test():    csv_name = 'my_csv.csv'# åˆå§‹åŒ–ä¸€ä¸ªå¸¦è¡¨å¤´çš„ç©ºè¡¨    f1 = pd.DataFrame(None, columns=['name', 'price', 'marks'])    f1.to_csv(csv_name, mode='w', encoding='utf-8', index=False)    # è¿½åŠ æ•°æ®åˆ°å·²å­˜åœ¨çš„è¡¨    data = {&quot;name&quot;: ['google', 'baidu', 'yahoo'], &quot;marks&quot;: [100, 200, 300], &quot;price&quot;: [1, 2, 3]}    f1 = pd.DataFrame(data, columns=['name', 'price', 'marks'])    f1.to_csv(csv_name, mode='a', encoding='utf-8', header=False, index=False)    # è¯»å–csv,index_col=Falseè¡¨ç¤ºä¸å­˜åœ¨ç´¢å¼•åˆ—    f2 = pd.read_csv(csv_name, encoding='utf-8', index_col=False)    print()if __name__ == '__main__':    csv_test()classmethod å’Œ staticmethodPython ä¸­çš„ classmethod å’Œ staticmethod æœ‰ä»€ä¹ˆå…·ä½“ç”¨é€”ï¼Ÿä¼˜é›…åˆ¤æ–­æ•°å­—æ‰€å±ç­‰çº§æœ‰ä» A åˆ° F çš„ 5 ä¸ªç­‰çº§ï¼Œç°è¦åˆ¤æ–­æŸä¸ªæ•°å€¼ï¼ˆä» 0 åˆ° 1 ä¹‹é—´ï¼‰æ‰€å±çš„ç­‰çº§ä¸¾ä¾‹ï¼Œå¦‚æ•°å€¼ &gt;= 0.9ï¼Œåˆ™å±äº Aï¼›è‹¥æ•°å€¼ &gt;= 0.8ï¼Œåˆ™å±äº Bï¼›ä»¥æ­¤ç±»æ¨1234567891011121314from typing import Iterablefrom bisect import bisect def cal_level(score: float, breakpoints: Iterable, name_codes: List): &quot;&quot;&quot; äºŒåˆ†æŸ¥æ‰¾ è®¡ç®—åˆ†æ•°ç­‰çº§ ç¤ºä¾‹ï¼š     obj = cal_level(score=78, breakpoints=(60, 70, 80, 90), name_codes='FDCBA') :param score: å¾—åˆ† :param breakpoints: åˆ†å€¼åŒºé—´ :param name_codes: å„åŒºé—´å¯¹åº”ç»“æœ :return: è¯¥åˆ†å€¼çš„å¯¹åº”ç»“æœ &quot;&quot;&quot; return name_codes[bisect(breakpoints, score)]å–æ•´æ“ä½œ123456789101112131415161718192021222324252627282930313233343536def learning():    import math    # å‘ä¸Šå–æ•´    math.ceil(2.3)  # 3    math.ceil(2.6)  # 3    # å‘ä¸‹å–æ•´    math.floor(2.3)  # 2    math.floor(2.6)  # 2    # å››èˆäº”å…¥    round(6.6)  # 7    round(6.4)  # 6    round(6.55)  # 7    # åªè¦ä¸æ˜¯.5çš„å½¢å¼ï¼Œä¹Ÿå°±æ˜¯å°æ•°ä½ä¸ä¸º5ï¼ŒroundåŸºæœ¬ç”¨æ³•å°±æ˜¯å››èˆäº”å…¥ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œroundç”¨äºåœ†æ•´ï¼Œä¿ç•™æœ€è¿‘å¶æ•°ï¼š    round(6.5)  # 6  æ˜¯å¶æ•°    round(7.5)  # 8 æ˜¯å¶æ•°    import torch    import torch.nn as nn    m = nn.Linear(20, 30)    input = torch.randn(128, 20)    output = m(input)    logger.info(output.shape)  # torch.Size([128, 30])    m = nn.Conv2d(16, 33, 3, stride=2)    input = torch.randn(20, 16, 50, 100)    output = m(input)    logger.info(output.shape)  # torch.Size([20, 33, 24, 95])     (190 + 2 * 0 - (3 - 1) - 1) / 2 + 1    embedding = nn.Embedding(10, 3)    input = torch.LongTensor([[1, 2, 4, 5], [4, 3, 2, 9]])    logger.info(input.shape)  # torch.Size([2, 4])    output = embedding(input)    logger.info(output.shape)  # torch.Size([2, 4, 3])è…¾è®¯ä¸‰é¢ï¼š40äº¿ä¸ªQQå·ç å¦‚ä½•å»é‡ï¼Ÿå…¶ä»–åº“å“ªäº› Python åº“è®©ä½ ç›¸è§æ¨æ™šï¼Ÿpython cookbookè®°å½•æ•°æ®ç»“æ„å’Œç®—æ³•æœ€å¤§æˆ–æœ€å°çš„ N ä¸ªå…ƒç´ æ€æ ·ä»ä¸€ä¸ªé›†åˆä¸­è·å¾—æœ€å¤§æˆ–è€…æœ€å°çš„ N ä¸ªå…ƒç´ åˆ—è¡¨ï¼Ÿheapq æ¨¡å—æœ‰ä¸¤ä¸ªå‡½æ•°ï¼šnlargest() å’Œ nsmallest() å¯ä»¥å®Œç¾è§£å†³è¿™ä¸ªé—®é¢˜ã€‚1234import heapqnums = [1, 8, 2, 23, 7, -4, 18, 23, 42, 37, 2]print(heapq.nlargest(3, nums)) # Prints [42, 37, 23]print(heapq.nsmallest(3, nums)) # Prints [-4, 1, 2]ä¸¤ä¸ªå‡½æ•°éƒ½èƒ½æ¥å—ä¸€ä¸ªå…³é”®å­—å‚æ•°ï¼Œç”¨äºæ›´å¤æ‚çš„æ•°æ®ç»“æ„ä¸­ï¼š12345678910portfolio = [{'name': 'IBM', 'shares': 100, 'price': 91.1},{'name': 'AAPL', 'shares': 50, 'price': 543.22},{'name': 'FB', 'shares': 200, 'price': 21.09},{'name': 'HPQ', 'shares': 35, 'price': 31.75},{'name': 'YHOO', 'shares': 45, 'price': 16.35},{'name': 'ACME', 'shares': 75, 'price': 115.65}]cheap = heapq.nsmallest(3, portfolio, key=lambda s: s['price'])expensive = heapq.nlargest(3, portfolio, key=lambda s: s['price'])è¯‘è€…æ³¨ï¼šä¸Šé¢ä»£ç åœ¨å¯¹æ¯ä¸ªå…ƒç´ è¿›è¡Œå¯¹æ¯”çš„æ—¶å€™ï¼Œä¼šä»¥ price çš„å€¼è¿›è¡Œæ¯”è¾ƒå¦‚æœä½ æƒ³åœ¨ä¸€ä¸ªé›†åˆä¸­æŸ¥æ‰¾æœ€å°æˆ–æœ€å¤§çš„ N ä¸ªå…ƒç´ ï¼Œå¹¶ä¸” N å°äºé›†åˆå…ƒç´ æ•°é‡ï¼Œé‚£ä¹ˆè¿™äº›å‡½æ•°æä¾›äº†å¾ˆå¥½çš„æ€§èƒ½ã€‚å› ä¸ºåœ¨åº•å±‚å®ç°é‡Œé¢ï¼Œé¦–å…ˆä¼šå…ˆå°†é›†åˆæ•°æ®è¿›è¡Œå †æ’åºåæ”¾å…¥ä¸€ä¸ªåˆ—è¡¨ä¸­ï¼š123456nums = [1, 8, 2, 23, 7, -4, 18, 23, 42, 37, 2]import heapqheap = list(nums)heapq.heapify(heap)heap[-4, 2, 1, 23, 7, 2, 18, 23, 42, 37, 8]å †æ•°æ®ç»“æ„æœ€é‡è¦çš„ç‰¹å¾æ˜¯ heap[0] æ°¸è¿œæ˜¯æœ€å°çš„å…ƒç´ ã€‚å¹¶ä¸”å‰©ä½™çš„å…ƒç´ å¯ä»¥å¾ˆå®¹æ˜“çš„é€šè¿‡è°ƒç”¨heapq.heappop() æ–¹æ³•å¾—åˆ°ï¼Œè¯¥æ–¹æ³•ä¼šå…ˆå°†ç¬¬ä¸€ä¸ªå…ƒç´ å¼¹å‡ºæ¥ï¼Œç„¶åç”¨ä¸‹ä¸€ä¸ªæœ€å°çš„å…ƒç´ æ¥å–ä»£è¢«å¼¹å‡ºå…ƒç´ ï¼ˆè¿™ç§æ“ä½œæ—¶é—´å¤æ‚åº¦ä»…ä»…æ˜¯$Olog(N)$ï¼Œ$N$æ˜¯å †å¤§å°ï¼‰ã€‚å°ç»“ï¼šå½“è¦æŸ¥æ‰¾çš„å…ƒç´ ä¸ªæ•°ç›¸å¯¹æ¯”è¾ƒå°çš„æ—¶å€™ï¼Œå‡½æ•° nlargest() å’Œ nsmallest() æ˜¯å¾ˆåˆé€‚çš„ã€‚å¦‚æœä½ ä»…ä»…æƒ³æŸ¥æ‰¾å”¯ä¸€çš„æœ€å°æˆ–æœ€å¤§ï¼ˆN=1ï¼‰çš„å…ƒç´ çš„è¯ï¼Œé‚£ä¹ˆä½¿ç”¨ min() å’Œmax() å‡½æ•°ä¼šæ›´å¿«äº›ã€‚ç±»ä¼¼çš„ï¼Œå¦‚æœ N çš„å¤§å°å’Œé›†åˆå¤§å°æ¥è¿‘çš„æ—¶å€™ï¼Œé€šå¸¸å…ˆæ’åºè¿™ä¸ªé›†åˆç„¶åå†ä½¿ç”¨åˆ‡ç‰‡æ“ä½œä¼šæ›´å¿«ç‚¹ï¼ˆsorted(items)[:N] æˆ–è€…æ˜¯ sorted(items)[-N:]ï¼‰ã€‚éœ€è¦åœ¨æ­£ç¡®åœºåˆä½¿ç”¨å‡½æ•° nlargest() å’Œ nsmallest() æ‰èƒ½å‘æŒ¥å®ƒä»¬çš„ä¼˜åŠ¿ï¼ˆå¦‚æœN å¿«æ¥è¿‘é›†åˆå¤§å°äº†ï¼Œé‚£ä¹ˆä½¿ç”¨æ’åºæ“ä½œä¼šæ›´å¥½äº›ï¼‰ã€‚å®ç°ä¸€ä¸ªä¼˜å…ˆçº§é˜Ÿåˆ—æ€æ ·å®ç°ä¸€ä¸ªæŒ‰ä¼˜å…ˆçº§æ’åºçš„é˜Ÿåˆ—ï¼Ÿå¹¶ä¸”åœ¨è¿™ä¸ªé˜Ÿåˆ—ä¸Šé¢æ¯æ¬¡ pop æ“ä½œæ€»æ˜¯è¿”å›ä¼˜å…ˆçº§æœ€é«˜çš„é‚£ä¸ªå…ƒç´ åˆ©ç”¨ heapq æ¨¡å—å®ç°äº†ä¸€ä¸ªç®€å•çš„ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼š12345678910111213import heapqclass PriorityQueue:    def __init__(self):        self._queue = []        self._index = 0        def push(self, item, priority):            heapq.heappush(self._queue, (-priority, self._index, item))            self._index += 1        def pop(self):            return heapq.heappop(self._queue)[-1]1234567891011121314151617181920&gt;&gt;&gt; class Item:... def __init__(self, name):... self.name = name... def __repr__(self):... return 'Item({!r})'.format(self.name)...&gt;&gt;&gt; q = PriorityQueue()&gt;&gt;&gt; q.push(Item('foo'), 1)&gt;&gt;&gt; q.push(Item('bar'), 5)&gt;&gt;&gt; q.push(Item('spam'), 4)&gt;&gt;&gt; q.push(Item('grok'), 1)&gt;&gt;&gt; q.pop()Item('bar')&gt;&gt;&gt; q.pop()Item('spam')&gt;&gt;&gt; q.pop()Item('foo')&gt;&gt;&gt; q.pop()Item('grok')&gt;&gt;&gt;ä»”ç»†è§‚å¯Ÿå¯ä»¥å‘ç°ï¼Œç¬¬ä¸€ä¸ª pop() æ“ä½œè¿”å›ä¼˜å…ˆçº§æœ€é«˜çš„å…ƒç´ ã€‚å¦å¤–æ³¨æ„åˆ°å¦‚æœä¸¤ä¸ªæœ‰ç€ç›¸åŒä¼˜å…ˆçº§çš„å…ƒç´ ï¼ˆfoo å’Œ grok ï¼‰ï¼Œpop æ“ä½œæŒ‰ç…§å®ƒä»¬è¢«æ’å…¥åˆ°é˜Ÿåˆ—çš„é¡ºåºè¿”å›çš„ã€‚åœ¨ä¸Šé¢ä»£ç ä¸­ï¼Œé˜Ÿåˆ—åŒ…å«äº†ä¸€ä¸ª (-priority, index, item) çš„å…ƒç»„ã€‚ä¼˜å…ˆçº§ä¸ºè´Ÿæ•°çš„ç›®çš„æ˜¯ä½¿å¾—å…ƒç´ æŒ‰ç…§ä¼˜å…ˆçº§ä»é«˜åˆ°ä½æ’åºã€‚è¿™ä¸ªè·Ÿæ™®é€šçš„æŒ‰ä¼˜å…ˆçº§ä»ä½åˆ°é«˜æ’åºçš„å †æ’åºæ°å·§ç›¸åã€‚index å˜é‡çš„ä½œç”¨æ˜¯ä¿è¯åŒç­‰ä¼˜å…ˆçº§å…ƒç´ çš„æ­£ç¡®æ’åºã€‚é€šè¿‡ä¿å­˜ä¸€ä¸ªä¸æ–­å¢åŠ çš„index ä¸‹æ ‡å˜é‡ï¼Œå¯ä»¥ç¡®ä¿å…ƒç´ æŒ‰ç…§å®ƒä»¬æ’å…¥çš„é¡ºåºæ’åºã€‚è€Œä¸”ï¼Œindex å˜é‡ä¹Ÿåœ¨ç›¸åŒä¼˜å…ˆçº§å…ƒç´ æ¯”è¾ƒçš„æ—¶å€™èµ·åˆ°é‡è¦ä½œç”¨é€šè¿‡å¼•å…¥å¦å¤–çš„ index å˜é‡ç»„æˆä¸‰å…ƒç»„ (priority, index, item) ï¼Œå°±èƒ½å¾ˆå¥½çš„é¿å…ä¸Šé¢çš„é”™è¯¯ï¼Œå› ä¸ºä¸å¯èƒ½æœ‰ä¸¤ä¸ªå…ƒç´ æœ‰ç›¸åŒçš„ index å€¼ã€‚Python åœ¨åšå…ƒç»„æ¯”è¾ƒæ—¶å€™ï¼Œå¦‚æœå‰é¢çš„æ¯”è¾ƒå·²ç»å¯ä»¥ç¡®å®šç»“æœäº†ï¼Œåé¢çš„æ¯”è¾ƒæ“ä½œå°±ä¸ä¼šå‘ç”Ÿäº†ï¼š1234567a = (1, 0, Item('foo'))b = (5, 1, Item('bar'))c = (1, 2, Item('grok'))a &lt; bTruea &lt; cTrueå¦‚æœä½ æƒ³åœ¨å¤šä¸ªçº¿ç¨‹ä¸­ä½¿ç”¨åŒä¸€ä¸ªé˜Ÿåˆ—ï¼Œé‚£ä¹ˆä½ éœ€è¦å¢åŠ é€‚å½“çš„é”å’Œä¿¡å·é‡æœºåˆ¶ã€‚å­—å…¸çš„è¿ç®—æ€æ ·åœ¨æ•°æ®å­—å…¸ä¸­æ‰§è¡Œä¸€äº›è®¡ç®—æ“ä½œï¼ˆæ¯”å¦‚æ±‚æœ€å°å€¼ã€æœ€å¤§å€¼ã€æ’åºç­‰ç­‰ï¼‰ï¼Ÿè€ƒè™‘ä¸‹é¢çš„è‚¡ç¥¨åå’Œä»·æ ¼æ˜ å°„å­—å…¸ï¼š123456prices = {    'ACME': 45.23,    'AAPL': 612.78,    'IBM': 205.55,    'HPQ': 37.20,    'FB': 10.75}ä¸ºäº†å¯¹å­—å…¸å€¼æ‰§è¡Œè®¡ç®—æ“ä½œï¼Œé€šå¸¸éœ€è¦ä½¿ç”¨ zip() å‡½æ•°å…ˆå°†é”®å’Œå€¼åè½¬è¿‡æ¥ã€‚æ¯”å¦‚ï¼Œä¸‹é¢æ˜¯æŸ¥æ‰¾æœ€å°å’Œæœ€å¤§è‚¡ç¥¨ä»·æ ¼å’Œè‚¡ç¥¨å€¼çš„ä»£ç 1234min_price = min(zip(prices.values(), prices.keys()))# min_price is (10.75, 'FB')max_price = max(zip(prices.values(), prices.keys()))# max_price is (612.78, 'AAPL')ç±»ä¼¼çš„ï¼Œå¯ä»¥ä½¿ç”¨ zip() å’Œ sorted() å‡½æ•°æ¥æ’åˆ—å­—å…¸æ•°æ®ï¼š1234prices_sorted = sorted(zip(prices.values(), prices.keys()))# prices_sorted is [(10.75, 'FB'), (37.2, 'HPQ'),# (45.23, 'ACME'), (205.55, 'IBM'),# (612.78, 'AAPL')]å¦‚æœä½ åœ¨ä¸€ä¸ªå­—å…¸ä¸Šæ‰§è¡Œæ™®é€šçš„æ•°å­¦è¿ç®—ï¼Œä½ ä¼šå‘ç°å®ƒä»¬ä»…ä»…ä½œç”¨äºé”®ï¼Œè€Œä¸æ˜¯å€¼ã€‚éœ€è¦æ³¨æ„çš„æ˜¯åœ¨è®¡ç®—æ“ä½œä¸­ä½¿ç”¨åˆ°äº† (å€¼ï¼Œé”®) å¯¹ã€‚å½“å¤šä¸ªå®ä½“æ‹¥æœ‰ç›¸åŒçš„å€¼çš„æ—¶å€™ï¼Œé”®ä¼šå†³å®šè¿”å›ç»“æœã€‚æ¯”å¦‚ï¼Œåœ¨æ‰§è¡Œ min() å’Œ max() æ“ä½œçš„æ—¶å€™ï¼Œå¦‚æœæ°å·§æœ€å°æˆ–æœ€å¤§å€¼æœ‰é‡å¤çš„ï¼Œé‚£ä¹ˆæ‹¥æœ‰æœ€å°æˆ–æœ€å¤§é”®çš„å®ä½“ä¼šè¿”å›ï¼š12345prices = { 'AAA' : 45.23, 'ZZZ': 45.23 }min(zip(prices.values(), prices.keys()))(45.23, 'AAA')max(zip(prices.values(), prices.keys()))(45.23, 'ZZZ')æŸ¥æ‰¾ä¸¤å­—å…¸çš„ç›¸åŒç‚¹ä¸ºäº†å¯»æ‰¾ä¸¤ä¸ªå­—å…¸çš„ç›¸åŒç‚¹ï¼Œå¯ä»¥ç®€å•çš„åœ¨ä¸¤å­—å…¸çš„ keys() æˆ–è€… items() æ–¹æ³•è¿”å›ç»“æœä¸Šæ‰§è¡Œé›†åˆæ“ä½œã€‚123456# Find keys in commona.keys() &amp; b.keys() # { 'x', 'y' }# Find keys in a that are not in ba.keys() - b.keys() # { 'z' }# Find (key,value) pairs in commona.items() &amp; b.items() # { ('y', 2) }è¿™äº›æ“ä½œä¹Ÿå¯ä»¥ç”¨äºä¿®æ”¹æˆ–è€…è¿‡æ»¤å­—å…¸å…ƒç´ ã€‚æ¯”å¦‚ï¼Œå‡å¦‚ä½ æƒ³ä»¥ç°æœ‰å­—å…¸æ„é€ ä¸€ä¸ªæ’é™¤å‡ ä¸ªæŒ‡å®šé”®çš„æ–°å­—å…¸ã€‚ä¸‹é¢åˆ©ç”¨å­—å…¸æ¨å¯¼æ¥å®ç°è¿™æ ·çš„éœ€æ±‚ï¼š123# Make a new dictionary with certain keys removedc = {key:a[key] for key in a.keys() - {'z', 'w'}}# c is {'x': 1, 'y': 2}å°ç»“ï¼šä¸€ä¸ªå­—å…¸å°±æ˜¯ä¸€ä¸ªé”®é›†åˆä¸å€¼é›†åˆçš„æ˜ å°„å…³ç³»ã€‚å­—å…¸çš„ keys() æ–¹æ³•è¿”å›ä¸€ä¸ªå±•ç°é”®é›†åˆçš„é”®è§†å›¾å¯¹è±¡ã€‚é”®è§†å›¾çš„ä¸€ä¸ªå¾ˆå°‘è¢«äº†è§£çš„ç‰¹æ€§å°±æ˜¯å®ƒä»¬ä¹Ÿæ”¯æŒé›†åˆæ“ä½œï¼Œæ¯”å¦‚é›†åˆå¹¶ã€äº¤ã€å·®è¿ç®—ã€‚æ‰€ä»¥ï¼Œå¦‚æœä½ æƒ³å¯¹é›†åˆçš„é”®æ‰§è¡Œä¸€äº›æ™®é€šçš„é›†åˆæ“ä½œï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨é”®è§†å›¾å¯¹è±¡è€Œä¸ç”¨å…ˆå°†å®ƒä»¬è½¬æ¢æˆä¸€ä¸ª setã€‚å­—å…¸çš„ items() æ–¹æ³•è¿”å›ä¸€ä¸ªåŒ…å« (é”®ï¼Œå€¼) å¯¹çš„å…ƒç´ è§†å›¾å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡åŒæ ·ä¹Ÿæ”¯æŒé›†åˆæ“ä½œï¼Œå¹¶ä¸”å¯ä»¥è¢«ç”¨æ¥æŸ¥æ‰¾ä¸¤ä¸ªå­—å…¸æœ‰å“ªäº›ç›¸åŒçš„é”®å€¼å¯¹ã€‚å°½ç®¡å­—å…¸çš„ values() æ–¹æ³•ä¹Ÿæ˜¯ç±»ä¼¼ï¼Œä½†æ˜¯å®ƒå¹¶ä¸æ”¯æŒè¿™é‡Œä»‹ç»çš„é›†åˆæ“ä½œã€‚æŸç§ç¨‹åº¦ä¸Šæ˜¯å› ä¸ºå€¼è§†å›¾ä¸èƒ½ä¿è¯æ‰€æœ‰çš„å€¼äº’ä¸ç›¸åŒï¼Œè¿™æ ·ä¼šå¯¼è‡´æŸäº›é›†åˆæ“ä½œä¼šå‡ºç°é—®é¢˜ã€‚ä¸è¿‡ï¼Œå¦‚æœä½ ç¡¬è¦åœ¨å€¼ä¸Šé¢æ‰§è¡Œè¿™äº›é›†åˆæ“ä½œçš„è¯ï¼Œä½ å¯ä»¥å…ˆå°†å€¼é›†åˆè½¬æ¢æˆ setï¼Œç„¶åå†æ‰§è¡Œé›†åˆè¿ç®—å°±è¡Œäº†ã€‚åˆ é™¤åºåˆ—ç›¸åŒå…ƒç´ å¹¶ä¿æŒé¡ºåºå¦‚æœä½ æƒ³æ¶ˆé™¤å…ƒç´ ä¸å¯å“ˆå¸Œï¼ˆæ¯”å¦‚ dict ç±»å‹ï¼‰çš„åºåˆ—ä¸­é‡å¤å…ƒç´ çš„è¯1234567def dedupe(items, key=None):seen = set()for item in items:val = item if key is None else key(item)if val not in seen:yield itemseen.add(val)è¿™é‡Œçš„ key å‚æ•°æŒ‡å®šäº†ä¸€ä¸ªå‡½æ•°ï¼Œå°†åºåˆ—å…ƒç´ è½¬æ¢æˆ hashable ç±»å‹ã€‚123456&gt;&gt;&gt; a = [ {'x':1, 'y':2}, {'x':1, 'y':3}, {'x':1, 'y':2}, {'x':2, 'y':4}]&gt;&gt;&gt; list(dedupe(a, key=lambda d: (d['x'],d['y'])))[{'x': 1, 'y': 2}, {'x': 1, 'y': 3}, {'x': 2, 'y': 4}]&gt;&gt;&gt; list(dedupe(a, key=lambda d: d['x']))[{'x': 1, 'y': 2}, {'x': 2, 'y': 4}]&gt;&gt;&gt;å¦‚æœä½ æƒ³åŸºäºå•ä¸ªå­—æ®µã€å±æ€§æˆ–è€…æŸä¸ªæ›´å¤§çš„æ•°æ®ç»“æ„æ¥æ¶ˆé™¤é‡å¤å…ƒç´ ï¼Œç¬¬äºŒç§æ–¹æ¡ˆåŒæ ·å¯ä»¥èƒœä»»ã€‚å‘½ååˆ‡ç‰‡å†…ç½®çš„ slice() å‡½æ•°åˆ›å»ºäº†ä¸€ä¸ªåˆ‡ç‰‡å¯¹è±¡ï¼Œå¯ä»¥è¢«ç”¨åœ¨ä»»ä½•åˆ‡ç‰‡å…è®¸ä½¿ç”¨çš„åœ°æ–¹ã€‚å¦‚æœä½ æœ‰ä¸€ä¸ªåˆ‡ç‰‡å¯¹è±¡ aï¼Œä½ å¯ä»¥åˆ†åˆ«è°ƒç”¨å®ƒçš„ a.start , a.stop , a.step å±æ€§æ¥è·å–æ›´å¤šçš„ä¿¡æ¯ã€‚è¿˜èƒ½é€šè¿‡è°ƒç”¨åˆ‡ç‰‡çš„ indices(size) æ–¹æ³•å°†å®ƒæ˜ å°„åˆ°ä¸€ä¸ªç¡®å®šå¤§å°çš„åºåˆ—ä¸Šï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªä¸‰å…ƒç»„ (start, stop, step) ï¼Œæ‰€æœ‰å€¼éƒ½ä¼šè¢«åˆé€‚çš„ç¼©å°ä»¥æ»¡è¶³è¾¹ç•Œé™åˆ¶ï¼Œä»è€Œä½¿ç”¨çš„æ—¶å€™é¿å…å‡ºç° IndexError å¼‚å¸¸ã€‚123&gt;SHARES = slice(20, 23)&gt;PRICE = slice(31, 37)&gt;cost = int(record[SHARES]) * float(record[PRICE])å­—ç¬¦ä¸²å’Œæ–‡æœ¬ä½¿ç”¨å¤šä¸ªç•Œå®šç¬¦åˆ†å‰²å­—ç¬¦ä¸²å‡½æ•° re.split() æ˜¯éå¸¸å®ç”¨çš„ï¼Œå› ä¸ºå®ƒå…è®¸ä½ ä¸ºåˆ†éš”ç¬¦æŒ‡å®šå¤šä¸ªæ­£åˆ™æ¨¡å¼ã€‚æ¯”å¦‚ï¼Œåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œåˆ†éš”ç¬¦å¯ä»¥æ˜¯é€—å·ï¼Œåˆ†å·æˆ–è€…æ˜¯ç©ºæ ¼ï¼Œå¹¶ä¸”åé¢ç´§è·Ÿç€ä»»æ„ä¸ªçš„ç©ºæ ¼ã€‚åªè¦è¿™ä¸ªæ¨¡å¼è¢«æ‰¾åˆ°ï¼Œé‚£ä¹ˆåŒ¹é…çš„åˆ†éš”ç¬¦ä¸¤è¾¹çš„å®ä½“éƒ½ä¼šè¢«å½“æˆæ˜¯ç»“æœä¸­çš„å…ƒç´ è¿”å›ã€‚è¿”å›ç»“æœä¸ºä¸€ä¸ªå­—æ®µåˆ—è¡¨ï¼Œè¿™ä¸ªè·Ÿ str.split() è¿”å›å€¼ç±»å‹æ˜¯ä¸€æ ·çš„ã€‚å½“ä½ ä½¿ç”¨ re.split() å‡½æ•°æ—¶å€™ï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯æ­£åˆ™è¡¨è¾¾å¼ä¸­æ˜¯å¦åŒ…å«ä¸€ä¸ªæ‹¬å·æ•è·åˆ†ç»„ã€‚å¦‚æœä½¿ç”¨äº†æ•è·åˆ†ç»„ï¼Œé‚£ä¹ˆè¢«åŒ¹é…çš„æ–‡æœ¬ä¹Ÿå°†å‡ºç°åœ¨ç»“æœåˆ—è¡¨ä¸­ã€‚123&gt;&gt;&gt; fields = re.split(r'(;|,|\s)\s*', line)&gt;&gt;&gt; fields['asdf', ' ', 'fjdk', ';', 'afed', ',', 'fjek', ',', 'asdf', ',', 'foo']ç”¨ Shell é€šé…ç¬¦åŒ¹é…å­—ç¬¦ä¸²ä½¿ç”¨ Unix Shell ä¸­å¸¸ç”¨çš„é€šé…ç¬¦ (æ¯”å¦‚ .py , Dat[0-9].csv ç­‰) å»åŒ¹é…æ–‡æœ¬å­—ç¬¦ä¸²fnmatch æ¨¡å—æä¾›äº†ä¸¤ä¸ªå‡½æ•°â€”â€”fnmatch() å’Œ fnmatchcase() ï¼Œå¯ä»¥ç”¨æ¥å®ç°è¿™æ ·çš„åŒ¹é…ã€‚12345678910&gt;&gt;&gt; from fnmatch import fnmatch, fnmatchcase&gt;&gt;&gt; fnmatch('foo.txt', '*.txt')True&gt;&gt;&gt; fnmatch('foo.txt', '?oo.txt')True&gt;&gt;&gt; fnmatch('Dat45.csv', 'Dat[0-9]*')True&gt;&gt;&gt; names = ['Dat1.csv', 'Dat2.csv', 'config.ini', 'foo.py']&gt;&gt;&gt; [name for name in names if fnmatch(name, 'Dat*.csv')]['Dat1.csv', 'Dat2.csv']fnmatch() å‡½æ•°ä½¿ç”¨åº•å±‚æ“ä½œç³»ç»Ÿçš„å¤§å°å†™æ•æ„Ÿè§„åˆ™ (ä¸åŒçš„ç³»ç»Ÿæ˜¯ä¸ä¸€æ ·çš„) æ¥åŒ¹é…æ¨¡å¼ã€‚123456&gt;&gt;&gt; # On OS X (Mac)&gt;&gt;&gt; fnmatch('foo.txt', '*.TXT')False&gt;&gt;&gt; # On Windows&gt;&gt;&gt; fnmatch('foo.txt', '*.TXT')Trueå¦‚æœä½ å¯¹è¿™ä¸ªåŒºåˆ«å¾ˆåœ¨æ„ï¼Œå¯ä»¥ä½¿ç”¨ fnmatchcase() æ¥ä»£æ›¿ã€‚å®ƒå®Œå…¨ä½¿ç”¨ä½ çš„æ¨¡å¼å¤§å°å†™åŒ¹é…12&gt;&gt;&gt; fnmatchcase('foo.txt', '*.TXT')Falsefnmatch() å‡½æ•°åŒ¹é…èƒ½åŠ›ä»‹äºç®€å•çš„å­—ç¬¦ä¸²æ–¹æ³•å’Œå¼ºå¤§çš„æ­£åˆ™è¡¨è¾¾å¼ä¹‹é—´ã€‚å¦‚æœåœ¨æ•°æ®å¤„ç†æ“ä½œä¸­åªéœ€è¦ç®€å•çš„é€šé…ç¬¦å°±èƒ½å®Œæˆçš„æ—¶å€™ï¼Œè¿™é€šå¸¸æ˜¯ä¸€ä¸ªæ¯”è¾ƒåˆç†çš„æ–¹æ¡ˆã€‚å¦‚æœä½ çš„ä»£ç éœ€è¦åšæ–‡ä»¶åçš„åŒ¹é…ï¼Œæœ€å¥½ä½¿ç”¨ glob æ¨¡å—ã€‚å­—ç¬¦ä¸²åŒ¹é…å’Œæœç´¢åŒ¹é…æˆ–è€…æœç´¢ç‰¹å®šæ¨¡å¼çš„æ–‡æœ¬å¦‚æœä½ æƒ³åŒ¹é…çš„æ˜¯å­—é¢å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆä½ é€šå¸¸åªéœ€è¦è°ƒç”¨åŸºæœ¬å­—ç¬¦ä¸²æ–¹æ³•å°±è¡Œï¼Œæ¯”å¦‚str.find() , str.endswith() , str.startswith() æˆ–è€…ç±»ä¼¼çš„æ–¹æ³•å¯¹äºå¤æ‚çš„åŒ¹é…éœ€è¦ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å’Œ re æ¨¡å—ã€‚ä¸ºäº†è§£é‡Šæ­£åˆ™è¡¨è¾¾å¼çš„åŸºæœ¬åŸç†ï¼Œå‡è®¾ä½ æƒ³åŒ¹é…æ•°å­—æ ¼å¼çš„æ—¥æœŸå­—ç¬¦ä¸²æ¯”å¦‚ 11/27/2012 ï¼Œä½ å¯ä»¥è¿™æ ·åš1234567891011121314151617&gt;&gt;&gt; text1 = '11/27/2012'&gt;&gt;&gt; text2 = 'Nov 27, 2012'&gt;&gt;&gt;&gt;&gt;&gt; import re&gt;&gt;&gt; # Simple matching: \d+ means match one or more digits&gt;&gt;&gt; if re.match(r'\d+/\d+/\d+', text1):... print('yes')... else:... print('no')...yes&gt;&gt;&gt; if re.match(r'\d+/\d+/\d+', text2):... print('yes')... else:... print('no')...noå¦‚æœä½ æƒ³ä½¿ç”¨åŒä¸€ä¸ªæ¨¡å¼å»åšå¤šæ¬¡åŒ¹é…ï¼Œä½ åº”è¯¥å…ˆå°†æ¨¡å¼å­—ç¬¦ä¸²é¢„ç¼–è¯‘ä¸ºæ¨¡å¼å¯¹è±¡ã€‚match() æ€»æ˜¯ä»å­—ç¬¦ä¸²å¼€å§‹å»åŒ¹é…ï¼Œå¦‚æœä½ æƒ³æŸ¥æ‰¾å­—ç¬¦ä¸²ä»»æ„éƒ¨åˆ†çš„æ¨¡å¼å‡ºç°ä½ç½®ï¼Œä½¿ç”¨ findall() æ–¹æ³•å»ä»£æ›¿åœ¨å®šä¹‰æ­£åˆ™å¼çš„æ—¶å€™ï¼Œé€šå¸¸ä¼šåˆ©ç”¨æ‹¬å·å»æ•è·åˆ†ç»„ã€‚1datepat = re.compile(r'(\d+)/(\d+)/(\d+)')æ•è·åˆ†ç»„å¯ä»¥ä½¿å¾—åé¢çš„å¤„ç†æ›´åŠ ç®€å•ï¼Œå› ä¸ºå¯ä»¥åˆ†åˆ«å°†æ¯ä¸ªç»„çš„å†…å®¹æå–å‡ºæ¥ã€‚123456789101112131415161718192021222324252627&gt;&gt;&gt; m = datepat.match('11/27/2012')&gt;&gt;&gt; m&lt;_sre.SRE_Match object at 0x1005d2750&gt;&gt;&gt;&gt; # Extract the contents of each group&gt;&gt;&gt; m.group(0)'11/27/2012'&gt;&gt;&gt; m.group(1)'11'&gt;&gt;&gt; m.group(2)'27'&gt;&gt;&gt; m.group(3)'2012'&gt;&gt;&gt; m.groups()('11', '27', '2012')&gt;&gt;&gt; month, day, year = m.groups()&gt;&gt;&gt;&gt;&gt;&gt; # Find all matches (notice splitting into tuples)&gt;&gt;&gt; text'Today is 11/27/2012. PyCon starts 3/13/2013.'&gt;&gt;&gt; datepat.findall(text)[('11', '27', '2012'), ('3', '13', '2013')]&gt;&gt;&gt; for month, day, year in datepat.findall(text):... print('{}-{}-{}'.format(year, month, day))...2012-11-272013-3-13&gt;&gt;&gt;findall() æ–¹æ³•ä¼šæœç´¢æ–‡æœ¬å¹¶ä»¥åˆ—è¡¨å½¢å¼è¿”å›æ‰€æœ‰çš„åŒ¹é…ã€‚å¦‚æœä½ æƒ³ä»¥è¿­ä»£æ–¹å¼è¿”å›åŒ¹é…ï¼Œå¯ä»¥ä½¿ç”¨ finditer() æ–¹æ³•æ¥ä»£æ›¿æ ¸å¿ƒæ­¥éª¤å°±æ˜¯å…ˆä½¿ç”¨ re.compile() ç¼–è¯‘æ­£åˆ™è¡¨è¾¾å¼å­—ç¬¦ä¸²ï¼Œç„¶åä½¿ç”¨ match() , findall() æˆ–è€… finditer() ç­‰æ–¹æ³•ã€‚å­—ç¬¦ä¸²æœç´¢å’Œæ›¿æ¢å¯¹äºç®€å•çš„å­—é¢æ¨¡å¼ï¼Œç›´æ¥ä½¿ç”¨ str.replace() æ–¹æ³•å³å¯å¯¹äºå¤æ‚çš„æ¨¡å¼ï¼Œè¯·ä½¿ç”¨ re æ¨¡å—ä¸­çš„ sub() å‡½æ•°ã€‚ä¸ºäº†è¯´æ˜è¿™ä¸ªï¼Œå‡è®¾ä½ æƒ³å°†å½¢å¼ä¸º 11/27/2012 çš„æ—¥æœŸå­—ç¬¦ä¸²æ”¹æˆ 2012-11-27 ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š1234&gt;&gt;&gt; text = 'Today is 11/27/2012. PyCon starts 3/13/2013.'&gt;&gt;&gt; import re&gt;&gt;&gt; re.sub(r'(\d+)/(\d+)/(\d+)', r'\3-\1-\2', text)'Today is 2012-11-27. PyCon starts 2013-3-13.'sub() å‡½æ•°ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¢«åŒ¹é…çš„æ¨¡å¼ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ›¿æ¢æ¨¡å¼ã€‚åæ–œæ æ•°å­—æ¯”å¦‚ \3 æŒ‡å‘å‰é¢æ¨¡å¼çš„æ•è·ç»„å·ã€‚å¯¹äºæ›´åŠ å¤æ‚çš„æ›¿æ¢ï¼Œå¯ä»¥ä¼ é€’ä¸€ä¸ªæ›¿æ¢å›è°ƒå‡½æ•°æ¥ä»£æ›¿12345678&gt;&gt;&gt; from calendar import month_abbr&gt;&gt;&gt; def change_date(m):... mon_name = month_abbr[int(m.group(1))]... return '{} {} {}'.format(m.group(2), mon_name, m.group(3))...&gt;&gt;&gt; datepat.sub(change_date, text)'Today is 27 Nov 2012. PyCon starts 13 Mar 2013.'&gt;&gt;&gt;ä¸€ä¸ªæ›¿æ¢å›è°ƒå‡½æ•°çš„å‚æ•°æ˜¯ä¸€ä¸ª match å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯ match() æˆ–è€… find() è¿”å›çš„å¯¹è±¡ã€‚ä½¿ç”¨ group() æ–¹æ³•æ¥æå–ç‰¹å®šçš„åŒ¹é…éƒ¨åˆ†ã€‚å›è°ƒå‡½æ•°æœ€åè¿”å›æ›¿æ¢å­—ç¬¦ä¸²ã€‚å¦‚æœé™¤äº†æ›¿æ¢åçš„ç»“æœå¤–ï¼Œä½ è¿˜æƒ³çŸ¥é“æœ‰å¤šå°‘æ›¿æ¢å‘ç”Ÿäº†ï¼Œå¯ä»¥ä½¿ç”¨ re.subn()æ¥ä»£æ›¿ã€‚å°† Unicode æ–‡æœ¬æ ‡å‡†åŒ–åˆ é™¤å­—ç¬¦ä¸²ä¸­ä¸éœ€è¦çš„å­—ç¬¦å»æ‰æ–‡æœ¬å­—ç¬¦ä¸²å¼€å¤´ï¼Œç»“å°¾æˆ–è€…ä¸­é—´ä¸æƒ³è¦çš„å­—ç¬¦ï¼Œæ¯”å¦‚ç©ºç™½ã€‚strip() æ–¹æ³•èƒ½ç”¨äºåˆ é™¤å¼€å§‹æˆ–ç»“å°¾çš„å­—ç¬¦ã€‚lstrip() å’Œ rstrip() åˆ†åˆ«ä»å·¦å’Œä»å³æ‰§è¡Œåˆ é™¤æ“ä½œã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™äº›æ–¹æ³•ä¼šå»é™¤ç©ºç™½å­—ç¬¦ï¼Œä½†æ˜¯ä½ ä¹Ÿå¯ä»¥æŒ‡å®šå…¶ä»–å­—ç¬¦ã€‚12345678910111213141516&gt;&gt;&gt; # Whitespace stripping&gt;&gt;&gt; s = ' hello world \n'&gt;&gt;&gt; s.strip()'hello world'&gt;&gt;&gt; s.lstrip()'hello world \n'&gt;&gt;&gt; s.rstrip()' hello world'&gt;&gt;&gt;&gt;&gt;&gt; # Character stripping&gt;&gt;&gt; t = '-----hello====='&gt;&gt;&gt; t.lstrip('-')'hello====='&gt;&gt;&gt; t.strip('-=')'hello'&gt;&gt;&gt;è¿™äº› strip() æ–¹æ³•åœ¨è¯»å–å’Œæ¸…ç†æ•°æ®ä»¥å¤‡åç»­å¤„ç†çš„æ—¶å€™æ˜¯ç»å¸¸ä¼šè¢«ç”¨åˆ°çš„ã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥ç”¨å®ƒä»¬æ¥å»æ‰ç©ºæ ¼ï¼Œå¼•å·å’Œå®Œæˆå…¶ä»–ä»»åŠ¡ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯å»é™¤æ“ä½œä¸ä¼šå¯¹å­—ç¬¦ä¸²çš„ä¸­é—´çš„æ–‡æœ¬äº§ç”Ÿä»»ä½•å½±å“ã€‚å¦‚æœä½ æƒ³å¤„ç†ä¸­é—´çš„ç©ºæ ¼ï¼Œé‚£ä¹ˆä½ éœ€è¦æ±‚åŠ©å…¶ä»–æŠ€æœ¯ã€‚æ¯”å¦‚ä½¿ç”¨ replace() æ–¹æ³•æˆ–è€…æ˜¯ç”¨æ­£åˆ™è¡¨è¾¾å¼æ›¿æ¢ã€‚å®¡æŸ¥æ¸…ç†æ–‡æœ¬å­—ç¬¦ä¸²ä¸€äº›æ— èŠçš„å¹¼ç¨šé»‘å®¢åœ¨ä½ çš„ç½‘ç«™é¡µé¢è¡¨å•ä¸­è¾“å…¥æ–‡æœ¬â€pÃ½tÄ¥Ã¶Ã±â€ï¼Œç„¶åä½ æƒ³å°†è¿™äº›å­—ç¬¦æ¸…ç†æ‰ã€‚æ–‡æœ¬æ¸…ç†é—®é¢˜ä¼šæ¶‰åŠåˆ°åŒ…æ‹¬æ–‡æœ¬è§£æä¸æ•°æ®å¤„ç†ç­‰ä¸€ç³»åˆ—é—®é¢˜ã€‚åœ¨éå¸¸ç®€å•çš„æƒ…å½¢ä¸‹ï¼Œä½ å¯èƒ½ä¼šé€‰æ‹©ä½¿ç”¨å­—ç¬¦ä¸²å‡½æ•° (æ¯”å¦‚ str.upper() å’Œ str.lower() ) å°†æ–‡æœ¬è½¬ä¸ºæ ‡å‡†æ ¼å¼ã€‚ä½¿ç”¨ str.replace() æˆ–è€… re.sub() çš„ç®€å•æ›¿æ¢æ“ä½œèƒ½åˆ é™¤æˆ–è€…æ”¹å˜æŒ‡å®šçš„å­—ç¬¦åºåˆ—ã€‚ä½ åŒæ ·è¿˜å¯ä»¥ä½¿ç”¨ 2.9 å°èŠ‚çš„ unicodedata.normalize() å‡½æ•°å°† nicodeæ–‡æœ¬æ ‡å‡†åŒ–ã€‚å­—ç¬¦ä¸²å¯¹é½å¯¹äºåŸºæœ¬çš„å­—ç¬¦ä¸²å¯¹é½æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²çš„ ljust() , rjust() å’Œ center()æ–¹æ³•ã€‚1234567&gt;&gt;&gt;&gt; text = 'Hello World'&gt;&gt;&gt;&gt; text.ljust(20)&gt;'Hello World '&gt;&gt;&gt;&gt; text.rjust(20)&gt;' Hello World'&gt;&gt;&gt;&gt; text.center(20)&gt;' Hello World 'æ‰€æœ‰è¿™äº›æ–¹æ³•éƒ½èƒ½æ¥å—ä¸€ä¸ªå¯é€‰çš„å¡«å……å­—ç¬¦ã€‚1234&gt;&gt;&gt;&gt; text.rjust(20,'=')&gt;'=========Hello World'&gt;&gt;&gt;&gt; text.center(20,'*')&gt;'****Hello World*****'å‡½æ•° format() åŒæ ·å¯ä»¥ç”¨æ¥å¾ˆå®¹æ˜“çš„å¯¹é½å­—ç¬¦ä¸²ã€‚ä½ è¦åšçš„å°±æ˜¯ä½¿ç”¨ &lt;,&gt; æˆ–è€… ^å­—ç¬¦åé¢ç´§è·Ÿä¸€ä¸ªæŒ‡å®šçš„å®½åº¦ã€‚1234567&gt;&gt;&gt;&gt; format(text, '&gt;20')&gt;' Hello World'&gt;&gt;&gt;&gt; format(text, '&lt;20')&gt;'Hello World '&gt;&gt;&gt;&gt; format(text, '^20')&gt;' Hello World '&gt;&gt;&gt;&gt;å¦‚æœä½ æƒ³æŒ‡å®šä¸€ä¸ªéç©ºæ ¼çš„å¡«å……å­—ç¬¦ï¼Œå°†å®ƒå†™åˆ°å¯¹é½å­—ç¬¦çš„å‰é¢å³å¯1234&gt;&gt;&gt;&gt; format(text, '=&gt;20s')&gt;'=========Hello World'&gt;&gt;&gt;&gt; format(text, '*^20s')&gt;'****Hello World*****'å½“æ ¼å¼åŒ–å¤šä¸ªå€¼çš„æ—¶å€™ï¼Œè¿™äº›æ ¼å¼ä»£ç ä¹Ÿå¯ä»¥è¢«ç”¨åœ¨ format() æ–¹æ³•ä¸­ã€‚12&gt;&gt;&gt;&gt; '{:&gt;10s} {:&gt;10s}'.format('Hello', 'World')&gt;' Hello World'format() å‡½æ•°çš„ä¸€ä¸ªå¥½å¤„æ˜¯å®ƒä¸ä»…é€‚ç”¨äºå­—ç¬¦ä¸²ã€‚å®ƒå¯ä»¥ç”¨æ¥æ ¼å¼åŒ–ä»»ä½•å€¼ï¼Œä½¿å¾—å®ƒéå¸¸çš„é€šç”¨ã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥ç”¨å®ƒæ¥æ ¼å¼åŒ–æ•°å­—ï¼š12345&gt;&gt;&gt;&gt; x = 1.2345&gt;&gt;&gt;&gt; format(x, '&gt;10')&gt;' 1.2345'&gt;&gt;&gt;&gt; format(x, '^10.2f')&gt;' 1.23 'åœ¨æ–°ç‰ˆæœ¬ä»£ç ä¸­ï¼Œä½ åº”è¯¥ä¼˜å…ˆé€‰æ‹© format() å‡½æ•°æˆ–è€…æ–¹æ³•ã€‚format() è¦æ¯”% æ“ä½œç¬¦çš„åŠŸèƒ½æ›´ä¸ºå¼ºå¤§ã€‚å¹¶ä¸” format() ä¹Ÿæ¯”ä½¿ç”¨ ljust() , rjust() æˆ– center() æ–¹æ³•æ›´é€šç”¨ï¼Œå› ä¸ºå®ƒå¯ä»¥ç”¨æ¥æ ¼å¼åŒ–ä»»æ„å¯¹è±¡ï¼Œè€Œä¸ä»…ä»…æ˜¯å­—ç¬¦ä¸²ã€‚ä»¥æŒ‡å®šåˆ—å®½æ ¼å¼åŒ–å­—ç¬¦ä¸²ä½¿ç”¨ textwrap æ¨¡å—æ¥æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„è¾“å‡ºã€‚æ¯”å¦‚ï¼Œå‡å¦‚ä½ æœ‰ä¸‹åˆ—çš„é•¿å­—ç¬¦ä¸²ï¼š123s = &quot;Look into my eyes, look into my eyes, the eyes, the eyes, \the eyes, not around the eyes, don't look around the eyes, \look into my eyes, you're under.&quot;ä¸‹é¢æ¼”ç¤ºä½¿ç”¨ textwrap æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„å¤šç§æ–¹å¼ï¼š123456789101112131415161718192021&gt;&gt;&gt; import textwrap&gt;&gt;&gt; print(textwrap.fill(s, 70))Look into my eyes, look into my eyes, the eyes, the eyes, the eyes,not around the eyes, don't look around the eyes, look into my eyes,you're under.&gt;&gt;&gt; print(textwrap.fill(s, 40))Look into my eyes, look into my eyes,the eyes, the eyes, the eyes, not aroundthe eyes, don't look around the eyes,look into my eyes, you're under.&gt;&gt;&gt; print(textwrap.fill(s, 40, initial_indent=' '))Look into my eyes, look into myeyes, the eyes, the eyes, the eyes, notaround the eyes, don't look around theeyes, look into my eyes, you're under.&gt;&gt;&gt; print(textwrap.fill(s, 40, subsequent_indent=' '))Look into my eyes, look into my eyes,the eyes, the eyes, the eyes, notaround the eyes, don't look aroundthe eyes, look into my eyes, you'reunder.textwrap æ¨¡å—å¯¹äºå­—ç¬¦ä¸²æ‰“å°æ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œç‰¹åˆ«æ˜¯å½“ä½ å¸Œæœ›è¾“å‡ºè‡ªåŠ¨åŒ¹é…ç»ˆç«¯å¤§å°çš„æ—¶å€™ã€‚ä½ å¯ä»¥ä½¿ç”¨ os.get_terminal_size() æ–¹æ³•æ¥è·å–ç»ˆç«¯çš„å¤§å°å°ºå¯¸ã€‚123&gt;&gt;&gt; import os&gt;&gt;&gt; os.get_terminal_size().columns80fill() æ–¹æ³•æ¥å—ä¸€äº›å…¶ä»–å¯é€‰å‚æ•°æ¥æ§åˆ¶ tabï¼Œè¯­å¥ç»“å°¾ç­‰ã€‚åœ¨å­—ç¬¦ä¸²ä¸­å¤„ç† html å’Œ xmlå­—ç¬¦ä¸²ä»¤ç‰Œè§£æè¿­ä»£å™¨ä¸ç”Ÿæˆå™¨é¡ºåºè¿­ä»£åˆå¹¶åçš„æ’åºè¿­ä»£å¯¹è±¡æœ‰ä¸€ç³»åˆ—æ’åºåºåˆ—ï¼Œæƒ³å°†å®ƒä»¬åˆå¹¶åå¾—åˆ°ä¸€ä¸ªæ’åºåºåˆ—å¹¶åœ¨ä¸Šé¢è¿­ä»£éå†heapq.merge() å‡½æ•°å¯ä»¥å¸®ä½ è§£å†³è¿™ä¸ªé—®é¢˜1234567891011121314&gt;&gt;&gt; import heapq&gt;&gt;&gt; a = [1, 4, 7, 10]&gt;&gt;&gt; b = [2, 5, 6, 11]&gt;&gt;&gt; for c in heapq.merge(a, b):... print(c)...1245671011heapq.merge å¯è¿­ä»£ç‰¹æ€§æ„å‘³ç€å®ƒä¸ä¼šç«‹é©¬è¯»å–æ‰€æœ‰åºåˆ—ã€‚è¿™å°±æ„å‘³ç€ä½ å¯ä»¥åœ¨éå¸¸é•¿çš„åºåˆ—ä¸­ä½¿ç”¨å®ƒï¼Œè€Œä¸ä¼šæœ‰å¤ªå¤§çš„å¼€é”€ã€‚è¦å¼ºè°ƒçš„æ˜¯ heapq.merge() éœ€è¦æ‰€æœ‰è¾“å…¥åºåˆ—å¿…é¡»æ˜¯æ’è¿‡åºçš„ã€‚ç‰¹åˆ«çš„ï¼Œå®ƒå¹¶ä¸ä¼šé¢„å…ˆè¯»å–æ‰€æœ‰æ•°æ®åˆ°å †æ ˆä¸­æˆ–è€…é¢„å…ˆæ’åºï¼Œä¹Ÿä¸ä¼šå¯¹è¾“å…¥åšä»»ä½•çš„æ’åºæ£€æµ‹ã€‚å®ƒä»…ä»…æ˜¯æ£€æŸ¥æ‰€æœ‰åºåˆ—çš„å¼€å§‹éƒ¨åˆ†å¹¶è¿”å›æœ€å°çš„é‚£ä¸ªï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸€ç›´ä¼šæŒç»­ç›´åˆ°æ‰€æœ‰è¾“å…¥åºåˆ—ä¸­çš„å…ƒç´ éƒ½è¢«éå†å®Œã€‚æ–‡ä»¶ä¸ IOæ•°æ®ç¼–ç å’Œå¤„ç†å‡½æ•°ç»™å‡½æ•°å‚æ•°å¢åŠ å…ƒä¿¡æ¯å†™å¥½äº†ä¸€ä¸ªå‡½æ•°ï¼Œç„¶åæƒ³ä¸ºè¿™ä¸ªå‡½æ•°çš„å‚æ•°å¢åŠ ä¸€äº›é¢å¤–çš„ä¿¡æ¯ï¼Œè¿™æ ·çš„è¯å…¶ä»–ä½¿ç”¨è€…å°±èƒ½æ¸…æ¥šçš„çŸ¥é“è¿™ä¸ªå‡½æ•°åº”è¯¥æ€ä¹ˆä½¿ç”¨ã€‚ä½¿ç”¨å‡½æ•°å‚æ•°æ³¨è§£æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„åŠæ³•ï¼Œå®ƒèƒ½æç¤ºç¨‹åºå‘˜åº”è¯¥æ€æ ·æ­£ç¡®ä½¿ç”¨è¿™ä¸ªå‡½æ•°ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢æœ‰ä¸€ä¸ªè¢«æ³¨è§£äº†çš„å‡½æ•°ï¼š12def add(x:int, y:int) -&gt; int:return x + ypython è§£é‡Šå™¨ä¸ä¼šå¯¹è¿™äº›æ³¨è§£æ·»åŠ ä»»ä½•çš„è¯­ä¹‰ã€‚å®ƒä»¬ä¸ä¼šè¢«ç±»å‹æ£€æŸ¥ï¼Œè¿è¡Œæ—¶è·Ÿæ²¡æœ‰åŠ æ³¨è§£ä¹‹å‰çš„æ•ˆæœä¹Ÿæ²¡æœ‰ä»»ä½•å·®è·ã€‚å°½ç®¡ä½ å¯ä»¥ä½¿ç”¨ä»»æ„ç±»å‹çš„å¯¹è±¡ç»™å‡½æ•°æ·»åŠ æ³¨è§£ (ä¾‹å¦‚æ•°å­—ï¼Œå­—ç¬¦ä¸²ï¼Œå¯¹è±¡å®ä¾‹ç­‰ç­‰)ï¼Œä¸è¿‡é€šå¸¸æ¥è®²ä½¿ç”¨ç±»æˆ–è€…å­—ç¬¦ä¸²ä¼šæ¯”è¾ƒå¥½ç‚¹ã€‚å‡½æ•°æ³¨è§£åªå­˜å‚¨åœ¨å‡½æ•°çš„ __annotations__ å±æ€§ä¸­12&gt;&gt;&gt; add.__annotations__{'y': &lt;class 'int'&gt;, 'return': &lt;class 'int'&gt;, 'x': &lt;class 'int'&gt;}å°½ç®¡æ³¨è§£çš„ä½¿ç”¨æ–¹æ³•å¯èƒ½æœ‰å¾ˆå¤šç§ï¼Œä½†æ˜¯å®ƒä»¬çš„ä¸»è¦ç”¨é€”è¿˜æ˜¯æ–‡æ¡£ã€‚å› ä¸º pythonå¹¶æ²¡æœ‰ç±»å‹å£°æ˜ï¼Œé€šå¸¸æ¥è®²ä»…ä»…é€šè¿‡é˜…è¯»æºç å¾ˆéš¾çŸ¥é“åº”è¯¥ä¼ é€’ä»€ä¹ˆæ ·çš„å‚æ•°ç»™è¿™ä¸ªå‡½æ•°ã€‚è¿™æ—¶å€™ä½¿ç”¨æ³¨è§£å°±èƒ½ç»™ç¨‹åºå‘˜æ›´å¤šçš„æç¤ºï¼Œè®©ä»–ä»¬å¯ä»¥æ­£ç¡®çš„ä½¿ç”¨å‡½æ•°ã€‚psï¼šè¿™é‡Œå¯ä»¥ç»“åˆå…ƒç±»ï¼Œä¸ºå‚æ•°åšç±»å‹æ£€æµ‹ï¼ˆnarutohycä¸ªäººæƒ³æ³•ï¼Œè¿˜æœªå®ç°ï¼‰å°†å•æ–¹æ³•çš„ç±»è½¬æ¢ä¸ºå‡½æ•°ä½ æœ‰ä¸€ä¸ªé™¤ __init__() æ–¹æ³•å¤–åªå®šä¹‰äº†ä¸€ä¸ªæ–¹æ³•çš„ç±»ã€‚ä¸ºäº†ç®€åŒ–ä»£ç ï¼Œä½ æƒ³å°†å®ƒè½¬æ¢æˆä¸€ä¸ªå‡½æ•°123456def urltemplate(template):    def opener(**kwargs):    return urlopen(template.format_map(kwargs))    return opener# Example useyahoo = urltemplate('http://finance.yahoo.com/d/quotes.csv?s={names}&amp;f=,â†’ {fields}')å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œä½ æ‹¥æœ‰ä¸€ä¸ªå•æ–¹æ³•ç±»çš„åŸå› æ˜¯éœ€è¦å­˜å‚¨æŸäº›é¢å¤–çš„çŠ¶æ€æ¥ç»™æ–¹æ³•ä½¿ç”¨ã€‚å¸¦é¢å¤–çŠ¶æ€ä¿¡æ¯çš„å›è°ƒå‡½æ•°ä½ çš„ä»£ç ä¸­éœ€è¦ä¾èµ–åˆ°å›è°ƒå‡½æ•°çš„ä½¿ç”¨ (æ¯”å¦‚äº‹ä»¶å¤„ç†å™¨ã€ç­‰å¾…åå°ä»»åŠ¡å®Œæˆåçš„å›è°ƒç­‰)ï¼Œå¹¶ä¸”ä½ è¿˜éœ€è¦è®©å›è°ƒå‡½æ•°æ‹¥æœ‰é¢å¤–çš„çŠ¶æ€å€¼ï¼Œä»¥ä¾¿åœ¨å®ƒçš„å†…éƒ¨ä½¿ç”¨åˆ°ã€‚å†…è”å›è°ƒå‡½æ•°å½“ä½ ç¼–å†™ä½¿ç”¨å›è°ƒå‡½æ•°çš„ä»£ç çš„æ—¶å€™ï¼Œæ‹…å¿ƒå¾ˆå¤šå°å‡½æ•°çš„æ‰©å¼ å¯èƒ½ä¼šå¼„ä¹±ç¨‹åºæ§åˆ¶æµã€‚ä½ å¸Œæœ›æ‰¾åˆ°æŸä¸ªæ–¹æ³•æ¥è®©ä»£ç çœ‹ä¸Šå»æ›´åƒæ˜¯ä¸€ä¸ªæ™®é€šçš„æ‰§è¡Œåºåˆ—ã€‚é€šè¿‡ä½¿ç”¨ç”Ÿæˆå™¨å’Œåç¨‹å¯ä»¥ä½¿å¾—å›è°ƒå‡½æ•°å†…è”åœ¨æŸä¸ªå‡½æ•°ä¸­ã€‚ä¸ºäº†æ¼”ç¤ºè¯´æ˜ï¼Œå‡è®¾ä½ æœ‰å¦‚ä¸‹æ‰€ç¤ºçš„ä¸€ä¸ªæ‰§è¡ŒæŸç§è®¡ç®—ä»»åŠ¡ç„¶åè°ƒç”¨ä¸€ä¸ªå›è°ƒå‡½æ•°çš„å‡½æ•°12345def apply_async(func, args, *, callback):    # Compute the result    result = func(*args)    # Invoke the callback with the result    callback(result)æ¥ä¸‹æ¥è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ä¸‹é¢çš„ä»£ç ï¼Œå®ƒåŒ…å«äº†ä¸€ä¸ª Async ç±»å’Œä¸€ä¸ª inlined_asyncè£…é¥°å™¨ï¼š12345678910111213141516171819202122232425from queue import Queuefrom functools import wrapsclass Async:    def __init__(self, func, args):        self.func = func        self.args = argsdef inlined_async(func):    @wraps(func)    def wrapper(*args):        f = func(*args)        result_queue = Queue()        result_queue.put(None)        while True:            result = result_queue.get()            try:                a = f.send(result)                apply_async(a.func, a.args, callback=result_queue.put)            except StopIteration:                break    return wrapperè¿™ä¸¤ä¸ªä»£ç ç‰‡æ®µå…è®¸ä½ ä½¿ç”¨ yield è¯­å¥å†…è”å›è°ƒæ­¥éª¤ã€‚æ¯”å¦‚ï¼š123456789101112def add(x, y):    return x + y@inlined_asyncdef test():    r = yield Async(add, (2, 3))    print(r)    r = yield Async(add, ('hello', 'world'))    print(r)    for n in range(10):        r = yield Async(add, (n, n))        print(r)    print('Goodbye')å¦‚æœä½ è°ƒç”¨ test() ï¼Œä½ ä¼šå¾—åˆ°ç±»ä¼¼å¦‚ä¸‹çš„è¾“å‡ºï¼š123456789101112135helloworld024681012141618Goodbyeä½ ä¼šå‘ç°ï¼Œé™¤äº†é‚£ä¸ªç‰¹åˆ«çš„è£…é¥°å™¨å’Œ yield è¯­å¥å¤–ï¼Œå…¶ä»–åœ°æ–¹å¹¶æ²¡æœ‰å‡ºç°ä»»ä½•çš„å›è°ƒå‡½æ•° (å…¶å®æ˜¯åœ¨åå°å®šä¹‰çš„)ã€‚æœ¬å°èŠ‚ä¼šå®å®åœ¨åœ¨çš„æµ‹è¯•ä½ å…³äºå›è°ƒå‡½æ•°ã€ç”Ÿæˆå™¨å’Œæ§åˆ¶æµçš„çŸ¥è¯†ã€‚é¦–å…ˆï¼Œåœ¨éœ€è¦ä½¿ç”¨åˆ°å›è°ƒçš„ä»£ç ä¸­ï¼Œå…³é”®ç‚¹åœ¨äºå½“å‰è®¡ç®—å·¥ä½œä¼šæŒ‚èµ·å¹¶åœ¨å°†æ¥çš„æŸä¸ªæ—¶å€™é‡å¯ (æ¯”å¦‚å¼‚æ­¥æ‰§è¡Œ)ã€‚å½“è®¡ç®—é‡å¯æ—¶ï¼Œå›è°ƒå‡½æ•°è¢«è°ƒç”¨æ¥ç»§ç»­å¤„ç†ç»“æœã€‚applyasync() å‡½æ•°æ¼”ç¤ºäº†æ‰§è¡Œå›è°ƒçš„å®é™…é€»è¾‘ï¼Œå°½ç®¡å®é™…æƒ…å†µä¸­å®ƒå¯èƒ½ä¼šæ›´åŠ å¤æ‚(åŒ…æ‹¬çº¿ç¨‹ã€è¿›ç¨‹ã€äº‹ä»¶å¤„ç†å™¨ç­‰ç­‰)ã€‚è®¡ç®—çš„æš‚åœä¸é‡å¯æ€è·¯è·Ÿç”Ÿæˆå™¨å‡½æ•°çš„æ‰§è¡Œæ¨¡å‹ä¸è°‹è€Œåˆã€‚å…·ä½“æ¥è®²ï¼Œyield æ“ä½œä¼šä½¿ä¸€ä¸ªç”Ÿæˆå™¨å‡½æ•°äº§ç”Ÿä¸€ä¸ªå€¼å¹¶æš‚åœã€‚æ¥ä¸‹æ¥è°ƒç”¨ç”Ÿæˆå™¨çš„ \_next__() æˆ– send()æ–¹æ³•åˆä¼šè®©å®ƒä»æš‚åœå¤„ç»§ç»­æ‰§è¡Œã€‚æ ¹æ®è¿™ä¸ªæ€è·¯ï¼Œè¿™ä¸€å°èŠ‚çš„æ ¸å¿ƒå°±åœ¨ inline_async() è£…é¥°å™¨å‡½æ•°ä¸­äº†ã€‚å…³é”®ç‚¹å°±æ˜¯ï¼Œè£…é¥°å™¨ä¼šé€æ­¥éå†ç”Ÿæˆå™¨å‡½æ•°çš„æ‰€æœ‰ yield è¯­å¥ï¼Œæ¯ä¸€æ¬¡ä¸€ä¸ªã€‚ä¸ºäº†è¿™æ ·åšï¼Œåˆšå¼€å§‹çš„æ—¶å€™åˆ›å»ºäº†ä¸€ä¸ª result é˜Ÿåˆ—å¹¶å‘é‡Œé¢æ”¾å…¥ä¸€ä¸ª None å€¼ã€‚ç„¶åå¼€å§‹ä¸€ä¸ªå¾ªç¯æ“ä½œï¼Œä»é˜Ÿåˆ—ä¸­å–å‡ºç»“æœå€¼å¹¶å‘é€ç»™ç”Ÿæˆå™¨ï¼Œå®ƒä¼šæŒç»­åˆ°ä¸‹ä¸€ä¸ª yield è¯­å¥ï¼Œåœ¨è¿™é‡Œä¸€ä¸ª Async çš„å®ä¾‹è¢«æ¥å—åˆ°ã€‚ç„¶åå¾ªç¯å¼€å§‹æ£€æŸ¥å‡½æ•°å’Œå‚æ•°ï¼Œå¹¶å¼€å§‹è¿›è¡Œå¼‚æ­¥è®¡ç®—apply_async() ã€‚ç„¶è€Œï¼Œè¿™ä¸ªè®¡ç®—æœ‰ä¸ªæœ€è¯¡å¼‚éƒ¨åˆ†æ˜¯å®ƒå¹¶æ²¡æœ‰ä½¿ç”¨ä¸€ä¸ªæ™®é€šçš„å›è°ƒå‡½æ•°ï¼Œè€Œæ˜¯ç”¨é˜Ÿåˆ—çš„ put() æ–¹æ³•æ¥å›è°ƒã€‚è¿™æ—¶å€™ï¼Œæ˜¯æ—¶å€™è¯¦ç»†è§£é‡Šä¸‹åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆäº†ã€‚ä¸»å¾ªç¯ç«‹å³è¿”å›é¡¶éƒ¨å¹¶åœ¨é˜Ÿåˆ—ä¸Šæ‰§è¡Œ get() æ“ä½œã€‚å¦‚æœæ•°æ®å­˜åœ¨ï¼Œå®ƒä¸€å®šæ˜¯ put() å›è°ƒå­˜æ”¾çš„ç»“æœã€‚å¦‚æœæ²¡æœ‰æ•°æ®ï¼Œé‚£ä¹ˆå…ˆæš‚åœæ“ä½œå¹¶ç­‰å¾…ç»“æœçš„åˆ°æ¥ã€‚è¿™ä¸ªå…·ä½“æ€æ ·å®ç°æ˜¯ç”± apply_async() å‡½æ•°æ¥å†³å®šçš„ã€‚å¦‚æœä½ ä¸ç›¸ä¿¡ä¼šæœ‰è¿™ä¹ˆç¥å¥‡çš„äº‹æƒ…ï¼Œä½ å¯ä»¥ä½¿ç”¨ multiprocessing åº“æ¥è¯•ä¸€ä¸‹ï¼Œåœ¨å•ç‹¬çš„è¿›ç¨‹ä¸­æ‰§è¡Œå¼‚æ­¥è®¡ç®—æ“ä½œï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š123456if __name__ == '__main__':    import multiprocessing    pool = multiprocessing.Pool()    apply_async = pool.apply_async    # Run the test function    test()å®é™…ä¸Šä½ ä¼šå‘ç°è¿™ä¸ªçœŸçš„å°±æ˜¯è¿™æ ·çš„ï¼Œä½†æ˜¯è¦è§£é‡Šæ¸…æ¥šå…·ä½“çš„æ§åˆ¶æµå¾—éœ€è¦ç‚¹æ—¶é—´äº†ã€‚å°†å¤æ‚çš„æ§åˆ¶æµéšè—åˆ°ç”Ÿæˆå™¨å‡½æ•°èƒŒåçš„ä¾‹å­åœ¨æ ‡å‡†åº“å’Œç¬¬ä¸‰æ–¹åŒ…ä¸­éƒ½èƒ½çœ‹åˆ°ã€‚æ¯”å¦‚ï¼Œåœ¨ contextlib ä¸­çš„ @contextmanager è£…é¥°å™¨ä½¿ç”¨äº†ä¸€ä¸ªä»¤äººè´¹è§£çš„æŠ€å·§ï¼Œé€šè¿‡ä¸€ä¸ª yield è¯­å¥å°†è¿›å…¥å’Œç¦»å¼€ä¸Šä¸‹æ–‡ç®¡ç†å™¨ç²˜åˆåœ¨ä¸€èµ·ã€‚å¦å¤–éå¸¸æµè¡Œçš„ Twisted åŒ…ä¸­ä¹ŸåŒ…å«äº†éå¸¸ç±»ä¼¼çš„å†…è”å›è°ƒã€‚è®¿é—®é—­åŒ…ä¸­å®šä¹‰çš„å˜é‡ç±»ä¸å¯¹è±¡å…ƒç¼–ç¨‹pycharmåŸºç¡€è®¾ç½®å¦‚æœå·²ç»æœ‰setting.zipå¯ä»¥ç›´æ¥å¯¼å…¥å³å¯./res/5. pythonåŸºç¡€çŸ¥è¯†/settings.zippycharmæ¿€æ´»idea PyCharm å…¨å®¶æ¡¶æ¿€æ´»ç  - lookdivç§˜é’¥: lookdiv.comgité…ç½®é…ç½®gitè·¯å¾„Setting-&gt;Version Control-&gt;gitPath to Git executable: S:\Git\cmd\git.exepythonæ¨¡æ¿è®¾ç½®æ‰“å¼€Setting-&gt;Editor-&gt;File and Code Templates-&gt;Files-&gt;Python Scripté…ç½®å¦‚ä¸‹ä¿¡æ¯(ä¿®æ”¹ä½œè€…åï¼Œå…¶ä»–æ— éœ€ä¿®æ”¹)ï¼š123456789101112#!/usr/bin/env Python# -- coding: utf-8 --&quot;&quot;&quot;@version: v0.1@author: narutohyc@file: ${NAME}.py@Description: @time: ${DATE} ${TIME}&quot;&quot;&quot;å¿«æ·é”®è®¾ç½®æ“ä½œå¿«æ·é”®è¡¥å……è¯´æ˜Reformat CodeCtrl+Alt+Fæ ¼å¼åŒ–ä»£ç CloseCtrl+Rå…³é—­å½“å‰pyæ–‡ä»¶çª—å£Split VerticallyCtrl+Shift+å‘å³ç®­å¤´å‚ç›´åˆ‡åˆ†çª—å£Split HorizontallyCtrl+Shift+å‘å·¦ç®­å¤´æ°´å¹³åˆ‡åˆ†çª—å£Git PullCtrl+Shift+Lgit pullGit commit FileCtrl+Kgit commitGit Commit and pushCtrl+Shift+Kgit pushChange font sizectrl+N-&gt;Actions-&gt;Change font size with Ctrl+Mouse WheelShow in ExplorerCrtl+Shift+Sé¡¹ç›®ä¾èµ–å¯¼å‡ºä¾èµ–å®‰è£…pipreqs1pip install pipreqså¯¼å‡ºä¾èµ–, å¼ºåˆ¶è¦†ç›–åŸå…ˆçš„ä¾èµ–1pipreqs ./  --encoding=utf8 --forceå®‰è£…ä¾èµ–å®‰è£…ä¾èµ–åº“1pip install -r requirements.txtç¦»çº¿å®‰è£…å•ä¸ªä¸‹è½½1pip download package_name -d &quot;ä¸‹è½½çš„è·¯å¾„(windowsä¸‹åŒå¼•å·æ¥è¡¨ç¤ºæ–‡ä»¶å¤¹)&quot;æ‰¹é‡ä¸‹è½½1pip download -d /tmp/packages -r requirements.txtæ‰¹é‡å®‰è£…å·²ç»å¯¼å‡ºçš„åŒ…å…¶ä¸­ â€”no-index ä»£è¡¨å¿½è§†pip å¿½è§†é»˜è®¤çš„ä¾èµ–åŒ…ç´¢å¼•â€”find-links= ä»£è¡¨ä»ä½ æŒ‡å®šçš„ç›®å½•å¯»ä¸‹æ‰¾ç¦»çº¿åŒ… 1pip install --no-index --find-links=/tmp/packages -r requirements.txtNginxNginxå¿«é€Ÿå…¥é—¨ä»€ä¹ˆæ˜¯Nginxï¼ŸNginx (engine x) æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„HTTPå’Œåå‘ä»£ç†webæœåŠ¡å™¨ï¼ŒåŒæ—¶ä¹Ÿæä¾›äº†IMAP/POP3/SMTPæœåŠ¡ã€‚Nginxæ˜¯ç”±ä¼Šæˆˆå°”Â·èµ›ç´¢è€¶å¤«ä¸ºä¿„ç½—æ–¯è®¿é—®é‡ç¬¬äºŒçš„Rambler.ruç«™ç‚¹ï¼ˆä¿„æ–‡ï¼šĞ Ğ°Ğ¼Ğ±Ğ»ĞµÑ€ï¼‰å¼€å‘çš„ï¼Œç¬¬ä¸€ä¸ªå…¬å¼€ç‰ˆæœ¬0.1.0å‘å¸ƒäº2004å¹´10æœˆ4æ—¥ã€‚2011å¹´6æœˆ1æ—¥ï¼Œnginx 1.0.4å‘å¸ƒã€‚å…¶ç‰¹ç‚¹æ˜¯å æœ‰å†…å­˜å°‘ï¼Œå¹¶å‘èƒ½åŠ›å¼ºï¼Œäº‹å®ä¸Šnginxçš„å¹¶å‘èƒ½åŠ›åœ¨åŒç±»å‹çš„ç½‘é¡µæœåŠ¡å™¨ä¸­è¡¨ç°è¾ƒå¥½ï¼Œä¸­å›½å¤§é™†ä½¿ç”¨nginxç½‘ç«™ç”¨æˆ·æœ‰ï¼šç™¾åº¦ã€äº¬ä¸œã€æ–°æµªã€ç½‘æ˜“ã€è…¾è®¯ã€æ·˜å®ç­‰ã€‚åœ¨å…¨çƒæ´»è·ƒçš„ç½‘ç«™ä¸­æœ‰12.18%çš„ä½¿ç”¨æ¯”ç‡ï¼Œå¤§çº¦ä¸º2220ä¸‡ä¸ªç½‘ç«™ã€‚Nginx æ˜¯ä¸€ä¸ªå®‰è£…éå¸¸çš„ç®€å•ã€é…ç½®æ–‡ä»¶éå¸¸ç®€æ´ï¼ˆè¿˜èƒ½å¤Ÿæ”¯æŒperlè¯­æ³•ï¼‰ã€Bugéå¸¸å°‘çš„æœåŠ¡ã€‚Nginx å¯åŠ¨ç‰¹åˆ«å®¹æ˜“ï¼Œå¹¶ä¸”å‡ ä¹å¯ä»¥åšåˆ°7*24ä¸é—´æ–­è¿è¡Œï¼Œå³ä½¿è¿è¡Œæ•°ä¸ªæœˆä¹Ÿä¸éœ€è¦é‡æ–°å¯åŠ¨ã€‚ä½ è¿˜èƒ½å¤Ÿä¸é—´æ–­æœåŠ¡çš„æƒ…å†µä¸‹è¿›è¡Œè½¯ä»¶ç‰ˆæœ¬çš„å‡çº§ã€‚Nginxä»£ç å®Œå…¨ç”¨Cè¯­è¨€ä»å¤´å†™æˆã€‚å®˜æ–¹æ•°æ®æµ‹è¯•è¡¨æ˜èƒ½å¤Ÿæ”¯æŒé«˜è¾¾ 50,000 ä¸ªå¹¶å‘è¿æ¥æ•°çš„å“åº”ã€‚Nginxä½œç”¨Httpä»£ç†Httpä»£ç†ï¼Œåå‘ä»£ç†ï¼šä½œä¸ºwebæœåŠ¡å™¨æœ€å¸¸ç”¨çš„åŠŸèƒ½ä¹‹ä¸€ï¼Œå°¤å…¶æ˜¯åå‘ä»£ç†ã€‚æ­£å‘ä»£ç†åå‘ä»£ç†è´Ÿè½½å‡è¡¡Nginxæä¾›çš„è´Ÿè½½å‡è¡¡ç­–ç•¥æœ‰2ç§ï¼šå†…ç½®ç­–ç•¥å’Œæ‰©å±•ç­–ç•¥ã€‚å†…ç½®ç­–ç•¥ä¸ºè½®è¯¢ï¼ŒåŠ æƒè½®è¯¢ï¼ŒIp hashã€‚æ‰©å±•ç­–ç•¥ï¼Œå°±å¤©é©¬è¡Œç©ºï¼Œåªæœ‰ä½ æƒ³ä¸åˆ°çš„æ²¡æœ‰ä»–åšä¸åˆ°çš„ã€‚è½®è¯¢åŠ æƒè½®è¯¢iphashå¯¹å®¢æˆ·ç«¯è¯·æ±‚çš„ipè¿›è¡Œhashæ“ä½œï¼Œç„¶åæ ¹æ®hashç»“æœå°†åŒä¸€ä¸ªå®¢æˆ·ç«¯ipçš„è¯·æ±‚åˆ†å‘ç»™åŒä¸€å°æœåŠ¡å™¨è¿›è¡Œå¤„ç†ï¼Œå¯ä»¥è§£å†³sessionä¸å…±äº«çš„é—®é¢˜ã€‚fairæŒ‰åç«¯æœåŠ¡å™¨çš„å“åº”æ—¶é—´æ¥åˆ†é…è¯·æ±‚ï¼Œå“åº”æ—¶é—´çŸ­çš„ä¼˜å…ˆåˆ†é…ã€‚url_hashæŒ‰è®¿é—®urlçš„hashç»“æœæ¥åˆ†é…è¯·æ±‚ï¼Œä½¿æ¯ä¸ªurlå®šå‘åˆ°åŒä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œåç«¯æœåŠ¡å™¨ä¸ºç¼“å­˜æ—¶æ¯”è¾ƒæœ‰æ•ˆã€‚åŠ¨é™åˆ†ç¦»åŠ¨é™åˆ†ç¦»ï¼Œåœ¨æˆ‘ä»¬çš„è½¯ä»¶å¼€å‘ä¸­ï¼Œæœ‰äº›è¯·æ±‚æ˜¯éœ€è¦åå°å¤„ç†çš„ï¼Œæœ‰äº›è¯·æ±‚æ˜¯ä¸éœ€è¦ç»è¿‡åå°å¤„ç†çš„ï¼ˆå¦‚ï¼šcssã€htmlã€jpgã€jsç­‰ç­‰æ–‡ä»¶ï¼‰ï¼Œè¿™äº›ä¸éœ€è¦ç»è¿‡åå°å¤„ç†çš„æ–‡ä»¶ç§°ä¸ºé™æ€æ–‡ä»¶ã€‚è®©åŠ¨æ€ç½‘ç«™é‡Œçš„åŠ¨æ€ç½‘é¡µæ ¹æ®ä¸€å®šè§„åˆ™æŠŠä¸å˜çš„èµ„æºå’Œç»å¸¸å˜çš„èµ„æºåŒºåˆ†å¼€æ¥ï¼ŒåŠ¨é™èµ„æºåšå¥½äº†æ‹†åˆ†ä»¥åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®é™æ€èµ„æºçš„ç‰¹ç‚¹å°†å…¶åšç¼“å­˜æ“ä½œã€‚æé«˜èµ„æºå“åº”çš„é€Ÿåº¦ã€‚åŸºæœ¬ä½¿ç”¨é…ç½®ç›‘å¬nginxçš„é…ç½®æ–‡ä»¶æ˜¯confç›®å½•ä¸‹çš„nginx.confï¼Œé»˜è®¤é…ç½®çš„nginxç›‘å¬çš„ç«¯å£ä¸º80ï¼Œå¦‚æœ80ç«¯å£è¢«å ç”¨å¯ä»¥ä¿®æ”¹ä¸ºæœªè¢«å ç”¨çš„ç«¯å£å³å¯ã€‚å½“æˆ‘ä»¬ä¿®æ”¹äº†nginxçš„é…ç½®æ–‡ä»¶nginx.conf æ—¶ï¼Œä¸éœ€è¦å…³é—­nginxåé‡æ–°å¯åŠ¨nginxï¼Œåªéœ€è¦æ‰§è¡Œå‘½ä»¤ nginx -s reload å³å¯è®©æ”¹åŠ¨ç”Ÿæ•ˆå…³é—­nginxå¦‚æœä½¿ç”¨cmdå‘½ä»¤çª—å£å¯åŠ¨nginxï¼Œ å…³é—­cmdçª—å£æ˜¯ä¸èƒ½ç»“æŸnginxè¿›ç¨‹çš„ï¼Œå¯ä½¿ç”¨ä¸¤ç§æ–¹æ³•å…³é—­nginx(1)è¾“å…¥nginxå‘½ä»¤ nginx -s stop(å¿«é€Ÿåœæ­¢nginx) æˆ– nginx -s quit(å®Œæ•´æœ‰åºçš„åœæ­¢nginx)(2)ä½¿ç”¨taskkill taskkill /f /t /im nginx.exe1234taskkillæ˜¯ç”¨æ¥ç»ˆæ­¢è¿›ç¨‹çš„ï¼Œ/fæ˜¯å¼ºåˆ¶ç»ˆæ­¢ ./tç»ˆæ­¢æŒ‡å®šçš„è¿›ç¨‹å’Œä»»ä½•ç”±æ­¤å¯åŠ¨çš„å­è¿›ç¨‹ã€‚/imç¤ºæŒ‡å®šçš„è¿›ç¨‹åç§° .Nginxå¸¸ç”¨å‘½ä»¤æŒ‡ä»¤123456cd /usr/local/nginx/sbin/./nginx  å¯åŠ¨./nginx -s stop  åœæ­¢./nginx -s quit  å®‰å…¨é€€å‡º./nginx -s reload  é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶ps aux|grep nginx  æŸ¥çœ‹nginxè¿›ç¨‹é˜²ç«å¢™1234567891011121314151617181920# å¼€å¯service firewalld start# é‡å¯service firewalld restart# å…³é—­service firewalld stop# æŸ¥çœ‹é˜²ç«å¢™è§„åˆ™firewall-cmd --list-all# æŸ¥è¯¢ç«¯å£æ˜¯å¦å¼€æ”¾firewall-cmd --query-port=8080/tcp# å¼€æ”¾80ç«¯å£firewall-cmd --permanent --add-port=80/tcp# ç§»é™¤ç«¯å£firewall-cmd --permanent --remove-port=8080/tcp#é‡å¯é˜²ç«å¢™(ä¿®æ”¹é…ç½®åè¦é‡å¯é˜²ç«å¢™)firewall-cmd --reload# å‚æ•°è§£é‡Š1ã€firwall-cmdï¼šæ˜¯Linuxæä¾›çš„æ“ä½œfirewallçš„ä¸€ä¸ªå·¥å…·ï¼›2ã€--permanentï¼šè¡¨ç¤ºè®¾ç½®ä¸ºæŒä¹…ï¼›3ã€--add-portï¼šæ ‡è¯†æ·»åŠ çš„ç«¯å£ï¼›æ¼”ç¤º1234567upstream lb{    server 127.0.0.1:8080 weight=1;    server 127.0.0.1:8081 weight=1;}location / {    proxy_pass http://lb;}</content>
	</entry>
	<entry>
		<title>pythonå…ƒç¼–ç¨‹</title>
		<url>/article/16156.html</url>
		<content>åŠ¨æ€å±æ€§åœ¨ Python ä¸­ï¼Œæ•°æ®çš„å±æ€§å’Œå¤„ç†æ•°æ®çš„æ–¹æ³•ç»Ÿç§°å±æ€§ï¼ˆattributeï¼‰ã€‚å…¶å®ï¼Œæ–¹æ³•åªæ˜¯å¯è°ƒç”¨çš„å±æ€§ã€‚å±æ€§æè¿°ç¬¦(get/set/delete)python ä½¿ç”¨ç‰¹æ€§ç®¡ç†å®ä¾‹å±æ€§(è½¬)Pythonæè¿°ç¬¦ï¼ˆdescriptorï¼‰è§£å¯†pythonç†è§£æè¿°ç¬¦(descriptor)python æè¿°ç¬¦æ€»ç»“Pythonæè¿°ç¬¦ (descriptor) è¯¦è§£åœ¨ä¸å¯æ•£åˆ—çš„ç±»ä¸­ä½¿ç”¨æè¿°ç¬¦-pythonpythoné«˜çº§ç¼–ç¨‹â€”â€”æè¿°ç¬¦Descriptorè¯¦è§£ï¼ˆä¸‹ç¯‡ï¼‰åŸºæœ¬æ¦‚å¿µæè¿°ç¬¦æ˜¯å¯¹å¤šä¸ªå±æ€§è¿ç”¨ç›¸åŒå­˜å–é€»è¾‘çš„ä¸€ç§æ–¹å¼ã€‚ä¾‹å¦‚ï¼ŒDjango ORM å’Œ SQL Alchemy ç­‰ ORM ä¸­çš„å­—æ®µç±»å‹æ˜¯æè¿°ç¬¦ï¼ŒæŠŠæ•°æ®åº“è®°å½•ä¸­å­—æ®µé‡Œçš„æ•°æ®ä¸ Python å¯¹è±¡çš„å±æ€§å¯¹åº”èµ·æ¥ã€‚ä¸ºä»€ä¹ˆéœ€è¦æè¿°ç¬¦ï¼šå¯¹propertyæ¥è¯´ï¼Œæœ€å¤§çš„ç¼ºç‚¹å°±æ˜¯å®ƒä»¬ä¸èƒ½é‡å¤ä½¿ç”¨ã€‚è™½ç„¶propertyå¯ä»¥è®©ç±»ä»å¤–éƒ¨çœ‹èµ·æ¥æ¥å£æ•´æ´æ¼‚äº®ï¼Œä½†æ˜¯å´åšä¸åˆ°å†…éƒ¨åŒæ ·æ•´æ´æ¼‚äº®ã€‚æè¿°ç¬¦æ˜¯propertyçš„å‡çº§ç‰ˆï¼Œå…è®¸ä½ ä¸ºé‡å¤çš„propertyé€»è¾‘ç¼–å†™å•ç‹¬çš„ç±»æ¥å¤„ç†ã€‚åŸºæœ¬è¦æ±‚ï¼šæè¿°ç¬¦æ˜¯å®ç°äº†ç‰¹å®šåè®®çš„ç±»ï¼Œè¿™ä¸ªåè®®åŒ…æ‹¬ __get__ã€__set__ å’Œ __delete__ æ–¹æ³•ã€‚property ç±»å®ç°äº†å®Œæ•´çš„æè¿°ç¬¦åè®®ã€‚é€šå¸¸ï¼Œå¯ä»¥åªå®ç°éƒ¨åˆ†åè®®ã€‚å…¶å®ï¼Œæˆ‘ä»¬åœ¨çœŸå®çš„ä»£ç ä¸­è§åˆ°çš„å¤§å¤šæ•°æè¿°ç¬¦åªå®ç°äº† __get__ å’Œ __set__ æ–¹æ³•ï¼Œè¿˜æœ‰å¾ˆå¤šåªå®ç°äº†å…¶ä¸­çš„ä¸€ä¸ªã€‚å®ç°äº† __get__ã€__set__ æˆ– __delete__ æ–¹æ³•çš„ç±»æ˜¯æè¿°ç¬¦ã€‚ç”¨æ³•ï¼šæè¿°ç¬¦çš„ç”¨æ³•æ˜¯ï¼Œåˆ›å»ºä¸€ä¸ªæè¿°ç¬¦ç±»ï¼Œå®ƒçš„å®ä¾‹å¯¹è±¡ä½œä¸ºå¦ä¸€ä¸ªç±»çš„å±æ€§ã€‚ä¸ºäº†è®©æè¿°ç¬¦èƒ½å¤Ÿæ­£å¸¸å·¥ä½œï¼Œå®ƒä»¬å¿…é¡»å®šä¹‰åœ¨ç±»çš„å±‚æ¬¡ä¸Šã€‚å¦‚æœä½ ä¸è¿™ä¹ˆåšï¼Œé‚£ä¹ˆPythonæ— æ³•è‡ªåŠ¨ä¸ºä½ è°ƒç”¨__get__å’Œ__set__æ–¹æ³•ã€‚å¤§è‡´æµç¨‹ï¼šå®šä¹‰ä¸€ä¸ªæè¿°ç¬¦ç±»Dï¼Œå…¶å†…åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ª__get__()ã€__set__()ã€__delete__()æ–¹æ³•å°†æè¿°ç¬¦ç±»Dçš„å®ä¾‹å¯¹è±¡dèµ‹å€¼ç»™å¦ä¸€ä¸ªè¦ä»£ç†çš„ç±»ä¸­æŸä¸ªå±æ€§attrï¼Œå³attr=D()ä¹‹åè®¿é—®ã€èµ‹å€¼ã€åˆ é™¤attrå±æ€§ï¼Œå°†ä¼šè‡ªåŠ¨è§¦å‘æè¿°ç¬¦ç±»ä¸­çš„__get__()ã€__set__()ã€__delete__()æ–¹æ³•å®ç°ï¼šè¦å®šä¹‰æè¿°ç¬¦ç±»å¾ˆç®€å•ï¼Œåªè¦æŸä¸ªç±»ä¸­åŒ…å«äº†ä¸‹é¢ä¸€ä¸ªæˆ–å¤šä¸ªæ–¹æ³•ï¼Œå°±ç®—æ˜¯æ»¡è¶³æè¿°ç¬¦åè®®ï¼Œå°±æ˜¯æè¿°ç¬¦ç±»ï¼Œå°±å¯ä»¥ä½œä¸ºå±æ€§æ“ä½œçš„ä»£ç†å™¨ã€‚1234class Descriptor():    def __get__(self, instance, owner):...    def __set__(self, instance, value):...    def __delete__(self, instance):...éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ__get__çš„è¿”å›å€¼éœ€è¦æ˜¯å±æ€§å€¼æˆ–æŠ›å¼‚å¸¸ï¼Œå¦å¤–ä¸¤ä¸ªæ–¹æ³•è¦è¿”å›Noneã€‚ç±»å±æ€§æè¿°ç¬¦å¯¹è±¡å’Œå®ä¾‹å±æ€§åŒåæ—¶ï¼šæè¿°ç¬¦é’ˆå¯¹çš„æ˜¯ç±»å±æ€§ï¼Œä½†æ˜¯å½“ä¸€ä¸ªç±»ä¸­ï¼Œå¦‚æœç±»å±æ€§æ˜¯æè¿°ç¬¦å¯¹è±¡ï¼Œè€Œå®ä¾‹å±æ€§ç”±äºè¿™ä¸ªæè¿°ç¬¦å±æ€§åŒå12345678910class Person:    character = CharacterDescriptor('ä¹è§‚çš„')    weight = WeightDescriptor(150)    def __init__(self, character,weight):        self.character = character        self.weight = weight       p = Person('æ‚²è§‚çš„', 200)print(p.character)  #å±æ€§çš„è®¿é—®print(p.weight)     #ä»ä¸Šé¢çš„è¿è¡Œç»“æœå¯ä»¥çœ‹å‡ºï¼Œé¦–å…ˆæ˜¯è®¿é—®äº†æè¿°ç¬¦çš„__set__æ–¹æ³•ï¼Œè¿™æ˜¯å› ä¸ºåœ¨æ„å»ºå¯¹è±¡çš„æ—¶å€™ï¼Œç›¸å½“äºä¸ºcharacterå’Œweightèµ‹å€¼ï¼Œç„¶åå†è°ƒç”¨__get__æ–¹æ³•ï¼Œè¿™æ˜¯å› ä¸ºè®¿é—®äº†ç±»å±æ€§characterå’Œweightï¼Œä½†æ˜¯æœ€ç»ˆæ‰“å°å‡ºæ¥å€¼å´å¹¶ä¸æ˜¯ç±»å±æ€§çš„å€¼ï¼Œè¿™æ˜¯å› ä¸ºï¼Œå®ä¾‹å±æ€§å®é™…ä¸Šæ˜¯åœ¨â€œæè¿°ç¬¦ç±»å±æ€§â€åé¢è®¿é—®çš„ï¼Œæ‰€ä»¥è¦†ç›–æ‰äº†ã€‚ä¸“æœ‰åè¯æè¿°ç¬¦ç±»: å®ç°äº†æè¿°ç¬¦åè®®çš„ç±»ï¼Œæè¿°ç¬¦ç±»çš„ä¸€äº›åè®®(__get__ã€__set__æˆ–__delete__ )ã€‚å®ç°äº†__get__ã€__set__ã€__delete__ æ–¹æ³•çš„ç±»æ˜¯æè¿°ç¬¦ï¼Œåªè¦å®ç°äº†å…¶ä¸­ä¸€ä¸ªå°±æ˜¯ã€‚æ‰˜ç®¡ç±»ï¼š å°†æè¿°ç¬¦å®ä¾‹ä½œä¸ºç±»å±æ€§çš„ç±»ï¼Œæ¯”å¦‚Fruits ç±»ï¼Œä»–æœ‰ weightã€price ä¸¤ä¸ªç±»å±æ€§ï¼Œä¸”éƒ½è¢«èµ‹äºˆäº†æè¿°ç¬¦ç±»çš„å®ä¾‹ã€‚æè¿°ç¬¦å®ä¾‹: æè¿°ç¬¦ç±»åˆ›å»ºå‡ºæè¿°ç¬¦å®ä¾‹ï¼Œé€šå¸¸æ¥è®²ï¼Œæè¿°ç¬¦ç±»çš„å®ä¾‹ä¼šè¢«èµ‹ç»™æ‰˜ç®¡ç±»çš„ç±»å±æ€§ã€‚æ‰˜ç®¡å®ä¾‹: æ‰˜ç®¡ç±»åˆ›å»ºå‡ºæ¥çš„å®ä¾‹æ‰˜ç®¡å±æ€§: æ‰˜ç®¡ç±»ä¸­ç”±æè¿°ç¬¦å®ä¾‹å¤„ç†çš„å…¬å¼€å±æ€§å­˜å‚¨å±æ€§: å¯ä»¥ç²—ç•¥çš„ç†è§£ä¸ºã€æ‰˜ç®¡å®ä¾‹çš„å±æ€§ã€åœ¨ä¸Šä¾‹ä¸­ä½¿ç”¨ vars(apple) å¾—åˆ°çš„ç»“æœä¸­ price å’Œ weight å®ä¾‹å±æ€§å°±æ˜¯å­˜å‚¨å±æ€§ï¼Œå®ƒä»¬å®é™…å­˜å‚¨ç€*å®ä¾‹çš„*å±æ€§å€¼éæ•°æ®æè¿°ç¬¦ï¼šä¸€ä¸ªç±»ï¼Œå¦‚æœåªå®šä¹‰äº†__get__() æˆ–è€…æ˜¯__delete__()æ–¹æ³•ï¼Œè€Œæ²¡æœ‰å®šä¹‰__set__()æ–¹æ³•ï¼Œåˆ™è®¤ä¸ºæ˜¯éæ•°æ®æè¿°ç¬¦(å³æ²¡æœ‰å®šä¹‰__set__)æ•°æ®æè¿°ç¬¦ï¼šä¸€ä¸ªç±»ï¼Œä¸ä»…å®šä¹‰äº†__get__() æ–¹æ³•ï¼Œè¿˜å®šä¹‰__set__(), __delete__() æ–¹æ³•ï¼Œåˆ™è®¤ä¸ºæ˜¯æ•°æ®æè¿°ç¬¦(å³å®šä¹‰äº†__get__å’Œ__set__)psï¼š æ‰˜ç®¡å±æ€§æ˜¯ç±»(Fruits)å±æ€§ã€å­˜å‚¨å±æ€§æ˜¯å®ä¾‹(apple)çš„å±æ€§ã€‚&gt;Quantity å®ä¾‹æ˜¯æè¿°ç¬¦ï¼Œå› æ­¤æœ‰ä¸ªæ”¾å¤§é•œï¼Œç”¨äºè·å–å€¼ï¼ˆ__get__ï¼‰ï¼Œä»¥åŠä¸€ä¸ªæ‰‹æŠ“ï¼Œç”¨äºè®¾ç½®å€¼ï¼ˆ__set__ï¼‰ã€‚ä¾‹å­è¦ç‚¹å®šä¹‰ä½ç½®ï¼šä¸ºäº†è®©æè¿°ç¬¦èƒ½å¤Ÿæ­£å¸¸å·¥ä½œï¼Œå®ƒä»¬å¿…é¡»å®šä¹‰åœ¨ç±»çš„å±‚æ¬¡ä¸Šã€‚å¦‚æœä½ ä¸è¿™ä¹ˆåšï¼Œé‚£ä¹ˆPythonæ— æ³•è‡ªåŠ¨ä¸ºä½ è°ƒç”¨__get__å’Œ__set__æ–¹æ³•ã€‚ç‹¬ç«‹å®ä¾‹ï¼šç±»ä½¿ç”¨äº†ä¸€ä¸ªå­—å…¸æ¥å•ç‹¬ä¿å­˜ä¸“å±äºå®ä¾‹çš„æ•°æ®ã€‚è¿™ä¸ªä¸€èˆ¬æ¥è¯´æ˜¯æ²¡é—®é¢˜çš„ï¼Œé™¤éä½ ç”¨åˆ°äº†ä¸å¯å“ˆå¸Œï¼ˆunhashableï¼‰çš„å¯¹è±¡ä¸å¯å“ˆå¸Œå¤„ç†ï¼šlistçš„å­ç±»æ˜¯ä¸å¯å“ˆå¸Œçš„ï¼Œå› æ­¤å®ƒä»¬ä¸èƒ½ä¸ºæè¿°ç¬¦ç±»ç”¨åšæ•°æ®å­—å…¸çš„keyã€‚æœ‰ä¸€äº›æ–¹æ³•å¯ä»¥è§„é¿è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯éƒ½ä¸å®Œç¾ã€‚æœ€å¥½çš„æ–¹æ³•å¯èƒ½å°±æ˜¯ç»™ä½ çš„æè¿°ç¬¦åŠ æ ‡ç­¾äº†ã€‚æè¿°ç¬¦å¯ä»¥å®‰å…¨çš„åœ¨è¿™é‡Œå­˜å‚¨æ•°æ®ã€‚åªæ˜¯è¦è®°ä½ï¼Œä¸è¦åœ¨åˆ«çš„åœ°æ–¹ä¹Ÿç»™è¿™ä¸ªæè¿°ç¬¦æ·»åŠ æ ‡ç­¾ã€‚è¿™æ ·çš„ä»£ç å¾ˆè„†å¼±ä¹Ÿæœ‰å¾ˆå¤šå¾®å¦™ä¹‹å¤„ã€‚ä½†è¿™ä¸ªæ–¹æ³•çš„ç¡®å¾ˆæ™®éï¼Œå¯ä»¥ç”¨åœ¨ä¸å¯å“ˆå¸Œçš„æ‰€æœ‰è€…ç±»ä¸Šã€‚123456789101112131415class Descriptor(object):    def __init__(self, label):        self.label = label    def __get__(self, instance, owner):        print('__get__', instance, owner)        return instance.__dict__.get(self.label)    def __set__(self, instance, value):        print('__set__')        instance.__dict__[self.label] = valueclass Foo(list):    x = Descriptor('x')    y = Descriptor('y')æ³„æ¼å†…å­˜é—®é¢˜ï¼šWeakKeyDictionaryå¯ä»¥ä¿è¯æè¿°ç¬¦ç±»ä¸ä¼šæ³„æ¼å†…å­˜ï¼šWeakKeyDictionaryçš„ç‰¹æ®Šä¹‹å¤„åœ¨äºï¼šå¦‚æœè¿è¡ŒæœŸç³»ç»Ÿå‘ç°è¿™ç§å­—å…¸æ‰€æŒæœ‰çš„å¼•ç”¨ï¼Œæ˜¯æ•´ä¸ªç¨‹åºé‡Œé¢æŒ‡å‘Examå®ä¾‹çš„æœ€åä¸€ä»½å¼•ç”¨ï¼Œé‚£ä¹ˆï¼Œç³»ç»Ÿå°±ä¼šè‡ªåŠ¨å°†è¯¥å®ä¾‹ä»å­—å…¸çš„é”®ä¸­ç§»é™¤ã€‚æ¨¡æ‹ŸORMä»£ç -æè¿°ç¬¦ç±»1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162#!/usr/bin/env Python# -- coding: utf-8 --import weakrefimport numbersclass Field:    passclass IntField(Field):    # æ•°æ®æè¿°ç¬¦    def __init__(self, db_column, min_value=None, max_value=None):        self.min_value = min_value        self.max_value = max_value        self.db_column = db_column        if min_value is not None:            if not isinstance(min_value, numbers.Integral):                raise ValueError(&quot;min_value must be int&quot;)            elif min_value &lt; 0:                raise ValueError(&quot;min_value must be positive int&quot;)        if max_value is not None:            if not isinstance(max_value, numbers.Integral):                raise ValueError(&quot;max_value must be int&quot;)            elif max_value &lt; 0:                raise ValueError(&quot;max_value must be positive int&quot;)        if min_value is not None and max_value is not None:            if min_value &gt; max_value:                raise ValueError(&quot;min_value must be smaller than max_value&quot;)        self._value = weakref.WeakKeyDictionary()    def __get__(self, instance, owner):        if instance is None:            return self        return self._value.get(instance, 0)    def __set__(self, instance, value):        if not isinstance(value, numbers.Integral):            raise ValueError(&quot;int value need&quot;)        if value &lt; self.min_value or value &gt; self.max_value:            raise ValueError(&quot;value must between min_value and max_value&quot;)        self._value[instance] = valueclass CharField(Field):    def __init__(self, db_column, max_length=None):        # self._value = None        self.db_column = db_column        if max_length is None:            raise ValueError(&quot;you must spcify max_lenth for charfiled&quot;)        self.max_length = max_length        self._value = weakref.WeakKeyDictionary()    def __get__(self, instance, owner):        if instance is None:            return self        return self._value.get(instance, '0')    def __set__(self, instance, value):        if not isinstance(value, str):            raise ValueError(&quot;string value need&quot;)        if len(value) &gt; self.max_length:            raise ValueError(&quot;value len excess len of max_length&quot;)        self._value[instance] = valueä»£ç -å…ƒç±»123456789101112131415161718192021222324252627282930313233343536373839404142class ModelMetaClass(type):    def __new__(cls, name, bases, attrs, **kwargs):        if name == &quot;BaseModel&quot;:            return super().__new__(cls, name, bases, attrs, **kwargs)        fields = {}        for key, value in attrs.items():            if isinstance(value, Field):                fields[key] = value        attrs_meta = attrs.get(&quot;Meta&quot;, None)        _meta = {}        db_table = name.lower()        if attrs_meta is not None:            table = getattr(attrs_meta, &quot;db_table&quot;, None)            if table is not None:                db_table = table        _meta[&quot;db_table&quot;] = db_table        attrs[&quot;_meta&quot;] = _meta        attrs[&quot;fields&quot;] = fields        del attrs[&quot;Meta&quot;]        return super().__new__(cls, name, bases, attrs, **kwargs)class BaseModel(metaclass=ModelMetaClass):    def __init__(self, *args, **kwargs):        for key, value in kwargs.items():            setattr(self, key, value)        return super(BaseModel, self).__init__()    def save(self):        fields = []        values = []        for key, value in self.fields.items():            db_column = value.db_column            if db_column is None:                db_column = key.lower()            fields.append(db_column)            value = getattr(self, key)            values.append(str(value))        sql = &quot;insert {db_table}({fields}) value({values})&quot;.format(db_table=self._meta[&quot;db_table&quot;],                                                                   fields=&quot;,&quot;.join(fields), values=&quot;,&quot;.join(values))        print(sql)ä»£ç -æµ‹è¯•12345678910111213141516171819class User(BaseModel):    name = CharField(db_column=&quot;name&quot;, max_length=10)    age = IntField(db_column=&quot;age&quot;, min_value=1, max_value=100)    class Meta:        db_table = &quot;user&quot;if __name__ == '__main__':    first_user = User(name=&quot;bobby&quot;, age=28)    first_user.name = &quot;bobby&quot;    first_user.age = 28    second_user = User(name=&quot;bobby&quot;, age=23)    print(first_user.name is second_user.name)    second_user.name = 'okay'    print(first_user.name is second_user.name)    second_user.name = 'sec_boddy'    print(first_user.name)    print(second_user.name)    print(first_user.name is second_user.name)è¾“å‡º12345TrueFalsebobbysec_boddyFalseæˆç»©ç®¡ç†ä»£ç 123456789101112131415161718192021222324252627282930313233#!/usr/bin/env Python# -- coding: utf-8 --import weakrefclass Grade:    def __init__(self):        self._values = weakref.WeakKeyDictionary()    def __get__(self, instance, owner):        if instance is None:            return self        return self._values.get(instance, 0)    def __set__(self, instance, value):        if not (0 &lt;= value &lt;= 100):            raise ValueError('Grade must be between 0 and 100')        self._values[instance] = valueclass Exam:    # https://lingxiankong.github.io/2014-03-28-python-descriptor.html    # ä¸ºäº†è®©æè¿°ç¬¦èƒ½å¤Ÿæ­£å¸¸å·¥ä½œï¼Œå®ƒä»¬å¿…é¡»å®šä¹‰åœ¨ç±»çš„å±‚æ¬¡ä¸Šã€‚å¦‚æœä½ ä¸è¿™ä¹ˆåšï¼Œé‚£ä¹ˆPythonæ— æ³•è‡ªåŠ¨ä¸ºä½ è°ƒç”¨__get__å’Œ__set__æ–¹æ³•ã€‚    # ç¡®ä¿å®ä¾‹çš„æ•°æ®åªå±äºå®ä¾‹æœ¬èº«    math_grade = Grade()    writing_grade = Grade()    science_grade = Grade()    if __name__ == '__main__':    first_exam = Exam()    first_exam.writing_grade = 82    second_exam = Exam()    second_exam.writing_grade = 75    logger.info(f'first {first_exam.writing_grade}')    logger.info(f'second {second_exam.writing_grade}')    è¾“å‡º122020-06-25 20:18:23 lazy_db INFO:  first 822020-06-25 20:18:23 lazy_db INFO:  second 75æˆç»©ç®¡ç†2.0ä»£ç 123456789101112131415161718192021222324252627282930class Grade:    def __init__(self, name):        self.name = name        self.internal_name = '_' + self.name    def __get__(self, instance, owner):        if instance is None:            return self        return getattr(instance, self.internal_name, '')    def __set__(self, instance, value):        if not (0 &lt;= value &lt;= 100):            raise ValueError('Grade must be between 0 and 100')        setattr(instance, self.internal_name, value)class Exam:    # https://lingxiankong.github.io/2014-03-28-python-descriptor.html    # ä¸ºäº†è®©æè¿°ç¬¦èƒ½å¤Ÿæ­£å¸¸å·¥ä½œï¼Œå®ƒä»¬å¿…é¡»å®šä¹‰åœ¨ç±»çš„å±‚æ¬¡ä¸Šã€‚å¦‚æœä½ ä¸è¿™ä¹ˆåšï¼Œé‚£ä¹ˆPythonæ— æ³•è‡ªåŠ¨ä¸ºä½ è°ƒç”¨__get__å’Œ__set__æ–¹æ³•ã€‚    # ç¡®ä¿å®ä¾‹çš„æ•°æ®åªå±äºå®ä¾‹æœ¬èº«    math_grade = Grade('math_grade')    writing_grade = Grade('writing_grade')    science_grade = Grade('science_grade')if __name__ == '__main__':    first_exam = Exam()    first_exam.writing_grade = 82    second_exam = Exam()    second_exam.writing_grade = 75    logger.info(f'first {first_exam.writing_grade}')    logger.info(f'second {second_exam.writing_grade}')è¾“å‡º122020-06-25 20:18:23 lazy_db INFO:  first 822020-06-25 20:18:23 lazy_db INFO:  second 75æˆç»©ç®¡ç†2.1ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142class Grade:    def __init__(self):        self.name = None        self.internal_name = None    def __get__(self, instance, owner):        if instance is None:            return self        return getattr(instance, self.internal_name, '')    def __set__(self, instance, value):        if not (0 &lt;= value &lt;= 100):            raise ValueError('Grade must be between 0 and 100')        setattr(instance, self.internal_name, value)class Meta(type):    def __new__(cls, name, bases, class_dict):        for key, value in class_dict.items():            if isinstance(value, Grade):                value.name = key                value.internal_name = '_' + key        cls = type.__new__(cls, name, bases, class_dict)        return clsclass Exam(object,metaclass=Meta):    # https://lingxiankong.github.io/2014-03-28-python-descriptor.html    # ä¸ºäº†è®©æè¿°ç¬¦èƒ½å¤Ÿæ­£å¸¸å·¥ä½œï¼Œå®ƒä»¬å¿…é¡»å®šä¹‰åœ¨ç±»çš„å±‚æ¬¡ä¸Šã€‚å¦‚æœä½ ä¸è¿™ä¹ˆåšï¼Œé‚£ä¹ˆPythonæ— æ³•è‡ªåŠ¨ä¸ºä½ è°ƒç”¨__get__å’Œ__set__æ–¹æ³•ã€‚    # ç¡®ä¿å®ä¾‹çš„æ•°æ®åªå±äºå®ä¾‹æœ¬èº«    math_grade = Grade()    writing_grade = Grade()    science_grade = Grade()    def __init__(self, writing_grade):        self.writing_grade = writing_gradeif __name__ == '__main__':    first_exam = Exam(85)    first_exam.writing_grade = 82    second_exam = Exam(13)    second_exam.writing_grade = 75    logger.info(f'first {first_exam.writing_grade}')    logger.info(f'second {second_exam.writing_grade}')è¿›é˜¶æ·»åŠ å›è°ƒæè¿°ç¬¦ä»…ä»…æ˜¯ç±»ï¼Œä¹Ÿè®¸ä½ æƒ³è¦ä¸ºå®ƒä»¬å¢åŠ ä¸€äº›æ–¹æ³•ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæè¿°ç¬¦æ˜¯ä¸€ä¸ªç”¨æ¥å›è°ƒpropertyçš„å¾ˆå¥½çš„æ‰‹æ®µã€‚æ¯”å¦‚æˆ‘ä»¬æƒ³è¦ä¸€ä¸ªç±»çš„æŸä¸ªéƒ¨åˆ†çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶å°±ç«‹åˆ»é€šçŸ¥æˆ‘ä»¬ã€‚ä¸‹é¢çš„å¤§éƒ¨åˆ†ä»£ç æ˜¯ç”¨æ¥åšè¿™ä¸ªçš„ï¼š12345678910111213141516171819202122232425262728293031323334class CallbackProperty(object):    &quot;&quot;&quot;A property that will alert observers when upon updates&quot;&quot;&quot;    def __init__(self, default=None):        self.data = WeakKeyDictionary()        self.default = default        self.callbacks = WeakKeyDictionary()    def __get__(self, instance, owner):        return self.data.get(instance, self.default)    def __set__(self, instance, value):                for callback in self.callbacks.get(instance, []):            # alert callback function of new value            callback(value)        self.data[instance] = value    def add_callback(self, instance, callback):        &quot;&quot;&quot;Add a new function to call everytime the descriptor updates&quot;&quot;&quot;        #but how do we get here?!?!        if instance not in self.callbacks:            self.callbacks[instance] = []        self.callbacks[instance].append(callback)class BankAccount(object):    balance = CallbackProperty(0)def low_balance_warning(value):    if value &lt; 100:        print &quot;You are poor&quot;ba = BankAccount()# will not work -- try it#ba.balance.add_callback(ba, low_balance_warning)è¿™æ˜¯ä¸€ä¸ªå¾ˆæœ‰å¸å¼•åŠ›çš„æ¨¡å¼â€”â€”æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰å›è°ƒå‡½æ•°ç”¨æ¥å“åº”ä¸€ä¸ªç±»ä¸­çš„çŠ¶æ€å˜åŒ–ï¼Œè€Œä¸”å®Œå…¨æ— éœ€ä¿®æ”¹è¿™ä¸ªç±»çš„ä»£ç ã€‚è¿™æ ·åšå¯çœŸæ˜¯æ›¿äººåˆ†å¿§è§£éš¾å‘€ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬æ‰€è¦åšçš„å°±æ˜¯è°ƒç”¨ba.balance.add_callback(ba, low_balance_warning)ï¼Œä»¥ä½¿å¾—æ¯æ¬¡balanceå˜åŒ–æ—¶low_balance_warningéƒ½ä¼šè¢«è°ƒç”¨ã€‚ä½†æ˜¯æˆ‘ä»¬æ˜¯å¦‚ä½•åšåˆ°çš„å‘¢ï¼Ÿå½“æˆ‘ä»¬è¯•å›¾è®¿é—®å®ƒä»¬æ—¶ï¼Œæè¿°ç¬¦æ€»æ˜¯ä¼šè°ƒç”¨__get__ã€‚å°±å¥½åƒaddcallbackæ–¹æ³•æ˜¯æ— æ³•è§¦åŠçš„ä¸€æ ·ï¼å…¶å®å…³é”®åœ¨äºåˆ©ç”¨äº†ä¸€ç§ç‰¹æ®Šçš„æƒ…å†µï¼Œå³ï¼Œå½“ä»ç±»çš„å±‚æ¬¡è®¿é—®æ—¶ï¼Œ`_get`æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯Noneã€‚1234567891011121314151617181920212223242526272829303132333435363738394041class CallbackProperty(object):    &quot;&quot;&quot;A property that will alert observers when upon updates&quot;&quot;&quot;    def __init__(self, default=None):        self.data = WeakKeyDictionary()        self.default = default        self.callbacks = WeakKeyDictionary()    def __get__(self, instance, owner):        if instance is None:            return self                return self.data.get(instance, self.default)    def __set__(self, instance, value):        for callback in self.callbacks.get(instance, []):            # alert callback function of new value            callback(value)        self.data[instance] = value    def add_callback(self, instance, callback):        &quot;&quot;&quot;Add a new function to call everytime the descriptor within instance updates&quot;&quot;&quot;        if instance not in self.callbacks:            self.callbacks[instance] = []        self.callbacks[instance].append(callback)class BankAccount(object):    balance = CallbackProperty(0)def low_balance_warning(value):    if value &lt; 100:        print &quot;You are now poor&quot;ba = BankAccount()BankAccount.balance.add_callback(ba, low_balance_warning)ba.balance = 5000print &quot;Balance is %s&quot; % ba.balanceba.balance = 99print &quot;Balance is %s&quot; % ba.balanceBalance is 5000You are now poorBalance is 99å®ç°åº•å±‚ @classmethod123456789101112131415161718192021222324252627282930class NewDefine_classmethod:    &quot;&quot;&quot;    ä½¿ç”¨â€œæè¿°ç¬¦â€å’Œâ€œè£…é¥°å™¨â€ç»“åˆèµ·æ¥ï¼Œæ¨¡æ‹Ÿ@classmethod    &quot;&quot;&quot;    def __init__(self, function):        self.function = function     def __get__(self, instance, owner):        #å¯¹ä¼ è¿›å‡½æ•°è¿›è¡ŒåŠ å·¥,æœ€åè¿”å›è¯¥å‡½æ•°        def wrapper(*args, **kwargs):   #ä½¿ç”¨ä¸å®šå‚æ•°æ˜¯ä¸ºäº†åŒ¹é…éœ€è¦ä¿®é¥°çš„å‡½æ•°å‚æ•°            print(&quot;ç»™å‡½æ•°æ·»åŠ é¢å¤–åŠŸèƒ½&quot;)            self.function(owner, *args, **kwargs)        return wrapper class Person:    name='æˆ‘æœ‰å§“å'    def __init__(self):        pass     @NewDefine_classmethod    def study_1(cls):        print(f'æˆ‘çš„åå­—æ˜¯ï¼š{cls.name},æˆ‘ä¼šæå­¦ä¹ ï¼')     @NewDefine_classmethod    def study_2(cls,score):        print(f'æˆ‘çš„åå­—æ˜¯ï¼š{cls.name},æˆ‘ä¼šæå­¦ä¹ ï¼,è€Œä¸”è¿™æ¬¡è€ƒè¯•è€ƒäº† {score} åˆ†')    print(Person.study_1())print(Person.study_2(99))å¯ä»¥åˆ†è¿™æ ·å‡ æ­¥åˆ†æï¼šç¬¬ä¸€æ­¥ï¼š@NewDefine_classmethodæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªâ€œç±»è£…é¥°å™¨â€ï¼Œä»å®ƒçš„å®šä¹‰å¯çŸ¥ï¼Œå®ƒçš„å®šä¹‰ä¸ºclass NewDefine_classmethod(function).æˆ‘ä»¬å‘ç°ï¼Œpythonç³»ç»Ÿå®šä¹‰çš„@classmethodå…¶å®å®ƒçš„å®šä¹‰ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œå¦‚ä¸‹ï¼Œclass classmethod(function) .æ€ä¹ˆæ ·ï¼Ÿå®ƒä»¬äºŒè€…çš„å®šä¹‰æ˜¯ä¸æ˜¯ä¸€æ ·ï¼Ÿç¬¬äºŒæ­¥ï¼šNewDefineclassmethodæœ¬è´¨ä¸Šåˆæ˜¯ä¸€ä¸ªæè¿°ç¬¦ï¼Œå› ä¸ºåœ¨å®ƒçš„å†…éƒ¨å®ç°äº†\_get__åè®®ï¼Œç”±æ­¤å¯è§ï¼ŒNewDefine_classmethodæ˜¯â€œé›†è£…é¥°å™¨-æè¿°ç¬¦â€äºä¸€èº«çš„ã€‚ç¬¬ä¸‰æ­¥ï¼šè¿è¡Œè¿‡ç¨‹åˆ†æï¼Œå› ä¸ºstudy_1=NewDefine_classmethodï¼ˆstudy_1ï¼‰,æ‰€ä»¥ï¼Œstudy_1æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªNewDefine_classmethodçš„å¯¹è±¡ï¼Œåˆå› ä¸ºNewDefine_classmethodæœ¬è´¨ä¸Šæ˜¯å®ç°äº†æè¿°ç¬¦çš„ï¼Œæ‰€ä»¥ï¼Œstudy_1æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå®šä¹‰åœ¨ç±»ä¸­çš„æè¿°ç¬¦å±æ€§ã€‚ç¬¬å››æ­¥ï¼šå› ä¸ºstudy1æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå®šä¹‰åœ¨ç±»ä¸­çš„æè¿°ç¬¦å±æ€§ã€‚æ‰€ä»¥åœ¨æ‰§è¡ŒPerson.study_1çš„æ—¶å€™ï¼Œç›¸å½“äºæ˜¯è®¿é—®ç±»çš„æè¿°ç¬¦å±æ€§ï¼Œæ‰€ä»¥ä¼šè¿›å…¥åˆ°æè¿°ç¬¦çš„\_get__æ–¹æ³•ã€‚ç°åœ¨æ˜¯ä¸æ˜¯è§‰å¾—åŸæ¥pythonæè¿°ç¬¦è¿˜æœ‰è¿™æ ·ç¥å¥‡çš„ä½¿ç”¨å‘¢ï¼Ÿæ³¨æ„ï¼šå¦‚æœä¿®é¥°çš„å‡½æ•°æœ¬èº«æ˜¯å…·æœ‰è¿”å›å€¼çš„ï¼Œåœ¨__get__é‡Œé¢æ‰€å®šä¹‰çš„wrapperé‡Œé¢ä¸€å®šè¦è¿”å›ï¼Œå³return self.function(owner, args, *kwargs)ã€‚è¿˜æœ‰ä¸€ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå› ä¸ºè¿™æ˜¯è‡ªå®šä¹‰çš„åº•å±‚å®ç°ï¼Œæ‰€ä»¥ä¸€äº›é›†æˆIDEå¯èƒ½ä¼šæ˜¾ç¤ºæœ‰è¯­æ³•é”™è¯¯ï¼Œä½†æ˜¯è¿™æ²¡æœ‰å…³ç³»ï¼Œè¿™æ­£æ˜¯pythonçµæ´»å¤šå˜çš„åœ°æ–¹ï¼Œè¿è¡Œå¹¶ä¸ä¼šå‡ºç°é”™è¯¯ã€‚å®ç°åº•å±‚ @staticmethodstaticmethodæ–¹æ³•ä¸classmethodæ–¹æ³•çš„åŒºåˆ«åœ¨äºclassmethodæ–¹æ³•åœ¨ä½¿ç”¨éœ€è¦ä¼ è¿›ä¸€ä¸ªç±»çš„å¼•ç”¨ä½œä¸ºå‚æ•°ã€‚è€Œstaticmethodåˆ™ä¸ç”¨ã€‚1234567891011121314151617181920212223242526272829class NewDefine_staticmethod:    &quot;&quot;&quot;    ä½¿ç”¨â€œæè¿°ç¬¦â€å’Œâ€œè£…é¥°å™¨â€ç»“åˆèµ·æ¥ï¼Œæ¨¡æ‹Ÿ@classmethod    &quot;&quot;&quot;    def __init__(self, function):        self.function = function     def __get__(self, instance, owner):        #å¯¹ä¼ è¿›å‡½æ•°è¿›è¡ŒåŠ å·¥,æœ€åè¿”å›è¯¥å‡½æ•°        def wrapper(*args, **kwargs):   #ä½¿ç”¨ä¸å®šå‚æ•°æ˜¯ä¸ºäº†åŒ¹é…éœ€è¦ä¿®é¥°çš„å‡½æ•°å‚æ•°            print(&quot;ç»™å‡½æ•°æ·»åŠ é¢å¤–åŠŸèƒ½&quot;)            self.function(*args, **kwargs)        return wrapper class Person:    name='æˆ‘æœ‰å§“å'    def __init__(self):        pass     @NewDefine_staticmethod    def study_1(math,english):        print(f'æˆ‘æ•°å­¦è€ƒäº† {math} åˆ†,è‹±è¯­è€ƒäº† {english} åˆ†,æˆ‘ä¼šæå­¦ä¹ ï¼')     @NewDefine_staticmethod    def study_2(history,science):        print(f'æˆ‘å†å²è€ƒäº† {history} åˆ†,ç§‘å­¦è€ƒäº† {science} åˆ†,æˆ‘ä¼šæå­¦ä¹ ï¼')    print(Person.study_1(99,98))print(Person.study_2(88,89))ç±»æ–¹æ³•classmethodå¿…é¡»ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯clsï¼Œè¿™ä¸ªå®é™…ä¸Šå°±æ˜¯åˆ¤æ–­æ‰€å±çš„é‚£ä¸ªç±»ï¼Œå› æ­¤åœ¨__get__é‡Œé¢çš„functionåœ¨è°ƒç”¨çš„æ—¶å€™ï¼Œç¬¬ä¸€ä¸ªå‚æ•°éœ€è¦ä¼ é€’ä¸ºownerï¼Œå› ä¸ºæ‰€å±çš„â€œç±»clsç­‰ä»·äºPersonç­‰ä»·äºownerâ€ï¼Œä½†æ˜¯å› ä¸ºé™æ€æ–¹æ³•ä¸éœ€è¦ä»»ä½•å‚æ•°clsæˆ–è€…æ˜¯selféƒ½ä¸éœ€è¦ï¼Œå› æ­¤åœ¨__get__å®ç°çš„æ—¶å€™ä¸èƒ½å†ä¼ é€’ownerå‚æ•°ï¼Œå¦åˆ™ä¼šæ˜¾ç¤ºå‚æ•°é”™è¯¯ã€‚å®ç°åº•å±‚ @property12345678910111213141516171819202122class NewDefine_property:    &quot;&quot;&quot;    ä½¿ç”¨â€œæè¿°ç¬¦â€å’Œâ€œè£…é¥°å™¨â€ç»“åˆèµ·æ¥ï¼Œæ¨¡æ‹Ÿ@classmethod    &quot;&quot;&quot;    def __init__(self, function):        self.function = function     def __get__(self, instance, owner):        print(&quot;ç»™å‡½æ•°æ·»åŠ é¢å¤–åŠŸèƒ½&quot;)        return self.function(instance) class Person:    name='æˆ‘æœ‰å§“å'    def __init__(self):        self.__study=100     @NewDefine_property    def study_1(self):  #ä½¿ç”¨propertyè£…é¥°çš„å‡½æ•°ä¸€èˆ¬ä¸è¦ç”¨â€œå‚æ•°â€ï¼Œå› ä¸ºå®ƒçš„ä¸»è¦åŠŸèƒ½æ˜¯å¯¹å±æ€§çš„å°è£…        return self.__study p=Person()print(p.study_1)åŸºæœ¬æ€æƒ³å’Œå‰é¢åˆ†æçš„è¿˜æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯æœ‰å‡ ä¸ªåœ°æ–¹æœ‰æ‰€åŒºåˆ«ï¼Œéœ€è¦æ³¨æ„ï¼šç¬¬ä¸€ï¼š@propertyçš„ç›®çš„æ˜¯å°è£…ä¸€ä¸ªæ–¹æ³•ï¼Œæ˜¯è¿™ä¸ªæ–¹æ³•å¯ä»¥è¢«å½“åšå±æ€§è®¿é—®ç¬¬äºŒï¼šè°ƒç”¨çš„æ–¹å¼ä¸å‰é¢æœ‰æ‰€ä¸åŒï¼Œ__get__é‡Œé¢ä¸èƒ½å†å®šä¹‰wrapperäº†ï¼Œå¦åˆ™ä¸ä¼šè°ƒç”¨wrapperã€‚å¾—ä¸åˆ°æƒ³è¦çš„ç»“æœï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºè°ƒç”¨çš„æ–¹å¼ä¸ä¸€æ ·ï¼Œæ ¹æ®å‰é¢çš„åˆ†æï¼Œstudy_1çš„æœ¬è´¨æ˜¯æè¿°ç¬¦å±æ€§ï¼Œä½†æ˜¯å‰é¢çš„è°ƒç”¨å‡æ˜¯ä½¿ç”¨çš„Person.study_1()æˆ–è€…æ˜¯p.study_1()çš„å½¢å¼ï¼Œè¿˜æ˜¯å½“æˆæ–¹æ³•å»ä½¿ç”¨çš„ã€‚ä½†æ˜¯æ­¤å¤„ä¸ä¸€æ ·äº†ï¼Œç›´æ¥å°±æ˜¯å½“æˆå±æ€§å»ä½¿ç”¨ï¼Œp.study1 ï¼Œä¸å†æ˜¯æ–¹æ³•è°ƒç”¨ï¼Œå› æ­¤wrapperå‡½æ•°å¾—ä¸åˆ°è°ƒç”¨ã€‚æ‰€ä»¥\_get__æ–¹æ³•å¾—åˆ°äº†è¿›ä¸€æ­¥ç®€åŒ–ã€‚æŒ‰éœ€ç”Ÿæˆå±æ€§Python é­”æ³•æ–¹æ³•ï¼ˆä¸‰ï¼‰ __getattr__ï¼Œ__setattr__ï¼Œ __delattr__Pythoné«˜çº§ç”¨æ³•ä¹‹åŠ¨æ€å±æ€§ä½¿ç”¨__getattr__ã€__setattr__å’Œ__getattribute__æ¥åŠ¨æ€ç”Ÿæˆå±æ€§Python è¯­è¨€æä¾›äº†ä¸€äº›æŒ‚é’©ï¼Œä½¿å¾—å¼€å‘è€…å¾ˆå®¹æ˜“å°±èƒ½ç¼–å†™å‡ºé€šç”¨çš„ä»£ç ï¼Œä»¥ä¾¿å°†å¤šä¸ªç³»ç»Ÿé»åˆèµ·æ¥ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬è¦æŠŠæ•°æ®åº“çš„è¡Œï¼ˆrowï¼‰è¡¨ç¤ºä¸º Python å¯¹è±¡ã€‚ç”±äºæ•°æ®åº“æœ‰è‡ªå·±çš„ä¸€å¥—ç»“æ„ï¼ˆschemaï¼‰ï¼Œä¹Ÿç§°æ¶æ„ã€æ¨¡å¼ã€çº²è¦ã€æ¦‚è¦ã€å¤§çº²ï¼Œæ‰€ä»¥åœ¨æ“ä½œä¸è¡Œç›¸å¯¹åº”çš„å¯¹è±¡æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»çŸ¥é“è¿™ä¸ªæ•°æ®åº“çš„ç»“æ„ã€‚ç„¶è€Œï¼ŒæŠŠ Python å¯¹è±¡ä¸æ•°æ®åº“ç›¸è¿æ¥çš„è¿™äº›ä»£ç ï¼Œå´ä¸éœ€è¦çŸ¥é“è¡Œçš„ç»“æ„ï¼Œæ‰€ä»¥ï¼Œè¿™éƒ¨åˆ†ä»£ç åº”è¯¥å†™å¾—é€šç”¨ä¸€äº›ã€‚é‚£ä¹ˆï¼Œå¦‚ä½•å®ç°è¿™ç§é€šç”¨çš„ä»£ç å‘¢ï¼Ÿæ™®é€šçš„å®ä¾‹å±æ€§ã€@property æ–¹æ³•å’Œæè¿°ç¬¦ï¼Œéƒ½ä¸èƒ½å®Œæˆæ­¤åŠŸèƒ½ï¼Œå› ä¸ºå®ƒä»¬éƒ½å¿…é¡»é¢„å…ˆå®šä¹‰å¥½ï¼Œè€Œåƒè¿™æ ·çš„åŠ¨æ€è¡Œä¸ºï¼Œåˆ™å¯ä»¥é€šè¿‡ Python çš„__getattr__ç‰¹æ®Šæ–¹æ³•æ¥åšã€‚å¦‚æœæŸä¸ªç±»å®šä¹‰äº†__getattr__ï¼ŒåŒæ—¶ç³»ç»Ÿåœ¨è¯¥ç±»å¯¹è±¡çš„å®ä¾‹å­—å…¸ä¸­åˆæ‰¾ä¸åˆ°å¾…æŸ¥è¯¢çš„å±æ€§ï¼Œé‚£ä¹ˆï¼Œç³»ç»Ÿå°±ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚å®ä¾‹å±æ€§æŸ¥æ‰¾pythonå±æ€§æŸ¥æ‰¾ï¼ˆattribute lookupï¼‰é¦–å…ˆéœ€è¦æ˜ç™½çš„æ˜¯å®ä¾‹å±æ€§æŸ¥æ‰¾çš„è¿‡ç¨‹ï¼šå¦‚æœobjæ˜¯æŸä¸ªç±»çš„å®ä¾‹ï¼Œé‚£ä¹ˆobj.nameï¼ˆä»¥åŠç­‰ä»·çš„getattr(obj,â€™nameâ€™)ï¼‰é¦–å…ˆè°ƒç”¨__getattribute__ã€‚å¦‚æœç±»å®šä¹‰äº†__getattr__æ–¹æ³•ï¼Œé‚£ä¹ˆåœ¨__getattribute__æŠ›å‡º AttributeError çš„æ—¶å€™å°±ä¼šè°ƒç”¨åˆ°__getattr__ï¼Œè€Œå¯¹äºæè¿°ç¬¦(__get__ï¼‰çš„è°ƒç”¨ï¼Œåˆ™æ˜¯å‘ç”Ÿåœ¨__getattribute__å†…éƒ¨çš„ã€‚å®˜ç½‘æ–‡æ¡£æ˜¯è¿™ä¹ˆæè¿°çš„  The implementation works through a precedence chain that gives data descriptors priority over instance variables, instance variables priority over non-data descriptors, and assigns lowest priority to __getattr__() if provided.  obj = Clz(), é‚£ä¹ˆobj.attr é¡ºåºå¦‚ä¸‹ï¼šï¼ˆ1ï¼‰å¦‚æœâ€œattrâ€æ˜¯å‡ºç°åœ¨Clzæˆ–å…¶åŸºç±»çš„__dict__ä¸­ï¼Œ ä¸”attræ˜¯data descriptorï¼Œ é‚£ä¹ˆè°ƒç”¨å…¶__get__æ–¹æ³•, å¦åˆ™ï¼ˆ2ï¼‰å¦‚æœâ€œattrâ€å‡ºç°åœ¨objçš„__dict__ä¸­ï¼Œ é‚£ä¹ˆç›´æ¥è¿”å› obj.__dict__[â€˜attrâ€™]ï¼Œ å¦åˆ™ï¼ˆ3ï¼‰å¦‚æœâ€œattrâ€å‡ºç°åœ¨Clzæˆ–å…¶åŸºç±»çš„__dict__ä¸­ï¼ˆ3.1ï¼‰å¦‚æœattræ˜¯non-data descriptorï¼Œé‚£ä¹ˆè°ƒç”¨å…¶__get__æ–¹æ³•ï¼Œ å¦åˆ™ï¼ˆ3.2ï¼‰è¿”å› __dict__[â€˜attrâ€™]ï¼ˆ4ï¼‰å¦‚æœClzæœ‰__getattr__æ–¹æ³•ï¼Œè°ƒç”¨__getattr__æ–¹æ³•ï¼Œå¦åˆ™ï¼ˆ5ï¼‰æŠ›å‡ºAttributeErrorç¨‹åºæ¯æ¬¡è®¿é—®å¯¹è±¡çš„å±æ€§æ—¶ï¼ŒPython ç³»ç»Ÿéƒ½ä¼šè°ƒç”¨è¿™ä¸ªç‰¹æ®Šæ–¹æ³•ï¼Œå³ä½¿å±æ€§å­—å…¸é‡Œé¢å·²ç»æœ‰äº†è¯¥å±æ€§ï¼Œä¹Ÿä¾ç„¶ä¼šè§¦å‘ __getattribute__ æ–¹æ³•ã€‚è¿™æ ·å°±å¯ä»¥åœ¨ç¨‹åºæ¯æ¬¡è®¿é—®å±æ€§æ—¶ï¼Œæ£€æŸ¥å…¨å±€äº‹åŠ¡çŠ¶æ€ã€‚æŒ‰ç…§ Python å¤„ç†ç¼ºå¤±å±æ€§çš„æ ‡å‡†æµç¨‹ï¼Œå¦‚æœç¨‹åºåŠ¨æ€åœ°è®¿é—®äº†ä¸€ä¸ªä¸åº”è¯¥æœ‰çš„å±æ€§ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨ __getattr__ å’Œ __getattribute__ é‡Œé¢æŠ›å‡º AttributeError å¼‚å¸¸ã€‚å®ç°é€šç”¨çš„åŠŸèƒ½æ—¶ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šåœ¨ Python ä»£ç é‡Œä½¿ç”¨å†…ç½®çš„ hasattr å‡½æ•°æ¥åˆ¤æ–­å¯¹è±¡æ˜¯å¦å·²ç»æ‹¥æœ‰äº†ç›¸å…³çš„å±æ€§ï¼Œå¹¶ç”¨å†…ç½®çš„ __getattr__ å‡½æ•°æ¥è·å–å±æ€§å€¼ã€‚è¿™äº›å‡½æ•°ä¼šå…ˆåœ¨å®ä¾‹å­—å…¸ä¸­æœç´¢å¾…æŸ¥è¯¢çš„å±æ€§ï¼Œç„¶åå†è°ƒç”¨ __getattr__ã€‚å››ä¸ªé­”æ³•å‡½æ•°è®¿é—®æ—¶æœºå¦‚æœæŸä¸ªç±»å®šä¹‰äº†__getattr__ ï¼ŒåŒæ—¶ç³»ç»Ÿåœ¨è¯¥ç±»å¯¹è±¡çš„å®ä¾‹å­—å…¸ä¸­åˆæ‰¾ä¸åˆ°å¾…æŸ¥è¯¢çš„å±æ€§ï¼Œé‚£ä¹ˆï¼Œç³»ç»Ÿå°±ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚ç¨‹åºæ¯æ¬¡è®¿é—®å¯¹è±¡çš„å±æ€§æ—¶ï¼ŒPython ç³»ç»Ÿéƒ½ä¼šè°ƒç”¨è¿™ä¸ªç‰¹æ®Šæ–¹æ³•ï¼Œå³ä½¿å±æ€§å­—å…¸é‡Œé¢å·²ç»æœ‰äº†è¯¥å±æ€§ï¼Œä¹Ÿä¾ç„¶ä¼šè§¦å‘__getattribute__æ–¹æ³•ã€‚è¿™æ ·å°±å¯ä»¥åœ¨ç¨‹åºæ¯æ¬¡è®¿é—®å±æ€§æŒ‰ç…§Pythonå¤„ç†ç¼ºå¤±å±æ€§çš„æ ‡å‡†æµç¨‹ï¼Œå¦‚æœç¨‹åºåŠ¨æ€åœ°è®¿é—®äº†ä¸€ä¸ªä¸åº”è¯¥æœ‰çš„å±æ€§ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨__getattr__ å’Œ__getattribute__ é‡Œé¢æŠ›å‡ºAttributeErrorå¼‚å¸¸ã€‚åªè¦å¯¹å®ä¾‹çš„å±æ€§èµ‹å€¼ï¼Œæ— è®ºæ˜¯ç›´æ¥èµ‹å€¼ï¼Œè¿˜æ˜¯é€šè¿‡å†…ç½®çš„setattrå‡½æ•°èµ‹å€¼ï¼Œéƒ½ä¼šè§¦å‘__setattr__æ–¹æ³• ã€‚__getattr__å½“æˆ‘ä»¬è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„å±æ€§çš„æ—¶å€™ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œæç¤ºæˆ‘ä»¬ä¸å­˜åœ¨è¿™ä¸ªå±æ€§ã€‚è€Œè¿™ä¸ªå¼‚å¸¸å°±æ˜¯__getattr__æ–¹æ³•æŠ›å‡ºçš„ï¼Œå…¶åŸå› åœ¨äºä»–æ˜¯è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„å±æ€§çš„æœ€åè½è„šç‚¹ï¼Œä½œä¸ºå¼‚å¸¸æŠ›å‡ºçš„åœ°æ–¹æç¤ºå‡ºé”™å†é€‚åˆä¸è¿‡äº†ã€‚çœ‹ä¾‹å­ï¼Œæˆ‘ä»¬æ‰¾ä¸€ä¸ªå­˜åœ¨çš„å±æ€§å’Œä¸å­˜åœ¨çš„å±æ€§ã€‚1234567891011121314class A(object):    def __init__(self, value):        self.value = value     def __getattr__(self, item):        print &quot;into __getattr__&quot;        return  &quot;can not find&quot; a = A(10)print a.value# 10print a.name# into __getattr__# can not findå¯ä»¥çœ‹å‡ºï¼Œè®¿é—®å­˜åœ¨çš„å±æ€§æ—¶ï¼Œä¼šæ­£å¸¸è¿”å›å€¼ï¼Œè‹¥è¯¥å€¼ä¸å­˜åœ¨ï¼Œåˆ™ä¼šè¿›å…¥æœ€åçš„å…œåº•å‡½æ•°__getattr__ã€‚__setattr__åœ¨å¯¹ä¸€ä¸ªå±æ€§è®¾ç½®å€¼çš„æ—¶å€™ï¼Œä¼šè°ƒç”¨åˆ°è¿™ä¸ªå‡½æ•°ï¼Œæ¯ä¸ªè®¾ç½®å€¼çš„æ–¹å¼éƒ½ä¼šè¿›å…¥è¿™ä¸ªæ–¹æ³•ã€‚12345678910111213141516171819202122class A(object):    def __init__(self, value):        print &quot;into __init__&quot;        self.value = value     def __setattr__(self, name, value):        print &quot;into __setattr__&quot;        if value == 10:            print &quot;from __init__&quot;        object.__setattr__(self, name, value)  a = A(10)# into __init__# into __setattr__# from __init__print a.value# 10a.value = 100# into __setattr__print a.value# 100åœ¨å®ä¾‹åŒ–çš„æ—¶å€™ï¼Œä¼šè¿›è¡Œåˆå§‹åŒ–ï¼Œåœ¨__init__é‡Œï¼Œå¯¹valueçš„å±æ€§å€¼è¿›è¡Œäº†è®¾ç½®ï¼Œè¿™æ—¶å€™ä¼šè°ƒç”¨__setattr__æ–¹æ³•ã€‚åœ¨å¯¹a.valueé‡æ–°è®¾ç½®å€¼100çš„æ—¶å€™ï¼Œä¼šå†æ¬¡è¿›å…¥__setattr__æ–¹æ³•ã€‚éœ€è¦æ³¨æ„çš„åœ°æ–¹æ˜¯ï¼Œåœ¨é‡å†™__setattr__æ–¹æ³•çš„æ—¶å€™åƒä¸‡ä¸è¦é‡å¤è°ƒç”¨é€ æˆæ­»å¾ªç¯ã€‚123456class A(object):    def __init__(self, value):        self.value = value     def __setattr__(self, name, value):        self.name = valueè¿™æ˜¯ä¸ªæ­»å¾ªç¯ã€‚å½“æˆ‘ä»¬å®ä¾‹åŒ–è¿™ä¸ªç±»çš„æ—¶å€™ï¼Œä¼šè¿›å…¥__init__ï¼Œç„¶åå¯¹valueè¿›è¡Œè®¾ç½®å€¼ï¼Œè®¾ç½®å€¼ä¼šè¿›å…¥__setattr__æ–¹æ³•ï¼Œè€Œ__setattr__æ–¹æ³•é‡Œé¢åˆæœ‰ä¸€ä¸ªself.name=valueè®¾ç½®å€¼çš„æ“ä½œï¼Œä¼šå†æ¬¡è°ƒç”¨è‡ªèº«__setattr__ï¼Œé€ æˆæ­»å¾ªç¯ã€‚é™¤äº†ä¸Šé¢è°ƒç”¨objectç±»çš„__setattr__é¿å¼€æ­»å¾ªç¯ï¼Œè¿˜å¯ä»¥å¦‚ä¸‹é‡å†™__setattr__é¿å¼€å¾ªç¯ã€‚1234567891011class A(object):    def __init__(self, value):        self.value = value     def __setattr__(self, name, value):        self.__dict__[name] = value  a = A(10)print a.value# 10__delattr____delattr__æ˜¯ä¸ªåˆ é™¤å±æ€§çš„æ–¹æ³•123456789101112131415161718class A(object):    def __init__(self, value):        self.value = value     def __delattr__(self, item):        object.__delattr__(self, item)     def __getattr__(self, item):        return &quot;when can not find attribute into __getattr__&quot;   a = A(10)print a.value# 10del a.valueprint a.value# when can not find attribute into __getattr____delattr__ä¹Ÿè¦é¿å…æ­»å¾ªç¯çš„é—®é¢˜ï¼Œå°±å¦‚__setattr__ä¸€æ ·ï¼Œåœ¨é‡å†™__delattr__ï¼Œé¿å…é‡å¤è°ƒç”¨ã€‚__getattribute__ä½¿ç”¨__getattribute__å¯¹å±æ€§çš„è®¿é—®åšé¢å¤–å¤„ç†å‡è®¾æˆ‘ä»¬éœ€è¦åœ¨æ•°æ®åº“ä¸­å®ç°äº‹ç‰©ï¼ˆtransactionï¼‰å¤„ç†ï¼Œå³æ¯æ¬¡åœ¨è®¿é—®å±æ€§æ—¶ï¼Œéœ€è¦é¢å¤–è°ƒç”¨ç‰¹æ®Šæ–¹æ³•æ£€æŸ¥æ•°æ®åº“ä¸­å¯¹åº”çš„è¡Œæ˜¯å¦æœ‰æ•ˆï¼Œä»¥åŠç›¸å…³çš„äº‹åŠ¡æ˜¯å¦ä¾ç„¶å¼€æ”¾ã€‚æ­¤æ—¶ä½¿ç”¨__getattr__æ— æ³•å®ç°è¿™ç§åŠŸèƒ½ï¼Œå› ä¸ºç¬¬äºŒæ¬¡è®¿é—®å±æ€§æ—¶ï¼ŒPythonä¼šç›´æ¥è¿”å›ä¸Šé¦–æ¬¡è°ƒç”¨æ—¶å­˜å‚¨åœ¨__dict__ä¸­çš„å±æ€§å€¼ï¼Œè€Œä¸ä¼šå†æ¬¡è°ƒç”¨__getattr__æ’å¯»å±æ€§çš„çŠ¶æ€ã€‚æ­¤ç§æƒ…å†µä¸‹æˆ‘ä»¬éœ€è¦ä½¿ç”¨__getattribute__ï¼Œè¯¥æ–¹æ³•åœ¨ç”¨æˆ·æ¯æ¬¡è®¿é—®å±æ€§æ˜¯éƒ½ä¼šè¢«è°ƒç”¨ã€‚12345678910111213141516171819202122232425class LazyDB(object):    def __init__(self):        self.exist = 1     def __getattribute__(self, item):        print('__getattribute__ (%s) called' % item)        try:            return super().__getattribute__(item)        except AttributeError:            value = ' '.join(['default value: ', item])            setattr(self, item, value)            return value data = LazyDB()print(data.foo) ##æ¯æ¬¡è®¿é—®ç±»å±æ€§æ—¶éƒ½ä¼šè¢«è°ƒç”¨ï¼Œæ­¤å¤„æ˜¯ç¬¬1æ¬¡è°ƒç”¨print(data.foo) ##æ¯æ¬¡è®¿é—®ç±»å±æ€§æ—¶éƒ½ä¼šè¢«è°ƒç”¨ï¼Œæ­¤å¤„æ˜¯ç¬¬2æ¬¡è°ƒç”¨print(data.__dict__)  ##æ¯æ¬¡è®¿é—®ç±»å±æ€§æ—¶éƒ½ä¼šè¢«è°ƒç”¨ï¼Œæ­¤å¤„æ˜¯ç¬¬3æ¬¡å¾…ç”¨ ###è¾“å‡ºå¦‚ä¸‹ï¼š__getattribute__ (foo) calleddefault value:  foo__getattribute__ (foo) calleddefault value:  foo__getattribute__ (__dict__) called{'exist': 1, 'foo': 'default value:  foo'}è¦ç‚¹__getattr__ å’Œ __setatr__ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æƒ°æ€§çš„æ–¹å¼æ¥åŠ è½½å¹¶ä¿å­˜å¯¹è±¡çš„å±æ€§ã€‚è¦ç†è§£ __getattr__ ä¸ __getattribute__ çš„åŒºåˆ«ï¼šå‰è€…åªä¼šåœ¨å¾…è®¿é—®çš„å±æ€§ç¼ºå¤±æ—¶è§¦å‘ï¼Œè€Œåè€…åˆ™ä¼šåœ¨æ¯æ¬¡è®¿é—®å±æ€§æ—¶è§¦å‘ã€‚å¦‚æœè¦åœ¨ __getattribute__ å’Œ __setattr__ æ–¹æ³•ä¸­è®¿é—®å®ä¾‹å±æ€§ï¼Œé‚£ä¹ˆåº”è¯¥ç›´æ¥é€šè¿‡super()ï¼ˆä¹Ÿå°±æ˜¯objectç±»çš„åŒåæ–¹æ³•ï¼‰æ¥åšï¼Œä»¥é¿å…æ— é™é€’å½’ã€‚æ€»ç»“ï¼šï¼ˆ1ï¼‰å¯¹äºç±»è£…é¥°å™¨å±æ€§ï¼Œåªè¦å‡ºç°å±æ€§è®¿é—®ï¼ˆä¸ç®¡æ˜¯é€šè¿‡å¯¹è±¡è®¿é—®è¿˜æ˜¯ç±»åè®¿é—®ï¼‰ï¼Œéƒ½ä¼šä¼˜å…ˆè°ƒç”¨è£…é¥°å™¨çš„__get__æ–¹æ³•;ï¼ˆ2ï¼‰å¯¹äºç±»è£…é¥°å™¨å±æ€§ï¼Œè‹¥å‡ºç°å±æ€§ä¿®æ”¹ï¼ˆä¸ç®¡æ˜¯é€šè¿‡å¯¹è±¡è®¿é—®è¿˜æ˜¯ç±»åè®¿é—®ï¼‰ï¼Œéƒ½ä¼šä¼˜å…ˆè°ƒç”¨è£…é¥°å™¨çš„__set__æ–¹æ³•;ï¼ˆ3ï¼‰å¯¹äºç±»è£…é¥°å™¨å±æ€§ï¼Œè‹¥å‡ºç°å±æ€§åˆ é™¤ï¼ˆä¸ç®¡æ˜¯é€šè¿‡å¯¹è±¡è®¿é—®è¿˜æ˜¯ç±»åè®¿é—®ï¼‰ï¼Œéƒ½ä¼šä¼˜å…ˆè°ƒç”¨è£…é¥°å™¨çš„__delete__æ–¹æ³•ä¾‹å­å…ƒç±»ç¬¬33/34æ¡ç”¨å…ƒç±»æ ¸å®å’Œç™»è®°å­ç±»,3334,éªŒè¯,æ³¨å†ŒåŸºæœ¬æ¦‚å¿µç±»å…ƒç¼–ç¨‹æ˜¯æŒ‡åœ¨è¿è¡Œæ—¶åˆ›å»ºæˆ–å®šåˆ¶ç±»çš„æŠ€è‰ºã€‚åœ¨ Python ä¸­ï¼Œç±»æ˜¯ä¸€ç­‰å¯¹è±¡ï¼Œå› æ­¤ä»»ä½•æ—¶å€™éƒ½å¯ä»¥ä½¿ç”¨å‡½æ•°æ–°å»ºç±»ï¼Œè€Œæ— éœ€ä½¿ç”¨ class å…³é”®å­—ã€‚ç±»è£…é¥°å™¨ä¹Ÿæ˜¯å‡½æ•°ï¼Œä¸è¿‡èƒ½å¤Ÿå®¡æŸ¥ã€ä¿®æ”¹ï¼Œç”šè‡³æŠŠè¢«è£…é¥°çš„ç±»æ›¿æ¢æˆå…¶ä»–ç±»ã€‚æœ€åï¼Œå…ƒç±»æ˜¯ç±»å…ƒç¼–ç¨‹æœ€é«˜çº§çš„å·¥å…·ï¼šä½¿ç”¨å…ƒç±»å¯ä»¥åˆ›å»ºå…·æœ‰æŸç§ç‰¹è´¨çš„å…¨æ–°ç±»ç§ï¼Œä¾‹å¦‚æˆ‘ä»¬è§è¿‡çš„æŠ½è±¡åŸºç±»ã€‚å…ƒç±»çš„å®šä¹‰Pythonå®šä¹‰å…ƒç±»æ—¶ï¼Œéœ€è¦ä» typeç±»ä¸­ç»§æ‰¿ï¼Œç„¶åé‡å†™ __new__æ–¹æ³•ï¼Œä¾¿å¯ä»¥å®ç°æ„æƒ³ä¸åˆ°çš„åŠŸèƒ½ã€‚1234567891011121314class Meta(type):    def __new__(meta,name,bases,class_dict):        #...å„ç§é€»è¾‘å®ç°1        cls = type.__new__(meta,name,bases,class_dict)        print('å½“å‰ç±»å',name)        print('çˆ¶ç±»',bases)        print('å…¨éƒ¨ç±»å±æ€§',class_dict)        #...å„ç§é€»è¾‘å®ç°2        return clsclass MyClass(object,metaclass=Meta):    stuff = 33    def foo(self):        pass123å½“å‰ç±»å MyClassçˆ¶ç±» (&lt;class 'object'&gt;,)å…¨éƒ¨ç±»å±æ€§ {'__module__': '__main__', '__qualname__': 'MyClass', 'stuff': 33, 'foo': &lt;function MyClass.foo at 0x0000019E028315E8&gt;}å…ƒç±»å¯ä»¥è·çŸ¥é‚£ä¸ªç±»çš„åç§°ã€å…¶æ‰€ç»§æ‰¿çš„çˆ¶ç±»ï¼Œä»¥åŠå®šä¹‰åœ¨classè¯­å¥ä½“ä¸­çš„å…¨éƒ¨ç±»å±æ€§å…ƒç±»çš„æœ¬è´¨åœ¨Pythonå½“ä¸­ä¸‡ç‰©çš†å¯¹è±¡ï¼Œæˆ‘ä»¬ç”¨ classå…³é”®å­—å®šä¹‰çš„ç±»æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œ è´Ÿè´£äº§ç”Ÿè¯¥å¯¹è±¡çš„ç±»ç§°ä¹‹ä¸ºå…ƒç±» ï¼Œå…ƒç±»å¯ä»¥ç®€ç§°ä¸ºç±»çš„ç±»ï¼Œ å…ƒç±»çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†æ§åˆ¶ç±»çš„åˆ›å»ºè¡Œä¸º ã€‚typeæ˜¯Pythonçš„ä¸€ä¸ªå†…å»ºå…ƒç±»ï¼Œç”¨æ¥ç›´æ¥æ§åˆ¶ç”Ÿæˆç±»ï¼Œåœ¨Pythonä¸­ä»»ä½• classå®šä¹‰çš„ç±»å…¶å®éƒ½æ˜¯ typeç±»å®ä¾‹åŒ–çš„ç»“æœã€‚åªæœ‰ç»§æ‰¿äº† typeç±»æ‰èƒ½ç§°ä¹‹ä¸ºä¸€ä¸ªå…ƒç±»ï¼Œå¦åˆ™å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„è‡ªå®šä¹‰ç±»ï¼Œè‡ªå®šä¹‰å…ƒç±»å¯ä»¥æ§åˆ¶ç±»çš„äº§ç”Ÿè¿‡ç¨‹ï¼Œç±»çš„äº§ç”Ÿè¿‡ç¨‹å…¶å®å°±æ˜¯å…ƒç±»çš„è°ƒç”¨è¿‡ç¨‹ã€‚å°ç»“å…ƒç±»çš„å„ç§æ“ä½œå¯ä»¥å®ç°ç±»çš„éªŒè¯å’Œæ³¨å†Œé€»è¾‘ï¼Œå‡å¯ä»¥åœ¨å…ƒç±»çš„ __new__æ–¹æ³•ä¸­å®ç°ï¼Œä¸»è¦åŸå› æ˜¯å½“å­ç±»å¯¹è±¡æ„å»ºæ—¶ï¼Œä¼šå…ˆè°ƒç”¨å…ƒç±»çš„ __new__æ–¹æ³•ï¼Œäº§ç”Ÿä¸€ä¸ªç©ºå¯¹è±¡ï¼Œç„¶åå†è°ƒç”¨å­ç±»çš„ __init__æ–¹æ³•ç»™å¯¹è±¡å±æ€§è¿›è¡Œèµ‹å€¼ã€‚éªŒè¯å­ç±»å…ƒç±»æ˜¯pythonæ¯”è¾ƒé«˜çº§çš„ç”¨æ³•ï¼Œç®€è€Œè¨€ä¹‹ï¼Œå…ƒç±»å°±æ˜¯åˆ›å»ºç±»çš„ç±»ã€‚è€Œtypeå°±æ˜¯ä¸€ä¸ªå…ƒç±»ï¼Œæ˜¯ç”¨æ¥åˆ›å»ºç±»å¯¹è±¡çš„ç±»ã€‚å› æ­¤ï¼Œè¦å®šä¹‰å…ƒç±»å°±è¦ä½¿å…¶ç»§æ‰¿typeç±»ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œå¼€å‘è€…åœ¨ä½¿ç”¨OOPçš„æ–¹å¼ç¼–ç¨‹æ—¶ï¼Œå¾€å¾€ä¼šç”¨åˆ°__init__æ–¹æ³•ï¼Œå³æ„é€ å‡½æ•°ã€‚è¯¥æ–¹æ³•ä¼šåœ¨ç±»åˆå§‹åŒ–æ—¶è¿è¡Œã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥å°†éªŒè¯çš„æ—¶æœºæå‰ï¼Œä»¥è‡³äºæå‰åˆ°ç±»åˆ›å»ºä¹‹æ—¶ï¼Œå› æ­¤å°±ä¼šç”¨åˆ°__new__æ–¹æ³•ã€‚12345678910111213141516171819class Base(type):    def __new__(cls, name, param, dicts):        print(cls)        print(name)        print(param)        print(dicts)        return super().__new__(cls, name, param, dicts) class Meta(metaclass=Base):    name = 'yang'     def person(self):        passMeta() &lt;class '__main__.Base'&gt;Meta(){'__module__': '__main__', '__qualname__': 'Meta', 'name': 'yang', 'person': &lt;function Meta.person at 0x10c6492f0&gt;}å…ƒç±»ä¸­æ‰€ç¼–å†™çš„éªŒè¯é€»è¾‘ï¼Œé’ˆå¯¹çš„æ˜¯è¯¥åŸºç±»çš„å­ç±»ï¼Œè€Œä¸æ˜¯åŸºç±»æœ¬èº«ã€‚__new__()æ–¹æ³•æ¥æ”¶åˆ°çš„å‚æ•°ä¾æ¬¡æ˜¯ï¼šå½“å‰å‡†å¤‡åˆ›å»ºçš„ç±»çš„å¯¹è±¡ï¼›ç±»çš„åå­—ï¼›ç±»ç»§æ‰¿çš„çˆ¶ç±»é›†åˆï¼›ç±»çš„æ–¹æ³•é›†åˆã€‚æ¡ˆä¾‹1 ï¼šç¼–å†™ä¸€ä¸ªå¤šè¾¹å½¢ç±»ï¼Œå½“è¾¹æ•°å°äº 3æ—¶ï¼Œå…¶ç±»æŠ¥é”™ï¼Œå®ç°å…¶éªŒè¯é€»è¾‘ã€‚123456789101112131415161718192021class ValidatePolygon(type):    ## __new__å½“ä¸­æ”¾å…¥éªŒè¯é€»è¾‘    def __new__(meta,name,bases,class_dict):        if bases!=(object,): ##é’ˆå¯¹å­ç±»è€Œä¸å¯¹åŸºç±»            if class_dict['sides'] &lt; 3:                raise ValueError('Polygons need 3+ sides')        return type.__new__(meta,name,bases,class_dict)        class Polygons(object,metaclass=ValidatePolygon):    sides = None        @classmethod    def interior_angles(cls):        return (cls.sides - 2) * 180        class Triangle(Polygons):    sides = 3    ### ç±»è®¾è®¡æŠ¥é”™ã€‚class Line(Polygons):    sides = 1æ³¨å†Œå­ç±»å…ƒç±»è¿˜æœ‰ä¸€ä¸ªç”¨é€”ï¼Œå°±æ˜¯åœ¨ç¨‹åºä¸­ è‡ªåŠ¨æ³¨å†Œç±»å‹ã€‚å¼€å‘è€…æ¯æ¬¡ä»åŸºç±»ä¸­ç»§æ‰¿å­ç±»æ—¶ï¼ŒåŸºç±»çš„å…ƒç±»éƒ½å¯ä»¥è‡ªåŠ¨è¿è¡Œæ³¨å†Œä»£ç ã€‚æ¡ˆä¾‹2 ï¼šå®ç°å¯¹è±¡çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–1234567891011121314151617181920212223242526272829###å»ºç«‹ç±»åä¸è¯¥ç±»å¯¹è±¡çš„æ˜ å°„å…³ç³»ï¼Œç»´æŠ¤registryå­—å…¸ã€‚registry = {}def register_class(target_class):    registry[target_class.__name__] = target_classdef deserialize(data):    params = json.loads(data)    name = params['class']    target_class = registry[name]    return target_classclass Meta(type):    def __new__(meta,name,bases,class_dict):        cls = type.__new__(meta,name,bases,class_dict)        register_class(cls) ##æ³¨å†Œå­ç±»        return clsclass BetterSerializable(object):    def __init__(self,*args):        self.args = args        def serialize(self):        return json.dumps({'class':self.__class__.__name__,            'args':self.args,})    def __repr__(self):        passclass RegisterSerializabel(BetterSerializable,metaclass=Meta):    passé€šè¿‡å…ƒç±»æ¥å®ç°ç±»çš„æ³¨å†Œï¼Œå¯ä»¥ç¡®ä¿æ‰€æœ‰çš„å­ç±»éƒ½ä¸ä¼šé—æ¼ï¼Œä»è€Œé¿å…åç»­çš„é”™è¯¯ã€‚è·å–__init__çš„é»˜è®¤å‚æ•°è·å–__init__çš„é»˜è®¤å‚æ•°ï¼Œå¹¶åœ¨classmethodæ–¹æ³•ä¸­ä¸ºæ²¡æœ‰ç»™å®šçš„å±æ€§èµ‹é»˜è®¤å€¼ï¼Œæå‡ä»£ç çš„å¥å£®æ€§å…ƒç±»å®šä¹‰ï¼š1234567891011121314151617181920212223242526#!/usr/bin/env Python# -- coding: utf-8 --&quot;&quot;&quot;@version: v0.1@author: narutohyc@file: meta_interface.py@Description: @time: 2020/6/15 20:29&quot;&quot;&quot;import collectionsfrom abc import (ABC,                 abstractmethod,                 ABCMeta)import inspectclass DicMetaClass(ABCMeta):    def __new__(cls, name, bases, attrs, **kwargs):        if name == 'DicMeta':            return super().__new__(cls, name, bases, attrs, **kwargs)        # è·å–__init__å‡½æ•°çš„ é»˜è®¤å€¼        argspec = inspect.getfullargspec(attrs[&quot;__init__&quot;])        init_defaults = dict(zip(argspec.args[-len(argspec.defaults):], argspec.defaults))        cls.__init_defaults = init_defaults        attrs['__init_defaults__'] = init_defaults        return super().__new__(cls, name, bases, attrs, **kwargs)æŠ½è±¡çˆ¶ç±»ï¼š1234567891011121314151617181920212223242526272829303132333435#!/usr/bin/env Python# -- coding: utf-8 --&quot;&quot;&quot;@version: v0.1@author: narutohyc@file: meta_interface.py@Description: @time: 2020/6/15 20:29&quot;&quot;&quot;from abc import (ABC,                 abstractmethod,                 ABCMeta)class DicMeta(ABC, metaclass=DicMetaClass):    def __init__(self):        pass    @abstractmethod    def to_dict(self):        '''        è¿”å›å­—å…¸        '''        pass    @classmethod    def load_from_mapping(cls, mapping_datas):        '''        ç”¨å­—å…¸æ¥æ„å»ºå®ä¾‹å¯¹è±¡        '''        assert isinstance(mapping_datas, collections.abc.Mapping)        obj = cls.__new__(cls)        [setattr(obj, k, v) for k, v in mapping_datas.items()]        return objå­ç±»å®ç°ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263#!/usr/bin/env Python# -- coding: utf-8 --&quot;&quot;&quot;@version: v0.1@author: narutohyc@file: text_meta.py@Description: @time: 2020/5/22 14:55&quot;&quot;&quot;from augmentation.meta_class.meta_interface import DicMetafrom utils.utils_func import gen_md5, str2boolimport reclass TaskMeta(DicMeta):    '''    æ•°æ®åŒ…è£…ç±»çš„beanç»“æ„    '''    def __init__(self, text, doc_id, sentence_id, reg_lst,                 has_reg=True,                 flag=None,                 dataset='train',                 text_source=&quot;primitive&quot;):        super(TaskMeta, self).__init__()        self.text = text        self.doc_id = doc_id        self.sentence_id = sentence_id        if reg_lst and isinstance(reg_lst[0], list):            reg_lst = ['%s %s %s' % (tag, start_idx, value) for tag, start_idx, value in reg_lst]        self.reg_lst = sorted(reg_lst, key=lambda reg: int(re.sub(' +', ' ', reg).split(&quot; &quot;, 2)[1])) if reg_lst else []        self.flag = list(set(i.split(' ', 2)[0] for i in self.reg_lst)) if flag is None else flag        self.has_reg = str2bool(has_reg)        self.dataset = dataset        self.text_source = text_source        self._id = gen_md5(self.text)    @classmethod    def load_from_mapping(cls, mapping_datas):        '''        ç”¨å­—å…¸æ¥æ„å»º TaskMetaå®ä¾‹        '''        obj = super(TaskMeta, cls).load_from_mapping(mapping_datas)        obj._id = gen_md5(obj.text)        [setattr(obj, k, v) for k, v in obj.__init_defaults__.items() if not hasattr(obj, k)]        if obj.flag is None:            obj.flag = list(set(i.split(' ', 2)[0] for i in obj.reg_lst))        obj.has_reg = str2bool(obj.has_reg)        return obj        @property    def to_dict(self):        '''        å½“è¯¥ç±»æ²¡æœ‰å…¶ä»–å¤šä½™å±æ€§æ—¶  å¯ä»¥ç›´æ¥è¿”å›self.__dict__çš„å‰¯æœ¬        '''        return {&quot;text&quot;: self.text,                &quot;doc_id&quot;: self.doc_id,                &quot;sentence_id&quot;: self.sentence_id,                &quot;reg_lst&quot;: self.reg_lst,                &quot;flag&quot;: list(self.flag),                &quot;has_reg&quot;: self.has_reg,                &quot;dataset&quot;: self.dataset,                &quot;text_source&quot;: self.text_source,                &quot;_id&quot;: self._id}    æµ‹è¯•ç±»ï¼š12345678910task_meta_0 = TaskMeta.load_from_mapping({'text': 'æ–¯å¦ç¦å¤§å­¦å¼€å‘çš„åŸºäºæ¡ä»¶éšæœºåœºçš„å‘½åå®ä½“è¯†åˆ«ç³»ç»Ÿï¼Œè¯¥ç³»ç»Ÿå‚æ•°æ˜¯åŸºäºCoNLLã€MUC-6ã€MUC-7å’ŒACEå‘½åå®ä½“è¯­æ–™è®­ç»ƒå‡ºæ¥çš„ã€‚',                                           'doc_id': 'id1', 'sentence_id': 'id1',                                           'reg_lst': ['å­¦æ ¡ 0 æ–¯å¦ç¦å¤§å­¦', 'æ ‡æ³¨ 33 CoNLL', 'æ ‡æ³¨ 39 MUC-6', 'æ ‡æ³¨ 45 MUC-7', 'æ ‡æ³¨ 51 ACE']})task_meta_1 = TaskMeta.load_from_mapping({'text': 'æ–¯å¦ç¦å¤§å­¦å¼€å‘çš„åŸºäºæ¡ä»¶éšæœºåœºçš„å‘½åå®ä½“è¯†åˆ«ç³»ç»Ÿï¼Œè¯¥ç³»ç»Ÿå‚æ•°æ˜¯åŸºäºCoNLLã€MUC-6ã€MUC-7å’ŒACEå‘½åå®ä½“è¯­æ–™è®­ç»ƒå‡ºæ¥çš„ã€‚',                                           'doc_id': 'id1', 'sentence_id': 'id1',                                           'reg_lst': ['å­¦æ ¡ 0 æ–¯å¦ç¦å¤§å­¦', 'æ ‡æ³¨ 33 CoNLL', 'æ ‡æ³¨ 39 MUC-6', 'æ ‡æ³¨ 45 MUC-7', 'æ ‡æ³¨ 51 ACE'],                                           'flag': ['å­¦æ ¡', 'æ ‡æ³¨'], 'has_reg': True,                                           'dataset': 'train', 'text_source': 'primitive', '_id': '3b895befc659345be8686bd7de4d7693'})task_meta_0.to_dict == task_meta_1.to_dictOut[33]: Trueå¯ä»¥çœ‹å‡ºï¼Œtaskmeta_0å’Œtask_meta_1ä¸¤è€…çš„ å€¼æ˜¯å®Œå…¨ç›¸åŒçš„ï¼Œè¿™é‡Œå°±å¯ä»¥åšåˆ°å…±äº«\_init__é»˜è®¤å‚æ•°çš„æ•ˆæœæ³¨è§£ç±»çš„å±æ€§å…ƒç±»è¿˜æœ‰ä¸€ä¸ªæ›´æœ‰ç”¨å¤„çš„åŠŸèƒ½ï¼Œé‚£å°±æ˜¯å¯ä»¥åœ¨æŸä¸ªç±»åˆšå®šä¹‰å¥½ä½†æ˜¯å°šæœªä½¿ç”¨çš„æ—¶å€™ï¼Œæå‰ä¿®æ”¹æˆ–æ³¨è§£è¯¥ç±»çš„å±æ€§ã€‚è¿™ç§å†™æ³•é€šå¸¸ä¼šä¸æè¿°ç¬¦(descriptor) æ­é…èµ·æ¥(å‚è§æœ¬ä¹¦ç¬¬31æ¡)ï¼Œä»¤è¿™äº›å±æ€§å¯ä»¥æ›´åŠ è¯¦ç»†åœ°äº†è§£è‡ªå·±åœ¨å¤–å›´ç±»ä¸­çš„ä½¿ç”¨æ–¹å¼ã€‚ä¾‹å¦‚ï¼Œè¦å®šä¹‰æ–°çš„ç±»ï¼Œç”¨æ¥è¡¨ç¤ºå®¢æˆ·æ•°æ®åº“é‡Œçš„æŸ- -è¡Œã€‚åŒæ—¶ï¼Œæˆ‘ä»¬è¿˜å¸Œæœ›åœ¨è¯¥ç±»çš„ç›¸å…³å±æ€§ä¸æ•°æ®åº“è¡¨çš„æ¯ä¸€åˆ—ä¹‹é—´ï¼Œ å»ºç«‹å¯¹åº”å…³ç³»ã€‚äºæ˜¯ï¼Œç”¨ä¸‹é¢è¿™ä¸ªæè¿°ç¬¦ç±»ï¼ŒæŠŠå±æ€§ä¸åˆ—åè”ç³»èµ·æ¥ã€‚123456789101112class Field:       def __init__(self, name):           self.name = name           self.internal_name = '_' + self.name       def __get__(self, instance, owner):           if instance is None:               return self           return getattr(instance, self.internal_name, '')       def __set__(self, instance, value):           setattr(instance, self.internal_name, value)ç”±äºåˆ—çš„åç§°å·²ç»ä¿å­˜åˆ°äº†Fieldæè¿°ç¬¦ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡å†…ç½®çš„setattrå’Œgetattrå‡½æ•°ï¼ŒæŠŠæ¯ä¸ªå®ä¾‹çš„æ‰€æœ‰çŠ¶æ€éƒ½ä½œä¸ºprotectedå­—æ®µï¼Œå­˜æ”¾åœ¨è¯¥å®ä¾‹çš„å­—å…¸é‡Œé¢ã€‚åœ¨æœ¬ä¹¦å‰é¢çš„ä¾‹å­ä¸­ï¼Œä¸ºäº†é¿å…å†…å­˜æ³„æ¼ï¼Œæˆ‘ä»¬æ›¾ç»ç”¨weakrefå­—å…¸æ¥æ„å»ºæè¿°ç¬¦ï¼Œè€Œåˆšæ‰çš„é‚£æ®µä»£ç ï¼Œç›®å‰çœ‹æ¥ï¼Œä¼¼ä¹è¦æ¯”weakrefæ–¹æ¡ˆä¾¿æ·å¾—å¤šã€‚æ¥ä¸‹æ¥å®šä¹‰è¡¨ç¤ºæ•°æ®è¡Œçš„Customerç±»ï¼Œå®šä¹‰è¯¥ç±»çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¦ä¸ºæ¯ä¸ªç±»å±æ€§æŒ‡å®šå¯¹åº”çš„åˆ—åã€‚12345class Customer:       first_name = Field('first_name')       last_name = Field('last_name')       prefix = Field('prefix')       suffix = Field('suffix')é—®é¢˜åœ¨äºï¼Œä¸Šé¢è¿™ç§å†™æ³•æ˜¾å¾—æœ‰äº›é‡å¤ã€‚åœ¨Customerç±»çš„classè¯­å¥ä½“ä¸­ï¼Œæˆ‘ä»¬æ—¢ç„¶è¦å°†æ„å»ºå¥½çš„Fieldå¯¹è±¡èµ‹ç»™Customer.first name, é‚£ä¸ºä»€ä¹ˆè¿˜è¦æŠŠè¿™ä¸ªå­—æ®µå(æœ¬ä¾‹ä¸­æ˜¯â€™first nameâ€™) å†ä¼ ç»™Fieldçš„æ„é€ å™¨å‘¢?ä¹‹æ‰€ä»¥è¿˜è¦æŠŠå­—æ®µåä¼ ç»™Fieldæ„é€ å™¨ï¼Œæ˜¯å› ä¸ºå®šä¹‰Customerç±»çš„æ—¶å€™ï¼ŒPython ä¼šä»¥ä»å³å‘å·¦çš„é¡ºåºè§£è¯»èµ‹å€¼è¯­å¥ï¼Œè¿™ä¸ä»å·¦è‡³å³çš„é˜…è¯»é¡ºåºæ°å¥½ç›¸åã€‚é¦–å…ˆï¼ŒPython ä¼šä»¥Field(first nameâ€™) çš„å½¢å¼æ¥è°ƒç”¨Field æ„é€ å™¨ï¼Œç„¶åï¼Œå®ƒæŠŠè°ƒç”¨æ„é€ å™¨æ‰€å¾—çš„è¿”å›å€¼ï¼Œèµ‹ç»™Customer.field nameã€‚ ä»è¿™ä¸ªé¡ºåºæ¥çœ‹ï¼ŒField å¯¹è±¡æ²¡æœ‰åŠæ³•æå‰çŸ¥é“è‡ªå·±ä¼šèµ‹ç»™Customerç±»é‡Œçš„å“ªä¸€ä¸ªå±æ€§ã€‚    ä¸ºäº†æ¶ˆé™¤è¿™ç§é‡å¤ä»£ç ï¼Œæˆ‘ä»¬ç°åœ¨ç”¨å…ƒç±»æ¥æ”¹å†™å®ƒã€‚ä½¿ç”¨å…ƒç±»ï¼Œå°±ç›¸å½“äºç›´æ¥åœ¨classè¯­å¥ä¸Šé¢æ”¾ç½®æŒ‚é’©ï¼Œåªè¦classè¯­å¥ä½“å¤„ç†å®Œæ¯•ï¼Œè¿™ä¸ªæŒ‚é’©å°±ä¼šç«‹åˆ»è§¦å‘ã€‚äºæ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ©å…ƒç±»ï¼Œä¸ºFieldæè¿°ç¬¦è‡ªåŠ¨è®¾ç½®å…¶Field.nameå’ŒField.internal_ name, è€Œä¸ç”¨å†åƒåˆšæ‰é‚£æ ·ï¼ŒæŠŠåˆ—çš„åç§°æ‰‹å·¥ä¼ ç»™Field æ„é€ å™¨ã€‚12345678class Meta(type):       def __new__(meta, name, bases, class_dict):           for key, value in class_dict.items():               if isinstance(value, Field):                   value.name = key                   value.internal_name = '_' + key           cls = type.__new__(meta, name, bases, class_dict)           return clsä¸‹é¢å®šä¹‰ä¸€ä¸€ä¸ªåŸºç±»ï¼Œè¯¥åŸºç±»ä½¿ç”¨åˆšæ‰å®šä¹‰å¥½çš„Metaä½œä¸ºå…¶å…ƒç±»ã€‚å‡¡æ˜¯ä»£è¡¨æ•°æ®åº“é‡Œé¢æŸä¸€è¡Œçš„ç±»ï¼Œéƒ½åº”è¯¥ä»è¿™ä¸ªåŸºç±»ä¸­ç»§æ‰¿ï¼Œä»¥ç¡®ä¿å®ƒä»¬èƒ½å¤Ÿåˆ©ç”¨å…ƒç±»æ‰€æä¾›çš„åŠŸèƒ½:12class DatabaseRow(object, metaclass=Meta):passé‡‡ç”¨å…ƒç±»æ¥å®ç°è¿™å¥—æ–¹æ¡ˆæ—¶ï¼ŒField æè¿°ç¬¦ç±»åŸºæœ¬ä¸Šæ˜¯æ— éœ€ä¿®æ”¹çš„ã€‚å”¯ä¸€ è¦è°ƒæ•´çš„åœ°æ–¹å°±åœ¨äº:ç°åœ¨ä¸éœ€è¦å†ç»™æ„é€ å™¨ä¼ äººå‚æ•°äº†ï¼Œå› ä¸ºåˆšæ‰ç¼–å†™çš„Meta.__new__ æ–¹æ³•ä¼šè‡ªåŠ¨æŠŠç›¸å…³çš„å±æ€§è®¾ç½®å¥½ã€‚1234class Field:       def __init__(self):           self.name = None           self.internal_name = Noneæœ‰äº†å…ƒç±»ã€æ–°çš„DatabaseRowåŸºç±»ä»¥åŠæ–°çš„Fieldæè¿°ç¬¦ä¹‹åï¼Œæˆ‘ä»¬åœ¨ä¸ºæ•°æ®è¡Œå®šä¹‰DatabaseRowå­ç±»æ—¶ï¼Œå°±ä¸ç”¨å†åƒåŸæ¥é‚£æ ·ï¼Œç¼–å†™é‡å¤çš„ä»£ç äº†ã€‚12345class BetterCustomer(DatabaseRow):       first_name = Field()       last_name = Field()       prefix = Field()       suffix = Field()ORMä¾‹å­ORM æ˜¯ pythonç¼–ç¨‹è¯­è¨€åç«¯webæ¡†æ¶ Djangoçš„æ ¸å¿ƒæ€æƒ³ï¼Œâ€œObject Relational Mappingâ€ï¼Œå³å¯¹è±¡-å…³ç³»æ˜ å°„ï¼Œç®€ç§°ORMã€‚ä¸€ä¸ªå¥è¯ç†è§£å°±æ˜¯ï¼šåˆ›å»ºä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼Œç”¨åˆ›å»ºå®ƒçš„ç±»åå½“åšæ•°æ®è¡¨åï¼Œç”¨åˆ›å»ºå®ƒçš„ç±»å±æ€§å¯¹åº”æ•°æ®è¡¨çš„å­—æ®µï¼Œå½“å¯¹è¿™ä¸ªå®ä¾‹å¯¹è±¡æ“ä½œæ—¶ï¼Œèƒ½å¤Ÿå¯¹åº”MySQLè¯­å¥ ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142class ModelMetaclass(type):    def __new__(cls, name, bases, attrs):        mappings = dict()        for k, v in attrs.items():            if isinstance(v, tuple):                print('Found mapping :%s ==&gt; %s' % (k, v))                mappings[k] = v        for k in mappings.keys():            attrs.pop(k)        attrs['__mappings__'] = mappings        attrs['__table__'] = name        return type.__new__(cls, name, bases, attrs)class Model(object, metaclass=ModelMetaclass):    def __init__(self, **kwargs):        for name, value in kwargs.items():            setattr(self, name, value)    def save(self):        fields, args = [], []        for k, v in self.__mappings__.items():            fields.append(v[0])            args.append(getattr(self, k, None))        args_temp = list()        for temp in args:            if isinstance(temp, int):                args_temp.append(str(temp))            elif isinstance(temp, str):                args_temp.append(&quot;&quot;&quot;'%s'&quot;&quot;&quot; % temp)        sql = 'insert into %s (%s) values (%s)' % (self.__table__, ','.join(fields), ','.join(args_temp))        print(sql)class User(Model):    uid = ('uid', 'int unsigned')    name = ('username', 'varchar(30)')    email = ('email', 'varchar(30)')    password = ('password', 'varchar(30)')user = User(uid=1234, name='naruto', email='1832044042@qq.mail', password='hycpass')user.save()è¾“å‡º12345Found mapping :uid ==&gt; ('uid', 'int unsigned')Found mapping :name ==&gt; ('username', 'varchar(30)')Found mapping :email ==&gt; ('email', 'varchar(30)')Found mapping :password ==&gt; ('password', 'varchar(30)')insert into User (uid,username,email,password) values (1234,'naruto','1832044042@qq.mail','hycpass')è¦ç‚¹å€ŸåŠ©å…ƒç±»ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æŸä¸ªç±»å®Œå…¨å®šä¹‰å¥½ä¹‹å‰ï¼Œç‡å…ˆä¿®æ”¹è¯¥ç±»çš„å±æ€§ã€‚æè¿°ç¬¦ä¸å…ƒç±»èƒ½å¤Ÿæœ‰æ•ˆåœ°ç»„åˆèµ·æ¥ï¼Œä»¥ä¾¿å¯¹æŸç§è¡Œä¸ºåšå‡ºä¿®é¥°ï¼Œæˆ–åœ¨ç¨‹åºè¿è¡Œæ—¶æ¢æŸ¥ç›¸å…³ä¿¡æ¯ã€‚å¦‚æœæŠŠå…ƒç±»ä¸æè¿°ç¬¦ç›¸ç»“åˆï¼Œé‚£å°±å¯ä»¥åœ¨ä¸ä½¿ç”¨weakrefæ¨¡å—çš„å‰æä¸‹é¿å…å†…å­˜æ³„æ¼ã€‚</content>
	</entry>
	<entry>
		<title>å¤šçº¿ç¨‹_åŸºç¡€ç¯‡</title>
		<url>/article/9f4ad441.html</url>
		<content>åŸºç¡€ç¯‡1231. Javaå¤šçº¿ç¨‹ç³»åˆ—ç›®å½•(å…±43ç¯‡)-è½¬https://www.jianshu.com/p/dca27f047923https://www.cnblogs.com/skywang12345/p/java_threads_category.htmlçº¿ç¨‹å…±åŒ…æ‹¬ä»¥ä¸‹5ç§çŠ¶æ€ï¼šæ–°å»ºçŠ¶æ€(New) : çº¿ç¨‹å¯¹è±¡è¢«åˆ›å»ºåï¼Œå°±è¿›å…¥äº†æ–°å»ºçŠ¶æ€ã€‚ä¾‹å¦‚ï¼ŒThread thread = new Thread()ã€‚å°±ç»ªçŠ¶æ€(Runnable): ä¹Ÿè¢«ç§°ä¸ºâ€œå¯æ‰§è¡ŒçŠ¶æ€â€ã€‚çº¿ç¨‹å¯¹è±¡è¢«åˆ›å»ºåï¼Œå…¶å®ƒçº¿ç¨‹è°ƒç”¨äº†è¯¥å¯¹è±¡çš„start()æ–¹æ³•ï¼Œä»è€Œæ¥å¯åŠ¨è¯¥çº¿ç¨‹ã€‚ä¾‹å¦‚ï¼Œthread.start()ã€‚å¤„äºå°±ç»ªçŠ¶æ€çš„çº¿ç¨‹ï¼Œéšæ—¶å¯èƒ½è¢«CPUè°ƒåº¦æ‰§è¡Œã€‚è¿è¡ŒçŠ¶æ€(Running): çº¿ç¨‹è·å–CPUæƒé™è¿›è¡Œæ‰§è¡Œã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œçº¿ç¨‹åªèƒ½ä»å°±ç»ªçŠ¶æ€è¿›å…¥åˆ°è¿è¡ŒçŠ¶æ€ã€‚é˜»å¡çŠ¶æ€(Blocked) : é˜»å¡çŠ¶æ€æ˜¯çº¿ç¨‹å› ä¸ºæŸç§åŸå› æ”¾å¼ƒCPUä½¿ç”¨æƒï¼Œæš‚æ—¶åœæ­¢è¿è¡Œã€‚ç›´åˆ°çº¿ç¨‹è¿›å…¥å°±ç»ªçŠ¶æ€ï¼Œæ‰æœ‰æœºä¼šè½¬åˆ°è¿è¡ŒçŠ¶æ€ã€‚é˜»å¡çš„æƒ…å†µåˆ†ä¸‰ç§ï¼š(01) ç­‰å¾…é˜»å¡ â€” é€šè¿‡è°ƒç”¨çº¿ç¨‹çš„wait()æ–¹æ³•ï¼Œè®©çº¿ç¨‹ç­‰å¾…æŸå·¥ä½œçš„å®Œæˆã€‚(02) åŒæ­¥é˜»å¡ â€” çº¿ç¨‹åœ¨è·å–synchronizedåŒæ­¥é”å¤±è´¥(å› ä¸ºé”è¢«å…¶å®ƒçº¿ç¨‹æ‰€å ç”¨)ï¼Œå®ƒä¼šè¿›å…¥åŒæ­¥é˜»å¡çŠ¶æ€ã€‚(03) å…¶ä»–é˜»å¡ â€” é€šè¿‡è°ƒç”¨çº¿ç¨‹çš„sleep()æˆ–join()æˆ–å‘å‡ºäº†I/Oè¯·æ±‚æ—¶ï¼Œçº¿ç¨‹ä¼šè¿›å…¥åˆ°é˜»å¡çŠ¶æ€ã€‚å½“sleep()çŠ¶æ€è¶…æ—¶ã€join()ç­‰å¾…çº¿ç¨‹ç»ˆæ­¢æˆ–è€…è¶…æ—¶ã€æˆ–è€…I/Oå¤„ç†å®Œæ¯•æ—¶ï¼Œçº¿ç¨‹é‡æ–°è½¬å…¥å°±ç»ªçŠ¶æ€ã€‚æ­»äº¡çŠ¶æ€(Dead) : çº¿ç¨‹æ‰§è¡Œå®Œäº†æˆ–è€…å› å¼‚å¸¸é€€å‡ºäº†run()æ–¹æ³•ï¼Œè¯¥çº¿ç¨‹ç»“æŸç”Ÿå‘½å‘¨æœŸã€‚æ‰©å±•ï¼šObjectç±»ï¼Œå®šä¹‰äº†wait(), notify(), notifyAll()ç­‰ä¼‘çœ /å”¤é†’å‡½æ•°ã€‚Threadç±»ï¼Œçº¿ç¨‹æ“ä½œå‡½æ•°ã€‚ä¾‹å¦‚sleep()ä¼‘çœ å‡½æ•°, interrupt()ä¸­æ–­å‡½æ•°, getName()è·å–çº¿ç¨‹åç§°ç­‰ã€‚synchronizedå…³é”®å­—ï¼ŒåŒºåˆ†ä¸ºsynchronizedä»£ç å—å’Œsynchronizedæ–¹æ³•ï¼Œè®©çº¿ç¨‹è·å–å¯¹è±¡çš„åŒæ­¥é”ã€‚å®ç°å¤šçº¿ç¨‹çš„ä¸¤ç§æ–¹å¼ 1231. Runnable æ˜¯ä¸€ä¸ªæ¥å£ï¼Œè¯¥æ¥å£ä¸­åªåŒ…å«äº†ä¸€ä¸ªrun()æ–¹æ³•ã€‚   Runnableçš„ä½œç”¨ï¼Œå®ç°å¤šçº¿ç¨‹ã€‚æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªç±»Aå®ç°Runnableæ¥å£ï¼›ç„¶åï¼Œé€šè¿‡new Thread(new A())ç­‰æ–¹å¼æ–°å»ºçº¿ç¨‹ã€‚2. Thread æ˜¯ä¸€ä¸ªç±»ã€‚Threadæœ¬èº«å°±å®ç°äº†Runnableæ¥å£ã€‚Threadçš„ä½œç”¨ï¼Œå®ç°å¤šçº¿ç¨‹ã€‚Threadå’ŒRunnableçš„å¼‚åŒç‚¹1234Thread å’Œ Runnable çš„ç›¸åŒç‚¹ï¼šéƒ½æ˜¯â€œå¤šçº¿ç¨‹çš„å®ç°æ–¹å¼â€ã€‚Thread å’Œ Runnable çš„ä¸åŒç‚¹ï¼šThread æ˜¯ç±»ï¼Œè€ŒRunnableæ˜¯æ¥å£ï¼›Threadæœ¬èº«æ˜¯å®ç°äº†Runnableæ¥å£çš„ç±»ã€‚æˆ‘ä»¬çŸ¥é“â€œä¸€ä¸ªç±»åªèƒ½æœ‰ä¸€ä¸ªçˆ¶ç±»ï¼Œä½†æ˜¯å´èƒ½å®ç°å¤šä¸ªæ¥å£â€ï¼Œå› æ­¤Runnableå…·æœ‰æ›´å¥½çš„æ‰©å±•æ€§ã€‚æ­¤å¤–ï¼ŒRunnableè¿˜å¯ä»¥ç”¨äºâ€œèµ„æºçš„å…±äº«â€ã€‚å³ï¼Œå¤šä¸ªçº¿ç¨‹éƒ½æ˜¯åŸºäºæŸä¸€ä¸ªRunnableå¯¹è±¡å»ºç«‹çš„ï¼Œå®ƒä»¬ä¼šå…±äº«Runnableå¯¹è±¡ä¸Šçš„èµ„æºã€‚//é€šå¸¸ï¼Œå»ºè®®é€šè¿‡â€œRunnableâ€å®ç°å¤šçº¿ç¨‹ï¼Runnableçš„å¤šçº¿ç¨‹ç¤ºä¾‹123456789101112131415161718192021222324252627282930313233343536373839class MyThread implements Runnable {    private int ticket = 10;    public void run() {        for (int i = 0; i &lt; 20; i++) {            if (this.ticket &gt; 0) {                System.out.println(Thread.currentThread().getName() + &quot; å–ç¥¨ï¼šticket&quot; + this.ticket--);            }        }    }};public class Test {    public static void main(String[] args) {        MyThread mt = new MyThread();        // å¯åŠ¨3ä¸ªçº¿ç¨‹t1,t2,t3(å®ƒä»¬å…±ç”¨ä¸€ä¸ªRunnableå¯¹è±¡)ï¼Œè¿™3ä¸ªçº¿ç¨‹ä¸€å…±å–10å¼ ç¥¨ï¼        Thread t1 = new Thread(mt);        Thread t2 = new Thread(mt);        Thread t3 = new Thread(mt);        t1.start();        t2.start();        t3.start();    }}//ç»“æœè¯´æ˜ï¼š(01) å’Œä¸‹é¢â€œMyThreadç»§æ‰¿äºThreadâ€ä¸åŒï¼›è¿™é‡Œçš„MyThreadå®ç°äº†Threadæ¥å£ã€‚(02) ä¸»çº¿ç¨‹mainåˆ›å»ºå¹¶å¯åŠ¨3ä¸ªå­çº¿ç¨‹ï¼Œè€Œä¸”è¿™3ä¸ªå­çº¿ç¨‹éƒ½æ˜¯åŸºäºâ€œmtè¿™ä¸ªRunnableå¯¹è±¡â€è€Œåˆ›å»ºçš„ã€‚è¿è¡Œç»“æœæ˜¯è¿™3ä¸ªå­çº¿ç¨‹ä¸€å…±å–å‡ºäº†10å¼ ç¥¨ã€‚è¿™è¯´æ˜å®ƒä»¬æ˜¯å…±äº«äº†MyThreadæ¥å£çš„ã€‚Thread-1 å–ç¥¨ï¼šticket10Thread-2 å–ç¥¨ï¼šticket9Thread-0 å–ç¥¨ï¼šticket9Thread-2 å–ç¥¨ï¼šticket7Thread-1 å–ç¥¨ï¼šticket8Thread-2 å–ç¥¨ï¼šticket5Thread-0 å–ç¥¨ï¼šticket6Thread-2 å–ç¥¨ï¼šticket3Thread-1 å–ç¥¨ï¼šticket4Thread-2 å–ç¥¨ï¼šticket1Thread-0 å–ç¥¨ï¼šticket2Threadçš„å¤šçº¿ç¨‹ç¤ºä¾‹123456789101112131415161718192021222324252627282930313233343536373839404142class MyThread extends Thread{    private int ticket=5;    public void run(){        for(int i=0;i&lt;20;i++){            if(this.ticket&gt;0){                System.out.println(this.getName()+&quot; å–ç¥¨ï¼šticket&quot;+this.ticket--);            }        }    }}public class Test {    public static void main(String[] args) {        // å¯åŠ¨3ä¸ªçº¿ç¨‹t1,t2,t3ï¼›æ¯ä¸ªçº¿ç¨‹å„å–10å¼ ç¥¨ï¼        MyThread t1=new MyThread();        MyThread t2=new MyThread();        MyThread t3=new MyThread();        t1.start();        t2.start();        t3.start();    }}//ç»“æœè¯´æ˜ï¼š(01) MyThreadç»§æ‰¿äºThreadï¼Œå®ƒæ˜¯è‡ªå®šä¹‰ä¸ªçº¿ç¨‹ã€‚æ¯ä¸ªMyThreadéƒ½ä¼šå–å‡º10å¼ ç¥¨ã€‚(02) ä¸»çº¿ç¨‹mainåˆ›å»ºå¹¶å¯åŠ¨3ä¸ªMyThreadå­çº¿ç¨‹ã€‚æ¯ä¸ªå­çº¿ç¨‹éƒ½å„è‡ªå–å‡ºäº†10å¼ ç¥¨ã€‚Thread-0 å–ç¥¨ï¼šticket5Thread-0 å–ç¥¨ï¼šticket4Thread-0 å–ç¥¨ï¼šticket3Thread-0 å–ç¥¨ï¼šticket2Thread-0 å–ç¥¨ï¼šticket1Thread-1 å–ç¥¨ï¼šticket5Thread-1 å–ç¥¨ï¼šticket4Thread-1 å–ç¥¨ï¼šticket3Thread-1 å–ç¥¨ï¼šticket2Thread-1 å–ç¥¨ï¼šticket1Thread-2 å–ç¥¨ï¼šticket5Thread-2 å–ç¥¨ï¼šticket4Thread-2 å–ç¥¨ï¼šticket3Thread-2 å–ç¥¨ï¼šticket2Thread-2 å–ç¥¨ï¼šticket1Threadä¸­start()å’Œrun()çš„åŒºåˆ« 12start(): å®ƒçš„ä½œç”¨æ˜¯å¯åŠ¨ä¸€ä¸ªæ–°çº¿ç¨‹ï¼Œæ–°çº¿ç¨‹ä¼šæ‰§è¡Œç›¸åº”çš„run()æ–¹æ³•ã€‚start()ä¸èƒ½è¢«é‡å¤è°ƒç”¨ã€‚run(): run()å°±å’Œæ™®é€šçš„æˆå‘˜æ–¹æ³•ä¸€æ ·ï¼Œå¯ä»¥è¢«é‡å¤è°ƒç”¨ã€‚å•ç‹¬è°ƒç”¨run()çš„è¯ï¼Œä¼šåœ¨å½“å‰çº¿ç¨‹ä¸­æ‰§è¡Œrun()ï¼Œè€Œå¹¶ä¸ä¼šå¯åŠ¨æ–°çº¿ç¨‹ï¼synchronizedå…³é”®å­—synchronizedåŸç†123åœ¨javaä¸­ï¼Œæ¯ä¸€ä¸ªå¯¹è±¡æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªåŒæ­¥é”ã€‚è¿™ä¹Ÿæ„å‘³ç€ï¼ŒåŒæ­¥é”æ˜¯ä¾èµ–äºå¯¹è±¡è€Œå­˜åœ¨ã€‚å½“æˆ‘ä»¬è°ƒç”¨æŸå¯¹è±¡çš„synchronizedæ–¹æ³•æ—¶ï¼Œå°±è·å–äº†è¯¥å¯¹è±¡çš„åŒæ­¥é”ã€‚ä¾‹å¦‚ï¼Œsynchronized(obj)å°±è·å–äº†â€œobjè¿™ä¸ªå¯¹è±¡â€çš„åŒæ­¥é”ã€‚ä¸åŒçº¿ç¨‹å¯¹åŒæ­¥é”çš„è®¿é—®æ˜¯äº’æ–¥çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒæŸæ—¶é—´ç‚¹ï¼Œå¯¹è±¡çš„åŒæ­¥é”åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹è·å–åˆ°ï¼é€šè¿‡åŒæ­¥é”ï¼Œæˆ‘ä»¬å°±èƒ½åœ¨å¤šçº¿ç¨‹ä¸­ï¼Œå®ç°å¯¹â€œå¯¹è±¡/æ–¹æ³•â€çš„äº’æ–¥è®¿é—®ã€‚ ä¾‹å¦‚ï¼Œç°åœ¨æœ‰ä¸¤ä¸ªçº¿ç¨‹Aå’Œçº¿ç¨‹Bï¼Œå®ƒä»¬éƒ½ä¼šè®¿é—®â€œå¯¹è±¡objçš„åŒæ­¥é”â€ã€‚å‡è®¾ï¼Œåœ¨æŸä¸€æ—¶åˆ»ï¼Œçº¿ç¨‹Aè·å–åˆ°â€œobjçš„åŒæ­¥é”â€å¹¶åœ¨æ‰§è¡Œä¸€äº›æ“ä½œï¼›è€Œæ­¤æ—¶ï¼Œçº¿ç¨‹Bä¹Ÿä¼å›¾è·å–â€œobjçš„åŒæ­¥é”â€ â€”â€” çº¿ç¨‹Bä¼šè·å–å¤±è´¥ï¼Œå®ƒå¿…é¡»ç­‰å¾…ï¼Œç›´åˆ°çº¿ç¨‹Aé‡Šæ”¾äº†â€œè¯¥å¯¹è±¡çš„åŒæ­¥é”â€ä¹‹åçº¿ç¨‹Bæ‰èƒ½è·å–åˆ°â€œobjçš„åŒæ­¥é”â€ä»è€Œæ‰å¯ä»¥è¿è¡Œã€‚synchronizedåŸºæœ¬è§„åˆ™123ç¬¬ä¸€æ¡: å½“ä¸€ä¸ªçº¿ç¨‹è®¿é—®â€œæŸå¯¹è±¡â€çš„â€œsynchronizedæ–¹æ³•â€æˆ–è€…â€œsynchronizedä»£ç å—â€æ—¶ï¼Œå…¶ä»–çº¿ç¨‹å¯¹â€œè¯¥å¯¹è±¡â€çš„è¯¥â€œsynchronizedæ–¹æ³•â€æˆ–è€…â€œsynchronizedä»£ç å—â€çš„è®¿é—®å°†è¢«é˜»å¡ã€‚ç¬¬äºŒæ¡: å½“ä¸€ä¸ªçº¿ç¨‹è®¿é—®â€œæŸå¯¹è±¡â€çš„â€œsynchronizedæ–¹æ³•â€æˆ–è€…â€œsynchronizedä»£ç å—â€æ—¶ï¼Œå…¶ä»–çº¿ç¨‹ä»ç„¶å¯ä»¥è®¿é—®â€œè¯¥å¯¹è±¡â€çš„éåŒæ­¥ä»£ç å—ã€‚ç¬¬ä¸‰æ¡: å½“ä¸€ä¸ªçº¿ç¨‹è®¿é—®â€œæŸå¯¹è±¡â€çš„â€œsynchronizedæ–¹æ³•â€æˆ–è€…â€œsynchronizedä»£ç å—â€æ—¶ï¼Œå…¶ä»–çº¿ç¨‹å¯¹â€œè¯¥å¯¹è±¡â€çš„å…¶ä»–çš„â€œsynchronizedæ–¹æ³•â€æˆ–è€…â€œsynchronizedä»£ç å—â€çš„è®¿é—®å°†è¢«é˜»å¡ã€‚123456789101112131415161718192021222324252627282930313233343536373839// ç¬¬ä¸€æ¡class MyRunable implements Runnable {    @Override    public void run() {        synchronized(this) {            try {                  for (int i = 0; i &lt; 5; i++) {                    Thread.sleep(100); // ä¼‘çœ 100ms                    System.out.println(Thread.currentThread().getName() + &quot; loop &quot; + i);                  }            } catch (InterruptedException ie) {              }        }      }}public class Demo1_1 {    public static void main(String[] args) {          Runnable demo = new MyRunable();     // æ–°å»ºâ€œRunnableå¯¹è±¡â€        Thread t1 = new Thread(demo, &quot;t1&quot;);  // æ–°å»ºâ€œçº¿ç¨‹t1â€, t1æ˜¯åŸºäºdemoè¿™ä¸ªRunnableå¯¹è±¡        Thread t2 = new Thread(demo, &quot;t2&quot;);  // æ–°å»ºâ€œçº¿ç¨‹t2â€, t2æ˜¯åŸºäºdemoè¿™ä¸ªRunnableå¯¹è±¡        t1.start();                          // å¯åŠ¨â€œçº¿ç¨‹t1â€        t2.start();                          // å¯åŠ¨â€œçº¿ç¨‹t2â€     } }// ç»“æœè¯´æ˜ï¼šrun()æ–¹æ³•ä¸­å­˜åœ¨â€œsynchronized(this)ä»£ç å—â€ï¼Œè€Œä¸”t1å’Œt2éƒ½æ˜¯åŸºäº&quot;demoè¿™ä¸ªRunnableå¯¹è±¡&quot;åˆ›å»ºçš„çº¿ç¨‹ã€‚è¿™å°±æ„å‘³ç€ï¼Œæˆ‘ä»¬å¯ä»¥å°†synchronized(this)ä¸­çš„thisçœ‹ä½œæ˜¯â€œdemoè¿™ä¸ªRunnableå¯¹è±¡â€ï¼›å› æ­¤ï¼Œçº¿ç¨‹t1å’Œt2å…±äº«â€œdemoå¯¹è±¡çš„åŒæ­¥é”â€ã€‚æ‰€ä»¥ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹è¿è¡Œçš„æ—¶å€™ï¼Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹å¿…é¡»ç­‰å¾…â€œè¿è¡Œçº¿ç¨‹â€é‡Šæ”¾â€œdemoçš„åŒæ­¥é”â€ä¹‹åæ‰èƒ½è¿è¡Œã€‚t1 loop 0t1 loop 1t1 loop 2t1 loop 3t1 loop 4t2 loop 0t2 loop 1t2 loop 2t2 loop 3t2 loop 41234567891011121314151617181920212223242526272829303132333435363738394041424344454647// ç¬¬ä¸€æ¡_ç»­class MyThread extends Thread {    public MyThread(String name) {        super(name);    }    @Override    public void run() {        synchronized(this) {            try {                  for (int i = 0; i &lt; 5; i++) {                    Thread.sleep(100); // ä¼‘çœ 100ms                    System.out.println(Thread.currentThread().getName() + &quot; loop &quot; + i);                  }            } catch (InterruptedException ie) {              }        }      }}public class Demo1_2 {    public static void main(String[] args) {          Thread t1 = new MyThread(&quot;t1&quot;);  // æ–°å»ºâ€œçº¿ç¨‹t1â€        Thread t2 = new MyThread(&quot;t2&quot;);  // æ–°å»ºâ€œçº¿ç¨‹t2â€        t1.start();                      // å¯åŠ¨â€œçº¿ç¨‹t1â€        t2.start();                      // å¯åŠ¨â€œçº¿ç¨‹t2â€     } }// ä»£ç è¯´æ˜ï¼šæ¯”è¾ƒDemo1_2 å’Œ Demo1_1ï¼Œæˆ‘ä»¬å‘ç°ï¼ŒDemo1_2ä¸­çš„MyThreadç±»æ˜¯ç›´æ¥ç»§æ‰¿äºThreadï¼Œè€Œä¸”t1å’Œt2éƒ½æ˜¯MyThreadå­çº¿ç¨‹ã€‚å¹¸è¿çš„æ˜¯ï¼Œåœ¨â€œDemo1_2çš„run()æ–¹æ³•â€ä¹Ÿè°ƒç”¨äº†synchronized(this)ï¼Œæ­£å¦‚â€œDemo1_1çš„run()æ–¹æ³•â€ä¹Ÿè°ƒç”¨äº†synchronized(this)ä¸€æ ·ï¼// ç»“æœè¯´æ˜ï¼šå¦‚æœè¿™ä¸ªç»“æœä¸€ç‚¹ä¹Ÿä¸ä»¤ä½ æ„Ÿåˆ°æƒŠè®¶ï¼Œé‚£ä¹ˆæˆ‘ç›¸ä¿¡ä½ å¯¹synchronizedå’Œthisçš„è®¤è¯†å·²ç»æ¯”è¾ƒæ·±åˆ»äº†ã€‚å¦åˆ™çš„è¯ï¼Œè¯·ç»§ç»­é˜…è¯»è¿™é‡Œçš„åˆ†æã€‚synchronized(this)ä¸­çš„thisæ˜¯æŒ‡â€œå½“å‰çš„ç±»å¯¹è±¡â€ï¼Œå³synchronized(this)æ‰€åœ¨çš„ç±»å¯¹åº”çš„å½“å‰å¯¹è±¡ã€‚å®ƒçš„ä½œç”¨æ˜¯è·å–â€œå½“å‰å¯¹è±¡çš„åŒæ­¥é”â€ã€‚å¯¹äºDemo1_2ä¸­ï¼Œsynchronized(this)ä¸­çš„thisä»£è¡¨çš„æ˜¯MyThreadå¯¹è±¡ï¼Œè€Œt1å’Œt2æ˜¯ä¸¤ä¸ªä¸åŒçš„MyThreadå¯¹è±¡ï¼Œå› æ­¤t1å’Œt2åœ¨æ‰§è¡Œsynchronized(this)æ—¶ï¼Œè·å–çš„æ˜¯ä¸åŒå¯¹è±¡çš„åŒæ­¥é”ã€‚å¯¹äºDemo1_1å¯¹è€Œè¨€ï¼Œsynchronized(this)ä¸­çš„thisä»£è¡¨çš„æ˜¯MyRunableå¯¹è±¡ï¼›t1å’Œt2å…±åŒä¸€ä¸ªMyRunableå¯¹è±¡ï¼Œå› æ­¤ï¼Œä¸€ä¸ªçº¿ç¨‹è·å–äº†å¯¹è±¡çš„åŒæ­¥é”ï¼Œä¼šé€ æˆå¦å¤–ä¸€ä¸ªçº¿ç¨‹ç­‰å¾…ã€‚t1 loop 0t2 loop 0t1 loop 1t2 loop 1t1 loop 2t2 loop 2t1 loop 3t2 loop 3t1 loop 4t2 loop 4123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263// ç¬¬äºŒæ¡class Count {    // å«æœ‰synchronizedåŒæ­¥å—çš„æ–¹æ³•    public void synMethod() {        synchronized(this) {            try {                  for (int i = 0; i &lt; 5; i++) {                    Thread.sleep(100); // ä¼‘çœ 100ms                    System.out.println(Thread.currentThread().getName() + &quot; synMethod loop &quot; + i);                  }            } catch (InterruptedException ie) {              }        }      }    // éåŒæ­¥çš„æ–¹æ³•    public void nonSynMethod() {        try {              for (int i = 0; i &lt; 5; i++) {                Thread.sleep(100);                System.out.println(Thread.currentThread().getName() + &quot; nonSynMethod loop &quot; + i);              }        } catch (InterruptedException ie) {          }    }}public class Demo2 {    public static void main(String[] args) {          final Count count = new Count();        // æ–°å»ºt1, t1ä¼šè°ƒç”¨â€œcountå¯¹è±¡â€çš„synMethod()æ–¹æ³•        Thread t1 = new Thread(                new Runnable() {                    @Override                    public void run() {                        count.synMethod();                    }                }, &quot;t1&quot;);        // æ–°å»ºt2, t2ä¼šè°ƒç”¨â€œcountå¯¹è±¡â€çš„nonSynMethod()æ–¹æ³•        Thread t2 = new Thread(                new Runnable() {                    @Override                    public void run() {                        count.nonSynMethod();                    }                }, &quot;t2&quot;);          t1.start();  // å¯åŠ¨t1        t2.start();  // å¯åŠ¨t2    } }// ç»“æœè¯´æ˜ï¼šä¸»çº¿ç¨‹ä¸­æ–°å»ºäº†ä¸¤ä¸ªå­çº¿ç¨‹t1å’Œt2ã€‚t1ä¼šè°ƒç”¨countå¯¹è±¡çš„synMethod()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å†…å«æœ‰åŒæ­¥å—ï¼›è€Œt2åˆ™ä¼šè°ƒç”¨countå¯¹è±¡çš„nonSynMethod()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸æ˜¯åŒæ­¥æ–¹æ³•ã€‚t1è¿è¡Œæ—¶ï¼Œè™½ç„¶è°ƒç”¨synchronized(this)è·å–â€œcountçš„åŒæ­¥é”â€ï¼›ä½†æ˜¯å¹¶æ²¡æœ‰é€ æˆt2çš„é˜»å¡ï¼Œå› ä¸ºt2æ²¡æœ‰ç”¨åˆ°â€œcountâ€åŒæ­¥é”ã€‚t1 synMethod loop 0t2 nonSynMethod loop 0t1 synMethod loop 1t2 nonSynMethod loop 1t1 synMethod loop 2t2 nonSynMethod loop 2t1 synMethod loop 3t2 nonSynMethod loop 3t1 synMethod loop 4t2 nonSynMethod loop 41234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465// ç¬¬ä¸‰æ¡class Count {    // å«æœ‰synchronizedåŒæ­¥å—çš„æ–¹æ³•    public void synMethod() {        synchronized(this) {            try {                  for (int i = 0; i &lt; 5; i++) {                    Thread.sleep(100); // ä¼‘çœ 100ms                    System.out.println(Thread.currentThread().getName() + &quot; synMethod loop &quot; + i);                  }            } catch (InterruptedException ie) {              }        }      }    // ä¹ŸåŒ…å«synchronizedåŒæ­¥å—çš„æ–¹æ³•    public void nonSynMethod() {        synchronized(this) {            try {                  for (int i = 0; i &lt; 5; i++) {                    Thread.sleep(100);                    System.out.println(Thread.currentThread().getName() + &quot; nonSynMethod loop &quot; + i);                  }            } catch (InterruptedException ie) {              }        }    }}public class Demo3 {    public static void main(String[] args) {          final Count count = new Count();        // æ–°å»ºt1, t1ä¼šè°ƒç”¨â€œcountå¯¹è±¡â€çš„synMethod()æ–¹æ³•        Thread t1 = new Thread(                new Runnable() {                    @Override                    public void run() {                        count.synMethod();                    }                }, &quot;t1&quot;);        // æ–°å»ºt2, t2ä¼šè°ƒç”¨â€œcountå¯¹è±¡â€çš„nonSynMethod()æ–¹æ³•        Thread t2 = new Thread(                new Runnable() {                    @Override                    public void run() {                        count.nonSynMethod();                    }                }, &quot;t2&quot;);          t1.start();  // å¯åŠ¨t1        t2.start();  // å¯åŠ¨t2    } }// ç»“æœè¯´æ˜ï¼šä¸»çº¿ç¨‹ä¸­æ–°å»ºäº†ä¸¤ä¸ªå­çº¿ç¨‹t1å’Œt2ã€‚t1å’Œt2è¿è¡Œæ—¶éƒ½è°ƒç”¨synchronized(this)ï¼Œè¿™ä¸ªthisæ˜¯Countå¯¹è±¡(count)ï¼Œè€Œt1å’Œt2å…±ç”¨countã€‚å› æ­¤ï¼Œåœ¨t1è¿è¡Œæ—¶ï¼Œt2ä¼šè¢«é˜»å¡ï¼Œç­‰å¾…t1è¿è¡Œé‡Šæ”¾â€œcountå¯¹è±¡çš„åŒæ­¥é”â€ï¼Œt2æ‰èƒ½è¿è¡Œã€‚t1 synMethod loop 0t1 synMethod loop 1t1 synMethod loop 2t1 synMethod loop 3t1 synMethod loop 4t2 nonSynMethod loop 0t2 nonSynMethod loop 1t2 nonSynMethod loop 2t2 nonSynMethod loop 3t2 nonSynMethod loop 4synchronizedæ–¹æ³• å’Œ synchronizedä»£ç å—123456789101112// synchronizedæ–¹æ³•ç¤ºä¾‹public synchronized void foo1() {    System.out.println(&quot;synchronized methoed&quot;);}// synchronizedä»£ç å—public void foo2() {    synchronized (this) {        System.out.println(&quot;synchronized methoed&quot;);    }}// synchronizedä»£ç å—ä¸­çš„thisæ˜¯æŒ‡å½“å‰å¯¹è±¡ã€‚ä¹Ÿå¯ä»¥å°†thisæ›¿æ¢æˆå…¶ä»–å¯¹è±¡ï¼Œä¾‹å¦‚å°†thisæ›¿æ¢æˆobjï¼Œåˆ™foo2()åœ¨æ‰§è¡Œsynchronized(obj)æ—¶å°±è·å–çš„æ˜¯objçš„åŒæ­¥é”ã€‚// synchronizedä»£ç å—å¯ä»¥æ›´ç²¾ç¡®çš„æ§åˆ¶å†²çªé™åˆ¶è®¿é—®åŒºåŸŸï¼Œæœ‰æ—¶å€™è¡¨ç°æ›´é«˜æ•ˆç‡ã€‚å®ä¾‹é”å’Œå…¨å±€é”1234567891011121314151617å®ä¾‹é” -- é”åœ¨æŸä¸€ä¸ªå®ä¾‹å¯¹è±¡ä¸Šã€‚å¦‚æœè¯¥ç±»æ˜¯å•ä¾‹ï¼Œé‚£ä¹ˆè¯¥é”ä¹Ÿå…·æœ‰å…¨å±€é”çš„æ¦‚å¿µã€‚// å®ä¾‹é”å¯¹åº”çš„å°±æ˜¯synchronizedå…³é”®å­—ã€‚å…¨å±€é” -- è¯¥é”é’ˆå¯¹çš„æ˜¯ç±»ï¼Œæ— è®ºå®ä¾‹å¤šå°‘ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆçº¿ç¨‹éƒ½å…±äº«è¯¥é”ã€‚// å…¨å±€é”å¯¹åº”çš„å°±æ˜¯static synchronizedï¼ˆæˆ–è€…æ˜¯é”åœ¨è¯¥ç±»çš„classæˆ–è€…classloaderå¯¹è±¡ä¸Šï¼‰ã€‚               pulbic class Something {    public synchronized void isSyncA(){}    public synchronized void isSyncB(){}    public static synchronized void cSyncA(){}    public static synchronized void cSyncB(){}}å‡è®¾ï¼ŒSomethingæœ‰ä¸¤ä¸ªå®ä¾‹xå’Œyã€‚åˆ†æä¸‹é¢4ç»„è¡¨è¾¾å¼è·å–çš„é”çš„æƒ…å†µã€‚(01) (ä¸èƒ½è¢«åŒæ—¶è®¿é—®)x.isSyncA()ä¸x.isSyncB() (02) (å¯ä»¥åŒæ—¶è¢«è®¿é—®)x.isSyncA()ä¸y.isSyncA()(03) (ä¸èƒ½è¢«åŒæ—¶è®¿é—®)x.cSyncA()ä¸y.cSyncB()(04) (å¯ä»¥è¢«åŒæ—¶è®¿é—®)x.isSyncA()ä¸Something.cSyncA()123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263// (01) ä¸èƒ½è¢«åŒæ—¶è®¿é—®ã€‚å› ä¸ºisSyncA()å’ŒisSyncB()éƒ½æ˜¯è®¿é—®åŒä¸€ä¸ªå¯¹è±¡(å¯¹è±¡x)çš„åŒæ­¥é”ï¼// LockTest1.javaçš„æºç class Something {    public synchronized void isSyncA(){        try {              for (int i = 0; i &lt; 5; i++) {                Thread.sleep(100); // ä¼‘çœ 100ms                System.out.println(Thread.currentThread().getName()+&quot; : isSyncA&quot;);            }        }catch (InterruptedException ie) {          }      }    public synchronized void isSyncB(){        try {              for (int i = 0; i &lt; 5; i++) {                Thread.sleep(100); // ä¼‘çœ 100ms                System.out.println(Thread.currentThread().getName()+&quot; : isSyncB&quot;);            }        }catch (InterruptedException ie) {          }      }}public class LockTest1 {    Something x = new Something();    Something y = new Something();    // æ¯”è¾ƒ(01) x.isSyncA()ä¸x.isSyncB()     private void test1() {        // æ–°å»ºt11, t11ä¼šè°ƒç”¨ x.isSyncA()        Thread t11 = new Thread(                new Runnable() {                    @Override                    public void run() {                        x.isSyncA();                    }                }, &quot;t11&quot;);        // æ–°å»ºt12, t12ä¼šè°ƒç”¨ x.isSyncB()        Thread t12 = new Thread(                new Runnable() {                    @Override                    public void run() {                        x.isSyncB();                    }                }, &quot;t12&quot;);          t11.start();  // å¯åŠ¨t11        t12.start();  // å¯åŠ¨t12    }    public static void main(String[] args) {        LockTest1 demo = new LockTest1();        demo.test1();    }}t11 : isSyncAt11 : isSyncAt11 : isSyncAt11 : isSyncAt11 : isSyncAt12 : isSyncBt12 : isSyncBt12 : isSyncBt12 : isSyncBt12 : isSyncB12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182// (02) å¯ä»¥åŒæ—¶è¢«è®¿é—®ã€‚å› ä¸ºè®¿é—®çš„ä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡çš„åŒæ­¥é”ï¼Œx.isSyncA()è®¿é—®çš„æ˜¯xçš„åŒæ­¥é”ï¼Œè€Œy.isSyncA()è®¿é—®çš„æ˜¯yçš„åŒæ­¥é”ã€‚// LockTest2.javaçš„æºç class Something {    public synchronized void isSyncA(){        try {              for (int i = 0; i &lt; 5; i++) {                Thread.sleep(100); // ä¼‘çœ 100ms                System.out.println(Thread.currentThread().getName()+&quot; : isSyncA&quot;);            }        }catch (InterruptedException ie) {          }      }    public synchronized void isSyncB(){        try {              for (int i = 0; i &lt; 5; i++) {                Thread.sleep(100); // ä¼‘çœ 100ms                System.out.println(Thread.currentThread().getName()+&quot; : isSyncB&quot;);            }        }catch (InterruptedException ie) {          }      }    public static synchronized void cSyncA(){        try {              for (int i = 0; i &lt; 5; i++) {                Thread.sleep(100); // ä¼‘çœ 100ms                System.out.println(Thread.currentThread().getName()+&quot; : cSyncA&quot;);            }         }catch (InterruptedException ie) {          }      }    public static synchronized void cSyncB(){        try {              for (int i = 0; i &lt; 5; i++) {                Thread.sleep(100); // ä¼‘çœ 100ms                System.out.println(Thread.currentThread().getName()+&quot; : cSyncB&quot;);            }         }catch (InterruptedException ie) {          }      }}public class LockTest2 {    Something x = new Something();    Something y = new Something();    // æ¯”è¾ƒ(02) x.isSyncA()ä¸y.isSyncA()    private void test2() {        // æ–°å»ºt21, t21ä¼šè°ƒç”¨ x.isSyncA()        Thread t21 = new Thread(                new Runnable() {                    @Override                    public void run() {                        x.isSyncA();                    }                }, &quot;t21&quot;);        // æ–°å»ºt22, t22ä¼šè°ƒç”¨ x.isSyncB()        Thread t22 = new Thread(                new Runnable() {                    @Override                    public void run() {                        y.isSyncA();                    }                }, &quot;t22&quot;);          t21.start();  // å¯åŠ¨t21        t22.start();  // å¯åŠ¨t22    }    public static void main(String[] args) {        LockTest2 demo = new LockTest2();        demo.test2();    }}t21 : isSyncAt22 : isSyncAt21 : isSyncAt22 : isSyncAt21 : isSyncAt22 : isSyncAt21 : isSyncAt22 : isSyncAt21 : isSyncAt22 : isSyncA12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182// (03) ä¸èƒ½è¢«åŒæ—¶è®¿é—®ã€‚å› ä¸ºcSyncA()å’ŒcSyncB()éƒ½æ˜¯staticç±»å‹ï¼Œx.cSyncA()ç›¸å½“äºSomething.isSyncA()ï¼Œy.cSyncB()ç›¸å½“äºSomething.isSyncB()ï¼Œå› æ­¤å®ƒä»¬å…±ç”¨ä¸€ä¸ªåŒæ­¥é”ï¼Œä¸èƒ½è¢«åŒæ—¶è®¿é—®ã€‚// LockTest3.javaçš„æºç class Something {    public synchronized void isSyncA(){        try {              for (int i = 0; i &lt; 5; i++) {                Thread.sleep(100); // ä¼‘çœ 100ms                System.out.println(Thread.currentThread().getName()+&quot; : isSyncA&quot;);            }        }catch (InterruptedException ie) {          }      }    public synchronized void isSyncB(){        try {              for (int i = 0; i &lt; 5; i++) {                Thread.sleep(100); // ä¼‘çœ 100ms                System.out.println(Thread.currentThread().getName()+&quot; : isSyncB&quot;);            }        }catch (InterruptedException ie) {          }      }    public static synchronized void cSyncA(){        try {              for (int i = 0; i &lt; 5; i++) {                Thread.sleep(100); // ä¼‘çœ 100ms                System.out.println(Thread.currentThread().getName()+&quot; : cSyncA&quot;);            }         }catch (InterruptedException ie) {          }      }    public static synchronized void cSyncB(){        try {              for (int i = 0; i &lt; 5; i++) {                Thread.sleep(100); // ä¼‘çœ 100ms                System.out.println(Thread.currentThread().getName()+&quot; : cSyncB&quot;);            }         }catch (InterruptedException ie) {          }      }}public class LockTest3 {    Something x = new Something();    Something y = new Something();    // æ¯”è¾ƒ(03) x.cSyncA()ä¸y.cSyncB()    private void test3() {        // æ–°å»ºt31, t31ä¼šè°ƒç”¨ x.isSyncA()        Thread t31 = new Thread(                new Runnable() {                    @Override                    public void run() {                        x.cSyncA();                    }                }, &quot;t31&quot;);        // æ–°å»ºt32, t32ä¼šè°ƒç”¨ x.isSyncB()        Thread t32 = new Thread(                new Runnable() {                    @Override                    public void run() {                        y.cSyncB();                    }                }, &quot;t32&quot;);          t31.start();  // å¯åŠ¨t31        t32.start();  // å¯åŠ¨t32    }    public static void main(String[] args) {        LockTest3 demo = new LockTest3();        demo.test3();    }}t31 : cSyncAt31 : cSyncAt31 : cSyncAt31 : cSyncAt31 : cSyncAt32 : cSyncBt32 : cSyncBt32 : cSyncBt32 : cSyncBt32 : cSyncB123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081// (04) å¯ä»¥è¢«åŒæ—¶è®¿é—®ã€‚å› ä¸ºisSyncA()æ˜¯å®ä¾‹æ–¹æ³•ï¼Œx.isSyncA()ä½¿ç”¨çš„æ˜¯å¯¹è±¡xçš„é”ï¼›è€ŒcSyncA()æ˜¯é™æ€æ–¹æ³•ï¼ŒSomething.cSyncA()å¯ä»¥ç†è§£å¯¹ä½¿ç”¨çš„æ˜¯â€œç±»çš„é”â€ã€‚å› æ­¤ï¼Œå®ƒä»¬æ˜¯å¯ä»¥è¢«åŒæ—¶è®¿é—®çš„ã€‚// LockTest4.javaçš„æºç class Something {    public synchronized void isSyncA(){        try {              for (int i = 0; i &lt; 5; i++) {                Thread.sleep(100); // ä¼‘çœ 100ms                System.out.println(Thread.currentThread().getName()+&quot; : isSyncA&quot;);            }        }catch (InterruptedException ie) {          }      }    public synchronized void isSyncB(){        try {              for (int i = 0; i &lt; 5; i++) {                Thread.sleep(100); // ä¼‘çœ 100ms                System.out.println(Thread.currentThread().getName()+&quot; : isSyncB&quot;);            }        }catch (InterruptedException ie) {          }      }    public static synchronized void cSyncA(){        try {              for (int i = 0; i &lt; 5; i++) {                Thread.sleep(100); // ä¼‘çœ 100ms                System.out.println(Thread.currentThread().getName()+&quot; : cSyncA&quot;);            }         }catch (InterruptedException ie) {          }      }    public static synchronized void cSyncB(){        try {              for (int i = 0; i &lt; 5; i++) {                Thread.sleep(100); // ä¼‘çœ 100ms                System.out.println(Thread.currentThread().getName()+&quot; : cSyncB&quot;);            }         }catch (InterruptedException ie) {          }      }}public class LockTest4 {    Something x = new Something();    Something y = new Something();    // æ¯”è¾ƒ(04) x.isSyncA()ä¸Something.cSyncA()    private void test4() {        // æ–°å»ºt41, t41ä¼šè°ƒç”¨ x.isSyncA()        Thread t41 = new Thread(                new Runnable() {                    @Override                    public void run() {                        x.isSyncA();                    }                }, &quot;t41&quot;);        // æ–°å»ºt42, t42ä¼šè°ƒç”¨ x.isSyncB()        Thread t42 = new Thread(                new Runnable() {                    @Override                    public void run() {                        Something.cSyncA();                    }                }, &quot;t42&quot;);          t41.start();  // å¯åŠ¨t41        t42.start();  // å¯åŠ¨t42    }    public static void main(String[] args) {        LockTest4 demo = new LockTest4();        demo.test4();    }}t41 : isSyncAt42 : cSyncAt41 : isSyncAt42 : cSyncAt41 : isSyncAt42 : cSyncAt41 : isSyncAt42 : cSyncAt41 : isSyncAt42 : cSyncAçº¿ç¨‹ç­‰å¾…ä¸å”¤é†’wait(), notify(), notifyAll()ç­‰æ–¹æ³•ä»‹ç»Objectç±»ä¸­å…³äºç­‰å¾…/å”¤é†’çš„APIè¯¦ç»†ä¿¡æ¯å¦‚ä¸‹ï¼šnotify()  â€” å”¤é†’åœ¨æ­¤å¯¹è±¡ç›‘è§†å™¨ä¸Šç­‰å¾…çš„å•ä¸ªçº¿ç¨‹ã€‚notifyAll()  â€” å”¤é†’åœ¨æ­¤å¯¹è±¡ç›‘è§†å™¨ä¸Šç­‰å¾…çš„æ‰€æœ‰çº¿ç¨‹ã€‚wait() â€” å½“å‰çº¿ç¨‹å¤„äºâ€œç­‰å¾…(é˜»å¡)çŠ¶æ€â€ï¼Œâ€œç›´åˆ°å…¶ä»–çº¿ç¨‹è°ƒç”¨æ­¤å¯¹è±¡çš„ notify() æ–¹æ³•æˆ– notifyAll() æ–¹æ³•â€ï¼Œå½“å‰çº¿ç¨‹è¢«å”¤é†’(è¿›å…¥â€œå°±ç»ªçŠ¶æ€â€)ã€‚wait(long timeout) â€” è®©å½“å‰çº¿ç¨‹å¤„äºâ€œç­‰å¾…(é˜»å¡)çŠ¶æ€â€ï¼Œâ€œç›´åˆ°å…¶ä»–çº¿ç¨‹è°ƒç”¨æ­¤å¯¹è±¡çš„ notify() æ–¹æ³•æˆ– notifyAll() æ–¹æ³•ï¼Œæˆ–è€…è¶…è¿‡æŒ‡å®šçš„æ—¶é—´é‡â€ï¼Œå½“å‰çº¿ç¨‹è¢«å”¤é†’(è¿›å…¥â€œå°±ç»ªçŠ¶æ€â€)ã€‚wait(long timeout, int nanos)  â€” è®©å½“å‰çº¿ç¨‹å¤„äºâ€œç­‰å¾…(é˜»å¡)çŠ¶æ€â€ï¼Œâ€œç›´åˆ°å…¶ä»–çº¿ç¨‹è°ƒç”¨æ­¤å¯¹è±¡çš„ notify() æ–¹æ³•æˆ– notifyAll() æ–¹æ³•ï¼Œæˆ–è€…å…¶ä»–æŸä¸ªçº¿ç¨‹ä¸­æ–­å½“å‰çº¿ç¨‹ï¼Œæˆ–è€…å·²è¶…è¿‡æŸä¸ªå®é™…æ—¶é—´é‡â€ï¼Œå½“å‰çº¿ç¨‹è¢«å”¤é†’(è¿›å…¥â€œå°±ç»ªçŠ¶æ€â€)ã€‚wait()å’Œnotify()ç¤ºä¾‹123456789101112131415161718192021222324252627282930313233343536373839404142434445// WaitTest.javaçš„æºç class ThreadA extends Thread{    public ThreadA(String name) {        super(name);    }    public void run() {        synchronized (this) {            System.out.println(Thread.currentThread().getName()+&quot; call notify()&quot;);            // å”¤é†’å½“å‰çš„waitçº¿ç¨‹            notify();        }    }}public class WaitTest {    public static void main(String[] args) {        ThreadA t1 = new ThreadA(&quot;t1&quot;);        synchronized(t1) {            try {                // å¯åŠ¨â€œçº¿ç¨‹t1â€                System.out.println(Thread.currentThread().getName()+&quot; start t1&quot;);                t1.start();                // ä¸»çº¿ç¨‹ç­‰å¾…t1é€šè¿‡notify()å”¤é†’ã€‚                System.out.println(Thread.currentThread().getName()+&quot; wait()&quot;);                t1.wait();                System.out.println(Thread.currentThread().getName()+&quot; continue&quot;);            } catch (InterruptedException e) {                e.printStackTrace();            }        }    }}main start t1main wait()t1 call notify()main continue// ç»“æœè¯´æ˜ï¼šå¦‚ä¸‹å›¾ï¼Œè¯´æ˜äº†â€œä¸»çº¿ç¨‹â€å’Œâ€œçº¿ç¨‹t1â€çš„æµç¨‹ã€‚(01) æ³¨æ„ï¼Œå›¾ä¸­&quot;ä¸»çº¿ç¨‹&quot; ä»£è¡¨â€œä¸»çº¿ç¨‹mainâ€ã€‚&quot;çº¿ç¨‹t1&quot; ä»£è¡¨WaitTestä¸­å¯åŠ¨çš„â€œçº¿ç¨‹t1â€ã€‚ è€Œâ€œé”â€ ä»£è¡¨â€œt1è¿™ä¸ªå¯¹è±¡çš„åŒæ­¥é”â€ã€‚(02) â€œä¸»çº¿ç¨‹â€é€šè¿‡ new ThreadA(&quot;t1&quot;) æ–°å»ºâ€œçº¿ç¨‹t1â€ã€‚éšåé€šè¿‡synchronized(t1)è·å–â€œt1å¯¹è±¡çš„åŒæ­¥é”â€ã€‚ç„¶åè°ƒç”¨t1.start()å¯åŠ¨â€œçº¿ç¨‹t1â€ã€‚(03) â€œä¸»çº¿ç¨‹â€æ‰§è¡Œt1.wait() é‡Šæ”¾â€œt1å¯¹è±¡çš„é”â€å¹¶ä¸”è¿›å…¥â€œç­‰å¾…(é˜»å¡)çŠ¶æ€â€ã€‚ç­‰å¾…t1å¯¹è±¡ä¸Šçš„çº¿ç¨‹é€šè¿‡notify() æˆ– notifyAll()å°†å…¶å”¤é†’ã€‚(04) â€œçº¿ç¨‹t1â€è¿è¡Œä¹‹åï¼Œé€šè¿‡synchronized(this)è·å–â€œå½“å‰å¯¹è±¡çš„é”â€ï¼›æ¥ç€è°ƒç”¨notify()å”¤é†’â€œå½“å‰å¯¹è±¡ä¸Šçš„ç­‰å¾…çº¿ç¨‹â€ï¼Œä¹Ÿå°±æ˜¯å”¤é†’â€œä¸»çº¿ç¨‹â€ã€‚(05) â€œçº¿ç¨‹t1â€è¿è¡Œå®Œæ¯•ä¹‹åï¼Œé‡Šæ”¾â€œå½“å‰å¯¹è±¡çš„é”â€ã€‚ç´§æ¥ç€ï¼Œâ€œä¸»çº¿ç¨‹â€è·å–â€œt1å¯¹è±¡çš„é”â€ï¼Œç„¶åæ¥ç€è¿è¡Œã€‚jdkæ–‡æ¡£ä¸­å…³äºwaitçš„ä¸€æ®µä»‹ç»ï¼š1234567Causes the current thread to wait until another thread invokes the notify() method or the notifyAll() method for this object. In other words, this method behaves exactly as if it simply performs the call wait(0).The current thread must own this object's monitor. The thread releases ownership of this monitor and waits until another thread notifies threads waiting on this object's monitor to wake up either through a call to the notify method or the notifyAll method. The thread then waits until it can re-obtain ownership of the monitor and resumes execution.å¼•èµ·â€œå½“å‰çº¿ç¨‹â€ç­‰å¾…ï¼Œç›´åˆ°å¦å¤–ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨notify()æˆ–notifyAll()å”¤é†’è¯¥çº¿ç¨‹ã€‚æ¢å¥è¯è¯´ï¼Œè¿™ä¸ªæ–¹æ³•å’Œwait(0)çš„æ•ˆæœä¸€æ ·ï¼(è¡¥å……ï¼Œå¯¹äºwait(long millis)æ–¹æ³•ï¼Œå½“millisä¸º0æ—¶ï¼Œè¡¨ç¤ºæ— é™ç­‰å¾…ï¼Œç›´åˆ°è¢«notify()æˆ–notifyAll()å”¤é†’)ã€‚â€œå½“å‰çº¿ç¨‹â€åœ¨è°ƒç”¨wait()æ—¶ï¼Œå¿…é¡»æ‹¥æœ‰è¯¥å¯¹è±¡çš„åŒæ­¥é”ã€‚è¯¥çº¿ç¨‹è°ƒç”¨wait()ä¹‹åï¼Œä¼šé‡Šæ”¾è¯¥é”ï¼›ç„¶åä¸€ç›´ç­‰å¾…ç›´åˆ°â€œå…¶å®ƒçº¿ç¨‹â€è°ƒç”¨å¯¹è±¡çš„åŒæ­¥é”çš„notify()æˆ–notifyAll()æ–¹æ³•ã€‚ç„¶åï¼Œè¯¥çº¿ç¨‹ç»§ç»­ç­‰å¾…ç›´åˆ°å®ƒé‡æ–°è·å–â€œè¯¥å¯¹è±¡çš„åŒæ­¥é”â€ï¼Œç„¶åå°±å¯ä»¥æ¥ç€è¿è¡Œã€‚æ³¨æ„ï¼šjdkçš„è§£é‡Šä¸­ï¼Œè¯´wait()çš„ä½œç”¨æ˜¯è®©â€œå½“å‰çº¿ç¨‹â€ç­‰å¾…ï¼Œè€Œâ€œå½“å‰çº¿ç¨‹â€æ˜¯æŒ‡æ­£åœ¨cpuä¸Šè¿è¡Œçš„çº¿ç¨‹ï¼è¿™ä¹Ÿæ„å‘³ç€ï¼Œè™½ç„¶t1.wait()æ˜¯é€šè¿‡â€œçº¿ç¨‹t1â€è°ƒç”¨çš„wait()æ–¹æ³•ï¼Œä½†æ˜¯è°ƒç”¨t1.wait()çš„åœ°æ–¹æ˜¯åœ¨â€œä¸»çº¿ç¨‹mainâ€ä¸­ã€‚è€Œä¸»çº¿ç¨‹å¿…é¡»æ˜¯â€œå½“å‰çº¿ç¨‹â€ï¼Œä¹Ÿå°±æ˜¯è¿è¡ŒçŠ¶æ€ï¼Œæ‰å¯ä»¥æ‰§è¡Œt1.wait()ã€‚æ‰€ä»¥ï¼Œæ­¤æ—¶çš„â€œå½“å‰çº¿ç¨‹â€æ˜¯â€œä¸»çº¿ç¨‹mainâ€ï¼å› æ­¤ï¼Œt1.wait()æ˜¯è®©â€œä¸»çº¿ç¨‹â€ç­‰å¾…ï¼Œè€Œä¸æ˜¯â€œçº¿ç¨‹t1â€ï¼wait(long timeout)å’Œnotify()1234567891011121314151617181920212223242526272829303132333435363738394041424344wait(long timeout)ä¼šè®©å½“å‰çº¿ç¨‹å¤„äºâ€œç­‰å¾…(é˜»å¡)çŠ¶æ€â€ï¼Œâ€œç›´åˆ°å…¶ä»–çº¿ç¨‹è°ƒç”¨æ­¤å¯¹è±¡çš„ notify() æ–¹æ³•æˆ– notifyAll() æ–¹æ³•ï¼Œæˆ–è€…è¶…è¿‡æŒ‡å®šçš„æ—¶é—´é‡â€ï¼Œå½“å‰çº¿ç¨‹è¢«å”¤é†’(è¿›å…¥â€œå°±ç»ªçŠ¶æ€â€)ã€‚// WaitTimeoutTest.javaçš„æºç class ThreadA extends Thread{    public ThreadA(String name) {        super(name);    }    public void run() {        System.out.println(Thread.currentThread().getName() + &quot; run &quot;);        // æ­»å¾ªç¯ï¼Œä¸æ–­è¿è¡Œã€‚        while(true)            ;    }}public class WaitTimeoutTest {    public static void main(String[] args) {        ThreadA t1 = new ThreadA(&quot;t1&quot;);        synchronized(t1) {            try {                // å¯åŠ¨â€œçº¿ç¨‹t1â€                System.out.println(Thread.currentThread().getName() + &quot; start t1&quot;);                t1.start();                // ä¸»çº¿ç¨‹ç­‰å¾…t1é€šè¿‡notify()å”¤é†’ æˆ– notifyAll()å”¤é†’ï¼Œæˆ–è¶…è¿‡3000mså»¶æ—¶ï¼›ç„¶åæ‰è¢«å”¤é†’ã€‚                System.out.println(Thread.currentThread().getName() + &quot; call wait &quot;);                t1.wait(3000);                System.out.println(Thread.currentThread().getName() + &quot; continue&quot;);            } catch (InterruptedException e) {                e.printStackTrace();            }        }    }}main start t1main call wait t1 run                  // å¤§çº¦3ç§’ä¹‹å...è¾“å‡ºâ€œmain continueâ€main continue    // ç»“æœè¯´æ˜ï¼šå¦‚ä¸‹å›¾ï¼Œè¯´æ˜äº†â€œä¸»çº¿ç¨‹â€å’Œâ€œçº¿ç¨‹t1â€çš„æµç¨‹ã€‚(01) æ³¨æ„ï¼Œå›¾ä¸­&quot;ä¸»çº¿ç¨‹&quot; ä»£è¡¨WaitTimeoutTestä¸»çº¿ç¨‹(å³ï¼Œçº¿ç¨‹main)ã€‚&quot;çº¿ç¨‹t1&quot; ä»£è¡¨WaitTestä¸­å¯åŠ¨çš„çº¿ç¨‹t1ã€‚ è€Œâ€œé”â€ ä»£è¡¨â€œt1è¿™ä¸ªå¯¹è±¡çš„åŒæ­¥é”â€ã€‚(02) ä¸»çº¿ç¨‹mainæ‰§è¡Œt1.start()å¯åŠ¨â€œçº¿ç¨‹t1â€ã€‚(03) ä¸»çº¿ç¨‹mainæ‰§è¡Œt1.wait(3000)ï¼Œæ­¤æ—¶ï¼Œä¸»çº¿ç¨‹è¿›å…¥â€œé˜»å¡çŠ¶æ€â€ã€‚éœ€è¦â€œç”¨äºt1å¯¹è±¡é”çš„çº¿ç¨‹é€šè¿‡notify() æˆ–è€… notifyAll()å°†å…¶å”¤é†’â€ æˆ–è€… â€œè¶…æ—¶3000msä¹‹åâ€ï¼Œä¸»çº¿ç¨‹mainæ‰è¿›å…¥åˆ°â€œå°±ç»ªçŠ¶æ€â€ï¼Œç„¶åæ‰å¯ä»¥è¿è¡Œã€‚(04) â€œçº¿ç¨‹t1â€è¿è¡Œä¹‹åï¼Œè¿›å…¥äº†æ­»å¾ªç¯ï¼Œä¸€ç›´ä¸æ–­çš„è¿è¡Œã€‚(05) è¶…æ—¶3000msä¹‹åï¼Œä¸»çº¿ç¨‹mainä¼šè¿›å…¥åˆ°â€œå°±ç»ªçŠ¶æ€â€ï¼Œç„¶åæ¥ç€è¿›å…¥â€œè¿è¡ŒçŠ¶æ€â€ã€‚wait() å’Œ notifyAll()1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556public class NotifyAllTest {    private static Object obj = new Object();    public static void main(String[] args) {        ThreadA t1 = new ThreadA(&quot;t1&quot;);        ThreadA t2 = new ThreadA(&quot;t2&quot;);        ThreadA t3 = new ThreadA(&quot;t3&quot;);        t1.start();        t2.start();        t3.start();        try {            System.out.println(Thread.currentThread().getName()+&quot; sleep(3000)&quot;);            Thread.sleep(3000);        } catch (InterruptedException e) {            e.printStackTrace();        }        synchronized(obj) {            // ä¸»çº¿ç¨‹ç­‰å¾…å”¤é†’ã€‚            System.out.println(Thread.currentThread().getName()+&quot; notifyAll()&quot;);            obj.notifyAll();        }    }    static class ThreadA extends Thread{        public ThreadA(String name){            super(name);        }        public void run() {            synchronized (obj) {                try {                    // æ‰“å°è¾“å‡ºç»“æœ                    System.out.println(Thread.currentThread().getName() + &quot; wait&quot;);                    // å”¤é†’å½“å‰çš„waitçº¿ç¨‹                    obj.wait();                    // æ‰“å°è¾“å‡ºç»“æœ                    System.out.println(Thread.currentThread().getName() + &quot; continue&quot;);                } catch (InterruptedException e) {                    e.printStackTrace();                }            }        }    }}t1 waitmain sleep(3000)t3 waitt2 waitmain notifyAll()t2 continuet3 continuet1 continue// ç»“æœè¯´æ˜ï¼šå‚è€ƒä¸‹é¢çš„æµç¨‹å›¾ã€‚ (01) ä¸»çº¿ç¨‹ä¸­æ–°å»ºå¹¶ä¸”å¯åŠ¨äº†3ä¸ªçº¿ç¨‹&quot;t1&quot;, &quot;t2&quot;å’Œ&quot;t3&quot;ã€‚(02) ä¸»çº¿ç¨‹é€šè¿‡sleep(3000)ä¼‘çœ 3ç§’ã€‚åœ¨ä¸»çº¿ç¨‹ä¼‘çœ 3ç§’çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å‡è®¾&quot;t1&quot;, &quot;t2&quot;å’Œ&quot;t3&quot;è¿™3ä¸ªçº¿ç¨‹éƒ½è¿è¡Œäº†ã€‚ä»¥&quot;t1&quot;ä¸ºä¾‹ï¼Œå½“å®ƒè¿è¡Œçš„æ—¶å€™ï¼Œå®ƒä¼šæ‰§è¡Œobj.wait()ç­‰å¾…å…¶å®ƒçº¿ç¨‹é€šè¿‡notify()æˆ–é¢nofityAll()æ¥å”¤é†’å®ƒï¼›ç›¸åŒçš„é“ç†ï¼Œ&quot;t2&quot;å’Œ&quot;t3&quot;ä¹Ÿä¼šç­‰å¾…å…¶å®ƒçº¿ç¨‹é€šè¿‡nofity()æˆ–nofityAll()æ¥å”¤é†’å®ƒä»¬ã€‚(03) ä¸»çº¿ç¨‹ä¼‘çœ 3ç§’ä¹‹åï¼Œæ¥ç€è¿è¡Œã€‚æ‰§è¡Œ obj.notifyAll() å”¤é†’objä¸Šçš„ç­‰å¾…çº¿ç¨‹ï¼Œå³å”¤é†’&quot;t1&quot;, &quot;t2&quot;å’Œ&quot;t3&quot;è¿™3ä¸ªçº¿ç¨‹ã€‚ ç´§æ¥ç€ï¼Œä¸»çº¿ç¨‹çš„synchronized(obj)è¿è¡Œå®Œæ¯•ä¹‹åï¼Œä¸»çº¿ç¨‹é‡Šæ”¾â€œobjé”â€ã€‚è¿™æ ·ï¼Œ&quot;t1&quot;, &quot;t2&quot;å’Œ&quot;t3&quot;å°±å¯ä»¥è·å–â€œobjé”â€è€Œç»§ç»­è¿è¡Œäº†ï¼Objectä¸­çš„wait(), notify()ç­‰å‡½æ•°ï¼Œå’Œsynchronizedä¸€æ ·ï¼Œä¼šå¯¹â€œå¯¹è±¡çš„åŒæ­¥é”â€è¿›è¡Œæ“ä½œã€‚wait()ä¼šä½¿â€œå½“å‰çº¿ç¨‹â€ç­‰å¾…ï¼Œå› ä¸ºçº¿ç¨‹è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œæ‰€ä»¥çº¿ç¨‹åº”è¯¥é‡Šæ”¾å®ƒé”æŒæœ‰çš„â€œåŒæ­¥é”â€ï¼Œå¦åˆ™å…¶å®ƒçº¿ç¨‹è·å–ä¸åˆ°è¯¥â€œåŒæ­¥é”â€è€Œæ— æ³•è¿è¡Œï¼OKï¼Œçº¿ç¨‹è°ƒç”¨wait()ä¹‹åï¼Œä¼šé‡Šæ”¾å®ƒé”æŒæœ‰çš„â€œåŒæ­¥é”â€ï¼›è€Œä¸”ï¼Œæ ¹æ®å‰é¢çš„ä»‹ç»ï¼Œæˆ‘ä»¬çŸ¥é“ï¼šç­‰å¾…çº¿ç¨‹å¯ä»¥è¢«notify()æˆ–notifyAll()å”¤é†’ã€‚ç°åœ¨ï¼Œè¯·æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼šnotify()æ˜¯ä¾æ®ä»€ä¹ˆå”¤é†’ç­‰å¾…çº¿ç¨‹çš„ï¼Ÿæˆ–è€…è¯´ï¼Œwait()ç­‰å¾…çº¿ç¨‹å’Œnotify()ä¹‹é—´æ˜¯é€šè¿‡ä»€ä¹ˆå…³è”èµ·æ¥çš„ï¼Ÿç­”æ¡ˆæ˜¯ï¼šä¾æ®â€œå¯¹è±¡çš„åŒæ­¥é”â€ã€‚è´Ÿè´£å”¤é†’ç­‰å¾…çº¿ç¨‹çš„é‚£ä¸ªçº¿ç¨‹(æˆ‘ä»¬ç§°ä¸ºâ€œå”¤é†’çº¿ç¨‹â€)ï¼Œå®ƒåªæœ‰åœ¨è·å–â€œè¯¥å¯¹è±¡çš„åŒæ­¥é”â€(è¿™é‡Œçš„åŒæ­¥é”å¿…é¡»å’Œç­‰å¾…çº¿ç¨‹çš„åŒæ­¥é”æ˜¯åŒä¸€ä¸ª)ï¼Œå¹¶ä¸”è°ƒç”¨notify()æˆ–notifyAll()æ–¹æ³•ä¹‹åï¼Œæ‰èƒ½å”¤é†’ç­‰å¾…çº¿ç¨‹ã€‚è™½ç„¶ï¼Œç­‰å¾…çº¿ç¨‹è¢«å”¤é†’ï¼›ä½†æ˜¯ï¼Œå®ƒä¸èƒ½ç«‹åˆ»æ‰§è¡Œï¼Œå› ä¸ºå”¤é†’çº¿ç¨‹è¿˜æŒæœ‰â€œè¯¥å¯¹è±¡çš„åŒæ­¥é”â€ã€‚å¿…é¡»ç­‰åˆ°å”¤é†’çº¿ç¨‹é‡Šæ”¾äº†â€œå¯¹è±¡çš„åŒæ­¥é”â€ä¹‹åï¼Œç­‰å¾…çº¿ç¨‹æ‰èƒ½è·å–åˆ°â€œå¯¹è±¡çš„åŒæ­¥é”â€è¿›è€Œç»§ç»­è¿è¡Œã€‚æ€»ä¹‹ï¼Œnotify(), wait()ä¾èµ–äºâ€œåŒæ­¥é”â€ï¼Œè€Œâ€œåŒæ­¥é”â€æ˜¯å¯¹è±¡é”æŒæœ‰ï¼Œå¹¶ä¸”æ¯ä¸ªå¯¹è±¡æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªï¼è¿™å°±æ˜¯ä¸ºä»€ä¹ˆnotify(), wait()ç­‰å‡½æ•°å®šä¹‰åœ¨Objectç±»ï¼Œè€Œä¸æ˜¯Threadç±»ä¸­çš„åŸå› ã€‚çº¿ç¨‹è®©æ­¥yield()yield()çš„ä½œç”¨æ˜¯è®©æ­¥ã€‚å®ƒèƒ½è®©å½“å‰çº¿ç¨‹ç”±â€œè¿è¡ŒçŠ¶æ€â€è¿›å…¥åˆ°â€œå°±ç»ªçŠ¶æ€â€ï¼Œä»è€Œè®©å…¶å®ƒå…·æœ‰ç›¸åŒä¼˜å…ˆçº§çš„ç­‰å¾…çº¿ç¨‹è·å–æ‰§è¡Œæƒï¼›ä½†æ˜¯ï¼Œå¹¶ä¸èƒ½ä¿è¯åœ¨å½“å‰çº¿ç¨‹è°ƒç”¨yield()ä¹‹åï¼Œå…¶å®ƒå…·æœ‰ç›¸åŒä¼˜å…ˆçº§çš„çº¿ç¨‹å°±ä¸€å®šèƒ½è·å¾—æ‰§è¡Œæƒï¼›ä¹Ÿæœ‰å¯èƒ½æ˜¯å½“å‰çº¿ç¨‹åˆè¿›å…¥åˆ°â€œè¿è¡ŒçŠ¶æ€â€ç»§ç»­è¿è¡Œï¼12345678910111213141516171819202122232425262728293031323334353637383940414243444546// YieldTest.javaçš„æºç class ThreadA extends Thread{    public ThreadA(String name){         super(name);     }     public synchronized void run(){         for(int i=0; i &lt;10; i++){             System.out.printf(&quot;%s [%d]:%d\n&quot;, this.getName(), this.getPriority(), i);             // iæ•´é™¤4æ—¶ï¼Œè°ƒç”¨yield            if (i%4 == 0)                Thread.yield();        }     } } public class YieldTest{     public static void main(String[] args){         ThreadA t1 = new ThreadA(&quot;t1&quot;);         ThreadA t2 = new ThreadA(&quot;t2&quot;);         t1.start();         t2.start();    } }// ç»“æœè¯´æ˜ï¼šâ€œçº¿ç¨‹t1â€åœ¨èƒ½è¢«4æ•´æ•°çš„æ—¶å€™ï¼Œå¹¶æ²¡æœ‰åˆ‡æ¢åˆ°â€œçº¿ç¨‹t2â€ã€‚è¿™è¡¨æ˜ï¼Œyield()è™½ç„¶å¯ä»¥è®©çº¿ç¨‹ç”±â€œè¿è¡ŒçŠ¶æ€â€è¿›å…¥åˆ°â€œå°±ç»ªçŠ¶æ€â€ï¼›ä½†æ˜¯ï¼Œå®ƒä¸ä¸€å®šä¼šè®©å…¶å®ƒçº¿ç¨‹è·å–CPUæ‰§è¡Œæƒ(å³ï¼Œå…¶å®ƒçº¿ç¨‹è¿›å…¥åˆ°â€œè¿è¡ŒçŠ¶æ€â€)ï¼Œå³ä½¿è¿™ä¸ªâ€œå…¶å®ƒçº¿ç¨‹â€ä¸å½“å‰è°ƒç”¨yield()çš„çº¿ç¨‹å…·æœ‰ç›¸åŒçš„ä¼˜å…ˆçº§ã€‚t1 [5]:0t2 [5]:0t1 [5]:1t1 [5]:2t1 [5]:3t1 [5]:4t1 [5]:5t1 [5]:6t1 [5]:7t1 [5]:8t1 [5]:9t2 [5]:1t2 [5]:2t2 [5]:3t2 [5]:4t2 [5]:5t2 [5]:6t2 [5]:7t2 [5]:8t2 [5]:9yield() ä¸ wait()çš„æ¯”è¾ƒwait()çš„ä½œç”¨æ˜¯è®©å½“å‰çº¿ç¨‹ç”±â€œè¿è¡ŒçŠ¶æ€â€è¿›å…¥â€œç­‰å¾…(é˜»å¡)çŠ¶æ€â€çš„åŒæ—¶ï¼Œä¹Ÿä¼šé‡Šæ”¾åŒæ­¥é”ã€‚è€Œyield()çš„ä½œç”¨æ˜¯è®©æ­¥ï¼Œå®ƒä¹Ÿä¼šè®©å½“å‰çº¿ç¨‹ç¦»å¼€â€œè¿è¡ŒçŠ¶æ€â€ã€‚å®ƒä»¬çš„åŒºåˆ«æ˜¯ï¼š(01) wait()æ˜¯è®©çº¿ç¨‹ç”±â€œè¿è¡ŒçŠ¶æ€â€è¿›å…¥åˆ°â€œç­‰å¾…(é˜»å¡)çŠ¶æ€â€ï¼Œè€Œä¸yield()æ˜¯è®©çº¿ç¨‹ç”±â€œè¿è¡ŒçŠ¶æ€â€è¿›å…¥åˆ°â€œå°±ç»ªçŠ¶æ€â€ã€‚(02) wait()æ˜¯ä¼šçº¿ç¨‹é‡Šæ”¾å®ƒæ‰€æŒæœ‰å¯¹è±¡çš„åŒæ­¥é”ï¼Œè€Œyield()æ–¹æ³•ä¸ä¼šé‡Šæ”¾é”ã€‚123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051// ä¸‹é¢é€šè¿‡ç¤ºä¾‹æ¼”ç¤ºyield()æ˜¯ä¸ä¼šé‡Šæ”¾é”çš„ã€‚// YieldLockTest.java çš„æºç public class YieldLockTest{     private static Object obj = new Object();    public static void main(String[] args){         ThreadA t1 = new ThreadA(&quot;t1&quot;);         ThreadA t2 = new ThreadA(&quot;t2&quot;);         t1.start();         t2.start();    }     static class ThreadA extends Thread{        public ThreadA(String name){             super(name);         }         public void run(){             // è·å–objå¯¹è±¡çš„åŒæ­¥é”            synchronized (obj) {                for(int i=0; i &lt;10; i++){                     System.out.printf(&quot;%s [%d]:%d\n&quot;, this.getName(), this.getPriority(), i);                     // iæ•´é™¤4æ—¶ï¼Œè°ƒç”¨yield                    if (i%4 == 0)                        Thread.yield();                }            }        }     } }// ç»“æœè¯´æ˜ï¼šä¸»çº¿ç¨‹mainä¸­å¯åŠ¨äº†ä¸¤ä¸ªçº¿ç¨‹t1å’Œt2ã€‚t1å’Œt2åœ¨run()ä¼šå¼•ç”¨åŒä¸€ä¸ªå¯¹è±¡çš„åŒæ­¥é”ï¼Œå³synchronized(obj)ã€‚åœ¨t1è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œè™½ç„¶å®ƒä¼šè°ƒç”¨Thread.yield()ï¼›ä½†æ˜¯ï¼Œt2æ˜¯ä¸ä¼šè·å–cpuæ‰§è¡Œæƒçš„ã€‚å› ä¸ºï¼Œt1å¹¶æ²¡æœ‰é‡Šæ”¾â€œobjæ‰€æŒæœ‰çš„åŒæ­¥é”â€ï¼t1 [5]:0t1 [5]:1t1 [5]:2t1 [5]:3t1 [5]:4t1 [5]:5t1 [5]:6t1 [5]:7t1 [5]:8t1 [5]:9t2 [5]:0t2 [5]:1t2 [5]:2t2 [5]:3t2 [5]:4t2 [5]:5t2 [5]:6t2 [5]:7t2 [5]:8t2 [5]:9çº¿ç¨‹ä¼‘çœ sleep()sleep() å®šä¹‰åœ¨Thread.javaä¸­ã€‚sleep() çš„ä½œç”¨æ˜¯è®©å½“å‰çº¿ç¨‹ä¼‘çœ ï¼Œå³å½“å‰çº¿ç¨‹ä¼šä»â€œè¿è¡ŒçŠ¶æ€â€è¿›å…¥åˆ°â€œä¼‘çœ (é˜»å¡)çŠ¶æ€â€ã€‚sleep()ä¼šæŒ‡å®šä¼‘çœ æ—¶é—´ï¼Œçº¿ç¨‹ä¼‘çœ çš„æ—¶é—´ä¼šå¤§äº/ç­‰äºè¯¥ä¼‘çœ æ—¶é—´ï¼›åœ¨çº¿ç¨‹é‡æ–°è¢«å”¤é†’æ—¶ï¼Œå®ƒä¼šç”±â€œé˜»å¡çŠ¶æ€â€å˜æˆâ€œå°±ç»ªçŠ¶æ€â€ï¼Œä»è€Œç­‰å¾…cpuçš„è°ƒåº¦æ‰§è¡Œã€‚1234567891011121314151617181920212223242526272829303132333435363738// SleepTest.javaçš„æºç class ThreadA extends Thread{    public ThreadA(String name){         super(name);     }     public synchronized void run() {         try {            for(int i=0; i &lt;10; i++){                 System.out.printf(&quot;%s: %d\n&quot;, this.getName(), i);                 // ièƒ½è¢«4æ•´é™¤æ—¶ï¼Œä¼‘çœ 100æ¯«ç§’                if (i%4 == 0)                    Thread.sleep(100);            }         } catch (InterruptedException e) {            e.printStackTrace();        }    } } public class SleepTest{     public static void main(String[] args){         ThreadA t1 = new ThreadA(&quot;t1&quot;);         t1.start();     } }// ç»“æœè¯´æ˜ï¼šç¨‹åºæ¯”è¾ƒç®€å•ï¼Œåœ¨ä¸»çº¿ç¨‹mainä¸­å¯åŠ¨çº¿ç¨‹t1ã€‚t1å¯åŠ¨ä¹‹åï¼Œå½“t1ä¸­çš„è®¡ç®—ièƒ½è¢«4æ•´é™¤æ—¶ï¼Œt1ä¼šé€šè¿‡Thread.sleep(100)ä¼‘çœ 100æ¯«ç§’ã€‚t1: 0t1: 1t1: 2t1: 3t1: 4t1: 5t1: 6t1: 7t1: 8t1: 9sleep() ä¸ wait()çš„æ¯”è¾ƒwait()çš„ä½œç”¨æ˜¯è®©å½“å‰çº¿ç¨‹ç”±â€œè¿è¡ŒçŠ¶æ€â€è¿›å…¥â€œç­‰å¾…(é˜»å¡)çŠ¶æ€â€çš„åŒæ—¶ï¼Œä¹Ÿä¼šé‡Šæ”¾åŒæ­¥é”ã€‚è€Œsleep()çš„ä½œç”¨æ˜¯ä¹Ÿæ˜¯è®©å½“å‰çº¿ç¨‹ç”±â€œè¿è¡ŒçŠ¶æ€â€è¿›å…¥åˆ°â€œä¼‘çœ (é˜»å¡)çŠ¶æ€â€ã€‚ä½†æ˜¯ï¼Œwait()ä¼šé‡Šæ”¾å¯¹è±¡çš„åŒæ­¥é”ï¼Œè€Œsleep()åˆ™ä¸ä¼šé‡Šæ”¾é”ã€‚12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455// SleepLockTest.javaçš„æºç public class SleepLockTest{     private static Object obj = new Object();    public static void main(String[] args){         ThreadA t1 = new ThreadA(&quot;t1&quot;);         ThreadA t2 = new ThreadA(&quot;t2&quot;);         t1.start();         t2.start();    }     static class ThreadA extends Thread{        public ThreadA(String name){             super(name);         }         public void run(){             // è·å–objå¯¹è±¡çš„åŒæ­¥é”            synchronized (obj) {                try {                    for(int i=0; i &lt;10; i++){                         System.out.printf(&quot;%s: %d\n&quot;, this.getName(), i);                         // ièƒ½è¢«4æ•´é™¤æ—¶ï¼Œä¼‘çœ 100æ¯«ç§’                        if (i%4 == 0)                            Thread.sleep(100);                    }                } catch (InterruptedException e) {                    e.printStackTrace();                }            }        }     } }// ç»“æœè¯´æ˜ï¼šä¸»çº¿ç¨‹mainä¸­å¯åŠ¨äº†ä¸¤ä¸ªçº¿ç¨‹t1å’Œt2ã€‚t1å’Œt2åœ¨run()ä¼šå¼•ç”¨åŒä¸€ä¸ªå¯¹è±¡çš„åŒæ­¥é”ï¼Œå³synchronized(obj)ã€‚åœ¨t1è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œè™½ç„¶å®ƒä¼šè°ƒç”¨Thread.sleep(100)ï¼›ä½†æ˜¯ï¼Œt2æ˜¯ä¸ä¼šè·å–cpuæ‰§è¡Œæƒçš„ã€‚å› ä¸ºï¼Œt1å¹¶æ²¡æœ‰é‡Šæ”¾â€œobjæ‰€æŒæœ‰çš„åŒæ­¥é”â€ï¼æ³¨æ„ï¼Œè‹¥æˆ‘ä»¬æ³¨é‡Šæ‰synchronized (obj)åå†æ¬¡æ‰§è¡Œè¯¥ç¨‹åºï¼Œt1å’Œt2æ˜¯å¯ä»¥ç›¸äº’åˆ‡æ¢çš„ã€‚t1: 0t1: 1t1: 2t1: 3t1: 4t1: 5t1: 6t1: 7t1: 8t1: 9t2: 0t2: 1t2: 2t2: 3t2: 4t2: 5t2: 6t2: 7t2: 8t2: 9join() æ–¹æ³•join() çš„ä½œç”¨ï¼šè®©â€œä¸»çº¿ç¨‹â€ç­‰å¾…â€œå­çº¿ç¨‹â€ç»“æŸä¹‹åæ‰èƒ½ç»§ç»­è¿è¡Œã€‚1234567891011121314151617181920212223// ä¸»çº¿ç¨‹public class Father extends Thread {    public void run() {        Son s = new Son();        s.start();        s.join();        ...    }}// å­çº¿ç¨‹public class Son extends Thread {    public void run() {        ...    }}// è¯´æ˜ï¼šä¸Šé¢çš„æœ‰ä¸¤ä¸ªç±»Father(ä¸»çº¿ç¨‹ç±»)å’ŒSon(å­çº¿ç¨‹ç±»)ã€‚å› ä¸ºSonæ˜¯åœ¨Fatherä¸­åˆ›å»ºå¹¶å¯åŠ¨çš„ï¼Œæ‰€ä»¥ï¼ŒFatheræ˜¯ä¸»çº¿ç¨‹ç±»ï¼ŒSonæ˜¯å­çº¿ç¨‹ç±»ã€‚åœ¨Fatherä¸»çº¿ç¨‹ä¸­ï¼Œé€šè¿‡new Son()æ–°å»ºâ€œå­çº¿ç¨‹sâ€ã€‚æ¥ç€é€šè¿‡s.start()å¯åŠ¨â€œå­çº¿ç¨‹sâ€ï¼Œå¹¶ä¸”è°ƒç”¨s.join()ã€‚åœ¨è°ƒç”¨s.join()ä¹‹åï¼ŒFatherä¸»çº¿ç¨‹ä¼šä¸€ç›´ç­‰å¾…ï¼Œç›´åˆ°â€œå­çº¿ç¨‹sâ€è¿è¡Œå®Œæ¯•ï¼›åœ¨â€œå­çº¿ç¨‹sâ€è¿è¡Œå®Œæ¯•ä¹‹åï¼ŒFatherä¸»çº¿ç¨‹æ‰èƒ½æ¥ç€è¿è¡Œã€‚ è¿™ä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„â€œjoin()çš„ä½œç”¨ï¼Œæ˜¯è®©ä¸»çº¿ç¨‹ä¼šç­‰å¾…å­çº¿ç¨‹ç»“æŸä¹‹åæ‰èƒ½ç»§ç»­è¿è¡Œâ€ï¼// é—®é¢˜ï¼šè™½ç„¶s.join()è¢«è°ƒç”¨çš„åœ°æ–¹æ˜¯å‘ç”Ÿåœ¨â€œFatherä¸»çº¿ç¨‹â€ä¸­ï¼Œä½†æ˜¯s.join()æ˜¯é€šè¿‡â€œå­çº¿ç¨‹sâ€å»è°ƒç”¨çš„join()ã€‚é‚£ä¹ˆï¼Œjoin()æ–¹æ³•ä¸­çš„isAlive()åº”è¯¥æ˜¯åˆ¤æ–­â€œå­çº¿ç¨‹sâ€æ˜¯ä¸æ˜¯AliveçŠ¶æ€ï¼›å¯¹åº”çš„wait(0)ä¹Ÿåº”è¯¥æ˜¯â€œè®©å­çº¿ç¨‹sâ€ç­‰å¾…æ‰å¯¹ã€‚ä½†å¦‚æœæ˜¯è¿™æ ·çš„è¯ï¼Œs.join()çš„ä½œç”¨æ€ä¹ˆå¯èƒ½æ˜¯â€œè®©ä¸»çº¿ç¨‹ç­‰å¾…ï¼Œç›´åˆ°å­çº¿ç¨‹så®Œæˆä¸ºæ­¢â€å‘¢ï¼Œåº”è¯¥æ˜¯è®©&quot;å­çº¿ç¨‹ç­‰å¾…æ‰å¯¹(å› ä¸ºè°ƒç”¨å­çº¿ç¨‹å¯¹è±¡sçš„waitæ–¹æ³•å˜›)&quot;ï¼Ÿç­”æ¡ˆï¼šwait()çš„ä½œç”¨æ˜¯è®©â€œå½“å‰çº¿ç¨‹â€ç­‰å¾…ï¼Œè€Œè¿™é‡Œçš„â€œå½“å‰çº¿ç¨‹â€æ˜¯æŒ‡å½“å‰åœ¨CPUä¸Šè¿è¡Œçš„çº¿ç¨‹ã€‚æ‰€ä»¥ï¼Œè™½ç„¶æ˜¯è°ƒç”¨å­çº¿ç¨‹çš„wait()æ–¹æ³•ï¼Œä½†æ˜¯å®ƒæ˜¯é€šè¿‡â€œä¸»çº¿ç¨‹â€å»è°ƒç”¨çš„ï¼›æ‰€ä»¥ï¼Œä¼‘çœ çš„æ˜¯ä¸»çº¿ç¨‹ï¼Œè€Œä¸æ˜¯â€œå­çº¿ç¨‹â€ï¼12345678910111213141516171819202122232425262728293031323334// JoinTest.javaçš„æºç public class JoinTest{     public static void main(String[] args){         try {            ThreadA t1 = new ThreadA(&quot;t1&quot;); // æ–°å»ºâ€œçº¿ç¨‹t1â€            t1.start();                     // å¯åŠ¨â€œçº¿ç¨‹t1â€            t1.join();                        // å°†â€œçº¿ç¨‹t1â€åŠ å…¥åˆ°â€œä¸»çº¿ç¨‹mainâ€ä¸­ï¼Œå¹¶ä¸”â€œä¸»çº¿ç¨‹main()ä¼šç­‰å¾…å®ƒçš„å®Œæˆâ€            System.out.printf(&quot;%s finish\n&quot;, Thread.currentThread().getName());         } catch (InterruptedException e) {            e.printStackTrace();        }    }     static class ThreadA extends Thread{        public ThreadA(String name){             super(name);         }         public void run(){             System.out.printf(&quot;%s start\n&quot;, this.getName());             // å»¶æ—¶æ“ä½œ            for(int i=0; i &lt;1000000; i++) ;            System.out.printf(&quot;%s finish\n&quot;, this.getName());         }     } }// ç»“æœè¯´æ˜ï¼šè¿è¡Œæµç¨‹å¦‚å›¾ (01) åœ¨â€œä¸»çº¿ç¨‹mainâ€ä¸­é€šè¿‡ new ThreadA(&quot;t1&quot;) æ–°å»ºâ€œçº¿ç¨‹t1â€ã€‚ æ¥ç€ï¼Œé€šè¿‡ t1.start() å¯åŠ¨â€œçº¿ç¨‹t1â€ï¼Œå¹¶æ‰§è¡Œt1.join()ã€‚(02) æ‰§è¡Œt1.join()ä¹‹åï¼Œâ€œä¸»çº¿ç¨‹mainâ€ä¼šè¿›å…¥â€œé˜»å¡çŠ¶æ€â€ç­‰å¾…t1è¿è¡Œç»“æŸã€‚â€œå­çº¿ç¨‹t1â€ç»“æŸä¹‹åï¼Œä¼šå”¤é†’â€œä¸»çº¿ç¨‹mainâ€ï¼Œâ€œä¸»çº¿ç¨‹â€é‡æ–°è·å–cpuæ‰§è¡Œæƒï¼Œç»§ç»­è¿è¡Œã€‚t1 startt1 finishmain finishinterrupt()å’Œçº¿ç¨‹ç»ˆæ­¢æ–¹å¼123456789101112131415// å…³äºinterrupt()ï¼Œjavaçš„djkæ–‡æ¡£æè¿°å¦‚ä¸‹ï¼šhttp://docs.oracle.com/javase/7/docs/api/Interrupts this thread.Unless the current thread is interrupting itself, which is always permitted, the checkAccess method of this thread is invoked, which may cause a SecurityException to be thrown.If this thread is blocked in an invocation of the wait(), wait(long), or wait(long, int) methods of the Object class, or of the join(), join(long), join(long, int), sleep(long), or sleep(long, int), methods of this class, then its interrupt status will be cleared and it will receive an InterruptedException.If this thread is blocked in an I/O operation upon an interruptible channel then the channel will be closed, the thread's interrupt status will be set, and the thread will receive a ClosedByInterruptException.If this thread is blocked in a Selector then the thread's interrupt status will be set and it will return immediately from the selection operation, possibly with a non-zero value, just as if the selector's wakeup method were invoked.If none of the previous conditions hold then this thread's interrupt status will be set.Interrupting a thread that is not alive need not have any effect.interrupt()çš„ä½œç”¨æ˜¯ä¸­æ–­æœ¬çº¿ç¨‹ã€‚æœ¬çº¿ç¨‹ä¸­æ–­è‡ªå·±æ˜¯è¢«å…è®¸çš„ï¼›å…¶å®ƒçº¿ç¨‹è°ƒç”¨æœ¬çº¿ç¨‹çš„interrupt()æ–¹æ³•æ—¶ï¼Œä¼šé€šè¿‡checkAccess()æ£€æŸ¥æƒé™ã€‚è¿™æœ‰å¯èƒ½æŠ›å‡ºSecurityExceptionå¼‚å¸¸ã€‚å¦‚æœæœ¬çº¿ç¨‹æ˜¯å¤„äºé˜»å¡çŠ¶æ€ï¼šè°ƒç”¨çº¿ç¨‹çš„wait(), wait(long)æˆ–wait(long, int)ä¼šè®©å®ƒè¿›å…¥ç­‰å¾…(é˜»å¡)çŠ¶æ€ï¼Œæˆ–è€…è°ƒç”¨çº¿ç¨‹çš„join(), join(long), join(long, int), sleep(long), sleep(long, int)ä¹Ÿä¼šè®©å®ƒè¿›å…¥é˜»å¡çŠ¶æ€ã€‚è‹¥çº¿ç¨‹åœ¨é˜»å¡çŠ¶æ€æ—¶ï¼Œè°ƒç”¨äº†å®ƒçš„interrupt()æ–¹æ³•ï¼Œé‚£ä¹ˆå®ƒçš„â€œä¸­æ–­çŠ¶æ€â€ä¼šè¢«æ¸…é™¤å¹¶ä¸”ä¼šæ”¶åˆ°ä¸€ä¸ªInterruptedExceptionå¼‚å¸¸ã€‚ä¾‹å¦‚ï¼Œçº¿ç¨‹é€šè¿‡wait()è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œæ­¤æ—¶é€šè¿‡interrupt()ä¸­æ–­è¯¥çº¿ç¨‹ï¼›è°ƒç”¨interrupt()ä¼šç«‹å³å°†çº¿ç¨‹çš„ä¸­æ–­æ ‡è®°è®¾ä¸ºâ€œtrueâ€ï¼Œä½†æ˜¯ç”±äºçº¿ç¨‹å¤„äºé˜»å¡çŠ¶æ€ï¼Œæ‰€ä»¥è¯¥â€œä¸­æ–­æ ‡è®°â€ä¼šç«‹å³è¢«æ¸…é™¤ä¸ºâ€œfalseâ€ï¼ŒåŒæ—¶ï¼Œä¼šäº§ç”Ÿä¸€ä¸ªInterruptedExceptionçš„å¼‚å¸¸ã€‚å¦‚æœçº¿ç¨‹è¢«é˜»å¡åœ¨ä¸€ä¸ªSelectoré€‰æ‹©å™¨ä¸­ï¼Œé‚£ä¹ˆé€šè¿‡interrupt()ä¸­æ–­å®ƒæ—¶ï¼›çº¿ç¨‹çš„ä¸­æ–­æ ‡è®°ä¼šè¢«è®¾ç½®ä¸ºtrueï¼Œå¹¶ä¸”å®ƒä¼šç«‹å³ä»é€‰æ‹©æ“ä½œä¸­è¿”å›ã€‚å¦‚æœä¸å±äºå‰é¢æ‰€è¯´çš„æƒ…å†µï¼Œé‚£ä¹ˆé€šè¿‡interrupt()ä¸­æ–­çº¿ç¨‹æ—¶ï¼Œå®ƒçš„ä¸­æ–­æ ‡è®°ä¼šè¢«è®¾ç½®ä¸ºâ€œtrueâ€ã€‚ä¸­æ–­ä¸€ä¸ªâ€œå·²ç»ˆæ­¢çš„çº¿ç¨‹â€ä¸ä¼šäº§ç”Ÿä»»ä½•æ“ä½œã€‚ç»ˆæ­¢çº¿ç¨‹çš„æ–¹å¼Threadä¸­çš„stop()å’Œsuspend()æ–¹æ³•ï¼Œç”±äºå›ºæœ‰çš„ä¸å®‰å…¨æ€§ï¼Œå·²ç»å»ºè®®ä¸å†ä½¿ç”¨ï¼ç»ˆæ­¢å¤„äºâ€œé˜»å¡çŠ¶æ€â€çš„çº¿ç¨‹12345678910111213141516é€šå¸¸ï¼Œæˆ‘ä»¬é€šè¿‡â€œä¸­æ–­â€æ–¹å¼ç»ˆæ­¢å¤„äºâ€œé˜»å¡çŠ¶æ€â€çš„çº¿ç¨‹ã€‚å½“çº¿ç¨‹ç”±äºè¢«è°ƒç”¨äº†sleep(), wait(), join()ç­‰æ–¹æ³•è€Œè¿›å…¥é˜»å¡çŠ¶æ€ï¼›è‹¥æ­¤æ—¶è°ƒç”¨çº¿ç¨‹çš„interrupt()å°†çº¿ç¨‹çš„ä¸­æ–­æ ‡è®°è®¾ä¸ºtrueã€‚ç”±äºå¤„äºé˜»å¡çŠ¶æ€ï¼Œä¸­æ–­æ ‡è®°ä¼šè¢«æ¸…é™¤ï¼ŒåŒæ—¶äº§ç”Ÿä¸€ä¸ªInterruptedExceptionå¼‚å¸¸ã€‚å°†InterruptedExceptionæ”¾åœ¨é€‚å½“çš„ä¸ºæ­¢å°±èƒ½ç»ˆæ­¢çº¿ç¨‹ï¼Œå½¢å¼å¦‚ä¸‹ï¼š@Overridepublic void run() {    try {        while (true) {            // æ‰§è¡Œä»»åŠ¡...        }    } catch (InterruptedException ie) {          // ç”±äºäº§ç”ŸInterruptedExceptionå¼‚å¸¸ï¼Œé€€å‡ºwhile(true)å¾ªç¯ï¼Œçº¿ç¨‹ç»ˆæ­¢ï¼    }}è¯´æ˜ï¼šåœ¨while(true)ä¸­ä¸æ–­çš„æ‰§è¡Œä»»åŠ¡ï¼Œå½“çº¿ç¨‹å¤„äºé˜»å¡çŠ¶æ€æ—¶ï¼Œè°ƒç”¨çº¿ç¨‹çš„interrupt()äº§ç”ŸInterruptedExceptionä¸­æ–­ã€‚ä¸­æ–­çš„æ•è·åœ¨while(true)ä¹‹å¤–ï¼Œè¿™æ ·å°±é€€å‡ºäº†while(true)å¾ªç¯ï¼æ³¨æ„ï¼šå¯¹InterruptedExceptionçš„æ•è·åŠ¡ä¸€èˆ¬æ”¾åœ¨while(true)å¾ªç¯ä½“çš„å¤–é¢ï¼Œè¿™æ ·ï¼Œåœ¨äº§ç”Ÿå¼‚å¸¸æ—¶å°±é€€å‡ºäº†while(true)å¾ªç¯ã€‚å¦åˆ™ï¼ŒInterruptedExceptionåœ¨while(true)å¾ªç¯ä½“ä¹‹å†…ï¼Œå°±éœ€è¦é¢å¤–çš„æ·»åŠ é€€å‡ºå¤„ç†ã€‚ç»ˆæ­¢å¤„äºâ€œè¿è¡ŒçŠ¶æ€â€çš„çº¿ç¨‹1234567891011121314151617181920212223242526272829303132333435363738é€šå¸¸ï¼Œæˆ‘ä»¬é€šè¿‡â€œæ ‡è®°â€æ–¹å¼ç»ˆæ­¢å¤„äºâ€œè¿è¡ŒçŠ¶æ€â€çš„çº¿ç¨‹ã€‚å…¶ä¸­ï¼ŒåŒ…æ‹¬â€œä¸­æ–­æ ‡è®°â€å’Œâ€œé¢å¤–æ·»åŠ æ ‡è®°â€ã€‚// (01) é€šè¿‡â€œä¸­æ–­æ ‡è®°â€ç»ˆæ­¢çº¿ç¨‹ã€‚@Overridepublic void run() {    while (!isInterrupted()) {        // æ‰§è¡Œä»»åŠ¡...    }}è¯´æ˜ï¼šisInterrupted()æ˜¯åˆ¤æ–­çº¿ç¨‹çš„ä¸­æ–­æ ‡è®°æ˜¯ä¸æ˜¯ä¸ºtrueã€‚å½“çº¿ç¨‹å¤„äºè¿è¡ŒçŠ¶æ€ï¼Œå¹¶ä¸”æˆ‘ä»¬éœ€è¦ç»ˆæ­¢å®ƒæ—¶ï¼›å¯ä»¥è°ƒç”¨çº¿ç¨‹çš„interrupt()æ–¹æ³•ï¼Œä½¿ç”¨çº¿ç¨‹çš„ä¸­æ–­æ ‡è®°ä¸ºtrueï¼Œå³isInterrupted()ä¼šè¿”å›trueã€‚æ­¤æ—¶ï¼Œå°±ä¼šé€€å‡ºwhileå¾ªç¯ã€‚æ³¨æ„ï¼šinterrupt()å¹¶ä¸ä¼šç»ˆæ­¢å¤„äºâ€œè¿è¡ŒçŠ¶æ€â€çš„çº¿ç¨‹ï¼å®ƒä¼šå°†çº¿ç¨‹çš„ä¸­æ–­æ ‡è®°è®¾ä¸ºtrueã€‚// (02) é€šè¿‡â€œé¢å¤–æ·»åŠ æ ‡è®°â€ã€‚private volatile boolean flag= true;protected void stopTask() {    flag = false;}@Overridepublic void run() {    while (flag) {        // æ‰§è¡Œä»»åŠ¡...    }}è¯´æ˜ï¼šçº¿ç¨‹ä¸­æœ‰ä¸€ä¸ªflagæ ‡è®°ï¼Œå®ƒçš„é»˜è®¤å€¼æ˜¯trueï¼›å¹¶ä¸”æˆ‘ä»¬æä¾›stopTask()æ¥è®¾ç½®flagæ ‡è®°ã€‚å½“æˆ‘ä»¬éœ€è¦ç»ˆæ­¢è¯¥çº¿ç¨‹æ—¶ï¼Œè°ƒç”¨è¯¥çº¿ç¨‹çš„stopTask()æ–¹æ³•å°±å¯ä»¥è®©çº¿ç¨‹é€€å‡ºwhileå¾ªç¯ã€‚æ³¨æ„ï¼šå°†flagå®šä¹‰ä¸ºvolatileç±»å‹ï¼Œæ˜¯ä¸ºäº†ä¿è¯flagçš„å¯è§æ€§ã€‚å³å…¶å®ƒçº¿ç¨‹é€šè¿‡stopTask()ä¿®æ”¹äº†flagä¹‹åï¼Œæœ¬çº¿ç¨‹èƒ½çœ‹åˆ°ä¿®æ”¹åçš„flagçš„å€¼ã€‚// ç»¼åˆçº¿ç¨‹å¤„äºâ€œé˜»å¡çŠ¶æ€â€å’Œâ€œè¿è¡ŒçŠ¶æ€â€çš„ç»ˆæ­¢æ–¹å¼ï¼Œæ¯”è¾ƒé€šç”¨çš„ç»ˆæ­¢çº¿ç¨‹çš„å½¢å¼å¦‚ä¸‹ï¼š@Overridepublic void run() {    try {        // 1. isInterrupted()ä¿è¯ï¼Œåªè¦ä¸­æ–­æ ‡è®°ä¸ºtrueå°±ç»ˆæ­¢çº¿ç¨‹ã€‚        while (!isInterrupted()) {            // æ‰§è¡Œä»»åŠ¡...        }    } catch (InterruptedException ie) {          // 2. InterruptedExceptionå¼‚å¸¸ä¿è¯ï¼Œå½“InterruptedExceptionå¼‚å¸¸äº§ç”Ÿæ—¶ï¼Œçº¿ç¨‹è¢«ç»ˆæ­¢ã€‚    }}ç»ˆæ­¢çº¿ç¨‹çš„ç¤ºä¾‹1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253// ç»ˆæ­¢çº¿ç¨‹çš„ç¤ºä¾‹// interrupt()å¸¸å¸¸è¢«ç”¨æ¥ç»ˆæ­¢â€œé˜»å¡çŠ¶æ€â€çº¿ç¨‹ã€‚// Demo1.javaçš„æºç class MyThread extends Thread {    public MyThread(String name) {        super(name);    }    @Override    public void run() {        try {              int i=0;            while (!isInterrupted()) {                Thread.sleep(100); // ä¼‘çœ 100ms                i++;                System.out.println(Thread.currentThread().getName()+&quot; (&quot;+this.getState()+&quot;) loop &quot; + i);              }        } catch (InterruptedException e) {              System.out.println(Thread.currentThread().getName() +&quot; (&quot;+this.getState()+&quot;) catch InterruptedException.&quot;);          }    }}public class Demo1 {    public static void main(String[] args) {          try {              Thread t1 = new MyThread(&quot;t1&quot;);  // æ–°å»ºâ€œçº¿ç¨‹t1â€            System.out.println(t1.getName() +&quot; (&quot;+t1.getState()+&quot;) is new.&quot;);              t1.start();                      // å¯åŠ¨â€œçº¿ç¨‹t1â€            System.out.println(t1.getName() +&quot; (&quot;+t1.getState()+&quot;) is started.&quot;);              // ä¸»çº¿ç¨‹ä¼‘çœ 300msï¼Œç„¶åä¸»çº¿ç¨‹ç»™t1å‘â€œä¸­æ–­â€æŒ‡ä»¤ã€‚            Thread.sleep(300);            t1.interrupt();            System.out.println(t1.getName() +&quot; (&quot;+t1.getState()+&quot;) is interrupted.&quot;);            // ä¸»çº¿ç¨‹ä¼‘çœ 300msï¼Œç„¶åæŸ¥çœ‹t1çš„çŠ¶æ€ã€‚            Thread.sleep(300);            System.out.println(t1.getName() +&quot; (&quot;+t1.getState()+&quot;) is interrupted now.&quot;);        } catch (InterruptedException e) {              e.printStackTrace();        }    } }// ç»“æœè¯´æ˜ï¼š(01) ä¸»çº¿ç¨‹mainä¸­é€šè¿‡new MyThread(&quot;t1&quot;)åˆ›å»ºçº¿ç¨‹t1ï¼Œä¹‹åé€šè¿‡t1.start()å¯åŠ¨çº¿ç¨‹t1ã€‚(02) t1å¯åŠ¨ä¹‹åï¼Œä¼šä¸æ–­çš„æ£€æŸ¥å®ƒçš„ä¸­æ–­æ ‡è®°ï¼Œå¦‚æœä¸­æ–­æ ‡è®°ä¸ºâ€œfalseâ€ï¼›åˆ™ä¼‘çœ 100msã€‚(03) t1ä¼‘çœ ä¹‹åï¼Œä¼šåˆ‡æ¢åˆ°ä¸»çº¿ç¨‹mainï¼›ä¸»çº¿ç¨‹å†æ¬¡è¿è¡Œæ—¶ï¼Œä¼šæ‰§è¡Œt1.interrupt()ä¸­æ–­çº¿ç¨‹t1ã€‚t1æ”¶åˆ°ä¸­æ–­æŒ‡ä»¤ä¹‹åï¼Œä¼šå°†t1çš„ä¸­æ–­æ ‡è®°è®¾ç½®â€œfalseâ€ï¼Œè€Œä¸”ä¼šæŠ›å‡ºInterruptedExceptionå¼‚å¸¸ã€‚åœ¨t1çš„run()æ–¹æ³•ä¸­ï¼Œæ˜¯åœ¨å¾ªç¯ä½“whileä¹‹å¤–æ•è·çš„å¼‚å¸¸ï¼›å› æ­¤å¾ªç¯è¢«ç»ˆæ­¢ã€‚t1 (NEW) is new.t1 (RUNNABLE) is started.t1 (RUNNABLE) loop 1t1 (RUNNABLE) loop 2t1 (TIMED_WAITING) is interrupted.t1 (RUNNABLE) catch InterruptedException.t1 (TERMINATED) is interrupted now.1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253// é€šè¿‡â€œé¢å¤–æ·»åŠ æ ‡è®°â€çš„æ–¹å¼ç»ˆæ­¢â€œçŠ¶æ€çŠ¶æ€â€çš„çº¿ç¨‹çš„ç¤ºä¾‹// Demo3.javaçš„æºç class MyThread extends Thread {    private volatile boolean flag= true;    public void stopTask() {        flag = false;    }    public MyThread(String name) {        super(name);    }    @Override    public void run() {        synchronized(this) {            try {                int i=0;                while (flag) {                    Thread.sleep(100); // ä¼‘çœ 100ms                    i++;                    System.out.println(Thread.currentThread().getName()+&quot; (&quot;+this.getState()+&quot;) loop &quot; + i);                  }            } catch (InterruptedException ie) {                  System.out.println(Thread.currentThread().getName() +&quot; (&quot;+this.getState()+&quot;) catch InterruptedException.&quot;);              }        }      }}public class Demo3 {    public static void main(String[] args) {          try {              MyThread t1 = new MyThread(&quot;t1&quot;);  // æ–°å»ºâ€œçº¿ç¨‹t1â€            System.out.println(t1.getName() +&quot; (&quot;+t1.getState()+&quot;) is new.&quot;);              t1.start();                      // å¯åŠ¨â€œçº¿ç¨‹t1â€            System.out.println(t1.getName() +&quot; (&quot;+t1.getState()+&quot;) is started.&quot;);              // ä¸»çº¿ç¨‹ä¼‘çœ 300msï¼Œç„¶åä¸»çº¿ç¨‹ç»™t1å‘â€œä¸­æ–­â€æŒ‡ä»¤ã€‚            Thread.sleep(300);            t1.stopTask();            System.out.println(t1.getName() +&quot; (&quot;+t1.getState()+&quot;) is interrupted.&quot;);            // ä¸»çº¿ç¨‹ä¼‘çœ 300msï¼Œç„¶åæŸ¥çœ‹t1çš„çŠ¶æ€ã€‚            Thread.sleep(300);            System.out.println(t1.getName() +&quot; (&quot;+t1.getState()+&quot;) is interrupted now.&quot;);        } catch (InterruptedException e) {              e.printStackTrace();        }    } }t1 (NEW) is new.t1 (RUNNABLE) is started.t1 (RUNNABLE) loop 1t1 (RUNNABLE) loop 2t1 (TIMED_WAITING) is interrupted.t1 (RUNNABLE) loop 3t1 (TERMINATED) is interrupted now.interrupted() å’Œ isInterrupted()éƒ½èƒ½å¤Ÿç”¨äºæ£€æµ‹å¯¹è±¡çš„â€œä¸­æ–­æ ‡è®°â€ã€‚åŒºåˆ«æ˜¯ï¼Œinterrupted()é™¤äº†è¿”å›ä¸­æ–­æ ‡è®°ä¹‹å¤–ï¼Œå®ƒè¿˜ä¼šæ¸…é™¤ä¸­æ–­æ ‡è®°(å³å°†ä¸­æ–­æ ‡è®°è®¾ä¸ºfalse)ï¼›è€ŒisInterrupted()ä»…ä»…è¿”å›ä¸­æ–­æ ‡è®°ã€‚çº¿ç¨‹ä¼˜å…ˆçº§å’Œå®ˆæŠ¤çº¿ç¨‹java ä¸­çš„çº¿ç¨‹ä¼˜å…ˆçº§çš„èŒƒå›´æ˜¯1ï½10ï¼Œé»˜è®¤çš„ä¼˜å…ˆçº§æ˜¯5ã€‚â€œé«˜ä¼˜å…ˆçº§çº¿ç¨‹â€ä¼šä¼˜å…ˆäºâ€œä½ä¼˜å…ˆçº§çº¿ç¨‹â€æ‰§è¡Œã€‚java ä¸­æœ‰ä¸¤ç§çº¿ç¨‹ï¼šç”¨æˆ·çº¿ç¨‹å’Œå®ˆæŠ¤çº¿ç¨‹ã€‚å¯ä»¥é€šè¿‡isDaemon()æ–¹æ³•æ¥åŒºåˆ«å®ƒä»¬ï¼šå¦‚æœè¿”å›falseï¼Œåˆ™è¯´æ˜è¯¥çº¿ç¨‹æ˜¯â€œç”¨æˆ·çº¿ç¨‹â€ï¼›å¦åˆ™å°±æ˜¯â€œå®ˆæŠ¤çº¿ç¨‹â€ã€‚ç”¨æˆ·çº¿ç¨‹ä¸€èˆ¬ç”¨æˆ·æ‰§è¡Œç”¨æˆ·çº§ä»»åŠ¡ï¼Œè€Œå®ˆæŠ¤çº¿ç¨‹ä¹Ÿå°±æ˜¯â€œåå°çº¿ç¨‹â€ï¼Œä¸€èˆ¬ç”¨æ¥æ‰§è¡Œåå°ä»»åŠ¡ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼šJavaè™šæ‹Ÿæœºåœ¨â€œç”¨æˆ·çº¿ç¨‹â€éƒ½ç»“æŸåä¼šåé€€å‡ºã€‚JDK ä¸­å…³äºçº¿ç¨‹ä¼˜å…ˆçº§å’Œå®ˆæŠ¤çº¿ç¨‹çš„ä»‹ç»å¦‚ä¸‹ï¼š123456789101112131415Every thread has a priority. Threads with higher priority are executed in preference to threads with lower priority. Each thread may or may not also be marked as a daemon. When code running in some thread creates a new Thread object, the new thread has its priority initially set equal to the priority of the creating thread, and is a daemon thread if and only if the creating thread is a daemon.When a Java Virtual Machine starts up, there is usually a single non-daemon thread (which typically calls the method named main of some designated class). The Java Virtual Machine continues to execute threads until either of the following occurs:The exit method of class Runtime has been called and the security manager has permitted the exit operation to take place.All threads that are not daemon threads have died, either by returning from the call to the run method or by throwing an exception that propagates beyond the run method. Marks this thread as either a daemon thread or a user thread. The Java Virtual Machine exits when the only threads running are all daemon threads.æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªä¼˜å…ˆçº§ã€‚â€œé«˜ä¼˜å…ˆçº§çº¿ç¨‹â€ä¼šä¼˜å…ˆäºâ€œä½ä¼˜å…ˆçº§çº¿ç¨‹â€æ‰§è¡Œã€‚æ¯ä¸ªçº¿ç¨‹éƒ½å¯ä»¥è¢«æ ‡è®°ä¸ºä¸€ä¸ªå®ˆæŠ¤è¿›ç¨‹æˆ–éå®ˆæŠ¤è¿›ç¨‹ã€‚åœ¨ä¸€äº›è¿è¡Œçš„ä¸»çº¿ç¨‹ä¸­åˆ›å»ºæ–°çš„å­çº¿ç¨‹æ—¶ï¼Œå­çº¿ç¨‹çš„ä¼˜å…ˆçº§è¢«è®¾ç½®ä¸ºç­‰äºâ€œåˆ›å»ºå®ƒçš„ä¸»çº¿ç¨‹çš„ä¼˜å…ˆçº§â€ï¼Œå½“ä¸”ä»…å½“â€œåˆ›å»ºå®ƒçš„ä¸»çº¿ç¨‹æ˜¯å®ˆæŠ¤çº¿ç¨‹â€æ—¶â€œå­çº¿ç¨‹æ‰ä¼šæ˜¯å®ˆæŠ¤çº¿ç¨‹â€ã€‚å½“Javaè™šæ‹Ÿæœºå¯åŠ¨æ—¶ï¼Œé€šå¸¸æœ‰ä¸€ä¸ªå•ä¸€çš„éå®ˆæŠ¤çº¿ç¨‹ï¼ˆè¯¥çº¿ç¨‹é€šè¿‡æ˜¯é€šè¿‡main()æ–¹æ³•å¯åŠ¨ï¼‰ã€‚JVMä¼šä¸€ç›´è¿è¡Œç›´åˆ°ä¸‹é¢çš„ä»»æ„ä¸€ä¸ªæ¡ä»¶å‘ç”Ÿï¼ŒJVMå°±ä¼šç»ˆæ­¢è¿è¡Œï¼š(01) è°ƒç”¨äº†exit()æ–¹æ³•ï¼Œå¹¶ä¸”exit()æœ‰æƒé™è¢«æ­£å¸¸æ‰§è¡Œã€‚(02) æ‰€æœ‰çš„â€œéå®ˆæŠ¤çº¿ç¨‹â€éƒ½æ­»äº†(å³JVMä¸­ä»…ä»…åªæœ‰â€œå®ˆæŠ¤çº¿ç¨‹â€)ã€‚æ¯ä¸€ä¸ªçº¿ç¨‹éƒ½è¢«æ ‡è®°ä¸ºâ€œå®ˆæŠ¤çº¿ç¨‹â€æˆ–â€œç”¨æˆ·çº¿ç¨‹â€ã€‚å½“åªæœ‰å®ˆæŠ¤çº¿ç¨‹è¿è¡Œæ—¶ï¼ŒJVMä¼šè‡ªåŠ¨é€€å‡ºã€‚12345678910111213141516171819202122232425262728293031323334353637383940class MyThread extends Thread{      public MyThread(String name) {        super(name);    }    public void run(){        for (int i=0; i&lt;5; i++) {            System.out.println(Thread.currentThread().getName()                    +&quot;(&quot;+Thread.currentThread().getPriority()+ &quot;)&quot;                    +&quot;, loop &quot;+i);        }    } }public class Demo {      public static void main(String[] args) {          System.out.println(Thread.currentThread().getName()                +&quot;(&quot;+Thread.currentThread().getPriority()+ &quot;)&quot;);        Thread t1=new MyThread(&quot;t1&quot;);    // æ–°å»ºt1        Thread t2=new MyThread(&quot;t2&quot;);    // æ–°å»ºt2        t1.setPriority(1);                // è®¾ç½®t1çš„ä¼˜å…ˆçº§ä¸º1        t2.setPriority(10);                // è®¾ç½®t2çš„ä¼˜å…ˆçº§ä¸º10        t1.start();                        // å¯åŠ¨t1        t2.start();                        // å¯åŠ¨t2    }  }// ç»“æœè¯´æ˜ï¼š(01) ä¸»çº¿ç¨‹mainçš„ä¼˜å…ˆçº§æ˜¯5ã€‚(02) t1çš„ä¼˜å…ˆçº§è¢«è®¾ä¸º1ï¼Œè€Œt2çš„ä¼˜å…ˆçº§è¢«è®¾ä¸º10ã€‚cpuåœ¨æ‰§è¡Œt1å’Œt2çš„æ—¶å€™ï¼Œæ ¹æ®æ—¶é—´ç‰‡è½®å¾ªè°ƒåº¦ï¼Œæ‰€ä»¥èƒ½å¤Ÿå¹¶å‘æ‰§è¡Œã€‚main(5)t1(1), loop 0t2(10), loop 0t1(1), loop 1t2(10), loop 1t1(1), loop 2t2(10), loop 2t1(1), loop 3t2(10), loop 3t1(1), loop 4t2(10), loop 41234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465// å®ˆæŠ¤çº¿ç¨‹çš„ç¤ºä¾‹// Demo.javaclass MyThread extends Thread{      public MyThread(String name) {        super(name);    }    public void run(){        try {            for (int i=0; i&lt;5; i++) {                Thread.sleep(3);                System.out.println(this.getName() +&quot;(isDaemon=&quot;+this.isDaemon()+ &quot;)&quot; +&quot;, loop &quot;+i);            }        } catch (InterruptedException e) {        }    } }class MyDaemon extends Thread{      public MyDaemon(String name) {        super(name);    }    public void run(){        try {            for (int i=0; i&lt;10000; i++) {                Thread.sleep(1);                System.out.println(this.getName() +&quot;(isDaemon=&quot;+this.isDaemon()+ &quot;)&quot; +&quot;, loop &quot;+i);            }        } catch (InterruptedException e) {        }    } }public class Demo {      public static void main(String[] args) {          System.out.println(Thread.currentThread().getName()                +&quot;(isDaemon=&quot;+Thread.currentThread().isDaemon()+ &quot;)&quot;);        Thread t1=new MyThread(&quot;t1&quot;);    // æ–°å»ºt1        Thread t2=new MyDaemon(&quot;t2&quot;);    // æ–°å»ºt2        t2.setDaemon(true);                // è®¾ç½®t2ä¸ºå®ˆæŠ¤çº¿ç¨‹        t1.start();                        // å¯åŠ¨t1        t2.start();                        // å¯åŠ¨t2    }  }// ç»“æœè¯´æ˜ï¼š(01) ä¸»çº¿ç¨‹mainæ˜¯ç”¨æˆ·çº¿ç¨‹ï¼Œå®ƒåˆ›å»ºçš„å­çº¿ç¨‹t1ä¹Ÿæ˜¯ç”¨æˆ·çº¿ç¨‹ã€‚(02) t2æ˜¯å®ˆæŠ¤çº¿ç¨‹ã€‚åœ¨â€œä¸»çº¿ç¨‹mainâ€å’Œâ€œå­çº¿ç¨‹t1â€(å®ƒä»¬éƒ½æ˜¯ç”¨æˆ·çº¿ç¨‹)æ‰§è¡Œå®Œæ¯•ï¼Œåªå‰©t2è¿™ä¸ªå®ˆæŠ¤çº¿ç¨‹çš„æ—¶å€™ï¼ŒJVMè‡ªåŠ¨é€€å‡ºã€‚main(isDaemon=false)t2(isDaemon=true), loop 0t2(isDaemon=true), loop 1t1(isDaemon=false), loop 0t2(isDaemon=true), loop 2t2(isDaemon=true), loop 3t1(isDaemon=false), loop 1t2(isDaemon=true), loop 4t2(isDaemon=true), loop 5t2(isDaemon=true), loop 6t1(isDaemon=false), loop 2t2(isDaemon=true), loop 7t2(isDaemon=true), loop 8t2(isDaemon=true), loop 9t1(isDaemon=false), loop 3t2(isDaemon=true), loop 10t2(isDaemon=true), loop 11t1(isDaemon=false), loop 4t2(isDaemon=true), loop 12ç”Ÿäº§æ¶ˆè´¹è€…é—®é¢˜ç”Ÿäº§/æ¶ˆè´¹è€…é—®é¢˜æ˜¯ä¸ªéå¸¸å…¸å‹çš„å¤šçº¿ç¨‹é—®é¢˜ï¼Œæ¶‰åŠåˆ°çš„å¯¹è±¡åŒ…æ‹¬â€œç”Ÿäº§è€…â€ã€â€œæ¶ˆè´¹è€…â€ã€â€œä»“åº“â€å’Œâ€œäº§å“â€ã€‚ä»–ä»¬ä¹‹é—´çš„å…³ç³»å¦‚ä¸‹ï¼š(01) ç”Ÿäº§è€…ä»…ä»…åœ¨ä»“å‚¨æœªæ»¡æ—¶å€™ç”Ÿäº§ï¼Œä»“æ»¡åˆ™åœæ­¢ç”Ÿäº§ã€‚(02) æ¶ˆè´¹è€…ä»…ä»…åœ¨ä»“å‚¨æœ‰äº§å“æ—¶å€™æ‰èƒ½æ¶ˆè´¹ï¼Œä»“ç©ºåˆ™ç­‰å¾…ã€‚(03) å½“æ¶ˆè´¹è€…å‘ç°ä»“å‚¨æ²¡äº§å“å¯æ¶ˆè´¹æ—¶å€™ä¼šé€šçŸ¥ç”Ÿäº§è€…ç”Ÿäº§ã€‚(04) ç”Ÿäº§è€…åœ¨ç”Ÿäº§å‡ºå¯æ¶ˆè´¹äº§å“æ—¶å€™ï¼Œåº”è¯¥é€šçŸ¥ç­‰å¾…çš„æ¶ˆè´¹è€…å»æ¶ˆè´¹ã€‚123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120// é€šè¿‡wait()/notify()æ–¹å¼å®ç°è¯¥æ¨¡å‹(åé¢åœ¨å­¦ä¹ äº†çº¿ç¨‹æ± ç›¸å…³å†…å®¹ä¹‹åï¼Œå†é€šè¿‡å…¶å®ƒæ–¹å¼å®ç°ç”Ÿäº§/æ¶ˆè´¹è€…æ¨¡å‹)ã€‚// Demo1.java// ä»“åº“class Depot {    private int capacity;    // ä»“åº“çš„å®¹é‡    private int size;        // ä»“åº“çš„å®é™…æ•°é‡    public Depot(int capacity) {        this.capacity = capacity;        this.size = 0;    }    public synchronized void produce(int val) {        try {             // left è¡¨ç¤ºâ€œæƒ³è¦ç”Ÿäº§çš„æ•°é‡â€(æœ‰å¯èƒ½ç”Ÿäº§é‡å¤ªå¤šï¼Œéœ€å¤šæ­¤ç”Ÿäº§)            int left = val;            while (left &gt; 0) {                // åº“å­˜å·²æ»¡æ—¶ï¼Œç­‰å¾…â€œæ¶ˆè´¹è€…â€æ¶ˆè´¹äº§å“ã€‚                while (size &gt;= capacity)                    wait();                // è·å–â€œå®é™…ç”Ÿäº§çš„æ•°é‡â€(å³åº“å­˜ä¸­æ–°å¢çš„æ•°é‡)                // å¦‚æœâ€œåº“å­˜â€+â€œæƒ³è¦ç”Ÿäº§çš„æ•°é‡â€&gt;â€œæ€»çš„å®¹é‡â€ï¼Œåˆ™â€œå®é™…å¢é‡â€=â€œæ€»çš„å®¹é‡â€-â€œå½“å‰å®¹é‡â€ã€‚(æ­¤æ—¶å¡«æ»¡ä»“åº“)                // å¦åˆ™â€œå®é™…å¢é‡â€=â€œæƒ³è¦ç”Ÿäº§çš„æ•°é‡â€                int inc = (size+left)&gt;capacity ? (capacity-size) : left;                size += inc;                left -= inc;                System.out.printf(&quot;%s produce(=) --&gt; left==, inc==, size==\n&quot;,                         Thread.currentThread().getName(), val, left, inc, size);                // é€šçŸ¥â€œæ¶ˆè´¹è€…â€å¯ä»¥æ¶ˆè´¹äº†ã€‚                notifyAll();            }        } catch (InterruptedException e) {        }    }     public synchronized void consume(int val) {        try {            // left è¡¨ç¤ºâ€œå®¢æˆ·è¦æ¶ˆè´¹æ•°é‡â€(æœ‰å¯èƒ½æ¶ˆè´¹é‡å¤ªå¤§ï¼Œåº“å­˜ä¸å¤Ÿï¼Œéœ€å¤šæ­¤æ¶ˆè´¹)            int left = val;            while (left &gt; 0) {                // åº“å­˜ä¸º0æ—¶ï¼Œç­‰å¾…â€œç”Ÿäº§è€…â€ç”Ÿäº§äº§å“ã€‚                while (size &lt;= 0)                    wait();                // è·å–â€œå®é™…æ¶ˆè´¹çš„æ•°é‡â€(å³åº“å­˜ä¸­å®é™…å‡å°‘çš„æ•°é‡)                // å¦‚æœâ€œåº“å­˜â€&lt;â€œå®¢æˆ·è¦æ¶ˆè´¹çš„æ•°é‡â€ï¼Œåˆ™â€œå®é™…æ¶ˆè´¹é‡â€=â€œåº“å­˜â€ï¼›                // å¦åˆ™ï¼Œâ€œå®é™…æ¶ˆè´¹é‡â€=â€œå®¢æˆ·è¦æ¶ˆè´¹çš„æ•°é‡â€ã€‚                int dec = (size&lt;left) ? size : left;                size -= dec;                left -= dec;                System.out.printf(&quot;%s consume(=) &lt;-- left==, dec==, size==\n&quot;,                         Thread.currentThread().getName(), val, left, dec, size);                notifyAll();            }        } catch (InterruptedException e) {        }    }    public String toString() {        return &quot;capacity:&quot;+capacity+&quot;, actual size:&quot;+size;    }} // ç”Ÿäº§è€…class Producer {    private Depot depot;    public Producer(Depot depot) {        this.depot = depot;    }    // æ¶ˆè´¹äº§å“ï¼šæ–°å»ºä¸€ä¸ªçº¿ç¨‹å‘ä»“åº“ä¸­ç”Ÿäº§äº§å“ã€‚    public void produce(final int val) {        new Thread() {            public void run() {                depot.produce(val);            }        }.start();    }}// æ¶ˆè´¹è€…class Customer {    private Depot depot;    public Customer(Depot depot) {        this.depot = depot;    }    // æ¶ˆè´¹äº§å“ï¼šæ–°å»ºä¸€ä¸ªçº¿ç¨‹ä»ä»“åº“ä¸­æ¶ˆè´¹äº§å“ã€‚    public void consume(final int val) {        new Thread() {            public void run() {                depot.consume(val);            }        }.start();    }}public class Demo1 {      public static void main(String[] args) {          Depot mDepot = new Depot(100);        Producer mPro = new Producer(mDepot);        Customer mCus = new Customer(mDepot);        mPro.produce(60);        mPro.produce(120);        mCus.consume(90);        mCus.consume(150);        mPro.produce(110);    }}// è¯´æ˜ï¼š(01) Produceræ˜¯â€œç”Ÿäº§è€…â€ç±»ï¼Œå®ƒä¸â€œä»“åº“(depot)â€å…³è”ã€‚å½“è°ƒç”¨â€œç”Ÿäº§è€…â€çš„produce()æ–¹æ³•æ—¶ï¼Œå®ƒä¼šæ–°å»ºä¸€ä¸ªçº¿ç¨‹å¹¶å‘â€œä»“åº“â€ä¸­ç”Ÿäº§äº§å“ã€‚(02) Customeræ˜¯â€œæ¶ˆè´¹è€…â€ç±»ï¼Œå®ƒä¸â€œä»“åº“(depot)â€å…³è”ã€‚å½“è°ƒç”¨â€œæ¶ˆè´¹è€…â€çš„consume()æ–¹æ³•æ—¶ï¼Œå®ƒä¼šæ–°å»ºä¸€ä¸ªçº¿ç¨‹å¹¶æ¶ˆè´¹â€œä»“åº“â€ä¸­çš„äº§å“ã€‚(03) Depotæ˜¯â€œä»“åº“â€ç±»ï¼Œä»“åº“ä¸­è®°å½•â€œä»“åº“çš„å®¹é‡(capacity)â€ä»¥åŠâ€œä»“åº“ä¸­å½“å‰äº§å“æ•°ç›®(size)â€ã€‚â€œä»“åº“â€ç±»çš„ç”Ÿäº§æ–¹æ³•produce()å’Œæ¶ˆè´¹æ–¹æ³•consume()æ–¹æ³•éƒ½æ˜¯synchronizedæ–¹æ³•ï¼Œè¿›å…¥synchronizedæ–¹æ³•ä½“ï¼Œæ„å‘³ç€è¿™ä¸ªçº¿ç¨‹è·å–åˆ°äº†è¯¥â€œä»“åº“â€å¯¹è±¡çš„åŒæ­¥é”ã€‚è¿™ä¹Ÿå°±æ˜¯è¯´ï¼ŒåŒä¸€æ—¶é—´ï¼Œç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çº¿ç¨‹åªèƒ½æœ‰ä¸€ä¸ªèƒ½è¿è¡Œã€‚é€šè¿‡åŒæ­¥é”ï¼Œå®ç°äº†å¯¹â€œæ®‹é…·â€çš„äº’æ–¥è®¿é—®ã€‚å¯¹äºç”Ÿäº§æ–¹æ³•produce()è€Œè¨€ï¼šå½“ä»“åº“æ»¡æ—¶ï¼Œç”Ÿäº§è€…çº¿ç¨‹ç­‰å¾…ï¼Œéœ€è¦ç­‰å¾…æ¶ˆè´¹è€…æ¶ˆè´¹äº§å“ä¹‹åï¼Œç”Ÿäº§çº¿ç¨‹æ‰èƒ½ç”Ÿäº§ï¼›ç”Ÿäº§è€…çº¿ç¨‹ç”Ÿäº§å®Œäº§å“ä¹‹åï¼Œä¼šé€šè¿‡notifyAll()å”¤é†’åŒæ­¥é”ä¸Šçš„æ‰€æœ‰çº¿ç¨‹ï¼ŒåŒ…æ‹¬â€œæ¶ˆè´¹è€…çº¿ç¨‹â€ï¼Œå³æˆ‘ä»¬æ‰€è¯´çš„â€œé€šçŸ¥æ¶ˆè´¹è€…è¿›è¡Œæ¶ˆè´¹â€ã€‚å¯¹äºæ¶ˆè´¹æ–¹æ³•consume()è€Œè¨€ï¼šå½“ä»“åº“ä¸ºç©ºæ—¶ï¼Œæ¶ˆè´¹è€…çº¿ç¨‹ç­‰å¾…ï¼Œéœ€è¦ç­‰å¾…ç”Ÿäº§è€…ç”Ÿäº§äº§å“ä¹‹åï¼Œæ¶ˆè´¹è€…çº¿ç¨‹æ‰èƒ½æ¶ˆè´¹ï¼›æ¶ˆè´¹è€…çº¿ç¨‹æ¶ˆè´¹å®Œäº§å“ä¹‹åï¼Œä¼šé€šè¿‡notifyAll()å”¤é†’åŒæ­¥é”ä¸Šçš„æ‰€æœ‰çº¿ç¨‹ï¼ŒåŒ…æ‹¬â€œç”Ÿäº§è€…çº¿ç¨‹â€ï¼Œå³æˆ‘ä»¬æ‰€è¯´çš„â€œé€šçŸ¥ç”Ÿäº§è€…è¿›è¡Œç”Ÿäº§â€ã€‚      Thread-0 produce( 60) --&gt; left=  0, inc= 60, size= 60Thread-4 produce(110) --&gt; left= 70, inc= 40, size=100Thread-2 consume( 90) &lt;-- left=  0, dec= 90, size= 10Thread-3 consume(150) &lt;-- left=140, dec= 10, size=  0Thread-1 produce(120) --&gt; left= 20, inc=100, size=100Thread-3 consume(150) &lt;-- left= 40, dec=100, size=  0Thread-4 produce(110) --&gt; left=  0, inc= 70, size= 70Thread-3 consume(150) &lt;-- left=  0, dec= 40, size= 30Thread-1 produce(120) --&gt; left=  0, inc= 20, size= 50</content>
	</entry>
	<entry>
		<title>è®¾è®¡æ¨¡å¼</title>
		<url>/article/364ea8cc.html</url>
		<content>è®¾è®¡æ¨¡å¼çš„æ¦‚å¿µè®¾è®¡æ¨¡å¼(Design pattern)ä»£è¡¨äº†æœ€ä½³çš„å®è·µï¼Œé€šå¸¸è¢«æœ‰ç»éªŒçš„é¢å‘å¯¹è±¡çš„è½¯ä»¶å¼€å‘äººå‘˜æ‰€é‡‡ç”¨è®¾è®¡æ¨¡å¼æ˜¯è½¯ä»¶å¼€å‘äººå‘˜åœ¨è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­é¢ä¸´çš„ä¸€èˆ¬é—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚è¿™äº›è§£å†³æ–¹æ¡ˆæ˜¯ä¼—å¤šè½¯ä»¶å¼€å‘äººå‘˜ç»è¿‡ç›¸å½“é•¿çš„ä¸€æ®µæ—¶é—´çš„è¯•éªŒå’Œé”™è¯¯æ€»ç»“å‡ºæ¥çš„è®¾è®¡æ¨¡å¼ï¼ˆDesign Patternï¼‰æ˜¯ä¸€å¥—è¢«åå¤ä½¿ç”¨ã€å¤šæ•°äººçŸ¥æ™“çš„ã€ç»è¿‡åˆ†ç±»çš„ã€ä»£ç è®¾è®¡ç»éªŒçš„æ€»ç»“ä½¿ç”¨è®¾è®¡æ¨¡å¼çš„ç›®çš„ï¼šä¸ºäº†ä»£ç å¯é‡ç”¨æ€§ã€è®©ä»£ç æ›´å®¹æ˜“è¢«ä»–äººç†è§£ã€ä¿è¯ä»£ç å¯é æ€§ è®¾è®¡æ¨¡å¼ä½¿ä»£ç ç¼–å†™çœŸæ­£å·¥ç¨‹åŒ–ï¼›è®¾è®¡æ¨¡å¼æ˜¯è½¯ä»¶å·¥ç¨‹çš„åŸºçŸ³è„‰ç»œï¼Œå¦‚åŒå¤§å¦çš„ç»“æ„ä¸€æ ·è®¾è®¡æ¨¡å¼çš„ç»„æˆå’Œåˆ†ç±»æ ¹æ®å…¶ç›®çš„ï¼ˆæ¨¡å¼æ˜¯ç”¨æ¥åšä»€ä¹ˆçš„ï¼‰å¯åˆ†ä¸ºåˆ›å»ºå‹(Creational)ï¼Œç»“æ„å‹(Structural)å’Œè¡Œä¸ºå‹(Behavioral)ä¸‰ç§ï¼šâ€¢ åˆ›å»ºå‹æ¨¡å¼ä¸»è¦ç”¨äºåˆ›å»ºå¯¹è±¡â€¢ ç»“æ„å‹æ¨¡å¼ä¸»è¦ç”¨äºå¤„ç†ç±»æˆ–å¯¹è±¡çš„ç»„åˆâ€¢ è¡Œä¸ºå‹æ¨¡å¼ä¸»è¦ç”¨äºæè¿°å¯¹ç±»æˆ–å¯¹è±¡æ€æ ·äº¤äº’å’Œæ€æ ·åˆ†é…èŒè´£æ ¹æ®èŒƒå›´ï¼ˆæ¨¡å¼ä¸»è¦æ˜¯ç”¨äºå¤„ç†ç±»ä¹‹é—´å…³ç³»è¿˜æ˜¯å¤„ç†å¯¹è±¡ä¹‹é—´çš„å…³ç³»ï¼‰å¯åˆ†ä¸ºç±»æ¨¡å¼å’Œå¯¹è±¡æ¨¡å¼ä¸¤ç§ï¼šâ€¢ ç±»æ¨¡å¼å¤„ç†ç±»å’Œå­ç±»ä¹‹é—´çš„å…³ç³»ï¼Œè¿™äº›å…³ç³»é€šè¿‡ç»§æ‰¿å»ºç«‹ï¼Œåœ¨ç¼–è¯‘æ—¶åˆ»å°±è¢«ç¡®å®šä¸‹æ¥ï¼Œæ˜¯å±äºé™æ€çš„â€¢ å¯¹è±¡æ¨¡å¼å¤„ç†å¯¹è±¡é—´çš„å…³ç³»ï¼Œè¿™äº›å…³ç³»åœ¨è¿è¡Œæ—¶åˆ»å˜åŒ–ï¼Œæ›´å…·åŠ¨æ€æ€§UMLå›¾ç¤ºè¯´æ˜TypeSymbolDrawingExtensionï¼ˆæ‰©å±•ï¼‰&lt;|â€”Compositionï¼ˆç»„åˆï¼‰*â€”Aggregationï¼ˆèšåˆï¼‰oâ€”ä½¿ç”¨.. æ¥ä»£æ›¿ -- å¯ä»¥å¾—åˆ°ç‚¹çº¿åœ¨è¿™äº›è§„åˆ™ä¸‹ï¼Œä¹Ÿå¯ä»¥ç»˜åˆ¶ä¸‹åˆ—å›¾å½¢1234567@startuml Class01 &lt;|-- Class02 Class03 *-- Class04 Class05 o-- Class06 Class07 .. Class08 Class09 -- Class10 @enduml 1234567@startuml Class11 &lt;|.. Class12 Class13 --&gt; Class14 Class15 ..&gt; Class16 Class17 ..|&gt; Class18 Class19 &lt;--* Class20 @enduml 1234567@startuml Class21 #-- Class22 Class23 x-- Class24 Class25 }-- Class26 Class27 +-- Class28 Class29 ^-- Class30 @enduml å®šä¹‰å¯è®¿é—®æ€§ä¸€æ—¦ä½ å®šä¹‰äº†åŸŸæˆ–è€…æ–¹æ³•ï¼Œä½ å¯ä»¥å®šä¹‰ç›¸åº”æ¡ç›®çš„å¯è®¿é—®æ€§è´¨ã€‚CharacterIcon for fieldIcon for methodVisibility-private#protected~package private+publicå…­å¤§è®¾è®¡åŸåˆ™å­¦ä¹ 6å¤§è®¾è®¡åŸåˆ™ã€23ç§è®¾è®¡æ¨¡å¼æ€»ç»“ä¸‹è½¯ä»¶è®¾è®¡çš„å…­å¤§åŸåˆ™6å¤§è®¾è®¡åŸåˆ™æ€»ç»“JAVAè®¾è®¡æ¨¡å¼æ€»ç»“ä¹‹23ç§è®¾è®¡æ¨¡å¼å›¾è¯´è®¾è®¡æ¨¡å¼å•ä¸€èŒè´£åŸåˆ™(SRP)å¼€æ”¾å°é—­åŸåˆ™(OCP)é‡Œå¼æ›¿æ¢åŸåˆ™(LSP)è¿ªç±³ç‰¹æ³•åˆ™(LKP)æ¥å£éš”ç¦»åŸåˆ™(ISP)ä¾èµ–å€’ç½®åŸåˆ™(DIP)There should never be more than one reason for a class to change.ç†è§£ï¼šä¸€ä¸ªç±»åº”è¯¥åªæœ‰ä¸€ä¸ªå‘ç”Ÿå˜åŒ–çš„åŸå› ï¼Œå³ä¸€ä¸ªç±»åªè´Ÿè´£ä¸€é¡¹èŒè´£ã€‚å¦‚æœä¸€ä¸ªç±»æœ‰å¤šä¸ªèŒè´£ï¼Œè¿™äº›èŒè´£å°±è€¦åˆåœ¨äº†ä¸€èµ·ã€‚å½“ä¸€ä¸ªèŒè´£å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¯èƒ½ä¼šå½±å“å…¶å®ƒçš„èŒè´£ã€‚å¦å¤–ï¼Œå¤šä¸ªèŒè´£è€¦åˆåœ¨ä¸€èµ·ä¼šå½±å“å¤ç”¨æ€§ã€‚æ­¤åŸåˆ™çš„æ ¸å¿ƒæ˜¯è§£è€¦å’Œå¢å¼ºå†…èšæ€§æ€»ç»“ï¼šä¸€ä¸ªç±»åªæ‰¿æ‹…ä¸€ä¸ªèŒè´£Software entities like classes,modules and functions should be open for extension but closed for modifications.ç†è§£ï¼šå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹æ›´æ”¹å°é—­ã€‚ç±»æ¨¡å—åº”è¯¥æ˜¯å¯æ‰©å±•çš„ï¼Œä½†æ˜¯ä¸å¯ä¿®æ”¹æ€»ç»“ï¼šå¯¹è½¯ä»¶å®ä½“çš„æ”¹åŠ¨ï¼Œæœ€å¥½ç”¨æ‰©å±•è€Œéä¿®æ”¹çš„æ–¹å¼Functions that use pointers or references to base classes must be able to use objects of derived classes without knowing it.ç†è§£ï¼šçˆ¶ç±»å¯è¢«å­ç±»æ›¿æ¢ï¼Œä½†åä¹‹ä¸ä¸€å®šæˆç«‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä»£ç ä¸­å¯ä»¥å°†çˆ¶ç±»å…¨éƒ¨æ›¿æ¢ä¸ºå­ç±»ï¼Œç¨‹åºä¸ä¼šå‡ºç°å¼‚å¸¸ï¼Œä½†åè¿‡æ¥å°±ä¸ä¸€å®šäº†æ€»ç»“ï¼šåœ¨ç»§æ‰¿ç±»æ˜¯ï¼ŒåŠ¡å¿…é‡å†™ï¼ˆoverrideï¼‰çˆ¶ç±»ä¸­æ‰€æœ‰çš„æ–¹æ³•ï¼Œå°¤å…¶éœ€è¦æ³¨æ„çˆ¶ç±»çš„protectedæ–¹æ³•ï¼ˆå®ƒä»¬å¾€å¾€æ˜¯è®©ä½ é‡å†™çš„ï¼‰ï¼Œå­ç±»å°½é‡ä¸è¦æš´éœ²è‡ªå·±çš„publicæ–¹æ³•ä¾›å¤–ç•Œè°ƒç”¨Only talk to you immediate friends.ç†è§£ï¼šå¦‚æœä¸¤ä¸ªç±»ä¸å¿…å½¼æ­¤ç›´æ¥é€šä¿¡ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªç±»å°±ä¸åº”å½“å‘ç”Ÿç›´æ¥çš„ç›¸äº’ä½œç”¨ï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ªç±»éœ€è¦è°ƒç”¨å¦ä¸€ä¸ªç±»çš„æŸä¸€ä¸ªæ–¹æ³•çš„è¯ï¼Œå¯ä»¥é€šè¿‡ç¬¬ä¸‰è€…è½¬å‘è¿™ä¸ªè°ƒç”¨æ€»ç»“ï¼šä¸€å®šè¦åšåˆ°ï¼šä½è€¦åˆã€é«˜å†…èšThe dependency of one class to another one should depend on the smallest possible interface.ç†è§£ï¼šä¸è¦å¯¹å¤–æš´éœ²æ²¡æœ‰å®é™…æ„ä¹‰çš„æ¥å£ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå°½é‡ä¿è¯æ¥å£çš„å®ç”¨æ€§ã€‚å½“éœ€è¦å¯¹å¤–æš´éœ²æ¥å£æ—¶ï¼Œéœ€è¦å†ä¸‰æ–Ÿé…Œï¼Œè‹¥æ²¡å¿…è¦å¯¹å¤–æä¾›å°±åˆ äº†å§ï¼Œå› ä¸ºä¸€æ—¦æä¾›äº†å°±æ„å‘³ç€ï¼Œå°†æ¥è¦å¤šåšä¸€ä»¶äº‹æƒ…ï¼Œä½•è‹¦ç»™è‡ªå·±æ‰¾äº‹åšå‘¢æ€»ç»“ï¼šä¸è¦å¯¹å¤–æš´éœ²æ²¡æœ‰å®é™…æ„ä¹‰çš„æ¥å£High level modules should not depends upon low level modules. Both should depend upon abstractions. Abstractions should not depend upon details. Details should depend upon abstractions.ç†è§£ï¼šé«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–äºåº•å±‚æ¨¡å—ï¼Œè€Œåº”è¯¥ä¾èµ–äºæŠ½è±¡ã€‚æŠ½è±¡ä¸åº”ä¾èµ–äºç»†èŠ‚ï¼Œç»†èŠ‚åº”ä¾èµ–äºæŠ½è±¡ã€‚åº”è¯¥é¢å‘æ¥å£ç¼–ç¨‹ï¼Œä¸è¯¥é¢å‘å®ç°ç±»ç¼–ç¨‹ã€‚é¢å‘å®ç°ç±»ç¼–ç¨‹ç›¸å½“äºå°±äº‹è®ºäº‹ï¼Œé‚£æ˜¯æ­£å‘ä¾èµ–ï¼›é¢å‘æ¥å£ç¼–ç¨‹ï¼Œç›¸å½“äºé€è¿‡ç°è±¡çœ‹æœ¬è´¨ï¼ŒæŠ“ä½äº‹åŠ¡çš„å…±æ€§ï¼Œé‚£å°±æ˜¯åå‘ä¾èµ–ï¼Œå³ä¾èµ–å€’ç½®æ€»ç»“ï¼šé¢å‘æ¥å£ç¼–ç¨‹ï¼Œæå–å‡ºäº‹åŠ¡çš„æœ¬è´¨å’Œå…±æ€§åˆ›å»ºå‹æ¨¡å¼åœ¨çº¿plantumlå·¥å…·plantumlè¯­æ³•Draw Diagrams With MarkdownæŠ½è±¡å·¥å‚æ¨¡å¼(Abstract Factory)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778@startumlabstract AbsBmwCar{  +drive()}note left: æŠ½è±¡äº§å“ï¼Œä»£è¡¨äº†æŸä¸€ç±»çš„äº§å“class BmwSportCar{  +drive()}class BmwBusinessCar{  +drive()}note left: å…·ä½“æŸç±»äº§å“abstract AbsAudiCar{  +drive()}class AudiSportCar{  +drive()}class AudiBusinessCar{  +drive()}abstract AbsBenzCar{  +drive()}class BenzSportCar{  +drive()}class BenzBusinessCar{  +drive()}abstract AbsDriver{  +createBenzCar()  +createBmwCar()  +createAudiCar()}note left: æŠ½è±¡å·¥å‚ï¼ŒåŒ…å«äº†æ‰€æœ‰äº§å“åˆ›å»ºçš„æŠ½è±¡æ–¹æ³•class SportDriver{  +createBenzCar()  +createBmwCar()  +createAudiCar()}class BusinessDriver{  +createBenzCar()  +createBmwCar()  +createAudiCar()}class ClientAbsBmwCar &lt;|-- BmwSportCarAbsBmwCar &lt;|-- BmwBusinessCarAbsAudiCar &lt;|-- AudiSportCarAbsAudiCar &lt;|-- AudiBusinessCarAbsBenzCar &lt;|-- BenzSportCarAbsBenzCar &lt;|-- BenzBusinessCarAbsDriver &lt;|-- SportDriverAbsDriver &lt;|-- BusinessDriverClient --&gt; AbsBmwCarClient --&gt; AbsAudiCar Client --&gt; AbsBenzCar Client --&gt; AbsDriverSportDriver ..&gt; BmwSportCarSportDriver ..&gt; BmwBusinessCarSportDriver ..&gt; AudiSportCarSportDriver ..&gt; AudiBusinessCarSportDriver ..&gt; BenzSportCarSportDriver ..&gt; BenzBusinessCarBusinessDriver ..&gt; BmwSportCarBusinessDriver ..&gt; BmwBusinessCarBusinessDriver ..&gt; AudiBusinessCarBusinessDriver ..&gt; AudiBusinessCarBusinessDriver ..&gt; BenzSportCarBusinessDriver ..&gt; BenzBusinessCar@endumlã€ŠJAVAè®¾è®¡æ¨¡å¼ã€‹ä¹‹æŠ½è±¡å·¥å‚æ¨¡å¼(Abstract Factory)æ¯ä¸€ä¸ªæ¨¡å¼éƒ½æ˜¯é’ˆå¯¹ä¸€å®šé—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚æŠ½è±¡å·¥å‚æ¨¡å¼ä¸å·¥å‚æ–¹æ³•æ¨¡å¼çš„æœ€å¤§åŒºåˆ«å°±åœ¨äºï¼Œå·¥å‚æ–¹æ³•æ¨¡å¼é’ˆå¯¹çš„æ˜¯ä¸€ä¸ªäº§å“ç­‰çº§ç»“æ„ï¼›è€ŒæŠ½è±¡å·¥å‚æ¨¡å¼åˆ™éœ€è¦é¢å¯¹å¤šä¸ªäº§å“ç­‰çº§ç»“æ„ã€‚ä¼˜ç‚¹æŠ½è±¡å·¥å‚æ¨¡å¼æ­£å¦‚å…¶åå­—ä¸€æ ·ï¼Œç†è§£èµ·æ¥éå¸¸æŠ½è±¡ï¼Œæ­£æ˜¯å› ä¸ºè¿™ç§æŠ½è±¡ï¼Œä½¿å¾—æŠ½è±¡å·¥å‚æ¨¡å¼éå¸¸å¼ºå¤§å’Œçµæ´»ï¼Œæ¯”å…¶ä»–ä¸¤ç§å·¥å‚è®¾è®¡æ¨¡å¼è¦å¼ºå¤§å¾ˆå¤šã€‚æŠ½è±¡å·¥å‚æ¨¡å¼å¯ä»¥åˆ›å»ºå¤šä¸ªç³»åˆ—ï¼Œå¹¶ä¸”æ¯ä¸ªç³»åˆ—æŠ½è±¡å­ç±»ä¸€ä¸€å¯¹åº”ï¼Œè¿™ç§å¼ºå¤§çš„åŠŸèƒ½æ˜¯å…¶ä»–ä¸¤ç§å·¥å‚æ¨¡å¼éƒ½ä¸èƒ½å®ç°çš„ã€‚é€šè¿‡æŠ½è±¡å·¥å‚æ¨¡å¼ç»Ÿä¸€æ§åˆ¶å¤šä¸ªç³»åˆ—çš„æŠ½è±¡å­ç±»ï¼Œå¯ä»¥ç”¨å¤šä¸ªç³»åˆ—çš„æŠ½è±¡å­ç±»å®Œæˆä¸€äº›å¤æ‚çš„éœ€æ±‚ã€‚ä¾‹å¦‚æˆ‘ä»¬æ–‡ä¸­è¯´åˆ°çš„æœ¬åœ°æŒä¹…åŒ–æ–¹æ¡ˆçš„åˆ‡æ¢ï¼Œæœ€åé€šè¿‡æˆ‘ä»¬çš„ä¸æ–­ä¼˜åŒ–ï¼Œåšåˆ°åªéœ€è¦ä¿®æ”¹ä¸€ä¸ªé¢„ç¼–è¯‘æŒ‡ä»¤çš„å‚æ•°å³å¯åˆ‡æ¢æ•´ä¸ªæ•°æ®æŒä¹…åŒ–æ–¹æ¡ˆï¼Œè¿™æ˜¯å…¶ä»–å·¥å‚æ¨¡å¼æ‰€ä¸èƒ½å®Œæˆçš„ã€‚æŠ½è±¡å·¥å‚æ¨¡å¼å»¶ç»­äº†å·¥å‚æ¨¡å¼çš„ä¼˜ç‚¹ï¼Œå¤–ç•Œæ¥è§¦ä¸åˆ°ä»»ä½•ç±»å‹çš„æŠ½è±¡å­ç±»ï¼Œè€Œåªéœ€è¦çŸ¥é“ä¸åŒç±»å‹çš„æŠ½è±¡ç±»å³å¯ï¼ŒæŠ½è±¡å­ç±»çš„åˆ›å»ºè¿‡ç¨‹éƒ½åœ¨å·¥å‚å­ç±»ä¸­ã€‚è¿™ç§è®¾è®¡æ–¹å¼å……åˆ†çš„åˆ©ç”¨äº†é¢å‘å¯¹è±¡è¯­è¨€ä¸­çš„å¤šæ€ç‰¹æ€§ï¼Œä½¿çµæ´»æ€§å¤§å¤§æå‡ã€‚è€Œä¸”æŠ½è±¡å·¥å‚æ¨¡å¼æ˜¯éå¸¸ç¬¦åˆå¼€æ”¾å°é—­åŸåˆ™çš„ï¼Œå¯¹æ‰©å±•çš„å¼€æ”¾ä»¥åŠå¯¹ä¿®æ”¹çš„å°é—­éƒ½å®Œç¾æ”¯æŒã€‚ç¼ºç‚¹æŠ½è±¡å·¥å‚æ¨¡å¼å¸¦æ¥çš„ç¼ºç‚¹ä¹Ÿæ˜¯æ˜¾è€Œæ˜“è§çš„ï¼Œæœ€æ˜æ˜¾çš„ç¼ºç‚¹å°±æ˜¯æ¨¡å¼æ¯”è¾ƒåºå¤§ï¼Œæ‰€ä»¥éœ€è¦åœ¨é€‚åˆçš„ä¸šåŠ¡åœºæ™¯ä½¿ç”¨è¿™ç§æ¨¡å¼ï¼Œå¦åˆ™ä¼šé€‚å¾—å…¶åã€‚ä¸Šé¢è¯´åˆ°æŠ½è±¡å·¥å‚å’Œå·¥å‚æ–¹æ³•æ¨¡å¼çš„åŠŸèƒ½æ·»åŠ éƒ½éå¸¸å¤æ‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥ç®€åŒ–å‘¢ï¼Ÿ ç­”æ¡ˆæ˜¯è‚¯å®šæœ‰çš„ï¼š é‚£å°±æ˜¯å·¥å‚æ¨¡å¼ +  é…ç½®æ–‡ä»¶ + åå°„ã€‚å…·ä½“æ€ä¹ˆå®ç°ï¼Œè¯·çœ‹ä¸‹å›åˆ†è§£ã€‚å»ºé€ è€…æ¨¡å¼(Builder)å»ºé€ è€…æ¨¡å¼1234567891011121314151617181920212223242526272829303132@startumlclass Director{  -builder:Builder  +construct():void}note top: æŒ‡æŒ¥è€…,æ„å»ºä¸€ä¸ªä½¿ç”¨Builderæ¥å£çš„å¯¹è±¡interface Builder{  #buildPart1():void  #buildPart2():void  #retrieveResult():Product}note top: Builderæ˜¯ä¸ºåˆ›å»ºä¸€ä¸ªProductå¯¹è±¡\nçš„å„ä¸ªéƒ¨ä»¶æŒ‡å®šçš„æŠ½è±¡æ¥å£class Product {  -part1:String  -part2:String}note bottom: å…·ä½“äº§å“class ConcreteBuilder{  -product:Product  #buildPart1():void  #buildPart2():void  #retrieveResult():Product}note bottom: å…·ä½“åˆ›å»ºè€…,å®ç°Builderæ¥å£,\næ„å»ºå’Œè£…é…å„ä¸ªéƒ¨ä»¶Builder &lt;|-- ConcreteBuilderConcreteBuilder .left.&gt; ProductDirector o-right-&gt; Builder@endumlå·¥å‚æ–¹æ³•æ¨¡å¼(Factory Method)123456789101112131415161718192021222324252627282930313233@startumlinterface Icar{  +run()}class Audi{  +run()}class Byd{  +run()}interface ICarFactory{  +createCar()}class AudiFactory{  +createCar()}class BydFactory{  +createCar()}Icar .left.&gt; ICarFactoryIcar &lt;|-- AudiIcar &lt;|-- BydICarFactory &lt;|-- AudiFactoryICarFactory &lt;|-- BydFactoryAudi &lt;.. AudiFactoryByd &lt;.. BydFactory@endumlå·¥å‚æ–¹æ³•æ¨¡å¼è§’è‰²ï¼šâ€‹           æŠ½è±¡å·¥å‚(Creator)è§’è‰²ï¼šæ˜¯å·¥å‚æ–¹æ³•æ¨¡å¼çš„æ ¸å¿ƒï¼Œä¸åº”ç”¨ç¨‹åºæ— å…³ã€‚ä»»ä½•åœ¨æ¨¡å¼ä¸­åˆ›å»ºçš„å¯¹è±¡çš„å·¥å‚ç±»å¿…é¡»å®ç°è¿™ä¸ªæ¥å£ã€‚â€‹           å…·ä½“å·¥å‚(Concrete Creator)è§’è‰²ï¼šè¿™æ˜¯å®ç°æŠ½è±¡å·¥å‚æ¥å£çš„å…·ä½“å·¥å‚ç±»ï¼ŒåŒ…å«ä¸åº”ç”¨ç¨‹åºå¯†åˆ‡ç›¸å…³çš„é€»è¾‘ï¼Œå¹¶ä¸”å—åˆ°åº”ç”¨ç¨‹åºè°ƒç”¨ä»¥åˆ›å»ºäº§å“å¯¹è±¡ã€‚â€‹           æŠ½è±¡äº§å“(Product)è§’è‰²ï¼šå·¥å‚æ–¹æ³•æ¨¡å¼æ‰€åˆ›å»ºçš„å¯¹è±¡çš„è¶…ç±»å‹ï¼Œä¹Ÿå°±æ˜¯äº§å“å¯¹è±¡çš„å…±åŒçˆ¶ç±»æˆ–å…±åŒæ‹¥æœ‰çš„æ¥å£ã€‚â€‹           å…·ä½“äº§å“(Concrete Product)è§’è‰²ï¼šè¿™ä¸ªè§’è‰²å®ç°äº†æŠ½è±¡äº§å“è§’è‰²æ‰€å®šä¹‰çš„æ¥å£ã€‚æŸå…·ä½“äº§å“æœ‰ä¸“é—¨çš„å…·ä½“å·¥å‚åˆ›å»ºï¼Œå®ƒä»¬ä¹‹é—´å¾€å¾€ä¸€ä¸€å¯¹åº”ã€‚åœ¨å·¥å‚æ–¹æ³•æ¨¡å¼ä¸­ï¼Œæ ¸å¿ƒå·¥å‚ç±»ä¸åœ¨è´Ÿè´£äº§å“çš„åˆ›å»ºï¼Œè€Œæ˜¯å°†å…·ä½“çš„åˆ›å»ºå·¥ä½œäº¤ç»™å­ç±»å»å®Œæˆã€‚ä¹Ÿå°±æ˜¯åæ‰€è¿™ä¸ªæ ¸å¿ƒå·¥å‚ä»…ä»…åªæ˜¯æä¾›åˆ›å»ºçš„æ¥å£ï¼Œå…·ä½“å®ç°æ–¹æ³•äº¤ç»™ç»§æ‰¿å®ƒçš„å­ç±»å»å®Œæˆã€‚åŸå‹æ¨¡å¼(Prototype)123456789101112131415161718192021222324252627282930313233343536373839@startumlclass Client{}note right:è®©ä¸€ä¸ªåŸå‹å…‹éš†è‡ªèº«,\nä»è€Œæ–°å»ºä¸€ä¸ªå¯¹è±¡abstract Shape{  -id:String  #type:String  +draw():void  +clone():Object}note top: åŸå‹ç±»,å®šä¹‰å®ç°ä¸€ä¸ªå…‹éš†è‡ªèº«çš„æ–¹æ³•class Rectangle{  +draw():void}note bottom: å…·ä½“åŸå‹ç±»,å®ç°è‡ªå·±çš„æ“ä½œclass Square{  +draw():void}class Circle{  +draw():void}class ShapeCache {  -shapeMap:Hashtable&lt;String, Shape&gt;  +getShape(shapeId:String):Shape  +loadCache():void}note bottom: ä»æ•°æ®åº“è·å–å®ä½“ç±»ï¼Œå¹¶æŠŠå®ƒä»¬å­˜å‚¨åœ¨ä¸€ä¸ªHashtableä¸­Shape &lt;|-- RectangleShape &lt;|-- SquareShape &lt;|-- CircleShape &lt;-left- ShapeCacheClient --&gt; ShapeCache@endumlå•ä¾‹æ¨¡å¼(Singleton)12345678@startumlclass Singleton{  -instance : Singleton  -Singleton()  +GetInstance()}note right:Singletonç±»ï¼Œå®šä¹‰ä¸€ä¸ªGetInstanceæ“ä½œï¼Œå…è®¸å®¢æˆ·è®¿é—®å®ƒçš„å”¯ä¸€å®ä¾‹ã€‚\n GetInstanceæ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œä¸»è¦åˆ›å»ºè‡ªå·±çš„å”¯ä¸€å®ä¾‹@endumlå•ä¾‹æ¨¡å¼åªå…è®¸åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œå› æ­¤èŠ‚çœå†…å­˜ï¼ŒåŠ å¿«å¯¹è±¡è®¿é—®é€Ÿåº¦ï¼Œå› æ­¤å¯¹è±¡éœ€è¦è¢«å…¬ç”¨çš„åœºåˆé€‚åˆä½¿ç”¨ï¼Œå¦‚å¤šä¸ªæ¨¡å—ä½¿ç”¨åŒä¸€ä¸ªæ•°æ®æºè¿æ¥å¯¹è±¡ç­‰ç­‰ã€‚å¦‚ï¼š ï¼ˆ1ï¼‰éœ€è¦é¢‘ç¹å®ä¾‹åŒ–ç„¶åé”€æ¯çš„å¯¹è±¡ã€‚ ï¼ˆ2ï¼‰åˆ›å»ºå¯¹è±¡æ—¶è€—æ—¶è¿‡å¤šæˆ–è€…è€—èµ„æºè¿‡å¤šï¼Œä½†åˆç»å¸¸ç”¨åˆ°çš„å¯¹è±¡ã€‚ ï¼ˆ3ï¼‰æœ‰çŠ¶æ€çš„å·¥å…·ç±»å¯¹è±¡ã€‚ ï¼ˆ4ï¼‰é¢‘ç¹è®¿é—®æ•°æ®åº“æˆ–æ–‡ä»¶çš„å¯¹è±¡ã€‚123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254package per.hyc.designPattern.Singleton;/** * 1ã€æ‡’æ±‰å¼ï¼Œçº¿ç¨‹ä¸å®‰å…¨ * æ˜¯å¦ Lazy åˆå§‹åŒ–ï¼šæ˜¯ * æ˜¯å¦å¤šçº¿ç¨‹å®‰å…¨ï¼šå¦ * å®ç°éš¾åº¦ï¼šæ˜“ * æè¿°ï¼šè¿™ç§æ–¹å¼æ˜¯æœ€åŸºæœ¬çš„å®ç°æ–¹å¼ï¼Œè¿™ç§å®ç°æœ€å¤§çš„é—®é¢˜å°±æ˜¯ä¸æ”¯æŒå¤šçº¿ç¨‹ã€‚å› ä¸ºæ²¡æœ‰åŠ é” synchronizedï¼Œæ‰€ä»¥ä¸¥æ ¼æ„ä¹‰ä¸Šå®ƒå¹¶ä¸ç®—å•ä¾‹æ¨¡å¼ã€‚ * è¿™ç§æ–¹å¼ lazy loading å¾ˆæ˜æ˜¾ï¼Œä¸è¦æ±‚çº¿ç¨‹å®‰å…¨ï¼Œåœ¨å¤šçº¿ç¨‹ä¸èƒ½æ­£å¸¸å·¥ä½œã€‚ */class SingleObject_1 {    private static SingleObject_1 instance;    private SingleObject_1() {    }    public static SingleObject_1 getInstance() {        if (instance == null) {            instance = new SingleObject_1();        }        return instance;    }    public void showMessage() {        System.out.println(&quot;1ã€æ‡’æ±‰å¼ï¼Œçº¿ç¨‹ä¸å®‰å…¨&quot;);    }}/** * 2ã€æ‡’æ±‰å¼ï¼Œçº¿ç¨‹å®‰å…¨ * æ˜¯å¦ Lazy åˆå§‹åŒ–ï¼šæ˜¯ * æ˜¯å¦å¤šçº¿ç¨‹å®‰å…¨ï¼šæ˜¯ * å®ç°éš¾åº¦ï¼šæ˜“ * æè¿°ï¼šè¿™ç§æ–¹å¼å…·å¤‡å¾ˆå¥½çš„ lazy loadingï¼Œèƒ½å¤Ÿåœ¨å¤šçº¿ç¨‹ä¸­å¾ˆå¥½çš„å·¥ä½œï¼Œä½†æ˜¯ï¼Œæ•ˆç‡å¾ˆä½ï¼Œ99% æƒ…å†µä¸‹ä¸éœ€è¦åŒæ­¥ã€‚ * ä¼˜ç‚¹ï¼šç¬¬ä¸€æ¬¡è°ƒç”¨æ‰åˆå§‹åŒ–ï¼Œé¿å…å†…å­˜æµªè´¹ã€‚ * ç¼ºç‚¹ï¼šå¿…é¡»åŠ é” synchronized æ‰èƒ½ä¿è¯å•ä¾‹ï¼Œä½†åŠ é”ä¼šå½±å“æ•ˆç‡ã€‚ * getInstance() çš„æ€§èƒ½å¯¹åº”ç”¨ç¨‹åºä¸æ˜¯å¾ˆå…³é”®ï¼ˆè¯¥æ–¹æ³•ä½¿ç”¨ä¸å¤ªé¢‘ç¹ï¼‰ã€‚ */class SingleObject_2 {    private static SingleObject_2 instance;    private SingleObject_2() {    }    public static synchronized SingleObject_2 getInstance() {        if (instance == null) {            instance = new SingleObject_2();        }        return instance;    }    public void showMessage() {        System.out.println(&quot;2ã€æ‡’æ±‰å¼ï¼Œçº¿ç¨‹å®‰å…¨&quot;);    }}/** * 3ã€é¥¿æ±‰å¼ * æ˜¯å¦ Lazy åˆå§‹åŒ–ï¼šå¦ * æ˜¯å¦å¤šçº¿ç¨‹å®‰å…¨ï¼šæ˜¯ * å®ç°éš¾åº¦ï¼šæ˜“ * æè¿°ï¼šè¿™ç§æ–¹å¼æ¯”è¾ƒå¸¸ç”¨ï¼Œä½†å®¹æ˜“äº§ç”Ÿåƒåœ¾å¯¹è±¡ã€‚ * ä¼˜ç‚¹ï¼šæ²¡æœ‰åŠ é”ï¼Œæ‰§è¡Œæ•ˆç‡ä¼šæé«˜ã€‚ * ç¼ºç‚¹ï¼šç±»åŠ è½½æ—¶å°±åˆå§‹åŒ–ï¼Œæµªè´¹å†…å­˜ã€‚ * å®ƒåŸºäº classloader æœºåˆ¶é¿å…äº†å¤šçº¿ç¨‹çš„åŒæ­¥é—®é¢˜ï¼Œä¸è¿‡ï¼Œinstance åœ¨ç±»è£…è½½æ—¶å°±å®ä¾‹åŒ–ï¼Œ * è™½ç„¶å¯¼è‡´ç±»è£…è½½çš„åŸå› æœ‰å¾ˆå¤šç§ï¼Œåœ¨å•ä¾‹æ¨¡å¼ä¸­å¤§å¤šæ•°éƒ½æ˜¯è°ƒç”¨ getInstance æ–¹æ³•ï¼Œ * ä½†æ˜¯ä¹Ÿä¸èƒ½ç¡®å®šæœ‰å…¶ä»–çš„æ–¹å¼ï¼ˆæˆ–è€…å…¶ä»–çš„é™æ€æ–¹æ³•ï¼‰å¯¼è‡´ç±»è£…è½½ï¼Œè¿™æ—¶å€™åˆå§‹åŒ– instance * æ˜¾ç„¶æ²¡æœ‰è¾¾åˆ° lazy loading çš„æ•ˆæœã€‚ */class SingleObject_3 {    private static SingleObject_3 instance = new SingleObject_3();    private SingleObject_3() {    }    public static SingleObject_3 getInstance() {        return instance;    }    public void showMessage() {        System.out.println(&quot;3ã€é¥¿æ±‰å¼&quot;);    }}/** * 4ã€åŒæ£€é”/åŒé‡æ ¡éªŒé”ï¼ˆDCLï¼Œå³ double-checked lockingï¼‰ * JDK ç‰ˆæœ¬ï¼šJDK1.5 èµ· * æ˜¯å¦ Lazy åˆå§‹åŒ–ï¼šæ˜¯ * æ˜¯å¦å¤šçº¿ç¨‹å®‰å…¨ï¼šæ˜¯ * å®ç°éš¾åº¦ï¼šè¾ƒå¤æ‚ * æè¿°ï¼šè¿™ç§æ–¹å¼é‡‡ç”¨åŒé”æœºåˆ¶ï¼Œå®‰å…¨ä¸”åœ¨å¤šçº¿ç¨‹æƒ…å†µä¸‹èƒ½ä¿æŒé«˜æ€§èƒ½ã€‚ * getInstance() çš„æ€§èƒ½å¯¹åº”ç”¨ç¨‹åºå¾ˆå…³é”®ã€‚ */class SingleObject_4 {    private volatile static SingleObject_4 singleton;    private SingleObject_4() {    }    public static SingleObject_4 getInstance() {        if (singleton == null) {            synchronized (SingleObject_4.class) {                if (singleton == null) {                    singleton = new SingleObject_4();                }            }        }        return singleton;    }    public void showMessage() {        System.out.println(&quot;4ã€åŒæ£€é”/åŒé‡æ ¡éªŒé”ï¼ˆDCLï¼Œå³ double-checked lockingï¼‰&quot;);    }}/** * 5ã€ç™»è®°å¼/é™æ€å†…éƒ¨ç±» * æ˜¯å¦ Lazy åˆå§‹åŒ–ï¼šæ˜¯ * æ˜¯å¦å¤šçº¿ç¨‹å®‰å…¨ï¼šæ˜¯ * å®ç°éš¾åº¦ï¼šä¸€èˆ¬ * æè¿°ï¼šè¿™ç§æ–¹å¼èƒ½è¾¾åˆ°åŒæ£€é”æ–¹å¼ä¸€æ ·çš„åŠŸæ•ˆï¼Œä½†å®ç°æ›´ç®€å•ã€‚å¯¹é™æ€åŸŸä½¿ç”¨å»¶è¿Ÿåˆå§‹åŒ–ï¼Œ * åº”ä½¿ç”¨è¿™ç§æ–¹å¼è€Œä¸æ˜¯åŒæ£€é”æ–¹å¼ã€‚è¿™ç§æ–¹å¼åªé€‚ç”¨äºé™æ€åŸŸçš„æƒ…å†µï¼Œ * åŒæ£€é”æ–¹å¼å¯åœ¨å®ä¾‹åŸŸéœ€è¦å»¶è¿Ÿåˆå§‹åŒ–æ—¶ä½¿ç”¨ã€‚ * è¿™ç§æ–¹å¼åŒæ ·åˆ©ç”¨äº† classloader æœºåˆ¶æ¥ä¿è¯åˆå§‹åŒ– instance æ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œ * å®ƒè·Ÿç¬¬ 3 ç§æ–¹å¼ä¸åŒçš„æ˜¯ï¼šç¬¬ 3 ç§æ–¹å¼åªè¦ Singleton ç±»è¢«è£…è½½äº†ï¼Œ * é‚£ä¹ˆ instance å°±ä¼šè¢«å®ä¾‹åŒ–ï¼ˆæ²¡æœ‰è¾¾åˆ° lazy loading æ•ˆæœï¼‰ï¼Œ * è€Œè¿™ç§æ–¹å¼æ˜¯ Singleton ç±»è¢«è£…è½½äº†ï¼Œinstance ä¸ä¸€å®šè¢«åˆå§‹åŒ–ã€‚ * å› ä¸º SingletonHolder ç±»æ²¡æœ‰è¢«ä¸»åŠ¨ä½¿ç”¨ï¼Œåªæœ‰é€šè¿‡æ˜¾å¼è°ƒç”¨ getInstance æ–¹æ³•æ—¶ï¼Œ * æ‰ä¼šæ˜¾å¼è£…è½½ SingletonHolder ç±»ï¼Œä»è€Œå®ä¾‹åŒ– instanceã€‚ * æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœå®ä¾‹åŒ– instance å¾ˆæ¶ˆè€—èµ„æºï¼Œæ‰€ä»¥æƒ³è®©å®ƒå»¶è¿ŸåŠ è½½ï¼Œ * å¦å¤–ä¸€æ–¹é¢ï¼Œåˆä¸å¸Œæœ›åœ¨ Singleton ç±»åŠ è½½æ—¶å°±å®ä¾‹åŒ–ï¼Œ * å› ä¸ºä¸èƒ½ç¡®ä¿ Singleton ç±»è¿˜å¯èƒ½åœ¨å…¶ä»–çš„åœ°æ–¹è¢«ä¸»åŠ¨ä½¿ç”¨ä»è€Œè¢«åŠ è½½ï¼Œ * é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å®ä¾‹åŒ– instance æ˜¾ç„¶æ˜¯ä¸åˆé€‚çš„ã€‚ * è¿™ä¸ªæ—¶å€™ï¼Œè¿™ç§æ–¹å¼ç›¸æ¯”ç¬¬ 3 ç§æ–¹å¼å°±æ˜¾å¾—å¾ˆåˆç†ã€‚ */class SingleObject_5 {    private static class SingletonHolder {        private static final SingleObject_5 INSTANCE = new SingleObject_5();    }    private SingleObject_5() {    }    public static final SingleObject_5 getInstance() {        return SingletonHolder.INSTANCE;    }    public void showMessage() {        System.out.println(&quot;5ã€ç™»è®°å¼/é™æ€å†…éƒ¨ç±»&quot;);    }}/** * 6ã€æšä¸¾ * JDK ç‰ˆæœ¬ï¼šJDK1.5 èµ· * æ˜¯å¦ Lazy åˆå§‹åŒ–ï¼šå¦ * æ˜¯å¦å¤šçº¿ç¨‹å®‰å…¨ï¼šæ˜¯ * å®ç°éš¾åº¦ï¼šæ˜“ * æè¿°ï¼šè¿™ç§å®ç°æ–¹å¼è¿˜æ²¡æœ‰è¢«å¹¿æ³›é‡‡ç”¨ï¼Œä½†è¿™æ˜¯å®ç°å•ä¾‹æ¨¡å¼çš„æœ€ä½³æ–¹æ³•ã€‚ * å®ƒæ›´ç®€æ´ï¼Œè‡ªåŠ¨æ”¯æŒåºåˆ—åŒ–æœºåˆ¶ï¼Œç»å¯¹é˜²æ­¢å¤šæ¬¡å®ä¾‹åŒ–ã€‚ * è¿™ç§æ–¹å¼æ˜¯ Effective Java ä½œè€… Josh Bloch æå€¡çš„æ–¹å¼ï¼Œå®ƒä¸ä»…èƒ½é¿å…å¤šçº¿ç¨‹åŒæ­¥é—®é¢˜ï¼Œ * è€Œä¸”è¿˜è‡ªåŠ¨æ”¯æŒåºåˆ—åŒ–æœºåˆ¶ï¼Œé˜²æ­¢ååºåˆ—åŒ–é‡æ–°åˆ›å»ºæ–°çš„å¯¹è±¡ï¼Œç»å¯¹é˜²æ­¢å¤šæ¬¡å®ä¾‹åŒ–ã€‚ * ä¸è¿‡ï¼Œç”±äº JDK1.5 ä¹‹åæ‰åŠ å…¥ enum ç‰¹æ€§ï¼Œç”¨è¿™ç§æ–¹å¼å†™ä¸å…è®©äººæ„Ÿè§‰ç”Ÿç–ï¼Œ * åœ¨å®é™…å·¥ä½œä¸­ï¼Œä¹Ÿå¾ˆå°‘ç”¨ã€‚ * ä¸èƒ½é€šè¿‡ reflection attack æ¥è°ƒç”¨ç§æœ‰æ„é€ æ–¹æ³•ã€‚ */enum SingleObject_6 {    INSTANCE;    public void showMessage() {        System.out.println(&quot;6ã€æšä¸¾&quot;);    }}/** * ç»éªŒä¹‹è°ˆï¼šä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸å»ºè®®ä½¿ç”¨ç¬¬ 1 ç§å’Œç¬¬ 2 ç§æ‡’æ±‰æ–¹å¼ï¼Œå»ºè®®ä½¿ç”¨ç¬¬ 3 ç§é¥¿æ±‰æ–¹å¼ã€‚ * åªæœ‰åœ¨è¦æ˜ç¡®å®ç° lazy loading æ•ˆæœæ—¶ï¼Œæ‰ä¼šä½¿ç”¨ç¬¬ 5 ç§ç™»è®°æ–¹å¼ã€‚ * å¦‚æœæ¶‰åŠåˆ°ååºåˆ—åŒ–åˆ›å»ºå¯¹è±¡æ—¶ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨ç¬¬ 6 ç§æšä¸¾æ–¹å¼ã€‚ * å¦‚æœæœ‰å…¶ä»–ç‰¹æ®Šçš„éœ€æ±‚ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ç¬¬ 4 ç§åŒæ£€é”æ–¹å¼ã€‚ */public class Singleton {    static void TestSingleObject_1() {        //ä¸åˆæ³•çš„æ„é€ å‡½æ•°        //ç¼–è¯‘æ—¶é”™è¯¯ï¼šæ„é€ å‡½æ•° SingleObject() æ˜¯ä¸å¯è§çš„        //SingleObject object = new SingleObject();        //è·å–å”¯ä¸€å¯ç”¨çš„å¯¹è±¡        SingleObject_1 object = SingleObject_1.getInstance();        //æ˜¾ç¤ºæ¶ˆæ¯        object.showMessage();    }    static void TestSingleObject_2() {        //è·å–å”¯ä¸€å¯ç”¨çš„å¯¹è±¡        SingleObject_2 object = SingleObject_2.getInstance();        //æ˜¾ç¤ºæ¶ˆæ¯        object.showMessage();    }    static void TestSingleObject_3() {        //è·å–å”¯ä¸€å¯ç”¨çš„å¯¹è±¡        SingleObject_3 object = SingleObject_3.getInstance();        //æ˜¾ç¤ºæ¶ˆæ¯        object.showMessage();    }    static void TestSingleObject_4() {        //è·å–å”¯ä¸€å¯ç”¨çš„å¯¹è±¡        SingleObject_4 object = SingleObject_4.getInstance();        //æ˜¾ç¤ºæ¶ˆæ¯        object.showMessage();    }    static void TestSingleObject_5() {        //è·å–å”¯ä¸€å¯ç”¨çš„å¯¹è±¡        SingleObject_5 object = SingleObject_5.getInstance();        //æ˜¾ç¤ºæ¶ˆæ¯        object.showMessage();    }    static void TestSingleObject_6() {        //è·å–å”¯ä¸€å¯ç”¨çš„å¯¹è±¡        SingleObject_6 object = SingleObject_6.INSTANCE;        //æ˜¾ç¤ºæ¶ˆæ¯        object.showMessage();    }    public static void main(String[] args) {        TestSingleObject_1();        TestSingleObject_2();        TestSingleObject_3();        TestSingleObject_4();        TestSingleObject_5();        TestSingleObject_6();    }}1ã€æ‡’æ±‰å¼ï¼Œçº¿ç¨‹ä¸å®‰å…¨2ã€æ‡’æ±‰å¼ï¼Œçº¿ç¨‹å®‰å…¨3ã€é¥¿æ±‰å¼4ã€åŒæ£€é”/åŒé‡æ ¡éªŒé”ï¼ˆDCLï¼Œå³ double-checked lockingï¼‰5ã€ç™»è®°å¼/é™æ€å†…éƒ¨ç±»6ã€æšä¸¾è¡Œä¸ºå‹æ¨¡å¼èŒè´£é“¾æ¨¡å¼(Chain of Responsibility)123456789101112131415161718192021222324252627282930@startumlabstract AbstractLogger{  #level:int  +logMessage(level: int, message:string)  +setNextLogger(nextLogger: AbstractLogger)  +write(message:string)}note right: å®šä¹‰ä¸€ä¸ªå¤„ç†è¯·ç¤ºçš„æ¥å£class Clientclass ConsoleLogger{  +write(message:string)}class ErrorLogger{  +write(message:string)}class FileLogger{  +write(message:string)}note bottom: å…·ä½“å¤„ç†è€…ç±»ï¼Œå¤„ç†å®ƒæ‰€è´Ÿè´£çš„è¯·æ±‚ï¼Œå¯è®¿é—®å®ƒçš„åç»§è€…ï¼Œ\n å¦‚æœå¯ä»¥å¤„ç†è¯¥è¯·æ±‚å°±å¤„ç†ï¼Œä¸ç„¶å°†è¯·æ±‚è½¬å‘ç»™å®ƒçš„åç»§è€…Client -right-&gt; AbstractLoggerAbstractLogger&lt;|-- ConsoleLoggerAbstractLogger &lt;|-- ErrorLoggerAbstractLogger &lt;|-- FileLoggerAbstractLogger &lt;--o AbstractLogger@endumlä¼˜ç‚¹è´£ä»»é“¾æ¨¡å¼å°†è¯·æ±‚å’Œå¤„ç†åˆ†å¼€ï¼Œè¯·æ±‚è€…ä¸çŸ¥é“æ˜¯è°å¤„ç†çš„ï¼Œå¤„ç†è€…å¯ä»¥ä¸ç”¨çŸ¥é“è¯·æ±‚çš„å…¨è²Œã€‚æé«˜ç³»ç»Ÿçš„çµæ´»æ€§ã€‚ç¼ºç‚¹é™ä½ç¨‹åºçš„æ€§èƒ½ã€‚æ¯ä¸ªè¯·æ±‚éƒ½æ˜¯ä»é“¾å¤´éå†åˆ°é“¾å°¾ï¼Œå½“é“¾æ¯”è¾ƒé•¿çš„æ—¶å€™ï¼Œæ€§èƒ½ä¼šå¤§å¹…ä¸‹é™ã€‚ä¸æ˜“äºè°ƒè¯•ã€‚ç”±äºè¯¥æ¨¡å¼é‡‡ç”¨äº†ç±»ä¼¼é€’å½’çš„æ–¹å¼ï¼Œè°ƒè¯•çš„æ—¶å€™é€»è¾‘æ¯”è¾ƒå¤æ‚ã€‚åº”ç”¨åœºæ™¯è´£ä»»é“¾æ¨¡å¼æ˜¯ä¸€ç§å¸¸è§çš„æ¨¡å¼ï¼ŒStruts2çš„æ ¸å¿ƒæ§ä»¶FilterDispatcheræ˜¯ä¸€ä¸ªServletè¿‡æ»¤å™¨ï¼Œè¯¥æ§ä»¶å°±æ˜¯é‡‡ç”¨è´£ä»»é“¾æ¨¡å¼ï¼Œå¯ä»¥å¯¹ç”¨æˆ·è¯·æ±‚è¿›è¡Œå±‚å±‚è¿‡æ»¤å¤„ç†ã€‚è´£ä»»é“¾æ¨¡å¼åœ¨å®é™…é¡¹ç›®ä¸­çš„ä½¿ç”¨æ¯”è¾ƒå¤šï¼Œå…¶å…¸å‹çš„åº”ç”¨åœºæ™¯å¦‚ä¸‹ï¼šä¸€ä¸ªè¯·æ±‚éœ€è¦ä¸€ç³»åˆ—çš„å¤„ç†å·¥ä½œã€‚ä¸šåŠ¡æµçš„å¤„ç†ï¼Œä¾‹å¦‚æ–‡ä»¶å®¡æ‰¹ã€‚å¯¹ç³»ç»Ÿè¿›è¡Œæ‰©å±•è¡¥å……ã€‚åœ¨è´£ä»»é“¾æ¨¡å¼ä¸­ï¼Œå®¢æˆ·åªéœ€è¦å°†è¯·æ±‚å‘é€åˆ°è´£ä»»é“¾ä¸Šå³å¯ï¼Œæ— é¡»å…³å¿ƒè¯·æ±‚çš„å¤„ç†ç»†èŠ‚å’Œè¯·æ±‚çš„ä¼ é€’è¿‡ç¨‹ï¼Œæ‰€ä»¥è´£ä»»é“¾å°†è¯·æ±‚çš„å‘é€è€…å’Œè¯·æ±‚çš„å¤„ç†è€…è§£è€¦äº†ã€‚è´£ä»»é“¾æ¨¡å¼æ˜¯ä¸€ç§å¯¹è±¡è¡Œä¸ºå‹æ¨¡å¼ï¼Œå…¶ä¸»è¦ä¼˜ç‚¹å¦‚ä¸‹ã€‚ä¸èƒ½ä¿è¯æ¯ä¸ªè¯·æ±‚ä¸€å®šè¢«å¤„ç†ã€‚ç”±äºä¸€ä¸ªè¯·æ±‚æ²¡æœ‰æ˜ç¡®çš„æ¥æ”¶è€…ï¼Œæ‰€ä»¥ä¸èƒ½ä¿è¯å®ƒä¸€å®šä¼šè¢«å¤„ç†ï¼Œè¯¥è¯·æ±‚å¯èƒ½ä¸€ç›´ä¼ åˆ°é“¾çš„æœ«ç«¯éƒ½å¾—ä¸åˆ°å¤„ç†ã€‚å¯¹æ¯”è¾ƒé•¿çš„èŒè´£é“¾ï¼Œè¯·æ±‚çš„å¤„ç†å¯èƒ½æ¶‰åŠå¤šä¸ªå¤„ç†å¯¹è±¡ï¼Œç³»ç»Ÿæ€§èƒ½å°†å—åˆ°ä¸€å®šå½±å“ã€‚èŒè´£é“¾å»ºç«‹çš„åˆç†æ€§è¦é å®¢æˆ·ç«¯æ¥ä¿è¯ï¼Œå¢åŠ äº†å®¢æˆ·ç«¯çš„å¤æ‚æ€§ï¼Œå¯èƒ½ä¼šç”±äºèŒè´£é“¾çš„é”™è¯¯è®¾ç½®è€Œå¯¼è‡´ç³»ç»Ÿå‡ºé”™ï¼Œå¦‚å¯èƒ½ä¼šé€ æˆå¾ªç¯è°ƒç”¨ã€‚å‘½ä»¤æ¨¡å¼(Command)12345678910111213141516171819202122232425262728293031323334353637@startumlclass Invoker{  -concreteCommandA:ICommand  -concreteCommandB:ICommand  +orderA():void  +orderB():void}note top: è¦æ±‚è¯¥å‘½ä»¤æ‰§è¡Œè¿™ä¸ªè¯·æ±‚interface ICommand {  +execute():void}note top: ç”¨æ¥å£°æ˜æ‰§è¡Œæ“ä½œçš„æ¥å£class ConcreteCommandA{  -receiver:Receiver  +execute():void}class ConcreteCommandB{  -receiver:Receiver  +execute():void}note bottom: å°†ä¸€ä¸ªæ¥æ”¶è€…å¯¹è±¡ç»‘å®šäºä¸€ä¸ªåŠ¨ä½œ,\nè°ƒç”¨æ¥æ”¶è€…ç›¸åº”çš„æ“ä½œ,ä»¥å®ç°Executeclass Receiver{  +execute():void}note bottom: çŸ¥é“å¦‚ä½•å®æ–½ä¸æ‰§è¡Œä¸€ä¸ªè¯·æ±‚ç›¸å…³\nçš„æ“ä½œ,ä»»ä½•ç±»éƒ½å¯èƒ½ä½œä¸ºä¸€ä¸ªæ¥æ”¶è€…Client .right.&gt; InvokerClient .right.&gt; ReceiverICommand &lt;|-- ConcreteCommandAICommand &lt;|-- ConcreteCommandBInvoker o-right-&gt; ICommandReceiver &lt;-- ConcreteCommandA@endumlå‘½ä»¤æ¨¡å¼çš„å‡ ä¸ªè§’è‰²ï¼šæŠ½è±¡å‘½ä»¤æ¥å£ICommandï¼šå®šä¹‰å‘½ä»¤çš„æ¥å£ï¼Œå£°æ˜æ‰§è¡Œçš„æ–¹æ³•ã€‚å…·ä½“çš„å‘½ä»¤å¯¹è±¡ConcreteCommandï¼šæŒæœ‰å…·ä½“çš„æ¥å—è€…å¯¹è±¡ï¼Œå®Œæˆå…·ä½“çš„å…·ä½“çš„å‘½ä»¤ã€‚æ¥å—è€…å¯¹è±¡Receiverï¼šæ¥å—è€…å¯¹è±¡ï¼ŒçœŸæ­£æ‰§è¡Œå‘½ä»¤çš„å¯¹è±¡ã€‚ä¼ é€’å‘½ä»¤å¯¹è±¡Invokerï¼šæŒæœ‰å‘½ä»¤å¯¹è±¡ï¼Œè¦æ±‚å‘½ä»¤å¯¹è±¡æ‰§è¡Œè¯·æ±‚ã€‚å®¢æˆ·ç«¯å¯¹è±¡Clientï¼šåˆ›å»ºå…·ä½“å‘½ä»¤çš„å¯¹è±¡å¹¶ä¸”è®¾ç½®å‘½ä»¤å¯¹è±¡çš„æ¥å—è€…ã€‚Javaè®¾è®¡æ¨¡å¼ï¼ˆ18ï¼‰ä¹‹å‘½ä»¤æ¨¡å¼è§£é‡Šå™¨æ¨¡å¼(Interpreter)1234567891011121314151617181920212223242526272829303132333435363738394041@startumlabstract ReadXmlExpression{  +interpret(c:Context):String[]}note left: æŠ½è±¡è¡¨è¾¾å¼,å£°æ˜ä¸€ä¸ªæŠ½è±¡çš„è§£é‡Šæ“ä½œ,\nè¿™ä¸ªæ¥å£ä¸ºæŠ½è±¡è¯­æ³•æ ‘ä¸­æ‰€æœ‰çš„èŠ‚ç‚¹å…±äº«class ElementExpression{  -eles:Collection&lt;ReadXmlExpression&gt;  -eleName:String  +addEle(ele:ReadXmlExpression):boolean  +removeEle(ele:ReadXmlExpression):boolean  +interpret(c:Context):String[]}note bottom: éç»ˆç»“è¡¨è¾¾å¼,ä¸ºæ–‡æ³•ä¸­çš„éç»ˆç»“\nç¬¦å®ç°è§£é‡Šæ“ä½œã€‚å¯¹æ–‡æ³•ä¸­æ¯ä¸€æ¡\nè§„åˆ™R1..Rnéƒ½éœ€è¦ä¸€ä¸ªå…·ä½“çš„éç»ˆç»“ç¬¦\nè¡¨è¾¾å¼ç±»class ElementTerminalExpression{  -eleName:String  +interpret(c:Context):String[]}note bottom: ç»ˆç»“è¡¨è¾¾å¼,å®ç°ä¸æ–‡æ³•ä¸­çš„ç»ˆç»“ç¬¦\nç›¸å…³è”çš„è§£é‡Šæ“ä½œclass PropertyTerminalExpression{  -eleName:String  +interpret(c:Context):String[]}class Context{  -preEle:Element  -document:Document  +reInit():void  +getNowEle(pEle:Element,eleName:String):Element}note right: åŒ…å«è§£é‡Šå™¨ä¹‹å¤–çš„ä¸€äº›å…¨å±€ä¿¡æ¯ReadXmlExpression &lt;|-- ElementExpressionReadXmlExpression &lt;|-- ElementTerminalExpressionReadXmlExpression &lt;|-- PropertyTerminalExpressionClinet ..&gt; ContextClinet ..&gt; ReadXmlExpressionElementExpression o--&gt; ReadXmlExpression@endumlè¿­ä»£å™¨æ¨¡å¼(Iterator)1234567891011121314151617181920212223242526272829303132@startumlinterface IAggregate{  +CreateIterator(): int}note top: èšé›†æ¥å£class Clientinterface AbsIterator{  +First()  +Next()  +IsDone()  +CurrentItem()}note top: è¿­ä»£æ¥å£ç±»ï¼Œç”¨äºå¾—åˆ°å¼€å§‹å¯¹è±¡ã€ \n å¾—åˆ°ä¸‹ä¸€ä¸ªå¯¹è±¡ã€åˆ¤æ–­æ˜¯å¦åˆ°ç»“å°¾ã€ \n å½“å‰å¯¹è±¡ç­‰æŠ½è±¡æ–¹æ³•ï¼Œç»Ÿä¸€æ¥å£class ConcreteIteratornote bottom: å…·ä½“è¿­ä»£å™¨ç±»class ConcreteAggregate{  +CreateIterator(): int}note bottom: å…·ä½“èšé›†ç±»ï¼Œç»§æ‰¿è‡ªIAggregateClient -left-&gt; AbsIteratorClient -right-&gt; IAggregateIAggregate &lt;|-- ConcreteAggregateAbsIterator &lt;|-- ConcreteIteratorConcreteAggregate &lt;-left- ConcreteIteratorConcreteAggregate .left.&gt; ConcreteIterator@endumlä¸­ä»‹è€…æ¨¡å¼(Mediator)1234567891011121314151617181920@startumlinterface Mediatornote left: æ¥å£ç»ˆä¸­ä»‹è€…ï¼Œå®šä¹‰äº†Colleague \n å¯¹è±¡åˆ°Mediatorå¯¹è±¡çš„æ¥å£abstract AbsColleagueclass ConcreteMediatornote left: å…·ä½“ä¸­ä»‹è€…å¯¹è±¡ï¼Œå®ç°æŠ½è±¡ç±»çš„æ–¹æ³•ï¼Œ\n å®ƒéœ€è¦çŸ¥é“æ‰€æœ‰å…·ä½“çš„Colleagueç±»ï¼Œå¹¶ä»å…·ä½“çš„ \n Colleagueæ¥æ”¶æ¶ˆæ¯ï¼Œå‘å…·ä½“Colleagueå¯¹è±¡å‘å‡ºå‘½ä»¤class ColleagueAnote top: å…·ä½“Colleagueç±»ï¼Œæ¯ä¸ªå…·ä½“ColleagueåªçŸ¥é“è‡ªå·± \n çš„è¡Œä¸ºï¼Œè€Œä¸äº†è§£å…¶ä»–Colleagueç±»çš„æƒ…å†µï¼Œ \n ä½†å®ƒä»¬å´éƒ½è®¤è¯†Mediatorå¯¹è±¡class ColleagueBMediator &lt;|-- ConcreteMediatorAbsColleague &lt;|-- ColleagueAAbsColleague &lt;|-- ColleagueBColleagueA &lt;-- ConcreteMediatorColleagueB &lt;-- ConcreteMediator@endumlä¸­ä»‹è€…æ¨¡å¼çš„å®šä¹‰ç”¨ä¸€ä¸ªä¸­ä»‹è€…å¯¹è±¡å°è£…ä¸€ç³»åˆ—çš„å¯¹è±¡äº¤äº’ï¼Œä¸­ä»‹è€…ä½¿å„å¯¹è±¡ä¸éœ€è¦æ˜¾ç¤ºåœ°ç›¸äº’ä½œç”¨ï¼Œä»è€Œä½¿è€¦åˆæ¾æ•£ï¼Œè€Œä¸”å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜å®ƒä»¬ä¹‹é—´çš„äº¤äº’ã€‚ä¸­ä»‹è€…æ¨¡å¼çš„ä¼˜ç‚¹é€‚å½“åœ°ä½¿ç”¨ä¸­ä»‹è€…æ¨¡å¼å¯ä»¥é¿å…åŒäº‹ç±»ä¹‹é—´çš„è¿‡åº¦è€¦åˆï¼Œä½¿å¾—å„åŒäº‹ç±»ä¹‹é—´å¯ä»¥ç›¸å¯¹ç‹¬ç«‹åœ°ä½¿ç”¨ã€‚ä½¿ç”¨ä¸­ä»‹è€…æ¨¡å¼å¯ä»¥å°†å¯¹è±¡é—´ä¸€å¯¹å¤šçš„å…³è”è½¬å˜ä¸ºä¸€å¯¹ä¸€çš„å…³è”ï¼Œä½¿å¯¹è±¡é—´çš„å…³ç³»æ˜“äºç†è§£å’Œç»´æŠ¤ã€‚ä½¿ç”¨ä¸­ä»‹è€…æ¨¡å¼å¯ä»¥å°†å¯¹è±¡çš„è¡Œä¸ºå’Œåä½œè¿›è¡ŒæŠ½è±¡ï¼Œèƒ½å¤Ÿæ¯”è¾ƒçµæ´»çš„å¤„ç†å¯¹è±¡é—´çš„ç›¸äº’ä½œç”¨ã€‚é€‚ç”¨åœºæ™¯ åœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ï¼Œä¸€ä¸ªç±»å¿…ç„¶ä¼šä¸å…¶ä»–çš„ç±»å‘ç”Ÿä¾èµ–å…³ç³»ï¼Œå®Œå…¨ç‹¬ç«‹çš„ç±»æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚ä¸€ä¸ªç±»åŒæ—¶ä¾èµ–å¤šä¸ªç±»çš„æƒ…å†µä¹Ÿç›¸å½“æ™®éï¼Œæ—¢ç„¶å­˜åœ¨è¿™æ ·çš„æƒ…å†µï¼Œè¯´æ˜ï¼Œä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»æœ‰å®ƒçš„åˆç†æ€§ï¼Œé€‚å½“çš„ä½¿ç”¨ä¸­ä»‹è€…æ¨¡å¼å¯ä»¥ä½¿åŸæœ¬å‡Œä¹±çš„å¯¹è±¡å…³ç³»æ¸…æ™°ï¼Œä½†æ˜¯å¦‚æœæ»¥ç”¨ï¼Œåˆ™å¯èƒ½ä¼šå¸¦æ¥åçš„æ•ˆæœã€‚ä¸€èˆ¬æ¥è¯´ï¼Œåªæœ‰å¯¹äºé‚£ç§åŒäº‹ç±»ä¹‹é—´æ˜¯ç½‘çŠ¶ç»“æ„çš„å…³ç³»ï¼Œæ‰ä¼šè€ƒè™‘ä½¿ç”¨ä¸­ä»‹è€…æ¨¡å¼ã€‚å¯ä»¥å°†ç½‘çŠ¶ç»“æ„å˜ä¸ºæ˜ŸçŠ¶ç»“æ„ï¼Œä½¿åŒäº‹ç±»ä¹‹é—´çš„å…³ç³»å˜çš„æ¸…æ™°ä¸€äº›ã€‚ ä¸­ä»‹è€…æ¨¡å¼æ˜¯ä¸€ç§æ¯”è¾ƒå¸¸ç”¨çš„æ¨¡å¼ï¼Œä¹Ÿæ˜¯ä¸€ç§æ¯”è¾ƒå®¹æ˜“è¢«æ»¥ç”¨çš„æ¨¡å¼ã€‚å¯¹äºå¤§å¤šæ•°çš„æƒ…å†µï¼ŒåŒäº‹ç±»ä¹‹é—´çš„å…³ç³»ä¸ä¼šå¤æ‚åˆ°æ··ä¹±ä¸å ªçš„ç½‘çŠ¶ç»“æ„ï¼Œå› æ­¤ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå°†å¯¹è±¡é—´çš„ä¾èµ–å…³ç³»å°è£…çš„åŒäº‹ç±»å†…éƒ¨å°±å¯ä»¥çš„ï¼Œæ²¡æœ‰å¿…è¦éå¼•å…¥ä¸­ä»‹è€…æ¨¡å¼ã€‚æ»¥ç”¨ä¸­ä»‹è€…æ¨¡å¼ï¼Œåªä¼šè®©äº‹æƒ…å˜çš„æ›´å¤æ‚ã€‚ä¼˜ç‚¹ï¼š1ã€é™ä½äº†ç±»çš„å¤æ‚åº¦ï¼Œå°†ä¸€å¯¹å¤šè½¬åŒ–æˆäº†ä¸€å¯¹ä¸€ã€‚2ã€å„ä¸ªç±»ä¹‹é—´çš„è§£è€¦ã€‚3ã€ç¬¦åˆè¿ªç±³ç‰¹åŸåˆ™ã€‚ç¼ºç‚¹ï¼š1.ä¸­ä»‹è€…ä¼šåºå¤§ï¼Œå˜å¾—å¤æ‚éš¾ä»¥ç»´æŠ¤ã€‚2.å¦‚æœä¸­ä»‹è€…ç±»å‡ºç°é—®é¢˜ï¼Œå°†ä¼šå¯¼è‡´æ‰€æœ‰ç›¸å…³ç±»å‡ºé—®é¢˜ã€‚Where:å¤šä¸ªç±»ç›¸äº’è€¦åˆï¼Œå½¢æˆäº†ç½‘çŠ¶ç»“æ„ã€‚è®¾è®¡æ¨¡å¼ä¹‹ä¸­ä»‹è€…æ¨¡å¼ï¼ˆMediator Patternï¼‰å¤‡å¿˜å½•æ¨¡å¼(Memento)Javaè®¾è®¡æ¨¡å¼å­¦ä¹ è®°å½•-å¤‡å¿˜å½•æ¨¡å¼https://www.cnblogs.com/jimoer/p/9537997.html12345678910111213141516171819202122@startumlclass Game{  +playerStep:int  +restore(gameMemento: GameMemento):void  +createGameMemento():GameMemento}note Bottom: è´Ÿè´£åˆ›å»ºä¸€ä¸ªå¤‡å¿˜å½•GameMementoï¼Œ \n ç”¨ä»¥è®°å½•å½“å‰æ—¶åˆ»çš„å†…éƒ¨çŠ¶æ€ï¼Œ \n å¹¶å¯ä½¿ç”¨å¤‡å¿˜å½•æ¢å¤å†…éƒ¨çŠ¶æ€class GameMemento{  -playerSteps:int}note top: è´Ÿè´£å­˜å‚¨Gameå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œ\n å¹¶å¯é˜²æ­¢Gameä»¥å¤–çš„å¯¹è±¡è®¿é—® \n å¤‡å¿˜å½•GameMementoclass Caretaker{  -gameMemento: GameMemento  +saveMemento(gameMemento:GameMemento):void}note right: è´Ÿè´£ä¿å­˜å¥½å¤‡å¿˜å½•GameMementoGame .right.&gt; GameMementoGameMemento &lt;--o Caretaker@endumlè§‚å¯Ÿè€…æ¨¡å¼(Observer)123456789101112131415161718192021222324252627282930313233343536373839404142434445@startumlclass ISubject{  +attach(observer: Observer)  +detach(observer: Observer)  +notifyAllObservers()}note top: ISubjectç±»,å®ƒæŠŠæ‰€æœ‰å¯¹è§‚å¯Ÿè€…å¯¹è±¡çš„å¼•ç”¨ä¿å­˜åœ¨ä¸€ä¸ª\nèšé›†é‡Œ,æ¯ä¸ªä¸»é¢˜éƒ½å¯ä»¥æœ‰ä»»ä½•æ•°é‡çš„è§‚å¯Ÿè€….  ä¸»é¢˜æä¾›\nä¸€ä¸ªæ¥å£,å¯ä»¥å¢åŠ å’Œåˆ é™¤è§‚å¯Ÿè€…å¯¹è±¡ class Subject{  #observers:List&lt;Observer&gt;  +state: int  +getState()  +setState()  +attach(observer: Observer)  +detach(observer: Observer)  +notifyAllObservers()}note bottom: Subjectç±»,å…·ä½“ä¸»é¢˜,å°†æœ‰å…³çŠ¶æ€å­˜å…¥\nå…·ä½“è§‚å¯Ÿè€…å¯¹è±¡;åœ¨å…·ä½“ä¸»é¢˜çš„å†…éƒ¨çŠ¶æ€æ”¹å˜\nçš„æ—¶å€™ï¼Œç»™æ‰€æœ‰ç™»è®°è¿‡çš„è§‚å¯Ÿè€…å‘å‡ºé€šçŸ¥ abstract Observer{  #subject:Subject  +update()}note top: æŠ½è±¡è§‚å¯Ÿè€…,ä¸ºæ‰€æœ‰çš„å…·ä½“è§‚å¯Ÿè€…å®šä¹‰\nä¸€ä¸ªæ¥å£,åœ¨å¾—åˆ°ä¸»é¢˜çš„é€šçŸ¥æ—¶æ›´æ–°è‡ªå·±class BinaryObserver{  +update()}class OctalObserver{  +update()}note bottom: å…·ä½“è§‚å¯Ÿè€…,å®ç°æŠ½è±¡è§‚å¯Ÿè€…è§’è‰²æ‰€\nè¦æ±‚çš„æ›´æ–°æ¥å£,ä»¥ä¾¿ä½¿è‡ªèº«çŠ¶æ€ä¸ä¸»é¢˜çŠ¶æ€ç›¸åè°ƒclass HexaObserver{  +update()}ISubject &lt;|-- SubjectObserver &lt;|-- BinaryObserverObserver &lt;|-- OctalObserverObserver &lt;|-- HexaObserverSubject &lt;-left- HexaObserverISubject -right-&gt; Observer@endumlçŠ¶æ€æ¨¡å¼(State)123456789101112131415161718192021222324252627@startumlinterface Statenote left: çŠ¶æ€ç±»æ¥å£ï¼Œå®šä¹‰ä¸€ä¸ªæ¥å£ä»¥å°è£…ä¸ \n Contextçš„ä¸€ä¸ªç‰¹å®šçŠ¶æ€ç›¸å…³çš„è¡Œä¸ºclass Context{  +Request()}note left: ç»´æŠ¤ä¸€ä¸ªConcreteStateå­ç±»çš„å®ä¾‹ï¼Œ\n è¿™ä¸ªå®ä¾‹å®šä¹‰å½“å‰çš„çŠ¶æ€class ConcreteStateA{  +Handle()}note right: å…·ä½“çŠ¶æ€ï¼Œæ¯ä¸€ä¸ªå­ç±»å®ç°ä¸€ä¸ª \n ä¸Contextçš„ä¸€ä¸ªçŠ¶æ€ç›¸å…³çš„è¡Œä¸ºclass ConcreteStateB{  +Handle()}class ConcreteStateC{  +Handle()}Context o--&gt; StateState &lt;|-- ConcreteStateAState &lt;|-- ConcreteStateBState &lt;|-- ConcreteStateC@endumlç­–ç•¥æ¨¡å¼(Strategy)12345678910111213141516171819202122232425262728@startumlclass OperationAdd{  +doOperation()}class OperationSubstract{  +doOperation()}class OperationMultiply{  +doOperation()}note bottom: å…·ä½“ç­–ç•¥ç±»ï¼Œå°è£…äº†å…·ä½“çš„ç®—æ³•æˆ–è¡Œä¸ºï¼Œç»§æ‰¿äºIStrategyclass Context{  +executeStrategy()}note bottom: Contextä¸Šä¸‹æ–‡ï¼Œç”¨ä¸€ä¸ª \n ConcreateStategyæ¥é…ç½®ï¼Œ \n ç»´æŠ¤ä¸€ä¸ªå¯¹IStrategyå¯¹è±¡çš„å¼•ç”¨interface IStrategy{  +doOperation()}note right:ç­–ç•¥ç±»ï¼Œå®šä¹‰æ‰€æœ‰æ”¯æŒçš„ç®—æ³•çš„å…¬å…±æ¥å£Context &lt;-left-o IStrategyIStrategy&lt;|-- OperationAddIStrategy&lt;|-- OperationSubstractIStrategy&lt;|-- OperationMultiply@endumläºŒåä¸‰ç§è®¾è®¡æ¨¡å¼ - ç­–ç•¥æ¨¡å¼æ¨¡å¼å®šä¹‰ç­–ç•¥æ¨¡å¼ï¼šå±äºå¯¹è±¡çš„è¡Œä¸ºæ¨¡å¼ã€‚å…¶ç”¨æ„æ˜¯é’ˆå¯¹ä¸€ç»„ç®—æ³•ï¼Œå°†æ¯ä¸€ä¸ªç®—æ³•å°è£…åˆ°å…·æœ‰å…±åŒæ¥å£çš„ç‹¬ç«‹çš„ç±»ä¸­ï¼Œä»è€Œä½¿å¾—å®ƒä»¬å¯ä»¥ç›¸äº’æ›¿æ¢ã€‚ç­–ç•¥æ¨¡å¼ï¼šä½¿å¾—ç®—æ³•å¯ä»¥åœ¨ä¸å½±å“åˆ°å®¢æˆ·ç«¯çš„æƒ…å†µä¸‹å‘ç”Ÿå˜åŒ–ã€‚ç­–ç•¥æ¨¡å¼ï¼šæ˜¯å¯¹ç®—æ³•çš„åŒ…è£…ï¼Œæ˜¯æŠŠä½¿ç”¨ç®—æ³•çš„è´£ä»»å’Œç®—æ³•æœ¬èº«åˆ†å‰²å¼€æ¥ï¼Œå§”æ´¾ç»™ä¸åŒçš„å¯¹è±¡ç®¡ç†ã€‚ç­–ç•¥æ¨¡å¼é€šå¸¸æŠŠä¸€ä¸ªç³»åˆ—çš„ç®—æ³•åŒ…è£…åˆ°ä¸€ç³»åˆ—çš„ç­–ç•¥ç±»é‡Œé¢ï¼Œä½œä¸ºä¸€ä¸ªæŠ½è±¡ç­–ç•¥ç±»çš„å­ç±»ã€‚ç”¨ä¸€å¥è¯æ¥è¯´ï¼Œå°±æ˜¯ï¼šâ€œå‡†å¤‡ä¸€ç»„ç®—æ³•ï¼Œå¹¶å°†æ¯ä¸€ä¸ªç®—æ³•å°è£…èµ·æ¥ï¼Œä½¿å¾—å®ƒä»¬å¯ä»¥äº’æ¢â€ã€‚å‚ä¸è€…ç­–ç•¥æ¨¡å¼å‚ä¸è€…ï¼šContextï¼šç¯å¢ƒè§’è‰²ï¼ŒæŒæœ‰ä¸€ä¸ªStrategyçš„å¼•ç”¨ã€‚Strategyï¼šæŠ½è±¡ç­–ç•¥è§’è‰²ï¼Œè¿™æ˜¯ä¸€ä¸ªæŠ½è±¡è§’è‰²ï¼Œé€šå¸¸ç”±ä¸€ä¸ªæ¥å£æˆ–æŠ½è±¡ç±»å®ç°ã€‚æ­¤è§’è‰²ç»™å‡ºæ‰€æœ‰çš„å…·ä½“ç­–ç•¥ç±»æ‰€éœ€çš„æ¥å£ã€‚ConcreteStrategyï¼šå…·ä½“ç­–ç•¥è§’è‰²ï¼ŒåŒ…è£…äº†ç›¸å…³çš„ç®—æ³•æˆ–è¡Œä¸ºä¼˜ç‚¹ï¼šä¸šåŠ¡é€»è¾‘å’Œå‰ç«¯å±•ç¤ºç›¸äº’åˆ†ç¦»å¼€äº†ã€‚ä¸šåŠ¡é€»è¾‘çš„ä¿®æ”¹ï¼Œä¸å½±å“å‰ç«¯ä»£ç å±•ç¤ºã€‚æ¯ä¸€ä¸ªä¸šåŠ¡é€»è¾‘å•ç‹¬ä¸€ä¸ªç±»ï¼Œä¿®æ”¹æˆ–è€…æ·»åŠ ä¸€ä¸ªç±»ï¼Œä¸ä¼šå½±å“åˆ°å…¶ä»–çš„ç±»ã€‚ä½¿ç”¨å·¥å‚ç±»å°è£…äº†ä¸šåŠ¡é€»è¾‘ç±»ï¼Œå‰ç«¯ä¸éœ€è¦çŸ¥é“åˆ°åº•æ¯ç§ä¸šåŠ¡æ€ä¹ˆå®ç°ï¼Œåªéœ€è¦çŸ¥é“ä»–çš„çˆ¶ç±»å³å¯ã€‚ç¼ºç‚¹ï¼šå¦‚æœæ´»åŠ¨å¾ˆé¢‘ç¹ï¼Œç»å¸¸ä¼šæå„ç§å„æ ·çš„æ´»åŠ¨ï¼Œé‚£ä¹ˆä¸šåŠ¡é€»è¾‘å°±ä¼šæœ‰å¾ˆå¤šç§ï¼Œæ¯ä¸€æ¬¡éƒ½è¦å¢åŠ ä¸€ä¸ªç±»ã€‚æ¯å¢åŠ ä¸€ä¸ªç±»éƒ½è¦ä¿®æ”¹å·¥å‚ç±»ï¼Œä¿®æ”¹ä¼šå¾ˆé¢‘ç¹ã€‚ç­–ç•¥æ¨¡å¼çš„ä¼˜ç‚¹ï¼ˆ1ï¼‰ç­–ç•¥æ¨¡å¼æä¾›äº†ç®¡ç†ç›¸å…³çš„ç®—æ³•æ—çš„åŠæ³•ã€‚ç­–ç•¥ç±»çš„ç­‰çº§ç»“æ„å®šä¹‰äº†ä¸€ä¸ªç®—æ³•æˆ–è¡Œä¸ºæ—ã€‚æ°å½“ä½¿ç”¨ç»§æ‰¿å¯ä»¥æŠŠå…¬å…±çš„ä»£ç ç§»åˆ°çˆ¶ç±»é‡Œé¢ï¼Œä»è€Œé¿å…ä»£ç é‡å¤ã€‚ï¼ˆ2ï¼‰ä½¿ç”¨ç­–ç•¥æ¨¡å¼å¯ä»¥é¿å…ä½¿ç”¨å¤šé‡æ¡ä»¶(if-else)è¯­å¥ã€‚å¤šé‡æ¡ä»¶è¯­å¥ä¸æ˜“ç»´æŠ¤ï¼Œå®ƒæŠŠé‡‡å–å“ªä¸€ç§ç®—æ³•æˆ–é‡‡å–å“ªä¸€ç§è¡Œä¸ºçš„é€»è¾‘ä¸ç®—æ³•æˆ–è¡Œä¸ºçš„é€»è¾‘æ··åˆåœ¨ä¸€èµ·ï¼Œç»Ÿç»Ÿåˆ—åœ¨ä¸€ä¸ªå¤šé‡æ¡ä»¶è¯­å¥é‡Œé¢ï¼Œæ¯”ä½¿ç”¨ç»§æ‰¿çš„åŠæ³•è¿˜è¦åŸå§‹å’Œè½åã€‚ç­–ç•¥æ¨¡å¼çš„ç¼ºç‚¹ï¼ˆ1ï¼‰å®¢æˆ·ç«¯å¿…é¡»çŸ¥é“æ‰€æœ‰çš„ç­–ç•¥ç±»ï¼Œå¹¶è‡ªè¡Œå†³å®šä½¿ç”¨å“ªä¸€ä¸ªç­–ç•¥ç±»ã€‚è¿™å°±æ„å‘³ç€å®¢æˆ·ç«¯å¿…é¡»ç†è§£è¿™äº›ç®—æ³•çš„åŒºåˆ«ï¼Œä»¥ä¾¿é€‚æ—¶é€‰æ‹©æ°å½“çš„ç®—æ³•ç±»ã€‚æ¢è¨€ä¹‹ï¼Œç­–ç•¥æ¨¡å¼åªé€‚ç”¨äºå®¢æˆ·ç«¯çŸ¥é“ç®—æ³•æˆ–è¡Œä¸ºçš„æƒ…å†µã€‚ï¼ˆ2ï¼‰ç”±äºç­–ç•¥æ¨¡å¼æŠŠæ¯ä¸ªå…·ä½“çš„ç­–ç•¥å®ç°éƒ½å•ç‹¬å°è£…æˆä¸ºç±»ï¼Œå¦‚æœå¤‡é€‰çš„ç­–ç•¥å¾ˆå¤šçš„è¯ï¼Œé‚£ä¹ˆå¯¹è±¡çš„æ•°ç›®å°±ä¼šå¾ˆå¯è§‚ç”¨é€”ä¸ä¸€æ ·å·¥å‚æ˜¯åˆ›å»ºå‹æ¨¡å¼,å®ƒçš„ä½œç”¨å°±æ˜¯åˆ›å»ºå¯¹è±¡ï¼›ç­–ç•¥æ˜¯è¡Œä¸ºå‹æ¨¡å¼,å®ƒçš„ä½œç”¨æ˜¯è®©ä¸€ä¸ªå¯¹è±¡åœ¨è®¸å¤šè¡Œä¸ºä¸­é€‰æ‹©ä¸€ç§è¡Œä¸º;å…³æ³¨ç‚¹ä¸ä¸€æ ·ä¸€ä¸ªå…³æ³¨å¯¹è±¡åˆ›å»ºä¸€ä¸ªå…³æ³¨è¡Œä¸ºçš„å°è£…è§£å†³ä¸åŒçš„é—®é¢˜å·¥å‚æ¨¡å¼æ˜¯åˆ›å»ºå‹çš„è®¾è®¡æ¨¡å¼ï¼Œå®ƒæ¥å—æŒ‡ä»¤ï¼Œåˆ›å»ºå‡ºç¬¦åˆè¦æ±‚çš„å®ä¾‹ï¼›å®ƒä¸»è¦è§£å†³çš„æ˜¯èµ„æºçš„ç»Ÿä¸€åˆ†å‘ï¼Œå°†å¯¹è±¡çš„åˆ›å»ºå®Œå…¨ç‹¬ç«‹å‡ºæ¥ï¼Œè®©å¯¹è±¡çš„åˆ›å»ºå’Œå…·ä½“çš„ä½¿ç”¨å®¢æˆ·æ— å…³ã€‚ä¸»è¦åº”ç”¨åœ¨å¤šæ•°æ®åº“é€‰æ‹©ï¼Œç±»åº“æ–‡ä»¶åŠ è½½ç­‰ã€‚ç­–ç•¥æ¨¡å¼æ˜¯ä¸ºäº†è§£å†³çš„æ˜¯ç­–ç•¥çš„åˆ‡æ¢ä¸æ‰©å±•ï¼Œæ›´ç®€æ´çš„è¯´æ˜¯å®šä¹‰ç­–ç•¥æ—ï¼Œåˆ†åˆ«å°è£…èµ·æ¥ï¼Œè®©ä»–ä»¬ä¹‹é—´å¯ä»¥ç›¸äº’æ›¿æ¢ï¼Œç­–ç•¥æ¨¡å¼è®©ç­–ç•¥çš„å˜åŒ–ç‹¬ç«‹äºä½¿ç”¨ç­–ç•¥çš„å®¢æˆ·ã€‚å·¥å‚ç›¸å½“äºé»‘ç›’å­ï¼Œç­–ç•¥ç›¸å½“äºç™½ç›’å­ï¼›æ¨¡æ¿æ–¹æ³•æ¨¡å¼(Template Method)12345678910111213141516171819202122232425@startumlabstract AbsTestPaper{  +TestQuestion1()  +TestQuestion2()  +TestQuestion3()  +Answer1()  +Answer2()  +Answer3()}class TestPaperA{  +Answer1()  +Answer2()  +Answer3()}class TestPaperB{  +Answer1()  +Answer2()  +Answer3()}AbsTestPaper &lt;|-- TestPaperAAbsTestPaper &lt;|-- TestPaperB@endumlè®¿é—®è€…æ¨¡å¼(Visitor)è®¾è®¡æ¨¡å¼ï¼šè®¿é—®è€…ï¼ˆVisitorï¼‰æ¨¡å¼è®¿é—®è€…æ¨¡å¼ä¸€ç¯‡å°±å¤Ÿäº†12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849@startumlclass Clinet{  +visitor()}abstract Staff{  +accept(visitor: Visitor)}note top: å®šä¹‰ä¸€ä¸ªacceptæ“ä½œ,å®ƒä»¥ä¸€ä¸ªè®¿é—®ä¸ºå‚æ•°class Engineer{  +accept(visitor: Visitor)}class Manager{  +accept(visitor: Visitor)}note bottom: å…·ä½“å…ƒç´ ,å®ç°acceptæ“ä½œclass BusinessReport{  -mStaffs: List&lt;Staff&gt;  +showReport(visitor: Visitor)}note bottom: èƒ½æšä¸¾å®ƒçš„å…ƒç´ ,å¯ä»¥æä¾›ä¸€ä¸ªé«˜å±‚çš„æ¥å£\nä»¥å…è®¸è®¿é—®è€…è®¿é—®å®ƒçš„å…ƒç´ interface Visitor{  +visit(engineer: Engineer)  +visit(manager: Manager)}note top:ä¸ºè¯¥å¯¹è±¡ç»“æ„ä¸­æ¯ä¸ªå®ç°ç±»å£°æ˜ä¸€ä¸ªvisitæ“ä½œclass CEOVisitor{  +visit(engineer: Engineer)  +visit(manager: Manager) }class CTOVisitor{  +visit(engineer: Engineer)  +visit(manager: Manager) }note bottom: å…·ä½“è®¿é—®è€…,å®ç°æ¯ä¸ªç”±Visitorå£°æ˜çš„æ“ä½œ,\næ¯ä¸ªæ“ä½œå®ç°ç®—æ³•çš„ä¸€éƒ¨åˆ†,è€Œè¯¥ç®—æ³•\nç‰‡æ®µä»æ˜¯å¯¹åº”äºç»“æ„ä¸­å¯¹è±¡çš„ç±»Staff &lt;|-- EngineerStaff &lt;|-- ManagerVisitor &lt;|-- CEOVisitorVisitor &lt;|-- CTOVisitorClinet --&gt; BusinessReportClinet -right-&gt; VisitorBusinessReport -left-&gt; Staff@endumlè§’è‰²ä»‹ç»Visitorï¼šæ¥å£æˆ–è€…æŠ½è±¡ç±»ï¼Œå®šä¹‰äº†å¯¹æ¯ä¸ª Element è®¿é—®çš„è¡Œä¸ºï¼Œå®ƒçš„å‚æ•°å°±æ˜¯è¢«è®¿é—®çš„å…ƒç´ ï¼Œå®ƒçš„æ–¹æ³•ä¸ªæ•°ç†è®ºä¸Šä¸å…ƒç´ çš„ä¸ªæ•°æ˜¯ä¸€æ ·çš„ï¼Œå› æ­¤ï¼Œè®¿é—®è€…æ¨¡å¼è¦æ±‚å…ƒç´ çš„ç±»å‹è¦ç¨³å®šï¼Œå¦‚æœç»å¸¸æ·»åŠ ã€ç§»é™¤å…ƒç´ ç±»ï¼Œå¿…ç„¶ä¼šå¯¼è‡´é¢‘ç¹åœ°ä¿®æ”¹ Visitor æ¥å£ï¼Œå¦‚æœå‡ºç°è¿™ç§æƒ…å†µï¼Œåˆ™è¯´æ˜ä¸é€‚åˆä½¿ç”¨è®¿é—®è€…æ¨¡å¼ã€‚ConcreteVisitorï¼šå…·ä½“çš„è®¿é—®è€…ï¼Œå®ƒéœ€è¦ç»™å‡ºå¯¹æ¯ä¸€ä¸ªå…ƒç´ ç±»è®¿é—®æ—¶æ‰€äº§ç”Ÿçš„å…·ä½“è¡Œä¸ºã€‚Elementï¼šå…ƒç´ æ¥å£æˆ–è€…æŠ½è±¡ç±»ï¼Œå®ƒå®šä¹‰äº†ä¸€ä¸ªæ¥å—è®¿é—®è€…ï¼ˆacceptï¼‰çš„æ–¹æ³•ï¼Œå…¶æ„ä¹‰æ˜¯æŒ‡æ¯ä¸€ä¸ªå…ƒç´ éƒ½è¦å¯ä»¥è¢«è®¿é—®è€…è®¿é—®ã€‚ElementAã€ElementBï¼šå…·ä½“çš„å…ƒç´ ç±»ï¼Œå®ƒæä¾›æ¥å—è®¿é—®çš„å…·ä½“å®ç°ï¼Œè€Œè¿™ä¸ªå…·ä½“çš„å®ç°ï¼Œé€šå¸¸æƒ…å†µä¸‹æ˜¯ä½¿ç”¨è®¿é—®è€…æä¾›çš„è®¿é—®è¯¥å…ƒç´ ç±»çš„æ–¹æ³•ã€‚ObjectStructureï¼šå®šä¹‰å½“ä¸­æ‰€æåˆ°çš„å¯¹è±¡ç»“æ„ï¼Œå¯¹è±¡ç»“æ„æ˜¯ä¸€ä¸ªæŠ½è±¡è¡¨è¿°ï¼Œå®ƒå†…éƒ¨ç®¡ç†äº†å…ƒç´ é›†åˆï¼Œå¹¶ä¸”å¯ä»¥è¿­ä»£è¿™äº›å…ƒç´ æä¾›è®¿é—®è€…è®¿é—®ã€‚ç»“æ„å‹æ¨¡å¼é€‚é…å™¨æ¨¡å¼(Adapter)123456789101112131415161718192021222324252627282930313233343536373839@startumlabstract AbsPlayer{  +attack()  +defense()}note left: çƒå‘˜æŠ½è±¡ç±»class Forwards{  +attack()  +defense()}class Center{  +attack()  +defense()}class Guards{  +attack()  +defense()}class Translator{  +attack()  +defense()}class ChinaCenter{  +jingong()  +fangshou()}note left: ä¸­å›½ä¸­é”‹AbsPlayer &lt;|-- ForwardsAbsPlayer &lt;|-- CenterAbsPlayer &lt;|-- GuardsAbsPlayer &lt;|-- TranslatorChinaCenter &lt;-- Translator@enduml123456789ä¼˜ç‚¹ï¼š1ï¼šå°†ç›®æ ‡ç±»å’Œé€‚é…è€…ç±»è§£è€¦ï¼Œé€šè¿‡å¼•å…¥ä¸€ä¸ªé€‚é…å™¨ç±»æ¥é‡ç”¨ç°æœ‰çš„é€‚é…è€…ç±»ï¼Œæ— éœ€ä¿®æ”¹åŸæœ‰ç»“æ„ã€‚2ï¼šå¢åŠ äº†ç±»çš„é€æ˜æ€§å’Œå¤ç”¨æ€§ï¼Œå°†å…·ä½“çš„ä¸šåŠ¡å®ç°è¿‡ç¨‹å°è£…åœ¨é€‚é…è€…ç±»ä¸­ï¼Œå¯¹äºå®¢æˆ·ç«¯ç±»è€Œè¨€æ˜¯é€æ˜çš„ï¼Œè€Œä¸”æé«˜äº†é€‚é…è€…çš„å¤ç”¨æ€§ï¼ŒåŒä¸€é€‚é…è€…ç±»å¯ä»¥åœ¨å¤šä¸ªä¸åŒçš„ç³»ç»Ÿä¸­å¤ç”¨ã€‚3ï¼šçµæ´»æ€§å’Œæ‰©å±•æ€§éƒ½éå¸¸å¥½ï¼Œé€šè¿‡ä½¿ç”¨é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„æ›´æ¢é€‚é…å™¨ï¼Œä¹Ÿå¯ä»¥åœ¨ä¸ä¿®æ”¹åŸæœ‰ä»£ç çš„åŸºç¡€ä¸Š å¢åŠ æ–°çš„é€‚é…å™¨ï¼Œå®Œå…¨å¤åˆå¼€é—­åŸåˆ™ã€‚ç¼ºç‚¹ï¼š1ï¼šä¸€æ¬¡æœ€å¤šåªèƒ½é€‚é…ä¸€ä¸ªé€‚é…è€…ç±»ï¼Œä¸èƒ½åŒæ—¶é€‚é…å¤šä¸ªé€‚é…è€…ã€‚2ï¼šé€‚é…è€…ç±»ä¸èƒ½ä¸ºæœ€ç»ˆç±»ï¼Œåœ¨C#ä¸­ä¸èƒ½ä¸ºsealedç±»3ï¼šç›®æ ‡æŠ½è±¡ç±»åªèƒ½ä¸ºæ¥å£ï¼Œä¸èƒ½ä¸ºç±»ï¼Œå…¶ä½¿ç”¨æœ‰ä¸€å®šçš„å±€é™æ€§ã€‚æ¡¥æ¥æ¨¡å¼(Bridge)1234567891011121314151617181920212223242526272829303132@startumlinterface Color{  +bepaint(penType:String,name:String):void}class Blue{  +bepaint(penType:String,name:String):void}class Green{  +bepaint(penType:String,name:String):void}class Pen{  #color:Color  +draw(name:String):void}class SmallPen{  +draw(name:String):void}class MiddlePen{  +draw(name:String):void}Pen &lt;|-- SmallPenPen &lt;|-- MiddlePenColor &lt;|-- BlueColor &lt;|-- GreenPen o-left-&gt; Color@endumlæ¦‚è¿°åœ¨è½¯ä»¶ç³»ç»Ÿä¸­ï¼ŒæŸäº›ç±»å‹ç”±äºè‡ªèº«çš„é€»è¾‘ï¼Œå®ƒå…·æœ‰ä¸¤ä¸ªæˆ–å¤šä¸ªç»´åº¦çš„å˜åŒ–ï¼Œé‚£ä¹ˆå¦‚ä½•åº”å¯¹è¿™ç§â€œå¤šç»´åº¦çš„å˜åŒ–â€ï¼Ÿå¦‚ä½•åˆ©ç”¨é¢å‘å¯¹è±¡çš„æŠ€æœ¯æ¥ä½¿å¾—è¯¥ç±»å‹èƒ½å¤Ÿè½»æ¾çš„æ²¿ç€å¤šä¸ªæ–¹å‘è¿›è¡Œå˜åŒ–ï¼Œè€Œåˆä¸å¼•å…¥é¢å¤–çš„å¤æ‚åº¦ï¼Ÿè¿™å°±è¦ä½¿ç”¨Bridgeæ¨¡å¼ã€‚æ„å›¾ã€GOF95ã€‘åœ¨æå‡ºæ¡¥æ¢æ¨¡å¼çš„æ—¶å€™æŒ‡å‡ºï¼Œæ¡¥æ¢æ¨¡å¼çš„ç”¨æ„æ˜¯â€å°†æŠ½è±¡åŒ–(Abstraction)ä¸å®ç°åŒ–(Implementation)è„±è€¦ï¼Œä½¿å¾—äºŒè€…å¯ä»¥ç‹¬ç«‹åœ°å˜åŒ–â€ã€‚è¿™å¥è¯æœ‰ä¸‰ä¸ªå…³é”®è¯ï¼Œä¹Ÿå°±æ˜¯æŠ½è±¡åŒ–ã€å®ç°åŒ–å’Œè„±è€¦ã€‚æŠ½è±¡åŒ–å­˜åœ¨äºå¤šä¸ªå®ä½“ä¸­çš„å…±åŒçš„æ¦‚å¿µæ€§è”ç³»ï¼Œå°±æ˜¯æŠ½è±¡åŒ–ã€‚ä½œä¸ºä¸€ä¸ªè¿‡ç¨‹ï¼ŒæŠ½è±¡åŒ–å°±æ˜¯å¿½ç•¥ä¸€äº›ä¿¡æ¯ï¼Œä»è€ŒæŠŠä¸åŒçš„å®ä½“å½“åšåŒæ ·çš„å®ä½“å¯¹å¾…ã€LISKOV94ã€‘ã€‚å®ç°åŒ–æŠ½è±¡åŒ–ç»™å‡ºçš„å…·ä½“å®ç°ï¼Œå°±æ˜¯å®ç°åŒ–ã€‚è„±è€¦æ‰€è°“è€¦åˆï¼Œå°±æ˜¯ä¸¤ä¸ªå®ä½“çš„è¡Œä¸ºçš„æŸç§å¼ºå…³è”ã€‚è€Œå°†å®ƒä»¬çš„å¼ºå…³è”å»æ‰ï¼Œå°±æ˜¯è€¦åˆçš„è§£è„±ï¼Œæˆ–ç§°è„±è€¦ã€‚åœ¨è¿™é‡Œï¼Œè„±è€¦æ˜¯æŒ‡å°†æŠ½è±¡åŒ–å’Œå®ç°åŒ–ä¹‹é—´çš„è€¦åˆè§£è„±å¼€ï¼Œæˆ–è€…è¯´æ˜¯å°†å®ƒä»¬ä¹‹é—´çš„å¼ºå…³è”æ”¹æ¢æˆå¼±å…³è”ã€‚å°†ä¸¤ä¸ªè§’è‰²ä¹‹é—´çš„ç»§æ‰¿å…³ç³»æ”¹ä¸ºèšåˆå…³ç³»ï¼Œå°±æ˜¯å°†å®ƒä»¬ä¹‹é—´çš„å¼ºå…³è”æ”¹æ¢æˆä¸ºå¼±å…³è”ã€‚å› æ­¤ï¼Œæ¡¥æ¢æ¨¡å¼ä¸­çš„æ‰€è°“è„±è€¦ï¼Œå°±æ˜¯æŒ‡åœ¨ä¸€ä¸ªè½¯ä»¶ç³»ç»Ÿçš„æŠ½è±¡åŒ–å’Œå®ç°åŒ–ä¹‹é—´ä½¿ç”¨ç»„åˆ/èšåˆå…³ç³»è€Œä¸æ˜¯ç»§æ‰¿å…³ç³»ï¼Œä»è€Œä½¿ä¸¤è€…å¯ä»¥ç›¸å¯¹ç‹¬ç«‹åœ°å˜åŒ–ã€‚è¿™å°±æ˜¯æ¡¥æ¢æ¨¡å¼çš„ç”¨æ„ã€‚ç»„åˆæ¨¡å¼(Composite)12345678910111213141516171819202122232425262728293031323334353637@startumlabstract AbsCompany{  +add(company: AbsCompany)  +remove(company: AbsCompany)  +display(depth: int)  +lineOfDuty()}note right: ç»„åˆä¸­çš„å¯¹è±¡å£°æ˜æ¥å£ï¼Œåœ¨é€‚å½“æƒ…å†µä¸‹ï¼Œ\n å®ç°æ‰€æœ‰ç±»å…±æœ‰æ¥å£çš„é»˜è®¤è¡Œä¸ºã€‚å£°æ˜ä¸€ä¸ª\n æ¥å£ç”¨äºè®¿é—®å’Œç®¡ç†AbsCompanyçš„å­éƒ¨ä»¶class ConcreteCompany{  +add(company: AbsCompany)  +remove(company: AbsCompany)  +display(depth: int)  +lineOfDuty()}note bottom: å®šä¹‰æœ‰æèŠ‚ç‚¹è¡Œä¸ºï¼Œç”¨æ¥å­˜å‚¨å­éƒ¨ä»¶ï¼Œ\n åœ¨AbsCompanyæ¥å£ä¸­å®ç°ä¸å­éƒ¨ä»¶æœ‰å…³ \n çš„æ“ä½œï¼Œæ¯”å¦‚å¢åŠ Addå’Œåˆ é™¤Removeclass HRDepartment{  +add(company: AbsCompany)  +remove(company: AbsCompany)  +display(depth: int)  +lineOfDuty()}note bottom: åœ¨ç»„åˆä¸­è¡¨ç¤ºå¶èŠ‚ç‚¹å¯¹è±¡ï¼Œ \n å¶èŠ‚ç‚¹æ²¡æœ‰å­èŠ‚ç‚¹class FinanceDepartment{  +add(company: AbsCompany)  +remove(company: AbsCompany)  +display(depth: int)  +lineOfDuty()}AbsCompany &lt;|-- ConcreteCompanyAbsCompany &lt;|-- HRDepartmentAbsCompany &lt;|-- FinanceDepartmentAbsCompany &lt;--o ConcreteCompany@endumlç»„åˆæ¨¡å¼(Composite Pattern)ï¼šç»„åˆå¤šä¸ªå¯¹è±¡å½¢æˆæ ‘å½¢ç»“æ„ä»¥è¡¨ç¤ºå…·æœ‰ â€œæ•´ä½“â€”éƒ¨åˆ†â€ å…³ç³»çš„å±‚æ¬¡ç»“æ„ã€‚ç»„åˆæ¨¡å¼å¯¹å•ä¸ªå¯¹è±¡ï¼ˆå³å¶å­å¯¹è±¡ï¼‰å’Œç»„åˆå¯¹è±¡ï¼ˆå³å®¹å™¨å¯¹è±¡ï¼‰çš„ä½¿ç”¨å…·æœ‰ä¸€è‡´æ€§ï¼Œç»„åˆæ¨¡å¼åˆå¯ä»¥ç§°ä¸º â€œæ•´ä½“â€”éƒ¨åˆ†â€(Part-Whole) æ¨¡å¼ï¼Œå®ƒæ˜¯ä¸€ç§å¯¹è±¡ç»“æ„å‹æ¨¡å¼ã€‚ç”±äºåœ¨è½¯ä»¶å¼€å‘ä¸­å­˜åœ¨å¤§é‡çš„æ ‘å½¢ç»“æ„ï¼Œå› æ­¤ç»„åˆæ¨¡å¼æ˜¯ä¸€ç§ä½¿ç”¨é¢‘ç‡è¾ƒé«˜çš„ç»“æ„å‹è®¾è®¡æ¨¡å¼ï¼ŒJava SEä¸­çš„AWTå’ŒSwingåŒ…çš„è®¾è®¡å°±åŸºäºç»„åˆæ¨¡å¼ã€‚é™¤æ­¤ä»¥å¤–ï¼Œåœ¨XMLè§£æã€ç»„ç»‡ç»“æ„æ ‘å¤„ç†ã€æ–‡ä»¶ç³»ç»Ÿè®¾è®¡ç­‰é¢†åŸŸï¼Œç»„åˆæ¨¡å¼éƒ½å¾—åˆ°äº†å¹¿æ³›åº”ç”¨ã€‚è§’è‰²Componentï¼ˆæŠ½è±¡æ„ä»¶ï¼‰ï¼šå®ƒå¯ä»¥æ˜¯æ¥å£æˆ–æŠ½è±¡ç±»ï¼Œä¸ºå¶å­æ„ä»¶å’Œå®¹å™¨æ„ä»¶å¯¹è±¡å£°æ˜æ¥å£ï¼Œåœ¨è¯¥è§’è‰²ä¸­å¯ä»¥åŒ…å«æ‰€æœ‰å­ç±»å…±æœ‰è¡Œä¸ºçš„å£°æ˜å’Œå®ç°ã€‚åœ¨æŠ½è±¡æ„ä»¶ä¸­å®šä¹‰äº†è®¿é—®åŠç®¡ç†å®ƒçš„å­æ„ä»¶çš„æ–¹æ³•ï¼Œå¦‚å¢åŠ å­æ„ä»¶ã€åˆ é™¤å­æ„ä»¶ã€è·å–å­æ„ä»¶ç­‰ã€‚Leafï¼ˆå¶å­æ„ä»¶ï¼‰ï¼šå®ƒåœ¨ç»„åˆç»“æ„ä¸­è¡¨ç¤ºå¶å­èŠ‚ç‚¹å¯¹è±¡ï¼Œå¶å­èŠ‚ç‚¹æ²¡æœ‰å­èŠ‚ç‚¹ï¼Œå®ƒå®ç°äº†åœ¨æŠ½è±¡æ„ä»¶ä¸­å®šä¹‰çš„è¡Œä¸ºã€‚å¯¹äºé‚£äº›è®¿é—®åŠç®¡ç†å­æ„ä»¶çš„æ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡å¼‚å¸¸ç­‰æ–¹å¼è¿›è¡Œå¤„ç†ã€‚Compositeï¼ˆå®¹å™¨æ„ä»¶ï¼‰ï¼šå®ƒåœ¨ç»„åˆç»“æ„ä¸­è¡¨ç¤ºå®¹å™¨èŠ‚ç‚¹å¯¹è±¡ï¼Œå®¹å™¨èŠ‚ç‚¹åŒ…å«å­èŠ‚ç‚¹ï¼Œå…¶å­èŠ‚ç‚¹å¯ä»¥æ˜¯å¶å­èŠ‚ç‚¹ï¼Œä¹Ÿå¯ä»¥æ˜¯å®¹å™¨èŠ‚ç‚¹ï¼Œå®ƒæä¾›ä¸€ä¸ªé›†åˆç”¨äºå­˜å‚¨å­èŠ‚ç‚¹ï¼Œå®ç°äº†åœ¨æŠ½è±¡æ„ä»¶ä¸­å®šä¹‰çš„è¡Œä¸ºï¼ŒåŒ…æ‹¬é‚£äº›è®¿é—®åŠç®¡ç†å­æ„ä»¶çš„æ–¹æ³•ï¼Œåœ¨å…¶ä¸šåŠ¡æ–¹æ³•ä¸­å¯ä»¥é€’å½’è°ƒç”¨å…¶å­èŠ‚ç‚¹çš„ä¸šåŠ¡æ–¹æ³•ã€‚ç»„åˆæ¨¡å¼çš„å…³é”®æ˜¯å®šä¹‰äº†ä¸€ä¸ªæŠ½è±¡æ„ä»¶ç±»ï¼Œå®ƒæ—¢å¯ä»¥ä»£è¡¨å¶å­ï¼Œåˆå¯ä»¥ä»£è¡¨å®¹å™¨ï¼Œè€Œå®¢æˆ·ç«¯é’ˆå¯¹è¯¥æŠ½è±¡æ„ä»¶ç±»è¿›è¡Œç¼–ç¨‹ï¼Œæ— é¡»çŸ¥é“å®ƒåˆ°åº•è¡¨ç¤ºçš„æ˜¯å¶å­è¿˜æ˜¯å®¹å™¨ï¼Œå¯ä»¥å¯¹å…¶è¿›è¡Œç»Ÿä¸€å¤„ç†ã€‚åŒæ—¶å®¹å™¨å¯¹è±¡ä¸æŠ½è±¡æ„ä»¶ç±»ä¹‹é—´è¿˜å»ºç«‹ä¸€ä¸ªèšåˆå…³è”å…³ç³»ï¼Œåœ¨å®¹å™¨å¯¹è±¡ä¸­æ—¢å¯ä»¥åŒ…å«å¶å­ï¼Œä¹Ÿå¯ä»¥åŒ…å«å®¹å™¨ï¼Œä»¥æ­¤å®ç°é€’å½’ç»„åˆï¼Œå½¢æˆä¸€ä¸ªæ ‘å½¢ç»“æ„ã€‚é€æ˜ä¸å®‰å…¨åœ¨ä½¿ç”¨ç»„åˆæ¨¡å¼æ—¶ï¼Œæ ¹æ®æŠ½è±¡æ„ä»¶ç±»çš„å®šä¹‰å½¢å¼ï¼Œæˆ‘ä»¬å¯å°†ç»„åˆæ¨¡å¼åˆ†ä¸ºé€æ˜ç»„åˆæ¨¡å¼å’Œå®‰å…¨ç»„åˆæ¨¡å¼ä¸¤ç§å½¢å¼ã€‚é€æ˜ç»„åˆæ¨¡å¼é€æ˜ç»„åˆæ¨¡å¼ä¸­ï¼ŒæŠ½è±¡æ„ä»¶è§’è‰²ä¸­å£°æ˜äº†æ‰€æœ‰ç”¨äºç®¡ç†æˆå‘˜å¯¹è±¡çš„æ–¹æ³•ï¼Œè­¬å¦‚åœ¨ç¤ºä¾‹ä¸­ Component å£°æ˜äº† addã€remove æ–¹æ³•ï¼Œè¿™æ ·åšçš„å¥½å¤„æ˜¯ç¡®ä¿æ‰€æœ‰çš„æ„ä»¶ç±»éƒ½æœ‰ç›¸åŒçš„æ¥å£ã€‚é€æ˜ç»„åˆæ¨¡å¼ä¹Ÿæ˜¯ç»„åˆæ¨¡å¼çš„æ ‡å‡†å½¢å¼ã€‚é€æ˜ç»„åˆæ¨¡å¼çš„ç¼ºç‚¹æ˜¯ä¸å¤Ÿå®‰å…¨ï¼Œå› ä¸ºå¶å­å¯¹è±¡å’Œå®¹å™¨å¯¹è±¡åœ¨æœ¬è´¨ä¸Šæ˜¯æœ‰åŒºåˆ«çš„ï¼Œå¶å­å¯¹è±¡ä¸å¯èƒ½æœ‰ä¸‹ä¸€ä¸ªå±‚æ¬¡çš„å¯¹è±¡ï¼Œå³ä¸å¯èƒ½åŒ…å«æˆå‘˜å¯¹è±¡ï¼Œå› æ­¤ä¸ºå…¶æä¾› add()ã€remove() ç­‰æ–¹æ³•æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œè¿™åœ¨ç¼–è¯‘é˜¶æ®µä¸ä¼šå‡ºé”™ï¼Œä½†åœ¨è¿è¡Œé˜¶æ®µå¦‚æœè°ƒç”¨è¿™äº›æ–¹æ³•å¯èƒ½ä¼šå‡ºé”™ï¼ˆå¦‚æœæ²¡æœ‰æä¾›ç›¸åº”çš„é”™è¯¯å¤„ç†ä»£ç ï¼‰å®‰å…¨ç»„åˆæ¨¡å¼åœ¨å®‰å…¨ç»„åˆæ¨¡å¼ä¸­ï¼Œåœ¨æŠ½è±¡æ„ä»¶è§’è‰²ä¸­æ²¡æœ‰å£°æ˜ä»»ä½•ç”¨äºç®¡ç†æˆå‘˜å¯¹è±¡çš„æ–¹æ³•ï¼Œè€Œæ˜¯åœ¨å®¹å™¨æ„ä»¶ Composite ç±»ä¸­å£°æ˜å¹¶å®ç°è¿™äº›æ–¹æ³•ã€‚ç»„åˆæ¨¡å¼æ€»ç»“ç»„åˆæ¨¡å¼çš„ä¸»è¦ä¼˜ç‚¹å¦‚ä¸‹ï¼šç»„åˆæ¨¡å¼å¯ä»¥æ¸…æ¥šåœ°å®šä¹‰åˆ†å±‚æ¬¡çš„å¤æ‚å¯¹è±¡ï¼Œè¡¨ç¤ºå¯¹è±¡çš„å…¨éƒ¨æˆ–éƒ¨åˆ†å±‚æ¬¡ï¼Œå®ƒè®©å®¢æˆ·ç«¯å¿½ç•¥äº†å±‚æ¬¡çš„å·®å¼‚ï¼Œæ–¹ä¾¿å¯¹æ•´ä¸ªå±‚æ¬¡ç»“æ„è¿›è¡Œæ§åˆ¶ã€‚å®¢æˆ·ç«¯å¯ä»¥ä¸€è‡´åœ°ä½¿ç”¨ä¸€ä¸ªç»„åˆç»“æ„æˆ–å…¶ä¸­å•ä¸ªå¯¹è±¡ï¼Œä¸å¿…å…³å¿ƒå¤„ç†çš„æ˜¯å•ä¸ªå¯¹è±¡è¿˜æ˜¯æ•´ä¸ªç»„åˆç»“æ„ï¼Œç®€åŒ–äº†å®¢æˆ·ç«¯ä»£ç ã€‚åœ¨ç»„åˆæ¨¡å¼ä¸­å¢åŠ æ–°çš„å®¹å™¨æ„ä»¶å’Œå¶å­æ„ä»¶éƒ½å¾ˆæ–¹ä¾¿ï¼Œæ— é¡»å¯¹ç°æœ‰ç±»åº“è¿›è¡Œä»»ä½•ä¿®æ”¹ï¼Œç¬¦åˆâ€œå¼€é—­åŸåˆ™â€ã€‚ç»„åˆæ¨¡å¼ä¸ºæ ‘å½¢ç»“æ„çš„é¢å‘å¯¹è±¡å®ç°æä¾›äº†ä¸€ç§çµæ´»çš„è§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡å¶å­å¯¹è±¡å’Œå®¹å™¨å¯¹è±¡çš„é€’å½’ç»„åˆï¼Œå¯ä»¥å½¢æˆå¤æ‚çš„æ ‘å½¢ç»“æ„ï¼Œä½†å¯¹æ ‘å½¢ç»“æ„çš„æ§åˆ¶å´éå¸¸ç®€å•ã€‚ç»„åˆæ¨¡å¼çš„ä¸»è¦ç¼ºç‚¹å¦‚ä¸‹ï¼šä½¿å¾—è®¾è®¡æ›´åŠ å¤æ‚ï¼Œå®¢æˆ·ç«¯éœ€è¦èŠ±æ›´å¤šæ—¶é—´ç†æ¸…ç±»ä¹‹é—´çš„å±‚æ¬¡å…³ç³»ã€‚åœ¨å¢åŠ æ–°æ„ä»¶æ—¶å¾ˆéš¾å¯¹å®¹å™¨ä¸­çš„æ„ä»¶ç±»å‹è¿›è¡Œé™åˆ¶ã€‚é€‚ç”¨åœºæ™¯ï¼šåœ¨å…·æœ‰æ•´ä½“å’Œéƒ¨åˆ†çš„å±‚æ¬¡ç»“æ„ä¸­ï¼Œå¸Œæœ›é€šè¿‡ä¸€ç§æ–¹å¼å¿½ç•¥æ•´ä½“ä¸éƒ¨åˆ†çš„å·®å¼‚ï¼Œå®¢æˆ·ç«¯å¯ä»¥ä¸€è‡´åœ°å¯¹å¾…å®ƒä»¬ã€‚åœ¨ä¸€ä¸ªä½¿ç”¨é¢å‘å¯¹è±¡è¯­è¨€å¼€å‘çš„ç³»ç»Ÿä¸­éœ€è¦å¤„ç†ä¸€ä¸ªæ ‘å½¢ç»“æ„ã€‚åœ¨ä¸€ä¸ªç³»ç»Ÿä¸­èƒ½å¤Ÿåˆ†ç¦»å‡ºå¶å­å¯¹è±¡å’Œå®¹å™¨å¯¹è±¡ï¼Œè€Œä¸”å®ƒä»¬çš„ç±»å‹ä¸å›ºå®šï¼Œéœ€è¦å¢åŠ ä¸€äº›æ–°çš„ç±»å‹ã€‚è£…é¥°æ¨¡å¼(Decorator)12345678910111213141516171819202122232425262728293031323334@startumlinterface IComponent{  +Operation()}note left: IComponentæ˜¯å®šä¹‰ä¸€ä¸ªå¯¹è±¡æ¥å£ï¼Œ\n å¯ä»¥ç»™è¿™äº›å¯¹è±¡åŠ¨æ€åœ°æ·»åŠ èŒè´£class ConcreteComponent{  +Operation()}note bottom: ConcreteComponentæ˜¯å®šä¹‰äº†ä¸€ä¸ªå…·ä½“çš„å¯¹è±¡ï¼Œ\n ä¹Ÿå¯ä»¥ç»™è¿™ä¸ªå¯¹è±¡æ·»åŠ ä¸€äº›èŒè´£abstract AbsDecorator{  -component:IComponent  +Operation()}note left: AbsDecoratorï¼Œè£…é¥°æŠ½è±¡ç±»ï¼Œ\n ç»§æ‰¿äº†IComponentï¼Œä»å¤–ç±»æ¥æ‰©å±•\n IComponentç±»çš„åŠŸèƒ½ï¼Œ\n ä½†å¯¹äºIComponentæ¥è¯´ï¼Œæ˜¯æ— éœ€çŸ¥é“\n AbsDecoratorçš„å­˜åœ¨çš„class ConcreteDecoratorA{  +Operation()  -AddedBehaviorA()}class ConcreteDecoratorB{  +Operation()  -AddedBehaviorB()}note bottom: ConcreteDecoratorå°±æ˜¯å…·ä½“çš„è£…é¥°å¯¹è±¡ï¼Œ\n èµ·åˆ°ç»™IComponentæ·»åŠ èŒè´£çš„åŠŸèƒ½IComponent &lt;|-- ConcreteComponentIComponent &lt;|-- AbsDecoratorAbsDecorator  &lt;|-- ConcreteDecoratorAAbsDecorator  &lt;|-- ConcreteDecoratorBIComponent &lt;--o AbsDecorator@endumlè£…é¥°å™¨æ¨¡å¼ï¼šåœ¨ä¸æ”¹å˜åŸæœ‰ç»“æ„çš„æƒ…å†µä¸‹ï¼Œå…è®¸åŠ¨æ€çš„ç»™ä¸€ä¸ªç°æœ‰å¯¹è±¡æ·»åŠ ä¸€äº›é¢å¤–çš„èŒè´£ï¼ˆé¢å¤–çš„ç»“æ„ï¼‰è£…é¥°å™¨æ¨¡å¼ä¸»è¦è§£å†³ï¼šåŠ¨æ€å¯¹ä¸€ä¸ªç±»è¿›è¡Œæ‰©å±•ï¼Œä¿è¯å…¶åŸæœ‰ç»“æ„ä¸å˜çš„åŸºç¡€ä¸Šè·å¾—æ–°çš„ç»“æ„å’ŒåŠŸèƒ½ã€‚è¿™ç§æ‰©å±•ä¸ä»¥ç»§æ‰¿çš„æ–¹å¼å®ç°ï¼Œæœ‰æ•ˆçš„é˜²æ­¢å­ç±»è¿‡åˆ†è†¨èƒ€çš„é—®é¢˜ã€‚ä¼˜ç‚¹ï¼šè£…é¥°ç±»å’Œè¢«è£…é¥°ç±»å¯ä»¥ç‹¬ç«‹å‘å±•ï¼Œä¸ä¼šç›¸äº’è€¦åˆã€‚è£…é¥°æ¨¡å¼æ˜¯ç»§æ‰¿çš„ä¸€ä¸ªæ›¿ä»£çš„æ–¹æ³•ï¼Œè£…é¥°æ¨¡å¼å¯ä»¥åŠ¨æ€æ‰©å±•ä¸€ä¸ªå®ç°ç±»çš„åŠŸèƒ½ã€‚å¦å¤–ï¼Œè£…é¥°æ¨¡å¼å¯ä»¥å®ç°æœªçŸ¥é¡ºåºçš„æ‰©å±•ï¼Œå°†åŸæœ‰çš„çˆ¶å­ç»“æ„è½¬æ¢ä¸ºå…„å¼Ÿç»“æ„ï¼Œé™ä½ç³»ç»Ÿçš„è€¦åˆåº¦ã€‚è£…é¥°å™¨æ¨¡å¼çš„ä¼˜ç‚¹è£…é¥°æ¨¡å¼ä¸ç»§æ‰¿å…³ç³»çš„ç›®çš„éƒ½æ˜¯è¦æ‰©å±•å¯¹è±¡çš„åŠŸèƒ½ï¼Œä½†æ˜¯è£…é¥°æ¨¡å¼å¯ä»¥æä¾›æ¯”ç»§æ‰¿æ›´å¤šçš„çµæ´»æ€§ã€‚é€šè¿‡ä½¿ç”¨ä¸åŒçš„å…·ä½“è£…é¥°ç±»ä»¥åŠè¿™äº›è£…é¥°ç±»çš„æ’åˆ—ç»„åˆï¼Œå¯ä»¥åˆ›é€ å‡ºå¾ˆå¤šä¸åŒè¡Œä¸ºçš„ç»„åˆã€‚å¯ä»¥ä½¿ç”¨å¤šä¸ªå…·ä½“è£…é¥°ç±»æ¥è£…é¥°åŒä¸€å¯¹è±¡ï¼Œå¾—åˆ°åŠŸèƒ½æ›´ä¸ºå¼ºå¤§çš„å¯¹è±¡ã€‚è£…é¥°å™¨æ¨¡å¼çš„ç¼ºç‚¹è¿™ç§æ¯”ç»§æ‰¿æ›´åŠ çµæ´»æœºåŠ¨çš„ç‰¹æ€§ï¼Œä¹ŸåŒæ—¶æ„å‘³ç€è£…é¥°æ¨¡å¼æ¯”ç»§æ‰¿æ›´åŠ æ˜“äºå‡ºé”™ï¼Œæ’é”™ä¹Ÿå¾ˆå›°éš¾ï¼Œå¯¹äºå¤šæ¬¡è£…é¥°çš„å¯¹è±¡ï¼Œè°ƒè¯•æ—¶å¯»æ‰¾é”™è¯¯å¯èƒ½éœ€è¦é€çº§æ’æŸ¥ï¼Œè¾ƒä¸ºçƒ¦çã€‚å¤–è§‚æ¨¡å¼(Facade)12345678910111213141516171819202122232425262728293031@startumlclass ControllerFacade{  +on():void  +off():void}note right: Facadewå¤–è§‚ç±»\n çŸ¥é“å“ªäº›å­ç³»ç»Ÿè´Ÿè´£å¤„ç†è¯·æ±‚ï¼Œ\n å°†å®¢æˆ·çš„è¯·æ±‚ä»£ç†ç»™é€‚å½“çš„å­ç³»ç»Ÿå¯¹è±¡ class Light{  +on():void  +off():void}class Television{  +on():void  +off():void}class Aircondition{  +on():void  +off():void}class ClientClient -right-&gt; ControllerFacadeControllerFacade--&gt; LightControllerFacade --&gt; TelevisionControllerFacade--&gt; Aircondition@endumlé—¨é¢æ¨¡å¼è¦æ±‚ä¸€ä¸ªå­ç³»ç»Ÿçš„å¤–éƒ¨ä¸å…¶å†…éƒ¨çš„é€šä¿¡å¿…é¡»é€šè¿‡ä¸€ä¸ªç»Ÿä¸€çš„é—¨é¢(Facade)å¯¹è±¡è¿›è¡Œã€‚é—¨é¢æ¨¡å¼æä¾›ä¸€ä¸ªé«˜å±‚æ¬¡çš„æ¥å£ï¼Œä½¿å¾—å­ç³»ç»Ÿæ›´æ˜“äºä½¿ç”¨ã€‚å°±å¦‚åŒåŒ»é™¢çš„æ¥å¾…å‘˜ä¸€æ ·ï¼Œé—¨é¢æ¨¡å¼çš„é—¨é¢ç±»å°†å®¢æˆ·ç«¯ä¸å­ç³»ç»Ÿçš„å†…éƒ¨å¤æ‚æ€§åˆ†éš”å¼€ï¼Œä½¿å¾—å®¢æˆ·ç«¯åªéœ€è¦ä¸é—¨é¢å¯¹è±¡æ‰“äº¤é“ï¼Œè€Œä¸éœ€è¦ä¸å­ç³»ç»Ÿå†…éƒ¨çš„å¾ˆå¤šå¯¹è±¡æ‰“äº¤é“ã€‚åˆå­¦è€…å¾€å¾€ä»¥ä¸ºé€šè¿‡ç»§æ‰¿ä¸€ä¸ªé—¨é¢ç±»ä¾¿å¯åœ¨å­ç³»ç»Ÿä¸­åŠ å…¥æ–°çš„è¡Œä¸ºï¼Œè¿™æ˜¯é”™è¯¯çš„ã€‚é—¨é¢æ¨¡å¼çš„ç”¨æ„æ˜¯ä¸ºå­ç³»ç»Ÿæä¾›ä¸€ä¸ªé›†ä¸­åŒ–å’Œç®€åŒ–çš„æ²Ÿé€šç®¡é“ï¼Œè€Œä¸èƒ½å‘å­ç³»ç»ŸåŠ å…¥æ–°çš„è¡Œä¸ºã€‚äº«å…ƒæ¨¡å¼(Flyweight)äº«å…ƒæ¨¡å¼äº«å…ƒæ¨¡å¼ï¼ˆFlyweightï¼‰åˆç§°ä¸º è½»é‡çº§æ¨¡å¼ï¼Œå®ƒæ˜¯ä¸€ç§å¯¹è±¡ç»“æ„å‹æ¨¡å¼ã€‚é¢å‘å¯¹è±¡æŠ€æœ¯å¯ä»¥å¾ˆå¥½åœ°è§£å†³ä¸€äº›çµæ´»æ€§æˆ–å¯æ‰©å±•æ€§é—®é¢˜ï¼Œä½†åœ¨å¾ˆå¤šæƒ…å†µä¸‹éœ€è¦åœ¨ç³»ç»Ÿä¸­å¢åŠ ç±»å’Œå¯¹è±¡çš„ä¸ªæ•°ã€‚å½“å¯¹è±¡æ•°é‡å¤ªå¤šæ—¶ï¼Œå°†å¯¼è‡´è¿è¡Œä»£ä»·è¿‡é«˜ï¼Œå¸¦æ¥æ€§èƒ½ä¸‹é™ç­‰é—®é¢˜ã€‚äº«å…ƒæ¨¡å¼ æ­£æ˜¯ä¸ºè§£å†³è¿™ä¸€ç±»é—®é¢˜è€Œè¯ç”Ÿçš„ã€‚äº«å…ƒæ¨¡å¼ æ˜¯å¯¹è±¡æ± çš„ä¸€ç§å®ç°ã€‚ç±»ä¼¼äºçº¿ç¨‹æ± ï¼Œçº¿ç¨‹æ± å¯ä»¥é¿å…ä¸åœçš„åˆ›å»ºå’Œé”€æ¯å¤šä¸ªå¯¹è±¡ï¼Œæ¶ˆè€—æ€§èƒ½ã€‚äº«å…ƒæ¨¡å¼ ä¹Ÿæ˜¯ä¸ºäº†å‡å°‘å†…å­˜çš„ä½¿ç”¨ï¼Œé¿å…å‡ºç°å¤§é‡é‡å¤çš„åˆ›å»ºé”€æ¯å¯¹è±¡çš„åœºæ™¯ã€‚äº«å…ƒæ¨¡å¼ çš„å®—æ—¨æ˜¯å…±äº«ç»†ç²’åº¦å¯¹è±¡ï¼Œå°†å¤šä¸ªå¯¹åŒä¸€å¯¹è±¡çš„è®¿é—®é›†ä¸­èµ·æ¥ï¼Œä¸å¿…ä¸ºæ¯ä¸ªè®¿é—®è€…åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„å¯¹è±¡ï¼Œä»¥æ­¤æ¥é™ä½å†…å­˜çš„æ¶ˆè€—ã€‚äº«å…ƒæ¨¡å¼ æŠŠä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€åˆ†æˆå†…éƒ¨çŠ¶æ€å’Œå¤–éƒ¨çŠ¶æ€ï¼Œå†…éƒ¨çŠ¶æ€å³æ˜¯ä¸å˜çš„ï¼Œå¤–éƒ¨çŠ¶æ€æ˜¯å˜åŒ–çš„ï¼›ç„¶åé€šè¿‡å…±äº«ä¸å˜çš„éƒ¨åˆ†ï¼Œè¾¾åˆ°å‡å°‘å¯¹è±¡æ•°é‡å¹¶èŠ‚çº¦å†…å­˜çš„ç›®çš„ã€‚äº«å…ƒæ¨¡å¼ æœ¬è´¨ï¼šç¼“å­˜å…±äº«å¯¹è±¡ï¼Œé™ä½å†…å­˜æ¶ˆè€—12345678910111213141516171819202122@startumlinterface IFlyweight{  +operation(extrinsicState:String):void}class ConcreteFlyweight{  -intrinsicState:String  +operation(extrinsicState:String):void}class FlyweightFactory{  -pool:Map&lt;String, IFlyweight&gt;  +getFlyweight(intrinsicState:String):IFlyweight}class ClientClient ..&gt; FlyweightFactoryConcreteFlyweight --|&gt; IFlyweightFlyweightFactory o-right- IFlyweight ConcreteFlyweight &lt;.right. Client@endumläº«å…ƒæ¨¡å¼ï¼ˆFlyweightï¼‰åˆç§°ä¸º è½»é‡çº§æ¨¡å¼ï¼Œå®ƒæ˜¯ä¸€ç§å¯¹è±¡ç»“æ„å‹æ¨¡å¼ã€‚é¢å‘å¯¹è±¡æŠ€æœ¯å¯ä»¥å¾ˆå¥½åœ°è§£å†³ä¸€äº›çµæ´»æ€§æˆ–å¯æ‰©å±•æ€§é—®é¢˜ï¼Œä½†åœ¨å¾ˆå¤šæƒ…å†µä¸‹éœ€è¦åœ¨ç³»ç»Ÿä¸­å¢åŠ ç±»å’Œå¯¹è±¡çš„ä¸ªæ•°ã€‚å½“å¯¹è±¡æ•°é‡å¤ªå¤šæ—¶ï¼Œå°†å¯¼è‡´è¿è¡Œä»£ä»·è¿‡é«˜ï¼Œå¸¦æ¥æ€§èƒ½ä¸‹é™ç­‰é—®é¢˜ã€‚äº«å…ƒæ¨¡å¼ æ­£æ˜¯ä¸ºè§£å†³è¿™ä¸€ç±»é—®é¢˜è€Œè¯ç”Ÿçš„ã€‚äº«å…ƒæ¨¡å¼ æ˜¯å¯¹è±¡æ± çš„ä¸€ç§å®ç°ã€‚ç±»ä¼¼äºçº¿ç¨‹æ± ï¼Œçº¿ç¨‹æ± å¯ä»¥é¿å…ä¸åœçš„åˆ›å»ºå’Œé”€æ¯å¤šä¸ªå¯¹è±¡ï¼Œæ¶ˆè€—æ€§èƒ½ã€‚äº«å…ƒæ¨¡å¼ ä¹Ÿæ˜¯ä¸ºäº†å‡å°‘å†…å­˜çš„ä½¿ç”¨ï¼Œé¿å…å‡ºç°å¤§é‡é‡å¤çš„åˆ›å»ºé”€æ¯å¯¹è±¡çš„åœºæ™¯ã€‚äº«å…ƒæ¨¡å¼ çš„å®—æ—¨æ˜¯å…±äº«ç»†ç²’åº¦å¯¹è±¡ï¼Œå°†å¤šä¸ªå¯¹åŒä¸€å¯¹è±¡çš„è®¿é—®é›†ä¸­èµ·æ¥ï¼Œä¸å¿…ä¸ºæ¯ä¸ªè®¿é—®è€…åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„å¯¹è±¡ï¼Œä»¥æ­¤æ¥é™ä½å†…å­˜çš„æ¶ˆè€—ã€‚äº«å…ƒæ¨¡å¼ æŠŠä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€åˆ†æˆå†…éƒ¨çŠ¶æ€å’Œå¤–éƒ¨çŠ¶æ€ï¼Œå†…éƒ¨çŠ¶æ€å³æ˜¯ä¸å˜çš„ï¼Œå¤–éƒ¨çŠ¶æ€æ˜¯å˜åŒ–çš„ï¼›ç„¶åé€šè¿‡å…±äº«ä¸å˜çš„éƒ¨åˆ†ï¼Œè¾¾åˆ°å‡å°‘å¯¹è±¡æ•°é‡å¹¶èŠ‚çº¦å†…å­˜çš„ç›®çš„ã€‚äº«å…ƒæ¨¡å¼ æœ¬è´¨ï¼šç¼“å­˜å…±äº«å¯¹è±¡ï¼Œé™ä½å†…å­˜æ¶ˆè€—ä¼˜ç‚¹äº«å…ƒæ¨¡å¼ å¯ä»¥æå¤§å‡å°‘å†…å­˜ä¸­å¯¹è±¡çš„æ•°é‡ï¼Œä½¿å¾—ç›¸åŒå¯¹è±¡æˆ–ç›¸ä¼¼å¯¹è±¡åœ¨å†…å­˜ä¸­åªä¿å­˜ä¸€ä»½ï¼Œé™ä½å†…å­˜å ç”¨ï¼Œå¢å¼ºç¨‹åºçš„æ€§èƒ½ï¼›äº«å…ƒæ¨¡å¼ çš„å¤–éƒ¨çŠ¶æ€ç›¸å¯¹ç‹¬ç«‹ï¼Œè€Œä¸”ä¸ä¼šå½±å“å…¶å†…éƒ¨çŠ¶æ€ï¼Œä»è€Œä½¿å¾—äº«å…ƒå¯¹è±¡å¯ä»¥åœ¨ä¸åŒçš„ç¯å¢ƒä¸­è¢«å…±äº«ï¼›ç¼ºç‚¹äº«å…ƒæ¨¡å¼ ä½¿å¾—ç³»ç»Ÿæ›´åŠ å¤æ‚ï¼Œéœ€è¦åˆ†ç¦»å‡ºå†…éƒ¨çŠ¶æ€å’Œå¤–éƒ¨çŠ¶æ€ï¼Œè¿™ä½¿å¾—ç¨‹åºçš„é€»è¾‘å¤æ‚åŒ–ï¼›ä¸ºäº†ä½¿å¯¹è±¡å¯ä»¥å…±äº«ï¼Œäº«å…ƒæ¨¡å¼ éœ€è¦å°†äº«å…ƒå¯¹è±¡çš„çŠ¶æ€å¤–éƒ¨åŒ–ï¼Œè€Œä¸”å¤–éƒ¨çŠ¶æ€å¿…é¡»å…·å¤‡å›ºåŒ–ç‰¹æ€§ï¼Œä¸åº”è¯¥éšå†…éƒ¨çŠ¶æ€æ”¹å˜è€Œæ”¹å˜ï¼Œå¦åˆ™ä¼šå¯¼è‡´ç³»ç»Ÿçš„é€»è¾‘æ··ä¹±ï¼›ä½¿ç”¨åœºæ™¯ç³»ç»Ÿä¸­å­˜åœ¨å¤§é‡çš„ç›¸ä¼¼å¯¹è±¡ï¼›ç»†ç²’åº¦çš„å¯¹è±¡éƒ½å…·å¤‡è¾ƒæ¥è¿‘çš„å¤–éƒ¨çŠ¶æ€ï¼Œè€Œä¸”å†…éƒ¨çŠ¶æ€ä¸ç¯å¢ƒæ— å…³ï¼Œä¹Ÿå°±æ˜¯è¯´å¯¹è±¡æ²¡æœ‰ç‰¹å®šèº«ä»½ï¼›éœ€è¦ç¼“å†²æ± çš„åœºæ™¯ï¼›javaä¸­ï¼Œä»äº«å…ƒæ¨¡å¼è§’åº¦å†çœ‹String123456String a = &quot;å°†å¯¼è‡´è¿è¡Œä»£ä»·è¿‡é«˜&quot;;String b = &quot;å°†å¯¼è‡´è¿è¡Œä»£ä»·è¿‡é«˜&quot;;String c = new String(&quot;å°†å¯¼è‡´è¿è¡Œä»£ä»·è¿‡é«˜&quot;);String d = new String(&quot;å°†å¯¼è‡´è¿è¡Œä»£ä»·è¿‡é«˜&quot;);a==b  truec==d  falseä»£ç†æ¨¡å¼(Proxy)12345678910111213141516171819202122@startumlinterface IGiveGift{  +giveDolls()  +giveFlowers()}note right: IGiveGiftç±»ï¼Œå®šä¹‰äº†Pursuitå’ŒGiftProxyçš„å…¬ç”¨æ¥å£ï¼Œ\n è¿™æ ·å°±åœ¨ä»»ä½•ä½¿ç”¨Pursuitçš„åœ°æ–¹éƒ½å¯ä»¥ä½¿ç”¨GiftProxyclass Pursuit{  +giveDolls()  +giveFlowers()}class GiftProxy{  +giveDolls()  +giveFlowers()}Client -right-&gt; IGiveGiftIGiveGift&lt;|-- PursuitIGiveGift&lt;|-- GiftProxyPursuit &lt;-left- GiftProxy: -Pursuit@endumlä»£ç†æ¨¡å¼ï¼šä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚ä»£ç†æ¨¡å¼ä½¿ç”¨ä¸€ä¸ªä»£ç†ç±»æ¥ä»£è¡¨å¦ä¸€ä¸ªç±»çš„åŠŸèƒ½ï¼Œä»£ç†ç±»æŒæœ‰ç°æœ‰å¯¹è±¡ï¼Œå¹¶åˆ©ç”¨ç°æœ‰å¯¹è±¡å¯¹å¤–ç•Œæä¾›åŠŸèƒ½ã€‚ä»£ç†æ¨¡å¼å¯ä»¥çœ‹ä½œæ˜¯å¯¹åŸæœ‰å¯¹è±¡çš„ä¸€ä¸ªå†åŒ…è£…ï¼Œç°åœ¨å…¶ä»–å¯¹è±¡å¯¹åŸæœ‰å¯¹è±¡çš„è®¿é—®éƒ½åº”è¯¥é€šè¿‡ä»£ç†çš„æ¨¡å¼æ¥åšï¼Œèµ·åˆ°æ§åˆ¶è®¿é—®çš„æ•ˆæœã€‚ä»£ç†æ¨¡å¼ä¸»è¦è§£å†³ï¼šç›´æ¥è®¿é—®å¯¹è±¡çš„æ—¶å€™éœ€è¦å¾ˆå¤šé¢å¤–çš„æ“ä½œï¼ˆæ¯”å¦‚æƒé™æ§åˆ¶ï¼Œå®‰å…¨æ€§æ£€æŸ¥ç­‰ï¼‰ï¼Œè¿™ä¸ªå¯¹è±¡è¢«è®¿é—®çš„æ—¶å€™å¸Œæœ›èƒ½æ— ä¸€ä¾‹å¤–çš„å¯¹è¿™äº›è¯·æ±‚åšæ§åˆ¶ï¼Œæ­¤æ—¶åˆ™éœ€è¦ä½¿ç”¨åˆ°ä»£ç†æ¨¡å¼ã€‚ä¼˜ç‚¹ï¼š1ã€èŒè´£æ¸…æ™°ï¼Œæ»¡è¶³å•ä¸€èŒè´£åŸåˆ™ã€‚ è¢«ä»£ç†è€…å’Œä»£ç†è€…å„è‡ªè´Ÿè´£è‡ªå·±çš„èŒè´£å³å¯ï¼Œå°†è¢«ä»£ç†è€…çš„è®¿é—®æ§åˆ¶è½¬ç§»åˆ°ä»£ç†è€…èº«ä¸Šã€‚2ã€é«˜æ‰©å±•æ€§ï¼Œä»£ç†è€…å¯ä»¥ä½œä¸ºä¸€ä¸ªè¢«ä»£ç†è€…è¢«å†æ¬¡åŒ…è£…ï¼Œåœ¨ä¸æ”¹å˜åŸæœ‰ç»“æ„çš„åŸºç¡€ä¸Šæ‰©å±•æ–°åŠŸèƒ½ã€‚ä»£ç†æ¨¡å¼å¯ä»¥çœ‹ä½œæ˜¯ä¸€ç§ç‰¹æ®Šç›®çš„çš„è£…é¥°å™¨æ¨¡å¼ã€‚è£…é¥°å™¨æ˜¯åœ¨ä¸æ”¹å˜åŸæœ‰ç±»çš„ç»“æ„ä¸‹ï¼Œä¸ºå…¶å¢åŠ æ–°çš„åŠŸèƒ½ã€‚ä»£ç†æ¨¡å¼åˆ™æ˜¯åœ¨ä¸æ”¹å˜åŸæœ‰ç±»çš„ç»“æ„ä¸‹ï¼Œæ§åˆ¶å…¶ä»–ç±»å¯¹å…¶çš„è®¿é—®ï¼Œè¿™ç§æ§åˆ¶åŠŸèƒ½å¯ä»¥çœ‹ä½œæ˜¯ä¸ºåŸæœ‰ç±»å¢åŠ çš„ç‰¹æ®Šçš„æ–°åŠŸèƒ½ã€‚ä»£ç†æ¨¡å¼ä¸ºäº†å®ç°å¯¹åŸæœ‰ç±»çš„è®¿é—®çš„æ§åˆ¶ï¼Œåˆ™è¦æ±‚æŒæœ‰åŸæœ‰å¯¹è±¡ã€‚è£…é¥°å™¨æ¨¡å¼æ²¡æœ‰å¿…è¦çš„è¦æ±‚ï¼Œè£…é¥°å™¨æ¨¡å¼å¯ä»¥å’Œè¢«è£…é¥°ç±»ï¼ˆåŸæœ‰ç±»ï¼‰äº’ç›¸ç‹¬ç«‹ï¼Œåªéœ€è¦åœ¨éœ€è¦è£…é¥°çš„æ—¶å€™å¯ä»¥è·å–åˆ°è¢«è£…é¥°ç±»å³å¯ã€‚ä¾æ®ç¬¬äºŒç‚¹ï¼Œå¯ä»¥çœ‹å‡ºä»£ç†æ¨¡å¼å’Œè£…é¥°å™¨æ¨¡å¼ä¹‹é—´æœ€å¤§çš„åŒºåˆ«åœ¨äºï¼šä»£ç†æ¨¡å¼ä¸­ï¼Œä»£ç†è€…å’Œè¢«ä»£ç†è€…çš„å…³ç³»éœ€è¦åœ¨ç¼–è¯‘æ—¶å°±ç¡®å®šä¸‹æ¥ï¼Œå®ç°å¯¹è¢«ä»£ç†è€…çš„æœ‰æ•ˆæ§åˆ¶ï¼›è£…é¥°å™¨æ¨¡å¼ä¸­ï¼Œè£…é¥°è€…å’Œè¢«è£…é¥°è€…ä¹‹é—´æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œå½“è¢«è£…é¥°è€…æœ‰æ–°åŠŸèƒ½éœ€è¦æ·»åŠ çš„æ—¶å€™ï¼Œä½¿ç”¨åˆé€‚çš„è£…é¥°è€…å°†å…¶è£…é¥°å³å¯ã€‚è®¾è®¡æ¨¡å¼æ€»ç»“è®¾è®¡æ¨¡å¼æ€»ç»“è®¾è®¡æ¨¡å¼æ€»ç»“å¸¸è§è®¾è®¡æ¨¡å¼æ€»ç»“è®¾è®¡æ¨¡å¼ç”¨æ³•å•ä¾‹ä¿è¯ç±»çš„å®ä¾‹åªæœ‰ä¸€ä¸ªç®€å•å·¥å‚æ ¹æ®å‚æ•°åˆ›å»ºå¯¹åº”å…·ä½“å­ç±»ç­–ç•¥ç®—æ³•ã€è§„åˆ™çš„å°è£…ã€ä¼ å…¥å…·ä½“è°ƒç”¨ï¼Œè°ƒç”¨å…·ä½“ç®—æ³•è£…é¥°è€…åŠ¨æ€å¯¹ä¸€ä¸ªå¯¹è±¡è¿›è¡Œå¢å±æ€§ã€è°ƒç”¨æ–¹æ³•ç­‰æ“ä½œï¼Œé“¾å¼æ“ä½œéšæ„ç»„åˆã€‚æ¢³å¤´ã€ç”»çœ‰ã€åªæ¢³å¤´ä¸ç”»çœ‰ã€åªç”»çœ‰ä¸æ¢³å¤´å·¥å‚æ–¹æ³•åˆ›å»ºç±»ï¼Œä¸€ä¸ªå®ç°ç±»è¦æœ‰ä¸€ä¸ªå·¥å‚ç±»æ€»æ˜¯é€šè¿‡å¯¹åº”çš„å·¥å‚ç±»åˆ›å»ºå®ç°ç±»ï¼Œåˆ¤æ–­åœ¨å®¢æˆ·ç«¯è¿›è¡Œã€‚å·¥å‚ç±»å¤ªå¤šã€‚ä»£ç†å¯¹è±¡ä¸­ä¿å­˜èƒ½æ‰§è¡Œå¦ä¸€ç§æ“ä½œçš„å¯¹è±¡ï¼Œé€šè¿‡è¿™ä¸ªä¿å­˜çš„å¯¹è±¡å»æ“ä½œã€‚åŸå‹ç”¨å…‹éš†(Clone)ï¼Œä»£æ›¿newå¯¹è±¡ã€‚å…‹éš†çš„æ–¹å¼èƒ½å¤Ÿä¿ç•™ä¸€äº›åŒæ ·çš„ä¿¡æ¯ã€‚æ¨¡æ¿æ–¹æ³•æç‚¼å‡ºç›¸åŒçš„å…¬å…±ä»£ç ï¼Œå°è£…ä¸ºä¸€ä¸ªæ–¹æ³•æ¨¡æ¿ã€‚å¤–è§‚é€šè¿‡æ”¹é€ å†…éƒ¨å®ç°ï¼Œè®©å¤–éƒ¨çœ‹èµ·æ¥è°ƒç”¨çš„æ–¹å¼å¾ˆç®€å•(å¦‚ï¼Œå®é™…éœ€è¦è°ƒç”¨3ä¸ªæ–¹æ³•ï¼Œä½†å¢åŠ ä¸€ä¸ªæ–¹æ³•æ¥è°ƒç”¨è¿™3ä¸ªæ–¹æ³•ï¼Œè®©å¤–éƒ¨åªè°ƒç”¨ä¸€ä¸ªæ–¹æ³•å³å¯)ã€‚å»ºé€ è€…å°†ä¸€ä¸ªå¤åˆ¶å¯¹è±¡çš„æ„å»ºä¸å®ƒçš„è¡¨ç¤ºåˆ†ç¦»ï¼Œä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤ºã€‚è§‚å¯Ÿè€…è§‚å¯Ÿè€…ç±»é‡Œé¢æ”¾äº†ä¸€ä¸ªé›†åˆï¼ŒåŒ…å«äº†å¤šä¸ªè¢«é€šçŸ¥ç±»ï¼Œè¢«é€šçŸ¥ç±»å®ç°ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œæœ‰ä¸€ä¸ªæ–¹æ³•æ¥å—é€šçŸ¥ã€‚æŠ½è±¡å·¥å‚å¢åŠ ä¸€ä¸ªæ¥å£ï¼Œè®©å¤–éƒ¨ä¾èµ–æ¥å£è€Œä¸æ˜¯å…·ä½“ç±»çŠ¶æ€å¤šä¸ªå¤§è‡´ç›¸åŒçš„ç±»ï¼Œåªæ˜¯çŠ¶æ€ä¸åŒï¼Œéšç€ä¸åœçš„è°ƒç”¨ä¸€ä¸ªçŠ¶æ€ä¼šè½¬ä¸ºå¦ä¸€ä¸ªçŠ¶æ€(ä¸€ä¸ªç±»è½¬ä¸ºå¦ä¸€ä¸ªç±»)é€‚é…å™¨å°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·å¸Œæœ›çš„å¦å¤–ä¸€ä¸ªæ¥å£å¯ä»¥ç†è§£ä¸ºï¼Œä»…ä»…æ”¹ä¸ºä¸€ä¸ªæ–¹æ³•åï¼Œåœ¨æ–¹æ³•å†…éƒ¨è°ƒç”¨çœŸæ­£çš„æ–¹æ³•(åå­—ä¸åŒ)ã€‚å¤‡å¿˜å½•å¢åŠ ä¸€ä¸ªç±»ç”¨äºå­˜å‚¨çŠ¶æ€ï¼Œä¸€ä¸ªç±»è´Ÿè´£å¤‡ä»½å’Œæ¢å¤çŠ¶æ€ç»„åˆéƒ¨åˆ†-æ•´ä½“å…³ç³»ï¼Œè§£å†³æ— é™é€’å½’é—®é¢˜ã€‚è¿­ä»£å™¨åˆ†ç¦»äº†é›†åˆå¯¹è±¡çš„éå†è¡Œä¸ºï¼ŒæŠ½è±¡å‡ºä¸€ä¸ªè¿­ä»£å™¨ç±»æ¥è´Ÿè´£ã€‚è§£å†³éå†é—®é¢˜æ¡¥æ¥å°†ç»§æ‰¿å…³ç³»åˆ†ç¦»å‡ºæ¥æ”¹ä¸ºèšåˆå…³ç³»å‘½ä»¤å¯¹è¯·æ±‚çš„å°è£…ï¼Œè¯·æ±‚-ã€‹çœŸæ­£æ‰§è¡Œ(é˜Ÿåˆ—)èŒè´£é“¾ç±»ä¼¼äºAsp.netç®¡é“ï¼Œä¸€æ¡é“¾æ“ä½œï¼Œæ¯ä¸ªç±»éƒ½æœ‰å¤„ç†çš„æœºä¼šæ²¡æƒé™å°±å¾€ä¸Šçº§æŠ›ï¼Œç›´åˆ°æœ‰æƒé™çš„ç±»èƒ½å¤Ÿå¤„ç†ä¸­ä»‹è€…é€šè¿‡ä¸€ä¸ªä¸­ä»‹ç±»æ¥å¤„ç†ä¸¤ä¸ªç±»ä¹‹é—´çš„ä¿¡æ¯äº¤æ¢äº«å…ƒå¯¹è±¡çš„å¤§å¤šæ•°çŠ¶æ€ä¸ºå¤–éƒ¨çŠ¶æ€ï¼Œå¦‚æœåˆ é™¤å¯¹è±¡çš„å¤–éƒ¨çŠ¶æ€é‚£ä¹ˆå¯ä»¥ç”¨ç›¸å¯¹è¾ƒå°‘çš„å…±äº«å¯¹è±¡å–ä»£å¾ˆå¤šç»„å¯¹è±¡ã€‚è®¿é—®è€…å®ƒæŠŠæ•°æ®ç»“æ„å’Œä½œç”¨äºç»“æ„ä¸Šçš„æ“ä½œä¹‹é—´çš„è€¦åˆè§£è„±å¼€ï¼ˆç”¨ç±»å°è£…å˜åŒ–çš„æ•°æ®ï¼‰è§£é‡Šå™¨ç”¨ç±»å»å°è£…ä¸€æ¡è§„åˆ™graph LRA[Hard edge] --&gt;B(Round edge)    B --&gt; C{Decision}    C --&gt;|One| D[Result one]    C --&gt;|Two| E[Result two]    C --&gt;|Two| F[Result two]    F --&gt;|Two| G[Result two]</content>
	</entry>
	<entry>
		<title>æœºå™¨å­¦ä¹ _ä¸€å…ƒå‡½æ•°å¾®ç§¯åˆ†</title>
		<url>/article/10706.html</url>
		<content>å†™åœ¨å‰é¢ï¼Œæœ¬ç³»åˆ—ä¸»è¦æ˜¯å¯¹ä¸‹é¢è¿™æœ¬ä¹¦åšçš„å­¦ä¹ ç¬”è®°å¸¸ç”¨æ•°å­¦ç¬¦å·çš„ LaTeX è¡¨ç¤ºæ–¹æ³•Markdown å¸¸ç”¨æ•°å­¦ç¬¦å·å’Œå…¬å¼æé™ä¸è¿ç»­æé™æ˜¯å¾®ç§¯åˆ†ä¸­æœ€åŸºæœ¬çš„æ¦‚å¿µï¼Œä¹Ÿæ˜¯ç†è§£å¯¼æ•°ä¸ç§¯åˆ†ç­‰æ¦‚å¿µçš„åŸºç¡€ã€‚å¯æ•°é›†å’Œä¸å¯æ•°é›†åˆç­‰æ•°å­¦å·²ç»å¯¹å…ƒç´ æ•°æœ‰é™çš„é›†åˆè¿›è¡Œçš„ç³»ç»Ÿç³»ç»Ÿé˜è¿°ï¼Œå¯¹æ— é™é›†æœ‰äº›æ¦‚å¿µå’Œè§„åˆ™ä¸å†é€‚ç”¨ï¼Œå³ä½¿æ˜¯å¸¸ç”¨çš„è‡ªç„¶æ•°é›†å’Œå®æ•°é›†å…¶æ€§è´¨ï¼Œä¹Ÿéœ€è¦é‡æ–°å®šä¹‰åŸºæ•°æˆ–åŠ¿é›†åˆçš„å…ƒç´ æ•°é‡ç§°ä¸ºå…¶åŸºæ•°æˆ–åŠ¿ï¼Œè®°ä¸ºï¼Œå¯¹äºé›†åˆï¼Œå…¶åŸºæ•°ä¸ºåŸºæ•°ä¸ºæœ‰é™å€¼çš„é›†åˆç§°ä¸ºæœ‰é™é›†ï¼›åŸºæ•°ä¸ºæ— é™å€¼çš„é›†åˆç§°ä¸ºæ— é™é›†å¯¹äºä¸¤ä¸ªæœ‰é™é›†ï¼Œå¦‚æœé›†åˆæ˜¯é›†åˆçš„çœŸå­é›†ï¼Œå³ï¼Œåˆ™æœ‰ï¼Œè€Œæ— é™é›†çš„åŸºæ•°ä¸ºï¼Œå› æ­¤ä¸èƒ½ç›´æ¥ä½¿ç”¨è¿™ä¸ªè§„åˆ™è¿›è¡ŒåŸºæ•°æ¯”è¾ƒè€ƒè™‘æ­£æ•´æ•°é›†ï¼Œä»¤é›†åˆä¸ºæ‰€æœ‰æ­£å¥‡æ•°ç»„æˆçš„é›†åˆï¼Œé›†åˆä¸ºæ‰€æœ‰æ­£å¶æ•°ç»„æˆçš„é›†åˆã€‚å› æ­¤æœ‰ä½†è¿™å¹¶ä¸æ„å‘³ç€åŒå°„å‡½æ•°å¯¹äºé›†åˆå’Œï¼Œå¦‚æœé›†åˆçš„ä»»æ„å…ƒç´ ï¼Œåœ¨é›†åˆéƒ½æœ‰å”¯ä¸€çš„å…ƒç´ é€šè¿‡æŸç§æ˜ å°„å…³ç³»ä¸ä¹‹å¯¹åº”ï¼Œå³å­˜åœ¨å¦‚ä¸‹çš„åŒå°„å‡½æ•°(ä¸€å¯¹ä¸€æ˜ å°„å‡½æ•°) åˆ™ç§°è¿™ä¸¤ä¸ªé›†åˆçš„åŸºæ•°ç›¸ç­‰ã€1ã€‘æ­£æ•´æ•°é›†ä¸æ­£å¶æ•°é›†çš„åŸºæ•°ç›¸ç­‰ï¼Œå› ä¸ºå®ƒä»¬çš„å…ƒç´ ä¹‹é—´å­˜åœ¨å¦‚ä¸‹çš„åŒå°„å…³ç³»ã€2ã€‘é›†åˆå’Œé›†åˆçš„åŸºæ•°ä¹Ÿç›¸ç­‰ï¼Œå› ä¸ºã€3ã€‘é›†åˆä¸æ•´ä¸ªå®æ•°é›†åˆç­‰åŠ¿ï¼Œå› ä¸ºé›†åˆå®æ•°é›†åˆçš„å…ƒç´ é—´å­˜åœ¨å¦‚ä¸‹çš„åŒå°„å‡½æ•°æ­¤å‡½æ•°å¯ä»¥å°†åŒºé—´æ‹‰å‡è‡³ï¼Œä¸”å­˜åœ¨åå‡½æ•°å›¾ é›†åˆAåˆ°å®æ•°é›†çš„æ˜ å°„ã€4ã€‘åŒºé—´ä¸åŒºé—´æ˜¯ç­‰ä»·çš„ï¼Œå› ä¸ºå­˜åœ¨åŒå°„å‡½æ•°åè¿‡æ¥å®æ•°ä¸åŒºé—´ä¹Ÿæ˜¯ç­‰ä»·çš„ï¼Œå› ä¸ºå­˜åœ¨åŒå°„å‡½æ•°æ­¤å‡½æ•°ç§°ä¸ºlogisticå‡½æ•°æˆ–sigmoidå‡½æ•°ï¼Œæœ‰ç€ä¼˜è‰¯çš„æ€§è´¨ï¼Œåœ¨æœºå™¨å­¦ä¹ ä¸æ·±åº¦å­¦ä¹ ä¸­è¢«å¹¿æ³›ä½¿ç”¨ã€‚å¯æ•°é›†å’Œä¸å¯æ•°é›†æ— é™é›†ï¼Œå¯è¿›ä¸€æ­¥åˆ†ä¸ºå¯æ•°é›†ä¸ä¸å¯æ•°é›†ï¼Œå¯æ•°é›†ä¸­çš„æ¯ä¸ªå…ƒç´ å¯ä»¥ç”¨æ­£æ•´æ•°è¿›è¡Œç¼–å·ï¼Œå³ä¸æ­£æ•´æ•°ç­‰åŠ¿æ­£æ•´æ•°æ˜¯å¯æ•°é›†ï¼Œå®ƒçš„æ¯ä¸ªå…ƒç´ å¯ä»¥å†™æˆå¯æ•°é›†å®šä¹‰ï¼šå¦‚æœå­˜åœ¨ä»æ­£æ•´æ•°é›†åˆ°é›†åˆ$A$çš„åŒå°„å…³ç³»ï¼Œåˆ™é›†åˆæ˜¯å¯æ•°çš„æ•´æ•°é›†æ˜¯å¯æ•°çš„ï¼Œå› ä¸ºå­˜åœ¨åŒå°„å‡½æ•°ï¼Œå°†å…¶æ˜ å°„åˆ°æ­£æ•´æ•°é›†æœ‰ç†æ•°é›†ä¹Ÿæ˜¯å¯æ•°é›†ï¼Œå› ä¸ºæ‰€æœ‰çš„æœ‰ç†æ•°éƒ½å¯ä»¥å†™æˆä¸¤ä¸ªæ•´æ•°ç›¸é™¤çš„å½¢å¼æ•´æ•°é›†å’Œæœ‰ç†æ•°é›†ï¼Œè¿™é‡Œçš„ç¦»æ•£å’Œå¯æ•°ç­‰ä»·ï¼Œä»»ä½•å¯æ•°é›†åœ¨æ•°è½´ä¸Šçš„â€é•¿åº¦â€ä¸º0ã€‚ä¸å¯æ•°é›†ï¼šæ— ç†æ•°ã€å®æ•°é›†å’Œé•¿åº¦ä¸ä¸º0çš„å®æ•°åŒºé—´éƒ½æ˜¯ä¸å¯æ•°çš„ï¼Œå…¶ä¸­çš„å…ƒç´ æ˜¯è¿ç»­çš„ï¼Œå®ƒä»¬åœ¨æ•°è½´ä¸Šæ˜¯ç¨ å¯†çš„æˆ–è€…è¯´è¿ç»­çš„ï¼Œå¦‚ï¼Œåœ†å‘¨ç‡ä»¥åŠä»¥è‡ªç„¶å¯¹æ•°åº•æ•°éƒ½æ˜¯æ— ç†æ•°ï¼Œä¸å¯æ•°é›†åœ¨æ•°è½´ä¸Šçš„â€é•¿åº¦â€ä¸ä¸º0ã€‚å¯æ•°å’Œä¸å¯æ•°çš„æ¦‚å¿µå°†ç”¨äºå®šç§¯åˆ†ä¸­å‡½æ•°çš„å¯ç§¯æ€§ï¼Œä»¥åŠæ¦‚ç‡è®ºä¸­çš„ç¦»æ•£å‹å’Œè¿ç»­å‹éšæœºå˜é‡ç­‰æ¦‚å¿µä¸­æ•°åˆ—çš„æé™æé™æ¦‚å¿µä¸å®šä¹‰æ•°åˆ—æé™æ•°åˆ—çš„æé™åæ˜ äº†å½“æ•°åˆ—å…ƒç´ ä¸‹æ ‡è¶‹å‘äºæ—¶æ•°åˆ—é¡¹å–å€¼çš„è¶‹åŠ¿æ•°åˆ—æé™å®šä¹‰: å¯¹äºæ•°åˆ—ä»¥åŠæŸä¸€å®æ•°ï¼Œå¦‚æœå¯¹äºä»»æ„ç»™å®šçš„éƒ½å­˜åœ¨æ­£æ•´æ•°ï¼Œä½¿å¾—å¯¹äºä»»æ„æ»¡è¶³çš„éƒ½æœ‰ä¸‹é¢çš„ä¸ç­‰å¼æˆç«‹åˆ™ç§°æ­¤æ•°åˆ—çš„æé™ä¸ºï¼Œæˆ–ç§°å…¶æ”¶æ•›äºï¼Œæ•°åˆ—çš„æé™è®°ä¸ºç›´è§‚è§£é‡Š: å½“å¢åŠ æ—¶æ•°åˆ—çš„å€¼æ— é™è¶‹è¿‘äºï¼Œå¯æ¥è¿‘åˆ°ä»»æ„æŒ‡å®šçš„ç¨‹åº¦ï¼Œç”±æ§åˆ¶ï¼Œå½“æ•°åˆ—çš„æé™ä¸å­˜åœ¨ï¼Œåˆ™ç§°è¯¥æ•°åˆ—å‘æ•£ï¼Œå¦‚æœæ•°åˆ—çš„æé™å­˜åœ¨ï¼Œåˆ™å…¶å€¼å¿…å”¯ä¸€è¯æ˜æ•°åˆ—æé™å­˜åœ¨ä¸”ä¸ºæŸä¸€å€¼çš„æ–¹æ³•æ˜¯è¯æ˜å…¬å¼(1)æˆç«‹å¹¶éæ‰€æœ‰çš„æ•°åˆ—éƒ½å­˜åœ¨æé™æ•°åˆ—ï¼Œå½“æ—¶ï¼Œæ•°åˆ—çš„å€¼åœ¨-1ä¸1ä¹‹é—´æŒ¯è¡æ•°åˆ—ï¼Œå½“æ—¶ï¼Œæ•°åˆ—çš„å€¼è¶‹å‘äºï¼Œæé™ä¹Ÿä¸å­˜åœ¨æ•°åˆ—æé™çš„å››åˆ™è¿ç®—è®¡ç®—æé™ï¼Œæ ¹æ®æ•°åˆ—æé™çš„å››åˆ™è¿ç®—æœ‰æé™å­˜åœ¨åˆ¤å®šæ³•åˆ™å•è°ƒæ”¶æ•›å®šç†å¤¹é€¼å®šç†æ•°åˆ—ä¸Šç•Œå’Œä¸‹ç•Œä¸Šç•Œ: å¯¹äºæ•°åˆ—ï¼Œå¦‚æœå®ƒçš„ä»»æ„å…ƒç´ éƒ½æ»¡è¶³ï¼Œåˆ™ç§°ä¸ºæ•°åˆ—çš„ä¸Šç•Œï¼Œä¸Šç•Œä¸å”¯ä¸€ä¸‹ç•Œ: å¯¹äºæ•°åˆ—ï¼Œå¦‚æœå®ƒçš„ä»»æ„å…ƒç´ éƒ½æ»¡è¶³ï¼Œåˆ™ç§°ä¸ºæ•°åˆ—çš„ä¸‹ç•Œå•è°ƒæ”¶æ•›å®šç†: å¦‚æœæ•°åˆ—å•è°ƒé€’å¢ä¸”å­˜åœ¨ä¸Šç•Œï¼Œåˆ™æé™å­˜åœ¨ï¼Œå¦‚æœæ•°åˆ—å•è°ƒé€’å‡ä¸”æœ‰ä¸‹ç•Œï¼Œåˆ™æé™å­˜åœ¨ï¼Œå³å•è°ƒæœ‰ç•Œçš„æ•°åˆ—æ”¶æ•›æ ¹æ®å•è°ƒæ”¶æ•›å®šç†ï¼Œå¯ä»¥å¾—åˆ°å¾®ç§¯åˆ†ä¸­ä¸€ä¸ªé‡è¦æé™ï¼Œå¯¹äºæ•°åˆ—çš„æé™ä¸ºå›¾ å•è°ƒæœ‰ç•Œçš„æ•°åˆ—æ”¶æ•›å…¶ä¸­ä¸ºè‡ªç„¶å¯¹æ•°çš„åº•æ•°ï¼Œçº¦ä¸ºï¼Œæ˜¯æ•°å­¦ä¸­æœ€é‡è¦çš„å¸¸æ•°ä¹‹ä¸€è¯æ˜: è¯æ˜æ•°åˆ—æœ‰ç•Œå’Œå•è°ƒé€’å¢ï¼Œæ”¶æ•›äºæ•°åˆ—çš„æé™ä¸ºè¿™ä¸ªæé™å¯ä»¥ç”¨æ¥è¡¨ç¤ºå¯¹ä¸ªæ ·æœ¬è¿›è¡Œæ¬¡æœ‰æ”¾å›ç­‰æ¦‚ç‡æŠ½æ ·ï¼Œå½“æ ·æœ¬é‡è¶‹äºæ— ç©·å¤§æ—¶ï¼Œæ¯ä¸ªæ ·æœ¬ä¸€æ¬¡éƒ½æ²¡è¢«æŠ½ä¸­çš„æ¦‚ç‡å•è°ƒæœ‰ç•Œæ˜¯æ•°åˆ—æ”¶æ•›çš„å……åˆ†æ¡ä»¶è€Œéå¿…è¦æ¡ä»¶å›¾ ä¸æ»¡è¶³å•è°ƒæœ‰ç•Œæ¡ä»¶ä½†æ”¶æ•›çš„æ•°åˆ—å¤¹é€¼å®šç†: å¦‚æœå¯¹äºæœ‰ä¸”ï¼Œåˆ™æœ‰ï¼Œè¿™ä¸€ç»“è®ºç§°ä¸ºå¤¹é€¼å®šç†å¦‚æœæ•°åˆ—æ— ç•Œï¼Œåˆ™å¿…å®šå‘æ•£ï¼Œæœ‰ç•Œæ˜¯æ•°åˆ—æ”¶æ•›çš„å¿…è¦æ¡ä»¶è€Œéå……åˆ†æ¡ä»¶ï¼Œå¦‚æ•°åˆ—æœ‰ç•Œä½†ä¸æ”¶æ•›å‡½æ•°çš„æé™å‡½æ•°æé™çš„ä¸¥æ ¼å®šä¹‰ç”±æ³•å›½æ•°å­¦å®¶æŸ¯è¥¿ç»™å‡º: å³å½“å‰å¹¿æ³›ä½¿ç”¨çš„$\epsilon \mbox{-} s $å®šä¹‰é¢†åŸŸ: ç‚¹çš„é¢†åŸŸæ˜¯æŒ‡æ»¡è¶³ä¸ç­‰å¼çš„æ‰€æœ‰æ„æˆçš„é›†åˆï¼Œå³åŒºé—´ï¼Œç§°ä¸ºé¢†åŸŸçš„åŠå¾„å»å¿ƒé¢†åŸŸ: å»å¿ƒé¢†åŸŸæ˜¯æŒ‡æ»¡è¶³ä¸Šå¼ä¸”å»æ‰ç‚¹çš„ç‚¹æ„æˆçš„é›†åˆå‡½æ•°æé™: å¯¹äºå‡½æ•°ï¼Œå¦‚æœå¯¹äºä»»æ„çš„ï¼Œå‡å­˜åœ¨çš„å»å¿ƒé¢†åŸŸï¼Œä½¿å¾—å»å¿ƒé¢†åŸŸå†…æ‰€æœ‰çš„éƒ½æœ‰åˆ™ç§°å‡½æ•°åœ¨ç‚¹å¤„çš„æé™ä¸ºï¼Œå‡½æ•°åœ¨ç‚¹å¤„çš„æé™è®°ä¸ºç›´è§‚è§£é‡Š: å½“è‡ªå˜é‡çš„å€¼æ— é™æ¥è¿‘äºæ—¶ï¼Œå‡½æ•°å€¼æ— é™æ¥è¿‘äºå³åœ¨å†…çš„å‡½æ•°å€¼éƒ½åœ¨åŒºé—´å†…è¯æ˜å‡½æ•°æé™çš„æ–¹æ³•å’Œæ•°åˆ—ç±»ä¼¼ï¼Œæ ¸å¿ƒæ˜¯è¯æ˜åœ¨åŒºæ–°é¢†åŸŸå†…ä½¿å¾—å…¬å¼(1)æˆç«‹å·¦å³æé™ä¸€ç»´æ•°è½´ä¸Šæœ‰ä¸¤ä¸ªæ–¹å‘ï¼Œå˜é‡å¯ä»¥ä»å·¦ä¾§è¶‹è¿‘äºï¼Œä¹Ÿå¯ä»¥ä»å³ä¾§è¶‹è¿‘äºå› æ­¤å‡½æ•°çš„æé™åˆ†ä¸ºå·¦æé™å’Œå³æé™ï¼Œå·¦æé™å’Œå³æé™åˆ†åˆ«è®°ä¸ºå¤¹é€¼å®šç†å‡è®¾æ˜¯åŒ…å«ç‚¹çš„åŒºé—´ï¼Œã€ã€ä¸ºå®šä¹‰åœ¨è¯¥åŒºé—´ä¸Šçš„å‡½æ•°ï¼Œå¦‚æœå¯¹æ‰€æœ‰å±äºä½†ä¸ç­‰äºç‚¹çš„ç‚¹éƒ½æœ‰ï¼Œä¸”åˆ™æœ‰ï¼Œè¿™ä¸€ç»“è®ºç§°ä¸ºå¤¹é€¼å®šç†å‡ ä¸ªé‡è¦æé™ä»¤ï¼Œåˆ™ï¼Œå› æ­¤æœ‰å› ä¸ºæœ‰æœ€åå¯ä»¥å¾—åˆ°å‡½æ•°çš„è¿ç»­æ€§ä¸é—´æ–­ç‚¹è¿ç»­æ€§å‡½æ•°çš„è¿ç»­å‹é€šè¿‡æé™å®šä¹‰ï¼Œæ˜¯æœ€åŸºæœ¬çš„æ€§è´¨ä¹‹ä¸€å‡½æ•°è¿ç»­çš„ç›´è§‚è¡¨ç°: å¦‚æœè‡ªå˜é‡çš„æ”¹å˜å¾ˆå°ï¼Œåˆ™å› å˜é‡çš„æ”¹å˜ä¹Ÿéå¸¸å°ï¼Œå‡½æ•°å€¼ä¸ä¼šçªç„¶å‘ç”Ÿè·³è·ƒå‡½æ•°è¿ç»­çš„å®šä¹‰å¦‚æœå‡½æ•°æ»¡è¶³ï¼Œåˆ™ç§°å®ƒåœ¨ç‚¹å¤„è¿ç»­å‡ ä½•è§£é‡Šå‡½æ•°è¿ç»­åœ¨è¯¥ç‚¹å¤„çš„å‡½æ•°æ›²çº¿æ²¡æœ‰â€æ–­â€è¿ç»­çš„é‡è¦æ€§è´¨åŸºæœ¬åˆç­‰å‡½æ•°åœ¨å…¶å®šä¹‰åŸŸå†…æ˜¯è¿ç»­çš„ï¼ŒåŒ…æ‹¬å¤šé¡¹å¼å‡½æ•°ã€æœ‰ç†åˆ†å¼å‡½æ•°ã€æŒ‡æ•°å‡½æ•°ã€å¯¹æ•°å‡½æ•°ã€ä¸‰è§’å‡½æ•°ã€åä¸‰è§’å‡½æ•°ç»å¯¹å€¼å‡½æ•°åœ¨å…¶å®šä¹‰åŸŸå†…ä¹Ÿæ˜¯è¿ç»­çš„ç”±åŸºæœ¬åˆç­‰å‡½æ•°ç»è¿‡æœ‰é™æ¬¡å››åˆ™è¿ç®—å’Œå¤åˆè€Œå½¢æˆçš„å‡½æ•°ï¼Œåœ¨å…¶å®šä¹‰åŸŸå†…è¿ç»­ï¼Œè¿™æ ·çš„å‡½æ•°è¢«ç§°ä¸ºåˆç­‰å‡½æ•°å¦‚æœå‡½æ•°å’Œåœ¨å®šä¹‰åŸŸå†…è¿ç»­ï¼Œåˆ™å¤åˆå‡½æ•°åœ¨å®šä¹‰åŸŸå†…è¿ç»­ç¬¬ä¸€ç±»é—´æ–­ç‚¹ç¬¬äºŒç±»é—´æ–­ç‚¹è·³è·ƒé—´æ–­ç‚¹è·³è·ƒé—´æ–­ç‚¹: å‡½æ•°åœ¨å¤„çš„å·¦æé™å’Œå³æé™éƒ½å­˜åœ¨ï¼Œä½†ä¸ç›¸ç­‰ä¾‹å­:  å…¶ä¸­ä¸ºè·³è·ƒé—´æ–­ç‚¹å›¾ è·³è·ƒé—´æ–­ç‚¹å¯å»é—´æ–­ç‚¹å¯å»é—´æ–­ç‚¹: æˆ–è€…å·¦å³æé™ç›¸ç­‰ï¼Œä½†ä¸ç­‰äºè¯¥ç‚¹å¤„çš„å‡½æ•°å€¼ä¾‹å­:  å…¶ä¸­ä¸ºå¯å»é—´æ–­ç‚¹å‡½æ•°åœ¨ç‚¹å¤„çš„å·¦æé™å’Œå³æé™è‡³å°‘æœ‰ä¸€ä¸ªä¸å­˜åœ¨ä¾‹å­: æ­£åˆ‡å‡½æ•°ï¼Œåœ¨å¤„æé™å€¼ä¸å­˜åœ¨ï¼Œä¸ºç¬¬äºŒç±»é—´æ–­ç‚¹å›¾ æ­£åˆ‡å‡½æ•°çš„ç¬¬äºŒç±»é—´æ–­ç‚¹ä¾‹å­: åæ¯”ä¾‹å‡½æ•°ï¼Œä¸ºå‡½æ•°çš„ç¬¬äºŒç±»é—´æ–­ç‚¹ï¼Œåœ¨è¯¥ç‚¹å¤„å‡½æ•°çš„æé™ä¸å­˜åœ¨å›¾ åæ¯”ä¾‹å‡½æ•°çš„ç¬¬äºŒç±»é—´æ–­ç‚¹è¿ç»­å‡½æ•°çš„æ€§è´¨è¿ç»­å‡½æ•°å…·æœ‰å¾ˆå¤šä¼˜è‰¯çš„æ€§è´¨é—­åŒºé—´ä¸Šçš„è¿ç»­å‡½æ•°ä¸€å®šå­˜åœ¨æå¤§å€¼å’Œæå°å€¼ï¼Œä½¿å¾—å¯¹äºè¯¥åŒºé—´ä»»æ„çš„æœ‰å¼€åŒºé—´ä¸Šçš„è¿ç»­å‡½æ•°åˆ™ä¸èƒ½ä¿è¯å­˜åœ¨æå¤§å€¼å’Œæå°å€¼ï¼Œå¦‚åæ¯”ä¾‹å‡½æ•°ä»‹å€¼å®šç†ä»‹å€¼å®šç†ï¼š å¦‚æœå‡½æ•°åœ¨é—­åŒºé—´å†…è¿ç»­ï¼Œæ˜¯ä»‹äºå’Œä¹‹é—´çš„ä¸€ä¸ªæ•°ï¼Œåˆ™å­˜åœ¨ä¸­çš„æŸä¸ªç‚¹ï¼Œä½¿å¾—ï¼Œè€ƒè™‘ä¸‹å›¾å›¾  ä»‹å€¼å®šç†å¯¹äºåŒºé—´ï¼Œåœ¨å·¦å³ç«¯ç‚¹å¤„çš„å‡½æ•°å€¼åˆ†åˆ«ä¸ºå’Œï¼Œå¯¹äºä»»æ„çš„ï¼Œå‡å­˜åœ¨è‡³å°‘ä¸€ä¸ªç‚¹ï¼Œä½¿å¾—å¦‚æœï¼Œåˆ™æ›²çº¿å¿…ç„¶å­˜åœ¨ä¸€ç‚¹ä½¿å¾—ï¼Œè¿™å°±æ˜¯æ–¹ç¨‹çš„æ ¹ï¼Œäº‹å®ä¸Šï¼Œæ»¡è¶³æ­¤æ¡ä»¶ä»‹å€¼å®šç†å‡ ä½•æ„ä¹‰å‡½æ•°åœ¨åŒºé—´å†…ä¸€å®šä¸ç›´çº¿è‡³å°‘æœ‰ä¸€ä¸ªäº¤ç‚¹ï¼Œå…¶ä¸­ä»‹äºå’Œä¹‹é—´ä»‹å€¼å®šç†ä¿è¯è‡³å°‘å­˜åœ¨ä¸€ç‚¹ä½¿å¾—ï¼Œæ»¡è¶³æ­¤æ¡ä»¶çš„å¯èƒ½æœ‰å¤šä¸ªè¿ç»­æ€§å‡è®¾æœºå™¨å­¦ä¹ ä¸æ·±åº¦å­¦ä¹ ç®—æ³•æ‰€ä½¿ç”¨çš„ç»å¤§å¤šæ•°æ¨¡å‹ï¼Œå‡è®¾å‡½æ•°æ˜¯è¿ç»­å‡½æ•°ï¼Œä»¥ä¿è¯è¾“å…¥å˜åŒ–å°çš„å˜åŒ–ä¸è‡³äºå¯¼è‡´é¢„æµ‹å€¼çš„çªå˜ï¼Œè¿™ç§°ä¸ºè¿ç»­æ€§å‡è®¾ï¼Œè¿ç»­æ€§é€šå¸¸èƒ½å¤Ÿä¿è¯æœºå™¨å­¦ä¹ ç®—æ³•æœ‰æ›´å¥½çš„æ³›åŒ–æ€§èƒ½ä¸Šç¡®ç•Œä¸ä¸‹ç¡®ç•Œä¸Šç¡®ç•Œä¸ä¸‹ç¡®ç•Œå¯çœ‹ä½œæ˜¯é›†åˆæœ€å¤§å€¼ä¸æœ€å°å€¼çš„æ¨å¹¿ä¸Šç¡®ç•Œä¸‹ç¡®ç•Œä¸Šç¡®ç•Œä¹Ÿç§°ä¸ºæœ€å°ä¸Šç•Œï¼Œå¯¹äºçš„éç©ºå­é›†ï¼Œå¦‚æœè¯¥é›†åˆä¸­çš„ä»»æ„å…ƒç´ å‡æœ‰ï¼Œå³æ˜¯é›†åˆçš„ä¸€ä¸ªä¸Šç•Œï¼Œä¸”æ»¡è¶³åƒä¸ç­‰æ˜¯æ­¤ä¸ç­‰å¼æ¡ä»¶çš„æœ€å°å€¼ï¼Œåˆ™ä¸ºé›†åˆçš„ä¸Šç¡®ç•Œï¼Œè®°ä¸ºå¦‚æœæ»¡è¶³æ­¤æ¡ä»¶çš„ä¸å­˜åœ¨ï¼Œåˆ™ç§°ä¸ºé›†åˆçš„ä¸Šç¡®ç•Œä¸ºï¼Œå¦‚æœé›†åˆçš„ä¸Šç¡®ç•Œå­˜åœ¨ï¼Œåˆ™å¿…å®šå”¯ä¸€å¦‚æœé›†åˆçš„å…ƒç´ å­˜åœ¨æœ€å¤§å€¼ï¼Œåˆ™æœ€å¤§å€¼ä¸ºå…¶ä¸Šç¡®ç•Œï¼Œå¦‚é—­åŒºé—´çš„ä¸Šç¡®ç•Œä¸º1é›†åˆå¯èƒ½ä¸å­˜åœ¨æœ€å¤§å€¼ï¼Œå¦‚å¼€åŒºé—´ï¼Œå…¶ä¸Šç¡®ç•Œä¸ºï¼Œä½†ä¸æ˜¯é›†åˆçš„æœ€å¤§å€¼ä¾‹å­: é›†åˆæ˜¯æœ‰é™é›†ï¼Œå…¶ä¸Šç¡®ç•Œä¸ºé›†åˆå…ƒç´ çš„æœ€å¤§å€¼ï¼Œå…¶å€¼ä¸ºé›†åˆæ˜¯æ— é™å¯æ•°é›†ï¼Œå¹¶ä¸”è¯¥æ•°åˆ—å•è°ƒé€’å¢ï¼Œå…¶ä¸Šç¡®ç•Œä¸ºæ•°åˆ—çš„æé™é›†åˆæ˜¯æ— é™ä¸å¯æ•°é›†ï¼Œå…¶ä¸Šç¡®ç•Œä¸ºè¯¥å‡½æ•°çš„æå¤§å€¼å……åˆ†å¿…è¦æ¡ä»¶é›†åˆå­˜åœ¨ä¸Šç¡®ç•Œçš„å……åˆ†å¿…è¦æ¡ä»¶æ˜¯é›†åˆæœ‰ä¸Šç•Œï¼Œå®æ•°é›†çš„ä»»æ„éç©ºæœ‰ç•Œå­é›†å‡å­˜åœ¨ä¸Šç¡®ç•Œä¸‹ç¡®ç•Œ: ä¸‹ç¡®ç•Œä¹Ÿç§°ä¸ºæœ€å¤§ä¸‹ç•Œï¼Œæ˜¯é›†åˆçš„ä¸€ä¸ªä¸‹ç•Œï¼Œå³å¯¹ä¸­çš„ä»»æ„å…ƒç´ ï¼Œå‡æœ‰ï¼Œä¸”æ˜¯æœ€å¤§çš„ä¸‹ç•Œï¼Œåˆ™ç§°ä¸ºçš„ä¸‹ç¡®ç•Œï¼Œè®°ä½$inf(S)$å¯¹äºé—­åŒºé—´ï¼Œä¸‹ç¡®ç•Œä¸ºï¼Œå¯¹äºå¼€åŒºé—´ï¼Œå…¶ä¸‹ç¡®ç•Œä¹Ÿä¸ºä¾‹å­:é›†åˆçš„ä¸‹ç¡®ç•Œä¸ºï¼Œåœ¨æ—¶å–å¾—é›†åˆçš„ä¸‹ç¡®ç•Œä¸ºï¼Œæ˜¯å‡½æ•°çš„æœ€å°å€¼ææ™®å¸ŒèŒ¨è¿ç»­ææ™®å¸ŒèŒ¨è¿ç»­ææ™®å¸ŒèŒ¨è¿ç»­æ˜¯æ¯”è¿ç»­æ›´å¼ºçš„æ¡ä»¶ï¼Œä¸ä½†ä¿è¯äº†å‡½æ•°å€¼ä¸é—´æ–­ï¼Œè€Œä¸”é™å®šäº†å‡½æ•°çš„å˜åŒ–é€Ÿåº¦ç»™å®šå‡½æ•°ï¼Œå¦‚æœå¯¹äºåŒºé—´ä»»æ„ä¸¤ç‚¹ã€éƒ½å­˜åœ¨å¸¸æ•°ä½¿å¾—ä¸‹é¢çš„ä¸ç­‰å¼æˆç«‹åˆ™ç§°å‡½æ•°åœ¨åŒºé—´å†…æ»¡è¶³ææ™®å¸ŒèŒ¨æ¡ä»¶ï¼Œä¹Ÿç§°ä¸ºææ™®å¸ŒèŒ¨è¿ç»­ä½¿å¾—å…¬å¼(1)æˆç«‹çš„æœ€å°å€¼ç§°ä¸ºææ™®å¸ŒèŒ¨å¸¸æ•°ï¼Œå…¶å€¼ä¸å…·ä½“çš„å‡½æ•°æœ‰å…³å¦‚æœï¼Œåˆ™ç§°å‡½æ•°ä¸ºå‹ç¼©æ˜ å°„å‡ ä½•æ„ä¹‰åœ¨ä»»æ„ä¸¤ç‚¹ï¼Œå¤„å‡½æ•°å‰²çº¿æ–œç‡çš„ç»å¯¹å€¼å‡ä¸å¤§äºåœ¨ä»»ä¸€ç‚¹å¤„ï¼Œæ›²çº¿å‡å¤¹åœ¨ç›´çº¿ä¸ä¹‹é—´ï¼Œå¦‚å›¾æ‰€ç¤ºå›¾ ææ™®å¸ŒèŒ¨è¿ç»­æ€§å‘å³ä¸Šå€¾æ–œçš„ç›´çº¿ä¸æƒ³åšä¸Šå€¾æ–œçš„ç›´çº¿åˆ†åˆ«ä¸ºä¸ä¾‹å­ä¸€æ¬¡å‡½æ•°åœ¨å†…æ˜¯ææ™®å¸ŒèŒ¨è¿ç»­ï¼Œå› ä¸ºå¯¹äºä»»æ„çš„å’Œéƒ½æœ‰å› æ­¤è¯¥å‡½æ•°ææ™®å¸ŒèŒ¨è¿ç»­ä¸”ææ™®å¸ŒèŒ¨å¸¸æ•°ä¸ºäºŒæ¬¡å‡½æ•°åœ¨å†…ä¸æ˜¯ææ™®å¸ŒèŒ¨è¿ç»­ï¼Œå› ä¸ºå¯¹äºå†…ä»»æ„çš„å’Œéƒ½æœ‰æ˜¾ç„¶ä¸å­˜åœ¨å¸¸æ•°ä½¿å¾—ä»»æ„å’Œéƒ½æ»¡è¶³ï¼Œå› æ­¤è¯¥å‡½æ•°ä¸æ˜¯ææ™®å¸ŒèŒ¨è¿ç»­å‡½æ•°åœ¨åŒºé—´å†…ææ™®å¸ŒèŒ¨è¿ç»­å¯¹äºåŒºé—´å†…ä»»æ„çš„å’Œéƒ½æœ‰åŒºé—´å†…ä¸æ˜¯ææ™®å¸ŒèŒ¨è¿ç»­ï¼Œå¯¹äºè¯¥åŒºé—´å†…ä»»æ„çš„å’Œéƒ½æœ‰å½“æ—¶ï¼Œä¸å­˜åœ¨å¸¸æ•°æ»¡è¶³æœºå™¨å­¦ä¹ ä¸­çš„æ„ä¹‰ææ™®å¸ŒèŒ¨è¿ç»­è¦æ±‚å‡½æ•°åœ¨åŒºé—´ä¸Šä¸èƒ½æœ‰è¶…è¿‡çº¿æ€§çš„å˜åŒ–é€Ÿåº¦ï¼Œå¯¹äºåˆ†æå’Œç¡®ä¿æœºå™¨å­¦ä¹ ç®—æ³•çš„ç¨³å®šæ€§æœ‰é‡è¦çš„ä½œç”¨æ— ç©·å°é‡è€ƒè™‘å‡½æ•°æé™å€¼ä¸ºçš„æƒ…å†µå®šä¹‰: å¦‚æœå‡½æ•°åœ¨çš„æŸå»å¿ƒé¢†åŸŸå†…ï¼Œæœ‰å®šä¹‰ä¸”åˆ™ç§°ä¸ºçš„æ— ç©·å°é‡è™½ç„¶å®ƒä»¬çš„æå€¼å‡ä¸º0ï¼Œä½†å®ƒä»¬ä¹‹é—´æ¯”å€¼çš„æé™å´æœ‰å‡ ç§æƒ…å†µé«˜é˜¶æ— ç©·å°: ï¼Œè¯¥æ¯”å€¼ä¹Ÿæ˜¯æ— ç©·å°é‡ï¼Œä¾‹å¦‚åŒé˜¶æ— ç©·å°(ç­‰ä»·æ— ç©·å°): ï¼Œæ¯”å€¼çš„æé™ä¸ºé$0$çš„æœ‰ç•Œå˜é‡ï¼Œä¾‹å¦‚ä½é˜¶æ— ç©·å°: ï¼Œæ¯”å€¼çš„æé™ä¸ºæ— ç•Œå˜é‡(ç§°ä¸ºæ— ç©·å¤§é‡)ï¼Œä¾‹å¦‚å…¶ä¸­é«˜é˜¶æ— ç©·å°è®°ä¸ºï¼Œç­‰ä»·æ— ç©·å°è®°ä¸ºç›´è§‚æ¥çœ‹è¿™äº›æ¯”å€¼åæ˜ äº†æ— ç©·å°æ¥è¿‘äº0æ—¶çš„å˜åŒ–é€Ÿåº¦å¿«æ…¢å…¸å‹çš„ç­‰ä»·æ— ç©·å°()ç­‰ä»·æ— ç©·å°åœ¨è®¡ç®—æé™æ—¶èµ·ç€é‡è¦çš„ä½œç”¨å¯¼æ•°ä¸å¾®åˆ†å¯¼æ•°æ˜¯å¾®åˆ†å­¦ä¸­çš„æ ¸å¿ƒæ¦‚å¿µï¼Œå®ƒå†³å®šäº†å¯å¯¼å‡½æ•°çš„åŸºæœ¬æ€§è´¨ï¼ŒåŒ…æ‹¬å•è°ƒæ€§ã€æå€¼ä¸å‡¹å‡¸æ€§ã€‚åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œç»å¤§å¤šæ•°ç®—æ³•å¯ä»¥å½’çº³ä¸ºæ±‚è§£æœ€ä¼˜åŒ–çš„é—®é¢˜ï¼Œå¯¹äºè¿ç»­å‹ä¼˜åŒ–é—®é¢˜åœ¨æ±‚è§£æ—¶ä¸€èˆ¬éœ€è¦ä½¿ç”¨å¯¼æ•°ä¸€é˜¶å¯¼æ•°å®šä¹‰å¯¼æ•°å®šä¹‰å‡½æ•°çš„è‡ªå˜é‡å˜åŒ–å€¼è¶‹å‘äºæ—¶ï¼Œå‡½æ•°å€¼çš„å˜åŒ–é‡ä¸è‡ªå˜é‡å˜åŒ–é‡æ¯”å€¼çš„æé™ï¼Œåœ¨ç‚¹å¤„çš„å¯¼æ•°ä¸ºå¦‚æœå¼(1)çš„æé™å­˜åœ¨ï¼Œåˆ™ç§°å‡½æ•°åœ¨ç‚¹$x$å¤„å¯å¯¼é™¤äº†ç”¨è¡¨ç¤ºä¹‹å¤–ï¼Œå¯¼æ•°ä¹Ÿå¯å†™æˆï¼Œå³ä¸Šé¢çš„å®šä¹‰ä¹Ÿå¯ä»¥å†™æˆå¦ä¸€ç§å½¢å¼å·¦å³å¯¼æ•°ç±»ä¼¼äºæé™ï¼Œå¯¼æ•°ä¹Ÿå¯åˆ†ä¸ºå·¦å¯¼æ•°å’Œå³å¯¼æ•°å·¦å¯¼æ•°æ˜¯ä»å·¦ä¾§è¶‹å‘äºæ—¶çš„æé™å³å¯¼æ•°ä¸ºè‡ªå˜é‡ä»å³ä¾§è¶‹å‘äºæ—¶çš„æé™å‡½æ•°å¯å¯¼çš„å……åˆ†å¿…è¦æ¡ä»¶æ˜¯å·¦å³å¯¼æ•°å‡å­˜åœ¨ä¸”ç›¸ç­‰ï¼Œå…¶å¿…è¦æ¡ä»¶æ˜¯å‡½æ•°è¿ç»­å¦‚æœå¯¼æ•°ä¸å­˜åœ¨ï¼Œåˆ™ç§°å‡½æ•°ä¸å¯å¯¼å‡ ä½•å’Œç‰©ç†æ„ä¹‰å‡ ä½•æ„ä¹‰å‡½æ•°åœ¨å®šä¹‰åŸŸ å†…æ‰€æœ‰ç‚¹å¤„çš„å¯¼æ•°å€¼æ„æˆçš„å‡½æ•°ç§°ä¸ºå¯¼å‡½æ•°ï¼Œç®€ç§°å‡½æ•°å¯¼æ•°çš„å‡ ä½•æ„ä¹‰æ˜¯å‡½æ•°åœ¨ç‚¹å¤„åˆ‡çº¿çš„æ–œç‡ï¼Œåæ˜ äº†å‡½æ•°å€¼åœ¨æ­¤ç‚¹å¤„å˜åŒ–çš„å¿«æ…¢å‡½æ•°åœ¨å¤„ï¼Œæ ¹æ®å¯¼æ•°çš„å®šä¹‰æœ‰å› æ­¤åœ¨è¯¥ç‚¹å¤„çš„åˆ‡çº¿æ–œç‡ä¸ºï¼Œç”±äºåˆ‡çº¿ç»è¿‡ï¼Œå› æ­¤åˆ‡çº¿çš„æ–¹ç¨‹ä¸ºï¼Œå³ï¼Œä¸‹å›¾ä¸ºè¯¥æ›²çº¿å’Œå¯¹åº”çš„åˆ‡çº¿å›¾  å¯¼æ•°çš„å‡ ä½•æ„ä¹‰ç‰©ç†æ„ä¹‰å¯¼æ•°å…¸å‹çš„ç‰©ç†æ„ä¹‰æ˜¯ç¬æ—¶é€Ÿåº¦å·®åˆ†å…¬å¼å•ä¾§å·®åˆ†å…¬å¼å¦‚æœçš„å€¼æ¥è¿‘äºï¼Œåˆ™åœ¨ç‚¹å¤„çš„å¯¼æ•°å¯ä»¥ç”¨ä¸‹é¢çš„å…¬å¼è¿‘ä¼¼è®¡ç®—ç§°ä¸ºå•ä¾§å·®åˆ†å…¬å¼ä¸­å¿ƒå·®åˆ†å…¬å¼æ ¹æ®å¯¼æ•°çš„å®šä¹‰æœ‰å…¶ä¸­ä¸ºæ¥è¿‘äºçš„æ­£æ•°ï¼Œè¿™ç§°ä¸ºä¸­å¿ƒå·®åˆ†å…¬å¼ï¼Œç”¨äºæ•°å€¼è®¡ç®—å¯¼æ•°å€¼ï¼Œå› æ­¤å¯ç”¨ä¸‹é¢çš„å…¬å¼è¿‘ä¼¼è®¡ç®—ç‚¹å¤„çš„ä¸€é˜¶å¯¼æ•°å€¼åŸºæœ¬å‡½æ•°çš„æ±‚å¯¼ä¸‹è¡¨)åˆ—å‡ºäº†å„ç§åŸºæœ¬åˆç­‰å‡½æ•°çš„æ±‚å¯¼å…¬å¼è¡¨ åŸºæœ¬å‡½æ•°çš„æ±‚å¯¼å…¬å¼åŸºæœ¬å‡½æ•°æ±‚å¯¼å…¬å¼å¹‚å‡½æ•°æŒ‡æ•°å‡½æ•°æŒ‡æ•°å‡½æ•°ä¸‰è§’å‡½æ•°ä¸‰è§’å‡½æ•°ä¸‰è§’å‡½æ•°ä¸‰è§’å‡½æ•°å¯¹æ•°å‡½æ•°åä¸‰è§’å‡½æ•°åä¸‰è§’å‡½æ•°åä¸‰è§’å‡½æ•°è¯æ˜å››åˆ™è¿ç®—çš„æ±‚å¯¼å…¬å¼åŸºæœ¬è¿ç®—æ±‚å¯¼å…¬å¼åŠ æ³•å‡æ³•æ•°ä¹˜ä¹˜æ³•é™¤æ³•å€’æ•°æœºå™¨å­¦ä¹ ä¸­å¸¸ç”¨çš„å‡½æ•°logisticå‡½æ•°å¯ç”¨ä½œç¥ç»ç½‘ç»œçš„æ¿€æ´»å‡½æ•°softpluså‡½æ•°ï¼Œå¯çœ‹ä½œæ˜¯å‡½æ•°Reluå³$max(0,x)$çš„å…‰æ»‘è¿‘ä¼¼ï¼Œè¯¥å‡½æ•°çš„å¯¼æ•°ä¸ºlogisticå‡½æ•°å‡½æ•°çš„å¯¼æ•°ä¸ºï¼šReluå‡½æ•°å¯ç”¨ä½œç¥ç»ç½‘ç»œçš„æ¿€æ´»å‡½æ•°ï¼Œåœ¨$0$å¤„è¯¥å‡½æ•°ä¸å¯å¯¼ï¼Œåœ¨è¯¥ç‚¹å¤„å·¦å¯¼æ•°ä¸º0ï¼Œå³å¯¼æ•°ä¸º1å»æ‰0ç‚¹ï¼Œè¯¥å‡½æ•°çš„å¯¼æ•°ä¸ºï¼šç»å¯¹å€¼å‡½æ•°ï¼Œåœ¨$0$ç‚¹å¤„æ”¹å‡½æ•°ä¸å¯å¯¼ï¼Œå·¦å¯¼æ•°ä¸º-1ï¼Œå³å¯¼æ•°ä¸º1ï¼Œå»æ‰è¯¥ç‚¹ï¼Œæ­¤å‡½æ•°çš„å¯¼æ•°ä¸ºç»å¯¹å€¼å‡½æ•°å¸¸ç”¨äºæ„é€ æœºå™¨å­¦ä¹ ç®—æ³•è®­ç»ƒç›®æ ‡å‡½æ•°çš„æ­£åˆ™åŒ–é¡¹sgnç¬¦å·å‡½æ•°ï¼Œåœ¨$0$ç‚¹å¤„ä¸è¿ç»­ï¼Œå› æ­¤ä¸å¯å¯¼ï¼Œå»æ‰è¯¥ç‚¹ï¼Œæ­¤å‡½æ•°åœ¨æ‰€æœ‰ç‚¹å¤„çš„å¯¼æ•°å‡ä¸º0ç¬¦å·å‡½æ•°å¸¸ç”¨äºåˆ†ç±»å™¨çš„é¢„æµ‹å‡½æ•°ï¼Œè¡¨ç¤ºäºŒå€¼åŒ–çš„åˆ†ç±»ç»“æœï¼Œåœ¨æ”¯æŒå‘é‡æœºã€logsticå›å½’ä¸­éƒ½è¢«ä½¿ç”¨å¦‚æœä¸€ä¸ªå‡½æ•°æ‰€æœ‰ä¸å¯å¯¼ç‚¹çš„é›†åˆä¸ºæœ‰é™é›†æˆ–æ— é™å¯æ•°é›†ï¼Œåˆ™ç§°è¯¥å‡½æ•°å‡ ä¹å¤„å¤„å¯å¯¼ï¼Œæœ¬èŠ‚ä¸­çš„ç»å¯¹å€¼å‡½æ•°ã€Reluå‡½æ•°ã€ç¬¦å·å‡½æ•°å‡æ˜¯å‡ ä¹å¤„å¤„å¯å¯¼çš„å‡½æ•°ï¼Œå¤„å¤„å¯å¯¼ä¿è¯äº†åœ¨è®­ç»ƒæ—¶èƒ½å¤Ÿä½¿ç”¨æ¢¯åº¦ä¸‹é™æ³•æ±‚è§£å‡½æ•°çš„æå€¼é«˜é˜¶å¯¼æ•°å®šä¹‰å¯¹å¯¼æ•°è¿ç»­æ±‚å¯¼å¯ä»¥å¾—åˆ°é«˜é˜¶å¯¼æ•°ï¼ŒäºŒé˜¶å¯¼æ•°çš„æ˜¯ä¸€é˜¶å¯¼æ•°çš„å¯¼æ•°ï¼Œè®°ä¸ºné˜¶å¯¼æ•°è®°ä¸ºè®¡ç®—$f(x) = x^{m}$çš„né˜¶å¯¼æ•°å…¶ä¸€é˜¶å¯¼æ•°ä¸º$fâ€™(x) = mx^{m-1}$ï¼ŒäºŒé˜¶å¯¼æ•°ä¸º$fâ€™â€™(x) = m(m-1)x^{m-2}$ï¼Œä»¥æ­¤ç±»æ¨ï¼Œné˜¶å¯¼æ•°ä¸ºå¦‚æœ$m=n$ï¼Œåˆ™$f^{(n)}(x) = n!$è®¡ç®—$f(x) = \frac {1}{1-x}$çš„né˜¶å¯¼æ•°è®¡ç®—$f(x) = ln(1+x)$çš„né˜¶å¯¼æ•°è®¡ç®—$f(x) = e^x$çš„né˜¶å¯¼æ•°è®¡ç®—f(x)= sin(x)çš„né˜¶å¯¼æ•°æ ¹æ®æ­¤è§„å¾‹æœ‰ç±»ä¼¼åœ°ï¼Œå¯¹äºä½™å¼¦å‡½æ•°$f(x)=cos(x)$æœ‰äºŒé˜¶å¯¼æ•°çš„ç‰©ç†æ„ä¹‰æ˜¯åŠ é€Ÿåº¦ï¼Œå¦‚æœ$f(t)$ä¸ºä½ç§»å‡½æ•°ï¼Œå…¶äºŒé˜¶å¯¼æ•°ä¸º$t$æ—¶åˆ»çš„åŠ é€Ÿåº¦å…¶ä¸­$a(t)$ä¸º$t$æ—¶åˆ»çš„åŠ é€Ÿåº¦ï¼Œ$v(t)$ä¸º$t$æ—¶åˆ»çš„é€Ÿåº¦åœ¨pythonè¯­è¨€ä¸­ï¼Œsympyåº“æä¾›äº†æ±‚å¯¼çš„åŠŸèƒ½123456from sympy import *x = symbols('x')r = diff(cos(x), x)print(r)&gt;&gt;&gt;&gt; -sin(x)å¾®åˆ†å‡½æ•°$y=f(x)$åœ¨æŸä¸€åŒºé—´ä¸Šæœ‰å®šä¹‰ï¼Œå¯¹äºåŒºé—´å†…çš„ç‚¹$x_0$ï¼Œå½“$x$å˜ä¸º$x_0 + \Delta x$æ—¶ï¼Œå¦‚æœå‡½æ•°çš„å¢é‡$\Delta y = f(x_0 + \Delta)-f(x_0)$å¯ä»¥è¡¨ç¤ºæˆå…¶ä¸­$A$æ˜¯ä¸ä¾èµ–äº$\Delta x$çš„å¸¸æ•°ï¼Œ$o(\Delta x)$æ˜¯$\Delta x$çš„é«˜é˜¶æ— ç©·å°ï¼Œåˆ™ç§°å‡½æ•°åœ¨$x_0$å¤„å¯å¾®$A \Delta x$ç§°ä¸ºå‡½æ•°åœ¨$x_0$å¤„çš„å¾®åˆ†ï¼Œè®°ä¸º$dy$ï¼Œå³$dy = A \Delta x$ï¼Œ$dy$ä¸º$\Delta y$çš„çº¿æ€§ä¸»éƒ¨é€šå¸¸æŠŠ$\Delta x$ç§°ä¸ºè‡ªå˜é‡çš„å¾®åˆ†ï¼Œè®°ä¸º$dx$ï¼Œå¦‚æœå‡½æ•°å¯å¾®ï¼Œåˆ™å¯¼æ•°å’Œå¾®åˆ†çš„å…³ç³»ä¸º$dy = f(x)dx$å¾®åˆ†çš„å‡ ä½•æ„ä¹‰æ˜¯åœ¨ç‚¹$(x_0, f(x_0))$å¤„è‡ªå˜é‡å¢åŠ $\Delta x$æ—¶åˆ‡çº¿å‡½æ•°$y = fâ€™(x_0)(x-x_0)+f(x_0)$ä¸¾ä¾‹è¯´æ˜å¾®åˆ†çš„è®¡ç®—ï¼Œå¯¹äºå‡½æ•°$y=sin(x^2)$å…¶å¯¼æ•°ä¸º$yâ€™ = 2x \cdot cos(x^2)$ï¼Œäºæ˜¯å¯ä»¥å¾—åˆ°å…¶å¾®åˆ†ä¸º$dy = 2x \cdot cos(x^2) dx$è€ƒè™‘ä¸‹å¤åˆå‡½æ•°çš„å¾®åˆ†ï¼Œå¯¹äºå¤åˆå‡½æ•°$z = f(y), y=g(x)$æ ¹æ®å¤åˆå‡½æ•°æ±‚å¯¼å…¬å¼æœ‰$\frac{dz}{dx}=fâ€™(y)gâ€™(x)$ï¼Œå› æ­¤å…¶å¾®åˆ†ä¸º$dz = fâ€™(y)gâ€™(x)dx$ç”±äºæœ‰$dy = gâ€™(x)dx$ï¼Œå› ä¸ºä¹Ÿå¯ä»¥å†™æˆ$dz = fâ€™(y)dy$å¯¼æ•°ä¸å‡½æ•°çš„å•è°ƒæ€§å¯¼æ•°å†³å®šäº†å¯å¯¼å‡½æ•°çš„é‡è¦æ€§è´¨ï¼ŒåŒ…æ‹¬å•è°ƒæ€§ä¸æå€¼ï¼Œæ˜¯ç ”ç©¶å‡½æ•°æ€§è´¨çš„æœ‰åŠ›å·¥å…·ï¼Œç”±äºå¯¼æ•°æ˜¯å‡½æ•°å˜åŒ–ç‡çš„æé™å› æ­¤å¦‚æœåœ¨$x$ç‚¹å¤„å®ƒçš„å€¼ä¸ºæ­£ï¼Œåˆ™åœ¨è¯¥ç‚¹å¤„è‡ªå˜é‡å¢å¤§æ—¶å‡½æ•°å€¼ä¹Ÿå¢å¤§ï¼Œå¦‚æœä¸ºè´Ÿï¼Œåˆ™è‡ªå˜é‡å¢å¤§æ—¶å‡½æ•°å€¼å‡å°å‡è®¾å‡½æ•°$f(x)$åœ¨åŒºé—´$[a,b]$å†…è¿ç»­ï¼Œåœ¨åŒºé—´$(a,b)$å†…å¯å¯¼ã€‚å¦‚æœåœ¨$(a,b)$å†…$fâ€™(x) \gt 0$ï¼Œåˆ™å‡½æ•°åœ¨$[a,b]$å†…å•è°ƒé€’å¢ï¼›å¦‚æœåœ¨$(a,b)$å†…$fâ€™(x) \t 0$ï¼Œåˆ™å‡½æ•°åœ¨$[a,b]$å†…å•è°ƒé€’å‡ï¼Œå¯ä»¥é€šè¿‡æ‹‰æ ¼æœ—æ—¥ä¸­å€¼å®šç†è¯æ˜å¯¹äºå‡½æ•°$f(x) = x^3 + 4x^2 -10x +1$å…¶ä¸€é˜¶å¯¼æ•°ä¸º$fâ€™(x) = 3x^2 +8x -10$ï¼Œæ–¹ç¨‹$fâ€™(x)=0$çš„æ ¹ä¸º$x = \frac{-8 \pm \sqrt{64+120}}{6} = \frac{-4 \pm \sqrt{46}}{3}$åœ¨åŒºé—´$(- \infty , \frac{-4-\sqrt{46}}{3} )$å†…$fâ€™(x) \gt 0$ï¼Œå‡½æ•°å•è°ƒé€’å¢åœ¨åŒºé—´$(\frac{-4-\sqrt{46}}{3} , \frac{-4+\sqrt{46}}{3} )$å†…$fâ€™(x) \lt 0$ï¼Œå‡½æ•°å•è°ƒé€’å‡åœ¨åŒºé—´$(\frac{-4+\sqrt{46}}{3} , +\infty )$å†…$fâ€™(x) \gt 0$ï¼Œå‡½æ•°å•è°ƒé€’å¢å› æ­¤åœ¨$x= \frac{-4-\sqrt{46}}{3}$å¤„å‡½æ•°æœ‰æå¤§å€¼ï¼Œåœ¨$ x = \frac{-4+\sqrt{46}}{3}$å¤„å‡½æ•°æœ‰æå°å€¼ï¼Œå‡½æ•°çš„æ›²çº¿ä¸ºåˆ©ç”¨å¯¼æ•°å¯ä»¥è¯æ˜æŸäº›ä¸ç­‰å¼ï¼Œå…¶æ€è·¯æ˜¯è¯æ˜å‡½æ•°åœ¨æŸä¸€åŒºé—´å†…å•è°ƒï¼Œå› æ­¤åœ¨åŒºé—´çš„ç«¯ç‚¹å¤„å–å¾—æå€¼è¯æ˜å½“$x&gt;0$æ—¶ä¸ç­‰å¼$ln(x) \le x-1 $æˆç«‹æ„é€ å‡½æ•°$f(x) = x-1-ln(x)$ï¼Œå…¶å¯¼æ•°ä¸º$fâ€™(x) = 1- \frac{1}{x}$å½“$x \lt 1$æ—¶æœ‰$fâ€™(x) \lt 0$ï¼Œå‡½æ•°å•è°ƒé€’å‡å½“$x \gt 1$æ—¶æœ‰$fâ€™(x) \gt 0$ï¼Œå‡½æ•°å•è°ƒé€’å¢1æ˜¯å‡½æ•°çš„æå°å€¼ç‚¹ï¼Œä¸”$f(1)=0$ï¼Œå› æ­¤ä¸ç­‰å¼æˆç«‹æå€¼åˆ¤åˆ«æ³•åˆ™æå€¼å®šä¹‰ï¼Œè¿™é‡ŒæŒ‡çš„æ˜¯å±€éƒ¨æå€¼å‡½æ•°$f(x)$åœ¨åŒºé—´$I$å†…æœ‰å®šä¹‰ï¼Œ$x_0$æ˜¯è¯¥åŒºé—´å†…çš„ä¸€ä¸ªç‚¹å¦‚æœå­˜åœ¨$x_0$çš„ä¸€ä¸ª$\delta $é¢†åŸŸï¼Œå¯¹äºè¯¥é¢†åŸŸå†…ä»»æ„ä¸€ç‚¹$x$éƒ½æœ‰$f(x_0) \ge f(x)$ï¼Œåˆ™ç§°$x_0$æ˜¯è¯¥å‡½æ•°çš„æå¤§å€¼å¦‚æœé¢†åŸŸå†…ä»»æ„ä¸€ç‚¹$x$éƒ½æœ‰$f(x_0) \le f(x)$ï¼Œåˆ™ç§°$x_0$æ˜¯è¯¥å‡½æ•°çš„æå°å€¼æå¤§å€¼å’Œæå°å€¼ç»Ÿç§°ä¸ºæå€¼å¦‚æœå­˜åœ¨$x_0$çš„ä¸€ä¸ª$\delta $é¢†åŸŸï¼Œå¯¹äºè¯¥é¢†åŸŸå†…ä»»æ„ä¸€ç‚¹$x$éƒ½æœ‰$f(x_0) \gt f(x)$ï¼Œåˆ™ç§°$x_0$æ˜¯è¯¥å‡½æ•°çš„ä¸¥æ ¼æå¤§å€¼å¦‚æœé¢†åŸŸå†…ä»»æ„ä¸€ç‚¹$x$éƒ½æœ‰$f(x_0) \lt f(x)$ï¼Œåˆ™ç§°$x_0$æ˜¯è¯¥å‡½æ•°çš„ä¸¥æ ¼æå°å€¼è´¹é©¬å®šç†ä¸‹çš„å……åˆ†æ¡ä»¶äºŒé˜¶å¯¼æ•°ä¸‹çš„å……åˆ†æ¡ä»¶è´¹é©¬å®šç†å‡è®¾å‡½æ•°$f(x)$åœ¨$x_0$ç‚¹å¤„å¯å¯¼ï¼Œå¦‚æœåœ¨$x_0$ç‚¹å¤„å–å¾—æå€¼ï¼Œåˆ™å®šæœ‰$fâ€™(x) = 0$ï¼Œè¿™ä¸€ç»“è®ºç§°ä¸ºè´¹é©¬å®šç†ï¼Œå®ƒç»™å‡ºäº†å¯å¯¼å‡½æ•°å–æå€¼çš„ä¸€é˜¶å¿…è¦æ¡ä»¶å¯¼æ•°ç­‰äº0çš„ç‚¹ç§°ä¸ºå‡½æ•°çš„é©»ç‚¹(Stationary Point)æœ€ä¼˜åŒ–ç®—æ³•ä¸€èˆ¬é€šè¿‡å¯»æ‰¾å‡½æ•°çš„é©»ç‚¹è€Œæ±‚è§£å‡½æ•°çš„æå€¼é—®é¢˜ï¼Œå¯¼æ•°ä¸º0æ˜¯å‡½æ•°å–å¾—æå€¼çš„å¿…è¦æ¡ä»¶è€Œéå……åˆ†æ¡ä»¶ä¸‹é¢ç»™å‡ºåœ¨è´¹é©¬å®šç†ä¸‹çš„å‡½æ•°å–æå€¼çš„å……åˆ†æ¡ä»¶ï¼Œå‡è®¾å‡½æ•°$f(x)$åœ¨$x_0$ç‚¹çš„ä¸€ä¸ªé¢†åŸŸå†…å¯å¯¼ï¼Œä¸”æœ‰$fâ€™(x) = 0$ï¼Œè€ƒå¯Ÿåœ¨$x_0$å»å¿ƒé¢†åŸŸå†…çš„å‡½æ•°å€¼ç¬¦å·ï¼Œæœ‰ä¸‰ç§æƒ…å†µåœ¨$x_0$çš„å·¦ä¾§$fâ€™(x) \gt 0$ï¼Œåœ¨$x_0$çš„å³ä¾§$fâ€™(x) \lt 0$ï¼Œåˆ™å‡½æ•°åœ¨$x_0$å–ä¸¥æ ¼æå¤§å€¼åœ¨$x_0$çš„å·¦ä¾§$fâ€™(x) \lt 0$ï¼Œåœ¨$x_0$çš„å³ä¾§$fâ€™(x) \gt 0$ï¼Œåˆ™å‡½æ•°åœ¨$x_0$å–ä¸¥æ ¼æå°å€¼åœ¨$x_0$çš„å·¦ä¾§å’Œå³ä¾§$fâ€™(x)$åŒå·ï¼Œåˆ™$x_0$ä¸æ˜¯æå€¼ç‚¹å¯¹äºç¬¬ä¸€ç§æƒ…å†µï¼Œå‡½æ•°åœ¨$x_0$çš„å·¦ä¾§å•è°ƒå¢ï¼Œåœ¨å³ä¾§å•é€’å‡ï¼Œå› æ­¤$x_0$æ˜¯æå¤§å€¼ç‚¹ï¼›å¯¹äºç¬¬äºŒç§æƒ…å†µï¼Œå‡½æ•°åœ¨$x_0$çš„å·¦ä¾§å•é€’å‡ï¼Œåœ¨å³ä¾§å•é€’å¢ï¼Œå› æ­¤$x_0$æ˜¯æå°å€¼ç‚¹ï¼›å¯¹äºç¬¬ä¸‰ç§æƒ…å†µï¼Œå‡½æ•°åœ¨$x_0$çš„ä¸¤ä¾§å‡å•è°ƒå¢æˆ–è€…å•è°ƒå‡ï¼Œå› æ­¤$x_0$ä¸æ˜¯æå€¼ç‚¹æ ¹æ®æ­¤ç»“è®ºï¼Œæ±‚å‡½æ•°çš„æå€¼ç‚¹çš„æ–¹æ³•é¦–å…ˆæ˜¯æ±‚è§£æ–¹ç¨‹$fâ€™(x)=0$å¾—åˆ°å‡½æ•°çš„æ‰€æœ‰é©»ç‚¹ï¼Œç„¶ååˆ¤æ–­é©»ç‚¹ä¸¤ä¾§ä¸€é˜¶å¯¼æ•°å€¼çš„ç¬¦å·åˆ©ç”¨äºŒé˜¶å¯¼æ•°çš„ä¿¡æ¯ç»™å‡ºå‡½æ•°æå€¼çš„å……åˆ†æ¡ä»¶ï¼Œå‡è®¾$x_0$ä¸ºå‡½æ•°çš„é©»ç‚¹ï¼Œä¸”åœ¨è¯¥ç‚¹å¤„äºŒé˜¶å¯å¯¼ï¼Œå¯¹äºé©»ç‚¹å¤„äºŒé˜¶å¯¼æ•°çš„ç¬¦å·ï¼Œå¯åˆ†ä¸ºä¸‰ç§æƒ…å†µ$fâ€™â€™(x) \gt 0$ï¼Œåˆ™$x_0$ä¸ºå‡½æ•°$f(x)$çš„ä¸¥æ ¼æå°å€¼ç‚¹$fâ€™â€™(x) \lt 0$ï¼Œåˆ™$x_0$ä¸ºå‡½æ•°$f(x)$çš„ä¸¥æ ¼æå¤§å€¼ç‚¹$fâ€™â€™(x) = 0$ï¼Œåˆ™ä¸å®šï¼Œ$x_0$å¯èƒ½æ˜¯æå€¼ç‚¹ä¹Ÿå¯èƒ½ä¸æ˜¯æå€¼ç‚¹ï¼Œéœ€è¿›ä¸€æ­¥è®¨è®ºæƒ…å†µä¸€ï¼šå¦‚æœnæ˜¯å¶æ•°ï¼Œåˆ™$x_0$æ˜¯æå€¼ç‚¹ï¼Œå½“$f^{(n)}{x_0} \gt 0$æ˜¯$f(x)$de ä¸¥æ ¼æå°å€¼ç‚¹ï¼Œå½“$f^{(n)}{x_0} \lt 0$æ˜¯$f(x)$de ä¸¥æ ¼æå¤§å€¼ç‚¹æƒ…å†µäºŒï¼šå¦‚æœnæ˜¯æŠ€æœ¯ï¼Œåˆ™$x_0$ä¸æ˜¯$f(x)$çš„æå€¼ç‚¹è¯¥å……åˆ†æ¡ä»¶å¯ä»¥ç”¨æ³°å‹’å…¬å¼è¯æ˜ä¾‹å­è€ƒè™‘å‡½æ•°$f(x)=x^2$å…¶ä¸€é˜¶å¯¼æ•°ä¸º$fâ€™(x)=2x$ï¼Œä»¤$fâ€™(x)=0$å¯ä»¥è§£å¾—å…¶é©»ç‚¹ä¸º$x=0$ï¼Œç”±äº$fâ€™â€™(x)=2 \gt 0$ï¼Œè¯¥ç‚¹æ˜¯å‡½æ•°çš„æå°å€¼ç‚¹å¯¹äºå‡½æ•°$f(x) = -x^2$å…¶ä¸€é˜¶å¯¼æ•°ä¸º$fâ€™(x) = -2x $ï¼Œä»¤$fâ€™(x)=0$å¯ä»¥è§£å¾—å…¶é©»ç‚¹ä¸º$x=0$ï¼Œç”±äº$fâ€™â€™(x)=-2 \lt 0$ï¼Œè¯¥ç‚¹æ˜¯å‡½æ•°çš„æå¤§å€¼ç‚¹å¯¹äºå‡½æ•°$f(x)=x^3$å…¶ä¸€é˜¶å¯¼æ•°ä¸º$fâ€™(x)=3x^2$ï¼Œä»¤$fâ€™(x)=0$å¯ä»¥è§£å¾—å…¶é©»ç‚¹ä¸º$x=0$å…¶äºŒé˜¶å¯¼æ•°ä¸º$fâ€™â€™(x)=6x$å…¶ä¸‰é˜¶å¯¼æ•°ä¸º$f^{(3)}(x)=6$ç”±äº$fâ€™â€™(0)=0$ï¼Œ$f^{(3)}(0)=6$ï¼Œå› æ­¤è¯¥ç‚¹ä¸æ˜¯æå€¼ç‚¹æœ€åä¸€ç§æƒ…å†µç§°ä¸ºéç‚¹ï¼Œä¼šå¯¼è‡´æ•°å€¼ä¼˜åŒ–ç®—æ³•ï¼Œå¦‚æ¢¯åº¦ä¸‹é™æ— æ³•æ‰¾åˆ°çœŸæ­£çš„æå€¼ç‚¹å¯¼æ•°ä¸å‡½æ•°çš„å‡¹å‡¸æ€§å‡¹å‡¸æ€§æ˜¯å‡½æ•°çš„å¦ä¸€ä¸ªé‡è¦æ€§è´¨ï¼Œå®ƒä¸å•è°ƒæ€§å…±åŒå†³å®šäº†å‡½æ•°æ›²çº¿çš„å½¢çŠ¶å‡¸å‡½æ•°å®šä¹‰å‡¹å‡½æ•°å®šä¹‰å¯¹äºå‡½æ•°$f(x)$åœ¨å®ƒçš„å®šä¹‰åŸŸå†…æœ‰ä¸¤ç‚¹$x$ã€$y$ï¼Œå¦‚æœå¯¹äºä»»æ„çš„å®æ•°$ 0 \le \theta \le 1$éƒ½æ»¡è¶³å¦‚ä¸‹ä¸ç­‰å¼å³å‡½æ•°ä¸ºå‡¸å‡½æ•°ï¼Œä»å›¾åƒä¸Šçœ‹ï¼Œå¦‚æœå‡½æ•°ä¸ºå‡¸å‡½æ•°ï¼Œé‚£ä¹ˆå®ƒæ˜¯å‘ä¸‹å‡¸çš„ï¼Œç”¨ç›´çº¿è¿æ¥å‡½æ•°ä¸Šä»»ä½•ä¸¤ç‚¹(å³ä¸¤ç‚¹çš„å‰²çº¿)ï¼Œçº¿æ®µä¸Šçš„ç‚¹éƒ½åœ¨å‡½æ•°æ›²çº¿çš„ä¸Šæ–¹ï¼Œå¦‚å›¾æ‰€ç¤ºå¦‚æœæ»¡è¶³ä¸ç­‰å¼åˆ™ç§°ä¸ºå‡¹å‡½æ•°ï¼Œéœ€è¦å¼ºè°ƒçš„æ˜¯ï¼Œè¿™é‡Œéµå¾ªçš„æ˜¯æ¬§ç¾å›½å®¶çš„å®šä¹‰ï¼Œä¸å›½å†…æŸäº›é«˜ç­‰æ•°å­¦æ•™æå®šä¹‰åˆšå¥½ç›¸åè¯æ˜å‡¸å‡½æ•°å®šä¹‰å¯¹äº$ \forall x,y $ä»¥åŠ$ 0 \le \theta \le 1$æœ‰æ˜¾ç„¶æœ‰å› æ­¤æœ‰å¦‚æœæŠŠå¼ä¸­çš„ç­‰å·å»æ‰ï¼Œåˆ™ç§°å‡½æ•°å¼ä¸¥æ ¼å‡¸å‡½æ•°ï¼Œç±»ä¼¼çš„å¯ä»¥å®šä¹‰ä¸¥æ ¼å‡¹å‡½æ•°äºŒé˜¶å¯å¯¼å‡½æ•°æ˜¯å‡¸å‡½æ•°å’Œå‡¹å‡½æ•°çš„å……åˆ†å¿…è¦æ¡ä»¶å‡è®¾$f(x)$åœ¨åŒºé—´$[a,b]$å†…è¿ç»­ï¼Œåœ¨åŒºé—´$(a,b)$å†…ä¸€é˜¶å¯¼æ•°å’ŒäºŒé˜¶å¯¼æ•°å‡å­˜åœ¨å¦‚æœåœ¨$(a,b)$å†…$fâ€™â€™(x) \ge 0$ï¼Œåˆ™ç§°å‡½æ•°åœ¨$[a,b]$å†…ä¸ºå‡¸å‡½æ•°å¦‚æœåœ¨$(a,b)$å†…$fâ€™â€™(x) \le 0$ï¼Œåˆ™ç§°å‡½æ•°åœ¨$[a,b]$å†…ä¸ºå‡¹å‡½æ•°å¦‚æœåœ¨$(a,b)$å†…$fâ€™â€™(x) &gt; 0$ï¼Œåˆ™ç§°å‡½æ•°åœ¨$[a,b]$å†…ä¸ºä¸¥æ ¼å‡¸å‡½æ•°å¦‚æœåœ¨$(a,b)$å†…$fâ€™â€™(x) &lt; 0$ï¼Œåˆ™ç§°å‡½æ•°åœ¨$[a,b]$å†…ä¸ºä¸¥æ ¼å‡¹å‡½æ•°æ‹ç‚¹å‡½æ•°å‡¹å‡¸æ€§çš„åˆ†ç•Œç‚¹ç§°ä¸ºæ‹ç‚¹ï¼Œå¦‚æœå‡½æ•°äºŒé˜¶å¯å¯¼ï¼Œåˆ™åœ¨æ‹ç‚¹å¤„æœ‰$fâ€™â€™(x)=0$ï¼Œä¸”åœ¨æ‹ç‚¹å¤„ä¸¤ä¾§äºŒé˜¶å¯¼æ•°å€¼å¼‚å·å¯¹äºå‡½æ•°$f(x)=x^3$ï¼Œå…¶äºŒé˜¶å¯¼æ•°ä¸º$6x$ï¼Œ$0$ç‚¹å¤„äºŒé˜¶å¯¼æ•°å€¼ä¸º$0$ï¼Œä¸”åœ¨$0$ç‚¹ä¸¤ä¾§çš„äºŒé˜¶å¯¼æ•°å€¼å¼‚å·ï¼Œå› æ­¤$0$ä¸ºå…¶æ‹ç‚¹å‡¸å‡½æ•°æœ‰è‰¯å¥½çš„çš„æ€§è´¨ï¼Œå¯ä»¥ä¿è¯ä¼˜åŒ–ç®—æ³•æ‰¾åˆ°å‡½æ•°çš„æå°å€¼ç‚¹å¾®åˆ†ä¸­å€¼å®šç†å¾®åˆ†ä¸­å€¼å®šç†å»ºç«‹äº†å¯¼æ•°ä¸å‡½æ•°å€¼ä¹‹é—´çš„å…³ç³»ç½—å°”ä¸­å€¼å®šç†æ‹‰æ ¼æœ—æ—¥ä¸­å€¼å®šç†æŸ¯è¥¿ä¸­å€¼å®šç†å®šä¹‰ç½—å°”ä¸­å€¼å®šç†(Rolle Mean Value Theorem)æ˜¯æŒ‡å¦‚æœå‡½æ•°$f(x)$åœ¨é—­åŒºé—´$[a,b]$å†…è¿ç»­ï¼Œåœ¨å¼€åŒºé—´$(a,b)$å†…å¯å¯¼ï¼Œä¸”åœ¨åŒºé—´çš„ä¸¤ä¸ªç«¯ç‚¹å¤„çš„å€¼ç›¸ç­‰ï¼Œå³$f(a)=f(b)$ï¼Œåˆ™åœ¨åŒºé—´$[a,b]$å†…è‡³å°‘å­˜åœ¨ä¸€ç‚¹$\xi$ä½¿å¾—$fâ€™(\xi)=0$ä¸¾ä¸€ä¸ªç½—å°”ä¸­å€¼å®šç†çš„ç¤ºä¾‹: $f(x)=sin(x)$ï¼Œè€ƒè™‘é—´$[0,\pi]$ï¼Œæœ‰$f(0)=f(\pi)=0$ï¼Œå‡½æ•°åœ¨$x=\frac{\pi}{2}$å¤„æœ‰æå¤§å€¼ï¼Œæ˜¾ç„¶åœ¨è¯¥ç‚¹å¤„å¯¼æ•°å€¼ä¸º$0$ç”¨è´¹é©¬å®šç†è¯æ˜ç½—å°”ä¸­å€¼å®šç†å¦‚æœ$f(x)$åœ¨é—­åŒºé—´$[a,b]$å†…æ˜¯å¸¸æ•°ï¼Œåˆ™åœ¨è¯¥åŒºé—´å†…ä»»ä¸€ç‚¹å¤„éƒ½æœ‰$fâ€™(x)=0$å¦‚æœä¸ä¸ºå¸¸æ•°ï¼Œåˆ™å¿…å®šå­˜åœ¨æå¤§å€¼ç‚¹å’Œæå°å€¼ç‚¹ï¼Œæ ¹æ®è¿ç»­å‡½æ•°çš„æ€§è´¨ï¼Œæå¤§å€¼å’Œæå°å€¼ä¸­è‡³å°‘æœ‰ä¸€ä¸ªåŒºé—´$(a,b)$å†…å–å¾—ï¼Œåœ¨è¯¥ç‚¹å¤„æœ‰$fâ€™(x)=0$å‡ ä½•æ„ä¹‰å¯¹äºåŒºé—´ä¸¤ä¸ªç«¯ç‚¹å¤„çš„å‡½æ•°å€¼ç›¸ç­‰çš„å‡½æ•°ï¼Œåœ¨åŒºé—´å†…è‡³å°‘å­˜åœ¨ä¸€ç‚¹çš„å¯¼æ•°å€¼ä¸º$0$ï¼Œè¯¥ç‚¹å¤„çš„åˆ‡çº¿ä¸$x$è½´å¹³è¡Œå®šä¹‰æ‹‰æ ¼æœ—æ—¥ä¸­å€¼å®šç†(Lagrange Mean Value Theorem)æ˜¯æŒ‡å¦‚æœå‡½æ•°$f(x)$åœ¨é—­åŒºé—´$[a,b]$å†…è¿ç»­ï¼Œåœ¨å¼€åŒºé—´$(a,b)$å†…å¯å¯¼ï¼Œåˆ™åœ¨åŒºé—´$(a,b)$å†…è‡³å°‘å­˜åœ¨ä¸€ç‚¹$\xi$ä½¿å¾—è¿™æ˜¯ç½—å°”ä¸­å€¼å®šç†çš„æ¨å¹¿è¯æ˜æ„é€ è¾…åŠ©å‡½æ•°$g(x)=f(x)-\frac{f(b)-f(a)}{b-a}(x-a)$ï¼Œæ˜¾ç„¶æœ‰ä¸”$gâ€™(x)=fâ€™(x)-\frac{f(b)-f(a)}{b-a}$ï¼Œ$g(x)$æ»¡è¶³ç½—å°”ä¸­å€¼å®šç†å› æ­¤åœ¨$(a,b)$å†…è‡³å°‘å­˜åœ¨ä¸€ç‚¹$\xi$ä½¿å¾—$gâ€™(\xi)=fâ€™(\xi)-\frac{f(b)-f(a)}{b-a}=0$å…¶ç›´è§‚è§£é‡Šæ˜¯å°†å‡½æ•°å‡æ‰ä¸€ä¸ªçº¿æ€§å‡½æ•°ï¼Œæ„é€ å‡ºä¸¤ä¸ªç«¯ç‚¹çš„å€¼ç›¸ç­‰çš„å‡½æ•°ï¼Œä»¥æ»¡è¶³ç½—å°”ä¸­å€¼å®šç†çš„æ¡ä»¶å‡ ä½•æ„ä¹‰åŒºé—´$(a,b)$å†…è‡³å°‘å­˜åœ¨ä¸€ä¸ªç‚¹$\xi$ï¼Œåœ¨$(\xi,f(\xi))$å¤„çš„åˆ‡çº¿ä¸ä¸¤ç‚¹ä¹‹é—´çš„å‰²çº¿å¹³è¡Œï¼Œå³æ–œç‡ç›¸ç­‰è€ƒè™‘å‡½æ•°$f(x)=x^2$ï¼Œå®ƒç»è¿‡$(0,0)$ä¸$(1,1)$è¿™ä¸¤ä¸ªç‚¹ï¼Œå› æ­¤åœ¨åŒºé—´$(0,1)$å†…è‡³å°‘å­˜åœ¨æŸä¸€ç‚¹$\xi$ï¼Œä½¿å¾—$fâ€™(\xi)=\frac{f(1)-f(0)}{1-0}$ï¼Œåœ¨è¿™é‡Œ$\xi=0.5$ï¼Œåœ¨è¯¥ç‚¹å¤„åˆ‡çº¿ä¸ç»è¿‡$(0,0)$ä¸$(1,1)$è¿™ä¸¤ä¸ªç‚¹çš„å‰²çº¿å¹³è¡Œï¼Œå¦‚å›¾æ‰€ç¤ºç”¨æ‹‰æ ¼æœ—æ—¥ä¸­å€¼å®šç†è¯æ˜å‡½æ•°çš„ä¸€é˜¶å¯¼æ•°ä¸å…¶å•è°ƒæ€§çš„å…³ç³»å‡è®¾å‡½æ•°$f(x)$åœ¨$[a,b]$å†…è¿ç»­ï¼Œåœ¨$(a,b)$å†…å¯å¯¼ã€‚å¦‚æœåœ¨$(a,b)$å†…æ‰€æœ‰çš„ç‚¹å¤„å‡æœ‰$fâ€™(x)&gt;0$ï¼Œåˆ™å‡½æ•°åœ¨$[a,b]$å†…å•è°ƒé€’å¢å¯¹äºåŒºé—´å†…ä»»ä¸€çš„ç‚¹$x_1$ï¼Œ$x_2$ï¼Œå­˜åœ¨ä¸€ç‚¹$x_1 &lt; \xi &lt; x_2$ï¼Œä½¿å¾—$f(x_2)-f(x_1)=fâ€™(\xi)(x_2-x_1)$è¿™é‡Œ$fâ€™(\xi)&gt;0$ï¼Œç”±äº$x_10$å‡½æ•°å•è°ƒé€’å¢å¯¹äºå•è°ƒé€’å‡çš„æƒ…å†µå¯ä»¥ç”¨ç›¸åŒçš„æ–¹æ³•è¯æ˜å®šä¹‰å‡½æ•°$f(x)$å’Œ$g(x)$åœ¨$[a,b]$å†…è¿ç»­ï¼Œåœ¨$(a,b)$å†…å¯å¯¼ï¼Œä¸”å¯¹$\forall x \in (a,b)$æœ‰$gâ€™(x) \neq 0$ï¼Œåˆ™å­˜åœ¨$\xi \in (a,b)$ä½¿å¾—å€ŸåŠ©ç½—å°”ä¸­å€¼å®šç†è¯æ˜æ„é€ è¾…åŠ©å‡½æ•°$F(x)=f(x)-f(a)-\frac{f(b)-f(a)}{g(b)-g(a)}(g(x)-g(a))$ï¼Œæ˜¾ç„¶æœ‰$F(a)=F(b)=0$ä¸”$Fâ€™(x)=fâ€™(x)-\frac{f(b)-f(a)}{g(b)-g(a)}(gâ€™(x))$ï¼Œæ ¹æ®ç½—å°”ä¸­å€¼å®šç†ï¼Œå­˜åœ¨$\xi \in (a,b)$ä½¿å¾—$Fâ€™(\xi)=fâ€™(\xi)-\frac{f(b)-f(a)}{g(b)-g(a)}gâ€™(\xi)=0$å› æ­¤æŸ¯è¥¿ä¸­å€¼å®šç†æˆç«‹æ³°å‹’å…¬å¼å®šä¹‰å¦‚æœä¸€ä¸ªå‡½æ•°è¶³å¤Ÿå…‰æ»‘ä¸”åœ¨æŸç‚¹å‡ºå„é˜¶å¯¼æ•°å‡å­˜åœ¨ï¼Œæ³°å‹’å…¬å¼(Taylorâ€™s Formula)ä»¥è¯¥ç‚¹å¤„çš„å„é˜¶å¯¼æ•°ä½œä¸ºç³»æ•°ï¼Œæ„é€ å‡ºå¤šé¡¹å¼æ¥è¿‘ä¼¼å‡½æ•°åœ¨è¯¥ç‚¹é¢†åŸŸä¸­ä»»æ„ç‚¹å¤„çš„å‡½æ•°å€¼ï¼Œæ­¤å¤šé¡¹å¼ç§°ä¸ºæ³°å‹’å…¬å¼å¸¦çš®äºšè¯º(Peano)ä½™é¡¹çš„æ³°å‹’å…¬å¼å¸¦æ‹‰æ ¼æœ—æ—¥ä½™é¡¹çš„æ³°å‹’å…¬å¼æ ¹æ®å¾®åˆ†çš„å®šä¹‰ï¼Œå¦‚æœ$f(x)$åœ¨ç‚¹$a$å¤„å¯å¯¼ï¼Œå¯ç”¨ä¸€æ¬¡å‡½æ•°è¿‘ä¼¼ä»£æ›¿å‡½æ•°$f(x)$ï¼Œè¯¯å·®æ˜¯$x-a$çš„é«˜é˜¶æ— ç©·å°ä¸‹é¢å°†ä¸€æ¬¡å‡½æ•°æ¨å¹¿åˆ°æ›´é«˜æ¬¡çš„å¤šé¡¹å¼ï¼Œå¦‚æœå‡½æ•°$n$é˜¶å¯å¯¼ï¼Œåˆ™å¯ä»¥å»ºç«‹ä¸€ä¸ªå¦‚ä¸‹å½¢å¼çš„å¤šé¡¹å¼è¿‘ä¼¼ä»£æ›¿$f(x)$æ»¡è¶³$f(x)=A_0+A_1(x-a)+\cdots+A_n(x-a)^n+o((x-a)^n)$ï¼Œè¯¯å·®é¡¹æ˜¯$(x-a)^n$çš„é«˜é˜¶æ— ç©·å°ä¸‹é¢ç¡®å®šå¤šé¡¹å¼çš„ç³»æ•°ï¼Œé¦–å…ˆä»¤$x=a$ï¼Œå«æœ‰$x-a$å„é¡¹çš„å€¼å‡ä¸º$0$ï¼Œå¯ä»¥è§£å¾—$A_0=f(a)$æ¥ä¸‹æ¥å¯¹$f(x)$ä¸¤è¾¹åŒæ—¶æ±‚å¯¼å¾—$fâ€™(x)=A_1+2A_2(x-a)+\cdots +nA_n(x-a)^{n-1}+o((x-a)^{n-1})$ä»¤$x=a$ï¼Œå¯ä»¥è§£å¾—$A_1=fâ€™(a)$ä»¥æ­¤ç±»æ¨ï¼Œå¯¹$f(x)$ä¸¤è¾¹åŒæ—¶æ±‚$m$é˜¶å¯¼æ•°ï¼Œå¹¶ä»¤$x=a$ï¼Œå¯ä»¥è§£å¾—$A_m = fâ€™(a)$å› æ­¤æˆ‘ä»¬è¦æ‰¾çš„å¤šé¡¹å¼ä¸ºç§°ä¸ºæ³°å‹’å¤šé¡¹å¼(Taylor polynomial)ï¼Œç”±æ­¤å¾—åˆ°å¸¦çš®äºšè¯º(Peano)ä½™é¡¹çš„æ³°å‹’å…¬å¼å¦‚æœä»¤$\Delta x=x-a$ï¼Œæ³°å‹’å…¬å¼å¯ä»¥å†™æˆå¦‚æœå‡½æ•°$n+1$é˜¶å¯å¯¼ï¼Œå€ŸåŠ©æŸ¯è¥¿ä¸­å€¼å®šç†å¯ä»¥è¯æ˜æ³°å‹’å…¬å¼çš„å¦ä¸€ç§å½¢å¼ï¼Œç§°ä¸ºå¸¦æ‹‰æ ¼æœ—æ—¥ä½™é¡¹çš„æ³°å‹’å…¬å¼å…¶ä¸­$\theta \in (a,x)$ï¼Œä¸¤ç§æ³°å‹’å…¬å¼å¯ä»¥ç»Ÿä¸€å†™æˆå…¶ä¸­$R_n(x)$ç§°ä¸ºä½™é¡¹ï¼Œæ˜¯$(x-a)^n$çš„é«˜é˜¶æ— ç©·å°éº¦å…‹åŠ³æ—(Maclaurin)å…¬å¼å‡½æ•°åœ¨$x=0$ç‚¹å¤„çš„æ³°å‹’å…¬å¼ç§°ä¸ºéº¦å…‹åŠ³æ—(Maclaurin)å…¬å¼ï¼Œä¸ºå¦‚ä¸‹å½¢å¼ä¸‹é¢åˆ—å‡ºç»å…¸çš„éº¦å…‹åŠ³æ—å…¬å¼å‡½æ•°éº¦å…‹åŠ³æ—å…¬å¼$\frac {1}{1-x}$$1+x+x^2+ \cdots + x^n + o(x^n)$$e^x$$1+x+\frac {x^2}{2!}+\cdots +\frac {x^n}{n!}+o(x^n)$$sin(x)$$x-\frac {x^3}{3!}+ \cdots + \frac {(-1)^{n-1}}{(2n-1)!}x^{2n-1}+o(x^{2n-1})$$cos(x)$$1-\frac {x^2}{2!}+\frac {x^4}{4!}- \cdots +\frac {(-1)^n}{(2n)!}x^{2n}+o(x^{2n})$$ln(1+x)$$x-\frac {x^2}{2}+\frac {x^3}{3}- \cdots + \frac {(-1)^{n+1}}{n}x^n+o(x^n)$æ³°å‹’å…¬å¼å»ºç«‹äº†å¯å¯¼å‡½æ•°ä¸å…¶å„é˜¶å¯¼æ•°ä¹‹é—´çš„è”ç³»ï¼ŒåŒæ—¶ç”¨å¤šé¡¹å¼å¯¹å‡½æ•°è¿›è¡Œé€¼è¿‘å®ƒè¢«ç”¨äºå¯¹å‡½æ•°çš„åˆ†æä¸è®¡ç®—ï¼ŒåŒ…æ‹¬æ¢¯åº¦ä¸‹é™æ³•ã€ç‰›é¡¿æ³•ã€æ‹Ÿç‰›é¡¿æ³•ç­‰åˆ©ç”¨æ³°å‹’å…¬å¼å¯ä»¥è¯æ˜æå€¼åˆ¤åˆ«æ³•åˆ™å°†$f(x)$åœ¨$x_0$ç‚¹å¤„åšæ³°å‹’å±•å¼€ï¼Œå¦‚æœ$f^{(i)}(x_0)=0,i=1,\cdots, n-1$ï¼ŒåŒæ—¶$f^{(n)}(x_0) \neq 0$ï¼Œåˆ™æ³°å‹’å±•å¼€çš„ç»“æœä¸ºå¦‚æœ$n$ä¸ºå¶æ•°ï¼Œåˆ™åœ¨$x_0$çš„å»å¿ƒé¢†åŸŸå†…å¿½ç•¥é«˜é˜¶æ— ç©·å°ï¼Œæœ‰$f(x)-f(x_0)=\frac{f^n(x)(x_0)}{n!}(x-x_0)^n$ç”±äº$(x-x_0)^n &gt; 0$ï¼Œæ‰€ä»¥$\frac{f^{(n)}(x_0)}{n!}(x-x_0)^n$ä¸$\frac {f^{(n)}(x_0)}{n!}$ï¼Œæ€»ä¸ºæ­£æˆ–æ€»ä¸ºè´Ÿï¼Œå› $x_0$æ˜¯æå€¼ç‚¹å¦‚æœ$n$ä¸ºå¥‡æ•°ï¼Œåˆ™$\frac{f^n(x)(x_0)}{n!}(x-x_0)^n$åœ¨$x_0$çš„ä¸¤ä¾§å˜å·ï¼Œå› æ­¤$x_0$ä¸æ˜¯æå€¼ç‚¹ä¸å®šç§¯åˆ†ä¸å®šç§¯åˆ†æ˜¯ç§¯åˆ†å­¦çš„æ ¸å¿ƒæ¦‚å¿µï¼Œå¯çœ‹ä½œæ±‚å¯¼å’Œå¾®åˆ†çš„é€†è¿ç®—ï¼ŒåŒæ ·å°†ä¸€ä¸ªå‡½æ•°å˜æ¢æˆå¦å¤–ä¸€ä¸ªå‡½æ•°ï¼Œç§°ä¸ºåŸå‡½æ•°ä¸å®šç§¯åˆ†çš„å®šä¹‰å¯¹äºå®šä¹‰åœ¨åŒºé—´$[a,b]$å†…çš„å‡½æ•°$f(x)$ï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªåŒºé—´$(a,b)$å†…å¯å¯¼çš„å‡½æ•°$F(x)$ï¼Œå¯¹äºä»»æ„çš„$x \in (a,b)$å‡æœ‰$Fâ€™(x)=f(x)$åˆ™ç§°$F(x)$æ˜¯$f(x)$çš„ä¸€ä¸ªåŸå‡½æ•°ï¼Œä¹Ÿç§°ä¸ºä¸å®šç§¯åˆ†ä¸å®šç§¯åˆ†æ˜¯æ±‚å¯¼å’Œå¾®åˆ†çš„é€†è¿ç®—ï¼Œè®°ä¸º$\int f(x)dx $ï¼Œæ„ä¸ºæ±‚å’Œ(sum)å¦‚æœ$F(x)$æ˜¯$f(x)$çš„ä¸€ä¸ªåŸå‡½æ•°ï¼Œåˆ™$F(x)+C$ä¹Ÿæ˜¯$f(x)$çš„åŸå‡½æ•°ï¼Œå…¶ä¸­$C$ä¸ºä»»æ„å¸¸æ•°å› æ­¤ä¸å®šç§¯åˆ†ä¸åŸå‡½æ•°çš„å…³ç³»ä¸ºï¼š$\int f(x)dx=F(x)+C$è¿™æ˜¯å› ä¸º$(F(x)+C)â€™=Fâ€™(x)=f(x)$å¦‚æœå‡½æ•°$f(x)$çš„åŸå‡½æ•°å­˜åœ¨ï¼Œåˆ™ç§°å…¶å¯ç§¯ï¼Œå¦‚æœå‡½æ•°åœ¨åŒºé—´$[a,b]$å†…è¿ç»­ï¼Œåˆ™å…¶åŸå‡½æ•°å­˜åœ¨ï¼Œè¿ç»­æ˜¯å¯ç§¯çš„å……åˆ†æ¡ä»¶ä¸€åˆ‡åˆç­‰å‡½æ•°åœ¨å…¶å®šä¹‰åŸŸå†…éƒ½æ˜¯è¿ç»­çš„ï¼Œå› æ­¤éƒ½æ˜¯å¯ç§¯çš„å¯¹äºå‡½æ•°$f(x)=x^2$å…¶ä¸å®šç§¯åˆ†ä¸º$\int x^2dx=\frac{1}{3}x^3+C$å¯¹äºå¸¸æ•°å‡½æ•°$f(x)=c$ï¼Œ ä¸å®šç§¯åˆ†ä¸ºçº¿æ€§å‡½æ•°(ä¸€æ¬¡å‡½æ•°)$\int cdx = cx+C$ä¸å®šç§¯åˆ†çš„æ€§è´¨å¯¹äºåŠ æ³•è¿ç®—å¯¹äºä¹˜æ³•è¿ç®—å…¶ä¸­$k$æ˜¯ä¸ªå¸¸æ•°ï¼Œè¿™äº›ç»“è®ºå¯ä»¥æ ¹æ®æ±‚å¯¼å…¬å¼å¾—åˆ°è®¡ç®—$\int tan^2(x)dx$æ ¹æ®ä¸‰è§’å‡½æ•°ä¹‹é—´çš„å…³ç³»æœ‰è®¡ç®—$\int \frac{1}{(x-a)(x-b)}dx$å¯¹åˆ†å¼è¿›è¡Œæ‹†åˆ†ï¼Œå¯ä»¥å¾—åˆ°åŸºæœ¬å‡½æ•°çš„ç§¯åˆ†å…¬å¼å‡½æ•°ç§¯åˆ†å…¬å¼å¸¸æ•°å‡½æ•°$\int a dx = ax+C $å¹‚å‡½æ•°$\int x^a dx = \frac {1}{a+1}x^{a+1}+C, a \neq -1$å¹‚å‡½æ•°$\int \frac {1}{x} dx = ln \vert x \vert +C$æŒ‡æ•°å‡½æ•°$\int e^x dx = e^x+C $æŒ‡æ•°å‡½æ•°$\int a^x dx = \frac {1}{ln(a)}a^x+C,a&gt;0,a \neq1$ä¸‰è§’å‡½æ•°$\int sin(x) dx = -cos(x)+C$ä¸‰è§’å‡½æ•°$\int cos(x) dx = sin(x) + C$ä¸‰è§’å‡½æ•°$\int tan(x)dx = -ln \vert cos(x) \vert +C $ä¸‰è§’å‡½æ•°$\int cot(x)dx = ln \vert sin(x) \vert +C$ä¸‰è§’å‡½æ•°$\int \frac{1}{cos^2(x)} dx = tan(x)+C$ä¸‰è§’å‡½æ•°$\int \frac{1}{sin^2(x)} dx = -cot(x)+C$åä¸‰è§’å‡½æ•°$\int \frac {1}{\sqrt{1-x^2}}dx = arcsin(x) + C = -arccos(x) + C$åä¸‰è§’å‡½æ•°$\int \frac {1}{1+x^2}dx = arctan(x)+C$æ¢å…ƒç§¯åˆ†æ³•ä¹‹å‡‘å¾®åˆ†æ³•æ¢å…ƒç§¯åˆ†æ³•ä¹‹å˜é‡æ›¿æ¢æ³•åˆ†éƒ¨ç§¯åˆ†æ³•æ¢å…ƒæ³•åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼Œç¬¬ä¸€ç§ç§°ä¸ºå‡‘å¾®åˆ†æ³•ï¼Œä¹Ÿç§°ä¸ºç¬¬ä¸€ç±»æ¢å…ƒæ³•æ ¹æ®å¤åˆå‡½æ•°æ±‚å¯¼å…¬å¼æœ‰$(F(u(x)))â€™=Fâ€™(u(x))uâ€™(x)$ï¼Œå¦‚æœæœ‰$(F(u(x)))â€™=f(u(x))uâ€™(x)$æ ¹æ®ä¸å®šç§¯åˆ†çš„å®šä¹‰å¯ä»¥å¾—åˆ°$\int f(u(x))uâ€™(x)dx=F(u(x))$ï¼Œç”±äº$\int f(u)dx=F(u)$ï¼Œå› æ­¤æœ‰è¿™ç§æ–¹æ³•çš„å…³é”®æ˜¯å°†è¢«ç§¯å‡½æ•°å†™æˆä¸€ä¸ªå‡½æ•°$f(u(x))$ä¸å¦ä¸€ä¸ªå‡½æ•°çš„å¯¼æ•°$uâ€™(x)$çš„ä¹˜ç§¯è®¡ç®—ä¸å®šç§¯åˆ†$\int x cos(x^2+1)dx$è¿™ç§æ–¹æ³•çš„å…³é”®æ˜¯â€å‡‘å‡ºâ€æ‰€éœ€è¦çš„å¤åˆå‡½æ•°çš„å¾®åˆ†ï¼Œè¿™é‡Œå‡‘å‡º$x^2+1$è®¡ç®—ä¸å®šç§¯åˆ†$\int x e^{x^2}dx$ç¬¬äºŒç§æ¢å…ƒæ³•ç§°ä¸ºå˜é‡æ›¿æ¢æ³•ï¼ŒåŒæ ·æ ¹æ®å¤åˆå‡½æ•°çš„æ±‚å¯¼å…¬å¼æ±‚å‡ºå¯¹äºä¸å®šç§¯åˆ†$\int f(x)dx$ï¼Œä»¤$x=u(t)$ï¼Œå¦‚æœ$u(t)$åœ¨åŒºé—´$I$å†…å•è°ƒä¸”å¯å¯¼ï¼Œåå‡½æ•°$t=u^{-1}(x)$å­˜åœ¨ï¼Œåˆ™æœ‰$\int f(x)dx = \int f(u(t))du(t)$åœ¨å³ä¾§ç§¯å‡ºä¹‹åï¼Œç”¨$t=u^{-1}(x)$å°†$t$æ›¿æ¢å›$x$å³å¯è®¡ç®—ç§¯åˆ†$\int \frac {1}{1+\sqrt(x)} dx$è¿™é‡Œä¸»è¦å›°éš¾æ˜¯$\sqrt{x}$ï¼Œå› æ­¤ä»¤$t= \sqrt {x}$ï¼Œåˆ™æœ‰$x=t^2$ï¼Œä»è€Œæœ‰è®¡ç®—ç§¯åˆ†$\int arcsin(x)dx$ä»¤$t=arcsin(x)$ï¼Œåˆ™$x=sin(t)$ï¼Œä»è€Œæœ‰è¿™é‡Œçš„ç¬¬äºŒæ­¥ç”¨äº†åˆ†éƒ¨ç§¯åˆ†æ³•è®¡ç®—ç§¯åˆ†$\int \sqrt {a^2-x^2}dx$ä»¤$x=asin(t)$ï¼Œåˆ©ç”¨å€è§’å…¬å¼æœ‰æ¢å…ƒæ³•çš„æ ¸å¿ƒæ˜¯ç¡®å®šè¦æ›¿æ¢çš„éƒ¨åˆ†åˆ†éƒ¨ç§¯åˆ†æ³•ç”±ä¹˜æ³•æ±‚å¯¼å…¬å¼å¯¼å‡ºï¼Œæ ¹æ®ä¹˜æ³•çš„æ±‚å¯¼å…¬å¼$(f(x)g(x))â€™ = fâ€™(x)g(x) + f(x)gâ€™(x)$ï¼Œå˜å½¢åå¾—åˆ°$f(x)gâ€™(x) = (f(x)g(x))â€™ - fâ€™(x)g(x)$ï¼Œä¸¤è¾¹åŒæ—¶æ±‚ç§¯åˆ†å¾—åˆ°è®¡ç®—$\int x^2cos(x)dx$åˆç­‰å‡½æ•°æ˜¯ç”±å¹‚å‡½æ•°ã€æŒ‡æ•°å‡½æ•°ã€å¯¹è§’å‡½æ•°ã€ä¸‰è§’å‡½æ•°ã€åä¸‰è§’å‡½æ•°ä¸å¸¸æ•°ç»è¿‡æœ‰é™æ¬¡æœ‰ç†è¿ç®—åŠæœ‰é™æ¬¡å¤åˆæ‰€äº§ç”Ÿï¼Œå¹¶ä¸”èƒ½ç”¨ä¸€ä¸ªè§£æå¼è¡¨ç¤ºçš„å‡½æ•°ï¼Œå› æ­¤åˆç­‰å‡½æ•°çš„å¯¼æ•°ä»æ˜¯åˆç­‰å‡½æ•°ï¼Œä½†åˆç­‰å‡½æ•°çš„åŸå‡½æ•°ä¸ä¸€å®šæ˜¯åˆç­‰å‡½æ•°ä¾‹å¦‚$e^{-x^2}$ã€$\frac {sin(x)}{x}$ã€$\frac {1}{ln(x)}$è¿™äº›å‡½æ•°çš„ä¸å®šç§¯åˆ†éƒ½æ— æ³•å¾—åˆ°è§£æè¡¨è¾¾å¼åˆ˜ç»´å°”å®šç†ä¹‹å¤„ï¼Œä¸€ä¸ªåˆç­‰å‡½æ•°å¦‚æœæœ‰åˆç­‰çš„åŸå‡½æ•°ï¼Œåˆ™å®ƒä¸€å®šèƒ½å†™æˆåŒä¸€ä¸ªå¾®åˆ†åŸŸçš„å‡½æ•°åŠ ä¸Šè¯¥åŸŸä¸Šå‡½æ•°çš„å¯¹æ•°çš„çº¿æ€§ç»„åˆï¼Œå¦åˆ™ä¸å­˜åœ¨åˆç­‰çš„åŸå‡½æ•°åœ¨pythonä¸­ï¼Œç¬¦å·è®¡ç®—åº“sympyæä¾›äº†è®¡ç®—ä¸å®šç§¯åˆ†çš„åŠŸèƒ½ï¼Œç”±å‡½æ•°integrateå®ç°123456from sympy import *x = symbols('x')r = integrate(cos(x), x)print(r)&gt;&gt;&gt;&gt; sin(x)  # è¿™é‡Œå¿½ç•¥å¸¸æ•°Cå®šç§¯åˆ†å®šç§¯åˆ†çš„å®šä¹‰ä¸æ€§è´¨å®šä¹‰å®šç§¯åˆ†å°†å‡½æ•°æ˜ å°„æˆå®æ•°ï¼Œæ˜¯å’Œå¼çš„æé™ï¼Œå®ƒæœ€åˆç”¨äºè§£å†³å‡ ä½•ç‰©ç†é—®é¢˜ï¼Œå¦‚è®¡ç®—å‡½æ•°æ›²çº¿å›´æˆçš„é¢ç§¯ã€æ›²çº¿é•¿åº¦ã€è¿åŠ¨ç‰©ä½“çš„ä½ç§»ç­‰å¸¸è§çš„æœ‰é»æ›¼ç§¯åˆ†å’Œå‹’è´æ ¼ç§¯åˆ†ï¼Œè¿™é‡Œåªä»‹ç»å‰è€…ï¼Œä¹Ÿå°±æ˜¯é€šå¸¸æ‰€è¯´çš„å®šç§¯åˆ†ï¼Œå‹’è´æ ¼ç§¯åˆ†çŸ¥è¯†å¯ä»¥é˜…è¯»å®å˜å‡½æ•°æ•™æå‡½æ•°$f(x)$åœ¨åŒºé—´$[a,b]$ä¸Šçš„å®šç§¯åˆ†æ˜¯ä¸‹é¢çš„æé™è¿™é‡Œç”¨ä¸€ç³»åˆ—ç‚¹å°†åŒºé—´$ [a,b] $åˆ’åˆ†æˆ$ n $åˆ†ï¼Œç¬¬$ i $ä»½çš„åŒºé—´é•¿åº¦ä¸ºï¼Œä¸ºç¬¬$i$ä¸ªåŒºé—´å†…ä»»æ„ä¸€ç‚¹åªè¦åˆ’åˆ†çš„è¶³å¤Ÿç»†ä¸”å‡½æ•°$f(x)$æ»¡è¶³ä¸€å®šçš„æ¡ä»¶ï¼Œåˆ™å¼ä¸­çš„æé™å­˜åœ¨ï¼Œå¼ä¸­çš„å®šç§¯åˆ†è®°ä¸º$\int _a^b{f(x)dx}$è‹¥å¼ä¸­çš„æé™å­˜åœ¨ï¼Œåˆ™ç§°å‡½æ•°åœ¨åŒºé—´$[a,b]$å†…å¯ç§¯å‡ ä½•æ„ä¹‰å®šç§¯åˆ†çš„å‡ ä½•æ„ä¹‰æ˜¯å‡½æ•°åœ¨æŸä¸€åŒºé—´ä¸Šä¸æ¨ªè½´å›´åŸçš„åŒºåŸŸé¢ç§¯åœ¨è®¡ç®—æ—¶é‡‡ç”¨é€æ­¥é€¼è¿‘å–æé™çš„æ–¹æ³•ï¼Œå³ä¾§çš„å’Œè®°ä¸ºçŸ©å½¢æ¡çš„é¢ç§¯ä¹‹å’ŒçŸ©å½¢çš„å®½åº¦ä¸ºï¼Œé«˜åº¦ä¸ºå†…ä»»æ„ä¸€ç‚¹çš„å‡½æ•°å€¼$f(\xi _i)$å®šç§¯åˆ†å­˜åœ¨æ¡ä»¶å®šç§¯åˆ†å­˜åœ¨æ¡ä»¶æ˜¯å‡½æ•°å‡ ä¹å¤„å¤„è¿ç»­ï¼Œä¸è¿ç»­ç‚¹çš„æµ‹åº¦ä¸º$0$ç›´è§‚çš„è§£é‡Šæ˜¯ä¸è¿ç»­ç‚¹çš„ç»“åˆæ˜¯æœ‰é™é›†æˆ–æ— é™å¯æ•°é›†æ ¹æ®å®šç§¯åˆ†å®šä¹‰è®¡ç®—$\int _0 ^1 {x^2 dx}$åˆ©ç”¨ä¸‹é¢çš„å…¬å¼å°†åŒºé—´$[0,1]$ç­‰åˆ†ä¸º$n$ä»½ï¼Œ$\Delta x_i = \frac {1}{n}$ï¼Œæ ¹æ®å®šç§¯åˆ†çš„å®šä¹‰æœ‰ç›´æ¥æ ¹æ®å®šä¹‰æ¥è®¡ç®—å®šç§¯åˆ†æ˜¯ç¹çå›°éš¾çš„ï¼Œåé¢ä¼šä½¿ç”¨ç‰›é¡¿-è±å¸ƒå°¼èŒ¨å…¬å¼æ¥è®¡ç®—å®šç§¯åˆ†æ€§è´¨å‡è®¾å‡½æ•°$f(x)$å’Œ$g(x)$åœ¨åŒºé—´$[a,b]$å†…å¯ç§¯ï¼Œ$\lambda$æ˜¯ä¸€ä¸ªå¸¸æ•°ï¼Œåˆ™$f(x)+g(x)$ä¸$\lambda f(x)$åœ¨åŒºé—´$[a,b]$å†…ä¹Ÿå¯ç§¯ï¼Œä¸”æœ‰å®šç§¯åˆ†å…·æœ‰çº¿æ€§çš„æ€§è´¨åŒºé—´å¯åŠ æ€§ç§¯åˆ†ä¸Šä¸‹é™é¢ å€’ï¼Œç§¯åˆ†å€¼å–è´Ÿå·ç‰›é¡¿-è±å¸ƒå°¼èŒ¨å…¬å¼ç‰›é¡¿-è±å¸ƒå°¼èŒ¨(Newton-Leibniz)å…¬å¼ç›´æ¥æ ¹æ®å®šä¹‰æ¥è®¡ç®—å®šç§¯åˆ†æ˜¯ç¹çå›°éš¾çš„ï¼Œæ›´é«˜æ•ˆçš„æ–¹æ³•æ˜¯åˆ©ç”¨å¾®ç§¯åˆ†åŸºæœ¬å®šç†ï¼Œå³ç‰›é¡¿-è±å¸ƒå°¼èŒ¨å…¬å¼æ¥è®¡ç®—ç‰›é¡¿-è±å¸ƒå°¼èŒ¨å…¬å¼å»ºç«‹äº†å®šç§¯åˆ†ä¸åŸå‡½æ•°ä¹‹é—´çš„å…³ç³»å¦‚æœå‡½æ•°$f(x)$åœ¨åŒºé—´$[a,b]$å†…å¯ç§¯ï¼Œåˆ™åœ¨æ­¤åŒºé—´å†…å®šç§¯åˆ†çš„å€¼ç­‰äºå…¶åŸå‡½æ•°åœ¨åŒºé—´ä¸¤ä¸ªç«¯ç‚¹å¤„å‡½æ•°å€¼ä¹‹å·®å…¶ä¸­$F(x)$æ˜¯$f(x)$çš„ä¸€ä¸ªåŸå‡½æ•°ï¼Œé€šå¸¸å°†$F(b)-F(a)$è®°ä¸º$F(x)|_{a}^{b}$ï¼Œè¯¥å…¬å¼ä¹Ÿå¯ä»¥å†™æˆå¯ä»¥ç”¨æ‹‰æ ¼æœ—æ—¥ä¸­å€¼å®šç†è¯æ˜è¯¥å®šç†ï¼Œæ ¹æ®å®šç§¯åˆ†çš„å®šä¹‰æœ‰è¿™ä¸€å®šç†ä¸ºè®¡ç®—å®šç§¯åˆ†æä¾›äº†ç»Ÿä¸€çš„ä¾æ®ï¼Œæ˜¯å¾®ç§¯åˆ†ä¸­æœ€é‡è¦çš„ç»“è®ºåªéœ€è®¡ç®—åŸå‡½æ•°ï¼Œç„¶åå³å¯æ ¹æ®åŸå‡½æ•°çš„å€¼è®¡ç®—ä»»æ„åŒºé—´ä¸Šçš„å®šç§¯åˆ†è®¡ç®—å®šç§¯åˆ†$\int _{0}^{\pi}{sin(x)dx} = -cos(x)| _0^{\pi} = 2$åœ¨pythonä¸­æä¾›äº†è®¡ç®—å®šç§¯åˆ†çš„åŠŸèƒ½ï¼Œæœ‰integrateæ”¯æŒ123456from sympy import *x = symbols('x')r = integrate(cos(x), x, -pi, pi)print(r)&gt;&gt;&gt;&gt; 0å®šç§¯åˆ†çš„è®¡ç®—å®šç§¯åˆ†çš„è®¡ç®—å¯ä»¥å€ŸåŠ©ç‰›é¡¿-è±å¸ƒå°¼èŒ¨å…¬å¼å®Œæˆï¼Œå› æ­¤é—®é¢˜çš„æ ¸å¿ƒæ˜¯è®¡ç®—ä¸å®šç§¯åˆ†ï¼ŒåŒæ ·å¯ä»¥ä½¿ç”¨æ¢å…ƒæ³•å’Œåˆ†éƒ¨ç§¯åˆ†æ³•æ¢å…ƒç§¯åˆ†æ³•ä¹‹å‡‘å¾®åˆ†æ³•æ¢å…ƒç§¯åˆ†æ³•ä¹‹å˜é‡æ›¿æ¢æ³•åˆ†éƒ¨ç§¯åˆ†æ³•ç¬¬ä¸€ç±»æ¢å…ƒæ³•é€šè¿‡å‡‘å¾®åˆ†æ³•å¾—åˆ°åŸå‡½æ•°ï¼Œåœ¨è®¡ç®—å®šç§¯åˆ†æ—¶ï¼Œç›´æ¥ç§¯åˆ†ä¸Šä¸‹é™å¸¦å…¥åŸå‡½æ•°å³å¯å¾—åˆ°ç»“æœï¼Œç¬¬äºŒç±»æ¢å…ƒæ³•ï¼Œç”±äºè¿›è¡Œäº†å˜é‡æ›¿æ¢ï¼Œå› æ­¤ç§¯åˆ†ä¸Šä¸‹é™è¦è¿›è¡Œç›¸åº”çš„å˜æ¢å‡è®¾å‡½æ•°$f(x)$åœ¨åŒºé—´$[a,b]$å†…å¯ç§¯ï¼Œä»¤$x = \varphi (t)$æ˜¯ä¸€ä¸ªå•è°ƒå‡½æ•°ï¼Œä¸”$\varphi (\alpha) = a, \varphi (\beta) = b$ï¼Œå¯¹äºç¬¬äºŒç±»æ¢å…ƒæ³•æœ‰æˆ–è€…å†™æˆç”¨æ¢å…ƒæ³•è®¡ç®—$\int _{0}^{1}{\sqrt {1-x^2} dx}$å¦‚æœä»¤$x=sin(t)$ï¼Œåˆ™æœ‰è¿™æ°å¥½æ˜¯$\frac {1}{4}$çš„å•ä½å…ƒçš„é¢ç§¯å¯¹äºå®šç§¯åˆ†ï¼Œå…¶åˆ†éƒ¨ç§¯åˆ†æ³•ä¸ºç”¨åˆ†éƒ¨ç§¯åˆ†æ³•è®¡ç®—ä¾‹å­é‡è¦ç»“è®ºï¼Œè¯¥ç»“è®ºåœ¨æ¬§æ‹‰-æ‹‰æ ¼æœ—æ—¥æ–¹ç¨‹æ¨å¯¼ä¸­ä½¿ç”¨å‡è®¾å‡½æ•°$f(x)$åœ¨åŒºé—´$[a,b]$å†…è¿ç»­ï¼Œå‡½æ•°$\eta (x)$æ»¡è¶³ç«¯ç‚¹å€¼çº¦æŸæ¡ä»¶$\eta (a) = \eta (b) = 0$ï¼Œå¦‚æœå¯¹ä»»æ„$\eta (x)$éƒ½æœ‰åˆ™$f(x) \equiv 0$è¿™é‡Œç”¨åè¯æ³•è¯æ˜ï¼Œå‡è®¾å‡½æ•°$f(x)$ä¸æ’ä¸º$0$ï¼Œç”±äº$\eta (x)$æ˜¯æ»¡è¶³ç«¯ç‚¹å€¼çº¦æŸçš„ä»»æ„å‡½æ•°ï¼Œå¯ä»¥ä»¤$\eta (x) = -f(x)(x-a)(x-b)$æ˜¾ç„¶æ­¤å‡½æ•°æ»¡è¶³ç«¯ç‚¹å€¼çº¦æŸæ¡ä»¶ï¼Œä¸”åœ¨$(a,b)$å†…$-(x-a)(x-b) &gt; 0$å› æ­¤æœ‰è¿™ç»“è®ºä¸ä¸Šå¼ï¼Œå› æ­¤ç»“è®ºæˆç«‹å˜ä¸Šé™ç§¯åˆ†å®šä¹‰å˜ä¸Šé™ç§¯åˆ†å‡½æ•°æ˜¯ä»¥ç§¯åˆ†ä¸Šé™ä¸ºè‡ªå˜é‡çš„å®šç§¯åˆ†å¯¹åº”çš„å‡½æ•°å‡è®¾å‡½æ•°åœ¨åŒºé—´å†…å¯ç§¯ï¼Œï¼Œåˆ™å˜ä¸Šé™ç§¯åˆ†çš„å®šä¹‰ä¸ºå¦‚æœæ˜¯çš„ä¸€ä¸ªåŸå‡½æ•°ï¼Œæ ¹æ®ç‰›é¡¿-è±å¸ƒå°¼èŒ¨å…¬å¼æœ‰å˜ä¸Šé™ç§¯åˆ†å‡½æ•°æ˜¯è¢«ç§¯åˆ†å‡½æ•°çš„ä¸€ä¸ªåŸå‡½æ•°ï¼Œæ¦‚ç‡è®ºä¸­è¿ç»­å‹éšæœºå˜é‡çš„åˆ†å¸ƒå‡½æ•°æ˜¯å…¸å‹çš„å˜ä¸Šé™ç§¯åˆ†å‡è®¾ï¼Œåˆ™å˜ä¸Šé™ç§¯åˆ†å¯¹åº”çš„å‡½æ•°ä¸ºè¯æ˜: å¦‚æœå‡½æ•°åœ¨åŒºé—´å†…è¿ç»­ï¼Œåˆ™å˜ä¸Šé™ç§¯åˆ†æ˜¯å¯å¯¼çš„ï¼Œä¸”å…¶å¯¼æ•°ä¸ºå‡è®¾æ˜¯çš„ä¸€ä¸ªåŸå‡½æ•°ï¼Œåˆ™æœ‰æ¯”å¦‚å˜ä¸Šé™ç§¯åˆ†å…¶å¯¼æ•°ä¸ºè€ƒè™‘å˜ä¸Šé™ç§¯åˆ†çš„å¤åˆå‡½æ•°å¯¹äºå˜ä¸Šé™ç§¯åˆ†ï¼Œæ ¹æ®å¤åˆå‡½æ•°çš„æ±‚å¯¼å…¬å¼ï¼Œå…¶å¯¼æ•°ä¸ºæ¯”å¦‚è®¡ç®—å˜ä¸Šé™ç§¯åˆ†çš„å¯¼æ•°å€¼ï¼Œæ ¹æ®ä¸Šé¢å…¬å¼å¯ä»¥å¾—åˆ°å®šç§¯åˆ†çš„åº”ç”¨å®šç§¯åˆ†å¯ä»¥ç”¨äºè®¡ç®—æŸäº›å‡ ä½•é‡å’Œç‰©ç†é‡ï¼ŒåŒ…æ‹¬æ›²çº¿æ‰€å›´æˆçš„é¢ç§¯ã€æ›²çº¿çš„é•¿åº¦ã€è¿åŠ¨ç‰©ä½“çš„ä½ç§»ã€å˜åŠ›çš„åšåŠŸç­‰æ›²çº¿é¢ç§¯æ›²çº¿å¼§é•¿å‡½æ•°åœ¨åŒºé—´å†…çš„ç§¯åˆ†å€¼ä¸ºå…¶ä»£æ•°é¢ç§¯ï¼Œå³ä»¥$[a,b]$åŒºé—´çš„ä¸¤ä¸ªç«¯ç‚¹ã€$x$è½´ã€å‡½æ•°æ›²çº¿å›´åŸçš„å°é—­åŒºåŸŸçš„é¢ç§¯ï¼Œå¸¦æœ‰æ­£è´Ÿå·ç­‰ä»·äºå®šç§¯åˆ†$ \int _a^b f(x)dx $è®¡ç®—æ¤­åœ†$ \frac {x^2}{a^2} + \frac {y^2}{b^2} = 1$çš„é¢ç§¯ç”±äºæ¤­åœ†æ˜¯å¯¹ç§°çš„ï¼Œå› æ­¤è®¡ç®—å‡ºå®ƒåœ¨çš„ç¬¬ä¸€è±¡é™å†…çš„é¢ç§¯ï¼Œç„¶åä¹˜ä»¥4ï¼Œå³å¯å¾—åˆ°æ•´ä¸ªæ¤­åœ†çš„é¢ç§¯ä»¤$x=asin(t)$ï¼Œåˆ©ç”¨å€è§’å…¬å¼æœ‰å‡è®¾æœ‰åŒºé—´$[a,b]$å†…å¯ç§¯å‡½æ•°$f(x)$ä¸$g(x)$ï¼Œåˆ™ç”±æ›²çº¿$x=a$ã€$x=b$ä»¥åŠè¿™ä¸¤æ¡æ›²çº¿æ‰€å›´æˆçš„åŒºåŸŸé¢ç§¯ä¸º$\int _a^b (f(x)-g(x))dx$æ¯”å¦‚è®¡ç®—æŠ›ç‰©çº¿$y=x^2$ä¸ç›´çº¿$y=x$æ‰€å›´æˆçš„åŒºåŸŸé¢ç§¯ï¼ŒæŠ›ç‰©çº¿ä¸ç›´çº¿äº¤ç‚¹ä¸º$(0,0)$å’Œ$(1,1)$ï¼Œå› æ­¤å›´æˆçš„åŒºåŸŸé¢ç§¯ä¸ºè€ƒè™‘ç›´è§’åæ ‡ç³»çš„æƒ…å†µè®¡ç®—$f(x)$åœ¨åŒºé—´$[a,b]$å†…çš„å¼§é•¿ï¼Œè¿™å¯ä»¥é€šè¿‡æŠ˜çº¿é€¼è¿‘å‡½æ•°çš„æ›²çº¿ã€ç´¯åŠ æŠ˜çº¿çš„é•¿åº¦å¾—åˆ°ï¼Œå…¶ä¸­å®çº¿ä¸ºè®¡ç®—é•¿åº¦çš„æ›²çº¿ï¼Œè™šçº¿æ˜¯ç”¨æŠ˜çº¿å¯¹æ›²çº¿è¿›è¡Œè¿‘ä¼¼çš„ç»“æœï¼Œå½“åˆ’åˆ†å¾—è¶³å¤Ÿç»†çš„æ—¶å€™ï¼Œè¿™äº›æŠ˜çº¿çš„é•¿åº¦ä¹‹å’Œçš„æé™å°±æ˜¯æ›²çº¿çš„å¼§é•¿ï¼Œç”¨ç”µï¼ŒåŒºé—´å†…çš„æŠ˜çº¿é•¿åº¦ä¸ºä»¤ç‚¹$M_i = (x_i, y_i)$ï¼Œåˆ™æ›²çº¿çš„å¼§é•¿ä¸ºå¦‚ä¸‹çš„æé™ç”±æ­¤å¾—åˆ°æ›²çº¿åœ¨åŒºé—´$[a,b]$å†…çš„å¼§é•¿ä¸ºå¦‚ä¸‹çš„å®šç§¯åˆ†è®¡ç®—æ›²çº¿$y= \frac {2}{3}x^{\frac {3}{2}}$åœ¨åŒºé—´$[1,2]$å†…çš„å¼§é•¿è®¡ç®—å•ä½åœ†$x^2+y^2=1$çš„å‘¨é•¿ï¼Œç”±äºåœ†æ˜¯å¯¹ç§°çš„ï¼Œå› æ­¤åªéœ€è®¡ç®—ç¬¬ä¸€è±¡é™å³å¯ï¼Œç¬¬ä¸€è±¡é™çš„æ›²çº¿ä¸º$y=\sqrt {1-x^2}$è€ƒè™‘å‚æ•°æ–¹ç¨‹çš„æƒ…å†µæ›²çº¿çš„å‚æ•°æ–¹ç¨‹ä¸º$x = \varphi (t) \qquad y = \psi (t)$ï¼Œå…¶ä¸­$t \in [\alpha, \beta]$å‡è®¾$\varphi (t)$å’Œ$\psi (t)$åœ¨è¯¥åŒºé—´ä¸Šè¿ç»­å¯å¯¼ï¼Œåˆ™å¼§é•¿å…ƒä¸ºä»è€Œå¾—åˆ°å¼§é•¿çš„è®¡ç®—å…¬å¼ä¸ºè®¡ç®—æ˜Ÿå½¢çº¿çš„å¼§é•¿ï¼Œå…¶å‚æ•°æ–¹ç¨‹ä¸º$ x = a cos^3(t) \qquad y = a sin^3(t)$ç”±äºæ˜Ÿå½¢çº¿çš„å½¢çŠ¶æ˜¯å¯¹ç§°çš„ï¼Œå› æ­¤åªéœ€è®¡ç®—ç¬¬ä¸€è±¡é™çš„æ›²çº¿å¼§é•¿å³å¯å¹¿ä¹‰ç§¯åˆ†å®šä¹‰å¹¿ä¹‰ç§¯åˆ†(Improper Integral)æ˜¯å®šç§¯åˆ†çš„æ¨å¹¿ï¼Œä¹Ÿç§°ä¸ºåå¸¸ç§¯åˆ†æ— ç©·ç§¯åˆ†(æ— ç©·é™å¹¿ä¹‰ç§¯åˆ†)ï¼šç§¯åˆ†åŒºé—´ä¸ºæ— é™ç‘•ç§¯åˆ†(æ— ç•Œå‡½æ•°çš„å¹¿ä¹‰ç§¯åˆ†)ï¼šç§¯åˆ†åŒºé—´æœ‰é™ä½†è¢«ç§¯åˆ†å‡½æ•°æ— ç•Œæ— ç©·ç§¯åˆ†ç‘•ç§¯åˆ†æ­¤æ—¶å¯ä»¥ä½¿ç”¨ç‰›é¡¿-è±å¸ƒå°¼èŒ¨å…¬å¼çš„æ¨å¹¿ï¼Œå‡½æ•°$f(x)$åœ¨$[a, + \infty]$å†…æœ‰å®šä¹‰ä¸”è¿ç»­ï¼Œ$F(x)$æ˜¯åŸå‡½æ•°ï¼Œå¦‚æœä¸‹é¢çš„æé™å­˜åœ¨åˆ™æœ‰å¯¹äºå‡½æ•°$f(x) = e ^{-x}$ï¼Œåœ¨åŒºé—´$[0, +\infty]$å†…çš„å¹¿ä¹‰ç§¯åˆ†ä¸ºè€ƒè™‘å‡½æ•°å€¼ä¸ºæ— é™çš„æƒ…å†µï¼Œå‡½æ•°$f(x)$åœ¨$[a, b]$å†…æœ‰å®šä¹‰ä¸”è¿ç»­ï¼Œ$F(x)$æ˜¯åŸå‡½æ•°ï¼Œå¦‚æœä¸‹é¢çš„æé™å­˜åœ¨åˆ™æœ‰è®¡ç®—å‡½æ•°$\int _0^1 {\frac {1}{\sqrt{1-x^2}} dx}$çš„å¹¿ä¹‰ç§¯åˆ†å¯¹äºæŸäº›è¿ç»­å‹éšæœºå˜é‡ï¼Œå¦‚æ­£æ€åˆ†å¸ƒéšæœºå˜é‡ï¼Œå…¶æ¦‚ç‡å¯†åº¦å‡½æ•°çš„å®šä¹‰åŒºé—´æ— é™è¿™ç§éšæœºå˜é‡çš„æ•°å­¦æœŸæœ›å’Œæ–¹å·®å³ä¸ºå¹¿ä¹‰ç§¯åˆ†å¸¸å¾®åˆ†æ–¹ç¨‹å¾®åˆ†æ–¹ç¨‹(Differential Equation, DE)æ˜¯å«æœ‰è‡ªå˜é‡ã€å‡½æ•°ä¸å…¶å¯¼æ•°çš„æ–¹ç¨‹ï¼Œæ–¹ç¨‹çš„è§£æ˜¯å‡½æ•°æ™®é€šçš„ä»£æ•°æ–¹ç¨‹å¦‚äºŒæ¬¡æ–¹ç¨‹ã€ä¸‰æ¬¡æ–¹ç¨‹çš„è§£æ˜¯å®æ•°æˆ–å¤æ•°åŸºæœ¬æ¦‚å¿µå®šä¹‰å«æœ‰è‡ªå˜é‡ã€å‡½æ•°ä»¥åŠå‡½æ•°å„é˜¶å¯¼æ•°çš„æ–¹ç¨‹ç§°ä¸ºå¸¸å¾®åˆ†æ–¹ç¨‹(Ordinary Differential Equation, ODE)ï¼Œå®ƒçš„è§£æ˜¯ä¸€å…ƒå‡½æ•°å¸¸å¾®åˆ†æ–¹ç¨‹å¯ä»¥å†™æˆ$f(x, y^{(n)}, \cdots, yâ€™, y) = 0$ï¼Œè¿™é‡Œ$f$æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œ$y$æ˜¯$x$çš„å‡½æ•°æ¯”å¦‚$x^2yâ€™â€™ - x^3yâ€™ + 2y -4x = 0$å¾®åˆ†æ–¹ç¨‹ä¸­å‡ºç°çš„å¯¼æ•°çš„æœ€é«˜é˜¶æ•°ç§°ä¸ºå¾®åˆ†æ–¹ç¨‹çš„é˜¶æ•°ï¼Œä¸Šé¢çš„æ–¹ç¨‹æ˜¯äºŒé˜¶æ–¹ç¨‹å¦‚æœå¾®åˆ†æ–¹ç¨‹æ˜¯æœªçŸ¥å‡½æ•°ä»¥åŠå¯¼æ•°çš„ä¸€æ¬¡æ–¹ç¨‹ï¼Œåˆ™ç§°ä¸ºçº¿æ€§å¾®åˆ†æ–¹ç¨‹ï¼Œå¦åˆ™ç§°ä¸ºéçº¿æ€§å¾®åˆ†æ–¹ç¨‹$n$é˜¶çº¿æ€§å¾®åˆ†æ–¹ç¨‹å¯ä»¥å†™æˆå¦‚ä¸‹çš„å½¢å¼ï¼Œå…¶ä¸­$a_{n}(x) \neq 0$å¦‚æœçº¿æ€§å¾®åˆ†æ–¹ç¨‹ä¸­æœªçŸ¥å‡½æ•°é¡¹ä»¥åŠå„é˜¶å¯¼æ•°é¡¹çš„ç³»æ•°éƒ½æ˜¯å¸¸æ•°ï¼Œåˆ™æˆä¸ºå¸¸ç³»æ•°çº¿æ€§å¾®åˆ†æ–¹ç¨‹æ¯”å¦‚äºŒé˜¶å¸¸ç³»æ•°çº¿æ€§å¾®åˆ†æ–¹ç¨‹$yâ€™â€™-xyâ€™+y-4x = 0$åº”ç”¨å¾®åˆ†æ–¹ç¨‹åœ¨ç‰©ç†å­¦é‡ç»å¸¸è¢«ä½¿ç”¨ï¼Œä»¥åŠ›å­¦ä¸ºä¾‹ç‰©ä½“åœ¨è‡ªç”±è½ä½“æ—¶å¦‚æœä¸è€ƒè™‘ç©ºæ°”é˜»åŠ›ï¼Œåˆ™åªæœ‰é‡åŠ›åŠ é€Ÿåº¦çš„ä½œç”¨æ ¹æ®ç‰›é¡¿ç¬¬äºŒå®šå¾‹å¯ä»¥å»ºç«‹å¾®åˆ†æ–¹ç¨‹$yâ€™â€™= g$å…¶ä¸­$y$ä¸º$t$æ—¶åˆ»çš„ä½ç§»ï¼Œ$g$ä¸ºé‡åŠ›åŠ é€Ÿåº¦ï¼Œè§£æ­¤æ–¹ç¨‹å¯ä»¥å¾—åˆ°ä½ç§»å‡½æ•°$y(t)$å¦‚æœè€ƒè™‘ç©ºæ°”çš„é˜»åŠ›ï¼Œå¯¹äºä½é€Ÿè¿åŠ¨çš„ç‰©ä½“ï¼Œé˜»åŠ›å¤§å°ä¸é€Ÿåº¦å¤§å°æˆæ­£æ¯”ï¼Œæ–¹å‘ä¸é‡åŠ›çš„æ–¹å‘ç›¸åé€Ÿåº¦æ˜¯ä½ç§»å‡½æ•°çš„ä¸€é˜¶å¯¼æ•°$yâ€™$ï¼ŒåŠ é€Ÿåº¦æ˜¯ä½ç§»å‡½æ•°çš„äºŒé˜¶å¯¼æ•°$yâ€™â€™$ï¼Œæ ¹æ®ç‰›é¡¿ç¬¬äºŒå®šå¾‹å¯ä»¥å¾—åˆ°å¾®åˆ†æ–¹ç¨‹$myâ€™â€™ = mg -kyâ€™$å…¶ä¸­$k$ä¸ºå¸¸æ•°ï¼Œ$m$ä¸ºç‰©ä½“çš„è´¨é‡ï¼Œå˜å½¢åå¯ä»¥å¾—åˆ°$yâ€™â€™ + \frac {k}{m}yâ€™ -g = 0$åˆå€¼é—®é¢˜é€šå¸¸æƒ…å†µä¸‹å¾®åˆ†æ–¹ç¨‹çš„è§£ä¸å”¯ä¸€ï¼ŒåŠ ä¸Šé™å®šæ¡ä»¶å¯ä»¥ä¿è¯è§£çš„å”¯ä¸€æ€§ï¼Œå¯ä»¥æŒ‡å®šå‡½æ•°åœ¨æŸä¸€ç‚¹æˆ–æŸäº›ç‚¹çš„å€¼$y(x_0)=c_0$æˆ–æ˜¯å…¶å¯¼æ•°åœ¨æŸä¸€ç‚¹å¤„çš„å€¼$yâ€™(x_0) = c_1$ï¼ŒåŠ ä¸Šè¿™ç§é™å®šæ¡ä»¶ä¹‹åç§°ä¸ºåˆå€¼é—®é¢˜å­˜åœ¨æ€§ä¸å”¯ä¸€æ€§åˆ¤åˆ«æ¡ä»¶å¹¶éæ‰€æœ‰å¾®åˆ†æ–¹ç¨‹çš„è§£éƒ½å­˜åœ¨ï¼Œå¯¹äºåˆå€¼é—®é¢˜ï¼ŒæŸ¯è¥¿-ææ™®å¸ŒèŒ¨(Cauchy-Lipschitz)å®šç†ç»™å‡ºäº†è§£çš„å­˜åœ¨æ€§ä¸å”¯ä¸€æ€§åˆ¤åˆ«æ¡ä»¶å³ä½¿è§£å­˜åœ¨ï¼Œä¹Ÿåªæœ‰å°‘æ•°ç®€å•çš„å¾®åˆ†æ–¹ç¨‹å¯ä»¥æ±‚è§£å¾—åˆ°è§£æè§£åœ¨æ— æ³•æ±‚å¾—è§£æè§£æ—¶ï¼Œå¯ä»¥åˆ©ç”¨æ•°å€¼è®¡ç®—çš„æ–¹æ³•è¿‘ä¼¼æ±‚è§£ï¼Œå¸¸ç”¨çš„æœ‰é¾™æ ¼-åº“å¡”(Runge-Kutta)æ³•å’Œç†æŸ¥æ£®(Richardsoon)å¤–æ¨æ³•ä¸€é˜¶çº¿æ€§å¾®åˆ†æ–¹ç¨‹åœ¨æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ ä¸­ç”¨åˆ°çš„é€šå¸¸æ˜¯æœ€ç®€å•çš„æ–¹ç¨‹ä¸€é˜¶æ–¹ç¨‹å¯¹äºä¸€é˜¶æ–¹ç¨‹$yâ€™=f(x)$ï¼Œå¯ä»¥ç›´æ¥å¯¹å…¶ç§¯åˆ†å³å¯å¾—åˆ°æ–¹ç¨‹çš„è§£å¯¹äºæ–¹ç¨‹ä¸€ä¾§åªå«æœ‰æ›´é«˜é˜¶å¯¼æ•°çš„æ–¹ç¨‹$f^{(n)} = f(x)$å¯ä»¥é€šè¿‡å¤šæ¬¡ç§¯åˆ†æ±‚è§£ï¼Œè¿™ç±»ç§°ä¸ºå¯ç§¯åˆ†çš„å¾®åˆ†æ–¹ç¨‹å¯¹äºä¸‹é¢çš„æ–¹ç¨‹$yâ€™+ay=0$ï¼Œå°†æ–¹ç¨‹ä¸¤è¾¹åŒä¹˜ä»¥$e^{ax}$å¯å¾—$e^{ax}yâ€™ + aye^{ax} = 0$æ ¹æ®ä¹˜æ³•çš„æ±‚å¯¼å…¬å¼å¯ä»¥å¾—åˆ°$y = Ce^{-ax}$å…¶ä¸­$yâ€™+ay=0$æ˜¯é½æ¬¡æ–¹ç¨‹ä¸€èˆ¬çš„æ–¹ç¨‹$yâ€™ + ay = b(x)$åŒæ ·å°†æ–¹ç¨‹ä¸¤è¾¹åŒä¹˜ä»¥$e^{ax}$å¯å¾—$e^{ax}$å¯å¾—$e^{ax}yâ€™ + aye^{ax} = e^{ax}b(x)$ï¼Œå³$(e^{ax}y)â€™ = e^{ax}b(x)$ä»è€Œæœ‰$e^{ax}y = \int {e^{ax}b(x)dx} + C$ï¼Œå¯ä»¥è§£å¾—$y = e^{-ax}(\int e^{ax}b(x)dx + C)$å…¶ä¸­$yâ€™ + ay = b(x)$æ˜¯éé½æ¬¡æ–¹ç¨‹æ›´å¤æ‚çš„æ–¹ç¨‹å¯¹äºä¸€é˜¶çº¿æ€§å¾®åˆ†æ–¹ç¨‹$yâ€™+a(x)y=b(x)$ï¼Œå°†ä¸¤è¾¹åŒä¹˜ä»¥$e^{\int a(x)dx}$å¯å¾—å³$(e^{\int a(x)dx}y) = b(x)e^{\int a(x)dx}$ï¼Œå› æ­¤æœ‰ä»è€Œå¯ä»¥è§£å¾—è¿™äº›æ–¹ç¨‹çš„æ±‚è§£éƒ½åˆ©ç”¨äº†æŒ‡æ•°å‡½æ•°æ±‚å¯¼çš„ä¼˜è‰¯æ€§è´¨ï¼Œæ–¹ç¨‹ä¸¤è¾¹åŒä¹˜ä»¥æŒ‡æ•°å‡½æ•°ä¹‹åï¼Œåˆ©ç”¨ä¹˜ç§¯çš„æ±‚å¯¼å…¬å¼ï¼Œå°†æ–¹ç¨‹å·¦ä¾§çš„ä¸¤é¡¹æ±‚å’Œè½¬ä¸ºæŸä¸¤ä¸ªå‡½æ•°ç›¸ä¹˜çš„å¯¼æ•°</content>
	</entry>
	<entry>
		<title>pythonåç¨‹</title>
		<url>/article/56863.html</url>
		<content>pythonè¿­ä»£å¯¹è±¡Coroutines Are Faster To Start Than Threads in Pythonæ‰«æå†…å­˜ä¸­æ”¾ä¸ä¸‹çš„æ•°æ®é›†æ—¶ï¼Œæˆ‘ä»¬è¦æ‰¾åˆ°ä¸€ç§æƒ°æ€§è·å–æ•°æ®é¡¹çš„æ–¹å¼ï¼Œå³æŒ‰éœ€ä¸€æ¬¡è·å–ä¸€ä¸ªæ•°æ®é¡¹è¿™å°±æ˜¯è¿­ä»£å™¨æ¨¡å¼(Iterator pattern)ï¼Œè¿­ä»£æ˜¯æ•°æ®å¤„ç†çš„åŸºçŸ³Python 2.2(2001 å¹´)åŠ å…¥äº† yield å…³é”®å­—ï¼Œè¿™ä¸ªå…³é”®å­—ç”¨äºæ„å»ºç”Ÿæˆå™¨(generator)ï¼Œå…¶ä½œç”¨ä¸è¿­ä»£å™¨ä¸€æ ·æ‰€æœ‰ç”Ÿæˆå™¨éƒ½æ˜¯è¿­ä»£å™¨ï¼Œå› ä¸ºç”Ÿæˆå™¨å®Œå…¨å®ç°äº†è¿­ä»£å™¨æ¥å£è¿­ä»£å™¨ç”¨äºä»é›†åˆä¸­å–å‡ºå…ƒç´ ï¼›è€Œç”Ÿæˆå™¨ç”¨äºâ€å‡­ç©ºâ€ç”Ÿæˆå…ƒç´ Python ç¤¾åŒºä¸­ï¼Œå¤§å¤šæ•°æ—¶å€™éƒ½æŠŠè¿­ä»£å™¨å’Œç”Ÿæˆå™¨è§†ä½œåŒä¸€æ¦‚å¿µå†…ç½®çš„ range() å‡½æ•°ä¹Ÿè¿”å›ä¸€ä¸ªç±»ä¼¼ç”Ÿæˆå™¨çš„å¯¹è±¡ï¼Œè€Œä»¥å‰åˆ™è¿”å›å®Œæ•´çš„åˆ—è¡¨å¦‚æœä¸€å®šè¦è®© range() å‡½æ•°è¿”å›åˆ—è¡¨ï¼Œé‚£ä¹ˆå¿…é¡»æ˜ç¡®æŒ‡æ˜(ä¾‹å¦‚ï¼Œlist(range(100)))åºåˆ—å¯ä»¥è¿­ä»£çš„åŸå› ï¼šiterå‡½æ•°è§£é‡Šå™¨éœ€è¦è¿­ä»£å¯¹è±¡ x æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨ iter(x)å†…ç½®çš„ iter å‡½æ•°æœ‰ä»¥ä¸‹ä½œç”¨æ£€æŸ¥å¯¹è±¡æ˜¯å¦å®ç°äº† __iter__ æ–¹æ³•ï¼Œå¦‚æœå®ç°äº†å°±è°ƒç”¨å®ƒï¼Œè·å–ä¸€ä¸ªè¿­ä»£å™¨å¦‚æœæ²¡æœ‰å®ç° __iter__ æ–¹æ³•ï¼Œä½†æ˜¯å®ç°äº† __getitem__ æ–¹æ³•ï¼ŒPython ä¼šåˆ›å»ºä¸€ä¸ªè¿­ä»£å™¨ï¼Œå°è¯•æŒ‰é¡ºåº(ä»ç´¢å¼• 0 å¼€å§‹)è·å–å…ƒç´ å¦‚æœå°è¯•å¤±è´¥ï¼ŒPython æŠ›å‡º TypeError å¼‚å¸¸ï¼Œé€šå¸¸ä¼šæç¤ºâ€C object is not iterableâ€(C å¯¹è±¡ä¸å¯è¿­ä»£)ï¼Œå…¶ä¸­ C æ˜¯ç›®æ ‡å¯¹è±¡æ‰€å±çš„ç±»ä»»ä½• Python åºåˆ—éƒ½å¯è¿­ä»£çš„åŸå› æ˜¯ï¼Œå®ƒä»¬éƒ½å®ç°äº† __getitem__ æ–¹æ³•é¸­å­ç±»å‹ï¼ˆduck typingï¼‰çš„æç«¯å½¢å¼ä¸ä»…è¦å®ç°ç‰¹æ®Šçš„ __iter__ æ–¹æ³•ï¼Œè¿˜è¦å®ç° __getitem__ æ–¹æ³•è€Œä¸” __getitem__ æ–¹æ³•çš„å‚æ•°æ˜¯ä» 0 å¼€å§‹çš„æ•´æ•°ï¼ˆintï¼‰ï¼Œè¿™æ ·æ‰è®¤ä¸ºå¯¹è±¡æ˜¯å¯è¿­ä»£çš„ç™½é¹…ç±»å‹ï¼ˆgoose-typingï¼‰ç†è®ºä¸­ï¼Œå¯è¿­ä»£å¯¹è±¡çš„å®šä¹‰ç®€å•ä¸€äº›ï¼Œä¸è¿‡æ²¡é‚£ä¹ˆçµæ´»å¦‚æœå®ç°äº† __iter__ æ–¹æ³•ï¼Œé‚£ä¹ˆå°±è®¤ä¸ºå¯¹è±¡æ˜¯å¯è¿­ä»£çš„æ£€æŸ¥å¯¹è±¡ x èƒ½å¦è¿­ä»£ï¼Œæœ€å‡†ç¡®çš„æ–¹æ³•æ˜¯ï¼šè°ƒç”¨ iter(x)å‡½æ•°ï¼Œå¦‚æœä¸å¯è¿­ä»£ï¼Œå†å¤„ç† TypeError å¼‚å¸¸è¿™æ¯”ä½¿ç”¨ isinstance(x, abc.Iterable) æ›´å‡†ç¡®å› ä¸º iter(x) å‡½æ•°ä¼šè€ƒè™‘åˆ°é—ç•™çš„ __getitem__ æ–¹æ³•ï¼Œè€Œ abc.Iterable ç±»åˆ™ä¸è€ƒè™‘å¯è¿­ä»£çš„å¯¹è±¡ä½¿ç”¨ iter å†…ç½®å‡½æ•°å¯ä»¥è·å–è¿­ä»£å™¨çš„å¯¹è±¡å¦‚æœå¯¹è±¡å®ç°äº†èƒ½è¿”å›è¿­ä»£å™¨çš„ __iter__ æ–¹æ³•ï¼Œé‚£ä¹ˆå¯¹è±¡å°±æ˜¯å¯è¿­ä»£çš„ã€‚åºåˆ—éƒ½å¯ä»¥è¿­ä»£æ˜¯å®ç°äº† __getitem__æ–¹æ³•ï¼Œè€Œä¸”å…¶å‚æ•°æ˜¯ä»é›¶å¼€å§‹çš„ç´¢å¼•ï¼Œè¿™ç§å¯¹è±¡ä¹Ÿå¯ä»¥è¿­ä»£éå†æ–¹å¼ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ for å¾ªç¯ï¼Œè¿­ä»£ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚è¿™é‡Œï¼Œå­—ç¬¦ä¸² 'ABC' æ˜¯å¯è¿­ä»£çš„å¯¹è±¡ã€‚èƒŒåæ˜¯æœ‰è¿­ä»£å™¨çš„ï¼Œåªä¸è¿‡æˆ‘ä»¬çœ‹ä¸åˆ°ï¼š1234567&gt;&gt;&gt; s = 'ABC'&gt;&gt;&gt; for char in s:...     print(char)...ABCå¦‚æœæ²¡æœ‰ for è¯­å¥ï¼Œä¸å¾—ä¸ä½¿ç”¨ while å¾ªç¯æ¨¡æ‹Ÿï¼Œè¦åƒä¸‹é¢è¿™æ ·å†™ï¼š123456789101112131415161718&gt;&gt;&gt; s = 'ABC'&gt;&gt;&gt; it = iter(s)  # âŠ&gt;&gt;&gt; while True:...     try:...         print(next(it))  # â‹...     except StopIteration:  # âŒ...         del it  # â...         break  # â...ABCâ¶ ä½¿ç”¨å¯è¿­ä»£çš„å¯¹è±¡æ„å»ºè¿­ä»£å™¨ itã€‚â· ä¸æ–­åœ¨è¿­ä»£å™¨ä¸Šè°ƒç”¨ next å‡½æ•°ï¼Œè·å–ä¸‹ä¸€ä¸ªå­—ç¬¦ã€‚â¸ å¦‚æœæ²¡æœ‰å­—ç¬¦äº†ï¼Œè¿­ä»£å™¨ä¼šæŠ›å‡º StopIteration å¼‚å¸¸ã€‚â¹ é‡Šæ”¾å¯¹ it çš„å¼•ç”¨ï¼Œå³åºŸå¼ƒè¿­ä»£å™¨å¯¹è±¡ã€‚âº é€€å‡ºå¾ªç¯ã€‚StopIteration å¼‚å¸¸è¡¨æ˜è¿­ä»£å™¨åˆ°å¤´äº†Python è¯­è¨€å†…éƒ¨ä¼šå¤„ç† for å¾ªç¯å’Œå…¶ä»–è¿­ä»£ä¸Šä¸‹æ–‡(å¦‚åˆ—è¡¨æ¨å¯¼ã€å…ƒç»„æ‹†åŒ…ç­‰ç­‰)ä¸­çš„ StopIteration å¼‚å¸¸æ˜ç¡®å¯è¿­ä»£çš„å¯¹è±¡å’Œè¿­ä»£å™¨ä¹‹é—´çš„å…³ç³»ï¼šPython ä»å¯è¿­ä»£çš„å¯¹è±¡ä¸­è·å–è¿­ä»£å™¨è¿­ä»£å™¨æ ‡å‡†çš„è¿­ä»£å™¨æ¥å£æœ‰ä¸¤ä¸ªæ–¹æ³•__next__: è¿”å›ä¸‹ä¸€ä¸ªå¯ç”¨çš„å…ƒç´ ï¼Œå¦‚æœæ²¡æœ‰å…ƒç´ äº†ï¼ŒæŠ›å‡º StopIteration å¼‚å¸¸__iter__: è¿”å› selfï¼Œä»¥ä¾¿åœ¨åº”è¯¥ä½¿ç”¨å¯è¿­ä»£å¯¹è±¡çš„åœ°æ–¹ä½¿ç”¨è¿­ä»£å™¨ï¼Œä¾‹å¦‚åœ¨ for å¾ªç¯ä¸­Iterator æŠ½è±¡åŸºç±»å®ç° __iter__ æ–¹æ³•çš„æ–¹å¼æ˜¯è¿”å›å®ä¾‹æœ¬èº«(return self)å¦‚æœæƒ³å†æ¬¡è¿­ä»£ï¼Œè¦é‡æ–°æ„å»ºè¿­ä»£å™¨ï¼Œåœ¨éœ€è¦å¯è¿­ä»£å¯¹è±¡çš„åœ°æ–¹å¯ä»¥ä½¿ç”¨è¿­ä»£å™¨æ£€æŸ¥è¿­ä»£å™¨é—ç•™å¯¹è±¡å› ä¸ºè¿­ä»£å™¨åªéœ€ __next__ å’Œ __iter__ ä¸¤ä¸ªæ–¹æ³•ï¼Œæ‰€ä»¥é™¤äº†è°ƒç”¨ next() æ–¹æ³•ï¼Œä»¥åŠæ•è· StopIteration å¼‚å¸¸ä¹‹å¤–ï¼Œæ²¡æœ‰åŠæ³•æ£€æŸ¥æ˜¯å¦è¿˜æœ‰é—ç•™çš„å…ƒç´ Python ä¸­çš„è¿­ä»£å™¨è¿˜å®ç°äº† __iter__ æ–¹æ³•ï¼Œå› æ­¤è¿­ä»£å™¨ä¹Ÿå¯ä»¥è¿­ä»£ä½¿ç”¨è¿­ä»£å™¨æ¨¡å¼å®ç° Sentence ç±»12345678910111213141516171819202122232425262728293031import reimport reprlibRE_WORD = re.compile('\w+')class Sentence:    def __init__(self, text):       self.text = text       self.words = RE_WORD.findall(text)    def __repr__(self):       return 'Sentence(%s)' % reprlib.repr(self.text)    def __iter__(self):  âŠ       return SentenceIterator(self.words)  â‹class SentenceIterator:    def __init__(self, words):       self.words = words  âŒ       self.index = 0  â    def __next__(self):       try:           word = self.words[self.index]  â       except IndexError:           raise StopIteration()  â       self.index += 1  â       return word  â‘    def __iter__(self):  â’       return selfå¯¹è¿™ä¸ªç¤ºä¾‹æ¥è¯´ï¼Œå…¶å®æ²¡å¿…è¦åœ¨ SentenceIterator ç±»ä¸­å®ç° __iter__æ–¹æ³•ï¼Œä¸è¿‡è¿™ä¹ˆåšæ˜¯å¯¹çš„ï¼Œå› ä¸ºè¿­ä»£å™¨åº”è¯¥å®ç° __next__ å’Œ __iter__ ä¸¤ä¸ªæ–¹æ³•ï¼Œè€Œä¸”è¿™ä¹ˆåšèƒ½è®©è¿­ä»£å™¨é€šè¿‡ issubclass(SentenceIterator, abc.Iterator) æµ‹è¯•å¯è¿­ä»£çš„å¯¹è±¡æœ‰ä¸ª __iter__ æ–¹æ³•ï¼Œæ¯æ¬¡éƒ½å®ä¾‹åŒ–ä¸€ä¸ªæ–°çš„è¿­ä»£å™¨è€Œè¿­ä»£å™¨è¦å®ç° __next__ æ–¹æ³•ï¼Œè¿”å›å•ä¸ªå…ƒç´ ï¼Œæ­¤å¤–è¿˜è¦å®ç° __iter__ æ–¹æ³•ï¼Œè¿”å›è¿­ä»£å™¨æœ¬èº«ä¸ºäº†â€æ”¯æŒå¤šç§éå†â€ï¼Œå¿…é¡»èƒ½ä»åŒä¸€ä¸ªå¯è¿­ä»£çš„å®ä¾‹ä¸­è·å–å¤šä¸ªç‹¬ç«‹çš„è¿­ä»£å™¨ï¼Œè€Œä¸”å„ä¸ªè¿­ä»£å™¨è¦èƒ½ç»´æŠ¤è‡ªèº«çš„å†…éƒ¨çŠ¶æ€ï¼Œå› æ­¤è¿™ä¸€æ¨¡å¼æ­£ç¡®çš„å®ç°æ–¹å¼æ˜¯ï¼Œæ¯æ¬¡è°ƒç”¨ iter(my_iterable) éƒ½æ–°å»ºä¸€ä¸ªç‹¬ç«‹çš„è¿­ä»£å™¨ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¿™ä¸ªç¤ºä¾‹éœ€è¦å®šä¹‰ SentenceIterator ç±»è§„çº¦å‡½æ•°æ¥å—ä¸€ä¸ªå¯è¿­ä»£çš„å¯¹è±¡ï¼Œç„¶åè¿”å›å•ä¸ªç»“æœï¼Œè¿™äº›å‡½æ•°å«å½’çº¦å‡½æ•°å¯¹ all å’Œ any å‡½æ•°æ¥è¯´ï¼Œæœ‰ä¸€é¡¹é‡è¦çš„ä¼˜åŒ–æªæ–½æ˜¯ reduce å‡½æ•°åšä¸åˆ°çš„ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°ä¼šçŸ­è·¯(å³ä¸€æ—¦ç¡®å®šäº†ç»“æœå°±ç«‹å³åœæ­¢ä½¿ç”¨è¿­ä»£å™¨)æ¨¡å—å‡½æ•°è¯´æ˜å†…ç½®all(it)it ä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½ä¸ºçœŸå€¼æ—¶è¿”å› Trueï¼Œå¦åˆ™è¿”å› Falseall([]) è¿”å› Trueå†…ç½®any(it)åªè¦ it ä¸­æœ‰å…ƒç´ ä¸ºçœŸå€¼å°±è¿”å› Trueï¼Œå¦åˆ™è¿”å› Falseany([]) è¿”å› Falseå†…ç½®max(it, [key=,] [default=])è¿”å› it ä¸­å€¼æœ€å¤§çš„å…ƒç´ ï¼›*key æ˜¯æ’åºå‡½æ•°ï¼Œä¸ sorted å‡½æ•°ä¸­çš„ä¸€æ ·å¦‚æœå¯è¿­ä»£çš„å¯¹è±¡ä¸ºç©ºï¼Œè¿”å› defaultå†…ç½®min(it, [key=,] [default=])è¿”å› it ä¸­å€¼æœ€å°çš„å…ƒç´ ï¼›#key æ˜¯æ’åºå‡½æ•°ï¼Œä¸ sorted å‡½æ•°ä¸­çš„ä¸€æ ·å¦‚æœå¯è¿­ä»£çš„å¯¹è±¡ä¸ºç©ºï¼Œè¿”å› defaultfunctoolsreduce(func, it, [initial])æŠŠå‰ä¸¤ä¸ªå…ƒç´ ä¼ ç»™ funcï¼Œç„¶åæŠŠè®¡ç®—ç»“æœå’Œç¬¬ä¸‰ä¸ªå…ƒç´ ä¼ ç»™ funcï¼Œä»¥æ­¤ç±»æ¨ï¼Œè¿”å›æœ€åçš„ç»“æœå¦‚æœæä¾›äº† initialï¼ŒæŠŠå®ƒå½“ä½œç¬¬ä¸€ä¸ªå…ƒç´ ä¼ å…¥å†…ç½®sum(it, start=0)it ä¸­æ‰€æœ‰å…ƒç´ çš„æ€»å’Œï¼Œå¦‚æœæä¾›å¯é€‰çš„ startï¼Œä¼šæŠŠå®ƒåŠ ä¸Šï¼ˆè®¡ç®—æµ®ç‚¹æ•°çš„åŠ æ³•æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ math.fsum å‡½æ•°æé«˜ç²¾åº¦ï¼‰åœ¨ Python ä¸­è¿­ä»£å¯¹è±¡ x æ—¶ä¼šè°ƒç”¨ iter(x)iter å‡½æ•°è¿˜æœ‰ä¸€ä¸ªé²œä¸ºäººçŸ¥çš„ç”¨æ³•ï¼šä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼Œä½¿ç”¨å¸¸è§„çš„å‡½æ•°æˆ–ä»»ä½•å¯è°ƒç”¨çš„å¯¹è±¡åˆ›å»ºè¿­ä»£å™¨è¿™æ ·ä½¿ç”¨æ—¶ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯å¯è°ƒç”¨çš„å¯¹è±¡ï¼Œç”¨äºä¸æ–­è°ƒç”¨(æ²¡æœ‰å‚æ•°)ï¼Œäº§å‡ºå„ä¸ªå€¼ï¼›ç¬¬äºŒä¸ªå€¼æ˜¯å“¨ç¬¦ï¼Œè¿™æ˜¯ä¸ªæ ‡è®°å€¼ï¼Œå½“å¯è°ƒç”¨çš„å¯¹è±¡è¿”å›è¿™ä¸ªå€¼æ—¶ï¼Œè§¦å‘è¿­ä»£å™¨æŠ›å‡º StopIteration å¼‚å¸¸ï¼Œè€Œä¸äº§å‡ºå“¨ç¬¦ç”Ÿæˆå™¨åªè¦ Python å‡½æ•°çš„å®šä¹‰ä½“ä¸­æœ‰ yield å…³é”®å­—ï¼Œè¯¥å‡½æ•°å°±æ˜¯ç”Ÿæˆå™¨å‡½æ•°ç”Ÿæˆå™¨å‡½æ•°ä¼šåˆ›å»ºä¸€ä¸ªç”Ÿæˆå™¨å¯¹è±¡ï¼ŒåŒ…è£…ç”Ÿæˆå™¨å‡½æ•°çš„å®šä¹‰ä½“æŠŠç”Ÿæˆå™¨ä¼ ç»™ next(...) å‡½æ•°æ—¶ï¼Œç”Ÿæˆå™¨å‡½æ•°ä¼šå‘å‰ï¼Œæ‰§è¡Œå‡½æ•°å®šä¹‰ä½“ä¸­çš„ä¸‹ä¸€ä¸ª yield è¯­å¥è¿”å›äº§å‡ºçš„å€¼ï¼Œå¹¶åœ¨å‡½æ•°å®šä¹‰ä½“çš„å½“å‰ä½ç½®æš‚åœæœ€ç»ˆï¼Œå‡½æ•°çš„å®šä¹‰ä½“è¿”å›æ—¶ï¼Œå¤–å±‚çš„ç”Ÿæˆå™¨å¯¹è±¡ä¼šæŠ›å‡º StopIteration å¼‚å¸¸â€”â€”è¿™ä¸€ç‚¹ä¸è¿­ä»£å™¨åè®®ä¸€è‡´å¦‚æœä¸€ä¸ªç±»åªæ˜¯ä¸ºäº†æ„å»ºç”Ÿæˆå™¨è€Œå»å®ç° __iter__ æ–¹æ³•ï¼Œé‚£è¿˜ä¸å¦‚ä½¿ç”¨ç”Ÿæˆå™¨å‡½æ•°æƒ°æ€§æ˜¯å¥½çš„ç‰¹è´¨ï¼Œè‡³å°‘åœ¨ç¼–ç¨‹è¯­è¨€å’Œ API ä¸­æ˜¯å¦‚æ­¤ï¼Œæƒ°æ€§å®ç°æ˜¯æŒ‡å°½å¯èƒ½å»¶åç”Ÿæˆå€¼è¿™æ ·åšèƒ½èŠ‚çœå†…å­˜ï¼Œè€Œä¸”æˆ–è®¸è¿˜å¯ä»¥é¿å…åšæ— ç”¨çš„å¤„ç†12345678910111213141516171819import reimport reprlibRE_WORD = re.compile('\w+')class Sentence: def __init__(self, text):     self.text = text  âŠ def __repr__(self):     return 'Sentence(%s)' % reprlib.repr(self.text) def __iter__(self):     for match in RE_WORD.finditer(self.text):  â‹         yield match.group()  âŒâ¶ ä¸å†éœ€è¦ words åˆ—è¡¨ã€‚â· finditer å‡½æ•°æ„å»ºä¸€ä¸ªè¿­ä»£å™¨ï¼ŒåŒ…å« self.text ä¸­åŒ¹é… RE_WORD çš„å•è¯ï¼Œäº§å‡º MatchObject å®ä¾‹ã€‚â¸ match.group() æ–¹æ³•ä» MatchObject å®ä¾‹ä¸­æå–åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼çš„å…·ä½“æ–‡æœ¬ç”Ÿæˆå™¨è¡¨è¾¾å¼å¯ä»¥ç†è§£ä¸ºåˆ—è¡¨æ¨å¯¼çš„æƒ°æ€§ç‰ˆæœ¬ï¼šä¸ä¼šè¿«åˆ‡åœ°æ„å»ºåˆ—è¡¨ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªç”Ÿæˆå™¨ï¼ŒæŒ‰éœ€æƒ°æ€§ç”Ÿæˆå…ƒç´ ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœåˆ—è¡¨æ¨å¯¼æ˜¯åˆ¶é€ åˆ—è¡¨çš„å·¥å‚ï¼Œé‚£ä¹ˆç”Ÿæˆå™¨è¡¨è¾¾å¼å°±æ˜¯åˆ¶é€ ç”Ÿæˆå™¨çš„å·¥å‚123456789101112131415import reimport reprlibRE_WORD = re.compile('\w+')class Sentence:    def __init__(self, text):        self.text = text    def __repr__(self):        return 'Sentence(%s)' % reprlib.repr(self.text)    def __iter__(self):        return (match.group() for match in RE_WORD.finditer(self.text))æœ€ç»ˆçš„æ•ˆæœä¸€æ ·ï¼šè°ƒç”¨ __iter__ æ–¹æ³•ä¼šå¾—åˆ°ä¸€ä¸ªç”Ÿæˆå™¨å¯¹è±¡ç”Ÿæˆå™¨è¡¨è¾¾å¼æ˜¯è¯­æ³•ç³–ï¼šå®Œå…¨å¯ä»¥æ›¿æ¢æˆç”Ÿæˆå™¨å‡½æ•°ï¼Œä¸è¿‡æœ‰æ—¶ä½¿ç”¨ç”Ÿæˆå™¨è¡¨è¾¾å¼æ›´ä¾¿åˆ©ç”Ÿæˆå™¨è¡¨è¾¾å¼æ˜¯åˆ›å»ºç”Ÿæˆå™¨çš„ç®€æ´å¥æ³•ï¼Œè¿™æ ·æ— éœ€å…ˆå®šä¹‰å‡½æ•°å†è°ƒç”¨ç”Ÿæˆå™¨å‡½æ•°çµæ´»å¾—å¤šï¼Œå¯ä»¥ä½¿ç”¨å¤šä¸ªè¯­å¥å®ç°å¤æ‚çš„é€»è¾‘ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºåç¨‹ä½¿ç”¨é‡åˆ°ç®€å•çš„æƒ…å†µæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ç”Ÿæˆå™¨è¡¨è¾¾å¼å¦‚æœç”Ÿæˆå™¨è¡¨è¾¾å¼è¦åˆ†æˆå¤šè¡Œå†™ï¼Œæˆ‘å€¾å‘äºå®šä¹‰ç”Ÿæˆå™¨å‡½æ•°ï¼Œä»¥ä¾¿æé«˜å¯è¯»æ€§å¦‚æœå‡½æ•°æˆ–æ„é€ æ–¹æ³•åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œä¼ å…¥ç”Ÿæˆå™¨è¡¨è¾¾å¼æ—¶ä¸ç”¨å†™ä¸€å¯¹è°ƒç”¨å‡½æ•°çš„æ‹¬å·å†å†™ä¸€å¯¹æ‹¬å·å›´ä½ç”Ÿæˆå™¨è¡¨è¾¾å¼ï¼Œåªå†™ä¸€å¯¹æ‹¬å·å°±è¡Œäº†è¿­ä»£å™¨æœ‰ä¸¤ä¸ªç‰¹ç‚¹æ¥å£Python çš„è¿­ä»£å™¨åè®®å®šä¹‰äº†ä¸¤ä¸ªæ–¹æ³•ï¼š__next__ å’Œ __iter__ç”Ÿæˆå™¨å¯¹è±¡å®ç°äº†è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œå› æ­¤ä»è¿™æ–¹é¢æ¥çœ‹ï¼Œæ‰€æœ‰ç”Ÿæˆå™¨éƒ½æ˜¯è¿­ä»£å™¨å®ç°æ–¹å¼ç”Ÿæˆå™¨è¿™ç§ Python è¯­è¨€ç»“æ„å¯ä»¥ä½¿ç”¨ä¸¤ç§æ–¹å¼ç¼–å†™ï¼šå«æœ‰ yield å…³é”®å­—çš„å‡½æ•°ï¼Œæˆ–è€…ç”Ÿæˆå™¨è¡¨è¾¾å¼è°ƒç”¨ç”Ÿæˆå™¨å‡½æ•°æˆ–è€…æ‰§è¡Œç”Ÿæˆå™¨è¡¨è¾¾å¼å¾—åˆ°çš„ç”Ÿæˆå™¨å¯¹è±¡å±äºè¯­è¨€å†…éƒ¨çš„ GeneratorType ç±»å‹è¿­ä»£å™¨å¯ä»¥èŠ‚çº¦å¤§é‡çš„ç©ºé—´å½“éœ€è¦ç”Ÿæˆçš„æ•°åˆ—æ•°é‡éå¸¸å¤§æ—¶ï¼Œç”±äºä»£ç ä¸­å°†æ•°å­—å­˜å‚¨åœ¨ list ä¸­ï¼Œä¼šå¯¼è‡´å·¨å¤§å†…å­˜å ç”¨12345678910111213141516171819# ç”Ÿæˆå™¨class Fab(object):   def __init__(self, max):       self.max = max       self.n, self.a, self.b = 0, 0, 1    def __iter__(self):       return self    def next(self):       if self.n &lt; self.max:           r = self.b           self.a, self.b = self.b, self.a + self.b           self.n = self.n + 1           return r       raise StopIteration()Fab(6)Out[56]: [1, 1, 2, 3, 5, 8]ä¸Šè¿°ä»£ç é€šè¿‡ç±»çš„å½¢å¼å°†å‡½æ•°å°è£…ä¸ºä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡é€šè¿‡nextæ–¹æ³•åœ¨å¾ªç¯çš„æ—¶å€™æ¯æ¬¡å»å–ä¸€ä¸ªæ•°ï¼Œåªæœ‰åœ¨éœ€è¦ä½¿ç”¨çš„æ—¶å€™æ‰ä¼šç”Ÿæˆï¼Œå†…å­˜å ç”¨å¾ˆå°ä½†æ˜¯ï¼Œä¸Šè¿°ä»£ç è¾ƒä¸ºç¹çï¼Œåœ¨Pythonä¸­ï¼Œæœ‰ä¸€ç§è¯­æ³•ç³–èƒ½ç®€åŒ–ï¼Œé‚£å°±æ˜¯ yield å¦‚æœè¿™ä¸ªå…ƒç´ å¯ä»¥é€šè¿‡æŸç§æ–¹å¼æ¨ç®—å‡ºæ¥åˆ‡å¯ä»¥è¿›è¡Œå¾ªç¯æ“ä½œï¼Œå°±é¿å…äº†å¤§çš„å†…å­˜å ç”¨åªéœ€è¦å‡½æ•°åœ¨å¾ªç¯æ—¶è®¡ç®—å¾—ä¸‹ä¸€ä¸ªæ•°å­—å¹¶è¿”å›ï¼Œè¿™æ ·å°±ä¸å¿…åˆ›å»ºå®Œæ•´çš„ list ï¼Œä»è€ŒèŠ‚çœå¤§é‡ç©ºé—´åœ¨Pythonä¸­ï¼Œè¿™ç§ä¸€è¾¹å¾ªç¯ä¸€è¾¹è®¡ç®—çš„æœºåˆ¶ï¼Œç§°ä¸ºç”Ÿæˆå™¨ï¼šgenerator1234567891011# yield è¯­æ³•ç³–def fab(max):    n, a, b = 0, 0, 1    while n &lt; max:        yield b        # print b        a, b = b, a + b        n = n + 1fab(6)Out[56]: [1, 1, 2, 3, 5, 8]è°ƒç”¨å’Œ Fab ç‰ˆçš„å®Œå…¨ä¸€è‡´ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ next æ–¹æ³•ç­‰ã€‚ç®€å•çš„è¯´ï¼Œ yield çš„ä½œç”¨å°±æ˜¯æŠŠä¸€ä¸ªå‡½æ•°å˜ä¸ºä¸€ä¸ª generator ï¼Œå¸¦æœ‰ yield çš„å‡½æ•°ä¸å†æ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œ Python è§£é‡Šå™¨ä¼šå°†å™¨è§†ä¸º generator åœ¨ for å¾ªç¯æ‰§è¡Œæ—¶ï¼Œæ¯æ¬¡å¾ªç¯éƒ½ä¼šæ‰§è¡Œ fab å‡½æ•°å†…éƒ¨çš„ä»£ç ï¼Œæ‰§è¡Œåˆ° yield æ—¶å‡½æ•°å°±è¿”å›ä¸€ä¸ªè¿­ä»£å€¼ï¼Œä¸‹æ¬¡è¿­ä»£æ—¶ï¼Œå°±ä» yield çš„ä¸‹ä¸€å¥ç»§ç»­æ‰§è¡Œï¼Œè°ƒç”¨nextä¹Ÿæ˜¯åŒç†å½“å‡½æ•°æ‰§è¡Œç»“æŸæ—¶ï¼Œä¼šæŠ›å‡º StopIteration å¼‚å¸¸ï¼Œè¡¨ç¤ºè¿­ä»£å®Œæˆitertoolsæ¨¡å—itertools â€”- ä¸ºé«˜æ•ˆå¾ªç¯è€Œåˆ›å»ºè¿­ä»£å™¨çš„å‡½æ•°Python-è¿›é˜¶-itertoolsæ¨¡å—å°ç»“itertoolsè¿­ä»£å™¨çš„ç‰¹ç‚¹æ˜¯ï¼šæƒ°æ€§æ±‚å€¼ï¼ˆLazy evaluationï¼‰ï¼Œå³åªæœ‰å½“è¿­ä»£è‡³æŸä¸ªå€¼æ—¶ï¼Œå®ƒæ‰ä¼šè¢«è®¡ç®—ï¼Œè¿™ä¸ªç‰¹ç‚¹ä½¿å¾—è¿­ä»£å™¨ç‰¹åˆ«é€‚åˆäºéå†å¤§æ–‡ä»¶æˆ–æ— é™é›†åˆç­‰ï¼Œå› ä¸ºæˆ‘ä»¬ä¸ç”¨ä¸€æ¬¡æ€§å°†å®ƒä»¬å­˜å‚¨åœ¨å†…å­˜ä¸­Python å†…ç½®çš„ itertools æ¨¡å—åŒ…å«äº†ä¸€ç³»åˆ—ç”¨æ¥äº§ç”Ÿä¸åŒç±»å‹è¿­ä»£å™¨çš„å‡½æ•°æˆ–ç±»ï¼Œè¿™äº›å‡½æ•°çš„è¿”å›éƒ½æ˜¯ä¸€ä¸ªè¿­ä»£å™¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ for å¾ªç¯æ¥éå†å–å€¼ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ next() æ¥å–å€¼itertools æ¨¡å—æä¾›çš„è¿­ä»£å™¨å‡½æ•°æœ‰ä»¥ä¸‹å‡ ç§ç±»å‹ï¼šæ— é™è¿­ä»£å™¨ï¼šç”Ÿæˆä¸€ä¸ªæ— é™åºåˆ—ï¼Œæ¯”å¦‚è‡ªç„¶æ•°åºåˆ— 1, 2, 3, 4, ...æœ‰é™è¿­ä»£å™¨ï¼šæ¥æ”¶ä¸€ä¸ªæˆ–å¤šä¸ªåºåˆ—ï¼ˆsequenceï¼‰ä½œä¸ºå‚æ•°ï¼Œè¿›è¡Œç»„åˆã€åˆ†ç»„å’Œè¿‡æ»¤ç­‰ç»„åˆç”Ÿæˆå™¨ï¼šåºåˆ—çš„æ’åˆ—ã€ç»„åˆï¼Œæ±‚åºåˆ—çš„ç¬›å¡å„¿ç§¯ç­‰æ— é™è¿­ä»£å™¨itertools æ¨¡å—æä¾›äº†ä¸‰ä¸ªå‡½æ•°ï¼ˆäº‹å®ä¸Šï¼Œå®ƒä»¬æ˜¯ç±»ï¼‰ç”¨äºç”Ÿæˆä¸€ä¸ªæ— é™åºåˆ—è¿­ä»£å™¨count(firstval=0, step=1)åˆ›å»ºä¸€ä¸ªä» firstval (é»˜è®¤å€¼ä¸º 0) å¼€å§‹ï¼Œä»¥ step (é»˜è®¤å€¼ä¸º 1) ä¸ºæ­¥é•¿çš„çš„æ— é™æ•´æ•°è¿­ä»£å™¨cycle(iterable)å¯¹ iterable ä¸­çš„å…ƒç´ åå¤æ‰§è¡Œå¾ªç¯ï¼Œè¿”å›è¿­ä»£å™¨repeat(object [,times]åå¤ç”Ÿæˆ objectï¼Œå¦‚æœç»™å®š timesï¼Œåˆ™é‡å¤æ¬¡æ•°ä¸º timesï¼Œå¦åˆ™ä¸ºæ— é™IteratorArgumentsResultsExamplecount()start, [step]start, start+step, start+2*step, â€¦count(10) --&gt; 10 11 12 13 14 ...cycle()pp0, p1, â€¦ plast, p0, p1, â€¦cycle('ABCD') --&gt; A B C D A B C D ...repeat()elem [,n]elem, elem, elem, â€¦ endlessly or up to n timesrepeat(10, 3) --&gt; 10 10 1012345678910111213import itertoolsnums = itertools.count(start=2,step=3)for i in nums:    if i&gt;15:        break    print(i, end=' ')Out[17]: 2 5 8 11 14 [i for i in itertools.repeat(['a','b'],3)]Out[18]: [['a', 'b'], ['a', 'b'], ['a', 'b']]æœ‰é™è¿­ä»£å™¨itertools æ¨¡å—æä¾›äº†å¤šä¸ªå‡½æ•°ï¼ˆç±»ï¼‰ï¼Œæ¥æ”¶ä¸€ä¸ªæˆ–å¤šä¸ªè¿­ä»£å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œå¯¹å®ƒä»¬è¿›è¡Œç»„åˆã€åˆ†ç»„å’Œè¿‡æ»¤ç­‰chain()compress()dropwhile()groupby()ifilter()ifilterfalse()islice()imap()starmap()tee()takewhile()izip()izip_longest()IteratorArgumentsResultsExamplechain()p, q, â€¦p0, p1, â€¦ plast, q0, q1, â€¦chain('ABC', 'DEF') --&gt; A B C D E Fcompress()data, selectors(d[0] if s[0]), (d[1] if s[1]), â€¦compress('ABCDEF', [1,0,1,0,1,1]) --&gt; A C E Fdropwhile()pred, seqseq[n], seq[n+1], starting when pred failsdropwhile(lambda x: x&lt;5, [1,4,6,4,1]) --&gt; 6 4 1groupby()iterable[, keyfunc]sub-iterators grouped by value of keyfunc(v)ifilter()pred, seqelements of seq where pred(elem) is trueifilter(lambda x: x%2, range(10)) --&gt; 1 3 5 7 9ifilterfalse()pred, seqelements of seq where pred(elem) is falseifilterfalse(lambda x: x%2, range(10)) --&gt; 0 2 4 6 8islice()seq, [start,] stop [, step]elements from seq[start:stop:step]islice('ABCDEFG', 2, None) --&gt; C D E F Gstarmap()func, seqfunc(seq[0]), func(seq[1]), â€¦starmap(pow, [(2,5), (3,2), (10,3)]) --&gt; 32 9 1000tee()it, nit1, it2, â€¦ itn splits one iterator into ntakewhile()pred, seqseq[0], seq[1], until pred failstakewhile(lambda x: x&lt;5, [1,4,6,4,1]) --&gt; 1 4zip_longest()p, q, â€¦(p[0], q[0]), (p[1], q[1]), â€¦zip_longest('ABCD', 'xy', fillvalue='-') --&gt; Ax By C- D-1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374[item for item in itertools.chain([1, 2, 3], ['a', 'b', 'c'])]Out[19]: [1, 2, 3, 'a', 'b', 'c']# æ¥æ”¶ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªè¿­ä»£å™¨string = itertools.chain.from_iterable('ABCD')# compress å¯ç”¨äºå¯¹æ•°æ®è¿›è¡Œç­›é€‰ï¼Œå½“selectorsçš„æŸä¸ªå…ƒç´ ä¸ºtrueæ—¶ï¼Œåˆ™ä¿ç•™dataå¯¹åº”ä½ç½®çš„å…ƒç´ ï¼Œå¦åˆ™å»é™¤ï¼š# compress(data, selectors)list(compress('ABCDEF', [1, 1, 0, 1, 0, 1]))Out[23]:['A', 'B', 'D', 'F']# dropwhile(predicate, iterable)# å…¶ä¸­ï¼Œpredicate æ˜¯å‡½æ•°ï¼Œiterable æ˜¯å¯è¿­ä»£å¯¹è±¡ã€‚å¯¹äº iterable ä¸­çš„å…ƒç´ ï¼Œå¦‚æœ predicate(item) ä¸º trueï¼Œåˆ™ä¸¢å¼ƒè¯¥å…ƒç´ ï¼Œå¦åˆ™è¿”å›è¯¥é¡¹åŠæ‰€æœ‰åç»­é¡¹ã€‚&gt;&gt;&gt; list(dropwhile(lambda x: x &lt; 5, [1, 3, 6, 2, 1]))[6, 2, 1]&gt;&gt;&gt;&gt;&gt;&gt; list(dropwhile(lambda x: x &gt; 3, [2, 1, 6, 5, 4]))[2, 1, 6, 5, 4]# groupby(iterable[, keyfunc])# ç›¸é‚»ç›¸åŒå…ƒç´ åˆ†ç»„# å…¶ä¸­ï¼Œiterable æ˜¯ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼Œkeyfunc æ˜¯åˆ†ç»„å‡½æ•°ï¼Œç”¨äºå¯¹ iterable çš„è¿ç»­é¡¹è¿›è¡Œåˆ†ç»„ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œåˆ™é»˜è®¤å¯¹ iterable ä¸­çš„è¿ç»­ç›¸åŒé¡¹è¿›è¡Œåˆ†ç»„ï¼Œè¿”å›ä¸€ä¸ª (key, sub-iterator) çš„è¿­ä»£å™¨ã€‚&gt;&gt;&gt; for key, value_iter in groupby('aaabbbaaccd'):...     print key, ':', list(value_iter)...a : ['a', 'a', 'a']b : ['b', 'b', 'b']a : ['a', 'a']c : ['c', 'c']d : ['d']# ifilter(function or None, sequence)# å°† iterable ä¸­ function(item) ä¸º True çš„å…ƒç´ ç»„æˆä¸€ä¸ªè¿­ä»£å™¨è¿”å›ï¼Œå¦‚æœ function æ˜¯ Noneï¼Œåˆ™è¿”å› iterable ä¸­æ‰€æœ‰è®¡ç®—ä¸º True çš„é¡¹ã€‚&gt;&gt;&gt; list(ifilter(lambda x: x &lt; 6, range(10)))[0, 1, 2, 3, 4, 5]&gt;&gt;&gt;&gt;&gt;&gt; list(ifilter(None, [0, 1, 2, 0, 3, 4]))[1, 2, 3, 4]# ifilterfalse çš„ä½¿ç”¨å½¢å¼å’Œ ifilter ç±»ä¼¼ï¼Œå®ƒå°† iterable ä¸­ function(item) ä¸º False çš„å…ƒç´ ç»„æˆä¸€ä¸ªè¿­ä»£å™¨è¿”å›ï¼Œå¦‚æœ function æ˜¯ Noneï¼Œåˆ™è¿”å› iterable ä¸­æ‰€æœ‰è®¡ç®—ä¸º False çš„é¡¹ã€‚&gt;&gt;&gt; list(ifilterfalse(lambda x: x &lt; 6, range(10)))[6, 7, 8, 9]&gt;&gt;&gt;&gt;&gt;&gt; list(ifilter(None, [0, 1, 2, 0, 3, 4]))[0, 0]# islice(iterable, [start,] stop [, step]) # å…¶ä¸­ï¼Œiterable æ˜¯å¯è¿­ä»£å¯¹è±¡ï¼Œstart æ˜¯å¼€å§‹ç´¢å¼•ï¼Œstop æ˜¯ç»“æŸç´¢å¼•ï¼Œstep æ˜¯æ­¥é•¿ï¼Œstart å’Œ step å¯é€‰ã€‚&gt;&gt;&gt; list(islice([10, 6, 2, 8, 1, 3, 9], 5))[10, 6, 2, 8, 1]&gt;&gt;&gt;&gt;&gt;&gt; list(islice(count(), 6))[0, 1, 2, 3, 4, 5]&gt;&gt;&gt;&gt;&gt;&gt; list(islice(count(), 3, 10))[3, 4, 5, 6, 7, 8, 9]&gt;&gt;&gt; list(islice(count(), 3, 10 ,2))[3, 5, 7, 9]# tee ç”¨äºä» iterable åˆ›å»º n ä¸ªç‹¬ç«‹çš„è¿­ä»£å™¨ï¼Œä»¥å…ƒç»„çš„å½¢å¼è¿”å›ï¼Œn çš„é»˜è®¤å€¼æ˜¯ 2ã€‚iter1, iter2 = tee('abcde')# n é»˜è®¤ä¸º 2ï¼Œåˆ›å»ºä¸¤ä¸ªç‹¬ç«‹çš„è¿­ä»£å™¨# takewhile(predicate, iterable)# å…¶ä¸­ï¼Œpredicate æ˜¯å‡½æ•°ï¼Œiterable æ˜¯å¯è¿­ä»£å¯¹è±¡ã€‚å¯¹äº iterable ä¸­çš„å…ƒç´ ï¼Œå¦‚æœ predicate(item) ä¸º trueï¼Œåˆ™ä¿ç•™è¯¥å…ƒç´ ï¼Œåªè¦ predicate(item) ä¸º falseï¼Œåˆ™ç«‹å³åœæ­¢è¿­ä»£ã€‚&gt;&gt;&gt; list(takewhile(lambda x: x &lt; 5, [1, 3, 6, 2, 1]))[1, 3]&gt;&gt;&gt; list(takewhile(lambda x: x &gt; 3, [2, 1, 6, 5, 4]))[]from itertools import zip_longest[item for item in zip_longest('ABCD', 'xy')]Out[41]: [('A', 'x'), ('B', 'y'), ('C', None), ('D', None)][item for item in zip_longest('ABCD', 'xy',fillvalue='-')]Out[42]: [('A', 'x'), ('B', 'y'), ('C', '-'), ('D', '-')]itertools.groupbyç”¨æ³•1234567891011121314# åˆ†ç»„ç»Ÿè®¡ï¼Œå¹¶è·å–æ¯ç»„çš„å…·ä½“å…ƒç´ import refrom itertools import groupbysentence = 'æˆ‘æ˜¯ å“ˆå“ˆ  ä¸€ç›´åœ¨  æˆ‘ ä¸‰è¿å‡» é™ˆé£’é£’  é˜¿è±†è…å¹²   é˜¿è‹æ‰“æ°´ä¸¢é˜¿è¨å¾·'res= itertools.groupby(sorted(re.sub(' +',' ',sentence).split(' '),key=len,reverse=True),len)for k,v in res:print('%s-&gt;%s'%(k,list(v)))8-&gt;['é˜¿è‹æ‰“æ°´ä¸¢é˜¿è¨å¾·']4-&gt;['é˜¿è±†è…å¹²']3-&gt;['ä¸€ç›´åœ¨', 'ä¸‰è¿å‡»', 'é™ˆé£’é£’']2-&gt;['æˆ‘æ˜¯', 'å“ˆå“ˆ']1-&gt;['æˆ‘']itertools.teeç”¨æ³•itertools.teeåˆ†è£‚å‡ºæ¥çš„å¤šä¸ªç”Ÿæˆå™¨ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä¸èƒ½åœ¨å¤šçº¿ç¨‹é‡Œé¢è¿è¡Œï¼Œå¦åˆ™ä¼šå¯¼è‡´æŠ¥é”™ï¼Œè¿™é‡Œç»™å‡ºä¸€ä¸ªæŠ¥é”™çš„ä¾‹å­ï¼š1234567891011121314import itertoolsimport threadingdef generator():    for i in range(1000000):        yield ig = generator()g_1, g_2 = itertools.tee(g, 2)for x in [g_1, g_2]:    threading.Thread(target=sum, args=(x,)).start()å¤šçº¿ç¨‹å®‰å…¨ç‰ˆæœ¬12345678910111213141516171819class ThreadingTee:    def __init__(self, tee_obj, lock):        self.tee_obj = tee_obj        self.lock = lock    def __iter__(self):        return self    def __next__(self):        with self.lock:            return next(self.tee_obj)    def __copy__(self):        return ThreadingTee(self.tee_obj.__copy__(), self.lock)    def threading_tee(iterable, n=2):        &quot;&quot;&quot;tuple of n independent thread-safe iterators&quot;&quot;&quot;        lock = Lock()        return tuple(ThreadingTee(tee_obj, lock) for tee_obj in itertools.tee(iterable, n))ç»„åˆç”Ÿæˆå™¨itertools æ¨¡å—è¿˜æä¾›äº†å¤šä¸ªç»„åˆç”Ÿæˆå™¨å‡½æ•°ï¼Œç”¨äºæ±‚åºåˆ—çš„æ’åˆ—ã€ç»„åˆç­‰productpermutationscombinationscombinations_with_replacementIteratorArgumentsResultsproduct()p, q, â€¦ [repeat=1]cartesian product, equivalent to a nested for-looppermutations()p[, r]r-length tuples, all possible orderings, no repeated elementscombinations()p, rr-length tuples, in sorted order, no repeated elementscombinations_with_replacement()p, rr-length tuples, in sorted order, with repeated elementsproduct('ABCD', repeat=2)AA AB AC AD BA BB BC BD CA CB CC CD DA DB DC DDpermutations('ABCD', 2)AB AC AD BA BC BD CA CB CD DA DB DCcombinations('ABCD', 2)AB AC AD BC BD CDcombinations_with_replacement('ABCD', 2)AA AB AC AD BB BC BD CC CD DD1234567891011121314151617181920212223242526272829303132333435# product ç”¨äºæ±‚å¤šä¸ªå¯è¿­ä»£å¯¹è±¡çš„ç¬›å¡å°”ç§¯ï¼Œå®ƒè·ŸåµŒå¥—çš„ for å¾ªç¯ç­‰ä»·ã€‚å®ƒçš„ä¸€èˆ¬ä½¿ç”¨å½¢å¼å¦‚ä¸‹ï¼š# product(iter1, iter2, ... iterN, [repeat=1])# å…¶ä¸­ï¼Œrepeat æ˜¯ä¸€ä¸ªå…³é”®å­—å‚æ•°ï¼Œç”¨äºæŒ‡å®šé‡å¤ç”Ÿæˆåºåˆ—çš„æ¬¡æ•°ï¼Œ&gt;&gt;&gt; for item in product('ABCD', 'xy'):...     print(item)('A', 'x')('A', 'y')('B', 'x')('B', 'y')('C', 'x')('C', 'y')('D', 'x')('D', 'y')&gt;&gt;&gt; list(product('ABC', repeat=2))[('A', 'A'), ('A', 'B'), ('A', 'C'), ('B', 'A'), ('B', 'B'), ('B', 'C'), ('C', 'A'), ('C', 'B'), ('C', 'C')]# permutations ç”¨äºç”Ÿæˆä¸€ä¸ªæ’åˆ—ï¼Œå®ƒçš„ä¸€èˆ¬ä½¿ç”¨å½¢å¼å¦‚ä¸‹ï¼š# permutations(iterable[, r])# å…¶ä¸­ï¼Œr æŒ‡å®šç”Ÿæˆæ’åˆ—çš„å…ƒç´ çš„é•¿åº¦ï¼Œå¦‚æœä¸æŒ‡å®šï¼Œåˆ™é»˜è®¤ä¸ºå¯è¿­ä»£å¯¹è±¡çš„å…ƒç´ é•¿åº¦ã€‚&gt;&gt;&gt; list(permutations('ABC', 2))[('A', 'B'), ('A', 'C'), ('B', 'A'), ('B', 'C'), ('C', 'A'), ('C', 'B')]&gt;&gt;&gt; list(permutations('ABC'))[('A', 'B', 'C'), ('A', 'C', 'B'), ('B', 'A', 'C'), ('B', 'C', 'A'), ('C', 'A', 'B'), ('C', 'B', 'A')]# combinations ç”¨äºæ±‚åºåˆ—çš„ç»„åˆï¼Œå®ƒçš„ä½¿ç”¨å½¢å¼å¦‚ä¸‹ï¼š# combinations(iterable, r)# å…¶ä¸­ï¼Œr æŒ‡å®šç”Ÿæˆç»„åˆçš„å…ƒç´ çš„é•¿åº¦ã€‚&gt;&gt;&gt; from itertools import combinations&gt;&gt;&gt; list(combinations('ABC', 2))[('A', 'B'), ('A', 'C'), ('B', 'C')]# combinations_with_replacement å’Œ combinations ç±»ä¼¼ï¼Œä½†å®ƒç”Ÿæˆçš„ç»„åˆåŒ…å«è‡ªèº«å…ƒç´ ã€‚&gt;&gt;&gt; from itertools import combinations_with_replacement&gt;&gt;&gt; list(combinations_with_replacement('ABC', 2))[('A', 'A'), ('A', 'B'), ('A', 'C'), ('B', 'B'), ('B', 'C'), ('C', 'C')]å…¶ä»–æ–¹æ³•accumulateå¯¹iterableå¯¹è±¡é€ä¸ªè¿›è¡Œfuncæ“ä½œ(é»˜è®¤æ˜¯ç´¯åŠ )1itertools.accumulate(iterable[, func, *, initial=None])123456&gt;&gt;&gt; from itertools import accumulate&gt;&gt;&gt; import operator  # operator --- æ ‡å‡†è¿ç®—ç¬¦æ›¿ä»£å‡½æ•°&gt;&gt;&gt; a = [1,2,3,4,5]&gt;&gt;&gt; b = accumulate(a)  # é»˜è®¤æ˜¯ç´¯åŠ  è¿™é‡Œè¿”å›çš„æ˜¯ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡&gt;&gt;&gt; list(b)   # å¼ºåˆ¶è½¬åŒ–[1, 3, 6, 10, 15]ä½¿ç”¨ç°æœ‰æ‰©å±•åŠŸèƒ½ä½¿ç”¨å†…ç½®çš„itertoolså¯ä»¥ç»„åˆæ‰©å±•å‡ºæ›´å¤šæ›´å¼ºå¤§åŠŸèƒ½çš„æ–¹æ³•123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161def take(n, iterable):    &quot;Return first n items of the iterable as a list&quot;    return list(islice(iterable, n))def tabulate(function, start=0):    &quot;Return function(0), function(1), ...&quot;    return imap(function, count(start))def consume(iterator, n):    &quot;Advance the iterator n-steps ahead. If n is none, consume entirely.&quot;    # Use functions that consume iterators at C speed.    if n is None:        # feed the entire iterator into a zero-length deque        collections.deque(iterator, maxlen=0)    else:        # advance to the empty slice starting at position n        next(islice(iterator, n, n), None)def nth(iterable, n, default=None):    &quot;Returns the nth item or a default value&quot;    return next(islice(iterable, n, None), default)def quantify(iterable, pred=bool):    &quot;Count how many times the predicate is true&quot;    return sum(imap(pred, iterable))def padnone(iterable):    &quot;&quot;&quot;Returns the sequence elements and then returns None indefinitely.    Useful for emulating the behavior of the built-in map() function.    &quot;&quot;&quot;    return chain(iterable, repeat(None))def ncycles(iterable, n):    &quot;Returns the sequence elements n times&quot;    return chain.from_iterable(repeat(tuple(iterable), n))def dotproduct(vec1, vec2):    return sum(imap(operator.mul, vec1, vec2))def flatten(listOfLists):    &quot;Flatten one level of nesting&quot;    return chain.from_iterable(listOfLists)def repeatfunc(func, times=None, *args):    &quot;&quot;&quot;Repeat calls to func with specified arguments.    Example:  repeatfunc(random.random)    &quot;&quot;&quot;    if times is None:        return starmap(func, repeat(args))    return starmap(func, repeat(args, times))def pairwise(iterable):    &quot;s -&gt; (s0,s1), (s1,s2), (s2, s3), ...&quot;    a, b = tee(iterable)    next(b, None)    return izip(a, b)def grouper(iterable, n, fillvalue=None):    &quot;Collect data into fixed-length chunks or blocks&quot;    # grouper('ABCDEFG', 3, 'x') --&gt; ABC DEF Gxx    args = [iter(iterable)] * n    return izip_longest(fillvalue=fillvalue, *args)def roundrobin(*iterables):    &quot;roundrobin('ABC', 'D', 'EF') --&gt; A D E B F C&quot;    # Recipe credited to George Sakkis    pending = len(iterables)    nexts = cycle(iter(it).next for it in iterables)    while pending:        try:            for next in nexts:                yield next()        except StopIteration:            pending -= 1            nexts = cycle(islice(nexts, pending))def powerset(iterable):    &quot;powerset([1,2,3]) --&gt; () (1,) (2,) (3,) (1,2) (1,3) (2,3) (1,2,3)&quot;    s = list(iterable)    return chain.from_iterable(combinations(s, r) for r in range(len(s)+1))def unique_everseen(iterable, key=None):    &quot;List unique elements, preserving order. Remember all elements ever seen.&quot;    # unique_everseen('AAAABBBCCDAABBB') --&gt; A B C D    # unique_everseen('ABBCcAD', str.lower) --&gt; A B C D    seen = set()    seen_add = seen.add    if key is None:        for element in ifilterfalse(seen.__contains__, iterable):            seen_add(element)            yield element    else:        for element in iterable:            k = key(element)            if k not in seen:                seen_add(k)                yield elementdef unique_justseen(iterable, key=None):    &quot;List unique elements, preserving order. Remember only the element just seen.&quot;    # unique_justseen('AAAABBBCCDAABBB') --&gt; A B C D A B    # unique_justseen('ABBCcAD', str.lower) --&gt; A B C A D    return imap(next, imap(itemgetter(1), groupby(iterable, key)))def iter_except(func, exception, first=None):    &quot;&quot;&quot; Call a function repeatedly until an exception is raised.    Converts a call-until-exception interface to an iterator interface.    Like __builtin__.iter(func, sentinel) but uses an exception instead    of a sentinel to end the loop.    Examples:        bsddbiter = iter_except(db.next, bsddb.error, db.first)        heapiter = iter_except(functools.partial(heappop, h), IndexError)        dictiter = iter_except(d.popitem, KeyError)        dequeiter = iter_except(d.popleft, IndexError)        queueiter = iter_except(q.get_nowait, Queue.Empty)        setiter = iter_except(s.pop, KeyError)    &quot;&quot;&quot;    try:        if first is not None:            yield first()        while 1:            yield func()    except exception:        passdef random_product(*args, **kwds):    &quot;Random selection from itertools.product(*args, **kwds)&quot;    pools = map(tuple, args) * kwds.get('repeat', 1)    return tuple(random.choice(pool) for pool in pools)def random_permutation(iterable, r=None):    &quot;Random selection from itertools.permutations(iterable, r)&quot;    pool = tuple(iterable)    r = len(pool) if r is None else r    return tuple(random.sample(pool, r))def random_combination(iterable, r):    &quot;Random selection from itertools.combinations(iterable, r)&quot;    pool = tuple(iterable)    n = len(pool)    indices = sorted(random.sample(xrange(n), r))    return tuple(pool[i] for i in indices)def random_combination_with_replacement(iterable, r):    &quot;Random selection from itertools.combinations_with_replacement(iterable, r)&quot;    pool = tuple(iterable)    n = len(pool)    indices = sorted(random.randrange(n) for i in xrange(r))    return tuple(pool[i] for i in indices)def tee_lookahead(t, i):    &quot;&quot;&quot;Inspect the i-th upcomping value from a tee object    while leaving the tee object at its current position.    Raise an IndexError if the underlying iterator doesn't    have enough values.    &quot;&quot;&quot;    for value in islice(t.__copy__(), i, None):        return value    raise IndexError(i)è‡ªå®šä¹‰æ‰©å±•1234567891011121314# å°†åºåˆ—æŒ‰å¤§å°åˆ‡åˆ†,æ›´å¥½çš„æ€§èƒ½from itertools import chain, islicedef chunks(iterable, size, format=iter):    it = iter(iterable)    while True:        yield format(chain((it.next(),), islice(it, size - 1)))&gt;&gt;&gt; l = [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, &quot;f&quot;, &quot;g&quot;]&gt;&gt;&gt; for chunk in chunks(l, 3, tuple):        print(chunk)(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;)(&quot;d&quot;, &quot;e&quot;, &quot;f&quot;)(&quot;g&quot;,)pythonåç¨‹è°ˆè°ˆPythonåç¨‹æŠ€æœ¯çš„æ¼”è¿›è°ˆè°ˆPythonåç¨‹æŠ€æœ¯çš„æ¼”è¿›Pythonåç¨‹ä»å…¥é—¨åˆ°æ”¾å¼ƒåˆ°æ­»äº¡åˆ°é‡ç”ŸPythonåç¨‹çš„æ¼”åŒ–-ä»yield/sendåˆ°async/awaitåç¨‹çš„å®ç°æ–¹å¼æœ‰å¾ˆå¤šï¼Œè¿™é‡Œæˆ‘ä»¬æ¥åˆ—ä¸¾ä¸‰ç§åŸºæœ¬æ–¹å¼åˆ©ç”¨ yield æ¥å®ç°åç¨‹åˆ©ç”¨ greenlet æ¨¡å—å®ç°åˆ©ç”¨ gevent æ¨¡å—å®ç°å¹¶è¡Œä¸å¹¶å‘å¹¶è¡Œæ˜¯æŒ‡ä¸¤ä¸ªæˆ–è€…å¤šä¸ªäº‹ä»¶åœ¨åŒä¸€æ—¶åˆ»å‘ç”Ÿï¼Œé€šå¸¸æ˜¯å½“ç³»ç»Ÿæœ‰ä¸€ä¸ªä»¥ä¸ŠCPUæˆ–CPUæ ¸å¿ƒæ—¶ï¼Œæ‰æœ‰å¯èƒ½å¹¶è¡Œä¸¤ä¸ªæˆ–è€…å¤šä¸ªäº‹ä»¶ã€çº¿ç¨‹å¹¶æ­¥æŠ¢å CPUèµ„æºå¹¶å‘æ˜¯æŒ‡ä¸¤ä¸ªæˆ–è€…å¤šä¸ªäº‹ä»¶åœ¨åŒä¸€æ—¶é—´é—´éš”å†…å‘ç”Ÿåœ¨ä¸€å®šæ—¶é—´é—´éš”å†…ï¼Œæœ‰å¤šä¸ªç¨‹åºåœ¨æ‰§è¡Œï¼Œä½†åœ¨åŒä¸€æ—¶åˆ»ï¼Œåªæœ‰ä¸€ä¸ªç¨‹åºåœ¨æ‰§è¡Œç”Ÿæˆå™¨å’Œåç¨‹åç¨‹çš„æ¦‚å¿µåç¨‹é€šè¿‡å…è®¸å¤šä¸ªå…¥å£ç‚¹åœ¨æŸäº›ä½ç½®æš‚åœå’Œæ¢å¤æ‰§è¡Œæ¥æ¦‚æ‹¬ç”¨äºéæŠ¢å å¼å¤šä»»åŠ¡çš„å­ç¨‹åºyield å…³é”®å­—å·²ç»å¯ä»¥æš‚åœæ‰§è¡Œï¼Œå¦‚æœåœ¨æš‚åœåæœ‰æ–¹æ³•æŠŠä¸€äº›å€¼å‘é€å›åˆ°æš‚åœçª’æ¯çš„å‡½æ•°ä¸­ï¼Œé‚£ä¹ˆä¾¿å°±å¯ä»¥ç†è§£ä¸ºåç¨‹æ·»åŠ äº†æŠŠä¸œè¥¿å‘å›å·²ç»æš‚åœçš„ç”Ÿæˆå™¨ä¸­çš„æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å°±æ˜¯ send()ç”Ÿæˆå™¨å’Œåç¨‹ä»è¯­æ³•ä¸Šè®²ï¼Œç”Ÿæˆå™¨æ˜¯ä¸€ä¸ªå¸¦yieldè¯­å¥çš„å‡½æ•°ã€‚åç¨‹ï¼Œåˆç§°å¾®çº¿ç¨‹ï¼Œçº¤ç¨‹ï¼Œè‹±æ–‡Coroutineä»æŸäº›è§’åº¦æ¥ç†è§£ï¼Œåç¨‹å…¶å®å°±æ˜¯ä¸€ä¸ªå¯ä»¥æš‚åœæ‰§è¡Œçš„å‡½æ•°ï¼Œå¹¶ä¸”å¯ä»¥æ¢å¤ç»§ç»­æ‰§è¡Œç”Ÿæˆå™¨å’Œåç¨‹éƒ½æ˜¯é€šè¿‡ python ä¸­ yield çš„å…³é”®å­—å®ç°çš„next()å’Œsend()ç”Ÿæˆå™¨åªè°ƒç”¨ next æ¥ä¸æ–­çš„ç”Ÿæˆæ•°æ®ï¼Œè€Œåç¨‹ä¼šè°ƒç”¨ next å’Œ send æ¥è¿”å›ç»“æœå’Œæ¥æ”¶å‚æ•°ä¸.__next__() æ–¹æ³•ä¸€æ ·ï¼Œ.send() æ–¹æ³•è‡´ä½¿ç”Ÿæˆå™¨å‰è¿›åˆ°ä¸‹ä¸€ä¸ª yield è¯­å¥ä¸è¿‡.send() æ–¹æ³•è¿˜å…è®¸ä½¿ç”¨ç”Ÿæˆå™¨çš„å®¢æˆ·æŠŠæ•°æ®å‘ç»™è‡ªå·±ï¼Œå³ä¸ç®¡ä¼ ç»™ .send() æ–¹æ³•ä»€ä¹ˆå‚æ•°ï¼Œé‚£ä¸ªå‚æ•°éƒ½ä¼šæˆä¸ºç”Ÿæˆå™¨å‡½æ•°å®šä¹‰ä½“ä¸­å¯¹åº”çš„ yield è¡¨è¾¾å¼çš„å€¼ä¹Ÿå°±æ˜¯è¯´ï¼Œ.send() æ–¹æ³•å…è®¸åœ¨å®¢æˆ·ä»£ç å’Œç”Ÿæˆå™¨ä¹‹é—´åŒå‘äº¤æ¢æ•°æ®è€Œ .__next__() æ–¹æ³•åªå…è®¸å®¢æˆ·ä»ç”Ÿæˆå™¨ä¸­è·å–æ•°æ®Python æ–°å¼•å…¥çš„ yield from å¥æ³•å…è®¸ç”Ÿæˆå™¨æˆ–åç¨‹æŠŠå·¥ä½œå§”æ‰˜ç»™ç¬¬ä¸‰æ–¹å®Œæˆï¼Œè¿™æ ·å°±æ— éœ€åµŒå¥— for å¾ªç¯ä½œä¸ºå˜é€šäº†123456789101112131415161718192021222324252627282930313233343536import random,timedef stupid_fib(n):    index = 0    a = 0    b = 1    while index &lt; n:        sleep_cnt = yield b        print('let me think {0} secs'.format(sleep_cnt))        time.sleep(sleep_cnt)        a, b = b, a + b        index += 1        print('-'*10 + 'test yield send' + '-'*10)N = 5sfib = stupid_fib(N)fib_res = next(sfib)while True:    print(fib_res)    try:        fib_res = sfib.send(random.uniform(0, 0.5))    except StopIteration:        break    ----------test yield send----------1let me think 0.2438615286011866 secs1let me think 0.027476256830278822 secs2let me think 0.09717699872403579 secs3let me think 0.017161862262742633 secs5let me think 0.3313821890336833 secså…¶ä¸­ next(sfib) ç›¸å½“äº sfib.send(None)ï¼Œå¯ä»¥ä½¿å¾— sfib è¿è¡Œè‡³ç¬¬ä¸€ä¸ª yield å¤„è¿”å›åç»­å°†ä¸€ä¸ªéšæœºçš„ç§’æ•°å‘é€ç»™ sfib ï¼Œä½œä¸ºå½“å‰ä¸­æ–­çš„ yield è¡¨è¾¾å¼çš„è¿”å›å€¼yield è¡¨è¾¾å¼çš„ä½œç”¨åŒ…å«äº†ä¸‰ä¸ªæ­¥éª¤ï¼šå‘å‡½æ•°å¤–æŠ›å‡ºå€¼æš‚åœï¼Œç­‰å¾… next() æˆ– send() æ¢å¤èµ‹å€¼ï¼Œæ¥å— send å‘é€è¿‡æ¥çš„æ•°æ®éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä½¿ç”¨ send(None) æˆ–è€… next() é¢„æ¿€ç”Ÿæˆå™¨å‡½æ•°ï¼Œå¹¶æ‰§è¡Œåˆ°ç¬¬ä¸€ä¸ª yield è¯­å¥ç»“æŸçš„ä½ç½®æ—¶ï¼Œå®é™…ç¨‹åºåªæ‰§è¡Œäº†1ã€2ä¸¤æ­¥ï¼Œç¨‹åºè¿”å›äº†å€¼ï¼Œå¹¶æš‚åœï¼Œå¹¶æ²¡æœ‰æ‰§è¡Œç¬¬ä¸‰æ­¥å»èµ‹å€¼ã€‚åœ¨åç»­çš„å¾ªç¯ä¸­ï¼Œæ‰ä¼šè¿›è¡Œèµ‹å€¼ã€‚ç”Ÿæˆå™¨å¯¹è±¡æœ‰ send ã€throw å’Œ close æ–¹æ³•ï¼Œè¿™ä¸‰ä¸ªæ–¹æ³•çš„ä½œç”¨åˆ†åˆ«æ˜¯ï¼šå‘é€æ•°æ®ç»™ç”Ÿæˆå™¨å¹¶èµ‹å€¼ç»™ yield è¯­å¥å‘ç”Ÿæˆå™¨ä¸­æŠ›å…¥å¼‚å¸¸ç”±ç”Ÿæˆå™¨å†…éƒ¨å¤„ç†ç»ˆæ­¢ç”Ÿæˆå™¨è¿™ä¸‰ä¸ªæ–¹æ³•ä½¿å¾—ç”Ÿæˆå™¨è¿›åŒ–æˆåç¨‹åç¨‹çŠ¶æ€åç¨‹æœ‰å››ç§å­˜åœ¨çŠ¶æ€ï¼šGEN_CREATED åˆ›å»ºå®Œæˆï¼Œç­‰å¾…æ‰§è¡ŒGEN_RUNNING è§£é‡Šå™¨æ­£åœ¨æ‰§è¡Œï¼ˆè¿™ä¸ªçŠ¶æ€åœ¨ä¸‹é¢çš„ç¤ºä¾‹ç¨‹åºä¸­æ— æ³•çœ‹åˆ°ï¼‰GEN_SUSPENDED åœ¨ yield è¡¨è¾¾å¼å¤„æš‚åœGEN_CLOSE æ‰§è¡Œç»“æŸï¼Œç”Ÿæˆå™¨åœæ­¢å¯ä»¥ä½¿ç”¨ inspect.getgeneratorstate æ–¹æ³•æŸ¥çœ‹åç¨‹çš„å½“å‰çŠ¶æ€12345678910111213141516171819202122232425262728293031323334In [202]: import inspectIn [203]: def generator():     ...:     i = 'æ¿€æ´»ç”Ÿæˆå™¨'     ...:     while True:     ...:         try:     ...:             value = yield i     ...:         except ValueError:     ...:             print('OVER')     ...:         i = value     ...:In [204]: g = generator()  # 1In [205]: inspect.getgeneratorstate(g)  # 2Out[205]: 'GEN_CREATED'In [206]: next(g)  # 3Out[206]: 'æ¿€æ´»ç”Ÿæˆå™¨'In [207]: inspect.getgeneratorstate(g)Out[207]: 'GEN_SUSPENDED'In [208]: g.send('Hello Shiyanlou')  # 4Out[208]: 'Hello Shiyanlou'In [209]: g.throw(ValueError)  # 5OVEROut[209]: 'Hello Shiyanlou'In [210]: g.close()  # 6In [211]: inspect.getgeneratorstate(g)Out[211]: 'GEN_CLOSED'ä»£ç è¯´æ˜åˆ›å»ºç”Ÿæˆå™¨æŸ¥çœ‹ç”Ÿæˆå™¨çŠ¶æ€è¿™æ­¥æ“ä½œå«åšé¢„æ¿€ç”Ÿæˆå™¨ï¼ˆæˆ–åç¨‹ï¼‰ï¼Œè¿™æ˜¯å¿…é¡»åšçš„ã€‚åœ¨ç”Ÿæˆå™¨åˆ›å»ºå®Œæˆåï¼Œéœ€è¦å°†å…¶ç¬¬ä¸€æ¬¡è¿è¡Œåˆ° yield è¯­å¥å¤„æš‚åœæš‚åœçŠ¶æ€çš„ç”Ÿæˆå™¨å¯ä»¥ä½¿ç”¨ send æ–¹æ³•å‘é€æ•°æ®ï¼Œæ­¤æ–¹æ³•çš„å‚æ•°å°±æ˜¯ yield è¡¨è¾¾å¼çš„å€¼ä¹Ÿå°±æ˜¯ yield è¡¨è¾¾å¼ç­‰å·å‰é¢çš„ value å˜é‡çš„å€¼å˜æˆ â€˜Hello Shiyanlouâ€™ï¼Œç»§ç»­å‘ä¸‹æ‰§è¡Œå®Œä¸€æ¬¡ while å¾ªç¯ï¼Œå˜é‡ i è¢«èµ‹å€¼ï¼Œç»§ç»­è¿è¡Œä¸‹ä¸€æ¬¡å¾ªç¯ï¼Œyield è¡¨è¾¾å¼å¼¹å‡ºå˜é‡ iå‘ç”Ÿæˆå™¨æŠ›å…¥å¼‚å¸¸ï¼Œå¼‚å¸¸ä¼šè¢« try except æ•è·ï¼Œä½œè¿›ä¸€æ­¥å¤„ç†close æ–¹æ³•ç»ˆæ­¢ç”Ÿæˆå™¨ï¼Œå¼‚å¸¸ä¸ä¼šè¢«æŠ›å‡ºå› ä¸ºç”Ÿæˆå™¨çš„è°ƒç”¨æ–¹ä¹Ÿå°±æ˜¯ç¨‹åºå‘˜è‡ªå·±å¯ä»¥æ§åˆ¶ç”Ÿæˆå™¨çš„å¯åŠ¨ã€æš‚åœã€ç»ˆæ­¢ï¼Œè€Œä¸”å¯ä»¥å‘ç”Ÿæˆå™¨å†…éƒ¨ä¼ å…¥æ•°æ®æ‰€ä»¥è¿™ç§ç”Ÿæˆå™¨åˆå«åšåç¨‹ï¼Œgenerator å‡½æ•°æ—¢å¯ä»¥å«åšç”Ÿæˆå™¨å‡½æ•°ï¼Œä¹Ÿå¯ä»¥å«åç¨‹å‡½æ•°ï¼Œè¿™æ˜¯ç”Ÿæˆå™¨å‘åç¨‹çš„è¿‡æ¸¡é˜¶æ®µyield fromåœ¨ Python3.3 å‡ºç°äº† yield from è¯­æ³•, yield from item è¡¨è¾¾å¼ä» item ä¸­è·å¾—è¿­ä»£å™¨yield from å¯ä»¥ä»£æ›¿ for å¾ªç¯ï¼Œä½¿å¾—ä»£ç æ›´ä¸ºç²¾ç‚¼ï¼Œyield from åé¢éœ€è¦åŠ çš„æ˜¯å¯è¿­ä»£å¯¹è±¡yield from i å®Œå…¨ä»£æ›¿äº†å†…å±‚çš„ for å¾ªç¯ã€‚è€Œä¸”ä»£ç è¯»èµ·æ¥æ›´é¡ºç•…ï¼Œä¸è¿‡æ„Ÿè§‰æ›´åƒæ˜¯è¯­æ³•ç³–é™¤äº†ä»£æ›¿å¾ªç¯ä¹‹å¤–ï¼Œyield from è¿˜ä¼šåˆ›å»ºé€šé“ï¼ŒæŠŠå†…å±‚ç”Ÿæˆå™¨ç›´æ¥ä¸å¤–å±‚ç”Ÿæˆå™¨çš„å®¢æˆ·ç«¯è”ç³»èµ·æ¥æŠŠç”Ÿæˆå™¨å½“æˆåç¨‹ä½¿ç”¨æ—¶ï¼Œè¿™ä¸ªé€šé“ç‰¹åˆ«é‡è¦ï¼Œä¸ä»…èƒ½ä¸ºå®¢æˆ·ç«¯ä»£ç ç”Ÿæˆå€¼ï¼Œè¿˜èƒ½ä½¿ç”¨å®¢æˆ·ç«¯ä»£ç æä¾›çš„å€¼123456789101112131415# yield fromdef first_gen():    for c in &quot;AB&quot;:        yield c    for i in range(0, 3):        yield iprint(list(first_gen()))def second_gen():    yield from &quot;AB&quot;    yield from range(0, 3)print(list(second_gen()))['A', 'B', 0, 1, 2]['A', 'B', 0, 1, 2]å½“ yiled from åé¢åŠ ä¸Šä¸€ä¸ªç”Ÿæˆå™¨ä¹‹åï¼Œå°±å®ç°äº†ç”Ÿæˆçš„åµŒå¥—ã€‚å®ç°ç”Ÿæˆå™¨çš„åµŒå¥—ï¼Œä¸ä¸€å®šè¦ä½¿ç”¨ yield fromä½†å®ƒå¯ä»¥è®©æˆ‘ä»¬é¿å…è®©è‡ªå·±å¤„ç†å„ç§æ–™æƒ³ä¸åˆ°çš„å¼‚å¸¸ï¼Œå¦‚æœè‡ªå·±å»å®ç°ï¼Œä¼šåŠ å¤§ç¼–ç çš„éš¾åº¦ã€‚yield from çš„ä¸»è¦åŠŸèƒ½æ˜¯æ‰“å¼€åŒå‘é€šé“ï¼ŒæŠŠæœ€å¤–å±‚çš„è°ƒç”¨ä¸æœ€å†…å±‚çš„å­ç”Ÿæˆå™¨è¿æ¥èµ·æ¥è¿™æ ·äºŒè€…å°±å¯ä»¥ç›´æ¥å‘é€å’Œäº§å‡ºå€¼ï¼Œè¿˜å¯ä»¥ç›´æ¥ç©¿å…¥å¼‚å¸¸å§”æ´¾ç”Ÿæˆå™¨åœ¨ yied from è¡¨è¾¾å¼å¤„æš‚åœæ—¶ï¼Œè°ƒç”¨æ–¹å¯ä»¥ç›´æ¥æŠŠæ•°æ®å‘ç»™å­ç”Ÿæˆå™¨å­ç”Ÿæˆå™¨å†æŠŠäº§å‡ºå€¼å‘ç»™è°ƒç”¨æ–¹ï¼Œå­ç”Ÿæˆå™¨è¿”å›ä¹‹åï¼Œè§£é‡Šå™¨ä¼šæŠ›å‡º StopIteration å¼‚å¸¸å§”æ‰˜ç”Ÿæˆå™¨çš„ä½œç”¨å°±æ˜¯ï¼šåœ¨è°ƒç”¨æ–¹ä¸å­ç”Ÿæˆå™¨ä¹‹é—´å»ºç«‹ä¸€ä¸ªåŒå‘é€šé“ä¸ºä»€ä¹ˆä¸€å®šè¦ä½¿ç”¨ yield from è¯­å¥å‘¢ï¼šåœ¨ä½¿ç”¨ yiled from è¯­å¥æ—¶ï¼Œè¯­å¥ä¸ºæˆ‘ä»¬å·²ç»å¤„ç†äº†å¾ˆå¤šçš„å¼‚å¸¸yield from è·å–è¿”å›å€¼pythonåç¨‹ç³»åˆ—ï¼ˆä¸‰ï¼‰â€”â€”yield fromåŸç†è¯¦è§£åœ¨ä½¿ç”¨yieldç”Ÿæˆå™¨çš„æ—¶å€™ï¼Œå¦‚æœä½¿ç”¨forè¯­å¥å»è¿­ä»£ç”Ÿæˆå™¨ï¼Œåˆ™ä¸ä¼šæ˜¾å¼çš„å‡ºå‘StopIterationå¼‚å¸¸ï¼Œè€Œæ˜¯è‡ªåŠ¨æ•è·StopIterationå¼‚å¸¸æ‰€ä»¥å¦‚æœé‡åˆ°returnï¼Œåªæ˜¯ä¼šç»ˆæ­¢è¿­ä»£ï¼Œè€Œä¸ä¼šè§¦å‘å¼‚å¸¸ï¼Œæ•…è€Œä¹Ÿå°±æ²¡åŠæ³•è·å–returnçš„å€¼123456789101112131415161718192021defÂ my_generator():Â Â Â Â forÂ iÂ inÂ range(5):Â Â Â Â Â Â Â Â ifÂ i==2:Â Â Â Â Â Â Â Â Â Â Â Â returnÂ 'æˆ‘è¢«è¿«ä¸­æ–­äº†'Â Â Â Â Â Â Â Â else:Â Â Â Â Â Â Â Â Â Â Â Â yieldÂ idefÂ main(generator):Â Â Â Â try:Â Â Â Â Â Â Â Â forÂ iÂ inÂ generator:Â Â #ä¸ä¼šæ˜¾å¼è§¦å‘å¼‚å¸¸ï¼Œæ•…è€Œæ— æ³•è·å–åˆ°returnçš„å€¼Â Â Â Â Â Â Â Â Â Â Â Â print(i)Â Â Â Â exceptÂ StopIterationÂ asÂ exc:Â Â Â Â Â Â Â Â print(exc.value)g=my_generator()Â Â #è°ƒç”¨main(g)'''è¿è¡Œç»“æœä¸ºï¼š01'''ä»ä¸Šé¢çš„ä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œforè¿­ä»£è¯­å¥ä¸ä¼šæ˜¾å¼è§¦å‘å¼‚å¸¸ï¼Œæ•…è€Œæ— æ³•è·å–åˆ°returnçš„å€¼è¿­ä»£åˆ°2çš„æ—¶å€™é‡åˆ°returnè¯­å¥ï¼Œéšå¼çš„è§¦å‘äº†StopIterationå¼‚å¸¸ï¼Œå°±ç»ˆæ­¢è¿­ä»£äº†ï¼Œä½†æ˜¯åœ¨ç¨‹åºä¸­ä¸ä¼šæ˜¾ç¤ºå‡ºæ¥12345678910111213141516171819202122232425defÂ my_generator():Â Â Â Â forÂ iÂ inÂ range(5):Â Â Â Â Â Â Â Â ifÂ i==2:Â Â Â Â Â Â Â Â Â Â Â Â returnÂ 'æˆ‘è¢«è¿«ä¸­æ–­äº†'Â Â Â Â Â Â Â Â else:Â Â Â Â Â Â Â Â Â Â Â Â yieldÂ idefÂ main(generator):Â Â Â Â try:Â Â Â Â Â Â Â Â print(next(generator))Â Â Â #æ¯æ¬¡è¿­ä»£ä¸€ä¸ªå€¼ï¼Œåˆ™ä¼šæ˜¾å¼å‡ºå‘StopIterationÂ Â Â Â Â Â Â Â print(next(generator))Â Â Â Â Â Â Â Â print(next(generator))Â Â Â Â Â Â Â Â print(next(generator))Â Â Â Â Â Â Â Â print(next(generator))Â Â Â Â exceptÂ StopIterationÂ asÂ exc:Â Â Â Â Â Â Â Â print(exc.value)Â Â Â Â Â #è·å–è¿”å›çš„å€¼g=my_generator()main(g)'''è¿è¡Œç»“æœä¸ºï¼š01æˆ‘è¢«è¿«ä¸­æ–­äº†'''ç°åœ¨æˆ‘ä»¬ä½¿ç”¨yield fromæ¥å®Œæˆä¸Šé¢çš„åŒæ ·çš„åŠŸèƒ½123456789101112131415161718192021222324defÂ my_generator():Â Â Â Â forÂ iÂ inÂ range(5):Â Â Â Â Â Â Â Â ifÂ i==2:Â Â Â Â Â Â Â Â Â Â Â Â returnÂ 'æˆ‘è¢«è¿«ä¸­æ–­äº†'Â Â Â Â Â Â Â Â else:Â Â Â Â Â Â Â Â Â Â Â Â yieldÂ idefÂ wrap_my_generator(generator):Â Â #å®šä¹‰ä¸€ä¸ªåŒ…è£…â€œç”Ÿæˆå™¨â€çš„ç”Ÿæˆå™¨ï¼Œå®ƒçš„æœ¬è´¨è¿˜æ˜¯ç”Ÿæˆå™¨Â Â Â Â result = yieldÂ fromÂ generatorÂ Â Â Â #è‡ªåŠ¨è§¦å‘StopIterationå¼‚å¸¸ï¼Œå¹¶ä¸”å°†returnçš„è¿”å›å€¼èµ‹å€¼ç»™yieldÂ fromè¡¨è¾¾å¼çš„ç»“æœÂ Â Â Â print(result)defÂ main(generator):Â Â Â Â forÂ jÂ inÂ generator:Â Â Â Â Â Â Â Â print(j)g = my_generator()wrap_g = wrap_my_generator(g)main(wrap_g)Â Â #è°ƒç”¨'''è¿è¡Œç»“æœä¸ºï¼š01æˆ‘è¢«è¿«ä¸­æ–­äº†'''ä»ä¸Šé¢çš„æ¯”è¾ƒå¯ä»¥çœ‹å‡ºï¼Œyield fromå…·æœ‰ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼šè°ƒç”¨æ–¹â€”&gt;ç”Ÿæˆå™¨å‡½æ•°(åç¨‹å‡½æ•°)è°ƒç”¨æ–¹â€”&gt;ç”Ÿæˆå™¨åŒ…è£…å‡½æ•°â€”&gt;ç”Ÿæˆå™¨å‡½æ•°(åç¨‹å‡½æ•°)returnè¿”å›çš„å€¼æˆ–è€…æ˜¯StopIterationçš„value å±æ€§çš„å€¼å˜æˆ yield from è¡¨è¾¾å¼çš„å€¼ï¼Œå³ä¸Šé¢çš„resultgreenlet å’Œ geventgreenletå¯ä»¥å®ç°åç¨‹ï¼Œä¸è¿‡æ¯ä¸€æ¬¡éƒ½è¦äººä¸ºå»æŒ‡å‘ä¸‹ä¸€ä¸ªè¯¥æ‰§è¡Œçš„åç¨‹greenlet å¯ä»¥ä»ä¸€ä¸ªåç¨‹åˆ‡æ¢åˆ°ä»»æ„å…¶ä»–åç¨‹ï¼Œä½†å¿…é¡»ä¿è¯ greenlet çš„æ­£å¸¸ç»“æŸï¼Œåœ¨åç¨‹ä¹‹é—´çš„ä»»æ„åˆ‡æ¢å¾ˆå®¹æ˜“å‡ºç°é—®é¢˜greelet æ˜¯ Stackless å‘å±•æ¥çš„ Cpython æ‰©å±•åŒ…ï¼Œ greelet æ˜¯åº•å±‚å®ç°äº†åŸç”Ÿåç¨‹çš„Cæ‰©å±•åº“è¿­ä»£å™¨(å³å¯æŒ‡å­ç”Ÿæˆå™¨)äº§ç”Ÿçš„å€¼ç›´æ¥è¿”è¿˜ç»™è°ƒç”¨è€…ä»»ä½•ä½¿ç”¨send()æ–¹æ³•å‘ç»™å§”æ´¾ç”Ÿäº§å™¨(å³å¤–éƒ¨ç”Ÿäº§å™¨)çš„å€¼è¢«ç›´æ¥ä¼ é€’ç»™è¿­ä»£å™¨ã€‚å¦‚æœsendå€¼æ˜¯Noneï¼Œåˆ™è°ƒç”¨è¿­ä»£å™¨next()æ–¹æ³•ï¼›å¦‚æœä¸ä¸ºNoneï¼Œåˆ™è°ƒç”¨è¿­ä»£å™¨çš„send()æ–¹æ³•ã€‚å¦‚æœå¯¹è¿­ä»£å™¨çš„è°ƒç”¨äº§ç”ŸStoplterationå¼‚å¸¸ï¼Œå§”æ´¾ç”Ÿäº§å™¨æ¢å¤ç»§ç»­æ‰§è¡Œyield fromåé¢çš„è¯­å¥ï¼›è‹¥è¿­ä»£å™¨äº§ç”Ÿå…¶ä»–ä»»ä½•å¼‚å¸¸ï¼Œåˆ™éƒ½ä¼ é€’ç»™å§”æ´¾ç”Ÿäº§å™¨å­ç”Ÿæˆå™¨å¯èƒ½åªæ˜¯ä¸€ä¸ªè¿­ä»£å™¨ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªä½œä¸ºåç¨‹çš„ç”Ÿæˆå™¨ï¼Œæ‰€ä»¥å®ƒä¸æ”¯æŒ.throw()å’Œ.close()æ–¹æ³•ï¼Œå³å¯èƒ½ä¼šäº§ç”ŸAttributeErrorå¼‚å¸¸é™¤äº†GeneratorExitå¼‚å¸¸å¤–çš„å…¶ä»–æŠ›ç»™å§”æ´¾ç”Ÿäº§å™¨çš„å¼‚å¸¸ï¼Œå°†ä¼šè¢«ä¼ é€’åˆ°è¿­ä»£å™¨çš„throw()æ–¹æ³•ï¼Œå¦‚æœè¿­ä»£å™¨throw()è°ƒç”¨äº§ç”Ÿäº†Stoplterationå¼‚å¸¸ï¼Œå§”æ´¾ç”Ÿäº§å™¨æ¢å¤å¹¶ç»§ç»­æ‰§è¡Œï¼Œå…¶ä»–å¼‚å¸¸åˆ™ä¼ é€’ç»™å§”æ´¾ç”Ÿäº§å™¨å¦‚æœGeneratorExitå¼‚å¸¸è¢«æŠ›ç»™å§”æ´¾ç”Ÿäº§å™¨ï¼Œæˆ–è€…å§”æ´¾ç”Ÿäº§å™¨çš„close()æ–¹æ³•è¢«è°ƒç”¨ï¼Œå¦‚æœè¿­ä»£å™¨æœ‰close()çš„è¯ä¹Ÿå°†è¢«è°ƒç”¨ã€‚å¦‚æœclose()è°ƒç”¨äº§ç”Ÿå¼‚å¸¸ï¼Œå¼‚å¸¸å°†ä¼ é€’ç»™å§”æ´¾ç”Ÿäº§å™¨ã€‚å¦åˆ™ï¼Œå§”æ´¾ç”Ÿäº§å™¨å°†æŠ›å‡ºGeneratorExit å¼‚å¸¸å½“è¿­ä»£å™¨ç»“æŸå¹¶æŠ›å‡ºå¼‚å¸¸æ—¶ï¼Œyield fromè¡¨è¾¾å¼çš„å€¼æ˜¯å…¶Stoplterationå¼‚å¸¸ä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸€ä¸ªç”Ÿæˆå™¨ä¸­çš„return exprè¯­å¥å°†ä¼šä»ç”Ÿæˆå™¨é€€å‡ºå¹¶æŠ›å‡º Stoplteration(expr)å¼‚å¸¸greenlet12345678910111213141516171819202122232425262728293031# ä½¿ç”¨ greenlet å®ç°çš„ ç”Ÿäº§è€…-æ¶ˆè´¹è€… æ¨¡å‹ï¼š# greenlet çš„ä»·å€¼åœ¨äºé«˜æ€§èƒ½çš„åŸç”Ÿåç¨‹ï¼Œä¸”è¯­ä¹‰æ›´åŠ æ˜ç¡®ã€æ˜¾å¼åˆ‡æ¢ï¼Œæ‰§è¡Œåˆ° switch æ—¶å°±åˆ‡æ¢ç¨‹åº# ç›´æ¥å°†å‡½æ•°åŒ…è£…æˆåç¨‹ï¼Œå¯ä»¥ä¿ç•™åŸä»£ç çš„é£æ ¼# åŸºäºgreenletçš„ç”Ÿäº§è€…æ¶ˆè´¹è€…åç¨‹from greenlet import greenletimport randomimport timedef Producer():    while True:        item = random.randint(1, 10)        print(&quot;ç”Ÿäº§&lt;{}&gt;ä¸­...&quot;.format(item))        time.sleep(1)        c.switch(item)  # åˆ‡æ¢åˆ°æ¶ˆè´¹è€…ï¼Œå¹¶å°†itemä¼ å…¥ã€‚def Consumer():    while True:        item = p.switch()  # åˆ‡æ¢åˆ°ç”Ÿäº§è€…ã€‚ç­‰å¾…ç”Ÿäº§è€…ä¼ é€’å‚æ•°item        print(&quot;æ¶ˆè´¹&lt;{}&gt;ä¸­..&quot;.format(item))c = greenlet(Consumer)  # å°†æ™®é€šå‡½æ•°ç¼–ç¨‹åç¨‹p = greenlet(Producer)  # åŒç†c.switch()  # å¯åŠ¨åç¨‹ï¼ŒConsumerå…ˆæ‰§è¡Œ&quot;&quot;&quot;ä»consumerå¼€å§‹æ‰§è¡Œï¼Œæ‰§è¡Œåˆ°item=p.switch()æ—¶ï¼Œç¨‹åºåˆ‡æ¢åˆ°producerï¼Œå¹¶ç­‰å¾…ä¼ å‚producerå¾—åˆ°æ‰§è¡Œæƒåï¼Œç”Ÿæˆä¸€ä¸ªitem,å¹¶å¾€ä¸‹æ‰§è¡Œä»£ç å½“produceræ‰§è¡Œåˆ°c.switch(item)æ—¶ï¼Œç¨‹åºæºå¸¦ä¼ é€’çš„itemåˆ‡æ¢åˆ°consumer,consumerç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œç›´åˆ°ä¸‹ä¸€æ¬¡è¿è¡Œåˆ°p.switchæ—¶ï¼Œäº¤å‡ºæ‰§è¡Œæƒï¼Œåˆ‡æ¢åˆ°producerï¼Œé‡å¤ä»¥ä¸Šè¿‡ç¨‹&quot;&quot;&quot;geventgevent æ˜¯å®ç°åç¨‹çš„ç¬¬ä¸‰æ–¹åº“ï¼Œé€šè¿‡å°è£… greenletï¼Œepoll å›è°ƒç¼–ç¨‹æ¨¡å¼ï¼Œç”Ÿæˆå™¨åç¨‹å®ç°å½“é‡åˆ° IO æ“ä½œæ—¶ï¼Œå°±è‡ªåŠ¨åˆ‡æ¢åˆ°å…¶ä»–åç¨‹ï¼Œç­‰åˆ° IO æ“ä½œå®Œæˆï¼Œå†åœ¨é€‚å½“çš„æ—¶å€™åˆ‡æ¢å›æ¥ç»§ç»­æ‰§è¡Œgevent ä¼šè‡ªåŠ¨åˆ‡æ¢åç¨‹ï¼Œå°±ä¿è¯æ€»æœ‰åç¨‹åœ¨æ‰§è¡Œï¼Œè€Œä¸æ˜¯ç­‰å¾… IOç”±äºåˆ‡æ¢å®åœ¨ IO æ“ä½œæ—¶è‡ªåŠ¨å®Œæˆï¼Œæ‰€ä»¥ gevent éœ€è¦ä¿®æ”¹ Python çš„è‡ªå¸¦çš„ä¸€äº›ä¿å‡†åº“ï¼Œè¿™ä¸€è¿‡ç¨‹åœ¨å¯åŠ¨æ—¶é€šè¿‡ monkey patch å®Œæˆgeventçš„ä»·å€¼åœ¨äºå®ƒçš„ä½¿ç”¨åŸºäºepollçš„libevæ¥é¿å¼€é˜»å¡ï¼›ä½¿ç”¨åŸºäºgeventçš„é«˜æ•ˆåç¨‹ï¼Œæ¥åˆ‡æ¢æ‰§è¡Œåªåœ¨é‡åˆ°é˜»å¡çš„æ—¶å€™åˆ‡æ¢ï¼Œæ²¡æœ‰è½®è¯¢å’Œçº¿ç¨‹å¼€é”€1234567891011121314151617181920212223242526272829303132333435&quot;&quot;&quot; gevent: é€šè¿‡greenletå®ç°åç¨‹ï¼Œæ ¸å¿ƒå°±æ˜¯é‡åˆ°IOæ“ä½œï¼Œä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°å…¶ä»–åç¨‹ &quot;&quot;&quot;# å°†pythonæ ‡å‡†åº“ä¸­çš„ä¸€äº›é˜»å¡æ“ä½œå˜ä¸ºéé˜»å¡from gevent import monkey;monkey.patch_all()# ä½¿ç”¨çŒ´å­è¡¥ä¸è¦å†™åœ¨ç¬¬ä¸€è¡Œimport geventdef test1():    print(&quot;test1&quot;)    gevent.sleep(0)  # æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ    print(&quot;test11&quot;)def test2():    print(&quot;test2&quot;)    gevent.sleep(0)  # æ¨¡æ‹Ÿè€—æ—¶æ“ä½œ    print(&quot;test22&quot;)# g1 = gevent.spawn(test1)  # å°†å‡½æ•°å°è£…æˆåç¨‹ï¼Œå¹¶å¯åŠ¨# g2 = gevent.spawn(test2)# gevent.joinall([g1, g2])&quot;&quot;&quot;# joinall() é˜»å¡å½“å‰æµç¨‹ï¼Œæ‰§è¡Œç»™å®šçš„greenlet(åˆ—è¡¨ä¸­çš„å¯¹è±¡),ç­‰å¾…ç¨‹åºæ‰§è¡Œå®Œ# spawnæ˜¯å¯åŠ¨åç¨‹ï¼Œå‚æ•°ä¸ºå‡½æ•°ååŠå…¶å‚æ•°test1test2test11test22ä»£ç æ‰§è¡Œtest1,æ‰“å°test1ï¼Œé‡åˆ°gevent.sleep(0)æ—¶åˆ‡æ¢ç¨‹åºï¼Œæ‰§è¡Œtest2test()æ‰§è¡Œï¼Œæ‰“å°test2ï¼Œæ‰§è¡Œåˆ°gevent.sleep(0)æ—¶åˆ‡æ¢ç¨‹åºæ‰§è¡Œtest1åœ¨gevent.sleep(0)åé¢çš„ä»£ç ï¼Œç›´åˆ°å†æ¬¡é‡åˆ°geventæ—¶ï¼Œåˆ‡æ¢ç¨‹åºç„¶ååœ¨test2ä¸­ï¼Œç»§ç»­æ‰§è¡Œgeventåçš„ä»£ç ï¼Œç›´åˆ°é‡åˆ°geventæ—¶ï¼Œå†æ¬¡åˆ‡æ¢ç›´åˆ°ç¨‹åºæ‰§è¡Œå®Œæ¯•&quot;&quot;&quot;asyncio.coroutineåœ¨ Python3.4 ä¸­åŠ å…¥äº† asyncio åº“ï¼Œä½¿å¾— Python è·å¾—äº†äº‹ä»¶å¾ªç¯çš„ç‰¹æ€§ï¼Œä½†è¿™ä¸ªè¿˜æ˜¯ä»¥ç”Ÿæˆå™¨å¯¹è±¡ä¸ºåŸºç¡€yield from åœ¨ asyncio æ¨¡å—ä¸­å¾ˆå¸¸ç”¨ï¼Œé€šè¿‡ asnyncio+ç”Ÿæˆå™¨ ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°è¿™æ ·ä¸€ä¸ªå¼‚æ­¥çš„æ¨¡å‹ï¼š12345678910111213141516171819202122232425262728293031323334import asyncio@asyncio.coroutinedef counttdown(number, n):    while n &gt; 0:        print(&quot;T-minus&quot;, n, &quot;({})&quot;.format(number))        yield from asyncio.sleep(1)        n -= 1loop = asyncio.get_event_loop()tasks = [    asyncio.ensure_future(counttdown(&quot;A&quot;, 2)),    asyncio.ensure_future(counttdown(&quot;B&quot;, 5)),]loop.run_until_complete(asyncio.wait(tasks))loop.close()ã€outã€‘Traceback (most recent call last):  File &quot;&lt;ipython-input-2-cff1e6420e75&gt;&quot;, line 15, in &lt;module&gt;    loop.run_until_complete(asyncio.wait(tasks))  File &quot;S:\Anaconda3\lib\asyncio\base_events.py&quot;, line 555, in run_until_complete    self.run_forever()  File &quot;S:\Anaconda3\lib\asyncio\base_events.py&quot;, line 510, in run_forever    raise RuntimeError('This event loop is already running')RuntimeError: This event loop is already runningT-minus 2 (A)T-minus 5 (B)T-minus 1 (A)T-minus 4 (B)T-minus 3 (B)T-minus 2 (B)T-minus 1 (B)è¿™é‡Œ asyncio.coroutine è£…é¥°å™¨æ˜¯ç”¨æ¥æ ‡è®°è¿™ä¸ªå‡½æ•°æ˜¯ä¸€ä¸ªåç¨‹ï¼Œå› ä¸º asyncio è¦æ±‚æ‰€æœ‰ç”¨ä½œåç¨‹çš„ç”Ÿæˆå™¨å¿…é¡»ç”± asyncio.coroutine è£…é¥°è¿™æ®µä»£ç ä¸­ï¼Œäº‹ä»¶å¾ªç¯ä¼šå¯åŠ¨ä¸¤ä¸ª countdown() åç¨‹ï¼Œå®ƒä»¬ä¼šä¸€ç›´æ‰§è¡Œï¼ŒçŸ¥é“é‡åˆ° yield from asyncio.sleep() ï¼Œæš‚åœæ‰§è¡Œï¼Œå¹¶å°†ä¸€ä¸ª async.Future å¯¹è±¡è¿”å›ç»™äº‹ä»¶å¾ªç¯äº‹ä»¶å¾ªç¯ä¼šç›‘æ§è¿™ä¸ª asyncio.Future å¯¹è±¡ï¼Œä¸€æ—¦æ‰§è¡Œå®Œæˆåï¼Œä¼šå°†è¿™ä¸ª Future çš„æ‰§è¡Œç»“æœè¿”å›ç»™åˆšåˆšå› ä¸ºè¿™ä¸ª Futur eæš‚åœçš„åç¨‹ï¼Œå¹¶ä¸”ç»§ç»­æ‰§è¡ŒåŸåç¨‹event_loop äº‹ä»¶å¾ªç¯ï¼šç¨‹åºå¼€å¯ä¸€ä¸ªæ— é™çš„å¾ªç¯ï¼Œç¨‹åºå‘˜ä¼šæŠŠä¸€äº›å‡½æ•°æ³¨å†Œåˆ°äº‹ä»¶å¾ªç¯ä¸Šã€‚å½“æ»¡è¶³äº‹ä»¶å‘ç”Ÿçš„æ—¶å€™ï¼Œè°ƒç”¨ç›¸åº”çš„åç¨‹å‡½æ•°coroutine åç¨‹ï¼šåç¨‹å¯¹è±¡ï¼ŒæŒ‡ä¸€ä¸ªä½¿ç”¨asyncå…³é”®å­—å®šä¹‰çš„å‡½æ•°ï¼Œå®ƒçš„è°ƒç”¨ä¸ä¼šç«‹å³æ‰§è¡Œå‡½æ•°ï¼Œè€Œæ˜¯ä¼šè¿”å›ä¸€ä¸ªåç¨‹å¯¹è±¡åç¨‹å¯¹è±¡éœ€è¦æ³¨å†Œåˆ°äº‹ä»¶å¾ªç¯ï¼Œç”±äº‹ä»¶å¾ªç¯è°ƒç”¨task ä»»åŠ¡ï¼šä¸€ä¸ªåç¨‹å¯¹è±¡å°±æ˜¯ä¸€ä¸ªåŸç”Ÿå¯ä»¥æŒ‚èµ·çš„å‡½æ•°ï¼Œä»»åŠ¡åˆ™æ˜¯å¯¹åç¨‹è¿›ä¸€æ­¥å°è£…ï¼Œå…¶ä¸­åŒ…å«ä»»åŠ¡çš„å„ç§çŠ¶æ€åç¨‹å¯¹è±¡ä¸èƒ½ç›´æ¥è¿è¡Œï¼Œåœ¨æ³¨å†Œäº‹ä»¶å¾ªç¯çš„æ—¶å€™ï¼Œå…¶å®æ˜¯ run_until_complete æ–¹æ³•å°†åç¨‹åŒ…è£…æˆä¸€ä¸ªä»»åŠ¡ï¼ˆ task ï¼‰å¯¹è±¡task å¯¹è±¡æ˜¯ Future çš„å­ç±»ï¼Œä¿å­˜äº†åç¨‹è¿è¡Œåçš„çŠ¶æ€ï¼Œç”¨äºæœªæ¥è·å–åç¨‹çš„ç»“æœ1234567891011121314151617181920212223242526272829åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ asyncio.sleep ä¸­ï¼Œåˆ›å»ºäº†ä¸€ä¸ª Futrure å¯¹è±¡ï¼Œä½œä¸ºæ›´å†…å±‚çš„åç¨‹å¯¹è±¡ï¼Œé€šè¿‡ yield from äº¤ç»™äº†äº‹ä»¶å¾ªç¯ï¼Œè€Œ Future æ˜¯ä¸€ä¸ªå®ç°äº† __iter__ å¯¹è±¡çš„ç”Ÿæˆå™¨ã€‚@coroutinedef sleep(delay, result=None, *, loop=None):    &quot;&quot;&quot;Coroutine that completes after a given time (in seconds).&quot;&quot;&quot;    future = futures.Future(loop=loop)    h = future._loop.call_later(delay,                                future._set_result_unless_cancelled, result)    try:        return (yield from future)    finally:        h.cancel() class Future:#blabla...    def __iter__(self):        if not self.done():            self._blocking = True            yield self  # This tells Task to wait for completion.        assert self.done(), &quot;yield from wasn't used with future&quot;        return self.result()  # May raise too.# å½“åç¨‹ yield from asyncio.sleep æ—¶ï¼Œäº‹ä»¶å¾ªç¯å…¶å®æ˜¯ä¸ Future å¯¹è±¡å»ºç«‹äº†è”ç³»ã€‚ç¨‹åºè¿è¡Œç»“æœå¦‚ä¸‹ï¼šT-minus 2 (A)T-minus 5 (B)T-minus 1 (A)T-minus 4 (B)T-minus 3 (B)T-minus 2 (B)T-minus 1 (B)async å’Œ awaithello world123456789101112131415161718192021222324252627282930313233343536373839import asyncioimport timeasync def main():    print(f&quot;started at {time.strftime('%X')}&quot;)    await say_after(1, 'hello')    await say_after(2, 'world')    print(f&quot;finished at {time.strftime('%X')}&quot;)asyncio.run(main())# é¢„æœŸè¾“å‡ºstarted at 17:13:52helloworldfinished at 17:13:55async def main():    task1 = asyncio.create_task(        say_after(1, 'hello'))    task2 = asyncio.create_task(        say_after(2, 'world'))    print(f&quot;started at {time.strftime('%X')}&quot;)    # Wait until both tasks are completed (should take around 2 seconds.)    await task1    await task2    print(f&quot;finished at {time.strftime('%X')}&quot;)# é¢„æœŸçš„è¾“å‡ºæ˜¾ç¤ºä»£ç æ®µçš„è¿è¡Œæ—¶é—´æ¯”ä¹‹å‰å¿«äº† 1 ç§’started at 17:14:32helloworldfinished at 17:14:34asyncioæ¨¡å—å†å²æ¼”è¿›asyncioæ˜¯python3.4å¼•å…¥çš„åº“ï¼Œç¿»è¯‘è¿‡æ¥å°±æ˜¯å¼‚æ­¥I/Oç”¨awaitä»£æ›¿yield fromï¼ŒåŠŸèƒ½ä¸€æ¨¡ä¸€æ ·ï¼Œç¨‹åºè°ƒåº¦è£…é¥°å™¨@asyncio.coroutineå’Œå…³é”®å­—async1234567@asyncio.coroutinedef func1():    yield from asyncio.sleep(2)  # é‡åˆ°IOè€—æ—¶æ“ä½œï¼Œè‡ªåŠ¨åŒ–åˆ‡æ¢åˆ°tasksä¸­çš„å…¶ä»–ä»»åŠ¡# ç­‰ä»·äºasync def func1():    yield from asyncio.sleep(2)  # é‡åˆ°IOè€—æ—¶æ“ä½œï¼Œè‡ªåŠ¨åŒ–åˆ‡æ¢åˆ°tasksä¸­çš„å…¶ä»–ä»»åŠ¡Event loop123456# ç‰ˆæœ¬3.7ä»¥å‰loop = asyncio.get_event_loop() # åˆ›å»ºä¸€ä¸ªäº‹ä»¶å¾ªç¯loop.run_until_complete(result) # å°†åç¨‹å½“åšä»»åŠ¡æäº¤åˆ°äº‹ä»¶å¾ªç¯çš„ä»»åŠ¡åˆ—è¡¨ä¸­ï¼Œåç¨‹æ‰§è¡Œå®Œæˆä¹‹åç»ˆæ­¢# ç‰ˆæœ¬3.7å¼•å…¥asyncio.run(result)åœ¨ Python3.5 ä¸­å¼•å…¥äº† async å’Œ await ï¼Œå¯ä»¥å°†å®ƒä»¬ç†è§£ä¸º asyncio.coroutine / yield from çš„å®Œç¾æ›¿èº«ï¼Œ async/await è®©åç¨‹è¡¨é¢ä¸Šç‹¬ç«‹äºç”Ÿæˆå™¨è€Œå­˜åœ¨ï¼Œå°†ç»†èŠ‚éšè—äº asyncio æ¨¡å—ä¹‹ä¸‹ã€‚ä½¿ç”¨ await å¯ä»¥é’ˆå¯¹è€—æ—¶çš„æ“ä½œè¿›è¡ŒæŒ‚èµ·ï¼Œç±»ä¼¼äºç”Ÿæˆå™¨é‡Œçš„ yield ä¸€æ ·ï¼Œä½¿å‡½æ•°è®©å‡ºæ§åˆ¶æƒåç¨‹é‡åˆ° await ï¼Œäº‹ä»¶å¾ªç¯æŒ‚èµ·è¯¥åç¨‹ï¼Œç›´åˆ°å…¶ä»–åç¨‹ä¹ŸæŒ‚èµ·æˆ–è€…æ‰§è¡Œå®Œæ¯•ï¼Œå†è¿›è¡Œä¸‹ä¸€ä¸ªåç¨‹çš„æ‰§è¡Œã€‚è€—æ—¶çš„æ“ä½œä¸€èˆ¬æ˜¯ä¸€äº› IO æ“ä½œï¼Œå¦‚ç½‘ç»œè¯·æ±‚ï¼Œæ–‡ä»¶è¯»å–ç­‰å¦‚æœä¸€ä¸ªå¯¹è±¡å¯ä»¥åœ¨ await è¯­å¥ä¸­ä½¿ç”¨ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ å¯ç­‰å¾… å¯¹è±¡å¯ç­‰å¾…å¯¹è±¡æœ‰ä¸‰ç§ä¸»è¦ç±»å‹: åç¨‹, ä»»åŠ¡ å’Œ Futureåç¨‹: Python åç¨‹å±äº å¯ç­‰å¾… å¯¹è±¡ï¼Œå› æ­¤å¯ä»¥åœ¨å…¶ä»–åç¨‹ä¸­è¢«ç­‰å¾…1234async def nested():    return 42await nested()ä»»åŠ¡: è¢«ç”¨æ¥â€œå¹¶è¡Œçš„â€è°ƒåº¦åç¨‹ï¼Œå½“ä¸€ä¸ªåç¨‹é€šè¿‡ asyncio.create_task() ç­‰å‡½æ•°è¢«å°è£…ä¸ºä¸€ä¸ª ä»»åŠ¡ï¼Œè¯¥åç¨‹ä¼šè¢«è‡ªåŠ¨è°ƒåº¦æ‰§è¡Œ:123456# apiasyncio.create_task(coro, *, name=None, context=None)# è°ƒç”¨task = asyncio.create_task(nested())await taskFutures: Future æ˜¯ä¸€ç§ç‰¹æ®Šçš„ ä½å±‚çº§ å¯ç­‰å¾…å¯¹è±¡ï¼Œè¡¨ç¤ºä¸€ä¸ªå¼‚æ­¥æ“ä½œçš„ æœ€ç»ˆç»“æœå½“ä¸€ä¸ª Future å¯¹è±¡ è¢«ç­‰å¾…ï¼Œè¿™æ„å‘³ç€åç¨‹å°†ä¿æŒç­‰å¾…ç›´åˆ°è¯¥ Future å¯¹è±¡åœ¨å…¶ä»–åœ°æ–¹æ“ä½œå®Œæ¯•åœ¨ asyncio ä¸­éœ€è¦ Future å¯¹è±¡ä»¥ä¾¿å…è®¸é€šè¿‡ async/await ä½¿ç”¨åŸºäºå›è°ƒçš„ä»£ç é€šå¸¸æƒ…å†µä¸‹ æ²¡æœ‰å¿…è¦ åœ¨åº”ç”¨å±‚çº§çš„ä»£ç ä¸­åˆ›å»º Future å¯¹è±¡Future å¯¹è±¡æœ‰æ—¶ä¼šç”±åº“å’ŒæŸäº› asyncio API æš´éœ²ç»™ç”¨æˆ·ï¼Œç”¨ä½œå¯ç­‰å¾…å¯¹è±¡12345678async def main():    await function_that_returns_a_future_object()    # this is also valid:    await asyncio.gather(        function_that_returns_a_future_object(),        some_python_coroutine()    )ä¸€ä¸ªå¾ˆå¥½çš„è¿”å›å¯¹è±¡çš„ä½å±‚çº§å‡½æ•°çš„ç¤ºä¾‹æ˜¯ loop.run_in_executor()è¿™é‡Œå¯ä»¥ä½¿ç”¨ asyncio.sleep æ¥è¿›è¡Œæ¨¡æ‹Ÿä¸¾ä¾‹ï¼š1234567891011121314151617181920212223242526272829303132333435363738import asyncioimport timenow = lambda: time.time()async def do_some_work(x):    print('Waiting: ', x)    await asyncio.sleep(x)    return 'Done after {}s'.format(x)start = now()coroutine1 = do_some_work(1)coroutine2 = do_some_work(2)coroutine3 = do_some_work(4)tasks = [    asyncio.ensure_future(coroutine1),    asyncio.ensure_future(coroutine2),    asyncio.ensure_future(coroutine3)]loop = asyncio.get_event_loop()loop.run_until_complete(asyncio.wait(tasks))for task in tasks:    print('Task ret: ', task.result())print('TIME: ', now() - start)Waiting:  1Waiting:  2Waiting:  4Task ret:  Done after 1sTask ret:  Done after 2sTask ret:  Done after 4sTIME:  4.003541946411133åœ¨ sleep çš„æ—¶å€™ï¼Œä½¿ç”¨ await è®©å‡ºæ§åˆ¶æƒã€‚å½“é‡åˆ°é˜»å¡è°ƒç”¨çš„å‡½æ•°çš„æ—¶å€™ï¼Œä½¿ç”¨ await æ–¹æ³•å°†åç¨‹çš„æ§åˆ¶æƒè®©å‡ºï¼Œä»¥ä¾¿ loop è°ƒç”¨å…¶ä»–çš„åç¨‹æ³¨æ„çš„åŒºåˆ«æ˜¯ï¼š await æ¥å—çš„å¯¹è±¡å¿…é¡»æ˜¯ä¸€ä¸ª awaitable çš„å¯¹è±¡ï¼Œæ‰€è°“ awaitable çš„å¯¹è±¡ï¼Œå°±æ˜¯ä¸€ä¸ªå®ç°äº† await() æ–¹æ³•çš„å¯¹è±¡ï¼Œè€Œä¸”è¿™ä¸ªæ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ªä¸æ˜¯åç¨‹çš„è¿­ä»£å™¨åœ¨ Python3.6 ä¸­ï¼Œ yield å’Œ await ä¹Ÿå¯ä»¥åœ¨åŒä¸€ä¸ªå‡½æ•°ä¸­ä½¿ç”¨ï¼Œåˆæ¬¡ä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥åœ¨åˆ—è¡¨æ¨å¯¼ç­‰åœ°æ–¹ä½¿ç”¨ async for æˆ– await è¯­æ³•1234567result = [i async for i in aiter() if i % 2]result = [await func() for fun in funcs if await condition()]async def test(x, y):    for i in range(y):        yield i        await asyncio.sleep(x)åç¨‹ä¸å¼‚æ­¥ä¸å¤šçº¿ç¨‹ç¼–ç¨‹ä¸åŒçš„æ˜¯ï¼Œå¤šä¸ªåç¨‹æ€»æ˜¯è¿è¡Œåœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­ï¼Œä¸€æ—¦å…¶ä¸­çš„ä¸€ä¸ªåç¨‹å‘ç”Ÿé˜»å¡è¡Œä¸ºï¼Œè¿›è€Œæ‰€æœ‰çš„åç¨‹éƒ½æ— æ³•ç»§ç»­è¿è¡Œä¾‹å¦‚åœ¨æˆ‘ä»¬è¿›è¡Œçˆ¬è™«ç¼–å†™æ—¶ï¼Œä¹ æƒ¯ä½¿ç”¨ requests åº“ï¼Œè€Œè¿™ä¸ªåº“å°±æ˜¯é˜»å¡çš„å°è¯•ä½¿ç”¨åç¨‹çš„æ–¹å¼è¿›è¡Œç¼–å†™ï¼š123456789101112131415161718192021222324252627282930313233import asyncioimport requestsimport time start = time.time() async def get(url):    return requests.get(url) async def request():    url = 'http://127.0.0.1:5000'    print('Waiting for', url)    response = await get(url)    print('Get response from', url, 'Result:', response.text) tasks = [asyncio.ensure_future(request()) for _ in range(5)]loop = asyncio.get_event_loop()loop.run_until_complete(asyncio.wait(tasks)) end = time.time()print('Cost time:', end - start)Waiting for http://127.0.0.1:5000Get response from http://127.0.0.1:5000 Result: Hello!Waiting for http://127.0.0.1:5000Get response from http://127.0.0.1:5000 Result: Hello!Waiting for http://127.0.0.1:5000Get response from http://127.0.0.1:5000 Result: Hello!Waiting for http://127.0.0.1:5000Get response from http://127.0.0.1:5000 Result: Hello!Waiting for http://127.0.0.1:5000Get response from http://127.0.0.1:5000 Result: Hello!Cost time: 15.134317874908447è€Œä¸ä½¿ç”¨åç¨‹ï¼Œä½¿ç”¨æ™®é€šæ–¹å¼ï¼Œä¹Ÿæ˜¯è¿™ä¸ªæ—¶é—´ã€‚ä¸ºä»€ä¹ˆä¼šè¿™æ ·å‘¢ï¼Œç©¶å…¶åŸå› æ˜¯ requests å¹¶ä¸æ”¯æŒå¼‚æ­¥æ“ä½œã€‚åœ¨è¿è¡Œæ—¶é˜»å¡å¹¶æœªæŒ‚èµ·å¦å¤– await åé¢æ‰€è·Ÿçš„å¯¹è±¡å¿…é¡»æ˜¯ï¼šä¸€ä¸ªåŸç”Ÿ coroutine å¯¹è±¡ï¼Œä¸€ä¸ªç”± types.coroutine è£…é¥°çš„ç”Ÿæˆå™¨ï¼Œè¿™ä¸ªç”Ÿæˆå™¨å¯ä»¥è¿”å› coroutine å¯¹è±¡è€Œ requests è¿”å›çš„å¯¹è±¡ä¸ç¬¦åˆä¸Šè¿°æ¡ä»¶ã€‚ä¸ºäº†ç¨‹åºè¿è¡Œä¸æŠ¥é”™ï¼Œä¸Šé¢ä»£ç åœ¨ await æ—¶å¯¹ requsts è¿›è¡Œäº†ä¸€æ¬¡ async å‡½æ•°çš„åŒ…è£…ï¼Œä½†æ˜¯å®ƒå¹¶ä¸æ˜¯â€œåŸç”Ÿçš„coroutineå¯¹è±¡â€ï¼Œå› æ­¤ä¹Ÿå°±ä¸èƒ½çœŸæ­£å¼‚æ­¥äº†å¯ä»¥é€šè¿‡ä½¿ç”¨å®ç°äº†å¼‚æ­¥çš„ aiohttp æˆ–è€… Trip åº“æ”¹å†™ä¸Šè¿°çˆ¬è™«12345678910111213141516171819202122232425262728293031import asyncioimport timeimport aiohttpfrom spider_normal import targets, show_resultsfinal_results = {}async def get_content(url):    async with aiohttp.ClientSession() as session:        async with session.get(url) as resp:            content = await resp.read()            return len(content)async def spider(url):    length = await get_content(url)    final_results[url] = length    return Truedef main():    loop = asyncio.get_event_loop()    cor = [spider(url) for url in targets]    start_time = time.time()    result = loop.run_until_complete(asyncio.gather(*cor))    print(&quot;Use time: {:.2f}s&quot;.format(time.time() - start_time))    show_results(final_results)    print(&quot;loop result: &quot;, result)if __name__ == '__main__':    main()12345678910111213141516171819202122232425262728293031323334353637383940414243444546# lightless @ LL-DESKTOP in C:\Users\lightless\Desktop [22:49:11] $ python .\spider_asyncio.py Use time: 2.23s Length:   227  URL:https://www.baidu.com/ Length:  11759 URL:https://www.zhihu.com/ Length:  40740 URL:https://lightless.me/archives/python-coroutine-from-start-to-boom.html Length: 150227 URL:https://github.com/aio-libs -engtn: LO1 Length:  59391 URL:https://vww.python.org/dev/peps/pep-0380/ loop result: [True,True,True,True,True] # lightless @ LL-DESKTOP in C:\Users\lightless\Desktop [22:49:15] $ python .\spider_asyncio.py Use time: 1.62s Length:  11759 URL:https://www.zhihu.com/ Length:   227  URL:https://www.baidu.com/ Length:  40830 URL:https://lightless.me/archives/python-coroutine-from-start-to-boom.html Length:  59391 URL:https://ww.python.org/dev/peps/pep-0380/ Length: 150227 URL:https://github.com/aio-libs loop result: [True,True,True,True,True]# lightless @ LL-DESKTOP in C:\Users\lightless\Desktop [22:49:20] $ python .\spider_asyncio.py Use time: 1.59s Length:  11759 URL:https://ww.zhihu.com/ Length:   227  URL:https://www.baidu.com/ Length:  40629 URL:https://lightless.me/archives/python-coroutine-from-start-to-boom.html Length:  59391 URL:https://ww.python.org/dev/peps/pep-0380/ Length: 150219 URL:https://github.com/aio-libs loop result: [True,True,True,True.True] # lightless @ LL-DESKToP in C:\Users\lightless\Desktop [22:49:23] $ python .\spider_asyncio.py Use time: 4 70s Length:   227 URL:https://www.baidu.com Length: 11759 URL:https://www.zhihu.com/ Lengtn: 59391 URL:https://www.python.org/dev/peps/pep-0380/ Length:150218 URL:https://github.com/aio-libs Length: 40740 URL:https://lightless.me/archives/python-coroutine-from-start-to-boom.html loop result: [True.True,True,True.True] # lightless @ LL-DESKTOP in C:\Users\lightless\Desktop [22:49:29] $ python .\spider_asyncio.py Use time: 1.85s Length:   227 URL:https://www.baidu.com/ Length: 11759 URL:https://www.zhihu.com/ Length: 40777 URL:https://lightless.me/archives/python-coroutine-from-start-to-boom.html Length: 59391 URL:https://www.python.org/dev/peps/pep-0380/ Length:150227 URL:httos://github.com/aio-libsloop result:[True,True,True,True,True] # lightless @ LL-DESKTOP in C:\Users\lightless\Desktop [22:49:32]åº”ç”¨ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768#!/usr/bin/env Python# -- coding: utf-8 --&quot;&quot;&quot;@version: v1.0@author: huangyc@file: async_test.py@Description: @time: 2023/4/6 10:31&quot;&quot;&quot;import asyncio, randomimport threadingrandom.seed(5)async def rnd_sleep(t):    # sleep for T seconds on average    await asyncio.sleep(t * random.random() * 2)async def producer(queue):    lst = list(range(10))    for token in lst:        # produce a token and send it to a consumer        print(f'produced {token}')        await queue.put(token)        await rnd_sleep(.1)async def consumer(queue):    while True:        token = await queue.get()        # process the token received from a producer        await rnd_sleep(.1)        queue.task_done()        print(f'consumed {token}')async def main():    queue = asyncio.Queue()    # fire up the both producers and consumers    producers = [asyncio.create_task(producer(queue)) for _ in range(3)]    consumers = [asyncio.create_task(consumer(queue)) for _ in range(10)]    # with both producers and consumers running, wait for    # the producers to finish    await asyncio.gather(*producers)    print('---- done producing')    # wait for the remaining tasks to be processed    await queue.join()    # cancel the consumers, which are now idle    for c in consumers:        c.cancel()if __name__ == '__main__':    print(&quot;hello&quot;)    # å¤šçº¿ç¨‹+åç¨‹æ–¹å¼    t1 = threading.Thread(target=asyncio.run, args=(main(),))    t1.start()    t1.join()    # åç¨‹è°ƒç”¨    # asyncio.run(main())    print(&quot;end&quot;)å¤šè¿›ç¨‹ã€å¤šçº¿ç¨‹ä¸åç¨‹è®¡ç®—å¯†é›†å‹ï¼šå¤šè¿›ç¨‹ï¼Œå¯ä»¥æœ€å¤§é™åº¦å‘æŒ¥CPUè¿ç®—èƒ½åŠ›IO å¯†é›†å‹ï¼šæ¨èä¼˜å…ˆä½¿ç”¨åç¨‹ï¼Œå†…å­˜å¼€é”€å°‘ï¼Œæ‰§è¡Œæ•ˆç‡é«˜ï¼›å…¶æ¬¡æ˜¯å¤šçº¿ç¨‹ï¼Œè™½ç„¶ä¸å¦‚åç¨‹é«˜æ•ˆï¼Œä½†åŒæ ·èƒ½æå¤§æå‡ç¨‹åºè¿è¡Œæ•ˆç‡CPU å¯†é›†å’Œ IO å¯†é›†ï¼šå¤šè¿›ç¨‹+åç¨‹ï¼Œæ—¢å……åˆ†åˆ©ç”¨å¤šæ ¸ï¼Œåˆå……åˆ†å‘æŒ¥åç¨‹çš„é«˜æ•ˆç‡ï¼Œå¯è·å¾—æé«˜çš„æ€§èƒ½</content>
	</entry>
	<entry>
		<title>å¤šçº¿ç¨‹_JUCé”é›†åˆ</title>
		<url>/article/10fd680e.html</url>
		<content>JUCé”é›†åˆåŒæ­¥é”: å³é€šè¿‡synchronizedå…³é”®å­—æ¥è¿›è¡ŒåŒæ­¥ï¼Œå®ç°å¯¹ç«äº‰èµ„æºçš„äº’æ–¥è®¿é—®çš„é”ã€‚Java 1.0ç‰ˆæœ¬ä¸­å°±å·²ç»æ”¯æŒåŒæ­¥é”äº†ã€‚å¯¹äºæ¯ä¸€ä¸ªå¯¹è±¡ï¼Œæœ‰ä¸”ä»…æœ‰ä¸€ä¸ªåŒæ­¥é”ï¼›ä¸åŒçš„çº¿ç¨‹èƒ½å…±åŒè®¿é—®è¯¥åŒæ­¥é”ã€‚ä½†æ˜¯ï¼Œåœ¨åŒä¸€ä¸ªæ—¶é—´ç‚¹ï¼Œè¯¥åŒæ­¥é”èƒ½ä¸”åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹è·å–åˆ°ã€‚è¿™æ ·ï¼Œè·å–åˆ°åŒæ­¥é”çš„çº¿ç¨‹å°±èƒ½è¿›è¡ŒCPUè°ƒåº¦ï¼Œä»è€Œåœ¨CPUä¸Šæ‰§è¡Œï¼›è€Œæ²¡æœ‰è·å–åˆ°åŒæ­¥é”çš„çº¿ç¨‹ï¼Œå¿…é¡»è¿›è¡Œç­‰å¾…ï¼Œç›´åˆ°è·å–åˆ°åŒæ­¥é”ä¹‹åæ‰èƒ½ç»§ç»­è¿è¡Œã€‚è¿™å°±æ˜¯ï¼Œå¤šçº¿ç¨‹é€šè¿‡åŒæ­¥é”è¿›è¡ŒåŒæ­¥çš„åŸç†ï¼ JUCåŒ…ä¸­çš„é” : ç›¸æ¯”åŒæ­¥é”ï¼ŒJUCåŒ…ä¸­çš„é”çš„åŠŸèƒ½æ›´åŠ å¼ºå¤§ï¼Œå®ƒä¸ºé”æä¾›äº†ä¸€ä¸ªæ¡†æ¶ï¼Œè¯¥æ¡†æ¶å…è®¸æ›´çµæ´»åœ°ä½¿ç”¨é”ï¼Œåªæ˜¯å®ƒçš„ç”¨æ³•æ›´éš¾ç½¢äº†ã€‚ã€€ã€€JUCåŒ…ä¸­çš„é”ï¼ŒåŒ…æ‹¬ï¼šLockæ¥å£ï¼ŒReadWriteLockæ¥å£ï¼ŒLockSupporté˜»å¡åŸè¯­ï¼ŒConditionæ¡ä»¶ï¼ŒAbstractOwnableSynchronizer/AbstractQueuedSynchronizer/AbstractQueuedLongSynchronizerä¸‰ä¸ªæŠ½è±¡ç±»ï¼ŒReentrantLockç‹¬å é”ï¼ŒReentrantReadWriteLockè¯»å†™é”ã€‚ç”±äºCountDownLatchï¼ŒCyclicBarrierå’ŒSemaphoreä¹Ÿæ˜¯é€šè¿‡AQSæ¥å®ç°çš„ï¼›Lockæ¥å£: JUCåŒ…ä¸­çš„ Lock æ¥å£æ”¯æŒé‚£äº›è¯­ä¹‰ä¸åŒ(é‡å…¥ã€å…¬å¹³ç­‰)çš„é”è§„åˆ™ã€‚æ‰€è°“è¯­ä¹‰ä¸åŒï¼Œæ˜¯æŒ‡é”å¯æ˜¯æœ‰â€å…¬å¹³æœºåˆ¶çš„é”â€ã€â€éå…¬å¹³æœºåˆ¶çš„é”â€ã€â€å¯é‡å…¥çš„é”â€ç­‰ç­‰ã€‚â€å…¬å¹³æœºåˆ¶â€æ˜¯æŒ‡â€ä¸åŒçº¿ç¨‹è·å–é”çš„æœºåˆ¶æ˜¯å…¬å¹³çš„â€ï¼Œè€Œâ€éå…¬å¹³æœºåˆ¶â€åˆ™æ˜¯æŒ‡â€ä¸åŒçº¿ç¨‹è·å–é”çš„æœºåˆ¶æ˜¯éå…¬å¹³çš„â€ï¼Œâ€å¯é‡å…¥çš„é”â€æ˜¯æŒ‡åŒä¸€ä¸ªé”èƒ½å¤Ÿè¢«ä¸€ä¸ªçº¿ç¨‹å¤šæ¬¡è·å–ã€‚ ReadWriteLock: ReadWriteLock æ¥å£ä»¥å’ŒLockç±»ä¼¼çš„æ–¹å¼å®šä¹‰äº†ä¸€äº›è¯»å–è€…å¯ä»¥å…±äº«è€Œå†™å…¥è€…ç‹¬å çš„é”ã€‚JUCåŒ…åªæœ‰ä¸€ä¸ªç±»å®ç°äº†è¯¥æ¥å£ï¼Œå³ ReentrantReadWriteLockï¼Œå› ä¸ºå®ƒé€‚ç”¨äºå¤§éƒ¨åˆ†çš„æ ‡å‡†ç”¨æ³•ä¸Šä¸‹æ–‡ã€‚ä½†ç¨‹åºå‘˜å¯ä»¥åˆ›å»ºè‡ªå·±çš„ã€é€‚ç”¨äºéæ ‡å‡†è¦æ±‚çš„å®ç°ã€‚ AQS: AbstractOwnableSynchronizer/AbstractQueuedSynchronizer/AbstractQueuedLongSynchronizer ã€€ã€€AbstractQueuedSynchronizerå°±æ˜¯è¢«ç§°ä¹‹ä¸ºAQSçš„ç±»ï¼Œå®ƒæ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„è¶…ç±»ï¼Œå¯ç”¨æ¥å®šä¹‰é”ä»¥åŠä¾èµ–äºæ’é˜Ÿé˜»å¡çº¿ç¨‹çš„å…¶ä»–åŒæ­¥å™¨ï¼›ReentrantLockï¼ŒReentrantReadWriteLockï¼ŒCountDownLatchï¼ŒCyclicBarrierå’ŒSemaphoreç­‰è¿™äº›ç±»éƒ½æ˜¯åŸºäºAQSç±»å®ç°çš„ã€‚AbstractQueuedLongSynchronizer ç±»æä¾›ç›¸åŒçš„åŠŸèƒ½ä½†æ‰©å±•äº†å¯¹åŒæ­¥çŠ¶æ€çš„ 64 ä½çš„æ”¯æŒã€‚ä¸¤è€…éƒ½æ‰©å±•äº†ç±» AbstractOwnableSynchronizerï¼ˆä¸€ä¸ªå¸®åŠ©è®°å½•å½“å‰ä¿æŒç‹¬å åŒæ­¥çš„çº¿ç¨‹çš„ç®€å•ç±»ï¼‰ã€‚LockSupport: LockSupportæä¾›â€œåˆ›å»ºé”â€å’Œâ€œå…¶ä»–åŒæ­¥ç±»çš„åŸºæœ¬çº¿ç¨‹é˜»å¡åŸè¯­â€ã€‚ã€€ã€€LockSupportçš„åŠŸèƒ½å’Œâ€Threadä¸­çš„Thread.suspend()å’ŒThread.resume()æœ‰ç‚¹ç±»ä¼¼â€ï¼ŒLockSupportä¸­çš„park() å’Œ unpark() çš„ä½œç”¨åˆ†åˆ«æ˜¯é˜»å¡çº¿ç¨‹å’Œè§£é™¤é˜»å¡çº¿ç¨‹ã€‚ä½†æ˜¯park()å’Œunpark()ä¸ä¼šé‡åˆ°â€œThread.suspend å’Œ Thread.resumeæ‰€å¯èƒ½å¼•å‘çš„æ­»é”â€é—®é¢˜ã€‚ Condition: Conditionéœ€è¦å’ŒLockè”åˆä½¿ç”¨ï¼Œå®ƒçš„ä½œç”¨æ˜¯ä»£æ›¿Objectç›‘è§†å™¨æ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡await(),signal()æ¥ä¼‘çœ /å”¤é†’çº¿ç¨‹ã€‚        Condition æ¥å£æè¿°äº†å¯èƒ½ä¼šä¸é”æœ‰å…³è”çš„æ¡ä»¶å˜é‡ã€‚è¿™äº›å˜é‡åœ¨ç”¨æ³•ä¸Šä¸ä½¿ç”¨ Object.wait è®¿é—®çš„éšå¼ç›‘è§†å™¨ç±»ä¼¼ï¼Œä½†æä¾›äº†æ›´å¼ºå¤§çš„åŠŸèƒ½ã€‚éœ€è¦ç‰¹åˆ«æŒ‡å‡ºçš„æ˜¯ï¼Œå•ä¸ª Lock å¯èƒ½ä¸å¤šä¸ª Condition å¯¹è±¡å…³è”ã€‚ä¸ºäº†é¿å…å…¼å®¹æ€§é—®é¢˜ï¼ŒCondition æ–¹æ³•çš„åç§°ä¸å¯¹åº”çš„ Object ç‰ˆæœ¬ä¸­çš„ä¸åŒã€‚ ReentrantLock: ReentrantLockæ˜¯ç‹¬å é”ã€‚æ‰€è°“ç‹¬å é”ï¼Œæ˜¯æŒ‡åªèƒ½è¢«ç‹¬è‡ªå é¢†ï¼Œå³åŒä¸€ä¸ªæ—¶é—´ç‚¹åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹é”è·å–åˆ°çš„é”ã€‚ReentrantLocké”åŒ…æ‹¬â€å…¬å¹³çš„ReentrantLockâ€å’Œâ€éå…¬å¹³çš„ReentrantLockâ€ã€‚â€å…¬å¹³çš„ReentrantLockâ€æ˜¯æŒ‡â€ä¸åŒçº¿ç¨‹è·å–é”çš„æœºåˆ¶æ˜¯å…¬å¹³çš„â€ï¼Œè€Œâ€éå…¬å¹³çš„ã€€ã€€ReentrantLockâ€åˆ™æ˜¯æŒ‡â€ä¸åŒçº¿ç¨‹è·å–é”çš„æœºåˆ¶æ˜¯éå…¬å¹³çš„â€ï¼ŒReentrantLockæ˜¯â€å¯é‡å…¥çš„é”â€ã€‚ReentrantReadWriteLock: ReentrantReadWriteLockæ˜¯è¯»å†™é”æ¥å£ReadWriteLockçš„å®ç°ç±»ï¼Œå®ƒåŒ…æ‹¬å­ç±»ReadLockå’ŒWriteLockã€‚ReentrantLockæ˜¯å…±äº«é”ï¼Œè€ŒWriteLockæ˜¯ç‹¬å é”ã€‚CountDownLatch: CountDownLatchæ˜¯ä¸€ä¸ªåŒæ­¥è¾…åŠ©ç±»ï¼Œåœ¨å®Œæˆä¸€ç»„æ­£åœ¨å…¶ä»–çº¿ç¨‹ä¸­æ‰§è¡Œçš„æ“ä½œä¹‹å‰ï¼Œå®ƒå…è®¸ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ä¸€ç›´ç­‰å¾…ã€‚CountDownLatchåŒ…å«äº†syncå¯¹è±¡ï¼Œsyncæ˜¯Syncç±»å‹ã€‚CountDownLatchçš„Syncæ˜¯å®ä¾‹ç±»ï¼Œå®ƒç»§æ‰¿äºAQSã€‚CyclicBarrier: CyclicBarrieræ˜¯ä¸€ä¸ªåŒæ­¥è¾…åŠ©ç±»ï¼Œå…è®¸ä¸€ç»„çº¿ç¨‹äº’ç›¸ç­‰å¾…ï¼Œç›´åˆ°åˆ°è¾¾æŸä¸ªå…¬å…±å±éšœç‚¹ (common barrier point)ã€‚å› ä¸ºè¯¥ barrier åœ¨é‡Šæ”¾ç­‰å¾…çº¿ç¨‹åå¯ä»¥é‡ç”¨ï¼Œæ‰€ä»¥ç§°å®ƒä¸ºå¾ªç¯ çš„ barrierã€‚1234CyclicBarrieræ˜¯åŒ…å«äº†&quot;ReentrantLockå¯¹è±¡lock&quot;å’Œ&quot;Conditionå¯¹è±¡trip&quot;ï¼Œå®ƒæ˜¯é€šè¿‡ç‹¬å é”å®ç°çš„ã€‚CyclicBarrierå’ŒCountDownLatchçš„åŒºåˆ«**æ˜¯ï¼š(01) CountDownLatchçš„ä½œç”¨æ˜¯å…è®¸1æˆ–Nä¸ªçº¿ç¨‹ç­‰å¾…å…¶ä»–çº¿ç¨‹å®Œæˆæ‰§è¡Œï¼›è€ŒCyclicBarrieråˆ™æ˜¯å…è®¸Nä¸ªçº¿ç¨‹ç›¸äº’ç­‰å¾…ã€‚(02) CountDownLatchçš„è®¡æ•°å™¨æ— æ³•è¢«é‡ç½®ï¼›CyclicBarrierçš„è®¡æ•°å™¨å¯ä»¥è¢«é‡ç½®åä½¿ç”¨ï¼Œå› æ­¤å®ƒè¢«ç§°ä¸ºæ˜¯å¾ªç¯çš„barrierã€‚Semaphore: Semaphoreæ˜¯ä¸€ä¸ªè®¡æ•°ä¿¡å·é‡ï¼Œå®ƒçš„æœ¬è´¨æ˜¯ä¸€ä¸ªâ€å…±äº«é”â€ã€‚    ã€€ä¿¡å·é‡ç»´æŠ¤äº†ä¸€ä¸ªä¿¡å·é‡è®¸å¯é›†ã€‚çº¿ç¨‹å¯ä»¥é€šè¿‡è°ƒç”¨acquire()æ¥è·å–ä¿¡å·é‡çš„è®¸å¯ï¼›å½“ä¿¡å·é‡ä¸­æœ‰å¯ç”¨çš„è®¸å¯æ—¶ï¼Œçº¿ç¨‹èƒ½è·å–è¯¥è®¸å¯ï¼›å¦åˆ™çº¿ç¨‹å¿…é¡»ç­‰å¾…ï¼Œç›´åˆ°æœ‰å¯ç”¨çš„è®¸å¯ä¸ºæ­¢ã€‚ çº¿ç¨‹å¯ä»¥é€šè¿‡release()æ¥é‡Šæ”¾å®ƒæ‰€æŒæœ‰çš„ä¿¡å·é‡è®¸å¯ã€‚å’Œâ€ReentrantLockâ€ä¸€æ ·ï¼ŒSemaphoreåŒ…å«äº†syncå¯¹è±¡ï¼Œsyncæ˜¯Syncç±»å‹ï¼›è€Œä¸”ï¼ŒSyncä¹Ÿæ˜¯ä¸€ä¸ªç»§æ‰¿äºAQSçš„æŠ½è±¡ç±»ã€‚Syncä¹ŸåŒ…æ‹¬â€å…¬å¹³ä¿¡å·é‡â€FairSyncå’Œâ€éå…¬å¹³ä¿¡å·é‡â€NonfairSyncã€‚äº’æ–¥é”ReentrantLockReentrantLockæ˜¯ä¸€ä¸ªå¯é‡å…¥çš„äº’æ–¥é”ï¼Œåˆè¢«ç§°ä¸ºâ€œç‹¬å é”â€ã€‚12é¡¾åæ€ä¹‰ï¼ŒReentrantLocké”åœ¨åŒä¸€ä¸ªæ—¶é—´ç‚¹åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹é”æŒæœ‰ï¼›è€Œå¯é‡å…¥çš„æ„æ€æ˜¯ï¼ŒReentrantLocké”ï¼Œå¯ä»¥è¢«å•ä¸ªçº¿ç¨‹å¤šæ¬¡è·å–ã€‚ReentrantLockåˆ†ä¸ºâ€œå…¬å¹³é”â€å’Œâ€œéå…¬å¹³é”â€ã€‚å®ƒä»¬çš„åŒºåˆ«ä½“ç°åœ¨è·å–é”çš„æœºåˆ¶ä¸Šæ˜¯å¦å…¬å¹³ã€‚â€œé”â€æ˜¯ä¸ºäº†ä¿æŠ¤ç«äº‰èµ„æºï¼Œé˜²æ­¢å¤šä¸ªçº¿ç¨‹åŒæ—¶æ“ä½œçº¿ç¨‹è€Œå‡ºé”™ï¼ŒReentrantLockåœ¨åŒä¸€ä¸ªæ—¶é—´ç‚¹åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹è·å–(å½“æŸçº¿ç¨‹è·å–åˆ°â€œé”â€æ—¶ï¼Œå…¶å®ƒçº¿ç¨‹å°±å¿…é¡»ç­‰å¾…)ï¼›ReentraantLockæ˜¯é€šè¿‡ä¸€ä¸ªFIFOçš„ç­‰å¾…é˜Ÿåˆ—æ¥ç®¡ç†è·å–è¯¥é”æ‰€æœ‰çº¿ç¨‹çš„ã€‚åœ¨â€œå…¬å¹³é”â€çš„æœºåˆ¶ä¸‹ï¼Œçº¿ç¨‹ä¾æ¬¡æ’é˜Ÿè·å–é”ï¼›è€Œâ€œéå…¬å¹³é”â€åœ¨é”æ˜¯å¯è·å–çŠ¶æ€æ—¶ï¼Œä¸ç®¡è‡ªå·±æ˜¯ä¸æ˜¯åœ¨é˜Ÿåˆ—çš„å¼€å¤´éƒ½ä¼šè·å–é”ã€‚1234567891011121314151617181920212223242526272829303132333435363738394041// ReentrantLockå‡½æ•°åˆ—è¡¨// åˆ›å»ºä¸€ä¸ª ReentrantLock ï¼Œé»˜è®¤æ˜¯â€œéå…¬å¹³é”â€ã€‚ReentrantLock()// åˆ›å»ºç­–ç•¥æ˜¯fairçš„ ReentrantLockã€‚fairä¸ºtrueè¡¨ç¤ºæ˜¯å…¬å¹³é”ï¼Œfairä¸ºfalseè¡¨ç¤ºæ˜¯éå…¬å¹³é”ã€‚ReentrantLock(boolean fair)// æŸ¥è¯¢å½“å‰çº¿ç¨‹ä¿æŒæ­¤é”çš„æ¬¡æ•°ã€‚int getHoldCount()// è¿”å›ç›®å‰æ‹¥æœ‰æ­¤é”çš„çº¿ç¨‹ï¼Œå¦‚æœæ­¤é”ä¸è¢«ä»»ä½•çº¿ç¨‹æ‹¥æœ‰ï¼Œåˆ™è¿”å› nullã€‚protected Thread getOwner()// è¿”å›ä¸€ä¸ª collectionï¼Œå®ƒåŒ…å«å¯èƒ½æ­£ç­‰å¾…è·å–æ­¤é”çš„çº¿ç¨‹ã€‚protected Collection&lt;Thread&gt; getQueuedThreads()// è¿”å›æ­£ç­‰å¾…è·å–æ­¤é”çš„çº¿ç¨‹ä¼°è®¡æ•°ã€‚int getQueueLength()// è¿”å›ä¸€ä¸ª collectionï¼Œå®ƒåŒ…å«å¯èƒ½æ­£åœ¨ç­‰å¾…ä¸æ­¤é”ç›¸å…³ç»™å®šæ¡ä»¶çš„é‚£äº›çº¿ç¨‹ã€‚protected Collection&lt;Thread&gt; getWaitingThreads(Condition condition)// è¿”å›ç­‰å¾…ä¸æ­¤é”ç›¸å…³çš„ç»™å®šæ¡ä»¶çš„çº¿ç¨‹ä¼°è®¡æ•°ã€‚int getWaitQueueLength(Condition condition)// æŸ¥è¯¢ç»™å®šçº¿ç¨‹æ˜¯å¦æ­£åœ¨ç­‰å¾…è·å–æ­¤é”ã€‚boolean hasQueuedThread(Thread thread)// æŸ¥è¯¢æ˜¯å¦æœ‰äº›çº¿ç¨‹æ­£åœ¨ç­‰å¾…è·å–æ­¤é”ã€‚boolean hasQueuedThreads()// æŸ¥è¯¢æ˜¯å¦æœ‰äº›çº¿ç¨‹æ­£åœ¨ç­‰å¾…ä¸æ­¤é”æœ‰å…³çš„ç»™å®šæ¡ä»¶ã€‚boolean hasWaiters(Condition condition)// å¦‚æœæ˜¯â€œå…¬å¹³é”â€è¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚boolean isFair()// æŸ¥è¯¢å½“å‰çº¿ç¨‹æ˜¯å¦ä¿æŒæ­¤é”ã€‚boolean isHeldByCurrentThread()// æŸ¥è¯¢æ­¤é”æ˜¯å¦ç”±ä»»æ„çº¿ç¨‹ä¿æŒã€‚boolean isLocked()// è·å–é”ã€‚void lock()// å¦‚æœå½“å‰çº¿ç¨‹æœªè¢«ä¸­æ–­ï¼Œåˆ™è·å–é”ã€‚void lockInterruptibly()// è¿”å›ç”¨æ¥ä¸æ­¤ Lock å®ä¾‹ä¸€èµ·ä½¿ç”¨çš„ Condition å®ä¾‹ã€‚Condition newCondition()// ä»…åœ¨è°ƒç”¨æ—¶é”æœªè¢«å¦ä¸€ä¸ªçº¿ç¨‹ä¿æŒçš„æƒ…å†µä¸‹ï¼Œæ‰è·å–è¯¥é”ã€‚boolean tryLock()// å¦‚æœé”åœ¨ç»™å®šç­‰å¾…æ—¶é—´å†…æ²¡æœ‰è¢«å¦ä¸€ä¸ªçº¿ç¨‹ä¿æŒï¼Œä¸”å½“å‰çº¿ç¨‹æœªè¢«ä¸­æ–­ï¼Œåˆ™è·å–è¯¥é”ã€‚boolean tryLock(long timeout, TimeUnit unit)// è¯•å›¾é‡Šæ”¾æ­¤é”ã€‚void unlock()123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108// ReentrantLockç¤ºä¾‹import java.util.concurrent.locks.Lock;import java.util.concurrent.locks.ReentrantLock;// LockTest1.java// ä»“åº“class Depot {     private int size;        // ä»“åº“çš„å®é™…æ•°é‡    private Lock lock;        // ç‹¬å é”    public Depot() {        this.size = 0;        this.lock = new ReentrantLock();    }    public void produce(int val) {        lock.lock();        try {            size += val;            System.out.printf(&quot;%s produce(%d) --&gt; size=%d\n&quot;,                     Thread.currentThread().getName(), val, size);        } finally {            lock.unlock();        }    }    public void consume(int val) {        lock.lock();        try {            size -= val;            System.out.printf(&quot;%s consume(%d) &lt;-- size=%d\n&quot;,                     Thread.currentThread().getName(), val, size);        } finally {            lock.unlock();        }    }}; // ç”Ÿäº§è€…class Producer {    private Depot depot;        public Producer(Depot depot) {        this.depot = depot;    }    // æ¶ˆè´¹äº§å“ï¼šæ–°å»ºä¸€ä¸ªçº¿ç¨‹å‘ä»“åº“ä¸­ç”Ÿäº§äº§å“ã€‚    public void produce(final int val) {        new Thread() {            public void run() {                depot.produce(val);            }        }.start();    }}// æ¶ˆè´¹è€…class Customer {    private Depot depot;        public Customer(Depot depot) {        this.depot = depot;    }    // æ¶ˆè´¹äº§å“ï¼šæ–°å»ºä¸€ä¸ªçº¿ç¨‹ä»ä»“åº“ä¸­æ¶ˆè´¹äº§å“ã€‚    public void consume(final int val) {        new Thread() {            public void run() {                depot.consume(val);            }        }.start();    }}public class LockTest1 {      public static void main(String[] args) {          Depot mDepot = new Depot();        Producer mPro = new Producer(mDepot);        Customer mCus = new Customer(mDepot);        mPro.produce(60);        mPro.produce(120);        mCus.consume(90);        mCus.consume(150);        mPro.produce(110);    }}Thread-0 produce(60) --&gt; size=60Thread-1 produce(120) --&gt; size=180Thread-3 consume(150) &lt;-- size=30Thread-2 consume(90) &lt;-- size=-60Thread-4 produce(110) --&gt; size=50ç»“æœåˆ†æï¼š(01) Depot æ˜¯ä¸ªä»“åº“ã€‚é€šè¿‡produce()èƒ½å¾€ä»“åº“ä¸­ç”Ÿäº§è´§ç‰©ï¼Œé€šè¿‡consume()èƒ½æ¶ˆè´¹ä»“åº“ä¸­çš„è´§ç‰©ã€‚é€šè¿‡ç‹¬å é”lockå®ç°å¯¹ä»“åº“çš„äº’æ–¥è®¿é—®ï¼šåœ¨æ“ä½œ(ç”Ÿäº§/æ¶ˆè´¹)ä»“åº“ä¸­è´§å“å‰ï¼Œä¼šå…ˆé€šè¿‡lock()é”ä½ä»“åº“ï¼Œæ“ä½œå®Œä¹‹åå†é€šè¿‡unlock()è§£é”ã€‚(02) Produceræ˜¯ç”Ÿäº§è€…ç±»ã€‚è°ƒç”¨Producerä¸­çš„produce()å‡½æ•°å¯ä»¥æ–°å»ºä¸€ä¸ªçº¿ç¨‹å¾€ä»“åº“ä¸­ç”Ÿäº§äº§å“ã€‚(03) Customeræ˜¯æ¶ˆè´¹è€…ç±»ã€‚è°ƒç”¨Customerä¸­çš„consume()å‡½æ•°å¯ä»¥æ–°å»ºä¸€ä¸ªçº¿ç¨‹æ¶ˆè´¹ä»“åº“ä¸­çš„äº§å“ã€‚(04) åœ¨ä¸»çº¿ç¨‹mainä¸­ï¼Œæˆ‘ä»¬ä¼šæ–°å»º1ä¸ªç”Ÿäº§è€…mProï¼ŒåŒæ—¶æ–°å»º1ä¸ªæ¶ˆè´¹è€…mCusã€‚å®ƒä»¬åˆ†åˆ«å‘ä»“åº“ä¸­ç”Ÿäº§/æ¶ˆè´¹äº§å“ã€‚æ ¹æ®mainä¸­çš„ç”Ÿäº§/æ¶ˆè´¹æ•°é‡ï¼Œä»“åº“æœ€ç»ˆå‰©ä½™çš„äº§å“åº”è¯¥æ˜¯50ã€‚è¿è¡Œç»“æœæ˜¯ç¬¦åˆæˆ‘ä»¬é¢„æœŸçš„ï¼è¿™ä¸ªæ¨¡å‹å­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼š(01) ç°å®ä¸­ï¼Œä»“åº“çš„å®¹é‡ä¸å¯èƒ½ä¸ºè´Ÿæ•°ã€‚ä½†æ˜¯ï¼Œæ­¤æ¨¡å‹ä¸­çš„ä»“åº“å®¹é‡å¯ä»¥ä¸ºè´Ÿæ•°ï¼Œè¿™ä¸ç°å®ç›¸çŸ›ç›¾ï¼(02) ç°å®ä¸­ï¼Œä»“åº“çš„å®¹é‡æ˜¯æœ‰é™åˆ¶çš„ã€‚ä½†æ˜¯ï¼Œæ­¤æ¨¡å‹ä¸­çš„å®¹é‡ç¡®å®æ²¡æœ‰é™åˆ¶çš„ï¼è¿™ä¸¤ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ç¨å¾®ä¼šè®²åˆ°å¦‚ä½•è§£å†³ã€‚ç°åœ¨ï¼Œå…ˆçœ‹ä¸ªç®€å•çš„ç¤ºä¾‹2ï¼›é€šè¿‡å¯¹æ¯”â€œç¤ºä¾‹1â€å’Œâ€œç¤ºä¾‹2â€,æˆ‘ä»¬èƒ½æ›´æ¸…æ™°çš„è®¤è¯†lock(),unlock()çš„ç”¨é€”ã€‚123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141// åœ¨â€œç¤ºä¾‹2â€ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡Conditionå»è§£å†³â€œç¤ºä¾‹1â€ä¸­çš„ä¸¤ä¸ªé—®é¢˜ï¼š// â€œä»“åº“çš„å®¹é‡ä¸å¯èƒ½ä¸ºè´Ÿæ•°â€// â€œä»“åº“çš„å®¹é‡æ˜¯æœ‰é™åˆ¶çš„â€ã€‚// è§£å†³è¯¥é—®é¢˜æ˜¯é€šè¿‡Conditionã€‚Conditionæ˜¯éœ€è¦å’ŒLockè”åˆä½¿ç”¨çš„ï¼šé€šè¿‡Conditionä¸­çš„await()æ–¹æ³•ï¼Œèƒ½è®©çº¿ç¨‹é˜»å¡[ç±»ä¼¼äºwait()]ï¼›é€šè¿‡Conditionçš„signal()æ–¹æ³•ï¼Œèƒ½è®©å”¤é†’çº¿ç¨‹[ç±»ä¼¼äºnotify()]ã€‚import java.util.concurrent.locks.Lock;import java.util.concurrent.locks.ReentrantLock;import java.util.concurrent.locks.Condition;// LockTest3.java// ä»“åº“class Depot {    private int capacity;    // ä»“åº“çš„å®¹é‡    private int size;        // ä»“åº“çš„å®é™…æ•°é‡    private Lock lock;        // ç‹¬å é”    private Condition fullCondtion;            // ç”Ÿäº§æ¡ä»¶    private Condition emptyCondtion;        // æ¶ˆè´¹æ¡ä»¶    public Depot(int capacity) {        this.capacity = capacity;        this.size = 0;        this.lock = new ReentrantLock();        this.fullCondtion = lock.newCondition();        this.emptyCondtion = lock.newCondition();    }    public void produce(int val) {        lock.lock();        try {             // left è¡¨ç¤ºâ€œæƒ³è¦ç”Ÿäº§çš„æ•°é‡â€(æœ‰å¯èƒ½ç”Ÿäº§é‡å¤ªå¤šï¼Œéœ€å¤šæ­¤ç”Ÿäº§)            int left = val;            while (left &gt; 0) {                // åº“å­˜å·²æ»¡æ—¶ï¼Œç­‰å¾…â€œæ¶ˆè´¹è€…â€æ¶ˆè´¹äº§å“ã€‚                while (size &gt;= capacity)                    fullCondtion.await();                // è·å–â€œå®é™…ç”Ÿäº§çš„æ•°é‡â€(å³åº“å­˜ä¸­æ–°å¢çš„æ•°é‡)                // å¦‚æœâ€œåº“å­˜â€+â€œæƒ³è¦ç”Ÿäº§çš„æ•°é‡â€&gt;â€œæ€»çš„å®¹é‡â€ï¼Œåˆ™â€œå®é™…å¢é‡â€=â€œæ€»çš„å®¹é‡â€-â€œå½“å‰å®¹é‡â€ã€‚(æ­¤æ—¶å¡«æ»¡ä»“åº“)                // å¦åˆ™â€œå®é™…å¢é‡â€=â€œæƒ³è¦ç”Ÿäº§çš„æ•°é‡â€                int inc = (size+left)&gt;capacity ? (capacity-size) : left;                size += inc;                left -= inc;                System.out.printf(&quot;%s produce(=) --&gt; left==, inc==, size==\n&quot;,                         Thread.currentThread().getName(), val, left, inc, size);                // é€šçŸ¥â€œæ¶ˆè´¹è€…â€å¯ä»¥æ¶ˆè´¹äº†ã€‚                emptyCondtion.signal();            }        } catch (InterruptedException e) {        } finally {            lock.unlock();        }    }    public void consume(int val) {        lock.lock();        try {            // left è¡¨ç¤ºâ€œå®¢æˆ·è¦æ¶ˆè´¹æ•°é‡â€(æœ‰å¯èƒ½æ¶ˆè´¹é‡å¤ªå¤§ï¼Œåº“å­˜ä¸å¤Ÿï¼Œéœ€å¤šæ­¤æ¶ˆè´¹)            int left = val;            while (left &gt; 0) {                // åº“å­˜ä¸º0æ—¶ï¼Œç­‰å¾…â€œç”Ÿäº§è€…â€ç”Ÿäº§äº§å“ã€‚                while (size &lt;= 0)                    emptyCondtion.await();                // è·å–â€œå®é™…æ¶ˆè´¹çš„æ•°é‡â€(å³åº“å­˜ä¸­å®é™…å‡å°‘çš„æ•°é‡)                // å¦‚æœâ€œåº“å­˜â€&lt;â€œå®¢æˆ·è¦æ¶ˆè´¹çš„æ•°é‡â€ï¼Œåˆ™â€œå®é™…æ¶ˆè´¹é‡â€=â€œåº“å­˜â€ï¼›                // å¦åˆ™ï¼Œâ€œå®é™…æ¶ˆè´¹é‡â€=â€œå®¢æˆ·è¦æ¶ˆè´¹çš„æ•°é‡â€ã€‚                int dec = (size&lt;left) ? size : left;                size -= dec;                left -= dec;                System.out.printf(&quot;%s consume(=) &lt;-- left==, dec==, size==\n&quot;,                         Thread.currentThread().getName(), val, left, dec, size);                fullCondtion.signal();            }        } catch (InterruptedException e) {        } finally {            lock.unlock();        }    }    public String toString() {        return &quot;capacity:&quot;+capacity+&quot;, actual size:&quot;+size;    }}; // ç”Ÿäº§è€…class Producer {    private Depot depot;        public Producer(Depot depot) {        this.depot = depot;    }    // æ¶ˆè´¹äº§å“ï¼šæ–°å»ºä¸€ä¸ªçº¿ç¨‹å‘ä»“åº“ä¸­ç”Ÿäº§äº§å“ã€‚    public void produce(final int val) {        new Thread() {            public void run() {                depot.produce(val);            }        }.start();    }}// æ¶ˆè´¹è€…class Customer {    private Depot depot;        public Customer(Depot depot) {        this.depot = depot;    }    // æ¶ˆè´¹äº§å“ï¼šæ–°å»ºä¸€ä¸ªçº¿ç¨‹ä»ä»“åº“ä¸­æ¶ˆè´¹äº§å“ã€‚    public void consume(final int val) {        new Thread() {            public void run() {                depot.consume(val);            }        }.start();    }}public class LockTest3 {      public static void main(String[] args) {          Depot mDepot = new Depot(100);        Producer mPro = new Producer(mDepot);        Customer mCus = new Customer(mDepot);        mPro.produce(60);        mPro.produce(120);        mCus.consume(90);        mCus.consume(150);        mPro.produce(110);    }}Thread-0 produce( 60) --&gt; left=  0, inc= 60, size= 60Thread-1 produce(120) --&gt; left= 80, inc= 40, size=100Thread-2 consume( 90) &lt;-- left=  0, dec= 90, size= 10Thread-3 consume(150) &lt;-- left=140, dec= 10, size=  0Thread-4 produce(110) --&gt; left= 10, inc=100, size=100Thread-3 consume(150) &lt;-- left= 40, dec=100, size=  0Thread-4 produce(110) --&gt; left=  0, inc= 10, size= 10Thread-3 consume(150) &lt;-- left= 30, dec= 10, size=  0Thread-1 produce(120) --&gt; left=  0, inc= 80, size= 80Thread-3 consume(150) &lt;-- left=  0, dec= 30, size= 50å…¬å¹³é”åŸºæœ¬æ¦‚å¿µ:AQS  â€” æŒ‡AbstractQueuedSynchronizerç±»ã€‚AQSæ˜¯javaä¸­ç®¡ç†â€œé”â€çš„æŠ½è±¡ç±»ï¼Œé”çš„è®¸å¤šå…¬å…±æ–¹æ³•éƒ½æ˜¯åœ¨è¿™ä¸ªç±»ä¸­å®ç°ã€‚AQSæ˜¯ç‹¬å é”(ä¾‹å¦‚ï¼ŒReentrantLock)å’Œå…±äº«é”(ä¾‹å¦‚ï¼ŒSemaphore)çš„å…¬å…±çˆ¶ç±»ã€‚AQSé”çš„ç±»åˆ« â€” åˆ†ä¸ºâ€œç‹¬å é”â€å’Œâ€œå…±äº«é”â€ä¸¤ç§ã€‚(01) ç‹¬å é” â€” é”åœ¨ä¸€ä¸ªæ—¶é—´ç‚¹åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹é”å æœ‰ã€‚æ ¹æ®é”çš„è·å–æœºåˆ¶ï¼Œå®ƒåˆåˆ’åˆ†ä¸ºâ€œå…¬å¹³é”â€å’Œâ€œéå…¬å¹³é”â€ã€‚å…¬å¹³é”ï¼Œæ˜¯æŒ‰ç…§é€šè¿‡CLHç­‰å¾…çº¿ç¨‹æŒ‰ç…§å…ˆæ¥å…ˆå¾—çš„è§„åˆ™ï¼Œå…¬å¹³çš„è·å–é”ï¼›è€Œéå…¬å¹³é”ï¼Œåˆ™å½“çº¿ç¨‹è¦è·å–é”æ—¶ï¼Œå®ƒä¼šæ— è§†CLHç­‰å¾…é˜Ÿåˆ—è€Œç›´æ¥è·å–é”ã€‚ç‹¬å é”çš„å…¸å‹å®ä¾‹å­æ˜¯ReentrantLockï¼Œæ­¤å¤–ï¼ŒReentrantReadWriteLock.WriteLockä¹Ÿæ˜¯ç‹¬å é”ã€‚(02) å…±äº«é” â€” èƒ½è¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶æ‹¥æœ‰ï¼Œèƒ½è¢«å…±äº«çš„é”ã€‚JUCåŒ…ä¸­çš„ReentrantReadWriteLock.ReadLockï¼ŒCyclicBarrierï¼Œ CountDownLatchå’ŒSemaphoreéƒ½æ˜¯å…±äº«é”ã€‚è¿™äº›é”çš„ç”¨é€”å’ŒåŸç†ï¼Œåœ¨ä»¥åçš„ç« èŠ‚å†è¯¦ç»†ä»‹ç»ã€‚CLHé˜Ÿåˆ— â€” Craig, Landin, and Hagersten lock queueCLHé˜Ÿåˆ—æ˜¯AQSä¸­â€œç­‰å¾…é”â€çš„çº¿ç¨‹é˜Ÿåˆ—ã€‚åœ¨å¤šçº¿ç¨‹ä¸­ï¼Œä¸ºäº†ä¿æŠ¤ç«äº‰èµ„æºä¸è¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶æ“ä½œè€Œèµ·æ¥é”™è¯¯ï¼Œæˆ‘ä»¬å¸¸å¸¸éœ€è¦é€šè¿‡é”æ¥ä¿æŠ¤è¿™äº›èµ„æºã€‚åœ¨ç‹¬å é”ä¸­ï¼Œç«äº‰èµ„æºåœ¨ä¸€ä¸ªæ—¶é—´ç‚¹åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹é”è®¿é—®ï¼›è€Œå…¶å®ƒçº¿ç¨‹åˆ™éœ€è¦ç­‰å¾…ã€‚CLHå°±æ˜¯ç®¡ç†è¿™äº›â€œç­‰å¾…é”â€çš„çº¿ç¨‹çš„é˜Ÿåˆ—ã€‚CLHæ˜¯ä¸€ä¸ªéé˜»å¡çš„ FIFO é˜Ÿåˆ—ã€‚ä¹Ÿå°±æ˜¯è¯´å¾€é‡Œé¢æ’å…¥æˆ–ç§»é™¤ä¸€ä¸ªèŠ‚ç‚¹çš„æ—¶å€™ï¼Œåœ¨å¹¶å‘æ¡ä»¶ä¸‹ä¸ä¼šé˜»å¡ï¼Œè€Œæ˜¯é€šè¿‡è‡ªæ—‹é”å’Œ CAS ä¿è¯èŠ‚ç‚¹æ’å…¥å’Œç§»é™¤çš„åŸå­æ€§ã€‚CASå‡½æ•° â€” Compare And SwapCASå‡½æ•°ï¼Œæ˜¯æ¯”è¾ƒå¹¶äº¤æ¢å‡½æ•°ï¼Œå®ƒæ˜¯åŸå­æ“ä½œå‡½æ•°ï¼›å³ï¼Œé€šè¿‡CASæ“ä½œçš„æ•°æ®éƒ½æ˜¯ä»¥åŸå­æ–¹å¼è¿›è¡Œçš„ã€‚ä¾‹å¦‚ï¼ŒcompareAndSetHead(), compareAndSetTail(), compareAndSetNext()ç­‰å‡½æ•°ã€‚å®ƒä»¬å…±åŒçš„ç‰¹ç‚¹æ˜¯ï¼Œè¿™äº›å‡½æ•°æ‰€æ‰§è¡Œçš„åŠ¨ä½œæ˜¯ä»¥åŸå­çš„æ–¹å¼è¿›è¡Œçš„ã€‚è·å–å…¬å¹³é”123456789101112131. lock()lock()åœ¨ReentrantLock.javaçš„FairSyncç±»ä¸­å®ç°è¯´æ˜ï¼šâ€œå½“å‰çº¿ç¨‹â€å®é™…ä¸Šæ˜¯é€šè¿‡acquire(1)è·å–é”çš„ã€‚è¿™é‡Œè¯´æ˜ä¸€ä¸‹â€œ1â€çš„å«ä¹‰ï¼Œå®ƒæ˜¯è®¾ç½®â€œé”çš„çŠ¶æ€â€çš„å‚æ•°ã€‚å¯¹äºâ€œç‹¬å é”â€è€Œè¨€ï¼Œé”å¤„äºå¯è·å–çŠ¶æ€æ—¶ï¼Œå®ƒçš„çŠ¶æ€å€¼æ˜¯0ï¼›é”è¢«çº¿ç¨‹åˆæ¬¡è·å–åˆ°äº†ï¼Œå®ƒçš„çŠ¶æ€å€¼å°±å˜æˆäº†1ã€‚ç”±äºReentrantLock(å…¬å¹³é”/éå…¬å¹³é”)æ˜¯å¯é‡å…¥é”ï¼Œæ‰€ä»¥â€œç‹¬å é”â€å¯ä»¥è¢«å•ä¸ªçº¿ç¨‹å¤šæ­¤è·å–ï¼Œæ¯è·å–1æ¬¡å°±å°†é”çš„çŠ¶æ€+1ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåˆæ¬¡è·å–é”æ—¶ï¼Œé€šè¿‡acquire(1)å°†é”çš„çŠ¶æ€å€¼è®¾ä¸º1ï¼›å†æ¬¡è·å–é”æ—¶ï¼Œå°†é”çš„çŠ¶æ€å€¼è®¾ä¸º2ï¼›ä¾æ¬¡ç±»æ¨...è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè·å–é”æ—¶ï¼Œä¼ å…¥çš„å‚æ•°æ˜¯1çš„åŸå› äº†ã€‚å¯é‡å…¥å°±æ˜¯æŒ‡é”å¯ä»¥è¢«å•ä¸ªçº¿ç¨‹å¤šæ¬¡è·å–ã€‚        2. acquire()acquire()åœ¨AQSä¸­å®ç°çš„(01) â€œå½“å‰çº¿ç¨‹â€é¦–å…ˆé€šè¿‡tryAcquire()å°è¯•è·å–é”ã€‚è·å–æˆåŠŸçš„è¯ï¼Œç›´æ¥è¿”å›ï¼›å°è¯•å¤±è´¥çš„è¯ï¼Œè¿›å…¥åˆ°ç­‰å¾…é˜Ÿåˆ—æ’åºç­‰å¾…(å‰é¢è¿˜æœ‰å¯èƒ½æœ‰éœ€è¦çº¿ç¨‹åœ¨ç­‰å¾…è¯¥é”)ã€‚(02) â€œå½“å‰çº¿ç¨‹â€å°è¯•å¤±è´¥çš„æƒ…å†µä¸‹ï¼Œå…ˆé€šè¿‡addWaiter(Node.EXCLUSIVE)æ¥å°†â€œå½“å‰çº¿ç¨‹â€åŠ å…¥åˆ°&quot;CLHé˜Ÿåˆ—(éé˜»å¡çš„FIFOé˜Ÿåˆ—)&quot;æœ«å°¾ã€‚CLHé˜Ÿåˆ—å°±æ˜¯çº¿ç¨‹ç­‰å¾…é˜Ÿåˆ—ã€‚(03) å†æ‰§è¡Œå®ŒaddWaiter(Node.EXCLUSIVE)ä¹‹åï¼Œä¼šè°ƒç”¨acquireQueued()æ¥è·å–é”ã€‚ç”±äºæ­¤æ—¶ReentrantLockæ˜¯å…¬å¹³é”ï¼Œå®ƒä¼šæ ¹æ®å…¬å¹³æ€§åŸåˆ™æ¥è·å–é”ã€‚(04) â€œå½“å‰çº¿ç¨‹â€åœ¨æ‰§è¡ŒacquireQueued()æ—¶ï¼Œä¼šè¿›å…¥åˆ°CLHé˜Ÿåˆ—ä¸­ä¼‘çœ ç­‰å¾…ï¼Œç›´åˆ°è·å–é”äº†æ‰è¿”å›ï¼å¦‚æœâ€œå½“å‰çº¿ç¨‹â€åœ¨ä¼‘çœ ç­‰å¾…è¿‡ç¨‹ä¸­è¢«ä¸­æ–­è¿‡ï¼ŒacquireQueuedä¼šè¿”å›trueï¼Œæ­¤æ—¶&quot;å½“å‰çº¿ç¨‹&quot;ä¼šè°ƒç”¨selfInterrupt()æ¥è‡ªå·±ç»™è‡ªå·±äº§ç”Ÿä¸€ä¸ªä¸­æ–­ã€‚tryAcquire()123456789101112131415161718192021221. tryAcquire()è¯´æ˜ï¼šæ ¹æ®ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†æå‡ºï¼ŒtryAcquire()çš„ä½œç”¨å°±æ˜¯å°è¯•å»è·å–é”ã€‚æ³¨æ„ï¼Œè¿™é‡Œåªæ˜¯å°è¯•ï¼å°è¯•æˆåŠŸçš„è¯ï¼Œè¿”å›trueï¼›å°è¯•å¤±è´¥çš„è¯ï¼Œè¿”å›falseï¼Œåç»­å†é€šè¿‡å…¶å®ƒåŠæ³•æ¥è·å–è¯¥é”ã€‚åé¢æˆ‘ä»¬ä¼šè¯´æ˜ï¼Œåœ¨å°è¯•å¤±è´¥çš„æƒ…å†µä¸‹ï¼Œæ˜¯å¦‚ä½•ä¸€æ­¥æ­¥è·å–é”çš„ã€‚2. hasQueuedPredecessors()è¯´æ˜ï¼šé€šè¿‡ä»£ç ï¼Œèƒ½åˆ†æå‡ºï¼ŒhasQueuedPredecessors() æ˜¯é€šè¿‡åˆ¤æ–­&quot;å½“å‰çº¿ç¨‹&quot;æ˜¯ä¸æ˜¯åœ¨CLHé˜Ÿåˆ—çš„é˜Ÿé¦–ï¼Œæ¥è¿”å›AQSä¸­æ˜¯ä¸æ˜¯æœ‰æ¯”â€œå½“å‰çº¿ç¨‹â€ç­‰å¾…æ›´ä¹…çš„çº¿ç¨‹ã€‚ä¸‹é¢å¯¹headã€tailå’ŒNodeè¿›è¡Œè¯´æ˜ã€‚3. Nodeçš„æºç è¯´æ˜ï¼šNodeæ˜¯CLHé˜Ÿåˆ—çš„èŠ‚ç‚¹ï¼Œä»£è¡¨â€œç­‰å¾…é”çš„çº¿ç¨‹é˜Ÿåˆ—â€ã€‚(01) æ¯ä¸ªNodeéƒ½ä¼šä¸€ä¸ªçº¿ç¨‹å¯¹åº”ã€‚(02) æ¯ä¸ªNodeä¼šé€šè¿‡prevå’Œnextåˆ†åˆ«æŒ‡å‘ä¸Šä¸€ä¸ªèŠ‚ç‚¹å’Œä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè¿™åˆ†åˆ«ä»£è¡¨ä¸Šä¸€ä¸ªç­‰å¾…çº¿ç¨‹å’Œä¸‹ä¸€ä¸ªç­‰å¾…çº¿ç¨‹ã€‚(03) Nodeé€šè¿‡waitStatusä¿å­˜çº¿ç¨‹çš„ç­‰å¾…çŠ¶æ€ã€‚(04) Nodeé€šè¿‡nextWaiteræ¥åŒºåˆ†çº¿ç¨‹æ˜¯â€œç‹¬å é”â€çº¿ç¨‹è¿˜æ˜¯â€œå…±äº«é”â€çº¿ç¨‹ã€‚å¦‚æœæ˜¯â€œç‹¬å é”â€çº¿ç¨‹ï¼Œåˆ™nextWaiterçš„å€¼ä¸ºEXCLUSIVEï¼›å¦‚æœæ˜¯â€œå…±äº«é”â€çº¿ç¨‹ï¼Œåˆ™nextWaiterçš„å€¼æ˜¯SHAREDã€‚4. compareAndSetState()è¯´æ˜ï¼š compareAndSwapInt() æ˜¯sun.misc.Unsafeç±»ä¸­çš„ä¸€ä¸ªæœ¬åœ°æ–¹æ³•ã€‚å¯¹æ­¤ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£çš„æ˜¯ compareAndSetState(expect, update) æ˜¯ä»¥åŸå­çš„æ–¹å¼æ“ä½œå½“å‰çº¿ç¨‹ï¼›è‹¥å½“å‰çº¿ç¨‹çš„çŠ¶æ€ä¸ºexpectï¼Œåˆ™è®¾ç½®å®ƒçš„çŠ¶æ€ä¸ºupdateã€‚5. setExclusiveOwnerThread()è¯´æ˜ï¼šsetExclusiveOwnerThread()çš„ä½œç”¨å°±æ˜¯ï¼Œè®¾ç½®çº¿ç¨‹tä¸ºå½“å‰æ‹¥æœ‰â€œç‹¬å é”â€çš„çº¿ç¨‹6. getState(), setState()è¯´æ˜ï¼šstateè¡¨ç¤ºé”çš„çŠ¶æ€ï¼Œå¯¹äºâ€œç‹¬å é”â€è€Œå·²ï¼Œstate=0è¡¨ç¤ºé”æ˜¯å¯è·å–çŠ¶æ€(å³ï¼Œé”æ²¡æœ‰è¢«ä»»ä½•çº¿ç¨‹é”æŒæœ‰)ã€‚ç”±äºjavaä¸­çš„ç‹¬å é”æ˜¯å¯é‡å…¥çš„ï¼Œstateçš„å€¼å¯ä»¥&gt;1ã€‚addWaiter(Node.EXCLUSIVE)123456789101112addWaiter(Node.EXCLUSIVE)çš„ä½œç”¨æ˜¯ï¼Œåˆ›å»ºâ€œå½“å‰çº¿ç¨‹â€çš„NodeèŠ‚ç‚¹ï¼Œä¸”Nodeä¸­è®°å½•â€œå½“å‰çº¿ç¨‹â€å¯¹åº”çš„é”æ˜¯â€œç‹¬å é”â€ç±»å‹ï¼Œå¹¶ä¸”å°†è¯¥èŠ‚ç‚¹æ·»åŠ åˆ°CLHé˜Ÿåˆ—çš„æœ«å°¾ã€‚1.addWaiter()è¯´æ˜ï¼šå¯¹äºâ€œå…¬å¹³é”â€è€Œè¨€ï¼ŒaddWaiter(Node.EXCLUSIVE)ä¼šé¦–å…ˆåˆ›å»ºä¸€ä¸ªNodeèŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹çš„ç±»å‹æ˜¯â€œç‹¬å é”â€(Node.EXCLUSIVE)ç±»å‹ã€‚ç„¶åï¼Œå†å°†è¯¥èŠ‚ç‚¹æ·»åŠ åˆ°CLHé˜Ÿåˆ—çš„æœ«å°¾ã€‚2. compareAndSetTail()è¯´æ˜ï¼šcompareAndSetTailä¹Ÿå±äºCASå‡½æ•°ï¼Œä¹Ÿæ˜¯é€šè¿‡â€œæœ¬åœ°æ–¹æ³•â€å®ç°çš„ã€‚compareAndSetTail(expect, update)ä¼šä»¥åŸå­çš„æ–¹å¼è¿›è¡Œæ“ä½œï¼Œå®ƒçš„ä½œç”¨æ˜¯åˆ¤æ–­CLHé˜Ÿåˆ—çš„é˜Ÿå°¾æ˜¯ä¸æ˜¯ä¸ºexpectï¼Œæ˜¯çš„è¯ï¼Œå°±å°†é˜Ÿå°¾è®¾ä¸ºupdateã€‚3. enq()è¯´æ˜ï¼š enq()çš„ä½œç”¨å¾ˆç®€å•ã€‚å¦‚æœCLHé˜Ÿåˆ—ä¸ºç©ºï¼Œåˆ™æ–°å»ºä¸€ä¸ªCLHè¡¨å¤´ï¼›ç„¶åå°†nodeæ·»åŠ åˆ°CLHæœ«å°¾ã€‚å¦åˆ™ï¼Œç›´æ¥å°†nodeæ·»åŠ åˆ°CLHæœ«å°¾ã€‚å°ç»“ï¼šaddWaiter()çš„ä½œç”¨ï¼Œå°±æ˜¯å°†å½“å‰çº¿ç¨‹æ·»åŠ åˆ°CLHé˜Ÿåˆ—ä¸­ã€‚è¿™å°±æ„å‘³ç€å°†å½“å‰çº¿ç¨‹æ·»åŠ åˆ°ç­‰å¾…è·å–â€œé”â€çš„ç­‰å¾…çº¿ç¨‹é˜Ÿåˆ—ä¸­äº†ã€‚acquireQueued()12345678910111213141516171819202122232425262728293031323334353637383940414243acquireQueued()çš„ä½œç”¨å°±æ˜¯é€æ­¥çš„å»æ‰§è¡ŒCLHé˜Ÿåˆ—çš„çº¿ç¨‹ï¼Œå¦‚æœå½“å‰çº¿ç¨‹è·å–åˆ°äº†é”ï¼Œåˆ™è¿”å›ï¼›å¦åˆ™ï¼Œå½“å‰çº¿ç¨‹è¿›è¡Œä¼‘çœ ï¼Œç›´åˆ°å”¤é†’å¹¶é‡æ–°è·å–é”äº†æ‰è¿”å›ã€‚1. acquireQueued()è¯´æ˜ï¼šacquireQueued()çš„ç›®çš„æ˜¯ä»é˜Ÿåˆ—ä¸­è·å–é”ã€‚2. shouldParkAfterFailedAcquire()è¯´æ˜ï¼š(01) å…³äºwaitStatusè¯·å‚è€ƒä¸‹è¡¨(ä¸­æ‰©å·å†…ä¸ºwaitStatusçš„å€¼)ï¼Œæ›´å¤šå…³äºwaitStatusçš„å†…å®¹ï¼Œå¯ä»¥å‚è€ƒå‰é¢çš„Nodeç±»çš„ä»‹ç»ã€‚    CANCELLED[1]  -- å½“å‰çº¿ç¨‹å·²è¢«å–æ¶ˆ    SIGNAL[-1]    -- â€œå½“å‰çº¿ç¨‹çš„åç»§çº¿ç¨‹éœ€è¦è¢«unpark(å”¤é†’)â€ã€‚ä¸€èˆ¬å‘ç”Ÿæƒ…å†µæ˜¯ï¼šå½“å‰çº¿ç¨‹çš„åç»§çº¿ç¨‹å¤„äºé˜»å¡çŠ¶æ€ï¼Œè€Œå½“å‰çº¿ç¨‹è¢«releaseæˆ–cancelæ‰ï¼Œå› æ­¤éœ€è¦å”¤é†’å½“å‰çº¿ç¨‹çš„åç»§çº¿ç¨‹ã€‚    CONDITION[-2] -- å½“å‰çº¿ç¨‹(å¤„åœ¨Conditionä¼‘çœ çŠ¶æ€)åœ¨ç­‰å¾…Conditionå”¤é†’    PROPAGATE[-3] -- (å…±äº«é”)å…¶å®ƒçº¿ç¨‹è·å–åˆ°â€œå…±äº«é”â€    [0]           -- å½“å‰çº¿ç¨‹ä¸å±äºä¸Šé¢çš„ä»»ä½•ä¸€ç§çŠ¶æ€ã€‚(02) shouldParkAfterFailedAcquire()é€šè¿‡ä»¥ä¸‹è§„åˆ™ï¼Œåˆ¤æ–­â€œå½“å‰çº¿ç¨‹â€æ˜¯å¦éœ€è¦è¢«é˜»å¡ã€‚    è§„åˆ™1ï¼šå¦‚æœå‰ç»§èŠ‚ç‚¹çŠ¶æ€ä¸ºSIGNALï¼Œè¡¨æ˜å½“å‰èŠ‚ç‚¹éœ€è¦è¢«unpark(å”¤é†’)ï¼Œæ­¤æ—¶åˆ™è¿”å›trueã€‚    è§„åˆ™2ï¼šå¦‚æœå‰ç»§èŠ‚ç‚¹çŠ¶æ€ä¸ºCANCELLED(ws&gt;0)ï¼Œè¯´æ˜å‰ç»§èŠ‚ç‚¹å·²ç»è¢«å–æ¶ˆï¼Œåˆ™é€šè¿‡å…ˆå‰å›æº¯æ‰¾åˆ°ä¸€ä¸ªæœ‰æ•ˆ(éCANCELLEDçŠ¶æ€)çš„èŠ‚ç‚¹ï¼Œå¹¶è¿”å›falseã€‚    è§„åˆ™3ï¼šå¦‚æœå‰ç»§èŠ‚ç‚¹çŠ¶æ€ä¸ºéSIGNALã€éCANCELLEDï¼Œåˆ™è®¾ç½®å‰ç»§çš„çŠ¶æ€ä¸ºSIGNALï¼Œå¹¶è¿”å›falseã€‚å¦‚æœâ€œè§„åˆ™1â€å‘ç”Ÿï¼Œå³â€œå‰ç»§èŠ‚ç‚¹æ˜¯SIGNALâ€çŠ¶æ€ï¼Œåˆ™æ„å‘³ç€â€œå½“å‰çº¿ç¨‹â€éœ€è¦è¢«é˜»å¡ã€‚æ¥ä¸‹æ¥ä¼šè°ƒç”¨parkAndCheckInterrupt()é˜»å¡å½“å‰çº¿ç¨‹ï¼Œç›´åˆ°å½“å‰å…ˆè¢«å”¤é†’æ‰ä»parkAndCheckInterrupt()ä¸­è¿”å›ã€‚3. parkAndCheckInterrupt())è¯´æ˜ï¼šparkAndCheckInterrupt()çš„ä½œç”¨æ˜¯é˜»å¡å½“å‰çº¿ç¨‹ï¼Œå¹¶ä¸”è¿”å›â€œçº¿ç¨‹è¢«å”¤é†’ä¹‹åâ€çš„ä¸­æ–­çŠ¶æ€ã€‚å®ƒä¼šå…ˆé€šè¿‡LockSupport.park()é˜»å¡â€œå½“å‰çº¿ç¨‹â€ï¼Œç„¶åé€šè¿‡Thread.interrupted()è¿”å›çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€ã€‚è¿™é‡Œä»‹ç»ä¸€ä¸‹çº¿ç¨‹è¢«é˜»å¡ä¹‹åå¦‚ä½•å”¤é†’ã€‚ä¸€èˆ¬æœ‰2ç§æƒ…å†µï¼šç¬¬1ç§æƒ…å†µï¼šunpark()å”¤é†’ã€‚â€œå‰ç»§èŠ‚ç‚¹å¯¹åº”çš„çº¿ç¨‹â€ä½¿ç”¨å®Œé”ä¹‹åï¼Œé€šè¿‡unpark()æ–¹å¼å”¤é†’å½“å‰çº¿ç¨‹ã€‚ç¬¬2ç§æƒ…å†µï¼šä¸­æ–­å”¤é†’ã€‚å…¶å®ƒçº¿ç¨‹é€šè¿‡interrupt()ä¸­æ–­å½“å‰çº¿ç¨‹ã€‚è¡¥å……ï¼šLockSupport()ä¸­çš„park(),unpark()çš„ä½œç”¨ å’Œ Objectä¸­çš„wait(),notify()ä½œç”¨ç±»ä¼¼ï¼Œæ˜¯é˜»å¡/å”¤é†’ã€‚å®ƒä»¬çš„ç”¨æ³•ä¸åŒï¼Œpark(),unpark()æ˜¯è½»é‡çº§çš„ï¼Œè€Œwait(),notify()æ˜¯å¿…é¡»å…ˆé€šè¿‡Synchronizedè·å–åŒæ­¥é”ã€‚4. å†æ¬¡tryAcquire()è¯´æ˜ï¼š(01) é€šè¿‡node.predecessor()è·å–å‰ç»§èŠ‚ç‚¹ã€‚predecessor()å°±æ˜¯è¿”å›nodeçš„å‰ç»§èŠ‚ç‚¹ï¼Œè‹¥å¯¹æ­¤æœ‰ç–‘æƒ‘å¯ä»¥æŸ¥çœ‹ä¸‹é¢å…³äºNodeç±»çš„ä»‹ç»ã€‚(02) p == head &amp;&amp; tryAcquire(arg)é¦–å…ˆï¼Œåˆ¤æ–­â€œå‰ç»§èŠ‚ç‚¹â€æ˜¯ä¸æ˜¯CHLè¡¨å¤´ã€‚å¦‚æœæ˜¯çš„è¯ï¼Œåˆ™é€šè¿‡tryAcquire()å°è¯•è·å–é”ã€‚å…¶å®ï¼Œè¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†â€œè®©å½“å‰çº¿ç¨‹è·å–é”â€ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆéœ€è¦å…ˆåˆ¤æ–­p==headå‘¢ï¼Ÿç†è§£è¿™ä¸ªå¯¹ç†è§£â€œå…¬å¹³é”â€çš„æœºåˆ¶å¾ˆé‡è¦ï¼Œå› ä¸ºè¿™ä¹ˆåšçš„åŸå› å°±æ˜¯ä¸ºäº†ä¿è¯å…¬å¹³æ€§ï¼(a) å‰é¢ï¼Œæˆ‘ä»¬åœ¨shouldParkAfterFailedAcquire()æˆ‘ä»¬åˆ¤æ–­â€œå½“å‰çº¿ç¨‹â€æ˜¯å¦éœ€è¦é˜»å¡ï¼›(b) æ¥ç€ï¼Œâ€œå½“å‰çº¿ç¨‹â€é˜»å¡çš„è¯ï¼Œä¼šè°ƒç”¨parkAndCheckInterrupt()æ¥é˜»å¡çº¿ç¨‹ã€‚å½“çº¿ç¨‹è¢«è§£é™¤é˜»å¡çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šè¿”å›çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€ã€‚è€Œçº¿ç¨‹è¢«è§£å†³é˜»å¡ï¼Œå¯èƒ½æ˜¯ç”±äºâ€œçº¿ç¨‹è¢«ä¸­æ–­â€ï¼Œä¹Ÿå¯èƒ½æ˜¯ç”±äºâ€œå…¶å®ƒçº¿ç¨‹è°ƒç”¨äº†è¯¥çº¿ç¨‹çš„unpark()å‡½æ•°â€ã€‚(c) å†å›åˆ°p==headè¿™é‡Œã€‚å¦‚æœå½“å‰çº¿ç¨‹æ˜¯å› ä¸ºå…¶å®ƒçº¿ç¨‹è°ƒç”¨äº†unpark()å‡½æ•°è€Œè¢«å”¤é†’ï¼Œé‚£ä¹ˆå”¤é†’å®ƒçš„çº¿ç¨‹ï¼Œåº”è¯¥æ˜¯å®ƒçš„å‰ç»§èŠ‚ç‚¹æ‰€å¯¹åº”çš„çº¿ç¨‹(å…³äºè¿™ä¸€ç‚¹ï¼Œåé¢åœ¨â€œé‡Šæ”¾é”â€çš„è¿‡ç¨‹ä¸­ä¼šçœ‹åˆ°)ã€‚ OKï¼Œæ˜¯å‰ç»§èŠ‚ç‚¹è°ƒç”¨unpark()å”¤é†’äº†å½“å‰çº¿ç¨‹ï¼æ­¤æ—¶ï¼Œå†æ¥ç†è§£p==headå°±å¾ˆç®€å•äº†ï¼šå½“å‰ç»§èŠ‚ç‚¹æ˜¯CLHé˜Ÿåˆ—çš„å¤´èŠ‚ç‚¹ï¼Œå¹¶ä¸”å®ƒé‡Šæ”¾é”ä¹‹åï¼›å°±è½®åˆ°å½“å‰èŠ‚ç‚¹è·å–é”äº†ã€‚ç„¶åï¼Œå½“å‰èŠ‚ç‚¹é€šè¿‡tryAcquire()è·å–é”ï¼›è·å–æˆåŠŸçš„è¯ï¼Œé€šè¿‡setHead(node)è®¾ç½®å½“å‰èŠ‚ç‚¹ä¸ºå¤´èŠ‚ç‚¹ï¼Œå¹¶è¿”å›ã€‚æ€»ä¹‹ï¼Œå¦‚æœâ€œå‰ç»§èŠ‚ç‚¹è°ƒç”¨unpark()å”¤é†’äº†å½“å‰çº¿ç¨‹â€å¹¶ä¸”â€œå‰ç»§èŠ‚ç‚¹æ˜¯CLHè¡¨å¤´â€ï¼Œæ­¤æ—¶å°±æ˜¯æ»¡è¶³p==headï¼Œä¹Ÿå°±æ˜¯ç¬¦åˆå…¬å¹³æ€§åŸåˆ™çš„ã€‚å¦åˆ™ï¼Œå¦‚æœå½“å‰çº¿ç¨‹æ˜¯å› ä¸ºâ€œçº¿ç¨‹è¢«ä¸­æ–­â€è€Œå”¤é†’ï¼Œé‚£ä¹ˆæ˜¾ç„¶å°±ä¸æ˜¯å…¬å¹³äº†ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¯´p==headå°±æ˜¯ä¿è¯å…¬å¹³æ€§ï¼å°ç»“ï¼šacquireQueued()çš„ä½œç”¨å°±æ˜¯â€œå½“å‰çº¿ç¨‹â€ä¼šæ ¹æ®å…¬å¹³æ€§åŸåˆ™è¿›è¡Œé˜»å¡ç­‰å¾…ï¼Œç›´åˆ°è·å–é”ä¸ºæ­¢ï¼›å¹¶ä¸”è¿”å›å½“å‰çº¿ç¨‹åœ¨ç­‰å¾…è¿‡ç¨‹ä¸­æœ‰æ²¡æœ‰å¹¶ä¸­æ–­è¿‡ã€‚selfInterrupt()1234567891011121314151617181920private static void selfInterrupt() {    Thread.currentThread().interrupt();}è¯´æ˜ï¼šselfInterrupt()çš„ä»£ç å¾ˆç®€å•ï¼Œå°±æ˜¯â€œå½“å‰çº¿ç¨‹â€è‡ªå·±äº§ç”Ÿä¸€ä¸ªä¸­æ–­ã€‚ä½†æ˜¯ï¼Œä¸ºä»€ä¹ˆéœ€è¦è¿™ä¹ˆåšå‘¢ï¼Ÿè¿™å¿…é¡»ç»“åˆacquireQueued()è¿›è¡Œåˆ†æã€‚å¦‚æœåœ¨acquireQueued()ä¸­ï¼Œå½“å‰çº¿ç¨‹è¢«ä¸­æ–­è¿‡ï¼Œåˆ™æ‰§è¡ŒselfInterrupt()ï¼›å¦åˆ™ä¸ä¼šæ‰§è¡Œã€‚åœ¨acquireQueued()ä¸­ï¼Œå³ä½¿æ˜¯çº¿ç¨‹åœ¨é˜»å¡çŠ¶æ€è¢«ä¸­æ–­å”¤é†’è€Œè·å–åˆ°cpuæ‰§è¡Œæƒåˆ©ï¼›ä½†æ˜¯ï¼Œå¦‚æœè¯¥çº¿ç¨‹çš„å‰é¢è¿˜æœ‰å…¶å®ƒç­‰å¾…é”çš„çº¿ç¨‹ï¼Œæ ¹æ®å…¬å¹³æ€§åŸåˆ™ï¼Œè¯¥çº¿ç¨‹ä¾ç„¶æ— æ³•è·å–åˆ°é”ã€‚å®ƒä¼šå†æ¬¡é˜»å¡ï¼ è¯¥çº¿ç¨‹å†æ¬¡é˜»å¡ï¼Œç›´åˆ°è¯¥çº¿ç¨‹è¢«å®ƒçš„å‰é¢ç­‰å¾…é”çš„çº¿ç¨‹é”å”¤é†’ï¼›çº¿ç¨‹æ‰ä¼šè·å–é”ï¼Œç„¶åâ€œçœŸæ­£æ‰§è¡Œèµ·æ¥â€ï¼ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨è¯¥çº¿ç¨‹â€œæˆåŠŸè·å–é”å¹¶çœŸæ­£æ‰§è¡Œèµ·æ¥â€ä¹‹å‰ï¼Œå®ƒçš„ä¸­æ–­ä¼šè¢«å¿½ç•¥å¹¶ä¸”ä¸­æ–­æ ‡è®°ä¼šè¢«æ¸…é™¤ï¼ å› ä¸ºåœ¨parkAndCheckInterrupt()ä¸­ï¼Œæˆ‘ä»¬çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€æ—¶è°ƒç”¨äº†Thread.interrupted()ã€‚è¯¥å‡½æ•°ä¸åŒäºThreadçš„isInterrupted()å‡½æ•°ï¼ŒisInterrupted()ä»…ä»…è¿”å›ä¸­æ–­çŠ¶æ€ï¼Œè€Œinterrupted()åœ¨è¿”å›å½“å‰ä¸­æ–­çŠ¶æ€ä¹‹åï¼Œè¿˜ä¼šæ¸…é™¤ä¸­æ–­çŠ¶æ€ã€‚ æ­£å› ä¸ºä¹‹å‰çš„ä¸­æ–­çŠ¶æ€è¢«æ¸…é™¤äº†ï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦è°ƒç”¨selfInterrupt()é‡æ–°äº§ç”Ÿä¸€ä¸ªä¸­æ–­ï¼å°ç»“ï¼šselfInterrupt()çš„ä½œç”¨å°±æ˜¯å½“å‰çº¿ç¨‹è‡ªå·±äº§ç”Ÿä¸€ä¸ªä¸­æ–­ã€‚æ€»ç»“:å†å›è¿‡å¤´çœ‹çœ‹acquire()å‡½æ•°ï¼Œå®ƒæœ€ç»ˆçš„ç›®çš„æ˜¯è·å–é”ï¼public final void acquire(int arg) {    if (!tryAcquire(arg) &amp;&amp;        acquireQueued(addWaiter(Node.EXCLUSIVE), arg))        selfInterrupt();}(01) å…ˆæ˜¯é€šè¿‡tryAcquire()å°è¯•è·å–é”ã€‚è·å–æˆåŠŸçš„è¯ï¼Œç›´æ¥è¿”å›ï¼›å°è¯•å¤±è´¥çš„è¯ï¼Œå†é€šè¿‡acquireQueued()è·å–é”ã€‚(02) å°è¯•å¤±è´¥çš„æƒ…å†µä¸‹ï¼Œä¼šå…ˆé€šè¿‡addWaiter()æ¥å°†â€œå½“å‰çº¿ç¨‹â€åŠ å…¥åˆ°&quot;CLHé˜Ÿåˆ—&quot;æœ«å°¾ï¼›ç„¶åè°ƒç”¨acquireQueued()ï¼Œåœ¨CLHé˜Ÿåˆ—ä¸­æ’åºç­‰å¾…è·å–é”ï¼Œåœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œçº¿ç¨‹å¤„äºä¼‘çœ çŠ¶æ€ã€‚ç›´åˆ°è·å–é”äº†æ‰è¿”å›ã€‚ å¦‚æœåœ¨ä¼‘çœ ç­‰å¾…è¿‡ç¨‹ä¸­è¢«ä¸­æ–­è¿‡ï¼Œåˆ™è°ƒç”¨selfInterrupt()æ¥è‡ªå·±äº§ç”Ÿä¸€ä¸ªä¸­æ–­ã€‚é‡Šæ”¾å…¬å¹³é”123456789101112131415161718191. unlock()è¯´æ˜ï¼šunlock()æ˜¯è§£é”å‡½æ•°ï¼Œå®ƒæ˜¯é€šè¿‡AQSçš„release()å‡½æ•°æ¥å®ç°çš„ã€‚åœ¨è¿™é‡Œï¼Œâ€œ1â€çš„å«ä¹‰å’Œâ€œè·å–é”çš„å‡½æ•°acquire(1)çš„å«ä¹‰â€ä¸€æ ·ï¼Œå®ƒæ˜¯è®¾ç½®â€œé‡Šæ”¾é”çš„çŠ¶æ€â€çš„å‚æ•°ã€‚ç”±äºâ€œå…¬å¹³é”â€æ˜¯å¯é‡å…¥çš„ï¼Œæ‰€ä»¥å¯¹äºåŒä¸€ä¸ªçº¿ç¨‹ï¼Œæ¯é‡Šæ”¾é”ä¸€æ¬¡ï¼Œé”çš„çŠ¶æ€-1ã€‚2. release()è¯´æ˜ï¼šrelease()ä¼šå…ˆè°ƒç”¨tryRelease()æ¥å°è¯•é‡Šæ”¾å½“å‰çº¿ç¨‹é”æŒæœ‰çš„é”ã€‚æˆåŠŸçš„è¯ï¼Œåˆ™å”¤é†’åç»§ç­‰å¾…çº¿ç¨‹ï¼Œå¹¶è¿”å›trueã€‚å¦åˆ™ï¼Œç›´æ¥è¿”å›falseã€‚3. tryRelease()è¯´æ˜ï¼štryRelease()çš„ä½œç”¨æ˜¯å°è¯•é‡Šæ”¾é”ã€‚(01) å¦‚æœâ€œå½“å‰çº¿ç¨‹â€ä¸æ˜¯â€œé”çš„æŒæœ‰è€…â€ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚(02) å¦‚æœâ€œå½“å‰çº¿ç¨‹â€åœ¨æœ¬æ¬¡é‡Šæ”¾é”æ“ä½œä¹‹åï¼Œå¯¹é”çš„æ‹¥æœ‰çŠ¶æ€æ˜¯0(å³ï¼Œå½“å‰çº¿ç¨‹å½»åº•é‡Šæ”¾è¯¥â€œé”â€)ï¼Œåˆ™è®¾ç½®â€œé”â€çš„æŒæœ‰è€…ä¸ºnullï¼Œå³é”æ˜¯å¯è·å–çŠ¶æ€ã€‚åŒæ—¶ï¼Œæ›´æ–°å½“å‰çº¿ç¨‹çš„é”çš„çŠ¶æ€ä¸º0ã€‚4. unparkSuccessor()åœ¨release()ä¸­â€œå½“å‰çº¿ç¨‹â€é‡Šæ”¾é”æˆåŠŸçš„è¯ï¼Œä¼šå”¤é†’å½“å‰çº¿ç¨‹çš„åç»§çº¿ç¨‹ã€‚æ ¹æ®CLHé˜Ÿåˆ—çš„FIFOè§„åˆ™ï¼Œâ€œå½“å‰çº¿ç¨‹â€(å³å·²ç»è·å–é”çš„çº¿ç¨‹)è‚¯å®šæ˜¯headï¼›å¦‚æœCLHé˜Ÿåˆ—éç©ºçš„è¯ï¼Œåˆ™å”¤é†’é”çš„ä¸‹ä¸€ä¸ªç­‰å¾…çº¿ç¨‹ã€‚è¯´æ˜ï¼šunparkSuccessor()çš„ä½œç”¨æ˜¯â€œå”¤é†’å½“å‰çº¿ç¨‹çš„åç»§çº¿ç¨‹â€ã€‚åç»§çº¿ç¨‹è¢«å”¤é†’ä¹‹åï¼Œå°±å¯ä»¥è·å–è¯¥é”å¹¶æ¢å¤è¿è¡Œäº†ã€‚å…³æ€»ç»“: â€œé‡Šæ”¾é”â€çš„è¿‡ç¨‹ç›¸å¯¹â€œè·å–é”â€çš„è¿‡ç¨‹æ¯”è¾ƒç®€å•ã€‚é‡Šæ”¾é”æ—¶ï¼Œä¸»è¦è¿›è¡Œçš„æ“ä½œï¼Œæ˜¯æ›´æ–°å½“å‰çº¿ç¨‹å¯¹åº”çš„é”çš„çŠ¶æ€ã€‚å¦‚æœå½“å‰çº¿ç¨‹å¯¹é”å·²ç»å½»åº•é‡Šæ”¾ï¼Œåˆ™è®¾ç½®â€œé”â€çš„æŒæœ‰çº¿ç¨‹ä¸ºnullï¼Œè®¾ç½®å½“å‰çº¿ç¨‹çš„çŠ¶æ€ä¸ºç©ºï¼Œç„¶åå”¤é†’åç»§çº¿ç¨‹ã€‚éå…¬å¹³é”è·å–éå…¬å¹³é”1éå…¬å¹³é”å’Œå…¬å¹³é”åœ¨è·å–é”çš„æ–¹æ³•ä¸Šï¼Œæµç¨‹æ˜¯ä¸€æ ·çš„ï¼›å®ƒä»¬çš„åŒºåˆ«ä¸»è¦è¡¨ç°åœ¨â€œå°è¯•è·å–é”çš„æœºåˆ¶ä¸åŒâ€ã€‚ç®€å•ç‚¹è¯´ï¼Œâ€œå…¬å¹³é”â€åœ¨æ¯æ¬¡å°è¯•è·å–é”æ—¶ï¼Œéƒ½æ˜¯é‡‡ç”¨å…¬å¹³ç­–ç•¥(æ ¹æ®ç­‰å¾…é˜Ÿåˆ—ä¾æ¬¡æ’åºç­‰å¾…)ï¼›è€Œâ€œéå…¬å¹³é”â€åœ¨æ¯æ¬¡å°è¯•è·å–é”æ—¶ï¼Œéƒ½æ˜¯é‡‡ç”¨çš„éå…¬å¹³ç­–ç•¥(æ— è§†ç­‰å¾…é˜Ÿåˆ—ï¼Œç›´æ¥å°è¯•è·å–é”ï¼Œå¦‚æœé”æ˜¯ç©ºé—²çš„ï¼Œå³å¯è·å–çŠ¶æ€ï¼Œåˆ™è·å–é”)ã€‚12345678910111213141516171819202122232425262728291. lock()è¯´æ˜ï¼šlock()ä¼šå…ˆé€šè¿‡compareAndSet(0, 1)æ¥åˆ¤æ–­â€œé”â€æ˜¯ä¸æ˜¯ç©ºé—²çŠ¶æ€ã€‚æ˜¯çš„è¯ï¼Œâ€œå½“å‰çº¿ç¨‹â€ç›´æ¥è·å–â€œé”â€ï¼›å¦åˆ™çš„è¯ï¼Œè°ƒç”¨acquire(1)è·å–é”ã€‚(01) compareAndSetState()æ˜¯CASå‡½æ•°ï¼Œå®ƒçš„ä½œç”¨æ˜¯æ¯”è¾ƒå¹¶è®¾ç½®å½“å‰é”çš„çŠ¶æ€ã€‚è‹¥é”çš„çŠ¶æ€å€¼ä¸º0ï¼Œåˆ™è®¾ç½®é”çš„çŠ¶æ€å€¼ä¸º1ã€‚(02) setExclusiveOwnerThread(Thread.currentThread())çš„ä½œç”¨æ˜¯ï¼Œè®¾ç½®â€œå½“å‰çº¿ç¨‹â€ä¸ºâ€œé”â€çš„æŒæœ‰è€…ã€‚â€œå…¬å¹³é”â€å’Œâ€œéå…¬å¹³é”â€å…³äºlock()çš„å¯¹æ¯”å…¬å¹³é”   -- å…¬å¹³é”çš„lock()å‡½æ•°ï¼Œä¼šç›´æ¥è°ƒç”¨acquire(1)ã€‚éå…¬å¹³é” -- éå…¬å¹³é”ä¼šå…ˆåˆ¤æ–­å½“å‰é”çš„çŠ¶æ€æ˜¯ä¸æ˜¯ç©ºé—²ï¼Œæ˜¯çš„è¯ï¼Œå°±ä¸æ’é˜Ÿï¼Œè€Œæ˜¯ç›´æ¥è·å–é”ã€‚2. acquire()(01) â€œå½“å‰çº¿ç¨‹â€é¦–å…ˆé€šè¿‡tryAcquire()å°è¯•è·å–é”ã€‚è·å–æˆåŠŸçš„è¯ï¼Œç›´æ¥è¿”å›ï¼›å°è¯•å¤±è´¥çš„è¯ï¼Œè¿›å…¥åˆ°ç­‰å¾…é˜Ÿåˆ—ä¾æ¬¡æ’åºï¼Œç„¶åè·å–é”ã€‚(02) â€œå½“å‰çº¿ç¨‹â€å°è¯•å¤±è´¥çš„æƒ…å†µä¸‹ï¼Œä¼šå…ˆé€šè¿‡addWaiter(Node.EXCLUSIVE)æ¥å°†â€œå½“å‰çº¿ç¨‹â€åŠ å…¥åˆ°&quot;CLHé˜Ÿåˆ—(éé˜»å¡çš„FIFOé˜Ÿåˆ—)&quot;æœ«å°¾ã€‚(03) ç„¶åï¼Œè°ƒç”¨acquireQueued()è·å–é”ã€‚åœ¨acquireQueued()ä¸­ï¼Œå½“å‰çº¿ç¨‹ä¼šç­‰å¾…å®ƒåœ¨â€œCLHé˜Ÿåˆ—â€ä¸­å‰é¢çš„æ‰€æœ‰çº¿ç¨‹æ‰§è¡Œå¹¶é‡Šæ”¾é”ä¹‹åï¼Œæ‰èƒ½è·å–é”å¹¶è¿”å›ã€‚å¦‚æœâ€œå½“å‰çº¿ç¨‹â€åœ¨ä¼‘çœ ç­‰å¾…è¿‡ç¨‹ä¸­è¢«ä¸­æ–­è¿‡ï¼Œåˆ™è°ƒç”¨selfInterrupt()æ¥è‡ªå·±äº§ç”Ÿä¸€ä¸ªä¸­æ–­ã€‚â€œå…¬å¹³é”â€å’Œâ€œéå…¬å¹³é”â€å…³äºacquire()çš„å¯¹æ¯”å…¬å¹³é”å’Œéå…¬å¹³é”ï¼Œåªæœ‰tryAcquire()å‡½æ•°çš„å®ç°ä¸åŒï¼›å³å®ƒä»¬å°è¯•è·å–é”çš„æœºåˆ¶ä¸åŒã€‚è¿™å°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„â€œå®ƒä»¬è·å–é”ç­–ç•¥çš„ä¸åŒæ‰€åœ¨ä¹‹å¤„â€ï¼åœ¨â€œJavaå¤šçº¿ç¨‹ç³»åˆ—--â€œJUCé”â€03ä¹‹ å…¬å¹³é”(ä¸€)â€ä¸­ï¼Œå·²ç»è¯¦ç»†ä»‹ç»äº†acquire()æ¶‰åŠåˆ°çš„å„ä¸ªå‡½æ•°ã€‚è¿™é‡Œä»…å¯¹å®ƒä»¬æœ‰å·®å¼‚çš„å‡½æ•°tryAcquire()è¿›è¡Œè¯´æ˜ã€‚    è¯´æ˜ï¼šæ ¹æ®ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†æå‡ºï¼ŒtryAcquire()çš„ä½œç”¨å°±æ˜¯å°è¯•å»è·å–é”ã€‚(01) å¦‚æœâ€œé”â€æ²¡æœ‰è¢«ä»»ä½•çº¿ç¨‹æ‹¥æœ‰ï¼Œåˆ™é€šè¿‡CASå‡½æ•°è®¾ç½®â€œé”â€çš„çŠ¶æ€ä¸ºacquiresï¼ŒåŒæ—¶ï¼Œè®¾ç½®â€œå½“å‰çº¿ç¨‹â€ä¸ºé”çš„æŒæœ‰è€…ï¼Œç„¶åè¿”å›trueã€‚(02) å¦‚æœâ€œé”â€çš„æŒæœ‰è€…å·²ç»æ˜¯å½“å‰çº¿ç¨‹ï¼Œåˆ™å°†æ›´æ–°é”çš„çŠ¶æ€å³å¯ã€‚(03) å¦‚æœä¸æœ¯è¯­ä¸Šé¢çš„ä¸¤ç§æƒ…å†µï¼Œåˆ™è®¤ä¸ºå°è¯•å¤±è´¥ã€‚â€œå…¬å¹³é”â€å’Œâ€œéå…¬å¹³é”â€å…³äºtryAcquire()çš„å¯¹æ¯”å…¬å¹³é”å’Œéå…¬å¹³é”ï¼Œå®ƒä»¬å°è¯•è·å–é”çš„æ–¹å¼ä¸åŒã€‚å…¬å¹³é”åœ¨å°è¯•è·å–é”æ—¶ï¼Œå³ä½¿â€œé”â€æ²¡æœ‰è¢«ä»»ä½•çº¿ç¨‹é”æŒæœ‰ï¼Œå®ƒä¹Ÿä¼šåˆ¤æ–­è‡ªå·±æ˜¯ä¸æ˜¯CLHç­‰å¾…é˜Ÿåˆ—çš„è¡¨å¤´ï¼›æ˜¯çš„è¯ï¼Œæ‰è·å–é”ã€‚è€Œéå…¬å¹³é”åœ¨å°è¯•è·å–é”æ—¶ï¼Œå¦‚æœâ€œé”â€æ²¡æœ‰è¢«ä»»ä½•çº¿ç¨‹æŒæœ‰ï¼Œåˆ™ä¸ç®¡å®ƒåœ¨CLHé˜Ÿåˆ—çš„ä½•å¤„ï¼Œå®ƒéƒ½ç›´æ¥è·å–é”ã€‚ é‡Šæ”¾éå…¬å¹³é”1éå…¬å¹³é”å’Œå…¬å¹³é”åœ¨é‡Šæ”¾é”çš„æ–¹æ³•å’Œç­–ç•¥ä¸Šæ˜¯ä¸€æ ·çš„ã€‚Conditionæ¡ä»¶Conditionçš„ä½œç”¨æ˜¯å¯¹é”è¿›è¡Œæ›´ç²¾ç¡®çš„æ§åˆ¶ã€‚Conditionä¸­çš„await()æ–¹æ³•ç›¸å½“äºObjectçš„wait()æ–¹æ³•ï¼ŒConditionä¸­çš„signal()æ–¹æ³•ç›¸å½“äºObjectçš„notify()æ–¹æ³•ï¼ŒConditionä¸­çš„signalAll()ç›¸å½“äºObjectçš„notifyAll()æ–¹æ³•ã€‚ä¸åŒçš„æ˜¯ï¼ŒObjectä¸­çš„wait(),notify(),notifyAll()æ–¹æ³•æ˜¯å’Œâ€åŒæ­¥é”â€(synchronizedå…³é”®å­—)æ†ç»‘ä½¿ç”¨çš„ï¼›è€ŒConditionæ˜¯éœ€è¦ä¸â€äº’æ–¥é”â€/â€œå…±äº«é”â€æ†ç»‘ä½¿ç”¨çš„ã€‚123456789101112131415// Conditionå‡½æ•°åˆ—è¡¨// é€ æˆå½“å‰çº¿ç¨‹åœ¨æ¥åˆ°ä¿¡å·æˆ–è¢«ä¸­æ–­ä¹‹å‰ä¸€ç›´å¤„äºç­‰å¾…çŠ¶æ€ã€‚void await()// é€ æˆå½“å‰çº¿ç¨‹åœ¨æ¥åˆ°ä¿¡å·ã€è¢«ä¸­æ–­æˆ–åˆ°è¾¾æŒ‡å®šç­‰å¾…æ—¶é—´ä¹‹å‰ä¸€ç›´å¤„äºç­‰å¾…çŠ¶æ€ã€‚boolean await(long time, TimeUnit unit)// é€ æˆå½“å‰çº¿ç¨‹åœ¨æ¥åˆ°ä¿¡å·ã€è¢«ä¸­æ–­æˆ–åˆ°è¾¾æŒ‡å®šç­‰å¾…æ—¶é—´ä¹‹å‰ä¸€ç›´å¤„äºç­‰å¾…çŠ¶æ€ã€‚long awaitNanos(long nanosTimeout)// é€ æˆå½“å‰çº¿ç¨‹åœ¨æ¥åˆ°ä¿¡å·ä¹‹å‰ä¸€ç›´å¤„äºç­‰å¾…çŠ¶æ€ã€‚void awaitUninterruptibly()// é€ æˆå½“å‰çº¿ç¨‹åœ¨æ¥åˆ°ä¿¡å·ã€è¢«ä¸­æ–­æˆ–åˆ°è¾¾æŒ‡å®šæœ€åæœŸé™ä¹‹å‰ä¸€ç›´å¤„äºç­‰å¾…çŠ¶æ€ã€‚boolean awaitUntil(Date deadline)// å”¤é†’ä¸€ä¸ªç­‰å¾…çº¿ç¨‹ã€‚void signal()// å”¤é†’æ‰€æœ‰ç­‰å¾…çº¿ç¨‹ã€‚void signalAll()Conditionç¤ºä¾‹1234567891011121314151617181920212223242526272829// ç¤ºä¾‹1æ˜¯é€šè¿‡Objectçš„wait(), notify()æ¥æ¼”ç¤ºçº¿ç¨‹çš„ä¼‘çœ /å”¤é†’åŠŸèƒ½ã€‚public class WaitTest1 {    public static void main(String[] args) {        ThreadA ta = new ThreadA(&quot;ta&quot;);        synchronized(ta) { // é€šè¿‡synchronized(ta)è·å–â€œå¯¹è±¡taçš„åŒæ­¥é”â€            try {       System.out.println(Thread.currentThread().getName()+&quot; start ta&quot;);                ta.start();                System.out.println(Thread.currentThread().getName()+&quot; block&quot;);                ta.wait();    // ç­‰å¾…                System.out.println(Thread.currentThread().getName()+&quot; continue&quot;);            } catch (InterruptedException e) {                e.printStackTrace();            }        }    }    static class ThreadA extends Thread{        public ThreadA(String name) {            super(name);        }        public void run() {            synchronized (this) { // é€šè¿‡synchronized(this)è·å–â€œå½“å‰å¯¹è±¡çš„åŒæ­¥é”â€                System.out.println(Thread.currentThread().getName()+&quot; wakup others&quot;);                notify();    // å”¤é†’â€œå½“å‰å¯¹è±¡ä¸Šçš„ç­‰å¾…çº¿ç¨‹â€            }        }    }}123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354// ç¤ºä¾‹2æ˜¯é€šè¿‡Conditionçš„await(), signal()æ¥æ¼”ç¤ºçº¿ç¨‹çš„ä¼‘çœ /å”¤é†’åŠŸèƒ½ã€‚import java.util.concurrent.locks.Lock;import java.util.concurrent.locks.Condition;import java.util.concurrent.locks.ReentrantLock;public class ConditionTest1 {    private static Lock lock = new ReentrantLock();    private static Condition condition = lock.newCondition();    public static void main(String[] args) {        ThreadA ta = new ThreadA(&quot;ta&quot;);        lock.lock(); // è·å–é”        try {            System.out.println(Thread.currentThread().getName()+&quot; start ta&quot;);            ta.start();            System.out.println(Thread.currentThread().getName()+&quot; block&quot;);            condition.await();    // ç­‰å¾…            System.out.println(Thread.currentThread().getName()+&quot; continue&quot;);        } catch (InterruptedException e) {            e.printStackTrace();        } finally {            lock.unlock();    // é‡Šæ”¾é”        }    }    static class ThreadA extends Thread{        public ThreadA(String name) {            super(name);        }        public void run() {            lock.lock();    // è·å–é”            try {                System.out.println(Thread.currentThread().getName()+&quot; wakup others&quot;);                condition.signal();    // å”¤é†’â€œconditionæ‰€åœ¨é”ä¸Šçš„å…¶å®ƒçº¿ç¨‹â€            } finally {                lock.unlock();    // é‡Šæ”¾é”            }        }    }}è¿è¡Œç»“æœï¼šmain start tamain blockta wakup othersmain continueé€šè¿‡â€œç¤ºä¾‹1â€å’Œâ€œç¤ºä¾‹2â€ï¼Œæˆ‘ä»¬çŸ¥é“Conditionå’ŒObjectçš„æ–¹æ³•æœ‰ä¸€ä¸‹å¯¹åº”å…³ç³»ï¼š              Object      Condition  ä¼‘çœ           wait        awaitå”¤é†’ä¸ªçº¿ç¨‹     notify      signalå”¤é†’æ‰€æœ‰çº¿ç¨‹   notifyAll   signalAllConditioné™¤äº†æ”¯æŒä¸Šé¢çš„åŠŸèƒ½ä¹‹å¤–ï¼Œå®ƒæ›´å¼ºå¤§çš„åœ°æ–¹åœ¨äºï¼šèƒ½å¤Ÿæ›´åŠ ç²¾ç»†çš„æ§åˆ¶å¤šçº¿ç¨‹çš„ä¼‘çœ ä¸å”¤é†’ã€‚å¯¹äºåŒä¸€ä¸ªé”ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºå¤šä¸ªConditionï¼Œåœ¨ä¸åŒçš„æƒ…å†µä¸‹ä½¿ç”¨ä¸åŒçš„Conditionã€‚ä¾‹å¦‚ï¼Œå‡å¦‚å¤šçº¿ç¨‹è¯»/å†™åŒä¸€ä¸ªç¼“å†²åŒºï¼šå½“å‘ç¼“å†²åŒºä¸­å†™å…¥æ•°æ®ä¹‹åï¼Œå”¤é†’&quot;è¯»çº¿ç¨‹&quot;ï¼›å½“ä»ç¼“å†²åŒºè¯»å‡ºæ•°æ®ä¹‹åï¼Œå”¤é†’&quot;å†™çº¿ç¨‹&quot;ï¼›å¹¶ä¸”å½“ç¼“å†²åŒºæ»¡çš„æ—¶å€™ï¼Œ&quot;å†™çº¿ç¨‹&quot;éœ€è¦ç­‰å¾…ï¼›å½“ç¼“å†²åŒºä¸ºç©ºæ—¶ï¼Œ&quot;è¯»çº¿ç¨‹&quot;éœ€è¦ç­‰å¾…ã€‚å¦‚æœé‡‡ç”¨Objectç±»ä¸­çš„wait(), notify(), notifyAll()å®ç°è¯¥ç¼“å†²åŒºï¼Œå½“å‘ç¼“å†²åŒºå†™å…¥æ•°æ®ä¹‹åéœ€è¦å”¤é†’&quot;è¯»çº¿ç¨‹&quot;æ—¶ï¼Œä¸å¯èƒ½é€šè¿‡notify()æˆ–notifyAll()æ˜ç¡®çš„æŒ‡å®šå”¤é†’&quot;è¯»çº¿ç¨‹&quot;ï¼Œè€Œåªèƒ½é€šè¿‡notifyAllå”¤é†’æ‰€æœ‰çº¿ç¨‹(ä½†æ˜¯notifyAllæ— æ³•åŒºåˆ†å”¤é†’çš„çº¿ç¨‹æ˜¯è¯»çº¿ç¨‹ï¼Œè¿˜æ˜¯å†™çº¿ç¨‹)ã€‚  ä½†æ˜¯ï¼Œé€šè¿‡Conditionï¼Œå°±èƒ½æ˜ç¡®çš„æŒ‡å®šå”¤é†’è¯»çº¿ç¨‹ã€‚çœ‹çœ‹ä¸‹é¢çš„ç¤ºä¾‹3ï¼Œå¯èƒ½å¯¹è¿™ä¸ªæ¦‚å¿µæœ‰æ›´æ·±åˆ»çš„ç†è§£ã€‚123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130// ç¤ºä¾‹3æ˜¯é€šè¿‡Conditionçš„é«˜çº§åŠŸèƒ½ã€‚import java.util.concurrent.locks.Lock;import java.util.concurrent.locks.Condition;import java.util.concurrent.locks.ReentrantLock;class BoundedBuffer {    final Lock lock = new ReentrantLock();    final Condition notFull  = lock.newCondition();     final Condition notEmpty = lock.newCondition();     final Object[] items = new Object[5];    int putptr, takeptr, count;    public void put(Object x) throws InterruptedException {        lock.lock();    //è·å–é”        try {            // å¦‚æœâ€œç¼“å†²å·²æ»¡â€ï¼Œåˆ™ç­‰å¾…ï¼›ç›´åˆ°â€œç¼“å†²â€ä¸æ˜¯æ»¡çš„ï¼Œæ‰å°†xæ·»åŠ åˆ°ç¼“å†²ä¸­ã€‚            while (count == items.length)                notFull.await();            // å°†xæ·»åŠ åˆ°ç¼“å†²ä¸­            items[putptr] = x;             // å°†â€œputç»Ÿè®¡æ•°putptr+1â€ï¼›å¦‚æœâ€œç¼“å†²å·²æ»¡â€ï¼Œåˆ™è®¾putpträ¸º0ã€‚            if (++putptr == items.length) putptr = 0;            // å°†â€œç¼“å†²â€æ•°é‡+1            ++count;            // å”¤é†’takeçº¿ç¨‹ï¼Œå› ä¸ºtakeçº¿ç¨‹é€šè¿‡notEmpty.await()ç­‰å¾…            notEmpty.signal();            // æ‰“å°å†™å…¥çš„æ•°æ®            System.out.println(Thread.currentThread().getName() + &quot; put  &quot;+ (Integer)x);        } finally {            lock.unlock();    // é‡Šæ”¾é”        }    }    public Object take() throws InterruptedException {        lock.lock();    //è·å–é”        try {            // å¦‚æœâ€œç¼“å†²ä¸ºç©ºâ€ï¼Œåˆ™ç­‰å¾…ï¼›ç›´åˆ°â€œç¼“å†²â€ä¸ä¸ºç©ºï¼Œæ‰å°†xä»ç¼“å†²ä¸­å–å‡ºã€‚            while (count == 0)                 notEmpty.await();            // å°†xä»ç¼“å†²ä¸­å–å‡º            Object x = items[takeptr];             // å°†â€œtakeç»Ÿè®¡æ•°takeptr+1â€ï¼›å¦‚æœâ€œç¼“å†²ä¸ºç©ºâ€ï¼Œåˆ™è®¾takepträ¸º0ã€‚            if (++takeptr == items.length) takeptr = 0;            // å°†â€œç¼“å†²â€æ•°é‡-1            --count;            // å”¤é†’putçº¿ç¨‹ï¼Œå› ä¸ºputçº¿ç¨‹é€šè¿‡notFull.await()ç­‰å¾…            notFull.signal();            // æ‰“å°å–å‡ºçš„æ•°æ®            System.out.println(Thread.currentThread().getName() + &quot; take &quot;+ (Integer)x);            return x;        } finally {            lock.unlock();    // é‡Šæ”¾é”        }    } }public class ConditionTest2 {    private static BoundedBuffer bb = new BoundedBuffer();    public static void main(String[] args) {        // å¯åŠ¨10ä¸ªâ€œå†™çº¿ç¨‹â€ï¼Œå‘BoundedBufferä¸­ä¸æ–­çš„å†™æ•°æ®(å†™å…¥0-9)ï¼›        // å¯åŠ¨10ä¸ªâ€œè¯»çº¿ç¨‹â€ï¼Œä»BoundedBufferä¸­ä¸æ–­çš„è¯»æ•°æ®ã€‚        for (int i=0; i&lt;10; i++) {            new PutThread(&quot;p&quot;+i, i).start();            new TakeThread(&quot;t&quot;+i).start();        }    }    static class PutThread extends Thread {        private int num;        public PutThread(String name, int num) {            super(name);            this.num = num;        }        public void run() {            try {                Thread.sleep(1);    // çº¿ç¨‹ä¼‘çœ 1ms                bb.put(num);        // å‘BoundedBufferä¸­å†™å…¥æ•°æ®            } catch (InterruptedException e) {            }        }    }    static class TakeThread extends Thread {        public TakeThread(String name) {            super(name);        }        public void run() {            try {                Thread.sleep(10);                    // çº¿ç¨‹ä¼‘çœ 1ms                Integer num = (Integer)bb.take();    // ä»BoundedBufferä¸­å–å‡ºæ•°æ®            } catch (InterruptedException e) {            }        }    }}æŸä¸€æ¬¡ç»“æœ:p1 put  1p4 put  4p5 put  5p0 put  0p2 put  2t0 take 1p3 put  3t1 take 4p6 put  6t2 take 5p7 put  7t3 take 0p8 put  8t4 take 2p9 put  9t5 take 3t6 take 6t7 take 7t8 take 8t9 take 9    ç»“æœè¯´æ˜ï¼š(01) BoundedBuffer æ˜¯å®¹é‡ä¸º5çš„ç¼“å†²ï¼Œç¼“å†²ä¸­å­˜å‚¨çš„æ˜¯Objectå¯¹è±¡ï¼Œæ”¯æŒå¤šçº¿ç¨‹çš„è¯»/å†™ç¼“å†²ã€‚å¤šä¸ªçº¿ç¨‹æ“ä½œâ€œä¸€ä¸ªBoundedBufferå¯¹è±¡â€æ—¶ï¼Œå®ƒä»¬é€šè¿‡äº’æ–¥é”lockå¯¹ç¼“å†²åŒºitemsè¿›è¡Œäº’æ–¥è®¿é—®ï¼›è€Œä¸”åŒä¸€ä¸ªBoundedBufferå¯¹è±¡ä¸‹çš„å…¨éƒ¨çº¿ç¨‹å…±ç”¨â€œnotFullâ€å’Œâ€œnotEmptyâ€è¿™ä¸¤ä¸ªConditionã€‚    notFullç”¨äºæ§åˆ¶å†™ç¼“å†²ï¼ŒnotEmptyç”¨äºæ§åˆ¶è¯»ç¼“å†²ã€‚å½“ç¼“å†²å·²æ»¡çš„æ—¶å€™ï¼Œè°ƒç”¨putçš„çº¿ç¨‹ä¼šæ‰§è¡ŒnotFull.await()è¿›è¡Œç­‰å¾…ï¼›å½“ç¼“å†²åŒºä¸æ˜¯æ»¡çš„çŠ¶æ€æ—¶ï¼Œå°±å°†å¯¹è±¡æ·»åŠ åˆ°ç¼“å†²åŒºå¹¶å°†ç¼“å†²åŒºçš„å®¹é‡count+1ï¼Œæœ€åï¼Œè°ƒç”¨notEmpty.signal()ç¼“å†²notEmptyä¸Šçš„ç­‰å¾…çº¿ç¨‹(è°ƒç”¨notEmpty.awaitçš„çº¿ç¨‹)ã€‚ ç®€è¨€ä¹‹ï¼ŒnotFullæ§åˆ¶â€œç¼“å†²åŒºçš„å†™å…¥â€ï¼Œå½“å¾€ç¼“å†²åŒºå†™å…¥æ•°æ®ä¹‹åä¼šå”¤é†’notEmptyä¸Šçš„ç­‰å¾…çº¿ç¨‹ã€‚åŒç†ï¼ŒnotEmptyæ§åˆ¶â€œç¼“å†²åŒºçš„è¯»å–â€ï¼Œå½“è¯»å–äº†ç¼“å†²åŒºæ•°æ®ä¹‹åä¼šå”¤é†’notFullä¸Šçš„ç­‰å¾…çº¿ç¨‹ã€‚(02) åœ¨ConditionTest2çš„mainå‡½æ•°ä¸­ï¼Œå¯åŠ¨10ä¸ªâ€œå†™çº¿ç¨‹â€ï¼Œå‘BoundedBufferä¸­ä¸æ–­çš„å†™æ•°æ®(å†™å…¥0-9)ï¼›åŒæ—¶ï¼Œä¹Ÿå¯åŠ¨10ä¸ªâ€œè¯»çº¿ç¨‹â€ï¼Œä»BoundedBufferä¸­ä¸æ–­çš„è¯»æ•°æ®ã€‚(03) ç®€å•åˆ†æä¸€ä¸‹è¿è¡Œç»“æœã€‚1, p1çº¿ç¨‹å‘ç¼“å†²ä¸­å†™å…¥1ã€‚    æ­¤æ—¶ï¼Œç¼“å†²åŒºæ•°æ®:   | 1 |   |   |   |   |     2, p4çº¿ç¨‹å‘ç¼“å†²ä¸­å†™å…¥4ã€‚    æ­¤æ—¶ï¼Œç¼“å†²åŒºæ•°æ®:   | 1 | 4 |   |   |   |     3, p5çº¿ç¨‹å‘ç¼“å†²ä¸­å†™å…¥5ã€‚    æ­¤æ—¶ï¼Œç¼“å†²åŒºæ•°æ®:   | 1 | 4 | 5 |   |   |     4, p0çº¿ç¨‹å‘ç¼“å†²ä¸­å†™å…¥0ã€‚    æ­¤æ—¶ï¼Œç¼“å†²åŒºæ•°æ®:   | 1 | 4 | 5 | 0 |   |     5, p2çº¿ç¨‹å‘ç¼“å†²ä¸­å†™å…¥2ã€‚    æ­¤æ—¶ï¼Œç¼“å†²åŒºæ•°æ®:   | 1 | 4 | 5 | 0 | 2 |     æ­¤æ—¶ï¼Œç¼“å†²åŒºå®¹é‡ä¸º5ï¼›ç¼“å†²åŒºå·²æ»¡ï¼å¦‚æœæ­¤æ—¶ï¼Œè¿˜æœ‰â€œå†™çº¿ç¨‹â€æƒ³å¾€ç¼“å†²ä¸­å†™å…¥æ•°æ®ï¼Œä¼šè°ƒç”¨putä¸­çš„notFull.await()ç­‰å¾…ï¼Œç›´æ¥ç¼“å†²åŒºéæ»¡çŠ¶æ€ï¼Œæ‰èƒ½ç»§ç»­è¿è¡Œã€‚     6, t0çº¿ç¨‹ä»ç¼“å†²ä¸­å–å‡ºæ•°æ®1ã€‚æ­¤æ—¶ï¼Œç¼“å†²åŒºæ•°æ®:   |   | 4 | 5 | 0 | 2 |     7, p3çº¿ç¨‹å‘ç¼“å†²ä¸­å†™å…¥3ã€‚    æ­¤æ—¶ï¼Œç¼“å†²åŒºæ•°æ®:   | 3 | 4 | 5 | 0 | 2 |     8, t1çº¿ç¨‹ä»ç¼“å†²ä¸­å–å‡ºæ•°æ®4ã€‚æ­¤æ—¶ï¼Œç¼“å†²åŒºæ•°æ®:   | 3 |   | 5 | 0 | 2 |     9, p6çº¿ç¨‹å‘ç¼“å†²ä¸­å†™å…¥6ã€‚    æ­¤æ—¶ï¼Œç¼“å†²åŒºæ•°æ®:   | 3 | 6 | 5 | 0 | 2 |     ...LockSupport123LockSupportæ˜¯ç”¨æ¥åˆ›å»ºé”å’Œå…¶ä»–åŒæ­¥ç±»çš„åŸºæœ¬çº¿ç¨‹é˜»å¡åŸè¯­ã€‚ LockSupportä¸­çš„park() å’Œ unpark() çš„ä½œç”¨åˆ†åˆ«æ˜¯é˜»å¡çº¿ç¨‹å’Œè§£é™¤é˜»å¡çº¿ç¨‹ï¼Œè€Œä¸”park()å’Œunpark()ä¸ä¼šé‡åˆ°â€œThread.suspend å’Œ Thread.resumeæ‰€å¯èƒ½å¼•å‘çš„æ­»é”â€é—®é¢˜ã€‚å› ä¸ºpark() å’Œ unpark()æœ‰è®¸å¯çš„å­˜åœ¨ï¼›è°ƒç”¨ park() çš„çº¿ç¨‹å’Œå¦ä¸€ä¸ªè¯•å›¾å°†å…¶ unpark() çš„çº¿ç¨‹ä¹‹é—´çš„ç«äº‰å°†ä¿æŒæ´»æ€§ã€‚1234567891011121314151617// LockSupportå‡½æ•°åˆ—è¡¨// è¿”å›æä¾›ç»™æœ€è¿‘ä¸€æ¬¡å°šæœªè§£é™¤é˜»å¡çš„ park æ–¹æ³•è°ƒç”¨çš„ blocker å¯¹è±¡ï¼Œå¦‚æœè¯¥è°ƒç”¨ä¸å—é˜»å¡ï¼Œåˆ™è¿”å› nullã€‚static Object getBlocker(Thread t)// ä¸ºäº†çº¿ç¨‹è°ƒåº¦ï¼Œç¦ç”¨å½“å‰çº¿ç¨‹ï¼Œé™¤éè®¸å¯å¯ç”¨ã€‚static void park()// ä¸ºäº†çº¿ç¨‹è°ƒåº¦ï¼Œåœ¨è®¸å¯å¯ç”¨ä¹‹å‰ç¦ç”¨å½“å‰çº¿ç¨‹ã€‚static void park(Object blocker)// ä¸ºäº†çº¿ç¨‹è°ƒåº¦ç¦ç”¨å½“å‰çº¿ç¨‹ï¼Œæœ€å¤šç­‰å¾…æŒ‡å®šçš„ç­‰å¾…æ—¶é—´ï¼Œé™¤éè®¸å¯å¯ç”¨ã€‚static void parkNanos(long nanos)// ä¸ºäº†çº¿ç¨‹è°ƒåº¦ï¼Œåœ¨è®¸å¯å¯ç”¨å‰ç¦ç”¨å½“å‰çº¿ç¨‹ï¼Œå¹¶æœ€å¤šç­‰å¾…æŒ‡å®šçš„ç­‰å¾…æ—¶é—´ã€‚static void parkNanos(Object blocker, long nanos)// ä¸ºäº†çº¿ç¨‹è°ƒåº¦ï¼Œåœ¨æŒ‡å®šçš„æ—¶é™å‰ç¦ç”¨å½“å‰çº¿ç¨‹ï¼Œé™¤éè®¸å¯å¯ç”¨ã€‚static void parkUntil(long deadline)// ä¸ºäº†çº¿ç¨‹è°ƒåº¦ï¼Œåœ¨æŒ‡å®šçš„æ—¶é™å‰ç¦ç”¨å½“å‰çº¿ç¨‹ï¼Œé™¤éè®¸å¯å¯ç”¨ã€‚static void parkUntil(Object blocker, long deadline)// å¦‚æœç»™å®šçº¿ç¨‹çš„è®¸å¯å°šä¸å¯ç”¨ï¼Œåˆ™ä½¿å…¶å¯ç”¨ã€‚static void unpark(Thread thread)LockSupportç¤ºä¾‹12345678910111213141516171819202122232425262728public class WaitTest1 {    public static void main(String[] args) {        ThreadA ta = new ThreadA(&quot;ta&quot;);        synchronized(ta) { // é€šè¿‡synchronized(ta)è·å–â€œå¯¹è±¡taçš„åŒæ­¥é”â€            try {                System.out.println(Thread.currentThread().getName()+&quot; start ta&quot;);                ta.start();                System.out.println(Thread.currentThread().getName()+&quot; block&quot;);                // ä¸»çº¿ç¨‹ç­‰å¾…                ta.wait();                System.out.println(Thread.currentThread().getName()+&quot; continue&quot;);            } catch (InterruptedException e) {                e.printStackTrace();            }        }    }    static class ThreadA extends Thread{        public ThreadA(String name) {            super(name);        }        public void run() {            synchronized (this) { // é€šè¿‡synchronized(this)è·å–â€œå½“å‰å¯¹è±¡çš„åŒæ­¥é”â€                System.out.println(Thread.currentThread().getName()+&quot; wakup others&quot;);                notify();    // å”¤é†’â€œå½“å‰å¯¹è±¡ä¸Šçš„ç­‰å¾…çº¿ç¨‹â€            }        }    }}123456789101112131415161718192021222324252627282930313233import java.util.concurrent.locks.LockSupport;public class LockSupportTest1 {    private static Thread mainThread;    public static void main(String[] args) {        ThreadA ta = new ThreadA(&quot;ta&quot;);        // è·å–ä¸»çº¿ç¨‹        mainThread = Thread.currentThread();        System.out.println(Thread.currentThread().getName()+&quot; start ta&quot;);        ta.start();        System.out.println(Thread.currentThread().getName()+&quot; block&quot;);        // ä¸»çº¿ç¨‹é˜»å¡        LockSupport.park(mainThread);        System.out.println(Thread.currentThread().getName()+&quot; continue&quot;);    }    static class ThreadA extends Thread{        public ThreadA(String name) {            super(name);        }        public void run() {            System.out.println(Thread.currentThread().getName()+&quot; wakup others&quot;);            // å”¤é†’â€œä¸»çº¿ç¨‹â€            LockSupport.unpark(mainThread);        }    }}è¿è¡Œç»“æœï¼šmain start tamain blockta wakup othersmain continueè¯´æ˜ï¼šparkå’Œwaitçš„åŒºåˆ«ã€‚waitè®©çº¿ç¨‹é˜»å¡å‰ï¼Œå¿…é¡»é€šè¿‡synchronizedè·å–åŒæ­¥é”ã€‚å…±äº«é”å’ŒReentrantReadWriteLock12345ReadWriteLockï¼Œé¡¾åæ€ä¹‰ï¼Œæ˜¯è¯»å†™é”ã€‚å®ƒç»´æŠ¤äº†ä¸€å¯¹ç›¸å…³çš„é” â€” â€” â€œè¯»å–é”â€å’Œâ€œå†™å…¥é”â€ï¼Œä¸€ä¸ªç”¨äºè¯»å–æ“ä½œï¼Œå¦ä¸€ä¸ªç”¨äºå†™å…¥æ“ä½œã€‚â€œè¯»å–é”â€ç”¨äºåªè¯»æ“ä½œï¼Œå®ƒæ˜¯â€œå…±äº«é”â€ï¼Œèƒ½åŒæ—¶è¢«å¤šä¸ªçº¿ç¨‹è·å–ã€‚â€œå†™å…¥é”â€ç”¨äºå†™å…¥æ“ä½œï¼Œå®ƒæ˜¯â€œç‹¬å é”â€ï¼Œå†™å…¥é”åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹é”è·å–ã€‚æ³¨æ„ï¼šä¸èƒ½åŒæ—¶å­˜åœ¨è¯»å–é”å’Œå†™å…¥é”ï¼ReadWriteLockæ˜¯ä¸€ä¸ªæ¥å£ã€‚ReentrantReadWriteLockæ˜¯å®ƒçš„å®ç°ç±»ï¼ŒReentrantReadWriteLockåŒ…æ‹¬å­ç±»ReadLockå’ŒWriteLockã€‚12345// ReadWriteLockå‡½æ•°åˆ—è¡¨// è¿”å›ç”¨äºè¯»å–æ“ä½œçš„é”ã€‚Lock readLock()// è¿”å›ç”¨äºå†™å…¥æ“ä½œçš„é”ã€‚Lock writeLock()1234567891011121314151617181920212223242526272829303132333435363738394041// ReentrantReadWriteLockå‡½æ•°åˆ—è¡¨// åˆ›å»ºä¸€ä¸ªæ–°çš„ ReentrantReadWriteLockï¼Œé»˜è®¤æ˜¯é‡‡ç”¨â€œéå…¬å¹³ç­–ç•¥â€ã€‚ReentrantReadWriteLock()// åˆ›å»ºä¸€ä¸ªæ–°çš„ ReentrantReadWriteLockï¼Œfairæ˜¯â€œå…¬å¹³ç­–ç•¥â€ã€‚fairä¸ºtrueï¼Œæ„å‘³ç€å…¬å¹³ç­–ç•¥ï¼›å¦åˆ™ï¼Œæ„å‘³ç€éå…¬å¹³ç­–ç•¥ã€‚ReentrantReadWriteLock(boolean fair)// è¿”å›å½“å‰æ‹¥æœ‰å†™å…¥é”çš„çº¿ç¨‹ï¼Œå¦‚æœæ²¡æœ‰è¿™æ ·çš„çº¿ç¨‹ï¼Œåˆ™è¿”å› nullã€‚protected Thread getOwner()// è¿”å›ä¸€ä¸ª collectionï¼Œå®ƒåŒ…å«å¯èƒ½æ­£åœ¨ç­‰å¾…è·å–è¯»å–é”çš„çº¿ç¨‹ã€‚protected Collection&lt;Thread&gt; getQueuedReaderThreads()// è¿”å›ä¸€ä¸ª collectionï¼Œå®ƒåŒ…å«å¯èƒ½æ­£åœ¨ç­‰å¾…è·å–è¯»å–æˆ–å†™å…¥é”çš„çº¿ç¨‹ã€‚protected Collection&lt;Thread&gt; getQueuedThreads()// è¿”å›ä¸€ä¸ª collectionï¼Œå®ƒåŒ…å«å¯èƒ½æ­£åœ¨ç­‰å¾…è·å–å†™å…¥é”çš„çº¿ç¨‹ã€‚protected Collection&lt;Thread&gt; getQueuedWriterThreads()// è¿”å›ç­‰å¾…è·å–è¯»å–æˆ–å†™å…¥é”çš„çº¿ç¨‹ä¼°è®¡æ•°ç›®ã€‚int getQueueLength()// æŸ¥è¯¢å½“å‰çº¿ç¨‹åœ¨æ­¤é”ä¸Šä¿æŒçš„é‡å…¥è¯»å–é”æ•°é‡ã€‚int getReadHoldCount()// æŸ¥è¯¢ä¸ºæ­¤é”ä¿æŒçš„è¯»å–é”æ•°é‡ã€‚int getReadLockCount()// è¿”å›ä¸€ä¸ª collectionï¼Œå®ƒåŒ…å«å¯èƒ½æ­£åœ¨ç­‰å¾…ä¸å†™å…¥é”ç›¸å…³çš„ç»™å®šæ¡ä»¶çš„é‚£äº›çº¿ç¨‹ã€‚protected Collection&lt;Thread&gt; getWaitingThreads(Condition condition)// è¿”å›æ­£ç­‰å¾…ä¸å†™å…¥é”ç›¸å…³çš„ç»™å®šæ¡ä»¶çš„çº¿ç¨‹ä¼°è®¡æ•°ç›®ã€‚int getWaitQueueLength(Condition condition)// æŸ¥è¯¢å½“å‰çº¿ç¨‹åœ¨æ­¤é”ä¸Šä¿æŒçš„é‡å…¥å†™å…¥é”æ•°é‡ã€‚int getWriteHoldCount()// æŸ¥è¯¢æ˜¯å¦ç»™å®šçº¿ç¨‹æ­£åœ¨ç­‰å¾…è·å–è¯»å–æˆ–å†™å…¥é”ã€‚boolean hasQueuedThread(Thread thread)// æŸ¥è¯¢æ˜¯å¦æ‰€æœ‰çš„çº¿ç¨‹æ­£åœ¨ç­‰å¾…è·å–è¯»å–æˆ–å†™å…¥é”ã€‚boolean hasQueuedThreads()// æŸ¥è¯¢æ˜¯å¦æœ‰äº›çº¿ç¨‹æ­£åœ¨ç­‰å¾…ä¸å†™å…¥é”æœ‰å…³çš„ç»™å®šæ¡ä»¶ã€‚boolean hasWaiters(Condition condition)// å¦‚æœæ­¤é”å°†å…¬å¹³æ€§è®¾ç½®ä¸º tureï¼Œåˆ™è¿”å› trueã€‚boolean isFair()// æŸ¥è¯¢æ˜¯å¦æŸä¸ªçº¿ç¨‹ä¿æŒäº†å†™å…¥é”ã€‚boolean isWriteLocked()// æŸ¥è¯¢å½“å‰çº¿ç¨‹æ˜¯å¦ä¿æŒäº†å†™å…¥é”ã€‚boolean isWriteLockedByCurrentThread()// è¿”å›ç”¨äºè¯»å–æ“ä½œçš„é”ã€‚ReentrantReadWriteLock.ReadLock readLock()// è¿”å›ç”¨äºå†™å…¥æ“ä½œçš„é”ã€‚ReentrantReadWriteLock.WriteLock writeLock()è·å–å…±äº«é”12345678910111213141516171819202122è·å–å…±äº«é”çš„æ€æƒ³(å³lockå‡½æ•°çš„æ­¥éª¤)ï¼Œæ˜¯å…ˆé€šè¿‡tryAcquireShared()å°è¯•è·å–å…±äº«é”ã€‚å°è¯•æˆåŠŸçš„è¯ï¼Œåˆ™ç›´æ¥è¿”å›ï¼›å°è¯•å¤±è´¥çš„è¯ï¼Œåˆ™é€šè¿‡doAcquireShared()ä¸æ–­çš„å¾ªç¯å¹¶å°è¯•è·å–é”ï¼Œè‹¥æœ‰éœ€è¦ï¼Œåˆ™é˜»å¡ç­‰å¾…ã€‚doAcquireShared()åœ¨å¾ªç¯ä¸­æ¯æ¬¡å°è¯•è·å–é”æ—¶ï¼Œéƒ½æ˜¯é€šè¿‡tryAcquireShared()æ¥è¿›è¡Œå°è¯•çš„ã€‚1. lock()2. acquireShared()è¯´æ˜ï¼šacquireShared()é¦–å…ˆä¼šé€šè¿‡tryAcquireShared()æ¥å°è¯•è·å–é”ã€‚å°è¯•æˆåŠŸçš„è¯ï¼Œåˆ™ä¸å†åšä»»ä½•åŠ¨ä½œ(å› ä¸ºå·²ç»æˆåŠŸè·å–åˆ°é”äº†)ã€‚å°è¯•å¤±è´¥çš„è¯ï¼Œåˆ™é€šè¿‡doAcquireShared()æ¥è·å–é”ã€‚doAcquireShared()ä¼šè·å–åˆ°é”äº†æ‰è¿”å›ã€‚3. tryAcquireShared()è¯´æ˜ï¼štryAcquireShared()çš„ä½œç”¨æ˜¯å°è¯•è·å–â€œå…±äº«é”â€ã€‚å¦‚æœåœ¨å°è¯•è·å–é”æ—¶ï¼Œâ€œä¸éœ€è¦é˜»å¡ç­‰å¾…â€å¹¶ä¸”â€œè¯»å–é”çš„å…±äº«è®¡æ•°å°äºMAX_COUNTâ€ï¼Œåˆ™ç›´æ¥é€šè¿‡CASå‡½æ•°æ›´æ–°â€œè¯»å–é”çš„å…±äº«è®¡æ•°â€ï¼Œä»¥åŠå°†â€œå½“å‰çº¿ç¨‹è·å–è¯»å–é”çš„æ¬¡æ•°+1â€ã€‚å¦åˆ™ï¼Œé€šè¿‡fullTryAcquireShared()è·å–è¯»å–é”ã€‚4. fullTryAcquireShared()è¯´æ˜ï¼šfullTryAcquireShared()ä¼šæ ¹æ®â€œæ˜¯å¦éœ€è¦é˜»å¡ç­‰å¾…â€ï¼Œâ€œè¯»å–é”çš„å…±äº«è®¡æ•°æ˜¯å¦è¶…è¿‡é™åˆ¶â€ç­‰ç­‰è¿›è¡Œå¤„ç†ã€‚å¦‚æœä¸éœ€è¦é˜»å¡ç­‰å¾…ï¼Œå¹¶ä¸”é”çš„å…±äº«è®¡æ•°æ²¡æœ‰è¶…è¿‡é™åˆ¶ï¼Œåˆ™é€šè¿‡CASå°è¯•è·å–é”ï¼Œå¹¶è¿”å›1ã€‚5. doAcquireShared()è¯´æ˜ï¼šdoAcquireShared()çš„ä½œç”¨æ˜¯è·å–å…±äº«é”ã€‚å®ƒä¼šé¦–å…ˆåˆ›å»ºçº¿ç¨‹å¯¹åº”çš„CLHé˜Ÿåˆ—çš„èŠ‚ç‚¹ï¼Œç„¶åå°†è¯¥èŠ‚ç‚¹æ·»åŠ åˆ°CLHé˜Ÿåˆ—ä¸­ã€‚CLHé˜Ÿåˆ—æ˜¯ç®¡ç†è·å–é”çš„ç­‰å¾…çº¿ç¨‹çš„é˜Ÿåˆ—ã€‚å¦‚æœâ€œå½“å‰çº¿ç¨‹â€æ˜¯CLHé˜Ÿåˆ—çš„è¡¨å¤´ï¼Œåˆ™å°è¯•è·å–å…±äº«é”ï¼›å¦åˆ™ï¼Œåˆ™éœ€è¦é€šè¿‡shouldParkAfterFailedAcquire()åˆ¤æ–­æ˜¯å¦é˜»å¡ç­‰å¾…ï¼Œéœ€è¦çš„è¯ï¼Œåˆ™é€šè¿‡parkAndCheckInterrupt()è¿›è¡Œé˜»å¡ç­‰å¾…ã€‚doAcquireShared()ä¼šé€šè¿‡forå¾ªç¯ï¼Œä¸æ–­çš„è¿›è¡Œä¸Šé¢çš„æ“ä½œï¼›ç›®çš„å°±æ˜¯è·å–å…±äº«é”ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼šdoAcquireShared()åœ¨æ¯ä¸€æ¬¡å°è¯•è·å–é”æ—¶ï¼Œæ˜¯é€šè¿‡tryAcquireShared()æ¥æ‰§è¡Œçš„ï¼é‡Šæ”¾å…±äº«é”1234567891011121314é‡Šæ”¾å…±äº«é”çš„æ€æƒ³ï¼Œæ˜¯å…ˆé€šè¿‡tryReleaseShared()å°è¯•é‡Šæ”¾å…±äº«é”ã€‚å°è¯•æˆåŠŸçš„è¯ï¼Œåˆ™é€šè¿‡doReleaseShared()å”¤é†’â€œå…¶ä»–ç­‰å¾…è·å–å…±äº«é”çš„çº¿ç¨‹â€ï¼Œå¹¶è¿”å›trueï¼›å¦åˆ™çš„è¯ï¼Œè¿”å›flaseã€‚1. unlock()è¯´æ˜ï¼šè¯¥å‡½æ•°å®é™…ä¸Šè°ƒç”¨releaseShared(1)é‡Šæ”¾å…±äº«é”ã€‚2. releaseShared()è¯´æ˜ï¼šreleaseShared()çš„ç›®çš„æ˜¯è®©å½“å‰çº¿ç¨‹é‡Šæ”¾å®ƒæ‰€æŒæœ‰çš„å…±äº«é”ã€‚å®ƒé¦–å…ˆä¼šé€šè¿‡tryReleaseShared()å»å°è¯•é‡Šæ”¾å…±äº«é”ã€‚å°è¯•æˆåŠŸï¼Œåˆ™ç›´æ¥è¿”å›ï¼›å°è¯•å¤±è´¥ï¼Œåˆ™é€šè¿‡doReleaseShared()å»é‡Šæ”¾å…±äº«é”ã€‚3. tryReleaseShared()è¯´æ˜ï¼štryReleaseShared()çš„ä½œç”¨æ˜¯å°è¯•é‡Šæ”¾å…±äº«é”ã€‚4. doReleaseShared()è¯´æ˜ï¼šdoReleaseShared()ä¼šé‡Šæ”¾â€œå…±äº«é”â€ã€‚å®ƒä¼šä»å‰å¾€åçš„éå†CLHé˜Ÿåˆ—ï¼Œä¾æ¬¡â€œå”¤é†’â€ç„¶åâ€œæ‰§è¡Œâ€é˜Ÿåˆ—ä¸­æ¯ä¸ªèŠ‚ç‚¹å¯¹åº”çš„çº¿ç¨‹ï¼›æœ€ç»ˆçš„ç›®çš„æ˜¯è®©è¿™äº›çº¿ç¨‹é‡Šæ”¾å®ƒä»¬æ‰€æŒæœ‰çš„é”ã€‚å…¬å¹³å…±äº«é”å’Œéå…¬å¹³å…±äº«é”12345å’Œäº’æ–¥é”ReentrantLockä¸€æ ·ï¼ŒReadLockä¹Ÿåˆ†ä¸ºå…¬å¹³é”å’Œéå…¬å¹³é”ã€‚å…¬å¹³é”å’Œéå…¬å¹³é”çš„åŒºåˆ«ï¼Œä½“ç°åœ¨åˆ¤æ–­æ˜¯å¦éœ€è¦é˜»å¡çš„å‡½æ•°readerShouldBlock()æ˜¯ä¸åŒçš„ã€‚åœ¨å…¬å¹³å…±äº«é”ä¸­ï¼Œå¦‚æœåœ¨å½“å‰çº¿ç¨‹çš„å‰é¢æœ‰å…¶ä»–çº¿ç¨‹åœ¨ç­‰å¾…è·å–å…±äº«é”ï¼Œåˆ™è¿”å›trueï¼›å¦åˆ™ï¼Œè¿”å›falseã€‚åœ¨éå…¬å¹³å…±äº«é”ä¸­ï¼Œå®ƒä¼šæ— è§†å½“å‰çº¿ç¨‹çš„å‰é¢æ˜¯å¦æœ‰å…¶ä»–çº¿ç¨‹åœ¨ç­‰å¾…è·å–å…±äº«é”ã€‚åªè¦è¯¥éå…¬å¹³å…±äº«é”å¯¹åº”çš„çº¿ç¨‹ä¸ä¸ºnullï¼Œåˆ™è¿”å›trueã€‚ReentrantReadWriteLockç¤ºä¾‹123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105import java.util.concurrent.locks.ReadWriteLock; import java.util.concurrent.locks.ReentrantReadWriteLock; public class ReadWriteLockTest1 {     public static void main(String[] args) {         // åˆ›å»ºè´¦æˆ·        MyCount myCount = new MyCount(&quot;4238920615242830&quot;, 10000);         // åˆ›å»ºç”¨æˆ·ï¼Œå¹¶æŒ‡å®šè´¦æˆ·        User user = new User(&quot;Tommy&quot;, myCount);         // åˆ†åˆ«å¯åŠ¨3ä¸ªâ€œè¯»å–è´¦æˆ·é‡‘é’±â€çš„çº¿ç¨‹ å’Œ 3ä¸ªâ€œè®¾ç½®è´¦æˆ·é‡‘é’±â€çš„çº¿ç¨‹        for (int i=0; i&lt;3; i++) {            user.getCash();            user.setCash((i+1)*1000);        }    } } class User {    private String name;            //ç”¨æˆ·å     private MyCount myCount;        //æ‰€è¦æ“ä½œçš„è´¦æˆ·     private ReadWriteLock myLock;   //æ‰§è¡Œæ“ä½œæ‰€éœ€çš„é”å¯¹è±¡     User(String name, MyCount myCount) {        this.name = name;         this.myCount = myCount;         this.myLock = new ReentrantReadWriteLock();    }    public void getCash() {        new Thread() {            public void run() {                myLock.readLock().lock();                 try {                    System.out.println(Thread.currentThread().getName() +&quot; getCash start&quot;);                     myCount.getCash();                    Thread.sleep(1);                    System.out.println(Thread.currentThread().getName() +&quot; getCash end&quot;);                 } catch (InterruptedException e) {                } finally {                    myLock.readLock().unlock();                 }            }        }.start();    }    public void setCash(final int cash) {        new Thread() {            public void run() {                myLock.writeLock().lock();                 try {                    System.out.println(Thread.currentThread().getName() +&quot; setCash start&quot;);                     myCount.setCash(cash);                    Thread.sleep(1);                    System.out.println(Thread.currentThread().getName() +&quot; setCash end&quot;);                 } catch (InterruptedException e) {                } finally {                    myLock.writeLock().unlock();                 }            }        }.start();    }}class MyCount {    private String id;         //è´¦å·     private int    cash;       //è´¦æˆ·ä½™é¢     MyCount(String id, int cash) {         this.id = id;         this.cash = cash;     }     public String getId() {         return id;     }     public void setId(String id) {         this.id = id;     }     public int getCash() {         System.out.println(Thread.currentThread().getName() +&quot; getCash cash=&quot;+ cash);         return cash;     }     public void setCash(int cash) {         System.out.println(Thread.currentThread().getName() +&quot; setCash cash=&quot;+ cash);         this.cash = cash;     } }Thread-0 getCash startThread-2 getCash startThread-0 getCash cash=10000Thread-2 getCash cash=10000Thread-0 getCash endThread-2 getCash endThread-1 setCash startThread-1 setCash cash=1000Thread-1 setCash endThread-3 setCash startThread-3 setCash cash=2000Thread-3 setCash endThread-4 getCash startThread-4 getCash cash=2000Thread-4 getCash endThread-5 setCash startThread-5 setCash cash=3000Thread-5 setCash endç»“æœè¯´æ˜ï¼š(01) è§‚å¯ŸThread0å’ŒThread-2çš„è¿è¡Œç»“æœï¼Œæˆ‘ä»¬å‘ç°ï¼ŒThread-0å¯åŠ¨å¹¶è·å–åˆ°â€œè¯»å–é”â€ï¼Œåœ¨å®ƒè¿˜æ²¡è¿è¡Œå®Œæ¯•çš„æ—¶å€™ï¼ŒThread-2ä¹Ÿå¯åŠ¨äº†å¹¶ä¸”ä¹ŸæˆåŠŸè·å–åˆ°â€œè¯»å–é”â€ã€‚å› æ­¤ï¼Œâ€œè¯»å–é”â€æ”¯æŒè¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶è·å–ã€‚(02) è§‚å¯ŸThread-1,Thread-3,Thread-5è¿™ä¸‰ä¸ªâ€œå†™å…¥é”â€çš„çº¿ç¨‹ã€‚åªè¦â€œå†™å…¥é”â€è¢«æŸçº¿ç¨‹è·å–ï¼Œåˆ™è¯¥çº¿ç¨‹è¿è¡Œå®Œæ¯•äº†ï¼Œæ‰é‡Šæ”¾è¯¥é”ã€‚å› æ­¤ï¼Œâ€œå†™å…¥é”â€ä¸æ”¯æŒè¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶è·å–ã€‚CountDownLatchåŸç†å’Œç¤ºä¾‹12345CountDownLatchæ˜¯ä¸€ä¸ªåŒæ­¥è¾…åŠ©ç±»ï¼Œåœ¨å®Œæˆä¸€ç»„æ­£åœ¨å…¶ä»–çº¿ç¨‹ä¸­æ‰§è¡Œçš„æ“ä½œä¹‹å‰ï¼Œå®ƒå…è®¸ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ä¸€ç›´ç­‰å¾…ã€‚CountDownLatchå’ŒCyclicBarrierçš„åŒºåˆ«(01) CountDownLatchçš„ä½œç”¨æ˜¯å…è®¸1æˆ–Nä¸ªçº¿ç¨‹ç­‰å¾…å…¶ä»–çº¿ç¨‹å®Œæˆæ‰§è¡Œï¼›è€ŒCyclicBarrieråˆ™æ˜¯å…è®¸Nä¸ªçº¿ç¨‹ç›¸äº’ç­‰å¾…ã€‚(02) CountDownLatchçš„è®¡æ•°å™¨æ— æ³•è¢«é‡ç½®ï¼›CyclicBarrierçš„è®¡æ•°å™¨å¯ä»¥è¢«é‡ç½®åä½¿ç”¨ï¼Œå› æ­¤å®ƒè¢«ç§°ä¸ºæ˜¯å¾ªç¯çš„barrierã€‚å…³äºCyclicBarrierçš„åŸç†ï¼Œåé¢ä¸€ç« å†æ¥å­¦ä¹ ã€‚12345678910111213// CountDownLatchå‡½æ•°åˆ—è¡¨CountDownLatch(int count)// æ„é€ ä¸€ä¸ªç”¨ç»™å®šè®¡æ•°åˆå§‹åŒ–çš„ CountDownLatchã€‚// ä½¿å½“å‰çº¿ç¨‹åœ¨é”å­˜å™¨å€’è®¡æ•°è‡³é›¶ä¹‹å‰ä¸€ç›´ç­‰å¾…ï¼Œé™¤éçº¿ç¨‹è¢«ä¸­æ–­ã€‚void await()// ä½¿å½“å‰çº¿ç¨‹åœ¨é”å­˜å™¨å€’è®¡æ•°è‡³é›¶ä¹‹å‰ä¸€ç›´ç­‰å¾…ï¼Œé™¤éçº¿ç¨‹è¢«ä¸­æ–­æˆ–è¶…å‡ºäº†æŒ‡å®šçš„ç­‰å¾…æ—¶é—´ã€‚boolean await(long timeout, TimeUnit unit)// é€’å‡é”å­˜å™¨çš„è®¡æ•°ï¼Œå¦‚æœè®¡æ•°åˆ°è¾¾é›¶ï¼Œåˆ™é‡Šæ”¾æ‰€æœ‰ç­‰å¾…çš„çº¿ç¨‹ã€‚void countDown()// è¿”å›å½“å‰è®¡æ•°ã€‚long getCount()// è¿”å›æ ‡è¯†æ­¤é”å­˜å™¨åŠå…¶çŠ¶æ€çš„å­—ç¬¦ä¸²ã€‚String toString()12345678910111213141516171819202122231. CountDownLatch(int count)è¯´æ˜ï¼šè¯¥å‡½æ•°æ˜¯åˆ›å»ºä¸€ä¸ªSyncå¯¹è±¡ï¼Œè€ŒSyncæ˜¯ç»§æ‰¿äºAQSç±»ã€‚2. await()è¯´æ˜ï¼šè¯¥å‡½æ•°å®é™…ä¸Šæ˜¯è°ƒç”¨çš„AQSçš„acquireSharedInterruptibly(1);è¯´æ˜ï¼šacquireSharedInterruptibly()çš„ä½œç”¨æ˜¯è·å–å…±äº«é”ã€‚å¦‚æœå½“å‰çº¿ç¨‹æ˜¯ä¸­æ–­çŠ¶æ€ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸InterruptedExceptionã€‚å¦åˆ™ï¼Œè°ƒç”¨tryAcquireShared(arg)å°è¯•è·å–å…±äº«é”ï¼›å°è¯•æˆåŠŸåˆ™è¿”å›ï¼Œå¦åˆ™å°±è°ƒç”¨doAcquireSharedInterruptibly()ã€‚doAcquireSharedInterruptibly()ä¼šä½¿å½“å‰çº¿ç¨‹ä¸€ç›´ç­‰å¾…ï¼Œç›´åˆ°å½“å‰çº¿ç¨‹è·å–åˆ°å…±äº«é”(æˆ–è¢«ä¸­æ–­)æ‰è¿”å›ã€‚è¯´æ˜ï¼štryAcquireShared()çš„ä½œç”¨æ˜¯å°è¯•è·å–å…±äº«é”ã€‚å¦‚æœ&quot;é”è®¡æ•°å™¨=0&quot;ï¼Œå³é”æ˜¯å¯è·å–çŠ¶æ€ï¼Œåˆ™è¿”å›1ï¼›å¦åˆ™ï¼Œé”æ˜¯ä¸å¯è·å–çŠ¶æ€ï¼Œåˆ™è¿”å›-1ã€‚è¯´æ˜ï¼š(01) addWaiter(Node.SHARED)çš„ä½œç”¨æ˜¯ï¼Œåˆ›å»ºâ€å½“å‰çº¿ç¨‹â€œçš„NodeèŠ‚ç‚¹ï¼Œä¸”Nodeä¸­è®°å½•çš„é”çš„ç±»å‹æ˜¯â€å…±äº«é”â€œ(Node.SHARED)ï¼›å¹¶å°†è¯¥èŠ‚ç‚¹æ·»åŠ åˆ°CLHé˜Ÿåˆ—æœ«å°¾ã€‚å…³äºNodeå’ŒCLHåœ¨&quot;Javaå¤šçº¿ç¨‹ç³»åˆ—--â€œJUCé”â€03ä¹‹ å…¬å¹³é”(ä¸€)&quot;å·²ç»è¯¦ç»†ä»‹ç»è¿‡ï¼Œè¿™é‡Œå°±ä¸å†é‡å¤è¯´æ˜äº†ã€‚(02) node.predecessor()çš„ä½œç”¨æ˜¯ï¼Œè·å–ä¸Šä¸€ä¸ªèŠ‚ç‚¹ã€‚å¦‚æœä¸Šä¸€èŠ‚ç‚¹æ˜¯CLHé˜Ÿåˆ—çš„è¡¨å¤´ï¼Œåˆ™â€å°è¯•è·å–å…±äº«é”â€œã€‚(03) shouldParkAfterFailedAcquire()çš„ä½œç”¨å’Œå®ƒçš„åç§°ä¸€æ ·ï¼Œå¦‚æœåœ¨å°è¯•è·å–é”å¤±è´¥ä¹‹åï¼Œçº¿ç¨‹åº”è¯¥ç­‰å¾…ï¼Œåˆ™è¿”å›trueï¼›å¦åˆ™ï¼Œè¿”å›falseã€‚(04) å½“shouldParkAfterFailedAcquire()è¿”å›tureæ—¶ï¼Œåˆ™è°ƒç”¨parkAndCheckInterrupt()ï¼Œå½“å‰çº¿ç¨‹ä¼šè¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œç›´åˆ°è·å–åˆ°å…±äº«é”æ‰ç»§ç»­è¿è¡Œã€‚3. countDown()è¯´æ˜ï¼šè¯¥å‡½æ•°å®é™…ä¸Šè°ƒç”¨releaseShared(1)é‡Šæ”¾å…±äº«é”ã€‚è¯´æ˜ï¼šreleaseShared()çš„ç›®çš„æ˜¯è®©å½“å‰çº¿ç¨‹é‡Šæ”¾å®ƒæ‰€æŒæœ‰çš„å…±äº«é”ã€‚å®ƒé¦–å…ˆä¼šé€šè¿‡tryReleaseShared()å»å°è¯•é‡Šæ”¾å…±äº«é”ã€‚å°è¯•æˆåŠŸï¼Œåˆ™ç›´æ¥è¿”å›ï¼›å°è¯•å¤±è´¥ï¼Œåˆ™é€šè¿‡doReleaseShared()å»é‡Šæ”¾å…±äº«é”ã€‚è¯´æ˜ï¼štryReleaseShared()çš„ä½œç”¨æ˜¯é‡Šæ”¾å…±äº«é”ï¼Œå°†â€œé”è®¡æ•°å™¨â€çš„å€¼-1ã€‚æ€»ç»“ï¼šCountDownLatchæ˜¯é€šè¿‡â€œå…±äº«é”â€å®ç°çš„ã€‚åœ¨åˆ›å»ºCountDownLatchä¸­æ—¶ï¼Œä¼šä¼ é€’ä¸€ä¸ªintç±»å‹å‚æ•°countï¼Œè¯¥å‚æ•°æ˜¯â€œé”è®¡æ•°å™¨â€çš„åˆå§‹çŠ¶æ€ï¼Œè¡¨ç¤ºè¯¥â€œå…±äº«é”â€æœ€å¤šèƒ½è¢«countç»™çº¿ç¨‹åŒæ—¶è·å–ã€‚å½“æŸçº¿ç¨‹è°ƒç”¨è¯¥CountDownLatchå¯¹è±¡çš„await()æ–¹æ³•æ—¶ï¼Œè¯¥çº¿ç¨‹ä¼šç­‰å¾…â€œå…±äº«é”â€å¯ç”¨æ—¶ï¼Œæ‰èƒ½è·å–â€œå…±äº«é”â€è¿›è€Œç»§ç»­è¿è¡Œã€‚è€Œâ€œå…±äº«é”â€å¯ç”¨çš„æ¡ä»¶ï¼Œå°±æ˜¯â€œé”è®¡æ•°å™¨â€çš„å€¼ä¸º0ï¼è€Œâ€œé”è®¡æ•°å™¨â€çš„åˆå§‹å€¼ä¸ºcountï¼Œæ¯å½“ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨è¯¥CountDownLatchå¯¹è±¡çš„countDown()æ–¹æ³•æ—¶ï¼Œæ‰å°†â€œé”è®¡æ•°å™¨â€-1ï¼›é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¿…é¡»æœ‰countä¸ªçº¿ç¨‹è°ƒç”¨countDown()ä¹‹åï¼Œâ€œé”è®¡æ•°å™¨â€æ‰ä¸º0ï¼Œè€Œå‰é¢æåˆ°çš„ç­‰å¾…çº¿ç¨‹æ‰èƒ½ç»§ç»­è¿è¡Œï¼CountDownLatchçš„ä½¿ç”¨ç¤ºä¾‹12345678910111213141516171819202122232425262728293031323334353637383940414243// é€šè¿‡CountDownLatchå®ç°ï¼š&quot;ä¸»çº¿ç¨‹&quot;ç­‰å¾…&quot;5ä¸ªå­çº¿ç¨‹&quot;å…¨éƒ¨éƒ½å®Œæˆ&quot;æŒ‡å®šçš„å·¥ä½œ(ä¼‘çœ 1000ms)&quot;ä¹‹åï¼Œå†ç»§ç»­è¿è¡Œã€‚import java.util.concurrent.CountDownLatch;import java.util.concurrent.CyclicBarrier;public class CountDownLatchTest1 {    private static int LATCH_SIZE = 5;    private static CountDownLatch doneSignal;    public static void main(String[] args) {        try {            doneSignal = new CountDownLatch(LATCH_SIZE);            // æ–°å»º5ä¸ªä»»åŠ¡            for(int i=0; i&lt;LATCH_SIZE; i++)                new InnerThread().start();            System.out.println(&quot;main await begin.&quot;);            // &quot;ä¸»çº¿ç¨‹&quot;ç­‰å¾…çº¿ç¨‹æ± ä¸­5ä¸ªä»»åŠ¡çš„å®Œæˆ            doneSignal.await();            System.out.println(&quot;main await finished.&quot;);        } catch (InterruptedException e) {            e.printStackTrace();        }    }    static class InnerThread extends Thread{        public void run() {            try {                Thread.sleep(1000);                System.out.println(Thread.currentThread().getName() + &quot; sleep 1000ms.&quot;);                // å°†CountDownLatchçš„æ•°å€¼å‡1                doneSignal.countDown();            } catch (InterruptedException e) {                e.printStackTrace();            }        }    }}main await begin.Thread-0 sleep 1000ms.Thread-2 sleep 1000ms.Thread-1 sleep 1000ms.Thread-4 sleep 1000ms.Thread-3 sleep 1000ms.main await finished.    ç»“æœè¯´æ˜ï¼šä¸»çº¿ç¨‹é€šè¿‡doneSignal.await()ç­‰å¾…å…¶å®ƒçº¿ç¨‹å°†doneSignalé€’å‡è‡³0ã€‚å…¶å®ƒçš„5ä¸ªInnerThreadçº¿ç¨‹ï¼Œæ¯ä¸€ä¸ªéƒ½é€šè¿‡doneSignal.countDown()å°†doneSignalçš„å€¼å‡1ï¼›å½“doneSignalä¸º0æ—¶ï¼Œmainè¢«å”¤é†’åç»§ç»­æ‰§è¡Œã€‚CyclicBarrieråŸç†å’Œç¤ºä¾‹1234CyclicBarrieræ˜¯ä¸€ä¸ªåŒæ­¥è¾…åŠ©ç±»ï¼Œå…è®¸ä¸€ç»„çº¿ç¨‹äº’ç›¸ç­‰å¾…ï¼Œç›´åˆ°åˆ°è¾¾æŸä¸ªå…¬å…±å±éšœç‚¹ (common barrier point)ã€‚å› ä¸ºè¯¥ barrier åœ¨é‡Šæ”¾ç­‰å¾…çº¿ç¨‹åå¯ä»¥é‡ç”¨ï¼Œæ‰€ä»¥ç§°å®ƒä¸ºå¾ªç¯ çš„ barrierã€‚æ³¨æ„æ¯”è¾ƒCountDownLatchå’ŒCyclicBarrierï¼š(01) CountDownLatchçš„ä½œç”¨æ˜¯å…è®¸1æˆ–Nä¸ªçº¿ç¨‹ç­‰å¾…å…¶ä»–çº¿ç¨‹å®Œæˆæ‰§è¡Œï¼›è€ŒCyclicBarrieråˆ™æ˜¯å…è®¸Nä¸ªçº¿ç¨‹ç›¸äº’ç­‰å¾…ã€‚(02) CountDownLatchçš„è®¡æ•°å™¨æ— æ³•è¢«é‡ç½®ï¼›CyclicBarrierçš„è®¡æ•°å™¨å¯ä»¥è¢«é‡ç½®åä½¿ç”¨ï¼Œå› æ­¤å®ƒè¢«ç§°ä¸ºæ˜¯å¾ªç¯çš„barrierã€‚1234567891011121314151617// CyclicBarrierå‡½æ•°åˆ—è¡¨CyclicBarrier(int parties)// åˆ›å»ºä¸€ä¸ªæ–°çš„ CyclicBarrierï¼Œå®ƒå°†åœ¨ç»™å®šæ•°é‡çš„å‚ä¸è€…ï¼ˆçº¿ç¨‹ï¼‰å¤„äºç­‰å¾…çŠ¶æ€æ—¶å¯åŠ¨ï¼Œä½†å®ƒä¸ä¼šåœ¨å¯åŠ¨ barrier æ—¶æ‰§è¡Œé¢„å®šä¹‰çš„æ“ä½œã€‚CyclicBarrier(int parties, Runnable barrierAction)// åˆ›å»ºä¸€ä¸ªæ–°çš„ CyclicBarrierï¼Œå®ƒå°†åœ¨ç»™å®šæ•°é‡çš„å‚ä¸è€…ï¼ˆçº¿ç¨‹ï¼‰å¤„äºç­‰å¾…çŠ¶æ€æ—¶å¯åŠ¨ï¼Œå¹¶åœ¨å¯åŠ¨ barrier æ—¶æ‰§è¡Œç»™å®šçš„å±éšœæ“ä½œï¼Œè¯¥æ“ä½œç”±æœ€åä¸€ä¸ªè¿›å…¥ barrier çš„çº¿ç¨‹æ‰§è¡Œã€‚int await()// åœ¨æ‰€æœ‰å‚ä¸è€…éƒ½å·²ç»åœ¨æ­¤ barrier ä¸Šè°ƒç”¨ await æ–¹æ³•ä¹‹å‰ï¼Œå°†ä¸€ç›´ç­‰å¾…ã€‚int await(long timeout, TimeUnit unit)// åœ¨æ‰€æœ‰å‚ä¸è€…éƒ½å·²ç»åœ¨æ­¤å±éšœä¸Šè°ƒç”¨ await æ–¹æ³•ä¹‹å‰å°†ä¸€ç›´ç­‰å¾…,æˆ–è€…è¶…å‡ºäº†æŒ‡å®šçš„ç­‰å¾…æ—¶é—´ã€‚int getNumberWaiting()// è¿”å›å½“å‰åœ¨å±éšœå¤„ç­‰å¾…çš„å‚ä¸è€…æ•°ç›®ã€‚int getParties()// è¿”å›è¦æ±‚å¯åŠ¨æ­¤ barrier çš„å‚ä¸è€…æ•°ç›®ã€‚boolean isBroken()// æŸ¥è¯¢æ­¤å±éšœæ˜¯å¦å¤„äºæŸåçŠ¶æ€ã€‚void reset()// å°†å±éšœé‡ç½®ä¸ºå…¶åˆå§‹çŠ¶æ€ã€‚12345678910111213141516171819202122232425262728291. æ„é€ å‡½æ•°CyclicBarrierçš„æ„é€ å‡½æ•°å…±2ä¸ªï¼šCyclicBarrier å’Œ CyclicBarrier(int parties, Runnable barrierAction)ã€‚ç¬¬1ä¸ªæ„é€ å‡½æ•°æ˜¯è°ƒç”¨ç¬¬2ä¸ªæ„é€ å‡½æ•°æ¥å®ç°çš„ï¼Œ2. ç­‰å¾…å‡½æ•°è¯´æ˜ï¼šawait()æ˜¯é€šè¿‡dowait()å®ç°çš„ã€‚è¯´æ˜ï¼šdowait()çš„ä½œç”¨å°±æ˜¯è®©å½“å‰çº¿ç¨‹é˜»å¡ï¼Œç›´åˆ°â€œæœ‰partiesä¸ªçº¿ç¨‹åˆ°è¾¾barrierâ€ æˆ– â€œå½“å‰çº¿ç¨‹è¢«ä¸­æ–­â€ æˆ– â€œè¶…æ—¶â€è¿™3è€…ä¹‹ä¸€å‘ç”Ÿï¼Œå½“å‰çº¿ç¨‹æ‰ç»§ç»­æ‰§è¡Œã€‚(01) generationæ˜¯CyclicBarrierçš„ä¸€ä¸ªæˆå‘˜éå†ï¼Œå®ƒçš„å®šä¹‰å¦‚ä¸‹ï¼šprivate Generation generation = new Generation();private static class Generation {    boolean broken = false;}åœ¨CyclicBarrierä¸­ï¼ŒåŒä¸€æ‰¹çš„çº¿ç¨‹å±äºåŒä¸€ä»£ï¼Œå³åŒä¸€ä¸ªGenerationï¼›CyclicBarrierä¸­é€šè¿‡generationå¯¹è±¡ï¼Œè®°å½•å±äºå“ªä¸€ä»£ã€‚å½“æœ‰partiesä¸ªçº¿ç¨‹åˆ°è¾¾barrierï¼Œgenerationå°±ä¼šè¢«æ›´æ–°æ¢ä»£ã€‚(02) å¦‚æœå½“å‰çº¿ç¨‹è¢«ä¸­æ–­ï¼Œå³Thread.interrupted()ä¸ºtrueï¼›åˆ™é€šè¿‡breakBarrier()ç»ˆæ­¢CyclicBarrierã€‚breakBarrier()çš„æºç å¦‚ä¸‹ï¼šprivate void breakBarrier() {    generation.broken = true;    count = parties;    trip.signalAll();}breakBarrier()ä¼šè®¾ç½®å½“å‰ä¸­æ–­æ ‡è®°brokenä¸ºtrueï¼Œæ„å‘³ç€â€œå°†è¯¥Generationä¸­æ–­â€ï¼›åŒæ—¶ï¼Œè®¾ç½®count=partiesï¼Œå³é‡æ–°åˆå§‹åŒ–countï¼›æœ€åï¼Œé€šè¿‡signalAll()å”¤é†’CyclicBarrierä¸Šæ‰€æœ‰çš„ç­‰å¾…çº¿ç¨‹ã€‚(03) å°†â€œcountè®¡æ•°å™¨â€-1ï¼Œå³--countï¼›ç„¶ååˆ¤æ–­æ˜¯ä¸æ˜¯â€œæœ‰partiesä¸ªçº¿ç¨‹åˆ°è¾¾barrierâ€ï¼Œå³indexæ˜¯ä¸æ˜¯ä¸º0ã€‚å½“index=0æ—¶ï¼Œå¦‚æœbarrierCommandä¸ä¸ºnullï¼Œåˆ™æ‰§è¡Œè¯¥barrierCommandï¼ŒbarrierCommandå°±æ˜¯æˆ‘ä»¬åˆ›å»ºCyclicBarrieræ—¶ï¼Œä¼ å…¥çš„Runnableå¯¹è±¡ã€‚ç„¶åï¼Œè°ƒç”¨nextGeneration()è¿›è¡Œæ¢ä»£å·¥ä½œï¼ŒnextGeneration()çš„æºç å¦‚ä¸‹ï¼šprivate void nextGeneration() {    trip.signalAll();    count = parties;    generation = new Generation();}é¦–å…ˆï¼Œå®ƒä¼šè°ƒç”¨signalAll()å”¤é†’CyclicBarrierä¸Šæ‰€æœ‰çš„ç­‰å¾…çº¿ç¨‹ï¼›æ¥ç€ï¼Œé‡æ–°åˆå§‹åŒ–countï¼›æœ€åï¼Œæ›´æ–°generationçš„å€¼ã€‚(04) åœ¨for(;;)å¾ªç¯ä¸­ã€‚timedæ˜¯ç”¨æ¥è¡¨ç¤ºå½“å‰æ˜¯ä¸æ˜¯â€œè¶…æ—¶ç­‰å¾…â€çº¿ç¨‹ã€‚å¦‚æœä¸æ˜¯ï¼Œåˆ™é€šè¿‡trip.await()è¿›è¡Œç­‰å¾…ï¼›å¦åˆ™ï¼Œè°ƒç”¨awaitNanos()è¿›è¡Œè¶…æ—¶ç­‰å¾…ã€‚CyclicBarrierçš„ä½¿ç”¨ç¤ºä¾‹123456789101112131415161718192021222324252627282930313233343536373839404142// æ–°å»º5ä¸ªçº¿ç¨‹ï¼Œè¿™5ä¸ªçº¿ç¨‹è¾¾åˆ°ä¸€å®šçš„æ¡ä»¶æ—¶ï¼Œå®ƒä»¬æ‰ç»§ç»­å¾€åè¿è¡Œã€‚import java.util.concurrent.CyclicBarrier;import java.util.concurrent.BrokenBarrierException;public class CyclicBarrierTest1 {    private static int SIZE = 5;    private static CyclicBarrier cb;    public static void main(String[] args) {        cb = new CyclicBarrier(SIZE);        // æ–°å»º5ä¸ªä»»åŠ¡        for(int i=0; i&lt;SIZE; i++)            new InnerThread().start();    }    static class InnerThread extends Thread{        public void run() {            try {                System.out.println(Thread.currentThread().getName() + &quot; wait for CyclicBarrier.&quot;);                // å°†cbçš„å‚ä¸è€…æ•°é‡åŠ 1                cb.await();                // cbçš„å‚ä¸è€…æ•°é‡ç­‰äº5æ—¶ï¼Œæ‰ç»§ç»­å¾€åæ‰§è¡Œ                System.out.println(Thread.currentThread().getName() + &quot; continued.&quot;);            } catch (BrokenBarrierException e) {                e.printStackTrace();            } catch (InterruptedException e) {                e.printStackTrace();            }        }    }}Thread-1 wait for CyclicBarrier.Thread-2 wait for CyclicBarrier.Thread-3 wait for CyclicBarrier.Thread-4 wait for CyclicBarrier.Thread-0 wait for CyclicBarrier.Thread-0 continued.Thread-4 continued.Thread-2 continued.Thread-3 continued.Thread-1 continued.ç»“æœè¯´æ˜ï¼šä¸»çº¿ç¨‹ä¸­æ–°å»ºäº†5ä¸ªçº¿ç¨‹ï¼Œæ‰€æœ‰çš„è¿™äº›çº¿ç¨‹éƒ½è°ƒç”¨cb.await()ç­‰å¾…ã€‚æ‰€æœ‰è¿™äº›çº¿ç¨‹ä¸€ç›´ç­‰å¾…ï¼Œç›´åˆ°cbä¸­æ‰€æœ‰çº¿ç¨‹éƒ½è¾¾åˆ°barrieræ—¶ï¼Œè¿™äº›çº¿ç¨‹æ‰ç»§ç»­è¿è¡Œï¼12345678910111213141516171819202122232425262728293031323334353637383940414243444546// æ–°å»º5ä¸ªçº¿ç¨‹ï¼Œå½“è¿™5ä¸ªçº¿ç¨‹è¾¾åˆ°ä¸€å®šçš„æ¡ä»¶æ—¶ï¼Œæ‰§è¡ŒæŸé¡¹ä»»åŠ¡ã€‚import java.util.concurrent.CyclicBarrier;import java.util.concurrent.BrokenBarrierException;public class CyclicBarrierTest2 {    private static int SIZE = 5;    private static CyclicBarrier cb;    public static void main(String[] args) {        cb = new CyclicBarrier(SIZE, new Runnable () {            public void run() {                System.out.println(&quot;CyclicBarrier's parties is: &quot;+ cb.getParties());            }        });        // æ–°å»º5ä¸ªä»»åŠ¡        for(int i=0; i&lt;SIZE; i++)            new InnerThread().start();    }    static class InnerThread extends Thread{        public void run() {            try {                System.out.println(Thread.currentThread().getName() + &quot; wait for CyclicBarrier.&quot;);                // å°†cbçš„å‚ä¸è€…æ•°é‡åŠ 1                cb.await();                // cbçš„å‚ä¸è€…æ•°é‡ç­‰äº5æ—¶ï¼Œæ‰ç»§ç»­å¾€åæ‰§è¡Œ                System.out.println(Thread.currentThread().getName() + &quot; continued.&quot;);            } catch (BrokenBarrierException e) {                e.printStackTrace();            } catch (InterruptedException e) {                e.printStackTrace();            }        }    }}Thread-1 wait for CyclicBarrier.Thread-2 wait for CyclicBarrier.Thread-3 wait for CyclicBarrier.Thread-4 wait for CyclicBarrier.Thread-0 wait for CyclicBarrier.CyclicBarrier's parties is: 5Thread-0 continued.Thread-4 continued.Thread-2 continued.Thread-3 continued.Thread-1 continued.    ç»“æœè¯´æ˜ï¼šä¸»çº¿ç¨‹ä¸­æ–°å»ºäº†5ä¸ªçº¿ç¨‹ï¼Œæ‰€æœ‰çš„è¿™äº›çº¿ç¨‹éƒ½è°ƒç”¨cb.await()ç­‰å¾…ã€‚æ‰€æœ‰è¿™äº›çº¿ç¨‹ä¸€ç›´ç­‰å¾…ï¼Œç›´åˆ°cbä¸­æ‰€æœ‰çº¿ç¨‹éƒ½è¾¾åˆ°barrieræ—¶ï¼Œæ‰§è¡Œæ–°å»ºcbæ—¶æ³¨å†Œçš„Runnableä»»åŠ¡ã€‚Semaphoreä¿¡å·é‡çš„åŸç†å’Œç¤ºä¾‹123Semaphoreæ˜¯ä¸€ä¸ªè®¡æ•°ä¿¡å·é‡ï¼Œå®ƒçš„æœ¬è´¨æ˜¯ä¸€ä¸ª&quot;å…±äº«é”&quot;ã€‚ä¿¡å·é‡ç»´æŠ¤äº†ä¸€ä¸ªä¿¡å·é‡è®¸å¯é›†ã€‚çº¿ç¨‹å¯ä»¥é€šè¿‡è°ƒç”¨acquire()æ¥è·å–ä¿¡å·é‡çš„è®¸å¯ï¼›å½“ä¿¡å·é‡ä¸­æœ‰å¯ç”¨çš„è®¸å¯æ—¶ï¼Œçº¿ç¨‹èƒ½è·å–è¯¥è®¸å¯ï¼›å¦åˆ™çº¿ç¨‹å¿…é¡»ç­‰å¾…ï¼Œç›´åˆ°æœ‰å¯ç”¨çš„è®¸å¯ä¸ºæ­¢ã€‚ çº¿ç¨‹å¯ä»¥é€šè¿‡release()æ¥é‡Šæ”¾å®ƒæ‰€æŒæœ‰çš„ä¿¡å·é‡è®¸å¯ã€‚1234567891011121314151617181920212223242526272829303132333435363738394041// Semaphoreçš„å‡½æ•°åˆ—è¡¨// åˆ›å»ºå…·æœ‰ç»™å®šçš„è®¸å¯æ•°å’Œéå…¬å¹³çš„å…¬å¹³è®¾ç½®çš„ Semaphoreã€‚Semaphore(int permits)// åˆ›å»ºå…·æœ‰ç»™å®šçš„è®¸å¯æ•°å’Œç»™å®šçš„å…¬å¹³è®¾ç½®çš„ Semaphoreã€‚Semaphore(int permits, boolean fair)// ä»æ­¤ä¿¡å·é‡è·å–ä¸€ä¸ªè®¸å¯ï¼Œåœ¨æä¾›ä¸€ä¸ªè®¸å¯å‰ä¸€ç›´å°†çº¿ç¨‹é˜»å¡ï¼Œå¦åˆ™çº¿ç¨‹è¢«ä¸­æ–­ã€‚void acquire()// ä»æ­¤ä¿¡å·é‡è·å–ç»™å®šæ•°ç›®çš„è®¸å¯ï¼Œåœ¨æä¾›è¿™äº›è®¸å¯å‰ä¸€ç›´å°†çº¿ç¨‹é˜»å¡ï¼Œæˆ–è€…çº¿ç¨‹å·²è¢«ä¸­æ–­ã€‚void acquire(int permits)// ä»æ­¤ä¿¡å·é‡ä¸­è·å–è®¸å¯ï¼Œåœ¨æœ‰å¯ç”¨çš„è®¸å¯å‰å°†å…¶é˜»å¡ã€‚void acquireUninterruptibly()// ä»æ­¤ä¿¡å·é‡è·å–ç»™å®šæ•°ç›®çš„è®¸å¯ï¼Œåœ¨æä¾›è¿™äº›è®¸å¯å‰ä¸€ç›´å°†çº¿ç¨‹é˜»å¡ã€‚void acquireUninterruptibly(int permits)// è¿”å›æ­¤ä¿¡å·é‡ä¸­å½“å‰å¯ç”¨çš„è®¸å¯æ•°ã€‚int availablePermits()// è·å–å¹¶è¿”å›ç«‹å³å¯ç”¨çš„æ‰€æœ‰è®¸å¯ã€‚int drainPermits()// è¿”å›ä¸€ä¸ª collectionï¼ŒåŒ…å«å¯èƒ½ç­‰å¾…è·å–çš„çº¿ç¨‹ã€‚protected Collection&lt;Thread&gt; getQueuedThreads()// è¿”å›æ­£åœ¨ç­‰å¾…è·å–çš„çº¿ç¨‹çš„ä¼°è®¡æ•°ç›®ã€‚int getQueueLength()// æŸ¥è¯¢æ˜¯å¦æœ‰çº¿ç¨‹æ­£åœ¨ç­‰å¾…è·å–ã€‚boolean hasQueuedThreads()// å¦‚æœæ­¤ä¿¡å·é‡çš„å…¬å¹³è®¾ç½®ä¸º trueï¼Œåˆ™è¿”å› trueã€‚boolean isFair()// æ ¹æ®æŒ‡å®šçš„ç¼©å‡é‡å‡å°å¯ç”¨è®¸å¯çš„æ•°ç›®ã€‚protected void reducePermits(int reduction)// é‡Šæ”¾ä¸€ä¸ªè®¸å¯ï¼Œå°†å…¶è¿”å›ç»™ä¿¡å·é‡ã€‚void release()// é‡Šæ”¾ç»™å®šæ•°ç›®çš„è®¸å¯ï¼Œå°†å…¶è¿”å›åˆ°ä¿¡å·é‡ã€‚void release(int permits)// è¿”å›æ ‡è¯†æ­¤ä¿¡å·é‡çš„å­—ç¬¦ä¸²ï¼Œä»¥åŠä¿¡å·é‡çš„çŠ¶æ€ã€‚String toString()// ä»…åœ¨è°ƒç”¨æ—¶æ­¤ä¿¡å·é‡å­˜åœ¨ä¸€ä¸ªå¯ç”¨è®¸å¯ï¼Œæ‰ä»ä¿¡å·é‡è·å–è®¸å¯ã€‚boolean tryAcquire()// ä»…åœ¨è°ƒç”¨æ—¶æ­¤ä¿¡å·é‡ä¸­æœ‰ç»™å®šæ•°ç›®çš„è®¸å¯æ—¶ï¼Œæ‰ä»æ­¤ä¿¡å·é‡ä¸­è·å–è¿™äº›è®¸å¯ã€‚boolean tryAcquire(int permits)// å¦‚æœåœ¨ç»™å®šçš„ç­‰å¾…æ—¶é—´å†…æ­¤ä¿¡å·é‡æœ‰å¯ç”¨çš„æ‰€æœ‰è®¸å¯ï¼Œå¹¶ä¸”å½“å‰çº¿ç¨‹æœªè¢«ä¸­æ–­ï¼Œåˆ™ä»æ­¤ä¿¡å·é‡è·å–ç»™å®šæ•°ç›®çš„è®¸å¯ã€‚boolean tryAcquire(int permits, long timeout, TimeUnit unit)// å¦‚æœåœ¨ç»™å®šçš„ç­‰å¾…æ—¶é—´å†…ï¼Œæ­¤ä¿¡å·é‡æœ‰å¯ç”¨çš„è®¸å¯å¹¶ä¸”å½“å‰çº¿ç¨‹æœªè¢«ä¸­æ–­ï¼Œåˆ™ä»æ­¤ä¿¡å·é‡è·å–ä¸€ä¸ªè®¸å¯ã€‚boolean tryAcquire(long timeout, TimeUnit unit)1234Semaphoreæ˜¯é€šè¿‡å…±äº«é”å®ç°çš„ã€‚æ ¹æ®å…±äº«é”çš„è·å–åŸåˆ™ï¼ŒSemaphoreåˆ†ä¸º&quot;å…¬å¹³ä¿¡å·é‡&quot;å’Œ&quot;éå…¬å¹³ä¿¡å·é‡&quot;ã€‚&quot;å…¬å¹³ä¿¡å·é‡&quot;å’Œ&quot;éå…¬å¹³ä¿¡å·é‡&quot;çš„åŒºåˆ«&quot;å…¬å¹³ä¿¡å·é‡&quot;å’Œ&quot;éå…¬å¹³ä¿¡å·é‡&quot;çš„é‡Šæ”¾ä¿¡å·é‡çš„æœºåˆ¶æ˜¯ä¸€æ ·çš„ï¼ä¸åŒçš„æ˜¯å®ƒä»¬è·å–ä¿¡å·é‡çš„æœºåˆ¶ï¼šçº¿ç¨‹åœ¨å°è¯•è·å–ä¿¡å·é‡è®¸å¯æ—¶ï¼Œå¯¹äºå…¬å¹³ä¿¡å·é‡è€Œè¨€ï¼Œå¦‚æœå½“å‰çº¿ç¨‹ä¸åœ¨CLHé˜Ÿåˆ—çš„å¤´éƒ¨ï¼Œåˆ™æ’é˜Ÿç­‰å€™ï¼›è€Œå¯¹äºéå…¬å¹³ä¿¡å·é‡è€Œè¨€ï¼Œæ— è®ºå½“å‰çº¿ç¨‹æ˜¯ä¸æ˜¯åœ¨CLHé˜Ÿåˆ—çš„å¤´éƒ¨ï¼Œå®ƒéƒ½ä¼šç›´æ¥è·å–ä¿¡å·é‡ã€‚è¯¥å·®å¼‚å…·ä½“çš„ä½“ç°åœ¨ï¼Œå®ƒä»¬çš„tryAcquireShared()å‡½æ•°çš„å®ç°ä¸åŒã€‚å…¬å¹³ä¿¡å·é‡è·å–å’Œé‡Šæ”¾1234567891011121314151617181. å…¬å¹³ä¿¡å·é‡çš„è·å–Semaphoreä¸­çš„å…¬å¹³ä¿¡å·é‡æ˜¯FairSyncã€‚ä¿¡å·é‡ä¸­çš„acquire()è·å–å‡½æ•°ï¼Œå®é™…ä¸Šæ˜¯è°ƒç”¨çš„AQSä¸­çš„acquireSharedInterruptibly()ã€‚è¯´æ˜ï¼štryAcquireShared()çš„ä½œç”¨æ˜¯å°è¯•è·å–acquiresä¸ªä¿¡å·é‡è®¸å¯æ•°ã€‚å¯¹äºSemaphoreè€Œè¨€ï¼Œstateè¡¨ç¤ºçš„æ˜¯â€œå½“å‰å¯è·å¾—çš„ä¿¡å·é‡è®¸å¯æ•°â€ã€‚è¯´æ˜ï¼šdoAcquireSharedInterruptibly()ä¼šä½¿å½“å‰çº¿ç¨‹ä¸€ç›´ç­‰å¾…ï¼Œç›´åˆ°å½“å‰çº¿ç¨‹è·å–åˆ°å…±äº«é”(æˆ–è¢«ä¸­æ–­)æ‰è¿”å›ã€‚(01) addWaiter(Node.SHARED)çš„ä½œç”¨æ˜¯ï¼Œåˆ›å»ºâ€å½“å‰çº¿ç¨‹â€œçš„NodeèŠ‚ç‚¹ï¼Œä¸”Nodeä¸­è®°å½•çš„é”çš„ç±»å‹æ˜¯â€å…±äº«é”â€œ(Node.SHARED)ï¼›å¹¶å°†è¯¥èŠ‚ç‚¹æ·»åŠ åˆ°CLHé˜Ÿåˆ—æœ«å°¾ã€‚å…³äºNodeå’ŒCLHåœ¨&quot;Javaå¤šçº¿ç¨‹ç³»åˆ—--â€œJUCé”â€03ä¹‹ å…¬å¹³é”(ä¸€)&quot;å·²ç»è¯¦ç»†ä»‹ç»è¿‡ï¼Œè¿™é‡Œå°±ä¸å†é‡å¤è¯´æ˜äº†ã€‚(02) node.predecessor()çš„ä½œç”¨æ˜¯ï¼Œè·å–ä¸Šä¸€ä¸ªèŠ‚ç‚¹ã€‚å¦‚æœä¸Šä¸€èŠ‚ç‚¹æ˜¯CLHé˜Ÿåˆ—çš„è¡¨å¤´ï¼Œåˆ™â€å°è¯•è·å–å…±äº«é”â€œã€‚(03) shouldParkAfterFailedAcquire()çš„ä½œç”¨å’Œå®ƒçš„åç§°ä¸€æ ·ï¼Œå¦‚æœåœ¨å°è¯•è·å–é”å¤±è´¥ä¹‹åï¼Œçº¿ç¨‹åº”è¯¥ç­‰å¾…ï¼Œåˆ™è¿”å›trueï¼›å¦åˆ™ï¼Œè¿”å›falseã€‚(04) å½“shouldParkAfterFailedAcquire()è¿”å›tureæ—¶ï¼Œåˆ™è°ƒç”¨parkAndCheckInterrupt()ï¼Œå½“å‰çº¿ç¨‹ä¼šè¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œç›´åˆ°è·å–åˆ°å…±äº«é”æ‰ç»§ç»­è¿è¡Œã€‚2. å…¬å¹³ä¿¡å·é‡çš„é‡Šæ”¾ä¿¡å·é‡çš„releases()é‡Šæ”¾å‡½æ•°ï¼Œå®é™…ä¸Šæ˜¯è°ƒç”¨çš„AQSä¸­çš„releaseShared()ã€‚è¯´æ˜ï¼šreleaseShared()çš„ç›®çš„æ˜¯è®©å½“å‰çº¿ç¨‹é‡Šæ”¾å®ƒæ‰€æŒæœ‰çš„å…±äº«é”ã€‚å®ƒé¦–å…ˆä¼šé€šè¿‡tryReleaseShared()å»å°è¯•é‡Šæ”¾å…±äº«é”ã€‚å°è¯•æˆåŠŸï¼Œåˆ™ç›´æ¥è¿”å›ï¼›å°è¯•å¤±è´¥ï¼Œåˆ™é€šè¿‡doReleaseShared()å»é‡Šæ”¾å…±äº«é”ã€‚Semaphoreé‡å†™äº†tryReleaseShared()ï¼Œå¦‚æœtryReleaseShared()å°è¯•é‡Šæ”¾å…±äº«é”å¤±è´¥ï¼Œåˆ™ä¼šè°ƒç”¨doReleaseShared()å»é‡Šæ”¾å…±äº«é”ã€‚è¯´æ˜ï¼šdoReleaseShared()ä¼šé‡Šæ”¾â€œå…±äº«é”â€ã€‚å®ƒä¼šä»å‰å¾€åçš„éå†CLHé˜Ÿåˆ—ï¼Œä¾æ¬¡â€œå”¤é†’â€ç„¶åâ€œæ‰§è¡Œâ€é˜Ÿåˆ—ä¸­æ¯ä¸ªèŠ‚ç‚¹å¯¹åº”çš„çº¿ç¨‹ï¼›æœ€ç»ˆçš„ç›®çš„æ˜¯è®©è¿™äº›çº¿ç¨‹é‡Šæ”¾å®ƒä»¬æ‰€æŒæœ‰çš„ä¿¡å·é‡ã€‚éå…¬å¹³ä¿¡å·é‡è·å–å’Œé‡Šæ”¾1234Semaphoreä¸­çš„éå…¬å¹³ä¿¡å·é‡æ˜¯NonFairSyncã€‚åœ¨Semaphoreä¸­ï¼Œâ€œéå…¬å¹³ä¿¡å·é‡è®¸å¯çš„é‡Šæ”¾(release)â€ä¸â€œå…¬å¹³ä¿¡å·é‡è®¸å¯çš„é‡Šæ”¾(release)â€æ˜¯ä¸€æ ·çš„ã€‚ä¸åŒçš„æ˜¯å®ƒä»¬è·å–â€œä¿¡å·é‡è®¸å¯â€çš„æœºåˆ¶ä¸åŒï¼Œè¯´æ˜ï¼šéå…¬å¹³ä¿¡å·é‡çš„tryAcquireShared()è°ƒç”¨AQSä¸­çš„nonfairTryAcquireShared()ã€‚è€Œåœ¨nonfairTryAcquireShared()çš„forå¾ªç¯ä¸­ï¼Œå®ƒéƒ½ä¼šç›´æ¥åˆ¤æ–­â€œå½“å‰å‰©ä½™çš„ä¿¡å·é‡è®¸å¯æ•°â€æ˜¯å¦è¶³å¤Ÿï¼›è¶³å¤Ÿçš„è¯ï¼Œåˆ™ç›´æ¥â€œè®¾ç½®å¯ä»¥è·å¾—çš„ä¿¡å·é‡è®¸å¯æ•°â€ï¼Œè¿›è€Œå†è·å–ä¿¡å·é‡ã€‚è€Œå…¬å¹³ä¿¡å·é‡çš„tryAcquireShared()ä¸­ï¼Œåœ¨è·å–ä¿¡å·é‡ä¹‹å‰ä¼šé€šè¿‡if (hasQueuedPredecessors())æ¥åˆ¤æ–­â€œå½“å‰çº¿ç¨‹æ˜¯ä¸æ˜¯åœ¨CLHé˜Ÿåˆ—çš„å¤´éƒ¨â€ï¼Œæ˜¯çš„è¯ï¼Œåˆ™è¿”å›-1ã€‚ Semaphoreç¤ºä¾‹12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849import java.util.concurrent.ExecutorService; import java.util.concurrent.Executors; import java.util.concurrent.Semaphore; public class SemaphoreTest1 {     private static final int SEM_MAX = 10;    public static void main(String[] args) {         Semaphore sem = new Semaphore(SEM_MAX);        //åˆ›å»ºçº¿ç¨‹æ±         ExecutorService threadPool = Executors.newFixedThreadPool(3);        //åœ¨çº¿ç¨‹æ± ä¸­æ‰§è¡Œä»»åŠ¡        threadPool.execute(new MyThread(sem, 5));        threadPool.execute(new MyThread(sem, 4));        threadPool.execute(new MyThread(sem, 7));        //å…³é—­æ±         threadPool.shutdown();    }}class MyThread extends Thread {    private volatile Semaphore sem;    // ä¿¡å·é‡    private int count;        // ç”³è¯·ä¿¡å·é‡çš„å¤§å°     MyThread(Semaphore sem, int count) {        this.sem = sem;        this.count = count;    }    public void run() {        try {            // ä»ä¿¡å·é‡ä¸­è·å–countä¸ªè®¸å¯            sem.acquire(count);            Thread.sleep(2000);            System.out.println(Thread.currentThread().getName() + &quot; acquire count=&quot;+count);        } catch (InterruptedException e) {            e.printStackTrace();        } finally {            // é‡Šæ”¾ç»™å®šæ•°ç›®çš„è®¸å¯ï¼Œå°†å…¶è¿”å›åˆ°ä¿¡å·é‡ã€‚            sem.release(count);            System.out.println(Thread.currentThread().getName() + &quot; release &quot; + count + &quot;&quot;);        }    }}(æŸä¸€æ¬¡)è¿è¡Œç»“æœï¼špool-1-thread-1 acquire count=5pool-1-thread-2 acquire count=4pool-1-thread-1 release 5pool-1-thread-2 release 4pool-1-thread-3 acquire count=7pool-1-thread-3 release 7ç»“æœè¯´æ˜ï¼šä¿¡å·é‡semçš„è®¸å¯æ€»æ•°æ˜¯10ä¸ªï¼›å…±3ä¸ªçº¿ç¨‹ï¼Œåˆ†åˆ«éœ€è¦è·å–çš„ä¿¡å·é‡è®¸å¯æ•°æ˜¯5,4,7ã€‚å‰é¢ä¸¤ä¸ªçº¿ç¨‹è·å–åˆ°ä¿¡å·é‡çš„è®¸å¯åï¼Œsemä¸­å‰©ä½™çš„å¯ç”¨çš„è®¸å¯æ•°æ˜¯1ï¼›å› æ­¤ï¼Œæœ€åä¸€ä¸ªçº¿ç¨‹å¿…é¡»ç­‰å‰ä¸¤ä¸ªçº¿ç¨‹é‡Šæ”¾äº†å®ƒä»¬æ‰€æŒæœ‰çš„ä¿¡å·é‡è®¸å¯ä¹‹åï¼Œæ‰èƒ½è·å–åˆ°7ä¸ªä¿¡å·é‡è®¸å¯ã€‚</content>
	</entry>
	<entry>
		<title>pythonå¼‚æ­¥ç¼–ç¨‹</title>
		<url>/article/49959.html</url>
		<content>åŸºç¡€æ¦‚å¿µpython3 asyncioå®˜æ–¹æ–‡æ¡£ä¸­æ–‡ç‰ˆasyncio â€”- å¼‚æ­¥ I/O2å°æ—¶å­¦ä¼špython asyncioã€èŠ±39å¤§æ´‹ä¹°çš„è¯¾ç¨‹ã€‘Pythonè¿›ç¨‹ã€çº¿ç¨‹å’Œåç¨‹å®æˆ˜æŒ‡å½’å¼‚æ­¥ç¼–ç¨‹åŸºæœ¬æ¦‚å¿µpythonâ€”-å¼‚æ­¥IO(asyncio)åç¨‹Pythoné»‘é­”æ³• â€”- å¼‚æ­¥IO(asyncio)åç¨‹pythonåç¨‹ç³»åˆ—ï¼ˆå…­ï¼‰â€”â€”asyncioçš„EventLoopä»¥åŠFutureè¯¦è§£pythonåç¨‹ç³»åˆ—ï¼ˆä¸ƒï¼‰â€”â€”asyncioç»“åˆå¤šçº¿ç¨‹è§£å†³é˜»å¡é—®é¢˜ä»¥åŠtimeræ¨¡æ‹Ÿasyncio â€”â€” å¼‚æ­¥I/Oã€äº‹ä»¶å¾ªç¯ã€åç¨‹å’Œä»»åŠ¡pythonåç¨‹ä¸å¼‚æ­¥åç¨‹[è¿›é˜¶]-Python3 å¼‚æ­¥ç¼–ç¨‹è¯¦è§£ï¼ˆå²ä¸Šæœ€å…¨ç¯‡ï¼‰pythonå¤šçº¿ç¨‹ã€å¤šè¿›ç¨‹ã€åç¨‹çš„ä½¿ç”¨Pythonå¼‚æ­¥IOä¹‹åç¨‹(ä¸€): ä»yield fromåˆ°asyncçš„ä½¿ç”¨pythonå¼‚æ­¥ç¼–ç¨‹æ¨¡å—asyncioå­¦ä¹ (ä¸€)pythonå¼‚æ­¥ç¼–ç¨‹æ¨¡å—asyncioå­¦ä¹ (äºŒ)Pythonä¸­åç¨‹å¼‚æ­¥IOï¼ˆasyncioï¼‰è¯¦è§£ç†è§£ Python ä¸­çš„å¼‚æ­¥ç¼–ç¨‹Pythonå¼‚æ­¥ç¼–ç¨‹æ¨¡å—asyncioå­¦ä¹  !æ­¤æ¨¡å—éå¸¸ä¹‹é‡è¦!å¸¦ä½ ç®€å•äº†è§£pythonåç¨‹å’Œå¼‚æ­¥è¿›ç¨‹ã€çº¿ç¨‹å’Œåç¨‹çº¿ç¨‹æ˜¯å¹¶å‘ï¼Œè¿›ç¨‹æ˜¯å¹¶è¡Œï¼›è¿›ç¨‹ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œæ˜¯ç³»ç»Ÿåˆ†é…èµ„æºçš„æœ€å°å•ä½ï¼ŒåŒä¸€ä¸ªè¿›ç¨‹ä¸­çš„æ‰€æœ‰çº¿ç¨‹å…±äº«èµ„æºè¿›ç¨‹æ‹¥æœ‰è‡ªå·±çš„å†…å­˜ç©ºé—´ï¼Œæ‰€ä»¥è¿›ç¨‹é—´æ•°æ®ä¸å…±äº«ï¼Œå¼€é”€å¤§ã€‚çº¿ç¨‹ï¼šè°ƒåº¦æ‰§è¡Œçš„æœ€å°å•ä½ï¼Œä¹Ÿå«æ‰§è¡Œè·¯å¾„ï¼Œä¸èƒ½ç‹¬ç«‹å­˜åœ¨ï¼Œä¾èµ–è¿›ç¨‹çš„å­˜åœ¨è€Œå­˜åœ¨ä¸€ä¸ªè¿›ç¨‹è‡³å°‘æœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œå«ä¸»çº¿ç¨‹ï¼Œå¤šä¸ªçº¿ç¨‹å…±äº«å†…å­˜ï¼ˆæ•°æ®å…±äº«å’Œå…¨å±€å˜é‡ï¼‰ï¼Œå› æ­¤æå‡ç¨‹åºçš„è¿è¡Œæ•ˆç‡ã€‚åç¨‹ï¼šç”¨æˆ·æ€çš„è½»é‡çº§çº¿ç¨‹ï¼Œè°ƒåº¦æœ‰ç”¨æˆ·æ§åˆ¶ï¼Œæ‹¥æœ‰è‡ªå·±çš„å¯„å­˜å™¨ä¸Šä¸‹æ–‡å’Œæ ˆï¼Œåˆ‡æ¢åŸºæœ¬æ²¡æœ‰å†…æ ¸åˆ‡æ¢çš„å¼€é”€ï¼Œåˆ‡æ¢çµæ´»ã€‚è¿›ç¨‹è¿›ç¨‹æœ€å¤§ä¼˜åŠ¿æ˜¯å¯ä»¥å……åˆ†ä¾‹ç”¨è®¡ç®—èµ„æºä½¿ç”¨è¿›ç¨‹å¤„ç†è®¡ç®—å¯†é›†å‹ä»»åŠ¡ï¼šå› ä¸ºä¸åŒçš„è¿›ç¨‹å¯ä»¥è¿è¡Œçš„ä¸åŒCPUçš„ä¸åŒçš„æ ¸ä¸Šå‡å¦‚ä¸€å°è®¡ç®—æœºçš„CPUå…±æœ‰16æ ¸ï¼Œåˆ™å¯ä»¥å¯åŠ¨16ä¸ªæˆ–æ›´å¤šä¸ªè¿›ç¨‹æ¥å¹¶è¡Œå¤„ç†ä»»åŠ¡ä½¿ç”¨å•ä¸ªçº¿ç¨‹æˆ–ä¸¤ä¸ªçº¿ç¨‹çš„æ—¶å€™ï¼Œè€—æ—¶å¤§çº¦30+ç§’ï¼Œæ”¹ç”¨ä¸¤ä¸ªè¿›ç¨‹åï¼Œè€—æ—¶17.786ç§’ï¼Œå·®ä¸å¤šå¿«äº†ä¸€å€å¦‚æœä½¿ç”¨4ä¸ªè¿›ç¨‹ï¼ˆå‰ææ˜¯è¿è¡Œçš„ä»£ç çš„è®¡ç®—æœºè‡³å°‘æœ‰4ä¸ªCPUæ ¸ï¼‰çš„è¯ï¼Œé€Ÿåº¦è¿˜èƒ½æé«˜ä¸€å€å¯¹äºè®¡ç®—å¯†é›†å‹çš„ä»»åŠ¡ï¼Œä½¿ç”¨å¤šè¿›ç¨‹å¹¶è¡Œå¤„ç†æ˜¯æœ‰æ•ˆçš„æé€Ÿæ‰‹æ®µï¼Œé€šå¸¸ï¼Œè¿›ç¨‹æ•°é‡é€‰æ‹©CPUæ ¸æ•°çš„æ•´å€æ•°è¿›ç¨‹é€šä¿¡çº¿ç¨‹é—´é€šä¿¡å¯ä»¥ä½¿ç”¨é˜Ÿåˆ—ã€äº’æ–¥é”ã€ä¿¡å·é‡ã€äº‹ä»¶å’Œæ¡ä»¶ç­‰å¤šç§åŒæ­¥æ–¹å¼ï¼ŒåŒæ ·çš„ï¼Œè¿™äº›æ‰‹æ®µä¹Ÿå¯ä»¥åº”ç”¨åœ¨è¿›ç¨‹é—´æ­¤å¤–ï¼Œmultiprocessing æ¨¡å—è¿˜æä¾›äº†ç®¡é“å’Œå…±äº«å†…å­˜ç­‰è¿›ç¨‹é—´é€šä¿¡çš„æ‰‹æ®µã€‚è¿›ç¨‹æ± ä½¿ç”¨å¤šè¿›ç¨‹å¹¶è¡Œå¤„ç†ä»»åŠ¡æ—¶ï¼Œå¤„ç†æ•ˆç‡å’Œè¿›ç¨‹æ•°é‡å¹¶ä¸æ€»æ˜¯æˆæ­£æ¯”ï¼Œå½“è¿›ç¨‹æ•°é‡è¶…è¿‡ä¸€å®šé™åº¦åï¼Œå®Œæˆä»»åŠ¡æ‰€éœ€æ—¶é—´åè€Œä¼šå»¶é•¿è¿›ç¨‹æ± æä¾›äº†ä¸€ä¸ªä¿æŒåˆç†è¿›ç¨‹æ•°é‡çš„æ–¹æ¡ˆï¼Œä½†åˆç†è¿›ç¨‹æ•°é‡éœ€è¦æ ¹æ®ç¡¬ä»¶çŠ¶å†µåŠè¿è¡ŒçŠ¶å†µæ¥ç¡®å®šï¼Œé€šå¸¸è®¾ç½®ä¸º CPU çš„æ ¸æ•°multiprocessing.Pool(n) å¯åˆ›å»º n ä¸ªè¿›ç¨‹çš„è¿›ç¨‹æ± ä¾›ç”¨æˆ·è°ƒç”¨å¦‚æœè¿›ç¨‹æ± ä»»åŠ¡ä¸æ»¡ï¼Œåˆ™æ–°çš„è¿›ç¨‹è¯·æ±‚ä¼šè¢«ç«‹å³æ‰§è¡Œï¼›å¦‚æœè¿›ç¨‹æ± ä»»åŠ¡å·²æ»¡ï¼Œåˆ™æ–°çš„è¯·æ±‚å°†ç­‰å¾…è‡³æœ‰å¯ç”¨è¿›ç¨‹æ—¶æ‰è¢«æ‰§è¡Œå‘è¿›ç¨‹æ± æäº¤ä»»åŠ¡æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼apply_async(func[, args[, kwds[, callback]]]) ï¼šéé˜»å¡å¼æäº¤ã€‚å³ä½¿è¿›ç¨‹æ± å·²æ»¡ï¼Œä¹Ÿä¼šæ¥å—æ–°çš„ä»»åŠ¡ï¼Œä¸ä¼šé˜»å¡ä¸»è¿›ç¨‹æ–°ä»»åŠ¡å°†å¤„äºç­‰å¾…çŠ¶æ€apply(func[, args[, kwds]]) ï¼šé˜»å¡å¼æäº¤ã€‚è‹¥è¿›ç¨‹æ± å·²æ»¡ï¼Œåˆ™ä¸»è¿›ç¨‹é˜»å¡ï¼Œç›´è‡³æœ‰ç©ºé—²è¿›ç¨‹å¯ä»¥ä½¿ç”¨çº¿ç¨‹çº¿ç¨‹çš„æœ€å¤§æ„ä¹‰åœ¨äºå¹¶è¡Œä½¿ç”¨çº¿ç¨‹å¤„ç†IOå¯†é›†å‹ä»»åŠ¡ï¼šå¯¹äºIOå¯†é›†å‹ï¼ˆæœ¬ä¾‹ä»…æµ‹è¯•ç½‘ç»œIOï¼Œæ²¡æœ‰ç£ç›˜IOï¼‰çš„ä»»åŠ¡ï¼Œé€‚é‡çš„çº¿ç¨‹å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šæé«˜å¤„ç†é€Ÿåº¦éšç€çº¿ç¨‹æ•°é‡çš„å¢åŠ ï¼Œé€Ÿåº¦çš„æå‡ä¸å†æ˜æ˜¾ä½¿ç”¨çº¿ç¨‹å¤„ç†**è®¡ç®—å¯†é›†å‹**ä»»åŠ¡: å¯¹ä¸€å¼ åƒä¸‡çº§åƒç´ çš„ç…§ç‰‡åšä½ç«¯å¢å¼ºï¼Œå€ŸåŠ©äºNumPyçš„å¹¿æ’­å’ŒçŸ¢é‡åŒ–è®¡ç®—ï¼Œè€—æ—¶0.38ç§’é’Ÿï¼›å•çº¿ç¨‹é€åƒç´ å¤„ç†çš„è¯ï¼Œè€—æ—¶ç›¸å½“äºNumPyçš„100å€ï¼›å¯ç”¨å¤šçº¿ç¨‹çš„è¯ï¼Œé€Ÿåº¦ä¸ä»…æ²¡æœ‰åŠ å¿«ï¼Œåå€’æ˜¯æ¯”å•çº¿ç¨‹æ›´æ…¢è¿™è¯´æ˜ï¼Œå¯¹äºè®¡ç®—å¯†é›†å‹çš„ä»»åŠ¡æ¥è¯´ï¼Œå¤šçº¿ç¨‹å¹¶ä¸èƒ½æé«˜å¤„ç†é€Ÿåº¦ï¼Œç›¸åï¼Œå› ä¸ºè¦åˆ›å»ºå’Œç®¡ç†çº¿ç¨‹ï¼Œå¤„ç†é€Ÿåº¦ä¼šæ›´æ…¢ä¸€äº›çº¿ç¨‹æ± å°½ç®¡å¤šçº¿ç¨‹å¯ä»¥å¹¶è¡Œå¤„ç†å¤šä¸ªä»»åŠ¡ï¼Œä½†å¼€å¯çº¿ç¨‹ä¸ä»…èŠ±è´¹æ—¶é—´ï¼Œä¹Ÿéœ€è¦å ç”¨ç³»ç»Ÿèµ„æºå› æ­¤ï¼Œçº¿ç¨‹æ•°é‡ä¸æ˜¯è¶Šå¤šè¶Šå¿«ï¼Œè€Œæ˜¯è¦ä¿æŒåœ¨åˆç†çš„æ°´å¹³ä¸Šçº¿ç¨‹æ± å¯ä»¥è®©æˆ‘ä»¬ç”¨å›ºå®šæ•°é‡çš„çº¿ç¨‹å®Œæˆæ¯”çº¿ç¨‹æ•°é‡å¤šå¾—å¤šçš„ä»»åŠ¡åç¨‹è°ˆè°ˆPythonåç¨‹æŠ€æœ¯çš„æ¼”è¿›æ¦‚å¿µçº¿ç¨‹å¸¸ç”¨äºå¤šä»»åŠ¡å¹¶è¡Œã€‚å¯¹äºå¯ä»¥åˆ‡åˆ†çš„IOå¯†é›†å‹ä»»åŠ¡ï¼Œå°†åˆ‡åˆ†çš„æ¯ä¸€å°å—ä»»åŠ¡åˆ†é…ç»™ä¸€ä¸ªçº¿ç¨‹ï¼Œå¯ä»¥æ˜¾è‘—æé«˜å¤„ç†é€Ÿåº¦è€Œåç¨‹ï¼Œæ— è®ºæœ‰å¤šå°‘ä¸ªï¼Œéƒ½è¢«**é™å®šåœ¨ä¸€ä¸ªçº¿ç¨‹å†…æ‰§è¡Œ**ï¼Œå› æ­¤ï¼Œåç¨‹åˆè¢«ç§°ä¸º**å¾®çº¿ç¨‹**ä»å®è§‚ä¸Šçœ‹ï¼Œçº¿ç¨‹ä»»åŠ¡å’Œåç¨‹ä»»åŠ¡éƒ½æ˜¯å¹¶è¡Œçš„ä»å¾®è§‚ä¸Šçœ‹ï¼Œçº¿ç¨‹ä»»åŠ¡æ˜¯åˆ†æ—¶åˆ‡ç‰‡è½®æµæ‰§è¡Œçš„ï¼Œè¿™ç§åˆ‡æ¢æ˜¯ç³»ç»Ÿè‡ªåŠ¨å®Œæˆçš„ï¼Œæ— éœ€ç¨‹åºå‘˜å¹²é¢„è€Œåç¨‹åˆ™æ˜¯æ ¹æ®ä»»åŠ¡ç‰¹ç‚¹ï¼Œåœ¨ä»»åŠ¡é˜»å¡æ—¶å°†æ§åˆ¶æƒäº¤ç»™å…¶ä»–åç¨‹ï¼Œè¿™ä¸ªæƒåŠ›äº¤æ¥çš„æ—¶æœºå’Œä½ç½®ï¼Œç”±ç¨‹åºå‘˜æŒ‡å®šå‚ä¸åç¨‹ç®¡ç†çš„æ¯ä¸€ä¸ªä»»åŠ¡ï¼Œå¿…é¡»å­˜åœ¨é˜»å¡çš„å¯èƒ½ï¼Œä¸”é˜»å¡æ¡ä»¶ä¼šè¢«å…¶å®ƒä»»åŠ¡ç ´åï¼Œä»è€Œå¾—ä»¥åœ¨é˜»å¡è§£é™¤åç»§ç»­æ‰§è¡Œå°½ç®¡åç¨‹éš¾ä»¥é©¾é©­ï¼Œä½†æ˜¯ç”±äºæ˜¯åœ¨ä¸€ä¸ªçº¿ç¨‹å†…è¿è¡Œï¼Œå…é™¤äº†çº¿ç¨‹æˆ–è¿›ç¨‹çš„åˆ‡æ¢å¼€é”€ï¼Œå› è€Œåç¨‹çš„è¿è¡Œæ•ˆç‡é«˜ï¼Œåœ¨ç‰¹å®šåœºåˆä¸‹ä»ç„¶è¢«å¹¿æ³›ä½¿ç”¨ã€‚åç¨‹æ¼”è¿›å²Py2æ—¶ä»£ï¼ŒPythonå¹¶ä¸æ”¯æŒåç¨‹ï¼Œä»…å¯é€šè¿‡yieldå®ç°éƒ¨åˆ†çš„åç¨‹åŠŸèƒ½å¦å¤–å¯ä»¥é€šè¿‡geventç­‰ç¬¬ä¸‰æ–¹åº“å®ç°åç¨‹ï¼Œgeventæœ€å¥½ç©çš„ï¼Œè«è¿‡äºmonkey_patch(çŒ´å­è¡¥ä¸)Py3.4å¼€å§‹ï¼ŒPythonå†…ç½®asyncioæ ‡å‡†åº“ï¼Œæ­£å¼åŸç”Ÿæ”¯æŒåç¨‹asyncioçš„å¼‚æ­¥æ“ä½œï¼Œéœ€è¦åœ¨åç¨‹ä¸­é€šè¿‡yield fromå®Œæˆï¼Œåç¨‹å‡½æ•°åˆ™éœ€è¦ä½¿ç”¨@asyncio.coroutineè£…é¥°å™¨ä¸ºäº†æ›´è´´è¿‘äººç±»æ€ç»´ï¼ŒPy3.5å¼•å…¥äº†æ–°çš„è¯­æ³•asyncå’Œawaitï¼Œå¯ä»¥è®©åç¨‹çš„ä»£ç ç¨å¾®æ˜“æ‡‚ä¸€ç‚¹ç‚¹æœ¬è´¨ä¸Šï¼Œasyncå°±æ˜¯@asyncio.coroutineï¼Œæ›¿æ¢ä¸ºawaitå°±æ˜¯yield fromï¼Œæ¢ä¸ªé©¬ç”²ï¼Œçœ‹èµ·æ¥å°±é¡ºçœ¼å¤šäº†ä¸‰è€…å…³ç³»ä½¿ç”¨åœºæ™¯è®¡ç®—å¯†é›†å‹(CPUæ“ä½œæŒ‡ä»¤æ¯”è¾ƒå¤šï¼Œå¦‚ç§‘å­¦è®¡ç®—ï¼Œä½æ•°å¤šçš„æµ®ç‚¹è¿ç®—)* è€ƒè™‘å¯ä»¥ä½¿ç”¨å¤šæ ¸ CPUï¼Œä½¿ç”¨å¤šè¿›ç¨‹I/Oå¯†é›†å‹(è¯»å†™æ•°æ®æ“ä½œè¾ƒå¤šçš„ï¼Œæ¯”å¦‚çˆ¬è™«)* I/Oè¯·æ±‚æ¯”è¾ƒè€—æ—¶çš„è¯ï¼Œä½¿ç”¨åç¨‹* I/Oè¯·æ±‚æ¯”è¾ƒå¿«çš„è¯ï¼Œä½¿ç”¨å¤šçº¿ç¨‹åç¨‹å’Œå¤šçº¿ç¨‹å¼‚åŒç‚¹æ¯”è¾ƒå…±åŒç‚¹ï¼šéƒ½æ˜¯å¹¶å‘æ“ä½œï¼Œå¤šçº¿ç¨‹åŒä¸€æ—¶é—´ç‚¹åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œï¼Œåç¨‹åŒä¸€æ—¶é—´ç‚¹åªèƒ½æœ‰ä¸€ä¸ªä»»åŠ¡åœ¨æ‰§è¡Œä¸åŒç‚¹ï¼šå¤šçº¿ç¨‹ï¼Œæ˜¯åœ¨I/Oé˜»å¡æ—¶é€šè¿‡åˆ‡æ¢çº¿ç¨‹æ¥è¾¾åˆ°å¹¶å‘çš„æ•ˆæœåœ¨ä»€ä¹ˆæƒ…å†µä¸‹åšçº¿ç¨‹åˆ‡æ¢æ˜¯ç”±æ“ä½œç³»ç»Ÿæ¥å†³å®šçš„ï¼Œå¼€å‘è€…ä¸ç”¨æ“å¿ƒï¼Œä½†ä¼šé€ æˆç«äº‰æ¡ä»¶ (race condition) åç¨‹ï¼Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œåœ¨I/Oé˜»å¡æ—¶é€šè¿‡åœ¨çº¿ç¨‹å†…åˆ‡æ¢ä»»åŠ¡æ¥è¾¾åˆ°å¹¶å‘çš„æ•ˆæœåœ¨ä»€ä¹ˆæƒ…å†µä¸‹åšä»»åŠ¡åˆ‡æ¢æ˜¯å¼€å‘è€…å†³å®šçš„ï¼Œä¸ä¼šæœ‰ç«äº‰æ¡ä»¶ (race condition) çš„æƒ…å†µå¤šçº¿ç¨‹çš„çº¿ç¨‹åˆ‡æ¢æ¯”åç¨‹çš„ä»»åŠ¡åˆ‡æ¢å¼€é”€æ›´å¤§å¯¹äºå¼€å‘è€…è€Œè¨€ï¼Œå¤šçº¿ç¨‹å¹¶å‘çš„ä»£ç æ¯”åç¨‹å¹¶å‘çš„æ›´å®¹æ˜“ä¹¦å†™ï¼Œä¸€èˆ¬æƒ…å†µä¸‹åç¨‹å¹¶å‘çš„å¤„ç†æ•ˆç‡æ¯”å¤šçº¿ç¨‹å¹¶å‘æ›´é«˜psï¼šå¯¹ç¬¬ä¸€ç‚¹å’Œç¬¬äºŒç‚¹è¡¥å……å¯¹äºioé˜»å¡çš„æ“ä½œï¼Œåç¨‹ç›¸è¾ƒäºçº¿ç¨‹ï¼Œèƒ½æ›´ç²¾ç¡®çš„è·å–ï¼ˆæˆ–è€…é‡Šæ”¾ï¼‰å¯¹èµ„æºçš„æ§åˆ¶æƒè¿™æ˜¯å› ä¸ºç”¨æˆ·å±‚ç›¸è¾ƒäºè¯­è¨€å±‚ï¼Œç”¨æˆ·å±‚èƒ½æ›´å¥½çš„æ„ŸçŸ¥ç‰¹å®šæ“ä½œçš„æ—¶æœºå¯¹äºéioé˜»å¡çš„æ“ä½œï¼Œçº¿ç¨‹ç›¸è¾ƒäºåç¨‹ï¼Œèƒ½æ›´å…¬å¹³çš„åˆ†é…å¯¹èµ„æºçš„æ§åˆ¶æƒè¿™æ˜¯å› ä¸ºè¯­è¨€å±‚ç›¸è¾ƒäºç”¨æˆ·å±‚ï¼Œè¯­è¨€å±‚èƒ½æ›´å¥½çš„æ„ŸçŸ¥åˆ°å¤šä¸ªçº¿ç¨‹çš„è¿è¡ŒçŠ¶æ€å¹¶åœ¨æŒæ¡æ›´å¤šä¿¡æ¯çš„å‰æä¸‹ï¼ˆçº¿ç¨‹è¿è¡Œçš„å­—èŠ‚ç å’Œæ—¶é•¿ï¼‰ï¼Œè¿›è¡Œæ›´åŠ åˆç†çš„GILçš„è·å–å’Œé‡Šæ”¾é˜»å¡å’Œéé˜»å¡é˜»å¡ç¨‹åºæœªå¾—åˆ°æ‰€éœ€è®¡ç®—èµ„æºæ—¶è¢«æŒ‚èµ·çš„çŠ¶æ€ç¨‹åºåœ¨ç­‰å¾…æŸä¸ªæ“ä½œå®ŒæˆæœŸé—´ï¼Œè‡ªèº«æ— æ³•ç»§ç»­å¹²åˆ«çš„äº‹æƒ…ï¼Œç§°ç¨‹åºåœ¨è¯¥æ“ä½œä¸Šæ˜¯é˜»å¡çš„å¸¸è§çš„é˜»å¡å½¢å¼æœ‰ï¼šç½‘ç»œI/Oé˜»å¡ã€ç£ç›˜I/Oé˜»å¡ã€ç”¨æˆ·è¾“å…¥é˜»å¡ç­‰é˜»å¡æ˜¯æ— å¤„ä¸åœ¨çš„ï¼ŒåŒ…æ‹¬CPUåˆ‡æ¢ä¸Šä¸‹æ–‡æ—¶ï¼Œæ‰€æœ‰çš„è¿›ç¨‹éƒ½æ— æ³•çœŸæ­£å¹²äº‹æƒ…ï¼Œå®ƒä»¬ä¹Ÿä¼šè¢«é˜»å¡ï¼ˆå¦‚æœæ˜¯å¤šæ ¸CPUåˆ™æ­£åœ¨æ‰§è¡Œä¸Šä¸‹æ–‡åˆ‡æ¢æ“ä½œçš„æ ¸ä¸å¯è¢«åˆ©ç”¨ï¼‰éé˜»å¡ç¨‹åºåœ¨ç­‰å¾…æŸæ“ä½œè¿‡ç¨‹ä¸­ï¼Œè‡ªèº«ä¸è¢«é˜»å¡ï¼Œå¯ä»¥ç»§ç»­è¿è¡Œå¹²åˆ«çš„äº‹æƒ…ï¼Œåˆ™ç§°è¯¥ç¨‹åºåœ¨è¯¥æ“ä½œä¸Šæ˜¯éé˜»å¡çš„éé˜»å¡å¹¶ä¸æ˜¯åœ¨ä»»ä½•ç¨‹åºçº§åˆ«ã€ä»»ä½•æƒ…å†µä¸‹éƒ½å¯ä»¥å­˜åœ¨çš„ä»…å½“ç¨‹åºå°è£…çš„çº§åˆ«å¯ä»¥å›Šæ‹¬ç‹¬ç«‹çš„å­ç¨‹åºå•å…ƒæ—¶ï¼Œå®ƒæ‰å¯èƒ½å­˜åœ¨éé˜»å¡çŠ¶æ€éé˜»å¡çš„å­˜åœ¨æ˜¯å› ä¸ºé˜»å¡å­˜åœ¨ï¼Œæ­£å› ä¸ºæŸä¸ªæ“ä½œé˜»å¡å¯¼è‡´çš„è€—æ—¶ä¸æ•ˆç‡ä½ä¸‹ï¼Œæˆ‘ä»¬æ‰è¦æŠŠå®ƒå˜æˆéé˜»å¡çš„å¼‚æ­¥å’ŒåŒæ­¥åŒæ­¥ä¸åŒç¨‹åºå•å…ƒä¸ºäº†å®ŒæˆæŸä¸ªä»»åŠ¡ï¼Œåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­éœ€é æŸç§é€šä¿¡æ–¹å¼ä»¥åè°ƒä¸€è‡´ï¼Œç§°è¿™äº›ç¨‹åºå•å…ƒæ˜¯åŒæ­¥æ‰§è¡Œçš„ä¾‹å¦‚è´­ç‰©ç³»ç»Ÿä¸­æ›´æ–°å•†å“åº“å­˜ï¼Œéœ€è¦ç”¨â€œè¡Œé”â€ä½œä¸ºé€šä¿¡ä¿¡å·ï¼Œè®©ä¸åŒçš„æ›´æ–°è¯·æ±‚å¼ºåˆ¶æ’é˜Ÿé¡ºåºæ‰§è¡Œï¼Œé‚£æ›´æ–°åº“å­˜çš„æ“ä½œæ˜¯åŒæ­¥çš„ç®€è¨€ä¹‹ï¼ŒåŒæ­¥æ„å‘³ç€æœ‰åºå¼‚æ­¥ä¸ºå®ŒæˆæŸä¸ªä»»åŠ¡ï¼Œä¸åŒç¨‹åºå•å…ƒä¹‹é—´è¿‡ç¨‹ä¸­æ— éœ€é€šä¿¡åè°ƒï¼Œä¹Ÿèƒ½å®Œæˆä»»åŠ¡çš„æ–¹å¼ä¸ç›¸å…³çš„ç¨‹åºå•å…ƒä¹‹é—´å¯ä»¥æ˜¯å¼‚æ­¥çš„ä¾‹å¦‚ï¼Œçˆ¬è™«ä¸‹è½½ç½‘é¡µã€‚è°ƒåº¦ç¨‹åºè°ƒç”¨ä¸‹è½½ç¨‹åºåï¼Œå³å¯è°ƒåº¦å…¶ä»–ä»»åŠ¡ï¼Œè€Œæ— éœ€ä¸è¯¥ä¸‹è½½ä»»åŠ¡ä¿æŒé€šä¿¡ä»¥åè°ƒè¡Œä¸ºä¸åŒç½‘é¡µçš„ä¸‹è½½ã€ä¿å­˜ç­‰æ“ä½œéƒ½æ˜¯æ— å…³çš„ï¼Œä¹Ÿæ— éœ€ç›¸äº’é€šçŸ¥åè°ƒã€‚è¿™äº›å¼‚æ­¥æ“ä½œçš„å®Œæˆæ—¶åˆ»å¹¶ä¸ç¡®å®šç®€è¨€ä¹‹ï¼Œå¼‚æ­¥æ„å‘³ç€æ— åºå½“ä¸€ä¸ªå¼‚æ­¥è¿‡ç¨‹è°ƒç”¨å‘å‡ºåï¼Œè°ƒç”¨è€…åœ¨æ²¡æœ‰å¾—åˆ°ç»“æœä¹‹å‰ï¼Œå°±å¯ä»¥ç»§ç»­æ‰§è¡Œåç»­æ“ä½œå½“è¿™ä¸ªè°ƒç”¨å®Œæˆåï¼Œä¸€èˆ¬é€šè¿‡çŠ¶æ€ã€é€šçŸ¥å’Œå›è°ƒæ¥é€šçŸ¥è°ƒç”¨è€…å¯¹äºå¼‚æ­¥è°ƒç”¨ï¼Œè°ƒç”¨çš„è¿”å›å¹¶ä¸å—è°ƒç”¨è€…æ§åˆ¶å¯¹äºé€šçŸ¥è°ƒç”¨è€…çš„ä¸‰ç§æ–¹å¼çŠ¶æ€ï¼šå³ç›‘å¬è¢«è°ƒç”¨è€…çš„çŠ¶æ€(è½®è¯¢)ï¼Œè°ƒç”¨è€…éœ€è¦æ¯éš”ä¸€å®šæ—¶é—´æ£€æŸ¥ä¸€æ¬¡ï¼Œæ•ˆç‡ä¼šå¾ˆä½é€šçŸ¥ï¼šå½“è¢«è°ƒç”¨è€…æ‰§è¡Œå®Œæˆåï¼Œå‘å‡ºé€šçŸ¥å‘ŠçŸ¥è°ƒç”¨è€…ï¼Œæ— éœ€æ¶ˆè€—å¤ªå¤šæ€§èƒ½å›è°ƒï¼šä¸é€šçŸ¥ç±»ä¼¼ï¼Œå½“è¢«è°ƒç”¨è€…æ‰§è¡Œå®Œæˆåï¼Œä¼šè°ƒç”¨è°ƒç”¨è€…æä¾›çš„å›è°ƒå‡½æ•°å¹¶è¡Œå’Œå¹¶å‘å¹¶å‘(å¤šçº¿ç¨‹)ä»»åŠ¡ç‰¹ç‚¹ï¼šIOå¯†é›†å‹ä»»åŠ¡ï¼šä»»åŠ¡åŒ…å«é¢‘ç¹çš„ã€æŒç»­çš„ç½‘ç»œIOå’Œç£ç›˜IOå•ä¸ªCPUï¼ˆä¹Ÿå¯ä»¥å¤šä¸ªCPUï¼‰å°†å¤šä¸ªçº¿ç¨‹ä¸­çš„æ¯ä¸ªçº¿ç¨‹ï¼ˆå¤šä¸ªè¿›ç¨‹ä¸­çš„æ¯ä¸ªè¿›ç¨‹ï¼‰æŒ‰æ—¶é—´åˆ†ä¸ºä¸€ä¸ªä¸€ä¸ªçš„æ—¶é—´ç‰‡æ¯ä¸€ä¸ªæ—¶åˆ»åªæ‰§è¡ŒæŸä¸ªçº¿ç¨‹ï¼ˆè¿›ç¨‹ï¼‰çš„æ—¶é—´ç‰‡ï¼Œæ—¶é—´ç‰‡è¿‡æœŸåè½¬è€Œæ‰§è¡Œä¸‹ä¸€ä¸ªçº¿ç¨‹ï¼ˆè¿›ç¨‹ï¼‰çš„æ—¶é—´ç‰‡å¹¶å‘æè¿°çš„æ˜¯ç¨‹åºçš„ç»„ç»‡ç»“æ„ã€‚æŒ‡ç¨‹åºè¦è¢«è®¾è®¡æˆå¤šä¸ªå¯ç‹¬ç«‹æ‰§è¡Œçš„å­ä»»åŠ¡ä»¥åˆ©ç”¨æœ‰é™çš„è®¡ç®—æœºèµ„æºä½¿å¤šä¸ªä»»åŠ¡å¯ä»¥è¢«å®æ—¶æˆ–è¿‘å®æ—¶æ‰§è¡Œä¸ºç›®çš„å¹¶å‘æä¾›äº†ä¸€ç§ç¨‹åºç»„ç»‡ç»“æ„æ–¹å¼ï¼Œè®©é—®é¢˜çš„è§£å†³æ–¹æ¡ˆå¯ä»¥å¹¶è¡Œæ‰§è¡Œæ³¨ï¼šå¹¶å‘å®è§‚ä¸Šçœ‹èµ·æ¥åƒæ˜¯å¹¶è¡Œä½†æ˜¯å¾®è§‚ä¸Šå¹¶ä¸èƒ½åšåˆ°å¹¶è¡Œå¹¶è¡Œ(å¤šè¿›ç¨‹)ä»»åŠ¡ç‰¹ç‚¹ï¼šè®¡ç®—å¯†é›†å‹ä»»åŠ¡ï¼šä»»åŠ¡åŒ…å«å¤§é‡è®¡ç®—ï¼ŒCPUå ç”¨ç‡é«˜å½“æœ‰å¤šä¸ªCPUæˆ–è€…æ˜¯å¤šæ ¸CPUæ—¶æ‰æœ‰å¯èƒ½å®ç°å¹¶è¡Œï¼Œå¹¶è¡Œå°±æ˜¯å¤šä¸ªçº¿ç¨‹æˆ–è€…å¤šä¸ªè¿›ç¨‹åŒæ—¶è¿è¡Œå¹¶è¡Œæè¿°çš„æ˜¯ç¨‹åºçš„æ‰§è¡ŒçŠ¶æ€ã€‚æŒ‡å¤šä¸ªä»»åŠ¡åŒæ—¶è¢«æ‰§è¡Œä»¥åˆ©ç”¨å¯Œä½™è®¡ç®—èµ„æºï¼ˆå¤šæ ¸CPUï¼‰åŠ é€Ÿå®Œæˆå¤šä¸ªä»»åŠ¡ä¸ºç›®çš„ç»„åˆåˆ†æåŒæ­¥é˜»å¡ã€åŒæ­¥éé˜»å¡ï¼Œå¼‚æ­¥é˜»å¡ã€å¼‚æ­¥éé˜»å¡ä¸¾ä¸ªç®€å•çš„ä¾‹å­æ¥æè¿°è¿™å››ç§æƒ…å†µï¼Œè€å¼ è¦åšä¸¤ä»¶äº‹ï¼Œç”¨æ°´å£¶çƒ§å¼€æ°´ï¼Œçœ‹ç”µè§†ï¼Œä¸¤ä»¶äº‹æƒ…å³ä¸¤ä¸ªä»»åŠ¡ï¼Œä¸¤ä¸ªå‡½æ•°åŒæ­¥é˜»å¡ï¼šè€å¼ æŠŠæ°´å£¶æ”¾åˆ°ç«ä¸Šï¼Œå°±ååœ¨é‚£é‡Œç­‰æ°´å¼€ï¼Œå¼€äº†ä¹‹åæˆ‘å†å»çœ‹ç”µè§†åŒæ­¥éé˜»å¡ï¼šè€å¼ æŠŠæ°´å£¶æ”¾åˆ°ç«ä¸Šï¼Œå»å®¢å…çœ‹ç”µè§†ï¼Œæ—¶ä¸æ—¶å»å¨æˆ¿çœ‹çœ‹æ°´å¼€æ²¡æœ‰è€å¼ è¿˜æ˜¯è§‰å¾—è‡ªå·±æœ‰ç‚¹å‚»ï¼Œäºæ˜¯å˜é«˜ç«¯äº†ï¼Œä¹°äº†æŠŠä¼šå“ç¬›çš„é‚£ç§æ°´å£¶ã€‚æ°´å¼€ä¹‹åï¼Œèƒ½å¤§å£°å‘å‡ºå˜€~~~~çš„å™ªéŸ³å¼‚æ­¥é˜»å¡ï¼šè€å¼ æŠŠå“æ°´å£¶æ”¾åˆ°ç«ä¸Šï¼Œç„¶åå°±ååœ¨æ—è¾¹ç­‰ç€å¬é‚£ä¸ªçƒ§å¼€çš„æç¤ºéŸ³å¼‚æ­¥éé˜»å¡ï¼šè€å¼ æŠŠå“æ°´å£¶æ”¾åˆ°ç«ä¸Šï¼Œå»å®¢å…çœ‹ç”µè§†ï¼Œæ°´å£¶å“ä¹‹å‰ä¸å†å»çœ‹å®ƒäº†ï¼Œå“äº†å†å»æ‹¿å£¶ä¹ä¸€çœ‹ï¼Œè¿™åŒæ­¥é˜»å¡ã€æ„ä¸é˜»å¡ä¼¼ä¹æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œä½†å®é™…ä¸Šæ˜¯æœ‰åŒºåˆ«çš„ï¼Œæ‰€è°“åŒæ­¥å¼‚æ­¥ï¼ŒæŒ‡çš„æ˜¯æ¶ˆæ¯é€šçŸ¥çš„æœºåˆ¶åŒºåˆ«åœ¨å“ªé‡Œå‘¢åœ¨è¿™ä¸ªä¾‹å­ä¸­åŒæ­¥å¼‚æ­¥åªæ˜¯å¯¹äºæ°´å£¶è€Œè¨€ã€‚åœ¨ä½¿ç”¨æ™®é€šæ°´å£¶çš„æ—¶å€™ï¼Œæˆ‘è¦è‡ªå·±ä¸»åŠ¨å»è§‚å¯Ÿæ°´æ˜¯ä¸æ˜¯çƒ§å¼€äº†ï¼Œè‡ªå·±ä¸»åŠ¨å»è·å–çƒ§å¼€çš„è¿™ä¸ªç»“æœï¼Œå³æ‰€è°“çš„åŒæ­¥ä½†æ˜¯åœ¨å“æ°´å£¶çš„æ—¶å€™ï¼Œæˆ‘ä¸éœ€è¦å†ç®¡æ°´çƒ§åˆ°ä»€ä¹ˆç¨‹åº¦äº†ï¼Œå› ä¸ºåªè¦æ°´çƒ§å¼€äº†ï¼Œé‚£ä¸ªæ»´æ»´çš„å™ªå£°å°±ä¼šé€šçŸ¥æˆ‘çš„ï¼Œå³æ‰€è°“çš„å¼‚æ­¥ä»–ä»¬çš„ç›¸åŒç‚¹æ˜¯ï¼Œåœ¨çƒ§æ°´çš„è¿‡ç¨‹ä¸­ï¼Œè€ç‹å•¥ä¹Ÿæ²¡å¹²ï¼Œå³â€œé˜»å¡â€å››ç§æ€»ç»“â€”â€”åŒæ­¥/å¼‚æ­¥ä¸é˜»å¡/éé˜»å¡åŒæ­¥é˜»å¡å½¢å¼ï¼šæ•ˆç‡æ˜¯æœ€ä½çš„ã€‚æ‹¿ä¸Šé¢çš„ä¾‹å­æ¥è¯´ï¼Œåœ¨çƒ§æ°´çš„è¿‡ç¨‹ä¸­ï¼Œä»€ä¹ˆåˆ«çš„äº‹éƒ½ä¸åšåŒæ­¥éé˜»å¡å½¢å¼ï¼šå®é™…ä¸Šæ˜¯æ•ˆç‡ä½ä¸‹çš„ã€‚å› ä¸ºè€ç‹éœ€è¦ä¸æ–­çš„åœ¨çœ‹ç”µè§†ä¸çƒ§æ°´ä¹‹é—´æ¥å›è·‘åŠ¨ï¼Œçœ‹ä¸€ä¸‹ç”µè§†ï¼Œåˆè¦å»çœ‹ä¸€ä¸‹æ°´çƒ§å¼€               æ²¡æœ‰ï¼Œè¿™æ ·æ¥å›è·‘å¾ˆå¤šæ¬¡ï¼Œåœ¨ç¨‹åºä¸­ï¼Œç¨‹åºéœ€è¦åœ¨è¿™ä¸¤ç§ä¸åŒçš„è¡Œä¸ºä¹‹é—´æ¥å›çš„åˆ‡æ¢ï¼Œæ•ˆç‡å¯æƒ³è€ŒçŸ¥æ˜¯ä½ä¸‹çš„å¼‚æ­¥é˜»å¡å½¢å¼ï¼šå¼‚æ­¥æ“ä½œæ˜¯å¯ä»¥è¢«é˜»å¡ä½çš„ï¼Œåªä¸è¿‡å®ƒä¸æ˜¯åœ¨å¤„ç†æ¶ˆæ¯æ—¶é˜»å¡ï¼Œè€Œæ˜¯åœ¨ç­‰å¾…æ¶ˆæ¯é€šçŸ¥æ—¶è¢«é˜»å¡è¿™ä¸ªæ•ˆç‡å…¶å®è·ŸåŒæ­¥é˜»å¡å·®ä¸å¤šçš„å¼‚æ­¥éé˜»å¡å½¢å¼ï¼šæ•ˆç‡æ›´é«˜ã€‚å› ä¸ºè€ç‹æŠŠæ°´çƒ§å¥½ä¹‹åå°±ä¸ç”¨ç®¡äº†ï¼Œå¯ä»¥å®‰å®‰å¿ƒå¿ƒå»çœ‹ç”µè§†ï¼Œä¸ç”¨æ¥å›å¥”æ³¢çœ‹æ°´çƒ§å¼€äº†æ²¡å› ä¸ºæ°´çƒ§å¼€äº†ä¼šæœ‰æç¤ºå‘Šè¯‰ä»–æ°´çƒ§å¥½äº†ï¼Œè¿™æ ·æ•ˆç‡å²‚ä¸æ˜¯æ›´é«˜é‚£æœ‰æ²¡æœ‰æ›´å¥½çš„åŠæ³•ï¼Ÿå½“ç„¶æœ‰ï¼Œå¦‚æœè€ç‹è¿˜æœ‰ä¸€ä¸ªå¸®æ‰‹è€å¼ ï¼Œè®©è€ç‹è‡ªå·±çœ‹ç”µè§†ã€åŒæ—¶è€å¼ å»çƒ§å¼€æ°´ï¼Œè¿™æ ·å²‚ä¸æ˜¯æ›´å¥½ï¼Ÿè¿™å°±æ˜¯æ‰€è°“çš„å¹¶è¡Œå¹¶å‘/å¹¶è¡Œã€åŒæ­¥/å¼‚æ­¥ã€é˜»å¡/éé˜»å¡å¹¶å‘/å¹¶è¡Œï¼šå³èƒ½å¤Ÿå¼€å¯å¤šä¸ªä»»åŠ¡ï¼Œå¤šä¸ªä»»åŠ¡äº¤æ›¿æ‰§è¡Œä¸ºå¹¶å‘ï¼Œå¤šä¸ªä»»åŠ¡åŒæ—¶æ‰§è¡Œä¸ºå¹¶è¡ŒåŒæ­¥/å¼‚æ­¥ï¼šå…³æ³¨çš„æ˜¯æ¶ˆæ¯é€šçŸ¥çš„æœºåˆ¶ï¼Œä¸»åŠ¨ç­‰å€™æ¶ˆæ¯åˆ™ä¸ºåŒæ­¥ã€è¢«åŠ¨å¬æ¶ˆæ¯åˆ™ä¸ºå¼‚æ­¥é˜»å¡/éé˜»å¡ï¼šå…³æ³¨çš„æ˜¯ç­‰å€™æ¶ˆæ¯çš„è¿‡ç¨‹ä¸­æœ‰æ²¡æœ‰å¹²å…¶ä»–äº‹æ€»ç»“ï¼šä¸Šé¢çš„å‡ ç»„æ¦‚å¿µï¼Œæ—¶åˆ»ç©¿æ’çš„ï¼Œå¹¶æ²¡æœ‰å®Œå…¨çš„ç­‰ä»·å…³ç³»æ‰€ä»¥ç»å¸¸æœ‰äººè¯´ï¼Œå¼‚æ­¥å°±æ˜¯éé˜»å¡ï¼ŒåŒæ­¥å°±æ˜¯é˜»å¡ï¼Œå¹¶å‘å°±æ˜¯éé˜»å¡ã€å¹¶è¡Œå°±æ˜¯éé˜»å¡ï¼Œè¿™äº›è¯´æ³•éƒ½æ˜¯ä¸å®Œå…¨å‡†ç¡®åœ°ã€‚æ¦‚å¿µæ€»ç»“è¦æ”¯æŒå¹¶å‘ï¼Œå¿…é¡»æ‹†åˆ†ä¸ºå¤šä»»åŠ¡ï¼Œä¸åŒä»»åŠ¡ç›¸å¯¹è€Œè¨€æ‰æœ‰é˜»å¡/éé˜»å¡ã€åŒæ­¥/å¼‚æ­¥å¹¶è¡Œæ˜¯ä¸ºäº†åˆ©ç”¨å¤šæ ¸åŠ é€Ÿå¤šä»»åŠ¡å®Œæˆçš„è¿›åº¦å¹¶å‘æ˜¯ä¸ºäº†è®©ç‹¬ç«‹çš„å­ä»»åŠ¡éƒ½æœ‰æœºä¼šè¢«å°½å¿«æ‰§è¡Œï¼Œä½†ä¸ä¸€å®šèƒ½åŠ é€Ÿæ•´ä½“è¿›åº¦éé˜»å¡æ˜¯ä¸ºäº†æé«˜ç¨‹åºæ•´ä½“æ‰§è¡Œæ•ˆç‡å¼‚æ­¥æ˜¯é«˜æ•ˆåœ°ç»„ç»‡éé˜»å¡ä»»åŠ¡çš„æ–¹å¼æ‰€ä»¥ï¼Œå¹¶å‘ã€å¼‚æ­¥ã€éé˜»å¡ä¸‰ä¸ªè¯æ€»æ˜¯å¦‚å½±éšå½¢asyncio æ ‡å‡†åº“åç¨‹æ ¸å¿ƒæ¦‚å¿µpythonåç¨‹çš„å¤šç§å®ç°æ–¹å¼åœ¨Pythonä¸­æœ‰å¤šç§æ–¹å¼å¯ä»¥å®ç°åç¨‹ï¼Œä¾‹å¦‚ï¼šgreenletï¼Œæ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œç”¨äºå®ç°åç¨‹ä»£ç ï¼ˆGeventåç¨‹å°±æ˜¯åŸºäºgreenletå®ç°ï¼‰yieldï¼Œç”Ÿæˆå™¨ï¼Œå€ŸåŠ©ç”Ÿæˆå™¨çš„ç‰¹ç‚¹ä¹Ÿå¯ä»¥å®ç°åç¨‹ä»£ç asyncioï¼Œåœ¨Python3.4ä¸­å¼•å…¥çš„æ¨¡å—ç”¨äºç¼–å†™åç¨‹ä»£ç async &amp; awiatï¼ŒPython3.5ä¸­å¼•å…¥çš„å…³é”®å­—ï¼Œç»“åˆasyncioæ¨¡å—å¯ä»¥æ›´æ–¹ä¾¿çš„ç¼–å†™åç¨‹ä»£ç ç›®å‰ä¸»æµä½¿ç”¨æ˜¯Pythonå®˜æ–¹æ¨èçš„ asyncio æ¨¡å—å’Œ async&amp;await å…³é”®å­—çš„æ–¹å¼ä¾‹å¦‚ï¼šåœ¨tonadoã€sanicã€fastapiã€django3 ä¸­å‡å·²æ”¯æŒä»»åŠ¡ç±»å‹è®¡ç®—å¯†é›†å‹ä»»åŠ¡ï¼šä»»åŠ¡åŒ…å«å¤§é‡è®¡ç®—ï¼ŒCPUå ç”¨ç‡é«˜IOå¯†é›†å‹ä»»åŠ¡ï¼šä»»åŠ¡åŒ…å«é¢‘ç¹çš„ã€æŒç»­çš„ç½‘ç»œIOå’Œç£ç›˜IOæ··åˆå‹ä»»åŠ¡ï¼šæ—¢æœ‰è®¡ç®—ä¹Ÿæœ‰IOåç¨‹çŠ¶æ€åç¨‹å‡½æ•°ç›¸æ¯”äºä¸€èˆ¬çš„å‡½æ•°æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥å°†åç¨‹åŒ…è£…æˆä»»åŠ¡Taskï¼Œä»»åŠ¡Taskå°±åœ¨äºå¯ä»¥è·Ÿè¸ªå®ƒçš„çŠ¶æ€ï¼Œæˆ‘å°±çŸ¥é“å®ƒå…·ä½“æ‰§è¡Œåˆ°å“ªä¸€æ­¥äº†ä¸€èˆ¬æ¥è¯´ï¼Œåç¨‹å‡½æ•°å…·æœ‰4ç§çŠ¶æ€Pendingï¼šåˆ›å»ºfutureçš„æ—¶å€™ï¼Œtaskä¸ºpendingRunningï¼šäº‹ä»¶å¾ªç¯è°ƒç”¨æ‰§è¡Œçš„æ—¶å€™å½“ç„¶å°±æ˜¯runningDoneï¼šè°ƒç”¨å®Œæ¯•è‡ªç„¶å°±æ˜¯doneCacelledï¼šåœæ­¢äº‹ä»¶å¾ªç¯ï¼Œå°±éœ€è¦å…ˆæŠŠtaskå–æ¶ˆï¼Œå³ä¸ºcancelledgreenletåº“ greentletæ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œéœ€è¦æå‰å®‰è£… pip3 install greenletæ‰èƒ½ä½¿ç”¨12345678910111213from greenlet import greenletdef func1():    print(1)        # ç¬¬1æ­¥ï¼šè¾“å‡º 1    gr2.switch()    # ç¬¬3æ­¥ï¼šåˆ‡æ¢åˆ° func2 å‡½æ•°    print(2)        # ç¬¬6æ­¥ï¼šè¾“å‡º 2    gr2.switch()    # ç¬¬7æ­¥ï¼šåˆ‡æ¢åˆ° func2 å‡½æ•°ï¼Œä»ä¸Šä¸€æ¬¡æ‰§è¡Œçš„ä½ç½®ç»§ç»­å‘åæ‰§è¡Œdef func2():    print(3)        # ç¬¬4æ­¥ï¼šè¾“å‡º 3    gr1.switch()    # ç¬¬5æ­¥ï¼šåˆ‡æ¢åˆ° func1 å‡½æ•°ï¼Œä»ä¸Šä¸€æ¬¡æ‰§è¡Œçš„ä½ç½®ç»§ç»­å‘åæ‰§è¡Œ    print(4)        # ç¬¬8æ­¥ï¼šè¾“å‡º 4gr1 = greenlet(func1)gr2 = greenlet(func2)gr1.switch() # ç¬¬1æ­¥ï¼šå»æ‰§è¡Œ func1 å‡½æ•° æ³¨æ„ï¼šswitchä¸­ä¹Ÿå¯ä»¥ä¼ é€’å‚æ•°ç”¨äºåœ¨åˆ‡æ¢æ‰§è¡Œæ—¶ç›¸äº’ä¼ é€’å€¼yieldå…³é”®å­— åŸºäºPythonçš„ç”Ÿæˆå™¨çš„yieldå’Œyield formå…³é”®å­—å®ç°åç¨‹ä»£ç 12345678910111213def func1():    yield 1    yield from func2()    yield 2    def func2():    yield 3    yield 4    f1 = func1()for item in f1:    print(item) æ³¨æ„ï¼šyield formå…³é”®å­—æ˜¯åœ¨Python3.3ä¸­å¼•å…¥çš„å…¥é—¨ç¤ºä¾‹asyncioæ¨¡å—åœ¨Python3.4ä¹‹å‰å®˜æ–¹æœªæä¾›åç¨‹çš„ç±»åº“ï¼Œä¸€èˆ¬å¤§å®¶éƒ½æ˜¯ä½¿ç”¨greenletç­‰å…¶ä»–æ¥å®ç°åœ¨Python3.4å‘å¸ƒåå®˜æ–¹æ­£å¼æ”¯æŒåç¨‹ï¼Œå³ï¼šasyncioæ¨¡å—123456789101112131415161718import asyncio@asyncio.coroutinedef func1():    print(1)    yield from asyncio.sleep(2)  # é‡åˆ°IOè€—æ—¶æ“ä½œï¼Œè‡ªåŠ¨åŒ–åˆ‡æ¢åˆ°tasksä¸­çš„å…¶ä»–ä»»åŠ¡    print(2)    @asyncio.coroutinedef func2():    print(3)    yield from asyncio.sleep(2) # é‡åˆ°IOè€—æ—¶æ“ä½œï¼Œè‡ªåŠ¨åŒ–åˆ‡æ¢åˆ°tasksä¸­çš„å…¶ä»–ä»»åŠ¡    print(4)tasks = [asyncio.ensure_future( func1() ),         asyncio.ensure_future( func2() )]loop = asyncio.get_event_loop()loop.run_until_complete(asyncio.wait(tasks))æ³¨æ„ï¼šåŸºäºasyncioæ¨¡å—å®ç°çš„åç¨‹æ¯”ä¹‹å‰çš„è¦å‰å®³ï¼Œå†…éƒ¨é›†æˆäº†é‡åˆ°IOè€—æ—¶æ“ä½œè‡ªåŠ¨åˆ‡æ¢çš„åŠŸèƒ½ async &amp; awit å…³é”®å­—async &amp; awit å…³é”®å­—åœ¨Python3.5ç‰ˆæœ¬ä¸­æ­£å¼å¼•å…¥ï¼Œè®©ä»£ç å¯ä»¥æ›´åŠ ç®€ä¾¿Python3.8ä¹‹å @asyncio.coroutine è£…é¥°å™¨å°±ä¼šè¢«ç§»é™¤ï¼Œæ¨èä½¿ç”¨async &amp; awit å…³é”®å­—å®ç°åç¨‹ä»£ç 12345678910111213141516import asyncioasync def func1():    print(1)    await asyncio.sleep(2)    print(2)    async def func2():    print(3)    await asyncio.sleep(2)    print(4)    tasks = [asyncio.ensure_future( func1() ),         asyncio.ensure_future( func2() )]loop = asyncio.get_event_loop()loop.run_until_complete(asyncio.wait(tasks))è¿›é˜¶ç¤ºä¾‹ç”¨ä»£ç å®ç°ä¸‹è½½ url_list ä¸­çš„å›¾ç‰‡ åŒæ­¥ç¼–ç¨‹å®ç° 12345678910111213141516171819202122232425&quot;&quot;&quot;ä¸‹è½½å›¾ç‰‡ä½¿ç”¨ç¬¬ä¸‰æ–¹æ¨¡å—requestsï¼Œè¯·æå‰å®‰è£…ï¼špip3 install requests&quot;&quot;&quot;import requestsdef download_image(url):    print(&quot;å¼€å§‹ä¸‹è½½:&quot;,url)        # å‘é€ç½‘ç»œè¯·æ±‚ï¼Œä¸‹è½½å›¾ç‰‡    response = requests.get(url)    print(&quot;ä¸‹è½½å®Œæˆ&quot;)        # å›¾ç‰‡ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶    file_name = url.rsplit('_')[-1]    with open(file_name, mode='wb') as file_object:        file_object.write(response.content)        if __name__ == '__main__':    url_list = [        'https://www3.autoimg.cn/newsdfs/g26/M02/35/A9/120x90_0_autohomecar__ChsEe12AXQ6AOOH_AAFocMs8nzU621.jpg',        'https://www2.autoimg.cn/newsdfs/g30/M01/3C/E2/120x90_0_autohomecar__ChcCSV2BBICAUntfAADjJFd6800429.jpg',        'https://www3.autoimg.cn/newsdfs/g26/M0B/3C/65/120x90_0_autohomecar__ChcCP12BFCmAIO83AAGq7vK0sGY193.jpg'    ]    for item in url_list:        download_image(item)åŸºäºåç¨‹çš„å¼‚æ­¥ç¼–ç¨‹å®ç°1234567891011121314151617181920212223242526272829303132333435363738#!/usr/bin/env Python# -- coding: utf-8 --&quot;&quot;&quot;@version: v1.0@author: huangyc@file: asyncio_test_http.py@Description: ä¸‹è½½å›¾ç‰‡ä½¿ç”¨ç¬¬ä¸‰æ–¹æ¨¡å—aiohttpï¼Œè¯·æå‰å®‰è£…ï¼špip3 install aiohttp@time: 2021/2/19 9:23&quot;&quot;&quot;import aiohttpimport asyncioasync def fetch(session, url):    print(&quot;å‘é€è¯·æ±‚ï¼š&quot;, url)    async with session.get(url, verify_ssl=False) as response:        content = await response.content.read()        file_name = url.rsplit('_')[-1]        with open(file_name, mode='wb') as file_object:            file_object.write(content)async def main():    async with aiohttp.ClientSession() as session:        url_list = [            'https://www3.autoimg.cn/newsdfs/g26/M02/35/A9/120x90_0_autohomecar__ChsEe12AXQ6AOOH_AAFocMs8nzU621.jpg',            'https://www2.autoimg.cn/newsdfs/g30/M01/3C/E2/120x90_0_autohomecar__ChcCSV2BBICAUntfAADjJFd6800429.jpg',            'https://www3.autoimg.cn/newsdfs/g26/M0B/3C/65/120x90_0_autohomecar__ChcCP12BFCmAIO83AAGq7vK0sGY193.jpg'        ]        tasks = [asyncio.create_task(fetch(session, url)) for url in url_list]        await asyncio.wait(tasks)if __name__ == '__main__':    asyncio.run(main())ä¸Šè¿°ä¸¤ç§çš„æ‰§è¡Œå¯¹æ¯”ä¹‹åä¼šå‘ç°ï¼ŒåŸºäºåç¨‹çš„å¼‚æ­¥ç¼–ç¨‹ è¦æ¯” åŒæ­¥ç¼–ç¨‹çš„æ•ˆç‡é«˜äº†å¾ˆå¤šåŒæ­¥ç¼–ç¨‹ï¼ŒæŒ‰ç…§é¡ºåºé€ä¸€æ’é˜Ÿæ‰§è¡Œï¼Œå¦‚æœå›¾ç‰‡ä¸‹è½½æ—¶é—´ä¸º2åˆ†é’Ÿï¼Œé‚£ä¹ˆå…¨éƒ¨æ‰§è¡Œå®Œåˆ™éœ€è¦6åˆ†é’Ÿã€‚å¼‚æ­¥ç¼–ç¨‹ï¼Œå‡ ä¹åŒæ—¶å‘å‡ºäº†3ä¸ªä¸‹è½½ä»»åŠ¡çš„è¯·æ±‚ï¼ˆé‡åˆ°IOè¯·æ±‚è‡ªåŠ¨åˆ‡æ¢å»å‘é€å…¶ä»–ä»»åŠ¡è¯·æ±‚ï¼‰ï¼Œå¦‚æœå›¾ç‰‡ä¸‹è½½æ—¶é—´ä¸º2åˆ†é’Ÿï¼Œé‚£ä¹ˆå…¨éƒ¨æ‰§è¡Œå®Œæ¯•ä¹Ÿå¤§æ¦‚éœ€è¦2åˆ†é’Ÿå·¦å³å°±å¯ä»¥äº†ã€‚ç¬¬ä¸‰æ–¹æ¨¡å—ä¸æ”¯æŒåç¨‹æ–¹å¼å¼‚æ­¥ç¼–ç¨‹12345678910111213141516171819202122232425import asyncioimport requestsasync def download_image(url):    # å‘é€ç½‘ç»œè¯·æ±‚ï¼Œä¸‹è½½å›¾ç‰‡ï¼ˆé‡åˆ°ç½‘ç»œä¸‹è½½å›¾ç‰‡çš„IOè¯·æ±‚ï¼Œè‡ªåŠ¨åŒ–åˆ‡æ¢åˆ°å…¶ä»–ä»»åŠ¡ï¼‰    print(&quot;å¼€å§‹ä¸‹è½½:&quot;, url)    loop = asyncio.get_event_loop()    # requestsæ¨¡å—é»˜è®¤ä¸æ”¯æŒå¼‚æ­¥æ“ä½œï¼Œæ‰€ä»¥å°±ä½¿ç”¨çº¿ç¨‹æ± æ¥é…åˆå®ç°äº†ã€‚    future = loop.run_in_executor(None, requests.get, url)    response = await future    print('ä¸‹è½½å®Œæˆ')    # å›¾ç‰‡ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶    file_name = url.rsplit('_')[-1]    with open(file_name, mode='wb') as file_object:        file_object.write(response.content)if __name__ == '__main__':    url_list = [        'https://www3.autoimg.cn/newsdfs/g26/M02/35/A9/120x90_0_autohomecar__ChsEe12AXQ6AOOH_AAFocMs8nzU621.jpg',        'https://www2.autoimg.cn/newsdfs/g30/M01/3C/E2/120x90_0_autohomecar__ChcCSV2BBICAUntfAADjJFd6800429.jpg',        'https://www3.autoimg.cn/newsdfs/g26/M0B/3C/65/120x90_0_autohomecar__ChcCP12BFCmAIO83AAGq7vK0sGY193.jpg'    ]    tasks = [download_image(url) for url in url_list]    loop = asyncio.get_event_loop()    loop.run_until_complete(asyncio.wait(tasks))æ ¸å¿ƒæ¦‚å¿µpythonåç¨‹ç³»åˆ—ï¼ˆäº”ï¼‰â€”â€”asyncioçš„æ ¸å¿ƒæ¦‚å¿µä¸åŸºæœ¬æ¶æ„åç¨‹å‡½æ•°å’Œå¯¹è±¡åç¨‹å‡½æ•°ï¼šå®šä¹‰å½¢å¼ä¸º async def fun() çš„å‡½æ•°åœ¨ Python 3.4 ä¸­ï¼Œasyncio æ¨¡å—å‡ºç°ï¼Œæ­¤æ—¶åˆ›å»ºåç¨‹å‡½æ•°é¡»ä½¿ç”¨ asyncio.coroutine è£…é¥°å™¨æ ‡è®°æ­¤å‰çš„åŒ…å« yield from è¯­å¥çš„å‡½æ•°æ—¢å¯ä»¥ç§°ä½œç”Ÿæˆå™¨å‡½æ•°ä¹Ÿå¯ä»¥ç§°ä½œåç¨‹å‡½æ•°ä¸ºäº†çªå‡ºåç¨‹çš„é‡è¦æ€§ï¼Œç°åœ¨ä½¿ç”¨ asyncio.coroutine è£…é¥°å™¨çš„å‡½æ•°å°±æ˜¯çœŸæ­£çš„åç¨‹å‡½æ•°äº†åç¨‹å¯¹è±¡ï¼šè°ƒç”¨ åç¨‹å‡½æ•° æ‰€è¿”å›çš„å¯¹è±¡å³åç¨‹å‡½æ•°çš„è¿è¡Œç»“æœä¸ºåç¨‹å¯¹è±¡ï¼Œåç¨‹å¯¹è±¡éœ€è¦åŒ…è£…æˆä»»åŠ¡æ³¨å…¥åˆ°äº‹ä»¶å¾ªç¯ï¼Œç”±äº‹ä»¶å¾ªç¯è°ƒç”¨æ€ä¹ˆåˆ¤æ–­ä¸€ä¸ªå‡½æ•°æ˜¯ä¸æ˜¯åç¨‹ï¼Ÿé€šè¿‡asyncio.iscoroutineï¼ˆobjï¼‰å’Œ asyncio.iscoroutinefunction(func)åŠ ä»¥åˆ¤æ–­ï¼Œè¿”å›trueï¼Œåˆ™æ˜¯12345# å®šä¹‰ä¸€ä¸ªåç¨‹å‡½æ•°async def func():    pass# è°ƒç”¨åç¨‹å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªåç¨‹å¯¹è±¡result = func()æ³¨æ„ï¼šè°ƒç”¨åç¨‹å‡½æ•°æ—¶ï¼Œå‡½æ•°å†…éƒ¨ä»£ç ä¸ä¼šæ‰§è¡Œï¼Œåªæ˜¯ä¼šè¿”å›ä¸€ä¸ªåç¨‹å¯¹è±¡è¦æ‰§è¡Œåç¨‹å‡½æ•°çš„å†…éƒ¨ä»£ç ï¼Œéœ€è¦ äº‹ä»¶å¾ªç¯ å’Œ åç¨‹å¯¹è±¡ é…åˆæ‰èƒ½å®ç°123456789101112131415import asyncioasync def func():    print(&quot;åç¨‹å†…éƒ¨ä»£ç &quot;)    # è°ƒç”¨åç¨‹å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªåç¨‹å¯¹è±¡ã€‚result = func()# æ–¹å¼ä¸€# loop = asyncio.get_event_loop() # åˆ›å»ºä¸€ä¸ªäº‹ä»¶å¾ªç¯# loop.run_until_complete(result) # å°†åç¨‹å½“åšä»»åŠ¡æäº¤åˆ°äº‹ä»¶å¾ªç¯çš„ä»»åŠ¡åˆ—è¡¨ä¸­ï¼Œåç¨‹æ‰§è¡Œå®Œæˆä¹‹åç»ˆæ­¢ã€‚# æ–¹å¼äºŒ# æœ¬è´¨ä¸Šæ–¹å¼ä¸€æ˜¯ä¸€æ ·çš„ï¼Œå†…éƒ¨å…ˆ åˆ›å»ºäº‹ä»¶å¾ªç¯ ç„¶åæ‰§è¡Œ run_until_completeï¼Œä¸€ä¸ªç®€ä¾¿çš„å†™æ³•ã€‚# asyncio.run å‡½æ•°åœ¨ Python 3.7 ä¸­åŠ å…¥ asyncio æ¨¡å—ï¼Œasyncio.run(result)è¿™ä¸ªè¿‡ç¨‹å¯ä»¥ç®€å•ç†è§£ä¸ºï¼šå°†åç¨‹å½“åšä»»åŠ¡æ·»åŠ åˆ° äº‹ä»¶å¾ªç¯ çš„ä»»åŠ¡åˆ—è¡¨ç„¶åäº‹ä»¶å¾ªç¯æ£€æµ‹åˆ—è¡¨ä¸­çš„åç¨‹æ˜¯å¦ å·²å‡†å¤‡å°±ç»ªï¼ˆé»˜è®¤å¯ç†è§£ä¸ºå°±ç»ªçŠ¶æ€ï¼‰å¦‚æœå‡†å¤‡å°±ç»ªåˆ™æ‰§è¡Œå…¶å†…éƒ¨ä»£ç Task å¯¹è±¡Tasks are used to schedule coroutines concurrently.When a coroutine is wrapped into a Task with functions like asyncio.create_task() the coroutine is automatically scheduled to run soonã€‚å°†åç¨‹å¯¹è±¡ä½œä¸ºå‚æ•°åˆ›å»ºä»»åŠ¡ï¼Œä»»åŠ¡æ˜¯å¯¹åç¨‹å¯¹è±¡çš„å°è£…ï¼Œå…¶ä¸­åŒ…å«ä»»åŠ¡çš„å„ç§çŠ¶æ€ï¼Œæ˜¯ä¸€ä¸ªå¯ä»¥æŒ‚èµ·çš„å‡½æ•°åç¨‹ä¸æ˜¯çº¿ç¨‹å®‰å…¨ï¼Œè¿™æ ·å¯ä»¥è®©åç¨‹åŠ å…¥äº‹ä»¶å¾ªç¯ä¸­ç­‰å¾…è¢«è°ƒåº¦æ‰§è¡Œå¼‚æ­¥ç¼–ç¨‹æœ€é‡è¦çš„å°±æ˜¯å¯¹å¼‚æ­¥æ“ä½œçŠ¶æ€çš„æŠŠæ§(1) åˆ›å»ºä»»åŠ¡ï¼ˆä¸¤ç§æ–¹æ³•ï¼‰ï¼štask = asyncio.create_task(coro())  # è¿™æ˜¯3.7ç‰ˆæœ¬æ–°æ·»åŠ çš„(å»ºè®®)task = asyncio.ensure_future(coro()) #  Python 3.7 ä¹‹å‰ï¼Œå¯ä»¥ä½¿ç”¨ä½å±‚çº§çš„å‡½æ•°ä¹Ÿå¯ä»¥ä½¿ç”¨ï¼šloop.create_future()æˆ–loop.create_task(coro) (ä¸å»ºè®®æ‰‹åŠ¨å®ä¾‹åŒ– Task å¯¹è±¡)æœ¬è´¨ä¸Šæ˜¯å°†åç¨‹å¯¹è±¡å°è£…æˆtaskå¯¹è±¡ï¼Œå¹¶å°†åç¨‹ç«‹å³åŠ å…¥äº‹ä»¶å¾ªç¯ï¼ŒåŒæ—¶è¿½è¸ªåç¨‹çš„çŠ¶æ€12345678910111213141516171819202122import asyncioasync def func():    print(1)    await asyncio.sleep(2)    print(2)    return &quot;è¿”å›å€¼&quot;async def main():    print(&quot;mainå¼€å§‹&quot;)    # åˆ›å»ºåç¨‹ï¼Œå°†åç¨‹å°è£…åˆ°Taskå¯¹è±¡ä¸­å¹¶æ·»åŠ åˆ°äº‹ä»¶å¾ªç¯çš„ä»»åŠ¡åˆ—è¡¨ä¸­ï¼Œç­‰å¾…äº‹ä»¶å¾ªç¯å»æ‰§è¡Œï¼ˆé»˜è®¤æ˜¯å°±ç»ªçŠ¶æ€ï¼‰ã€‚    # åœ¨è°ƒç”¨    task_list = [asyncio.create_task(func(), name=&quot;n1&quot;),                 asyncio.create_task(func(), name=&quot;n2&quot;)]    print(&quot;mainç»“æŸ&quot;)    # å½“æ‰§è¡ŒæŸåç¨‹é‡åˆ°IOæ“ä½œæ—¶ï¼Œä¼šè‡ªåŠ¨åŒ–åˆ‡æ¢æ‰§è¡Œå…¶ä»–ä»»åŠ¡ã€‚    # æ­¤å¤„çš„awaitæ˜¯ç­‰å¾…æ‰€æœ‰åç¨‹æ‰§è¡Œå®Œæ¯•ï¼Œå¹¶å°†æ‰€æœ‰åç¨‹çš„è¿”å›å€¼ä¿å­˜åˆ°done    # å¦‚æœè®¾ç½®äº†timeoutå€¼ï¼Œåˆ™æ„å‘³ç€æ­¤å¤„æœ€å¤šç­‰å¾…çš„ç§’ï¼Œå®Œæˆçš„åç¨‹è¿”å›å€¼å†™å…¥åˆ°doneä¸­ï¼Œæœªå®Œæˆåˆ™å†™åˆ°pendingä¸­ã€‚    done, pending = await asyncio.wait(task_list, timeout=None)    print(done, pending)    asyncio.run(main())æ³¨æ„ï¼šasyncio.wait æºç å†…éƒ¨ä¼šå¯¹åˆ—è¡¨ä¸­çš„æ¯ä¸ªåç¨‹æ‰§è¡Œensure_futureä»è€Œå°è£…ä¸ºTaskå¯¹è±¡æ‰€ä»¥åœ¨å’Œwaité…åˆä½¿ç”¨æ—¶task_listçš„å€¼ä¸º[func(),func()] ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ æˆ–è€…ï¼š123456789101112131415import asyncioasync def func():    print(&quot;æ‰§è¡Œåç¨‹å‡½æ•°å†…éƒ¨ä»£ç &quot;)    # é‡åˆ°IOæ“ä½œæŒ‚èµ·å½“å‰åç¨‹ï¼ˆä»»åŠ¡ï¼‰ï¼Œç­‰IOæ“ä½œå®Œæˆä¹‹åå†ç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚å½“å‰åç¨‹æŒ‚èµ·æ—¶ï¼Œäº‹ä»¶å¾ªç¯å¯ä»¥å»æ‰§è¡Œå…¶ä»–åç¨‹ï¼ˆä»»åŠ¡ï¼‰ã€‚    response = await asyncio.sleep(2)    print(&quot;IOè¯·æ±‚ç»“æŸï¼Œç»“æœä¸ºï¼š&quot;, response)    coroutine_list = [func(), func()]# é”™è¯¯ï¼šcoroutine_list = [ asyncio.create_task(func()), asyncio.create_task(func()) ]  # æ­¤å¤„ä¸èƒ½ç›´æ¥ asyncio.create_taskï¼Œå› ä¸ºå°†Taskç«‹å³åŠ å…¥åˆ°äº‹ä»¶å¾ªç¯çš„ä»»åŠ¡åˆ—è¡¨ï¼Œ# ä½†æ­¤æ—¶äº‹ä»¶å¾ªç¯è¿˜æœªåˆ›å»ºï¼Œæ‰€ä»¥ä¼šæŠ¥é”™ã€‚# ä½¿ç”¨asyncio.waitå°†åˆ—è¡¨å°è£…ä¸ºä¸€ä¸ªåç¨‹ï¼Œå¹¶è°ƒç”¨asyncio.runå®ç°æ‰§è¡Œä¸¤ä¸ªåç¨‹# asyncio.waitå†…éƒ¨ä¼šå¯¹åˆ—è¡¨ä¸­çš„æ¯ä¸ªåç¨‹æ‰§è¡Œensure_futureï¼Œå°è£…ä¸ºTaskå¯¹è±¡ã€‚done,pending = asyncio.run( asyncio.wait(coroutine_list) )(2) è·å–æŸä¸€ä¸ªä»»åŠ¡çš„æ–¹æ³•ï¼šè¿”å›åœ¨æŸä¸€ä¸ªæŒ‡å®šçš„loopä¸­ï¼Œå½“å‰æ­£åœ¨è¿è¡Œçš„ä»»åŠ¡ï¼Œå¦‚æœæ²¡æœ‰ä»»åŠ¡æ­£åœ¨è¿è¡Œï¼Œåˆ™è¿”å›Noneï¼Œå¦‚æœloopä¸ºNoneï¼Œåˆ™é»˜è®¤ä¸ºåœ¨å½“å‰çš„äº‹ä»¶å¾ªç¯ä¸­è·å–task=asyncio.current_task(loop=None)è¿”å›æŸä¸€ä¸ªloopä¸­è¿˜æ²¡æœ‰ç»“æŸçš„ä»»åŠ¡asyncio.all_tasks(loop=None)(3) Taskç±»å¸¸è§çš„ä¸€äº›ä½¿ç”¨å‡½æ•°cancel()ï¼š æœ€å¥½æ˜¯ä½¿ç”¨ä»–ä¼šå‡ºå‘CancelledErrorå¼‚å¸¸ï¼Œæ‰€ä»¥éœ€è¦å–æ¶ˆçš„åç¨‹å‡½æ•°é‡Œé¢çš„ä»£ç æœ€å¥½åœ¨try-exceptè¯­å¥å—ä¸­è¿›è¡Œï¼Œè¿™æ ·æ–¹ä¾¿è§¦å‘å¼‚å¸¸ï¼Œæ‰“å°ç›¸å…³ä¿¡æ¯ï¼Œä½†æ˜¯Task.cancel()æ²¡æœ‰åŠæ³•ä¿è¯ä»»åŠ¡ä¸€å®šä¼šå–æ¶ˆï¼Œè€ŒFuture.cancel()æ˜¯å¯ä»¥ä¿è¯ä»»åŠ¡ä¸€å®šå–æ¶ˆçš„ done()ï¼šå½“ä¸€ä¸ªè¢«åŒ…è£…å¾—åç¨‹æ—¢æ²¡æœ‰è§¦å‘å¼‚å¸¸ã€ä¹Ÿæ²¡æœ‰è¢«å–æ¶ˆçš„æ—¶å€™ï¼Œæ„å‘³ç€å®ƒæ˜¯doneçš„ï¼Œè¿”å›trueresult()ï¼šè¿”å›ä»»åŠ¡çš„æ‰§è¡Œç»“æœï¼Œå½“ä»»åŠ¡è¢«æ­£å¸¸æ‰§è¡Œå®Œæ¯•ï¼Œåˆ™è¿”å›ç»“æœï¼›å½“ä»»åŠ¡è¢«å–æ¶ˆäº†ï¼Œè°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä¼šè§¦å‘CancelledErrorå¼‚å¸¸ï¼›å½“ä»»åŠ¡è¿”å›çš„ç»“æœæ˜¯æ— ç”¨çš„æ—¶å€™ï¼Œåˆ™è°ƒç”¨è¿™ä¸ªæ–¹æ³•ä¼šè§¦å‘InvalidStateErrorï¼›å½“ä»»åŠ¡å‡ºå‘äº†ä¸€ä¸ªå¼‚å¸¸è€Œä¸­æ–­ï¼Œè°ƒç”¨è¿™ä¸ªæ–¹æ³•è¿˜ä¼šå†æ¬¡è§¦å‘è¿™ä¸ªä½¿ç¨‹åºä¸­æ–­çš„å¼‚å¸¸ã€‚exception()ï¼šè¿”å›ä»»åŠ¡çš„å¼‚å¸¸ä¿¡æ¯ï¼Œè§¦å‘äº†ä»€ä¹ˆå¼‚å¸¸ï¼Œå°±è¿”å›ä»€ä¹ˆå¼‚å¸¸å¦‚æœä»»åŠ¡æ˜¯æ­£å¸¸æ‰§è¡Œçš„æ— å¼‚å¸¸ï¼Œåˆ™è¿”å›Noneå½“ä»»åŠ¡è¢«å–æ¶ˆäº†ï¼Œè°ƒç”¨è¿™ä¸ªæ–¹æ³•ä¼šè§¦å‘CancelledErrorå¼‚å¸¸å½“ä»»åŠ¡æ²¡æœ‰åšå®Œï¼Œè°ƒç”¨è¿™ä¸ªæ–¹æ³•ä¼šè§¦å‘InvalidStateErrorå¼‚å¸¸ è¿˜æœ‰ä¸€äº›ä¸å¸¸ç”¨çš„æ–¹æ³•ï¼šadd_done_callback(callback, **, context=None*) remove_done_callback(callback) get_stack(**, limit=None*) print_stack(**, limit=None, file=None*) all_tasks(loop=None)ï¼Œè¿™æ˜¯ä¸€ä¸ªç±»æ–¹æ³• current_task(loop=None)ï¼Œè¿™æ˜¯ä¸€ä¸ªç±»æ–¹æ³• asyncio.Futureå¯¹è±¡A Futureis a special low-level awaitable object that represents an eventual result of an asynchronous operation. asyncioä¸­çš„Futureå¯¹è±¡æ˜¯ä¸€ä¸ªç›¸å¯¹æ›´åå‘åº•å±‚çš„å¯å¯¹è±¡ï¼Œé€šå¸¸æˆ‘ä»¬ä¸ä¼šç›´æ¥ç”¨åˆ°è¿™ä¸ªå¯¹è±¡ï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨Taskå¯¹è±¡æ¥å®Œæˆä»»åŠ¡çš„å¹¶å’ŒçŠ¶æ€çš„è¿½è¸ªTask æ˜¯ Futrueçš„å­ç±»ï¼Œå’Œtaskä¸Šæ²¡æœ‰æœ¬è´¨ä¸Šçš„åŒºåˆ«ï¼Œæ²¡æœ‰å¿…è¦å»ç”¨Futureï¼Œç”¨Taskå°±å¯ä»¥äº†Futureä¸ºæˆ‘ä»¬æä¾›äº†å¼‚æ­¥ç¼–ç¨‹ä¸­çš„ æœ€ç»ˆç»“æœ çš„å¤„ç†ï¼ˆTaskç±»ä¹Ÿå…·å¤‡çŠ¶æ€å¤„ç†çš„åŠŸèƒ½ï¼‰å½“ä¸€ä¸ªFutureå¯¹è±¡è¢«ç­‰å¾…çš„æ—¶å€™ï¼Œåç¨‹ä¼šä¸€ç›´ç­‰å¾…ï¼Œç›´åˆ°Futureå·²ç»è¿ç®—å®Œæ¯• asyncioä¸­çš„Futureç±»æ˜¯æ¨¡ä»¿concurrent.futures.Futureç±»è€Œè®¾è®¡çš„ç¤ºä¾‹1ï¼š1234567891011async def main():    # è·å–å½“å‰äº‹ä»¶å¾ªç¯    loop = asyncio.get_running_loop()        # # åˆ›å»ºä¸€ä¸ªä»»åŠ¡ï¼ˆFutureå¯¹è±¡ï¼‰ï¼Œè¿™ä¸ªä»»åŠ¡ä»€ä¹ˆéƒ½ä¸å¹²ã€‚    fut = loop.create_future()        # ç­‰å¾…ä»»åŠ¡æœ€ç»ˆç»“æœï¼ˆFutureå¯¹è±¡ï¼‰ï¼Œæ²¡æœ‰ç»“æœåˆ™ä¼šä¸€ç›´ç­‰ä¸‹å»ã€‚    await fut    asyncio.run(main())ç¤ºä¾‹2ï¼š12345678910111213141516171819202122import asyncioasync def set_after(fut):    await asyncio.sleep(2)    fut.set_result(&quot;666&quot;) # é€šå¸¸æ˜¯ä¸ä¼šè¿™æ ·è®¾ç½®çš„ï¼Œè¿™é‡Œåªæ˜¯æ¼”ç¤ºasync def main():    # è·å–å½“å‰äº‹ä»¶å¾ªç¯    loop = asyncio.get_running_loop()        # åˆ›å»ºä¸€ä¸ªä»»åŠ¡ï¼ˆFutureå¯¹è±¡ï¼‰ï¼Œæ²¡ç»‘å®šä»»ä½•è¡Œä¸ºï¼Œåˆ™è¿™ä¸ªä»»åŠ¡æ°¸è¿œä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™ç»“æŸã€‚    fut = loop.create_future()        # åˆ›å»ºä¸€ä¸ªä»»åŠ¡ï¼ˆTaskå¯¹è±¡ï¼‰ï¼Œç»‘å®šäº†set_afterå‡½æ•°ï¼Œå‡½æ•°å†…éƒ¨åœ¨2sä¹‹åï¼Œä¼šç»™futèµ‹å€¼ã€‚    # å³æ‰‹åŠ¨è®¾ç½®futureä»»åŠ¡çš„æœ€ç»ˆç»“æœï¼Œé‚£ä¹ˆfutå°±å¯ä»¥ç»“æŸäº†ã€‚    await loop.create_task(set_after(fut))        # ç­‰å¾… Futureå¯¹è±¡è·å– æœ€ç»ˆç»“æœï¼Œå¦åˆ™ä¸€ç›´ç­‰ä¸‹å»    data = await fut    print(data)asyncio.run(main())Futureå¯¹è±¡æœ¬èº«å‡½æ•°è¿›è¡Œç»‘å®šï¼Œæ‰€ä»¥æƒ³è¦è®©äº‹ä»¶å¾ªç¯è·å–Futureçš„ç»“æœï¼Œåˆ™éœ€è¦æ‰‹åŠ¨è®¾ç½®è€ŒTaskå¯¹è±¡ç»§æ‰¿äº†Futureå¯¹è±¡ï¼Œå…¶å®å°±å¯¹Futureè¿›è¡Œæ‰©å±•ï¼Œä»–å¯ä»¥å®ç°åœ¨å¯¹åº”ç»‘å®šçš„å‡½æ•°æ‰§è¡Œå®Œæˆä¹‹åï¼Œè‡ªåŠ¨æ‰§è¡Œset_resultï¼Œä»è€Œå®ç°è‡ªåŠ¨ç»“æŸè™½ç„¶ï¼Œå¹³æ—¶ä½¿ç”¨çš„æ˜¯Taskå¯¹è±¡ï¼Œä½†å¯¹äºç»“æœçš„å¤„ç†æœ¬è´¨æ˜¯åŸºäºFutureå¯¹è±¡æ¥å®ç°çš„æ‰©å±•ï¼šæ”¯æŒ await å¯¹è±¡è¯­ æ³•çš„å¯¹è±¡è¯¾æˆä¸ºå¯ç­‰å¾…å¯¹è±¡ï¼Œæ‰€ä»¥ åç¨‹å¯¹è±¡ã€Taskå¯¹è±¡ã€Futureå¯¹è±¡ éƒ½å¯ä»¥è¢«æˆä¸ºå¯ç­‰å¾…å¯¹è±¡ã€‚asyncioä¸­å…³äºFutureçš„å‡ ä¸ªæ–¹æ³•asyncio.isfuture(obj)ï¼šåˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯ä¸æ˜¯Futureï¼Œæ³¨æ„pythonä¸­ä¸€åˆ‡çš†å¯¹è±¡å“¦ï¼ŒåŒ…æ‹¬å‡½æ•°ï¼Œå½“objæ˜¯ä¸‹é¢å‡ ç§æƒ…å†µæ—¶è¿”å›trueasyncio.Futureçš„å®ä¾‹å¯¹è±¡asyncio.Taskçš„å®ä¾‹å¯¹è±¡ä¸€ä¸ªå…·æœ‰ _asyncio_future_blockingå±æ€§çš„å¯¹è±¡asyncio.ensure_future(obj, *, loop=None)ã€‚å°†ä¸€ä¸ªobjåŒ…è£…æˆFutureasyncio.wrap_future(future, *, loop=None)å°†concurrent.futures.Futureå¯¹è±¡åŒ…è£…æˆä¸€ä¸ª asyncio.Future å¯¹è±¡ã€‚Futureå¯¹è±¡çš„å¸¸ç”¨æ–¹æ³•result()ï¼šè¿”å›Futureæ‰§è¡Œçš„ç»“æœè¿”å›å€¼å¦‚æœFutureè¢«æ‰§è¡Œå®Œæˆï¼Œå¦‚æœä½¿ç”¨set_result()æ–¹æ³•è®¾ç½®äº†ä¸€ä¸ªç»“æœï¼Œé‚£ä¸ªè®¾ç½®çš„valueå°±ä¼šè¢«è¿”å›å¦‚æœFutureè¢«æ‰§è¡Œå®Œæˆï¼Œå¦‚æœä½¿ç”¨set_exception()æ–¹æ³•è®¾ç½®äº†ä¸€ä¸ªå¼‚å¸¸ï¼Œé‚£ä¹ˆä½¿ç”¨è¿™ä¸ªæ–¹æ³•ä¹Ÿä¼šè§¦å‘å¼‚å¸¸å¦‚æœFutureè¢«å–æ¶ˆäº†ï¼Œé‚£ä¹ˆä½¿ç”¨è¿™ä¸ªæ–¹æ³•ä¼šè§¦å‘CancelledErrorå¼‚å¸¸å¦‚æœFutureçš„ç»“æœä¸å¯ç”¨æˆ–è€…æ˜¯ä¸å¯è¾¾ï¼Œé‚£ä¹ˆä½¿ç”¨è¿™ä¸ªæ–¹æ³•ä¹Ÿä¼šè§¦å‘InvalidStateErrorå¼‚å¸¸set_result(result)ï¼šæ ‡è®°Futureå·²ç»æ‰§è¡Œå®Œæ¯•ï¼Œå¹¶ä¸”è®¾ç½®å®ƒçš„è¿”å›å€¼set_exception(exception)ï¼šæ ‡è®°Futureå·²ç»æ‰§è¡Œå®Œæ¯•ï¼Œå¹¶ä¸”è§¦å‘ä¸€ä¸ªå¼‚å¸¸done()ï¼šå¦‚æœFuture1æ‰§è¡Œå®Œæ¯•ï¼Œåˆ™è¿”å› True cancelled()ï¼šåˆ¤æ–­ä»»åŠ¡æ˜¯å¦å–æ¶ˆadd_done_callback(callback, *, context=None)ï¼šåœ¨Futureå®Œæˆä¹‹åï¼Œç»™å®ƒæ·»åŠ ä¸€ä¸ªå›è°ƒæ–¹æ³•è¿™ä¸ªæ–¹æ³•å°±ç›¸å½“äºæ˜¯loop.call_soon()æ–¹æ³•ï¼Œå¦‚æœè¦å›è°ƒå¸¦æœ‰å…³é”®å­—å‚æ•°çš„å‡½æ•°ï¼Œä¹Ÿéœ€è¦ä½¿ç”¨partialæ–¹æ³•å“¦remove_done_callback(callback)cancel()exception()get_loop()ï¼šè¿”å›Futureæ‰€ç»‘å®šçš„äº‹ä»¶å¾ªç¯futures.Futureå¯¹è±¡åœ¨Pythonçš„concurrent.futuresæ¨¡å—ä¸­ä¹Ÿæœ‰ä¸€ä¸ªFutureå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ˜¯åŸºäºçº¿ç¨‹æ± å’Œè¿›ç¨‹æ± å®ç°å¼‚æ­¥æ“ä½œæ—¶ä½¿ç”¨çš„å¯¹è±¡ã€‚123456789101112131415import timefrom concurrent.futures import Futurefrom concurrent.futures.thread import ThreadPoolExecutorfrom concurrent.futures.process import ProcessPoolExecutordef func(value):    time.sleep(1)    print(value)    pool = ThreadPoolExecutor(max_workers=5)# æˆ– pool = ProcessPoolExecutor(max_workers=5)for i in range(10):    fut = pool.submit(func, i)    print(fut)ä¸¤ä¸ªFutureå¯¹è±¡æ˜¯ä¸åŒçš„ï¼Œä»–ä»¬æ˜¯ä¸ºä¸åŒçš„åº”ç”¨åœºæ™¯è€Œè®¾è®¡ä¾‹å¦‚ï¼šconcurrent.futures.Futureä¸æ”¯æŒawaitè¯­æ³• ç­‰å®˜æ–¹æç¤ºä¸¤å¯¹è±¡ä¹‹é—´ä¸åŒï¼šunlike asyncio Futures, concurrent.futures.Future instances cannot be awaited.asyncio.Future.result() and asyncio.Future.exception() do not accept the timeout argument.asyncio.Future.result() and asyncio.Future.exception() raise an InvalidStateError exception when the Future is not done.Callbacks registered with asyncio.Future.add_done_callback() are not called immediately. They are scheduled with loop.call_soon() instead.asyncio Future is not compatible with the concurrent.futures.wait() and concurrent.futures.as_completed() functions.åœ¨Pythonæä¾›äº†ä¸€ä¸ªå°†futures.Future å¯¹è±¡åŒ…è£…æˆasyncio.Futureå¯¹è±¡çš„å‡½æ•° asynic.wrap_futureä¸ºä»€ä¹ˆpythonä¼šæä¾›è¿™ç§åŠŸèƒ½ï¼Ÿä¸€èˆ¬åœ¨ç¨‹åºå¼€å‘ä¸­æˆ‘ä»¬è¦ä¹ˆç»Ÿä¸€ä½¿ç”¨ asycio çš„åç¨‹å®ç°å¼‚æ­¥æ“ä½œã€è¦ä¹ˆéƒ½ä½¿ç”¨è¿›ç¨‹æ± å’Œçº¿ç¨‹æ± å®ç°å¼‚æ­¥æ“ä½œä½†å¦‚æœ åç¨‹çš„å¼‚æ­¥å’Œ è¿›ç¨‹æ± /çº¿ç¨‹æ± çš„å¼‚æ­¥ æ··æ­æ—¶ï¼Œé‚£ä¹ˆå°±ä¼šç”¨åˆ°æ­¤åŠŸèƒ½äº†12345678910111213141516171819202122232425262728293031import timeimport asyncioimport concurrent.futuresdef func1():    # æŸä¸ªè€—æ—¶æ“ä½œ    time.sleep(2)    return &quot;defaulf pool&quot;async def main():    loop = asyncio.get_running_loop()    # 1. Run in the default loop's executor ( é»˜è®¤ThreadPoolExecutor )    # ç¬¬ä¸€æ­¥ï¼šå†…éƒ¨ä¼šå…ˆè°ƒç”¨ ThreadPoolExecutor çš„ submit æ–¹æ³•å»çº¿ç¨‹æ± ä¸­ç”³è¯·ä¸€ä¸ªçº¿ç¨‹å»æ‰§è¡Œfunc1å‡½æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªconcurrent.futures.Futureå¯¹è±¡    # ç¬¬äºŒæ­¥ï¼šè°ƒç”¨asyncio.wrap_futureå°†concurrent.futures.Futureå¯¹è±¡åŒ…è£…ä¸ºasycio.Futureå¯¹è±¡ã€‚    # å› ä¸ºconcurrent.futures.Futureå¯¹è±¡ä¸æ”¯æŒawaitè¯­æ³•ï¼Œæ‰€ä»¥éœ€è¦åŒ…è£…ä¸º asycio.Futureå¯¹è±¡ æ‰èƒ½ä½¿ç”¨ã€‚    fut = loop.run_in_executor(None, func1)    result = await fut    print('default thread pool', result)        # # 2. Run in a custom thread pool:    # with concurrent.futures.ThreadPoolExecutor() as pool:    #     result = await loop.run_in_executor(pool, func1)    #     print('custom thread pool', result)    # 3. Run in a custom process pool:    # with concurrent.futures.ProcessPoolExecutor() as pool:    #     result = await loop.run_in_executor(pool, func1)    #     print('custom process pool', result)asyncio.run(main())åº”ç”¨åœºæ™¯ï¼šå½“é¡¹ç›®ä»¥åç¨‹å¼çš„å¼‚æ­¥ç¼–ç¨‹å¼€å‘æ—¶ï¼Œå¦‚æœè¦ä½¿ç”¨ä¸€ä¸ªç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œè€Œç¬¬ä¸‰æ–¹æ¨¡å—ä¸æ”¯æŒåç¨‹æ–¹å¼å¼‚æ­¥ç¼–ç¨‹æ—¶ï¼Œå°±éœ€è¦ç”¨åˆ°è¿™ä¸ªåŠŸèƒ½1234567891011121314151617181920212223242526import asyncioimport requestsasync def download_image(url):    # å‘é€ç½‘ç»œè¯·æ±‚ï¼Œä¸‹è½½å›¾ç‰‡ï¼ˆé‡åˆ°ç½‘ç»œä¸‹è½½å›¾ç‰‡çš„IOè¯·æ±‚ï¼Œè‡ªåŠ¨åŒ–åˆ‡æ¢åˆ°å…¶ä»–ä»»åŠ¡ï¼‰    print(&quot;å¼€å§‹ä¸‹è½½:&quot;, url)    loop = asyncio.get_event_loop()    # requestsæ¨¡å—é»˜è®¤ä¸æ”¯æŒå¼‚æ­¥æ“ä½œï¼Œæ‰€ä»¥å°±ä½¿ç”¨çº¿ç¨‹æ± æ¥é…åˆå®ç°äº†ã€‚    future = loop.run_in_executor(None, requests.get, url)    response = await future    print('ä¸‹è½½å®Œæˆ')    # å›¾ç‰‡ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶    file_name = url.rsplit('_')[-1]    with open(file_name, mode='wb') as file_object:        file_object.write(response.content)if __name__ == '__main__':    url_list = [        'https://www3.autoimg.cn/newsdfs/g26/M02/35/A9/120x90_0_autohomecar__ChsEe12AXQ6AOOH_AAFocMs8nzU621.jpg',        'https://www2.autoimg.cn/newsdfs/g30/M01/3C/E2/120x90_0_autohomecar__ChcCSV2BBICAUntfAADjJFd6800429.jpg',        'https://www3.autoimg.cn/newsdfs/g26/M0B/3C/65/120x90_0_autohomecar__ChcCP12BFCmAIO83AAGq7vK0sGY193.jpg'    ]    tasks = [download_image(url) for url in url_list]    loop = asyncio.get_event_loop()    loop.run_until_complete(asyncio.wait(tasks))è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ª asyncio.Future å¯¹è±¡ï¼Œä½¿ç”¨ functools.partial() ä¼ é€’å…³é”®å­—å‚æ•° ç»™ func asyncio.``wrap_future(future, **, loop=None*)å°†ä¸€ä¸ª concurrent.futures.Future å¯¹è±¡å°è£…åˆ° asyncio.Future å¯¹è±¡ä¸­async/await å…³é”®å­—python3.5 ç”¨äºå®šä¹‰åç¨‹çš„å…³é”®å­—ï¼Œasyncå®šä¹‰ä¸€ä¸ªåç¨‹ï¼Œawaitç”¨äºæŒ‚èµ·é˜»å¡çš„å¼‚æ­¥è°ƒç”¨æ¥å£ awaitæ˜¯ä¸€ä¸ªåªèƒ½åœ¨åç¨‹å‡½æ•°ä¸­ä½¿ç”¨çš„å…³é”®å­—ï¼Œç”¨äºé‡åˆ°IOæ“ä½œæ—¶æŒ‚èµ· å½“å‰åç¨‹(ä»»åŠ¡)å½“å‰åç¨‹(ä»»åŠ¡)æŒ‚èµ·è¿‡ç¨‹ä¸­ äº‹ä»¶å¾ªç¯å¯ä»¥å»æ‰§è¡Œå…¶ä»–çš„åç¨‹(ä»»åŠ¡)ï¼Œå½“å‰åç¨‹IOå¤„ç†å®Œæˆæ—¶ï¼Œå¯ä»¥å†æ¬¡åˆ‡æ¢å›æ¥æ‰§è¡Œawaitä¹‹åçš„ä»£ç  1234567891011121314151617import asyncioasync def others():    print(&quot;start&quot;)    await asyncio.sleep(2)    print('end')    return 'è¿”å›å€¼'async def func():    print(&quot;æ‰§è¡Œåç¨‹å‡½æ•°å†…éƒ¨ä»£ç &quot;)    # é‡åˆ°IOæ“ä½œæŒ‚èµ·å½“å‰åç¨‹ï¼ˆä»»åŠ¡ï¼‰ï¼Œç­‰IOæ“ä½œå®Œæˆä¹‹åå†ç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚å½“å‰åç¨‹æŒ‚èµ·æ—¶ï¼Œäº‹ä»¶å¾ªç¯å¯ä»¥å»æ‰§è¡Œå…¶ä»–åç¨‹ï¼ˆä»»åŠ¡ï¼‰ã€‚    response1 = await others()    print(&quot;IOè¯·æ±‚ç»“æŸï¼Œç»“æœä¸ºï¼š&quot;, response1)    response2 = await others()    print(&quot;IOè¯·æ±‚ç»“æŸï¼Œç»“æœä¸ºï¼š&quot;, response2)    asyncio.run( func() )äº‹ä»¶å¾ªç¯çš„ä»»åŠ¡åˆ—è¡¨ä¸­åªæœ‰ä¸€ä¸ªä»»åŠ¡ï¼Œæ‰€ä»¥åœ¨IOç­‰å¾…æ—¶æ— æ³•æ¼”ç¤ºåˆ‡æ¢åˆ°å…¶ä»–ä»»åŠ¡æ•ˆæœåœ¨ç¨‹åºæƒ³è¦åˆ›å»ºå¤šä¸ªä»»åŠ¡å¯¹è±¡ï¼Œéœ€è¦ä½¿ç”¨Taskå¯¹è±¡æ¥å®ç°å¯æš‚åœç­‰å¾…çš„å¯¹è±¡ï¼š æœ‰ä¸‰ç±»å¯¹è±¡æ˜¯å¯ç­‰å¾…çš„ï¼Œå³ coroutines, Tasks, and Futurescoroutineï¼šæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¸€å‰é¢çš„ç”Ÿæˆå™¨yieldå’Œyield fromä¸ºåŸºç¡€ï¼Œä¸å†èµ˜è¿°Tasks: ä»»åŠ¡ï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯è¦å®ŒæˆæŸä»¶äº‹æƒ…ï¼Œå…¶å®å°±æ˜¯å¯¹åç¨‹å‡½æ•°è¿›ä¸€æ­¥çš„å°è£…Futureï¼šå®ƒæ˜¯ä¸€ä¸ªâ€œæ›´åº•å±‚â€çš„æ¦‚å¿µï¼Œä»–ä»£è¡¨ä¸€ä¸ªä¸€æ­¥æ“ä½œçš„æœ€ç»ˆç»“æœï¼Œå› ä¸ºä¸€æ­¥æ“ä½œä¸€èˆ¬ç”¨äºè€—æ—¶æ“ä½œï¼Œç»“æœä¸ä¼šç«‹å³å¾—åˆ°ï¼Œä¼šåœ¨â€œå°†æ¥â€å¾—åˆ°å¼‚æ­¥è¿è¡Œçš„ç»“æœï¼Œæ•…è€Œå‘½åä¸ºFutureä¸‰è€…çš„å…³ç³»ï¼Œcoroutineå¯ä»¥è‡ªåŠ¨å°è£…æˆtaskï¼Œè€ŒTaskæ˜¯Futureçš„å­ç±»event_loop äº‹ä»¶å¾ªç¯python Event_loop(äº‹ä»¶å¾ªç¯)Python åç¨‹ä¸äº‹ä»¶å¾ªç¯ç¨‹åºå¼€å¯ä¸€ä¸ªæ— é™å¾ªç¯ï¼ŒæŠŠä¸€äº›å‡½æ•°æ³¨å†Œåˆ°äº‹ä»¶å¾ªç¯ä¸Šï¼Œå½“æ»¡è¶³äº‹ä»¶å‘ç”Ÿçš„æ—¶å€™ï¼Œè°ƒç”¨ç›¸åº”çš„åç¨‹å‡½æ•°12345678ä»»åŠ¡åˆ—è¡¨ = [ ä»»åŠ¡1, ä»»åŠ¡2, ä»»åŠ¡3,... ]while True:    å¯æ‰§è¡Œçš„ä»»åŠ¡åˆ—è¡¨ï¼Œå·²å®Œæˆçš„ä»»åŠ¡åˆ—è¡¨ = å»ä»»åŠ¡åˆ—è¡¨ä¸­æ£€æŸ¥æ‰€æœ‰çš„ä»»åŠ¡ï¼Œå°†'å¯æ‰§è¡Œ'å’Œ'å·²å®Œæˆ'çš„ä»»åŠ¡è¿”å›    for å°±ç»ªä»»åŠ¡ in å·²å‡†å¤‡å°±ç»ªçš„ä»»åŠ¡åˆ—è¡¨:        æ‰§è¡Œå·²å°±ç»ªçš„ä»»åŠ¡    for å·²å®Œæˆçš„ä»»åŠ¡ in å·²å®Œæˆçš„ä»»åŠ¡åˆ—è¡¨:        åœ¨ä»»åŠ¡åˆ—è¡¨ä¸­ç§»é™¤ å·²å®Œæˆçš„ä»»åŠ¡    å¦‚æœ ä»»åŠ¡åˆ—è¡¨ ä¸­çš„ä»»åŠ¡éƒ½å·²å®Œæˆï¼Œåˆ™ç»ˆæ­¢å¾ªç¯å°†å¤šçº¿ç¨‹æ¯”å–»ä¸ºå·¥å‚é‡Œçš„å¤šä¸ªè½¦é—´ï¼Œé‚£ä¹ˆåç¨‹å°±æ˜¯ä¸€ä¸ªè½¦é—´å†…çš„å¤šå°æœºå™¨ã€‚åœ¨çº¿ç¨‹çº§ç¨‹åºä¸­ï¼Œä¸€å°æœºå™¨å¼€å§‹å·¥ä½œï¼Œè½¦é—´å†…çš„å…¶å®ƒæœºå™¨ä¸èƒ½åŒæ—¶å·¥ä½œï¼Œéœ€è¦ç­‰ä¸Šä¸€å°æœºå™¨åœæ­¢ï¼Œä½†å…¶å®ƒè½¦é—´å†…çš„æœºå™¨å¯ä»¥åŒæ—¶å¯åŠ¨ï¼Œè¿™æ ·å°±å¯ä»¥æ˜¾è‘—æé«˜å·¥ä½œæ•ˆç‡ã€‚åœ¨åç¨‹ç¨‹åºä¸­ï¼Œä¸€ä¸ªè½¦é—´å†…çš„ä¸åŒæœºå™¨å¯ä»¥åŒæ—¶è¿è½¬ï¼Œå¯åŠ¨æœºå™¨ã€æš‚åœè¿è½¬ã€å»¶æ—¶å¯åŠ¨ã€åœæ­¢æœºå™¨ç­‰æ“ä½œéƒ½å¯ä»¥äººä¸ºè®¾ç½®äº‹ä»¶å¾ªç¯èƒ½å¤Ÿæ§åˆ¶ä»»åŠ¡è¿è¡Œæµç¨‹ï¼Œä¹Ÿå°±æ˜¯ä»»åŠ¡çš„è°ƒç”¨æ–¹åç¨‹å‡½æ•°ï¼Œä¸æ˜¯åƒæ™®é€šå‡½æ•°é‚£æ ·ç›´æ¥è°ƒç”¨è¿è¡Œçš„ï¼Œå¿…é¡»æ·»åŠ åˆ°äº‹ä»¶å¾ªç¯ä¸­ï¼Œç„¶åç”±äº‹ä»¶å¾ªç¯å»è¿è¡Œï¼Œå•ç‹¬è¿è¡Œåç¨‹å‡½æ•°æ˜¯ä¸ä¼šæœ‰ç»“æœçš„1234567891011121314151617import timeimport asyncioasync def say_after_time(delay,what):        await asyncio.sleep(delay)        print(what) async def main():        print(f&quot;å¼€å§‹æ—¶é—´ä¸ºï¼š {time.time()}&quot;)        await say_after_time(1,&quot;hello&quot;)        await say_after_time(2,&quot;world&quot;)        print(f&quot;ç»“æŸæ—¶é—´ä¸ºï¼š {time.time()}&quot;) loop=asyncio.get_event_loop()    #åˆ›å»ºäº‹ä»¶å¾ªç¯å¯¹è±¡#loop=asyncio.new_event_loop()   #ä¸ä¸Šé¢ç­‰ä»·ï¼Œåˆ›å»ºæ–°çš„äº‹ä»¶å¾ªç¯loop.run_until_complete(main())  #é€šè¿‡äº‹ä»¶å¾ªç¯å¯¹è±¡è¿è¡Œåç¨‹å‡½æ•°loop.close()è·å–äº‹ä»¶å¾ªç¯å¯¹è±¡çš„å‡ ç§æ–¹å¼ä¸‹é¢å‡ ç§æ–¹å¼å¯ä»¥ç”¨æ¥è·å–ã€è®¾ç½®ã€åˆ›å»ºäº‹ä»¶å¾ªç¯å¯¹è±¡looploop=asyncio.get_running_loop() è¿”å›ï¼ˆè·å–ï¼‰åœ¨å½“å‰çº¿ç¨‹ä¸­æ­£åœ¨è¿è¡Œçš„äº‹ä»¶å¾ªç¯ï¼Œå¦‚æœæ²¡æœ‰æ­£åœ¨è¿è¡Œçš„äº‹ä»¶å¾ªç¯ï¼Œåˆ™ä¼šæ˜¾ç¤ºé”™è¯¯ï¼›å®ƒæ˜¯python3.7ä¸­æ–°æ·»åŠ çš„loop=asyncio.get_event_loop() è·å¾—ä¸€ä¸ªäº‹ä»¶å¾ªç¯ï¼Œå¦‚æœå½“å‰çº¿ç¨‹è¿˜æ²¡æœ‰äº‹ä»¶å¾ªç¯ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„äº‹ä»¶å¾ªç¯loopï¼›loop=asyncio.set_event_loop(loop) è®¾ç½®ä¸€ä¸ªäº‹ä»¶å¾ªç¯ä¸ºå½“å‰çº¿ç¨‹çš„äº‹ä»¶å¾ªç¯ï¼›loop=asyncio.new_event_loop() åˆ›å»ºä¸€ä¸ªæ–°çš„äº‹ä»¶å¾ªç¯é€šè¿‡äº‹ä»¶å¾ªç¯è¿è¡Œåç¨‹å‡½æ•°çš„ä¸¤ç§æ–¹å¼åˆ›å»ºäº‹ä»¶å¾ªç¯å¯¹è±¡loopï¼Œå³asyncio.get_event_loop()ï¼Œé€šè¿‡äº‹ä»¶å¾ªç¯è¿è¡Œåç¨‹å‡½æ•°ç›´æ¥é€šè¿‡asyncio.run(function_name)è¿è¡Œåç¨‹å‡½æ•°éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé¦–å…ˆrunå‡½æ•°æ˜¯python3.7ç‰ˆæœ¬æ–°æ·»åŠ çš„ï¼Œå‰é¢çš„ç‰ˆæœ¬æ˜¯æ²¡æœ‰çš„ï¼›å…¶æ¬¡ï¼Œè¿™ä¸ªrunå‡½æ•°æ€»æ˜¯ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„äº‹ä»¶å¾ªç¯å¹¶åœ¨runç»“æŸä¹‹åå…³é—­äº‹ä»¶å¾ªç¯æ‰€ä»¥ï¼Œå¦‚æœåœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­å·²ç»æœ‰äº†ä¸€ä¸ªäº‹ä»¶å¾ªç¯ï¼Œåˆ™ä¸èƒ½å†ä½¿ç”¨è¿™ä¸ªå‡½æ•°äº†ï¼Œå› ä¸ºåŒä¸€ä¸ªçº¿ç¨‹ä¸èƒ½æœ‰ä¸¤ä¸ªäº‹ä»¶å¾ªç¯ï¼Œè€Œä¸”è¿™ä¸ªrunå‡½æ•°ä¸èƒ½åŒæ—¶è¿è¡Œä¸¤æ¬¡ï¼Œå› ä¸ºä»–å·²ç»åˆ›å»ºä¸€ä¸ªäº†å³åŒä¸€ä¸ªçº¿ç¨‹ä¸­æ˜¯ä¸å…è®¸æœ‰å¤šä¸ªäº‹ä»¶å¾ªç¯loopçš„è¿è¡Œå’Œåœæ­¢äº‹ä»¶å¾ªç¯loop.run_until_complete(future)ã€‚è¿è¡Œäº‹ä»¶å¾ªç¯ï¼Œç›´åˆ°futureè¿è¡Œç»“æŸloop.run_forever()ã€‚åœ¨python3.7ä¸­å·²ç»å–æ¶ˆäº†ï¼Œè¡¨ç¤ºäº‹ä»¶å¾ªç¯ä¼šä¸€ç›´è¿è¡Œï¼Œç›´åˆ°é‡åˆ°stopã€‚loop.stop()ã€‚åœæ­¢äº‹ä»¶å¾ªç¯loop.is_running()ã€‚å¦‚æœäº‹ä»¶å¾ªç¯ä¾ç„¶åœ¨è¿è¡Œï¼Œåˆ™è¿”å›Trueloop.is_closed()ã€‚å¦‚æœäº‹ä»¶å¾ªç¯å·²ç»closeï¼Œåˆ™è¿”å›Trueloop.close()ã€‚å…³é—­äº‹ä»¶å¾ªç¯åˆ›å»ºFutureå’ŒTaskloop.create_future(coroutine) ï¼Œè¿”å›futureå¯¹è±¡loop.create_task(corootine) ï¼Œè¿”å›taskå¯¹è±¡loop.set_task_factory(factory)loop.get_task_factory()äº‹ä»¶å¾ªç¯çš„æ—¶é’Ÿloop.time()ã€‚å¯ä»¥è¿™ä¹ˆç†è§£ï¼Œäº‹ä»¶å¾ªç¯å†…éƒ¨ä¹Ÿç»´æŠ¤ç€ä¸€ä¸ªæ—¶é’Ÿï¼Œå¯ä»¥æŸ¥çœ‹äº‹ä»¶å¾ªç¯ç°åœ¨è¿è¡Œçš„æ—¶é—´ç‚¹æ˜¯å¤šå°‘ï¼Œå°±åƒæ™®é€šçš„time.time()ç±»ä¼¼ï¼Œå®ƒè¿”å›çš„æ˜¯ä¸€ä¸ªæµ®ç‚¹æ•°å€¼123456789101112131415161718192021222324import asyncio async def hello1(a,b):    print('å‡†å¤‡åšåŠ æ³•è¿ç®—')    await asyncio.sleep(3)    return a+bloop=asyncio.get_event_loop()t1=loop.time()  #å¼€å§‹æ—¶é—´print(t1)loop.run_until_complete(hello1(3,4))t2=loop.time()  #ç»“æŸæ—¶é—´print(t2)print(t2-t1)    #æ—¶é—´é—´éš”'''è¿è¡Œç»“æœä¸ºï¼š28525.671å‡†å¤‡åšåŠ æ³•è¿ç®—28528.7033.0320000000028813'''è®¡åˆ’æ‰§è¡Œå›è°ƒå‡½æ•°(CallBacks)loop.call_later(delay, callback, *args, context=None)é¦–å…ˆç®€å•çš„è¯´ä¸€ä¸‹å®ƒçš„å«ä¹‰ï¼Œå°±æ˜¯äº‹ä»¶å¾ªç¯åœ¨delayå¤šé•¿æ—¶é—´ä¹‹åæ‰æ‰§è¡Œcallbackå‡½æ•°ï¼Œå®ƒçš„è¿”å›å€¼æ˜¯asyncio.TimerHandleç±»çš„ä¸€ä¸ªå®ä¾‹å¯¹è±¡loop.call_at(when, callback, *args, context=None)å³åœ¨æŸä¸€ä¸ªæ—¶åˆ»è¿›è¡Œè°ƒç”¨è®¡åˆ’çš„å›è°ƒå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸å†æ˜¯delayè€Œæ˜¯whenï¼Œè¡¨ç¤ºä¸€ä¸ªç»å¯¹çš„æ—¶é—´ç‚¹ï¼Œç»“åˆå‰é¢çš„loop.timeä½¿ç”¨ï¼Œå®ƒçš„ä½¿ç”¨æ–¹æ³•å’Œcall_later()å¾ˆç±»ä¼¼ã€‚å®ƒçš„è¿”å›å€¼æ˜¯asyncio.TimerHandleç±»çš„ä¸€ä¸ªå®ä¾‹å¯¹è±¡loop.call_soon(callback, *args, context=None)åœ¨ä¸‹ä¸€ä¸ªè¿­ä»£çš„æ—¶é—´å¾ªç¯ä¸­ç«‹åˆ»è°ƒç”¨å›è°ƒå‡½æ•°ï¼Œç”¨æ³•åŒä¸Šé¢ã€‚å®ƒçš„è¿”å›å€¼æ˜¯asyncio.Handleç±»çš„ä¸€ä¸ªå®ä¾‹å¯¹è±¡loop.call_soon_threadsafe(callback, *args, context=None)è¿™æ˜¯call_soon()å‡½æ•°çš„çº¿ç¨‹å®‰å…¨ç‰ˆæœ¬ï¼Œè®¡åˆ’å›è°ƒå‡½æ•°å¿…é¡»åœ¨å¦ä¸€ä¸ªçº¿ç¨‹ä¸­ä½¿ç”¨éœ€è¦æ³¨æ„çš„æ˜¯ï¼šä¸Šé¢çš„å‡ ä¸ªå›è°ƒå‡½æ•°éƒ½åªä½¿ç”¨äº†â€œä½ç½®å‚æ•°â€å“¦ï¼Œasyncioä¸­ï¼Œå¤§éƒ¨åˆ†çš„è®¡åˆ’å›è°ƒå‡½æ•°éƒ½ä¸æ”¯æŒâ€œå…³é”®å­—å‚æ•°â€ï¼Œå¦‚æœæ˜¯æƒ³è¦ä½¿ç”¨å…³é”®å­—å‚æ•°ï¼Œåˆ™æ¨èä½¿ç”¨functools.aprtial()å¯¹æ–¹æ³•è¿›ä¸€æ­¥åŒ…è£…æ€»ç»“æ³¨æ„äº‹é¡¹CallBackå‡½æ•°åªèƒ½å¤Ÿå®šä¹‰ä¸ºåŒæ­¥æ–¹æ³•ï¼Œä¸èƒ½å¤Ÿå®šä¹‰ä¸ºasyncæ–¹æ³•ï¼ŒåŠä¸èƒ½ä½¿ç”¨asyncå’Œ@asyncio.coroutineä¿®é¥°æ¯ä¸€ä¸ªCallBackæ–¹æ³•åªä¼šè°ƒç”¨ä¸€æ¬¡ï¼Œå¦‚æœåœ¨åŒä¸€ä¸ªæ—¶åˆ»æœ‰å¦ä¸ªCallBackæ–¹æ³•éœ€è¦è°ƒç”¨ï¼Œåˆ™ä»–ä»¬çš„æ‰§è¡Œé¡ºåºæ˜¯ä¸ç¡®å®šçš„æ³¨æ„ä½¿ç”¨functools.partialï¼ˆï¼‰å»ä¿®é¥°å¸¦æœ‰å…³é”®å­—å‚æ•°çš„CallBackæ–¹æ³•å¦‚ä½•ç†è§£å¯¹äºä¸€èˆ¬çš„å¼‚æ­¥å‡½æ•°ï¼Œæˆ‘ä»¬éœ€è¦å°†å®ƒæ”¾åœ¨æ—¶é—´å¾ªç¯é‡Œé¢ï¼Œç„¶åé€šè¿‡äº‹ä»¶å¾ªç¯å»å¾ªç¯è°ƒç”¨å®ƒï¼Œè€Œå› ä¸ºCallBackå¹¶ä¸æ˜¯å¼‚æ­¥å‡½æ•°å®ƒæ˜¯å®šä¹‰ä¸ºæ™®é€šçš„åŒæ­¥æ–¹æ³•ï¼Œæ‰€ä»¥ä¸èƒ½å¤Ÿæ”¾åœ¨æ—¶é—´å¾ªç¯é‡Œé¢ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä¾ç„¶æƒ³è¦è®©äº‹ä»¶å¾ªç¯å»æ‰§è¡Œå®ƒæ€ä¹ˆåŠå‘¢é‚£å°±ä¸æ”¾è¿›äº‹ä»¶å¾ªç¯ï¼Œç›´æ¥è®©äº‹ä»¶å¾ªç¯â€œç«‹å³ã€ç¨åã€åœ¨ä»€ä¹ˆæ—¶å€™â€å»æ‰§è¡Œå®ƒä¸å°±è¡Œäº†å˜›ï¼Œcallçš„å«ä¹‰å°±æ˜¯â€œæ‰§è¡Œâ€æ¶ˆæ¯é˜Ÿåˆ—rabbitmqå’Œredisç”¨ä½œæ¶ˆæ¯é˜Ÿåˆ—çš„åŒºåˆ«åŸºæœ¬ä½¿ç”¨åç¨‹å…¥é—¨ä¾‹å­123456789101112131415161718192021222324252627import timeimport asynciodef main():    start = time.time()    @asyncio.coroutine  # 1    def do_some_work():  # 2        print('Start coroutine')        time.sleep(0.1)  # 3        print('This is a coroutine')    loop = asyncio.get_event_loop()  # 4    coroutine = do_some_work()  # 5    loop.run_until_complete(coroutine)  # 6    end = time.time()    print('è¿è¡Œè€—æ—¶ï¼š{:.4f}'.format(end - start))  # 7main()In [53]: one()Start coroutineThis is a coroutineè¿è¡Œè€—æ—¶ï¼š0.1062ä»£ç è¯´æ˜ï¼š1ã€ä½¿ç”¨åç¨‹è£…é¥°å™¨åˆ›å»ºåç¨‹å‡½æ•°2ã€åç¨‹å‡½æ•°3ã€æ¨¡æ‹Ÿ IO æ“ä½œ4ã€åˆ›å»ºäº‹ä»¶å¾ªç¯ã€‚æ¯ä¸ªçº¿ç¨‹ä¸­åªèƒ½æœ‰ä¸€ä¸ªäº‹ä»¶å¾ªç¯ï¼Œget_event_loop æ–¹æ³•ä¼šè·å–å½“å‰å·²ç»å­˜åœ¨çš„äº‹ä»¶å¾ªç¯ï¼Œå¦‚æœå½“å‰çº¿ç¨‹ä¸­æ²¡æœ‰ï¼Œæ–°å»ºä¸€ä¸ª5ã€è°ƒç”¨åç¨‹å‡½æ•°è·å–åç¨‹å¯¹è±¡6ã€å°†åç¨‹å¯¹è±¡æ³¨å…¥åˆ°äº‹ä»¶å¾ªç¯ï¼Œåç¨‹çš„è¿è¡Œç”±äº‹ä»¶å¾ªç¯æ§åˆ¶ã€‚äº‹ä»¶å¾ªç¯çš„ run_until_complete æ–¹æ³•ä¼šé˜»å¡è¿è¡Œï¼Œç›´åˆ°ä»»åŠ¡å…¨éƒ¨å®Œæˆã€‚åç¨‹å¯¹è±¡ä½œä¸º run_until_complete æ–¹æ³•çš„å‚æ•°ï¼Œloop ä¼šè‡ªåŠ¨å°†åç¨‹å¯¹è±¡åŒ…è£…æˆä»»åŠ¡æ¥è¿è¡Œã€‚åé¢æˆ‘ä»¬ä¼šè®²åˆ°å¤šä¸ªä»»åŠ¡æ³¨å…¥äº‹ä»¶å¾ªç¯çš„æƒ…å†µ7ã€æ‰“å°ç¨‹åºè¿è¡Œè€—æ—¶å¼‚æ­¥å·¥å…·å‡½æ•°å¼‚æ­¥è½¬yieldå‡½æ•°12345678910111213141516171819202122async def get_next(ait):    try:        asy_obj = await ait.__anext__()        return False, asy_obj    except StopAsyncIteration:        return True, Nonedef iter_over_async(ait, loop):    &quot;&quot;&quot;    å¼‚æ­¥è½¬yield    @param ait: å¼‚æ­¥å‡½æ•°    @param loop: äº‹ä»¶å¾ªç¯    @return:    &quot;&quot;&quot;    ait = ait.__aiter__()    while True:        done, asy_obj = loop.run_until_complete(get_next(ait))        if done:            break        yield asy_objå¼‚æ­¥è°ƒç”¨postè¯·æ±‚1234567891011121314151617181920212223242526272829303132from json import JSONDecodeErrorfrom typing import Dict, Callableimport aiohttpasync def asy_http_post(url: str, param_dic: Dict, encoding=&quot;utf8&quot;, call_back: Callable = None):    &quot;&quot;&quot;    å¼‚æ­¥è°ƒç”¨postè¯·æ±‚    @param url: urlåœ°å€    @param param_dic: å‚æ•°å­—å…¸    @param encoding: ç¼–ç     @param call_back: å›è°ƒå‡½æ•°ï¼Œå¯¹ç»“æœçš„å¤„ç†    &quot;&quot;&quot;    async with aiohttp.ClientSession() as session:        async with session.post(url, json=param_dic) as response:            if response.status == 200:                async for data in response.content.iter_any():  # æ¯æ¬¡æ¥æ”¶å·²æœ‰çš„å…¨éƒ¨æ•°æ®                    # å¤„ç†æµå¼æ•°æ®                    try:                        yield call_back(data.decode(encoding)) if call_back else data.decode(encoding)                    except JSONDecodeError as e:                        # åœ¨è§£ç è¿‡ç¨‹ä¸­å‡ºç°å¼‚å¸¸ï¼Œå¤„ç†é”™è¯¯æƒ…å†µ                        print(f&quot;JSON decode error: {e}&quot;)                    except UnicodeDecodeError as e:                        # åœ¨è§£ç æ•°æ®æ—¶å‡ºç°ç¼–ç é”™è¯¯                        print(f&quot;Unicode decode error: {e}&quot;)                    except Exception as e:                        # å…¶ä»–å¼‚å¸¸                        print(f&quot;Error: {e}&quot;)            else:                print(&quot;è¯·æ±‚å¤±è´¥ï¼ŒçŠ¶æ€ç :&quot;, response.status)åç¨‹å¯¹è±¡è¿è¡Œåç¨‹å¯¹è±¡ä¸èƒ½ç›´æ¥è¿è¡Œï¼Œå¿…é¡»æ”¾å…¥äº‹ä»¶å¾ªç¯ä¸­æˆ–è€…ç”± yield from è¯­å¥è°ƒç”¨å°†åç¨‹å¯¹è±¡æ³¨å…¥äº‹ä»¶å¾ªç¯çš„æ—¶å€™ï¼Œå…¶å®æ˜¯ run_until_complete æ–¹æ³•å°†åç¨‹åŒ…è£…æˆäº†ä¸€ä¸ªä»»åŠ¡ï¼ˆtaskï¼‰å¯¹è±¡ï¼Œä»»åŠ¡å¯¹è±¡ä¿å­˜äº†åç¨‹è¿è¡Œåçš„çŠ¶æ€ï¼Œç”¨äºæœªæ¥è·å–åç¨‹çš„ç»“æœ12345678910111213141516171819202122232425262728293031import timeimport asynciodef main():    start = time.time()    @asyncio.coroutine    def do_some_work():        print('Start coroutine')        time.sleep(0.1)        print('This is a coroutine')    loop = asyncio.get_event_loop()    coroutine = do_some_work()    task = loop.create_task(coroutine)  # 1    print('task æ˜¯ä¸æ˜¯ asyncio.Task çš„å®ä¾‹?', isinstance(task, asyncio.Task))  # 2    print('Task state:', task._state)  # 3    loop.run_until_complete(task)  # 4    print('Task state:', task._state)    end = time.time()    print('è¿è¡Œè€—æ—¶ï¼š{:.4f}'.format(end - start))main()task æ˜¯ä¸æ˜¯ asyncio.Task çš„å®ä¾‹? TrueTask state: PENDINGStart coroutineThis is a coroutineTask state: FINISHEDè¿è¡Œè€—æ—¶ï¼š0.1052ä»£ç è¯´æ˜ï¼šäº‹ä»¶å¾ªç¯çš„ create_task æ–¹æ³•å¯ä»¥åˆ›å»ºä»»åŠ¡ï¼Œå¦å¤– asyncio.ensure_future æ–¹æ³•ä¹Ÿå¯ä»¥åˆ›å»ºä»»åŠ¡ï¼Œå‚æ•°é¡»ä¸ºåç¨‹å¯¹è±¡task æ˜¯ asyncio.Task ç±»çš„å®ä¾‹ï¼Œä¸ºä»€ä¹ˆè¦ä½¿ç”¨åç¨‹å¯¹è±¡åˆ›å»ºä»»åŠ¡ï¼Ÿå› ä¸ºåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ asyncio.Task åšäº†ä¸€äº›å·¥ä½œï¼ŒåŒ…æ‹¬é¢„æ¿€åç¨‹ã€åç¨‹è¿è¡Œä¸­é‡åˆ°æŸäº›å¼‚å¸¸æ—¶çš„å¤„ç†task å¯¹è±¡çš„ _state å±æ€§ä¿å­˜å½“å‰ä»»åŠ¡çš„è¿è¡ŒçŠ¶æ€ï¼Œä»»åŠ¡çš„è¿è¡ŒçŠ¶æ€æœ‰ PENDING å’Œ FINISHED ä¸¤ç§å°†ä»»åŠ¡æ³¨å…¥äº‹ä»¶å¾ªç¯ï¼Œé˜»å¡è¿è¡Œåœ¨ Python 3.5 ä¸­æ–°å¢äº† async / await å…³é”®å­—ç”¨æ¥å®šä¹‰åç¨‹å‡½æ•°è¿™ä¸¤ä¸ªå…³é”®å­—æ˜¯ä¸€ä¸ªç»„åˆï¼Œå…¶ä½œç”¨ç­‰åŒäº asyncio.coroutine è£…é¥°å™¨å’Œ yield from è¯­å¥ã€‚æ­¤ååç¨‹ä¸ç”Ÿæˆå™¨å°±å½»åº•æ³¾æ¸­åˆ†æ˜äº†ç»“æœè·å–é€šè¿‡resultè·å–12345678910111213141516171819202122import asyncioasync def hello1(a, b):    print(&quot;Hello world 01 begin&quot;)    await asyncio.sleep(3)  # æ¨¡æ‹Ÿè€—æ—¶ä»»åŠ¡3ç§’    print(&quot;Hello again 01 end&quot;)    return a + bcoroutine = hello1(10, 5)loop = asyncio.get_event_loop()  # ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºäº‹ä»¶å¾ªç¯task = asyncio.ensure_future(coroutine)  # ç¬¬äºŒæ­¥:å°†å¤šä¸ªåç¨‹å‡½æ•°åŒ…è£…æˆä»»åŠ¡åˆ—è¡¨loop.run_until_complete(task)  # ç¬¬ä¸‰æ­¥ï¼šé€šè¿‡äº‹ä»¶å¾ªç¯è¿è¡Œprint('-------------------------------------')print(task.result())loop.close()'''è¿è¡Œç»“æœä¸ºHello world 01 beginHello again 01 end-------------------------------------15'''å›è°ƒç»‘å®šæœ‰äº† asyncio / await å…³é”®å­—ï¼Œæˆ‘ä»¬ç»§ç»­å­¦ä¹  asyncio æ¨¡å—çš„åŸºæœ¬åŠŸèƒ½ã€‚å‡å¦‚åç¨‹åŒ…å«ä¸€ä¸ª IO æ“ä½œï¼ˆè¿™å‡ ä¹æ˜¯è‚¯å®šçš„ï¼‰ï¼Œç­‰å®ƒå¤„ç†å®Œæ•°æ®åï¼Œæˆ‘ä»¬å¸Œæœ›å¾—åˆ°é€šçŸ¥ï¼Œä»¥ä¾¿ä¸‹ä¸€æ­¥æ•°æ®å¤„ç†è¿™ä¸€éœ€æ±‚å¯ä»¥é€šè¿‡å‘ future å¯¹è±¡ä¸­æ·»åŠ å›è°ƒæ¥å®ç°é‚£ä¹ˆä»€ä¹ˆæ˜¯ future å¯¹è±¡task å¯¹è±¡å°±æ˜¯ future å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·è®¤ä¸ºï¼Œå› ä¸º asyncio.Task æ˜¯ asyncio.Future çš„å­ç±»ä¹Ÿå°±æ˜¯è¯´ï¼Œtask å¯¹è±¡å¯ä»¥æ·»åŠ å›è°ƒå‡½æ•°å›è°ƒå‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•°æ˜¯ future æˆ– task å¯¹è±¡ï¼Œé€šè¿‡è¯¥å¯¹è±¡å¯ä»¥è·å–åç¨‹è¿”å›å€¼å¦‚æœå›è°ƒéœ€è¦å¤šä¸ªå‚æ•°ï¼Œå¯ä»¥é€šè¿‡åå‡½æ•°å¯¼å…¥ç®€è¨€ä¹‹ï¼Œä¸€ä¸ªä»»åŠ¡å®Œæˆåéœ€è¦æå¸¦è¿è¡Œçš„ä»£ç å¯ä»¥æ”¾åˆ°å›è°ƒå‡½æ•°ä¸­ä¿®æ”¹ä¸Šä¸€ä¸ªç¨‹åºå¦‚ä¸‹ï¼š12345678910111213141516171819202122232425262728293031In [64]: def three():    ...:     start = time.time()    ...:    ...:     # @asyncio.coroutine    ...:     async def corowork():      # 1    ...:         print('[corowork] Start coroutine')    ...:         time.sleep(0.1)    ...:         print('[corowork] This is a coroutine')    ...:    ...:     def callback(name, task):  # 2     ...:         print('[callback] Hello {}'.format(name))    ...:         print('[callback] coroutine state: {}'.format(task._state))    ...:    ...:     loop = asyncio.get_event_loop()    ...:     coroutine = corowork()    ...:     task = loop.create_task(coroutine)    ...:     task.add_done_callback(functools.partial(callback, 'Shiyanlou'))  # 3    ...:     loop.run_until_complete(task)    ...:    ...:     end = time.time()    ...:     print('è¿è¡Œè€—æ—¶ï¼š{:.4f}'.format(end - start))    ...:In [65]: import functoolsIn [66]: three()[corowork] Start coroutine[corowork] This is a coroutine[callback] Hello Shiyanlou[callback] coroutine state: FINISHEDè¿è¡Œè€—æ—¶ï¼š0.1051ä»£ç è¯´æ˜ï¼šä½¿ç”¨ async å…³é”®å­—æ›¿ä»£ asyncio.coroutine è£…é¥°å™¨åˆ›å»ºåç¨‹å‡½æ•°å›è°ƒå‡½æ•°ï¼Œåç¨‹ç»ˆæ­¢åéœ€è¦é¡ºä¾¿è¿è¡Œçš„ä»£ç å†™å…¥è¿™é‡Œï¼Œå›è°ƒå‡½æ•°çš„å‚æ•°æœ‰è¦æ±‚ï¼Œæœ€åä¸€ä¸ªä½ç½®å‚æ•°é¡»ä¸º task å¯¹è±¡task å¯¹è±¡çš„ add_done_callback æ–¹æ³•å¯ä»¥æ·»åŠ å›è°ƒå‡½æ•°ï¼Œæ³¨æ„å‚æ•°å¿…é¡»æ˜¯å›è°ƒå‡½æ•°ï¼Œè¿™ä¸ªæ–¹æ³•ä¸èƒ½ä¼ å…¥å›è°ƒå‡½æ•°çš„å‚æ•°ï¼Œè¿™ä¸€ç‚¹éœ€è¦é€šè¿‡ functools æ¨¡å—çš„ partial æ–¹æ³•è§£å†³ï¼Œå°†å›è°ƒå‡½æ•°å’Œå…¶å‚æ•° name ä½œä¸º partial æ–¹æ³•çš„å‚æ•°ï¼Œæ­¤æ–¹æ³•çš„è¿”å›å€¼å°±æ˜¯åå‡½æ•°ï¼Œåå‡½æ•°å¯ä½œä¸º task.add_done_callback æ–¹æ³•çš„å‚æ•°å¼‚æ­¥è¿­ä»£å™¨ä»€ä¹ˆæ˜¯å¼‚æ­¥è¿­ä»£å™¨å®ç°äº† __aiter__() å’Œ __anext__() æ–¹æ³•çš„å¯¹è±¡ã€‚__anext__ å¿…é¡»è¿”å›ä¸€ä¸ª awaitable å¯¹è±¡ã€‚async for ä¼šå¤„ç†å¼‚æ­¥è¿­ä»£å™¨çš„ __anext__() æ–¹æ³•æ‰€è¿”å›çš„å¯ç­‰å¾…å¯¹è±¡ï¼Œç›´åˆ°å…¶å¼•å‘ä¸€ä¸ª StopAsyncIteration å¼‚å¸¸ã€‚ç”± PEP 492 å¼•å…¥ã€‚ä»€ä¹ˆæ˜¯å¼‚æ­¥å¯è¿­ä»£å¯¹è±¡å¯åœ¨ async for è¯­å¥ä¸­è¢«ä½¿ç”¨çš„å¯¹è±¡ã€‚å¿…é¡»é€šè¿‡å®ƒçš„ __aiter__() æ–¹æ³•è¿”å›ä¸€ä¸ª asynchronous iteratorã€‚ç”± PEP 492 å¼•å…¥ã€‚12345678910111213141516171819202122232425import asyncioclass Reader(object):    &quot;&quot;&quot; è‡ªå®šä¹‰å¼‚æ­¥è¿­ä»£å™¨ï¼ˆåŒæ—¶ä¹Ÿæ˜¯å¼‚æ­¥å¯è¿­ä»£å¯¹è±¡ï¼‰ &quot;&quot;&quot;    def __init__(self):        self.count = 0    async def readline(self):        # await asyncio.sleep(1)        self.count += 1        if self.count == 100:            return None        return self.count    def __aiter__(self):        return self    async def __anext__(self):        val = await self.readline()        if val == None:            raise StopAsyncIteration        return valasync def func():    # åˆ›å»ºå¼‚æ­¥å¯è¿­ä»£å¯¹è±¡    async_iter = Reader()    # async for å¿…é¡»è¦æ”¾åœ¨async defå‡½æ•°å†…ï¼Œå¦åˆ™è¯­æ³•é”™è¯¯ã€‚    async for item in async_iter:        print(item)asyncio.run(func())å¼‚æ­¥è¿­ä»£å™¨å…¶å®æ²¡ä»€ä¹ˆå¤ªå¤§çš„ä½œç”¨ï¼Œåªæ˜¯æ”¯æŒäº†async forè¯­æ³•è€Œå·²å¼‚æ­¥ä¸Šä¸‹æ–‡ç®¡ç†å™¨æ­¤ç§å¯¹è±¡é€šè¿‡å®šä¹‰ __aenter__() å’Œ __aexit__() æ–¹æ³•æ¥å¯¹ async with è¯­å¥ä¸­çš„ç¯å¢ƒè¿›è¡Œæ§åˆ¶ã€‚ç”± PEP 492 å¼•å…¥12345678910111213141516171819import asyncioclass AsyncContextManager:    def __init__(self):        self.conn = None    async def do_something(self):        # å¼‚æ­¥æ“ä½œæ•°æ®åº“        return 666    async def __aenter__(self):        # å¼‚æ­¥é“¾æ¥æ•°æ®åº“        self.conn = await asyncio.sleep(1)        return self    async def __aexit__(self, exc_type, exc, tb):        # å¼‚æ­¥å…³é—­æ•°æ®åº“é“¾æ¥        await asyncio.sleep(1)async def func():    async with AsyncContextManager() as f:        result = await f.do_something()        print(result)asyncio.run(func())å¼‚æ­¥ä¸Šä¸‹æ–‡ç®¡ç†å™¨è¿˜æ˜¯æ¯”è¾ƒæœ‰ç”¨çš„ï¼Œå¹³æ—¶åœ¨å¼€å‘è¿‡ç¨‹ä¸­ æ‰“å¼€ã€å¤„ç†ã€å…³é—­ æ“ä½œæ—¶ï¼Œå°±å¯ä»¥ç”¨è¿™ç§æ–¹å¼æ¥å¤„ç†è¿›é˜¶ä½¿ç”¨uvloopuvloopæ˜¯ asyncio ä¸­çš„äº‹ä»¶å¾ªç¯çš„æ›¿ä»£æ–¹æ¡ˆï¼Œæ›¿æ¢åå¯ä»¥ä½¿å¾—asyncioæ€§èƒ½æé«˜uvloopå®ç°äº†asyncio.AbstractEventLoopæ¥å£ï¼Œè¿™æ„å‘³ç€å®ƒæä¾›äº†asyncioäº‹ä»¶å¾ªç¯çš„ç›´æ¥æ›¿æ¢ äº‹å®ä¸Šï¼Œuvloopè¦æ¯”nodejsã€geventç­‰å…¶ä»–pythonå¼‚æ­¥æ¡†æ¶è‡³å°‘è¦å¿«2å€ï¼Œæ€§èƒ½å¯ä»¥æ¯”è‚©Goè¯­è¨€å®‰è£…uvloop: pip3 install uvloopåœ¨é¡¹ç›®ä¸­æƒ³è¦ä½¿ç”¨uvloopæ›¿æ¢asyncioçš„äº‹ä»¶å¾ªç¯ä¹Ÿéå¸¸ç®€å•ï¼Œåªè¦åœ¨ä»£ç ä¸­è¿™ä¹ˆåšå°±è¡Œ123456import asyncioimport uvloopasyncio.set_event_loop_policy(uvloop.EventLoopPolicy())# ç¼–å†™asyncioçš„ä»£ç ï¼Œä¸ä¹‹å‰å†™çš„ä»£ç ä¸€è‡´ã€‚# å†…éƒ¨çš„äº‹ä»¶å¾ªç¯è‡ªåŠ¨åŒ–ä¼šå˜ä¸ºuvloopasyncio.run(...)æ³¨æ„ï¼šçŸ¥åçš„asgi uvicornå†…éƒ¨å°±æ˜¯ä½¿ç”¨çš„uvloopçš„äº‹ä»¶å¾ªç¯ uvloopç”¨Cythonç¼–å†™ï¼Œå¹¶å»ºç«‹åœ¨libuvä¹‹ä¸Šã€‚libuvæ˜¯nodejsä½¿ç”¨çš„é«˜æ€§èƒ½ï¼Œå¤šå¹³å°å¼‚æ­¥I/Oåº“ã€‚ç”±äºnodejsçš„æ™®åŠå’Œæµè¡Œï¼Œlibuvæ—¢å¿«é€Ÿåˆç¨³å®šã€‚uvloopå®ç°æ‰€æœ‰å¼‚æ­¥äº‹ä»¶å¾ªç¯APIã€‚é«˜çº§Pythonå¯¹è±¡åŒ…è£…äº†ä½çº§libuvç»“æ„å’Œå‡½æ•°ã€‚ç»§æ‰¿ç”¨äºä¿æŒä»£ç DRYå¹¶ç¡®ä¿ä»»ä½•æ‰‹åŠ¨å†…å­˜ç®¡ç†ä¸libuvåŸè¯­çš„å¯¿å‘½ä¿æŒåŒæ­¥ã€‚asyncioé™„å¸¦ä¸‹åˆ—å†…ç½®ç­–ç•¥:class asyncio.``DefaultEventLoopPolicyé»˜è®¤asyncioç­–ç•¥ã€‚åœ¨Unixå’ŒWindowså¹³å°ä¸Šéƒ½ä½¿ç”¨ SelectorEventLoop ä¸éœ€è¦æ‰‹åŠ¨å®‰è£…é»˜è®¤ç­–ç•¥ï¼Œasyncioå·²é…ç½®æˆè‡ªåŠ¨ä½¿ç”¨é»˜è®¤ç­–ç•¥ã€‚class asyncio.``WindowsProactorEventLoopPolicyä½¿ç”¨ ProactorEventLoop äº‹ä»¶å¾ªç¯å®ç°çš„å¦ä¸€ç§äº‹ä»¶å¾ªç¯ç­–ç•¥ï¼Œå¯ç”¨æ€§: Windowsè‡ªå®šä¹‰ç­–ç•¥è¦å®ç°ä¸€ä¸ªæ–°çš„äº‹ä»¶å¾ªç¯ç­–ç•¥ï¼Œå»ºè®®å­ç±»åŒ– DefaultEventLoopPolicy å¹¶é‡å†™éœ€è¦å®šåˆ¶è¡Œä¸ºçš„æ–¹æ³•1234567891011class MyEventLoopPolicy(asyncio.DefaultEventLoopPolicy):    def get_event_loop(self):        &quot;&quot;&quot;Get the event loop.        This may be None or an instance of EventLoop.        &quot;&quot;&quot;        loop = super().get_event_loop()        # Do something with loop ...        return loopasyncio.set_event_loop_policy(MyEventLoopPolicy())å¼‚æ­¥Rediså½“é€šè¿‡pythonå»æ“ä½œredisæ—¶ï¼Œé“¾æ¥ã€è®¾ç½®å€¼ã€è·å–å€¼ è¿™äº›éƒ½æ¶‰åŠç½‘ç»œIOè¯·æ±‚ä½¿ç”¨asycioå¼‚æ­¥çš„æ–¹å¼å¯ä»¥åœ¨IOç­‰å¾…æ—¶å»åšä¸€äº›å…¶ä»–ä»»åŠ¡ï¼Œä»è€Œæå‡æ€§èƒ½å®‰è£…Pythonå¼‚æ­¥æ“ä½œredisæ¨¡å—ï¼špip3 install aioredisç¤ºä¾‹1ï¼šå¼‚æ­¥æ“ä½œredis123456789101112131415161718#!/usr/bin/env python# -*- coding:utf-8 -*-import asyncioimport aioredisasync def execute(address, password):    print(&quot;å¼€å§‹æ‰§è¡Œ&quot;, address)    # ç½‘ç»œIOæ“ä½œï¼šåˆ›å»ºredisè¿æ¥    redis = await aioredis.create_redis(address, password=password)    # ç½‘ç»œIOæ“ä½œï¼šåœ¨redisä¸­è®¾ç½®å“ˆå¸Œå€¼carï¼Œå†…éƒ¨åœ¨è®¾ä¸‰ä¸ªé”®å€¼å¯¹ï¼Œå³ï¼š redis = { car:{key1:1,key2:2,key3:3}}    await redis.hmset_dict('car', key1=1, key2=2, key3=3)    # ç½‘ç»œIOæ“ä½œï¼šå»redisä¸­è·å–å€¼    result = await redis.hgetall('car', encoding='utf-8')    print(result)    redis.close()    # ç½‘ç»œIOæ“ä½œï¼šå…³é—­redisè¿æ¥    await redis.wait_closed()    print(&quot;ç»“æŸ&quot;, address)asyncio.run(execute('redis://47.93.4.198:6379', &quot;root!2345&quot;))ç¤ºä¾‹2ï¼šè¿æ¥å¤šä¸ªredisåšæ“ä½œï¼ˆé‡åˆ°IOä¼šåˆ‡æ¢å…¶ä»–ä»»åŠ¡ï¼Œæä¾›äº†æ€§èƒ½ï¼‰1234567891011121314151617181920import asyncioimport aioredisasync def execute(address, password):    print(&quot;å¼€å§‹æ‰§è¡Œ&quot;, address)    # ç½‘ç»œIOæ“ä½œï¼šå…ˆå»è¿æ¥ 47.93.4.197:6379ï¼Œé‡åˆ°IOåˆ™è‡ªåŠ¨åˆ‡æ¢ä»»åŠ¡ï¼Œå»è¿æ¥47.93.4.198:6379    redis = await aioredis.create_redis_pool(address, password=password)    # ç½‘ç»œIOæ“ä½œï¼šé‡åˆ°IOä¼šè‡ªåŠ¨åˆ‡æ¢ä»»åŠ¡    await redis.hmset_dict('car', key1=1, key2=2, key3=3)    # ç½‘ç»œIOæ“ä½œï¼šé‡åˆ°IOä¼šè‡ªåŠ¨åˆ‡æ¢ä»»åŠ¡    result = await redis.hgetall('car', encoding='utf-8')    print(result)    redis.close()    # ç½‘ç»œIOæ“ä½œï¼šé‡åˆ°IOä¼šè‡ªåŠ¨åˆ‡æ¢ä»»åŠ¡    await redis.wait_closed()    print(&quot;ç»“æŸ&quot;, address)task_list = [    execute('redis://47.93.4.197:6379', &quot;root!2345&quot;),    execute('redis://47.93.4.198:6379', &quot;root!2345&quot;)]asyncio.run(asyncio.wait(task_list)) æ›´å¤šredisæ“ä½œå‚è€ƒaiorediså®˜ç½‘å¼‚æ­¥MySQLå½“é€šè¿‡pythonå»æ“ä½œMySQLæ—¶ï¼Œè¿æ¥ã€æ‰§è¡ŒSQLã€å…³é—­éƒ½æ¶‰åŠç½‘ç»œIOè¯·æ±‚ä½¿ç”¨asycioå¼‚æ­¥çš„æ–¹å¼å¯ä»¥åœ¨IOç­‰å¾…æ—¶å»åšä¸€äº›å…¶ä»–ä»»åŠ¡ï¼Œä»è€Œæå‡æ€§èƒ½å®‰è£…Pythonå¼‚æ­¥æ“ä½œmysqlæ¨¡å—ï¼špip3 install aiomysqlç¤ºä¾‹1ï¼š12345678910111213141516import asyncioimport aiomysqlasync def execute():    # ç½‘ç»œIOæ“ä½œï¼šè¿æ¥MySQL    conn = await aiomysql.connect(host='127.0.0.1', port=3306, user='root', password='123', db='mysql', )    # ç½‘ç»œIOæ“ä½œï¼šåˆ›å»ºCURSOR    cur = await conn.cursor()    # ç½‘ç»œIOæ“ä½œï¼šæ‰§è¡ŒSQL    await cur.execute(&quot;SELECT Host,User FROM user&quot;)    # ç½‘ç»œIOæ“ä½œï¼šè·å–SQLç»“æœ    result = await cur.fetchall()    print(result)    # ç½‘ç»œIOæ“ä½œï¼šå…³é—­é“¾æ¥    await cur.close()    conn.close()asyncio.run(execute())ç¤ºä¾‹2ï¼š123456789101112131415161718192021222324#!/usr/bin/env python# -*- coding:utf-8 -*-import asyncioimport aiomysqlasync def execute(host, password):    print(&quot;å¼€å§‹&quot;, host)    # ç½‘ç»œIOæ“ä½œï¼šå…ˆå»è¿æ¥ 47.93.40.197ï¼Œé‡åˆ°IOåˆ™è‡ªåŠ¨åˆ‡æ¢ä»»åŠ¡ï¼Œå»è¿æ¥47.93.40.198:6379    conn = await aiomysql.connect(host=host, port=3306, user='root', password=password, db='mysql')    # ç½‘ç»œIOæ“ä½œï¼šé‡åˆ°IOä¼šè‡ªåŠ¨åˆ‡æ¢ä»»åŠ¡    cur = await conn.cursor()    # ç½‘ç»œIOæ“ä½œï¼šé‡åˆ°IOä¼šè‡ªåŠ¨åˆ‡æ¢ä»»åŠ¡    await cur.execute(&quot;SELECT Host,User FROM user&quot;)    # ç½‘ç»œIOæ“ä½œï¼šé‡åˆ°IOä¼šè‡ªåŠ¨åˆ‡æ¢ä»»åŠ¡    result = await cur.fetchall()    print(result)    # ç½‘ç»œIOæ“ä½œï¼šé‡åˆ°IOä¼šè‡ªåŠ¨åˆ‡æ¢ä»»åŠ¡    await cur.close()    conn.close()    print(&quot;ç»“æŸ&quot;, host)task_list = [    execute('47.93.40.197', &quot;root!2345&quot;),    execute('47.93.40.197', &quot;root!2345&quot;)]asyncio.run(asyncio.wait(task_list))FastAPIæ¡†æ¶FastAPIæ˜¯ä¸€æ¬¾ç”¨äºæ„å»ºAPIçš„é«˜æ€§èƒ½webæ¡†æ¶ï¼Œæ¡†æ¶åŸºäºPython3.6+çš„ type hintsæ­å»ºæ¥ä¸‹é‡Œçš„å¼‚æ­¥ç¤ºä¾‹ä»¥FastAPIå’Œuvicornæ¥è®²è§£ï¼ˆuvicornæ˜¯ä¸€ä¸ªæ”¯æŒå¼‚æ­¥çš„asgiï¼‰å®‰è£…FastAPI web æ¡†æ¶ï¼špip3 install fastapiå®‰è£…uvicornï¼špip3 install uvicornæœ¬è´¨ä¸Šä¸ºwebæä¾›socket serverçš„æ”¯æŒçš„asgiï¼ˆä¸€èˆ¬æ”¯æŒå¼‚æ­¥ç§°asgiã€ä¸æ”¯æŒå¼‚æ­¥ç§°wsgiï¼‰ç¤ºä¾‹ï¼š12345678910111213141516171819202122232425262728293031#!/usr/bin/env python# -*- coding:utf-8 -*-import asyncioimport uvicornimport aioredisfrom aioredis import Redisfrom fastapi import FastAPIapp = FastAPI()REDIS_POOL = aioredis.ConnectionsPool('redis://47.193.14.198:6379', password=&quot;root123&quot;, minsize=1, maxsize=10)@app.get(&quot;/&quot;)def index():    &quot;&quot;&quot; æ™®é€šæ“ä½œæ¥å£ &quot;&quot;&quot;    return {&quot;message&quot;: &quot;Hello World&quot;}@app.get(&quot;/red&quot;)async def red():    &quot;&quot;&quot; å¼‚æ­¥æ“ä½œæ¥å£ &quot;&quot;&quot;    print(&quot;è¯·æ±‚æ¥äº†&quot;)    await asyncio.sleep(3)    # è¿æ¥æ± è·å–ä¸€ä¸ªè¿æ¥    conn = await REDIS_POOL.acquire()    redis = Redis(conn)    # è®¾ç½®å€¼    await redis.hmset_dict('car', key1=1, key2=2, key3=3)    # è¯»å–å€¼    result = await redis.hgetall('car', encoding='utf-8')    print(result)    # è¿æ¥å½’è¿˜è¿æ¥æ±     REDIS_POOL.release(conn)    return resultif __name__ == '__main__':    uvicorn.run(&quot;luffy:app&quot;, host=&quot;127.0.0.1&quot;, port=5000, log_level=&quot;info&quot;)åœ¨æœ‰å¤šä¸ªç”¨æˆ·å¹¶å‘è¯·æ±‚çš„æƒ…å†µä¸‹ï¼Œå¼‚æ­¥æ–¹å¼æ¥ç¼–å†™çš„æ¥å£å¯ä»¥åœ¨IOç­‰å¾…è¿‡ç¨‹ä¸­å»å¤„ç†å…¶ä»–çš„è¯·æ±‚ï¼Œæä¾›æ€§èƒ½ã€‚ä¾‹å¦‚ï¼šåŒæ—¶æœ‰ä¸¤ä¸ªç”¨æˆ·å¹¶å‘æ¥å‘æ¥å£ http://127.0.0.1:5000/red å‘é€è¯·æ±‚ï¼ŒæœåŠ¡ç«¯åªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼ŒåŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªè¯·æ±‚è¢«å¤„ç†å¼‚æ­¥å¤„ç†å¯ä»¥æä¾›å¹¶å‘æ˜¯å› ä¸ºï¼šå½“è§†å›¾å‡½æ•°åœ¨å¤„ç†ç¬¬ä¸€ä¸ªè¯·æ±‚æ—¶ï¼Œç¬¬äºŒä¸ªè¯·æ±‚æ­¤æ—¶æ˜¯ç­‰å¾…è¢«å¤„ç†çš„çŠ¶æ€ï¼Œå½“ç¬¬ä¸€ä¸ªè¯·æ±‚é‡åˆ°IOç­‰å¾…æ—¶ï¼Œä¼šè‡ªåŠ¨åˆ‡æ¢å»æ¥æ”¶å¹¶å¤„ç†ç¬¬äºŒä¸ªè¯·æ±‚ï¼Œå½“é‡åˆ°IOæ—¶è‡ªåŠ¨åŒ–åˆ‡æ¢è‡³å…¶ä»–è¯·æ±‚ï¼Œä¸€æ—¦æœ‰è¯·æ±‚IOæ‰§è¡Œå®Œæ¯•ï¼Œåˆ™ä¼šå†æ¬¡å›åˆ°æŒ‡å®šè¯·æ±‚å‘ä¸‹ç»§ç»­æ‰§è¡Œå…¶åŠŸèƒ½ä»£ç ã€‚åŸºäºä¸Šä¸‹æ–‡ç®¡ç†ï¼Œæ¥å®ç°è‡ªåŠ¨åŒ–ç®¡ç†çš„æ¡ˆä¾‹ç¤ºä¾‹1ï¼šredis123456789101112131415161718192021222324252627#!/usr/bin/env python# -*- coding:utf-8 -*-import asyncioimport uvicornimport aioredisfrom aioredis import Redisfrom fastapi import FastAPIapp = FastAPI()REDIS_POOL = aioredis.ConnectionsPool('redis://47.193.14.198:6379', password=&quot;root123&quot;, minsize=1, maxsize=10)@app.get(&quot;/&quot;)def index():    &quot;&quot;&quot; æ™®é€šæ“ä½œæ¥å£ &quot;&quot;&quot;    return {&quot;message&quot;: &quot;Hello World&quot;}@app.get(&quot;/red&quot;)async def red():    &quot;&quot;&quot; å¼‚æ­¥æ“ä½œæ¥å£ &quot;&quot;&quot;    print(&quot;è¯·æ±‚æ¥äº†&quot;)    async with REDIS_POOL.get() as conn:        redis = Redis(conn)        # è®¾ç½®å€¼        await redis.hmset_dict('car', key1=1, key2=2, key3=3)        # è¯»å–å€¼        result = await redis.hgetall('car', encoding='utf-8')        print(result)    return resultif __name__ == '__main__':    uvicorn.run(&quot;fast3:app&quot;, host=&quot;127.0.0.1&quot;, port=5000, log_level=&quot;info&quot;)ç¤ºä¾‹2ï¼šmysql12345678910111213141516171819202122232425#!/usr/bin/env python# -*- coding:utf-8 -*-import asyncioimport uvicornfrom fastapi import FastAPIimport aiomysqlapp = FastAPI()# åˆ›å»ºæ•°æ®åº“è¿æ¥æ± pool = aiomysql.Pool(host='127.0.0.1', port=3306, user='root', password='123', db='mysql',                     minsize=1, maxsize=10, echo=False, pool_recycle=-1, loop=asyncio.get_event_loop())@app.get(&quot;/red&quot;)async def red():    &quot;&quot;&quot; å¼‚æ­¥æ“ä½œæ¥å£ &quot;&quot;&quot;    # å»æ•°æ®åº“è¿æ¥æ± ç”³è¯·é“¾æ¥    async with pool.acquire() as conn:        async with conn.cursor() as cur:            # ç½‘ç»œIOæ“ä½œï¼šæ‰§è¡ŒSQL            await cur.execute(&quot;SELECT Host,User FROM user&quot;)            # ç½‘ç»œIOæ“ä½œï¼šè·å–SQLç»“æœ            result = await cur.fetchall()            print(result)            # ç½‘ç»œIOæ“ä½œï¼šå…³é—­é“¾æ¥    return {&quot;result&quot;: &quot;ok&quot;}if __name__ == '__main__':    uvicorn.run(&quot;fast2:app&quot;, host=&quot;127.0.0.1&quot;, port=5000, log_level=&quot;info&quot;)çˆ¬è™«åœ¨ç¼–å†™çˆ¬è™«åº”ç”¨æ—¶ï¼Œéœ€è¦é€šè¿‡ç½‘ç»œIOå»è¯·æ±‚ç›®æ ‡æ•°æ®ï¼Œè¿™ç§æƒ…å†µé€‚åˆä½¿ç”¨å¼‚æ­¥ç¼–ç¨‹æ¥æå‡æ€§èƒ½æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨æ”¯æŒå¼‚æ­¥ç¼–ç¨‹çš„aiohttpæ¨¡å—æ¥å®ç°å®‰è£…aiohttpæ¨¡å—: pip3 install aiohttpç¤ºä¾‹ï¼š123456789101112131415161718import aiohttpimport asyncioasync def fetch(session, url):    print(&quot;å‘é€è¯·æ±‚ï¼š&quot;, url)    async with session.get(url, verify_ssl=False) as response:        text = await response.text()        print(&quot;å¾—åˆ°ç»“æœï¼š&quot;, url, len(text))async def main():    async with aiohttp.ClientSession() as session:        url_list = [            'https://python.org',            'https://www.baidu.com',            'https://www.pythonav.com'        ]        tasks = [asyncio.create_task(fetch(session, url)) for url in url_list]        await asyncio.wait(tasks)if __name__ == '__main__':    asyncio.run(main())å¤šä»»åŠ¡å®é™…é¡¹ç›®ä¸­ï¼Œå¾€å¾€æœ‰å¤šä¸ªåç¨‹åˆ›å»ºå¤šä¸ªä»»åŠ¡å¯¹è±¡ï¼ŒåŒæ—¶åœ¨ä¸€ä¸ª loop é‡Œè¿è¡Œä¸ºäº†æŠŠå¤šä¸ªåç¨‹äº¤ç»™ loopï¼Œéœ€è¦å€ŸåŠ© asyncio.gather æ–¹æ³•ï¼Œä»»åŠ¡çš„ result æ–¹æ³•å¯ä»¥è·å¾—å¯¹åº”çš„åç¨‹å‡½æ•°çš„ return å€¼123456789101112131415161718192021222324252627282930In [67]: def four():    ...:     start = time.time()    ...:    ...:     async def corowork(name, t):    ...:         print('[corowork] Start coroutine', name)    ...:         await asyncio.sleep(t)                  # 1    ...:         print('[corowork] Stop coroutine', name)    ...:         return 'Coroutine {} OK'.format(name)   # 2    ...:    ...:     loop = asyncio.get_event_loop()    ...:     coroutine1 = corowork('ONE', 3)             # 3    ...:     coroutine2 = corowork('TWO', 1)             # 3    ...:     task1 = loop.create_task(coroutine1)        # 4    ...:     task2 = loop.create_task(coroutine2)        # 4    ...:     gather = asyncio.gather(task1, task2)       # 5    ...:     loop.run_until_complete(gather)             # 6    ...:     print('[task1] ', task1.result())           # 7    ...:     print('[task2] ', task2.result())           # 7    ...:    ...:     end = time.time()    ...:     print('è¿è¡Œè€—æ—¶ï¼š{:.4f}'.format(end - start))In [68]: four()[corowork] Start coroutine ONE[corowork] Start coroutine TWO[corowork] Stop coroutine TWO[corowork] Stop coroutine ONE[task1]  Coroutine ONE OK[task2]  Coroutine TWO OKè¿è¡Œè€—æ—¶ï¼š3.0070ä»£ç è¯´æ˜ï¼šawait å…³é”®å­—ç­‰åŒäº Python 3.4 ä¸­çš„ yield from è¯­å¥ï¼Œåé¢æ¥åç¨‹å¯¹è±¡ã€‚asyncio.sleep æ–¹æ³•çš„è¿”å›å€¼ä¸ºåç¨‹å¯¹è±¡ï¼Œè¿™ä¸€æ­¥ä¸ºé˜»å¡è¿è¡Œã€‚asyncio.sleep ä¸ time.sleep æ˜¯ä¸åŒçš„ï¼Œå‰è€…é˜»å¡å½“å‰åç¨‹ï¼Œå³ corowork å‡½æ•°çš„è¿è¡Œï¼Œè€Œ time.sleep ä¼šé˜»å¡æ•´ä¸ªçº¿ç¨‹ï¼Œæ‰€ä»¥è¿™é‡Œå¿…é¡»ç”¨å‰è€…ï¼Œé˜»å¡å½“å‰åç¨‹ï¼ŒCPU å¯ä»¥åœ¨çº¿ç¨‹å†…çš„å…¶å®ƒåç¨‹ä¸­æ‰§è¡Œåç¨‹å‡½æ•°çš„ return å€¼å¯ä»¥åœ¨åç¨‹è¿è¡Œç»“æŸåä¿å­˜åˆ°å¯¹åº”çš„ task å¯¹è±¡çš„ result æ–¹æ³•ä¸­åˆ›å»ºä¸¤ä¸ªåç¨‹å¯¹è±¡ï¼Œåœ¨åç¨‹å†…éƒ¨åˆ†åˆ«é˜»å¡ 3 ç§’å’Œ 1 ç§’åˆ›å»ºä¸¤ä¸ªä»»åŠ¡å¯¹è±¡å°†ä»»åŠ¡å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œasyncio.gather æ–¹æ³•åˆ›å»ºä»»åŠ¡æ”¶é›†å™¨ã€‚æ³¨æ„ï¼Œasyncio.gather æ–¹æ³•ä¸­å‚æ•°çš„é¡ºåºå†³å®šäº†åç¨‹çš„å¯åŠ¨é¡ºåºå°†ä»»åŠ¡æ”¶é›†å™¨ä½œä¸ºå‚æ•°ä¼ å…¥äº‹ä»¶å¾ªç¯çš„ run_until_complete æ–¹æ³•ï¼Œé˜»å¡è¿è¡Œï¼Œç›´åˆ°å…¨éƒ¨ä»»åŠ¡å®Œæˆä»»åŠ¡ç»“æŸåï¼Œäº‹ä»¶å¾ªç¯åœæ­¢ï¼Œæ‰“å°ä»»åŠ¡çš„ result æ–¹æ³•è¿”å›å€¼ï¼Œå³åç¨‹å‡½æ•°çš„ return å€¼åˆ°è¿™ä¸€æ­¥ï¼Œå¤§å®¶åº”è¯¥å¯ä»¥çœ‹å¾—å‡ºï¼Œä¸Šé¢çš„ä»£ç å·²ç»æ˜¯å¼‚æ­¥ç¼–ç¨‹çš„ç»“æ„äº†ï¼Œåœ¨äº‹ä»¶å¾ªç¯å†…éƒ¨ï¼Œä¸¤ä¸ªåç¨‹æ˜¯äº¤æ›¿è¿è¡Œå®Œæˆçš„ç®€å•å™è¿°ä¸€ä¸‹ç¨‹åºåç¨‹éƒ¨åˆ†çš„è¿è¡Œè¿‡ç¨‹ï¼šé¦–å…ˆè¿è¡Œ task1æ‰“å° [corowork] Start coroutine ONEé‡åˆ° asyncio.sleep é˜»å¡é‡Šæ”¾ CPU è½¬åˆ° task2 ä¸­æ‰§è¡Œæ‰“å° [corowork] Start coroutine TWOå†æ¬¡é‡åˆ° asyncio.sleep é˜»å¡è¿™æ¬¡æ²¡æœ‰å…¶å®ƒåç¨‹å¯ä»¥è¿è¡Œäº†ï¼Œåªèƒ½ç­‰é˜»å¡ç»“æŸtask2 çš„é˜»å¡æ—¶é—´è¾ƒçŸ­ï¼Œé˜»å¡ 1 ç§’åå…ˆç»“æŸï¼Œæ‰“å° [corowork] Stop coroutine TWOåˆè¿‡äº† 2 ç§’ï¼Œé˜»å¡ 3 ç§’çš„ task1 ä¹Ÿç»“æŸäº†é˜»å¡ï¼Œæ‰“å° [corowork] Stop coroutine ONEè‡³æ­¤ä¸¤ä¸ªä»»åŠ¡å…¨éƒ¨å®Œæˆï¼Œäº‹ä»¶å¾ªç¯åœæ­¢æ‰“å°ä¸¤ä¸ªä»»åŠ¡çš„ resultæ‰“å°ç¨‹åºè¿è¡Œæ—¶é—´ç¨‹åºå…¨éƒ¨ç»“æŸéœ€è¦é¢å¤–è¯´æ˜çš„å‡ ç‚¹ï¼šå¤šæ•°æƒ…å†µä¸‹æ— éœ€è°ƒç”¨ task çš„ add_done_callback æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥æŠŠå›è°ƒå‡½æ•°ä¸­çš„ä»£ç å†™å…¥ await è¯­å¥åé¢ï¼Œåç¨‹æ˜¯å¯ä»¥æš‚åœå’Œæ¢å¤çš„å¤šæ•°æƒ…å†µä¸‹åŒæ ·æ— éœ€è°ƒç”¨ task çš„ result æ–¹æ³•è·å–åç¨‹å‡½æ•°çš„ return å€¼ï¼Œå› ä¸ºäº‹ä»¶å¾ªç¯çš„ run_until_complete æ–¹æ³•çš„è¿”å›å€¼å°±æ˜¯åç¨‹å‡½æ•°çš„ return å€¼ã€‚ä¿®æ”¹ä¸Šæ–‡ # 6 ã€7 çš„ä»£ç å¦‚ä¸‹ï¼š12result = loop.run_until_complete(gather)print(result)å†æ¬¡è¿è¡Œç»“æœä¸ºï¼š1234567In [73]: four()[corowork] Start coroutine ONE[corowork] Start coroutine TWO[corowork] Stop coroutine TWO[corowork] Stop coroutine ONE['Coroutine ONE OK', 'Coroutine TWO OK']  # å˜é‡ result çš„å€¼è¿è¡Œè€—æ—¶ï¼š3.0045äº‹ä»¶å¾ªç¯æœ‰ä¸€ä¸ª stop æ–¹æ³•ç”¨æ¥åœæ­¢å¾ªç¯å’Œä¸€ä¸ª close æ–¹æ³•ç”¨æ¥å…³é—­å¾ªç¯ã€‚ä»¥ä¸Šç¤ºä¾‹ä¸­éƒ½æ²¡æœ‰è°ƒç”¨ loop.close æ–¹æ³•ï¼Œä¼¼ä¹å¹¶æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ã€‚æ‰€ä»¥åˆ°åº•è¦ä¸è¦è°ƒç”¨ loop.close å‘¢ï¼Ÿç®€å•æ¥è¯´ï¼Œloop åªè¦ä¸å…³é—­ï¼Œå°±è¿˜å¯ä»¥å†æ¬¡è¿è¡Œ run_until_complete æ–¹æ³•ï¼Œå…³é—­ååˆ™ä¸å¯è¿è¡Œã€‚æœ‰äººä¼šå»ºè®®è°ƒç”¨ loop.closeï¼Œå½»åº•æ¸…ç† loop å¯¹è±¡é˜²æ­¢è¯¯ç”¨ï¼Œå…¶å®å¤šæ•°æƒ…å†µä¸‹æ ¹æœ¬æ²¡æœ‰è¿™ä¸ªå¿…è¦asyncio æ¨¡å—æä¾›äº† asyncio.gather å’Œ asyncio.wait ä¸¤ä¸ªä»»åŠ¡æ”¶é›†æ–¹æ³•ï¼Œå®ƒä»¬çš„ä½œç”¨ç›¸åŒï¼Œéƒ½æ˜¯å°†åç¨‹ä»»åŠ¡æŒ‰é¡ºåºæ’å®šï¼Œå†å°†è¿”å›å€¼ä½œä¸ºå‚æ•°åŠ å…¥åˆ°äº‹ä»¶å¾ªç¯ä¸­å‰è€…åœ¨ä¸Šæ–‡å·²ç»ç”¨åˆ°ï¼Œåè€…ä¸å‰è€…çš„åŒºåˆ«æ˜¯å®ƒå¯ä»¥è·å–ä»»åŠ¡çš„æ‰§è¡ŒçŠ¶æ€ï¼ˆPENING &amp; FINISHEDï¼‰ï¼Œå½“æœ‰ä¸€äº›ç‰¹åˆ«çš„éœ€æ±‚ä¾‹å¦‚åœ¨æŸäº›æƒ…å†µä¸‹å–æ¶ˆä»»åŠ¡ï¼Œå¯ä»¥ä½¿ç”¨ asyncio.wait æ–¹æ³•ã€‚å¤šä»»åŠ¡å®ç°æ–¹å¼ä½¿ç”¨gatheråŒæ—¶æ³¨å†Œå¤šä¸ªä»»åŠ¡ï¼Œå®ç°å¹¶å‘awaitable asyncio.gather(**aws*, *loop=None*, *return_exceptions=False*)æ³¨æ„äº‹é¡¹ï¼šgatherçš„è¿”å›å€¼æ˜¯å®ƒæ‰€ç»‘å®šçš„æ‰€æœ‰ä»»åŠ¡çš„æ‰§è¡Œç»“æœï¼Œè€Œä¸”é¡ºåºæ˜¯ä¸å˜çš„ï¼Œå³è¿”å›çš„resultçš„é¡ºåºå’Œç»‘å®šçš„é¡ºåºæ˜¯ä¿æŒä¸€è‡´çš„é™¤æ­¤ä¹‹å¤–ï¼Œå®ƒæ˜¯awaitableçš„ï¼Œæ‰€ä»¥ï¼Œå¦‚æœéœ€è¦è·å–å¤šä¸ªä»»åŠ¡çš„è¿”å›å€¼ï¼Œæ—¢ç„¶æ˜¯awaitableçš„ï¼Œå°±éœ€è¦å°†å®ƒæ”¾åœ¨ä¸€ä¸ªå‡½æ•°é‡Œé¢ï¼Œæ‰€ä»¥æˆ‘ä»¬å¼•å…¥ä¸€ä¸ªåŒ…è£…å¤šä¸ªä»»åŠ¡çš„å…¥å£mainï¼Œè¿™ä¹Ÿæ˜¯python3.7çš„æ€æƒ³123456789101112131415161718192021222324252627282930313233343536373839404142434445import asyncioimport time async def hello1(a,b):    print(&quot;Hello world 01 begin&quot;)    await asyncio.sleep(3)  #æ¨¡æ‹Ÿè€—æ—¶ä»»åŠ¡3ç§’    print(&quot;Hello again 01 end&quot;)    return a+b async def hello2(a,b):    print(&quot;Hello world 02 begin&quot;)    await asyncio.sleep(2)   #æ¨¡æ‹Ÿè€—æ—¶ä»»åŠ¡2ç§’    print(&quot;Hello again 02 end&quot;)    return a-b async def hello3(a,b):    print(&quot;Hello world 03 begin&quot;)    await asyncio.sleep(4)   #æ¨¡æ‹Ÿè€—æ—¶ä»»åŠ¡4ç§’    print(&quot;Hello again 03 end&quot;)    return a*b async def main():  #å°è£…å¤šä»»åŠ¡çš„å…¥å£å‡½æ•°    task1=asyncio.ensure_future(hello1(10,5))    task2=asyncio.ensure_future(hello2(10,5))    task3=asyncio.ensure_future(hello3(10,5))    results=await asyncio.gather(task1,task2,task3)       for result in results:    #é€šè¿‡è¿­ä»£è·å–å‡½æ•°çš„ç»“æœï¼Œæ¯ä¸€ä¸ªå…ƒç´ å°±æ˜¯ç›¸å¯¹åº”çš„ä»»åŠ¡çš„è¿”å›å€¼ï¼Œé¡ºåºéƒ½æ²¡å˜        print(result) loop = asyncio.get_event_loop()               loop.run_until_complete(main())loop.close()                                  '''è¿è¡Œç»“æœä¸ºï¼šHello world 01 beginHello world 02 beginHello world 03 beginHello again 02 endHello again 01 endHello again 03 end15550'''ä½¿ç”¨waitå¯ä»¥åŒæ—¶æ³¨å†Œå¤šä¸ªä»»åŠ¡ï¼Œå®ç°å¹¶å‘await asyncio.wait(aws, *, loop=None, timeout=None, return_when=ALL_COMPLETED)å®ƒä¸gatherä¸åŒçš„åœ°æ–¹æ˜¯ä»–çš„å‚æ•°æ˜¯é›†åˆç±»å‹ï¼Œè€Œä¸”ä»–çš„è¿”å›ç±»å‹æ˜¯è¿™æ ·ä¸€ä¸ªå½¢å¼ï¼Œå³ (done, pending)è¿”å›donesæ˜¯å·²ç»å®Œæˆçš„ä»»åŠ¡ï¼Œpendingæ˜¯æœªå®Œæˆçš„ä»»åŠ¡ï¼Œéƒ½æ˜¯é›†åˆç±»å‹ï¼Œä¸åŒçš„æ˜¯æ¯ä¸€ä¸ªå…ƒç´ ä¸å†æ˜¯è¿”å›å€¼ï¼Œè€Œæ˜¯æŸä¸€ä¸ªtaskç›¸åŒçš„æ˜¯å®ƒä¾ç„¶ä¹Ÿæ˜¯awaitableçš„ï¼Œæ•…è€Œä¹Ÿéœ€è¦å®šä¹‰åœ¨ä¸€ä¸ªå¼‚æ­¥å‡½æ•°main()ä¸­ï¼Œå¦‚ä¸‹ï¼š1234567891011121314#å‰é¢çš„ä»£ç å’Œä¸Šé¢ä¸€æ ·async def main():  #å°è£…å¤šä»»åŠ¡çš„å…¥å£å‡½æ•°    task1=asyncio.ensure_future(hello1(10,5))    task2=asyncio.ensure_future(hello2(10,5))    task3=asyncio.ensure_future(hello3(10,5))    done,pending=await asyncio.wait([task1,task2,task3])       for done_task in done:        print(done_task.result())  #è¿™é‡Œè¿”å›çš„æ˜¯ä¸€ä¸ªä»»åŠ¡ï¼Œä¸æ˜¯ç›´æ¥çš„è¿”å›å€¼ï¼Œæ•…è€Œéœ€è¦ä½¿ç”¨resultå‡½æ•°è¿›è¡Œè·å– loop = asyncio.get_event_loop()               loop.run_until_complete(main())loop.close()   #è¿è¡Œç»“æœä¹Ÿä¸€æ ·ä½¿ç”¨as_completedå¯ä»¥åŒæ—¶æ³¨å†Œå¤šä¸ªä»»åŠ¡ï¼Œå®ç°å¹¶å‘è¿™ä¸ªæ–¹æ³•ä½¿ç”¨çš„æ¯”è¾ƒå°‘ï¼Œä¸å‰é¢çš„ä¸¤ä¸ªgatherå’Œwaitä¸åŒçš„æ˜¯ï¼Œå®ƒä¸æ˜¯awaitableä¸»è°ƒæ–¹è·å–ä»»åŠ¡çš„è¿è¡Œç»“æœ1234567891011121314async def main():  #å°è£…å¤šä»»åŠ¡çš„å…¥å£å‡½æ•°    task1=asyncio.ensure_future(hello1(10,5))    task2=asyncio.ensure_future(hello2(10,5))    task3=asyncio.ensure_future(hello3(10,5))    return await asyncio.gather(task1,task2,task3)  #ä¸åœ¨è¿™é‡Œè·å–ç»“æœï¼Œåªæ˜¯è¿”å›loop = asyncio.get_event_loop()               results=loop.run_until_complete(main())  #åœ¨è¿™é‡Œå†è·å–è¿”å›å‡½æ•°å€¼,ç„¶åè¿­ä»£è·å–for result in results:    print(result)loop.close()     #yè¿è¡Œç»“æœåŒä¸Š    æˆ–è€…æ˜¯å¦‚ä¸‹ï¼š 123456789101112async def main():  #å°è£…å¤šä»»åŠ¡çš„å…¥å£å‡½æ•°    task1=asyncio.ensure_future(hello1(10,5))    task2=asyncio.ensure_future(hello2(10,5))    task3=asyncio.ensure_future(hello3(10,5))     return await asyncio.wait([task1,task2,task3])  #ä¸åœ¨è¿™é‡Œè·å–ç»“æœï¼Œåªæ˜¯è¿”å› loop = asyncio.get_event_loop()               done,pending=loop.run_until_complete(main())  #åœ¨è¿™é‡Œå†è·å–è¿”å›å‡½æ•°å€¼,ç„¶åè¿­ä»£è·å–for done_task in done:    print(done_task.result())loop.close()åç¨‹é”æŒ‰ç…§å­—é¢æ„æ€æ¥çœ‹ï¼Œasyncio.lock åº”è¯¥å«åšå¼‚æ­¥ IO é”ï¼Œä¹‹æ‰€ä»¥å«åç¨‹é”ï¼Œæ˜¯å› ä¸ºå®ƒé€šå¸¸ä½¿ç”¨åœ¨å­åç¨‹ä¸­ï¼Œå…¶ä½œç”¨æ˜¯å°†åç¨‹å†…éƒ¨çš„ä¸€æ®µä»£ç é”ä½ï¼Œç›´åˆ°è¿™æ®µä»£ç è¿è¡Œå®Œæ¯•è§£é”åç¨‹é”çš„å›ºå®šç”¨æ³•æ˜¯ä½¿ç”¨ async with åˆ›å»ºåç¨‹é”çš„ä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œå°†ä»£ç å—å†™å…¥å…¶ä¸­ä¸¾ä¾‹è¯´æ˜ï¼Œå°†ä»¥ä¸‹ä»£ç å†™å…¥ async_lock.py æ–‡ä»¶ï¼š12345678910111213141516171819202122232425262728293031323334353637383940import asynciol = []lock = asyncio.Lock()   # åç¨‹é”async def work(name):    print('lalalalalalalala')     # æ‰“å°æ­¤ä¿¡æ¯æ˜¯ä¸ºäº†æµ‹è¯•åç¨‹é”çš„æ§åˆ¶èŒƒå›´    # è¿™é‡ŒåŠ ä¸ªé”ï¼Œç¬¬ä¸€æ¬¡è°ƒç”¨è¯¥åç¨‹ï¼Œè¿è¡Œåˆ°è¿™ä¸ªè¯­å¥å—ï¼Œä¸Šé”    # å½“è¯­å¥å—ç»“æŸåè§£é”ï¼Œå¼€é”å‰è¯¥è¯­å¥å—ä¸å¯è¢«è¿è¡Œç¬¬äºŒæ¬¡    # å¦‚æœä¸Šé”åæœ‰å…¶å®ƒä»»åŠ¡è°ƒç”¨äº†è¿™ä¸ªåç¨‹å‡½æ•°ï¼Œè¿è¡Œåˆ°è¿™æ­¥ä¼šè¢«é˜»å¡ï¼Œç›´è‡³è§£é”    # with æ˜¯æ™®é€šä¸Šä¸‹æ–‡ç®¡ç†å™¨å…³é”®å­—ï¼Œasync with æ˜¯å¼‚æ­¥ä¸Šä¸‹æ–‡ç®¡ç†å™¨å…³é”®å­—    # èƒ½å¤Ÿä½¿ç”¨ with å…³é”®å­—çš„å¯¹è±¡é¡»æœ‰ __enter__ å’Œ __exit__ æ–¹æ³•    # èƒ½å¤Ÿä½¿ç”¨ async with å…³é”®å­—çš„å¯¹è±¡é¡»æœ‰ __aenter__ å’Œ __aexit__ æ–¹æ³•    # async with ä¼šè‡ªåŠ¨è¿è¡Œ lock çš„ __aenter__ æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šè°ƒç”¨ acquire æ–¹æ³•ä¸Šé”    # åœ¨è¯­å¥å—ç»“æŸæ—¶è‡ªåŠ¨è¿è¡Œ __aexit__ æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šè°ƒç”¨ release æ–¹æ³•è§£é”    # è¿™å’Œ with ä¸€æ ·ï¼Œéƒ½æ˜¯ç®€åŒ– try ... finally è¯­å¥    async with lock:        print('{} start'.format(name))  # å¤´ä¸€æ¬¡è¿è¡Œè¯¥åç¨‹æ—¶æ‰“å°        if 'x' in l:                    # å¦‚æœåˆ¤æ–­æˆåŠŸ            return name                 # ç›´æ¥è¿”å›ç»“æŸåç¨‹ï¼Œä¸å†å‘ä¸‹æ‰§è¡Œ        await asyncio.sleep(0); print('----------')  # é˜»å¡ 0 ç§’ï¼Œåˆ‡æ¢åç¨‹        l.append('x')        print('{} end'.format(name))        return nameasync def one():    name = await work('one')    print('{} ok'.format(name))async def two():    name = await work('two')    print('{} ok'.format(name))def main():    loop = asyncio.get_event_loop()    tasks = asyncio.wait([one(), two()])    loop.run_until_complete(tasks)if __name__ == '__main__':    main()è¿è¡Œç¨‹åºå¦‚ä¸‹ï¼š123456789$ python3 async_lock.pylalalalalalalalaone startlalalalalalalala----------one endone oktwo starttwo okAPIç´¢å¼•é«˜çº§APIç´¢å¼•é«˜çº§APIç´¢å¼•ä»»åŠ¡è¿è¡Œå¼‚æ­¥ç¨‹åºï¼Œåˆ›å»ºTaskå¯¹è±¡ï¼Œç­‰å¾…å¤šä»¶äº‹è¿è¡Œè¶…æ—¶çš„å…¬å…±é›†run()åˆ›å»ºäº‹ä»¶å¾ªç¯ï¼Œè¿è¡Œä¸€ä¸ªåç¨‹ï¼Œå…³é—­äº‹ä»¶å¾ªç¯ã€‚create_task()å¯åŠ¨ä¸€ä¸ªasyncioçš„Taskå¯¹è±¡ã€‚await sleep()ä¼‘çœ å‡ ç§’ã€‚await gather()å¹¶å‘æ‰§è¡Œæ‰€æœ‰äº‹ä»¶çš„è°ƒåº¦å’Œç­‰å¾…ã€‚await wait_for()æœ‰è¶…æ—¶æ§åˆ¶çš„è¿è¡Œã€‚await shield()å±è”½å–æ¶ˆæ“ä½œawait wait()å®Œæˆæƒ…å†µçš„ç›‘æ§å™¨current_task()è¿”å›å½“å‰Taskå¯¹è±¡all_tasks()è¿”å›äº‹ä»¶å¾ªç¯ä¸­æ‰€æœ‰çš„taskå¯¹è±¡ã€‚TaskTaskå¯¹è±¡run_coroutine_threadsafe()ä»å…¶ä»–OSçº¿ç¨‹ä¸­è°ƒåº¦ä¸€ä¸ªåç¨‹ã€‚for in as_completed()ç”¨ for å¾ªç¯ç›‘æ§å®Œæˆæƒ…å†µã€‚ä¾‹å­ä½¿ç”¨ asyncio.gather() å¹¶è¡Œè¿è¡Œä½¿ç”¨ asyncio.wait_for() å¼ºåˆ¶è¶…æ—¶æ’¤é”€åç¨‹asyncio.sleep() çš„ç”¨æ³•è¯·ä¸»è¦å‚é˜… åç¨‹ä¸ä»»åŠ¡æ–‡æ¡£åŒæ­¥èƒ½è¢«ç”¨äºTaskå¯¹è±¡é›†çš„ï¼Œç±»ä¼¼çº¿ç¨‹çš„åŒæ­¥åŸºå…ƒç»„ä»¶Lockäº’æ–¥é”ã€‚Eventäº‹ä»¶å¯¹è±¡ã€‚Conditionæ¡ä»¶å¯¹è±¡Semaphoreä¿¡å·é‡BoundedSemaphoreæœ‰ç•Œçš„ä¿¡å·é‡ã€‚ä¾‹å­asyncio.Event çš„ç”¨æ³•è¯·å‚é˜…asyncioæ–‡æ¡£ synchronization primitiveså¼‚å¸¸asyncio.TimeoutErrorç±»ä¼¼ wait_for() ç­‰å‡½æ•°åœ¨è¶…æ—¶æ—¶å€™è¢«å¼•å‘ã€‚è¯·æ³¨æ„ asyncio.TimeoutError ä¸å†…å»ºå¼‚å¸¸ TimeoutError æ— å…³ã€‚asyncio.CancelledErrorå½“ä¸€ä¸ªTaskå¯¹è±¡è¢«å–æ¶ˆçš„æ—¶å€™è¢«å¼•å‘ã€‚è¯·å‚é˜… Task.cancel()ã€‚ä¾‹å­åœ¨å–æ¶ˆè¯·æ±‚å‘ç”Ÿçš„è¿è¡Œä»£ç ä¸­å¦‚ä½•å¤„ç†CancelledErrorå¼‚å¸¸è¯·å‚é˜…å®Œæ•´çš„ asyncio ä¸“ç”¨å¼‚å¸¸ åˆ—è¡¨åº•å±‚APIç´¢å¼•åº•å±‚APIç´¢å¼•è·å–äº‹ä»¶å¾ªç¯asyncio.get_running_loop()è·å–å½“å‰è¿è¡Œçš„äº‹ä»¶å¾ªç¯ é¦–é€‰ å‡½æ•°ã€‚asyncio.get_event_loop()è·å¾—ä¸€ä¸ªäº‹ä»¶å¾ªç¯å®ä¾‹(å½“å‰æˆ–é€šè¿‡ç­–ç•¥)ã€‚asyncio.set_event_loop()é€šè¿‡å½“å‰ç­–ç•¥å°†äº‹ä»¶å¾ªç¯è®¾ç½®å½“å‰äº‹ä»¶å¾ªç¯ã€‚asyncio.new_event_loop()åˆ›å»ºä¸€ä¸ªæ–°çš„äº‹ä»¶å¾ªç¯ã€‚ä¾‹å­ä½¿ç”¨asyncio.get_running_loop()ã€‚ç”Ÿå‘½å‘¨æœŸloop.run_until_complete()è¿è¡Œä¸€ä¸ªæœŸç¨‹/ä»»åŠ¡/å¯ç­‰å¾…å¯¹è±¡ç›´åˆ°å®Œæˆã€‚loop.run_forever()ä¸€ç›´è¿è¡Œäº‹ä»¶å¾ªç¯ã€‚loop.stop()åœæ­¢äº‹ä»¶å¾ªç¯ã€‚loop.close()å…³é—­äº‹ä»¶å¾ªç¯ã€‚loop.is_running()è¿”å› True ï¼Œ å¦‚æœäº‹ä»¶å¾ªç¯æ­£åœ¨è¿è¡Œã€‚loop.is_closed()è¿”å› True ï¼Œå¦‚æœäº‹ä»¶å¾ªç¯å·²ç»è¢«å…³é—­ ã€‚await loop.shutdown_asyncgens()å…³é—­å¼‚æ­¥ç”Ÿæˆå™¨ã€‚è°ƒè¯•loop.set_debug()å¼€å¯æˆ–ç¦ç”¨è°ƒè¯•æ¨¡å¼ã€‚loop.get_debug()è·å–å½“å‰æµ‹è¯•æ¨¡å¼ã€‚è°ƒåº¦å›è°ƒå‡½æ•°loop.call_soon()å°½å¿«è°ƒç”¨å›è°ƒã€‚loop.call_soon_threadsafe()loop.call_soon() æ–¹æ³•çº¿ç¨‹å®‰å…¨çš„å˜ä½“ã€‚loop.call_later()åœ¨ç»™å®šæ—¶é—´ ä¹‹å è°ƒç”¨å›è°ƒå‡½æ•°ã€‚loop.call_at()åœ¨ æŒ‡å®š æ—¶é—´è°ƒç”¨å›è°ƒå‡½æ•°ã€‚çº¿ç¨‹/è¿›ç¨‹æ± await loop.run_in_executor()åœ¨ concurrent.futures æ‰§è¡Œå™¨ä¸­è¿è¡Œä¸€ä¸ªç‹¬å CPUæˆ–å…¶å®ƒé˜»å¡å‡½æ•°ã€‚loop.set_default_executor()è®¾ç½® loop.run_in_executor() é»˜è®¤æ‰§è¡Œå™¨ã€‚ä»»åŠ¡ä¸æœŸç¨‹loop.create_future()åˆ›å»ºä¸€ä¸ª Future å¯¹è±¡ã€‚loop.create_task()å°†åç¨‹å½“ä½œ Task ä¸€æ ·è°ƒåº¦ã€‚loop.set_task_factory()è®¾ç½® loop.create_task() ä½¿ç”¨çš„å·¥å‚ï¼Œå®ƒå°†ç”¨æ¥åˆ›å»º Tasks ã€‚loop.get_task_factory()è·å– loop.create_task() ä½¿ç”¨çš„å·¥å‚ï¼Œå®ƒç”¨æ¥åˆ›å»º Tasks ã€‚é”™è¯¯å¤„ç†loop.call_exception_handler()è°ƒç”¨å¼‚å¸¸å¤„ç†å™¨ã€‚loop.set_exception_handler()è®¾ç½®ä¸€ä¸ªæ–°çš„å¼‚å¸¸å¤„ç†å™¨ã€‚loop.get_exception_handler()è·å–å½“å‰å¼‚å¸¸å¤„ç†å™¨ã€‚loop.default_exception_handler()é»˜è®¤å¼‚å¸¸å¤„ç†å™¨å®ç°ã€‚ä¾‹å­ä½¿ç”¨ asyncio.get_event_loop() å’Œ loop.run_forever()ä½¿ç”¨ loop.call_later()ä½¿ç”¨ loop.create_connection() å®ç° echoå®¢æˆ·ç«¯ä½¿ç”¨ loop.create_connection() å» é“¾æ¥socketä½¿ç”¨add_reader()ç›‘å¬FD(æ–‡ä»¶æè¿°ç¬¦)çš„è¯»å–äº‹ä»¶ä½¿ç”¨loop.add_signal_handler()ä½¿ç”¨loop.add_signal_handler()asyncioä¸geventæ¯”è¾ƒPythonä¸­asyncioä¸geventæœ‰ä»€ä¹ˆåŒºåˆ«?asycio éœ€è¦è‡ªå·±åœ¨ä»£ç ä¸­è®©å‡ºCPUï¼Œæ§åˆ¶æƒåœ¨è‡ªå·±æ‰‹ä¸Šgevent ç”¨ä¼šæ›¿æ¢æ ‡å‡†åº“ï¼Œä½ ä»¥ä¸ºè°ƒç”¨çš„æ˜¯æ ‡å‡†åº“çš„æ–¹æ³•å®é™…å·²ç»è¢«æ›¿æ¢æˆgeventè‡ªå·±çš„å®ç°ï¼Œé‡åˆ°é˜»å¡è°ƒç”¨ï¼Œgeventä¼šè‡ªåŠ¨è®©å‡ºCPUï¼Œåƒä¸åƒæ‰‹åŠ¨æŒ¡å’Œè‡ªåŠ¨æŒ¡çš„åŒºåˆ«Â·Â·Â·Â·Â·geventæ˜¯ç¬¬ä¸‰æ–¹åº“ï¼Œé€šè¿‡greenletå®ç°åç¨‹ï¼Œå…¶åŸºæœ¬æ€è·¯æ˜¯ï¼šå½“ä¸€ä¸ªgreenleté‡åˆ°IOæ“ä½œæ—¶ï¼Œå°±è‡ªåŠ¨åˆ‡æ¢åˆ°å…¶ä»–çš„greenletï¼Œç­‰åˆ°IOæ“ä½œå®Œæˆï¼Œå†åœ¨é€‚å½“çš„æ—¶å€™åˆ‡æ¢å›æ¥ç»§ç»­æ‰§è¡Œasyncioæ˜¯Python 3.4ç‰ˆæœ¬å¼•å…¥çš„æ ‡å‡†åº“ï¼Œç›´æ¥å†…ç½®äº†å¯¹å¼‚æ­¥IOçš„æ”¯æŒï¼Œä¸éœ€è¦ç¬¬ä¸‰æ–¹çš„æ”¯æŒç¼–ç¨‹æ¨¡å‹æ¯”è¾ƒasyncioçš„ç¼–ç¨‹æ¨¡å‹å°±æ˜¯ä¸€ä¸ªæ¶ˆæ¯å¾ªç¯ã€‚æˆ‘ä»¬ä»asyncioæ¨¡å—ä¸­ç›´æ¥è·å–ä¸€ä¸ªEventLoopçš„å¼•ç”¨ï¼Œç„¶åæŠŠéœ€è¦æ‰§è¡Œçš„åç¨‹æ‰”åˆ°EventLoopä¸­æ‰§è¡Œï¼Œå°±å®ç°äº†å¼‚æ­¥IOã€‚å¾ˆå¤šå¼‚æ­¥ioæ“ä½œè¿™ä¸¤ä¸ªåº“éƒ½å¯ä»¥ç”¨ï¼Œåªæ˜¯ä»–ä»¬åœ¨ä¸åŒåœºæ™¯ä¸‹çš„æ•ˆç‡å’Œæ˜“ç”¨æ€§å¯èƒ½æœ‰åŒºåˆ«ï¼Œå½“ç„¶è¿™ä¸ªå¾—è¿›è¡Œæ·±å…¥çš„æµ‹è¯•å’Œç ”ç©¶ï¼Œå•å°±ç°åœ¨æ™®é€šçš„åœºæ™¯æ¥è¯´ï¼ŒåŒºåˆ«å¹¶ä¸å¤§gevent æ˜¯è¡¥ä¸ï¼Œasyncio æ˜¯ python 3 åŸç”Ÿï¼›éƒ½èƒ½åšåˆ° å¼‚æ­¥ IOã€‚å¦‚æœç°åœ¨å†™å¼‚æ­¥IOç¨‹åºï¼Œåº”è¯¥ç”¨ asynciogevent éœ€è¦ patchï¼Œä¸ªäººæ„Ÿè§‰ä¸æ´ç™–ï¼Œæ¯”å¦‚æœ‰äº›æ—¶å€™ä¸éœ€è¦patchï¼Œæˆ–è€…è‡ªå·±å®ç°çš„ä¸œè¥¿å’Œpatchå†²çªå°±éº»çƒ¦äº†è­¦å‘Šæˆ–é”™è¯¯æç¤ºasyncioæå‰åˆ°ç¼–è¯‘é˜¶æ®µeventåªèƒ½è¿è¡Œé˜¶æ®µasyncio ç³»ç»Ÿè‡ªå¸¦ï¼Œå®˜æ–¹æ— å¿§å‰æœŸï¼šasync await ä¸€å…¥é—¨æ€ç»´æœ‰ç‚¹ç»•ï¼Œgeventç¨‹åºå‘˜ä¸€å¼€å§‹æ¯”è¾ƒä¹ æƒ¯åæœŸï¼šç”±äº async å’Œ await å…³é”®å­—ï¼Œasyncio æ‰æ˜¯æ‰€è§å³æ‰€å¾—ï¼geventå…¥å£å»æ‰ç¬¬ä¸€ä¸ªspawnå°±æ˜¯æ™®é€šå‡½æ•°å·®ä¸å¤šäº†å¤„ç†blockingï¼Œasyncio æ˜¯ run_in_executor å¥½ç”¨ï¼Œgevent æ˜¯ ThreadPoolï¼Œä¸å¥½ç”¨å¯åŠ¨asyncioæä¾›run_until_completegevent æ˜¯ joinï¼ˆspawnï¼‰åŒæ—¶å¯åŠ¨å¤šä¸ªasyncio ç”¨ asyncio.wait åŒ…è£… æˆ– gathergevent æ˜¯ joinallæœªæ¥ï¼šå®˜æ–¹æ—¢ç„¶å‡ºäº† asyncioï¼Œæ„Ÿè§‰gevent å°†ä¼šè¿‡æ—¶webæ¡†æ¶ã€python å¼‚æ­¥æ¡†æ¶tornadoã€‘TornadoåŸç†ç†è§£åŠåº”ç”¨åœºæ™¯åŸºç¡€çŸ¥è¯†pythonä¸­å¸¸è§çš„webæ¡†æ¶ä¸»è¦åŒ…æ‹¬äº†flaskã€djangoã€tornadoé‚£ä¹ˆè¿™äº›æ¼‚äº®çš„æ¡†æ¶çš„åº”ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿè¦æ€§èƒ½ï¼ŒTornado é¦–é€‰è¦å¼€å‘é€Ÿåº¦ï¼ŒDjango å’ŒFlask éƒ½è¡ŒåŒºåˆ«æ˜¯ï¼šFlask æŠŠè®¸å¤šåŠŸèƒ½äº¤ç»™ç¬¬ä¸‰æ–¹åº“å»å®Œæˆäº†ï¼Œå› æ­¤Flask æ›´ä¸ºçµæ´»Djangoé€‚åˆåˆå­¦è€…æˆ–è€…å°å›¢é˜Ÿçš„å¿«é€Ÿå¼€å‘ï¼Œé€‚åˆåšç®¡ç†ç±»ã€åšå®¢ç±»ç½‘ç«™ã€åŠŸèƒ½å¤æ‚éœ€æ±‚å¤šçš„ç½‘ç«™Tornadoé€‚åˆé«˜åº¦å®šåˆ¶ï¼Œé€‚åˆè®¿é—®é‡å¤§ï¼Œå¼‚æ­¥æƒ…å†µå¤šçš„ç½‘ç«™ã€‚ä¹Ÿå¯ä»¥ç”¨äºå®šåˆ¶apiæœåŠ¡WSGIåè®®ä¸­å›½æœ‰ä¸‰å®¶æœ‰åçš„é€šä¿¡è¿è¥å•†ï¼Œåˆ†åˆ«æ˜¯ç§»åŠ¨ã€è”é€šå’Œç”µä¿¡ï¼Œè¿™ä¸‰å®¶é€šä¿¡å•†çš„æ‰‹æœºå·æ˜¯å¯ä»¥è·¨å¹³å°æ‹¨æ‰“çš„ï¼Œå‡è®¾ä¸‰å®¶é€šä¿¡å•†è´Ÿè´£é€šä¿¡çš„åè®®ä¸åŒä¸”æ— æ³•äº’é€šï¼Œç”¨ç§»åŠ¨çš„æ‰‹æœºå·å°±æ— æ³•ç»™è”é€šç”µä¿¡çš„æ‰‹æœºæ‰“ç”µè¯ï¼Œä¸ºäº†æ–¹ä¾¿é€šä¿¡å°±éœ€è¦ä¸€ä¸ªç»Ÿä¸€çš„è§„èŒƒWSGIåè®®çš„è§’è‰²å°±æ˜¯è¿™ä¸ªç»Ÿä¸€çš„è§„èŒƒï¼Œæ˜¯æè¿°webserverå¦‚ä½•ä¸web applicationé€šä¿¡çš„è§„èŒƒï¼Œè¦å®ç°WSGIåè®®ï¼Œå°±å¿…é¡»åŒæ—¶å®ç°web serverå’Œwebapplicationï¼Œç›®å‰å¸¸è§çš„æœ‰Tornadoã€Flaskå’ŒDjangoWSGIæ˜¯ä¸ªåŒæ­¥æ¨¡å‹ï¼Œä¸æ”¯æŒéé˜»å¡çš„è¯·æ±‚æ–¹å¼ï¼ŒTornadoé»˜è®¤æ˜¯ä¸æ¨èä½¿ç”¨WSGIçš„ï¼Œå¦‚æœåœ¨Tornadoä¸­ä½¿ç”¨WSGIï¼Œå°†æ— æ³•ä½¿ç”¨Tornadoçš„å¼‚æ­¥éé˜»å¡çš„å¤„ç†æ–¹å¼ï¼Œç›¸åº”çš„å¼‚æ­¥æ¥å£ä¹Ÿå°±æ— æ³•ä½¿ç”¨ï¼Œæ€§èƒ½æ–¹é¢ä¹Ÿå°±å¤§æ‰“æŠ˜æ‰£ï¼Œè¿™ä¸ªä¹Ÿæ˜¯Tornadoæ€§èƒ½å¦‚æ­¤ä¼˜è¶Šçš„åŸå› djangoè¿™ç±»æ¡†æ¶ï¼Œé‡‡ç”¨WSGIåè®®ä¸æœåŠ¡å™¨å¯¹æ¥çš„ï¼Œè€Œè¿™ç±»æœåŠ¡å™¨é€šå¸¸æ˜¯åŸºäºå¤šçº¿ç¨‹/å¤šè¿›ç¨‹çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯æœ‰ä¸€ä¸ªç½‘ç»œè¯·æ±‚ï¼ŒæœåŠ¡å™¨éƒ½ä¼šæœ‰ä¸€ä¸ªçº¿ç¨‹/è¿›ç¨‹è¿›è¡Œå¤„ç†epollæŠ€æœ¯epollæ˜¯Linuxå†…æ ¸ä¸ºå¤„ç†baiå¤§æ‰¹é‡æ–‡ä»¶æè¿°duç¬¦è€Œä½œäº†æ”¹zhiè¿›çš„pollï¼Œæ˜¯Linuxä¸‹å¤šè·¯å¤ç”¨daoIOæ¥å£zhuanselect/pollçš„å¢å¼ºshuæœ¬ï¼Œå®ƒèƒ½æ˜¾è‘—æé«˜ç¨‹åºæƒåœ¨å¤§é‡å¹¶å‘è¿æ¥ä¸­åªæœ‰å°‘é‡æ´»è·ƒçš„æƒ…å†µä¸‹çš„ç³»ç»ŸCPUåˆ©ç”¨ç‡ã€‚å¦ä¸€ç‚¹åŸå› å°±æ˜¯è·å–äº‹ä»¶çš„æ—¶å€™ï¼Œå®ƒæ— é¡»éå†æ•´ä¸ªè¢«ä¾¦å¬çš„æè¿°ç¬¦é›†ï¼Œåªè¦éå†é‚£äº›è¢«å†…æ ¸IOäº‹ä»¶å¼‚æ­¥å”¤é†’è€ŒåŠ å…¥Readyé˜Ÿåˆ—çš„æè¿°ç¬¦é›†åˆå°±è¡Œäº†ã€‚epollé™¤äº†æä¾›select/pollé‚£ç§IOäº‹ä»¶çš„æ°´å¹³è§¦å‘ï¼ˆLevel Triggeredï¼‰å¤–ï¼Œè¿˜æä¾›äº†è¾¹ç¼˜è§¦å‘ï¼ˆEdge Triggeredï¼‰ï¼Œè¿™å°±ä½¿å¾—ç”¨æˆ·ç©ºé—´ç¨‹åºæœ‰å¯èƒ½ç¼“å­˜IOçŠ¶æ€ï¼Œå‡å°‘epoll_wait/epoll_pwaitçš„è°ƒç”¨ï¼Œæé«˜åº”ç”¨ç¨‹åºæ•ˆç‡ã€‚å¼‚æ­¥æ¡†æ¶tornadoé€»è¾‘æµç¨‹ã€python å¼‚æ­¥æ¡†æ¶tornadoã€‘TornadoåŸç†ç†è§£åŠåº”ç”¨åœºæ™¯EpollåŸç†è§£æåˆ†æä¸‹Torando.ioloop.IOLoop.current().start()ä»£ç ä¸ŠTorando.ioloopæ˜¯Tornadoçš„æ ¸å¿ƒæ¨¡å—ioloopæ¨¡å—IOLoopæ˜¯ioloopæ¨¡å—çš„ä¸€ä¸ªç±»current()æ˜¯IOLoopç±»çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç»“æœæ˜¯è¿”å›ä¸€ä¸ªå½“å‰çº¿ç¨‹çš„IOLoopçš„å®ä¾‹start()ä¹Ÿæ˜¯IOLoopçš„æ–¹æ³•ï¼Œè°ƒç”¨åå¼€å¯å¾ªç¯123456789101112131415# -*- encoding=utf-8 -*-import tornado.ioloopimport tornado.webclass IndexHandler(tornado.web.RequestHandler):    def get(self):        self.write(&quot;Hello, world&quot;)def make_app():    return tornado.web.Application([(r&quot;/&quot;, IndexHandler),])if __name__ == &quot;__main__&quot;:    app = make_app()    app.listen(8888)    tornado.ioloop.IOLoop.current().start()æ•´ä½“çš„æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šé¦–å…ˆTornadoéœ€è¦å»ºç«‹ç›‘å¬ï¼Œä¼šåˆ›å»ºä¸€ä¸ªsocketç”¨äºç›‘å¬ï¼Œå¦‚æœæœ‰å®¢æˆ·ç«¯Aè¯·æ±‚å»ºç«‹è¿æ¥ä¹‹åï¼ŒTornadoä¼šåŸºäºåŸå…ˆçš„socketæ–°åˆ›å»ºä¸€ä¸ªåŒ…å«å®¢æˆ·ç«¯Aè¿æ¥çš„æœ‰å…³ä¿¡æ¯çš„socket(åˆ†é…æ–°çš„ç›‘å¬ç«¯å£)ï¼Œç”¨äºç›‘å¬å’Œå®¢æˆ·ç«¯Açš„è¯·æ±‚æ­¤æ—¶å¯¹Tornadoæ¥è¯´å°±æœ‰ä¸¤ä¸ªsocketéœ€è¦è¿›è¡Œç›‘æ§ï¼ŒåŸå…ˆçš„socketç»§ç»­ç”¨æ¥ç›‘å¬å»ºç«‹æ–°è¿æ¥ï¼Œæ–°çš„socketç”¨äºå’Œå®¢æˆ·ç«¯Aè¿›è¡Œé€šä¿¡ï¼Œå‡å¦‚æ²¡æœ‰epollæŠ€æœ¯çš„è¯ï¼ŒTornadoéœ€è¦è‡ªå·±å»å¾ªç¯è¯¢é—®å“ªä¸ªsocketæœ‰æ–°çš„è¯·æ±‚æœ‰äº†epollæŠ€æœ¯ï¼ŒTornadoåªéœ€è¦æŠŠæ‰€æœ‰çš„socketä¸¢ç»™epollï¼Œepollä½œä¸ºç®¡å®¶å¸®å¿™ç›‘æ§ï¼Œç„¶åTorando.ioloop.IOLoop.current().start()å¼€å¯å¾ªç¯ï¼Œä¸æ–­çš„å»è¯¢é—®epollæ˜¯å¦æœ‰è¯·æ±‚éœ€è¦å¤„ç†ï¼Œè¿™å°±æ˜¯ioloopæ‰€åšçš„å·¥ä½œï¼Œä¹Ÿæ˜¯Tornadoçš„æ ¸å¿ƒéƒ¨åˆ†å½“æœ‰å®¢æˆ·ç«¯è¿›è¡Œè¯·æ±‚ï¼Œepollå°±å‘ç°æœ‰socketå¯å¤„ç†ï¼Œå½“ioloopå†æ¬¡è¯¢é—®epollæ—¶ï¼Œepollå°±æŠŠéœ€è¦å¤„ç†çš„socketäº¤ç”±Tornadoå¤„ç†Tornadoå¯¹è¯·æ±‚è¿›è¡Œå¤„ç†ï¼Œå–å‡ºæŠ¥æ–‡ï¼Œä»æŠ¥æ–‡ä¸­è·å–è¯·æ±‚è·¯å¾„ï¼Œç„¶åä»tornado.web.Applcationé‡Œé…ç½®çš„è·¯ç”±æ˜ å°„ä¸­æŠŠè¯·æ±‚è·¯å¾„æ˜ å°„æˆå¯¹åº”çš„å¤„ç†ç±»ï¼Œå¦‚ä¸Šå›¾IndexHandlerå°±æ˜¯å¤„ç†ç±»å¤„ç†ç±»å¤„ç†å®Œæˆåï¼Œç”Ÿæˆå“åº”ï¼Œå°†å“åº”å†…å®¹å°è£…æˆhttpæŠ¥æ–‡ï¼Œé€šè¿‡è¯·æ±‚æ—¶å»ºç«‹çš„è¿æ¥ï¼ˆå°šæœªä¸­æ–­ï¼‰å°†å“åº”å†…å®¹è¿”å›ç»™å®¢æˆ·ç«¯å½“æœ‰å¤šä¸ªè¯·æ±‚åŒæ—¶å‘ç”Ÿï¼ŒTornadoä¼šæŒ‰é¡ºåºæŒ¨ä¸ªå¤„ç†çœ‹äº†ä¸Šé¢çš„æµç¨‹ï¼Œå‡å¦‚Tornadoåœ¨å¤„ç†ä¸€ä¸ªéå¸¸è€—æ—¶çš„è¯·æ±‚æ—¶ï¼Œåé¢çš„è¯·æ±‚æ˜¯ä¸æ˜¯å°±ä¼šè¢«å¡æ­»å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œæ‰€ä»¥æåˆ°äº†Tornadoçš„å¦ä¸€ä¸ªç‰¹æ€§â€”å¼‚æ­¥å¤„ç†ï¼Œå½“ä¸€ä¸ªè¯·æ±‚ç‰¹åˆ«è€—æ—¶ï¼ŒTornadoå°±æŠŠå®ƒä¸¢åœ¨é‚£å¤„ç†ï¼Œç„¶åç»§ç»­å¤„ç†ä¸‹ä¸€ä¸ªè¯·æ±‚ï¼Œç¡®ä¿åé¢çš„è¯·æ±‚ä¸ä¼šè¢«å¡æ­»ã€‚Tornadoå¼‚æ­¥ï¼šåŸç”ŸTornadoæ¡†æ¶æä¾›å¼‚æ­¥ç½‘ç»œåº“IOLoopå’ŒIOStreamä»¥åŠå¼‚æ­¥åç¨‹åº“tornado.gen(å¿…é¡»ä½¿ç”¨Tornadoçš„webæ¡†æ¶å’ŒHTTPæœåŠ¡å™¨ï¼Œå¦åˆ™å¼‚æ­¥æ¥å£å¯èƒ½æ— æ³•ä½¿ç”¨)ï¼Œæ–¹ä¾¿ç”¨æˆ·é€šè¿‡æ›´ç›´æ¥çš„æ–¹æ³•å®ç°å¼‚æ­¥ç¼–ç¨‹ï¼Œè€Œä¸æ˜¯å›è°ƒçš„æ–¹å¼ï¼Œå®˜æ–¹æ¨èyieldåç¨‹æ–¹å¼å®Œæˆå¼‚æ­¥é€šè¿‡ä¸Šé¢æ‰€è®²ï¼ŒåŸºæœ¬ä¸Šå·²ç»å¯¹Tornadoçš„æ•´ä¸ªå¤„ç†æµç¨‹äº†è§£äº†ï¼Œæ€»ç»“ä¸€ä¸‹Tornadoä¹‹æ‰€ä»¥èƒ½åŒæ—¶å¤„ç†å¤§é‡è¿æ¥çš„åŸå› ï¼šåˆ©ç”¨é«˜æ•ˆçš„epollæŠ€æœ¯å¤„ç†è¯·æ±‚ï¼Œå•çº¿ç¨‹/å•è¿›ç¨‹åŒæ—¶å¤„ç†å¤§é‡è¿æ¥æ²¡ä½¿ç”¨ä¼ ç»Ÿçš„wsgiåè®®ï¼Œè€Œæ˜¯åˆ©ç”¨Tornadoè‡ªå·±çš„webæ¡†æ¶å’ŒhttpæœåŠ¡å½¢æˆäº†ä¸€æ•´å¥—WSGIæ–¹æ¡ˆè¿›è¡Œå¤„ç†å¼‚æ­¥å¤„ç†æ–¹å¼ï¼ŒTornadoæä¾›äº†å¼‚æ­¥æ¥å£å¯ä¾›è°ƒç”¨å¯¹æ¯”å…¶å®ƒæ¡†æ¶ornado é™¤äº†webæ¡†æ¶ä¹‹å¤–ï¼Œæ•°æ®åº“æˆ–è€…å…¶ä»–å‡ ä¹éƒ½æ˜¯é˜»å¡çš„ Tornadoè‡ªèº«å¯ä»¥å†™å‡ºéé˜»å¡çš„ä»£ç ï¼Œä½†æ˜¯è¿æ•°æ®åº“ï¼Œæƒ³ç”¨ORMçš„æ—¶å€™å´ä¸è¡Œï¼Œæ‰€ä»¥ä¹Ÿä¸æ˜¯ç‰¹åˆ«æ–¹ä¾¿ã€‚å› æ­¤å¾ˆå¤šäººé€‰æ‹©ä½¿ç”¨Flaskæˆ–è€…æ˜¯DjangoDjangoä¼˜ç¼ºï¼šé‡é‡çº§webæ¡†æ¶ï¼ŒåŠŸèƒ½å¤§è€Œå…¨ï¼Œæ³¨é‡é«˜æ•ˆå¼€å‘ å†…ç½®ç®¡ç†åå° å†…ç½®å°è£…å®Œå–„çš„ORMæ“ä½œ sessionåŠŸèƒ½ åå°ç®¡ç† ç¼ºé™·ï¼šé«˜è€¦åˆ Tornadoä¼˜ç¼ºï¼šè½»é‡çº§webæ¡†æ¶ï¼ŒåŠŸèƒ½å°‘è€Œç²¾ï¼Œæ³¨é‡æ€§èƒ½ä¼˜è¶Š HTTPæœåŠ¡å™¨ å¼‚æ­¥ç¼–ç¨‹ WebSocket ç¼ºé™·ï¼šå…¥é—¨é—¨æ§›è¾ƒé«˜ å…³é”®çŸ¥è¯†ç‚¹tornadoçš„åŸºç¡€webæ¡†æ¶æ¨¡å—RequestHandlerå°è£…äº†è¯·æ±‚å’Œå“åº”ã€‚Applicationæ ¸å¿ƒåº”ç”¨ç±»ï¼Œç±»ä¼¼äºflaskçš„appï¼Œæ˜¯å’ŒæœåŠ¡å™¨å¯¹æ¥çš„æ¥å£ï¼Œä¿å­˜äº†è·¯ç”±ä¿¡æ¯listenæ–¹æ³•ç»‘å®šç«¯å£åˆ›å»ºhttpæœåŠ¡å™¨å®ä¾‹ï¼Œä½†å¹¶æœªç›‘å¬ï¼Œä¸socketçš„listenä¸åŒ/ Tornadoçš„ä¼˜ç¼ºä¼˜åŠ¿è½»é‡çº§webæ¡†æ¶å¼‚æ­¥éé˜»å¡IOå¤„ç†æ–¹å¼å‡ºè‰²çš„æŠ—è´Ÿè½½èƒ½åŠ›ä¼˜å¼‚çš„å¤„ç†æ€§èƒ½ï¼Œä¸ä¾èµ–å¤šè¿›ç¨‹/å¤šçº¿ç¨‹ï¼Œä¸€å®šç¨‹åº¦ä¸Šè§£å†³C10Ké—®é¢˜WSGIå…¨æ ˆæ›¿ä»£äº§å“ï¼Œæ¨èåŒæ—¶ä½¿ç”¨å…¶webæ¡†æ¶å’ŒHTTPæœåŠ¡å™¨ åˆ†å¸ƒå¼ç³»ç»Ÿåˆ†å¸ƒå¼ä»»åŠ¡é˜Ÿåˆ—hueyä½¿ç”¨pythonçš„åˆ†å¸ƒå¼ä»»åŠ¡é˜Ÿåˆ—hueyå®ç°ä»»åŠ¡çš„å¼‚æ­¥åŒ–Celeryä»€ä¹ˆæ˜¯celeryæ¡†æ¶ä½¿ç”¨Celeryè¸©è¿‡çš„å‘Celery åˆ†å¸ƒå¼ä»»åŠ¡é˜Ÿåˆ—å…¥é—¨é¢è¯•å¿…é—®çš„CELERYï¼Œä½ äº†è§£å¤šå°‘ï¼Ÿç®€ä»‹celeryæ˜¯ä¸€ä¸ªä»»åŠ¡åˆ†å‘ç³»ç»Ÿç›®çš„ï¼šåˆ©ç”¨åç«¯å¾…å‘½çš„æ— æ•°workerå®ç°ä¸€ç³»åˆ—ä»»åŠ¡çš„å¿«é€Ÿå¤„ç†ä¸šåŠ¡æ¨¡å¼ï¼šç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å‹å¯ä»¥é€‰æ‹©Broker:RabbitMQRedisother brokerswebæ¡†æ¶Python å››å¤§ä¸»æµ Web ç¼–ç¨‹æ¡†æ¶webä¸‰å¤§ä¸»æµæ¡†æ¶ åŒæ­¥æ¡†æ¶ï¼šDjangoã€Flaskï¼›å¼‚æ­¥æ¡†æ¶ï¼šTornadoã€Sanic  å…³ç³»å‹æ•°æ®åº“ï¼šMySQLã€PostgreSQLã€Oracleï¼›éå…³ç³»å‹æ•°æ®åº“ï¼šRedisã€Mongo ä¼ä¸šçº§DjangoDjangoäº2003å¹´è¯ç”Ÿäºç¾å›½å ªè¨æ–¯ï¼ˆKansasï¼‰å·ï¼Œæœ€åˆç”¨æ¥åˆ¶ä½œåœ¨çº¿æ–°é—»Webç«™ç‚¹ï¼Œäº2005å¹´åŠ å…¥äº†BSDè®¸å¯è¯å®¶æ—ï¼Œæˆä¸ºå¼€æºç½‘ç»œæ¡†æ¶Djangoæ ¹æ®æ¯”åˆ©æ—¶çš„çˆµå£«éŸ³ä¹å®¶Django Reinhardtå‘½åï¼Œä½œè€…è¿™æ ·å‘½åDjangoæ„å‘³ç€Djangoèƒ½ä¼˜é›…åœ°æ¼”å¥ï¼ˆå¼€å‘ï¼‰åŠŸèƒ½ä¸°å¯Œçš„ä¹æ›²ï¼ˆWebåº”ç”¨ï¼‰å®ƒæ˜¯å½“å‰Pythonä¸–ç•Œé‡Œæœ€è´Ÿç››åä¸”æœ€æˆç†Ÿçš„ç½‘ç»œæ¡†æ¶æœ€åˆç”¨æ¥åˆ¶ä½œåœ¨çº¿æ–°é—»çš„Webç«™ç‚¹ï¼Œç›®å‰å·²å‘å±•ä¸ºåº”ç”¨æœ€å¹¿æ³›çš„Pythonç½‘ç»œæ¡†æ¶Djangoçš„å„æ¨¡å—ä¹‹é—´ç»“åˆå¾—æ¯”è¾ƒç´§å¯†ï¼Œæ‰€ä»¥åœ¨åŠŸèƒ½å¼ºå¤§çš„åŒæ—¶åˆæ˜¯ä¸€ä¸ªç›¸å¯¹å°é—­çš„ç³»ç»Ÿï¼Œä½†æ˜¯å…¶å¥å…¨çš„åœ¨çº¿æ–‡æ¡£åŠå¼€å‘ç¤¾åŒºï¼Œä½¿å¼€å‘è€…åœ¨é‡åˆ°é—®é¢˜æ—¶èƒ½æ‰¾åˆ°è§£å†³æ–¹æ³•ã€‚æ¡†æ¶ç‰¹ç‚¹åŠŸèƒ½æœ€å®Œæ•´ï¼šDjangoå®šä¹‰äº†æœåŠ¡å‘å¸ƒã€è·¯ç”±æ˜ å°„ã€æ¨¡æ¿ç¼–ç¨‹ã€æ•°æ®å¤„ç†çš„ä¸€æ•´å¥—åŠŸèƒ½æ¨¡å—é—´ç´§å¯†è€¦åˆï¼šå¼€å‘è€…éœ€è¦å­¦ä¹ Djangoè‡ªå·±å®šä¹‰çš„è¿™ä¸€æ•´å¥—æŠ€æœ¯å®Œå–„çš„æ–‡æ¡£ï¼šå¹¿æ³›çš„åº”ç”¨å’Œå®Œå–„çš„åœ¨çº¿æ–‡æ¡£ï¼Œå¼€å‘è€…é‡åˆ°é—®é¢˜æ—¶å¯ä»¥æœç´¢åœ¨çº¿æ–‡æ¡£å¯»æ±‚è§£å†³æ–¹æ¡ˆé›†æˆæ•°æ®è®¿é—®ç»„ä»¶ï¼šDjangoçš„Modelå±‚è‡ªå¸¦æ•°æ®åº“ORMç»„ä»¶ï¼Œæ— é¡»å­¦ä¹ å…¶ä»–æ•°æ®åº“è®¿é—®æŠ€æœ¯ï¼ˆdbiã€SQLAlchemyç­‰ï¼‰å¼ºå¤§çš„URLæ˜ å°„æŠ€æœ¯ï¼šDjangoä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ç®¡ç†URLæ˜ å°„ï¼Œç»™å¼€å‘è€…å¸¦æ¥äº†æé«˜çš„çµæ´»æ€§åå°ç®¡ç†ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆï¼šç®€å•çš„å‡ è¡Œé…ç½®å’Œä»£ç å°±å¯ä»¥å®ç°å®Œæ•´çš„åå°æ•°æ®ç®¡ç†Webæ§åˆ¶å°é”™è¯¯ä¿¡æ¯å®Œæ•´ï¼šæä¾›éå¸¸å®Œæ•´çš„é”™è¯¯ä¿¡æ¯å¸®åŠ©å¼€å‘è€…å®šä½é—®é¢˜ï¼Œæ¯”å¦‚ç¼ºå°‘xxxç»„ä»¶çš„é…ç½®å¼•ç”¨ç­‰Djangoæ˜¯éµå¾ªMVCæ¶æ„çš„Webå¼€å‘æ¡†æ¶ï¼Œå…¶ä¸»è¦ç”±ä»¥ä¸‹å‡ éƒ¨åˆ†ç»„æˆç®¡ç†å·¥å…·ï¼ˆManagementï¼‰ï¼šä¸€å¥—å†…ç½®çš„åˆ›å»ºç«™ç‚¹ã€è¿ç§»æ•°æ®ã€ç»´æŠ¤é™æ€æ–‡ä»¶çš„å‘½ä»¤å·¥å…·æ¨¡å‹ï¼ˆModelï¼‰ï¼šæä¾›æ•°æ®è®¿é—®æ¥å£å’Œæ¨¡å—ï¼ŒåŒ…æ‹¬æ•°æ®å­—æ®µã€å…ƒæ•°æ®ã€æ•°æ®å…³ç³»ç­‰çš„å®šä¹‰åŠæ“ä½œè§†å›¾ï¼ˆViewï¼‰ï¼šDjangoçš„è§†å›¾å±‚å°è£…äº†HTTP Requestå’ŒResponseçš„ä¸€ç³»åˆ—æ“ä½œå’Œæ•°æ®æµï¼Œå…¶ä¸»è¦åŠŸèƒ½åŒ…æ‹¬URLæ˜ å°„æœºåˆ¶ã€ç»‘å®šæ¨¡æ¿ç­‰æ¨¡æ¿ï¼ˆTemplateï¼‰ï¼šæ˜¯ä¸€å¥—Djangoè‡ªå·±çš„é¡µé¢æ¸²æŸ“æ¨¡æ¿è¯­è¨€ï¼Œç”¨è‹¥å¹²å†…ç½®çš„tagså’Œfilterså®šä¹‰é¡µé¢çš„ç”Ÿæˆæ–¹è¡¨å•ï¼ˆFormï¼‰ï¼šé€šè¿‡å†…ç½®çš„æ•°æ®ç±»å‹å’Œæ§ä»¶ç”ŸæˆHTMLè¡¨å•ç®¡ç†ç«™ï¼ˆAdminï¼‰ï¼šé€šè¿‡å£°æ˜éœ€è¦ç®¡ç†çš„Modelï¼Œå¿«é€Ÿç”Ÿæˆåå°æ•°æ®ç®¡ç†ç½‘ç«™é«˜å¹¶å‘TornadoTornadoæ˜¯ä½¿ç”¨Pythonç¼–å†™çš„ä¸€ä¸ªå¼ºå¤§çš„å¯æ‰©å±•çš„WebæœåŠ¡å™¨å®ƒåœ¨å¤„ç†é«˜ç½‘ç»œæµé‡æ—¶è¡¨ç°å¾—è¶³å¤Ÿå¼ºå¥ï¼Œå´åœ¨åˆ›å»ºå’Œç¼–å†™æ—¶æœ‰ç€è¶³å¤Ÿçš„è½»é‡çº§ï¼Œå¹¶èƒ½å¤Ÿè¢«ç”¨åœ¨å¤§é‡çš„åº”ç”¨å’Œå·¥å…·ä¸­Tornadoä½œä¸ºFriendFeedç½‘ç«™çš„åŸºç¡€æ¡†æ¶ï¼Œäº2009å¹´9æœˆ10æ—¥å‘å¸ƒï¼Œç›®å‰å·²ç»è·å¾—äº†å¾ˆå¤šç¤¾åŒºçš„æ”¯æŒï¼Œå¹¶ä¸”åœ¨ä¸€ç³»åˆ—ä¸åŒçš„åœºåˆä¸­å¾—åˆ°åº”ç”¨é™¤FriendFeedå’ŒFacebookå¤–ï¼Œè¿˜æœ‰å¾ˆå¤šå…¬å¸åœ¨ç”Ÿäº§ä¸Šè½¬å‘Tornadoï¼ŒåŒ…æ‹¬Quoraã€Turntable.fmã€Bit.lyã€HipmunkåŠMyYearbookç­‰ç›¸å¯¹äºå…¶ä»–Pythonç½‘ç»œæ¡†æ¶ï¼ŒTornadoæœ‰å¦‚ä¸‹ç‰¹ç‚¹å®Œå¤‡çš„Webæ¡†æ¶ï¼šä¸Djangoã€Flaskç­‰ä¸€æ ·ï¼ŒTornadoä¹Ÿæä¾›äº†URLè·¯ç”±æ˜ å°„ã€Requestä¸Šä¸‹æ–‡ã€åŸºäºæ¨¡æ¿çš„é¡µé¢æ¸²æŸ“æŠ€æœ¯ç­‰å¼€å‘Webåº”ç”¨çš„å¿…å¤‡å·¥å…·é«˜æ•ˆçš„ç½‘ç»œåº“ï¼Œæ€§èƒ½ä¸Twistedã€Geventç­‰åº•å±‚Pythonæ¡†æ¶ç›¸åª²ç¾ï¼š**æä¾›äº†å¼‚æ­¥I/Oæ”¯æŒã€è¶…æ—¶äº‹ä»¶å¤„ç†ã€‚è¿™ä½¿å¾—Tornadoé™¤äº†å¯ä»¥ä½œä¸ºWebåº”ç”¨æœåŠ¡å™¨æ¡†æ¶ï¼Œè¿˜å¯ä»¥ç”¨æ¥åšçˆ¬è™«åº”ç”¨ã€ç‰©è”ç½‘å…³ã€æ¸¸æˆæœåŠ¡å™¨ç­‰åå°åº”ç”¨é«˜æ•ˆHTTPClientï¼šé™¤äº†æœåŠ¡å™¨ç«¯æ¡†æ¶ï¼ŒTornadoè¿˜æä¾›äº†åŸºäºå¼‚æ­¥æ¡†æ¶çš„HTTPå®¢æˆ·ç«¯é«˜æ•ˆçš„å†…éƒ¨HTTPæœåŠ¡å™¨ï¼šè™½ç„¶å…¶ä»–Pythonç½‘ç»œæ¡†æ¶ï¼ˆDjangoã€Flaskï¼‰ä¹Ÿæä¾›äº†å†…éƒ¨HTTPæœåŠ¡å™¨ï¼Œä½†å®ƒä»¬çš„HTTPæœåŠ¡å™¨ç”±äºæ€§èƒ½åŸå› åªèƒ½ç”¨äºæµ‹è¯•ç¯å¢ƒã€‚è€ŒTornadoçš„HTTPæœåŠ¡å™¨ä¸Tornadoå¼‚æ­¥è°ƒç”¨ç´§å¯†ç»“åˆï¼Œå¯ä»¥ç›´æ¥ç”¨äºç”Ÿäº§ç¯å¢ƒå®Œå¤‡çš„WebSocketæ”¯æŒï¼šWebSocketæ˜¯HTML5çš„ä¸€ç§æ–°æ ‡å‡†ï¼Œå®ç°äº†æµè§ˆå™¨ä¸æœåŠ¡å™¨ä¹‹é—´çš„åŒå‘å®æ—¶é€šä¿¡å› ä¸ºTornadoçš„ä¸Šè¿°ç‰¹ç‚¹ï¼ŒTornadoå¸¸è¢«ç”¨ä½œå¤§å‹ç«™ç‚¹çš„æ¥å£æœåŠ¡æ¡†æ¶ï¼Œè€Œä¸åƒDjangoé‚£æ ·ç€çœ¼äºå»ºç«‹å®Œæ•´çš„å¤§å‹ç½‘ç«™ä¸»è¦å…³æ³¨Tornadoçš„å¼‚æ­¥åŠåç¨‹ç¼–ç¨‹ã€èº«ä»½è®¤è¯æ¡†æ¶ã€ç‹¬ç‰¹çš„éWSGIéƒ¨ç½²æ–¹å¼å¿«é€Ÿå»ºç«™FlaskFlaskæ˜¯Python Webæ¡†æ¶æ—é‡Œæ¯”è¾ƒå¹´è½»çš„ä¸€ä¸ªï¼Œäº2010å¹´å‡ºç°ï¼Œè¿™ä½¿å¾—å®ƒå¸æ”¶äº†å…¶ä»–æ¡†æ¶çš„ä¼˜ç‚¹ï¼Œå¹¶ä¸”æŠŠè‡ªå·±çš„ä¸»è¦é¢†åŸŸå®šä¹‰åœ¨äº†å¾®å°é¡¹ç›®ä¸ŠåŒæ—¶ï¼Œå®ƒæ˜¯å¯æ‰©å±•çš„ï¼ŒFlaskè®©å¼€å‘è€…è‡ªå·±é€‰æ‹©ç”¨ä»€ä¹ˆæ•°æ®åº“æ’ä»¶å­˜å‚¨ä»–ä»¬çš„æ•°æ®å¾ˆå¤šåŠŸèƒ½ç®€å•ä½†æ€§èƒ½å“è¶Šçš„ç½‘ç«™å°±æ˜¯åŸºäºFlaskæ¡†æ¶è€Œæ­å»ºçš„ï¼Œæ¯”å¦‚http://httpbin.org/å°±æ˜¯ä¸€ä¸ªåŠŸèƒ½ç®€å•ä½†æ€§èƒ½å¼ºå¤§çš„HTTPæµ‹è¯•é¡¹ç›®Flaskæ˜¯ä¸€ä¸ªé¢å‘ç®€å•éœ€æ±‚å’Œå°å‹åº”ç”¨çš„å¾®æ¡†æ¶ç›¸å¯¹äºå…¶ä»–Pythonè¯­è¨€çš„Webæ¡†æ¶è€Œè¨€ï¼ŒFlaskçš„ç‰¹ç‚¹å¯ä»¥å½’ç»“å¦‚ä¸‹ã€‚å†…ç½®å¼€å‘æœåŠ¡å™¨å’Œè°ƒè¯•å™¨ï¼šç½‘ç»œç¨‹åºè°ƒè¯•æ˜¯åœ¨å°†ç¼–åˆ¶å¥½çš„ç½‘ç«™æŠ•å…¥å®é™…è¿è¡Œå‰ï¼Œç”¨æ‰‹å·¥æˆ–ç¼–è¯‘ç¨‹åºç­‰æ–¹æ³•è¿›è¡Œæµ‹è¯•ï¼Œä¿®æ­£è¯­æ³•é”™è¯¯å’Œé€»è¾‘é”™è¯¯çš„è¿‡ç¨‹ã€‚æœ‰ç»éªŒçš„å¼€å‘è€…éƒ½çŸ¥é“ï¼Œè¿™æ˜¯ä¿è¯ç½‘ç«™ç³»ç»Ÿèƒ½å¤Ÿæ­£å¼åº”ç”¨çš„å¿…è¦æ­¥éª¤ã€‚Flask è‡ªå¸¦çš„å¼€å‘æœåŠ¡å™¨ä½¿å¼€å‘è€…åœ¨è°ƒè¯•ç¨‹åºæ—¶æ— é¡»å†å®‰è£…å…¶ä»–ä»»ä½•ç½‘ç»œæœåŠ¡å™¨ï¼Œæ¯”å¦‚Tomcatã€JBossã€Apacheç­‰ã€‚Flaské»˜è®¤å¤„äºè°ƒè¯•çŠ¶æ€ï¼Œä½¿å¾—è¿è¡Œä¸­çš„ä»»ä½•é”™è¯¯ä¼šåŒæ—¶å‘ä¸¤ä¸ªç›®æ ‡å‘é€ä¿¡æ¯ï¼šä¸€ä¸ªæ˜¯Python Consoleï¼Œå³å¯åŠ¨Pythonç¨‹åºçš„æ§åˆ¶å°ï¼›å¦ä¸€ä¸ªæ˜¯HTTPå®¢æˆ·ç«¯ï¼Œå³Flaskå¼€å‘æœåŠ¡å™¨å°†è°ƒè¯•ä¿¡æ¯ä¼ é€’ç»™äº†å®¢æˆ·ç«¯ã€‚ä¸Pythonå•å…ƒæµ‹è¯•åŠŸèƒ½æ— ç¼è¡”æ¥ï¼šå•å…ƒæµ‹è¯•æ˜¯å¯¹æœ€å°è½¯ä»¶å¼€å‘å•å…ƒçš„æµ‹è¯•ï¼Œå…¶é‡ç‚¹æµ‹è¯•ç¨‹åºçš„å†…éƒ¨ç»“æ„ï¼Œä¸»è¦é‡‡ç”¨ç™½ç›’æµ‹è¯•æ–¹æ³•ï¼Œç”±å¼€å‘äººå‘˜è´Ÿè´£ã€‚å•å…ƒæµ‹è¯•çš„ä¸»è¦ç›®æ ‡æ˜¯ä¿è¯å‡½æ•°åœ¨ç»™å®šçš„è¾“å…¥çŠ¶æ€ä¸‹ï¼Œèƒ½å¤Ÿå¾—åˆ°é¢„æƒ³çš„è¾“å‡ºï¼Œåœ¨ä¸ç¬¦åˆè¦æ±‚æ—¶èƒ½å¤Ÿæé†’å¼€å‘äººå‘˜è¿›è¡Œæ£€æŸ¥ã€‚Flaskæä¾›äº†ä¸€ä¸ªä¸Pythonè‡ªå¸¦çš„å•å…ƒæµ‹è¯•æ¡†æ¶unitestæ— ç¼è¡”æ¥çš„æµ‹è¯•æ¥å£ï¼Œå³Flaskå¯¹è±¡çš„test_client()å‡½æ•°ã€‚é€šè¿‡test_client()å‡½æ•°ï¼Œæµ‹è¯•ç¨‹åºå¯ä»¥æ¨¡æ‹Ÿè¿›è¡ŒHTTPè®¿é—®çš„å®¢æˆ·ç«¯æ¥è°ƒç”¨Flaskè·¯ç”±å¤„ç†å‡½æ•°ï¼Œå¹¶ä¸”è·å–å‡½æ•°çš„è¾“å‡ºæ¥è¿›è¡Œè‡ªå®šä¹‰çš„éªŒè¯ã€‚ä½¿ç”¨Jinja2æ¨¡æ¿å°†HTMLé¡µé¢ä¸åå°åº”ç”¨ç¨‹åºè”ç³»èµ·æ¥ä¸€ç›´æ˜¯ç½‘ç«™ç¨‹åºæ¡†æ¶çš„ä¸€ä¸ªé‡è¦ç›®æ ‡ã€‚Flaské€šè¿‡ä½¿ç”¨Jinja2æ¨¡æ¿æŠ€æœ¯è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚Jinja2æ˜¯ä¸€ä¸ªéå¸¸çµæ´»çš„HTMLæ¨¡æ¿æŠ€æœ¯ï¼Œå®ƒæ˜¯ä»Djangoæ¨¡æ¿å‘å±•è€Œæ¥çš„ï¼Œä½†æ˜¯æ¯”Djangoæ¨¡æ¿ä½¿ç”¨èµ·æ¥æ›´åŠ è‡ªç”±ä¸”æ›´åŠ é«˜æ•ˆã€‚Jinja2æ¨¡æ¿ä½¿ç”¨é…åˆ¶çš„è¯­ä¹‰ç³»ç»Ÿï¼Œæä¾›çµæ´»çš„æ¨¡æ¿ç»§æ‰¿æŠ€æœ¯ï¼Œè‡ªåŠ¨æŠ—å‡»XSSè·¨ç«™æ”»å‡»å¹¶ä¸”æ˜“äºè°ƒè¯•ã€‚å®Œå…¨å…¼å®¹WSGI 1.0æ ‡å‡†WSGIï¼ˆWeb Server Gateway Interfaceï¼‰å…·æœ‰å¾ˆå¼ºçš„ä¼¸ç¼©æ€§ä¸”èƒ½è¿è¡Œäºå¤šçº¿ç¨‹æˆ–å¤šè¿›ç¨‹ç¯å¢ƒä¸‹ï¼Œå› ä¸ºPythonçº¿ç¨‹å…¨å±€é”çš„å­˜åœ¨ï¼Œä½¿å¾—WSGIçš„è¿™ä¸ªç‰¹æ€§è‡³å…³é‡è¦ã€‚WSGIå·²ç»æ˜¯Pythonç•Œçš„ä¸€ä¸ªä¸»è¦æ ‡å‡†ï¼Œå„ç§å¤§å‹ç½‘è·¯æœåŠ¡å™¨å¯¹å…¶éƒ½æœ‰è‰¯å¥½çš„æ”¯æŒã€‚WSGIä½äºWebåº”ç”¨ç¨‹åºä¸WebæœåŠ¡å™¨ä¹‹é—´ï¼Œä¸WSGIå®Œå…¨å…¼å®¹ä½¿å¾—Flaskèƒ½å¤Ÿé…ç½®åˆ°å„ç§å¤§å‹ç½‘ç»œæœåŠ¡å™¨ä¸­ã€‚åŸºäºUnicodeç¼–ç Flaskæ˜¯å®Œå…¨åŸºäºUnicodeçš„ã€‚è¿™å¯¹åˆ¶ä½œéçº¯ASCIIå­—ç¬¦é›†çš„ç½‘ç«™æ¥è¯´éå¸¸æ–¹ä¾¿ã€‚HTTPæœ¬èº«æ˜¯åŸºäºå­—èŠ‚çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä»»ä½•ç¼–ç æ ¼å¼éƒ½å¯ä»¥åœ¨HTTPä¸­ä¼ è¾“ã€‚ä½†æ˜¯ï¼ŒHTTPè¦æ±‚åœ¨HTTP Headä¸­æ˜¾å¼åœ°å£°æ˜åœ¨æœ¬æ¬¡ä¼ è¾“ä¸­æ‰€åº”ç”¨çš„ç¼–ç æ ¼å¼ã€‚åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼ŒFlaskä¼šè‡ªåŠ¨æ·»åŠ ä¸€ä¸ªUTF-8ç¼–ç æ ¼å¼çš„HTTP Headï¼Œä½¿ç¨‹åºå‘˜æ— é¡»æ‹…å¿ƒç¼–ç çš„é—®é¢˜ã€‚è‡ªå®šä¹‰åè®®Twistedä»¥ä¸Šè®²åˆ°çš„3ä¸ªPython Webæ¡†æ¶éƒ½æ˜¯å›´ç»•ç€åº”ç”¨å±‚HTTPå±•å¼€çš„ï¼Œè€ŒTwistedæ˜¯ä¸€ä¸ªä¾‹å¤–Twistedæ˜¯ä¸€ä¸ªç”¨Pythonè¯­è¨€ç¼–å†™çš„äº‹ä»¶é©±åŠ¨çš„ç½‘ç»œæ¡†æ¶å¯¹äºè¿½æ±‚æœåŠ¡å™¨ç¨‹åºæ€§èƒ½çš„åº”ç”¨ï¼ŒTwistedæ¡†æ¶æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©Twistedæ˜¯ä¸€ä¸ªæœ‰ç€10å¤šå¹´å†å²çš„å¼€æºäº‹ä»¶é©±åŠ¨æ¡†æ¶wistedæ”¯æŒå¾ˆå¤šç§åè®®ï¼ŒåŒ…æ‹¬ä¼ è¾“å±‚çš„UDPã€TCPã€TLSï¼Œä»¥åŠåº”ç”¨å±‚çš„HTTPã€FTPç­‰å¯¹äºæ‰€æœ‰è¿™äº›åè®®ï¼ŒTwistedæä¾›äº†å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨æ–¹é¢çš„å¼€å‘å·¥å…·ã€‚Twistedæ¡†æ¶çš„å†å²æ‚ ä¹…ï¼Œå…¶ä¸»è¦å‘è¡Œç‰ˆæœ¬éƒ½ä»¥Python 2ä¸ºåŸºç¡€ï¼Œæœ€æ–°çš„ç‰ˆæœ¬ä¸ºåŸºäºPython 2.7çš„Twisted-15.4.0Twistedç¤¾åŒºæ­£åœ¨å¼€å‘åŸºäºPython 3çš„ç‰ˆæœ¬ï¼Œä½†ç›®å‰ä¸ºæ­¢å°šæ²¡æœ‰åŸºäºPython 3çš„Twistedç¨³å®šå‘è¡Œç‰ˆTwistedæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„ç¼–ç¨‹æ¡†æ¶åœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿå¹³å°ä¸Šï¼ŒTwistedåˆ©ç”¨ä¸åŒçš„åº•å±‚æŠ€æœ¯å®ç°äº†é«˜æ•ˆèƒ½é€šä¿¡åœ¨Windowsä¸­ï¼ŒTwistedçš„å®ç°åŸºäºI/Oå®Œæˆç«¯å£ï¼ˆIOCPï¼ŒInput/Output Completion Portï¼‰æŠ€æœ¯ï¼Œå®ƒä¿è¯äº†åº•å±‚é«˜æ•ˆåœ°å°†I/Oäº‹ä»¶é€šçŸ¥ç»™æ¡†æ¶åŠåº”ç”¨ç¨‹åºåœ¨Linuxä¸­ï¼ŒTwistedçš„å®ç°åŸºäºepollæŠ€æœ¯ï¼Œepollæ˜¯Linuxä¸‹å¤šè·¯å¤ç”¨I/Oæ¥å£select/pollçš„å¢å¼ºç‰ˆæœ¬ï¼Œå®ƒèƒ½æ˜¾è‘—æé«˜ç¨‹åºåœ¨å¤§é‡å¹¶å‘è¿æ¥ä¸­åªæœ‰å°‘é‡æ´»è·ƒçš„æƒ…å†µä¸‹çš„ç³»ç»ŸCPUåˆ©ç”¨ç‡åœ¨å¼€å‘æ–¹æ³•ä¸Šï¼ŒTwistedå¼•å¯¼ç¨‹åºå‘˜ä½¿ç”¨å¼‚æ­¥ç¼–ç¨‹æ¨¡å‹ã€‚Twistedæä¾›äº†ä¸°å¯Œçš„Deferã€Threadingç­‰ç‰¹æ€§æ¥æ”¯æŒå¼‚æ­¥ç¼–ç¨‹ã€‚æ¶ˆæ¯é˜Ÿåˆ—RabbitMQPythonæ¶ˆæ¯é˜Ÿåˆ—ï¼ˆRabbitMQï¼‰RedisPythonå­¦ä¹ ä¹‹Redisäº¤äº’è¯¦è§£ç›¸å…³ç–‘é—®å¤šçº¿ç¨‹å­˜åœ¨æ„ä¹‰å¤šçº¿ç¨‹å­˜åœ¨æ„ä¹‰åç¨‹å¸¸è§é—®é¢˜å¾ˆå¤šä¸ªåç¨‹ä¸€èµ·è¿è¡Œæœ‰åˆ›å»ºæ–°çš„çº¿ç¨‹å—ï¼Ÿåç¨‹è¿è¡Œæ—¶ï¼Œéƒ½æ˜¯åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­è¿è¡Œçš„ï¼Œæ²¡æœ‰åˆ›å»ºæ–°çš„çº¿ç¨‹ã€‚å¦‚ä¸‹ 1234567891011121314151617181920212223242526272829303132333435363738394041importÂ asyncioimportÂ timeimportÂ threading a=time.time() asyncÂ defÂ hello1():Â Â Â Â print(f&quot;HelloÂ worldÂ 01Â begin,myÂ threadÂ is:{threading.currentThread()}&quot;)Â Â Â Â awaitÂ asyncio.sleep(3)Â Â Â Â print(&quot;HelloÂ againÂ 01Â end&quot;) asyncÂ defÂ hello2():Â Â Â Â print(f&quot;HelloÂ worldÂ 02Â begin,myÂ threadÂ is:{threading.currentThread()}&quot;)Â Â Â Â awaitÂ asyncio.sleep(2)Â Â Â Â print(&quot;HelloÂ againÂ 02Â end&quot;) asyncÂ defÂ hello3():Â Â Â Â print(f&quot;HelloÂ worldÂ 03Â begin,myÂ threadÂ is:{threading.currentThread()}&quot;)Â Â Â Â awaitÂ asyncio.sleep(1)Â Â Â Â print(&quot;HelloÂ againÂ 03Â end&quot;) loopÂ =Â asyncio.get_event_loop()tasksÂ =Â [hello1(),Â hello2(),hello3()]loop.run_until_complete(asyncio.wait(tasks)) loop.close()  b=time.time()print('---------------------------------------')print(b-a)'''è¿è¡Œç»“æœä¸ºï¼šHelloÂ worldÂ 03Â begin,myÂ threadÂ is:&lt;_MainThread(MainThread,Â startedÂ 4168)&gt;HelloÂ worldÂ 02Â begin,myÂ threadÂ is:&lt;_MainThread(MainThread,Â startedÂ 4168)&gt;HelloÂ worldÂ 01Â begin,myÂ threadÂ is:&lt;_MainThread(MainThread,Â startedÂ 4168)&gt;HelloÂ againÂ 03Â endHelloÂ againÂ 02Â endHelloÂ againÂ 01Â end---------------------------------------2.994506597518921'''ä»ä¸Šé¢é‚£ä¸ªå¯ä»¥çœ‹å‡ºï¼Œä¸‰ä¸ªä¸åŒçš„åç¨‹å‡½æ•°éƒ½æ˜¯åœ¨ä¸€ä¸ªçº¿ç¨‹å®Œæˆçš„ã€‚ä½†æ˜¯å¹¶ä¸æ˜¯æ„å‘³ç€ï¼Œå¤šä¸ªåç¨‹å‡½æ•°åªèƒ½åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œï¼ŒåŒæ ·å¯ä»¥åˆ›å»ºæ–°çš„çº¿ç¨‹ï¼Œå…¶å®æˆ‘ä»¬å®Œå…¨å¯ä»¥åœ¨æ–°çš„çº¿ç¨‹ä¸­é‡æ–°åˆ›å»ºä¸€ä¸ªäº‹ä»¶å¾ªç¯ï¼Œå…·ä½“çš„å®ä¾‹å‚è§åé¢ã€‚ çº¿ç¨‹ä¸€å®šæ•ˆç‡æ›´é«˜å—ï¼Ÿ ä¹Ÿä¸æ˜¯ç»å¯¹çš„ï¼Œå½“ç„¶åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¼‚æ­¥æ–¹å¼çš„æ‰§è¡Œæ•ˆç‡æ˜¯æ›´é«˜çš„ï¼Œå°±æ¯”å¦‚ä¸Šé¢çš„ä¸‰ä¸ªå‡½æ•°ï¼Œå¦‚æœæŒ‰ç…§åŒæ­¥çš„æ–¹å¼æ‰§è¡Œï¼Œåˆ™ä¸€å…±éœ€è¦6ç§’çš„æ—¶é—´ï¼Œä½†æ˜¯é‡‡ç”¨åç¨‹åˆ™åªéœ€è¦æœ€é•¿çš„é‚£ä¸ªæ—¶é—´3ç§’ï¼Œè¿™è‡ªç„¶æ˜¯æé«˜äº†å·¥ä½œæ•ˆç‡ï¼Œé‚£æ˜¯ä¸æ˜¯ä¸€å®šä¼šæé«˜å‘¢ï¼Ÿä¹Ÿä¸ä¸€å®šï¼Œè¿™ä¸åç¨‹çš„è°ƒç”¨æ–¹å¼æ˜¯ç”±å¯†åˆ‡å…³ç³»çš„ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142import asyncioimport timeimport threading a=time.time() async def hello1():    print(f&quot;Hello world 01 begin,my thread is:{threading.currentThread()}&quot;)    await asyncio.sleep(3)    print(&quot;Hello again 01 end&quot;) async def hello2():    print(f&quot;Hello world 02 begin,my thread is:{threading.currentThread()}&quot;)    await asyncio.sleep(2)    print(&quot;Hello again 02 end&quot;) async def hello3():    print(f&quot;Hello world 03 begin,my thread is:{threading.currentThread()}&quot;)    await hello2()    await hello1()    print(&quot;Hello again 03 end&quot;) loop = asyncio.get_event_loop()tasks = [hello3()]loop.run_until_complete(asyncio.wait(tasks)) loop.close() b=time.time()print('---------------------------------------')print(b-a) '''è¿è¡Œç»“æœä¸ºï¼šHello world 03 begin,my thread is:&lt;_MainThread(MainThread, started 13308)&gt;Hello world 02 begin,my thread is:&lt;_MainThread(MainThread, started 13308)&gt;Hello again 02 endHello world 01 begin,my thread is:&lt;_MainThread(MainThread, started 13308)&gt;Hello again 01 endHello again 03 end---------------------------------------5.008373498916626'''æˆ‘ä»¬å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œä¸Šé¢æ‰§è¡Œçš„é¡ºåºå®Œå…¨ä¸æ˜¯å¼‚æ­¥æ‰§è¡Œï¼Œæ‰§è¡Œçš„æ—¶é—´ä¹Ÿæ²¡æœ‰å¾—åˆ°æ”¹å–„ï¼Œç©¶å…¶åŸå› ï¼Œæ˜¯å› ä¸ºä¸Šé¢æ˜¯é€šè¿‡hello3å»è°ƒç”¨hello1å’Œhello2çš„ï¼Œè¿™å’ŒåŒæ­¥è°ƒç”¨çš„æ–¹å¼å®Œå…¨æ˜¯ä¸€æ ·çš„ï¼Œå³ä½¿æˆ‘å®šä¹‰çš„éƒ½æ˜¯å¼‚æ­¥æ–¹æ³•ï¼Œå®ƒæ—¢æ²¡æœ‰æé«˜æ‰§è¡Œæ•ˆç‡ï¼Œè¿˜ä¼šæœ‰é˜»å¡ã€‚ç»“è®ºï¼šåœ¨æœ‰å¾ˆå¤šä¸ªå¼‚æ­¥æ–¹å¼çš„æ—¶å€™ï¼Œä¸€å®šè¦å°½é‡é¿å…è¿™ç§å¼‚æ­¥å‡½æ•°çš„ç›´æ¥è°ƒç”¨ï¼Œè¿™å’ŒåŒæ­¥æ˜¯æ²¡ä»€ä¹ˆåŒºåˆ«çš„ï¼Œä¸€å®šè¦é€šè¿‡äº‹ä»¶å¾ªç¯loopï¼Œâ€œè®©äº‹ä»¶å¾ªç¯åœ¨å„ä¸ªå¼‚æ­¥å‡½æ•°ä¹‹é—´ä¸åœæ¸¸èµ°â€ï¼Œè¿™æ ·æ‰ä¸ä¼šé€ æˆé˜»å¡ã€‚åç¨‹ä¼šä¸ä¼šæœ‰é˜»å¡å‘¢ï¼Ÿå¼‚æ­¥æ–¹å¼ä¾ç„¶ä¼šæœ‰é˜»å¡çš„ï¼Œå½“æˆ‘ä»¬å®šä¹‰çš„å¾ˆå¤šä¸ªå¼‚æ­¥æ–¹æ³•å½¼æ­¤ä¹‹é—´æœ‰ä¸€æ¥çš„æ—¶å€™ï¼Œæ¯”å¦‚ï¼Œæˆ‘å¿…é¡»è¦ç­‰åˆ°å‡½æ•°1æ‰§è¡Œå®Œæ¯•ï¼Œå‡½æ•°2éœ€è¦ç”¨åˆ°å‡½æ•°1çš„è¿”å›å€¼ï¼Œå¦‚ä¸Šé¢çš„ä¾‹å­2æ‰€ç¤ºï¼Œå°±ä¼šé€ æˆé˜»å¡ï¼Œè¿™ä¹Ÿæ˜¯å¼‚æ­¥ç¼–ç¨‹çš„éš¾ç‚¹ä¹‹ä¸€ï¼Œå¦‚ä½•åˆç†é…ç½®è¿™äº›èµ„æºï¼Œå°½é‡å‡å°‘å‡½æ•°ä¹‹é—´çš„æ˜ç¡®ä¾èµ–ï¼Œè¿™æ˜¯å¾ˆé‡è¦çš„ã€‚ å¼‚æ­¥æ–¹æ³•å‡æ­»ï¼ˆfreezingï¼‰123456789101112131415161718192021222324252627282930 import asyncioimport timeimport threading #å®šä¹‰ä¸€ä¸ªå¼‚æ­¥æ“ä½œasync def hello1(a,b):    print(f&quot;å¼‚æ­¥å‡½æ•°å¼€å§‹æ‰§è¡Œ&quot;)    await asyncio.sleep(3)    print(&quot;å¼‚æ­¥å‡½æ•°æ‰§è¡Œç»“æŸ&quot;)    return a+b #åœ¨ä¸€ä¸ªå¼‚æ­¥æ“ä½œé‡Œé¢è°ƒç”¨å¦ä¸€ä¸ªå¼‚æ­¥æ“ä½œasync def main():    c=await hello1(10,20)    print(c)    print(&quot;ä¸»å‡½æ•°æ‰§è¡Œ&quot;) loop = asyncio.get_event_loop()tasks = [main()]loop.run_until_complete(asyncio.wait(tasks)) loop.close() '''è¿è¡Œç»“æœä¸ºï¼šå¼‚æ­¥å‡½æ•°å¼€å§‹æ‰§è¡Œï¼ˆåœ¨æ­¤å¤„è¦ç­‰å¾…3ç§’ï¼‰å¼‚æ­¥å‡½æ•°æ‰§è¡Œç»“æŸ30ä¸»å‡½æ•°æ‰§è¡Œ'''æ³¨æ„ä¸€ä¸ªé—®é¢˜ï¼šæˆ‘ä»¬å‰é¢æ‰€è®²çš„ä¾‹å­ä¸­ï¼Œæ²¡æœ‰å‡ºç°ç­‰å¾…ï¼Œæ˜¯å› ä¸ºå„ä¸ªå¼‚æ­¥æ–¹æ³•ä¹‹é—´æ˜¯â€œå®Œå…¨å¹¶åˆ—â€å…³ç³»ï¼Œå½¼æ­¤ä¹‹é—´æ²¡æœ‰ä¾èµ–ï¼Œæ‰€ä»¥ï¼Œæˆ‘å¯ä»¥å°†æ‰€æœ‰çš„å¼‚æ­¥æ“ä½œâ€œgatherâ€èµ·æ¥ï¼Œç„¶åé€šè¿‡äº‹ä»¶å¾ªç¯ï¼Œè®©äº‹ä»¶å¾ªç¯åœ¨å¤šä¸ªå¼‚æ­¥æ–¹æ³•ä¹‹é—´æ¥å›è°ƒç”¨ï¼Œæ°¸ä¸åœæ­¢ï¼Œæ•…è€Œæ²¡æœ‰å‡ºç°ç­‰å¾…ã€‚ä½†æ˜¯ï¼Œç°å®ä¸­ä¸å¯èƒ½æ‰€æœ‰çš„å¼‚æ­¥æ–¹æ³•éƒ½æ˜¯å®Œå…¨ç‹¬ç«‹çš„ï¼Œæ²¡æœ‰ä»»ä½•å…³ç³»çš„ï¼Œåœ¨ä¸Šé¢çš„è¿™ä¸ªä¾‹å­ä¸­ï¼Œå°±æ˜¯å¾ˆå¥½çš„è¯´æ˜ï¼Œhello1æ˜¯ä¸€ä¸ªè€—æ—¶ä»»åŠ¡ï¼Œè€—æ—¶å¤§çº¦3ç§’ï¼Œmainä¹Ÿæ˜¯ä¸€ä¸ªå¼‚æ­¥æ–¹æ³•ï¼Œä½†æ˜¯mainä¸­éœ€è¦ç”¨åˆ°hello1ä¸­çš„è¿”å›ç»“æœï¼Œæ‰€ä»¥ä»–å¿…é¡»è¦ç­‰å¾…hello1è¿è¡Œç»“æŸä¹‹åå†æ‰èƒ½ç»§ç»­æ‰§è¡Œï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¼šå¾—åˆ°ä¸Šé¢ç»“æœçš„åŸå› ã€‚è¿™ä¹Ÿå†ä¸€æ¬¡è¯´æ˜ï¼Œå¼‚æ­¥ä¾ç„¶æ˜¯ä¼šæœ‰é˜»å¡çš„ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥è¿™æ ·ç†è§£ï¼Œå› ä¸ºæˆ‘ç»™äº‹ä»¶å¾ªç¯åªæ³¨å†Œäº†ä¸€ä¸ªå¼‚æ­¥æ–¹æ³•ï¼Œé‚£å°±æ˜¯mainï¼Œå½“åœ¨mainé‡Œé¢é‡åˆ°äº†awaitï¼Œäº‹ä»¶å¾ªç¯æŒ‚èµ·ï¼Œè½¬è€Œå¯»æ‰¾å…¶ä»–çš„å¼‚æ­¥æ–¹æ³•ï¼Œä½†æ˜¯ç”±äºåªæ³¨å†Œäº†ä¸€ä¸ªå¼‚æ­¥æ–¹æ³•ç»™äº‹ä»¶å¾ªç¯ï¼Œä»–æ²¡æœ‰å…¶ä»–çš„æ–¹æ³•å¯æ‰§è¡Œäº†ï¼Œæ‰€ä»¥åªèƒ½ç­‰å¾…ï¼Œè®©hello1æ‰§è¡Œå®Œäº†ï¼Œå†ç»§ç»­æ‰§è¡Œã€‚multithreading+asyncioæ€»ç»“1234567891011121314151617181920212223242526272829303132333435363738import tkinter as tk          # å¯¼å…¥ Tkinter åº“import timeimport asyncioimport threading class Form:    def __init__(self):        self.root=tk.Tk()        self.root.geometry('500x300')        self.root.title('çª—ä½“ç¨‹åº')  #è®¾ç½®çª—å£æ ‡é¢˜                self.button=tk.Button(self.root,text=&quot;å¼€å§‹è®¡ç®—&quot;,command=self.change_form_state)        self.label=tk.Label(master=self.root,text=&quot;ç­‰å¾…è®¡ç®—ç»“æœ&quot;)         self.button.pack()        self.label.pack()         self.root.mainloop()     async def calculate(self):        await asyncio.sleep(3)        self.label[&quot;text&quot;]=300     def get_loop(self,loop):        self.loop=loop        asyncio.set_event_loop(self.loop)        self.loop.run_forever()    def change_form_state(self):        coroutine1 = self.calculate()        new_loop = asyncio.new_event_loop()                        #åœ¨å½“å‰çº¿ç¨‹ä¸‹åˆ›å»ºæ—¶é—´å¾ªç¯ï¼Œï¼ˆæœªå¯ç”¨ï¼‰ï¼Œåœ¨start_loopé‡Œé¢å¯åŠ¨å®ƒ        t = threading.Thread(target=self.get_loop,args=(new_loop,))   #é€šè¿‡å½“å‰çº¿ç¨‹å¼€å¯æ–°çš„çº¿ç¨‹å»å¯åŠ¨äº‹ä»¶å¾ªç¯        t.start()         asyncio.run_coroutine_threadsafe(coroutine1,new_loop)  #è¿™å‡ ä¸ªæ˜¯å…³é”®ï¼Œä»£è¡¨åœ¨æ–°çº¿ç¨‹ä¸­äº‹ä»¶å¾ªç¯ä¸æ–­â€œæ¸¸èµ°â€æ‰§è¡Œ  if __name__=='__main__':    form=Form()å®šä¹‰éœ€è¦å¼‚æ­¥æ‰§è¡Œçš„ä¸€ç³»åˆ—æ“ä½œï¼ŒåŠä¸€ç³»åˆ—åç¨‹å‡½æ•°ï¼›åœ¨ä¸»çº¿ç¨‹ä¸­å®šä¹‰ä¸€ä¸ªæ–°çš„çº¿ç¨‹ï¼Œç„¶ååœ¨æ–°çº¿ç¨‹ä¸­äº§ç”Ÿä¸€ä¸ªæ–°çš„äº‹ä»¶å¾ªç¯ï¼›åœ¨ä¸»çº¿ç¨‹ä¸­ï¼Œé€šè¿‡asyncio.run_coroutine_threadsafe(coroutine,loop)è¿™ä¸ªæ–¹æ³•å°†ä¸€ç³»åˆ—å¼‚æ­¥æ–¹æ³•æ³¨å†Œåˆ°æ–°çº¿ç¨‹çš„loopé‡Œé¢å»ï¼Œè¿™æ ·å°±æ˜¯æ–°çº¿ç¨‹è´Ÿè´£äº‹ä»¶å¾ªç¯çš„æ‰§è¡Œã€‚asyncio.run_coroutine_threadsafe(coroutineï¼Œloop)çš„æ„æ€å¾ˆç®€å•ï¼Œå°±æ˜¯æˆ‘åœ¨æ–°çº¿ç¨‹ä¸­åˆ›å»ºä¸€ä¸ªäº‹ä»¶å¾ªç¯loopç„¶ååœ¨æ–°çº¿ç¨‹çš„loopä¸­ä¸æ–­ä¸åœçš„è¿è¡Œä¸€ä¸ªæˆ–è€…æ˜¯å¤šä¸ªcoroutine</content>
	</entry>
</search>
